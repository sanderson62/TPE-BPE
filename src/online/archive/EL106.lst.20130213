* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL106.cbl
* Options: int("EL106.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL106.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL106.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL106.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL106.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:41:00.
     7*                            VMOD=2.026.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL106.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION- EX10 - STATE MAINTENANCE
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* Changes are marked by the Change Effective date.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 100108    2008022800002  AJRA  ADD CHECK NUMBER TO STATE FOR AK
    34* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
    35* 011211    2010030900001  AJRA  ADD OPTION 4 AND 5 TO REFUND IND
    36* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
    37* 031512    2011120900003  AJRA  ADD AHL COMPANY CODE
    38******************************************************************
    39
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL106.cbl
    41 ENVIRONMENT DIVISION.
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL106 WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.026 ***********'.
    48
    49*                                COPY ELCSCTM.
    50******************************************************************
    51*                                                                *
    52*                                                                *
    53*                            ELCSCTM                             *
    54*                            VMOD=2.001                          *
    55*                                                                *
    56*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    57*                                                                *
    58******************************************************************
    59 01  SECURITY-MESSAGE.
    60     12  FILLER                          PIC X(30)
    61            VALUE '** LOGIC SECURITY VIOLATION -'.
    62     12  SM-READ                         PIC X(6).
    63     12  FILLER                          PIC X(5)
    64            VALUE ' PGM='.
    65     12  SM-PGM                          PIC X(6).
    66     12  FILLER                          PIC X(5)
    67            VALUE ' OPR='.
    68     12  SM-PROCESSOR-ID                 PIC X(4).
    69     12  FILLER                          PIC X(6)
    70            VALUE ' TERM='.
    71     12  SM-TERMID                       PIC X(4).
    72     12  FILLER                          PIC XX   VALUE SPACE.
    73     12  SM-JUL-DATE                     PIC 9(5).
    74     12  FILLER                          PIC X    VALUE SPACE.
    75     12  SM-TIME                         PIC 99.99.
    76
    77*                                COPY ELCSCRTY.
    78******************************************************************
    79*                                                                *
    80*                                                                *
    81*                            ELCSCRTY                            *
    82*                            VMOD=2.001                          *
    83*                                                                *
    84*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    85*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    86*        SAVED IN PI-SECURITY-ADDRESS.                           *
    87*                                                                *
    88******************************************************************
    89 01  SECURITY-CONTROL.
    90     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    91     12  FILLER                       PIC XX    VALUE 'SC'.
    92     12  SC-CREDIT-CODES.
    93         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    94             20  SC-CREDIT-DISPLAY    PIC X.
    95             20  SC-CREDIT-UPDATE     PIC X.
    96     12  SC-CLAIMS-CODES.
    97         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    98             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL106.cbl
    99             20  SC-CLAIMS-UPDATE     PIC X.
   100*                                COPY MPCSCRT.
   101******************************************************************
   102*                                                                *
   103*                            MPCSCRT                             *
   104*                            VMOD=1.001                          *
   105*                                                                *
   106*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   107*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   108*                                      (MP MORTGAGE PROTECTION)  *
   109*                                                                *
   110******************************************************************
   111*
   112 01  SECURITY-CONTROL-E.
   113     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   114     12  FILLER                       PIC  X(02) VALUE 'SC'.
   115     12  SC-QUID-KEY.
   116         16  SC-QUID-TERMINAL         PIC  X(04).
   117         16  SC-QUID-SYSTEM           PIC  X(04).
   118     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   119     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   120     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   121         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   122         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   123     12  SC-MP-CODES.
   124         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   125             20  SC-MP-DISPLAY        PIC  X(01).
   126             20  SC-MP-UPDATE         PIC  X(01).
   127     12  FILLER                       PIC  X(40).
   128
   129 01  WS-DATE-AREA.
   130     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   131     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   132
   133 01  WS.
   134     05  W-APPL-SCRTY-NDX    PIC S9(04) COMP   VALUE +29.
   135     05  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   136     05  WS-COMM-LENGTH      PIC S9(4) COMP VALUE +1500.
   137     05  WS-MAP-LENGTH       PIC S9(4) COMP VALUE +500.
   138     05  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   139     05  QID.
   140         16  QID-TERM        PIC X(4).
   141         16  FILLER          PIC X(4)    VALUE '106A'.
   142
   143     05  WS-ST-TOL-PREM-PCT  PIC S9V9(4)    VALUE +0.
   144     05  WS-ST-TOL-REF-PCT   PIC S9V9(4)    VALUE +0.
   145     05  WS-ST-OVR-SHT-PCT   PIC S9V9(4)    VALUE +0.
   146     05  WS-ST-LF-PREM-TAX   PIC S9V9(4)    VALUE +0.
   147     05  WS-ST-AH-PREM-TAX-I PIC S9V9(4)    VALUE +0.
   148     05  WS-ST-AH-PREM-TAX-G PIC S9V9(4)    VALUE +0.
   149     05  WS-ST-LF-EXP-PCT    PIC S9(3)V9(4) VALUE +0.
   150     05  WS-ST-AH-EXP-PCT    PIC S9(3)V9(4) VALUE +0.
   151     05  WS-ST-TARGET-LOSS-RATIO
   152                             PIC S9V9(4)    VALUE +0.
   153     05  WS-ST-CALC-INTEREST PIC S9V9(4)    VALUE +0.
   154     05  WS-COMSL            PIC S9V9(4)    VALUE +0.
   155     05  WS-COMJL            PIC S9V9(4)    VALUE +0.
   156     05  WS-COMSA            PIC S9V9(4)    VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL106.cbl
   157     05  WS-COMJA            PIC S9V9(4)    VALUE +0.
   158     05  WS-RESIDENT-TAX     PIC S9V9(4)    VALUE +0.
   159     05  WS-IRATE            PIC S9V9(4)    VALUE +0.
   160     05  WS-IRATE1           PIC S9V9(4)    VALUE +0.
   161     05  WS-IRATE2           PIC S9V9(4)    VALUE +0.
   162     05  WS-IRATE3           PIC S9V9(4)    VALUE +0.
   163     05  WS-FREE-LOOK-DAYS   PIC S9(3)      VALUE +0.
   164
   165 01  STANDARD-AREAS.
   166     12  MAP-NAME            PIC X(8)    VALUE 'EL106A'.
   167     12  MAPSET-NAME         PIC X(8)    VALUE 'EL106S'.
   168     12  TRANS-ID            PIC X(4)    VALUE 'EX10'.
   169     12  PGM-NAME            PIC X(8).
   170     12  TIME-IN             PIC S9(7).
   171     12  TIME-OUT-R  REDEFINES TIME-IN.
   172         16  FILLER          PIC X.
   173         16  TIME-OUT        PIC 99V99.
   174         16  FILLER          PIC XX.
   175     12  XCTL-EL005          PIC X(8)    VALUE 'EL005'.
   176     12  XCTL-EL010          PIC X(8)    VALUE 'EL010'.
   177     12  XCTL-EL126          PIC X(8)    VALUE 'EL126'.
   178     12  XCTL-EL626          PIC X(8)    VALUE 'EL626'.
   179     12  XCTL-EL6565         PIC X(8)    VALUE 'EL6565'.
   180     12  XCTL-EL6507         PIC X(8)    VALUE 'EL6507'.
   181     12  XCTL-EL1061         PIC X(8)    VALUE 'EL1061'.
   182     12  XCTL-EM626          PIC X(8)    VALUE 'EM626'.
   183     12  XCTL-GL800          PIC X(8)    VALUE 'GL800'.
   184     12  LINK-EL001          PIC X(8)    VALUE 'EL001'.
   185     12  LINK-EL004          PIC X(8)    VALUE 'EL004'.
   186     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   187     12  THIS-PGM            PIC X(8)    VALUE 'EL106'.
   188     12  ELCNTL-ID           PIC X(8)    VALUE 'ELCNTL'.
   189     12  ELLETR-ID           PIC X(8)    VALUE 'ELLETR'.
   190     12  SUB                 PIC S9(4)   COMP.
   191     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   192     12  WS-FIRST-TIME-SW    PIC X       VALUE 'Y'.
   193         88  FIRST-TIME                  VALUE 'Y'.
   194     12  WS-DISPLAY-SW       PIC X       VALUE 'N'.
   195         88  RETURN-DISPLAY              VALUE 'Y'.
   196
   197 01  ACCESS-KEYS.
   198     12  ELCNTL-KEY.
   199         16  CK-COMP-ID      PIC X(3).
   200         16  FILLER          PIC X       VALUE '3'.
   201         16  CK-STATE-CD     PIC X(4)    VALUE SPACES.
   202         16  CK-SEQ          PIC S9(4)   VALUE +0    COMP.
   203     12  W-WORKING-TEXT-KEY.
   204         16  W-TEXT-COMPANY-CD
   205                             PIC X.
   206         16  W-TEXT-FORM-NO  PIC X(12).
   207         16  W-TEXT-LINE-SEQ PIC S9(4)   COMP.
   208
   209 01  ERROR-MESSAGES.
   210     12  ER-0000                 PIC X(4)  VALUE '0000'.
   211     12  ER-0004                 PIC X(4)  VALUE '0004'.
   212     12  ER-0013                 PIC X(4)  VALUE '0013'.
   213     12  ER-0023                 PIC X(4)  VALUE '0023'.
   214     12  ER-0029                 PIC X(4)  VALUE '0029'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL106.cbl
   215     12  ER-0042                 PIC X(4)  VALUE '0042'.
   216     12  ER-0050                 PIC X(4)  VALUE '0050'.
   217     12  ER-0068                 PIC X(4)  VALUE '0068'.
   218     12  ER-0070                 PIC X(4)  VALUE '0070'.
   219     12  ER-0141                 PIC X(4)  VALUE '0141'.
   220     12  ER-0144                 PIC X(4)  VALUE '0144'.
   221     12  ER-0145                 PIC X(4)  VALUE '0145'.
   222     12  ER-0146                 PIC X(4)  VALUE '0146'.
   223     12  ER-0147                 PIC X(4)  VALUE '0147'.
   224     12  ER-0148                 PIC X(4)  VALUE '0148'.
   225     12  ER-0149                 PIC X(4)  VALUE '0149'.
   226     12  ER-0150                 PIC X(4)  VALUE '0150'.
   227     12  ER-0151                 PIC X(4)  VALUE '0151'.
   228     12  ER-0152                 PIC X(4)  VALUE '0152'.
   229     12  ER-0153                 PIC X(4)  VALUE '0153'.
   230     12  ER-0159                 PIC X(4)  VALUE '0159'.
   231     12  ER-0160                 PIC X(4)  VALUE '0160'.
   232     12  ER-0161                 PIC X(4)  VALUE '0161'.
   233     12  ER-0582                 PIC X(4)  VALUE '0582'.
   234     12  ER-0805                 PIC X(4)  VALUE '0805'.
   235     12  ER-1614                 PIC X(4)  VALUE '1614'.
   236     12  ER-2009                 PIC X(4)  VALUE '2009'.
   237     12  ER-2010                 PIC X(4)  VALUE '2010'.
   238     12  ER-2012                 PIC X(4)  VALUE '2012'.
   239     12  ER-2014                 PIC X(4)  VALUE '2014'.
   240     12  ER-2024                 PIC X(4)  VALUE '2024'.
   241     12  ER-2028                 PIC X(4)  VALUE '2028'.
   242     12  ER-2032                 PIC X(4)  VALUE '2032'.
   243     12  ER-2033                 PIC X(4)  VALUE '2033'.
   244     12  ER-2082                 PIC X(4)  VALUE '2082'.
   245     12  ER-2084                 PIC X(4)  VALUE '2084'.
   246     12  ER-2137                 PIC X(4)  VALUE '2137'.
   247     12  ER-2298                 PIC X(4)  VALUE '2298'.
   248     12  ER-2299                 PIC X(4)  VALUE '2299'.
   249     12  ER-3030                 PIC X(4)  VALUE '3030'.
   250     12  ER-3031                 PIC X(4)  VALUE '3031'.
   251     12  ER-3032                 PIC X(4)  VALUE '3032'.
   252     12  ER-3033                 PIC X(4)  VALUE '3033'.
   253     12  ER-3034                 PIC X(4)  VALUE '3034'.
   254     12  ER-3035                 PIC X(4)  VALUE '3035'.
   255     12  ER-3036                 PIC X(4)  VALUE '3036'.
   256     12  ER-3040                 PIC X(4)  VALUE '3040'.
   257     12  ER-7008                 PIC X(4)  VALUE '7008'.
   258     12  ER-7346                 PIC X(4)  VALUE '7346'.
   259     12  ER-7531                 PIC X(4)  VALUE '7531'.
   260     12  ER-7532                 PIC X(4)  VALUE '7532'.
   261     12  ER-7536                 PIC X(4)  VALUE '7536'.
   262     12  ER-7717                 PIC X(4)  VALUE '7717'.
   263     12  ER-7735                 PIC X(4)  VALUE '7735'.
   264     12  ER-8159                 PIC X(4)  VALUE '8159'.
   265     12  ER-9074                 PIC X(4)  VALUE '9074'.
   266     12  ER-9097                 PIC X(4)  VALUE '9097'.
   267     12  ER-9447                 PIC X(4)  VALUE '9447'.
   268     12  ER-9448                 PIC X(4)  VALUE '9448'.
   269     12  ER-9478                 PIC X(4)  VALUE '9478'.
   270     12  ER-9999                 PIC X(4)  VALUE '9999'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL106.cbl
   272*    COPY ELCDATE.
   273******************************************************************
   274*                                                                *
   275*                                                                *
   276*                            ELCDATE.                            *
   277*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   278*                            VMOD=2.003
   279*                                                                *
   280*                                                                *
   281*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   282*                 LENGTH = 200                                   *
   283******************************************************************
   284
   285 01  DATE-CONVERSION-DATA.
   286     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   287     12  DC-OPTION-CODE                PIC X.
   288         88  BIN-TO-GREG                VALUE ' '.
   289         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   290         88  EDIT-GREG-TO-BIN           VALUE '2'.
   291         88  YMD-GREG-TO-BIN            VALUE '3'.
   292         88  MDY-GREG-TO-BIN            VALUE '4'.
   293         88  JULIAN-TO-BIN              VALUE '5'.
   294         88  BIN-PLUS-ELAPSED           VALUE '6'.
   295         88  FIND-CENTURY               VALUE '7'.
   296         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   297         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   298         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   299         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   300         88  JULIAN-TO-BIN-3            VALUE 'C'.
   301         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   302         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   303         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   304         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   305         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   306         88  CHECK-LEAP-YEAR            VALUE 'H'.
   307         88  BIN-3-TO-GREG              VALUE 'I'.
   308         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   309         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   310         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   311         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   312         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   313         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   314         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   315         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   316         88  THREE-CHARACTER-BIN
   317                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   318         88  GREGORIAN-TO-BIN
   319                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   320         88  BIN-TO-GREGORIAN
   321                  VALUES ' ' '1' 'I' '8' 'G'.
   322         88  JULIAN-TO-BINARY
   323                  VALUES '5' 'C' 'E' 'F'.
   324     12  DC-ERROR-CODE                 PIC X.
   325         88  NO-CONVERSION-ERROR        VALUE ' '.
   326         88  DATE-CONVERSION-ERROR
   327                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   328         88  DATE-IS-ZERO               VALUE '1'.
   329         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL106.cbl
   330         88  DATE-IS-INVALID            VALUE '3'.
   331         88  DATE1-GREATER-DATE2        VALUE '4'.
   332         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   333         88  DATE-INVALID-OPTION        VALUE '9'.
   334         88  INVALID-CENTURY            VALUE 'A'.
   335         88  ONLY-CENTURY               VALUE 'B'.
   336         88  ONLY-LEAP-YEAR             VALUE 'C'.
   337         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   338     12  DC-END-OF-MONTH               PIC X.
   339         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   340     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   341         88  USE-NORMAL-PROCESS         VALUE ' '.
   342         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   343         88  ADJUST-UP-100-YRS          VALUE '2'.
   344     12  FILLER                        PIC X.
   345     12  DC-CONVERSION-DATES.
   346         16  DC-BIN-DATE-1             PIC XX.
   347         16  DC-BIN-DATE-2             PIC XX.
   348         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   349         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   350                       DC-GREG-DATE-1-EDIT.
   351             20  DC-EDIT1-MONTH        PIC 99.
   352             20  SLASH1-1              PIC X.
   353             20  DC-EDIT1-DAY          PIC 99.
   354             20  SLASH1-2              PIC X.
   355             20  DC-EDIT1-YEAR         PIC 99.
   356         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   357         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   358                     DC-GREG-DATE-2-EDIT.
   359             20  DC-EDIT2-MONTH        PIC 99.
   360             20  SLASH2-1              PIC X.
   361             20  DC-EDIT2-DAY          PIC 99.
   362             20  SLASH2-2              PIC X.
   363             20  DC-EDIT2-YEAR         PIC 99.
   364         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   365         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   366                     DC-GREG-DATE-1-YMD.
   367             20  DC-YMD-YEAR           PIC 99.
   368             20  DC-YMD-MONTH          PIC 99.
   369             20  DC-YMD-DAY            PIC 99.
   370         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   371         16  DC-GREG-DATE-1-MDY-R REDEFINES
   372                      DC-GREG-DATE-1-MDY.
   373             20  DC-MDY-MONTH          PIC 99.
   374             20  DC-MDY-DAY            PIC 99.
   375             20  DC-MDY-YEAR           PIC 99.
   376         16  DC-GREG-DATE-1-ALPHA.
   377             20  DC-ALPHA-MONTH        PIC X(10).
   378             20  DC-ALPHA-DAY          PIC 99.
   379             20  FILLER                PIC XX.
   380             20  DC-ALPHA-CENTURY.
   381                 24 DC-ALPHA-CEN-N     PIC 99.
   382             20  DC-ALPHA-YEAR         PIC 99.
   383         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   384         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   385         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   386         16  DC-JULIAN-DATE            PIC 9(05).
   387         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL106.cbl
   388                                       PIC 9(05).
   389         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   390             20  DC-JULIAN-YEAR        PIC 99.
   391             20  DC-JULIAN-DAYS        PIC 999.
   392         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   393         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   394         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   395     12  DATE-CONVERSION-VARIBLES.
   396         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   397         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   398             20  FILLER                PIC 9(3).
   399             20  HOLD-CEN-1-CCYY.
   400                 24  HOLD-CEN-1-CC     PIC 99.
   401                 24  HOLD-CEN-1-YY     PIC 99.
   402             20  HOLD-CEN-1-MO         PIC 99.
   403             20  HOLD-CEN-1-DA         PIC 99.
   404         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   405             20  HOLD-CEN-1-R-MO       PIC 99.
   406             20  HOLD-CEN-1-R-DA       PIC 99.
   407             20  HOLD-CEN-1-R-CCYY.
   408                 24  HOLD-CEN-1-R-CC   PIC 99.
   409                 24  HOLD-CEN-1-R-YY   PIC 99.
   410             20  FILLER                PIC 9(3).
   411         16  HOLD-CENTURY-1-X.
   412             20  FILLER                PIC X(3)  VALUE SPACES.
   413             20  HOLD-CEN-1-X-CCYY.
   414                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   415                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   416             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   417             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   418         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   419             20  HOLD-CEN-1-R-X-MO     PIC XX.
   420             20  HOLD-CEN-1-R-X-DA     PIC XX.
   421             20  HOLD-CEN-1-R-X-CCYY.
   422                 24  HOLD-CEN-1-R-X-CC PIC XX.
   423                 24  HOLD-CEN-1-R-X-YY PIC XX.
   424             20  FILLER                PIC XXX.
   425         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   426         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   427         16  DC-JULIAN-DATE-1          PIC 9(07).
   428         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   429             20  DC-JULIAN-1-CCYY.
   430                 24  DC-JULIAN-1-CC    PIC 99.
   431                 24  DC-JULIAN-1-YR    PIC 99.
   432             20  DC-JULIAN-DA-1        PIC 999.
   433         16  DC-JULIAN-DATE-2          PIC 9(07).
   434         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   435             20  DC-JULIAN-2-CCYY.
   436                 24  DC-JULIAN-2-CC    PIC 99.
   437                 24  DC-JULIAN-2-YR    PIC 99.
   438             20  DC-JULIAN-DA-2        PIC 999.
   439         16  DC-GREG-DATE-A-EDIT.
   440             20  DC-EDITA-MONTH        PIC 99.
   441             20  SLASHA-1              PIC X VALUE '/'.
   442             20  DC-EDITA-DAY          PIC 99.
   443             20  SLASHA-2              PIC X VALUE '/'.
   444             20  DC-EDITA-CCYY.
   445                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL106.cbl
   446                 24  DC-EDITA-YEAR     PIC 99.
   447         16  DC-GREG-DATE-B-EDIT.
   448             20  DC-EDITB-MONTH        PIC 99.
   449             20  SLASHB-1              PIC X VALUE '/'.
   450             20  DC-EDITB-DAY          PIC 99.
   451             20  SLASHB-2              PIC X VALUE '/'.
   452             20  DC-EDITB-CCYY.
   453                 24  DC-EDITB-CENT     PIC 99.
   454                 24  DC-EDITB-YEAR     PIC 99.
   455         16  DC-GREG-DATE-CYMD         PIC 9(08).
   456         16  DC-GREG-DATE-CYMD-R REDEFINES
   457                              DC-GREG-DATE-CYMD.
   458             20  DC-CYMD-CEN           PIC 99.
   459             20  DC-CYMD-YEAR          PIC 99.
   460             20  DC-CYMD-MONTH         PIC 99.
   461             20  DC-CYMD-DAY           PIC 99.
   462         16  DC-GREG-DATE-MDCY         PIC 9(08).
   463         16  DC-GREG-DATE-MDCY-R REDEFINES
   464                              DC-GREG-DATE-MDCY.
   465             20  DC-MDCY-MONTH         PIC 99.
   466             20  DC-MDCY-DAY           PIC 99.
   467             20  DC-MDCY-CEN           PIC 99.
   468             20  DC-MDCY-YEAR          PIC 99.
   469    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   470        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   471    12  DC-EL310-DATE                  PIC X(21).
   472    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL106.cbl
   474*    COPY ELCLOGOF.
   475******************************************************************
   476*                                                                *
   477*                                                                *
   478*                            ELCLOGOF.                           *
   479*                            VMOD=2.001                          *
   480*                                                                *
   481*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   482*                                                                *
   483******************************************************************
   484 01  CLASIC-LOGOFF.
   485     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   486     12  LOGOFF-TEXT.
   487         16  FILLER          PIC X(5)    VALUE SPACES.
   488         16  LOGOFF-MSG.
   489             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   490             20  FILLER      PIC X       VALUE SPACES.
   491             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   492         16  FILLER          PIC X(80)
   493           VALUE '* YOU ARE NOW LOGGED OFF'.
   494         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   495         16  FILLER          PIC X       VALUE QUOTE.
   496         16  LOGOFF-SYS-MSG  PIC X(17)
   497           VALUE 'S CLAS-IC SYSTEM '.
   498     12  TEXT-MESSAGES.
   499         16  UNACCESS-MSG    PIC X(29)
   500             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   501         16  PGMIDERR-MSG    PIC X(17)
   502             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL106.cbl
   504*    COPY ELCATTR.
   505******************************************************************
   506*                                                                *
   507*                            ELCATTR.                            *
   508*                            VMOD=2.001                          *
   509*                                                                *
   510*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   511*                                                                *
   512*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   513*                                                                *
   514*                   POS 1   P=PROTECTED                          *
   515*                           U=UNPROTECTED                        *
   516*                           S=ASKIP                              *
   517*                   POS 2   A=ALPHA/NUMERIC                      *
   518*                           N=NUMERIC                            *
   519*                   POS 3   N=NORMAL                             *
   520*                           B=BRIGHT                             *
   521*                           D=DARK                               *
   522*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   523*                           OF=MODIFIED DATA TAG OFF             *
   524*                                                                *
   525*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   526******************************************************************
   527 01  ATTRIBUTE-LIST.
   528     12  AL-PABOF            PIC X       VALUE 'Y'.
   529     12  AL-PABON            PIC X       VALUE 'Z'.
   530     12  AL-PADOF            PIC X       VALUE '%'.
   531     12  AL-PADON            PIC X       VALUE '_'.
   532     12  AL-PANOF            PIC X       VALUE '-'.
   533     12  AL-PANON            PIC X       VALUE '/'.
   534     12  AL-SABOF            PIC X       VALUE '8'.
   535     12  AL-SABON            PIC X       VALUE '9'.
   536     12  AL-SADOF            PIC X       VALUE '@'.
   537     12  AL-SADON            PIC X       VALUE QUOTE.
   538     12  AL-SANOF            PIC X       VALUE '0'.
   539     12  AL-SANON            PIC X       VALUE '1'.
   540     12  AL-UABOF            PIC X       VALUE 'H'.
   541     12  AL-UABON            PIC X       VALUE 'I'.
   542     12  AL-UADOF            PIC X       VALUE '<'.
   543     12  AL-UADON            PIC X       VALUE '('.
   544     12  AL-UANOF            PIC X       VALUE ' '.
   545     12  AL-UANON            PIC X       VALUE 'A'.
   546     12  AL-UNBOF            PIC X       VALUE 'Q'.
   547     12  AL-UNBON            PIC X       VALUE 'R'.
   548     12  AL-UNDOF            PIC X       VALUE '*'.
   549     12  AL-UNDON            PIC X       VALUE ')'.
   550     12  AL-UNNOF            PIC X       VALUE '&'.
   551     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL106.cbl
   553*    COPY ELCEMIB.
   554******************************************************************
   555*                                                                *
   556*                                                                *
   557*                            ELCEMIB.                            *
   558*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   559*                            VMOD=2.005                          *
   560*                                                                *
   561*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   562*                                                                *
   563******************************************************************
   564 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   565     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   566     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   567     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   568     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   569     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   570     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   571     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   572     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   573     12  EMI-SWITCH1             PIC X        VALUE '1'.
   574         88  EMI-NO-ERRORS                    VALUE '1'.
   575         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   576         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   577     12  EMI-SWITCH2             PIC X        VALUE '1'.
   578         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   579     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   580         88  EMI-AREA1-EMPTY                  VALUE '1'.
   581         88  EMI-AREA1-FULL                   VALUE '2'.
   582     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   583         88  EMI-AREA2-EMPTY                  VALUE '1'.
   584         88  EMI-AREA2-FULL                   VALUE '2'.
   585     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   586         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   587         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   588         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   589         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   590         88  EMI-BYPASS-FATALS                VALUE 'X'.
   591     12  EMI-ERROR-LINES.
   592         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   593         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   594         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   595         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   596             20  EMI-ERR-CODES OCCURS 10 TIMES.
   597                 24  EMI-ERR-NUM         PIC X(4).
   598                 24  EMI-FILLER          PIC X.
   599                 24  EMI-SEV             PIC X.
   600                 24  FILLER              PIC X.
   601             20  FILLER                  PIC X(02).
   602     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   603         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   604             20  EMI-ERROR-NUMBER    PIC X(4).
   605             20  EMI-FILL            PIC X.
   606             20  EMI-SEVERITY        PIC X.
   607             20  FILLER              PIC X.
   608             20  EMI-ERROR-TEXT.
   609                 24  EMI-TEXT-VARIABLE   PIC X(10).
   610                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL106.cbl
   611     12  EMI-SEVERITY-SAVE           PIC X.
   612         88  EMI-NOTE                    VALUE 'N'.
   613         88  EMI-WARNING                 VALUE 'W'.
   614         88  EMI-FORCABLE                VALUE 'F'.
   615         88  EMI-FATAL                   VALUE 'X'.
   616     12  EMI-MESSAGE-FLAG            PIC X.
   617         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   618         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   619     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   620     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   621         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   622         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   623         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   624     12  FILLER                      PIC X(137)  VALUE SPACES.
   625     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   626     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   627     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   628     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL106.cbl
   630*    COPY ELCJPFX.
   631******************************************************************
   632*                                                                *
   633*                                                                *
   634*                            ELCJPFX.                            *
   635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   636*                            VMOD=2.002                          *
   637*                                                                *
   638*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   639*                                                                *
   640*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   641*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   642*        ELCNTL - CONTROL FILE                                   *
   643*        ELMSTR - CLAIM MASTERS                                  *
   644*        ELTRLR - ACTIVITY TRAILERS                              *
   645*        ELCHKQ - CHECK QUE                                      *
   646******************************************************************
   647 01  JOURNAL-RECORD.
   648     12  JP-USER-ID                  PIC X(4).
   649     12  JP-FILE-ID                  PIC X(8).
   650     12  JP-PROGRAM-ID               PIC X(8).
   651     12  JP-RECORD-TYPE              PIC X.
   652         88 JP-ADD              VALUE 'A'.
   653         88 JP-BEFORE-CHANGE    VALUE 'B'.
   654         88 JP-AFTER-CHANGE     VALUE 'C'.
   655         88 JP-DELETE           VALUE 'D'.
   656         88 JP-GENERIC-DELETE   VALUE 'G'.
   657         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   658         88 JP-KEY-CHG-ADD      VALUE 'N'.
   659     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   660     12  JP-RECORD-AREA
   661
   662
   663             PIC X(530).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL106.cbl
   665*    COPY ELCINTF.
   666******************************************************************
   667*                                                                *
   668*                                                                *
   669*                            ELCINTF.                            *
   670*                            VMOD=2.017                          *
   671*                                                                *
   672*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   673*                                                                *
   674*       LENGTH = 1024                                            *
   675*                                                                *
   676******************************************************************
   677 01  PROGRAM-INTERFACE-BLOCK.
   678     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   679     12  PI-CALLING-PROGRAM              PIC X(8).
   680     12  PI-SAVED-PROGRAM-1              PIC X(8).
   681     12  PI-SAVED-PROGRAM-2              PIC X(8).
   682     12  PI-SAVED-PROGRAM-3              PIC X(8).
   683     12  PI-SAVED-PROGRAM-4              PIC X(8).
   684     12  PI-SAVED-PROGRAM-5              PIC X(8).
   685     12  PI-SAVED-PROGRAM-6              PIC X(8).
   686     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   687     12  PI-COMPANY-ID                   PIC XXX.
   688     12  PI-COMPANY-CD                   PIC X.
   689
   690     12  PI-COMPANY-PASSWORD             PIC X(8).
   691
   692     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   693
   694     12  PI-CONTROL-IN-PROGRESS.
   695         16  PI-CARRIER                  PIC X.
   696         16  PI-GROUPING                 PIC X(6).
   697         16  PI-STATE                    PIC XX.
   698         16  PI-ACCOUNT                  PIC X(10).
   699         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   700                                         PIC X(10).
   701         16  PI-CLAIM-CERT-GRP.
   702             20  PI-CLAIM-NO             PIC X(7).
   703             20  PI-CERT-NO.
   704                 25  PI-CERT-PRIME       PIC X(10).
   705                 25  PI-CERT-SFX         PIC X.
   706             20  PI-CERT-EFF-DT          PIC XX.
   707         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   708             20  PI-PLAN-CODE            PIC X(2).
   709             20  PI-REVISION-NUMBER      PIC X(3).
   710             20  PI-PLAN-EFF-DT          PIC X(2).
   711             20  PI-PLAN-EXP-DT          PIC X(2).
   712             20  FILLER                  PIC X(11).
   713         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   714             20  PI-OE-REFERENCE-1.
   715                 25  PI-OE-REF-1-PRIME   PIC X(18).
   716                 25  PI-OE-REF-1-SUFF    PIC XX.
   717
   718     12  PI-SESSION-IN-PROGRESS          PIC X.
   719         88  CLAIM-SESSION                   VALUE '1'.
   720         88  CREDIT-SESSION                  VALUE '2'.
   721         88  WARRANTY-SESSION                VALUE '3'.
   722         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL106.cbl
   723         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   724
   725
   726*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   727
   728     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   729     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   730
   731     12  PI-CREDIT-USER                  PIC X.
   732         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   733         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   734
   735     12  PI-CLAIM-USER                   PIC X.
   736         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   737         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   738
   739     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   740         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   741         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   742         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   743         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   744         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   745
   746     12  PI-PROCESSOR-ID                 PIC X(4).
   747
   748     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   749
   750     12  PI-MEMBER-CAPTION               PIC X(10).
   751
   752     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   753         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   754
   755     12  PI-LIFE-OVERRIDE-L1             PIC X.
   756     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   757     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   758     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   759
   760     12  PI-AH-OVERRIDE-L1               PIC X.
   761     12  PI-AH-OVERRIDE-L2               PIC XX.
   762     12  PI-AH-OVERRIDE-L6               PIC X(6).
   763     12  PI-AH-OVERRIDE-L12              PIC X(12).
   764
   765     12  PI-NEW-SYSTEM                   PIC X(2).
   766
   767     12  PI-PRIMARY-CERT-NO              PIC X(11).
   768     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   769         88  PI-USES-PAID-TO                 VALUE '1'.
   770     12  PI-CRDTCRD-SYSTEM.
   771         16  PI-CRDTCRD-USER             PIC X.
   772             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   773             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   774         16  PI-CC-MONTH-END-DT          PIC XX.
   775     12  PI-PROCESSOR-PRINTER            PIC X(4).
   776
   777     12  PI-OE-REFERENCE-2.
   778         16  PI-OE-REF-2-PRIME           PIC X(10).
   779         16  PI-OE-REF-2-SUFF            PIC X.
   780
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL106.cbl
   781     12  PI-REM-TRM-CALC-OPTION          PIC X.
   782
   783     12  PI-LANGUAGE-TYPE                PIC X.
   784             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   785             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   786             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   787
   788     12  PI-POLICY-LINKAGE-IND           PIC X.
   789         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   790         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   791                                                   LOW-VALUES.
   792
   793     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   794     12  PI-CLAIM-PW-SESSION             PIC X(1).
   795         88  PI-CLAIM-CREDIT                 VALUE '1'.
   796         88  PI-CLAIM-CONVEN                 VALUE '2'.
   797     12  FILLER                          PIC X(4).
   798
   799     12  PI-SYSTEM-LEVEL                 PIC X(145).
   800
   801     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   802         PI-SYSTEM-LEVEL.
   803
   804         16  PI-ENTRY-CODES.
   805             20  PI-ENTRY-CD-1           PIC X.
   806             20  PI-ENTRY-CD-2           PIC X.
   807
   808         16  PI-RETURN-CODES.
   809             20  PI-RETURN-CD-1          PIC X.
   810             20  PI-RETURN-CD-2          PIC X.
   811
   812         16  PI-UPDATE-STATUS-SAVE.
   813             20  PI-UPDATE-BY            PIC X(4).
   814             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   815
   816         16  PI-LOWER-CASE-LETTERS       PIC X.
   817             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   818
   819*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   820*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   821*            88  CARRIER-CLM-CNTL            VALUE '2'.
   822
   823         16  PI-CERT-ACCESS-CONTROL      PIC X.
   824             88  ST-ACCNT-CNTL               VALUE ' '.
   825             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   826             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   827             88  ACCNT-CNTL                  VALUE '3'.
   828             88  CARR-ACCNT-CNTL             VALUE '4'.
   829
   830         16  PI-PROCESSOR-CAP-LIST.
   831             20  PI-SYSTEM-CONTROLS.
   832                24 PI-SYSTEM-DISPLAY     PIC X.
   833                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   834                24 PI-SYSTEM-MODIFY      PIC X.
   835                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   836             20  FILLER                  PIC XX.
   837             20  PI-DISPLAY-CAP          PIC X.
   838                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL106.cbl
   839             20  PI-MODIFY-CAP           PIC X.
   840                 88  MODIFY-CAP              VALUE 'Y'.
   841             20  PI-MSG-AT-LOGON-CAP     PIC X.
   842                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   843             20  PI-FORCE-CAP            PIC X.
   844                 88  FORCE-CAP               VALUE 'Y'.
   845
   846         16  PI-PROGRAM-CONTROLS.
   847             20  PI-PGM-PRINT-OPT        PIC X.
   848             20  PI-PGM-FORMAT-OPT       PIC X.
   849             20  PI-PGM-PROCESS-OPT      PIC X.
   850             20  PI-PGM-TOTALS-OPT       PIC X.
   851
   852         16  PI-HELP-INTERFACE.
   853             20  PI-LAST-ERROR-NO        PIC X(4).
   854             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   855
   856         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   857             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   858
   859         16  PI-CR-CONTROL-IN-PROGRESS.
   860             20  PI-CR-CARRIER           PIC X.
   861             20  PI-CR-GROUPING          PIC X(6).
   862             20  PI-CR-STATE             PIC XX.
   863             20  PI-CR-ACCOUNT           PIC X(10).
   864             20  PI-CR-FIN-RESP          PIC X(10).
   865             20  PI-CR-TYPE              PIC X.
   866
   867         16  PI-CR-BATCH-NUMBER          PIC X(6).
   868
   869         16  PI-CR-MONTH-END-DT          PIC XX.
   870
   871         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   872             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   873             88  PI-ZERO-CARRIER             VALUE '1'.
   874             88  PI-ZERO-GROUPING            VALUE '2'.
   875             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   876
   877         16  PI-CARRIER-SECURITY         PIC X.
   878             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   879
   880         16  PI-ACCOUNT-SECURITY         PIC X(10).
   881             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   882             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   883
   884         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   885             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   886                                         INDEXED BY PI-ACCESS-NDX
   887                                         PIC X.
   888
   889         16  PI-GA-BILLING-CONTROL       PIC X.
   890             88  PI-GA-BILLING               VALUE '1'.
   891
   892         16  PI-MAIL-PROCESSING          PIC X.
   893             88  PI-MAIL-YES                 VALUE 'Y'.
   894
   895         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   896
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL106.cbl
   897         16  PI-AR-SYSTEM.
   898             20  PI-AR-PROCESSING-CNTL   PIC X.
   899                 88  PI-AR-PROCESSING        VALUE 'Y'.
   900             20  PI-AR-SUMMARY-CODE      PIC X(6).
   901             20  PI-AR-MONTH-END-DT      PIC XX.
   902
   903         16  PI-MP-SYSTEM.
   904             20  PI-MORTGAGE-USER            PIC X.
   905                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   906                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   907             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   908                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   909                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   910                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   911                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   912                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   913             20  PI-MP-MONTH-END-DT          PIC XX.
   914             20  PI-MP-REFERENCE-NO.
   915                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   916                 24  PI-MP-REFERENCE-SFX     PIC XX.
   917
   918         16  PI-LABEL-CONTROL            PIC X(01).
   919             88  PI-CREATE-LABELS                    VALUE 'Y'.
   920             88  PI-BYPASS-LABELS                    VALUE 'N'.
   921
   922         16  PI-BILL-GROUPING-CODE       PIC X(01).
   923             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   924
   925         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   926             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   927             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   928
   929         16  FILLER                      PIC X(14).
   930
   931     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   932******************************************************************
   933     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   934         16  FILLER              PIC X(101).
   935         16  PI-WS-STATE         PIC XX.
   936         16  PI-WS-CLASS         PIC XX.
   937         16  PI-WS-DEV           PIC XXX.
   938         16  PI-WS-TYPE          PIC X.
   939         16  PI-WS-PLAN          PIC XX.
   940         16  PI-PREV-STATE       PIC X(4).
   941         16  FILLER              PIC X(525).
   942
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL106.cbl
   944*    COPY ELCAID.
   945******************************************************************
   946*                                                                *
   947*                            ELCAID.                             *
   948*                            VMOD=2.001                          *
   949*                                                                *
   950*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   951*                                                                *
   952*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   953*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   954******************************************************************
   955
   956 01  DFHAID.
   957   02  DFHNULL   PIC  X  VALUE  ' '.
   958   02  DFHENTER  PIC  X  VALUE  QUOTE.
   959   02  DFHCLEAR  PIC  X  VALUE  '_'.
   960   02  DFHPEN    PIC  X  VALUE  '='.
   961   02  DFHOPID   PIC  X  VALUE  'W'.
   962   02  DFHPA1    PIC  X  VALUE  '%'.
   963   02  DFHPA2    PIC  X  VALUE  '>'.
   964   02  DFHPA3    PIC  X  VALUE  ','.
   965   02  DFHPF1    PIC  X  VALUE  '1'.
   966   02  DFHPF2    PIC  X  VALUE  '2'.
   967   02  DFHPF3    PIC  X  VALUE  '3'.
   968   02  DFHPF4    PIC  X  VALUE  '4'.
   969   02  DFHPF5    PIC  X  VALUE  '5'.
   970   02  DFHPF6    PIC  X  VALUE  '6'.
   971   02  DFHPF7    PIC  X  VALUE  '7'.
   972   02  DFHPF8    PIC  X  VALUE  '8'.
   973   02  DFHPF9    PIC  X  VALUE  '9'.
   974   02  DFHPF10   PIC  X  VALUE  ':'.
   975   02  DFHPF11   PIC  X  VALUE  '#'.
   976   02  DFHPF12   PIC  X  VALUE  '@'.
   977   02  DFHPF13   PIC  X  VALUE  'A'.
   978   02  DFHPF14   PIC  X  VALUE  'B'.
   979   02  DFHPF15   PIC  X  VALUE  'C'.
   980   02  DFHPF16   PIC  X  VALUE  'D'.
   981   02  DFHPF17   PIC  X  VALUE  'E'.
   982   02  DFHPF18   PIC  X  VALUE  'F'.
   983   02  DFHPF19   PIC  X  VALUE  'G'.
   984   02  DFHPF20   PIC  X  VALUE  'H'.
   985   02  DFHPF21   PIC  X  VALUE  'I'.
   986*00039    02  DFHPF22   PIC  X  VALUE  ''.
   987   02  DFHPF22   PIC  X  VALUE  '['.
   988   02  DFHPF23   PIC  X  VALUE  '.'.
   989   02  DFHPF24   PIC  X  VALUE  '<'.
   990   02  DFHMSRE   PIC  X  VALUE  'X'.
   991   02  DFHSTRF   PIC  X  VALUE  'h'.
   992   02  DFHTRIG   PIC  X  VALUE  '"'.
   993 01  FILLER REDEFINES DFHAID.
   994     12  FILLER              PIC X(8).
   995     12  PF-VALUES           PIC X       OCCURS 2.
   996
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL106.cbl
   998*    COPY EL106S.
   999 01  EL106AI.
  1000     05  FILLER            PIC  X(0012).
  1001*    -------------------------------
  1002     05  RUNDTEL PIC S9(0004) COMP.
  1003     05  RUNDTEF PIC  X(0001).
  1004     05  FILLER REDEFINES RUNDTEF.
  1005         10  RUNDTEA PIC  X(0001).
  1006     05  RUNDTEI PIC  X(0008).
  1007*    -------------------------------
  1008     05  RUNTIMEL PIC S9(0004) COMP.
  1009     05  RUNTIMEF PIC  X(0001).
  1010     05  FILLER REDEFINES RUNTIMEF.
  1011         10  RUNTIMEA PIC  X(0001).
  1012     05  RUNTIMEI PIC  X(0005).
  1013*    -------------------------------
  1014     05  MAINTL PIC S9(0004) COMP.
  1015     05  MAINTF PIC  X(0001).
  1016     05  FILLER REDEFINES MAINTF.
  1017         10  MAINTA PIC  X(0001).
  1018     05  MAINTI PIC  X(0001).
  1019*    -------------------------------
  1020     05  LSTUSRL PIC S9(0004) COMP.
  1021     05  LSTUSRF PIC  X(0001).
  1022     05  FILLER REDEFINES LSTUSRF.
  1023         10  LSTUSRA PIC  X(0001).
  1024     05  LSTUSRI PIC  X(0004).
  1025*    -------------------------------
  1026     05  LSTDTEL PIC S9(0004) COMP.
  1027     05  LSTDTEF PIC  X(0001).
  1028     05  FILLER REDEFINES LSTDTEF.
  1029         10  LSTDTEA PIC  X(0001).
  1030     05  LSTDTEI PIC  X(0008).
  1031*    -------------------------------
  1032     05  LSTTIMEL PIC S9(0004) COMP.
  1033     05  LSTTIMEF PIC  X(0001).
  1034     05  FILLER REDEFINES LSTTIMEF.
  1035         10  LSTTIMEA PIC  X(0001).
  1036     05  LSTTIMEI PIC  X(0005).
  1037*    -------------------------------
  1038     05  STCDL PIC S9(0004) COMP.
  1039     05  STCDF PIC  X(0001).
  1040     05  FILLER REDEFINES STCDF.
  1041         10  STCDA PIC  X(0001).
  1042     05  STCDI PIC  X(0002).
  1043*    -------------------------------
  1044     05  STABRL PIC S9(0004) COMP.
  1045     05  STABRF PIC  X(0001).
  1046     05  FILLER REDEFINES STABRF.
  1047         10  STABRA PIC  X(0001).
  1048     05  STABRI PIC  X(0002).
  1049*    -------------------------------
  1050     05  STNAMEL PIC S9(0004) COMP.
  1051     05  STNAMEF PIC  X(0001).
  1052     05  FILLER REDEFINES STNAMEF.
  1053         10  STNAMEA PIC  X(0001).
  1054     05  STNAMEI PIC  X(0025).
  1055*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL106.cbl
  1056     05  LEXPLBLL PIC S9(0004) COMP.
  1057     05  LEXPLBLF PIC  X(0001).
  1058     05  FILLER REDEFINES LEXPLBLF.
  1059         10  LEXPLBLA PIC  X(0001).
  1060     05  LEXPLBLI PIC  X(0006).
  1061*    -------------------------------
  1062     05  LFEXPL PIC S9(0004) COMP.
  1063     05  LFEXPF PIC  X(0001).
  1064     05  FILLER REDEFINES LFEXPF.
  1065         10  LFEXPA PIC  X(0001).
  1066     05  LFEXPI PIC  S9(3)V9999.
  1067*    -------------------------------
  1068     05  AEXPLBLL PIC S9(0004) COMP.
  1069     05  AEXPLBLF PIC  X(0001).
  1070     05  FILLER REDEFINES AEXPLBLF.
  1071         10  AEXPLBLA PIC  X(0001).
  1072     05  AEXPLBLI PIC  X(0006).
  1073*    -------------------------------
  1074     05  AHEXPL PIC S9(0004) COMP.
  1075     05  AHEXPF PIC  X(0001).
  1076     05  FILLER REDEFINES AHEXPF.
  1077         10  AHEXPA PIC  X(0001).
  1078     05  AHEXPI PIC  S9(3)V9999.
  1079*    -------------------------------
  1080     05  REMTERML PIC S9(0004) COMP.
  1081     05  REMTERMF PIC  X(0001).
  1082     05  FILLER REDEFINES REMTERMF.
  1083         10  REMTERMA PIC  X(0001).
  1084     05  REMTERMI PIC  X(0001).
  1085*    -------------------------------
  1086     05  QUOTCALL PIC S9(0004) COMP.
  1087     05  QUOTCALF PIC  X(0001).
  1088     05  FILLER REDEFINES QUOTCALF.
  1089         10  QUOTCALA PIC  X(0001).
  1090     05  QUOTCALI PIC  S9(4)V99.
  1091*    -------------------------------
  1092     05  PREMTOLL PIC S9(0004) COMP.
  1093     05  PREMTOLF PIC  X(0001).
  1094     05  FILLER REDEFINES PREMTOLF.
  1095         10  PREMTOLA PIC  X(0001).
  1096     05  PREMTOLI PIC  S9(4)V99.
  1097*    -------------------------------
  1098     05  REFTOLL PIC S9(0004) COMP.
  1099     05  REFTOLF PIC  X(0001).
  1100     05  FILLER REDEFINES REFTOLF.
  1101         10  REFTOLA PIC  X(0001).
  1102     05  REFTOLI PIC  S9(4)V99.
  1103*    -------------------------------
  1104     05  PRMPCTL PIC S9(0004) COMP.
  1105     05  PRMPCTF PIC  X(0001).
  1106     05  FILLER REDEFINES PRMPCTF.
  1107         10  PRMPCTA PIC  X(0001).
  1108     05  PRMPCTI PIC  S9(1)V9(4).
  1109*    -------------------------------
  1110     05  REFPCTL PIC S9(0004) COMP.
  1111     05  REFPCTF PIC  X(0001).
  1112     05  FILLER REDEFINES REFPCTF.
  1113         10  REFPCTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL106.cbl
  1114     05  REFPCTI PIC  S9(1)V9(4).
  1115*    -------------------------------
  1116     05  OVSAMTL PIC S9(0004) COMP.
  1117     05  OVSAMTF PIC  X(0001).
  1118     05  FILLER REDEFINES OVSAMTF.
  1119         10  OVSAMTA PIC  X(0001).
  1120     05  OVSAMTI PIC  S9(4)V99.
  1121*    -------------------------------
  1122     05  OVSPCTL PIC S9(0004) COMP.
  1123     05  OVSPCTF PIC  X(0001).
  1124     05  FILLER REDEFINES OVSPCTF.
  1125         10  OVSPCTA PIC  X(0001).
  1126     05  OVSPCTI PIC  S9(1)V9(4).
  1127*    -------------------------------
  1128     05  CLREJECL PIC S9(0004) COMP.
  1129     05  CLREJECF PIC  X(0001).
  1130     05  FILLER REDEFINES CLREJECF.
  1131         10  CLREJECA PIC  X(0001).
  1132     05  CLREJECI PIC  X(0001).
  1133*    -------------------------------
  1134     05  ISSREJL PIC S9(0004) COMP.
  1135     05  ISSREJF PIC  X(0001).
  1136     05  FILLER REDEFINES ISSREJF.
  1137         10  ISSREJA PIC  X(0001).
  1138     05  ISSREJI PIC  X(0001).
  1139*    -------------------------------
  1140     05  REFREJL PIC S9(0004) COMP.
  1141     05  REFREJF PIC  X(0001).
  1142     05  FILLER REDEFINES REFREJF.
  1143         10  REFREJA PIC  X(0001).
  1144     05  REFREJI PIC  X(0001).
  1145*    -------------------------------
  1146     05  REFMINL PIC S9(0004) COMP.
  1147     05  REFMINF PIC  X(0001).
  1148     05  FILLER REDEFINES REFMINF.
  1149         10  REFMINA PIC  X(0001).
  1150     05  REFMINI PIC  S9(4)V99.
  1151*    -------------------------------
  1152     05  REFDAY1L PIC S9(0004) COMP.
  1153     05  REFDAY1F PIC  X(0001).
  1154     05  FILLER REDEFINES REFDAY1F.
  1155         10  REFDAY1A PIC  X(0001).
  1156     05  REFDAY1I PIC  X(0002).
  1157*    -------------------------------
  1158     05  REFDAYSL PIC S9(0004) COMP.
  1159     05  REFDAYSF PIC  X(0001).
  1160     05  FILLER REDEFINES REFDAYSF.
  1161         10  REFDAYSA PIC  X(0001).
  1162     05  REFDAYSI PIC  X(0002).
  1163*    -------------------------------
  1164     05  SPLPMTL PIC S9(0004) COMP.
  1165     05  SPLPMTF PIC  X(0001).
  1166     05  FILLER REDEFINES SPLPMTF.
  1167         10  SPLPMTA PIC  X(0001).
  1168     05  SPLPMTI PIC  X(0001).
  1169*    -------------------------------
  1170     05  STUEL PIC S9(0004) COMP.
  1171     05  STUEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL106.cbl
  1172     05  FILLER REDEFINES STUEF.
  1173         10  STUEA PIC  X(0001).
  1174     05  STUEI PIC  X(0001).
  1175*    -------------------------------
  1176     05  STCNTLL PIC S9(0004) COMP.
  1177     05  STCNTLF PIC  X(0001).
  1178     05  FILLER REDEFINES STCNTLF.
  1179         10  STCNTLA PIC  X(0001).
  1180     05  STCNTLI PIC  X(0001).
  1181*    -------------------------------
  1182     05  STDEVL PIC S9(0004) COMP.
  1183     05  STDEVF PIC  X(0001).
  1184     05  FILLER REDEFINES STDEVF.
  1185         10  STDEVA PIC  X(0001).
  1186     05  STDEVI PIC  X(0003).
  1187*    -------------------------------
  1188     05  EXTDAYSL PIC S9(0004) COMP.
  1189     05  EXTDAYSF PIC  X(0001).
  1190     05  FILLER REDEFINES EXTDAYSF.
  1191         10  EXTDAYSA PIC  X(0001).
  1192     05  EXTDAYSI PIC  X(0003).
  1193*    -------------------------------
  1194     05  EXTCHGL PIC S9(0004) COMP.
  1195     05  EXTCHGF PIC  X(0001).
  1196     05  FILLER REDEFINES EXTCHGF.
  1197         10  EXTCHGA PIC  X(0001).
  1198     05  EXTCHGI PIC  X(0001).
  1199*    -------------------------------
  1200     05  LFTAXL PIC S9(0004) COMP.
  1201     05  LFTAXF PIC  X(0001).
  1202     05  FILLER REDEFINES LFTAXF.
  1203         10  LFTAXA PIC  X(0001).
  1204     05  LFTAXI PIC  S9(1)V9(4).
  1205*    -------------------------------
  1206     05  REPLAWL PIC S9(0004) COMP.
  1207     05  REPLAWF PIC  X(0001).
  1208     05  FILLER REDEFINES REPLAWF.
  1209         10  REPLAWA PIC  X(0001).
  1210     05  REPLAWI PIC  X(0001).
  1211*    -------------------------------
  1212     05  REPLETRL PIC S9(0004) COMP.
  1213     05  REPLETRF PIC  X(0001).
  1214     05  FILLER REDEFINES REPLETRF.
  1215         10  REPLETRA PIC  X(0001).
  1216     05  REPLETRI PIC  X(0004).
  1217*    -------------------------------
  1218     05  AHITAXL PIC S9(0004) COMP.
  1219     05  AHITAXF PIC  X(0001).
  1220     05  FILLER REDEFINES AHITAXF.
  1221         10  AHITAXA PIC  X(0001).
  1222     05  AHITAXI PIC  S9(1)V9(4).
  1223*    -------------------------------
  1224     05  TARRATL PIC S9(0004) COMP.
  1225     05  TARRATF PIC  X(0001).
  1226     05  FILLER REDEFINES TARRATF.
  1227         10  TARRATA PIC  X(0001).
  1228     05  TARRATI PIC  S9(2)V9(4).
  1229*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL106.cbl
  1230     05  CALCINTL PIC S9(0004) COMP.
  1231     05  CALCINTF PIC  X(0001).
  1232     05  FILLER REDEFINES CALCINTF.
  1233         10  CALCINTA PIC  X(0001).
  1234     05  CALCINTI PIC  S9(2)V9(4).
  1235*    -------------------------------
  1236     05  AHGTAXL PIC S9(0004) COMP.
  1237     05  AHGTAXF PIC  X(0001).
  1238     05  FILLER REDEFINES AHGTAXF.
  1239         10  AHGTAXA PIC  X(0001).
  1240     05  AHGTAXI PIC  S9(1)V9(4).
  1241*    -------------------------------
  1242     05  COMSLL PIC S9(0004) COMP.
  1243     05  COMSLF PIC  X(0001).
  1244     05  FILLER REDEFINES COMSLF.
  1245         10  COMSLA PIC  X(0001).
  1246     05  COMSLI PIC  S99V9(4).
  1247*    -------------------------------
  1248     05  LIMITL PIC S9(0004) COMP.
  1249     05  LIMITF PIC  X(0001).
  1250     05  FILLER REDEFINES LIMITF.
  1251         10  LIMITA PIC  X(0001).
  1252     05  LIMITI PIC  X(0001).
  1253*    -------------------------------
  1254     05  COMJLL PIC S9(0004) COMP.
  1255     05  COMJLF PIC  X(0001).
  1256     05  FILLER REDEFINES COMJLF.
  1257         10  COMJLA PIC  X(0001).
  1258     05  COMJLI PIC  S99V9(4).
  1259*    -------------------------------
  1260     05  LFREDL PIC S9(0004) COMP.
  1261     05  LFREDF PIC  X(0001).
  1262     05  FILLER REDEFINES LFREDF.
  1263         10  LFREDA PIC  X(0001).
  1264     05  LFREDI PIC  X(0001).
  1265*    -------------------------------
  1266     05  LFLEVL PIC S9(0004) COMP.
  1267     05  LFLEVF PIC  X(0001).
  1268     05  FILLER REDEFINES LFLEVF.
  1269         10  LFLEVA PIC  X(0001).
  1270     05  LFLEVI PIC  X(0001).
  1271*    -------------------------------
  1272     05  LFNETL PIC S9(0004) COMP.
  1273     05  LFNETF PIC  X(0001).
  1274     05  FILLER REDEFINES LFNETF.
  1275         10  LFNETA PIC  X(0001).
  1276     05  LFNETI PIC  X(0001).
  1277*    -------------------------------
  1278     05  COMSAL PIC S9(0004) COMP.
  1279     05  COMSAF PIC  X(0001).
  1280     05  FILLER REDEFINES COMSAF.
  1281         10  COMSAA PIC  X(0001).
  1282     05  COMSAI PIC  S99V9(4).
  1283*    -------------------------------
  1284     05  AHAHL PIC S9(0004) COMP.
  1285     05  AHAHF PIC  X(0001).
  1286     05  FILLER REDEFINES AHAHF.
  1287         10  AHAHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL106.cbl
  1288     05  AHAHI PIC  X(0001).
  1289*    -------------------------------
  1290     05  AHCPL PIC S9(0004) COMP.
  1291     05  AHCPF PIC  X(0001).
  1292     05  FILLER REDEFINES AHCPF.
  1293         10  AHCPA PIC  X(0001).
  1294     05  AHCPI PIC  X(0001).
  1295*    -------------------------------
  1296     05  COMJAL PIC S9(0004) COMP.
  1297     05  COMJAF PIC  X(0001).
  1298     05  FILLER REDEFINES COMJAF.
  1299         10  COMJAA PIC  X(0001).
  1300     05  COMJAI PIC  S99V9(4).
  1301*    -------------------------------
  1302     05  STCHKHDL PIC S9(0004) COMP.
  1303     05  STCHKHDF PIC  X(0001).
  1304     05  FILLER REDEFINES STCHKHDF.
  1305         10  STCHKHDA PIC  X(0001).
  1306     05  STCHKHDI PIC  X(0013).
  1307*    -------------------------------
  1308     05  STCHKNOL PIC S9(0004) COMP.
  1309     05  STCHKNOF PIC  X(0001).
  1310     05  FILLER REDEFINES STCHKNOF.
  1311         10  STCHKNOA PIC  X(0001).
  1312     05  STCHKNOI PIC  9(8).
  1313*    -------------------------------
  1314     05  RESTAXL PIC S9(0004) COMP.
  1315     05  RESTAXF PIC  X(0001).
  1316     05  FILLER REDEFINES RESTAXF.
  1317         10  RESTAXA PIC  X(0001).
  1318     05  RESTAXI PIC  S99V9(4).
  1319*    -------------------------------
  1320     05  FREELKL PIC S9(0004) COMP.
  1321     05  FREELKF PIC  X(0001).
  1322     05  FILLER REDEFINES FREELKF.
  1323         10  FREELKA PIC  X(0001).
  1324     05  FREELKI PIC  X(0003).
  1325*    -------------------------------
  1326     05  REFCLML PIC S9(0004) COMP.
  1327     05  REFCLMF PIC  X(0001).
  1328     05  FILLER REDEFINES REFCLMF.
  1329         10  REFCLMA PIC  X(0001).
  1330     05  REFCLMI PIC  X(0001).
  1331*    -------------------------------
  1332     05  VFYBENEL PIC S9(0004) COMP.
  1333     05  VFYBENEF PIC  X(0001).
  1334     05  FILLER REDEFINES VFYBENEF.
  1335         10  VFYBENEA PIC  X(0001).
  1336     05  VFYBENEI PIC  X(0001).
  1337*    -------------------------------
  1338     05  ERRMSG1L PIC S9(0004) COMP.
  1339     05  ERRMSG1F PIC  X(0001).
  1340     05  FILLER REDEFINES ERRMSG1F.
  1341         10  ERRMSG1A PIC  X(0001).
  1342     05  ERRMSG1I PIC  X(0076).
  1343*    -------------------------------
  1344     05  ERRMSG2L PIC S9(0004) COMP.
  1345     05  ERRMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL106.cbl
  1346     05  FILLER REDEFINES ERRMSG2F.
  1347         10  ERRMSG2A PIC  X(0001).
  1348     05  ERRMSG2I PIC  X(0076).
  1349*    -------------------------------
  1350     05  ENTERPFL PIC S9(0004) COMP.
  1351     05  ENTERPFF PIC  X(0001).
  1352     05  FILLER REDEFINES ENTERPFF.
  1353         10  ENTERPFA PIC  X(0001).
  1354     05  ENTERPFI PIC  9(2).
  1355 01  EL106AO REDEFINES EL106AI.
  1356     05  FILLER            PIC  X(0012).
  1357*    -------------------------------
  1358     05  FILLER            PIC  X(0003).
  1359     05  RUNDTEO PIC  X(0008).
  1360*    -------------------------------
  1361     05  FILLER            PIC  X(0003).
  1362     05  RUNTIMEO PIC  99.99.
  1363*    -------------------------------
  1364     05  FILLER            PIC  X(0003).
  1365     05  MAINTO PIC  X(0001).
  1366*    -------------------------------
  1367     05  FILLER            PIC  X(0003).
  1368     05  LSTUSRO PIC  X(0004).
  1369*    -------------------------------
  1370     05  FILLER            PIC  X(0003).
  1371     05  LSTDTEO PIC  X(0008).
  1372*    -------------------------------
  1373     05  FILLER            PIC  X(0003).
  1374     05  LSTTIMEO PIC  99.99.
  1375*    -------------------------------
  1376     05  FILLER            PIC  X(0003).
  1377     05  STCDO PIC  X(0002).
  1378*    -------------------------------
  1379     05  FILLER            PIC  X(0003).
  1380     05  STABRO PIC  X(0002).
  1381*    -------------------------------
  1382     05  FILLER            PIC  X(0003).
  1383     05  STNAMEO PIC  X(0025).
  1384*    -------------------------------
  1385     05  FILLER            PIC  X(0003).
  1386     05  LEXPLBLO PIC  X(0006).
  1387*    -------------------------------
  1388     05  FILLER            PIC  X(0003).
  1389     05  LFEXPO PIC  99.9999.
  1390*    -------------------------------
  1391     05  FILLER            PIC  X(0003).
  1392     05  AEXPLBLO PIC  X(0006).
  1393*    -------------------------------
  1394     05  FILLER            PIC  X(0003).
  1395     05  AHEXPO PIC  99.9999.
  1396*    -------------------------------
  1397     05  FILLER            PIC  X(0003).
  1398     05  REMTERMO PIC  X(0001).
  1399*    -------------------------------
  1400     05  FILLER            PIC  X(0003).
  1401     05  QUOTCALO PIC  ZZ9.99.
  1402*    -------------------------------
  1403     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL106.cbl
  1404     05  PREMTOLO PIC  ZZ9.99.
  1405*    -------------------------------
  1406     05  FILLER            PIC  X(0003).
  1407     05  REFTOLO PIC  ZZ9.99.
  1408*    -------------------------------
  1409     05  FILLER            PIC  X(0003).
  1410     05  PRMPCTO PIC  .9999.
  1411*    -------------------------------
  1412     05  FILLER            PIC  X(0003).
  1413     05  REFPCTO PIC  .9999.
  1414*    -------------------------------
  1415     05  FILLER            PIC  X(0003).
  1416     05  OVSAMTO PIC  ZZ9.99.
  1417*    -------------------------------
  1418     05  FILLER            PIC  X(0003).
  1419     05  OVSPCTO PIC  .9999.
  1420*    -------------------------------
  1421     05  FILLER            PIC  X(0003).
  1422     05  CLREJECO PIC  X(0001).
  1423*    -------------------------------
  1424     05  FILLER            PIC  X(0003).
  1425     05  ISSREJO PIC  X(0001).
  1426*    -------------------------------
  1427     05  FILLER            PIC  X(0003).
  1428     05  REFREJO PIC  X(0001).
  1429*    -------------------------------
  1430     05  FILLER            PIC  X(0003).
  1431     05  REFMINO PIC  ZZ9.99.
  1432*    -------------------------------
  1433     05  FILLER            PIC  X(0003).
  1434     05  REFDAY1O PIC  99.
  1435*    -------------------------------
  1436     05  FILLER            PIC  X(0003).
  1437     05  REFDAYSO PIC  99.
  1438*    -------------------------------
  1439     05  FILLER            PIC  X(0003).
  1440     05  SPLPMTO PIC  X(0001).
  1441*    -------------------------------
  1442     05  FILLER            PIC  X(0003).
  1443     05  STUEO PIC  X(0001).
  1444*    -------------------------------
  1445     05  FILLER            PIC  X(0003).
  1446     05  STCNTLO PIC  X(0001).
  1447*    -------------------------------
  1448     05  FILLER            PIC  X(0003).
  1449     05  STDEVO PIC  X(0003).
  1450*    -------------------------------
  1451     05  FILLER            PIC  X(0003).
  1452     05  EXTDAYSO PIC  999.
  1453*    -------------------------------
  1454     05  FILLER            PIC  X(0003).
  1455     05  EXTCHGO PIC  X(0001).
  1456*    -------------------------------
  1457     05  FILLER            PIC  X(0003).
  1458     05  LFTAXO PIC  .9999.
  1459*    -------------------------------
  1460     05  FILLER            PIC  X(0003).
  1461     05  REPLAWO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL106.cbl
  1462*    -------------------------------
  1463     05  FILLER            PIC  X(0003).
  1464     05  REPLETRO PIC  X(0004).
  1465*    -------------------------------
  1466     05  FILLER            PIC  X(0003).
  1467     05  AHITAXO PIC  .9999.
  1468*    -------------------------------
  1469     05  FILLER            PIC  X(0003).
  1470     05  TARRATO PIC  9.9999.
  1471*    -------------------------------
  1472     05  FILLER            PIC  X(0003).
  1473     05  CALCINTO PIC  9.9999.
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(0003).
  1476     05  AHGTAXO PIC  .9999.
  1477*    -------------------------------
  1478     05  FILLER            PIC  X(0003).
  1479     05  COMSLO PIC  9.9999.
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(0003).
  1482     05  LIMITO PIC  X(0001).
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
  1485     05  COMJLO PIC  9.9999.
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
  1488     05  LFREDO PIC  X(0001).
  1489*    -------------------------------
  1490     05  FILLER            PIC  X(0003).
  1491     05  LFLEVO PIC  X(0001).
  1492*    -------------------------------
  1493     05  FILLER            PIC  X(0003).
  1494     05  LFNETO PIC  X(0001).
  1495*    -------------------------------
  1496     05  FILLER            PIC  X(0003).
  1497     05  COMSAO PIC  9.9999.
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  AHAHO PIC  X(0001).
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  AHCPO PIC  X(0001).
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  COMJAO PIC  9.9999.
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
  1509     05  STCHKHDO PIC  X(0013).
  1510*    -------------------------------
  1511     05  FILLER            PIC  X(0003).
  1512     05  STCHKNOO PIC  9(8).
  1513*    -------------------------------
  1514     05  FILLER            PIC  X(0003).
  1515     05  RESTAXO PIC  9.9999.
  1516*    -------------------------------
  1517     05  FILLER            PIC  X(0003).
  1518     05  FREELKO PIC  999.
  1519*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL106.cbl
  1520     05  FILLER            PIC  X(0003).
  1521     05  REFCLMO PIC  X(0001).
  1522*    -------------------------------
  1523     05  FILLER            PIC  X(0003).
  1524     05  VFYBENEO PIC  X(0001).
  1525*    -------------------------------
  1526     05  FILLER            PIC  X(0003).
  1527     05  ERRMSG1O PIC  X(0076).
  1528*    -------------------------------
  1529     05  FILLER            PIC  X(0003).
  1530     05  ERRMSG2O PIC  X(0076).
  1531*    -------------------------------
  1532     05  FILLER            PIC  X(0003).
  1533     05  ENTERPFO PIC  X(0002).
  1534*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL106.cbl
  1536****************************************************************
  1537*
  1538* Copyright (c) 2007 by Clerity Solutions, Inc.
  1539* All rights reserved.
  1540*
  1541****************************************************************
  1542 01  DFHEIV.
  1543   02  DFHEIV0               PIC X(35).
  1544   02  DFHEIV1               PIC X(08).
  1545   02  DFHEIV2               PIC X(08).
  1546   02  DFHEIV3               PIC X(08).
  1547   02  DFHEIV4               PIC X(06).
  1548   02  DFHEIV5               PIC X(04).
  1549   02  DFHEIV6               PIC X(04).
  1550   02  DFHEIV7               PIC X(02).
  1551   02  DFHEIV8               PIC X(02).
  1552   02  DFHEIV9               PIC X(01).
  1553   02  DFHEIV10              PIC S9(7) COMP-3.
  1554   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1555   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1556   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1557   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1558   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1559   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1560   02  DFHEIV17              PIC X(04).
  1561   02  DFHEIV18              PIC X(04).
  1562   02  DFHEIV19              PIC X(04).
  1563   02  DFHEIV20              USAGE IS POINTER.
  1564   02  DFHEIV21              USAGE IS POINTER.
  1565   02  DFHEIV22              USAGE IS POINTER.
  1566   02  DFHEIV23              USAGE IS POINTER.
  1567   02  DFHEIV24              USAGE IS POINTER.
  1568   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1569   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1570   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1571   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1572   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1573   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1574   02  FILLER                PIC X(02).
  1575   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1576   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1577   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1578   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1579   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1580 LINKAGE  SECTION.
  1581*****************************************************************
  1582*                                                               *
  1583* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1584* All rights reserved.                                          *
  1585*                                                               *
  1586*****************************************************************
  1587 01  dfheiblk.
  1588     02  eibtime          pic s9(7) comp-3.
  1589     02  eibdate          pic s9(7) comp-3.
  1590     02  eibtrnid         pic x(4).
  1591     02  eibtaskn         pic s9(7) comp-3.
  1592     02  eibtrmid         pic x(4).
  1593     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL106.cbl
  1594     02  eibcposn         pic s9(4) comp.
  1595     02  eibcalen         pic s9(4) comp.
  1596     02  eibaid           pic x(1).
  1597     02  eibfiller1       pic x(1).
  1598     02  eibfn            pic x(2).
  1599     02  eibfiller2       pic x(2).
  1600     02  eibrcode         pic x(6).
  1601     02  eibfiller3       pic x(2).
  1602     02  eibds            pic x(8).
  1603     02  eibreqid         pic x(8).
  1604     02  eibrsrce         pic x(8).
  1605     02  eibsync          pic x(1).
  1606     02  eibfree          pic x(1).
  1607     02  eibrecv          pic x(1).
  1608     02  eibsend          pic x(1).
  1609     02  eibatt           pic x(1).
  1610     02  eibeoc           pic x(1).
  1611     02  eibfmh           pic x(1).
  1612     02  eibcompl         pic x(1).
  1613     02  eibsig           pic x(1).
  1614     02  eibconf          pic x(1).
  1615     02  eiberr           pic x(1).
  1616     02  eibrldbk         pic x(1).
  1617     02  eiberrcd         pic x(4).
  1618     02  eibsynrb         pic x(1).
  1619     02  eibnodat         pic x(1).
  1620     02  eibfiller5       pic x(2).
  1621     02  eibresp          pic 9(09) comp.
  1622     02  eibresp2         pic 9(09) comp.
  1623     02  dfheigdj         pic s9(4) comp.
  1624     02  dfheigdk         pic s9(4) comp.
  1625 01  DFHCOMMAREA             PIC X(1500).
  1626*01 PARMLIST .
  1627*    02  FILLER              PIC S9(8)   COMP.
  1628*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  1629*    02  ELLETR-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL106.cbl
  1631*    COPY ELCCNTL.
  1632******************************************************************
  1633*                                                                *
  1634*                                                                *
  1635*                            ELCCNTL.                            *
  1636*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1637*                            VMOD=2.059                          *
  1638*                                                                *
  1639*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1640*                                                                *
  1641*   FILE TYPE = VSAM,KSDS                                        *
  1642*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1643*                                                                *
  1644*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1645*       ALTERNATE INDEX = NONE                                   *
  1646*                                                                *
  1647*   LOG = YES                                                    *
  1648*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1649******************************************************************
  1650*                   C H A N G E   L O G
  1651*
  1652* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1653*-----------------------------------------------------------------
  1654*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1655* EFFECTIVE    NUMBER
  1656*-----------------------------------------------------------------
  1657* 082503                   PEMA  ADD BENEFIT GROUP
  1658* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1659* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1660* 092705    2005050300006  PEMA  ADD SPP LEASES
  1661* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1662* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1663* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1664* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1665* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1666******************************************************************
  1667*
  1668 01  CONTROL-FILE.
  1669     12  CF-RECORD-ID                       PIC XX.
  1670         88  VALID-CF-ID                        VALUE 'CF'.
  1671
  1672     12  CF-CONTROL-PRIMARY.
  1673         16  CF-COMPANY-ID                  PIC XXX.
  1674         16  CF-RECORD-TYPE                 PIC X.
  1675             88  CF-COMPANY-MASTER              VALUE '1'.
  1676             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1677             88  CF-STATE-MASTER                VALUE '3'.
  1678             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1679             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1680             88  CF-CARRIER-MASTER              VALUE '6'.
  1681             88  CF-MORTALITY-MASTER            VALUE '7'.
  1682             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1683             88  CF-TERMINAL-MASTER             VALUE '9'.
  1684             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1685             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1686             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1687             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1688             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL106.cbl
  1689             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1690             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1691             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1692             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1693         16  CF-ACCESS-CD-GENL              PIC X(4).
  1694         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1695             20  CF-PROCESSOR               PIC X(4).
  1696         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1697             20  CF-STATE-CODE              PIC XX.
  1698             20  FILLER                     PIC XX.
  1699         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1700             20  FILLER                     PIC XX.
  1701             20  CF-HI-BEN-IN-REC           PIC XX.
  1702         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1703             20  FILLER                     PIC XXX.
  1704             20  CF-CARRIER-CNTL            PIC X.
  1705         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1706             20  FILLER                     PIC XX.
  1707             20  CF-HI-TYPE-IN-REC          PIC 99.
  1708         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1709             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1710                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1711             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1712             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1713         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1714             20  FILLER                     PIC X.
  1715             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1716         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1717             20  FILLER                     PIC XX.
  1718             20  CF-MORTGAGE-PLAN           PIC XX.
  1719         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1720
  1721     12  CF-LAST-MAINT-DT                   PIC XX.
  1722     12  CF-LAST-MAINT-BY                   PIC X(4).
  1723     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1724
  1725     12  CF-RECORD-BODY                     PIC X(728).
  1726
  1727
  1728****************************************************************
  1729*             COMPANY MASTER RECORD                            *
  1730****************************************************************
  1731
  1732     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1733         16  CF-COMPANY-ADDRESS.
  1734             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1735             20  CF-CL-IN-CARE-OF           PIC X(30).
  1736             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1737             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1738             20  CF-CL-CITY-STATE           PIC X(30).
  1739             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1740             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1741         16  CF-COMPANY-CD                  PIC X.
  1742         16  CF-COMPANY-PASSWORD            PIC X(8).
  1743         16  CF-SECURITY-OPTION             PIC X.
  1744             88  ALL-SECURITY                   VALUE '1'.
  1745             88  COMPANY-VERIFY                 VALUE '2'.
  1746             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL106.cbl
  1747             88  NO-SECURITY                    VALUE '4'.
  1748             88  ALL-BUT-TERM                   VALUE '5'.
  1749         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1750             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1751         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1752             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1753         16  CF-INFORCE-LOCATION            PIC X.
  1754             88  CERTS-ARE-ONLINE               VALUE '1'.
  1755             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1756             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1757         16  CF-LOWER-CASE-LETTERS          PIC X.
  1758         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1759             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1760             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1761             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1762             88  CF-ACCNT-CNTL                  VALUE '3'.
  1763             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1764
  1765         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1766         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1767
  1768         16  CF-LGX-CREDIT-USER             PIC X.
  1769             88  CO-IS-NOT-USER                 VALUE 'N'.
  1770             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1771
  1772         16 CF-CREDIT-CALC-CODES.
  1773             20  CF-CR-REM-TERM-CALC PIC X.
  1774               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1775               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1776               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1777               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1778               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1779               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1780               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1781             20  CF-CR-R78-METHOD           PIC X.
  1782               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1783               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1784
  1785         16  CF-CLAIM-CONTROL-COUNTS.
  1786             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1787                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1788
  1789             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1790                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1791
  1792             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1793                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1794
  1795             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1796                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1797
  1798         16  CF-CURRENT-MONTH-END           PIC XX.
  1799
  1800         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1801             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1802             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1803             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1804             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL106.cbl
  1805                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1806                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1807             20  CF-CO-PREM-REJECT-SW       PIC X.
  1808                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1809                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1810             20  CF-CO-REF-REJECT-SW        PIC X.
  1811                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1812                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1813
  1814         16  CF-CO-REPORTING-DT             PIC XX.
  1815         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1816         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1817           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1818           88  CF-CO-MONTH-END                  VALUE '1'.
  1819
  1820         16  CF-LGX-CLAIM-USER              PIC X.
  1821             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1822             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1823
  1824         16  CF-CREDIT-EDIT-CONTROLS.
  1825             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1826             20  CF-MIN-AGE                 PIC 99.
  1827             20  CF-DEFAULT-AGE             PIC 99.
  1828             20  CF-MIN-TERM                PIC S999      COMP-3.
  1829             20  CF-MAX-TERM                PIC S999      COMP-3.
  1830             20  CF-DEFAULT-SEX             PIC X.
  1831             20  CF-JOINT-AGE-INPUT         PIC X.
  1832                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1833             20  CF-BIRTH-DATE-INPUT        PIC X.
  1834                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1835             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1836                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1837                 88  CF-ZERO-CARRIER            VALUE '1'.
  1838                 88  CF-ZERO-GROUPING           VALUE '2'.
  1839                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1840             20  CF-EDIT-SW                 PIC X.
  1841                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1842             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1843             20  CF-CR-PR-METHOD            PIC X.
  1844               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1845               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1846             20  FILLER                     PIC X.
  1847
  1848         16  CF-CREDIT-MISC-CONTROLS.
  1849             20  CF-REIN-TABLE-SW           PIC X.
  1850                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1851             20  CF-COMP-TABLE-SW           PIC X.
  1852                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1853             20  CF-EXPERIENCE-RETENTION-AGE
  1854                                            PIC S9        COMP-3.
  1855             20  CF-CONVERSION-DT           PIC XX.
  1856             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1857             20  CF-RUN-FREQUENCY-SW        PIC X.
  1858                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1859                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1860
  1861             20  CF-CR-CHECK-NO-CONTROL.
  1862                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL106.cbl
  1863                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1864                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1865                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1866                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1867                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1868
  1869                 24  CF-CR-CHECK-COUNT       REDEFINES
  1870                     CF-CR-CHECK-COUNTER      PIC X(4).
  1871
  1872                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1873                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1874
  1875                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1876                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1877                 24  CF-MAIL-PROCESSING       PIC X.
  1878                     88  MAIL-PROCESSING          VALUE 'Y'.
  1879
  1880         16  CF-MISC-SYSTEM-CONTROL.
  1881             20  CF-SYSTEM-C                 PIC X.
  1882                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1883             20  CF-SYSTEM-D                 PIC X.
  1884                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1885             20  CF-SOC-SEC-NO-SW            PIC X.
  1886                 88  SOC-SEC-NO-USED             VALUE '1'.
  1887             20  CF-MEMBER-NO-SW             PIC X.
  1888                 88  MEMBER-NO-USED              VALUE '1'.
  1889             20  CF-TAX-ID-NUMBER            PIC X(11).
  1890             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1891             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1892                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1893                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1894                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1895                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1896             20  CF-SYSTEM-E                 PIC X.
  1897                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1898
  1899         16  CF-LGX-LIFE-USER               PIC X.
  1900             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1901             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1902
  1903         16  CF-CR-MONTH-END-DT             PIC XX.
  1904
  1905         16  CF-FILE-MAINT-DATES.
  1906             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1907                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1908             20  CF-LAST-BATCH       REDEFINES
  1909                 CF-LAST-BATCH-NO               PIC X(4).
  1910             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1911             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1912             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1913             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1914             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1915             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1916             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1917             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1918             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1919             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1920
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL106.cbl
  1921         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1922         16  FILLER                         PIC X.
  1923
  1924         16  CF-ALT-MORT-CODE               PIC X(4).
  1925         16  CF-MEMBER-CAPTION              PIC X(10).
  1926
  1927         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1928             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1929             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1930             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1931             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1932             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1933
  1934         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1935
  1936         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1937         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1938         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1939         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1940
  1941         16  CF-AH-OVERRIDE-L1              PIC X.
  1942         16  CF-AH-OVERRIDE-L2              PIC XX.
  1943         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1944         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1945
  1946         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1947         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1948
  1949         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1950         16  CF-AR-LAST-EL860-DT            PIC XX.
  1951         16  CF-MP-MONTH-END-DT             PIC XX.
  1952
  1953         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1954         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1955             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1956
  1957         16  CF-AR-MONTH-END-DT             PIC XX.
  1958
  1959         16  CF-CRDTCRD-USER                PIC X.
  1960             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1961             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1962
  1963         16  CF-CC-MONTH-END-DT             PIC XX.
  1964
  1965         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1966
  1967         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1968             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1969             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1970             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1971         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1972         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1973         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1974         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1975             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1976             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1977         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1978         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL106.cbl
  1979         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1980             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1981         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1982
  1983         16  CF-CL-ZIP-CODE.
  1984             20  CF-CL-ZIP-PRIME.
  1985                 24  CF-CL-ZIP-1ST          PIC X.
  1986                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1987                 24  FILLER                 PIC X(4).
  1988             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1989         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1990             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1991             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1992             20  FILLER                     PIC XXX.
  1993
  1994         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1995         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1996         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1997         16  CF-CO-OPTION-START-DATE        PIC XX.
  1998         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1999           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2000                                                      '3' '4'.
  2001           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2002           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2003           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2004           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2005           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2006           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2007
  2008         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2009
  2010         16  CF-PAYMENT-APPROVAL-LEVELS.
  2011             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2012             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2013             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2014             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2015             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2016             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2017
  2018         16  CF-END-USER-REPORTING-USER     PIC X.
  2019             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2020             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2021
  2022         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2023             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2024             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2025
  2026         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2027
  2028         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2029         16  FILLER                         PIC X.
  2030
  2031         16  CF-CREDIT-ARCHIVE-CNTL.
  2032             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2033             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2034             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2035
  2036         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL106.cbl
  2037
  2038         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2039             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2040             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2041
  2042         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2043             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2044             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2045
  2046         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2047
  2048         16  CF-CO-ACH-ID-CODE              PIC  X.
  2049             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2050             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2051             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2052         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2053         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2054         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2055         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2056         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2057         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2058         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2059         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2060         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2061                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2062         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2063                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2064
  2065         16  CF-CO-OVER-SHORT.
  2066             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2067             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2068
  2069*         16  FILLER                         PIC X(102).
  2070         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2071             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2072             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2073
  2074         16  CF-AH-APPROVAL-DAYS.
  2075             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2076             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2077             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2078             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2079
  2080         16  FILLER                         PIC X(82).
  2081****************************************************************
  2082*             PROCESSOR/USER RECORD                            *
  2083****************************************************************
  2084
  2085     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2086         16  CF-PROCESSOR-NAME              PIC X(30).
  2087         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2088         16  CF-PROCESSOR-TITLE             PIC X(26).
  2089         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2090                 88  MESSAGE-YES                VALUE 'Y'.
  2091                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2092
  2093*****************************************************
  2094****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL106.cbl
  2095****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2096****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2097****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2098*****************************************************
  2099
  2100         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2101             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2102             20  CF-APPLICATION-FORCE       PIC X.
  2103             20  CF-INDIVIDUAL-APP.
  2104                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2105                     28  CF-BROWSE-APP      PIC X.
  2106                     28  CF-UPDATE-APP      PIC X.
  2107
  2108         16  CF-CURRENT-TERM-ON             PIC X(4).
  2109         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2110             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2111             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2112             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2113             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2114             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2115             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2116             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2117         16  CF-PROCESSOR-CARRIER           PIC X.
  2118             88  NO-CARRIER-SECURITY            VALUE ' '.
  2119         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2120             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2121         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2122             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2123         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2124             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2125
  2126         16  CF-PROC-SYS-ACCESS-SW.
  2127             20  CF-PROC-CREDIT-CLAIMS-SW.
  2128                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2129                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2130                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2131                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2132             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2133                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2134                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2135             20  CF-PROC-LIFE-GNRLDGR-SW.
  2136                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2137                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2138                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2139                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2140             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2141                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2142                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2143         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2144             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2145             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2146         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2147
  2148         16  CF-APPROVAL-LEVEL                  PIC X.
  2149             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2150             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2151             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2152             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL106.cbl
  2153
  2154         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2155
  2156         16  CF-LANGUAGE-TYPE                   PIC X.
  2157             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2158             88  CF-LANG-IS-FR                      VALUE 'F'.
  2159         16  FILLER                             PIC  X(240).
  2160
  2161****************************************************************
  2162*             PROCESSOR/REMINDERS RECORD                       *
  2163****************************************************************
  2164
  2165     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2166         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2167             20  CF-START-REMIND-DT         PIC XX.
  2168             20  CF-END-REMIND-DT           PIC XX.
  2169             20  CF-REMINDER-TEXT           PIC X(50).
  2170         16  FILLER                         PIC X(296).
  2171
  2172
  2173****************************************************************
  2174*             STATE MASTER RECORD                              *
  2175****************************************************************
  2176
  2177     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2178         16  CF-STATE-ABBREVIATION          PIC XX.
  2179         16  CF-STATE-NAME                  PIC X(25).
  2180         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2181         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2182             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2183             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2184             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2185             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2186                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2187                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2188             20  CF-ST-PREM-REJECT-SW       PIC X.
  2189                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2190                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2191             20  CF-ST-REF-REJECT-SW        PIC X.
  2192                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2193                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2194         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2195         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2196         16  CF-ST-REFUND-RULES.
  2197             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2198             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2199             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2200         16  CF-ST-FST-PMT-EXTENSION.
  2201             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2202             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2203                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2204                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2205                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2206                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2207         16  CF-ST-STATE-CALL.
  2208             20  CF-ST-CALL-UNEARNED        PIC X.
  2209             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2210             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL106.cbl
  2211         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2212             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2213             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2214         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2215         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2216         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2217         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2218         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2219         16  FILLER                         PIC X.
  2220         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2221             20  CF-ST-BENEFIT-CD           PIC XX.
  2222             20  CF-ST-BENEFIT-KIND         PIC X.
  2223                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2224                 88  CF-ST-AH-KIND              VALUE 'A'.
  2225             20  CF-ST-REM-TERM-CALC        PIC X.
  2226                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2227                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2228                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2229                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2230                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2231                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2232                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2233                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2234
  2235             20  CF-ST-REFUND-CALC          PIC X.
  2236                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2237                 88  ST-REFD-BY-R78             VALUE '1'.
  2238                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2239                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2240                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2241                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2242                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2243                 88  ST-REFD-UTAH               VALUE '7'.
  2244                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2245                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2246                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2247
  2248             20  CF-ST-EARNING-CALC         PIC X.
  2249                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2250                 88  ST-EARN-BY-R78             VALUE '1'.
  2251                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2252                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2253                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2254                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2255                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2256                 88  ST-EARN-MEAN               VALUE '8'.
  2257                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2258
  2259             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2260                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2261                 88  ST-OVRD-BY-R78             VALUE '1'.
  2262                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2263                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2264                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2265                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2266                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2267                 88  ST-OVRD-MEAN               VALUE '8'.
  2268                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL106.cbl
  2269             20  FILLER                     PIC X.
  2270
  2271         16  CF-ST-COMMISSION-CAPS.
  2272             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2273             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2274             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2275             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2276         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2277                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2278
  2279         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2280
  2281         16  CF-ST-STATUTORY-INTEREST.
  2282             20  CF-ST-STAT-DATE-FROM       PIC X.
  2283                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2284                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2285             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2286             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2287             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2288             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2289             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2290
  2291         16  CF-ST-OVER-SHORT.
  2292             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2293             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2294
  2295         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2296
  2297         16  CF-ST-RT-CALC                  PIC X.
  2298
  2299         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2300         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2301         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2302         16  CF-ST-RF-LR-CALC               PIC X.
  2303         16  CF-ST-RF-LL-CALC               PIC X.
  2304         16  CF-ST-RF-LN-CALC               PIC X.
  2305         16  CF-ST-RF-AH-CALC               PIC X.
  2306         16  CF-ST-RF-CP-CALC               PIC X.
  2307*        16  FILLER                         PIC X(206).
  2308*CIDMOD         16  FILLER                         PIC X(192).
  2309         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2310             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2311         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2312         16  CF-ST-VFY-2ND-BENE             PIC X.
  2313         16  FILLER                         PIC X(186).
  2314
  2315****************************************************************
  2316*             BENEFIT MASTER RECORD                            *
  2317****************************************************************
  2318
  2319     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2320         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2321             20  CF-BENEFIT-CODE            PIC XX.
  2322             20  CF-BENEFIT-NUMERIC  REDEFINES
  2323                 CF-BENEFIT-CODE            PIC XX.
  2324             20  CF-BENEFIT-ALPHA           PIC XXX.
  2325             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2326             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL106.cbl
  2327
  2328             20  CF-LF-COVERAGE-TYPE        PIC X.
  2329                 88  CF-REDUCING                VALUE 'R'.
  2330                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2331
  2332             20  CF-SPECIAL-CALC-CD         PIC X.
  2333                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2334                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2335                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2336                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2337                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2338                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2339                 88  CF-FARM-PLAN               VALUE 'F'.
  2340                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2341                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2342                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2343                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2344                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2345                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2346                 88  CF-PRUDENTIAL              VALUE 'P'.
  2347                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2348                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2349                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2350                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2351                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2352                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2353
  2354             20  CF-JOINT-INDICATOR         PIC X.
  2355                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2356
  2357*            20  FILLER                     PIC X(12).
  2358             20  FILLER                     PIC X(11).
  2359             20  CF-BENEFIT-CATEGORY        PIC X.
  2360             20  CF-LOAN-TYPE               PIC X(8).
  2361
  2362             20  CF-CO-REM-TERM-CALC        PIC X.
  2363                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2364                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2365                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2366                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2367                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2368
  2369             20  CF-CO-EARNINGS-CALC        PIC X.
  2370                 88  CO-EARN-BY-R78             VALUE '1'.
  2371                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2372                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2373                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2374                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2375                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2376                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2377                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2378
  2379             20  CF-CO-REFUND-CALC          PIC X.
  2380                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2381                 88  CO-REFD-BY-R78             VALUE '1'.
  2382                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2383                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2384                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL106.cbl
  2385                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2386                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2387                 88  CO-REFD-MEAN               VALUE '8'.
  2388                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2389                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2390                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2391
  2392             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2393                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2394                 88  CO-OVRD-BY-R78             VALUE '1'.
  2395                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2396                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2397                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2398                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2399                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2400                 88  CO-OVRD-MEAN               VALUE '8'.
  2401                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2402
  2403             20  CF-CO-BEN-I-G-CD           PIC X.
  2404                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2405                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2406                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2407
  2408         16  FILLER                         PIC X(304).
  2409
  2410
  2411****************************************************************
  2412*             CARRIER MASTER RECORD                            *
  2413****************************************************************
  2414
  2415     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2416         16  CF-ADDRESS-DATA.
  2417             20  CF-MAIL-TO-NAME            PIC X(30).
  2418             20  CF-IN-CARE-OF              PIC X(30).
  2419             20  CF-ADDRESS-LINE-1          PIC X(30).
  2420             20  CF-ADDRESS-LINE-2          PIC X(30).
  2421             20  CF-CITY-STATE              PIC X(30).
  2422             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2423             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2424
  2425         16  CF-CLAIM-NO-CONTROL.
  2426             20  CF-CLAIM-NO-METHOD         PIC X.
  2427                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2428                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2429                 88  CLAIM-NO-SEQ               VALUE '3'.
  2430                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2431             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2432                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2433                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2434                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2435
  2436         16  CF-CHECK-NO-CONTROL.
  2437             20  CF-CHECK-NO-METHOD         PIC X.
  2438                 88  CHECK-NO-MANUAL            VALUE '1'.
  2439                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2440                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2441                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2442             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL106.cbl
  2443                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2444
  2445         16  CF-DOMICILE-STATE              PIC XX.
  2446
  2447         16  CF-EXPENSE-CONTROLS.
  2448             20  CF-EXPENSE-METHOD          PIC X.
  2449                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2450                 88  DOLLARS-PER-PMT            VALUE '2'.
  2451                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2452                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2453             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2454             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2455
  2456         16  CF-CORRESPONDENCE-CONTROL.
  2457             20  CF-LETTER-RESEND-OPT       PIC X.
  2458                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2459                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2460             20  FILLER                     PIC X(4).
  2461
  2462         16  CF-RESERVE-CONTROLS.
  2463             20  CF-MANUAL-SW               PIC X.
  2464                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2465             20  CF-FUTURE-SW               PIC X.
  2466                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2467             20  CF-PTC-SW                  PIC X.
  2468                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2469             20  CF-IBNR-SW                 PIC X.
  2470                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2471             20  CF-PTC-LF-SW               PIC X.
  2472                 88  CF-LF-PTC-USED             VALUE '1'.
  2473             20  CF-CDT-ACCESS-METHOD       PIC X.
  2474                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2475                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2476                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2477             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2478
  2479         16  CF-CLAIM-CALC-METHOD           PIC X.
  2480             88  360-PLUS-MONTHS                VALUE '1'.
  2481             88  365-PLUS-MONTHS                VALUE '2'.
  2482             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2483             88  360-DAILY                      VALUE '4'.
  2484             88  365-DAILY                      VALUE '5'.
  2485
  2486         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2487         16  FILLER                         PIC X(11).
  2488
  2489         16  CF-LIMIT-AMOUNTS.
  2490             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2491             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2492             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2493             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2494             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2495             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2496             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2497             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2498             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2499             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2500
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL106.cbl
  2501         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2502         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2503         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2504
  2505         16  CF-ZIP-CODE.
  2506             20  CF-ZIP-PRIME.
  2507                 24  CF-ZIP-1ST             PIC X.
  2508                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2509                 24  FILLER                 PIC X(4).
  2510             20  CF-ZIP-PLUS4               PIC X(4).
  2511         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2512             20  CF-CAN-POSTAL-1            PIC XXX.
  2513             20  CF-CAN-POSTAL-2            PIC XXX.
  2514             20  FILLER                     PIC XXX.
  2515
  2516         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2517         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2518         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2519
  2520         16  CF-RATING-SWITCH               PIC X.
  2521             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2522             88  CF-NO-RATING                   VALUE 'N'.
  2523
  2524         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2525
  2526         16  CF-CARRIER-OVER-SHORT.
  2527             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2528             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2529
  2530         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2531         16  CF-SECPAY-SWITCH               PIC X.
  2532             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2533             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2534         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2535         16  FILLER                         PIC X(448).
  2536*        16  FILLER                         PIC X(452).
  2537
  2538
  2539****************************************************************
  2540*             MORTALITY MASTER RECORD                          *
  2541****************************************************************
  2542
  2543     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2544         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2545                                INDEXED BY CF-MORT-NDX.
  2546             20  CF-MORT-TABLE              PIC X(5).
  2547             20  CF-MORT-TABLE-TYPE         PIC X.
  2548                 88  CF-MORT-JOINT              VALUE 'J'.
  2549                 88  CF-MORT-SINGLE             VALUE 'S'.
  2550                 88  CF-MORT-COMBINED           VALUE 'C'.
  2551                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2552                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2553             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2554             20  CF-MORT-AGE-METHOD         PIC XX.
  2555                 88  CF-AGE-LAST                VALUE 'AL'.
  2556                 88  CF-AGE-NEAR                VALUE 'AN'.
  2557             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2558             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL106.cbl
  2559                                            PIC X.
  2560                 88  CF-MINUS                   VALUE '-'.
  2561                 88  CF-PLUS                    VALUE '+'.
  2562             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2563             20  CF-MORT-JOINT-CODE         PIC X.
  2564                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2565             20  CF-MORT-PC-Q               PIC X.
  2566                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2567             20  CF-MORT-TABLE-CODE         PIC X(4).
  2568             20  CF-MORT-COMMENTS           PIC X(15).
  2569             20  FILLER                     PIC X(14).
  2570
  2571         16  FILLER                         PIC X(251).
  2572
  2573
  2574****************************************************************
  2575*             BUSSINESS TYPE MASTER RECORD                     *
  2576****************************************************************
  2577
  2578     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2579* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2580* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2581* AND RECORD 05 IS TYPES 81-99
  2582         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2583             20  CF-BUSINESS-TITLE          PIC  X(19).
  2584             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2585                                            PIC S9V9(4) COMP-3.
  2586             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2587             20  FILLER                     PIC  X.
  2588         16  FILLER                         PIC  X(248).
  2589
  2590
  2591****************************************************************
  2592*             TERMINAL MASTER RECORD                           *
  2593****************************************************************
  2594
  2595     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2596
  2597         16  CF-COMPANY-TERMINALS.
  2598             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2599                                  PIC X(4).
  2600         16  FILLER               PIC X(248).
  2601
  2602
  2603****************************************************************
  2604*             LIFE EDIT MASTER RECORD                          *
  2605****************************************************************
  2606
  2607     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2608         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2609             20  CF-LIFE-CODE-IN            PIC XX.
  2610             20  CF-LIFE-CODE-OUT           PIC XX.
  2611         16  FILLER                         PIC X(248).
  2612
  2613
  2614****************************************************************
  2615*             AH EDIT MASTER RECORD                            *
  2616****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL106.cbl
  2617
  2618     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2619         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2620             20  CF-AH-CODE-IN              PIC XXX.
  2621             20  CF-AH-CODE-OUT             PIC XX.
  2622         16  FILLER                         PIC X(248).
  2623
  2624
  2625****************************************************************
  2626*             CREDIBILITY TABLES                               *
  2627****************************************************************
  2628
  2629     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2630         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2631                             INDEXED BY CF-CRDB-NDX.
  2632             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2633             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2634             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2635         16  FILLER                         PIC  X(332).
  2636
  2637
  2638****************************************************************
  2639*             REPORT CUSTOMIZATION RECORD                      *
  2640****************************************************************
  2641
  2642     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2643         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2644             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2645             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2646             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2647**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2648****       A T-TRANSFER.                                   ****
  2649             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2650
  2651         16  FILLER                         PIC XX.
  2652
  2653         16  CF-CARRIER-CNTL-OPT.
  2654             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2655                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2656                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2657             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2658                                            PIC X.
  2659         16  CF-GROUP-CNTL-OPT.
  2660             20  CF-GROUP-OPT-SEQ           PIC 9.
  2661                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2662                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2663             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2664                                            PIC X(6).
  2665         16  CF-STATE-CNTL-OPT.
  2666             20  CF-STATE-OPT-SEQ           PIC 9.
  2667                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2668                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2669             20  CF-STATE-SELECT OCCURS 3 TIMES
  2670                                            PIC XX.
  2671         16  CF-ACCOUNT-CNTL-OPT.
  2672             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2673                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2674                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL106.cbl
  2675             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2676                                            PIC X(10).
  2677         16  CF-BUS-TYP-CNTL-OPT.
  2678             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2679                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2680                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2681             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2682                                            PIC XX.
  2683         16  CF-LF-TYP-CNTL-OPT.
  2684             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2685                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2686                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2687             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2688                                            PIC XX.
  2689         16  CF-AH-TYP-CNTL-OPT.
  2690             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2691                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2692                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2693             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2694                                            PIC XX.
  2695         16  CF-REPTCD1-CNTL-OPT.
  2696             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2697                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2698                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2699             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2700                                            PIC X(10).
  2701         16  CF-REPTCD2-CNTL-OPT.
  2702             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2703                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2704                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2705             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2706                                            PIC X(10).
  2707         16  CF-USER1-CNTL-OPT.
  2708             20  CF-USER1-OPT-SEQ           PIC 9.
  2709                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2710                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2711             20  CF-USER1-SELECT OCCURS 3 TIMES
  2712                                            PIC X(10).
  2713         16  CF-USER2-CNTL-OPT.
  2714             20  CF-USER2-OPT-SEQ           PIC 9.
  2715                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2716                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2717             20  CF-USER2-SELECT OCCURS 3 TIMES
  2718                                            PIC X(10).
  2719         16  CF-USER3-CNTL-OPT.
  2720             20  CF-USER3-OPT-SEQ           PIC 9.
  2721                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2722                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2723             20  CF-USER3-SELECT OCCURS 3 TIMES
  2724                                            PIC X(10).
  2725         16  CF-USER4-CNTL-OPT.
  2726             20  CF-USER4-OPT-SEQ           PIC 9.
  2727                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2728                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2729             20  CF-USER4-SELECT OCCURS 3 TIMES
  2730                                            PIC X(10).
  2731         16  CF-USER5-CNTL-OPT.
  2732             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL106.cbl
  2733                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2734                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2735             20  CF-USER5-SELECT OCCURS 3 TIMES
  2736                                            PIC X(10).
  2737         16  CF-REINS-CNTL-OPT.
  2738             20  CF-REINS-OPT-SEQ           PIC 9.
  2739                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2740                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2741             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2742                 24  CF-REINS-PRIME         PIC XXX.
  2743                 24  CF-REINS-SUB           PIC XXX.
  2744
  2745         16  CF-AGENT-CNTL-OPT.
  2746             20  CF-AGENT-OPT-SEQ           PIC 9.
  2747                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2748                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2749             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2750                                            PIC X(10).
  2751
  2752         16  FILLER                         PIC X(43).
  2753
  2754         16  CF-LOSS-RATIO-SELECT.
  2755             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2756             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2757         16  CF-ENTRY-DATE-SELECT.
  2758             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2759             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2760         16  CF-EFFECTIVE-DATE-SELECT.
  2761             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2762             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2763
  2764         16  CF-EXCEPTION-LIST-IND          PIC X.
  2765             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2766
  2767         16  FILLER                         PIC X(318).
  2768
  2769****************************************************************
  2770*                  EXCEPTION REPORTING RECORD                  *
  2771****************************************************************
  2772
  2773     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2774         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2775             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2776
  2777         16  CF-COMBINED-LIFE-AH-OPT.
  2778             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2779             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2780             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2781             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2782
  2783         16  CF-LIFE-OPT.
  2784             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2785             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2786             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2787             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2788             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2789             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2790             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL106.cbl
  2791             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2792             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2793             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2794
  2795         16  CF-AH-OPT.
  2796             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2797             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2798             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2799             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2800             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2801             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2802             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2803             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2804             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2805             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2806
  2807         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2808             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2809             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2810             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2811
  2812         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2813
  2814         16  FILLER                         PIC X(673).
  2815
  2816
  2817****************************************************************
  2818*             MORTGAGE SYSTEM PLAN RECORD                      *
  2819****************************************************************
  2820
  2821     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2822         16  CF-PLAN-TYPE                   PIC X.
  2823             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2824             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2825             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2826         16  CF-PLAN-ABBREV                 PIC XXX.
  2827         16  CF-PLAN-DESCRIPT               PIC X(10).
  2828         16  CF-PLAN-NOTES                  PIC X(20).
  2829         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2830         16  CF-PLAN-UNDERWRITING.
  2831             20  CF-PLAN-TERM-DATA.
  2832                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2833                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2834             20  CF-PLAN-AGE-DATA.
  2835                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2836                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2837                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2838             20  CF-PLAN-BENEFIT-DATA.
  2839                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2840                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2841                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2842                                            PIC S9(7)V99  COMP-3.
  2843         16  CF-PLAN-POLICY-FORMS.
  2844             20  CF-POLICY-FORM             PIC X(12).
  2845             20  CF-MASTER-APPLICATION      PIC X(12).
  2846             20  CF-MASTER-POLICY           PIC X(12).
  2847         16  CF-PLAN-RATING.
  2848             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL106.cbl
  2849             20  CF-SEX-RATING              PIC X.
  2850                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2851                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2852             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2853             20  CF-SUB-STD-TYPE            PIC X.
  2854                 88  CF-PCT-OF-PREM            VALUE '1'.
  2855                 88  CF-PCT-OF-BENE            VALUE '2'.
  2856         16  CF-PLAN-PREM-TOLERANCES.
  2857             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2858             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2859         16  CF-PLAN-PYMT-TOLERANCES.
  2860             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2861             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2862         16  CF-PLAN-MISC-DATA.
  2863             20  FILLER                     PIC X.
  2864             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2865             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2866         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2867         16  CF-PLAN-IND-GRP                PIC X.
  2868             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2869                                                     '1'.
  2870             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2871                                                     '2'.
  2872         16  CF-MIB-SEARCH-SW               PIC X.
  2873             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2874             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2875             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2876             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2877         16  CF-ALPHA-SEARCH-SW             PIC X.
  2878             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2879             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2880             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2881             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2882             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2883             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2884             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2885             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2886             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2887             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2888                                                     'A' 'B' 'C'
  2889                                                     'X' 'Y' 'Z'.
  2890         16  CF-EFF-DT-RULE-SW              PIC X.
  2891             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2892             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2893             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2894             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2895             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2896         16  FILLER                         PIC X(4).
  2897         16  CF-HEALTH-QUESTIONS            PIC X.
  2898             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2899         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2900         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2901         16  CF-PLAN-SNGL-JNT               PIC X.
  2902             88  CF-COMBINED-PLAN              VALUE 'C'.
  2903             88  CF-JNT-PLAN                   VALUE 'J'.
  2904             88  CF-SNGL-PLAN                  VALUE 'S'.
  2905         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2906         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL106.cbl
  2907         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2908         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2909         16  CF-RERATE-CNTL                 PIC  X.
  2910             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2911             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2912             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2913             88  CF-AUTO-RECALC                 VALUE '4'.
  2914         16  CF-BENEFIT-TYPE                PIC  X.
  2915             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2916             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2917         16  CF-POLICY-FEE                  PIC S999V99
  2918                                                    COMP-3.
  2919         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2920         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2921         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2922         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2923         16  FILLER                         PIC  X(32).
  2924         16  CF-TERMINATION-FORM            PIC  X(04).
  2925         16  FILLER                         PIC  X(08).
  2926         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2927                                                       COMP-3.
  2928         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2929         16  CF-ISSUE-LETTER                PIC  X(4).
  2930         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2931         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2932             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2933             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2934         16  CF-MP-REFUND-CALC              PIC X.
  2935             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2936             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2937             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2938             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2939             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2940             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2941             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2942             88  CF-MP-REFD-MEAN                VALUE '8'.
  2943         16  CF-ALT-RATE-CODE               PIC  X(5).
  2944
  2945
  2946         16  FILLER                         PIC X(498).
  2947****************************************************************
  2948*             MORTGAGE COMPANY MASTER RECORD                   *
  2949****************************************************************
  2950
  2951     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2952         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2953         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2954             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2955             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2956             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2957             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2958             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2959
  2960         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2961         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2962         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2963         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2964         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL106.cbl
  2965
  2966         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2967             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2968         16  CF-MP-RECON-USE-IND            PIC X(1).
  2969             88  CF-MP-USE-RECON             VALUE 'Y'.
  2970         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2971             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2972         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2973             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2974             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2975         16  FILLER                         PIC X(1).
  2976         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2977             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2978         16  CF-MORTG-MIB-VERSION           PIC X.
  2979             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2980             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2981             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2982         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2983             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2984                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2985             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2986                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2987             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2988                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2989             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2990                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2991             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2992                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2993             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2994                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2995         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2996         16  FILLER                         PIC X(7).
  2997         16  CF-MORTG-DESTINATION-SYMBOL.
  2998             20  CF-MORTG-MIB-COMM          PIC X(5).
  2999             20  CF-MORTG-MIB-TERM          PIC X(5).
  3000         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3001             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3002         16  FILLER                         PIC X(03).
  3003         16  CF-MP-CHECK-NO-CONTROL.
  3004             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3005                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3006                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3007                                                ' ' LOW-VALUES.
  3008                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3009                                               VALUE '3'.
  3010         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3011         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3012         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3013             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3014                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3015             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3016                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3017             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3018                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3019             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3020                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3021             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3022                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL106.cbl
  3023             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3024                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3025         16  CF-MORTG-BILLING-AREA.
  3026             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3027                                            PIC X.
  3028         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3029         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3030         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3031         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3032             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3033             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3034         16  FILLER                         PIC X.
  3035         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3036             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3037             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3038         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3039         16  FILLER                         PIC X(8).
  3040         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3041         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3042         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3043         16  CF-ACH-COMPANY-ID.
  3044             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3045                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3046                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3047                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3048             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3049         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3050             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3051         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3052             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3053             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3054         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3055         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3056         16  FILLER                         PIC X(536).
  3057
  3058****************************************************************
  3059*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3060****************************************************************
  3061
  3062     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3063         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3064             20  CF-FEMALE-HEIGHT.
  3065                 24  CF-FEMALE-FT           PIC 99.
  3066                 24  CF-FEMALE-IN           PIC 99.
  3067             20  CF-FEMALE-MIN-WT           PIC 999.
  3068             20  CF-FEMALE-MAX-WT           PIC 999.
  3069         16  FILLER                         PIC X(428).
  3070
  3071     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3072         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3073             20  CF-MALE-HEIGHT.
  3074                 24  CF-MALE-FT             PIC 99.
  3075                 24  CF-MALE-IN             PIC 99.
  3076             20  CF-MALE-MIN-WT             PIC 999.
  3077             20  CF-MALE-MAX-WT             PIC 999.
  3078         16  FILLER                         PIC X(428).
  3079******************************************************************
  3080*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL106.cbl
  3081******************************************************************
  3082     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3083         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3084             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3085             20  CF-SYS-LETTER-ID           PIC X(04).
  3086             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3087             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3088             20  CF-SYS-RESET-SW            PIC X(01).
  3089             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3090             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3091
  3092         16  FILLER                         PIC X(50).
  3093
  3094         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3095             20  CF-USER-ACTIVE-SW          PIC X(01).
  3096             20  CF-USER-LETTER-ID          PIC X(04).
  3097             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3098             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3099             20  CF-USER-RESET-SW           PIC X(01).
  3100             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3101             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3102             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3103
  3104         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL106.cbl
  3106*    COPY ELCTEXT.
  3107******************************************************************
  3108*                                                                *
  3109*                                                                *
  3110*                            ELCTEXT.                            *
  3111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3112*                            VMOD=2.008                          *
  3113*                                                                *
  3114*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  3115*                                     FORM LETTERS,              *
  3116*                                     CERT FORM DISPLAY.
  3117*                                                                *
  3118*   FILE TYPE = VSAM,KSDS                                        *
  3119*   RECORD SIZE = 100   RECFORM = FIXED                          *
  3120*                                                                *
  3121*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  3122*       ALTERNATE INDEX = NONE                                   *
  3123*                                                                *
  3124*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  3125*       ALTERNATE INDEX = NONE                                   *
  3126*                                                                *
  3127*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3128*       ALTERNATE INDEX = NONE                                   *
  3129*                                                                *
  3130*   LOG = NO                                                     *
  3131*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3132******************************************************************
  3133 01  TEXT-FILES.
  3134     12  TEXT-FILE-ID                PIC XX.
  3135         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3136         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3137         88  HELP-FILE-TEXT             VALUE 'TH'.
  3138
  3139     12  TX-CONTROL-PRIMARY.
  3140         16  TX-COMPANY-CD           PIC X.
  3141             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3142         16  TX-ACCESS-CD-GENL       PIC X(12).
  3143
  3144         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3145             20  TX-LETTER-NO        PIC X(4).
  3146             20  FILLER              PIC X(8).
  3147
  3148         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3149             20  TX-FORM-NO          PIC X(12).
  3150
  3151         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3152             20  TX-HELP-TYPE        PIC X.
  3153                 88  HELP-FOR-GENERAL   VALUE ' '.
  3154                 88  HELP-BY-SCREEN     VALUE 'S'.
  3155                 88  HELP-BY-ERROR      VALUE 'E'.
  3156             20  TX-SCREEN-OR-ERROR  PIC X(4).
  3157                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3158             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3159                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3160             20  FILLER              PIC X(4).
  3161
  3162         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3163
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL106.cbl
  3164     12  TX-PROCESS-CONTROL          PIC XX.
  3165         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3166
  3167     12  TX-TEXT-LINE                PIC X(70).
  3168
  3169     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3170         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3171         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3172         88  TX-VALID-FORM-SQUEEZE-VALUE
  3173                                        VALUE 'Y' ' '.
  3174
  3175     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3176         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3177         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3178         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3179         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3180         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3181         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3182         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  3183                                              'K' 'N' ' '
  3184                                              'Z'.
  3185
  3186     12  TX-ARCHIVE-SW               PIC X.
  3187         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  3188         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3189         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3190
  3191     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3192     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3193
  3194     12  TX-BSR-CODE                 PIC X.
  3195         88  TX-BSR-LETTER              VALUE 'B'.
  3196         88  TX-NON-BSR-LETTER          VALUE ' '.
  3197
  3198     12  FILLER                      PIC X.
  3199*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL106.cbl
  3201 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  3202                          TEXT-FILES.
  3203 0000-DFHEXIT SECTION.
  3204     MOVE '9#                    $   ' TO DFHEIV0.
  3205     MOVE 'EL106' TO DFHEIV1.
  3206     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3207
  3208     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3209     MOVE '5'                   TO DC-OPTION-CODE.
  3210     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3211     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3212     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  3213
  3214     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  3215     MOVE 2                     TO EMI-NUMBER-OF-LINES
  3216                                   EMI-SWITCH2.
  3217
  3218     MOVE EIBTRMID              TO QID-TERM.
  3219
  3220     IF EIBCALEN = 0
  3221         GO TO 8800-UNAUTHORIZED-ACCESS.
  3222
  3223     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3224         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  3225       ELSE
  3226         MOVE SPACES             TO RETURNED-FROM.
  3227
  3228     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3229         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3230             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3231             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3232             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3233             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3234             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3235             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3236             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3237             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3238             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  3239         ELSE
  3240             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3241             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3242             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3243             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3244             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3245             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3246             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3247             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  3248
  3249     MOVE 'N' TO WS-DISPLAY-SW.
  3250
  3251
  3252* EXEC CICS HANDLE CONDITION
  3253*        DUPREC  (8850-DUPREC)
  3254*        NOTOPEN (8870-NOTOPEN)
  3255*        NOTFND  (8880-NOT-FOUND)
  3256*        PGMIDERR(9600-PGMID-ERROR)
  3257*        ERROR   (9990-ABEND)
  3258*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL106.cbl
  3259*    MOVE '"$%JIL.               ! " #00003247' TO DFHEIV0
  3260     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  3261     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3262     MOVE X'2220233030303033323437' TO DFHEIV0(25:11)
  3263     CALL 'kxdfhei1' USING DFHEIV0
  3264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3265
  3266
  3267     IF EIBTRNID NOT = TRANS-ID
  3268       IF RETURNED-FROM = XCTL-EL6565
  3269           MOVE LOW-VALUES           TO EL106AO
  3270           PERFORM 6500-RECOVER-TEMP-STORAGE THRU 6500-EXIT
  3271           GO TO 8100-SEND-INITIAL-MAP
  3272        ELSE
  3273       IF RETURNED-FROM = XCTL-EL1061
  3274           MOVE LOW-VALUES           TO EL106AO
  3275           IF PI-WS-STATE EQUAL LOW-VALUES OR SPACES
  3276               GO TO 8100-SEND-INITIAL-MAP
  3277           ELSE
  3278               MOVE PI-WS-STATE TO STCDI
  3279               MOVE 'Y' TO WS-DISPLAY-SW
  3280               GO TO 1000-SHOW-STATE
  3281        ELSE
  3282       IF PI-RETURN-TO-PROGRAM = XCTL-EL6507
  3283           MOVE LOW-VALUES           TO EL106AO
  3284           IF PI-WS-STATE EQUAL LOW-VALUES OR SPACES
  3285               GO TO 8100-SEND-INITIAL-MAP
  3286           ELSE
  3287               MOVE PI-WS-STATE TO STCDI
  3288               MOVE 'Y' TO WS-DISPLAY-SW
  3289               GO TO 1000-SHOW-STATE
  3290        ELSE
  3291         MOVE LOW-VALUES           TO EL106AO
  3292         GO TO 8100-SEND-INITIAL-MAP.
  3293
  3294     IF EIBAID = DFHCLEAR
  3295         GO TO 9400-CLEAR.
  3296
  3297     IF NOT DISPLAY-CAP
  3298         MOVE 'READ'         TO SM-READ
  3299         PERFORM 9995-SECURITY-VIOLATION
  3300         MOVE ER-0070        TO EMI-ERROR
  3301         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3302         GO TO 8100-SEND-INITIAL-MAP.
  3303
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL106.cbl
  3305 0200-RECEIVE.
  3306     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3307         MOVE LOW-VALUES TO EL106AI
  3308         MOVE ER-7008    TO EMI-ERROR
  3309         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3310         MOVE -1 TO MAINTL
  3311         GO TO 8200-SEND-DATAONLY.
  3312
  3313
  3314* EXEC CICS RECEIVE
  3315*        MAP   (MAP-NAME)
  3316*        MAPSET(MAPSET-NAME)
  3317*        INTO  (EL106AI)
  3318*    END-EXEC.
  3319     MOVE LENGTH OF
  3320      EL106AI
  3321       TO DFHEIV11
  3322*    MOVE '8"T I  L              ''   #00003301' TO DFHEIV0
  3323     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3324     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3325     MOVE X'2020233030303033333031' TO DFHEIV0(25:11)
  3326     CALL 'kxdfhei1' USING DFHEIV0,
  3327           MAP-NAME,
  3328           EL106AI,
  3329           DFHEIV11,
  3330           MAPSET-NAME,
  3331           DFHEIV99,
  3332           DFHEIV99
  3333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3334
  3335
  3336     IF ENTERPFL = 0
  3337         GO TO 0300-CHECK-PFKEYS.
  3338
  3339     IF EIBAID NOT = DFHENTER
  3340         MOVE ER-0004 TO EMI-ERROR
  3341         GO TO 0320-INPUT-ERROR.
  3342
  3343     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  3344         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  3345     ELSE
  3346         MOVE ER-0029 TO EMI-ERROR
  3347         GO TO 0320-INPUT-ERROR.
  3348
  3349 0300-CHECK-PFKEYS.
  3350     IF EIBAID = DFHPF23
  3351         GO TO 8810-PF23.
  3352
  3353     IF EIBAID = DFHPF24
  3354         GO TO 9200-RETURN-MAIN-MENU.
  3355
  3356     IF EIBAID = DFHPF12
  3357         GO TO 9500-PF12.
  3358
  3359     IF MAINTL NOT = 0  AND
  3360        EIBAID NOT = DFHENTER
  3361          MOVE ER-0050 TO EMI-ERROR
  3362          GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL106.cbl
  3363
  3364     IF EIBAID = DFHPF1
  3365         GO TO 5000-FIND-NEXT-STATE.
  3366
  3367     IF EIBAID = DFHPF2
  3368         GO TO 5500-FIND-PREV-STATE.
  3369
  3370     IF EIBAID = DFHPF3
  3371         IF NOT MORTGAGE-SESSION
  3372             IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  3373                 MOVE ER-0029        TO  EMI-ERROR
  3374                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3375                 MOVE -1             TO  ENTERPFL
  3376                 MOVE AL-UNBON       TO  ENTERPFA
  3377                 GO TO 8200-SEND-DATAONLY
  3378             ELSE
  3379                 MOVE PI-PREV-STATE  TO  PI-WS-STATE
  3380                 MOVE SPACES         TO  PI-WS-CLASS
  3381                                         PI-WS-DEV
  3382                                         PI-WS-TYPE
  3383                                         PI-WS-PLAN
  3384                 PERFORM 6400-CREATE-TEMP-STORAGE THRU 6400-EXIT
  3385                 MOVE XCTL-EL6565    TO  PGM-NAME
  3386                 GO TO 9300-XCTL
  3387         ELSE
  3388             MOVE ER-7536 TO EMI-ERROR
  3389             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3390             MOVE AL-UNBON TO ENTERPFA
  3391             IF ENTERPFL = 0
  3392                 MOVE -1 TO MAINTL
  3393                 GO TO 8200-SEND-DATAONLY
  3394             ELSE
  3395                 MOVE -1 TO ENTERPFL
  3396                 GO TO 8200-SEND-DATAONLY.
  3397
  3398     IF EIBAID = DFHPF4
  3399         IF NOT MORTGAGE-SESSION
  3400             IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  3401                 MOVE ER-0029        TO  EMI-ERROR
  3402                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3403                 MOVE -1             TO  ENTERPFL
  3404                 MOVE AL-UNBON       TO  ENTERPFA
  3405                 GO TO 8200-SEND-DATAONLY
  3406             ELSE
  3407                 MOVE PI-PREV-STATE  TO  PI-WS-STATE
  3408                 MOVE SPACES         TO  PI-WS-CLASS
  3409                                         PI-WS-DEV
  3410                                         PI-WS-TYPE
  3411                                         PI-WS-PLAN
  3412                 MOVE XCTL-EL1061    TO  PGM-NAME
  3413                 GO TO 9300-XCTL
  3414         ELSE
  3415             MOVE ER-7536 TO EMI-ERROR
  3416             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3417             MOVE AL-UNBON TO ENTERPFA
  3418             IF ENTERPFL = 0
  3419                 MOVE -1 TO MAINTL
  3420                 GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL106.cbl
  3421             ELSE
  3422                 MOVE -1 TO ENTERPFL
  3423                 GO TO 8200-SEND-DATAONLY.
  3424
  3425     IF EIBAID = DFHENTER
  3426         GO TO 0330-EDIT-DATA.
  3427
  3428     MOVE ER-0029 TO EMI-ERROR.
  3429 0320-INPUT-ERROR.
  3430     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3431     MOVE AL-UNBON TO ENTERPFA.
  3432
  3433     IF ENTERPFL = 0
  3434         MOVE -1 TO MAINTL
  3435     ELSE
  3436         MOVE -1 TO ENTERPFL.
  3437
  3438     GO TO 8200-SEND-DATAONLY.
  3439
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL106.cbl
  3441 0330-EDIT-DATA.
  3442     IF STCDL = ZERO AND
  3443        STABRL = ZERO
  3444         MOVE ER-0144       TO EMI-ERROR
  3445         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3446         MOVE -1            TO STCDL
  3447         MOVE AL-UABON      TO STCDA
  3448         GO TO 8200-SEND-DATAONLY.
  3449
  3450     IF STCDL = ZERO AND
  3451        STABRL NOT = ZERO
  3452         PERFORM 0500-GET-STATE-CD THRU 0600-EXIT.
  3453
  3454     IF MAINTI = 'S'
  3455         GO TO 1000-SHOW-STATE.
  3456
  3457     IF MODIFY-CAP
  3458        NEXT SENTENCE
  3459       ELSE
  3460        IF MAINTI = 'A' OR 'C' OR 'D'
  3461         MOVE 'UPDATE'       TO SM-READ
  3462         PERFORM 9995-SECURITY-VIOLATION
  3463         MOVE ER-0070        TO EMI-ERROR
  3464         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3465         MOVE LOW-VALUES     TO EL106AO
  3466         GO TO 8100-SEND-INITIAL-MAP.
  3467
  3468     IF MAINTI = 'C'
  3469         GO TO 2000-CHANGE-STATE.
  3470
  3471     IF MAINTI = 'A'
  3472         GO TO 3000-ADD-STATE.
  3473
  3474     IF MAINTI = 'D'
  3475         GO TO 4000-DELETE-STATE.
  3476
  3477     MOVE ER-0023 TO EMI-ERROR.
  3478     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3479     MOVE -1       TO MAINTL.
  3480     MOVE AL-UABON TO MAINTA.
  3481     GO TO 8200-SEND-DATAONLY.
  3482
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL106.cbl
  3484 0500-GET-STATE-CD.
  3485     MOVE PI-COMPANY-ID  TO CK-COMP-ID.
  3486     MOVE LOW-VALUES     TO CK-STATE-CD.
  3487     MOVE +0             TO CK-SEQ.
  3488
  3489
  3490* EXEC CICS HANDLE CONDITION
  3491*        ENDFILE(8880-NOT-FOUND)
  3492*        NOTFND (8880-NOT-FOUND)
  3493*    END-EXEC.
  3494*    MOVE '"$''I                  ! # #00003460' TO DFHEIV0
  3495     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  3496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3497     MOVE X'2320233030303033343630' TO DFHEIV0(25:11)
  3498     CALL 'kxdfhei1' USING DFHEIV0
  3499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3500
  3501
  3502
  3503* EXEC CICS STARTBR
  3504*        DATASET  (ELCNTL-ID)
  3505*        RIDFLD   (ELCNTL-KEY)
  3506*    END-EXEC.
  3507     MOVE 0
  3508       TO DFHEIV11
  3509*    MOVE '&,         G          &   #00003465' TO DFHEIV0
  3510     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3511     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3512     MOVE X'2020233030303033343635' TO DFHEIV0(25:11)
  3513     CALL 'kxdfhei1' USING DFHEIV0,
  3514           ELCNTL-ID,
  3515           ELCNTL-KEY,
  3516           DFHEIV99,
  3517           DFHEIV11,
  3518           DFHEIV99
  3519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3520
  3521
  3522 0510-GET-NEXT-CD.
  3523
  3524* EXEC CICS READNEXT
  3525*        DATASET(ELCNTL-ID)
  3526*        SET    (ADDRESS OF CONTROL-FILE)
  3527*        RIDFLD (ELCNTL-KEY)
  3528*    END-EXEC.
  3529     MOVE 0
  3530       TO DFHEIV11
  3531*    MOVE '&.S                   )   #00003471' TO DFHEIV0
  3532     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3533     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3534     MOVE X'2020233030303033343731' TO DFHEIV0(25:11)
  3535     CALL 'kxdfhei1' USING DFHEIV0,
  3536           ELCNTL-ID,
  3537           DFHEIV20,
  3538           DFHEIV99,
  3539           ELCNTL-KEY,
  3540           DFHEIV99,
  3541           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL106.cbl
  3542           DFHEIV99,
  3543           DFHEIV99
  3544     SET ADDRESS OF CONTROL-FILE TO
  3545         DFHEIV20
  3546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3547
  3548
  3549     IF CF-COMPANY-ID NOT = PI-COMPANY-ID
  3550
  3551* EXEC CICS ENDBR
  3552*            DATASET  (ELCNTL-ID)
  3553*        END-EXEC
  3554     MOVE 0
  3555       TO DFHEIV11
  3556*    MOVE '&2                    $   #00003478' TO DFHEIV0
  3557     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3558     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3559     MOVE X'2020233030303033343738' TO DFHEIV0(25:11)
  3560     CALL 'kxdfhei1' USING DFHEIV0,
  3561           ELCNTL-ID,
  3562           DFHEIV11,
  3563           DFHEIV99
  3564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3565         GO TO 8880-NOT-FOUND.
  3566
  3567     IF CF-RECORD-TYPE NOT = '3'
  3568         GO TO 0510-GET-NEXT-CD.
  3569
  3570     IF CF-STATE-ABBREVIATION = STABRI
  3571         NEXT SENTENCE
  3572       ELSE
  3573         GO TO 0510-GET-NEXT-CD.
  3574
  3575     MOVE CF-STATE-CODE      TO STCDI.
  3576     MOVE AL-UANON           TO STCDA.
  3577     MOVE +2                 TO STCDL.
  3578
  3579
  3580* EXEC CICS ENDBR
  3581*        DATASET  (ELCNTL-ID)
  3582*    END-EXEC.
  3583     MOVE 0
  3584       TO DFHEIV11
  3585*    MOVE '&2                    $   #00003495' TO DFHEIV0
  3586     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3587     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3588     MOVE X'2020233030303033343935' TO DFHEIV0(25:11)
  3589     CALL 'kxdfhei1' USING DFHEIV0,
  3590           ELCNTL-ID,
  3591           DFHEIV11,
  3592           DFHEIV99
  3593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3594
  3595
  3596 0600-EXIT.
  3597      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL106.cbl
  3599 1000-SHOW-STATE.
  3600     IF RETURN-DISPLAY
  3601
  3602* EXEC CICS HANDLE CONDITION
  3603*            NOTFND  (8100-SEND-INITIAL-MAP)
  3604*        END-EXEC.
  3605*    MOVE '"$I                   ! $ #00003504' TO DFHEIV0
  3606     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3608     MOVE X'2420233030303033353034' TO DFHEIV0(25:11)
  3609     CALL 'kxdfhei1' USING DFHEIV0
  3610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3611
  3612
  3613     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  3614     MOVE STCDI         TO CK-STATE-CD
  3615                           PI-WS-STATE.
  3616
  3617
  3618* EXEC CICS READ
  3619*        DATASET(ELCNTL-ID)
  3620*        SET    (ADDRESS OF CONTROL-FILE)
  3621*        RIDFLD (ELCNTL-KEY)
  3622*    END-EXEC.
  3623*    MOVE '&"S        E          (   #00003512' TO DFHEIV0
  3624     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3625     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3626     MOVE X'2020233030303033353132' TO DFHEIV0(25:11)
  3627     CALL 'kxdfhei1' USING DFHEIV0,
  3628           ELCNTL-ID,
  3629           DFHEIV20,
  3630           DFHEIV99,
  3631           ELCNTL-KEY,
  3632           DFHEIV99,
  3633           DFHEIV99,
  3634           DFHEIV99
  3635     SET ADDRESS OF CONTROL-FILE TO
  3636         DFHEIV20
  3637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3638
  3639
  3640     GO TO 7000-BUILD-OUTPUT-MAP.
  3641
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL106.cbl
  3643 2000-CHANGE-STATE.
  3644     IF STCDI NOT = PI-PREV-STATE
  3645         MOVE ER-0145 TO EMI-ERROR
  3646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3647         MOVE -1       TO STCDL
  3648         MOVE AL-UABON TO STCDA
  3649         GO TO 8200-SEND-DATAONLY.
  3650
  3651     PERFORM 6000-EDIT-INPUT-DATA THRU 6099-EXIT.
  3652
  3653     IF NOT EMI-NO-ERRORS
  3654         GO TO 8200-SEND-DATAONLY.
  3655
  3656     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  3657     MOVE STCDI         TO CK-STATE-CD
  3658                           PI-WS-STATE.
  3659
  3660
  3661* EXEC CICS READ
  3662*        UPDATE
  3663*        DATASET(ELCNTL-ID)
  3664*        SET    (ADDRESS OF CONTROL-FILE)
  3665*        RIDFLD (ELCNTL-KEY)
  3666*    END-EXEC.
  3667*    MOVE '&"S        EU         (   #00003538' TO DFHEIV0
  3668     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3669     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3670     MOVE X'2020233030303033353338' TO DFHEIV0(25:11)
  3671     CALL 'kxdfhei1' USING DFHEIV0,
  3672           ELCNTL-ID,
  3673           DFHEIV20,
  3674           DFHEIV99,
  3675           ELCNTL-KEY,
  3676           DFHEIV99,
  3677           DFHEIV99,
  3678           DFHEIV99
  3679     SET ADDRESS OF CONTROL-FILE TO
  3680         DFHEIV20
  3681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3682
  3683
  3684     IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY    OR
  3685        CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
  3686
  3687* EXEC CICS UNLOCK
  3688*            DATASET(ELCNTL-ID)
  3689*        END-EXEC
  3690*    MOVE '&*                    #   #00003547' TO DFHEIV0
  3691     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3692     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3693     MOVE X'2020233030303033353437' TO DFHEIV0(25:11)
  3694     CALL 'kxdfhei1' USING DFHEIV0,
  3695           ELCNTL-ID,
  3696           DFHEIV99
  3697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3698         MOVE ER-0068 TO EMI-ERROR
  3699         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3700         GO TO 1000-SHOW-STATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL106.cbl
  3701
  3702     MOVE 'B'                    TO JP-RECORD-TYPE.
  3703     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  3704     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  3705
  3706     MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY.
  3707     MOVE EIBTIME         TO CF-LAST-MAINT-HHMMSS.
  3708     MOVE EIBDATE         TO DC-JULIAN-YYDDD.
  3709     MOVE '5'             TO DC-OPTION-CODE.
  3710     MOVE LINK-ELDATCV    TO PGM-NAME.
  3711
  3712
  3713* EXEC CICS LINK
  3714*        PROGRAM (PGM-NAME)
  3715*        COMMAREA(DATE-CONVERSION-DATA)
  3716*        LENGTH  (DC-COMM-LENGTH)
  3717*    END-EXEC.
  3718*    MOVE '."C                   ''   #00003564' TO DFHEIV0
  3719     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3720     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3721     MOVE X'2020233030303033353634' TO DFHEIV0(25:11)
  3722     CALL 'kxdfhei1' USING DFHEIV0,
  3723           PGM-NAME,
  3724           DATE-CONVERSION-DATA,
  3725           DC-COMM-LENGTH,
  3726           DFHEIV99,
  3727           DFHEIV99,
  3728           DFHEIV99
  3729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3730
  3731
  3732     IF DATE-CONVERSION-ERROR
  3733         MOVE LOW-VALUES          TO CF-LAST-MAINT-DT
  3734     ELSE
  3735         MOVE DC-BIN-DATE-1       TO CF-LAST-MAINT-DT.
  3736
  3737     IF STABRL NOT = ZEROS
  3738         MOVE STABRI              TO CF-STATE-ABBREVIATION.
  3739
  3740     IF STNAMEL NOT = ZEROS
  3741         MOVE STNAMEI             TO CF-STATE-NAME.
  3742
  3743     IF LFEXPL NOT = ZEROS
  3744         MOVE WS-ST-LF-EXP-PCT    TO CF-ST-LF-EXP-PCT.
  3745
  3746     IF AHEXPL NOT = ZEROS
  3747         MOVE WS-ST-AH-EXP-PCT    TO CF-ST-AH-EXP-PCT.
  3748
  3749     IF QUOTCALL NOT = ZEROS
  3750         MOVE QUOTCALI            TO CF-ST-TOL-CLAIM.
  3751
  3752     IF PREMTOLL NOT = ZEROS
  3753         MOVE PREMTOLI            TO CF-ST-TOL-PREM.
  3754
  3755     IF REFTOLL NOT = ZEROS
  3756         MOVE REFTOLI             TO CF-ST-TOL-REFUND.
  3757
  3758     IF OVSAMTL > 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL106.cbl
  3759         MOVE OVSAMTI TO CF-ST-OVR-SHT-AMT
  3760     END-IF.
  3761
  3762     IF PRMPCTL NOT = ZEROS
  3763         MOVE WS-ST-TOL-PREM-PCT  TO CF-ST-TOL-PREM-PCT.
  3764
  3765     IF REFPCTL NOT = ZEROS
  3766         MOVE  WS-ST-TOL-REF-PCT  TO CF-ST-TOL-REF-PCT.
  3767
  3768     IF OVSPCTL > +0
  3769         MOVE WS-ST-OVR-SHT-PCT TO CF-ST-OVR-SHT-PCT
  3770     END-IF.
  3771
  3772     IF CLREJECL NOT = ZEROS
  3773         MOVE CLREJECI            TO CF-ST-CLAIM-REJECT-SW.
  3774
  3775     IF ISSREJL NOT = ZEROS
  3776         MOVE ISSREJI             TO CF-ST-PREM-REJECT-SW.
  3777
  3778     IF REFREJL NOT = ZEROS
  3779         MOVE REFREJI             TO CF-ST-REF-REJECT-SW.
  3780
  3781     IF REFMINL NOT = ZEROS
  3782         MOVE REFMINI             TO CF-ST-REFUND-MIN.
  3783
  3784     IF REFDAY1L NOT = ZEROS
  3785         MOVE REFDAY1I            TO CF-ST-REFUND-DAYS-FIRST.
  3786
  3787     IF REFDAYSL NOT = ZEROS
  3788         MOVE REFDAYSI            TO CF-ST-REFUND-DAYS-SUBSEQ.
  3789
  3790     IF SPLPMTL NOT = ZEROS
  3791         MOVE SPLPMTI             TO CF-ST-SPLIT-PAYMENT.
  3792
  3793     IF EXTDAYSL NOT = ZEROS
  3794         MOVE EXTDAYSI            TO CF-ST-FST-PMT-DAYS-MAX.
  3795
  3796*    IF INTDAYSL NOT = ZEROS
  3797*        MOVE INTDAYSI            TO CF-ST-NO-DAYS-ELAPSED.
  3798
  3799     IF EXTCHGL NOT = ZEROS
  3800         MOVE EXTCHGI             TO CF-ST-FST-PMT-DAYS-CHG.
  3801
  3802     IF REMTERML NOT = ZEROS
  3803        MOVE REMTERMI             TO CF-ST-RT-CALC
  3804     END-IF
  3805
  3806     IF LFREDL NOT = ZEROS
  3807        MOVE LFREDI               TO CF-ST-RF-LR-CALC
  3808     END-IF
  3809
  3810     IF LFLEVL NOT = ZEROS
  3811        MOVE LFLEVI               TO CF-ST-RF-LL-CALC
  3812     END-IF
  3813
  3814     IF LFNETL NOT = ZEROS
  3815        MOVE LFNETI               TO CF-ST-RF-LN-CALC
  3816     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL106.cbl
  3817
  3818     IF AHAHL NOT = ZEROS
  3819        MOVE AHAHI                TO CF-ST-RF-AH-CALC
  3820     END-IF
  3821
  3822     IF AHCPL NOT = ZEROS
  3823        MOVE AHCPI                TO CF-ST-RF-CP-CALC
  3824     END-IF
  3825
  3826     IF LFTAXL > +0
  3827        MOVE WS-ST-LF-PREM-TAX   TO CF-ST-LF-PREM-TAX
  3828     END-IF
  3829
  3830     IF AHITAXL > +0
  3831        MOVE WS-ST-AH-PREM-TAX-I TO CF-ST-AH-PREM-TAX-I
  3832     END-IF
  3833
  3834     IF AHGTAXL > +0
  3835        MOVE WS-ST-AH-PREM-TAX-G TO CF-ST-AH-PREM-TAX-G
  3836     END-IF
  3837
  3838     IF REFCLML NOT = ZEROS
  3839         MOVE REFCLMI             TO CF-ST-REF-AH-DEATH-IND
  3840     END-IF.
  3841
  3842     IF VFYBENEL NOT = ZEROS
  3843         MOVE VFYBENEI            TO CF-ST-VFY-2ND-BENE
  3844     END-IF.
  3845
  3846     IF STUEL NOT = ZEROS
  3847         MOVE STUEI               TO CF-ST-CALL-UNEARNED.
  3848
  3849     IF STCNTLL NOT = ZEROS
  3850         MOVE STCNTLI            TO CF-ST-CALL-RPT-CNTL.
  3851
  3852     IF STDEVL NOT = ZEROS
  3853         MOVE STDEVI             TO CF-ST-CALL-RATE-DEV.
  3854
  3855     MOVE REPLAWI                TO CF-REPLACEMENT-LAW-SW.
  3856     MOVE REPLETRI               TO CF-REPLACEMENT-LETTER.
  3857
  3858     MOVE LIMITI                 TO CF-COMM-CAP-LIMIT-TO.
  3859
  3860*    MOVE STATII                 TO CF-ST-STAT-DATE-FROM.
  3861
  3862     IF WS-COMSL NUMERIC AND
  3863        WS-COMSL NOT = ZEROS
  3864         MOVE WS-COMSL           TO CF-ST-COMM-CAP-SL
  3865      ELSE
  3866         MOVE ZEROS              TO CF-ST-COMM-CAP-SL.
  3867
  3868     IF WS-COMJL NUMERIC AND
  3869        WS-COMJL NOT = ZEROS
  3870         MOVE WS-COMJL           TO CF-ST-COMM-CAP-JL
  3871      ELSE
  3872         MOVE ZEROS              TO CF-ST-COMM-CAP-JL.
  3873
  3874     IF WS-COMSA NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL106.cbl
  3875        WS-COMSA NOT = ZEROS
  3876         MOVE WS-COMSA           TO CF-ST-COMM-CAP-SA
  3877      ELSE
  3878         MOVE ZEROS              TO CF-ST-COMM-CAP-SA.
  3879
  3880     IF WS-COMJA NUMERIC AND
  3881        WS-COMJA NOT = ZEROS
  3882         MOVE WS-COMJA           TO CF-ST-COMM-CAP-JA
  3883      ELSE
  3884         MOVE ZEROS              TO CF-ST-COMM-CAP-JA.
  3885
  3886     IF WS-IRATE NUMERIC AND
  3887        WS-IRATE NOT = ZEROS
  3888         MOVE WS-IRATE           TO CF-ST-STAT-INTEREST
  3889      ELSE
  3890         MOVE ZEROS              TO CF-ST-STAT-INTEREST.
  3891
  3892     IF WS-IRATE1 NUMERIC AND
  3893        WS-IRATE1 NOT = ZEROS
  3894         MOVE WS-IRATE1          TO CF-ST-STAT-INTEREST-1
  3895      ELSE
  3896         MOVE ZEROS              TO CF-ST-STAT-INTEREST-1.
  3897
  3898     IF WS-IRATE2 NUMERIC AND
  3899        WS-IRATE2 NOT = ZEROS
  3900         MOVE WS-IRATE2          TO CF-ST-STAT-INTEREST-2
  3901      ELSE
  3902         MOVE ZEROS              TO CF-ST-STAT-INTEREST-2.
  3903
  3904     IF WS-IRATE3 NUMERIC AND
  3905        WS-IRATE3 NOT = ZEROS
  3906         MOVE WS-IRATE3          TO CF-ST-STAT-INTEREST-3
  3907      ELSE
  3908         MOVE ZEROS              TO CF-ST-STAT-INTEREST-3.
  3909
  3910     IF WS-RESIDENT-TAX NUMERIC AND
  3911        WS-RESIDENT-TAX NOT = ZEROS
  3912         MOVE WS-RESIDENT-TAX    TO CF-ST-RES-TAX-PCT
  3913      ELSE
  3914         MOVE ZEROS              TO CF-ST-RES-TAX-PCT.
  3915
  3916     IF WS-FREE-LOOK-DAYS NUMERIC
  3917             AND
  3918        WS-FREE-LOOK-DAYS NOT EQUAL ZEROS
  3919         MOVE WS-FREE-LOOK-DAYS  TO CF-ST-FREE-LOOK-PERIOD
  3920      ELSE
  3921         MOVE ZEROS              TO CF-ST-FREE-LOOK-PERIOD.
  3922
  3923     IF  WS-ST-TARGET-LOSS-RATIO NUMERIC
  3924             AND
  3925         WS-ST-TARGET-LOSS-RATIO NOT EQUAL ZEROS
  3926         MOVE WS-ST-TARGET-LOSS-RATIO
  3927                                 TO CF-ST-TARGET-LOSS-RATIO
  3928     ELSE
  3929         MOVE ZEROS              TO CF-ST-TARGET-LOSS-RATIO.
  3930
  3931     IF  WS-ST-CALC-INTEREST NUMERIC
  3932             AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL106.cbl
  3933         WS-ST-CALC-INTEREST NOT EQUAL ZEROS
  3934         MOVE WS-ST-CALC-INTEREST
  3935                                 TO CF-ST-CALC-INTEREST
  3936     ELSE
  3937         MOVE ZEROS              TO CF-ST-CALC-INTEREST.
  3938
  3939     MOVE 'C'                    TO JP-RECORD-TYPE.
  3940     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  3941
  3942* EXEC CICS REWRITE
  3943*        DATASET(ELCNTL-ID)
  3944*        FROM   (CONTROL-FILE)
  3945*    END-EXEC.
  3946     MOVE LENGTH OF
  3947      CONTROL-FILE
  3948       TO DFHEIV11
  3949*    MOVE '&& L                  %   #00003779' TO DFHEIV0
  3950     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3951     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3952     MOVE X'2020233030303033373739' TO DFHEIV0(25:11)
  3953     CALL 'kxdfhei1' USING DFHEIV0,
  3954           ELCNTL-ID,
  3955           CONTROL-FILE,
  3956           DFHEIV11,
  3957           DFHEIV99
  3958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3959
  3960
  3961     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  3962     MOVE ER-0000 TO EMI-ERROR.
  3963     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3964     MOVE LOW-VALUES  TO EL106AO.
  3965     MOVE -1          TO MAINTL.
  3966     MOVE SPACES      TO PI-PREV-STATE.
  3967     MOVE CK-STATE-CD TO STCDO.
  3968     MOVE AL-UANON    TO STCDA.
  3969     GO TO 1000-SHOW-STATE.
  3970
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL106.cbl
  3972 3000-ADD-STATE.
  3973     PERFORM 6000-EDIT-INPUT-DATA THRU 6099-EXIT.
  3974
  3975     IF NOT EMI-NO-ERRORS
  3976         GO TO 8200-SEND-DATAONLY.
  3977
  3978
  3979* EXEC CICS GETMAIN
  3980*        SET    (ADDRESS OF CONTROL-FILE)
  3981*        LENGTH (750)
  3982*        INITIMG(GETMAIN-SPACE)
  3983*    END-EXEC.
  3984     MOVE 750
  3985       TO DFHEIV11
  3986*    MOVE ',"IL                  $   #00003801' TO DFHEIV0
  3987     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3988     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3989     MOVE X'2020233030303033383031' TO DFHEIV0(25:11)
  3990     CALL 'kxdfhei1' USING DFHEIV0,
  3991           DFHEIV20,
  3992           DFHEIV11,
  3993           GETMAIN-SPACE
  3994     SET ADDRESS OF CONTROL-FILE TO
  3995         DFHEIV20
  3996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3997
  3998
  3999     MOVE 'CF'          TO CF-RECORD-ID.
  4000     MOVE PI-COMPANY-ID TO CF-COMPANY-ID.
  4001     MOVE '3'           TO CF-RECORD-TYPE.
  4002     MOVE STCDI         TO CF-ACCESS-OF-STATE.
  4003     MOVE +0            TO CF-SEQUENCE-NO.
  4004
  4005     MOVE EIBDATE       TO DC-JULIAN-YYDDD.
  4006     MOVE '5'           TO DC-OPTION-CODE.
  4007     MOVE LINK-ELDATCV  TO PGM-NAME.
  4008
  4009* EXEC CICS LINK
  4010*        PROGRAM (PGM-NAME)
  4011*        COMMAREA(DATE-CONVERSION-DATA)
  4012*        LENGTH  (DC-COMM-LENGTH)
  4013*    END-EXEC.
  4014*    MOVE '."C                   ''   #00003816' TO DFHEIV0
  4015     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4016     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4017     MOVE X'2020233030303033383136' TO DFHEIV0(25:11)
  4018     CALL 'kxdfhei1' USING DFHEIV0,
  4019           PGM-NAME,
  4020           DATE-CONVERSION-DATA,
  4021           DC-COMM-LENGTH,
  4022           DFHEIV99,
  4023           DFHEIV99,
  4024           DFHEIV99
  4025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4026
  4027
  4028     IF DATE-CONVERSION-ERROR
  4029         MOVE LOW-VALUES    TO CF-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL106.cbl
  4030       ELSE
  4031         MOVE DC-BIN-DATE-1 TO CF-LAST-MAINT-DT.
  4032
  4033     MOVE PI-PROCESSOR-ID   TO CF-LAST-MAINT-BY.
  4034     MOVE EIBTIME           TO CF-LAST-MAINT-HHMMSS.
  4035
  4036     MOVE STNAMEI           TO CF-STATE-NAME.
  4037     MOVE STABRI            TO CF-STATE-ABBREVIATION.
  4038
  4039     IF LFEXPL = ZEROS
  4040         MOVE ZEROS               TO CF-ST-LF-EXP-PCT
  4041       ELSE
  4042         MOVE WS-ST-LF-EXP-PCT    TO CF-ST-LF-EXP-PCT.
  4043
  4044     IF AHEXPL = ZEROS
  4045         MOVE ZEROS               TO CF-ST-AH-EXP-PCT
  4046       ELSE
  4047         MOVE WS-ST-AH-EXP-PCT    TO CF-ST-AH-EXP-PCT.
  4048
  4049     IF QUOTCALL = ZEROS
  4050         MOVE ZEROS               TO CF-ST-TOL-CLAIM
  4051       ELSE
  4052         MOVE QUOTCALI            TO CF-ST-TOL-CLAIM.
  4053
  4054     IF PREMTOLL = ZEROS
  4055         MOVE ZEROS               TO CF-ST-TOL-PREM
  4056       ELSE
  4057         MOVE PREMTOLI            TO CF-ST-TOL-PREM.
  4058
  4059     IF OVSAMTL = ZEROS
  4060         MOVE ZEROS              TO CF-ST-OVR-SHT-AMT
  4061       ELSE
  4062         MOVE OVSAMTI            TO CF-ST-OVR-SHT-AMT.
  4063
  4064     IF REFTOLL = ZEROS
  4065         MOVE ZEROS              TO CF-ST-TOL-REFUND
  4066       ELSE
  4067         MOVE REFTOLI            TO CF-ST-TOL-REFUND.
  4068
  4069     IF PRMPCTL = ZEROS
  4070         MOVE ZEROS              TO CF-ST-TOL-PREM-PCT
  4071       ELSE
  4072         MOVE WS-ST-TOL-PREM-PCT TO CF-ST-TOL-PREM-PCT.
  4073
  4074     IF OVSPCTL = ZEROS
  4075         MOVE ZEROS              TO CF-ST-OVR-SHT-PCT
  4076       ELSE
  4077         MOVE WS-ST-OVR-SHT-PCT  TO CF-ST-OVR-SHT-PCT.
  4078
  4079     IF REFPCTL = ZEROS
  4080         MOVE ZEROS              TO CF-ST-TOL-REF-PCT
  4081       ELSE
  4082         MOVE WS-ST-TOL-REF-PCT  TO CF-ST-TOL-REF-PCT.
  4083
  4084     IF CLREJECL = ZEROS
  4085         MOVE SPACE              TO CF-ST-CLAIM-REJECT-SW
  4086       ELSE
  4087         MOVE CLREJECI           TO CF-ST-CLAIM-REJECT-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL106.cbl
  4088
  4089     IF ISSREJL = ZEROS
  4090         MOVE SPACE              TO CF-ST-PREM-REJECT-SW
  4091       ELSE
  4092         MOVE ISSREJI            TO CF-ST-PREM-REJECT-SW.
  4093
  4094     IF REFREJL = ZEROS
  4095         MOVE SPACE              TO CF-ST-REF-REJECT-SW
  4096       ELSE
  4097         MOVE REFREJI            TO CF-ST-REF-REJECT-SW.
  4098
  4099     IF REFMINL = ZEROS
  4100         MOVE ZEROS              TO CF-ST-REFUND-MIN
  4101       ELSE
  4102         MOVE REFMINI            TO CF-ST-REFUND-MIN.
  4103
  4104     IF REFDAY1L  = ZERO
  4105         MOVE ZEROS              TO CF-ST-REFUND-DAYS-FIRST
  4106       ELSE
  4107         MOVE REFDAY1I           TO CF-ST-REFUND-DAYS-FIRST.
  4108
  4109     IF REFDAYSL = ZERO
  4110         MOVE ZEROS              TO CF-ST-REFUND-DAYS-SUBSEQ
  4111       ELSE
  4112         MOVE REFDAYSI           TO CF-ST-REFUND-DAYS-SUBSEQ.
  4113
  4114     IF SPLPMTL = ZERO
  4115         MOVE 'N'                TO CF-ST-SPLIT-PAYMENT
  4116     ELSE
  4117         MOVE SPLPMTI            TO CF-ST-SPLIT-PAYMENT.
  4118
  4119     IF EXTDAYSL = ZERO
  4120         MOVE ZEROS              TO CF-ST-FST-PMT-DAYS-MAX
  4121       ELSE
  4122         MOVE EXTDAYSI           TO CF-ST-FST-PMT-DAYS-MAX.
  4123
  4124*    IF INTDAYSL = ZERO
  4125*        MOVE ZEROS              TO CF-ST-NO-DAYS-ELAPSED
  4126*      ELSE
  4127*        MOVE INTDAYSI           TO CF-ST-NO-DAYS-ELAPSED.
  4128
  4129     IF EXTCHGL = ZEROS
  4130         MOVE SPACES             TO CF-ST-FST-PMT-DAYS-CHG
  4131       ELSE
  4132         MOVE EXTCHGI            TO CF-ST-FST-PMT-DAYS-CHG.
  4133
  4134     IF REMTERML = ZEROS
  4135        MOVE SPACES              TO CF-ST-RT-CALC
  4136     ELSE
  4137        MOVE REMTERMI            TO CF-ST-RT-CALC
  4138     END-IF
  4139
  4140     IF LFTAXL = ZEROS
  4141        MOVE ZEROS               TO CF-ST-LF-PREM-TAX
  4142     ELSE
  4143        MOVE WS-ST-LF-PREM-TAX   TO CF-ST-LF-PREM-TAX
  4144     END-IF
  4145
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL106.cbl
  4146     IF AHITAXL = ZEROS
  4147        MOVE ZEROS               TO CF-ST-AH-PREM-TAX-I
  4148     ELSE
  4149        MOVE WS-ST-AH-PREM-TAX-I TO CF-ST-AH-PREM-TAX-I
  4150     END-IF
  4151
  4152     IF AHGTAXL = ZEROS
  4153        MOVE ZEROS               TO CF-ST-AH-PREM-TAX-G
  4154     ELSE
  4155        MOVE WS-ST-AH-PREM-TAX-G TO CF-ST-AH-PREM-TAX-G
  4156     END-IF
  4157
  4158     IF STUEL = ZEROS
  4159         MOVE SPACES             TO CF-ST-CALL-UNEARNED
  4160       ELSE
  4161         MOVE STUEI              TO CF-ST-CALL-UNEARNED.
  4162
  4163     IF STCNTLL = ZEROS
  4164         MOVE SPACES             TO CF-ST-CALL-RPT-CNTL
  4165       ELSE
  4166         MOVE STCNTLI            TO CF-ST-CALL-RPT-CNTL.
  4167
  4168     IF STDEVL = ZEROS
  4169         MOVE SPACES             TO CF-ST-CALL-RATE-DEV
  4170       ELSE
  4171         MOVE STDEVI             TO CF-ST-CALL-RATE-DEV.
  4172
  4173     IF  WS-ST-TARGET-LOSS-RATIO NUMERIC
  4174             AND
  4175         WS-ST-TARGET-LOSS-RATIO NOT EQUAL ZEROS
  4176         MOVE WS-ST-TARGET-LOSS-RATIO
  4177                                 TO CF-ST-TARGET-LOSS-RATIO
  4178     ELSE
  4179         MOVE ZEROS              TO CF-ST-TARGET-LOSS-RATIO.
  4180
  4181     IF  WS-ST-CALC-INTEREST NUMERIC
  4182             AND
  4183         WS-ST-CALC-INTEREST NOT EQUAL ZEROS
  4184         MOVE WS-ST-CALC-INTEREST
  4185                                 TO CF-ST-CALC-INTEREST
  4186     ELSE
  4187         MOVE ZEROS              TO CF-ST-CALC-INTEREST.
  4188
  4189     MOVE REPLAWI                TO CF-REPLACEMENT-LAW-SW.
  4190     MOVE REPLETRI               TO CF-REPLACEMENT-LETTER.
  4191
  4192     MOVE LIMITI                 TO CF-COMM-CAP-LIMIT-TO.
  4193
  4194*    MOVE STATII                 TO CF-ST-STAT-DATE-FROM.
  4195
  4196     IF COMSLL = ZEROS
  4197         MOVE ZEROS              TO CF-ST-COMM-CAP-SL
  4198       ELSE
  4199         MOVE WS-COMSL           TO CF-ST-COMM-CAP-SL.
  4200
  4201     IF COMJLL = ZEROS
  4202         MOVE ZEROS              TO CF-ST-COMM-CAP-JL
  4203       ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL106.cbl
  4204         MOVE WS-COMJL           TO CF-ST-COMM-CAP-JL.
  4205
  4206     IF COMSAL = ZEROS
  4207         MOVE ZEROS              TO CF-ST-COMM-CAP-SA
  4208       ELSE
  4209         MOVE WS-COMSA           TO CF-ST-COMM-CAP-SA.
  4210
  4211     IF COMJAL = ZEROS
  4212         MOVE ZEROS              TO CF-ST-COMM-CAP-JA
  4213       ELSE
  4214         MOVE WS-COMJA           TO CF-ST-COMM-CAP-JA.
  4215
  4216     IF RESTAXL = ZEROS
  4217         MOVE ZEROS              TO CF-ST-RES-TAX-PCT
  4218       ELSE
  4219         MOVE WS-RESIDENT-TAX    TO CF-ST-RES-TAX-PCT.
  4220
  4221     IF FREELKL = ZEROS
  4222         MOVE ZEROS              TO CF-ST-FREE-LOOK-PERIOD
  4223       ELSE
  4224         MOVE WS-FREE-LOOK-DAYS  TO CF-ST-FREE-LOOK-PERIOD.
  4225
  4226*    IF STATRL = ZEROS
  4227         MOVE ZEROS              TO CF-ST-STAT-INTEREST
  4228*      ELSE
  4229*        MOVE WS-IRATE           TO CF-ST-STAT-INTEREST.
  4230
  4231*    IF STATR1L = ZEROS
  4232         MOVE ZEROS              TO CF-ST-STAT-INTEREST-1
  4233*      ELSE
  4234*        MOVE WS-IRATE1          TO CF-ST-STAT-INTEREST-1.
  4235
  4236*    IF STATR2L = ZEROS
  4237         MOVE ZEROS              TO CF-ST-STAT-INTEREST-2
  4238*      ELSE
  4239*        MOVE WS-IRATE2          TO CF-ST-STAT-INTEREST-2.
  4240
  4241*    IF STATR3L = ZEROS
  4242         MOVE ZEROS              TO CF-ST-STAT-INTEREST-3
  4243*      ELSE
  4244*        MOVE WS-IRATE3          TO CF-ST-STAT-INTEREST-3.
  4245
  4246     PERFORM 6100-INITIALIZE-BENEFIT-CNTL THRU 6199-EXIT
  4247             VARYING SUB FROM +1 BY +1
  4248             UNTIL SUB GREATER THAN +50.
  4249
  4250     MOVE 'A'                    TO JP-RECORD-TYPE.
  4251     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4252
  4253
  4254* EXEC CICS WRITE
  4255*        FROM   (CONTROL-FILE)
  4256*        DATASET(ELCNTL-ID)
  4257*        RIDFLD (CF-CONTROL-PRIMARY)
  4258*    END-EXEC.
  4259     MOVE LENGTH OF
  4260      CONTROL-FILE
  4261       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL106.cbl
  4262*    MOVE '&$ L                  ''   #00004047' TO DFHEIV0
  4263     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4264     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4265     MOVE X'2020233030303034303437' TO DFHEIV0(25:11)
  4266     CALL 'kxdfhei1' USING DFHEIV0,
  4267           ELCNTL-ID,
  4268           CONTROL-FILE,
  4269           DFHEIV11,
  4270           CF-CONTROL-PRIMARY,
  4271           DFHEIV99,
  4272           DFHEIV99
  4273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4274
  4275
  4276     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  4277     MOVE ER-0000 TO EMI-ERROR.
  4278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4279     MOVE LOW-VALUES  TO EL106AO.
  4280     MOVE -1          TO MAINTL.
  4281     MOVE SPACES      TO PI-PREV-STATE.
  4282     MOVE CK-STATE-CD TO STCDO.
  4283     MOVE AL-UANON    TO STCDA.
  4284     GO TO 8100-SEND-INITIAL-MAP.
  4285
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL106.cbl
  4287 4000-DELETE-STATE.
  4288     IF STCDI NOT = PI-PREV-STATE
  4289         MOVE ER-0145  TO EMI-ERROR
  4290         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4291         MOVE -1       TO STCDL
  4292         MOVE AL-UABON TO STCDA
  4293         GO TO 8200-SEND-DATAONLY.
  4294
  4295     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  4296     MOVE STCDI         TO CK-STATE-CD.
  4297
  4298* EXEC CICS READ
  4299*        UPDATE
  4300*        DATASET(ELCNTL-ID)
  4301*        SET    (ADDRESS OF CONTROL-FILE)
  4302*        RIDFLD (ELCNTL-KEY)
  4303*    END-EXEC.
  4304*    MOVE '&"S        EU         (   #00004074' TO DFHEIV0
  4305     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4306     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4307     MOVE X'2020233030303034303734' TO DFHEIV0(25:11)
  4308     CALL 'kxdfhei1' USING DFHEIV0,
  4309           ELCNTL-ID,
  4310           DFHEIV20,
  4311           DFHEIV99,
  4312           ELCNTL-KEY,
  4313           DFHEIV99,
  4314           DFHEIV99,
  4315           DFHEIV99
  4316     SET ADDRESS OF CONTROL-FILE TO
  4317         DFHEIV20
  4318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4319
  4320
  4321     IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY    OR
  4322        CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
  4323
  4324* EXEC CICS UNLOCK
  4325*            DATASET(ELCNTL-ID)
  4326*        END-EXEC
  4327*    MOVE '&*                    #   #00004083' TO DFHEIV0
  4328     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4329     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4330     MOVE X'2020233030303034303833' TO DFHEIV0(25:11)
  4331     CALL 'kxdfhei1' USING DFHEIV0,
  4332           ELCNTL-ID,
  4333           DFHEIV99
  4334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4335         MOVE ER-0068 TO EMI-ERROR
  4336         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4337         GO TO 1000-SHOW-STATE.
  4338
  4339     MOVE 'D'                    TO JP-RECORD-TYPE.
  4340     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4341
  4342* EXEC CICS DELETE
  4343*        DATASET(ELCNTL-ID)
  4344*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL106.cbl
  4345*    MOVE '&(                    &   #00004092' TO DFHEIV0
  4346     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4347     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4348     MOVE X'2020233030303034303932' TO DFHEIV0(25:11)
  4349     CALL 'kxdfhei1' USING DFHEIV0,
  4350           ELCNTL-ID,
  4351           DFHEIV99,
  4352           DFHEIV99,
  4353           DFHEIV99,
  4354           DFHEIV99
  4355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4356
  4357
  4358     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT
  4359     MOVE ER-0000 TO EMI-ERROR.
  4360     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4361     MOVE LOW-VALUES  TO EL106AO.
  4362     MOVE -1          TO MAINTL.
  4363     MOVE SPACES      TO PI-PREV-STATE
  4364     MOVE CK-STATE-CD TO STCDO.
  4365     MOVE AL-UANON    TO STCDA.
  4366     GO TO 8100-SEND-INITIAL-MAP.
  4367
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL106.cbl
  4369 5000-FIND-NEXT-STATE.
  4370     MOVE PI-COMPANY-ID  TO CK-COMP-ID.
  4371
  4372     IF STCDL = 0
  4373         MOVE LOW-VALUES TO CK-STATE-CD
  4374         MOVE +0         TO CK-SEQ
  4375     ELSE
  4376         MOVE STCDI      TO CK-STATE-CD
  4377         MOVE +1         TO CK-SEQ.
  4378
  4379     MOVE SPACES TO PI-PREV-STATE.
  4380
  4381
  4382* EXEC CICS HANDLE CONDITION
  4383*        NOTFND (8860-ENDFILE)
  4384*    END-EXEC.
  4385*    MOVE '"$I                   ! % #00004119' TO DFHEIV0
  4386     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4388     MOVE X'2520233030303034313139' TO DFHEIV0(25:11)
  4389     CALL 'kxdfhei1' USING DFHEIV0
  4390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4391
  4392
  4393
  4394* EXEC CICS READ
  4395*        DATASET(ELCNTL-ID)
  4396*        SET    (ADDRESS OF CONTROL-FILE)
  4397*        RIDFLD (ELCNTL-KEY)
  4398*        GTEQ
  4399*    END-EXEC.
  4400*    MOVE '&"S        G          (   #00004123' TO DFHEIV0
  4401     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  4402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4403     MOVE X'2020233030303034313233' TO DFHEIV0(25:11)
  4404     CALL 'kxdfhei1' USING DFHEIV0,
  4405           ELCNTL-ID,
  4406           DFHEIV20,
  4407           DFHEIV99,
  4408           ELCNTL-KEY,
  4409           DFHEIV99,
  4410           DFHEIV99,
  4411           DFHEIV99
  4412     SET ADDRESS OF CONTROL-FILE TO
  4413         DFHEIV20
  4414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4415
  4416
  4417     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID  OR
  4418        CF-RECORD-TYPE NOT = '3'
  4419         GO TO 8860-ENDFILE.
  4420
  4421     IF STCDL = 0
  4422         MOVE ER-0146 TO EMI-ERROR
  4423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4424
  4425     GO TO 7000-BUILD-OUTPUT-MAP.
  4426
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL106.cbl
  4428 5500-FIND-PREV-STATE.
  4429     MOVE PI-COMPANY-ID          TO  CK-COMP-ID.
  4430     MOVE PI-PREV-STATE          TO  CK-STATE-CD.
  4431
  4432     IF STCDL GREATER +0
  4433         MOVE STCDI              TO  CK-STATE-CD.
  4434
  4435     MOVE SPACES                 TO  PI-PREV-STATE.
  4436
  4437
  4438* EXEC CICS HANDLE CONDITION
  4439*        NOTFND(8860-ENDFILE)
  4440*    END-EXEC.
  4441*    MOVE '"$I                   ! & #00004150' TO DFHEIV0
  4442     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4443     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4444     MOVE X'2620233030303034313530' TO DFHEIV0(25:11)
  4445     CALL 'kxdfhei1' USING DFHEIV0
  4446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4447
  4448
  4449
  4450* EXEC CICS STARTBR
  4451*        DATASET  (ELCNTL-ID)
  4452*        RIDFLD   (ELCNTL-KEY)
  4453*    END-EXEC.
  4454     MOVE 0
  4455       TO DFHEIV11
  4456*    MOVE '&,         G          &   #00004154' TO DFHEIV0
  4457     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4458     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4459     MOVE X'2020233030303034313534' TO DFHEIV0(25:11)
  4460     CALL 'kxdfhei1' USING DFHEIV0,
  4461           ELCNTL-ID,
  4462           ELCNTL-KEY,
  4463           DFHEIV99,
  4464           DFHEIV11,
  4465           DFHEIV99
  4466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4467
  4468
  4469 5600-READ-PREV-STATE-RECORD.
  4470
  4471* EXEC CICS READPREV
  4472*        DATASET  (ELCNTL-ID)
  4473*        SET      (ADDRESS OF CONTROL-FILE)
  4474*        RIDFLD   (ELCNTL-KEY)
  4475*    END-EXEC.
  4476     MOVE 0
  4477       TO DFHEIV11
  4478*    MOVE '&0S                   )   #00004160' TO DFHEIV0
  4479     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4480     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4481     MOVE X'2020233030303034313630' TO DFHEIV0(25:11)
  4482     CALL 'kxdfhei1' USING DFHEIV0,
  4483           ELCNTL-ID,
  4484           DFHEIV20,
  4485           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL106.cbl
  4486           ELCNTL-KEY,
  4487           DFHEIV99,
  4488           DFHEIV11,
  4489           DFHEIV99,
  4490           DFHEIV99
  4491     SET ADDRESS OF CONTROL-FILE TO
  4492         DFHEIV20
  4493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4494
  4495
  4496     IF FIRST-TIME
  4497         MOVE 'N'                TO  WS-FIRST-TIME-SW
  4498         GO TO 5600-READ-PREV-STATE-RECORD.
  4499
  4500     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID  OR
  4501        CF-RECORD-TYPE NOT = '3'
  4502         GO TO 8860-ENDFILE.
  4503
  4504     IF STCDL = 0
  4505         MOVE ER-0146 TO EMI-ERROR
  4506         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4507
  4508     GO TO 7000-BUILD-OUTPUT-MAP.
  4509
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL106.cbl
  4511 6000-EDIT-INPUT-DATA.
  4512     IF STABRL = ZEROS AND MAINTI = 'A'
  4513        MOVE -1  TO STABRL
  4514        MOVE ER-0152 TO EMI-ERROR
  4515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4516
  4517     IF STNAMEL = ZEROS AND MAINTI = 'A'
  4518        MOVE -1   TO STNAMEL
  4519        MOVE ER-0153 TO EMI-ERROR
  4520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4521
  4522     IF LFEXPL NOT = ZEROS
  4523
  4524* EXEC CICS BIF
  4525*            DEEDIT
  4526*            FIELD (LFEXPI)
  4527*            LENGTH(7)
  4528*       END-EXEC
  4529     MOVE 7
  4530       TO DFHEIV11
  4531*    MOVE '@"L                   #   #00004193' TO DFHEIV0
  4532     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4533     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4534     MOVE X'2020233030303034313933' TO DFHEIV0(25:11)
  4535     CALL 'kxdfhei1' USING DFHEIV0,
  4536           LFEXPI,
  4537           DFHEIV11
  4538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4539      IF LFEXPI NUMERIC
  4540            MOVE AL-UNNON        TO LFEXPA
  4541            MOVE LFEXPI          TO WS-ST-LF-EXP-PCT
  4542        ELSE
  4543            MOVE ER-7531         TO EMI-ERROR
  4544            MOVE -1              TO LFEXPL
  4545            MOVE AL-UNBON        TO LFEXPA
  4546            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4547
  4548     IF AHEXPL NOT = ZEROS
  4549
  4550* EXEC CICS BIF
  4551*            DEEDIT
  4552*            FIELD (AHEXPI)
  4553*            LENGTH(7)
  4554*       END-EXEC
  4555     MOVE 7
  4556       TO DFHEIV11
  4557*    MOVE '@"L                   #   #00004208' TO DFHEIV0
  4558     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4559     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4560     MOVE X'2020233030303034323038' TO DFHEIV0(25:11)
  4561     CALL 'kxdfhei1' USING DFHEIV0,
  4562           AHEXPI,
  4563           DFHEIV11
  4564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4565      IF AHEXPI NUMERIC
  4566            MOVE AL-UNNON        TO AHEXPA
  4567            MOVE AHEXPI          TO WS-ST-AH-EXP-PCT
  4568        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL106.cbl
  4569            MOVE ER-7531         TO EMI-ERROR
  4570            MOVE -1              TO AHEXPL
  4571            MOVE AL-UNBON        TO AHEXPA
  4572            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4573
  4574     IF QUOTCALL NOT = ZEROS
  4575
  4576* EXEC CICS BIF
  4577*            DEEDIT
  4578*            FIELD (QUOTCALI)
  4579*            LENGTH(6)
  4580*       END-EXEC
  4581     MOVE 6
  4582       TO DFHEIV11
  4583*    MOVE '@"L                   #   #00004223' TO DFHEIV0
  4584     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4585     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4586     MOVE X'2020233030303034323233' TO DFHEIV0(25:11)
  4587     CALL 'kxdfhei1' USING DFHEIV0,
  4588           QUOTCALI,
  4589           DFHEIV11
  4590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4591        IF QUOTCALI NOT NUMERIC
  4592           MOVE -1               TO QUOTCALL
  4593           MOVE AL-UNBON         TO QUOTCALA
  4594           MOVE ER-2009          TO EMI-ERROR
  4595           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4596        ELSE
  4597        IF QUOTCALI GREATER THAN 9999
  4598           MOVE -1               TO QUOTCALL
  4599           MOVE AL-UNBON         TO QUOTCALA
  4600           MOVE ER-2009          TO EMI-ERROR
  4601           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4602
  4603     IF OVSAMTL NOT = ZEROS
  4604
  4605* EXEC CICS BIF
  4606*            DEEDIT
  4607*            FIELD (OVSAMTI)
  4608*            LENGTH(6)
  4609*       END-EXEC
  4610     MOVE 6
  4611       TO DFHEIV11
  4612*    MOVE '@"L                   #   #00004241' TO DFHEIV0
  4613     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4614     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4615     MOVE X'2020233030303034323431' TO DFHEIV0(25:11)
  4616     CALL 'kxdfhei1' USING DFHEIV0,
  4617           OVSAMTI,
  4618           DFHEIV11
  4619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4620        IF OVSAMTI  NOT NUMERIC
  4621           MOVE -1               TO OVSAMTL
  4622           MOVE AL-UNBON         TO OVSAMTA
  4623           MOVE ER-2010          TO EMI-ERROR
  4624           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4625        ELSE
  4626        IF OVSAMTI  GREATER THAN 9999
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL106.cbl
  4627           MOVE -1               TO OVSAMTL
  4628           MOVE AL-UNBON         TO OVSAMTA
  4629           MOVE ER-2010          TO EMI-ERROR
  4630           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4631
  4632     IF PREMTOLL NOT = ZEROS
  4633
  4634* EXEC CICS BIF
  4635*            DEEDIT
  4636*            FIELD (PREMTOLI)
  4637*            LENGTH(6)
  4638*       END-EXEC
  4639     MOVE 6
  4640       TO DFHEIV11
  4641*    MOVE '@"L                   #   #00004259' TO DFHEIV0
  4642     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4643     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4644     MOVE X'2020233030303034323539' TO DFHEIV0(25:11)
  4645     CALL 'kxdfhei1' USING DFHEIV0,
  4646           PREMTOLI,
  4647           DFHEIV11
  4648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4649        IF PREMTOLI NOT NUMERIC
  4650           MOVE -1               TO PREMTOLL
  4651           MOVE AL-UNBON         TO PREMTOLA
  4652           MOVE ER-2010          TO EMI-ERROR
  4653           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4654        ELSE
  4655        IF PREMTOLI GREATER THAN 9999
  4656           MOVE -1               TO PREMTOLL
  4657           MOVE AL-UNBON         TO PREMTOLA
  4658           MOVE ER-2010          TO EMI-ERROR
  4659           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4660
  4661     IF REFTOLL NOT = ZEROS
  4662
  4663* EXEC CICS BIF
  4664*            DEEDIT
  4665*            FIELD(REFTOLI)
  4666*            LENGTH(6)
  4667*       END-EXEC
  4668     MOVE 6
  4669       TO DFHEIV11
  4670*    MOVE '@"L                   #   #00004277' TO DFHEIV0
  4671     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4672     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4673     MOVE X'2020233030303034323737' TO DFHEIV0(25:11)
  4674     CALL 'kxdfhei1' USING DFHEIV0,
  4675           REFTOLI,
  4676           DFHEIV11
  4677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4678        IF REFTOLI NOT NUMERIC
  4679           MOVE -1               TO REFTOLL
  4680           MOVE AL-UNBON         TO REFTOLA
  4681           MOVE ER-2014          TO EMI-ERROR
  4682           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4683        ELSE
  4684        IF REFTOLI GREATER THAN 9999
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL106.cbl
  4685           MOVE -1               TO REFTOLL
  4686           MOVE AL-UNBON         TO REFTOLA
  4687           MOVE ER-2014          TO EMI-ERROR
  4688           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4689
  4690     IF CLREJECL NOT = ZEROS
  4691        IF CLREJECI = SPACES OR '1'
  4692           NEXT SENTENCE
  4693          ELSE
  4694           MOVE -1               TO CLREJECL
  4695           MOVE AL-UABON         TO CLREJECA
  4696           MOVE ER-2024          TO EMI-ERROR
  4697           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4698
  4699     IF ISSREJL NOT = ZEROS
  4700        IF ISSREJI = SPACES OR '1'
  4701           NEXT SENTENCE
  4702          ELSE
  4703           MOVE -1               TO ISSREJL
  4704           MOVE AL-UABON         TO ISSREJA
  4705           MOVE ER-2012          TO EMI-ERROR
  4706           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4707
  4708     IF REFREJL NOT = ZEROS
  4709        IF REFREJI = SPACES OR '1'
  4710           NEXT SENTENCE
  4711          ELSE
  4712           MOVE -1               TO REFREJL
  4713           MOVE AL-UABON         TO REFREJA
  4714           MOVE ER-2028          TO EMI-ERROR
  4715           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4716
  4717     IF REFMINL NOT = ZEROS
  4718
  4719* EXEC CICS BIF
  4720*            DEEDIT
  4721*            FIELD (REFMINI)
  4722*            LENGTH(6)
  4723*       END-EXEC
  4724     MOVE 6
  4725       TO DFHEIV11
  4726*    MOVE '@"L                   #   #00004322' TO DFHEIV0
  4727     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4728     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4729     MOVE X'2020233030303034333232' TO DFHEIV0(25:11)
  4730     CALL 'kxdfhei1' USING DFHEIV0,
  4731           REFMINI,
  4732           DFHEIV11
  4733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4734        IF REFMINI NOT NUMERIC
  4735           MOVE -1               TO REFMINL
  4736           MOVE AL-UNBON         TO REFMINA
  4737           MOVE ER-3030          TO EMI-ERROR
  4738           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4739
  4740     IF REFDAY1L NOT = ZERO
  4741        IF REFDAY1I LESS '00' OR GREATER '31'
  4742            MOVE -1               TO REFDAY1L
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL106.cbl
  4743            MOVE AL-UNBON         TO REFDAY1A
  4744            MOVE ER-3031          TO EMI-ERROR
  4745            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4746
  4747     IF REFDAYSL NOT = ZERO
  4748        IF REFDAYSI LESS '00' OR GREATER '31'
  4749            MOVE -1               TO REFDAYSL
  4750            MOVE AL-UNBON         TO REFDAYSA
  4751            MOVE ER-3031          TO EMI-ERROR
  4752            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4753
  4754     IF SPLPMTL NOT = ZERO
  4755        IF (SPLPMTI IS EQUAL TO 'Y' OR 'N' OR ' ')
  4756            NEXT SENTENCE
  4757        ELSE
  4758            MOVE -1               TO SPLPMTL
  4759            MOVE AL-UABON         TO SPLPMTA
  4760            MOVE ER-0805          TO EMI-ERROR
  4761            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4762
  4763     IF EXTDAYSL NOT = ZERO
  4764        IF EXTDAYSI NOT NUMERIC
  4765            MOVE -1               TO EXTDAYSL
  4766            MOVE AL-UNBON         TO EXTDAYSA
  4767            MOVE ER-3032          TO EMI-ERROR
  4768            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4769
  4770*    IF INTDAYSL NOT = ZERO
  4771*       IF INTDAYSI NOT NUMERIC
  4772*           MOVE -1               TO INTDAYSL
  4773*           MOVE AL-UNBON         TO INTDAYSA
  4774*           MOVE ER-0141          TO EMI-ERROR
  4775*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4776
  4777     IF EXTCHGL NOT = ZEROS
  4778        IF EXTCHGI = SPACES OR '1' OR '2' OR '3'
  4779           NEXT SENTENCE
  4780          ELSE
  4781           MOVE -1               TO EXTCHGL
  4782           MOVE AL-UABON         TO EXTCHGA
  4783           MOVE ER-3033          TO EMI-ERROR
  4784           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4785
  4786     IF REMTERML NOT = ZEROS
  4787        IF (REMTERMI = ' ') OR
  4788           (REMTERMI > '0' AND < '8')
  4789           CONTINUE
  4790        ELSE
  4791           MOVE -1               TO REMTERML
  4792           MOVE AL-UABON         TO REMTERMA
  4793           MOVE ER-2298          TO EMI-ERROR
  4794           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4795        END-IF
  4796     END-IF
  4797
  4798     IF LFREDL NOT = ZEROS
  4799        IF LFREDI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4800                 OR '6' OR '8' OR '9'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL106.cbl
  4801           CONTINUE
  4802        ELSE
  4803           MOVE -1               TO LFREDL
  4804           MOVE AL-UABON         TO LFREDA
  4805           MOVE ER-0582          TO EMI-ERROR
  4806           PERFORM 9900-ERROR-FORMAT
  4807                                 THRU 9900-EXIT
  4808        END-IF
  4809     END-IF
  4810
  4811     IF LFLEVL NOT = ZEROS
  4812        IF LFLEVI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4813                 OR '6' OR '8' OR '9'
  4814           CONTINUE
  4815        ELSE
  4816           MOVE -1               TO LFLEVL
  4817           MOVE AL-UABON         TO LFLEVA
  4818           MOVE ER-0582          TO EMI-ERROR
  4819           PERFORM 9900-ERROR-FORMAT
  4820                                 THRU 9900-EXIT
  4821        END-IF
  4822     END-IF
  4823
  4824     IF LFNETL NOT = ZEROS
  4825        IF LFNETI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4826                 OR '6' OR '8' OR '9'
  4827           CONTINUE
  4828        ELSE
  4829           MOVE -1               TO LFNETL
  4830           MOVE AL-UABON         TO LFNETA
  4831           MOVE ER-0582          TO EMI-ERROR
  4832           PERFORM 9900-ERROR-FORMAT
  4833                                 THRU 9900-EXIT
  4834        END-IF
  4835     END-IF
  4836
  4837     IF AHAHL  NOT = ZEROS
  4838        IF AHAHI  = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4839                 OR '6' OR '8' OR '9'
  4840           CONTINUE
  4841        ELSE
  4842           MOVE -1               TO AHAHL
  4843           MOVE AL-UABON         TO AHAHA
  4844           MOVE ER-0582          TO EMI-ERROR
  4845           PERFORM 9900-ERROR-FORMAT
  4846                                 THRU 9900-EXIT
  4847        END-IF
  4848     END-IF
  4849
  4850     IF AHCPL  NOT = ZEROS
  4851        IF AHCPI  = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4852                 OR '6' OR '8' OR '9'
  4853           CONTINUE
  4854        ELSE
  4855           MOVE -1               TO AHCPL
  4856           MOVE AL-UABON         TO AHCPA
  4857           MOVE ER-0582          TO EMI-ERROR
  4858           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL106.cbl
  4859                                 THRU 9900-EXIT
  4860        END-IF
  4861     END-IF
  4862
  4863     IF STUEL NOT = ZEROS
  4864        IF STUEI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4865           NEXT SENTENCE
  4866          ELSE
  4867           MOVE -1               TO STUEL
  4868           MOVE AL-UABON         TO STUEA
  4869           MOVE ER-3034          TO EMI-ERROR
  4870           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4871
  4872     IF STCNTLL NOT = ZEROS
  4873        IF STCNTLI = SPACES
  4874           NEXT SENTENCE
  4875        ELSE
  4876           IF STCNTLI = '1' OR '2' OR '3' OR '4' OR
  4877                        '5' OR '6' OR '7' OR '8' OR
  4878                        '9' OR 'A' OR 'B' OR 'X'
  4879              NEXT SENTENCE
  4880           ELSE
  4881              MOVE -1               TO STCNTLL
  4882              MOVE AL-UABON         TO STCNTLA
  4883              MOVE ER-3035          TO EMI-ERROR
  4884              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4885
  4886     IF  REPLAWL GREATER THAN ZEROS
  4887         IF  REPLAWI = 'Y'
  4888             MOVE REPLAWI        TO REPLAWO
  4889             MOVE AL-UANON       TO REPLAWA
  4890         ELSE
  4891             IF  REPLAWI = 'N' OR SPACES OR LOW-VALUES
  4892                 MOVE 'N'        TO REPLAWO
  4893                 MOVE AL-UANON   TO REPLAWA
  4894             ELSE
  4895                 MOVE ER-9074    TO EMI-ERROR
  4896                 MOVE -1         TO REPLAWL
  4897                 MOVE AL-UABON   TO REPLAWA
  4898                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4899
  4900     IF  REPLETRL GREATER THAN +0
  4901         IF  REPLAWI = 'Y'
  4902             IF  REPLETRI GREATER THAN SPACES
  4903                 MOVE SPACES     TO W-WORKING-TEXT-KEY
  4904                 MOVE PI-COMPANY-CD
  4905                                 TO W-TEXT-COMPANY-CD
  4906                 MOVE REPLETRI   TO W-TEXT-FORM-NO
  4907                 MOVE +1         TO W-TEXT-LINE-SEQ
  4908
  4909* EXEC CICS HANDLE CONDITION
  4910*                    NOTFND   (6010-LETR-NOT-FOUND)
  4911*                    ENDFILE  (6010-LETR-NOT-FOUND)
  4912*                    NOTOPEN  (8890-LETR-NOT-OPEN)
  4913*                END-EXEC
  4914*    MOVE '"$I''J                 ! '' #00004501' TO DFHEIV0
  4915     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  4916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL106.cbl
  4917     MOVE X'2720233030303034353031' TO DFHEIV0(25:11)
  4918     CALL 'kxdfhei1' USING DFHEIV0
  4919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4920
  4921* EXEC CICS READ
  4922*                    SET     (ADDRESS OF TEXT-FILES)
  4923*                    DATASET (ELLETR-ID)
  4924*                    RIDFLD  (W-WORKING-TEXT-KEY)
  4925*                END-EXEC
  4926*    MOVE '&"S        E          (   #00004506' TO DFHEIV0
  4927     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4928     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4929     MOVE X'2020233030303034353036' TO DFHEIV0(25:11)
  4930     CALL 'kxdfhei1' USING DFHEIV0,
  4931           ELLETR-ID,
  4932           DFHEIV20,
  4933           DFHEIV99,
  4934           W-WORKING-TEXT-KEY,
  4935           DFHEIV99,
  4936           DFHEIV99,
  4937           DFHEIV99
  4938     SET ADDRESS OF TEXT-FILES TO
  4939         DFHEIV20
  4940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4941                 MOVE AL-UANON   TO REPLETRA
  4942             ELSE
  4943                 MOVE ER-9448    TO EMI-ERROR
  4944                 MOVE -1         TO REPLETRL
  4945                 MOVE AL-UABON   TO REPLETRA
  4946                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4947         ELSE
  4948             IF  REPLETRI EQUAL SPACES OR LOW-VALUES
  4949                 MOVE LOW-VALUES TO REPLETRO
  4950                 MOVE AL-UANON   TO REPLETRA
  4951             ELSE
  4952                 MOVE ER-9478    TO EMI-ERROR
  4953                 MOVE -1         TO REPLAWL
  4954                 MOVE AL-UABON   TO REPLAWA
  4955                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4956     ELSE
  4957         IF  REPLAWI = 'Y'
  4958             MOVE ER-9448        TO EMI-ERROR
  4959             MOVE -1             TO REPLETRL
  4960             MOVE AL-UABON       TO REPLETRA
  4961             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4962
  4963     IF LIMITL GREATER ZEROS
  4964         IF LIMITI = 'A'
  4965             MOVE LIMITI         TO LIMITO
  4966             MOVE AL-UANON       TO LIMITA
  4967          ELSE
  4968             IF LIMITI = SPACES OR LOW-VALUES
  4969                 MOVE ' '        TO LIMITO
  4970                 MOVE AL-UANON   TO LIMITA
  4971         ELSE
  4972             MOVE ER-2137    TO EMI-ERROR
  4973             MOVE -1         TO LIMITL
  4974             MOVE AL-UABON   TO LIMITA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL106.cbl
  4975             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4976
  4977*    IF STATIL GREATER ZEROS
  4978*        IF STATII = 'I' OR 'R'
  4979*            MOVE STATII         TO STATIO
  4980*            MOVE AL-UANON       TO STATIA
  4981*         ELSE
  4982*            IF STATII = SPACES OR LOW-VALUES
  4983*                MOVE ' '        TO STATIO
  4984*                MOVE AL-UANON   TO STATIA
  4985*        ELSE
  4986*            MOVE ER-7346    TO EMI-ERROR
  4987*            MOVE -1         TO STATIL
  4988*            MOVE AL-UABON   TO STATIA
  4989*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4990
  4991     IF COMSLL GREATER ZEROS
  4992
  4993* EXEC CICS BIF
  4994*            DEEDIT
  4995*            FIELD (COMSLI)
  4996*            LENGTH(6)
  4997*       END-EXEC
  4998     MOVE 6
  4999       TO DFHEIV11
  5000*    MOVE '@"L                   #   #00004562' TO DFHEIV0
  5001     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5002     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5003     MOVE X'2020233030303034353632' TO DFHEIV0(25:11)
  5004     CALL 'kxdfhei1' USING DFHEIV0,
  5005           COMSLI,
  5006           DFHEIV11
  5007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5008      IF COMSLI NUMERIC
  5009            MOVE AL-UNNON        TO COMSLA
  5010            MOVE COMSLI          TO WS-COMSL
  5011                                    COMSLO
  5012        ELSE
  5013            MOVE ER-1614         TO EMI-ERROR
  5014            MOVE -1              TO COMSLL
  5015            MOVE AL-UNBON        TO COMSLA
  5016            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5017
  5018     IF COMJLL GREATER ZEROS
  5019
  5020* EXEC CICS BIF
  5021*            DEEDIT
  5022*            FIELD (COMJLI)
  5023*            LENGTH(6)
  5024*       END-EXEC
  5025     MOVE 6
  5026       TO DFHEIV11
  5027*    MOVE '@"L                   #   #00004578' TO DFHEIV0
  5028     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5029     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5030     MOVE X'2020233030303034353738' TO DFHEIV0(25:11)
  5031     CALL 'kxdfhei1' USING DFHEIV0,
  5032           COMJLI,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL106.cbl
  5033           DFHEIV11
  5034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5035      IF COMJLI NUMERIC
  5036            MOVE AL-UNNON        TO COMJLA
  5037            MOVE COMJLI          TO WS-COMJL
  5038                                    COMJLO
  5039        ELSE
  5040            MOVE ER-1614         TO EMI-ERROR
  5041            MOVE -1              TO COMJLL
  5042            MOVE AL-UNBON        TO COMJLA
  5043            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5044
  5045     IF COMSAL GREATER ZEROS
  5046
  5047* EXEC CICS BIF
  5048*            DEEDIT
  5049*            FIELD (COMSAI)
  5050*            LENGTH(6)
  5051*       END-EXEC
  5052     MOVE 6
  5053       TO DFHEIV11
  5054*    MOVE '@"L                   #   #00004594' TO DFHEIV0
  5055     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5056     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5057     MOVE X'2020233030303034353934' TO DFHEIV0(25:11)
  5058     CALL 'kxdfhei1' USING DFHEIV0,
  5059           COMSAI,
  5060           DFHEIV11
  5061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5062      IF COMSAI NUMERIC
  5063            MOVE AL-UNNON        TO COMSAA
  5064            MOVE COMSAI          TO WS-COMSA
  5065                                    COMSAO
  5066        ELSE
  5067            MOVE ER-1614         TO EMI-ERROR
  5068            MOVE -1              TO COMSAL
  5069            MOVE AL-UNBON        TO COMSAA
  5070            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5071
  5072     IF COMJAL GREATER ZEROS
  5073
  5074* EXEC CICS BIF
  5075*            DEEDIT
  5076*            FIELD (COMJAI)
  5077*            LENGTH(6)
  5078*       END-EXEC
  5079     MOVE 6
  5080       TO DFHEIV11
  5081*    MOVE '@"L                   #   #00004610' TO DFHEIV0
  5082     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5083     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5084     MOVE X'2020233030303034363130' TO DFHEIV0(25:11)
  5085     CALL 'kxdfhei1' USING DFHEIV0,
  5086           COMJAI,
  5087           DFHEIV11
  5088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5089      IF COMJAI NUMERIC
  5090            MOVE AL-UNNON        TO COMJAA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL106.cbl
  5091            MOVE COMJAI          TO WS-COMJA
  5092                                    COMJAO
  5093        ELSE
  5094            MOVE ER-1614         TO EMI-ERROR
  5095            MOVE -1              TO COMJAL
  5096            MOVE AL-UNBON        TO COMJAA
  5097            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5098
  5099     IF RESTAXL GREATER ZEROS
  5100
  5101* EXEC CICS BIF
  5102*            DEEDIT
  5103*            FIELD (RESTAXI)
  5104*            LENGTH(6)
  5105*       END-EXEC
  5106     MOVE 6
  5107       TO DFHEIV11
  5108*    MOVE '@"L                   #   #00004626' TO DFHEIV0
  5109     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5110     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5111     MOVE X'2020233030303034363236' TO DFHEIV0(25:11)
  5112     CALL 'kxdfhei1' USING DFHEIV0,
  5113           RESTAXI,
  5114           DFHEIV11
  5115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5116      IF RESTAXI NUMERIC
  5117            MOVE AL-UNNON        TO RESTAXA
  5118            MOVE RESTAXI         TO WS-RESIDENT-TAX
  5119                                    RESTAXO
  5120        ELSE
  5121            MOVE ER-1614         TO EMI-ERROR
  5122            MOVE -1              TO RESTAXL
  5123            MOVE AL-UNBON        TO RESTAXA
  5124            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5125
  5126     IF FREELKI  NUMERIC
  5127            MOVE AL-UNNON        TO FREELKA
  5128            MOVE FREELKI         TO WS-FREE-LOOK-DAYS
  5129                                    FREELKO
  5130        ELSE
  5131            MOVE -1               TO FREELKL
  5132            MOVE AL-UNBON         TO FREELKA
  5133            MOVE ER-8159          TO EMI-ERROR
  5134            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5135
  5136*    IF STATRL GREATER ZEROS
  5137*       EXEC CICS BIF
  5138*            DEEDIT
  5139*            FIELD (STATRI)
  5140*            LENGTH(6)
  5141*       END-EXEC
  5142*     IF STATRI NUMERIC
  5143*           MOVE AL-UNNON        TO STATRA
  5144*           MOVE STATRI          TO WS-IRATE
  5145*                                   STATRO
  5146*       ELSE
  5147*           MOVE ER-1614         TO EMI-ERROR
  5148*           MOVE -1              TO STATRL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL106.cbl
  5149*           MOVE AL-UNBON        TO STATRA
  5150*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5151
  5152*    IF STATR1L GREATER ZEROS
  5153*       EXEC CICS BIF
  5154*            DEEDIT
  5155*            FIELD (STATR1I)
  5156*            LENGTH(6)
  5157*       END-EXEC
  5158*     IF STATR1I NUMERIC
  5159*           MOVE AL-UNNON        TO STATR1A
  5160*           MOVE STATR1I         TO WS-IRATE1
  5161*                                   STATR1O
  5162*       ELSE
  5163*           MOVE ER-1614         TO EMI-ERROR
  5164*           MOVE -1              TO STATR1L
  5165*           MOVE AL-UNBON        TO STATR1A
  5166*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5167*
  5168*    IF STATR2L GREATER ZEROS
  5169*       EXEC CICS BIF
  5170*            DEEDIT
  5171*            FIELD (STATR2I)
  5172*            LENGTH(6)
  5173*       END-EXEC
  5174*     IF STATR2I NUMERIC
  5175*           MOVE AL-UNNON        TO STATR2A
  5176*           MOVE STATR2I         TO WS-IRATE2
  5177*                                   STATR2O
  5178*       ELSE
  5179*           MOVE ER-1614         TO EMI-ERROR
  5180*           MOVE -1              TO STATR2L
  5181*           MOVE AL-UNBON        TO STATR2A
  5182*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5183*
  5184*    IF STATR3L GREATER ZEROS
  5185*       EXEC CICS BIF
  5186*            DEEDIT
  5187*            FIELD (STATR3I)
  5188*            LENGTH(6)
  5189*       END-EXEC
  5190*     IF STATR3I NUMERIC
  5191*           MOVE AL-UNNON        TO STATR3A
  5192*           MOVE STATR3I         TO WS-IRATE3
  5193*                                   STATR3O
  5194*       ELSE
  5195*           MOVE ER-1614         TO EMI-ERROR
  5196*           MOVE -1              TO STATR3L
  5197*           MOVE AL-UNBON        TO STATR3A
  5198*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5199
  5200     GO TO 6020-CONTINUE.
  5201
  5202 6010-LETR-NOT-FOUND.
  5203     MOVE ER-9447                TO EMI-ERROR.
  5204     MOVE -1                     TO REPLETRL.
  5205     MOVE AL-UABON               TO REPLETRA.
  5206     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL106.cbl
  5207
  5208 6020-CONTINUE.
  5209
  5210     IF  TARRATL NOT = ZEROS
  5211
  5212* EXEC CICS BIF
  5213*             DEEDIT
  5214*             FIELD (TARRATI)
  5215*             LENGTH (6)
  5216*        END-EXEC
  5217     MOVE 6
  5218       TO DFHEIV11
  5219*    MOVE '@"L                   #   #00004726' TO DFHEIV0
  5220     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5221     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5222     MOVE X'2020233030303034373236' TO DFHEIV0(25:11)
  5223     CALL 'kxdfhei1' USING DFHEIV0,
  5224           TARRATI,
  5225           DFHEIV11
  5226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5227
  5228         IF  TARRATI NUMERIC
  5229             MOVE AL-UNNON       TO TARRATA
  5230             MOVE TARRATI        TO WS-ST-TARGET-LOSS-RATIO
  5231                                    TARRATO
  5232         ELSE
  5233             MOVE ER-7717        TO EMI-ERROR
  5234             MOVE -1             TO TARRATL
  5235             MOVE AL-UNBON       TO TARRATA
  5236             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5237
  5238     IF  CALCINTL NOT = ZEROS
  5239
  5240* EXEC CICS BIF
  5241*             DEEDIT
  5242*             FIELD (CALCINTI)
  5243*             LENGTH (6)
  5244*        END-EXEC
  5245     MOVE 6
  5246       TO DFHEIV11
  5247*    MOVE '@"L                   #   #00004743' TO DFHEIV0
  5248     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5249     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5250     MOVE X'2020233030303034373433' TO DFHEIV0(25:11)
  5251     CALL 'kxdfhei1' USING DFHEIV0,
  5252           CALCINTI,
  5253           DFHEIV11
  5254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5255
  5256         IF  CALCINTI NUMERIC
  5257             MOVE AL-UNNON       TO CALCINTA
  5258             MOVE CALCINTI       TO WS-ST-CALC-INTEREST
  5259                                    CALCINTO
  5260         ELSE
  5261             MOVE ER-7735        TO EMI-ERROR
  5262             MOVE -1             TO CALCINTL
  5263             MOVE AL-UNBON       TO CALCINTA
  5264             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL106.cbl
  5265
  5266     IF PRMPCTL NOT = ZEROS
  5267
  5268* EXEC CICS BIF
  5269*            DEEDIT
  5270*            FIELD (PRMPCTI)
  5271*            LENGTH(5)
  5272*       END-EXEC
  5273     MOVE 5
  5274       TO DFHEIV11
  5275*    MOVE '@"L                   #   #00004760' TO DFHEIV0
  5276     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5277     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5278     MOVE X'2020233030303034373630' TO DFHEIV0(25:11)
  5279     CALL 'kxdfhei1' USING DFHEIV0,
  5280           PRMPCTI,
  5281           DFHEIV11
  5282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5283      IF PRMPCTI NUMERIC
  5284            MOVE AL-UNNON        TO PRMPCTA
  5285            MOVE PRMPCTI         TO WS-ST-TOL-PREM-PCT
  5286        ELSE
  5287            MOVE ER-7532         TO EMI-ERROR
  5288            MOVE -1              TO PRMPCTL
  5289            MOVE AL-UNBON        TO PRMPCTA
  5290            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5291
  5292     IF OVSPCTL NOT = ZEROS
  5293
  5294* EXEC CICS BIF
  5295*            DEEDIT
  5296*            FIELD (OVSPCTI)
  5297*            LENGTH(5)
  5298*       END-EXEC
  5299     MOVE 5
  5300       TO DFHEIV11
  5301*    MOVE '@"L                   #   #00004775' TO DFHEIV0
  5302     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5303     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5304     MOVE X'2020233030303034373735' TO DFHEIV0(25:11)
  5305     CALL 'kxdfhei1' USING DFHEIV0,
  5306           OVSPCTI,
  5307           DFHEIV11
  5308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5309      IF OVSPCTI NUMERIC
  5310            MOVE AL-UNNON        TO OVSPCTA
  5311            MOVE OVSPCTI         TO WS-ST-OVR-SHT-PCT
  5312        ELSE
  5313            MOVE ER-7532         TO EMI-ERROR
  5314            MOVE -1              TO OVSPCTL
  5315            MOVE AL-UNBON        TO OVSPCTA
  5316            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5317
  5318     IF REFPCTL NOT = ZEROS
  5319
  5320* EXEC CICS BIF
  5321*            DEEDIT
  5322*            FIELD (REFPCTI)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL106.cbl
  5323*            LENGTH(5)
  5324*       END-EXEC
  5325     MOVE 5
  5326       TO DFHEIV11
  5327*    MOVE '@"L                   #   #00004790' TO DFHEIV0
  5328     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5329     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5330     MOVE X'2020233030303034373930' TO DFHEIV0(25:11)
  5331     CALL 'kxdfhei1' USING DFHEIV0,
  5332           REFPCTI,
  5333           DFHEIV11
  5334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5335      IF REFPCTI NUMERIC
  5336            MOVE AL-UNNON        TO REFPCTA
  5337            MOVE REFPCTI         TO WS-ST-TOL-REF-PCT
  5338        ELSE
  5339            MOVE ER-7532         TO EMI-ERROR
  5340            MOVE -1              TO REFPCTL
  5341            MOVE AL-UNBON        TO REFPCTA
  5342            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5343
  5344     IF LFTAXL NOT = ZEROS
  5345
  5346* EXEC CICS BIF
  5347*            DEEDIT
  5348*            FIELD (LFTAXI)
  5349*            LENGTH(5)
  5350*       END-EXEC
  5351     MOVE 5
  5352       TO DFHEIV11
  5353*    MOVE '@"L                   #   #00004805' TO DFHEIV0
  5354     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5355     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5356     MOVE X'2020233030303034383035' TO DFHEIV0(25:11)
  5357     CALL 'kxdfhei1' USING DFHEIV0,
  5358           LFTAXI,
  5359           DFHEIV11
  5360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5361        IF LFTAXI NUMERIC
  5362           MOVE AL-UNNON         TO LFTAXA
  5363           MOVE LFTAXI           TO WS-ST-LF-PREM-TAX
  5364        ELSE
  5365           MOVE ER-2082          TO EMI-ERROR
  5366           MOVE -1               TO LFTAXL
  5367           MOVE AL-UNBON         TO LFTAXA
  5368           PERFORM 9900-ERROR-FORMAT
  5369                                 THRU 9900-EXIT
  5370        END-IF
  5371     END-IF
  5372
  5373     IF AHITAXL NOT = ZEROS
  5374
  5375* EXEC CICS BIF
  5376*            DEEDIT
  5377*            FIELD (AHITAXI)
  5378*            LENGTH(5)
  5379*       END-EXEC
  5380     MOVE 5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL106.cbl
  5381       TO DFHEIV11
  5382*    MOVE '@"L                   #   #00004823' TO DFHEIV0
  5383     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5384     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5385     MOVE X'2020233030303034383233' TO DFHEIV0(25:11)
  5386     CALL 'kxdfhei1' USING DFHEIV0,
  5387           AHITAXI,
  5388           DFHEIV11
  5389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5390        IF AHITAXI NUMERIC
  5391           MOVE AL-UNNON         TO AHITAXA
  5392           MOVE AHITAXI          TO WS-ST-AH-PREM-TAX-I
  5393        ELSE
  5394           MOVE ER-2084          TO EMI-ERROR
  5395           MOVE -1               TO AHITAXL
  5396           MOVE AL-UNBON         TO AHITAXA
  5397           PERFORM 9900-ERROR-FORMAT
  5398                                 THRU 9900-EXIT
  5399        END-IF
  5400     END-IF
  5401
  5402     IF AHGTAXL NOT = ZEROS
  5403
  5404* EXEC CICS BIF
  5405*            DEEDIT
  5406*            FIELD (AHGTAXI)
  5407*            LENGTH(5)
  5408*       END-EXEC
  5409     MOVE 5
  5410       TO DFHEIV11
  5411*    MOVE '@"L                   #   #00004841' TO DFHEIV0
  5412     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5413     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5414     MOVE X'2020233030303034383431' TO DFHEIV0(25:11)
  5415     CALL 'kxdfhei1' USING DFHEIV0,
  5416           AHGTAXI,
  5417           DFHEIV11
  5418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5419        IF AHGTAXI NUMERIC
  5420           MOVE AL-UNNON         TO AHGTAXA
  5421           MOVE AHGTAXI          TO WS-ST-AH-PREM-TAX-G
  5422        ELSE
  5423           MOVE ER-2084          TO EMI-ERROR
  5424           MOVE -1               TO AHGTAXL
  5425           MOVE AL-UNBON         TO AHGTAXA
  5426           PERFORM 9900-ERROR-FORMAT
  5427                                 THRU 9900-EXIT
  5428        END-IF
  5429     END-IF
  5430
  5431     IF REFCLML NOT = ZEROS
  5432        IF REFCLMI = SPACES OR '1' OR '2' OR '3' OR '4' OR '5'
  5433           NEXT SENTENCE
  5434        ELSE
  5435           MOVE -1               TO REFCLML
  5436           MOVE AL-UABON         TO REFCLMA
  5437           MOVE ER-3036          TO EMI-ERROR
  5438           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL106.cbl
  5439        END-IF
  5440     END-IF.
  5441
  5442     IF VFYBENEL NOT = ZEROS
  5443        IF VFYBENEI = SPACES OR 'Y' OR 'N'
  5444           NEXT SENTENCE
  5445        ELSE
  5446           MOVE -1               TO VFYBENEL
  5447           MOVE AL-UABON         TO VFYBENEA
  5448           MOVE ER-3040          TO EMI-ERROR
  5449           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5450        END-IF
  5451     END-IF.
  5452
  5453     .
  5454 6099-EXIT.
  5455     EXIT.
  5456
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL106.cbl
  5458 6100-INITIALIZE-BENEFIT-CNTL.
  5459
  5460     MOVE SPACES   TO   CF-ST-BENEFIT-CD         (SUB)
  5461                        CF-ST-BENEFIT-KIND       (SUB)
  5462                        CF-ST-REM-TERM-CALC      (SUB)
  5463                        CF-ST-REFUND-CALC        (SUB)
  5464                        CF-ST-EARNING-CALC       (SUB)
  5465                        CF-ST-OVRD-EARNINGS-CALC (SUB).
  5466
  5467 6199-EXIT.
  5468     EXIT.
  5469
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL106.cbl
  5471 6400-CREATE-TEMP-STORAGE.
  5472     PERFORM 6600-DELETE-TEMP-STORAGE THRU 6600-EXIT.
  5473
  5474
  5475* EXEC CICS WRITEQ TS
  5476*        QUEUE   (QID)
  5477*        FROM    (EL106AO)
  5478*        LENGTH  (WS-MAP-LENGTH)
  5479*    END-EXEC.
  5480*    MOVE '*"                    ''   #00004901' TO DFHEIV0
  5481     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  5482     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5483     MOVE X'2020233030303034393031' TO DFHEIV0(25:11)
  5484     CALL 'kxdfhei1' USING DFHEIV0,
  5485           QID,
  5486           EL106AO,
  5487           WS-MAP-LENGTH,
  5488           DFHEIV99,
  5489           DFHEIV99,
  5490           DFHEIV99
  5491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5492
  5493
  5494 6400-EXIT.
  5495      EXIT.
  5496
  5497 6500-RECOVER-TEMP-STORAGE.
  5498
  5499* EXEC CICS READQ TS
  5500*        QUEUE   (QID)
  5501*        INTO    (EL106AO)
  5502*        LENGTH  (WS-MAP-LENGTH)
  5503*    END-EXEC.
  5504*    MOVE '*$I    L              ''   #00004911' TO DFHEIV0
  5505     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  5506     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5507     MOVE X'2020233030303034393131' TO DFHEIV0(25:11)
  5508     CALL 'kxdfhei1' USING DFHEIV0,
  5509           QID,
  5510           EL106AO,
  5511           WS-MAP-LENGTH,
  5512           DFHEIV99,
  5513           DFHEIV99,
  5514           DFHEIV99
  5515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5516
  5517
  5518     PERFORM 6600-DELETE-TEMP-STORAGE THRU 6600-EXIT.
  5519
  5520 6500-EXIT.
  5521      EXIT.
  5522
  5523 6600-DELETE-TEMP-STORAGE.
  5524
  5525* EXEC CICS HANDLE CONDITION
  5526*        QIDERR  (6600-EXIT)
  5527*    END-EXEC.
  5528*    MOVE '"$N                   ! ( #00004923' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL106.cbl
  5529     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  5530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5531     MOVE X'2820233030303034393233' TO DFHEIV0(25:11)
  5532     CALL 'kxdfhei1' USING DFHEIV0
  5533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5534
  5535
  5536
  5537* EXEC CICS DELETEQ TS
  5538*        QUEUE  (QID)
  5539*    END-EXEC.
  5540*    MOVE '*&                    #   #00004927' TO DFHEIV0
  5541     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  5542     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5543     MOVE X'2020233030303034393237' TO DFHEIV0(25:11)
  5544     CALL 'kxdfhei1' USING DFHEIV0,
  5545           QID,
  5546           DFHEIV99
  5547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5548
  5549
  5550 6600-EXIT.
  5551      EXIT.
  5552
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL106.cbl
  5554***************************************************************
  5555*                                                             *
  5556*     BUILD THE OUTPUT SCREEN TO BE DISPLAYED                 *
  5557*                                                             *
  5558***************************************************************
  5559 7000-BUILD-OUTPUT-MAP.
  5560     MOVE LOW-VALUES            TO EL106AO.
  5561     MOVE CF-STATE-CODE         TO STCDO
  5562                                   PI-WS-STATE.
  5563     MOVE CF-ST-TOL-CLAIM       TO QUOTCALO.
  5564     MOVE CF-ST-TOL-PREM        TO PREMTOLO.
  5565     MOVE CF-ST-TOL-REFUND      TO REFTOLO.
  5566     MOVE CF-ST-CLAIM-REJECT-SW TO CLREJECO.
  5567     MOVE CF-ST-PREM-REJECT-SW  TO ISSREJO.
  5568     MOVE CF-ST-REF-REJECT-SW   TO REFREJO.
  5569     MOVE CF-ST-FST-PMT-DAYS-CHG
  5570                                TO EXTCHGO.
  5571     MOVE CF-ST-RT-CALC         TO REMTERMO
  5572     MOVE CF-ST-RF-LR-CALC      TO LFREDO
  5573     MOVE CF-ST-RF-LL-CALC      TO LFLEVO
  5574     MOVE CF-ST-RF-LN-CALC      TO LFNETO
  5575     MOVE CF-ST-RF-AH-CALC      TO AHAHO
  5576     MOVE CF-ST-RF-CP-CALC      TO AHCPO
  5577     MOVE CF-ST-CALL-UNEARNED   TO STUEO.
  5578     MOVE CF-ST-CALL-RPT-CNTL   TO STCNTLO.
  5579     MOVE CF-ST-CALL-RATE-DEV   TO STDEVO.
  5580     MOVE CF-STATE-ABBREVIATION TO STABRO.
  5581     MOVE CF-STATE-NAME         TO STNAMEO.
  5582     MOVE CF-ST-REF-AH-DEATH-IND TO REFCLMO.
  5583     MOVE CF-ST-VFY-2ND-BENE    TO VFYBENEO.
  5584     IF  CF-ST-CHECK-COUNTER NUMERIC
  5585        MOVE CF-ST-CHECK-COUNTER TO STCHKNOO
  5586     ELSE
  5587        MOVE ZEROS             TO STCHKNOO
  5588     END-IF.
  5589
  5590     IF CF-ST-LF-EXP-PCT      NUMERIC
  5591         IF CF-ST-LF-EXP-PCT NOT = ZEROS
  5592             MOVE CF-ST-LF-EXP-PCT  TO LFEXPO.
  5593
  5594     IF CF-ST-AH-EXP-PCT      NUMERIC
  5595         IF CF-ST-AH-EXP-PCT NOT = ZEROS
  5596             MOVE CF-ST-AH-EXP-PCT  TO AHEXPO.
  5597
  5598     IF CF-ST-TOL-PREM-PCT    NUMERIC
  5599         IF CF-ST-TOL-PREM-PCT NOT = ZEROS
  5600             MOVE CF-ST-TOL-PREM-PCT TO PRMPCTO.
  5601
  5602     IF CF-ST-OVR-SHT-AMT NUMERIC
  5603        IF CF-ST-OVR-SHT-AMT > ZEROS
  5604           MOVE CF-ST-OVR-SHT-AMT TO OVSAMTO
  5605        END-IF
  5606     END-IF.
  5607
  5608     IF CF-ST-OVR-SHT-PCT NUMERIC
  5609         IF CF-ST-OVR-SHT-PCT > ZEROS
  5610             MOVE CF-ST-OVR-SHT-PCT TO OVSPCTO
  5611         END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL106.cbl
  5612     END-IF.
  5613
  5614     IF CF-ST-TOL-REF-PCT     NUMERIC
  5615         IF CF-ST-TOL-REF-PCT NOT = ZEROS
  5616             MOVE CF-ST-TOL-REF-PCT TO REFPCTO.
  5617
  5618     IF CF-ST-REFUND-MIN      NUMERIC
  5619         IF CF-ST-REFUND-MIN NOT = ZEROS
  5620             MOVE CF-ST-REFUND-MIN  TO REFMINO.
  5621
  5622     IF CF-ST-REFUND-DAYS-FIRST NUMERIC
  5623       IF CF-ST-REFUND-DAYS-FIRST NOT = ZEROS
  5624         MOVE CF-ST-REFUND-DAYS-FIRST
  5625                                TO REFDAY1O.
  5626
  5627     IF CF-ST-REFUND-DAYS-SUBSEQ NUMERIC
  5628       IF CF-ST-REFUND-DAYS-SUBSEQ NOT = ZEROS
  5629         MOVE CF-ST-REFUND-DAYS-SUBSEQ
  5630                                TO REFDAYSO.
  5631
  5632     IF CF-ST-SPLIT-PAYMENT IS EQUAL TO ' '
  5633         MOVE 'N'               TO SPLPMTO
  5634     ELSE
  5635         MOVE CF-ST-SPLIT-PAYMENT
  5636                                TO SPLPMTO.
  5637
  5638     IF CF-ST-FST-PMT-DAYS-MAX NUMERIC
  5639       IF CF-ST-FST-PMT-DAYS-MAX NOT = ZEROS
  5640         MOVE CF-ST-FST-PMT-DAYS-MAX
  5641                                TO EXTDAYSO.
  5642
  5643     IF CF-ST-LF-PREM-TAX NUMERIC
  5644        IF CF-ST-LF-PREM-TAX > ZEROS
  5645           MOVE CF-ST-LF-PREM-TAX
  5646                                 TO LFTAXO
  5647        END-IF
  5648     END-IF
  5649
  5650     IF CF-ST-AH-PREM-TAX-I NUMERIC
  5651        IF CF-ST-AH-PREM-TAX-I > ZEROS
  5652           MOVE CF-ST-AH-PREM-TAX-I
  5653                                 TO AHITAXO
  5654        END-IF
  5655     END-IF
  5656
  5657     IF CF-ST-AH-PREM-TAX-G NUMERIC
  5658        IF CF-ST-AH-PREM-TAX-G > ZEROS
  5659           MOVE CF-ST-AH-PREM-TAX-G
  5660                                 TO AHGTAXO
  5661        END-IF
  5662     END-IF
  5663
  5664*    IF PI-COMPANY-ID = 'NCL'
  5665*    IF CF-ST-NO-DAYS-ELAPSED NUMERIC
  5666*      IF CF-ST-NO-DAYS-ELAPSED NOT = ZEROS
  5667*        MOVE CF-ST-NO-DAYS-ELAPSED
  5668*                               TO INTDAYSO.
  5669
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL106.cbl
  5670     IF  CF-REPLACEMENT-LAW-SW NOT EQUAL 'Y'
  5671             AND
  5672         CF-REPLACEMENT-LAW-SW NOT EQUAL 'N'
  5673         MOVE 'N'               TO REPLAWO
  5674         MOVE LOW-VALUES        TO REPLETRO
  5675     ELSE
  5676         MOVE CF-REPLACEMENT-LAW-SW
  5677                                TO REPLAWO
  5678
  5679         IF  CF-REPLACEMENT-LETTER GREATER THAN SPACES
  5680             MOVE CF-REPLACEMENT-LETTER
  5681                                TO REPLETRO
  5682         ELSE
  5683             MOVE LOW-VALUES    TO REPLETRO.
  5684
  5685     IF  CF-ST-TARGET-LOSS-RATIO NUMERIC
  5686         IF  CF-ST-TARGET-LOSS-RATIO NOT = ZEROS
  5687             MOVE CF-ST-TARGET-LOSS-RATIO
  5688                                TO TARRATO
  5689         ELSE
  5690             MOVE ZEROS         TO TARRATO
  5691     ELSE
  5692         MOVE ZEROS             TO TARRATO.
  5693
  5694     IF  CF-ST-CALC-INTEREST NUMERIC
  5695         IF  CF-ST-CALC-INTEREST NOT = ZEROS
  5696             MOVE CF-ST-CALC-INTEREST
  5697                                TO CALCINTO
  5698         ELSE
  5699             MOVE ZEROS         TO CALCINTO
  5700     ELSE
  5701         MOVE ZEROS             TO CALCINTO.
  5702
  5703     IF  CF-ST-COMM-CAP-SL NUMERIC
  5704         IF  CF-ST-COMM-CAP-SL NOT = ZEROS
  5705             MOVE CF-ST-COMM-CAP-SL
  5706                                TO COMSLO
  5707         ELSE
  5708             MOVE ZEROS         TO COMSLO
  5709     ELSE
  5710         MOVE ZEROS             TO COMSLO.
  5711
  5712     IF  CF-ST-COMM-CAP-JL NUMERIC
  5713         IF  CF-ST-COMM-CAP-JL NOT = ZEROS
  5714             MOVE CF-ST-COMM-CAP-JL
  5715                                TO COMJLO
  5716         ELSE
  5717             MOVE ZEROS         TO COMJLO
  5718     ELSE
  5719         MOVE ZEROS             TO COMJLO.
  5720
  5721     IF  CF-ST-COMM-CAP-SA NUMERIC
  5722         IF  CF-ST-COMM-CAP-SA NOT = ZEROS
  5723             MOVE CF-ST-COMM-CAP-SA
  5724                                TO COMSAO
  5725         ELSE
  5726             MOVE ZEROS         TO COMSAO
  5727     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL106.cbl
  5728         MOVE ZEROS             TO COMSAO.
  5729
  5730     IF  CF-ST-COMM-CAP-JA NUMERIC
  5731         IF  CF-ST-COMM-CAP-JA NOT = ZEROS
  5732             MOVE CF-ST-COMM-CAP-JA
  5733                                TO COMJAO
  5734         ELSE
  5735             MOVE ZEROS         TO COMJAO
  5736     ELSE
  5737         MOVE ZEROS             TO COMJAO.
  5738
  5739     IF  CF-ST-RES-TAX-PCT NUMERIC
  5740         IF  CF-ST-RES-TAX-PCT NOT = ZEROS
  5741             MOVE CF-ST-RES-TAX-PCT
  5742                                TO RESTAXO
  5743         ELSE
  5744             MOVE ZEROS         TO RESTAXO
  5745     ELSE
  5746         MOVE ZEROS             TO RESTAXO.
  5747
  5748     IF CF-ST-FREE-LOOK-PERIOD NUMERIC
  5749        IF CF-ST-FREE-LOOK-PERIOD NOT = ZEROS
  5750             MOVE CF-ST-FREE-LOOK-PERIOD
  5751                                TO FREELKO
  5752        ELSE
  5753             MOVE ZEROS         TO FREELKO
  5754     ELSE
  5755         MOVE ZEROS             TO FREELKO.
  5756
  5757*    IF PI-COMPANY-ID = 'NCL'
  5758*    IF  CF-ST-STAT-INTEREST NUMERIC
  5759*        IF  CF-ST-STAT-INTEREST NOT = ZEROS
  5760*            MOVE CF-ST-STAT-INTEREST
  5761*                               TO STATRO
  5762*        ELSE
  5763*            MOVE ZEROS         TO STATRO
  5764*    ELSE
  5765*        MOVE ZEROS             TO STATRO.
  5766
  5767*    IF PI-COMPANY-ID = 'NCL'
  5768*    IF  CF-ST-STAT-INTEREST-1 NUMERIC
  5769*        IF  CF-ST-STAT-INTEREST-1 NOT = ZEROS
  5770*            MOVE CF-ST-STAT-INTEREST-1
  5771*                               TO STATR1O
  5772*        ELSE
  5773*            MOVE ZEROS         TO STATR1O
  5774*    ELSE
  5775*        MOVE ZEROS             TO STATR1O.
  5776
  5777*    IF PI-COMPANY-ID = 'NCL'
  5778*    IF  CF-ST-STAT-INTEREST-2 NUMERIC
  5779*        IF  CF-ST-STAT-INTEREST-2 NOT = ZEROS
  5780*            MOVE CF-ST-STAT-INTEREST-2
  5781*                               TO STATR2O
  5782*        ELSE
  5783*            MOVE ZEROS         TO STATR2O
  5784*    ELSE
  5785*        MOVE ZEROS             TO STATR2O.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL106.cbl
  5786
  5787*    IF PI-COMPANY-ID = 'NCL'
  5788*    IF  CF-ST-STAT-INTEREST-3 NUMERIC
  5789*        IF  CF-ST-STAT-INTEREST-3 NOT = ZEROS
  5790*            MOVE CF-ST-STAT-INTEREST-3
  5791*                               TO STATR3O
  5792*        ELSE
  5793*            MOVE ZEROS         TO STATR3O
  5794*    ELSE
  5795*        MOVE ZEROS             TO STATR3O.
  5796
  5797     MOVE CF-COMM-CAP-LIMIT-TO  TO LIMITO.
  5798*    MOVE CF-ST-STAT-DATE-FROM  TO STATIO.
  5799
  5800     MOVE CF-LAST-MAINT-BY      TO LSTUSRO.
  5801     MOVE ' '                   TO DC-OPTION-CODE.
  5802     MOVE CF-LAST-MAINT-DT      TO DC-BIN-DATE-1.
  5803     MOVE LINK-ELDATCV          TO PGM-NAME.
  5804
  5805* EXEC CICS LINK
  5806*        PROGRAM (PGM-NAME)
  5807*        COMMAREA(DATE-CONVERSION-DATA)
  5808*        LENGTH  (DC-COMM-LENGTH)
  5809*    END-EXEC.
  5810*    MOVE '."C                   ''   #00005185' TO DFHEIV0
  5811     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5812     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5813     MOVE X'2020233030303035313835' TO DFHEIV0(25:11)
  5814     CALL 'kxdfhei1' USING DFHEIV0,
  5815           PGM-NAME,
  5816           DATE-CONVERSION-DATA,
  5817           DC-COMM-LENGTH,
  5818           DFHEIV99,
  5819           DFHEIV99,
  5820           DFHEIV99
  5821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5822
  5823
  5824     IF DATE-CONVERSION-ERROR
  5825         MOVE ZEROS              TO LSTDTEO
  5826     ELSE
  5827         MOVE DC-GREG-DATE-1-EDIT
  5828                                 TO LSTDTEO.
  5829
  5830     MOVE CF-LAST-MAINT-HHMMSS   TO TIME-IN.
  5831     MOVE TIME-OUT               TO LSTTIMEO.
  5832     MOVE -1                     TO MAINTL.
  5833     MOVE CF-LAST-MAINT-BY       TO PI-UPDATE-BY.
  5834     MOVE CF-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  5835     MOVE CF-STATE-CODE          TO PI-PREV-STATE.
  5836     MOVE AL-UANOF               TO MAINTA.
  5837     MOVE AL-UANON               TO STCDA
  5838                                  STNAMEA
  5839                                  STABRA
  5840                                  CLREJECA ISSREJA REFREJA
  5841                                  EXTCHGA STUEA STCNTLA STDEVA
  5842                                  REMTERMA
  5843                                  LFREDA LFLEVA LFNETA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL106.cbl
  5844                                  AHAHA  AHCPA
  5845                                  REPLAWA REPLETRA SPLPMTA
  5846                                  LIMITA.
  5847*    IF PI-COMPANY-ID = 'NCL'
  5848*        MOVE AL-UANON           TO STATIA.
  5849
  5850     MOVE AL-UNNON               TO LFEXPA AHEXPA
  5851                                  QUOTCALA PREMTOLA REFTOLA
  5852                                  OVSAMTA  OVSPCTA
  5853                                  LFTAXA   AHITAXA  AHGTAXA
  5854                                  PRMPCTA  REFPCTA
  5855                                  REFDAY1A REFDAYSA
  5856                                  REFMINA EXTDAYSA
  5857                                  TARRATA
  5858                                  CALCINTA
  5859                                  RESTAXA FREELKA
  5860                                  COMSLA COMJLA COMSAA COMJAA.
  5861
  5862*    IF PI-COMPANY-ID = 'NCL'
  5863*        MOVE AL-UNNON           TO STATRA STATR1A STATR2A
  5864*                                                  STATR3A
  5865*                                                  INTDAYSA.
  5866
  5867     IF RETURN-DISPLAY
  5868         GO TO 8100-SEND-INITIAL-MAP
  5869     ELSE
  5870         GO TO 8200-SEND-DATAONLY.
  5871
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL106.cbl
  5873 8100-SEND-INITIAL-MAP.
  5874     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
  5875       AND PI-WS-STATE = 'AK'
  5876        MOVE AL-SANON TO STCHKHDA STCHKNOA
  5877     ELSE
  5878        MOVE AL-SADOF TO STCHKHDA STCHKNOA
  5879     END-IF.
  5880     MOVE SAVE-DATE              TO RUNDTEO.
  5881     MOVE EIBTIME                TO TIME-IN.
  5882     MOVE TIME-OUT               TO RUNTIMEO.
  5883     MOVE -1                     TO MAINTL.
  5884     MOVE PI-LIFE-OVERRIDE-L6    TO LEXPLBLO.
  5885     MOVE PI-AH-OVERRIDE-L6      TO AEXPLBLO.
  5886     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  5887     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  5888
  5889*    IF PI-COMPANY-ID = 'NCL'
  5890*       MOVE AL-SANON            TO STATZA
  5891*                                   INTDAYZA
  5892*                                   STATRZA
  5893*                                   RNG1A
  5894*                                   RNG2A
  5895*                                   RNG3A
  5896*       MOVE AL-UANON            TO STATIA
  5897*                                   STATRA
  5898*                                   STATR1A
  5899*                                   STATR2A
  5900*                                   STATR3A
  5901*       MOVE AL-UNNON            TO INTDAYSA.
  5902
  5903
  5904* EXEC CICS SEND
  5905*        MAP   (MAP-NAME)
  5906*        MAPSET(MAPSET-NAME)
  5907*        FROM  (EL106AO)
  5908*        ERASE
  5909*        CURSOR
  5910*    END-EXEC.
  5911     MOVE LENGTH OF
  5912      EL106AO
  5913       TO DFHEIV12
  5914     MOVE -1
  5915       TO DFHEIV11
  5916*    MOVE '8$     CT  E    H L F ,   #00005270' TO DFHEIV0
  5917     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5918     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5919     MOVE X'2020233030303035323730' TO DFHEIV0(25:11)
  5920     CALL 'kxdfhei1' USING DFHEIV0,
  5921           MAP-NAME,
  5922           EL106AO,
  5923           DFHEIV12,
  5924           MAPSET-NAME,
  5925           DFHEIV99,
  5926           DFHEIV99,
  5927           DFHEIV99,
  5928           DFHEIV11,
  5929           DFHEIV99,
  5930           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL106.cbl
  5931           DFHEIV99
  5932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5933
  5934
  5935     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL106.cbl
  5937 8200-SEND-DATAONLY.
  5938
  5939     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
  5940       AND PI-WS-STATE = 'AK'
  5941        MOVE AL-SANON TO STCHKHDA STCHKNOA
  5942     ELSE
  5943        MOVE AL-SADOF TO STCHKHDA STCHKNOA
  5944     END-IF.
  5945
  5946     MOVE SAVE-DATE      TO RUNDTEO.
  5947     MOVE EIBTIME        TO TIME-IN.
  5948     MOVE TIME-OUT       TO RUNTIMEO.
  5949
  5950     IF QUOTCALL NOT = ZEROS
  5951        IF QUOTCALI NUMERIC
  5952           MOVE QUOTCALI TO QUOTCALO.
  5953
  5954     IF PREMTOLL NOT = ZEROS
  5955        IF PREMTOLI NUMERIC
  5956           MOVE PREMTOLI TO PREMTOLO.
  5957
  5958     IF OVSAMTL NOT = ZEROS
  5959        IF OVSAMTI NUMERIC
  5960           MOVE OVSAMTI TO OVSAMTO.
  5961
  5962     IF REFTOLL NOT = ZEROS
  5963        IF REFTOLI NUMERIC
  5964           MOVE REFTOLI TO REFTOLO.
  5965
  5966     IF PRMPCTL NOT = ZEROS
  5967        IF PRMPCTI NUMERIC
  5968           MOVE PRMPCTI TO PRMPCTO.
  5969
  5970     IF OVSPCTL NOT = ZEROS
  5971        IF OVSPCTI NUMERIC
  5972           MOVE OVSPCTI TO OVSPCTO.
  5973
  5974     IF LFTAXL NOT = ZEROS
  5975        IF LFTAXI NUMERIC
  5976           MOVE LFTAXI           TO LFTAXO
  5977        END-IF
  5978     END-IF
  5979
  5980     IF AHITAXL NOT = ZEROS
  5981        IF AHITAXI NUMERIC
  5982           MOVE AHITAXI          TO AHITAXO
  5983        END-IF
  5984     END-IF
  5985
  5986     IF AHGTAXL NOT = ZEROS
  5987        IF AHGTAXI NUMERIC
  5988           MOVE AHGTAXI          TO AHGTAXO
  5989        END-IF
  5990     END-IF
  5991
  5992     IF REFPCTL NOT = ZEROS
  5993        IF REFPCTI NUMERIC
  5994           MOVE REFPCTI TO REFPCTO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL106.cbl
  5995
  5996     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  5997     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  5998
  5999
  6000* EXEC CICS SEND
  6001*        MAP   (MAP-NAME)
  6002*        MAPSET(MAPSET-NAME)
  6003*        FROM  (EL106AO)
  6004*        DATAONLY
  6005*        ERASEAUP
  6006*        CURSOR
  6007*    END-EXEC.
  6008     MOVE LENGTH OF
  6009      EL106AO
  6010       TO DFHEIV12
  6011     MOVE -1
  6012       TO DFHEIV11
  6013*    MOVE '8$D    CT  A    H L F ,   #00005342' TO DFHEIV0
  6014     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  6015     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6016     MOVE X'2020233030303035333432' TO DFHEIV0(25:11)
  6017     CALL 'kxdfhei1' USING DFHEIV0,
  6018           MAP-NAME,
  6019           EL106AO,
  6020           DFHEIV12,
  6021           MAPSET-NAME,
  6022           DFHEIV99,
  6023           DFHEIV99,
  6024           DFHEIV99,
  6025           DFHEIV11,
  6026           DFHEIV99,
  6027           DFHEIV99,
  6028           DFHEIV99
  6029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6030
  6031
  6032     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL106.cbl
  6034 8300-SEND-TEXT.
  6035
  6036* EXEC CICS SEND TEXT
  6037*        FROM  (LOGOFF-TEXT)
  6038*        LENGTH(LOGOFF-LENGTH)
  6039*        ERASE
  6040*        FREEKB
  6041*    END-EXEC.
  6042*    MOVE '8&      T  E F  H   F -   #00005354' TO DFHEIV0
  6043     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  6044     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  6045     MOVE X'2020233030303035333534' TO DFHEIV0(25:11)
  6046     CALL 'kxdfhei1' USING DFHEIV0,
  6047           LOGOFF-TEXT,
  6048           LOGOFF-LENGTH,
  6049           DFHEIV99,
  6050           DFHEIV99,
  6051           DFHEIV99,
  6052           DFHEIV99,
  6053           DFHEIV99,
  6054           DFHEIV99,
  6055           DFHEIV99,
  6056           DFHEIV99,
  6057           DFHEIV99,
  6058           DFHEIV99
  6059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6060
  6061
  6062
  6063* EXEC CICS RETURN
  6064*    END-EXEC.
  6065*    MOVE '.(                    &   #00005361' TO DFHEIV0
  6066     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6067     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6068     MOVE X'2020233030303035333631' TO DFHEIV0(25:11)
  6069     CALL 'kxdfhei1' USING DFHEIV0,
  6070           DFHEIV99,
  6071           DFHEIV99,
  6072           DFHEIV99,
  6073           DFHEIV99,
  6074           DFHEIV99
  6075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6076
  6077
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL106.cbl
  6079 8400-LOG-JOURNAL-RECORD.
  6080     IF PI-JOURNAL-FILE-ID = 0
  6081         GO TO 8400-EXIT.
  6082
  6083     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  6084     MOVE ELCNTL-ID              TO JP-FILE-ID.
  6085     MOVE THIS-PGM               TO JP-PROGRAM-ID.
  6086*    EXEC CICS JOURNAL
  6087*         JFILEID(PI-JOURNAL-FILE-ID)
  6088*         JTYPEID('EL')
  6089*         FROM   (JOURNAL-RECORD)
  6090*         LENGTH (773)
  6091*    END-EXEC.
  6092
  6093 8400-EXIT.
  6094     EXIT.
  6095
  6096 8800-UNAUTHORIZED-ACCESS.
  6097     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  6098     GO TO 8300-SEND-TEXT.
  6099
  6100 8810-PF23.
  6101     MOVE EIBAID   TO PI-ENTRY-CD-1.
  6102     MOVE XCTL-EL005 TO PGM-NAME.
  6103     GO TO 9300-XCTL.
  6104
  6105 8850-DUPREC.
  6106     MOVE ER-0147 TO EMI-ERROR.
  6107     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6108     MOVE -1       TO STCDL.
  6109     MOVE AL-UABON TO STCDA.
  6110     GO TO 8200-SEND-DATAONLY.
  6111
  6112 8860-ENDFILE.
  6113     MOVE LOW-VALUES TO EL106AO.
  6114     MOVE ER-0148    TO EMI-ERROR.
  6115     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6116     MOVE -1 TO MAINTL.
  6117     MOVE SPACES TO PI-WS-STATE.
  6118     GO TO 8100-SEND-INITIAL-MAP.
  6119
  6120 8870-NOTOPEN.
  6121     MOVE ER-0042 TO EMI-ERROR.
  6122     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6123     MOVE -1 TO MAINTL.
  6124     GO TO 8200-SEND-DATAONLY.
  6125
  6126 8880-NOT-FOUND.
  6127     MOVE ER-0149 TO EMI-ERROR.
  6128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6129     MOVE -1       TO STCDL.
  6130     MOVE AL-UABON TO STCDA.
  6131     GO TO 8200-SEND-DATAONLY.
  6132
  6133 8890-LETR-NOT-OPEN.
  6134     MOVE ER-0013                TO EMI-ERROR.
  6135     MOVE -1                     TO REPLETRL.
  6136     MOVE AL-UABON               TO REPLETRA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL106.cbl
  6137     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6138     GO TO 8200-SEND-DATAONLY.
  6139
  6140 9000-RETURN-CICS.
  6141
  6142* EXEC CICS RETURN
  6143*    END-EXEC.
  6144*    MOVE '.(                    &   #00005427' TO DFHEIV0
  6145     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6146     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6147     MOVE X'2020233030303035343237' TO DFHEIV0(25:11)
  6148     CALL 'kxdfhei1' USING DFHEIV0,
  6149           DFHEIV99,
  6150           DFHEIV99,
  6151           DFHEIV99,
  6152           DFHEIV99,
  6153           DFHEIV99
  6154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6155
  6156
  6157 9100-RETURN-TRAN.
  6158     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  6159     MOVE '106A'                 TO PI-CURRENT-SCREEN-NO.
  6160
  6161
  6162* EXEC CICS RETURN
  6163*        TRANSID (TRANS-ID)
  6164*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  6165*        LENGTH  (WS-COMM-LENGTH)
  6166*    END-EXEC.
  6167*    MOVE '.(CT                  &   #00005434' TO DFHEIV0
  6168     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6169     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6170     MOVE X'2020233030303035343334' TO DFHEIV0(25:11)
  6171     CALL 'kxdfhei1' USING DFHEIV0,
  6172           TRANS-ID,
  6173           PROGRAM-INTERFACE-BLOCK,
  6174           WS-COMM-LENGTH,
  6175           DFHEIV99,
  6176           DFHEIV99
  6177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6178
  6179
  6180 9200-RETURN-MAIN-MENU.
  6181     IF  CREDIT-SESSION
  6182         MOVE XCTL-EL626           TO PGM-NAME
  6183     ELSE
  6184     IF  CLAIM-SESSION
  6185         MOVE XCTL-EL126           TO PGM-NAME
  6186     ELSE
  6187     IF  MORTGAGE-SESSION
  6188         MOVE XCTL-EM626           TO PGM-NAME
  6189     ELSE
  6190     IF  GENERAL-LEDGER-SESSION
  6191         MOVE XCTL-GL800           TO PGM-NAME.
  6192
  6193     GO TO 9300-XCTL.
  6194
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL106.cbl
  6195 9300-XCTL.
  6196
  6197* EXEC CICS XCTL
  6198*        PROGRAM (PGM-NAME)
  6199*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  6200*        LENGTH  (WS-COMM-LENGTH)
  6201*    END-EXEC.
  6202*    MOVE '.$C                   $   #00005456' TO DFHEIV0
  6203     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6204     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6205     MOVE X'2020233030303035343536' TO DFHEIV0(25:11)
  6206     CALL 'kxdfhei1' USING DFHEIV0,
  6207           PGM-NAME,
  6208           PROGRAM-INTERFACE-BLOCK,
  6209           WS-COMM-LENGTH
  6210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6211
  6212
  6213 9400-CLEAR.
  6214     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  6215     GO TO 9300-XCTL.
  6216
  6217 9500-PF12.
  6218     MOVE XCTL-EL010 TO PGM-NAME.
  6219     GO TO 9300-XCTL.
  6220
  6221 9600-PGMID-ERROR.
  6222
  6223* EXEC CICS HANDLE CONDITION
  6224*        PGMIDERR(8300-SEND-TEXT)
  6225*    END-EXEC.
  6226*    MOVE '"$L                   ! ) #00005471' TO DFHEIV0
  6227     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6229     MOVE X'2920233030303035343731' TO DFHEIV0(25:11)
  6230     CALL 'kxdfhei1' USING DFHEIV0
  6231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6232
  6233
  6234     MOVE PGM-NAME      TO PI-CALLING-PROGRAM.
  6235     MOVE ' '           TO PI-ENTRY-CD-1.
  6236     MOVE XCTL-EL005    TO PGM-NAME.
  6237     MOVE PGM-NAME      TO LOGOFF-PGM.
  6238     MOVE PGMIDERR-MSG  TO LOGOFF-FILL.
  6239     GO TO 9300-XCTL.
  6240
  6241 9700-LINK-DATE-CONVERT.
  6242
  6243* EXEC CICS LINK
  6244*        PROGRAM    ('ELDATCV')
  6245*        COMMAREA   (DATE-CONVERSION-DATA)
  6246*        LENGTH     (DC-COMM-LENGTH)
  6247*    END-EXEC.
  6248     MOVE 'ELDATCV' TO DFHEIV1
  6249*    MOVE '."C                   ''   #00005483' TO DFHEIV0
  6250     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6251     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6252     MOVE X'2020233030303035343833' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL106.cbl
  6253     CALL 'kxdfhei1' USING DFHEIV0,
  6254           DFHEIV1,
  6255           DATE-CONVERSION-DATA,
  6256           DC-COMM-LENGTH,
  6257           DFHEIV99,
  6258           DFHEIV99,
  6259           DFHEIV99
  6260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6261
  6262
  6263 9700-EXIT.
  6264     EXIT.
  6265
  6266 9900-ERROR-FORMAT.
  6267     IF NOT EMI-ERRORS-COMPLETE
  6268         MOVE LINK-EL001 TO PGM-NAME
  6269
  6270* EXEC CICS LINK
  6271*            PROGRAM (PGM-NAME)
  6272*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  6273*            LENGTH  (EMI-COMM-LENGTH)
  6274*        END-EXEC.
  6275*    MOVE '."C                   ''   #00005495' TO DFHEIV0
  6276     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6277     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6278     MOVE X'2020233030303035343935' TO DFHEIV0(25:11)
  6279     CALL 'kxdfhei1' USING DFHEIV0,
  6280           PGM-NAME,
  6281           ERROR-MESSAGE-INTERFACE-BLOCK,
  6282           EMI-COMM-LENGTH,
  6283           DFHEIV99,
  6284           DFHEIV99,
  6285           DFHEIV99
  6286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6287
  6288
  6289 9900-EXIT.
  6290     EXIT.
  6291
  6292 9910-INITIALIZE-SECURITY.
  6293******************************************************************
  6294*                                                                *
  6295*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  6296*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  6297*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  6298*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  6299*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  6300*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  6301*                                                                *
  6302******************************************************************
  6303     IF  PI-PROCESSOR-ID NOT = 'LGXX'
  6304         IF  MORTGAGE-SESSION
  6305             MOVE '125E'             TO SC-QUID-SYSTEM
  6306             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  6307
  6308* EXEC CICS READQ TS
  6309*                QUEUE  (SC-QUID-KEY)
  6310*                INTO   (SECURITY-CONTROL-E)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL106.cbl
  6311*                LENGTH (SC-COMM-LENGTH-E)
  6312*                ITEM   (SC-ITEM)
  6313*            END-EXEC
  6314*    MOVE '*$II   L              ''   #00005519' TO DFHEIV0
  6315     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6316     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6317     MOVE X'2020233030303035353139' TO DFHEIV0(25:11)
  6318     CALL 'kxdfhei1' USING DFHEIV0,
  6319           SC-QUID-KEY,
  6320           SECURITY-CONTROL-E,
  6321           SC-COMM-LENGTH-E,
  6322           SC-ITEM,
  6323           DFHEIV99,
  6324           DFHEIV99
  6325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6326             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  6327                                     TO PI-DISPLAY-CAP
  6328             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  6329                                     TO PI-MODIFY-CAP
  6330             IF  NOT DISPLAY-CAP
  6331                 MOVE 'READ'         TO SM-READ
  6332                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6333                 MOVE ER-9097        TO EMI-ERROR
  6334                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6335                 GO TO 8100-SEND-INITIAL-MAP
  6336             ELSE
  6337                 GO TO 9910-EXIT
  6338         ELSE
  6339
  6340* EXEC CICS  READQ TS
  6341*                QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6342*                INTO    (SECURITY-CONTROL)
  6343*                LENGTH  (SC-COMM-LENGTH)
  6344*                ITEM    (SC-ITEM-CL-CR)
  6345*                END-EXEC
  6346*    MOVE '*$II   L              ''   #00005538' TO DFHEIV0
  6347     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6348     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6349     MOVE X'2020233030303035353338' TO DFHEIV0(25:11)
  6350     CALL 'kxdfhei1' USING DFHEIV0,
  6351           PI-SECURITY-TEMP-STORE-ID,
  6352           SECURITY-CONTROL,
  6353           SC-COMM-LENGTH,
  6354           SC-ITEM-CL-CR,
  6355           DFHEIV99,
  6356           DFHEIV99
  6357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6358             MOVE SC-CREDIT-DISPLAY (29)
  6359                                 TO PI-DISPLAY-CAP
  6360             MOVE SC-CREDIT-UPDATE  (29)
  6361                                 TO PI-MODIFY-CAP
  6362             IF  NOT DISPLAY-CAP
  6363                 MOVE 'READ'     TO SM-READ
  6364                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6365                 MOVE ER-0070    TO  EMI-ERROR
  6366                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6367                 GO TO 8100-SEND-INITIAL-MAP.
  6368 9910-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL106.cbl
  6369     EXIT.
  6370 9990-ABEND.
  6371     MOVE LINK-EL004             TO PGM-NAME.
  6372     MOVE DFHEIBLK               TO EMI-LINE1.
  6373
  6374* EXEC CICS LINK
  6375*        PROGRAM   (PGM-NAME)
  6376*        COMMAREA  (EMI-LINE1)
  6377*        LENGTH    (72)
  6378*    END-EXEC.
  6379     MOVE 72
  6380       TO DFHEIV11
  6381*    MOVE '."C                   ''   #00005559' TO DFHEIV0
  6382     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6383     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6384     MOVE X'2020233030303035353539' TO DFHEIV0(25:11)
  6385     CALL 'kxdfhei1' USING DFHEIV0,
  6386           PGM-NAME,
  6387           EMI-LINE1,
  6388           DFHEIV11,
  6389           DFHEIV99,
  6390           DFHEIV99,
  6391           DFHEIV99
  6392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6393
  6394
  6395     GO TO 8200-SEND-DATAONLY.
  6396
  6397 9995-SECURITY-VIOLATION.
  6398*           COPY ELCSCTP.
  6399******************************************************************
  6400*                                                                *
  6401*                            ELCSCTP                             *
  6402*                            VMOD=2.001                          *
  6403*                                                                *
  6404*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6405******************************************************************
  6406
  6407
  6408     MOVE EIBDATE          TO SM-JUL-DATE.
  6409     MOVE EIBTRMID         TO SM-TERMID.
  6410     MOVE THIS-PGM         TO SM-PGM.
  6411     MOVE EIBTIME          TO TIME-IN.
  6412     MOVE TIME-OUT         TO SM-TIME.
  6413     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6414
  6415
  6416* EXEC CICS LINK
  6417*         PROGRAM  ('EL003')
  6418*         COMMAREA (SECURITY-MESSAGE)
  6419*         LENGTH   (80)
  6420*    END-EXEC.
  6421     MOVE 'EL003' TO DFHEIV1
  6422     MOVE 80
  6423       TO DFHEIV11
  6424*    MOVE '."C                   ''   #00005585' TO DFHEIV0
  6425     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6426     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL106.cbl
  6427     MOVE X'2020233030303035353835' TO DFHEIV0(25:11)
  6428     CALL 'kxdfhei1' USING DFHEIV0,
  6429           DFHEIV1,
  6430           SECURITY-MESSAGE,
  6431           DFHEIV11,
  6432           DFHEIV99,
  6433           DFHEIV99,
  6434           DFHEIV99
  6435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6436
  6437
  6438******************************************************************
  6439
  6440
  6441 9995-EXIT.
  6442      EXIT.
  6443
  6444
  6445 9999-DFHBACK SECTION.
  6446     MOVE '9%                    "   ' TO DFHEIV0
  6447     MOVE 'EL106' TO DFHEIV1
  6448     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6449     GOBACK.
  6450 9999-DFHEXIT.
  6451     IF DFHEIGDJ EQUAL 0001
  6452         NEXT SENTENCE
  6453     ELSE IF DFHEIGDJ EQUAL 2
  6454         GO TO 8850-DUPREC,
  6455               8870-NOTOPEN,
  6456               8880-NOT-FOUND,
  6457               9600-PGMID-ERROR,
  6458               9990-ABEND
  6459         DEPENDING ON DFHEIGDI
  6460     ELSE IF DFHEIGDJ EQUAL 3
  6461         GO TO 8880-NOT-FOUND,
  6462               8880-NOT-FOUND
  6463         DEPENDING ON DFHEIGDI
  6464     ELSE IF DFHEIGDJ EQUAL 4
  6465         GO TO 8100-SEND-INITIAL-MAP
  6466         DEPENDING ON DFHEIGDI
  6467     ELSE IF DFHEIGDJ EQUAL 5
  6468         GO TO 8860-ENDFILE
  6469         DEPENDING ON DFHEIGDI
  6470     ELSE IF DFHEIGDJ EQUAL 6
  6471         GO TO 8860-ENDFILE
  6472         DEPENDING ON DFHEIGDI
  6473     ELSE IF DFHEIGDJ EQUAL 7
  6474         GO TO 6010-LETR-NOT-FOUND,
  6475               6010-LETR-NOT-FOUND,
  6476               8890-LETR-NOT-OPEN
  6477         DEPENDING ON DFHEIGDI
  6478     ELSE IF DFHEIGDJ EQUAL 8
  6479         GO TO 6600-EXIT
  6480         DEPENDING ON DFHEIGDI
  6481     ELSE IF DFHEIGDJ EQUAL 9
  6482         GO TO 8300-SEND-TEXT
  6483         DEPENDING ON DFHEIGDI.
  6484     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL106.cbl
  6485     MOVE 'EL106' TO DFHEIV1
  6486     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6487     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5108     Code:       18837
