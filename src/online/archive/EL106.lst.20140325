* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   1
* EL106.cbl
* Options: int("EL106.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL106.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL106.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL106.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL106.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:41:00.
     7*                            VMOD=2.026.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   2
* EL106.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION- EX10 - STATE MAINTENANCE
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* Changes are marked by the Change Effective date.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 100108    2008022800002  AJRA  ADD CHECK NUMBER TO STATE FOR AK
    34* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
    35* 011211    2010030900001  AJRA  ADD OPTION 4 AND 5 TO REFUND IND
    36* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
    37* 031512    2011120900003  AJRA  ADD AHL COMPANY CODE
    38* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
    39******************************************************************
    40
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   3
* EL106.cbl
    42 ENVIRONMENT DIVISION.
    43 DATA DIVISION.
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL106 WORKING STORAGE     *'.
    48 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.026 ***********'.
    49
    50*                                COPY ELCSCTM.
    51******************************************************************
    52*                                                                *
    53*                                                                *
    54*                            ELCSCTM                             *
    55*                            VMOD=2.001                          *
    56*                                                                *
    57*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    58*                                                                *
    59******************************************************************
    60 01  SECURITY-MESSAGE.
    61     12  FILLER                          PIC X(30)
    62            VALUE '** LOGIC SECURITY VIOLATION -'.
    63     12  SM-READ                         PIC X(6).
    64     12  FILLER                          PIC X(5)
    65            VALUE ' PGM='.
    66     12  SM-PGM                          PIC X(6).
    67     12  FILLER                          PIC X(5)
    68            VALUE ' OPR='.
    69     12  SM-PROCESSOR-ID                 PIC X(4).
    70     12  FILLER                          PIC X(6)
    71            VALUE ' TERM='.
    72     12  SM-TERMID                       PIC X(4).
    73     12  FILLER                          PIC XX   VALUE SPACE.
    74     12  SM-JUL-DATE                     PIC 9(5).
    75     12  FILLER                          PIC X    VALUE SPACE.
    76     12  SM-TIME                         PIC 99.99.
    77
    78*                                COPY ELCSCRTY.
    79******************************************************************
    80*                                                                *
    81*                                                                *
    82*                            ELCSCRTY                            *
    83*                            VMOD=2.001                          *
    84*                                                                *
    85*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    86*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    87*        SAVED IN PI-SECURITY-ADDRESS.                           *
    88*                                                                *
    89******************************************************************
    90 01  SECURITY-CONTROL.
    91     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    92     12  FILLER                       PIC XX    VALUE 'SC'.
    93     12  SC-CREDIT-CODES.
    94         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    95             20  SC-CREDIT-DISPLAY    PIC X.
    96             20  SC-CREDIT-UPDATE     PIC X.
    97     12  SC-CLAIMS-CODES.
    98         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    99             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   4
* EL106.cbl
   100             20  SC-CLAIMS-UPDATE     PIC X.
   101*                                COPY MPCSCRT.
   102******************************************************************
   103*                                                                *
   104*                            MPCSCRT                             *
   105*                            VMOD=1.001                          *
   106*                                                                *
   107*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   108*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   109*                                      (MP MORTGAGE PROTECTION)  *
   110*                                                                *
   111******************************************************************
   112*
   113 01  SECURITY-CONTROL-E.
   114     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   115     12  FILLER                       PIC  X(02) VALUE 'SC'.
   116     12  SC-QUID-KEY.
   117         16  SC-QUID-TERMINAL         PIC  X(04).
   118         16  SC-QUID-SYSTEM           PIC  X(04).
   119     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   120     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   121     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   122         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   123         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   124     12  SC-MP-CODES.
   125         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   126             20  SC-MP-DISPLAY        PIC  X(01).
   127             20  SC-MP-UPDATE         PIC  X(01).
   128     12  FILLER                       PIC  X(40).
   129
   130 01  WS-DATE-AREA.
   131     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   132     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   133
   134 01  WS.
   135     05  W-APPL-SCRTY-NDX    PIC S9(04) COMP   VALUE +29.
   136     05  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   137     05  WS-COMM-LENGTH      PIC S9(4) COMP VALUE +1500.
   138     05  WS-MAP-LENGTH       PIC S9(4) COMP VALUE +500.
   139     05  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   140     05  QID.
   141         16  QID-TERM        PIC X(4).
   142         16  FILLER          PIC X(4)    VALUE '106A'.
   143
   144     05  WS-ST-TOL-PREM-PCT  PIC S9V9(4)    VALUE +0.
   145     05  WS-ST-TOL-REF-PCT   PIC S9V9(4)    VALUE +0.
   146     05  WS-ST-OVR-SHT-PCT   PIC S9V9(4)    VALUE +0.
   147     05  WS-ST-LF-PREM-TAX   PIC S9V9(4)    VALUE +0.
   148     05  WS-ST-AH-PREM-TAX-I PIC S9V9(4)    VALUE +0.
   149     05  WS-ST-AH-PREM-TAX-G PIC S9V9(4)    VALUE +0.
   150     05  WS-ST-LF-EXP-PCT    PIC S9(3)V9(4) VALUE +0.
   151     05  WS-ST-AH-EXP-PCT    PIC S9(3)V9(4) VALUE +0.
   152     05  WS-ST-TARGET-LOSS-RATIO
   153                             PIC S9V9(4)    VALUE +0.
   154     05  WS-ST-CALC-INTEREST PIC S9V9(4)    VALUE +0.
   155     05  WS-COMSL            PIC S9V9(4)    VALUE +0.
   156     05  WS-COMJL            PIC S9V9(4)    VALUE +0.
   157     05  WS-COMSA            PIC S9V9(4)    VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   5
* EL106.cbl
   158     05  WS-COMJA            PIC S9V9(4)    VALUE +0.
   159     05  WS-RESIDENT-TAX     PIC S9V9(4)    VALUE +0.
   160     05  WS-IRATE            PIC S9V9(4)    VALUE +0.
   161     05  WS-IRATE1           PIC S9V9(4)    VALUE +0.
   162     05  WS-IRATE2           PIC S9V9(4)    VALUE +0.
   163     05  WS-IRATE3           PIC S9V9(4)    VALUE +0.
   164     05  WS-FREE-LOOK-DAYS   PIC S9(3)      VALUE +0.
   165
   166 01  STANDARD-AREAS.
   167     12  MAP-NAME            PIC X(8)    VALUE 'EL106A'.
   168     12  MAPSET-NAME         PIC X(8)    VALUE 'EL106S'.
   169     12  TRANS-ID            PIC X(4)    VALUE 'EX10'.
   170     12  PGM-NAME            PIC X(8).
   171     12  TIME-IN             PIC S9(7).
   172     12  TIME-OUT-R  REDEFINES TIME-IN.
   173         16  FILLER          PIC X.
   174         16  TIME-OUT        PIC 99V99.
   175         16  FILLER          PIC XX.
   176     12  XCTL-EL005          PIC X(8)    VALUE 'EL005'.
   177     12  XCTL-EL010          PIC X(8)    VALUE 'EL010'.
   178     12  XCTL-EL126          PIC X(8)    VALUE 'EL126'.
   179     12  XCTL-EL626          PIC X(8)    VALUE 'EL626'.
   180     12  XCTL-EL6565         PIC X(8)    VALUE 'EL6565'.
   181     12  XCTL-EL6507         PIC X(8)    VALUE 'EL6507'.
   182     12  XCTL-EL1061         PIC X(8)    VALUE 'EL1061'.
   183     12  XCTL-EM626          PIC X(8)    VALUE 'EM626'.
   184     12  XCTL-GL800          PIC X(8)    VALUE 'GL800'.
   185     12  LINK-EL001          PIC X(8)    VALUE 'EL001'.
   186     12  LINK-EL004          PIC X(8)    VALUE 'EL004'.
   187     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   188     12  THIS-PGM            PIC X(8)    VALUE 'EL106'.
   189     12  ELCNTL-ID           PIC X(8)    VALUE 'ELCNTL'.
   190     12  ELLETR-ID           PIC X(8)    VALUE 'ELLETR'.
   191     12  SUB                 PIC S9(4)   COMP.
   192     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   193     12  WS-FIRST-TIME-SW    PIC X       VALUE 'Y'.
   194         88  FIRST-TIME                  VALUE 'Y'.
   195     12  WS-DISPLAY-SW       PIC X       VALUE 'N'.
   196         88  RETURN-DISPLAY              VALUE 'Y'.
   197
   198 01  ACCESS-KEYS.
   199     12  ELCNTL-KEY.
   200         16  CK-COMP-ID      PIC X(3).
   201         16  FILLER          PIC X       VALUE '3'.
   202         16  CK-STATE-CD     PIC X(4)    VALUE SPACES.
   203         16  CK-SEQ          PIC S9(4)   VALUE +0    COMP.
   204     12  W-WORKING-TEXT-KEY.
   205         16  W-TEXT-COMPANY-CD
   206                             PIC X.
   207         16  W-TEXT-FORM-NO  PIC X(12).
   208         16  W-TEXT-LINE-SEQ PIC S9(4)   COMP.
   209
   210 01  ERROR-MESSAGES.
   211     12  ER-0000                 PIC X(4)  VALUE '0000'.
   212     12  ER-0004                 PIC X(4)  VALUE '0004'.
   213     12  ER-0013                 PIC X(4)  VALUE '0013'.
   214     12  ER-0023                 PIC X(4)  VALUE '0023'.
   215     12  ER-0029                 PIC X(4)  VALUE '0029'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   6
* EL106.cbl
   216     12  ER-0042                 PIC X(4)  VALUE '0042'.
   217     12  ER-0050                 PIC X(4)  VALUE '0050'.
   218     12  ER-0068                 PIC X(4)  VALUE '0068'.
   219     12  ER-0070                 PIC X(4)  VALUE '0070'.
   220     12  ER-0141                 PIC X(4)  VALUE '0141'.
   221     12  ER-0144                 PIC X(4)  VALUE '0144'.
   222     12  ER-0145                 PIC X(4)  VALUE '0145'.
   223     12  ER-0146                 PIC X(4)  VALUE '0146'.
   224     12  ER-0147                 PIC X(4)  VALUE '0147'.
   225     12  ER-0148                 PIC X(4)  VALUE '0148'.
   226     12  ER-0149                 PIC X(4)  VALUE '0149'.
   227     12  ER-0150                 PIC X(4)  VALUE '0150'.
   228     12  ER-0151                 PIC X(4)  VALUE '0151'.
   229     12  ER-0152                 PIC X(4)  VALUE '0152'.
   230     12  ER-0153                 PIC X(4)  VALUE '0153'.
   231     12  ER-0159                 PIC X(4)  VALUE '0159'.
   232     12  ER-0160                 PIC X(4)  VALUE '0160'.
   233     12  ER-0161                 PIC X(4)  VALUE '0161'.
   234     12  ER-0582                 PIC X(4)  VALUE '0582'.
   235     12  ER-0805                 PIC X(4)  VALUE '0805'.
   236     12  ER-1614                 PIC X(4)  VALUE '1614'.
   237     12  ER-2009                 PIC X(4)  VALUE '2009'.
   238     12  ER-2010                 PIC X(4)  VALUE '2010'.
   239     12  ER-2012                 PIC X(4)  VALUE '2012'.
   240     12  ER-2014                 PIC X(4)  VALUE '2014'.
   241     12  ER-2024                 PIC X(4)  VALUE '2024'.
   242     12  ER-2028                 PIC X(4)  VALUE '2028'.
   243     12  ER-2032                 PIC X(4)  VALUE '2032'.
   244     12  ER-2033                 PIC X(4)  VALUE '2033'.
   245     12  ER-2082                 PIC X(4)  VALUE '2082'.
   246     12  ER-2084                 PIC X(4)  VALUE '2084'.
   247     12  ER-2137                 PIC X(4)  VALUE '2137'.
   248     12  ER-2298                 PIC X(4)  VALUE '2298'.
   249     12  ER-2299                 PIC X(4)  VALUE '2299'.
   250     12  ER-3030                 PIC X(4)  VALUE '3030'.
   251     12  ER-3031                 PIC X(4)  VALUE '3031'.
   252     12  ER-3032                 PIC X(4)  VALUE '3032'.
   253     12  ER-3033                 PIC X(4)  VALUE '3033'.
   254     12  ER-3034                 PIC X(4)  VALUE '3034'.
   255     12  ER-3035                 PIC X(4)  VALUE '3035'.
   256     12  ER-3036                 PIC X(4)  VALUE '3036'.
   257     12  ER-3040                 PIC X(4)  VALUE '3040'.
   258     12  ER-7008                 PIC X(4)  VALUE '7008'.
   259     12  ER-7346                 PIC X(4)  VALUE '7346'.
   260     12  ER-7531                 PIC X(4)  VALUE '7531'.
   261     12  ER-7532                 PIC X(4)  VALUE '7532'.
   262     12  ER-7536                 PIC X(4)  VALUE '7536'.
   263     12  ER-7578                 PIC X(4)  VALUE '7578'.
   264     12  ER-7717                 PIC X(4)  VALUE '7717'.
   265     12  ER-7735                 PIC X(4)  VALUE '7735'.
   266     12  ER-8159                 PIC X(4)  VALUE '8159'.
   267     12  ER-9074                 PIC X(4)  VALUE '9074'.
   268     12  ER-9097                 PIC X(4)  VALUE '9097'.
   269     12  ER-9447                 PIC X(4)  VALUE '9447'.
   270     12  ER-9448                 PIC X(4)  VALUE '9448'.
   271     12  ER-9478                 PIC X(4)  VALUE '9478'.
   272     12  ER-9999                 PIC X(4)  VALUE '9999'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   7
* EL106.cbl
   274*    COPY ELCDATE.
   275******************************************************************
   276*                                                                *
   277*                                                                *
   278*                            ELCDATE.                            *
   279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   280*                            VMOD=2.003
   281*                                                                *
   282*                                                                *
   283*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   284*                 LENGTH = 200                                   *
   285******************************************************************
   286
   287 01  DATE-CONVERSION-DATA.
   288     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   289     12  DC-OPTION-CODE                PIC X.
   290         88  BIN-TO-GREG                VALUE ' '.
   291         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   292         88  EDIT-GREG-TO-BIN           VALUE '2'.
   293         88  YMD-GREG-TO-BIN            VALUE '3'.
   294         88  MDY-GREG-TO-BIN            VALUE '4'.
   295         88  JULIAN-TO-BIN              VALUE '5'.
   296         88  BIN-PLUS-ELAPSED           VALUE '6'.
   297         88  FIND-CENTURY               VALUE '7'.
   298         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   299         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   300         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   301         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   302         88  JULIAN-TO-BIN-3            VALUE 'C'.
   303         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   304         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   305         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   306         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   307         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   308         88  CHECK-LEAP-YEAR            VALUE 'H'.
   309         88  BIN-3-TO-GREG              VALUE 'I'.
   310         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   311         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   312         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   313         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   314         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   315         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   316         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   317         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   318         88  THREE-CHARACTER-BIN
   319                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   320         88  GREGORIAN-TO-BIN
   321                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   322         88  BIN-TO-GREGORIAN
   323                  VALUES ' ' '1' 'I' '8' 'G'.
   324         88  JULIAN-TO-BINARY
   325                  VALUES '5' 'C' 'E' 'F'.
   326     12  DC-ERROR-CODE                 PIC X.
   327         88  NO-CONVERSION-ERROR        VALUE ' '.
   328         88  DATE-CONVERSION-ERROR
   329                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   330         88  DATE-IS-ZERO               VALUE '1'.
   331         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   8
* EL106.cbl
   332         88  DATE-IS-INVALID            VALUE '3'.
   333         88  DATE1-GREATER-DATE2        VALUE '4'.
   334         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   335         88  DATE-INVALID-OPTION        VALUE '9'.
   336         88  INVALID-CENTURY            VALUE 'A'.
   337         88  ONLY-CENTURY               VALUE 'B'.
   338         88  ONLY-LEAP-YEAR             VALUE 'C'.
   339         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   340     12  DC-END-OF-MONTH               PIC X.
   341         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   342     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   343         88  USE-NORMAL-PROCESS         VALUE ' '.
   344         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   345         88  ADJUST-UP-100-YRS          VALUE '2'.
   346     12  FILLER                        PIC X.
   347     12  DC-CONVERSION-DATES.
   348         16  DC-BIN-DATE-1             PIC XX.
   349         16  DC-BIN-DATE-2             PIC XX.
   350         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   351         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   352                       DC-GREG-DATE-1-EDIT.
   353             20  DC-EDIT1-MONTH        PIC 99.
   354             20  SLASH1-1              PIC X.
   355             20  DC-EDIT1-DAY          PIC 99.
   356             20  SLASH1-2              PIC X.
   357             20  DC-EDIT1-YEAR         PIC 99.
   358         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   359         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   360                     DC-GREG-DATE-2-EDIT.
   361             20  DC-EDIT2-MONTH        PIC 99.
   362             20  SLASH2-1              PIC X.
   363             20  DC-EDIT2-DAY          PIC 99.
   364             20  SLASH2-2              PIC X.
   365             20  DC-EDIT2-YEAR         PIC 99.
   366         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   367         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   368                     DC-GREG-DATE-1-YMD.
   369             20  DC-YMD-YEAR           PIC 99.
   370             20  DC-YMD-MONTH          PIC 99.
   371             20  DC-YMD-DAY            PIC 99.
   372         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   373         16  DC-GREG-DATE-1-MDY-R REDEFINES
   374                      DC-GREG-DATE-1-MDY.
   375             20  DC-MDY-MONTH          PIC 99.
   376             20  DC-MDY-DAY            PIC 99.
   377             20  DC-MDY-YEAR           PIC 99.
   378         16  DC-GREG-DATE-1-ALPHA.
   379             20  DC-ALPHA-MONTH        PIC X(10).
   380             20  DC-ALPHA-DAY          PIC 99.
   381             20  FILLER                PIC XX.
   382             20  DC-ALPHA-CENTURY.
   383                 24 DC-ALPHA-CEN-N     PIC 99.
   384             20  DC-ALPHA-YEAR         PIC 99.
   385         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   386         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   387         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   388         16  DC-JULIAN-DATE            PIC 9(05).
   389         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   9
* EL106.cbl
   390                                       PIC 9(05).
   391         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   392             20  DC-JULIAN-YEAR        PIC 99.
   393             20  DC-JULIAN-DAYS        PIC 999.
   394         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   395         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   396         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   397     12  DATE-CONVERSION-VARIBLES.
   398         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   399         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   400             20  FILLER                PIC 9(3).
   401             20  HOLD-CEN-1-CCYY.
   402                 24  HOLD-CEN-1-CC     PIC 99.
   403                 24  HOLD-CEN-1-YY     PIC 99.
   404             20  HOLD-CEN-1-MO         PIC 99.
   405             20  HOLD-CEN-1-DA         PIC 99.
   406         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   407             20  HOLD-CEN-1-R-MO       PIC 99.
   408             20  HOLD-CEN-1-R-DA       PIC 99.
   409             20  HOLD-CEN-1-R-CCYY.
   410                 24  HOLD-CEN-1-R-CC   PIC 99.
   411                 24  HOLD-CEN-1-R-YY   PIC 99.
   412             20  FILLER                PIC 9(3).
   413         16  HOLD-CENTURY-1-X.
   414             20  FILLER                PIC X(3)  VALUE SPACES.
   415             20  HOLD-CEN-1-X-CCYY.
   416                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   417                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   418             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   419             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   420         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   421             20  HOLD-CEN-1-R-X-MO     PIC XX.
   422             20  HOLD-CEN-1-R-X-DA     PIC XX.
   423             20  HOLD-CEN-1-R-X-CCYY.
   424                 24  HOLD-CEN-1-R-X-CC PIC XX.
   425                 24  HOLD-CEN-1-R-X-YY PIC XX.
   426             20  FILLER                PIC XXX.
   427         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   428         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   429         16  DC-JULIAN-DATE-1          PIC 9(07).
   430         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   431             20  DC-JULIAN-1-CCYY.
   432                 24  DC-JULIAN-1-CC    PIC 99.
   433                 24  DC-JULIAN-1-YR    PIC 99.
   434             20  DC-JULIAN-DA-1        PIC 999.
   435         16  DC-JULIAN-DATE-2          PIC 9(07).
   436         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   437             20  DC-JULIAN-2-CCYY.
   438                 24  DC-JULIAN-2-CC    PIC 99.
   439                 24  DC-JULIAN-2-YR    PIC 99.
   440             20  DC-JULIAN-DA-2        PIC 999.
   441         16  DC-GREG-DATE-A-EDIT.
   442             20  DC-EDITA-MONTH        PIC 99.
   443             20  SLASHA-1              PIC X VALUE '/'.
   444             20  DC-EDITA-DAY          PIC 99.
   445             20  SLASHA-2              PIC X VALUE '/'.
   446             20  DC-EDITA-CCYY.
   447                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  10
* EL106.cbl
   448                 24  DC-EDITA-YEAR     PIC 99.
   449         16  DC-GREG-DATE-B-EDIT.
   450             20  DC-EDITB-MONTH        PIC 99.
   451             20  SLASHB-1              PIC X VALUE '/'.
   452             20  DC-EDITB-DAY          PIC 99.
   453             20  SLASHB-2              PIC X VALUE '/'.
   454             20  DC-EDITB-CCYY.
   455                 24  DC-EDITB-CENT     PIC 99.
   456                 24  DC-EDITB-YEAR     PIC 99.
   457         16  DC-GREG-DATE-CYMD         PIC 9(08).
   458         16  DC-GREG-DATE-CYMD-R REDEFINES
   459                              DC-GREG-DATE-CYMD.
   460             20  DC-CYMD-CEN           PIC 99.
   461             20  DC-CYMD-YEAR          PIC 99.
   462             20  DC-CYMD-MONTH         PIC 99.
   463             20  DC-CYMD-DAY           PIC 99.
   464         16  DC-GREG-DATE-MDCY         PIC 9(08).
   465         16  DC-GREG-DATE-MDCY-R REDEFINES
   466                              DC-GREG-DATE-MDCY.
   467             20  DC-MDCY-MONTH         PIC 99.
   468             20  DC-MDCY-DAY           PIC 99.
   469             20  DC-MDCY-CEN           PIC 99.
   470             20  DC-MDCY-YEAR          PIC 99.
   471    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   472        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   473    12  DC-EL310-DATE                  PIC X(21).
   474    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  11
* EL106.cbl
   476*    COPY ELCLOGOF.
   477******************************************************************
   478*                                                                *
   479*                                                                *
   480*                            ELCLOGOF.                           *
   481*                            VMOD=2.001                          *
   482*                                                                *
   483*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   484*                                                                *
   485******************************************************************
   486 01  CLASIC-LOGOFF.
   487     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   488     12  LOGOFF-TEXT.
   489         16  FILLER          PIC X(5)    VALUE SPACES.
   490         16  LOGOFF-MSG.
   491             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   492             20  FILLER      PIC X       VALUE SPACES.
   493             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   494         16  FILLER          PIC X(80)
   495           VALUE '* YOU ARE NOW LOGGED OFF'.
   496         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   497         16  FILLER          PIC X       VALUE QUOTE.
   498         16  LOGOFF-SYS-MSG  PIC X(17)
   499           VALUE 'S CLAS-IC SYSTEM '.
   500     12  TEXT-MESSAGES.
   501         16  UNACCESS-MSG    PIC X(29)
   502             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   503         16  PGMIDERR-MSG    PIC X(17)
   504             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  12
* EL106.cbl
   506*    COPY ELCATTR.
   507******************************************************************
   508*                                                                *
   509*                            ELCATTR.                            *
   510*                            VMOD=2.001                          *
   511*                                                                *
   512*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   513*                                                                *
   514*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   515*                                                                *
   516*                   POS 1   P=PROTECTED                          *
   517*                           U=UNPROTECTED                        *
   518*                           S=ASKIP                              *
   519*                   POS 2   A=ALPHA/NUMERIC                      *
   520*                           N=NUMERIC                            *
   521*                   POS 3   N=NORMAL                             *
   522*                           B=BRIGHT                             *
   523*                           D=DARK                               *
   524*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   525*                           OF=MODIFIED DATA TAG OFF             *
   526*                                                                *
   527*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   528******************************************************************
   529 01  ATTRIBUTE-LIST.
   530     12  AL-PABOF            PIC X       VALUE 'Y'.
   531     12  AL-PABON            PIC X       VALUE 'Z'.
   532     12  AL-PADOF            PIC X       VALUE '%'.
   533     12  AL-PADON            PIC X       VALUE '_'.
   534     12  AL-PANOF            PIC X       VALUE '-'.
   535     12  AL-PANON            PIC X       VALUE '/'.
   536     12  AL-SABOF            PIC X       VALUE '8'.
   537     12  AL-SABON            PIC X       VALUE '9'.
   538     12  AL-SADOF            PIC X       VALUE '@'.
   539     12  AL-SADON            PIC X       VALUE QUOTE.
   540     12  AL-SANOF            PIC X       VALUE '0'.
   541     12  AL-SANON            PIC X       VALUE '1'.
   542     12  AL-UABOF            PIC X       VALUE 'H'.
   543     12  AL-UABON            PIC X       VALUE 'I'.
   544     12  AL-UADOF            PIC X       VALUE '<'.
   545     12  AL-UADON            PIC X       VALUE '('.
   546     12  AL-UANOF            PIC X       VALUE ' '.
   547     12  AL-UANON            PIC X       VALUE 'A'.
   548     12  AL-UNBOF            PIC X       VALUE 'Q'.
   549     12  AL-UNBON            PIC X       VALUE 'R'.
   550     12  AL-UNDOF            PIC X       VALUE '*'.
   551     12  AL-UNDON            PIC X       VALUE ')'.
   552     12  AL-UNNOF            PIC X       VALUE '&'.
   553     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  13
* EL106.cbl
   555*    COPY ELCEMIB.
   556******************************************************************
   557*                                                                *
   558*                                                                *
   559*                            ELCEMIB.                            *
   560*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   561*                            VMOD=2.005                          *
   562*                                                                *
   563*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   564*                                                                *
   565******************************************************************
   566 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   567     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   568     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   569     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   570     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   571     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   572     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   573     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   574     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   575     12  EMI-SWITCH1             PIC X        VALUE '1'.
   576         88  EMI-NO-ERRORS                    VALUE '1'.
   577         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   578         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   579     12  EMI-SWITCH2             PIC X        VALUE '1'.
   580         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   581     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   582         88  EMI-AREA1-EMPTY                  VALUE '1'.
   583         88  EMI-AREA1-FULL                   VALUE '2'.
   584     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   585         88  EMI-AREA2-EMPTY                  VALUE '1'.
   586         88  EMI-AREA2-FULL                   VALUE '2'.
   587     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   588         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   589         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   590         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   591         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   592         88  EMI-BYPASS-FATALS                VALUE 'X'.
   593     12  EMI-ERROR-LINES.
   594         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   595         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   596         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   597         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   598             20  EMI-ERR-CODES OCCURS 10 TIMES.
   599                 24  EMI-ERR-NUM         PIC X(4).
   600                 24  EMI-FILLER          PIC X.
   601                 24  EMI-SEV             PIC X.
   602                 24  FILLER              PIC X.
   603             20  FILLER                  PIC X(02).
   604     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   605         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   606             20  EMI-ERROR-NUMBER    PIC X(4).
   607             20  EMI-FILL            PIC X.
   608             20  EMI-SEVERITY        PIC X.
   609             20  FILLER              PIC X.
   610             20  EMI-ERROR-TEXT.
   611                 24  EMI-TEXT-VARIABLE   PIC X(10).
   612                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  14
* EL106.cbl
   613     12  EMI-SEVERITY-SAVE           PIC X.
   614         88  EMI-NOTE                    VALUE 'N'.
   615         88  EMI-WARNING                 VALUE 'W'.
   616         88  EMI-FORCABLE                VALUE 'F'.
   617         88  EMI-FATAL                   VALUE 'X'.
   618     12  EMI-MESSAGE-FLAG            PIC X.
   619         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   620         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   621     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   622     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   623         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   624         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   625         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   626     12  FILLER                      PIC X(137)  VALUE SPACES.
   627     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   628     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   629     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   630     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  15
* EL106.cbl
   632*    COPY ELCJPFX.
   633******************************************************************
   634*                                                                *
   635*                                                                *
   636*                            ELCJPFX.                            *
   637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   638*                            VMOD=2.002                          *
   639*                                                                *
   640*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   641*                                                                *
   642*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   643*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   644*        ELCNTL - CONTROL FILE                                   *
   645*        ELMSTR - CLAIM MASTERS                                  *
   646*        ELTRLR - ACTIVITY TRAILERS                              *
   647*        ELCHKQ - CHECK QUE                                      *
   648******************************************************************
   649 01  JOURNAL-RECORD.
   650     12  JP-USER-ID                  PIC X(4).
   651     12  JP-FILE-ID                  PIC X(8).
   652     12  JP-PROGRAM-ID               PIC X(8).
   653     12  JP-RECORD-TYPE              PIC X.
   654         88 JP-ADD              VALUE 'A'.
   655         88 JP-BEFORE-CHANGE    VALUE 'B'.
   656         88 JP-AFTER-CHANGE     VALUE 'C'.
   657         88 JP-DELETE           VALUE 'D'.
   658         88 JP-GENERIC-DELETE   VALUE 'G'.
   659         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   660         88 JP-KEY-CHG-ADD      VALUE 'N'.
   661     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   662     12  JP-RECORD-AREA
   663
   664
   665             PIC X(530).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  16
* EL106.cbl
   667*    COPY ELCINTF.
   668******************************************************************
   669*                                                                *
   670*                                                                *
   671*                            ELCINTF.                            *
   672*                            VMOD=2.017                          *
   673*                                                                *
   674*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   675*                                                                *
   676*       LENGTH = 1024                                            *
   677*                                                                *
   678******************************************************************
   679*                   C H A N G E   L O G
   680*
   681* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   682*-----------------------------------------------------------------
   683*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   684* EFFECTIVE    NUMBER
   685*-----------------------------------------------------------------
   686* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   687******************************************************************
   688 01  PROGRAM-INTERFACE-BLOCK.
   689     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   690     12  PI-CALLING-PROGRAM              PIC X(8).
   691     12  PI-SAVED-PROGRAM-1              PIC X(8).
   692     12  PI-SAVED-PROGRAM-2              PIC X(8).
   693     12  PI-SAVED-PROGRAM-3              PIC X(8).
   694     12  PI-SAVED-PROGRAM-4              PIC X(8).
   695     12  PI-SAVED-PROGRAM-5              PIC X(8).
   696     12  PI-SAVED-PROGRAM-6              PIC X(8).
   697     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   698     12  PI-COMPANY-ID                   PIC XXX.
   699     12  PI-COMPANY-CD                   PIC X.
   700
   701     12  PI-COMPANY-PASSWORD             PIC X(8).
   702
   703     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   704
   705     12  PI-CONTROL-IN-PROGRESS.
   706         16  PI-CARRIER                  PIC X.
   707         16  PI-GROUPING                 PIC X(6).
   708         16  PI-STATE                    PIC XX.
   709         16  PI-ACCOUNT                  PIC X(10).
   710         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   711                                         PIC X(10).
   712         16  PI-CLAIM-CERT-GRP.
   713             20  PI-CLAIM-NO             PIC X(7).
   714             20  PI-CERT-NO.
   715                 25  PI-CERT-PRIME       PIC X(10).
   716                 25  PI-CERT-SFX         PIC X.
   717             20  PI-CERT-EFF-DT          PIC XX.
   718         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   719             20  PI-PLAN-CODE            PIC X(2).
   720             20  PI-REVISION-NUMBER      PIC X(3).
   721             20  PI-PLAN-EFF-DT          PIC X(2).
   722             20  PI-PLAN-EXP-DT          PIC X(2).
   723             20  FILLER                  PIC X(11).
   724         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  17
* EL106.cbl
   725             20  PI-OE-REFERENCE-1.
   726                 25  PI-OE-REF-1-PRIME   PIC X(18).
   727                 25  PI-OE-REF-1-SUFF    PIC XX.
   728
   729     12  PI-SESSION-IN-PROGRESS          PIC X.
   730         88  CLAIM-SESSION                   VALUE '1'.
   731         88  CREDIT-SESSION                  VALUE '2'.
   732         88  WARRANTY-SESSION                VALUE '3'.
   733         88  MORTGAGE-SESSION                VALUE '4'.
   734         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   735
   736
   737*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   738
   739     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   740     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   741
   742     12  PI-CREDIT-USER                  PIC X.
   743         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   744         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   745
   746     12  PI-CLAIM-USER                   PIC X.
   747         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   748         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   749
   750     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   751         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   752         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   753         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   754         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   755         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   756
   757     12  PI-PROCESSOR-ID                 PIC X(4).
   758
   759     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   760
   761     12  PI-MEMBER-CAPTION               PIC X(10).
   762
   763     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   764         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   765
   766     12  PI-LIFE-OVERRIDE-L1             PIC X.
   767     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   768     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   769     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   770
   771     12  PI-AH-OVERRIDE-L1               PIC X.
   772     12  PI-AH-OVERRIDE-L2               PIC XX.
   773     12  PI-AH-OVERRIDE-L6               PIC X(6).
   774     12  PI-AH-OVERRIDE-L12              PIC X(12).
   775
   776     12  PI-NEW-SYSTEM                   PIC X(2).
   777
   778     12  PI-PRIMARY-CERT-NO              PIC X(11).
   779     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   780         88  PI-USES-PAID-TO                 VALUE '1'.
   781     12  PI-CRDTCRD-SYSTEM.
   782         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  18
* EL106.cbl
   783             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   784             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   785         16  PI-CC-MONTH-END-DT          PIC XX.
   786     12  PI-PROCESSOR-PRINTER            PIC X(4).
   787
   788     12  PI-OE-REFERENCE-2.
   789         16  PI-OE-REF-2-PRIME           PIC X(10).
   790         16  PI-OE-REF-2-SUFF            PIC X.
   791
   792     12  PI-REM-TRM-CALC-OPTION          PIC X.
   793
   794     12  PI-LANGUAGE-TYPE                PIC X.
   795             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   796             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   797             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   798
   799     12  PI-POLICY-LINKAGE-IND           PIC X.
   800         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   801         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   802                                                   LOW-VALUES.
   803
   804     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   805     12  PI-CLAIM-PW-SESSION             PIC X(1).
   806         88  PI-CLAIM-CREDIT                 VALUE '1'.
   807         88  PI-CLAIM-CONVEN                 VALUE '2'.
   808
   809     12  PI-PROCESSOR-CSR-IND            PIC X.
   810         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   811         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   812
   813     12  FILLER                          PIC X(3).
   814
   815     12  PI-SYSTEM-LEVEL                 PIC X(145).
   816
   817     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   818         PI-SYSTEM-LEVEL.
   819
   820         16  PI-ENTRY-CODES.
   821             20  PI-ENTRY-CD-1           PIC X.
   822             20  PI-ENTRY-CD-2           PIC X.
   823
   824         16  PI-RETURN-CODES.
   825             20  PI-RETURN-CD-1          PIC X.
   826             20  PI-RETURN-CD-2          PIC X.
   827
   828         16  PI-UPDATE-STATUS-SAVE.
   829             20  PI-UPDATE-BY            PIC X(4).
   830             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   831
   832         16  PI-LOWER-CASE-LETTERS       PIC X.
   833             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   834
   835*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   836*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   837*            88  CARRIER-CLM-CNTL            VALUE '2'.
   838
   839         16  PI-CERT-ACCESS-CONTROL      PIC X.
   840             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  19
* EL106.cbl
   841             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   842             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   843             88  ACCNT-CNTL                  VALUE '3'.
   844             88  CARR-ACCNT-CNTL             VALUE '4'.
   845
   846         16  PI-PROCESSOR-CAP-LIST.
   847             20  PI-SYSTEM-CONTROLS.
   848                24 PI-SYSTEM-DISPLAY     PIC X.
   849                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   850                24 PI-SYSTEM-MODIFY      PIC X.
   851                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   852             20  FILLER                  PIC XX.
   853             20  PI-DISPLAY-CAP          PIC X.
   854                 88  DISPLAY-CAP             VALUE 'Y'.
   855             20  PI-MODIFY-CAP           PIC X.
   856                 88  MODIFY-CAP              VALUE 'Y'.
   857             20  PI-MSG-AT-LOGON-CAP     PIC X.
   858                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   859             20  PI-FORCE-CAP            PIC X.
   860                 88  FORCE-CAP               VALUE 'Y'.
   861
   862         16  PI-PROGRAM-CONTROLS.
   863             20  PI-PGM-PRINT-OPT        PIC X.
   864             20  PI-PGM-FORMAT-OPT       PIC X.
   865             20  PI-PGM-PROCESS-OPT      PIC X.
   866             20  PI-PGM-TOTALS-OPT       PIC X.
   867
   868         16  PI-HELP-INTERFACE.
   869             20  PI-LAST-ERROR-NO        PIC X(4).
   870             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   871
   872         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   873             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   874
   875         16  PI-CR-CONTROL-IN-PROGRESS.
   876             20  PI-CR-CARRIER           PIC X.
   877             20  PI-CR-GROUPING          PIC X(6).
   878             20  PI-CR-STATE             PIC XX.
   879             20  PI-CR-ACCOUNT           PIC X(10).
   880             20  PI-CR-FIN-RESP          PIC X(10).
   881             20  PI-CR-TYPE              PIC X.
   882
   883         16  PI-CR-BATCH-NUMBER          PIC X(6).
   884
   885         16  PI-CR-MONTH-END-DT          PIC XX.
   886
   887         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   888             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   889             88  PI-ZERO-CARRIER             VALUE '1'.
   890             88  PI-ZERO-GROUPING            VALUE '2'.
   891             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   892
   893         16  PI-CARRIER-SECURITY         PIC X.
   894             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   895
   896         16  PI-ACCOUNT-SECURITY         PIC X(10).
   897             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   898             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  20
* EL106.cbl
   899
   900         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   901             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   902                                         INDEXED BY PI-ACCESS-NDX
   903                                         PIC X.
   904
   905         16  PI-GA-BILLING-CONTROL       PIC X.
   906             88  PI-GA-BILLING               VALUE '1'.
   907
   908         16  PI-MAIL-PROCESSING          PIC X.
   909             88  PI-MAIL-YES                 VALUE 'Y'.
   910
   911         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   912
   913         16  PI-AR-SYSTEM.
   914             20  PI-AR-PROCESSING-CNTL   PIC X.
   915                 88  PI-AR-PROCESSING        VALUE 'Y'.
   916             20  PI-AR-SUMMARY-CODE      PIC X(6).
   917             20  PI-AR-MONTH-END-DT      PIC XX.
   918
   919         16  PI-MP-SYSTEM.
   920             20  PI-MORTGAGE-USER            PIC X.
   921                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   922                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   923             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   924                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   925                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   926                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   927                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   928                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   929             20  PI-MP-MONTH-END-DT          PIC XX.
   930             20  PI-MP-REFERENCE-NO.
   931                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   932                 24  PI-MP-REFERENCE-SFX     PIC XX.
   933
   934         16  PI-LABEL-CONTROL            PIC X(01).
   935             88  PI-CREATE-LABELS                    VALUE 'Y'.
   936             88  PI-BYPASS-LABELS                    VALUE 'N'.
   937
   938         16  PI-BILL-GROUPING-CODE       PIC X(01).
   939             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   940
   941         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   942             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   943             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   944
   945         16  FILLER                      PIC X(14).
   946
   947     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   948******************************************************************
   949     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   950         16  FILLER              PIC X(101).
   951         16  PI-WS-STATE         PIC XX.
   952         16  PI-WS-CLASS         PIC XX.
   953         16  PI-WS-DEV           PIC XXX.
   954         16  PI-WS-TYPE          PIC X.
   955         16  PI-WS-PLAN          PIC XX.
   956         16  PI-PREV-STATE       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  21
* EL106.cbl
   957         16  FILLER              PIC X(525).
   958
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  22
* EL106.cbl
   960*    COPY ELCAID.
   961******************************************************************
   962*                                                                *
   963*                            ELCAID.                             *
   964*                            VMOD=2.001                          *
   965*                                                                *
   966*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   967*                                                                *
   968*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   969*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   970******************************************************************
   971
   972 01  DFHAID.
   973   02  DFHNULL   PIC  X  VALUE  ' '.
   974   02  DFHENTER  PIC  X  VALUE  QUOTE.
   975   02  DFHCLEAR  PIC  X  VALUE  '_'.
   976   02  DFHPEN    PIC  X  VALUE  '='.
   977   02  DFHOPID   PIC  X  VALUE  'W'.
   978   02  DFHPA1    PIC  X  VALUE  '%'.
   979   02  DFHPA2    PIC  X  VALUE  '>'.
   980   02  DFHPA3    PIC  X  VALUE  ','.
   981   02  DFHPF1    PIC  X  VALUE  '1'.
   982   02  DFHPF2    PIC  X  VALUE  '2'.
   983   02  DFHPF3    PIC  X  VALUE  '3'.
   984   02  DFHPF4    PIC  X  VALUE  '4'.
   985   02  DFHPF5    PIC  X  VALUE  '5'.
   986   02  DFHPF6    PIC  X  VALUE  '6'.
   987   02  DFHPF7    PIC  X  VALUE  '7'.
   988   02  DFHPF8    PIC  X  VALUE  '8'.
   989   02  DFHPF9    PIC  X  VALUE  '9'.
   990   02  DFHPF10   PIC  X  VALUE  ':'.
   991   02  DFHPF11   PIC  X  VALUE  '#'.
   992   02  DFHPF12   PIC  X  VALUE  '@'.
   993   02  DFHPF13   PIC  X  VALUE  'A'.
   994   02  DFHPF14   PIC  X  VALUE  'B'.
   995   02  DFHPF15   PIC  X  VALUE  'C'.
   996   02  DFHPF16   PIC  X  VALUE  'D'.
   997   02  DFHPF17   PIC  X  VALUE  'E'.
   998   02  DFHPF18   PIC  X  VALUE  'F'.
   999   02  DFHPF19   PIC  X  VALUE  'G'.
  1000   02  DFHPF20   PIC  X  VALUE  'H'.
  1001   02  DFHPF21   PIC  X  VALUE  'I'.
  1002*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1003   02  DFHPF22   PIC  X  VALUE  '['.
  1004   02  DFHPF23   PIC  X  VALUE  '.'.
  1005   02  DFHPF24   PIC  X  VALUE  '<'.
  1006   02  DFHMSRE   PIC  X  VALUE  'X'.
  1007   02  DFHSTRF   PIC  X  VALUE  'h'.
  1008   02  DFHTRIG   PIC  X  VALUE  '"'.
  1009 01  FILLER REDEFINES DFHAID.
  1010     12  FILLER              PIC X(8).
  1011     12  PF-VALUES           PIC X       OCCURS 2.
  1012
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  23
* EL106.cbl
  1014*    COPY EL106S.
  1015 01  EL106AI.
  1016     05  FILLER            PIC  X(0012).
  1017*    -------------------------------
  1018     05  RUNDTEL PIC S9(0004) COMP.
  1019     05  RUNDTEF PIC  X(0001).
  1020     05  FILLER REDEFINES RUNDTEF.
  1021         10  RUNDTEA PIC  X(0001).
  1022     05  RUNDTEI PIC  X(0008).
  1023*    -------------------------------
  1024     05  RUNTIMEL PIC S9(0004) COMP.
  1025     05  RUNTIMEF PIC  X(0001).
  1026     05  FILLER REDEFINES RUNTIMEF.
  1027         10  RUNTIMEA PIC  X(0001).
  1028     05  RUNTIMEI PIC  X(0005).
  1029*    -------------------------------
  1030     05  MAINTL PIC S9(0004) COMP.
  1031     05  MAINTF PIC  X(0001).
  1032     05  FILLER REDEFINES MAINTF.
  1033         10  MAINTA PIC  X(0001).
  1034     05  MAINTI PIC  X(0001).
  1035*    -------------------------------
  1036     05  LSTUSRL PIC S9(0004) COMP.
  1037     05  LSTUSRF PIC  X(0001).
  1038     05  FILLER REDEFINES LSTUSRF.
  1039         10  LSTUSRA PIC  X(0001).
  1040     05  LSTUSRI PIC  X(0004).
  1041*    -------------------------------
  1042     05  LSTDTEL PIC S9(0004) COMP.
  1043     05  LSTDTEF PIC  X(0001).
  1044     05  FILLER REDEFINES LSTDTEF.
  1045         10  LSTDTEA PIC  X(0001).
  1046     05  LSTDTEI PIC  X(0008).
  1047*    -------------------------------
  1048     05  LSTTIMEL PIC S9(0004) COMP.
  1049     05  LSTTIMEF PIC  X(0001).
  1050     05  FILLER REDEFINES LSTTIMEF.
  1051         10  LSTTIMEA PIC  X(0001).
  1052     05  LSTTIMEI PIC  X(0005).
  1053*    -------------------------------
  1054     05  STCDL PIC S9(0004) COMP.
  1055     05  STCDF PIC  X(0001).
  1056     05  FILLER REDEFINES STCDF.
  1057         10  STCDA PIC  X(0001).
  1058     05  STCDI PIC  X(0002).
  1059*    -------------------------------
  1060     05  STABRL PIC S9(0004) COMP.
  1061     05  STABRF PIC  X(0001).
  1062     05  FILLER REDEFINES STABRF.
  1063         10  STABRA PIC  X(0001).
  1064     05  STABRI PIC  X(0002).
  1065*    -------------------------------
  1066     05  STNAMEL PIC S9(0004) COMP.
  1067     05  STNAMEF PIC  X(0001).
  1068     05  FILLER REDEFINES STNAMEF.
  1069         10  STNAMEA PIC  X(0001).
  1070     05  STNAMEI PIC  X(0025).
  1071*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  24
* EL106.cbl
  1072     05  LEXPLBLL PIC S9(0004) COMP.
  1073     05  LEXPLBLF PIC  X(0001).
  1074     05  FILLER REDEFINES LEXPLBLF.
  1075         10  LEXPLBLA PIC  X(0001).
  1076     05  LEXPLBLI PIC  X(0006).
  1077*    -------------------------------
  1078     05  LFEXPL PIC S9(0004) COMP.
  1079     05  LFEXPF PIC  X(0001).
  1080     05  FILLER REDEFINES LFEXPF.
  1081         10  LFEXPA PIC  X(0001).
  1082     05  LFEXPI PIC  S9(3)V9999.
  1083*    -------------------------------
  1084     05  AEXPLBLL PIC S9(0004) COMP.
  1085     05  AEXPLBLF PIC  X(0001).
  1086     05  FILLER REDEFINES AEXPLBLF.
  1087         10  AEXPLBLA PIC  X(0001).
  1088     05  AEXPLBLI PIC  X(0006).
  1089*    -------------------------------
  1090     05  AHEXPL PIC S9(0004) COMP.
  1091     05  AHEXPF PIC  X(0001).
  1092     05  FILLER REDEFINES AHEXPF.
  1093         10  AHEXPA PIC  X(0001).
  1094     05  AHEXPI PIC  S9(3)V9999.
  1095*    -------------------------------
  1096     05  REMTERML PIC S9(0004) COMP.
  1097     05  REMTERMF PIC  X(0001).
  1098     05  FILLER REDEFINES REMTERMF.
  1099         10  REMTERMA PIC  X(0001).
  1100     05  REMTERMI PIC  X(0001).
  1101*    -------------------------------
  1102     05  QUOTCALL PIC S9(0004) COMP.
  1103     05  QUOTCALF PIC  X(0001).
  1104     05  FILLER REDEFINES QUOTCALF.
  1105         10  QUOTCALA PIC  X(0001).
  1106     05  QUOTCALI PIC  S9(4)V99.
  1107*    -------------------------------
  1108     05  PREMTOLL PIC S9(0004) COMP.
  1109     05  PREMTOLF PIC  X(0001).
  1110     05  FILLER REDEFINES PREMTOLF.
  1111         10  PREMTOLA PIC  X(0001).
  1112     05  PREMTOLI PIC  S9(4)V99.
  1113*    -------------------------------
  1114     05  REFTOLL PIC S9(0004) COMP.
  1115     05  REFTOLF PIC  X(0001).
  1116     05  FILLER REDEFINES REFTOLF.
  1117         10  REFTOLA PIC  X(0001).
  1118     05  REFTOLI PIC  S9(4)V99.
  1119*    -------------------------------
  1120     05  PRMPCTL PIC S9(0004) COMP.
  1121     05  PRMPCTF PIC  X(0001).
  1122     05  FILLER REDEFINES PRMPCTF.
  1123         10  PRMPCTA PIC  X(0001).
  1124     05  PRMPCTI PIC  S9(1)V9(4).
  1125*    -------------------------------
  1126     05  REFPCTL PIC S9(0004) COMP.
  1127     05  REFPCTF PIC  X(0001).
  1128     05  FILLER REDEFINES REFPCTF.
  1129         10  REFPCTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  25
* EL106.cbl
  1130     05  REFPCTI PIC  S9(1)V9(4).
  1131*    -------------------------------
  1132     05  OVSAMTL PIC S9(0004) COMP.
  1133     05  OVSAMTF PIC  X(0001).
  1134     05  FILLER REDEFINES OVSAMTF.
  1135         10  OVSAMTA PIC  X(0001).
  1136     05  OVSAMTI PIC  S9(4)V99.
  1137*    -------------------------------
  1138     05  OVSPCTL PIC S9(0004) COMP.
  1139     05  OVSPCTF PIC  X(0001).
  1140     05  FILLER REDEFINES OVSPCTF.
  1141         10  OVSPCTA PIC  X(0001).
  1142     05  OVSPCTI PIC  S9(1)V9(4).
  1143*    -------------------------------
  1144     05  CLREJECL PIC S9(0004) COMP.
  1145     05  CLREJECF PIC  X(0001).
  1146     05  FILLER REDEFINES CLREJECF.
  1147         10  CLREJECA PIC  X(0001).
  1148     05  CLREJECI PIC  X(0001).
  1149*    -------------------------------
  1150     05  ISSREJL PIC S9(0004) COMP.
  1151     05  ISSREJF PIC  X(0001).
  1152     05  FILLER REDEFINES ISSREJF.
  1153         10  ISSREJA PIC  X(0001).
  1154     05  ISSREJI PIC  X(0001).
  1155*    -------------------------------
  1156     05  REFREJL PIC S9(0004) COMP.
  1157     05  REFREJF PIC  X(0001).
  1158     05  FILLER REDEFINES REFREJF.
  1159         10  REFREJA PIC  X(0001).
  1160     05  REFREJI PIC  X(0001).
  1161*    -------------------------------
  1162     05  REFMINL PIC S9(0004) COMP.
  1163     05  REFMINF PIC  X(0001).
  1164     05  FILLER REDEFINES REFMINF.
  1165         10  REFMINA PIC  X(0001).
  1166     05  REFMINI PIC  S9(4)V99.
  1167*    -------------------------------
  1168     05  REFDAY1L PIC S9(0004) COMP.
  1169     05  REFDAY1F PIC  X(0001).
  1170     05  FILLER REDEFINES REFDAY1F.
  1171         10  REFDAY1A PIC  X(0001).
  1172     05  REFDAY1I PIC  X(0002).
  1173*    -------------------------------
  1174     05  REFDAYSL PIC S9(0004) COMP.
  1175     05  REFDAYSF PIC  X(0001).
  1176     05  FILLER REDEFINES REFDAYSF.
  1177         10  REFDAYSA PIC  X(0001).
  1178     05  REFDAYSI PIC  X(0002).
  1179*    -------------------------------
  1180     05  SPLPMTL PIC S9(0004) COMP.
  1181     05  SPLPMTF PIC  X(0001).
  1182     05  FILLER REDEFINES SPLPMTF.
  1183         10  SPLPMTA PIC  X(0001).
  1184     05  SPLPMTI PIC  X(0001).
  1185*    -------------------------------
  1186     05  STUEL PIC S9(0004) COMP.
  1187     05  STUEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  26
* EL106.cbl
  1188     05  FILLER REDEFINES STUEF.
  1189         10  STUEA PIC  X(0001).
  1190     05  STUEI PIC  X(0001).
  1191*    -------------------------------
  1192     05  STCNTLL PIC S9(0004) COMP.
  1193     05  STCNTLF PIC  X(0001).
  1194     05  FILLER REDEFINES STCNTLF.
  1195         10  STCNTLA PIC  X(0001).
  1196     05  STCNTLI PIC  X(0001).
  1197*    -------------------------------
  1198     05  STDEVL PIC S9(0004) COMP.
  1199     05  STDEVF PIC  X(0001).
  1200     05  FILLER REDEFINES STDEVF.
  1201         10  STDEVA PIC  X(0001).
  1202     05  STDEVI PIC  X(0003).
  1203*    -------------------------------
  1204     05  EXTDAYSL PIC S9(0004) COMP.
  1205     05  EXTDAYSF PIC  X(0001).
  1206     05  FILLER REDEFINES EXTDAYSF.
  1207         10  EXTDAYSA PIC  X(0001).
  1208     05  EXTDAYSI PIC  X(0003).
  1209*    -------------------------------
  1210     05  EXTCHGL PIC S9(0004) COMP.
  1211     05  EXTCHGF PIC  X(0001).
  1212     05  FILLER REDEFINES EXTCHGF.
  1213         10  EXTCHGA PIC  X(0001).
  1214     05  EXTCHGI PIC  X(0001).
  1215*    -------------------------------
  1216     05  LFTAXL PIC S9(0004) COMP.
  1217     05  LFTAXF PIC  X(0001).
  1218     05  FILLER REDEFINES LFTAXF.
  1219         10  LFTAXA PIC  X(0001).
  1220     05  LFTAXI PIC  S9(1)V9(4).
  1221*    -------------------------------
  1222     05  REPLAWL PIC S9(0004) COMP.
  1223     05  REPLAWF PIC  X(0001).
  1224     05  FILLER REDEFINES REPLAWF.
  1225         10  REPLAWA PIC  X(0001).
  1226     05  REPLAWI PIC  X(0001).
  1227*    -------------------------------
  1228     05  REPLETRL PIC S9(0004) COMP.
  1229     05  REPLETRF PIC  X(0001).
  1230     05  FILLER REDEFINES REPLETRF.
  1231         10  REPLETRA PIC  X(0001).
  1232     05  REPLETRI PIC  X(0004).
  1233*    -------------------------------
  1234     05  AHITAXL PIC S9(0004) COMP.
  1235     05  AHITAXF PIC  X(0001).
  1236     05  FILLER REDEFINES AHITAXF.
  1237         10  AHITAXA PIC  X(0001).
  1238     05  AHITAXI PIC  S9(1)V9(4).
  1239*    -------------------------------
  1240     05  TARRATL PIC S9(0004) COMP.
  1241     05  TARRATF PIC  X(0001).
  1242     05  FILLER REDEFINES TARRATF.
  1243         10  TARRATA PIC  X(0001).
  1244     05  TARRATI PIC  S9(2)V9(4).
  1245*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  27
* EL106.cbl
  1246     05  CALCINTL PIC S9(0004) COMP.
  1247     05  CALCINTF PIC  X(0001).
  1248     05  FILLER REDEFINES CALCINTF.
  1249         10  CALCINTA PIC  X(0001).
  1250     05  CALCINTI PIC  S9(2)V9(4).
  1251*    -------------------------------
  1252     05  AHGTAXL PIC S9(0004) COMP.
  1253     05  AHGTAXF PIC  X(0001).
  1254     05  FILLER REDEFINES AHGTAXF.
  1255         10  AHGTAXA PIC  X(0001).
  1256     05  AHGTAXI PIC  S9(1)V9(4).
  1257*    -------------------------------
  1258     05  COMSLL PIC S9(0004) COMP.
  1259     05  COMSLF PIC  X(0001).
  1260     05  FILLER REDEFINES COMSLF.
  1261         10  COMSLA PIC  X(0001).
  1262     05  COMSLI PIC  S99V9(4).
  1263*    -------------------------------
  1264     05  LIMITL PIC S9(0004) COMP.
  1265     05  LIMITF PIC  X(0001).
  1266     05  FILLER REDEFINES LIMITF.
  1267         10  LIMITA PIC  X(0001).
  1268     05  LIMITI PIC  X(0001).
  1269*    -------------------------------
  1270     05  COMJLL PIC S9(0004) COMP.
  1271     05  COMJLF PIC  X(0001).
  1272     05  FILLER REDEFINES COMJLF.
  1273         10  COMJLA PIC  X(0001).
  1274     05  COMJLI PIC  S99V9(4).
  1275*    -------------------------------
  1276     05  LFREDL PIC S9(0004) COMP.
  1277     05  LFREDF PIC  X(0001).
  1278     05  FILLER REDEFINES LFREDF.
  1279         10  LFREDA PIC  X(0001).
  1280     05  LFREDI PIC  X(0001).
  1281*    -------------------------------
  1282     05  LFLEVL PIC S9(0004) COMP.
  1283     05  LFLEVF PIC  X(0001).
  1284     05  FILLER REDEFINES LFLEVF.
  1285         10  LFLEVA PIC  X(0001).
  1286     05  LFLEVI PIC  X(0001).
  1287*    -------------------------------
  1288     05  LFNETL PIC S9(0004) COMP.
  1289     05  LFNETF PIC  X(0001).
  1290     05  FILLER REDEFINES LFNETF.
  1291         10  LFNETA PIC  X(0001).
  1292     05  LFNETI PIC  X(0001).
  1293*    -------------------------------
  1294     05  COMSAL PIC S9(0004) COMP.
  1295     05  COMSAF PIC  X(0001).
  1296     05  FILLER REDEFINES COMSAF.
  1297         10  COMSAA PIC  X(0001).
  1298     05  COMSAI PIC  S99V9(4).
  1299*    -------------------------------
  1300     05  AHAHL PIC S9(0004) COMP.
  1301     05  AHAHF PIC  X(0001).
  1302     05  FILLER REDEFINES AHAHF.
  1303         10  AHAHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  28
* EL106.cbl
  1304     05  AHAHI PIC  X(0001).
  1305*    -------------------------------
  1306     05  AHCPL PIC S9(0004) COMP.
  1307     05  AHCPF PIC  X(0001).
  1308     05  FILLER REDEFINES AHCPF.
  1309         10  AHCPA PIC  X(0001).
  1310     05  AHCPI PIC  X(0001).
  1311*    -------------------------------
  1312     05  COMJAL PIC S9(0004) COMP.
  1313     05  COMJAF PIC  X(0001).
  1314     05  FILLER REDEFINES COMJAF.
  1315         10  COMJAA PIC  X(0001).
  1316     05  COMJAI PIC  S99V9(4).
  1317*    -------------------------------
  1318     05  STCHKHDL PIC S9(0004) COMP.
  1319     05  STCHKHDF PIC  X(0001).
  1320     05  FILLER REDEFINES STCHKHDF.
  1321         10  STCHKHDA PIC  X(0001).
  1322     05  STCHKHDI PIC  X(0013).
  1323*    -------------------------------
  1324     05  STCHKNOL PIC S9(0004) COMP.
  1325     05  STCHKNOF PIC  X(0001).
  1326     05  FILLER REDEFINES STCHKNOF.
  1327         10  STCHKNOA PIC  X(0001).
  1328     05  STCHKNOI PIC  9(8).
  1329*    -------------------------------
  1330     05  RESTAXL PIC S9(0004) COMP.
  1331     05  RESTAXF PIC  X(0001).
  1332     05  FILLER REDEFINES RESTAXF.
  1333         10  RESTAXA PIC  X(0001).
  1334     05  RESTAXI PIC  S99V9(4).
  1335*    -------------------------------
  1336     05  FREELKL PIC S9(0004) COMP.
  1337     05  FREELKF PIC  X(0001).
  1338     05  FILLER REDEFINES FREELKF.
  1339         10  FREELKA PIC  X(0001).
  1340     05  FREELKI PIC  X(0003).
  1341*    -------------------------------
  1342     05  CAUSALL PIC S9(0004) COMP.
  1343     05  CAUSALF PIC  X(0001).
  1344     05  FILLER REDEFINES CAUSALF.
  1345         10  CAUSALA PIC  X(0001).
  1346     05  CAUSALI PIC  X(0001).
  1347*    -------------------------------
  1348     05  REFCLML PIC S9(0004) COMP.
  1349     05  REFCLMF PIC  X(0001).
  1350     05  FILLER REDEFINES REFCLMF.
  1351         10  REFCLMA PIC  X(0001).
  1352     05  REFCLMI PIC  X(0001).
  1353*    -------------------------------
  1354     05  VFYBENEL PIC S9(0004) COMP.
  1355     05  VFYBENEF PIC  X(0001).
  1356     05  FILLER REDEFINES VFYBENEF.
  1357         10  VFYBENEA PIC  X(0001).
  1358     05  VFYBENEI PIC  X(0001).
  1359*    -------------------------------
  1360     05  ERRMSG1L PIC S9(0004) COMP.
  1361     05  ERRMSG1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  29
* EL106.cbl
  1362     05  FILLER REDEFINES ERRMSG1F.
  1363         10  ERRMSG1A PIC  X(0001).
  1364     05  ERRMSG1I PIC  X(0076).
  1365*    -------------------------------
  1366     05  ERRMSG2L PIC S9(0004) COMP.
  1367     05  ERRMSG2F PIC  X(0001).
  1368     05  FILLER REDEFINES ERRMSG2F.
  1369         10  ERRMSG2A PIC  X(0001).
  1370     05  ERRMSG2I PIC  X(0076).
  1371*    -------------------------------
  1372     05  ENTERPFL PIC S9(0004) COMP.
  1373     05  ENTERPFF PIC  X(0001).
  1374     05  FILLER REDEFINES ENTERPFF.
  1375         10  ENTERPFA PIC  X(0001).
  1376     05  ENTERPFI PIC  9(2).
  1377 01  EL106AO REDEFINES EL106AI.
  1378     05  FILLER            PIC  X(0012).
  1379*    -------------------------------
  1380     05  FILLER            PIC  X(0003).
  1381     05  RUNDTEO PIC  X(0008).
  1382*    -------------------------------
  1383     05  FILLER            PIC  X(0003).
  1384     05  RUNTIMEO PIC  99.99.
  1385*    -------------------------------
  1386     05  FILLER            PIC  X(0003).
  1387     05  MAINTO PIC  X(0001).
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(0003).
  1390     05  LSTUSRO PIC  X(0004).
  1391*    -------------------------------
  1392     05  FILLER            PIC  X(0003).
  1393     05  LSTDTEO PIC  X(0008).
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(0003).
  1396     05  LSTTIMEO PIC  99.99.
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(0003).
  1399     05  STCDO PIC  X(0002).
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(0003).
  1402     05  STABRO PIC  X(0002).
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  STNAMEO PIC  X(0025).
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  LEXPLBLO PIC  X(0006).
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  LFEXPO PIC  99.9999.
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(0003).
  1414     05  AEXPLBLO PIC  X(0006).
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  AHEXPO PIC  99.9999.
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  30
* EL106.cbl
  1420     05  REMTERMO PIC  X(0001).
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  QUOTCALO PIC  ZZ9.99.
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(0003).
  1426     05  PREMTOLO PIC  ZZ9.99.
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
  1429     05  REFTOLO PIC  ZZ9.99.
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  PRMPCTO PIC  .9999.
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  REFPCTO PIC  .9999.
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  OVSAMTO PIC  ZZ9.99.
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  OVSPCTO PIC  .9999.
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  CLREJECO PIC  X(0001).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  ISSREJO PIC  X(0001).
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  REFREJO PIC  X(0001).
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  REFMINO PIC  ZZ9.99.
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  REFDAY1O PIC  99.
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  REFDAYSO PIC  99.
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  SPLPMTO PIC  X(0001).
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  STUEO PIC  X(0001).
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  STCNTLO PIC  X(0001).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  STDEVO PIC  X(0003).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  EXTDAYSO PIC  999.
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  EXTCHGO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  31
* EL106.cbl
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  LFTAXO PIC  .9999.
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  REPLAWO PIC  X(0001).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  REPLETRO PIC  X(0004).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  AHITAXO PIC  .9999.
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  TARRATO PIC  9.9999.
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  CALCINTO PIC  9.9999.
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  AHGTAXO PIC  .9999.
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  COMSLO PIC  9.9999.
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  LIMITO PIC  X(0001).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  COMJLO PIC  9.9999.
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  LFREDO PIC  X(0001).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  LFLEVO PIC  X(0001).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  LFNETO PIC  X(0001).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  COMSAO PIC  9.9999.
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  AHAHO PIC  X(0001).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  AHCPO PIC  X(0001).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  COMJAO PIC  9.9999.
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  STCHKHDO PIC  X(0013).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  STCHKNOO PIC  9(8).
  1535*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  32
* EL106.cbl
  1536     05  FILLER            PIC  X(0003).
  1537     05  RESTAXO PIC  9.9999.
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  FREELKO PIC  999.
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  CAUSALO PIC  X(0001).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  REFCLMO PIC  X(0001).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  VFYBENEO PIC  X(0001).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  ERRMSG1O PIC  X(0076).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  ERRMSG2O PIC  X(0076).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  ENTERPFO PIC  X(0002).
  1559*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  33
* EL106.cbl
  1561****************************************************************
  1562*
  1563* Copyright (c) 2007 by Clerity Solutions, Inc.
  1564* All rights reserved.
  1565*
  1566****************************************************************
  1567 01  DFHEIV.
  1568   02  DFHEIV0               PIC X(35).
  1569   02  DFHEIV1               PIC X(08).
  1570   02  DFHEIV2               PIC X(08).
  1571   02  DFHEIV3               PIC X(08).
  1572   02  DFHEIV4               PIC X(06).
  1573   02  DFHEIV5               PIC X(04).
  1574   02  DFHEIV6               PIC X(04).
  1575   02  DFHEIV7               PIC X(02).
  1576   02  DFHEIV8               PIC X(02).
  1577   02  DFHEIV9               PIC X(01).
  1578   02  DFHEIV10              PIC S9(7) COMP-3.
  1579   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1580   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1581   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1582   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1583   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1584   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1585   02  DFHEIV17              PIC X(04).
  1586   02  DFHEIV18              PIC X(04).
  1587   02  DFHEIV19              PIC X(04).
  1588   02  DFHEIV20              USAGE IS POINTER.
  1589   02  DFHEIV21              USAGE IS POINTER.
  1590   02  DFHEIV22              USAGE IS POINTER.
  1591   02  DFHEIV23              USAGE IS POINTER.
  1592   02  DFHEIV24              USAGE IS POINTER.
  1593   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1594   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1595   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1596   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1597   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1598   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1599   02  FILLER                PIC X(02).
  1600   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1601   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1602   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1603   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1604   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1605 LINKAGE  SECTION.
  1606*****************************************************************
  1607*                                                               *
  1608* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1609* All rights reserved.                                          *
  1610*                                                               *
  1611*****************************************************************
  1612 01  dfheiblk.
  1613     02  eibtime          pic s9(7) comp-3.
  1614     02  eibdate          pic s9(7) comp-3.
  1615     02  eibtrnid         pic x(4).
  1616     02  eibtaskn         pic s9(7) comp-3.
  1617     02  eibtrmid         pic x(4).
  1618     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  34
* EL106.cbl
  1619     02  eibcposn         pic s9(4) comp.
  1620     02  eibcalen         pic s9(4) comp.
  1621     02  eibaid           pic x(1).
  1622     02  eibfiller1       pic x(1).
  1623     02  eibfn            pic x(2).
  1624     02  eibfiller2       pic x(2).
  1625     02  eibrcode         pic x(6).
  1626     02  eibfiller3       pic x(2).
  1627     02  eibds            pic x(8).
  1628     02  eibreqid         pic x(8).
  1629     02  eibrsrce         pic x(8).
  1630     02  eibsync          pic x(1).
  1631     02  eibfree          pic x(1).
  1632     02  eibrecv          pic x(1).
  1633     02  eibsend          pic x(1).
  1634     02  eibatt           pic x(1).
  1635     02  eibeoc           pic x(1).
  1636     02  eibfmh           pic x(1).
  1637     02  eibcompl         pic x(1).
  1638     02  eibsig           pic x(1).
  1639     02  eibconf          pic x(1).
  1640     02  eiberr           pic x(1).
  1641     02  eibrldbk         pic x(1).
  1642     02  eiberrcd         pic x(4).
  1643     02  eibsynrb         pic x(1).
  1644     02  eibnodat         pic x(1).
  1645     02  eibfiller5       pic x(2).
  1646     02  eibresp          pic 9(09) comp.
  1647     02  eibresp2         pic 9(09) comp.
  1648     02  dfheigdj         pic s9(4) comp.
  1649     02  dfheigdk         pic s9(4) comp.
  1650 01  DFHCOMMAREA             PIC X(1500).
  1651*01 PARMLIST .
  1652*    02  FILLER              PIC S9(8)   COMP.
  1653*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  1654*    02  ELLETR-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  35
* EL106.cbl
  1656*    COPY ELCCNTL.
  1657******************************************************************
  1658*                                                                *
  1659*                                                                *
  1660*                            ELCCNTL.                            *
  1661*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1662*                            VMOD=2.059                          *
  1663*                                                                *
  1664*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1665*                                                                *
  1666*   FILE TYPE = VSAM,KSDS                                        *
  1667*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1668*                                                                *
  1669*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1670*       ALTERNATE INDEX = NONE                                   *
  1671*                                                                *
  1672*   LOG = YES                                                    *
  1673*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1674******************************************************************
  1675*                   C H A N G E   L O G
  1676*
  1677* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1678*-----------------------------------------------------------------
  1679*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1680* EFFECTIVE    NUMBER
  1681*-----------------------------------------------------------------
  1682* 082503                   PEMA  ADD BENEFIT GROUP
  1683* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1684* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1685* 092705    2005050300006  PEMA  ADD SPP LEASES
  1686* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1687* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1688* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1689* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1690* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1691* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1692* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1693******************************************************************
  1694*
  1695 01  CONTROL-FILE.
  1696     12  CF-RECORD-ID                       PIC XX.
  1697         88  VALID-CF-ID                        VALUE 'CF'.
  1698
  1699     12  CF-CONTROL-PRIMARY.
  1700         16  CF-COMPANY-ID                  PIC XXX.
  1701         16  CF-RECORD-TYPE                 PIC X.
  1702             88  CF-COMPANY-MASTER              VALUE '1'.
  1703             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1704             88  CF-STATE-MASTER                VALUE '3'.
  1705             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1706             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1707             88  CF-CARRIER-MASTER              VALUE '6'.
  1708             88  CF-MORTALITY-MASTER            VALUE '7'.
  1709             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1710             88  CF-TERMINAL-MASTER             VALUE '9'.
  1711             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1712             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1713             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  36
* EL106.cbl
  1714             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1715             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1716             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1717             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1718             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1719             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1720         16  CF-ACCESS-CD-GENL              PIC X(4).
  1721         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1722             20  CF-PROCESSOR               PIC X(4).
  1723         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1724             20  CF-STATE-CODE              PIC XX.
  1725             20  FILLER                     PIC XX.
  1726         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1727             20  FILLER                     PIC XX.
  1728             20  CF-HI-BEN-IN-REC           PIC XX.
  1729         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1730             20  FILLER                     PIC XXX.
  1731             20  CF-CARRIER-CNTL            PIC X.
  1732         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1733             20  FILLER                     PIC XX.
  1734             20  CF-HI-TYPE-IN-REC          PIC 99.
  1735         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1736             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1737                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1738             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1739             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1740         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1741             20  FILLER                     PIC X.
  1742             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1743         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1744             20  FILLER                     PIC XX.
  1745             20  CF-MORTGAGE-PLAN           PIC XX.
  1746         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1747
  1748     12  CF-LAST-MAINT-DT                   PIC XX.
  1749     12  CF-LAST-MAINT-BY                   PIC X(4).
  1750     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1751
  1752     12  CF-RECORD-BODY                     PIC X(728).
  1753
  1754
  1755****************************************************************
  1756*             COMPANY MASTER RECORD                            *
  1757****************************************************************
  1758
  1759     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1760         16  CF-COMPANY-ADDRESS.
  1761             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1762             20  CF-CL-IN-CARE-OF           PIC X(30).
  1763             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1764             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1765             20  CF-CL-CITY-STATE           PIC X(30).
  1766             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1767             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1768         16  CF-COMPANY-CD                  PIC X.
  1769         16  CF-COMPANY-PASSWORD            PIC X(8).
  1770         16  CF-SECURITY-OPTION             PIC X.
  1771             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  37
* EL106.cbl
  1772             88  COMPANY-VERIFY                 VALUE '2'.
  1773             88  PROCESSOR-VERIFY               VALUE '3'.
  1774             88  NO-SECURITY                    VALUE '4'.
  1775             88  ALL-BUT-TERM                   VALUE '5'.
  1776         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1777             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1778         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1779             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1780         16  CF-INFORCE-LOCATION            PIC X.
  1781             88  CERTS-ARE-ONLINE               VALUE '1'.
  1782             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1783             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1784         16  CF-LOWER-CASE-LETTERS          PIC X.
  1785         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1786             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1787             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1788             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1789             88  CF-ACCNT-CNTL                  VALUE '3'.
  1790             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1791
  1792         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1793         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1794
  1795         16  CF-LGX-CREDIT-USER             PIC X.
  1796             88  CO-IS-NOT-USER                 VALUE 'N'.
  1797             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1798
  1799         16 CF-CREDIT-CALC-CODES.
  1800             20  CF-CR-REM-TERM-CALC PIC X.
  1801               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1802               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1803               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1804               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1805               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1806               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1807               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1808             20  CF-CR-R78-METHOD           PIC X.
  1809               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1810               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1811
  1812         16  CF-CLAIM-CONTROL-COUNTS.
  1813             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1814                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1815
  1816             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1817                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1818
  1819             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1820                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1821
  1822             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1823                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1824
  1825         16  CF-CURRENT-MONTH-END           PIC XX.
  1826
  1827         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1828             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1829             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  38
* EL106.cbl
  1830             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1831             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1832                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1833                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1834             20  CF-CO-PREM-REJECT-SW       PIC X.
  1835                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1836                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1837             20  CF-CO-REF-REJECT-SW        PIC X.
  1838                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1839                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1840
  1841         16  CF-CO-REPORTING-DT             PIC XX.
  1842         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1843         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1844           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1845           88  CF-CO-MONTH-END                  VALUE '1'.
  1846
  1847         16  CF-LGX-CLAIM-USER              PIC X.
  1848             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1849             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1850
  1851         16  CF-CREDIT-EDIT-CONTROLS.
  1852             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1853             20  CF-MIN-AGE                 PIC 99.
  1854             20  CF-DEFAULT-AGE             PIC 99.
  1855             20  CF-MIN-TERM                PIC S999      COMP-3.
  1856             20  CF-MAX-TERM                PIC S999      COMP-3.
  1857             20  CF-DEFAULT-SEX             PIC X.
  1858             20  CF-JOINT-AGE-INPUT         PIC X.
  1859                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1860             20  CF-BIRTH-DATE-INPUT        PIC X.
  1861                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1862             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1863                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1864                 88  CF-ZERO-CARRIER            VALUE '1'.
  1865                 88  CF-ZERO-GROUPING           VALUE '2'.
  1866                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1867             20  CF-EDIT-SW                 PIC X.
  1868                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1869             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1870             20  CF-CR-PR-METHOD            PIC X.
  1871               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1872               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1873             20  FILLER                     PIC X.
  1874
  1875         16  CF-CREDIT-MISC-CONTROLS.
  1876             20  CF-REIN-TABLE-SW           PIC X.
  1877                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1878             20  CF-COMP-TABLE-SW           PIC X.
  1879                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1880             20  CF-EXPERIENCE-RETENTION-AGE
  1881                                            PIC S9        COMP-3.
  1882             20  CF-CONVERSION-DT           PIC XX.
  1883             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1884             20  CF-RUN-FREQUENCY-SW        PIC X.
  1885                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1886                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1887
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  39
* EL106.cbl
  1888             20  CF-CR-CHECK-NO-CONTROL.
  1889                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1890                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1891                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1892                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1893                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1894                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1895
  1896                 24  CF-CR-CHECK-COUNT       REDEFINES
  1897                     CF-CR-CHECK-COUNTER      PIC X(4).
  1898
  1899                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1900                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1901
  1902                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1903                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1904                 24  CF-MAIL-PROCESSING       PIC X.
  1905                     88  MAIL-PROCESSING          VALUE 'Y'.
  1906
  1907         16  CF-MISC-SYSTEM-CONTROL.
  1908             20  CF-SYSTEM-C                 PIC X.
  1909                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1910             20  CF-SYSTEM-D                 PIC X.
  1911                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1912             20  CF-SOC-SEC-NO-SW            PIC X.
  1913                 88  SOC-SEC-NO-USED             VALUE '1'.
  1914             20  CF-MEMBER-NO-SW             PIC X.
  1915                 88  MEMBER-NO-USED              VALUE '1'.
  1916             20  CF-TAX-ID-NUMBER            PIC X(11).
  1917             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1918             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1919                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1920                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1921                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1922                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1923             20  CF-SYSTEM-E                 PIC X.
  1924                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1925
  1926         16  CF-LGX-LIFE-USER               PIC X.
  1927             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1928             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1929
  1930         16  CF-CR-MONTH-END-DT             PIC XX.
  1931
  1932         16  CF-FILE-MAINT-DATES.
  1933             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1934                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1935             20  CF-LAST-BATCH       REDEFINES
  1936                 CF-LAST-BATCH-NO               PIC X(4).
  1937             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1938             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1939             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1940             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1941             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1942             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1943             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1944             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1945             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  40
* EL106.cbl
  1946             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1947
  1948         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1949         16  FILLER                         PIC X.
  1950
  1951         16  CF-ALT-MORT-CODE               PIC X(4).
  1952         16  CF-MEMBER-CAPTION              PIC X(10).
  1953
  1954         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1955             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1956             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1957             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1958             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1959             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1960
  1961         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1962
  1963         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1964         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1965         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1966         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1967
  1968         16  CF-AH-OVERRIDE-L1              PIC X.
  1969         16  CF-AH-OVERRIDE-L2              PIC XX.
  1970         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1971         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1972
  1973         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1974         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1975
  1976         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1977         16  CF-AR-LAST-EL860-DT            PIC XX.
  1978         16  CF-MP-MONTH-END-DT             PIC XX.
  1979
  1980         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1981         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1982             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1983
  1984         16  CF-AR-MONTH-END-DT             PIC XX.
  1985
  1986         16  CF-CRDTCRD-USER                PIC X.
  1987             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1988             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1989
  1990         16  CF-CC-MONTH-END-DT             PIC XX.
  1991
  1992         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1993
  1994         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1995             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1996             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1997             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1998         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1999         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2000         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2001         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2002             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2003             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  41
* EL106.cbl
  2004         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2005         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2006         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2007             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2008         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2009
  2010         16  CF-CL-ZIP-CODE.
  2011             20  CF-CL-ZIP-PRIME.
  2012                 24  CF-CL-ZIP-1ST          PIC X.
  2013                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2014                 24  FILLER                 PIC X(4).
  2015             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2016         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2017             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2018             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2019             20  FILLER                     PIC XXX.
  2020
  2021         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2022         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2023         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2024         16  CF-CO-OPTION-START-DATE        PIC XX.
  2025         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2026           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2027                                                      '3' '4'.
  2028           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2029           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2030           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2031           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2032           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2033           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2034
  2035         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2036
  2037         16  CF-PAYMENT-APPROVAL-LEVELS.
  2038             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2039             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2040             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2041             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2042             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2043             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2044
  2045         16  CF-END-USER-REPORTING-USER     PIC X.
  2046             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2047             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2048
  2049         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2050             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2051             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2052
  2053         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2054
  2055         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2056         16  FILLER                         PIC X.
  2057
  2058         16  CF-CREDIT-ARCHIVE-CNTL.
  2059             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2060             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2061             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  42
* EL106.cbl
  2062
  2063         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2064
  2065         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2066             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2067             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2068
  2069         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2070             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2071             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2072
  2073         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2074
  2075         16  CF-CO-ACH-ID-CODE              PIC  X.
  2076             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2077             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2078             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2079         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2080         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2081         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2082         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2083         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2084         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2085         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2086         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2087         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2088                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2089         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2090                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2091
  2092         16  CF-CO-OVER-SHORT.
  2093             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2094             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2095
  2096*         16  FILLER                         PIC X(102).
  2097         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2098             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2099             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2100
  2101         16  CF-AH-APPROVAL-DAYS.
  2102             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2103             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2104             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2105             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2106
  2107         16  FILLER                         PIC X(82).
  2108****************************************************************
  2109*             PROCESSOR/USER RECORD                            *
  2110****************************************************************
  2111
  2112     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2113         16  CF-PROCESSOR-NAME              PIC X(30).
  2114         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2115         16  CF-PROCESSOR-TITLE             PIC X(26).
  2116         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2117                 88  MESSAGE-YES                VALUE 'Y'.
  2118                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2119
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  43
* EL106.cbl
  2120*****************************************************
  2121****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2122****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2123****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2124****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2125*****************************************************
  2126
  2127         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2128             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2129             20  CF-APPLICATION-FORCE       PIC X.
  2130             20  CF-INDIVIDUAL-APP.
  2131                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2132                     28  CF-BROWSE-APP      PIC X.
  2133                     28  CF-UPDATE-APP      PIC X.
  2134
  2135         16  CF-CURRENT-TERM-ON             PIC X(4).
  2136         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2137             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2138             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2139             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2140             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2141             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2142             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2143             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2144         16  CF-PROCESSOR-CARRIER           PIC X.
  2145             88  NO-CARRIER-SECURITY            VALUE ' '.
  2146         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2147             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2148         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2149             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2150         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2151             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2152
  2153         16  CF-PROC-SYS-ACCESS-SW.
  2154             20  CF-PROC-CREDIT-CLAIMS-SW.
  2155                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2156                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2157                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2158                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2159             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2160                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2161                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2162             20  CF-PROC-LIFE-GNRLDGR-SW.
  2163                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2164                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2165                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2166                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2167             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2168                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2169                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2170         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2171             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2172             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2173         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2174
  2175         16  CF-APPROVAL-LEVEL                  PIC X.
  2176             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2177             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  44
* EL106.cbl
  2178             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2179             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2180
  2181         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2182
  2183         16  CF-LANGUAGE-TYPE                   PIC X.
  2184             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2185             88  CF-LANG-IS-FR                      VALUE 'F'.
  2186
  2187         16  CF-CSR-IND                         PIC X.
  2188         16  FILLER                             PIC X(239).
  2189
  2190****************************************************************
  2191*             PROCESSOR/REMINDERS RECORD                       *
  2192****************************************************************
  2193
  2194     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2195         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2196             20  CF-START-REMIND-DT         PIC XX.
  2197             20  CF-END-REMIND-DT           PIC XX.
  2198             20  CF-REMINDER-TEXT           PIC X(50).
  2199         16  FILLER                         PIC X(296).
  2200
  2201
  2202****************************************************************
  2203*             STATE MASTER RECORD                              *
  2204****************************************************************
  2205
  2206     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2207         16  CF-STATE-ABBREVIATION          PIC XX.
  2208         16  CF-STATE-NAME                  PIC X(25).
  2209         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2210         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2211             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2212             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2213             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2214             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2215                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2216                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2217             20  CF-ST-PREM-REJECT-SW       PIC X.
  2218                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2219                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2220             20  CF-ST-REF-REJECT-SW        PIC X.
  2221                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2222                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2223         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2224         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2225         16  CF-ST-REFUND-RULES.
  2226             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2227             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2228             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2229         16  CF-ST-FST-PMT-EXTENSION.
  2230             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2231             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2232                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2233                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2234                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2235                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  45
* EL106.cbl
  2236         16  CF-ST-STATE-CALL.
  2237             20  CF-ST-CALL-UNEARNED        PIC X.
  2238             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2239             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2240         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2241             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2242             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2243         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2244         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2245         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2246         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2247         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2248         16  FILLER                         PIC X.
  2249         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2250             20  CF-ST-BENEFIT-CD           PIC XX.
  2251             20  CF-ST-BENEFIT-KIND         PIC X.
  2252                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2253                 88  CF-ST-AH-KIND              VALUE 'A'.
  2254             20  CF-ST-REM-TERM-CALC        PIC X.
  2255                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2256                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2257                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2258                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2259                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2260                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2261                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2262                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2263
  2264             20  CF-ST-REFUND-CALC          PIC X.
  2265                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2266                 88  ST-REFD-BY-R78             VALUE '1'.
  2267                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2268                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2269                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2270                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2271                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2272                 88  ST-REFD-UTAH               VALUE '7'.
  2273                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2274                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2275                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2276
  2277             20  CF-ST-EARNING-CALC         PIC X.
  2278                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2279                 88  ST-EARN-BY-R78             VALUE '1'.
  2280                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2281                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2282                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2283                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2284                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2285                 88  ST-EARN-MEAN               VALUE '8'.
  2286                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2287
  2288             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2289                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2290                 88  ST-OVRD-BY-R78             VALUE '1'.
  2291                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2292                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2293                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  46
* EL106.cbl
  2294                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2295                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2296                 88  ST-OVRD-MEAN               VALUE '8'.
  2297                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2298             20  FILLER                     PIC X.
  2299
  2300         16  CF-ST-COMMISSION-CAPS.
  2301             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2302             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2303             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2304             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2305         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2306                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2307
  2308         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2309
  2310         16  CF-ST-STATUTORY-INTEREST.
  2311             20  CF-ST-STAT-DATE-FROM       PIC X.
  2312                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2313                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2314             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2315             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2316             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2317             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2318             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2319
  2320         16  CF-ST-OVER-SHORT.
  2321             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2322             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2323
  2324         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2325
  2326         16  CF-ST-RT-CALC                  PIC X.
  2327
  2328         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2329         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2330         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2331         16  CF-ST-RF-LR-CALC               PIC X.
  2332         16  CF-ST-RF-LL-CALC               PIC X.
  2333         16  CF-ST-RF-LN-CALC               PIC X.
  2334         16  CF-ST-RF-AH-CALC               PIC X.
  2335         16  CF-ST-RF-CP-CALC               PIC X.
  2336*        16  FILLER                         PIC X(206).
  2337*CIDMOD         16  FILLER                         PIC X(192).
  2338         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2339             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2340         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2341         16  CF-ST-VFY-2ND-BENE             PIC X.
  2342         16  CF-ST-CAUSAL-STATE             PIC X.
  2343         16  FILLER                         PIC X(185).
  2344
  2345****************************************************************
  2346*             BENEFIT MASTER RECORD                            *
  2347****************************************************************
  2348
  2349     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2350         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2351             20  CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  47
* EL106.cbl
  2352             20  CF-BENEFIT-NUMERIC  REDEFINES
  2353                 CF-BENEFIT-CODE            PIC XX.
  2354             20  CF-BENEFIT-ALPHA           PIC XXX.
  2355             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2356             20  CF-BENEFIT-COMMENT         PIC X(10).
  2357
  2358             20  CF-LF-COVERAGE-TYPE        PIC X.
  2359                 88  CF-REDUCING                VALUE 'R'.
  2360                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2361
  2362             20  CF-SPECIAL-CALC-CD         PIC X.
  2363                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2364                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2365                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2366                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2367                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2368                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2369                 88  CF-FARM-PLAN               VALUE 'F'.
  2370                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2371                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2372                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2373                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2374                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2375                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2376                 88  CF-PRUDENTIAL              VALUE 'P'.
  2377                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2378                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2379                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2380                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2381                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2382                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2383
  2384             20  CF-JOINT-INDICATOR         PIC X.
  2385                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2386
  2387*            20  FILLER                     PIC X(12).
  2388             20  FILLER                     PIC X(11).
  2389             20  CF-BENEFIT-CATEGORY        PIC X.
  2390             20  CF-LOAN-TYPE               PIC X(8).
  2391
  2392             20  CF-CO-REM-TERM-CALC        PIC X.
  2393                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2394                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2395                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2396                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2397                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2398
  2399             20  CF-CO-EARNINGS-CALC        PIC X.
  2400                 88  CO-EARN-BY-R78             VALUE '1'.
  2401                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2402                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2403                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2404                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2405                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2406                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2407                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2408
  2409             20  CF-CO-REFUND-CALC          PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  48
* EL106.cbl
  2410                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2411                 88  CO-REFD-BY-R78             VALUE '1'.
  2412                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2413                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2414                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2415                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2416                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2417                 88  CO-REFD-MEAN               VALUE '8'.
  2418                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2419                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2420                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2421
  2422             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2423                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2424                 88  CO-OVRD-BY-R78             VALUE '1'.
  2425                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2426                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2427                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2428                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2429                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2430                 88  CO-OVRD-MEAN               VALUE '8'.
  2431                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2432
  2433             20  CF-CO-BEN-I-G-CD           PIC X.
  2434                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2435                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2436                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2437
  2438         16  FILLER                         PIC X(304).
  2439
  2440
  2441****************************************************************
  2442*             CARRIER MASTER RECORD                            *
  2443****************************************************************
  2444
  2445     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2446         16  CF-ADDRESS-DATA.
  2447             20  CF-MAIL-TO-NAME            PIC X(30).
  2448             20  CF-IN-CARE-OF              PIC X(30).
  2449             20  CF-ADDRESS-LINE-1          PIC X(30).
  2450             20  CF-ADDRESS-LINE-2          PIC X(30).
  2451             20  CF-CITY-STATE              PIC X(30).
  2452             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2453             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2454
  2455         16  CF-CLAIM-NO-CONTROL.
  2456             20  CF-CLAIM-NO-METHOD         PIC X.
  2457                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2458                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2459                 88  CLAIM-NO-SEQ               VALUE '3'.
  2460                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2461             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2462                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2463                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2464                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2465
  2466         16  CF-CHECK-NO-CONTROL.
  2467             20  CF-CHECK-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  49
* EL106.cbl
  2468                 88  CHECK-NO-MANUAL            VALUE '1'.
  2469                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2470                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2471                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2472             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2473                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2474
  2475         16  CF-DOMICILE-STATE              PIC XX.
  2476
  2477         16  CF-EXPENSE-CONTROLS.
  2478             20  CF-EXPENSE-METHOD          PIC X.
  2479                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2480                 88  DOLLARS-PER-PMT            VALUE '2'.
  2481                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2482                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2483             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2484             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2485
  2486         16  CF-CORRESPONDENCE-CONTROL.
  2487             20  CF-LETTER-RESEND-OPT       PIC X.
  2488                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2489                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2490             20  FILLER                     PIC X(4).
  2491
  2492         16  CF-RESERVE-CONTROLS.
  2493             20  CF-MANUAL-SW               PIC X.
  2494                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2495             20  CF-FUTURE-SW               PIC X.
  2496                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2497             20  CF-PTC-SW                  PIC X.
  2498                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2499             20  CF-IBNR-SW                 PIC X.
  2500                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2501             20  CF-PTC-LF-SW               PIC X.
  2502                 88  CF-LF-PTC-USED             VALUE '1'.
  2503             20  CF-CDT-ACCESS-METHOD       PIC X.
  2504                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2505                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2506                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2507             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2508
  2509         16  CF-CLAIM-CALC-METHOD           PIC X.
  2510             88  360-PLUS-MONTHS                VALUE '1'.
  2511             88  365-PLUS-MONTHS                VALUE '2'.
  2512             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2513             88  360-DAILY                      VALUE '4'.
  2514             88  365-DAILY                      VALUE '5'.
  2515
  2516         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2517         16  FILLER                         PIC X(11).
  2518
  2519         16  CF-LIMIT-AMOUNTS.
  2520             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2521             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2522             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2523             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2524             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2525             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  50
* EL106.cbl
  2526             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2527             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2528             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2529             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2530
  2531         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2532         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2533         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2534
  2535         16  CF-ZIP-CODE.
  2536             20  CF-ZIP-PRIME.
  2537                 24  CF-ZIP-1ST             PIC X.
  2538                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2539                 24  FILLER                 PIC X(4).
  2540             20  CF-ZIP-PLUS4               PIC X(4).
  2541         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2542             20  CF-CAN-POSTAL-1            PIC XXX.
  2543             20  CF-CAN-POSTAL-2            PIC XXX.
  2544             20  FILLER                     PIC XXX.
  2545
  2546         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2547         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2548         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2549
  2550         16  CF-RATING-SWITCH               PIC X.
  2551             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2552             88  CF-NO-RATING                   VALUE 'N'.
  2553
  2554         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2555
  2556         16  CF-CARRIER-OVER-SHORT.
  2557             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2558             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2559
  2560         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2561         16  CF-SECPAY-SWITCH               PIC X.
  2562             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2563             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2564         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2565         16  FILLER                         PIC X(448).
  2566*        16  FILLER                         PIC X(452).
  2567
  2568
  2569****************************************************************
  2570*             MORTALITY MASTER RECORD                          *
  2571****************************************************************
  2572
  2573     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2574         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2575                                INDEXED BY CF-MORT-NDX.
  2576             20  CF-MORT-TABLE              PIC X(5).
  2577             20  CF-MORT-TABLE-TYPE         PIC X.
  2578                 88  CF-MORT-JOINT              VALUE 'J'.
  2579                 88  CF-MORT-SINGLE             VALUE 'S'.
  2580                 88  CF-MORT-COMBINED           VALUE 'C'.
  2581                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2582                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2583             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  51
* EL106.cbl
  2584             20  CF-MORT-AGE-METHOD         PIC XX.
  2585                 88  CF-AGE-LAST                VALUE 'AL'.
  2586                 88  CF-AGE-NEAR                VALUE 'AN'.
  2587             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2588             20  CF-MORT-ADJUSTMENT-DIRECTION
  2589                                            PIC X.
  2590                 88  CF-MINUS                   VALUE '-'.
  2591                 88  CF-PLUS                    VALUE '+'.
  2592             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2593             20  CF-MORT-JOINT-CODE         PIC X.
  2594                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2595             20  CF-MORT-PC-Q               PIC X.
  2596                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2597             20  CF-MORT-TABLE-CODE         PIC X(4).
  2598             20  CF-MORT-COMMENTS           PIC X(15).
  2599             20  FILLER                     PIC X(14).
  2600
  2601         16  FILLER                         PIC X(251).
  2602
  2603
  2604****************************************************************
  2605*             BUSSINESS TYPE MASTER RECORD                     *
  2606****************************************************************
  2607
  2608     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2609* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2610* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2611* AND RECORD 05 IS TYPES 81-99
  2612         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2613             20  CF-BUSINESS-TITLE          PIC  X(19).
  2614             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2615                                            PIC S9V9(4) COMP-3.
  2616             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2617             20  FILLER                     PIC  X.
  2618         16  FILLER                         PIC  X(248).
  2619
  2620
  2621****************************************************************
  2622*             TERMINAL MASTER RECORD                           *
  2623****************************************************************
  2624
  2625     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2626
  2627         16  CF-COMPANY-TERMINALS.
  2628             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2629                                  PIC X(4).
  2630         16  FILLER               PIC X(248).
  2631
  2632
  2633****************************************************************
  2634*             LIFE EDIT MASTER RECORD                          *
  2635****************************************************************
  2636
  2637     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2638         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2639             20  CF-LIFE-CODE-IN            PIC XX.
  2640             20  CF-LIFE-CODE-OUT           PIC XX.
  2641         16  FILLER                         PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  52
* EL106.cbl
  2642
  2643
  2644****************************************************************
  2645*             AH EDIT MASTER RECORD                            *
  2646****************************************************************
  2647
  2648     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2649         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2650             20  CF-AH-CODE-IN              PIC XXX.
  2651             20  CF-AH-CODE-OUT             PIC XX.
  2652         16  FILLER                         PIC X(248).
  2653
  2654
  2655****************************************************************
  2656*             CREDIBILITY TABLES                               *
  2657****************************************************************
  2658
  2659     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2660         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2661                             INDEXED BY CF-CRDB-NDX.
  2662             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2663             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2664             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2665         16  FILLER                         PIC  X(332).
  2666
  2667
  2668****************************************************************
  2669*             REPORT CUSTOMIZATION RECORD                      *
  2670****************************************************************
  2671
  2672     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2673         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2674             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2675             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2676             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2677**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2678****       A T-TRANSFER.                                   ****
  2679             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2680
  2681         16  FILLER                         PIC XX.
  2682
  2683         16  CF-CARRIER-CNTL-OPT.
  2684             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2685                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2686                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2687             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2688                                            PIC X.
  2689         16  CF-GROUP-CNTL-OPT.
  2690             20  CF-GROUP-OPT-SEQ           PIC 9.
  2691                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2692                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2693             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2694                                            PIC X(6).
  2695         16  CF-STATE-CNTL-OPT.
  2696             20  CF-STATE-OPT-SEQ           PIC 9.
  2697                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2698                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2699             20  CF-STATE-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  53
* EL106.cbl
  2700                                            PIC XX.
  2701         16  CF-ACCOUNT-CNTL-OPT.
  2702             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2703                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2704                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2705             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2706                                            PIC X(10).
  2707         16  CF-BUS-TYP-CNTL-OPT.
  2708             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2709                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2710                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2711             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2712                                            PIC XX.
  2713         16  CF-LF-TYP-CNTL-OPT.
  2714             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2715                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2716                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2717             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2718                                            PIC XX.
  2719         16  CF-AH-TYP-CNTL-OPT.
  2720             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2721                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2722                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2723             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2724                                            PIC XX.
  2725         16  CF-REPTCD1-CNTL-OPT.
  2726             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2727                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2728                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2729             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2730                                            PIC X(10).
  2731         16  CF-REPTCD2-CNTL-OPT.
  2732             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2733                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2734                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2735             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2736                                            PIC X(10).
  2737         16  CF-USER1-CNTL-OPT.
  2738             20  CF-USER1-OPT-SEQ           PIC 9.
  2739                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2740                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2741             20  CF-USER1-SELECT OCCURS 3 TIMES
  2742                                            PIC X(10).
  2743         16  CF-USER2-CNTL-OPT.
  2744             20  CF-USER2-OPT-SEQ           PIC 9.
  2745                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2746                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2747             20  CF-USER2-SELECT OCCURS 3 TIMES
  2748                                            PIC X(10).
  2749         16  CF-USER3-CNTL-OPT.
  2750             20  CF-USER3-OPT-SEQ           PIC 9.
  2751                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2752                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2753             20  CF-USER3-SELECT OCCURS 3 TIMES
  2754                                            PIC X(10).
  2755         16  CF-USER4-CNTL-OPT.
  2756             20  CF-USER4-OPT-SEQ           PIC 9.
  2757                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  54
* EL106.cbl
  2758                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2759             20  CF-USER4-SELECT OCCURS 3 TIMES
  2760                                            PIC X(10).
  2761         16  CF-USER5-CNTL-OPT.
  2762             20  CF-USER5-OPT-SEQ           PIC 9.
  2763                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2764                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2765             20  CF-USER5-SELECT OCCURS 3 TIMES
  2766                                            PIC X(10).
  2767         16  CF-REINS-CNTL-OPT.
  2768             20  CF-REINS-OPT-SEQ           PIC 9.
  2769                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2770                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2771             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2772                 24  CF-REINS-PRIME         PIC XXX.
  2773                 24  CF-REINS-SUB           PIC XXX.
  2774
  2775         16  CF-AGENT-CNTL-OPT.
  2776             20  CF-AGENT-OPT-SEQ           PIC 9.
  2777                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2778                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2779             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2780                                            PIC X(10).
  2781
  2782         16  FILLER                         PIC X(43).
  2783
  2784         16  CF-LOSS-RATIO-SELECT.
  2785             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2786             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2787         16  CF-ENTRY-DATE-SELECT.
  2788             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2789             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2790         16  CF-EFFECTIVE-DATE-SELECT.
  2791             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2792             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2793
  2794         16  CF-EXCEPTION-LIST-IND          PIC X.
  2795             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2796
  2797         16  FILLER                         PIC X(318).
  2798
  2799****************************************************************
  2800*                  EXCEPTION REPORTING RECORD                  *
  2801****************************************************************
  2802
  2803     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2804         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2805             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2806
  2807         16  CF-COMBINED-LIFE-AH-OPT.
  2808             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2809             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2810             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2811             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2812
  2813         16  CF-LIFE-OPT.
  2814             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2815             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  55
* EL106.cbl
  2816             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2817             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2818             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2819             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2820             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2821             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2822             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2823             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2824
  2825         16  CF-AH-OPT.
  2826             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2827             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2828             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2829             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2830             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2831             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2832             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2833             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2834             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2835             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2836
  2837         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2838             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2839             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2840             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2841
  2842         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2843
  2844         16  FILLER                         PIC X(673).
  2845
  2846
  2847****************************************************************
  2848*             MORTGAGE SYSTEM PLAN RECORD                      *
  2849****************************************************************
  2850
  2851     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2852         16  CF-PLAN-TYPE                   PIC X.
  2853             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2854             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2855             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2856         16  CF-PLAN-ABBREV                 PIC XXX.
  2857         16  CF-PLAN-DESCRIPT               PIC X(10).
  2858         16  CF-PLAN-NOTES                  PIC X(20).
  2859         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2860         16  CF-PLAN-UNDERWRITING.
  2861             20  CF-PLAN-TERM-DATA.
  2862                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2863                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2864             20  CF-PLAN-AGE-DATA.
  2865                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2866                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2867                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2868             20  CF-PLAN-BENEFIT-DATA.
  2869                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2870                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2871                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2872                                            PIC S9(7)V99  COMP-3.
  2873         16  CF-PLAN-POLICY-FORMS.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  56
* EL106.cbl
  2874             20  CF-POLICY-FORM             PIC X(12).
  2875             20  CF-MASTER-APPLICATION      PIC X(12).
  2876             20  CF-MASTER-POLICY           PIC X(12).
  2877         16  CF-PLAN-RATING.
  2878             20  CF-RATE-CODE               PIC X(5).
  2879             20  CF-SEX-RATING              PIC X.
  2880                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2881                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2882             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2883             20  CF-SUB-STD-TYPE            PIC X.
  2884                 88  CF-PCT-OF-PREM            VALUE '1'.
  2885                 88  CF-PCT-OF-BENE            VALUE '2'.
  2886         16  CF-PLAN-PREM-TOLERANCES.
  2887             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2888             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2889         16  CF-PLAN-PYMT-TOLERANCES.
  2890             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2891             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2892         16  CF-PLAN-MISC-DATA.
  2893             20  FILLER                     PIC X.
  2894             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2895             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2896         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2897         16  CF-PLAN-IND-GRP                PIC X.
  2898             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2899                                                     '1'.
  2900             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2901                                                     '2'.
  2902         16  CF-MIB-SEARCH-SW               PIC X.
  2903             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2904             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2905             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2906             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2907         16  CF-ALPHA-SEARCH-SW             PIC X.
  2908             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2909             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2910             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2911             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2912             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2913             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2914             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2915             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2916             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2917             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2918                                                     'A' 'B' 'C'
  2919                                                     'X' 'Y' 'Z'.
  2920         16  CF-EFF-DT-RULE-SW              PIC X.
  2921             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2922             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2923             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2924             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2925             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2926         16  FILLER                         PIC X(4).
  2927         16  CF-HEALTH-QUESTIONS            PIC X.
  2928             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2929         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2930         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2931         16  CF-PLAN-SNGL-JNT               PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  57
* EL106.cbl
  2932             88  CF-COMBINED-PLAN              VALUE 'C'.
  2933             88  CF-JNT-PLAN                   VALUE 'J'.
  2934             88  CF-SNGL-PLAN                  VALUE 'S'.
  2935         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2936         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2937         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2938         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2939         16  CF-RERATE-CNTL                 PIC  X.
  2940             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2941             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2942             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2943             88  CF-AUTO-RECALC                 VALUE '4'.
  2944         16  CF-BENEFIT-TYPE                PIC  X.
  2945             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2946             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2947         16  CF-POLICY-FEE                  PIC S999V99
  2948                                                    COMP-3.
  2949         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2950         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2951         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2952         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2953         16  FILLER                         PIC  X(32).
  2954         16  CF-TERMINATION-FORM            PIC  X(04).
  2955         16  FILLER                         PIC  X(08).
  2956         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2957                                                       COMP-3.
  2958         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2959         16  CF-ISSUE-LETTER                PIC  X(4).
  2960         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2961         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2962             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2963             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2964         16  CF-MP-REFUND-CALC              PIC X.
  2965             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2966             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2967             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2968             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2969             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2970             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2971             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2972             88  CF-MP-REFD-MEAN                VALUE '8'.
  2973         16  CF-ALT-RATE-CODE               PIC  X(5).
  2974
  2975
  2976         16  FILLER                         PIC X(498).
  2977****************************************************************
  2978*             MORTGAGE COMPANY MASTER RECORD                   *
  2979****************************************************************
  2980
  2981     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2982         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2983         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2984             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2985             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2986             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2987             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2988             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2989
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  58
* EL106.cbl
  2990         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2991         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2992         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2993         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2994         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2995
  2996         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2997             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2998         16  CF-MP-RECON-USE-IND            PIC X(1).
  2999             88  CF-MP-USE-RECON             VALUE 'Y'.
  3000         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3001             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3002         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3003             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3004             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3005         16  FILLER                         PIC X(1).
  3006         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3007             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3008         16  CF-MORTG-MIB-VERSION           PIC X.
  3009             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3010             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3011             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3012         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3013             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3014                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3015             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3016                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3017             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3018                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3019             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3020                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3021             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3022                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3023             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3024                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3025         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3026         16  FILLER                         PIC X(7).
  3027         16  CF-MORTG-DESTINATION-SYMBOL.
  3028             20  CF-MORTG-MIB-COMM          PIC X(5).
  3029             20  CF-MORTG-MIB-TERM          PIC X(5).
  3030         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3031             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3032         16  FILLER                         PIC X(03).
  3033         16  CF-MP-CHECK-NO-CONTROL.
  3034             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3035                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3036                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3037                                                ' ' LOW-VALUES.
  3038                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3039                                               VALUE '3'.
  3040         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3041         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3042         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3043             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3044                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3045             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3046                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3047             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  59
* EL106.cbl
  3048                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3049             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3050                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3051             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3052                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3053             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3054                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3055         16  CF-MORTG-BILLING-AREA.
  3056             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3057                                            PIC X.
  3058         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3059         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3060         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3061         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3062             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3063             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3064         16  FILLER                         PIC X.
  3065         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3066             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3067             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3068         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3069         16  FILLER                         PIC X(8).
  3070         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3071         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3072         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3073         16  CF-ACH-COMPANY-ID.
  3074             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3075                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3076                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3077                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3078             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3079         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3080             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3081         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3082             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3083             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3084         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3085         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3086         16  FILLER                         PIC X(536).
  3087
  3088****************************************************************
  3089*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3090****************************************************************
  3091
  3092     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3093         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3094             20  CF-FEMALE-HEIGHT.
  3095                 24  CF-FEMALE-FT           PIC 99.
  3096                 24  CF-FEMALE-IN           PIC 99.
  3097             20  CF-FEMALE-MIN-WT           PIC 999.
  3098             20  CF-FEMALE-MAX-WT           PIC 999.
  3099         16  FILLER                         PIC X(428).
  3100
  3101     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3102         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3103             20  CF-MALE-HEIGHT.
  3104                 24  CF-MALE-FT             PIC 99.
  3105                 24  CF-MALE-IN             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  60
* EL106.cbl
  3106             20  CF-MALE-MIN-WT             PIC 999.
  3107             20  CF-MALE-MAX-WT             PIC 999.
  3108         16  FILLER                         PIC X(428).
  3109******************************************************************
  3110*             AUTOMATIC ACTIVITY RECORD                          *
  3111******************************************************************
  3112     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3113         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3114             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3115             20  CF-SYS-LETTER-ID           PIC X(04).
  3116             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3117             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3118             20  CF-SYS-RESET-SW            PIC X(01).
  3119             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3120             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3121
  3122         16  FILLER                         PIC X(50).
  3123
  3124         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3125             20  CF-USER-ACTIVE-SW          PIC X(01).
  3126             20  CF-USER-LETTER-ID          PIC X(04).
  3127             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3128             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3129             20  CF-USER-RESET-SW           PIC X(01).
  3130             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3131             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3132             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3133
  3134         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  61
* EL106.cbl
  3136*    COPY ELCTEXT.
  3137******************************************************************
  3138*                                                                *
  3139*                                                                *
  3140*                            ELCTEXT.                            *
  3141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3142*                            VMOD=2.008                          *
  3143*                                                                *
  3144*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  3145*                                     FORM LETTERS,              *
  3146*                                     CERT FORM DISPLAY.
  3147*                                                                *
  3148*   FILE TYPE = VSAM,KSDS                                        *
  3149*   RECORD SIZE = 100   RECFORM = FIXED                          *
  3150*                                                                *
  3151*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  3152*       ALTERNATE INDEX = NONE                                   *
  3153*                                                                *
  3154*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  3155*       ALTERNATE INDEX = NONE                                   *
  3156*                                                                *
  3157*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3158*       ALTERNATE INDEX = NONE                                   *
  3159*                                                                *
  3160*   LOG = NO                                                     *
  3161*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3162******************************************************************
  3163 01  TEXT-FILES.
  3164     12  TEXT-FILE-ID                PIC XX.
  3165         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3166         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3167         88  HELP-FILE-TEXT             VALUE 'TH'.
  3168
  3169     12  TX-CONTROL-PRIMARY.
  3170         16  TX-COMPANY-CD           PIC X.
  3171             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3172         16  TX-ACCESS-CD-GENL       PIC X(12).
  3173
  3174         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3175             20  TX-LETTER-NO        PIC X(4).
  3176             20  FILLER              PIC X(8).
  3177
  3178         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3179             20  TX-FORM-NO          PIC X(12).
  3180
  3181         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3182             20  TX-HELP-TYPE        PIC X.
  3183                 88  HELP-FOR-GENERAL   VALUE ' '.
  3184                 88  HELP-BY-SCREEN     VALUE 'S'.
  3185                 88  HELP-BY-ERROR      VALUE 'E'.
  3186             20  TX-SCREEN-OR-ERROR  PIC X(4).
  3187                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3188             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3189                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3190             20  FILLER              PIC X(4).
  3191
  3192         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3193
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  62
* EL106.cbl
  3194     12  TX-PROCESS-CONTROL          PIC XX.
  3195         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3196
  3197     12  TX-TEXT-LINE                PIC X(70).
  3198
  3199     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3200         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3201         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3202         88  TX-VALID-FORM-SQUEEZE-VALUE
  3203                                        VALUE 'Y' ' '.
  3204
  3205     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3206         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3207         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3208         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3209         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3210         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3211         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3212         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  3213                                              'K' 'N' ' '
  3214                                              'Z'.
  3215
  3216     12  TX-ARCHIVE-SW               PIC X.
  3217         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  3218         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3219         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3220
  3221     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3222     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3223
  3224     12  TX-BSR-CODE                 PIC X.
  3225         88  TX-BSR-LETTER              VALUE 'B'.
  3226         88  TX-NON-BSR-LETTER          VALUE ' '.
  3227
  3228     12  FILLER                      PIC X.
  3229*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  63
* EL106.cbl
  3231 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  3232                          TEXT-FILES.
  3233 0000-DFHEXIT SECTION.
  3234     MOVE '9#                    $   ' TO DFHEIV0.
  3235     MOVE 'EL106' TO DFHEIV1.
  3236     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3237
  3238     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3239     MOVE '5'                   TO DC-OPTION-CODE.
  3240     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3241     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3242     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  3243
  3244     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  3245     MOVE 2                     TO EMI-NUMBER-OF-LINES
  3246                                   EMI-SWITCH2.
  3247
  3248     MOVE EIBTRMID              TO QID-TERM.
  3249
  3250     IF EIBCALEN = 0
  3251         GO TO 8800-UNAUTHORIZED-ACCESS.
  3252
  3253     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3254         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  3255       ELSE
  3256         MOVE SPACES             TO RETURNED-FROM.
  3257
  3258     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3259         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3260             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3261             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3262             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3263             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3264             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3265             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3266             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3267             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3268             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  3269         ELSE
  3270             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3271             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3272             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3273             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3274             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3275             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3276             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3277             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  3278
  3279     MOVE 'N' TO WS-DISPLAY-SW.
  3280
  3281
  3282* EXEC CICS HANDLE CONDITION
  3283*        DUPREC  (8850-DUPREC)
  3284*        NOTOPEN (8870-NOTOPEN)
  3285*        NOTFND  (8880-NOT-FOUND)
  3286*        PGMIDERR(9600-PGMID-ERROR)
  3287*        ERROR   (9990-ABEND)
  3288*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  64
* EL106.cbl
  3289*    MOVE '"$%JIL.               ! " #00003277' TO DFHEIV0
  3290     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  3291     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3292     MOVE X'2220233030303033323737' TO DFHEIV0(25:11)
  3293     CALL 'kxdfhei1' USING DFHEIV0
  3294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3295
  3296
  3297     IF EIBTRNID NOT = TRANS-ID
  3298       IF RETURNED-FROM = XCTL-EL6565
  3299           MOVE LOW-VALUES           TO EL106AO
  3300           PERFORM 6500-RECOVER-TEMP-STORAGE THRU 6500-EXIT
  3301           GO TO 8100-SEND-INITIAL-MAP
  3302        ELSE
  3303       IF RETURNED-FROM = XCTL-EL1061
  3304           MOVE LOW-VALUES           TO EL106AO
  3305           IF PI-WS-STATE EQUAL LOW-VALUES OR SPACES
  3306               GO TO 8100-SEND-INITIAL-MAP
  3307           ELSE
  3308               MOVE PI-WS-STATE TO STCDI
  3309               MOVE 'Y' TO WS-DISPLAY-SW
  3310               GO TO 1000-SHOW-STATE
  3311        ELSE
  3312       IF PI-RETURN-TO-PROGRAM = XCTL-EL6507
  3313           MOVE LOW-VALUES           TO EL106AO
  3314           IF PI-WS-STATE EQUAL LOW-VALUES OR SPACES
  3315               GO TO 8100-SEND-INITIAL-MAP
  3316           ELSE
  3317               MOVE PI-WS-STATE TO STCDI
  3318               MOVE 'Y' TO WS-DISPLAY-SW
  3319               GO TO 1000-SHOW-STATE
  3320        ELSE
  3321         MOVE LOW-VALUES           TO EL106AO
  3322         GO TO 8100-SEND-INITIAL-MAP.
  3323
  3324     IF EIBAID = DFHCLEAR
  3325         GO TO 9400-CLEAR.
  3326
  3327     IF NOT DISPLAY-CAP
  3328         MOVE 'READ'         TO SM-READ
  3329         PERFORM 9995-SECURITY-VIOLATION
  3330         MOVE ER-0070        TO EMI-ERROR
  3331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3332         GO TO 8100-SEND-INITIAL-MAP.
  3333
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  65
* EL106.cbl
  3335 0200-RECEIVE.
  3336     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3337         MOVE LOW-VALUES TO EL106AI
  3338         MOVE ER-7008    TO EMI-ERROR
  3339         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3340         MOVE -1 TO MAINTL
  3341         GO TO 8200-SEND-DATAONLY.
  3342
  3343
  3344* EXEC CICS RECEIVE
  3345*        MAP   (MAP-NAME)
  3346*        MAPSET(MAPSET-NAME)
  3347*        INTO  (EL106AI)
  3348*    END-EXEC.
  3349     MOVE LENGTH OF
  3350      EL106AI
  3351       TO DFHEIV11
  3352*    MOVE '8"T I  L              ''   #00003331' TO DFHEIV0
  3353     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3354     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3355     MOVE X'2020233030303033333331' TO DFHEIV0(25:11)
  3356     CALL 'kxdfhei1' USING DFHEIV0,
  3357           MAP-NAME,
  3358           EL106AI,
  3359           DFHEIV11,
  3360           MAPSET-NAME,
  3361           DFHEIV99,
  3362           DFHEIV99
  3363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3364
  3365
  3366     IF ENTERPFL = 0
  3367         GO TO 0300-CHECK-PFKEYS.
  3368
  3369     IF EIBAID NOT = DFHENTER
  3370         MOVE ER-0004 TO EMI-ERROR
  3371         GO TO 0320-INPUT-ERROR.
  3372
  3373     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  3374         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  3375     ELSE
  3376         MOVE ER-0029 TO EMI-ERROR
  3377         GO TO 0320-INPUT-ERROR.
  3378
  3379 0300-CHECK-PFKEYS.
  3380     IF EIBAID = DFHPF23
  3381         GO TO 8810-PF23.
  3382
  3383     IF EIBAID = DFHPF24
  3384         GO TO 9200-RETURN-MAIN-MENU.
  3385
  3386     IF EIBAID = DFHPF12
  3387         GO TO 9500-PF12.
  3388
  3389     IF MAINTL NOT = 0  AND
  3390        EIBAID NOT = DFHENTER
  3391          MOVE ER-0050 TO EMI-ERROR
  3392          GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  66
* EL106.cbl
  3393
  3394     IF EIBAID = DFHPF1
  3395         GO TO 5000-FIND-NEXT-STATE.
  3396
  3397     IF EIBAID = DFHPF2
  3398         GO TO 5500-FIND-PREV-STATE.
  3399
  3400     IF EIBAID = DFHPF3
  3401         IF NOT MORTGAGE-SESSION
  3402             IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  3403                 MOVE ER-0029        TO  EMI-ERROR
  3404                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3405                 MOVE -1             TO  ENTERPFL
  3406                 MOVE AL-UNBON       TO  ENTERPFA
  3407                 GO TO 8200-SEND-DATAONLY
  3408             ELSE
  3409                 MOVE PI-PREV-STATE  TO  PI-WS-STATE
  3410                 MOVE SPACES         TO  PI-WS-CLASS
  3411                                         PI-WS-DEV
  3412                                         PI-WS-TYPE
  3413                                         PI-WS-PLAN
  3414                 PERFORM 6400-CREATE-TEMP-STORAGE THRU 6400-EXIT
  3415                 MOVE XCTL-EL6565    TO  PGM-NAME
  3416                 GO TO 9300-XCTL
  3417         ELSE
  3418             MOVE ER-7536 TO EMI-ERROR
  3419             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3420             MOVE AL-UNBON TO ENTERPFA
  3421             IF ENTERPFL = 0
  3422                 MOVE -1 TO MAINTL
  3423                 GO TO 8200-SEND-DATAONLY
  3424             ELSE
  3425                 MOVE -1 TO ENTERPFL
  3426                 GO TO 8200-SEND-DATAONLY.
  3427
  3428     IF EIBAID = DFHPF4
  3429         IF NOT MORTGAGE-SESSION
  3430             IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  3431                 MOVE ER-0029        TO  EMI-ERROR
  3432                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3433                 MOVE -1             TO  ENTERPFL
  3434                 MOVE AL-UNBON       TO  ENTERPFA
  3435                 GO TO 8200-SEND-DATAONLY
  3436             ELSE
  3437                 MOVE PI-PREV-STATE  TO  PI-WS-STATE
  3438                 MOVE SPACES         TO  PI-WS-CLASS
  3439                                         PI-WS-DEV
  3440                                         PI-WS-TYPE
  3441                                         PI-WS-PLAN
  3442                 MOVE XCTL-EL1061    TO  PGM-NAME
  3443                 GO TO 9300-XCTL
  3444         ELSE
  3445             MOVE ER-7536 TO EMI-ERROR
  3446             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3447             MOVE AL-UNBON TO ENTERPFA
  3448             IF ENTERPFL = 0
  3449                 MOVE -1 TO MAINTL
  3450                 GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  67
* EL106.cbl
  3451             ELSE
  3452                 MOVE -1 TO ENTERPFL
  3453                 GO TO 8200-SEND-DATAONLY.
  3454
  3455     IF EIBAID = DFHENTER
  3456         GO TO 0330-EDIT-DATA.
  3457
  3458     MOVE ER-0029 TO EMI-ERROR.
  3459 0320-INPUT-ERROR.
  3460     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3461     MOVE AL-UNBON TO ENTERPFA.
  3462
  3463     IF ENTERPFL = 0
  3464         MOVE -1 TO MAINTL
  3465     ELSE
  3466         MOVE -1 TO ENTERPFL.
  3467
  3468     GO TO 8200-SEND-DATAONLY.
  3469
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  68
* EL106.cbl
  3471 0330-EDIT-DATA.
  3472     IF STCDL = ZERO AND
  3473        STABRL = ZERO
  3474         MOVE ER-0144       TO EMI-ERROR
  3475         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3476         MOVE -1            TO STCDL
  3477         MOVE AL-UABON      TO STCDA
  3478         GO TO 8200-SEND-DATAONLY.
  3479
  3480     IF STCDL = ZERO AND
  3481        STABRL NOT = ZERO
  3482         PERFORM 0500-GET-STATE-CD THRU 0600-EXIT.
  3483
  3484     IF MAINTI = 'S'
  3485         GO TO 1000-SHOW-STATE.
  3486
  3487     IF MODIFY-CAP
  3488        NEXT SENTENCE
  3489       ELSE
  3490        IF MAINTI = 'A' OR 'C' OR 'D'
  3491         MOVE 'UPDATE'       TO SM-READ
  3492         PERFORM 9995-SECURITY-VIOLATION
  3493         MOVE ER-0070        TO EMI-ERROR
  3494         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3495         MOVE LOW-VALUES     TO EL106AO
  3496         GO TO 8100-SEND-INITIAL-MAP.
  3497
  3498     IF MAINTI = 'C'
  3499         GO TO 2000-CHANGE-STATE.
  3500
  3501     IF MAINTI = 'A'
  3502         GO TO 3000-ADD-STATE.
  3503
  3504     IF MAINTI = 'D'
  3505         GO TO 4000-DELETE-STATE.
  3506
  3507     MOVE ER-0023 TO EMI-ERROR.
  3508     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3509     MOVE -1       TO MAINTL.
  3510     MOVE AL-UABON TO MAINTA.
  3511     GO TO 8200-SEND-DATAONLY.
  3512
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  69
* EL106.cbl
  3514 0500-GET-STATE-CD.
  3515     MOVE PI-COMPANY-ID  TO CK-COMP-ID.
  3516     MOVE LOW-VALUES     TO CK-STATE-CD.
  3517     MOVE +0             TO CK-SEQ.
  3518
  3519
  3520* EXEC CICS HANDLE CONDITION
  3521*        ENDFILE(8880-NOT-FOUND)
  3522*        NOTFND (8880-NOT-FOUND)
  3523*    END-EXEC.
  3524*    MOVE '"$''I                  ! # #00003490' TO DFHEIV0
  3525     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  3526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3527     MOVE X'2320233030303033343930' TO DFHEIV0(25:11)
  3528     CALL 'kxdfhei1' USING DFHEIV0
  3529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3530
  3531
  3532
  3533* EXEC CICS STARTBR
  3534*        DATASET  (ELCNTL-ID)
  3535*        RIDFLD   (ELCNTL-KEY)
  3536*    END-EXEC.
  3537     MOVE 0
  3538       TO DFHEIV11
  3539*    MOVE '&,         G          &   #00003495' TO DFHEIV0
  3540     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3541     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3542     MOVE X'2020233030303033343935' TO DFHEIV0(25:11)
  3543     CALL 'kxdfhei1' USING DFHEIV0,
  3544           ELCNTL-ID,
  3545           ELCNTL-KEY,
  3546           DFHEIV99,
  3547           DFHEIV11,
  3548           DFHEIV99
  3549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3550
  3551
  3552 0510-GET-NEXT-CD.
  3553
  3554* EXEC CICS READNEXT
  3555*        DATASET(ELCNTL-ID)
  3556*        SET    (ADDRESS OF CONTROL-FILE)
  3557*        RIDFLD (ELCNTL-KEY)
  3558*    END-EXEC.
  3559     MOVE 0
  3560       TO DFHEIV11
  3561*    MOVE '&.S                   )   #00003501' TO DFHEIV0
  3562     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3563     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3564     MOVE X'2020233030303033353031' TO DFHEIV0(25:11)
  3565     CALL 'kxdfhei1' USING DFHEIV0,
  3566           ELCNTL-ID,
  3567           DFHEIV20,
  3568           DFHEIV99,
  3569           ELCNTL-KEY,
  3570           DFHEIV99,
  3571           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  70
* EL106.cbl
  3572           DFHEIV99,
  3573           DFHEIV99
  3574     SET ADDRESS OF CONTROL-FILE TO
  3575         DFHEIV20
  3576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3577
  3578
  3579     IF CF-COMPANY-ID NOT = PI-COMPANY-ID
  3580
  3581* EXEC CICS ENDBR
  3582*            DATASET  (ELCNTL-ID)
  3583*        END-EXEC
  3584     MOVE 0
  3585       TO DFHEIV11
  3586*    MOVE '&2                    $   #00003508' TO DFHEIV0
  3587     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3588     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3589     MOVE X'2020233030303033353038' TO DFHEIV0(25:11)
  3590     CALL 'kxdfhei1' USING DFHEIV0,
  3591           ELCNTL-ID,
  3592           DFHEIV11,
  3593           DFHEIV99
  3594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3595         GO TO 8880-NOT-FOUND.
  3596
  3597     IF CF-RECORD-TYPE NOT = '3'
  3598         GO TO 0510-GET-NEXT-CD.
  3599
  3600     IF CF-STATE-ABBREVIATION = STABRI
  3601         NEXT SENTENCE
  3602       ELSE
  3603         GO TO 0510-GET-NEXT-CD.
  3604
  3605     MOVE CF-STATE-CODE      TO STCDI.
  3606     MOVE AL-UANON           TO STCDA.
  3607     MOVE +2                 TO STCDL.
  3608
  3609
  3610* EXEC CICS ENDBR
  3611*        DATASET  (ELCNTL-ID)
  3612*    END-EXEC.
  3613     MOVE 0
  3614       TO DFHEIV11
  3615*    MOVE '&2                    $   #00003525' TO DFHEIV0
  3616     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3617     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3618     MOVE X'2020233030303033353235' TO DFHEIV0(25:11)
  3619     CALL 'kxdfhei1' USING DFHEIV0,
  3620           ELCNTL-ID,
  3621           DFHEIV11,
  3622           DFHEIV99
  3623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3624
  3625
  3626 0600-EXIT.
  3627      EXIT.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  71
* EL106.cbl
  3629 1000-SHOW-STATE.
  3630     IF RETURN-DISPLAY
  3631
  3632* EXEC CICS HANDLE CONDITION
  3633*            NOTFND  (8100-SEND-INITIAL-MAP)
  3634*        END-EXEC.
  3635*    MOVE '"$I                   ! $ #00003534' TO DFHEIV0
  3636     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3638     MOVE X'2420233030303033353334' TO DFHEIV0(25:11)
  3639     CALL 'kxdfhei1' USING DFHEIV0
  3640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3641
  3642
  3643     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  3644     MOVE STCDI         TO CK-STATE-CD
  3645                           PI-WS-STATE.
  3646
  3647
  3648* EXEC CICS READ
  3649*        DATASET(ELCNTL-ID)
  3650*        SET    (ADDRESS OF CONTROL-FILE)
  3651*        RIDFLD (ELCNTL-KEY)
  3652*    END-EXEC.
  3653*    MOVE '&"S        E          (   #00003542' TO DFHEIV0
  3654     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3656     MOVE X'2020233030303033353432' TO DFHEIV0(25:11)
  3657     CALL 'kxdfhei1' USING DFHEIV0,
  3658           ELCNTL-ID,
  3659           DFHEIV20,
  3660           DFHEIV99,
  3661           ELCNTL-KEY,
  3662           DFHEIV99,
  3663           DFHEIV99,
  3664           DFHEIV99
  3665     SET ADDRESS OF CONTROL-FILE TO
  3666         DFHEIV20
  3667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3668
  3669
  3670     GO TO 7000-BUILD-OUTPUT-MAP.
  3671
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  72
* EL106.cbl
  3673 2000-CHANGE-STATE.
  3674     IF STCDI NOT = PI-PREV-STATE
  3675         MOVE ER-0145 TO EMI-ERROR
  3676         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3677         MOVE -1       TO STCDL
  3678         MOVE AL-UABON TO STCDA
  3679         GO TO 8200-SEND-DATAONLY.
  3680
  3681     PERFORM 6000-EDIT-INPUT-DATA THRU 6099-EXIT.
  3682
  3683     IF NOT EMI-NO-ERRORS
  3684         GO TO 8200-SEND-DATAONLY.
  3685
  3686     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  3687     MOVE STCDI         TO CK-STATE-CD
  3688                           PI-WS-STATE.
  3689
  3690
  3691* EXEC CICS READ
  3692*        UPDATE
  3693*        DATASET(ELCNTL-ID)
  3694*        SET    (ADDRESS OF CONTROL-FILE)
  3695*        RIDFLD (ELCNTL-KEY)
  3696*    END-EXEC.
  3697*    MOVE '&"S        EU         (   #00003568' TO DFHEIV0
  3698     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3699     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3700     MOVE X'2020233030303033353638' TO DFHEIV0(25:11)
  3701     CALL 'kxdfhei1' USING DFHEIV0,
  3702           ELCNTL-ID,
  3703           DFHEIV20,
  3704           DFHEIV99,
  3705           ELCNTL-KEY,
  3706           DFHEIV99,
  3707           DFHEIV99,
  3708           DFHEIV99
  3709     SET ADDRESS OF CONTROL-FILE TO
  3710         DFHEIV20
  3711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3712
  3713
  3714     IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY    OR
  3715        CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
  3716
  3717* EXEC CICS UNLOCK
  3718*            DATASET(ELCNTL-ID)
  3719*        END-EXEC
  3720*    MOVE '&*                    #   #00003577' TO DFHEIV0
  3721     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3722     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3723     MOVE X'2020233030303033353737' TO DFHEIV0(25:11)
  3724     CALL 'kxdfhei1' USING DFHEIV0,
  3725           ELCNTL-ID,
  3726           DFHEIV99
  3727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3728         MOVE ER-0068 TO EMI-ERROR
  3729         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3730         GO TO 1000-SHOW-STATE.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  73
* EL106.cbl
  3731
  3732     MOVE 'B'                    TO JP-RECORD-TYPE.
  3733     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  3734     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  3735
  3736     MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY.
  3737     MOVE EIBTIME         TO CF-LAST-MAINT-HHMMSS.
  3738     MOVE EIBDATE         TO DC-JULIAN-YYDDD.
  3739     MOVE '5'             TO DC-OPTION-CODE.
  3740     MOVE LINK-ELDATCV    TO PGM-NAME.
  3741
  3742
  3743* EXEC CICS LINK
  3744*        PROGRAM (PGM-NAME)
  3745*        COMMAREA(DATE-CONVERSION-DATA)
  3746*        LENGTH  (DC-COMM-LENGTH)
  3747*    END-EXEC.
  3748*    MOVE '."C                   (   #00003594' TO DFHEIV0
  3749     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3750     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3751     MOVE X'2020233030303033353934' TO DFHEIV0(25:11)
  3752     CALL 'kxdfhei1' USING DFHEIV0,
  3753           PGM-NAME,
  3754           DATE-CONVERSION-DATA,
  3755           DC-COMM-LENGTH,
  3756           DFHEIV99,
  3757           DFHEIV99,
  3758           DFHEIV99,
  3759           DFHEIV99
  3760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3761
  3762
  3763     IF DATE-CONVERSION-ERROR
  3764         MOVE LOW-VALUES          TO CF-LAST-MAINT-DT
  3765     ELSE
  3766         MOVE DC-BIN-DATE-1       TO CF-LAST-MAINT-DT.
  3767
  3768     IF STABRL NOT = ZEROS
  3769         MOVE STABRI              TO CF-STATE-ABBREVIATION.
  3770
  3771     IF STNAMEL NOT = ZEROS
  3772         MOVE STNAMEI             TO CF-STATE-NAME.
  3773
  3774     IF LFEXPL NOT = ZEROS
  3775         MOVE WS-ST-LF-EXP-PCT    TO CF-ST-LF-EXP-PCT.
  3776
  3777     IF AHEXPL NOT = ZEROS
  3778         MOVE WS-ST-AH-EXP-PCT    TO CF-ST-AH-EXP-PCT.
  3779
  3780     IF QUOTCALL NOT = ZEROS
  3781         MOVE QUOTCALI            TO CF-ST-TOL-CLAIM.
  3782
  3783     IF PREMTOLL NOT = ZEROS
  3784         MOVE PREMTOLI            TO CF-ST-TOL-PREM.
  3785
  3786     IF REFTOLL NOT = ZEROS
  3787         MOVE REFTOLI             TO CF-ST-TOL-REFUND.
  3788
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  74
* EL106.cbl
  3789     IF OVSAMTL > 0
  3790         MOVE OVSAMTI TO CF-ST-OVR-SHT-AMT
  3791     END-IF.
  3792
  3793     IF PRMPCTL NOT = ZEROS
  3794         MOVE WS-ST-TOL-PREM-PCT  TO CF-ST-TOL-PREM-PCT.
  3795
  3796     IF REFPCTL NOT = ZEROS
  3797         MOVE  WS-ST-TOL-REF-PCT  TO CF-ST-TOL-REF-PCT.
  3798
  3799     IF OVSPCTL > +0
  3800         MOVE WS-ST-OVR-SHT-PCT TO CF-ST-OVR-SHT-PCT
  3801     END-IF.
  3802
  3803     IF CLREJECL NOT = ZEROS
  3804         MOVE CLREJECI            TO CF-ST-CLAIM-REJECT-SW.
  3805
  3806     IF ISSREJL NOT = ZEROS
  3807         MOVE ISSREJI             TO CF-ST-PREM-REJECT-SW.
  3808
  3809     IF REFREJL NOT = ZEROS
  3810         MOVE REFREJI             TO CF-ST-REF-REJECT-SW.
  3811
  3812     IF REFMINL NOT = ZEROS
  3813         MOVE REFMINI             TO CF-ST-REFUND-MIN.
  3814
  3815     IF REFDAY1L NOT = ZEROS
  3816         MOVE REFDAY1I            TO CF-ST-REFUND-DAYS-FIRST.
  3817
  3818     IF REFDAYSL NOT = ZEROS
  3819         MOVE REFDAYSI            TO CF-ST-REFUND-DAYS-SUBSEQ.
  3820
  3821     IF SPLPMTL NOT = ZEROS
  3822         MOVE SPLPMTI             TO CF-ST-SPLIT-PAYMENT.
  3823
  3824     IF EXTDAYSL NOT = ZEROS
  3825         MOVE EXTDAYSI            TO CF-ST-FST-PMT-DAYS-MAX.
  3826
  3827*    IF INTDAYSL NOT = ZEROS
  3828*        MOVE INTDAYSI            TO CF-ST-NO-DAYS-ELAPSED.
  3829
  3830     IF EXTCHGL NOT = ZEROS
  3831         MOVE EXTCHGI             TO CF-ST-FST-PMT-DAYS-CHG.
  3832
  3833     IF REMTERML NOT = ZEROS
  3834        MOVE REMTERMI             TO CF-ST-RT-CALC
  3835     END-IF
  3836
  3837     IF LFREDL NOT = ZEROS
  3838        MOVE LFREDI               TO CF-ST-RF-LR-CALC
  3839     END-IF
  3840
  3841     IF LFLEVL NOT = ZEROS
  3842        MOVE LFLEVI               TO CF-ST-RF-LL-CALC
  3843     END-IF
  3844
  3845     IF LFNETL NOT = ZEROS
  3846        MOVE LFNETI               TO CF-ST-RF-LN-CALC
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  75
* EL106.cbl
  3847     END-IF
  3848
  3849     IF AHAHL NOT = ZEROS
  3850        MOVE AHAHI                TO CF-ST-RF-AH-CALC
  3851     END-IF
  3852
  3853     IF AHCPL NOT = ZEROS
  3854        MOVE AHCPI                TO CF-ST-RF-CP-CALC
  3855     END-IF
  3856
  3857     IF LFTAXL > +0
  3858        MOVE WS-ST-LF-PREM-TAX   TO CF-ST-LF-PREM-TAX
  3859     END-IF
  3860
  3861     IF AHITAXL > +0
  3862        MOVE WS-ST-AH-PREM-TAX-I TO CF-ST-AH-PREM-TAX-I
  3863     END-IF
  3864
  3865     IF AHGTAXL > +0
  3866        MOVE WS-ST-AH-PREM-TAX-G TO CF-ST-AH-PREM-TAX-G
  3867     END-IF
  3868
  3869     IF REFCLML NOT = ZEROS
  3870         MOVE REFCLMI             TO CF-ST-REF-AH-DEATH-IND
  3871     END-IF.
  3872
  3873     IF VFYBENEL NOT = ZEROS
  3874         MOVE VFYBENEI            TO CF-ST-VFY-2ND-BENE
  3875     END-IF.
  3876
  3877     IF CAUSALL NOT = ZEROS
  3878         MOVE CAUSALI             TO CF-ST-CAUSAL-STATE
  3879     END-IF.
  3880
  3881     IF STUEL NOT = ZEROS
  3882         MOVE STUEI               TO CF-ST-CALL-UNEARNED.
  3883
  3884     IF STCNTLL NOT = ZEROS
  3885         MOVE STCNTLI            TO CF-ST-CALL-RPT-CNTL.
  3886
  3887     IF STDEVL NOT = ZEROS
  3888         MOVE STDEVI             TO CF-ST-CALL-RATE-DEV.
  3889
  3890     MOVE REPLAWI                TO CF-REPLACEMENT-LAW-SW.
  3891     MOVE REPLETRI               TO CF-REPLACEMENT-LETTER.
  3892
  3893     MOVE LIMITI                 TO CF-COMM-CAP-LIMIT-TO.
  3894
  3895*    MOVE STATII                 TO CF-ST-STAT-DATE-FROM.
  3896
  3897     IF WS-COMSL NUMERIC AND
  3898        WS-COMSL NOT = ZEROS
  3899         MOVE WS-COMSL           TO CF-ST-COMM-CAP-SL
  3900      ELSE
  3901         MOVE ZEROS              TO CF-ST-COMM-CAP-SL.
  3902
  3903     IF WS-COMJL NUMERIC AND
  3904        WS-COMJL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  76
* EL106.cbl
  3905         MOVE WS-COMJL           TO CF-ST-COMM-CAP-JL
  3906      ELSE
  3907         MOVE ZEROS              TO CF-ST-COMM-CAP-JL.
  3908
  3909     IF WS-COMSA NUMERIC AND
  3910        WS-COMSA NOT = ZEROS
  3911         MOVE WS-COMSA           TO CF-ST-COMM-CAP-SA
  3912      ELSE
  3913         MOVE ZEROS              TO CF-ST-COMM-CAP-SA.
  3914
  3915     IF WS-COMJA NUMERIC AND
  3916        WS-COMJA NOT = ZEROS
  3917         MOVE WS-COMJA           TO CF-ST-COMM-CAP-JA
  3918      ELSE
  3919         MOVE ZEROS              TO CF-ST-COMM-CAP-JA.
  3920
  3921     IF WS-IRATE NUMERIC AND
  3922        WS-IRATE NOT = ZEROS
  3923         MOVE WS-IRATE           TO CF-ST-STAT-INTEREST
  3924      ELSE
  3925         MOVE ZEROS              TO CF-ST-STAT-INTEREST.
  3926
  3927     IF WS-IRATE1 NUMERIC AND
  3928        WS-IRATE1 NOT = ZEROS
  3929         MOVE WS-IRATE1          TO CF-ST-STAT-INTEREST-1
  3930      ELSE
  3931         MOVE ZEROS              TO CF-ST-STAT-INTEREST-1.
  3932
  3933     IF WS-IRATE2 NUMERIC AND
  3934        WS-IRATE2 NOT = ZEROS
  3935         MOVE WS-IRATE2          TO CF-ST-STAT-INTEREST-2
  3936      ELSE
  3937         MOVE ZEROS              TO CF-ST-STAT-INTEREST-2.
  3938
  3939     IF WS-IRATE3 NUMERIC AND
  3940        WS-IRATE3 NOT = ZEROS
  3941         MOVE WS-IRATE3          TO CF-ST-STAT-INTEREST-3
  3942      ELSE
  3943         MOVE ZEROS              TO CF-ST-STAT-INTEREST-3.
  3944
  3945     IF WS-RESIDENT-TAX NUMERIC AND
  3946        WS-RESIDENT-TAX NOT = ZEROS
  3947         MOVE WS-RESIDENT-TAX    TO CF-ST-RES-TAX-PCT
  3948      ELSE
  3949         MOVE ZEROS              TO CF-ST-RES-TAX-PCT.
  3950
  3951     IF WS-FREE-LOOK-DAYS NUMERIC
  3952             AND
  3953        WS-FREE-LOOK-DAYS NOT EQUAL ZEROS
  3954         MOVE WS-FREE-LOOK-DAYS  TO CF-ST-FREE-LOOK-PERIOD
  3955      ELSE
  3956         MOVE ZEROS              TO CF-ST-FREE-LOOK-PERIOD.
  3957
  3958     IF  WS-ST-TARGET-LOSS-RATIO NUMERIC
  3959             AND
  3960         WS-ST-TARGET-LOSS-RATIO NOT EQUAL ZEROS
  3961         MOVE WS-ST-TARGET-LOSS-RATIO
  3962                                 TO CF-ST-TARGET-LOSS-RATIO
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  77
* EL106.cbl
  3963     ELSE
  3964         MOVE ZEROS              TO CF-ST-TARGET-LOSS-RATIO.
  3965
  3966     IF  WS-ST-CALC-INTEREST NUMERIC
  3967             AND
  3968         WS-ST-CALC-INTEREST NOT EQUAL ZEROS
  3969         MOVE WS-ST-CALC-INTEREST
  3970                                 TO CF-ST-CALC-INTEREST
  3971     ELSE
  3972         MOVE ZEROS              TO CF-ST-CALC-INTEREST.
  3973
  3974     MOVE 'C'                    TO JP-RECORD-TYPE.
  3975     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  3976
  3977* EXEC CICS REWRITE
  3978*        DATASET(ELCNTL-ID)
  3979*        FROM   (CONTROL-FILE)
  3980*    END-EXEC.
  3981     MOVE LENGTH OF
  3982      CONTROL-FILE
  3983       TO DFHEIV11
  3984*    MOVE '&& L                  %   #00003813' TO DFHEIV0
  3985     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3986     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3987     MOVE X'2020233030303033383133' TO DFHEIV0(25:11)
  3988     CALL 'kxdfhei1' USING DFHEIV0,
  3989           ELCNTL-ID,
  3990           CONTROL-FILE,
  3991           DFHEIV11,
  3992           DFHEIV99
  3993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3994
  3995
  3996     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  3997     MOVE ER-0000 TO EMI-ERROR.
  3998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3999     MOVE LOW-VALUES  TO EL106AO.
  4000     MOVE -1          TO MAINTL.
  4001     MOVE SPACES      TO PI-PREV-STATE.
  4002     MOVE CK-STATE-CD TO STCDO.
  4003     MOVE AL-UANON    TO STCDA.
  4004     GO TO 1000-SHOW-STATE.
  4005
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  78
* EL106.cbl
  4007 3000-ADD-STATE.
  4008     PERFORM 6000-EDIT-INPUT-DATA THRU 6099-EXIT.
  4009
  4010     IF NOT EMI-NO-ERRORS
  4011         GO TO 8200-SEND-DATAONLY.
  4012
  4013
  4014* EXEC CICS GETMAIN
  4015*        SET    (ADDRESS OF CONTROL-FILE)
  4016*        LENGTH (750)
  4017*        INITIMG(GETMAIN-SPACE)
  4018*    END-EXEC.
  4019     MOVE 750
  4020       TO DFHEIV11
  4021*    MOVE ',"IL                  $   #00003835' TO DFHEIV0
  4022     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4023     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4024     MOVE X'2020233030303033383335' TO DFHEIV0(25:11)
  4025     CALL 'kxdfhei1' USING DFHEIV0,
  4026           DFHEIV20,
  4027           DFHEIV11,
  4028           GETMAIN-SPACE
  4029     SET ADDRESS OF CONTROL-FILE TO
  4030         DFHEIV20
  4031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4032
  4033
  4034     MOVE 'CF'          TO CF-RECORD-ID.
  4035     MOVE PI-COMPANY-ID TO CF-COMPANY-ID.
  4036     MOVE '3'           TO CF-RECORD-TYPE.
  4037     MOVE STCDI         TO CF-ACCESS-OF-STATE.
  4038     MOVE +0            TO CF-SEQUENCE-NO.
  4039
  4040     MOVE EIBDATE       TO DC-JULIAN-YYDDD.
  4041     MOVE '5'           TO DC-OPTION-CODE.
  4042     MOVE LINK-ELDATCV  TO PGM-NAME.
  4043
  4044* EXEC CICS LINK
  4045*        PROGRAM (PGM-NAME)
  4046*        COMMAREA(DATE-CONVERSION-DATA)
  4047*        LENGTH  (DC-COMM-LENGTH)
  4048*    END-EXEC.
  4049*    MOVE '."C                   (   #00003850' TO DFHEIV0
  4050     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4051     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4052     MOVE X'2020233030303033383530' TO DFHEIV0(25:11)
  4053     CALL 'kxdfhei1' USING DFHEIV0,
  4054           PGM-NAME,
  4055           DATE-CONVERSION-DATA,
  4056           DC-COMM-LENGTH,
  4057           DFHEIV99,
  4058           DFHEIV99,
  4059           DFHEIV99,
  4060           DFHEIV99
  4061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4062
  4063
  4064     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  79
* EL106.cbl
  4065         MOVE LOW-VALUES    TO CF-LAST-MAINT-DT
  4066       ELSE
  4067         MOVE DC-BIN-DATE-1 TO CF-LAST-MAINT-DT.
  4068
  4069     MOVE PI-PROCESSOR-ID   TO CF-LAST-MAINT-BY.
  4070     MOVE EIBTIME           TO CF-LAST-MAINT-HHMMSS.
  4071
  4072     MOVE STNAMEI           TO CF-STATE-NAME.
  4073     MOVE STABRI            TO CF-STATE-ABBREVIATION.
  4074
  4075     IF LFEXPL = ZEROS
  4076         MOVE ZEROS               TO CF-ST-LF-EXP-PCT
  4077       ELSE
  4078         MOVE WS-ST-LF-EXP-PCT    TO CF-ST-LF-EXP-PCT.
  4079
  4080     IF AHEXPL = ZEROS
  4081         MOVE ZEROS               TO CF-ST-AH-EXP-PCT
  4082       ELSE
  4083         MOVE WS-ST-AH-EXP-PCT    TO CF-ST-AH-EXP-PCT.
  4084
  4085     IF QUOTCALL = ZEROS
  4086         MOVE ZEROS               TO CF-ST-TOL-CLAIM
  4087       ELSE
  4088         MOVE QUOTCALI            TO CF-ST-TOL-CLAIM.
  4089
  4090     IF PREMTOLL = ZEROS
  4091         MOVE ZEROS               TO CF-ST-TOL-PREM
  4092       ELSE
  4093         MOVE PREMTOLI            TO CF-ST-TOL-PREM.
  4094
  4095     IF OVSAMTL = ZEROS
  4096         MOVE ZEROS              TO CF-ST-OVR-SHT-AMT
  4097       ELSE
  4098         MOVE OVSAMTI            TO CF-ST-OVR-SHT-AMT.
  4099
  4100     IF REFTOLL = ZEROS
  4101         MOVE ZEROS              TO CF-ST-TOL-REFUND
  4102       ELSE
  4103         MOVE REFTOLI            TO CF-ST-TOL-REFUND.
  4104
  4105     IF PRMPCTL = ZEROS
  4106         MOVE ZEROS              TO CF-ST-TOL-PREM-PCT
  4107       ELSE
  4108         MOVE WS-ST-TOL-PREM-PCT TO CF-ST-TOL-PREM-PCT.
  4109
  4110     IF OVSPCTL = ZEROS
  4111         MOVE ZEROS              TO CF-ST-OVR-SHT-PCT
  4112       ELSE
  4113         MOVE WS-ST-OVR-SHT-PCT  TO CF-ST-OVR-SHT-PCT.
  4114
  4115     IF REFPCTL = ZEROS
  4116         MOVE ZEROS              TO CF-ST-TOL-REF-PCT
  4117       ELSE
  4118         MOVE WS-ST-TOL-REF-PCT  TO CF-ST-TOL-REF-PCT.
  4119
  4120     IF CLREJECL = ZEROS
  4121         MOVE SPACE              TO CF-ST-CLAIM-REJECT-SW
  4122       ELSE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  80
* EL106.cbl
  4123         MOVE CLREJECI           TO CF-ST-CLAIM-REJECT-SW.
  4124
  4125     IF ISSREJL = ZEROS
  4126         MOVE SPACE              TO CF-ST-PREM-REJECT-SW
  4127       ELSE
  4128         MOVE ISSREJI            TO CF-ST-PREM-REJECT-SW.
  4129
  4130     IF REFREJL = ZEROS
  4131         MOVE SPACE              TO CF-ST-REF-REJECT-SW
  4132       ELSE
  4133         MOVE REFREJI            TO CF-ST-REF-REJECT-SW.
  4134
  4135     IF REFMINL = ZEROS
  4136         MOVE ZEROS              TO CF-ST-REFUND-MIN
  4137       ELSE
  4138         MOVE REFMINI            TO CF-ST-REFUND-MIN.
  4139
  4140     IF REFDAY1L  = ZERO
  4141         MOVE ZEROS              TO CF-ST-REFUND-DAYS-FIRST
  4142       ELSE
  4143         MOVE REFDAY1I           TO CF-ST-REFUND-DAYS-FIRST.
  4144
  4145     IF REFDAYSL = ZERO
  4146         MOVE ZEROS              TO CF-ST-REFUND-DAYS-SUBSEQ
  4147       ELSE
  4148         MOVE REFDAYSI           TO CF-ST-REFUND-DAYS-SUBSEQ.
  4149
  4150     IF SPLPMTL = ZERO
  4151         MOVE 'N'                TO CF-ST-SPLIT-PAYMENT
  4152     ELSE
  4153         MOVE SPLPMTI            TO CF-ST-SPLIT-PAYMENT.
  4154
  4155     IF EXTDAYSL = ZERO
  4156         MOVE ZEROS              TO CF-ST-FST-PMT-DAYS-MAX
  4157       ELSE
  4158         MOVE EXTDAYSI           TO CF-ST-FST-PMT-DAYS-MAX.
  4159
  4160*    IF INTDAYSL = ZERO
  4161*        MOVE ZEROS              TO CF-ST-NO-DAYS-ELAPSED
  4162*      ELSE
  4163*        MOVE INTDAYSI           TO CF-ST-NO-DAYS-ELAPSED.
  4164
  4165     IF EXTCHGL = ZEROS
  4166         MOVE SPACES             TO CF-ST-FST-PMT-DAYS-CHG
  4167       ELSE
  4168         MOVE EXTCHGI            TO CF-ST-FST-PMT-DAYS-CHG.
  4169
  4170     IF REMTERML = ZEROS
  4171        MOVE SPACES              TO CF-ST-RT-CALC
  4172     ELSE
  4173        MOVE REMTERMI            TO CF-ST-RT-CALC
  4174     END-IF
  4175
  4176     IF LFTAXL = ZEROS
  4177        MOVE ZEROS               TO CF-ST-LF-PREM-TAX
  4178     ELSE
  4179        MOVE WS-ST-LF-PREM-TAX   TO CF-ST-LF-PREM-TAX
  4180     END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  81
* EL106.cbl
  4181
  4182     IF AHITAXL = ZEROS
  4183        MOVE ZEROS               TO CF-ST-AH-PREM-TAX-I
  4184     ELSE
  4185        MOVE WS-ST-AH-PREM-TAX-I TO CF-ST-AH-PREM-TAX-I
  4186     END-IF
  4187
  4188     IF AHGTAXL = ZEROS
  4189        MOVE ZEROS               TO CF-ST-AH-PREM-TAX-G
  4190     ELSE
  4191        MOVE WS-ST-AH-PREM-TAX-G TO CF-ST-AH-PREM-TAX-G
  4192     END-IF
  4193
  4194     IF STUEL = ZEROS
  4195         MOVE SPACES             TO CF-ST-CALL-UNEARNED
  4196       ELSE
  4197         MOVE STUEI              TO CF-ST-CALL-UNEARNED.
  4198
  4199     IF STCNTLL = ZEROS
  4200         MOVE SPACES             TO CF-ST-CALL-RPT-CNTL
  4201       ELSE
  4202         MOVE STCNTLI            TO CF-ST-CALL-RPT-CNTL.
  4203
  4204     IF STDEVL = ZEROS
  4205         MOVE SPACES             TO CF-ST-CALL-RATE-DEV
  4206       ELSE
  4207         MOVE STDEVI             TO CF-ST-CALL-RATE-DEV.
  4208
  4209     IF  WS-ST-TARGET-LOSS-RATIO NUMERIC
  4210             AND
  4211         WS-ST-TARGET-LOSS-RATIO NOT EQUAL ZEROS
  4212         MOVE WS-ST-TARGET-LOSS-RATIO
  4213                                 TO CF-ST-TARGET-LOSS-RATIO
  4214     ELSE
  4215         MOVE ZEROS              TO CF-ST-TARGET-LOSS-RATIO.
  4216
  4217     IF  WS-ST-CALC-INTEREST NUMERIC
  4218             AND
  4219         WS-ST-CALC-INTEREST NOT EQUAL ZEROS
  4220         MOVE WS-ST-CALC-INTEREST
  4221                                 TO CF-ST-CALC-INTEREST
  4222     ELSE
  4223         MOVE ZEROS              TO CF-ST-CALC-INTEREST.
  4224
  4225     MOVE REPLAWI                TO CF-REPLACEMENT-LAW-SW.
  4226     MOVE REPLETRI               TO CF-REPLACEMENT-LETTER.
  4227
  4228     MOVE LIMITI                 TO CF-COMM-CAP-LIMIT-TO.
  4229
  4230*    MOVE STATII                 TO CF-ST-STAT-DATE-FROM.
  4231
  4232     IF COMSLL = ZEROS
  4233         MOVE ZEROS              TO CF-ST-COMM-CAP-SL
  4234       ELSE
  4235         MOVE WS-COMSL           TO CF-ST-COMM-CAP-SL.
  4236
  4237     IF COMJLL = ZEROS
  4238         MOVE ZEROS              TO CF-ST-COMM-CAP-JL
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  82
* EL106.cbl
  4239       ELSE
  4240         MOVE WS-COMJL           TO CF-ST-COMM-CAP-JL.
  4241
  4242     IF COMSAL = ZEROS
  4243         MOVE ZEROS              TO CF-ST-COMM-CAP-SA
  4244       ELSE
  4245         MOVE WS-COMSA           TO CF-ST-COMM-CAP-SA.
  4246
  4247     IF COMJAL = ZEROS
  4248         MOVE ZEROS              TO CF-ST-COMM-CAP-JA
  4249       ELSE
  4250         MOVE WS-COMJA           TO CF-ST-COMM-CAP-JA.
  4251
  4252     IF RESTAXL = ZEROS
  4253         MOVE ZEROS              TO CF-ST-RES-TAX-PCT
  4254       ELSE
  4255         MOVE WS-RESIDENT-TAX    TO CF-ST-RES-TAX-PCT.
  4256
  4257     IF FREELKL = ZEROS
  4258         MOVE ZEROS              TO CF-ST-FREE-LOOK-PERIOD
  4259       ELSE
  4260         MOVE WS-FREE-LOOK-DAYS  TO CF-ST-FREE-LOOK-PERIOD.
  4261
  4262*    IF STATRL = ZEROS
  4263         MOVE ZEROS              TO CF-ST-STAT-INTEREST
  4264*      ELSE
  4265*        MOVE WS-IRATE           TO CF-ST-STAT-INTEREST.
  4266
  4267*    IF STATR1L = ZEROS
  4268         MOVE ZEROS              TO CF-ST-STAT-INTEREST-1
  4269*      ELSE
  4270*        MOVE WS-IRATE1          TO CF-ST-STAT-INTEREST-1.
  4271
  4272*    IF STATR2L = ZEROS
  4273         MOVE ZEROS              TO CF-ST-STAT-INTEREST-2
  4274*      ELSE
  4275*        MOVE WS-IRATE2          TO CF-ST-STAT-INTEREST-2.
  4276
  4277*    IF STATR3L = ZEROS
  4278         MOVE ZEROS              TO CF-ST-STAT-INTEREST-3
  4279*      ELSE
  4280*        MOVE WS-IRATE3          TO CF-ST-STAT-INTEREST-3.
  4281
  4282     PERFORM 6100-INITIALIZE-BENEFIT-CNTL THRU 6199-EXIT
  4283             VARYING SUB FROM +1 BY +1
  4284             UNTIL SUB GREATER THAN +50.
  4285
  4286     MOVE 'A'                    TO JP-RECORD-TYPE.
  4287     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4288
  4289
  4290* EXEC CICS WRITE
  4291*        FROM   (CONTROL-FILE)
  4292*        DATASET(ELCNTL-ID)
  4293*        RIDFLD (CF-CONTROL-PRIMARY)
  4294*    END-EXEC.
  4295     MOVE LENGTH OF
  4296      CONTROL-FILE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  83
* EL106.cbl
  4297       TO DFHEIV11
  4298*    MOVE '&$ L                  ''   #00004081' TO DFHEIV0
  4299     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4300     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4301     MOVE X'2020233030303034303831' TO DFHEIV0(25:11)
  4302     CALL 'kxdfhei1' USING DFHEIV0,
  4303           ELCNTL-ID,
  4304           CONTROL-FILE,
  4305           DFHEIV11,
  4306           CF-CONTROL-PRIMARY,
  4307           DFHEIV99,
  4308           DFHEIV99
  4309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4310
  4311
  4312     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  4313     MOVE ER-0000 TO EMI-ERROR.
  4314     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4315     MOVE LOW-VALUES  TO EL106AO.
  4316     MOVE -1          TO MAINTL.
  4317     MOVE SPACES      TO PI-PREV-STATE.
  4318     MOVE CK-STATE-CD TO STCDO.
  4319     MOVE AL-UANON    TO STCDA.
  4320     GO TO 8100-SEND-INITIAL-MAP.
  4321
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  84
* EL106.cbl
  4323 4000-DELETE-STATE.
  4324     IF STCDI NOT = PI-PREV-STATE
  4325         MOVE ER-0145  TO EMI-ERROR
  4326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4327         MOVE -1       TO STCDL
  4328         MOVE AL-UABON TO STCDA
  4329         GO TO 8200-SEND-DATAONLY.
  4330
  4331     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  4332     MOVE STCDI         TO CK-STATE-CD.
  4333
  4334* EXEC CICS READ
  4335*        UPDATE
  4336*        DATASET(ELCNTL-ID)
  4337*        SET    (ADDRESS OF CONTROL-FILE)
  4338*        RIDFLD (ELCNTL-KEY)
  4339*    END-EXEC.
  4340*    MOVE '&"S        EU         (   #00004108' TO DFHEIV0
  4341     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4342     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4343     MOVE X'2020233030303034313038' TO DFHEIV0(25:11)
  4344     CALL 'kxdfhei1' USING DFHEIV0,
  4345           ELCNTL-ID,
  4346           DFHEIV20,
  4347           DFHEIV99,
  4348           ELCNTL-KEY,
  4349           DFHEIV99,
  4350           DFHEIV99,
  4351           DFHEIV99
  4352     SET ADDRESS OF CONTROL-FILE TO
  4353         DFHEIV20
  4354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4355
  4356
  4357     IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY    OR
  4358        CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
  4359
  4360* EXEC CICS UNLOCK
  4361*            DATASET(ELCNTL-ID)
  4362*        END-EXEC
  4363*    MOVE '&*                    #   #00004117' TO DFHEIV0
  4364     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4365     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4366     MOVE X'2020233030303034313137' TO DFHEIV0(25:11)
  4367     CALL 'kxdfhei1' USING DFHEIV0,
  4368           ELCNTL-ID,
  4369           DFHEIV99
  4370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4371         MOVE ER-0068 TO EMI-ERROR
  4372         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4373         GO TO 1000-SHOW-STATE.
  4374
  4375     MOVE 'D'                    TO JP-RECORD-TYPE.
  4376     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4377
  4378* EXEC CICS DELETE
  4379*        DATASET(ELCNTL-ID)
  4380*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  85
* EL106.cbl
  4381*    MOVE '&(                    &   #00004126' TO DFHEIV0
  4382     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4383     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4384     MOVE X'2020233030303034313236' TO DFHEIV0(25:11)
  4385     CALL 'kxdfhei1' USING DFHEIV0,
  4386           ELCNTL-ID,
  4387           DFHEIV99,
  4388           DFHEIV99,
  4389           DFHEIV99,
  4390           DFHEIV99
  4391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4392
  4393
  4394     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT
  4395     MOVE ER-0000 TO EMI-ERROR.
  4396     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4397     MOVE LOW-VALUES  TO EL106AO.
  4398     MOVE -1          TO MAINTL.
  4399     MOVE SPACES      TO PI-PREV-STATE
  4400     MOVE CK-STATE-CD TO STCDO.
  4401     MOVE AL-UANON    TO STCDA.
  4402     GO TO 8100-SEND-INITIAL-MAP.
  4403
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  86
* EL106.cbl
  4405 5000-FIND-NEXT-STATE.
  4406     MOVE PI-COMPANY-ID  TO CK-COMP-ID.
  4407
  4408     IF STCDL = 0
  4409         MOVE LOW-VALUES TO CK-STATE-CD
  4410         MOVE +0         TO CK-SEQ
  4411     ELSE
  4412         MOVE STCDI      TO CK-STATE-CD
  4413         MOVE +1         TO CK-SEQ.
  4414
  4415     MOVE SPACES TO PI-PREV-STATE.
  4416
  4417
  4418* EXEC CICS HANDLE CONDITION
  4419*        NOTFND (8860-ENDFILE)
  4420*    END-EXEC.
  4421*    MOVE '"$I                   ! % #00004153' TO DFHEIV0
  4422     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4424     MOVE X'2520233030303034313533' TO DFHEIV0(25:11)
  4425     CALL 'kxdfhei1' USING DFHEIV0
  4426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4427
  4428
  4429
  4430* EXEC CICS READ
  4431*        DATASET(ELCNTL-ID)
  4432*        SET    (ADDRESS OF CONTROL-FILE)
  4433*        RIDFLD (ELCNTL-KEY)
  4434*        GTEQ
  4435*    END-EXEC.
  4436*    MOVE '&"S        G          (   #00004157' TO DFHEIV0
  4437     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  4438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4439     MOVE X'2020233030303034313537' TO DFHEIV0(25:11)
  4440     CALL 'kxdfhei1' USING DFHEIV0,
  4441           ELCNTL-ID,
  4442           DFHEIV20,
  4443           DFHEIV99,
  4444           ELCNTL-KEY,
  4445           DFHEIV99,
  4446           DFHEIV99,
  4447           DFHEIV99
  4448     SET ADDRESS OF CONTROL-FILE TO
  4449         DFHEIV20
  4450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4451
  4452
  4453     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID  OR
  4454        CF-RECORD-TYPE NOT = '3'
  4455         GO TO 8860-ENDFILE.
  4456
  4457     IF STCDL = 0
  4458         MOVE ER-0146 TO EMI-ERROR
  4459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4460
  4461     GO TO 7000-BUILD-OUTPUT-MAP.
  4462
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  87
* EL106.cbl
  4464 5500-FIND-PREV-STATE.
  4465     MOVE PI-COMPANY-ID          TO  CK-COMP-ID.
  4466     MOVE PI-PREV-STATE          TO  CK-STATE-CD.
  4467
  4468     IF STCDL GREATER +0
  4469         MOVE STCDI              TO  CK-STATE-CD.
  4470
  4471     MOVE SPACES                 TO  PI-PREV-STATE.
  4472
  4473
  4474* EXEC CICS HANDLE CONDITION
  4475*        NOTFND(8860-ENDFILE)
  4476*    END-EXEC.
  4477*    MOVE '"$I                   ! & #00004184' TO DFHEIV0
  4478     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4480     MOVE X'2620233030303034313834' TO DFHEIV0(25:11)
  4481     CALL 'kxdfhei1' USING DFHEIV0
  4482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4483
  4484
  4485
  4486* EXEC CICS STARTBR
  4487*        DATASET  (ELCNTL-ID)
  4488*        RIDFLD   (ELCNTL-KEY)
  4489*    END-EXEC.
  4490     MOVE 0
  4491       TO DFHEIV11
  4492*    MOVE '&,         G          &   #00004188' TO DFHEIV0
  4493     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4494     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4495     MOVE X'2020233030303034313838' TO DFHEIV0(25:11)
  4496     CALL 'kxdfhei1' USING DFHEIV0,
  4497           ELCNTL-ID,
  4498           ELCNTL-KEY,
  4499           DFHEIV99,
  4500           DFHEIV11,
  4501           DFHEIV99
  4502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4503
  4504
  4505 5600-READ-PREV-STATE-RECORD.
  4506
  4507* EXEC CICS READPREV
  4508*        DATASET  (ELCNTL-ID)
  4509*        SET      (ADDRESS OF CONTROL-FILE)
  4510*        RIDFLD   (ELCNTL-KEY)
  4511*    END-EXEC.
  4512     MOVE 0
  4513       TO DFHEIV11
  4514*    MOVE '&0S                   )   #00004194' TO DFHEIV0
  4515     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4516     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4517     MOVE X'2020233030303034313934' TO DFHEIV0(25:11)
  4518     CALL 'kxdfhei1' USING DFHEIV0,
  4519           ELCNTL-ID,
  4520           DFHEIV20,
  4521           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  88
* EL106.cbl
  4522           ELCNTL-KEY,
  4523           DFHEIV99,
  4524           DFHEIV11,
  4525           DFHEIV99,
  4526           DFHEIV99
  4527     SET ADDRESS OF CONTROL-FILE TO
  4528         DFHEIV20
  4529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4530
  4531
  4532     IF FIRST-TIME
  4533         MOVE 'N'                TO  WS-FIRST-TIME-SW
  4534         GO TO 5600-READ-PREV-STATE-RECORD.
  4535
  4536     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID  OR
  4537        CF-RECORD-TYPE NOT = '3'
  4538         GO TO 8860-ENDFILE.
  4539
  4540     IF STCDL = 0
  4541         MOVE ER-0146 TO EMI-ERROR
  4542         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4543
  4544     GO TO 7000-BUILD-OUTPUT-MAP.
  4545
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  89
* EL106.cbl
  4547 6000-EDIT-INPUT-DATA.
  4548     IF STABRL = ZEROS AND MAINTI = 'A'
  4549        MOVE -1  TO STABRL
  4550        MOVE ER-0152 TO EMI-ERROR
  4551        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4552
  4553     IF STNAMEL = ZEROS AND MAINTI = 'A'
  4554        MOVE -1   TO STNAMEL
  4555        MOVE ER-0153 TO EMI-ERROR
  4556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4557
  4558     IF LFEXPL NOT = ZEROS
  4559
  4560* EXEC CICS BIF
  4561*            DEEDIT
  4562*            FIELD (LFEXPI)
  4563*            LENGTH(7)
  4564*       END-EXEC
  4565     MOVE 7
  4566       TO DFHEIV11
  4567*    MOVE '@"L                   #   #00004227' TO DFHEIV0
  4568     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4569     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4570     MOVE X'2020233030303034323237' TO DFHEIV0(25:11)
  4571     CALL 'kxdfhei1' USING DFHEIV0,
  4572           LFEXPI,
  4573           DFHEIV11
  4574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4575      IF LFEXPI NUMERIC
  4576            MOVE AL-UNNON        TO LFEXPA
  4577            MOVE LFEXPI          TO WS-ST-LF-EXP-PCT
  4578        ELSE
  4579            MOVE ER-7531         TO EMI-ERROR
  4580            MOVE -1              TO LFEXPL
  4581            MOVE AL-UNBON        TO LFEXPA
  4582            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4583
  4584     IF AHEXPL NOT = ZEROS
  4585
  4586* EXEC CICS BIF
  4587*            DEEDIT
  4588*            FIELD (AHEXPI)
  4589*            LENGTH(7)
  4590*       END-EXEC
  4591     MOVE 7
  4592       TO DFHEIV11
  4593*    MOVE '@"L                   #   #00004242' TO DFHEIV0
  4594     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4595     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4596     MOVE X'2020233030303034323432' TO DFHEIV0(25:11)
  4597     CALL 'kxdfhei1' USING DFHEIV0,
  4598           AHEXPI,
  4599           DFHEIV11
  4600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4601      IF AHEXPI NUMERIC
  4602            MOVE AL-UNNON        TO AHEXPA
  4603            MOVE AHEXPI          TO WS-ST-AH-EXP-PCT
  4604        ELSE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  90
* EL106.cbl
  4605            MOVE ER-7531         TO EMI-ERROR
  4606            MOVE -1              TO AHEXPL
  4607            MOVE AL-UNBON        TO AHEXPA
  4608            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4609
  4610     IF QUOTCALL NOT = ZEROS
  4611
  4612* EXEC CICS BIF
  4613*            DEEDIT
  4614*            FIELD (QUOTCALI)
  4615*            LENGTH(6)
  4616*       END-EXEC
  4617     MOVE 6
  4618       TO DFHEIV11
  4619*    MOVE '@"L                   #   #00004257' TO DFHEIV0
  4620     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4621     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4622     MOVE X'2020233030303034323537' TO DFHEIV0(25:11)
  4623     CALL 'kxdfhei1' USING DFHEIV0,
  4624           QUOTCALI,
  4625           DFHEIV11
  4626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4627        IF QUOTCALI NOT NUMERIC
  4628           MOVE -1               TO QUOTCALL
  4629           MOVE AL-UNBON         TO QUOTCALA
  4630           MOVE ER-2009          TO EMI-ERROR
  4631           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4632        ELSE
  4633        IF QUOTCALI GREATER THAN 9999
  4634           MOVE -1               TO QUOTCALL
  4635           MOVE AL-UNBON         TO QUOTCALA
  4636           MOVE ER-2009          TO EMI-ERROR
  4637           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4638
  4639     IF OVSAMTL NOT = ZEROS
  4640
  4641* EXEC CICS BIF
  4642*            DEEDIT
  4643*            FIELD (OVSAMTI)
  4644*            LENGTH(6)
  4645*       END-EXEC
  4646     MOVE 6
  4647       TO DFHEIV11
  4648*    MOVE '@"L                   #   #00004275' TO DFHEIV0
  4649     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4650     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4651     MOVE X'2020233030303034323735' TO DFHEIV0(25:11)
  4652     CALL 'kxdfhei1' USING DFHEIV0,
  4653           OVSAMTI,
  4654           DFHEIV11
  4655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4656        IF OVSAMTI  NOT NUMERIC
  4657           MOVE -1               TO OVSAMTL
  4658           MOVE AL-UNBON         TO OVSAMTA
  4659           MOVE ER-2010          TO EMI-ERROR
  4660           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4661        ELSE
  4662        IF OVSAMTI  GREATER THAN 9999
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  91
* EL106.cbl
  4663           MOVE -1               TO OVSAMTL
  4664           MOVE AL-UNBON         TO OVSAMTA
  4665           MOVE ER-2010          TO EMI-ERROR
  4666           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4667
  4668     IF PREMTOLL NOT = ZEROS
  4669
  4670* EXEC CICS BIF
  4671*            DEEDIT
  4672*            FIELD (PREMTOLI)
  4673*            LENGTH(6)
  4674*       END-EXEC
  4675     MOVE 6
  4676       TO DFHEIV11
  4677*    MOVE '@"L                   #   #00004293' TO DFHEIV0
  4678     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4679     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4680     MOVE X'2020233030303034323933' TO DFHEIV0(25:11)
  4681     CALL 'kxdfhei1' USING DFHEIV0,
  4682           PREMTOLI,
  4683           DFHEIV11
  4684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4685        IF PREMTOLI NOT NUMERIC
  4686           MOVE -1               TO PREMTOLL
  4687           MOVE AL-UNBON         TO PREMTOLA
  4688           MOVE ER-2010          TO EMI-ERROR
  4689           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4690        ELSE
  4691        IF PREMTOLI GREATER THAN 9999
  4692           MOVE -1               TO PREMTOLL
  4693           MOVE AL-UNBON         TO PREMTOLA
  4694           MOVE ER-2010          TO EMI-ERROR
  4695           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4696
  4697     IF REFTOLL NOT = ZEROS
  4698
  4699* EXEC CICS BIF
  4700*            DEEDIT
  4701*            FIELD(REFTOLI)
  4702*            LENGTH(6)
  4703*       END-EXEC
  4704     MOVE 6
  4705       TO DFHEIV11
  4706*    MOVE '@"L                   #   #00004311' TO DFHEIV0
  4707     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4708     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4709     MOVE X'2020233030303034333131' TO DFHEIV0(25:11)
  4710     CALL 'kxdfhei1' USING DFHEIV0,
  4711           REFTOLI,
  4712           DFHEIV11
  4713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4714        IF REFTOLI NOT NUMERIC
  4715           MOVE -1               TO REFTOLL
  4716           MOVE AL-UNBON         TO REFTOLA
  4717           MOVE ER-2014          TO EMI-ERROR
  4718           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4719        ELSE
  4720        IF REFTOLI GREATER THAN 9999
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  92
* EL106.cbl
  4721           MOVE -1               TO REFTOLL
  4722           MOVE AL-UNBON         TO REFTOLA
  4723           MOVE ER-2014          TO EMI-ERROR
  4724           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4725
  4726     IF CLREJECL NOT = ZEROS
  4727        IF CLREJECI = SPACES OR '1'
  4728           NEXT SENTENCE
  4729          ELSE
  4730           MOVE -1               TO CLREJECL
  4731           MOVE AL-UABON         TO CLREJECA
  4732           MOVE ER-2024          TO EMI-ERROR
  4733           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4734
  4735     IF ISSREJL NOT = ZEROS
  4736        IF ISSREJI = SPACES OR '1'
  4737           NEXT SENTENCE
  4738          ELSE
  4739           MOVE -1               TO ISSREJL
  4740           MOVE AL-UABON         TO ISSREJA
  4741           MOVE ER-2012          TO EMI-ERROR
  4742           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4743
  4744     IF REFREJL NOT = ZEROS
  4745        IF REFREJI = SPACES OR '1'
  4746           NEXT SENTENCE
  4747          ELSE
  4748           MOVE -1               TO REFREJL
  4749           MOVE AL-UABON         TO REFREJA
  4750           MOVE ER-2028          TO EMI-ERROR
  4751           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4752
  4753     IF REFMINL NOT = ZEROS
  4754
  4755* EXEC CICS BIF
  4756*            DEEDIT
  4757*            FIELD (REFMINI)
  4758*            LENGTH(6)
  4759*       END-EXEC
  4760     MOVE 6
  4761       TO DFHEIV11
  4762*    MOVE '@"L                   #   #00004356' TO DFHEIV0
  4763     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4764     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4765     MOVE X'2020233030303034333536' TO DFHEIV0(25:11)
  4766     CALL 'kxdfhei1' USING DFHEIV0,
  4767           REFMINI,
  4768           DFHEIV11
  4769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4770        IF REFMINI NOT NUMERIC
  4771           MOVE -1               TO REFMINL
  4772           MOVE AL-UNBON         TO REFMINA
  4773           MOVE ER-3030          TO EMI-ERROR
  4774           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4775
  4776     IF REFDAY1L NOT = ZERO
  4777        IF REFDAY1I LESS '00' OR GREATER '31'
  4778            MOVE -1               TO REFDAY1L
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  93
* EL106.cbl
  4779            MOVE AL-UNBON         TO REFDAY1A
  4780            MOVE ER-3031          TO EMI-ERROR
  4781            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4782
  4783     IF REFDAYSL NOT = ZERO
  4784        IF REFDAYSI LESS '00' OR GREATER '31'
  4785            MOVE -1               TO REFDAYSL
  4786            MOVE AL-UNBON         TO REFDAYSA
  4787            MOVE ER-3031          TO EMI-ERROR
  4788            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4789
  4790     IF SPLPMTL NOT = ZERO
  4791        IF (SPLPMTI IS EQUAL TO 'Y' OR 'N' OR ' ')
  4792            NEXT SENTENCE
  4793        ELSE
  4794            MOVE -1               TO SPLPMTL
  4795            MOVE AL-UABON         TO SPLPMTA
  4796            MOVE ER-0805          TO EMI-ERROR
  4797            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4798
  4799     IF EXTDAYSL NOT = ZERO
  4800        IF EXTDAYSI NOT NUMERIC
  4801            MOVE -1               TO EXTDAYSL
  4802            MOVE AL-UNBON         TO EXTDAYSA
  4803            MOVE ER-3032          TO EMI-ERROR
  4804            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4805
  4806*    IF INTDAYSL NOT = ZERO
  4807*       IF INTDAYSI NOT NUMERIC
  4808*           MOVE -1               TO INTDAYSL
  4809*           MOVE AL-UNBON         TO INTDAYSA
  4810*           MOVE ER-0141          TO EMI-ERROR
  4811*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4812
  4813     IF EXTCHGL NOT = ZEROS
  4814        IF EXTCHGI = SPACES OR '1' OR '2' OR '3'
  4815           NEXT SENTENCE
  4816          ELSE
  4817           MOVE -1               TO EXTCHGL
  4818           MOVE AL-UABON         TO EXTCHGA
  4819           MOVE ER-3033          TO EMI-ERROR
  4820           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4821
  4822     IF REMTERML NOT = ZEROS
  4823        IF (REMTERMI = ' ') OR
  4824           (REMTERMI > '0' AND < '8')
  4825           CONTINUE
  4826        ELSE
  4827           MOVE -1               TO REMTERML
  4828           MOVE AL-UABON         TO REMTERMA
  4829           MOVE ER-2298          TO EMI-ERROR
  4830           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4831        END-IF
  4832     END-IF
  4833
  4834     IF LFREDL NOT = ZEROS
  4835        IF LFREDI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4836                 OR '6' OR '8' OR '9'
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  94
* EL106.cbl
  4837           CONTINUE
  4838        ELSE
  4839           MOVE -1               TO LFREDL
  4840           MOVE AL-UABON         TO LFREDA
  4841           MOVE ER-0582          TO EMI-ERROR
  4842           PERFORM 9900-ERROR-FORMAT
  4843                                 THRU 9900-EXIT
  4844        END-IF
  4845     END-IF
  4846
  4847     IF LFLEVL NOT = ZEROS
  4848        IF LFLEVI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4849                 OR '6' OR '8' OR '9'
  4850           CONTINUE
  4851        ELSE
  4852           MOVE -1               TO LFLEVL
  4853           MOVE AL-UABON         TO LFLEVA
  4854           MOVE ER-0582          TO EMI-ERROR
  4855           PERFORM 9900-ERROR-FORMAT
  4856                                 THRU 9900-EXIT
  4857        END-IF
  4858     END-IF
  4859
  4860     IF LFNETL NOT = ZEROS
  4861        IF LFNETI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4862                 OR '6' OR '8' OR '9'
  4863           CONTINUE
  4864        ELSE
  4865           MOVE -1               TO LFNETL
  4866           MOVE AL-UABON         TO LFNETA
  4867           MOVE ER-0582          TO EMI-ERROR
  4868           PERFORM 9900-ERROR-FORMAT
  4869                                 THRU 9900-EXIT
  4870        END-IF
  4871     END-IF
  4872
  4873     IF AHAHL  NOT = ZEROS
  4874        IF AHAHI  = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4875                 OR '6' OR '8' OR '9'
  4876           CONTINUE
  4877        ELSE
  4878           MOVE -1               TO AHAHL
  4879           MOVE AL-UABON         TO AHAHA
  4880           MOVE ER-0582          TO EMI-ERROR
  4881           PERFORM 9900-ERROR-FORMAT
  4882                                 THRU 9900-EXIT
  4883        END-IF
  4884     END-IF
  4885
  4886     IF AHCPL  NOT = ZEROS
  4887        IF AHCPI  = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4888                 OR '6' OR '8' OR '9'
  4889           CONTINUE
  4890        ELSE
  4891           MOVE -1               TO AHCPL
  4892           MOVE AL-UABON         TO AHCPA
  4893           MOVE ER-0582          TO EMI-ERROR
  4894           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  95
* EL106.cbl
  4895                                 THRU 9900-EXIT
  4896        END-IF
  4897     END-IF
  4898
  4899     IF STUEL NOT = ZEROS
  4900        IF STUEI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4901           NEXT SENTENCE
  4902          ELSE
  4903           MOVE -1               TO STUEL
  4904           MOVE AL-UABON         TO STUEA
  4905           MOVE ER-3034          TO EMI-ERROR
  4906           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4907
  4908     IF STCNTLL NOT = ZEROS
  4909        IF STCNTLI = SPACES
  4910           NEXT SENTENCE
  4911        ELSE
  4912           IF STCNTLI = '1' OR '2' OR '3' OR '4' OR
  4913                        '5' OR '6' OR '7' OR '8' OR
  4914                        '9' OR 'A' OR 'B' OR 'X'
  4915              NEXT SENTENCE
  4916           ELSE
  4917              MOVE -1               TO STCNTLL
  4918              MOVE AL-UABON         TO STCNTLA
  4919              MOVE ER-3035          TO EMI-ERROR
  4920              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4921
  4922     IF  REPLAWL GREATER THAN ZEROS
  4923         IF  REPLAWI = 'Y'
  4924             MOVE REPLAWI        TO REPLAWO
  4925             MOVE AL-UANON       TO REPLAWA
  4926         ELSE
  4927             IF  REPLAWI = 'N' OR SPACES OR LOW-VALUES
  4928                 MOVE 'N'        TO REPLAWO
  4929                 MOVE AL-UANON   TO REPLAWA
  4930             ELSE
  4931                 MOVE ER-9074    TO EMI-ERROR
  4932                 MOVE -1         TO REPLAWL
  4933                 MOVE AL-UABON   TO REPLAWA
  4934                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4935
  4936     IF  REPLETRL GREATER THAN +0
  4937         IF  REPLAWI = 'Y'
  4938             IF  REPLETRI GREATER THAN SPACES
  4939                 MOVE SPACES     TO W-WORKING-TEXT-KEY
  4940                 MOVE PI-COMPANY-CD
  4941                                 TO W-TEXT-COMPANY-CD
  4942                 MOVE REPLETRI   TO W-TEXT-FORM-NO
  4943                 MOVE +1         TO W-TEXT-LINE-SEQ
  4944
  4945* EXEC CICS HANDLE CONDITION
  4946*                    NOTFND   (6010-LETR-NOT-FOUND)
  4947*                    ENDFILE  (6010-LETR-NOT-FOUND)
  4948*                    NOTOPEN  (8890-LETR-NOT-OPEN)
  4949*                END-EXEC
  4950*    MOVE '"$I''J                 ! '' #00004535' TO DFHEIV0
  4951     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  4952     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  96
* EL106.cbl
  4953     MOVE X'2720233030303034353335' TO DFHEIV0(25:11)
  4954     CALL 'kxdfhei1' USING DFHEIV0
  4955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4956
  4957* EXEC CICS READ
  4958*                    SET     (ADDRESS OF TEXT-FILES)
  4959*                    DATASET (ELLETR-ID)
  4960*                    RIDFLD  (W-WORKING-TEXT-KEY)
  4961*                END-EXEC
  4962*    MOVE '&"S        E          (   #00004540' TO DFHEIV0
  4963     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4964     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4965     MOVE X'2020233030303034353430' TO DFHEIV0(25:11)
  4966     CALL 'kxdfhei1' USING DFHEIV0,
  4967           ELLETR-ID,
  4968           DFHEIV20,
  4969           DFHEIV99,
  4970           W-WORKING-TEXT-KEY,
  4971           DFHEIV99,
  4972           DFHEIV99,
  4973           DFHEIV99
  4974     SET ADDRESS OF TEXT-FILES TO
  4975         DFHEIV20
  4976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4977                 MOVE AL-UANON   TO REPLETRA
  4978             ELSE
  4979                 MOVE ER-9448    TO EMI-ERROR
  4980                 MOVE -1         TO REPLETRL
  4981                 MOVE AL-UABON   TO REPLETRA
  4982                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4983         ELSE
  4984             IF  REPLETRI EQUAL SPACES OR LOW-VALUES
  4985                 MOVE LOW-VALUES TO REPLETRO
  4986                 MOVE AL-UANON   TO REPLETRA
  4987             ELSE
  4988                 MOVE ER-9478    TO EMI-ERROR
  4989                 MOVE -1         TO REPLAWL
  4990                 MOVE AL-UABON   TO REPLAWA
  4991                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4992     ELSE
  4993         IF  REPLAWI = 'Y'
  4994             MOVE ER-9448        TO EMI-ERROR
  4995             MOVE -1             TO REPLETRL
  4996             MOVE AL-UABON       TO REPLETRA
  4997             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4998
  4999     IF LIMITL GREATER ZEROS
  5000         IF LIMITI = 'A'
  5001             MOVE LIMITI         TO LIMITO
  5002             MOVE AL-UANON       TO LIMITA
  5003          ELSE
  5004             IF LIMITI = SPACES OR LOW-VALUES
  5005                 MOVE ' '        TO LIMITO
  5006                 MOVE AL-UANON   TO LIMITA
  5007         ELSE
  5008             MOVE ER-2137    TO EMI-ERROR
  5009             MOVE -1         TO LIMITL
  5010             MOVE AL-UABON   TO LIMITA
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  97
* EL106.cbl
  5011             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5012
  5013*    IF STATIL GREATER ZEROS
  5014*        IF STATII = 'I' OR 'R'
  5015*            MOVE STATII         TO STATIO
  5016*            MOVE AL-UANON       TO STATIA
  5017*         ELSE
  5018*            IF STATII = SPACES OR LOW-VALUES
  5019*                MOVE ' '        TO STATIO
  5020*                MOVE AL-UANON   TO STATIA
  5021*        ELSE
  5022*            MOVE ER-7346    TO EMI-ERROR
  5023*            MOVE -1         TO STATIL
  5024*            MOVE AL-UABON   TO STATIA
  5025*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5026
  5027     IF COMSLL GREATER ZEROS
  5028
  5029* EXEC CICS BIF
  5030*            DEEDIT
  5031*            FIELD (COMSLI)
  5032*            LENGTH(6)
  5033*       END-EXEC
  5034     MOVE 6
  5035       TO DFHEIV11
  5036*    MOVE '@"L                   #   #00004596' TO DFHEIV0
  5037     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5038     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5039     MOVE X'2020233030303034353936' TO DFHEIV0(25:11)
  5040     CALL 'kxdfhei1' USING DFHEIV0,
  5041           COMSLI,
  5042           DFHEIV11
  5043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5044      IF COMSLI NUMERIC
  5045            MOVE AL-UNNON        TO COMSLA
  5046            MOVE COMSLI          TO WS-COMSL
  5047                                    COMSLO
  5048        ELSE
  5049            MOVE ER-1614         TO EMI-ERROR
  5050            MOVE -1              TO COMSLL
  5051            MOVE AL-UNBON        TO COMSLA
  5052            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5053
  5054     IF COMJLL GREATER ZEROS
  5055
  5056* EXEC CICS BIF
  5057*            DEEDIT
  5058*            FIELD (COMJLI)
  5059*            LENGTH(6)
  5060*       END-EXEC
  5061     MOVE 6
  5062       TO DFHEIV11
  5063*    MOVE '@"L                   #   #00004612' TO DFHEIV0
  5064     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5065     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5066     MOVE X'2020233030303034363132' TO DFHEIV0(25:11)
  5067     CALL 'kxdfhei1' USING DFHEIV0,
  5068           COMJLI,
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  98
* EL106.cbl
  5069           DFHEIV11
  5070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5071      IF COMJLI NUMERIC
  5072            MOVE AL-UNNON        TO COMJLA
  5073            MOVE COMJLI          TO WS-COMJL
  5074                                    COMJLO
  5075        ELSE
  5076            MOVE ER-1614         TO EMI-ERROR
  5077            MOVE -1              TO COMJLL
  5078            MOVE AL-UNBON        TO COMJLA
  5079            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5080
  5081     IF COMSAL GREATER ZEROS
  5082
  5083* EXEC CICS BIF
  5084*            DEEDIT
  5085*            FIELD (COMSAI)
  5086*            LENGTH(6)
  5087*       END-EXEC
  5088     MOVE 6
  5089       TO DFHEIV11
  5090*    MOVE '@"L                   #   #00004628' TO DFHEIV0
  5091     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5092     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5093     MOVE X'2020233030303034363238' TO DFHEIV0(25:11)
  5094     CALL 'kxdfhei1' USING DFHEIV0,
  5095           COMSAI,
  5096           DFHEIV11
  5097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5098      IF COMSAI NUMERIC
  5099            MOVE AL-UNNON        TO COMSAA
  5100            MOVE COMSAI          TO WS-COMSA
  5101                                    COMSAO
  5102        ELSE
  5103            MOVE ER-1614         TO EMI-ERROR
  5104            MOVE -1              TO COMSAL
  5105            MOVE AL-UNBON        TO COMSAA
  5106            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5107
  5108     IF COMJAL GREATER ZEROS
  5109
  5110* EXEC CICS BIF
  5111*            DEEDIT
  5112*            FIELD (COMJAI)
  5113*            LENGTH(6)
  5114*       END-EXEC
  5115     MOVE 6
  5116       TO DFHEIV11
  5117*    MOVE '@"L                   #   #00004644' TO DFHEIV0
  5118     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5119     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5120     MOVE X'2020233030303034363434' TO DFHEIV0(25:11)
  5121     CALL 'kxdfhei1' USING DFHEIV0,
  5122           COMJAI,
  5123           DFHEIV11
  5124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5125      IF COMJAI NUMERIC
  5126            MOVE AL-UNNON        TO COMJAA
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  99
* EL106.cbl
  5127            MOVE COMJAI          TO WS-COMJA
  5128                                    COMJAO
  5129        ELSE
  5130            MOVE ER-1614         TO EMI-ERROR
  5131            MOVE -1              TO COMJAL
  5132            MOVE AL-UNBON        TO COMJAA
  5133            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5134
  5135     IF RESTAXL GREATER ZEROS
  5136
  5137* EXEC CICS BIF
  5138*            DEEDIT
  5139*            FIELD (RESTAXI)
  5140*            LENGTH(6)
  5141*       END-EXEC
  5142     MOVE 6
  5143       TO DFHEIV11
  5144*    MOVE '@"L                   #   #00004660' TO DFHEIV0
  5145     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5146     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5147     MOVE X'2020233030303034363630' TO DFHEIV0(25:11)
  5148     CALL 'kxdfhei1' USING DFHEIV0,
  5149           RESTAXI,
  5150           DFHEIV11
  5151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5152      IF RESTAXI NUMERIC
  5153            MOVE AL-UNNON        TO RESTAXA
  5154            MOVE RESTAXI         TO WS-RESIDENT-TAX
  5155                                    RESTAXO
  5156        ELSE
  5157            MOVE ER-1614         TO EMI-ERROR
  5158            MOVE -1              TO RESTAXL
  5159            MOVE AL-UNBON        TO RESTAXA
  5160            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5161
  5162     IF FREELKI  NUMERIC
  5163            MOVE AL-UNNON        TO FREELKA
  5164            MOVE FREELKI         TO WS-FREE-LOOK-DAYS
  5165                                    FREELKO
  5166        ELSE
  5167            MOVE -1               TO FREELKL
  5168            MOVE AL-UNBON         TO FREELKA
  5169            MOVE ER-8159          TO EMI-ERROR
  5170            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5171
  5172*    IF STATRL GREATER ZEROS
  5173*       EXEC CICS BIF
  5174*            DEEDIT
  5175*            FIELD (STATRI)
  5176*            LENGTH(6)
  5177*       END-EXEC
  5178*     IF STATRI NUMERIC
  5179*           MOVE AL-UNNON        TO STATRA
  5180*           MOVE STATRI          TO WS-IRATE
  5181*                                   STATRO
  5182*       ELSE
  5183*           MOVE ER-1614         TO EMI-ERROR
  5184*           MOVE -1              TO STATRL
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 100
* EL106.cbl
  5185*           MOVE AL-UNBON        TO STATRA
  5186*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5187
  5188*    IF STATR1L GREATER ZEROS
  5189*       EXEC CICS BIF
  5190*            DEEDIT
  5191*            FIELD (STATR1I)
  5192*            LENGTH(6)
  5193*       END-EXEC
  5194*     IF STATR1I NUMERIC
  5195*           MOVE AL-UNNON        TO STATR1A
  5196*           MOVE STATR1I         TO WS-IRATE1
  5197*                                   STATR1O
  5198*       ELSE
  5199*           MOVE ER-1614         TO EMI-ERROR
  5200*           MOVE -1              TO STATR1L
  5201*           MOVE AL-UNBON        TO STATR1A
  5202*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5203*
  5204*    IF STATR2L GREATER ZEROS
  5205*       EXEC CICS BIF
  5206*            DEEDIT
  5207*            FIELD (STATR2I)
  5208*            LENGTH(6)
  5209*       END-EXEC
  5210*     IF STATR2I NUMERIC
  5211*           MOVE AL-UNNON        TO STATR2A
  5212*           MOVE STATR2I         TO WS-IRATE2
  5213*                                   STATR2O
  5214*       ELSE
  5215*           MOVE ER-1614         TO EMI-ERROR
  5216*           MOVE -1              TO STATR2L
  5217*           MOVE AL-UNBON        TO STATR2A
  5218*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5219*
  5220*    IF STATR3L GREATER ZEROS
  5221*       EXEC CICS BIF
  5222*            DEEDIT
  5223*            FIELD (STATR3I)
  5224*            LENGTH(6)
  5225*       END-EXEC
  5226*     IF STATR3I NUMERIC
  5227*           MOVE AL-UNNON        TO STATR3A
  5228*           MOVE STATR3I         TO WS-IRATE3
  5229*                                   STATR3O
  5230*       ELSE
  5231*           MOVE ER-1614         TO EMI-ERROR
  5232*           MOVE -1              TO STATR3L
  5233*           MOVE AL-UNBON        TO STATR3A
  5234*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5235
  5236     GO TO 6020-CONTINUE.
  5237
  5238 6010-LETR-NOT-FOUND.
  5239     MOVE ER-9447                TO EMI-ERROR.
  5240     MOVE -1                     TO REPLETRL.
  5241     MOVE AL-UABON               TO REPLETRA.
  5242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 101
* EL106.cbl
  5243
  5244 6020-CONTINUE.
  5245
  5246     IF  TARRATL NOT = ZEROS
  5247
  5248* EXEC CICS BIF
  5249*             DEEDIT
  5250*             FIELD (TARRATI)
  5251*             LENGTH (6)
  5252*        END-EXEC
  5253     MOVE 6
  5254       TO DFHEIV11
  5255*    MOVE '@"L                   #   #00004760' TO DFHEIV0
  5256     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5257     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5258     MOVE X'2020233030303034373630' TO DFHEIV0(25:11)
  5259     CALL 'kxdfhei1' USING DFHEIV0,
  5260           TARRATI,
  5261           DFHEIV11
  5262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5263
  5264         IF  TARRATI NUMERIC
  5265             MOVE AL-UNNON       TO TARRATA
  5266             MOVE TARRATI        TO WS-ST-TARGET-LOSS-RATIO
  5267                                    TARRATO
  5268         ELSE
  5269             MOVE ER-7717        TO EMI-ERROR
  5270             MOVE -1             TO TARRATL
  5271             MOVE AL-UNBON       TO TARRATA
  5272             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5273
  5274     IF  CALCINTL NOT = ZEROS
  5275
  5276* EXEC CICS BIF
  5277*             DEEDIT
  5278*             FIELD (CALCINTI)
  5279*             LENGTH (6)
  5280*        END-EXEC
  5281     MOVE 6
  5282       TO DFHEIV11
  5283*    MOVE '@"L                   #   #00004777' TO DFHEIV0
  5284     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5285     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5286     MOVE X'2020233030303034373737' TO DFHEIV0(25:11)
  5287     CALL 'kxdfhei1' USING DFHEIV0,
  5288           CALCINTI,
  5289           DFHEIV11
  5290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5291
  5292         IF  CALCINTI NUMERIC
  5293             MOVE AL-UNNON       TO CALCINTA
  5294             MOVE CALCINTI       TO WS-ST-CALC-INTEREST
  5295                                    CALCINTO
  5296         ELSE
  5297             MOVE ER-7735        TO EMI-ERROR
  5298             MOVE -1             TO CALCINTL
  5299             MOVE AL-UNBON       TO CALCINTA
  5300             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 102
* EL106.cbl
  5301
  5302     IF PRMPCTL NOT = ZEROS
  5303
  5304* EXEC CICS BIF
  5305*            DEEDIT
  5306*            FIELD (PRMPCTI)
  5307*            LENGTH(5)
  5308*       END-EXEC
  5309     MOVE 5
  5310       TO DFHEIV11
  5311*    MOVE '@"L                   #   #00004794' TO DFHEIV0
  5312     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5313     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5314     MOVE X'2020233030303034373934' TO DFHEIV0(25:11)
  5315     CALL 'kxdfhei1' USING DFHEIV0,
  5316           PRMPCTI,
  5317           DFHEIV11
  5318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5319      IF PRMPCTI NUMERIC
  5320            MOVE AL-UNNON        TO PRMPCTA
  5321            MOVE PRMPCTI         TO WS-ST-TOL-PREM-PCT
  5322        ELSE
  5323            MOVE ER-7532         TO EMI-ERROR
  5324            MOVE -1              TO PRMPCTL
  5325            MOVE AL-UNBON        TO PRMPCTA
  5326            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5327
  5328     IF OVSPCTL NOT = ZEROS
  5329
  5330* EXEC CICS BIF
  5331*            DEEDIT
  5332*            FIELD (OVSPCTI)
  5333*            LENGTH(5)
  5334*       END-EXEC
  5335     MOVE 5
  5336       TO DFHEIV11
  5337*    MOVE '@"L                   #   #00004809' TO DFHEIV0
  5338     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5339     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5340     MOVE X'2020233030303034383039' TO DFHEIV0(25:11)
  5341     CALL 'kxdfhei1' USING DFHEIV0,
  5342           OVSPCTI,
  5343           DFHEIV11
  5344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5345      IF OVSPCTI NUMERIC
  5346            MOVE AL-UNNON        TO OVSPCTA
  5347            MOVE OVSPCTI         TO WS-ST-OVR-SHT-PCT
  5348        ELSE
  5349            MOVE ER-7532         TO EMI-ERROR
  5350            MOVE -1              TO OVSPCTL
  5351            MOVE AL-UNBON        TO OVSPCTA
  5352            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5353
  5354     IF REFPCTL NOT = ZEROS
  5355
  5356* EXEC CICS BIF
  5357*            DEEDIT
  5358*            FIELD (REFPCTI)
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 103
* EL106.cbl
  5359*            LENGTH(5)
  5360*       END-EXEC
  5361     MOVE 5
  5362       TO DFHEIV11
  5363*    MOVE '@"L                   #   #00004824' TO DFHEIV0
  5364     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5365     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5366     MOVE X'2020233030303034383234' TO DFHEIV0(25:11)
  5367     CALL 'kxdfhei1' USING DFHEIV0,
  5368           REFPCTI,
  5369           DFHEIV11
  5370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5371      IF REFPCTI NUMERIC
  5372            MOVE AL-UNNON        TO REFPCTA
  5373            MOVE REFPCTI         TO WS-ST-TOL-REF-PCT
  5374        ELSE
  5375            MOVE ER-7532         TO EMI-ERROR
  5376            MOVE -1              TO REFPCTL
  5377            MOVE AL-UNBON        TO REFPCTA
  5378            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5379
  5380     IF LFTAXL NOT = ZEROS
  5381
  5382* EXEC CICS BIF
  5383*            DEEDIT
  5384*            FIELD (LFTAXI)
  5385*            LENGTH(5)
  5386*       END-EXEC
  5387     MOVE 5
  5388       TO DFHEIV11
  5389*    MOVE '@"L                   #   #00004839' TO DFHEIV0
  5390     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5391     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5392     MOVE X'2020233030303034383339' TO DFHEIV0(25:11)
  5393     CALL 'kxdfhei1' USING DFHEIV0,
  5394           LFTAXI,
  5395           DFHEIV11
  5396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5397        IF LFTAXI NUMERIC
  5398           MOVE AL-UNNON         TO LFTAXA
  5399           MOVE LFTAXI           TO WS-ST-LF-PREM-TAX
  5400        ELSE
  5401           MOVE ER-2082          TO EMI-ERROR
  5402           MOVE -1               TO LFTAXL
  5403           MOVE AL-UNBON         TO LFTAXA
  5404           PERFORM 9900-ERROR-FORMAT
  5405                                 THRU 9900-EXIT
  5406        END-IF
  5407     END-IF
  5408
  5409     IF AHITAXL NOT = ZEROS
  5410
  5411* EXEC CICS BIF
  5412*            DEEDIT
  5413*            FIELD (AHITAXI)
  5414*            LENGTH(5)
  5415*       END-EXEC
  5416     MOVE 5
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 104
* EL106.cbl
  5417       TO DFHEIV11
  5418*    MOVE '@"L                   #   #00004857' TO DFHEIV0
  5419     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5420     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5421     MOVE X'2020233030303034383537' TO DFHEIV0(25:11)
  5422     CALL 'kxdfhei1' USING DFHEIV0,
  5423           AHITAXI,
  5424           DFHEIV11
  5425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5426        IF AHITAXI NUMERIC
  5427           MOVE AL-UNNON         TO AHITAXA
  5428           MOVE AHITAXI          TO WS-ST-AH-PREM-TAX-I
  5429        ELSE
  5430           MOVE ER-2084          TO EMI-ERROR
  5431           MOVE -1               TO AHITAXL
  5432           MOVE AL-UNBON         TO AHITAXA
  5433           PERFORM 9900-ERROR-FORMAT
  5434                                 THRU 9900-EXIT
  5435        END-IF
  5436     END-IF
  5437
  5438     IF AHGTAXL NOT = ZEROS
  5439
  5440* EXEC CICS BIF
  5441*            DEEDIT
  5442*            FIELD (AHGTAXI)
  5443*            LENGTH(5)
  5444*       END-EXEC
  5445     MOVE 5
  5446       TO DFHEIV11
  5447*    MOVE '@"L                   #   #00004875' TO DFHEIV0
  5448     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5449     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5450     MOVE X'2020233030303034383735' TO DFHEIV0(25:11)
  5451     CALL 'kxdfhei1' USING DFHEIV0,
  5452           AHGTAXI,
  5453           DFHEIV11
  5454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5455        IF AHGTAXI NUMERIC
  5456           MOVE AL-UNNON         TO AHGTAXA
  5457           MOVE AHGTAXI          TO WS-ST-AH-PREM-TAX-G
  5458        ELSE
  5459           MOVE ER-2084          TO EMI-ERROR
  5460           MOVE -1               TO AHGTAXL
  5461           MOVE AL-UNBON         TO AHGTAXA
  5462           PERFORM 9900-ERROR-FORMAT
  5463                                 THRU 9900-EXIT
  5464        END-IF
  5465     END-IF
  5466
  5467     IF REFCLML NOT = ZEROS
  5468        IF REFCLMI = SPACES OR '1' OR '2' OR '3' OR '4' OR '5'
  5469           NEXT SENTENCE
  5470        ELSE
  5471           MOVE -1               TO REFCLML
  5472           MOVE AL-UABON         TO REFCLMA
  5473           MOVE ER-3036          TO EMI-ERROR
  5474           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 105
* EL106.cbl
  5475        END-IF
  5476     END-IF.
  5477
  5478     IF VFYBENEL NOT = ZEROS
  5479        IF VFYBENEI = SPACES OR 'Y' OR 'N'
  5480           NEXT SENTENCE
  5481        ELSE
  5482           MOVE -1               TO VFYBENEL
  5483           MOVE AL-UABON         TO VFYBENEA
  5484           MOVE ER-3040          TO EMI-ERROR
  5485           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5486        END-IF
  5487     END-IF.
  5488
  5489     IF CAUSALL NOT = ZEROS
  5490        IF CAUSALI = SPACES OR 'A' OR 'L' OR 'B'
  5491           NEXT SENTENCE
  5492        ELSE
  5493           MOVE -1               TO CAUSALL
  5494           MOVE AL-UABON         TO CAUSALA
  5495           MOVE ER-7578          TO EMI-ERROR
  5496           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5497        END-IF
  5498     END-IF.
  5499
  5500     .
  5501 6099-EXIT.
  5502     EXIT.
  5503
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 106
* EL106.cbl
  5505 6100-INITIALIZE-BENEFIT-CNTL.
  5506
  5507     MOVE SPACES   TO   CF-ST-BENEFIT-CD         (SUB)
  5508                        CF-ST-BENEFIT-KIND       (SUB)
  5509                        CF-ST-REM-TERM-CALC      (SUB)
  5510                        CF-ST-REFUND-CALC        (SUB)
  5511                        CF-ST-EARNING-CALC       (SUB)
  5512                        CF-ST-OVRD-EARNINGS-CALC (SUB).
  5513
  5514 6199-EXIT.
  5515     EXIT.
  5516
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 107
* EL106.cbl
  5518 6400-CREATE-TEMP-STORAGE.
  5519     PERFORM 6600-DELETE-TEMP-STORAGE THRU 6600-EXIT.
  5520
  5521
  5522* EXEC CICS WRITEQ TS
  5523*        QUEUE   (QID)
  5524*        FROM    (EL106AO)
  5525*        LENGTH  (WS-MAP-LENGTH)
  5526*    END-EXEC.
  5527*    MOVE '*"                    ''   #00004946' TO DFHEIV0
  5528     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  5529     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5530     MOVE X'2020233030303034393436' TO DFHEIV0(25:11)
  5531     CALL 'kxdfhei1' USING DFHEIV0,
  5532           QID,
  5533           EL106AO,
  5534           WS-MAP-LENGTH,
  5535           DFHEIV99,
  5536           DFHEIV99,
  5537           DFHEIV99
  5538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5539
  5540
  5541 6400-EXIT.
  5542      EXIT.
  5543
  5544 6500-RECOVER-TEMP-STORAGE.
  5545
  5546* EXEC CICS READQ TS
  5547*        QUEUE   (QID)
  5548*        INTO    (EL106AO)
  5549*        LENGTH  (WS-MAP-LENGTH)
  5550*    END-EXEC.
  5551*    MOVE '*$I    L              ''   #00004956' TO DFHEIV0
  5552     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  5553     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5554     MOVE X'2020233030303034393536' TO DFHEIV0(25:11)
  5555     CALL 'kxdfhei1' USING DFHEIV0,
  5556           QID,
  5557           EL106AO,
  5558           WS-MAP-LENGTH,
  5559           DFHEIV99,
  5560           DFHEIV99,
  5561           DFHEIV99
  5562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5563
  5564
  5565     PERFORM 6600-DELETE-TEMP-STORAGE THRU 6600-EXIT.
  5566
  5567 6500-EXIT.
  5568      EXIT.
  5569
  5570 6600-DELETE-TEMP-STORAGE.
  5571
  5572* EXEC CICS HANDLE CONDITION
  5573*        QIDERR  (6600-EXIT)
  5574*    END-EXEC.
  5575*    MOVE '"$N                   ! ( #00004968' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 108
* EL106.cbl
  5576     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  5577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5578     MOVE X'2820233030303034393638' TO DFHEIV0(25:11)
  5579     CALL 'kxdfhei1' USING DFHEIV0
  5580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5581
  5582
  5583
  5584* EXEC CICS DELETEQ TS
  5585*        QUEUE  (QID)
  5586*    END-EXEC.
  5587*    MOVE '*&                    #   #00004972' TO DFHEIV0
  5588     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  5589     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5590     MOVE X'2020233030303034393732' TO DFHEIV0(25:11)
  5591     CALL 'kxdfhei1' USING DFHEIV0,
  5592           QID,
  5593           DFHEIV99
  5594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5595
  5596
  5597 6600-EXIT.
  5598      EXIT.
  5599
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 109
* EL106.cbl
  5601***************************************************************
  5602*                                                             *
  5603*     BUILD THE OUTPUT SCREEN TO BE DISPLAYED                 *
  5604*                                                             *
  5605***************************************************************
  5606 7000-BUILD-OUTPUT-MAP.
  5607     MOVE LOW-VALUES            TO EL106AO.
  5608     MOVE CF-STATE-CODE         TO STCDO
  5609                                   PI-WS-STATE.
  5610     MOVE CF-ST-TOL-CLAIM       TO QUOTCALO.
  5611     MOVE CF-ST-TOL-PREM        TO PREMTOLO.
  5612     MOVE CF-ST-TOL-REFUND      TO REFTOLO.
  5613     MOVE CF-ST-CLAIM-REJECT-SW TO CLREJECO.
  5614     MOVE CF-ST-PREM-REJECT-SW  TO ISSREJO.
  5615     MOVE CF-ST-REF-REJECT-SW   TO REFREJO.
  5616     MOVE CF-ST-FST-PMT-DAYS-CHG
  5617                                TO EXTCHGO.
  5618     MOVE CF-ST-RT-CALC         TO REMTERMO
  5619     MOVE CF-ST-RF-LR-CALC      TO LFREDO
  5620     MOVE CF-ST-RF-LL-CALC      TO LFLEVO
  5621     MOVE CF-ST-RF-LN-CALC      TO LFNETO
  5622     MOVE CF-ST-RF-AH-CALC      TO AHAHO
  5623     MOVE CF-ST-RF-CP-CALC      TO AHCPO
  5624     MOVE CF-ST-CALL-UNEARNED   TO STUEO.
  5625     MOVE CF-ST-CALL-RPT-CNTL   TO STCNTLO.
  5626     MOVE CF-ST-CALL-RATE-DEV   TO STDEVO.
  5627     MOVE CF-STATE-ABBREVIATION TO STABRO.
  5628     MOVE CF-STATE-NAME         TO STNAMEO.
  5629     MOVE CF-ST-REF-AH-DEATH-IND TO REFCLMO.
  5630     MOVE CF-ST-VFY-2ND-BENE    TO VFYBENEO.
  5631     MOVE CF-ST-CAUSAL-STATE    TO CAUSALO.
  5632     IF  CF-ST-CHECK-COUNTER NUMERIC
  5633        MOVE CF-ST-CHECK-COUNTER TO STCHKNOO
  5634     ELSE
  5635        MOVE ZEROS             TO STCHKNOO
  5636     END-IF.
  5637
  5638     IF CF-ST-LF-EXP-PCT      NUMERIC
  5639         IF CF-ST-LF-EXP-PCT NOT = ZEROS
  5640             MOVE CF-ST-LF-EXP-PCT  TO LFEXPO.
  5641
  5642     IF CF-ST-AH-EXP-PCT      NUMERIC
  5643         IF CF-ST-AH-EXP-PCT NOT = ZEROS
  5644             MOVE CF-ST-AH-EXP-PCT  TO AHEXPO.
  5645
  5646     IF CF-ST-TOL-PREM-PCT    NUMERIC
  5647         IF CF-ST-TOL-PREM-PCT NOT = ZEROS
  5648             MOVE CF-ST-TOL-PREM-PCT TO PRMPCTO.
  5649
  5650     IF CF-ST-OVR-SHT-AMT NUMERIC
  5651        IF CF-ST-OVR-SHT-AMT > ZEROS
  5652           MOVE CF-ST-OVR-SHT-AMT TO OVSAMTO
  5653        END-IF
  5654     END-IF.
  5655
  5656     IF CF-ST-OVR-SHT-PCT NUMERIC
  5657         IF CF-ST-OVR-SHT-PCT > ZEROS
  5658             MOVE CF-ST-OVR-SHT-PCT TO OVSPCTO
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 110
* EL106.cbl
  5659         END-IF
  5660     END-IF.
  5661
  5662     IF CF-ST-TOL-REF-PCT     NUMERIC
  5663         IF CF-ST-TOL-REF-PCT NOT = ZEROS
  5664             MOVE CF-ST-TOL-REF-PCT TO REFPCTO.
  5665
  5666     IF CF-ST-REFUND-MIN      NUMERIC
  5667         IF CF-ST-REFUND-MIN NOT = ZEROS
  5668             MOVE CF-ST-REFUND-MIN  TO REFMINO.
  5669
  5670     IF CF-ST-REFUND-DAYS-FIRST NUMERIC
  5671       IF CF-ST-REFUND-DAYS-FIRST NOT = ZEROS
  5672         MOVE CF-ST-REFUND-DAYS-FIRST
  5673                                TO REFDAY1O.
  5674
  5675     IF CF-ST-REFUND-DAYS-SUBSEQ NUMERIC
  5676       IF CF-ST-REFUND-DAYS-SUBSEQ NOT = ZEROS
  5677         MOVE CF-ST-REFUND-DAYS-SUBSEQ
  5678                                TO REFDAYSO.
  5679
  5680     IF CF-ST-SPLIT-PAYMENT IS EQUAL TO ' '
  5681         MOVE 'N'               TO SPLPMTO
  5682     ELSE
  5683         MOVE CF-ST-SPLIT-PAYMENT
  5684                                TO SPLPMTO.
  5685
  5686     IF CF-ST-FST-PMT-DAYS-MAX NUMERIC
  5687       IF CF-ST-FST-PMT-DAYS-MAX NOT = ZEROS
  5688         MOVE CF-ST-FST-PMT-DAYS-MAX
  5689                                TO EXTDAYSO.
  5690
  5691     IF CF-ST-LF-PREM-TAX NUMERIC
  5692        IF CF-ST-LF-PREM-TAX > ZEROS
  5693           MOVE CF-ST-LF-PREM-TAX
  5694                                 TO LFTAXO
  5695        END-IF
  5696     END-IF
  5697
  5698     IF CF-ST-AH-PREM-TAX-I NUMERIC
  5699        IF CF-ST-AH-PREM-TAX-I > ZEROS
  5700           MOVE CF-ST-AH-PREM-TAX-I
  5701                                 TO AHITAXO
  5702        END-IF
  5703     END-IF
  5704
  5705     IF CF-ST-AH-PREM-TAX-G NUMERIC
  5706        IF CF-ST-AH-PREM-TAX-G > ZEROS
  5707           MOVE CF-ST-AH-PREM-TAX-G
  5708                                 TO AHGTAXO
  5709        END-IF
  5710     END-IF
  5711
  5712*    IF PI-COMPANY-ID = 'NCL'
  5713*    IF CF-ST-NO-DAYS-ELAPSED NUMERIC
  5714*      IF CF-ST-NO-DAYS-ELAPSED NOT = ZEROS
  5715*        MOVE CF-ST-NO-DAYS-ELAPSED
  5716*                               TO INTDAYSO.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 111
* EL106.cbl
  5717
  5718     IF  CF-REPLACEMENT-LAW-SW NOT EQUAL 'Y'
  5719             AND
  5720         CF-REPLACEMENT-LAW-SW NOT EQUAL 'N'
  5721         MOVE 'N'               TO REPLAWO
  5722         MOVE LOW-VALUES        TO REPLETRO
  5723     ELSE
  5724         MOVE CF-REPLACEMENT-LAW-SW
  5725                                TO REPLAWO
  5726
  5727         IF  CF-REPLACEMENT-LETTER GREATER THAN SPACES
  5728             MOVE CF-REPLACEMENT-LETTER
  5729                                TO REPLETRO
  5730         ELSE
  5731             MOVE LOW-VALUES    TO REPLETRO.
  5732
  5733     IF  CF-ST-TARGET-LOSS-RATIO NUMERIC
  5734         IF  CF-ST-TARGET-LOSS-RATIO NOT = ZEROS
  5735             MOVE CF-ST-TARGET-LOSS-RATIO
  5736                                TO TARRATO
  5737         ELSE
  5738             MOVE ZEROS         TO TARRATO
  5739     ELSE
  5740         MOVE ZEROS             TO TARRATO.
  5741
  5742     IF  CF-ST-CALC-INTEREST NUMERIC
  5743         IF  CF-ST-CALC-INTEREST NOT = ZEROS
  5744             MOVE CF-ST-CALC-INTEREST
  5745                                TO CALCINTO
  5746         ELSE
  5747             MOVE ZEROS         TO CALCINTO
  5748     ELSE
  5749         MOVE ZEROS             TO CALCINTO.
  5750
  5751     IF  CF-ST-COMM-CAP-SL NUMERIC
  5752         IF  CF-ST-COMM-CAP-SL NOT = ZEROS
  5753             MOVE CF-ST-COMM-CAP-SL
  5754                                TO COMSLO
  5755         ELSE
  5756             MOVE ZEROS         TO COMSLO
  5757     ELSE
  5758         MOVE ZEROS             TO COMSLO.
  5759
  5760     IF  CF-ST-COMM-CAP-JL NUMERIC
  5761         IF  CF-ST-COMM-CAP-JL NOT = ZEROS
  5762             MOVE CF-ST-COMM-CAP-JL
  5763                                TO COMJLO
  5764         ELSE
  5765             MOVE ZEROS         TO COMJLO
  5766     ELSE
  5767         MOVE ZEROS             TO COMJLO.
  5768
  5769     IF  CF-ST-COMM-CAP-SA NUMERIC
  5770         IF  CF-ST-COMM-CAP-SA NOT = ZEROS
  5771             MOVE CF-ST-COMM-CAP-SA
  5772                                TO COMSAO
  5773         ELSE
  5774             MOVE ZEROS         TO COMSAO
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 112
* EL106.cbl
  5775     ELSE
  5776         MOVE ZEROS             TO COMSAO.
  5777
  5778     IF  CF-ST-COMM-CAP-JA NUMERIC
  5779         IF  CF-ST-COMM-CAP-JA NOT = ZEROS
  5780             MOVE CF-ST-COMM-CAP-JA
  5781                                TO COMJAO
  5782         ELSE
  5783             MOVE ZEROS         TO COMJAO
  5784     ELSE
  5785         MOVE ZEROS             TO COMJAO.
  5786
  5787     IF  CF-ST-RES-TAX-PCT NUMERIC
  5788         IF  CF-ST-RES-TAX-PCT NOT = ZEROS
  5789             MOVE CF-ST-RES-TAX-PCT
  5790                                TO RESTAXO
  5791         ELSE
  5792             MOVE ZEROS         TO RESTAXO
  5793     ELSE
  5794         MOVE ZEROS             TO RESTAXO.
  5795
  5796     IF CF-ST-FREE-LOOK-PERIOD NUMERIC
  5797        IF CF-ST-FREE-LOOK-PERIOD NOT = ZEROS
  5798             MOVE CF-ST-FREE-LOOK-PERIOD
  5799                                TO FREELKO
  5800        ELSE
  5801             MOVE ZEROS         TO FREELKO
  5802     ELSE
  5803         MOVE ZEROS             TO FREELKO.
  5804
  5805*    IF PI-COMPANY-ID = 'NCL'
  5806*    IF  CF-ST-STAT-INTEREST NUMERIC
  5807*        IF  CF-ST-STAT-INTEREST NOT = ZEROS
  5808*            MOVE CF-ST-STAT-INTEREST
  5809*                               TO STATRO
  5810*        ELSE
  5811*            MOVE ZEROS         TO STATRO
  5812*    ELSE
  5813*        MOVE ZEROS             TO STATRO.
  5814
  5815*    IF PI-COMPANY-ID = 'NCL'
  5816*    IF  CF-ST-STAT-INTEREST-1 NUMERIC
  5817*        IF  CF-ST-STAT-INTEREST-1 NOT = ZEROS
  5818*            MOVE CF-ST-STAT-INTEREST-1
  5819*                               TO STATR1O
  5820*        ELSE
  5821*            MOVE ZEROS         TO STATR1O
  5822*    ELSE
  5823*        MOVE ZEROS             TO STATR1O.
  5824
  5825*    IF PI-COMPANY-ID = 'NCL'
  5826*    IF  CF-ST-STAT-INTEREST-2 NUMERIC
  5827*        IF  CF-ST-STAT-INTEREST-2 NOT = ZEROS
  5828*            MOVE CF-ST-STAT-INTEREST-2
  5829*                               TO STATR2O
  5830*        ELSE
  5831*            MOVE ZEROS         TO STATR2O
  5832*    ELSE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 113
* EL106.cbl
  5833*        MOVE ZEROS             TO STATR2O.
  5834
  5835*    IF PI-COMPANY-ID = 'NCL'
  5836*    IF  CF-ST-STAT-INTEREST-3 NUMERIC
  5837*        IF  CF-ST-STAT-INTEREST-3 NOT = ZEROS
  5838*            MOVE CF-ST-STAT-INTEREST-3
  5839*                               TO STATR3O
  5840*        ELSE
  5841*            MOVE ZEROS         TO STATR3O
  5842*    ELSE
  5843*        MOVE ZEROS             TO STATR3O.
  5844
  5845     MOVE CF-COMM-CAP-LIMIT-TO  TO LIMITO.
  5846*    MOVE CF-ST-STAT-DATE-FROM  TO STATIO.
  5847
  5848     MOVE CF-LAST-MAINT-BY      TO LSTUSRO.
  5849     MOVE ' '                   TO DC-OPTION-CODE.
  5850     MOVE CF-LAST-MAINT-DT      TO DC-BIN-DATE-1.
  5851     MOVE LINK-ELDATCV          TO PGM-NAME.
  5852
  5853* EXEC CICS LINK
  5854*        PROGRAM (PGM-NAME)
  5855*        COMMAREA(DATE-CONVERSION-DATA)
  5856*        LENGTH  (DC-COMM-LENGTH)
  5857*    END-EXEC.
  5858*    MOVE '."C                   (   #00005231' TO DFHEIV0
  5859     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5860     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5861     MOVE X'2020233030303035323331' TO DFHEIV0(25:11)
  5862     CALL 'kxdfhei1' USING DFHEIV0,
  5863           PGM-NAME,
  5864           DATE-CONVERSION-DATA,
  5865           DC-COMM-LENGTH,
  5866           DFHEIV99,
  5867           DFHEIV99,
  5868           DFHEIV99,
  5869           DFHEIV99
  5870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5871
  5872
  5873     IF DATE-CONVERSION-ERROR
  5874         MOVE ZEROS              TO LSTDTEO
  5875     ELSE
  5876         MOVE DC-GREG-DATE-1-EDIT
  5877                                 TO LSTDTEO.
  5878
  5879     MOVE CF-LAST-MAINT-HHMMSS   TO TIME-IN.
  5880     MOVE TIME-OUT               TO LSTTIMEO.
  5881     MOVE -1                     TO MAINTL.
  5882     MOVE CF-LAST-MAINT-BY       TO PI-UPDATE-BY.
  5883     MOVE CF-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  5884     MOVE CF-STATE-CODE          TO PI-PREV-STATE.
  5885     MOVE AL-UANOF               TO MAINTA.
  5886     MOVE AL-UANON               TO STCDA
  5887                                  STNAMEA
  5888                                  STABRA
  5889                                  CLREJECA ISSREJA REFREJA
  5890                                  EXTCHGA STUEA STCNTLA STDEVA
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 114
* EL106.cbl
  5891                                  REMTERMA
  5892                                  LFREDA LFLEVA LFNETA
  5893                                  AHAHA  AHCPA
  5894                                  REPLAWA REPLETRA SPLPMTA
  5895                                  LIMITA.
  5896*    IF PI-COMPANY-ID = 'NCL'
  5897*        MOVE AL-UANON           TO STATIA.
  5898
  5899     MOVE AL-UNNON               TO LFEXPA AHEXPA
  5900                                  QUOTCALA PREMTOLA REFTOLA
  5901                                  OVSAMTA  OVSPCTA
  5902                                  LFTAXA   AHITAXA  AHGTAXA
  5903                                  PRMPCTA  REFPCTA
  5904                                  REFDAY1A REFDAYSA
  5905                                  REFMINA EXTDAYSA
  5906                                  TARRATA
  5907                                  CALCINTA
  5908                                  RESTAXA FREELKA
  5909                                  COMSLA COMJLA COMSAA COMJAA.
  5910
  5911*    IF PI-COMPANY-ID = 'NCL'
  5912*        MOVE AL-UNNON           TO STATRA STATR1A STATR2A
  5913*                                                  STATR3A
  5914*                                                  INTDAYSA.
  5915
  5916     IF RETURN-DISPLAY
  5917         GO TO 8100-SEND-INITIAL-MAP
  5918     ELSE
  5919         GO TO 8200-SEND-DATAONLY.
  5920
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 115
* EL106.cbl
  5922 8100-SEND-INITIAL-MAP.
  5923     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
  5924       AND PI-WS-STATE = 'AK'
  5925        MOVE AL-SANON TO STCHKHDA STCHKNOA
  5926     ELSE
  5927        MOVE AL-SADOF TO STCHKHDA STCHKNOA
  5928     END-IF.
  5929     MOVE SAVE-DATE              TO RUNDTEO.
  5930     MOVE EIBTIME                TO TIME-IN.
  5931     MOVE TIME-OUT               TO RUNTIMEO.
  5932     MOVE -1                     TO MAINTL.
  5933     MOVE PI-LIFE-OVERRIDE-L6    TO LEXPLBLO.
  5934     MOVE PI-AH-OVERRIDE-L6      TO AEXPLBLO.
  5935     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  5936     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  5937
  5938*    IF PI-COMPANY-ID = 'NCL'
  5939*       MOVE AL-SANON            TO STATZA
  5940*                                   INTDAYZA
  5941*                                   STATRZA
  5942*                                   RNG1A
  5943*                                   RNG2A
  5944*                                   RNG3A
  5945*       MOVE AL-UANON            TO STATIA
  5946*                                   STATRA
  5947*                                   STATR1A
  5948*                                   STATR2A
  5949*                                   STATR3A
  5950*       MOVE AL-UNNON            TO INTDAYSA.
  5951
  5952
  5953* EXEC CICS SEND
  5954*        MAP   (MAP-NAME)
  5955*        MAPSET(MAPSET-NAME)
  5956*        FROM  (EL106AO)
  5957*        ERASE
  5958*        CURSOR
  5959*    END-EXEC.
  5960     MOVE LENGTH OF
  5961      EL106AO
  5962       TO DFHEIV12
  5963     MOVE -1
  5964       TO DFHEIV11
  5965*    MOVE '8$     CT  E    H L F ,   #00005316' TO DFHEIV0
  5966     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5967     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5968     MOVE X'2020233030303035333136' TO DFHEIV0(25:11)
  5969     CALL 'kxdfhei1' USING DFHEIV0,
  5970           MAP-NAME,
  5971           EL106AO,
  5972           DFHEIV12,
  5973           MAPSET-NAME,
  5974           DFHEIV99,
  5975           DFHEIV99,
  5976           DFHEIV99,
  5977           DFHEIV11,
  5978           DFHEIV99,
  5979           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 116
* EL106.cbl
  5980           DFHEIV99
  5981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5982
  5983
  5984     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 117
* EL106.cbl
  5986 8200-SEND-DATAONLY.
  5987
  5988     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
  5989       AND PI-WS-STATE = 'AK'
  5990        MOVE AL-SANON TO STCHKHDA STCHKNOA
  5991     ELSE
  5992        MOVE AL-SADOF TO STCHKHDA STCHKNOA
  5993     END-IF.
  5994
  5995     MOVE SAVE-DATE      TO RUNDTEO.
  5996     MOVE EIBTIME        TO TIME-IN.
  5997     MOVE TIME-OUT       TO RUNTIMEO.
  5998
  5999     IF QUOTCALL NOT = ZEROS
  6000        IF QUOTCALI NUMERIC
  6001           MOVE QUOTCALI TO QUOTCALO.
  6002
  6003     IF PREMTOLL NOT = ZEROS
  6004        IF PREMTOLI NUMERIC
  6005           MOVE PREMTOLI TO PREMTOLO.
  6006
  6007     IF OVSAMTL NOT = ZEROS
  6008        IF OVSAMTI NUMERIC
  6009           MOVE OVSAMTI TO OVSAMTO.
  6010
  6011     IF REFTOLL NOT = ZEROS
  6012        IF REFTOLI NUMERIC
  6013           MOVE REFTOLI TO REFTOLO.
  6014
  6015     IF PRMPCTL NOT = ZEROS
  6016        IF PRMPCTI NUMERIC
  6017           MOVE PRMPCTI TO PRMPCTO.
  6018
  6019     IF OVSPCTL NOT = ZEROS
  6020        IF OVSPCTI NUMERIC
  6021           MOVE OVSPCTI TO OVSPCTO.
  6022
  6023     IF LFTAXL NOT = ZEROS
  6024        IF LFTAXI NUMERIC
  6025           MOVE LFTAXI           TO LFTAXO
  6026        END-IF
  6027     END-IF
  6028
  6029     IF AHITAXL NOT = ZEROS
  6030        IF AHITAXI NUMERIC
  6031           MOVE AHITAXI          TO AHITAXO
  6032        END-IF
  6033     END-IF
  6034
  6035     IF AHGTAXL NOT = ZEROS
  6036        IF AHGTAXI NUMERIC
  6037           MOVE AHGTAXI          TO AHGTAXO
  6038        END-IF
  6039     END-IF
  6040
  6041     IF REFPCTL NOT = ZEROS
  6042        IF REFPCTI NUMERIC
  6043           MOVE REFPCTI TO REFPCTO.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 118
* EL106.cbl
  6044
  6045     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  6046     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  6047
  6048
  6049* EXEC CICS SEND
  6050*        MAP   (MAP-NAME)
  6051*        MAPSET(MAPSET-NAME)
  6052*        FROM  (EL106AO)
  6053*        DATAONLY
  6054*        ERASEAUP
  6055*        CURSOR
  6056*    END-EXEC.
  6057     MOVE LENGTH OF
  6058      EL106AO
  6059       TO DFHEIV12
  6060     MOVE -1
  6061       TO DFHEIV11
  6062*    MOVE '8$D    CT  A    H L F ,   #00005388' TO DFHEIV0
  6063     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  6064     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6065     MOVE X'2020233030303035333838' TO DFHEIV0(25:11)
  6066     CALL 'kxdfhei1' USING DFHEIV0,
  6067           MAP-NAME,
  6068           EL106AO,
  6069           DFHEIV12,
  6070           MAPSET-NAME,
  6071           DFHEIV99,
  6072           DFHEIV99,
  6073           DFHEIV99,
  6074           DFHEIV11,
  6075           DFHEIV99,
  6076           DFHEIV99,
  6077           DFHEIV99
  6078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6079
  6080
  6081     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 119
* EL106.cbl
  6083 8300-SEND-TEXT.
  6084
  6085* EXEC CICS SEND TEXT
  6086*        FROM  (LOGOFF-TEXT)
  6087*        LENGTH(LOGOFF-LENGTH)
  6088*        ERASE
  6089*        FREEKB
  6090*    END-EXEC.
  6091*    MOVE '8&      T  E F  H   F -   #00005400' TO DFHEIV0
  6092     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  6093     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  6094     MOVE X'2020233030303035343030' TO DFHEIV0(25:11)
  6095     CALL 'kxdfhei1' USING DFHEIV0,
  6096           LOGOFF-TEXT,
  6097           LOGOFF-LENGTH,
  6098           DFHEIV99,
  6099           DFHEIV99,
  6100           DFHEIV99,
  6101           DFHEIV99,
  6102           DFHEIV99,
  6103           DFHEIV99,
  6104           DFHEIV99,
  6105           DFHEIV99,
  6106           DFHEIV99,
  6107           DFHEIV99
  6108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6109
  6110
  6111
  6112* EXEC CICS RETURN
  6113*    END-EXEC.
  6114*    MOVE '.(                    ''   #00005407' TO DFHEIV0
  6115     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6116     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6117     MOVE X'2020233030303035343037' TO DFHEIV0(25:11)
  6118     CALL 'kxdfhei1' USING DFHEIV0,
  6119           DFHEIV99,
  6120           DFHEIV99,
  6121           DFHEIV99,
  6122           DFHEIV99,
  6123           DFHEIV99,
  6124           DFHEIV99
  6125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6126
  6127
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 120
* EL106.cbl
  6129 8400-LOG-JOURNAL-RECORD.
  6130     IF PI-JOURNAL-FILE-ID = 0
  6131         GO TO 8400-EXIT.
  6132
  6133     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  6134     MOVE ELCNTL-ID              TO JP-FILE-ID.
  6135     MOVE THIS-PGM               TO JP-PROGRAM-ID.
  6136*    EXEC CICS JOURNAL
  6137*         JFILEID(PI-JOURNAL-FILE-ID)
  6138*         JTYPEID('EL')
  6139*         FROM   (JOURNAL-RECORD)
  6140*         LENGTH (773)
  6141*    END-EXEC.
  6142
  6143 8400-EXIT.
  6144     EXIT.
  6145
  6146 8800-UNAUTHORIZED-ACCESS.
  6147     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  6148     GO TO 8300-SEND-TEXT.
  6149
  6150 8810-PF23.
  6151     MOVE EIBAID   TO PI-ENTRY-CD-1.
  6152     MOVE XCTL-EL005 TO PGM-NAME.
  6153     GO TO 9300-XCTL.
  6154
  6155 8850-DUPREC.
  6156     MOVE ER-0147 TO EMI-ERROR.
  6157     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6158     MOVE -1       TO STCDL.
  6159     MOVE AL-UABON TO STCDA.
  6160     GO TO 8200-SEND-DATAONLY.
  6161
  6162 8860-ENDFILE.
  6163     MOVE LOW-VALUES TO EL106AO.
  6164     MOVE ER-0148    TO EMI-ERROR.
  6165     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6166     MOVE -1 TO MAINTL.
  6167     MOVE SPACES TO PI-WS-STATE.
  6168     GO TO 8100-SEND-INITIAL-MAP.
  6169
  6170 8870-NOTOPEN.
  6171     MOVE ER-0042 TO EMI-ERROR.
  6172     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6173     MOVE -1 TO MAINTL.
  6174     GO TO 8200-SEND-DATAONLY.
  6175
  6176 8880-NOT-FOUND.
  6177     MOVE ER-0149 TO EMI-ERROR.
  6178     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6179     MOVE -1       TO STCDL.
  6180     MOVE AL-UABON TO STCDA.
  6181     GO TO 8200-SEND-DATAONLY.
  6182
  6183 8890-LETR-NOT-OPEN.
  6184     MOVE ER-0013                TO EMI-ERROR.
  6185     MOVE -1                     TO REPLETRL.
  6186     MOVE AL-UABON               TO REPLETRA.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 121
* EL106.cbl
  6187     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6188     GO TO 8200-SEND-DATAONLY.
  6189
  6190 9000-RETURN-CICS.
  6191
  6192* EXEC CICS RETURN
  6193*    END-EXEC.
  6194*    MOVE '.(                    ''   #00005473' TO DFHEIV0
  6195     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6196     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6197     MOVE X'2020233030303035343733' TO DFHEIV0(25:11)
  6198     CALL 'kxdfhei1' USING DFHEIV0,
  6199           DFHEIV99,
  6200           DFHEIV99,
  6201           DFHEIV99,
  6202           DFHEIV99,
  6203           DFHEIV99,
  6204           DFHEIV99
  6205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6206
  6207
  6208 9100-RETURN-TRAN.
  6209     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  6210     MOVE '106A'                 TO PI-CURRENT-SCREEN-NO.
  6211
  6212
  6213* EXEC CICS RETURN
  6214*        TRANSID (TRANS-ID)
  6215*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  6216*        LENGTH  (WS-COMM-LENGTH)
  6217*    END-EXEC.
  6218*    MOVE '.(CT                  ''   #00005480' TO DFHEIV0
  6219     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6220     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6221     MOVE X'2020233030303035343830' TO DFHEIV0(25:11)
  6222     CALL 'kxdfhei1' USING DFHEIV0,
  6223           TRANS-ID,
  6224           PROGRAM-INTERFACE-BLOCK,
  6225           WS-COMM-LENGTH,
  6226           DFHEIV99,
  6227           DFHEIV99,
  6228           DFHEIV99
  6229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6230
  6231
  6232 9200-RETURN-MAIN-MENU.
  6233     IF  CREDIT-SESSION
  6234         MOVE XCTL-EL626           TO PGM-NAME
  6235     ELSE
  6236     IF  CLAIM-SESSION
  6237         MOVE XCTL-EL126           TO PGM-NAME
  6238     ELSE
  6239     IF  MORTGAGE-SESSION
  6240         MOVE XCTL-EM626           TO PGM-NAME
  6241     ELSE
  6242     IF  GENERAL-LEDGER-SESSION
  6243         MOVE XCTL-GL800           TO PGM-NAME.
  6244
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 122
* EL106.cbl
  6245     GO TO 9300-XCTL.
  6246
  6247 9300-XCTL.
  6248
  6249* EXEC CICS XCTL
  6250*        PROGRAM (PGM-NAME)
  6251*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  6252*        LENGTH  (WS-COMM-LENGTH)
  6253*    END-EXEC.
  6254*    MOVE '.$C                   %   #00005502' TO DFHEIV0
  6255     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6256     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6257     MOVE X'2020233030303035353032' TO DFHEIV0(25:11)
  6258     CALL 'kxdfhei1' USING DFHEIV0,
  6259           PGM-NAME,
  6260           PROGRAM-INTERFACE-BLOCK,
  6261           WS-COMM-LENGTH,
  6262           DFHEIV99
  6263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6264
  6265
  6266 9400-CLEAR.
  6267     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  6268     GO TO 9300-XCTL.
  6269
  6270 9500-PF12.
  6271     MOVE XCTL-EL010 TO PGM-NAME.
  6272     GO TO 9300-XCTL.
  6273
  6274 9600-PGMID-ERROR.
  6275
  6276* EXEC CICS HANDLE CONDITION
  6277*        PGMIDERR(8300-SEND-TEXT)
  6278*    END-EXEC.
  6279*    MOVE '"$L                   ! ) #00005517' TO DFHEIV0
  6280     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6282     MOVE X'2920233030303035353137' TO DFHEIV0(25:11)
  6283     CALL 'kxdfhei1' USING DFHEIV0
  6284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6285
  6286
  6287     MOVE PGM-NAME      TO PI-CALLING-PROGRAM.
  6288     MOVE ' '           TO PI-ENTRY-CD-1.
  6289     MOVE XCTL-EL005    TO PGM-NAME.
  6290     MOVE PGM-NAME      TO LOGOFF-PGM.
  6291     MOVE PGMIDERR-MSG  TO LOGOFF-FILL.
  6292     GO TO 9300-XCTL.
  6293
  6294 9700-LINK-DATE-CONVERT.
  6295
  6296* EXEC CICS LINK
  6297*        PROGRAM    ('ELDATCV')
  6298*        COMMAREA   (DATE-CONVERSION-DATA)
  6299*        LENGTH     (DC-COMM-LENGTH)
  6300*    END-EXEC.
  6301     MOVE 'ELDATCV' TO DFHEIV1
  6302*    MOVE '."C                   (   #00005529' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 123
* EL106.cbl
  6303     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6304     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6305     MOVE X'2020233030303035353239' TO DFHEIV0(25:11)
  6306     CALL 'kxdfhei1' USING DFHEIV0,
  6307           DFHEIV1,
  6308           DATE-CONVERSION-DATA,
  6309           DC-COMM-LENGTH,
  6310           DFHEIV99,
  6311           DFHEIV99,
  6312           DFHEIV99,
  6313           DFHEIV99
  6314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6315
  6316
  6317 9700-EXIT.
  6318     EXIT.
  6319
  6320 9900-ERROR-FORMAT.
  6321     IF NOT EMI-ERRORS-COMPLETE
  6322         MOVE LINK-EL001 TO PGM-NAME
  6323
  6324* EXEC CICS LINK
  6325*            PROGRAM (PGM-NAME)
  6326*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  6327*            LENGTH  (EMI-COMM-LENGTH)
  6328*        END-EXEC.
  6329*    MOVE '."C                   (   #00005541' TO DFHEIV0
  6330     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6331     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6332     MOVE X'2020233030303035353431' TO DFHEIV0(25:11)
  6333     CALL 'kxdfhei1' USING DFHEIV0,
  6334           PGM-NAME,
  6335           ERROR-MESSAGE-INTERFACE-BLOCK,
  6336           EMI-COMM-LENGTH,
  6337           DFHEIV99,
  6338           DFHEIV99,
  6339           DFHEIV99,
  6340           DFHEIV99
  6341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6342
  6343
  6344 9900-EXIT.
  6345     EXIT.
  6346
  6347 9910-INITIALIZE-SECURITY.
  6348******************************************************************
  6349*                                                                *
  6350*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  6351*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  6352*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  6353*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  6354*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  6355*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  6356*                                                                *
  6357******************************************************************
  6358     IF  PI-PROCESSOR-ID NOT = 'LGXX'
  6359         IF  MORTGAGE-SESSION
  6360             MOVE '125E'             TO SC-QUID-SYSTEM
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 124
* EL106.cbl
  6361             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  6362
  6363* EXEC CICS READQ TS
  6364*                QUEUE  (SC-QUID-KEY)
  6365*                INTO   (SECURITY-CONTROL-E)
  6366*                LENGTH (SC-COMM-LENGTH-E)
  6367*                ITEM   (SC-ITEM)
  6368*            END-EXEC
  6369*    MOVE '*$II   L              ''   #00005565' TO DFHEIV0
  6370     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6371     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6372     MOVE X'2020233030303035353635' TO DFHEIV0(25:11)
  6373     CALL 'kxdfhei1' USING DFHEIV0,
  6374           SC-QUID-KEY,
  6375           SECURITY-CONTROL-E,
  6376           SC-COMM-LENGTH-E,
  6377           SC-ITEM,
  6378           DFHEIV99,
  6379           DFHEIV99
  6380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6381             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  6382                                     TO PI-DISPLAY-CAP
  6383             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  6384                                     TO PI-MODIFY-CAP
  6385             IF  NOT DISPLAY-CAP
  6386                 MOVE 'READ'         TO SM-READ
  6387                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6388                 MOVE ER-9097        TO EMI-ERROR
  6389                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6390                 GO TO 8100-SEND-INITIAL-MAP
  6391             ELSE
  6392                 GO TO 9910-EXIT
  6393         ELSE
  6394
  6395* EXEC CICS  READQ TS
  6396*                QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6397*                INTO    (SECURITY-CONTROL)
  6398*                LENGTH  (SC-COMM-LENGTH)
  6399*                ITEM    (SC-ITEM-CL-CR)
  6400*                END-EXEC
  6401*    MOVE '*$II   L              ''   #00005584' TO DFHEIV0
  6402     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6403     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6404     MOVE X'2020233030303035353834' TO DFHEIV0(25:11)
  6405     CALL 'kxdfhei1' USING DFHEIV0,
  6406           PI-SECURITY-TEMP-STORE-ID,
  6407           SECURITY-CONTROL,
  6408           SC-COMM-LENGTH,
  6409           SC-ITEM-CL-CR,
  6410           DFHEIV99,
  6411           DFHEIV99
  6412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6413             MOVE SC-CREDIT-DISPLAY (29)
  6414                                 TO PI-DISPLAY-CAP
  6415             MOVE SC-CREDIT-UPDATE  (29)
  6416                                 TO PI-MODIFY-CAP
  6417             IF  NOT DISPLAY-CAP
  6418                 MOVE 'READ'     TO SM-READ
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 125
* EL106.cbl
  6419                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6420                 MOVE ER-0070    TO  EMI-ERROR
  6421                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6422                 GO TO 8100-SEND-INITIAL-MAP.
  6423 9910-EXIT.
  6424     EXIT.
  6425 9990-ABEND.
  6426     MOVE LINK-EL004             TO PGM-NAME.
  6427     MOVE DFHEIBLK               TO EMI-LINE1.
  6428
  6429* EXEC CICS LINK
  6430*        PROGRAM   (PGM-NAME)
  6431*        COMMAREA  (EMI-LINE1)
  6432*        LENGTH    (72)
  6433*    END-EXEC.
  6434     MOVE 72
  6435       TO DFHEIV11
  6436*    MOVE '."C                   (   #00005605' TO DFHEIV0
  6437     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6439     MOVE X'2020233030303035363035' TO DFHEIV0(25:11)
  6440     CALL 'kxdfhei1' USING DFHEIV0,
  6441           PGM-NAME,
  6442           EMI-LINE1,
  6443           DFHEIV11,
  6444           DFHEIV99,
  6445           DFHEIV99,
  6446           DFHEIV99,
  6447           DFHEIV99
  6448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6449
  6450
  6451     GO TO 8200-SEND-DATAONLY.
  6452
  6453 9995-SECURITY-VIOLATION.
  6454*           COPY ELCSCTP.
  6455******************************************************************
  6456*                                                                *
  6457*                            ELCSCTP                             *
  6458*                            VMOD=2.001                          *
  6459*                                                                *
  6460*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6461******************************************************************
  6462
  6463
  6464     MOVE EIBDATE          TO SM-JUL-DATE.
  6465     MOVE EIBTRMID         TO SM-TERMID.
  6466     MOVE THIS-PGM         TO SM-PGM.
  6467     MOVE EIBTIME          TO TIME-IN.
  6468     MOVE TIME-OUT         TO SM-TIME.
  6469     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6470
  6471
  6472* EXEC CICS LINK
  6473*         PROGRAM  ('EL003')
  6474*         COMMAREA (SECURITY-MESSAGE)
  6475*         LENGTH   (80)
  6476*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 126
* EL106.cbl
  6477     MOVE 'EL003' TO DFHEIV1
  6478     MOVE 80
  6479       TO DFHEIV11
  6480*    MOVE '."C                   (   #00005631' TO DFHEIV0
  6481     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6483     MOVE X'2020233030303035363331' TO DFHEIV0(25:11)
  6484     CALL 'kxdfhei1' USING DFHEIV0,
  6485           DFHEIV1,
  6486           SECURITY-MESSAGE,
  6487           DFHEIV11,
  6488           DFHEIV99,
  6489           DFHEIV99,
  6490           DFHEIV99,
  6491           DFHEIV99
  6492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6493
  6494
  6495******************************************************************
  6496
  6497
  6498 9995-EXIT.
  6499      EXIT.
  6500
  6501
  6502 9999-DFHBACK SECTION.
  6503     MOVE '9%                    "   ' TO DFHEIV0
  6504     MOVE 'EL106' TO DFHEIV1
  6505     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6506     GOBACK.
  6507 9999-DFHEXIT.
  6508     IF DFHEIGDJ EQUAL 0001
  6509         NEXT SENTENCE
  6510     ELSE IF DFHEIGDJ EQUAL 2
  6511         GO TO 8850-DUPREC,
  6512               8870-NOTOPEN,
  6513               8880-NOT-FOUND,
  6514               9600-PGMID-ERROR,
  6515               9990-ABEND
  6516         DEPENDING ON DFHEIGDI
  6517     ELSE IF DFHEIGDJ EQUAL 3
  6518         GO TO 8880-NOT-FOUND,
  6519               8880-NOT-FOUND
  6520         DEPENDING ON DFHEIGDI
  6521     ELSE IF DFHEIGDJ EQUAL 4
  6522         GO TO 8100-SEND-INITIAL-MAP
  6523         DEPENDING ON DFHEIGDI
  6524     ELSE IF DFHEIGDJ EQUAL 5
  6525         GO TO 8860-ENDFILE
  6526         DEPENDING ON DFHEIGDI
  6527     ELSE IF DFHEIGDJ EQUAL 6
  6528         GO TO 8860-ENDFILE
  6529         DEPENDING ON DFHEIGDI
  6530     ELSE IF DFHEIGDJ EQUAL 7
  6531         GO TO 6010-LETR-NOT-FOUND,
  6532               6010-LETR-NOT-FOUND,
  6533               8890-LETR-NOT-OPEN
  6534         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 127
* EL106.cbl
  6535     ELSE IF DFHEIGDJ EQUAL 8
  6536         GO TO 6600-EXIT
  6537         DEPENDING ON DFHEIGDI
  6538     ELSE IF DFHEIGDJ EQUAL 9
  6539         GO TO 8300-SEND-TEXT
  6540         DEPENDING ON DFHEIGDI.
  6541     MOVE '9%                    "   ' TO DFHEIV0
  6542     MOVE 'EL106' TO DFHEIV1
  6543     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6544     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5108     Code:       18993
