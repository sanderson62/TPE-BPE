* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL631.cbl
* Options: int("EL631.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL631.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL631.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL631.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL631.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:44:20.
     7*                            VMOD=2.021.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL631.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22
    23*REMARKS.    TRANSACTION - EXB0 - NEW BUSINESS
    24*                                 REVIEW AND CORRECTION
    25
    26 ENVIRONMENT DIVISION.
    27
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL631.cbl
    29 DATA DIVISION.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32 77  FILLER  PIC X(32)  VALUE '********************************'.
    33 77  FILLER  PIC X(32)  VALUE '*    EL631   WORKING STORAGE   *'.
    34 77  FILLER  PIC X(32)  VALUE '************VMOD=2.021 *********'.
    35
    36*    COPY ELCSCTM.
    37******************************************************************
    38*                                                                *
    39*                                                                *
    40*                            ELCSCTM                             *
    41*                            VMOD=2.001                          *
    42*                                                                *
    43*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    44*                                                                *
    45******************************************************************
    46 01  SECURITY-MESSAGE.
    47     12  FILLER                          PIC X(30)
    48            VALUE '** LOGIC SECURITY VIOLATION -'.
    49     12  SM-READ                         PIC X(6).
    50     12  FILLER                          PIC X(5)
    51            VALUE ' PGM='.
    52     12  SM-PGM                          PIC X(6).
    53     12  FILLER                          PIC X(5)
    54            VALUE ' OPR='.
    55     12  SM-PROCESSOR-ID                 PIC X(4).
    56     12  FILLER                          PIC X(6)
    57            VALUE ' TERM='.
    58     12  SM-TERMID                       PIC X(4).
    59     12  FILLER                          PIC XX   VALUE SPACE.
    60     12  SM-JUL-DATE                     PIC 9(5).
    61     12  FILLER                          PIC X    VALUE SPACE.
    62     12  SM-TIME                         PIC 99.99.
    63
    64*    COPY ELCSCRTY.
    65******************************************************************
    66*                                                                *
    67*                                                                *
    68*                            ELCSCRTY                            *
    69*                            VMOD=2.001                          *
    70*                                                                *
    71*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    72*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    73*        SAVED IN PI-SECURITY-ADDRESS.                           *
    74*                                                                *
    75******************************************************************
    76 01  SECURITY-CONTROL.
    77     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    78     12  FILLER                       PIC XX    VALUE 'SC'.
    79     12  SC-CREDIT-CODES.
    80         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    81             20  SC-CREDIT-DISPLAY    PIC X.
    82             20  SC-CREDIT-UPDATE     PIC X.
    83     12  SC-CLAIMS-CODES.
    84         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    85             20  SC-CLAIMS-DISPLAY    PIC X.
    86             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL631.cbl
    87
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL631.cbl
    89
    90 01  WS-DATE-AREA.
    91     05  SAVE-DATE               PIC X(8)    VALUE SPACES.
    92     05  SAVE-BIN-DATE           PIC X(2)    VALUE SPACES.
    93
    94 01  STANDARD-AREAS.
    95     12  SC-ITEM                 PIC S9(4) COMP VALUE +1.
    96     12  MAP-NAME                PIC X(8)    VALUE 'EL631A'.
    97     12  MAPSET-NAME             PIC X(8)    VALUE 'EL631S'.
    98     12  SCREEN-NUMBER           PIC X(4)    VALUE '631A'.
    99     12  TRANS-ID                PIC X(4)    VALUE 'EXB0'.
   100     12  THIS-PGM                PIC X(8)    VALUE 'EL631'.
   101     12  PGM-NAME                PIC X(8).
   102     12  TIME-IN                 PIC S9(7).
   103     12  TIME-OUT-R  REDEFINES TIME-IN.
   104         16  FILLER              PIC X.
   105         16  TIME-OUT            PIC 99V99.
   106         16  FILLER              PIC XX.
   107     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   108     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   109     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   110     12  XCTL-6311               PIC X(8)    VALUE 'EL6311'.
   111     12  XCTL-630                PIC X(8)    VALUE 'EL630'.
   112     12  XCTL-656                PIC X(8)    VALUE 'EL656'.
   113     12  XCTL-663                PIC X(8)    VALUE 'EL663'.
   114     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   115     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   116     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   117     12  FILE-ID                 PIC X(8)    VALUE SPACES.
   118     12  ERPNDB-FILE-ID          PIC X(8)    VALUE 'ERPNDB'.
   119     12  ERPNDB3-FILE-ID         PIC X(8)    VALUE 'ERPNDB3'.
   120     12  ERACCT2-FILE-ID         PIC X(8)    VALUE 'ERACCT2'.
   121
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL631.cbl
   123
   124 01  ERROR-MESSAGES.
   125     12  ER-0004                 PIC X(4)  VALUE '0004'.
   126     12  ER-0008                 PIC X(4)  VALUE '0008'.
   127     12  ER-0029                 PIC X(4)  VALUE '0029'.
   128     12  ER-0033                 PIC X(4)  VALUE '0033'.
   129     12  ER-0070                 PIC X(4)  VALUE '0070'.
   130     12  ER-0144                 PIC X(4)  VALUE '0144'.
   131     12  ER-0179                 PIC X(4)  VALUE '0179'.
   132     12  ER-0193                 PIC X(4)  VALUE '0193'.
   133     12  ER-0195                 PIC X(4)  VALUE '0195'.
   134     12  ER-0329                 PIC X(4)  VALUE '0329'.
   135     12  ER-0348                 PIC X(4)  VALUE '0348'.
   136     12  ER-2059                 PIC X(4)  VALUE '2059'.
   137     12  ER-2150                 PIC X(4)  VALUE '2150'.
   138     12  ER-2190                 PIC X(4)  VALUE '2190'.
   139     12  ER-2191                 PIC X(4)  VALUE '2191'.
   140     12  ER-2192                 PIC X(4)  VALUE '2192'.
   141     12  ER-2193                 PIC X(4)  VALUE '2193'.
   142     12  ER-2201                 PIC X(4)  VALUE '2201'.
   143     12  ER-2314                 PIC X(4)  VALUE '2314'.
   144     12  ER-2372                 PIC X(4)  VALUE '2372'.
   145     12  ER-2375                 PIC X(4)  VALUE '2375'.
   146     12  ER-2377                 PIC X(4)  VALUE '2377'.
   147     12  ER-2971                 PIC X(4)  VALUE '2971'.
   148
   149     12  DEEDIT-FIELD            PIC X(15).
   150     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   151
   152     12  CLIENT-MIC              PIC X(3)  VALUE 'MIC'.
   153     12  CLIENT-PEM              PIC X(3)  VALUE 'PEM'.
   154     12  CLIENT-CSO              PIC X(3)  VALUE 'CSO'.
   155     12  CLIENT-FLA              PIC X(3)  VALUE 'FLA'.
   156
   157     12  WS-ACCT-KEY.
   158         16  FILLER              PIC X(20).
   159         16  WS-EFF-DT           PIC XX.
   160
   161     12  RETURN-FROM             PIC X(8).
   162     12  QID.
   163         16  QID-TERM            PIC X(4).
   164         16  FILLER              PIC X(4)    VALUE '631A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL631.cbl
   166*    COPY ELCDATE.
   167******************************************************************
   168*                                                                *
   169*                                                                *
   170*                            ELCDATE.                            *
   171*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   172*                            VMOD=2.003
   173*                                                                *
   174*                                                                *
   175*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   176*                 LENGTH = 200                                   *
   177******************************************************************
   178
   179 01  DATE-CONVERSION-DATA.
   180     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   181     12  DC-OPTION-CODE                PIC X.
   182         88  BIN-TO-GREG                VALUE ' '.
   183         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   184         88  EDIT-GREG-TO-BIN           VALUE '2'.
   185         88  YMD-GREG-TO-BIN            VALUE '3'.
   186         88  MDY-GREG-TO-BIN            VALUE '4'.
   187         88  JULIAN-TO-BIN              VALUE '5'.
   188         88  BIN-PLUS-ELAPSED           VALUE '6'.
   189         88  FIND-CENTURY               VALUE '7'.
   190         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   191         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   192         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   193         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   194         88  JULIAN-TO-BIN-3            VALUE 'C'.
   195         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   196         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   197         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   198         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   199         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   200         88  CHECK-LEAP-YEAR            VALUE 'H'.
   201         88  BIN-3-TO-GREG              VALUE 'I'.
   202         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   203         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   204         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   205         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   206         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   207         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   208         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   209         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   210         88  THREE-CHARACTER-BIN
   211                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   212         88  GREGORIAN-TO-BIN
   213                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   214         88  BIN-TO-GREGORIAN
   215                  VALUES ' ' '1' 'I' '8' 'G'.
   216         88  JULIAN-TO-BINARY
   217                  VALUES '5' 'C' 'E' 'F'.
   218     12  DC-ERROR-CODE                 PIC X.
   219         88  NO-CONVERSION-ERROR        VALUE ' '.
   220         88  DATE-CONVERSION-ERROR
   221                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   222         88  DATE-IS-ZERO               VALUE '1'.
   223         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL631.cbl
   224         88  DATE-IS-INVALID            VALUE '3'.
   225         88  DATE1-GREATER-DATE2        VALUE '4'.
   226         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   227         88  DATE-INVALID-OPTION        VALUE '9'.
   228         88  INVALID-CENTURY            VALUE 'A'.
   229         88  ONLY-CENTURY               VALUE 'B'.
   230         88  ONLY-LEAP-YEAR             VALUE 'C'.
   231         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   232     12  DC-END-OF-MONTH               PIC X.
   233         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   234     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   235         88  USE-NORMAL-PROCESS         VALUE ' '.
   236         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   237         88  ADJUST-UP-100-YRS          VALUE '2'.
   238     12  FILLER                        PIC X.
   239     12  DC-CONVERSION-DATES.
   240         16  DC-BIN-DATE-1             PIC XX.
   241         16  DC-BIN-DATE-2             PIC XX.
   242         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   243         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   244                       DC-GREG-DATE-1-EDIT.
   245             20  DC-EDIT1-MONTH        PIC 99.
   246             20  SLASH1-1              PIC X.
   247             20  DC-EDIT1-DAY          PIC 99.
   248             20  SLASH1-2              PIC X.
   249             20  DC-EDIT1-YEAR         PIC 99.
   250         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   251         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   252                     DC-GREG-DATE-2-EDIT.
   253             20  DC-EDIT2-MONTH        PIC 99.
   254             20  SLASH2-1              PIC X.
   255             20  DC-EDIT2-DAY          PIC 99.
   256             20  SLASH2-2              PIC X.
   257             20  DC-EDIT2-YEAR         PIC 99.
   258         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   259         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   260                     DC-GREG-DATE-1-YMD.
   261             20  DC-YMD-YEAR           PIC 99.
   262             20  DC-YMD-MONTH          PIC 99.
   263             20  DC-YMD-DAY            PIC 99.
   264         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   265         16  DC-GREG-DATE-1-MDY-R REDEFINES
   266                      DC-GREG-DATE-1-MDY.
   267             20  DC-MDY-MONTH          PIC 99.
   268             20  DC-MDY-DAY            PIC 99.
   269             20  DC-MDY-YEAR           PIC 99.
   270         16  DC-GREG-DATE-1-ALPHA.
   271             20  DC-ALPHA-MONTH        PIC X(10).
   272             20  DC-ALPHA-DAY          PIC 99.
   273             20  FILLER                PIC XX.
   274             20  DC-ALPHA-CENTURY.
   275                 24 DC-ALPHA-CEN-N     PIC 99.
   276             20  DC-ALPHA-YEAR         PIC 99.
   277         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   278         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   279         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   280         16  DC-JULIAN-DATE            PIC 9(05).
   281         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL631.cbl
   282                                       PIC 9(05).
   283         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   284             20  DC-JULIAN-YEAR        PIC 99.
   285             20  DC-JULIAN-DAYS        PIC 999.
   286         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   287         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   288         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   289     12  DATE-CONVERSION-VARIBLES.
   290         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   291         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   292             20  FILLER                PIC 9(3).
   293             20  HOLD-CEN-1-CCYY.
   294                 24  HOLD-CEN-1-CC     PIC 99.
   295                 24  HOLD-CEN-1-YY     PIC 99.
   296             20  HOLD-CEN-1-MO         PIC 99.
   297             20  HOLD-CEN-1-DA         PIC 99.
   298         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   299             20  HOLD-CEN-1-R-MO       PIC 99.
   300             20  HOLD-CEN-1-R-DA       PIC 99.
   301             20  HOLD-CEN-1-R-CCYY.
   302                 24  HOLD-CEN-1-R-CC   PIC 99.
   303                 24  HOLD-CEN-1-R-YY   PIC 99.
   304             20  FILLER                PIC 9(3).
   305         16  HOLD-CENTURY-1-X.
   306             20  FILLER                PIC X(3)  VALUE SPACES.
   307             20  HOLD-CEN-1-X-CCYY.
   308                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   309                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   310             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   311             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   312         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   313             20  HOLD-CEN-1-R-X-MO     PIC XX.
   314             20  HOLD-CEN-1-R-X-DA     PIC XX.
   315             20  HOLD-CEN-1-R-X-CCYY.
   316                 24  HOLD-CEN-1-R-X-CC PIC XX.
   317                 24  HOLD-CEN-1-R-X-YY PIC XX.
   318             20  FILLER                PIC XXX.
   319         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   320         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   321         16  DC-JULIAN-DATE-1          PIC 9(07).
   322         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   323             20  DC-JULIAN-1-CCYY.
   324                 24  DC-JULIAN-1-CC    PIC 99.
   325                 24  DC-JULIAN-1-YR    PIC 99.
   326             20  DC-JULIAN-DA-1        PIC 999.
   327         16  DC-JULIAN-DATE-2          PIC 9(07).
   328         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   329             20  DC-JULIAN-2-CCYY.
   330                 24  DC-JULIAN-2-CC    PIC 99.
   331                 24  DC-JULIAN-2-YR    PIC 99.
   332             20  DC-JULIAN-DA-2        PIC 999.
   333         16  DC-GREG-DATE-A-EDIT.
   334             20  DC-EDITA-MONTH        PIC 99.
   335             20  SLASHA-1              PIC X VALUE '/'.
   336             20  DC-EDITA-DAY          PIC 99.
   337             20  SLASHA-2              PIC X VALUE '/'.
   338             20  DC-EDITA-CCYY.
   339                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL631.cbl
   340                 24  DC-EDITA-YEAR     PIC 99.
   341         16  DC-GREG-DATE-B-EDIT.
   342             20  DC-EDITB-MONTH        PIC 99.
   343             20  SLASHB-1              PIC X VALUE '/'.
   344             20  DC-EDITB-DAY          PIC 99.
   345             20  SLASHB-2              PIC X VALUE '/'.
   346             20  DC-EDITB-CCYY.
   347                 24  DC-EDITB-CENT     PIC 99.
   348                 24  DC-EDITB-YEAR     PIC 99.
   349         16  DC-GREG-DATE-CYMD         PIC 9(08).
   350         16  DC-GREG-DATE-CYMD-R REDEFINES
   351                              DC-GREG-DATE-CYMD.
   352             20  DC-CYMD-CEN           PIC 99.
   353             20  DC-CYMD-YEAR          PIC 99.
   354             20  DC-CYMD-MONTH         PIC 99.
   355             20  DC-CYMD-DAY           PIC 99.
   356         16  DC-GREG-DATE-MDCY         PIC 9(08).
   357         16  DC-GREG-DATE-MDCY-R REDEFINES
   358                              DC-GREG-DATE-MDCY.
   359             20  DC-MDCY-MONTH         PIC 99.
   360             20  DC-MDCY-DAY           PIC 99.
   361             20  DC-MDCY-CEN           PIC 99.
   362             20  DC-MDCY-YEAR          PIC 99.
   363    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   364        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   365    12  DC-EL310-DATE                  PIC X(21).
   366    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL631.cbl
   368*    COPY ELCLOGOF.
   369******************************************************************
   370*                                                                *
   371*                                                                *
   372*                            ELCLOGOF.                           *
   373*                            VMOD=2.001                          *
   374*                                                                *
   375*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   376*                                                                *
   377******************************************************************
   378 01  CLASIC-LOGOFF.
   379     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   380     12  LOGOFF-TEXT.
   381         16  FILLER          PIC X(5)    VALUE SPACES.
   382         16  LOGOFF-MSG.
   383             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   384             20  FILLER      PIC X       VALUE SPACES.
   385             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   386         16  FILLER          PIC X(80)
   387           VALUE '* YOU ARE NOW LOGGED OFF'.
   388         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   389         16  FILLER          PIC X       VALUE QUOTE.
   390         16  LOGOFF-SYS-MSG  PIC X(17)
   391           VALUE 'S CLAS-IC SYSTEM '.
   392     12  TEXT-MESSAGES.
   393         16  UNACCESS-MSG    PIC X(29)
   394             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   395         16  PGMIDERR-MSG    PIC X(17)
   396             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL631.cbl
   398*    COPY ELCATTR.
   399******************************************************************
   400*                                                                *
   401*                            ELCATTR.                            *
   402*                            VMOD=2.001                          *
   403*                                                                *
   404*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   405*                                                                *
   406*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   407*                                                                *
   408*                   POS 1   P=PROTECTED                          *
   409*                           U=UNPROTECTED                        *
   410*                           S=ASKIP                              *
   411*                   POS 2   A=ALPHA/NUMERIC                      *
   412*                           N=NUMERIC                            *
   413*                   POS 3   N=NORMAL                             *
   414*                           B=BRIGHT                             *
   415*                           D=DARK                               *
   416*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   417*                           OF=MODIFIED DATA TAG OFF             *
   418*                                                                *
   419*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   420******************************************************************
   421 01  ATTRIBUTE-LIST.
   422     12  AL-PABOF            PIC X       VALUE 'Y'.
   423     12  AL-PABON            PIC X       VALUE 'Z'.
   424     12  AL-PADOF            PIC X       VALUE '%'.
   425     12  AL-PADON            PIC X       VALUE '_'.
   426     12  AL-PANOF            PIC X       VALUE '-'.
   427     12  AL-PANON            PIC X       VALUE '/'.
   428     12  AL-SABOF            PIC X       VALUE '8'.
   429     12  AL-SABON            PIC X       VALUE '9'.
   430     12  AL-SADOF            PIC X       VALUE '@'.
   431     12  AL-SADON            PIC X       VALUE QUOTE.
   432     12  AL-SANOF            PIC X       VALUE '0'.
   433     12  AL-SANON            PIC X       VALUE '1'.
   434     12  AL-UABOF            PIC X       VALUE 'H'.
   435     12  AL-UABON            PIC X       VALUE 'I'.
   436     12  AL-UADOF            PIC X       VALUE '<'.
   437     12  AL-UADON            PIC X       VALUE '('.
   438     12  AL-UANOF            PIC X       VALUE ' '.
   439     12  AL-UANON            PIC X       VALUE 'A'.
   440     12  AL-UNBOF            PIC X       VALUE 'Q'.
   441     12  AL-UNBON            PIC X       VALUE 'R'.
   442     12  AL-UNDOF            PIC X       VALUE '*'.
   443     12  AL-UNDON            PIC X       VALUE ')'.
   444     12  AL-UNNOF            PIC X       VALUE '&'.
   445     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL631.cbl
   447*    COPY ELCEMIB.
   448******************************************************************
   449*                                                                *
   450*                                                                *
   451*                            ELCEMIB.                            *
   452*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   453*                            VMOD=2.005                          *
   454*                                                                *
   455*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   456*                                                                *
   457******************************************************************
   458 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   459     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   460     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   461     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   462     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   463     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   464     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   465     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   466     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   467     12  EMI-SWITCH1             PIC X        VALUE '1'.
   468         88  EMI-NO-ERRORS                    VALUE '1'.
   469         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   470         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   471     12  EMI-SWITCH2             PIC X        VALUE '1'.
   472         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   473     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   474         88  EMI-AREA1-EMPTY                  VALUE '1'.
   475         88  EMI-AREA1-FULL                   VALUE '2'.
   476     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   477         88  EMI-AREA2-EMPTY                  VALUE '1'.
   478         88  EMI-AREA2-FULL                   VALUE '2'.
   479     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   480         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   481         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   482         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   483         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   484         88  EMI-BYPASS-FATALS                VALUE 'X'.
   485     12  EMI-ERROR-LINES.
   486         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   487         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   488         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   489         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   490             20  EMI-ERR-CODES OCCURS 10 TIMES.
   491                 24  EMI-ERR-NUM         PIC X(4).
   492                 24  EMI-FILLER          PIC X.
   493                 24  EMI-SEV             PIC X.
   494                 24  FILLER              PIC X.
   495             20  FILLER                  PIC X(02).
   496     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   497         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   498             20  EMI-ERROR-NUMBER    PIC X(4).
   499             20  EMI-FILL            PIC X.
   500             20  EMI-SEVERITY        PIC X.
   501             20  FILLER              PIC X.
   502             20  EMI-ERROR-TEXT.
   503                 24  EMI-TEXT-VARIABLE   PIC X(10).
   504                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL631.cbl
   505     12  EMI-SEVERITY-SAVE           PIC X.
   506         88  EMI-NOTE                    VALUE 'N'.
   507         88  EMI-WARNING                 VALUE 'W'.
   508         88  EMI-FORCABLE                VALUE 'F'.
   509         88  EMI-FATAL                   VALUE 'X'.
   510     12  EMI-MESSAGE-FLAG            PIC X.
   511         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   512         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   513     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   514     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   515         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   516         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   517         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   518     12  FILLER                      PIC X(137)  VALUE SPACES.
   519     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   520     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   521     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   522     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL631.cbl
   524*    COPY ELCINTF.
   525******************************************************************
   526*                                                                *
   527*                                                                *
   528*                            ELCINTF.                            *
   529*                            VMOD=2.017                          *
   530*                                                                *
   531*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   532*                                                                *
   533*       LENGTH = 1024                                            *
   534*                                                                *
   535******************************************************************
   536*                   C H A N G E   L O G
   537*
   538* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   539*-----------------------------------------------------------------
   540*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   541* EFFECTIVE    NUMBER
   542*-----------------------------------------------------------------
   543* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   544******************************************************************
   545 01  PROGRAM-INTERFACE-BLOCK.
   546     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   547     12  PI-CALLING-PROGRAM              PIC X(8).
   548     12  PI-SAVED-PROGRAM-1              PIC X(8).
   549     12  PI-SAVED-PROGRAM-2              PIC X(8).
   550     12  PI-SAVED-PROGRAM-3              PIC X(8).
   551     12  PI-SAVED-PROGRAM-4              PIC X(8).
   552     12  PI-SAVED-PROGRAM-5              PIC X(8).
   553     12  PI-SAVED-PROGRAM-6              PIC X(8).
   554     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   555     12  PI-COMPANY-ID                   PIC XXX.
   556     12  PI-COMPANY-CD                   PIC X.
   557
   558     12  PI-COMPANY-PASSWORD             PIC X(8).
   559
   560     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   561
   562     12  PI-CONTROL-IN-PROGRESS.
   563         16  PI-CARRIER                  PIC X.
   564         16  PI-GROUPING                 PIC X(6).
   565         16  PI-STATE                    PIC XX.
   566         16  PI-ACCOUNT                  PIC X(10).
   567         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   568                                         PIC X(10).
   569         16  PI-CLAIM-CERT-GRP.
   570             20  PI-CLAIM-NO             PIC X(7).
   571             20  PI-CERT-NO.
   572                 25  PI-CERT-PRIME       PIC X(10).
   573                 25  PI-CERT-SFX         PIC X.
   574             20  PI-CERT-EFF-DT          PIC XX.
   575         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   576             20  PI-PLAN-CODE            PIC X(2).
   577             20  PI-REVISION-NUMBER      PIC X(3).
   578             20  PI-PLAN-EFF-DT          PIC X(2).
   579             20  PI-PLAN-EXP-DT          PIC X(2).
   580             20  FILLER                  PIC X(11).
   581         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL631.cbl
   582             20  PI-OE-REFERENCE-1.
   583                 25  PI-OE-REF-1-PRIME   PIC X(18).
   584                 25  PI-OE-REF-1-SUFF    PIC XX.
   585
   586     12  PI-SESSION-IN-PROGRESS          PIC X.
   587         88  CLAIM-SESSION                   VALUE '1'.
   588         88  CREDIT-SESSION                  VALUE '2'.
   589         88  WARRANTY-SESSION                VALUE '3'.
   590         88  MORTGAGE-SESSION                VALUE '4'.
   591         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   592
   593
   594*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   595
   596     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   597     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   598
   599     12  PI-CREDIT-USER                  PIC X.
   600         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   601         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   602
   603     12  PI-CLAIM-USER                   PIC X.
   604         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   605         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   606
   607     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   608         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   609         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   610         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   611         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   612         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   613
   614     12  PI-PROCESSOR-ID                 PIC X(4).
   615
   616     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   617
   618     12  PI-MEMBER-CAPTION               PIC X(10).
   619
   620     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   621         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   622
   623     12  PI-LIFE-OVERRIDE-L1             PIC X.
   624     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   625     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   626     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   627
   628     12  PI-AH-OVERRIDE-L1               PIC X.
   629     12  PI-AH-OVERRIDE-L2               PIC XX.
   630     12  PI-AH-OVERRIDE-L6               PIC X(6).
   631     12  PI-AH-OVERRIDE-L12              PIC X(12).
   632
   633     12  PI-NEW-SYSTEM                   PIC X(2).
   634
   635     12  PI-PRIMARY-CERT-NO              PIC X(11).
   636     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   637         88  PI-USES-PAID-TO                 VALUE '1'.
   638     12  PI-CRDTCRD-SYSTEM.
   639         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL631.cbl
   640             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   641             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   642         16  PI-CC-MONTH-END-DT          PIC XX.
   643     12  PI-PROCESSOR-PRINTER            PIC X(4).
   644
   645     12  PI-OE-REFERENCE-2.
   646         16  PI-OE-REF-2-PRIME           PIC X(10).
   647         16  PI-OE-REF-2-SUFF            PIC X.
   648
   649     12  PI-REM-TRM-CALC-OPTION          PIC X.
   650
   651     12  PI-LANGUAGE-TYPE                PIC X.
   652             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   653             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   654             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   655
   656     12  PI-POLICY-LINKAGE-IND           PIC X.
   657         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   658         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   659                                                   LOW-VALUES.
   660
   661     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   662     12  PI-CLAIM-PW-SESSION             PIC X(1).
   663         88  PI-CLAIM-CREDIT                 VALUE '1'.
   664         88  PI-CLAIM-CONVEN                 VALUE '2'.
   665
   666     12  PI-PROCESSOR-CSR-IND            PIC X.
   667         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   668         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   669
   670     12  FILLER                          PIC X(3).
   671
   672     12  PI-SYSTEM-LEVEL                 PIC X(145).
   673
   674     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   675         PI-SYSTEM-LEVEL.
   676
   677         16  PI-ENTRY-CODES.
   678             20  PI-ENTRY-CD-1           PIC X.
   679             20  PI-ENTRY-CD-2           PIC X.
   680
   681         16  PI-RETURN-CODES.
   682             20  PI-RETURN-CD-1          PIC X.
   683             20  PI-RETURN-CD-2          PIC X.
   684
   685         16  PI-UPDATE-STATUS-SAVE.
   686             20  PI-UPDATE-BY            PIC X(4).
   687             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   688
   689         16  PI-LOWER-CASE-LETTERS       PIC X.
   690             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   691
   692*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   693*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   694*            88  CARRIER-CLM-CNTL            VALUE '2'.
   695
   696         16  PI-CERT-ACCESS-CONTROL      PIC X.
   697             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL631.cbl
   698             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   699             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   700             88  ACCNT-CNTL                  VALUE '3'.
   701             88  CARR-ACCNT-CNTL             VALUE '4'.
   702
   703         16  PI-PROCESSOR-CAP-LIST.
   704             20  PI-SYSTEM-CONTROLS.
   705                24 PI-SYSTEM-DISPLAY     PIC X.
   706                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   707                24 PI-SYSTEM-MODIFY      PIC X.
   708                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   709             20  FILLER                  PIC XX.
   710             20  PI-DISPLAY-CAP          PIC X.
   711                 88  DISPLAY-CAP             VALUE 'Y'.
   712             20  PI-MODIFY-CAP           PIC X.
   713                 88  MODIFY-CAP              VALUE 'Y'.
   714             20  PI-MSG-AT-LOGON-CAP     PIC X.
   715                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   716             20  PI-FORCE-CAP            PIC X.
   717                 88  FORCE-CAP               VALUE 'Y'.
   718
   719         16  PI-PROGRAM-CONTROLS.
   720             20  PI-PGM-PRINT-OPT        PIC X.
   721             20  PI-PGM-FORMAT-OPT       PIC X.
   722             20  PI-PGM-PROCESS-OPT      PIC X.
   723             20  PI-PGM-TOTALS-OPT       PIC X.
   724
   725         16  PI-HELP-INTERFACE.
   726             20  PI-LAST-ERROR-NO        PIC X(4).
   727             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   728
   729         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   730             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   731
   732         16  PI-CR-CONTROL-IN-PROGRESS.
   733             20  PI-CR-CARRIER           PIC X.
   734             20  PI-CR-GROUPING          PIC X(6).
   735             20  PI-CR-STATE             PIC XX.
   736             20  PI-CR-ACCOUNT           PIC X(10).
   737             20  PI-CR-FIN-RESP          PIC X(10).
   738             20  PI-CR-TYPE              PIC X.
   739
   740         16  PI-CR-BATCH-NUMBER          PIC X(6).
   741
   742         16  PI-CR-MONTH-END-DT          PIC XX.
   743
   744         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   745             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   746             88  PI-ZERO-CARRIER             VALUE '1'.
   747             88  PI-ZERO-GROUPING            VALUE '2'.
   748             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   749
   750         16  PI-CARRIER-SECURITY         PIC X.
   751             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   752
   753         16  PI-ACCOUNT-SECURITY         PIC X(10).
   754             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   755             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL631.cbl
   756
   757         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   758             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   759                                         INDEXED BY PI-ACCESS-NDX
   760                                         PIC X.
   761
   762         16  PI-GA-BILLING-CONTROL       PIC X.
   763             88  PI-GA-BILLING               VALUE '1'.
   764
   765         16  PI-MAIL-PROCESSING          PIC X.
   766             88  PI-MAIL-YES                 VALUE 'Y'.
   767
   768         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   769
   770         16  PI-AR-SYSTEM.
   771             20  PI-AR-PROCESSING-CNTL   PIC X.
   772                 88  PI-AR-PROCESSING        VALUE 'Y'.
   773             20  PI-AR-SUMMARY-CODE      PIC X(6).
   774             20  PI-AR-MONTH-END-DT      PIC XX.
   775
   776         16  PI-MP-SYSTEM.
   777             20  PI-MORTGAGE-USER            PIC X.
   778                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   779                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   780             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   781                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   782                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   783                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   784                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   785                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   786             20  PI-MP-MONTH-END-DT          PIC XX.
   787             20  PI-MP-REFERENCE-NO.
   788                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   789                 24  PI-MP-REFERENCE-SFX     PIC XX.
   790
   791         16  PI-LABEL-CONTROL            PIC X(01).
   792             88  PI-CREATE-LABELS                    VALUE 'Y'.
   793             88  PI-BYPASS-LABELS                    VALUE 'N'.
   794
   795         16  PI-BILL-GROUPING-CODE       PIC X(01).
   796             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   797
   798         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   799             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   800             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   801
   802         16  FILLER                      PIC X(14).
   803
   804     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   805******************************************************************
   806     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   807*    COPY ELC631PI.
   808******************************************************************
   809*                                                                *
   810*                                                                *
   811*                            ELC631PI                            *
   812*                            VMOD=2.012                          *
   813*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL631.cbl
   814*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   815*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   816*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   817*                                                                *
   818*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   819*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   820*    BETWEEN PROGRAMS.                                           *
   821*                                                                *
   822*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   823*                                                                *
   824*               EL631 - EL6311 - EL6312 - EL6313                 *
   825*                                                                *
   826******************************************************************
   827
   828         16  PI-631-DATA.
   829             20  PI-ERPNDB-KEY.
   830                 24  PI-PB-COMPANY-CD     PIC X.
   831                 24  PI-PB-ENTRY-BATCH    PIC X(6).
   832                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
   833                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
   834
   835             20  PI-ERPNDB-ALT-KEY.
   836                 24  PI-PB-COMPANY-CD-A1  PIC X.
   837                 24  PI-PB-CARRIER        PIC X.
   838                 24  PI-PB-GROUPING       PIC X(6).
   839                 24  PI-PB-STATE          PIC XX.
   840                 24  PI-PB-ACCOUNT        PIC X(10).
   841                 24  PI-PB-CERT-EFF-DT    PIC XX.
   842                 24  PI-PB-CERT-NO.
   843                     28  PI-PB-CERT-PRIME PIC X(10).
   844                     28  PI-PB-CERT-SFX   PIC X.
   845                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
   846                 24  PI-PB-RECORD-TYPE    PIC X.
   847
   848             20  PI-ERPNDB-CSR-KEY.
   849                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
   850                 24  PI-PB-CSR-ID             PIC X(4).
   851                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
   852                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
   853                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
   854
   855             20  PI-BROWSE-TYPE               PIC X.
   856                 88  PI-FILE-BROWSE             VALUE ' '.
   857                 88  PI-PRIMARY-BROWSE          VALUE '1'.
   858                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
   859                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
   860                 88  PI-CSR-BROWSE              VALUE '4'.
   861
   862             20  PI-MAINT-FUNCTION            PIC X.
   863                 88  PI-ADD-FUNCTION            VALUE 'A'.
   864                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
   865                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
   866                 88  PI-DELETE-FUNCTION         VALUE 'D'.
   867                 88  PI-SHOW-FUNCTION           VALUE 'S'.
   868                 88  PI-PF5-FUNCTION            VALUE '5'.
   869                 88  PI-PF6-FUNCTION            VALUE '6'.
   870
   871             20  PI-FILE-SWITCHES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL631.cbl
   872                 24  PI-ALL-ISSUES-SW         PIC X.
   873                     88  ALL-ISSUES             VALUE 'Y'.
   874                 24  PI-ALL-CANCELS-SW        PIC X.
   875                     88  ALL-CANCELS            VALUE 'Y'.
   876                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
   877                     88  ISSUES-IN-ERROR        VALUE 'Y'.
   878                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
   879                     88  CANCEL-IN-ERROR        VALUE 'Y'.
   880                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
   881                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
   882                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
   883                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
   884                 24  PI-HOLD-REC-SW           PIC X.
   885                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
   886                 24  PI-CHANGE-REC-SW         PIC X.
   887                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
   888                 24  PI-CHK-REQ-REC-SW        PIC X.
   889                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
   890                 24  PI-ISSUE-WARNING-SW      PIC X.
   891                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
   892                 24  PI-CANCEL-WARNING-SW     PIC X.
   893                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
   894             20  PI-DISPLAY-SCREEN-SW         PIC X.
   895                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
   896             20  PI-ORIGINAL-BATCH-SW         PIC X.
   897                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
   898
   899             20  PI-MAP-NAME                  PIC X(8).
   900
   901             20  PI-CURSOR                    PIC S9(4) COMP.
   902
   903             20  PI-PREV-ALT-KEY              PIC X(36).
   904             20  PI-PREV-CSR-KEY              PIC X(15).
   905             20  PI-PREV-KEY.
   906                 24  PI-PREV-COMPANY-CD       PIC X.
   907                 24  PI-PREV-BATCH            PIC X(6).
   908                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
   909                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
   910             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
   911             20  PI-BROWSE-SW                 PIC X.
   912                 88  PI-GOOD-BROWSE             VALUE 'Y'.
   913                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
   914             20  PI-SV-CARRIER                PIC X.
   915             20  PI-SV-GROUPING               PIC X(6).
   916             20  PI-SV-STATE                  PIC XX.
   917             20  PI-EDIT-SW                   PIC X.
   918             20  PI-DISPLAY-SW                PIC XX.
   919                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
   920                 88 PI-DISPLAY-AH          VALUE 'AH'.
   921             20  PI-CRITERIA-DATA             PIC X(350).
   922             20  PI-BMODE                     PIC X.
   923             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
   924             20  PI-BPMTS                     PIC S999     COMP-3.
   925             20  PI-BTYPE                     PIC XXX OCCURS 2.
   926             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
   927             20  PI-CSR-SESSION-SW            PIC X.
   928                 88  CSR-EDIT-SESSION           VALUE 'Y'.
   929             20  PI-ERRORS-SW                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL631.cbl
   930                 88  FATAL-ERRORS               VALUE 'X'.
   931*                88  FATAL-OR-UNFORCED          VALUE 'X'.
   932             20  FILLER                       PIC X(5).
   933
   934         16  FILLER              PIC X(94).
   935
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL631.cbl
   937
   938*    COPY ELCAID.
   939******************************************************************
   940*                                                                *
   941*                            ELCAID.                             *
   942*                            VMOD=2.001                          *
   943*                                                                *
   944*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   945*                                                                *
   946*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   947*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   948******************************************************************
   949
   950 01  DFHAID.
   951   02  DFHNULL   PIC  X  VALUE  ' '.
   952   02  DFHENTER  PIC  X  VALUE  QUOTE.
   953   02  DFHCLEAR  PIC  X  VALUE  '_'.
   954   02  DFHPEN    PIC  X  VALUE  '='.
   955   02  DFHOPID   PIC  X  VALUE  'W'.
   956   02  DFHPA1    PIC  X  VALUE  '%'.
   957   02  DFHPA2    PIC  X  VALUE  '>'.
   958   02  DFHPA3    PIC  X  VALUE  ','.
   959   02  DFHPF1    PIC  X  VALUE  '1'.
   960   02  DFHPF2    PIC  X  VALUE  '2'.
   961   02  DFHPF3    PIC  X  VALUE  '3'.
   962   02  DFHPF4    PIC  X  VALUE  '4'.
   963   02  DFHPF5    PIC  X  VALUE  '5'.
   964   02  DFHPF6    PIC  X  VALUE  '6'.
   965   02  DFHPF7    PIC  X  VALUE  '7'.
   966   02  DFHPF8    PIC  X  VALUE  '8'.
   967   02  DFHPF9    PIC  X  VALUE  '9'.
   968   02  DFHPF10   PIC  X  VALUE  ':'.
   969   02  DFHPF11   PIC  X  VALUE  '#'.
   970   02  DFHPF12   PIC  X  VALUE  '@'.
   971   02  DFHPF13   PIC  X  VALUE  'A'.
   972   02  DFHPF14   PIC  X  VALUE  'B'.
   973   02  DFHPF15   PIC  X  VALUE  'C'.
   974   02  DFHPF16   PIC  X  VALUE  'D'.
   975   02  DFHPF17   PIC  X  VALUE  'E'.
   976   02  DFHPF18   PIC  X  VALUE  'F'.
   977   02  DFHPF19   PIC  X  VALUE  'G'.
   978   02  DFHPF20   PIC  X  VALUE  'H'.
   979   02  DFHPF21   PIC  X  VALUE  'I'.
   980*00039    02  DFHPF22   PIC  X  VALUE  ''.
   981   02  DFHPF22   PIC  X  VALUE  '['.
   982   02  DFHPF23   PIC  X  VALUE  '.'.
   983   02  DFHPF24   PIC  X  VALUE  '<'.
   984   02  DFHMSRE   PIC  X  VALUE  'X'.
   985   02  DFHSTRF   PIC  X  VALUE  'h'.
   986   02  DFHTRIG   PIC  X  VALUE  '"'.
   987 01  FILLER    REDEFINES DFHAID.
   988     12  FILLER                  PIC X(8).
   989     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
   990
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL631.cbl
   992
   993*    COPY EL631S.
   994 01  EL631AI.
   995     05  FILLER            PIC  X(0012).
   996*    -------------------------------
   997     05  DATEL PIC S9(0004) COMP.
   998     05  DATEF PIC  X(0001).
   999     05  FILLER REDEFINES DATEF.
  1000         10  DATEA PIC  X(0001).
  1001     05  DATEI PIC  X(0008).
  1002*    -------------------------------
  1003     05  TIMEL PIC S9(0004) COMP.
  1004     05  TIMEF PIC  X(0001).
  1005     05  FILLER REDEFINES TIMEF.
  1006         10  TIMEA PIC  X(0001).
  1007     05  TIMEI PIC  X(0005).
  1008*    -------------------------------
  1009     05  HEADL PIC S9(0004) COMP.
  1010     05  HEADF PIC  X(0001).
  1011     05  FILLER REDEFINES HEADF.
  1012         10  HEADA PIC  X(0001).
  1013     05  HEADI PIC  X(0038).
  1014*    -------------------------------
  1015     05  MODL PIC S9(0004) COMP.
  1016     05  MODF PIC  X(0001).
  1017     05  FILLER REDEFINES MODF.
  1018         10  MODA PIC  X(0001).
  1019     05  MODI PIC  X(0003).
  1020*    -------------------------------
  1021     05  BATCHL PIC S9(0004) COMP.
  1022     05  BATCHF PIC  X(0001).
  1023     05  FILLER REDEFINES BATCHF.
  1024         10  BATCHA PIC  X(0001).
  1025     05  BATCHI PIC  X(0006).
  1026*    -------------------------------
  1027     05  SEQL PIC S9(0004) COMP.
  1028     05  SEQF PIC  X(0001).
  1029     05  FILLER REDEFINES SEQF.
  1030         10  SEQA PIC  X(0001).
  1031     05  SEQI PIC  X(0004).
  1032*    -------------------------------
  1033     05  CARRIERL PIC S9(0004) COMP.
  1034     05  CARRIERF PIC  X(0001).
  1035     05  FILLER REDEFINES CARRIERF.
  1036         10  CARRIERA PIC  X(0001).
  1037     05  CARRIERI PIC  X(0001).
  1038*    -------------------------------
  1039     05  GROUPL PIC S9(0004) COMP.
  1040     05  GROUPF PIC  X(0001).
  1041     05  FILLER REDEFINES GROUPF.
  1042         10  GROUPA PIC  X(0001).
  1043     05  GROUPI PIC  X(0006).
  1044*    -------------------------------
  1045     05  STATEL PIC S9(0004) COMP.
  1046     05  STATEF PIC  X(0001).
  1047     05  FILLER REDEFINES STATEF.
  1048         10  STATEA PIC  X(0001).
  1049     05  STATEI PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL631.cbl
  1050*    -------------------------------
  1051     05  ACCOUNTL PIC S9(0004) COMP.
  1052     05  ACCOUNTF PIC  X(0001).
  1053     05  FILLER REDEFINES ACCOUNTF.
  1054         10  ACCOUNTA PIC  X(0001).
  1055     05  ACCOUNTI PIC  X(0010).
  1056*    -------------------------------
  1057     05  EFFDTL PIC S9(0004) COMP.
  1058     05  EFFDTF PIC  X(0001).
  1059     05  FILLER REDEFINES EFFDTF.
  1060         10  EFFDTA PIC  X(0001).
  1061     05  EFFDTI PIC  X(0008).
  1062*    -------------------------------
  1063     05  CERTNOL PIC S9(0004) COMP.
  1064     05  CERTNOF PIC  X(0001).
  1065     05  FILLER REDEFINES CERTNOF.
  1066         10  CERTNOA PIC  X(0001).
  1067     05  CERTNOI PIC  X(0010).
  1068*    -------------------------------
  1069     05  SUFFIXL PIC S9(0004) COMP.
  1070     05  SUFFIXF PIC  X(0001).
  1071     05  FILLER REDEFINES SUFFIXF.
  1072         10  SUFFIXA PIC  X(0001).
  1073     05  SUFFIXI PIC  X(0001).
  1074*    -------------------------------
  1075     05  CSRHDL PIC S9(0004) COMP.
  1076     05  CSRHDF PIC  X(0001).
  1077     05  FILLER REDEFINES CSRHDF.
  1078         10  CSRHDA PIC  X(0001).
  1079     05  CSRHDI PIC  X(0004).
  1080*    -------------------------------
  1081     05  CSRL PIC S9(0004) COMP.
  1082     05  CSRF PIC  X(0001).
  1083     05  FILLER REDEFINES CSRF.
  1084         10  CSRA PIC  X(0001).
  1085     05  CSRI PIC  X(0004).
  1086*    -------------------------------
  1087     05  ANYISSL PIC S9(0004) COMP.
  1088     05  ANYISSF PIC  X(0001).
  1089     05  FILLER REDEFINES ANYISSF.
  1090         10  ANYISSA PIC  X(0001).
  1091     05  ANYISSI PIC  X(0001).
  1092*    -------------------------------
  1093     05  ANYCANL PIC S9(0004) COMP.
  1094     05  ANYCANF PIC  X(0001).
  1095     05  FILLER REDEFINES ANYCANF.
  1096         10  ANYCANA PIC  X(0001).
  1097     05  ANYCANI PIC  X(0001).
  1098*    -------------------------------
  1099     05  ALLISSL PIC S9(0004) COMP.
  1100     05  ALLISSF PIC  X(0001).
  1101     05  FILLER REDEFINES ALLISSF.
  1102         10  ALLISSA PIC  X(0001).
  1103     05  ALLISSI PIC  X(0001).
  1104*    -------------------------------
  1105     05  ALLCANL PIC S9(0004) COMP.
  1106     05  ALLCANF PIC  X(0001).
  1107     05  FILLER REDEFINES ALLCANF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL631.cbl
  1108         10  ALLCANA PIC  X(0001).
  1109     05  ALLCANI PIC  X(0001).
  1110*    -------------------------------
  1111     05  ONLYHDRL PIC S9(0004) COMP.
  1112     05  ONLYHDRF PIC  X(0001).
  1113     05  FILLER REDEFINES ONLYHDRF.
  1114         10  ONLYHDRA PIC  X(0001).
  1115     05  ONLYHDRI PIC  X(0001).
  1116*    -------------------------------
  1117     05  OUTBALL PIC S9(0004) COMP.
  1118     05  OUTBALF PIC  X(0001).
  1119     05  FILLER REDEFINES OUTBALF.
  1120         10  OUTBALA PIC  X(0001).
  1121     05  OUTBALI PIC  X(0001).
  1122*    -------------------------------
  1123     05  ORGINALL PIC S9(0004) COMP.
  1124     05  ORGINALF PIC  X(0001).
  1125     05  FILLER REDEFINES ORGINALF.
  1126         10  ORGINALA PIC  X(0001).
  1127     05  ORGINALI PIC  X(0001).
  1128*    -------------------------------
  1129     05  ORGHDRL PIC S9(0004) COMP.
  1130     05  ORGHDRF PIC  X(0001).
  1131     05  FILLER REDEFINES ORGHDRF.
  1132         10  ORGHDRA PIC  X(0001).
  1133     05  ORGHDRI PIC  X(0028).
  1134*    -------------------------------
  1135     05  HLDRECL PIC S9(0004) COMP.
  1136     05  HLDRECF PIC  X(0001).
  1137     05  FILLER REDEFINES HLDRECF.
  1138         10  HLDRECA PIC  X(0001).
  1139     05  HLDRECI PIC  X(0001).
  1140*    -------------------------------
  1141     05  CHGRECL PIC S9(0004) COMP.
  1142     05  CHGRECF PIC  X(0001).
  1143     05  FILLER REDEFINES CHGRECF.
  1144         10  CHGRECA PIC  X(0001).
  1145     05  CHGRECI PIC  X(0001).
  1146*    -------------------------------
  1147     05  CHKREQL PIC S9(0004) COMP.
  1148     05  CHKREQF PIC  X(0001).
  1149     05  FILLER REDEFINES CHKREQF.
  1150         10  CHKREQA PIC  X(0001).
  1151     05  CHKREQI PIC  X(0001).
  1152*    -------------------------------
  1153     05  STARTATL PIC S9(0004) COMP.
  1154     05  STARTATF PIC  X(0001).
  1155     05  FILLER REDEFINES STARTATF.
  1156         10  STARTATA PIC  X(0001).
  1157     05  STARTATI PIC  X(0001).
  1158*    -------------------------------
  1159     05  ANYISSWL PIC S9(0004) COMP.
  1160     05  ANYISSWF PIC  X(0001).
  1161     05  FILLER REDEFINES ANYISSWF.
  1162         10  ANYISSWA PIC  X(0001).
  1163     05  ANYISSWI PIC  X(0001).
  1164*    -------------------------------
  1165     05  ANYCANWL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL631.cbl
  1166     05  ANYCANWF PIC  X(0001).
  1167     05  FILLER REDEFINES ANYCANWF.
  1168         10  ANYCANWA PIC  X(0001).
  1169     05  ANYCANWI PIC  X(0001).
  1170*    -------------------------------
  1171     05  ERRMSG1L PIC S9(0004) COMP.
  1172     05  ERRMSG1F PIC  X(0001).
  1173     05  FILLER REDEFINES ERRMSG1F.
  1174         10  ERRMSG1A PIC  X(0001).
  1175     05  ERRMSG1I PIC  X(0079).
  1176*    -------------------------------
  1177     05  ERRMSG2L PIC S9(0004) COMP.
  1178     05  ERRMSG2F PIC  X(0001).
  1179     05  FILLER REDEFINES ERRMSG2F.
  1180         10  ERRMSG2A PIC  X(0001).
  1181     05  ERRMSG2I PIC  X(0079).
  1182*    -------------------------------
  1183     05  PFENTERL PIC S9(0004) COMP.
  1184     05  PFENTERF PIC  X(0001).
  1185     05  FILLER REDEFINES PFENTERF.
  1186         10  PFENTERA PIC  X(0001).
  1187     05  PFENTERI PIC  99.
  1188 01  EL631AO REDEFINES EL631AI.
  1189     05  FILLER            PIC  X(0012).
  1190*    -------------------------------
  1191     05  FILLER            PIC  X(0003).
  1192     05  DATEO PIC  X(0008).
  1193*    -------------------------------
  1194     05  FILLER            PIC  X(0003).
  1195     05  TIMEO PIC  99.99.
  1196*    -------------------------------
  1197     05  FILLER            PIC  X(0003).
  1198     05  HEADO PIC  X(0038).
  1199*    -------------------------------
  1200     05  FILLER            PIC  X(0003).
  1201     05  MODO PIC  X(0003).
  1202*    -------------------------------
  1203     05  FILLER            PIC  X(0003).
  1204     05  BATCHO PIC  X(0006).
  1205*    -------------------------------
  1206     05  FILLER            PIC  X(0003).
  1207     05  SEQO PIC  X(0004).
  1208*    -------------------------------
  1209     05  FILLER            PIC  X(0003).
  1210     05  CARRIERO PIC  X(0001).
  1211*    -------------------------------
  1212     05  FILLER            PIC  X(0003).
  1213     05  GROUPO PIC  X(0006).
  1214*    -------------------------------
  1215     05  FILLER            PIC  X(0003).
  1216     05  STATEO PIC  X(0002).
  1217*    -------------------------------
  1218     05  FILLER            PIC  X(0003).
  1219     05  ACCOUNTO PIC  X(0010).
  1220*    -------------------------------
  1221     05  FILLER            PIC  X(0003).
  1222     05  EFFDTO PIC  X(0008).
  1223*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL631.cbl
  1224     05  FILLER            PIC  X(0003).
  1225     05  CERTNOO PIC  X(0010).
  1226*    -------------------------------
  1227     05  FILLER            PIC  X(0003).
  1228     05  SUFFIXO PIC  X(0001).
  1229*    -------------------------------
  1230     05  FILLER            PIC  X(0003).
  1231     05  CSRHDO PIC  X(0004).
  1232*    -------------------------------
  1233     05  FILLER            PIC  X(0003).
  1234     05  CSRO PIC  X(0004).
  1235*    -------------------------------
  1236     05  FILLER            PIC  X(0003).
  1237     05  ANYISSO PIC  X(0001).
  1238*    -------------------------------
  1239     05  FILLER            PIC  X(0003).
  1240     05  ANYCANO PIC  X(0001).
  1241*    -------------------------------
  1242     05  FILLER            PIC  X(0003).
  1243     05  ALLISSO PIC  X(0001).
  1244*    -------------------------------
  1245     05  FILLER            PIC  X(0003).
  1246     05  ALLCANO PIC  X(0001).
  1247*    -------------------------------
  1248     05  FILLER            PIC  X(0003).
  1249     05  ONLYHDRO PIC  X(0001).
  1250*    -------------------------------
  1251     05  FILLER            PIC  X(0003).
  1252     05  OUTBALO PIC  X(0001).
  1253*    -------------------------------
  1254     05  FILLER            PIC  X(0003).
  1255     05  ORGINALO PIC  X(0001).
  1256*    -------------------------------
  1257     05  FILLER            PIC  X(0003).
  1258     05  ORGHDRO PIC  X(0028).
  1259*    -------------------------------
  1260     05  FILLER            PIC  X(0003).
  1261     05  HLDRECO PIC  X(0001).
  1262*    -------------------------------
  1263     05  FILLER            PIC  X(0003).
  1264     05  CHGRECO PIC  X(0001).
  1265*    -------------------------------
  1266     05  FILLER            PIC  X(0003).
  1267     05  CHKREQO PIC  X(0001).
  1268*    -------------------------------
  1269     05  FILLER            PIC  X(0003).
  1270     05  STARTATO PIC  X(0001).
  1271*    -------------------------------
  1272     05  FILLER            PIC  X(0003).
  1273     05  ANYISSWO PIC  X(0001).
  1274*    -------------------------------
  1275     05  FILLER            PIC  X(0003).
  1276     05  ANYCANWO PIC  X(0001).
  1277*    -------------------------------
  1278     05  FILLER            PIC  X(0003).
  1279     05  ERRMSG1O PIC  X(0079).
  1280*    -------------------------------
  1281     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL631.cbl
  1282     05  ERRMSG2O PIC  X(0079).
  1283*    -------------------------------
  1284     05  FILLER            PIC  X(0003).
  1285     05  PFENTERO PIC  99.
  1286*    -------------------------------
  1287
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL631.cbl
  1289
  1290****************************************************************
  1291*
  1292* Copyright (c) 2007 by Clerity Solutions, Inc.
  1293* All rights reserved.
  1294*
  1295****************************************************************
  1296 01  DFHEIV.
  1297   02  DFHEIV0               PIC X(35).
  1298   02  DFHEIV1               PIC X(08).
  1299   02  DFHEIV2               PIC X(08).
  1300   02  DFHEIV3               PIC X(08).
  1301   02  DFHEIV4               PIC X(06).
  1302   02  DFHEIV5               PIC X(04).
  1303   02  DFHEIV6               PIC X(04).
  1304   02  DFHEIV7               PIC X(02).
  1305   02  DFHEIV8               PIC X(02).
  1306   02  DFHEIV9               PIC X(01).
  1307   02  DFHEIV10              PIC S9(7) COMP-3.
  1308   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1309   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1310   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1311   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1312   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1313   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1314   02  DFHEIV17              PIC X(04).
  1315   02  DFHEIV18              PIC X(04).
  1316   02  DFHEIV19              PIC X(04).
  1317   02  DFHEIV20              USAGE IS POINTER.
  1318   02  DFHEIV21              USAGE IS POINTER.
  1319   02  DFHEIV22              USAGE IS POINTER.
  1320   02  DFHEIV23              USAGE IS POINTER.
  1321   02  DFHEIV24              USAGE IS POINTER.
  1322   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1323   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1324   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1325   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1326   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1327   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1328   02  FILLER                PIC X(02).
  1329   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1330   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1331   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1332   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1333   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1334 LINKAGE  SECTION.
  1335*****************************************************************
  1336*                                                               *
  1337* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1338* All rights reserved.                                          *
  1339*                                                               *
  1340*****************************************************************
  1341 01  dfheiblk.
  1342     02  eibtime          pic s9(7) comp-3.
  1343     02  eibdate          pic s9(7) comp-3.
  1344     02  eibtrnid         pic x(4).
  1345     02  eibtaskn         pic s9(7) comp-3.
  1346     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL631.cbl
  1347     02  dfheigdi         pic s9(4) comp.
  1348     02  eibcposn         pic s9(4) comp.
  1349     02  eibcalen         pic s9(4) comp.
  1350     02  eibaid           pic x(1).
  1351     02  eibfiller1       pic x(1).
  1352     02  eibfn            pic x(2).
  1353     02  eibfiller2       pic x(2).
  1354     02  eibrcode         pic x(6).
  1355     02  eibfiller3       pic x(2).
  1356     02  eibds            pic x(8).
  1357     02  eibreqid         pic x(8).
  1358     02  eibrsrce         pic x(8).
  1359     02  eibsync          pic x(1).
  1360     02  eibfree          pic x(1).
  1361     02  eibrecv          pic x(1).
  1362     02  eibsend          pic x(1).
  1363     02  eibatt           pic x(1).
  1364     02  eibeoc           pic x(1).
  1365     02  eibfmh           pic x(1).
  1366     02  eibcompl         pic x(1).
  1367     02  eibsig           pic x(1).
  1368     02  eibconf          pic x(1).
  1369     02  eiberr           pic x(1).
  1370     02  eibrldbk         pic x(1).
  1371     02  eiberrcd         pic x(4).
  1372     02  eibsynrb         pic x(1).
  1373     02  eibnodat         pic x(1).
  1374     02  eibfiller5       pic x(2).
  1375     02  eibresp          pic 9(09) comp.
  1376     02  eibresp2         pic 9(09) comp.
  1377     02  dfheigdj         pic s9(4) comp.
  1378     02  dfheigdk         pic s9(4) comp.
  1379 01  DFHCOMMAREA                 PIC X(1300).
  1380
  1381*01 PARMLIST .
  1382*    02  FILLER                  PIC S9(8)   COMP.
  1383*    02  ERPNDB-POINTER          PIC S9(8)   COMP.
  1384*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  1385
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL631.cbl
  1387*    COPY ERCPNDB.
  1388******************************************************************
  1389*                                                                *
  1390*                                                                *
  1391*                            ERCPNDB.                            *
  1392*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1393*                            VMOD=2.025                          *
  1394*                                                                *
  1395*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1396*                                                                *
  1397******************************************************************
  1398*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1399*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1400******************************************************************
  1401*                                                                *
  1402*                                                                *
  1403*   FILE TYPE = VSAM,KSDS                                        *
  1404*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1405*                                                                *
  1406*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1407*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1408*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1409*                                                 RKP=13,LEN=36  *
  1410*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1411*                                      AND CHG-SEQ.)             *
  1412*                                                RKP=49,LEN=11   *
  1413*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1414*                                      AND CHG-SEQ.)             *
  1415*                                                RKP=60,LEN=15   *
  1416*                                                                *
  1417*   LOG = NO                                                     *
  1418*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1419******************************************************************
  1420******************************************************************
  1421*                   C H A N G E   L O G
  1422*
  1423* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1424*-----------------------------------------------------------------
  1425*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1426* EFFECTIVE    NUMBER
  1427*-----------------------------------------------------------------
  1428* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1429* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1430* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1431* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1432* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1433* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1434* 032306                   PEMA  ADD BOW LOAN NUMBER
  1435* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1436* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1437* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1438* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1439* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1440* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  1441* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1442* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1443******************************************************************
  1444
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL631.cbl
  1445 01  PENDING-BUSINESS.
  1446     12  PB-RECORD-ID                     PIC XX.
  1447         88  VALID-PB-ID                        VALUE 'PB'.
  1448
  1449     12  PB-CONTROL-PRIMARY.
  1450         16  PB-COMPANY-CD                PIC X.
  1451         16  PB-ENTRY-BATCH               PIC X(6).
  1452         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1453         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1454
  1455     12  PB-CONTROL-BY-ACCOUNT.
  1456         16  PB-COMPANY-CD-A1             PIC X.
  1457         16  PB-CARRIER                   PIC X.
  1458         16  PB-GROUPING.
  1459             20  PB-GROUPING-PREFIX       PIC XXX.
  1460             20  PB-GROUPING-PRIME        PIC XXX.
  1461         16  PB-STATE                     PIC XX.
  1462         16  PB-ACCOUNT.
  1463             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1464             20  PB-ACCOUNT-PRIME         PIC X(6).
  1465         16  PB-CERT-EFF-DT               PIC XX.
  1466         16  PB-CERT-NO.
  1467             20  PB-CERT-PRIME            PIC X(10).
  1468             20  PB-CERT-SFX              PIC X.
  1469         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1470
  1471         16  PB-RECORD-TYPE               PIC X.
  1472             88  PB-MAILING-DATA                VALUE '0'.
  1473             88  PB-ISSUE                       VALUE '1'.
  1474             88  PB-CANCELLATION                VALUE '2'.
  1475             88  PB-BATCH-TRAILER               VALUE '9'.
  1476
  1477     12  PB-CONTROL-BY-ORIG-BATCH.
  1478         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1479         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1480         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1481         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1482
  1483     12  PB-CONTROL-BY-CSR.
  1484         16  PB-CSR-COMPANY-CD            PIC X.
  1485         16  PB-CSR-ID                    PIC X(4).
  1486         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1487         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1488         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1489******************************************************************
  1490*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1491******************************************************************
  1492
  1493     12  PB-LAST-MAINT-DT                 PIC XX.
  1494     12  PB-LAST-MAINT-BY                 PIC X(4).
  1495     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1496
  1497     12  PB-RECORD-BODY                   PIC X(375).
  1498
  1499     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1500         16  PB-CERT-ORIGIN               PIC X.
  1501             88  CLASIC-CREATED-CERT         VALUE '1'.
  1502         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL631.cbl
  1503             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1504             20  PB-I-INSURED-FIRST-NAME.
  1505                 24  PB-I-INSURED-1ST-INIT PIC X.
  1506                 24  FILLER                PIC X(9).
  1507             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1508         16  PB-I-AGE                     PIC S99   COMP-3.
  1509         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1510         16  PB-I-BIRTHDAY                PIC XX.
  1511         16  PB-I-INSURED-SEX             PIC X.
  1512             88  PB-SEX-MALE     VALUE 'M'.
  1513             88  PB-SEX-FEMALE   VALUE 'F'.
  1514
  1515         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1516         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1517         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1518         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1519         16  PB-I-SKIP-CODE               PIC X.
  1520             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1521             88  PB-SKIP-JULY              VALUE '1'.
  1522             88  PB-SKIP-AUGUST            VALUE '2'.
  1523             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1524             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1525             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1526             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1527             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1528             88  PB-SKIP-JUNE              VALUE '8'.
  1529             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1530             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1531             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1532         16  PB-I-TERM-TYPE               PIC X.
  1533             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1534             88  PB-PAID-WEEKLY            VALUE 'W'.
  1535             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1536             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1537             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1538         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1539         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1540         16  PB-I-DATA-ENTRY-SW           PIC X.
  1541             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1542             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1543             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1544             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1545         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1546         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1547*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1548         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1549         16  FILLER                       PIC X.
  1550
  1551         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1552             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1553             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1554                                                   '90' THRU '99'.
  1555         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1556                                          PIC XX.
  1557         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1558         16  PB-I-AMOUNT-FINANCED REDEFINES
  1559                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  1560         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL631.cbl
  1561         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1562                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1563         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1564         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1565         16  PB-I-CLP-AMOUNT REDEFINES
  1566                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1567         16  PB-I-LF-CALC-FLAG            PIC X.
  1568             88 PB-COMP-LF-PREM               VALUE '?'.
  1569         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1570         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1571         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1572         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1573         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1574         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1575         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1576         16  PB-I-LF-ABBR                 PIC XXX.
  1577         16  PB-I-LF-INPUT-CD             PIC XX.
  1578
  1579         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1580             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1581             88  PB-INVALID-AH               VALUE '  ' '00'
  1582                                                   '90' THRU '99'.
  1583         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1584         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1585         16  PB-I-AH-CALC-FLAG            PIC X.
  1586             88 PB-COMP-AH-PREM                  VALUE '?'.
  1587         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  1588         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  1589         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1590         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  1591         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  1592         16  PB-I-AH-ABBR                 PIC XXX.
  1593         16  PB-I-AH-INPUT-CD             PIC XXX.
  1594
  1595         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  1596         16  PB-I-REIN-TABLE              PIC XXX.
  1597         16  PB-I-BUSINESS-TYPE           PIC 99.
  1598         16  PB-I-INDV-GRP-CD             PIC X.
  1599         16  PB-I-MORT-CODE.
  1600             20  PB-I-TABLE               PIC X.
  1601             20  PB-I-INTEREST            PIC XX.
  1602             20  PB-I-MORT-TYP            PIC X.
  1603         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  1604         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  1605         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  1606         16  PB-I-INDV-GRP-OVRD           PIC X.
  1607         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  1608         16  PB-I-SIG-SW                  PIC X.
  1609             88  PB-POLICY-SIGNED             VALUE 'Y'.
  1610         16  PB-I-RATE-CLASS              PIC XX.
  1611         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  1612         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  1613         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  1614         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  1615         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  1616         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  1617         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  1618         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL631.cbl
  1619         16  PB-I-OB-FLAG                 PIC X.
  1620             88  PB-I-OB                      VALUE 'B'.
  1621             88  PB-I-SUMMARY                 VALUE 'Z'.
  1622         16  PB-I-ENTRY-STATUS            PIC X.
  1623             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  1624                                              'M' '5' '9' '2'.
  1625             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  1626             88  PB-I-POLICY-PENDING          VALUE '2'.
  1627             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  1628             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  1629             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  1630             88  PB-I-REIN-ONLY               VALUE '9'.
  1631             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  1632             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  1633             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  1634             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  1635         16  PB-I-INT-CODE                PIC X.
  1636             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  1637             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  1638         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1639         16  PB-I-SOC-SEC-NO              PIC X(11).
  1640         16  PB-I-MEMBER-NO               PIC X(12).
  1641         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  1642*        16  PB-I-LOAN-OFFICER            PIC XXX.
  1643         16  PB-I-OLD-LOF                 PIC XXX.
  1644         16  PB-I-LF-EXPIRE-DT            PIC XX.
  1645         16  PB-I-AH-EXPIRE-DT            PIC XX.
  1646         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  1647         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  1648         16  PB-I-LIFE-INDICATOR          PIC X.
  1649             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  1650         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  1651         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  1652                                          PIC S9(5)V99    COMP-3.
  1653         16  PB-I-MAIL-ADDRS-SW           PIC X.
  1654             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  1655             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  1656         16  PB-I-1ST-PMT-DT              PIC XX.
  1657         16  PB-I-JOINT-INSURED.
  1658             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  1659             20 PB-I-JOINT-FIRST-NAME.
  1660                24  PB-I-JOINT-FIRST-INIT PIC X.
  1661                24  FILLER                PIC X(9).
  1662             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  1663*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  1664         16  PB-I-BENEFICIARY-NAME.
  1665             20  PB-I-BANK-NUMBER         PIC X(10).
  1666             20  FILLER                   PIC X(15).
  1667         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  1668         16  PB-I-REFERENCE               PIC X(12).
  1669         16  FILLER REDEFINES PB-I-REFERENCE.
  1670             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  1671             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  1672             20  PB-I-CLP-STATE           PIC XX.
  1673         16  PB-I-UNDERWRITING-STATUS     PIC X.
  1674             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  1675             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  1676             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL631.cbl
  1677         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  1678         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  1679         16  PB-I-RESIDENT-STATE          PIC XX.
  1680         16  PB-I-RATE-CODE               PIC X(4).
  1681         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1682         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1683         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1684         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1685         16  PB-I-BANK-NOCHRGB            PIC 99.
  1686         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1687         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1688
  1689     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1690         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1691             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1692         16  PB-C-CANCEL-ORIGIN           PIC X.
  1693             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1694         16  PB-C-LF-CANCEL-DT            PIC XX.
  1695         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1696         16  PB-C-LF-CALC-REQ             PIC X.
  1697             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1698         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1699         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1700         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1701             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1702         16  PB-C-AH-CANCEL-DT            PIC XX.
  1703         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1704         16  PB-C-AH-CALC-REQ             PIC X.
  1705             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1706         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1707         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1708         16  PB-C-LAST-NAME               PIC X(15).
  1709         16  PB-C-REFUND-SW               PIC X.
  1710             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1711             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1712         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1713         16  PB-C-PAYEE-CODE              PIC X(6).
  1714         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1715         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1716         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1717         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1718         16  PB-C-REFERENCE               PIC X(12).
  1719         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1720         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1721         16  PB-C-POST-CARD-IND           PIC X.
  1722         16  PB-C-CANCEL-REASON           PIC X.
  1723         16  PB-C-REF-INTERFACE-SW        PIC X.
  1724         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1725         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1726         16  FILLER                       PIC X(01).
  1727*        16  FILLER                       PIC X(18).
  1728         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1729*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1730         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1731         16  PB-CANCELED-CERT-DATA.
  1732             20  PB-CI-INSURED-NAME.
  1733                 24  PB-CI-LAST-NAME      PIC X(15).
  1734                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL631.cbl
  1735             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1736             20  PB-CI-INSURED-SEX        PIC X.
  1737             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1738             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1739             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1740             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1741             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1742             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1743             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1744             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1745             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1746             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1747             20  PB-CI-RATE-CLASS         PIC XX.
  1748             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1749             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1750             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1751             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1752             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1753             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1754             20  PB-CI-LF-ABBR            PIC X(3).
  1755             20  PB-CI-AH-ABBR            PIC X(3).
  1756             20  PB-CI-OB-FLAG            PIC X.
  1757                 88  PB-CI-OB                VALUE 'B'.
  1758             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1759                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1760                                           'M' '4' '5' '9' '2'.
  1761                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1762                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1763                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1764                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1765                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1766                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1767                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1768                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1769                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1770                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1771                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1772                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1773             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1774                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1775                                           'M' '4' '5' '9' '2'.
  1776                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1777                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1778                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1779                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1780                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1781                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1782                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1783                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1784                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1785                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1786                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1787                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1788             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1789             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1790             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1791             20  PB-CI-MEMBER-NO          PIC X(12).
  1792             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL631.cbl
  1793                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1794                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1795             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1796             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1797             20  PB-CI-COMP-EXCP-SW       PIC X.
  1798                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1799                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1800             20  PB-CI-ENTRY-STATUS       PIC X.
  1801             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1802             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1803             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1804             20  PB-CI-DEATH-DT           PIC XX.
  1805             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1806             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1807             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1808             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1809             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1810             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1811             20  PB-CI-ENTRY-DT              PIC XX.
  1812             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1813             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1814             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1815             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1816             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1817             20  PB-CI-OLD-LOF               PIC XXX.
  1818*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1819             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1820             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1821             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1822             20  PB-CI-INDV-GRP-CD           PIC X.
  1823             20  PB-CI-BENEFICIARY-NAME.
  1824                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1825                 24  FILLER                  PIC X(15).
  1826             20  PB-CI-NOTE-SW               PIC X.
  1827             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1828             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1829             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1830             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1831             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1832             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1833             20  PB-CI-FIRST-NAME            PIC X(10).
  1834             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1835
  1836         16  FILLER                       PIC X(13).
  1837*032306  16  FILLER                       PIC X(27).
  1838*        16  FILLER                       PIC X(46).
  1839
  1840     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1841         16  FILLER                       PIC X(10).
  1842         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1843         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1844         16  PB-M-INSURED-MID-INIT        PIC X.
  1845         16  PB-M-INSURED-AGE             PIC 99.
  1846         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1847         16  PB-M-INSURED-SEX             PIC X.
  1848         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1849         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1850         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL631.cbl
  1851         16  PB-M-INSURED-CITY-STATE.
  1852             20  PB-M-INSURED-CITY        PIC X(28).
  1853             20  PB-M-INSURED-STATE       PIC XX.
  1854         16  PB-M-INSURED-ZIP-CODE.
  1855             20  PB-M-INSURED-ZIP-PRIME.
  1856                 24  PB-M-INSURED-ZIP-1   PIC X.
  1857                     88  PB-M-CANADIAN-POST-CODE
  1858                                             VALUE 'A' THRU 'Z'.
  1859                 24  FILLER               PIC X(4).
  1860             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1861         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1862                                        PB-M-INSURED-ZIP-CODE.
  1863             20  PM-M-INS-CAN-POST1       PIC XXX.
  1864             20  PM-M-INS-CAN-POST2       PIC XXX.
  1865             20  FILLER                   PIC XXX.
  1866         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1867         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1868         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1869         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1870         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1871         16  PB-M-CRED-BENE-CITYST.
  1872             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1873             20  PB-M-CRED-BENE-STATE     PIC XX.
  1874         16  FILLER                       PIC X(92).
  1875
  1876     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1877         16  FILLER                       PIC X(10).
  1878         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1879         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1880         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1881         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1882         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1883         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1884         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1885         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1886         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1887         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1888         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1889         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1890         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1891         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1892         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1893         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1894         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1895         16  PB-ACCOUNT-NAME              PIC X(30).
  1896         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1897         16  PB-REFERENCE                 PIC X(12).
  1898         16  PB-B-RECEIVED-DT             PIC XX.
  1899         16  FILLER                       PIC X(234).
  1900
  1901     12  PB-RECORD-STATUS.
  1902         16  PB-CREDIT-SELECT-DT          PIC XX.
  1903         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1904         16  PB-BILLED-DT                 PIC XX.
  1905         16  PB-BILLING-STATUS            PIC X.
  1906             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1907             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1908             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL631.cbl
  1909         16  PB-RECORD-BILL               PIC X.
  1910             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1911             88  PB-RECORD-RETURNED           VALUE 'R'.
  1912             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1913             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1914             88  PB-OVERRIDE-AH               VALUE 'A'.
  1915             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1916         16  PB-BATCH-ENTRY               PIC X.
  1917             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1918             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1919             88  PB-REISSUED-CERT             VALUE 'E'.
  1920             88  PB-MONTHLY-CERT              VALUE 'M'.
  1921             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1922             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1923             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1924         16  PB-FORCE-CODE                PIC X.
  1925             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1926             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1927             88  PB-CANCEL-FORCE              VALUE '8'.
  1928             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1929             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1930             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1931             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1932             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1933             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1934             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1935         16  PB-FATAL-FLAG                PIC X.
  1936             88  PB-FATAL-ERRORS              VALUE 'X'.
  1937         16  PB-FORCE-ER-CD               PIC X.
  1938             88  PB-FORCE-ERRORS              VALUE 'F'.
  1939             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1940         16  PB-WARN-ER-CD                PIC X.
  1941             88  PB-WARNING-ERRORS            VALUE 'W'.
  1942         16  FILLER                       PIC X.
  1943         16  PB-OUT-BAL-CD                PIC X.
  1944             88  PB-OUT-OF-BAL                VALUE 'O'.
  1945         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1946         16  PB-AH-OVERRIDE-L1            PIC X.
  1947         16  PB-INPUT-DT                  PIC XX.
  1948         16  PB-INPUT-BY                  PIC X(4).
  1949         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1950         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1951         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1952         16  PB-LF-EARNING-METHOD         PIC X.
  1953         16  PB-AH-EARNING-METHOD         PIC X.
  1954         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1955         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1956         16  PB-REIN-CD                   PIC XXX.
  1957         16  PB-LF-REFUND-TYPE            PIC X.
  1958         16  PB-AH-REFUND-TYPE            PIC X.
  1959         16  PB-ACCT-EFF-DT               PIC XX.
  1960         16  PB-ACCT-EXP-DT               PIC XX.
  1961         16  PB-COMPANY-ID                PIC X(3).
  1962         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1963         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1964         16  PB-SV-CARRIER                PIC X.
  1965         16  PB-SV-GROUPING               PIC X(6).
  1966         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL631.cbl
  1967         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1968         16  PB-GA-BILLING-INFO.
  1969             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1970                                          PIC XX.
  1971         16  PB-SV-REMIT-TO  REDEFINES
  1972             PB-GA-BILLING-INFO           PIC X(10).
  1973         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1974         16  PB-I-LOAN-OFFICER            PIC X(5).
  1975         16  PB-I-VIN                     PIC X(17).
  1976
  1977         16  FILLER                       PIC X(04).
  1978         16  IMNET-BYPASS-SW              PIC X.
  1979
  1980******************************************************************
  1981*                COMMON EDIT ERRORS                              *
  1982******************************************************************
  1983
  1984     12  PB-COMMON-ERRORS.
  1985         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1986                                           PIC S9(4)     COMP.
  1987
  1988******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL631.cbl
  1990*    COPY ERCACCT.
  1991******************************************************************
  1992*                                                                *
  1993*                                                                *
  1994*                            ERCACCT                             *
  1995*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1996*                            VMOD=2.031                          *
  1997*                                                                *
  1998*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1999*                                                                *
  2000*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2001*   VSAM ACCOUNT MASTER FILES.                                   *
  2002*                                                                *
  2003*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2004*                                                                *
  2005*   FILE TYPE = VSAM,KSDS                                        *
  2006*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2007*                                                                *
  2008*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2009*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2010*                                                                *
  2011*   LOG = NO                                                     *
  2012*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2013*                                                                *
  2014*                                                                *
  2015******************************************************************
  2016*                   C H A N G E   L O G
  2017*
  2018* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2019*-----------------------------------------------------------------
  2020*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2021* EFFECTIVE    NUMBER
  2022*-----------------------------------------------------------------
  2023* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2024* 092705    2005050300006  PEMA  ADD SPP LEASES
  2025* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2026* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2027* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2028* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2029* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2030******************************************************************
  2031
  2032 01  ACCOUNT-MASTER.
  2033     12  AM-RECORD-ID                      PIC XX.
  2034         88  VALID-AM-ID                      VALUE 'AM'.
  2035
  2036     12  AM-CONTROL-PRIMARY.
  2037         16  AM-COMPANY-CD                 PIC X.
  2038         16  AM-MSTR-CNTRL.
  2039             20  AM-CONTROL-A.
  2040                 24  AM-CARRIER            PIC X.
  2041                 24  AM-GROUPING.
  2042                     28 AM-GROUPING-PREFIX PIC XXX.
  2043                     28 AM-GROUPING-PRIME  PIC XXX.
  2044                 24  AM-STATE              PIC XX.
  2045                 24  AM-ACCOUNT.
  2046                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2047                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL631.cbl
  2048             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2049                                           PIC X(19).
  2050             20  AM-CNTRL-B.
  2051                 24  AM-EXPIRATION-DT      PIC XX.
  2052                 24  FILLER                PIC X(4).
  2053             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2054                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2055
  2056     12  AM-CONTROL-BY-VAR-GRP.
  2057         16  AM-COMPANY-CD-A1              PIC X.
  2058         16  AM-VG-CARRIER                 PIC X.
  2059         16  AM-VG-GROUPING                PIC X(6).
  2060         16  AM-VG-STATE                   PIC XX.
  2061         16  AM-VG-ACCOUNT                 PIC X(10).
  2062         16  AM-VG-DATE.
  2063             20  AM-VG-EXPIRATION-DT       PIC XX.
  2064             20  FILLER                    PIC X(4).
  2065         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2066                                           PIC 9(11)      COMP-3.
  2067     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2068         16  FILLER                        PIC X(10).
  2069         16  AM-VG-KEY3.
  2070             20  AM-VG3-ACCOUNT            PIC X(10).
  2071             20  AM-VG3-EXP-DT             PIC XX.
  2072         16  FILLER                        PIC X(4).
  2073     12  AM-MAINT-INFORMATION.
  2074         16  AM-LAST-MAINT-DT              PIC XX.
  2075         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2076         16  AM-LAST-MAINT-USER            PIC X(4).
  2077         16  FILLER                        PIC XX.
  2078
  2079     12  AM-EFFECTIVE-DT                   PIC XX.
  2080     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2081
  2082     12  AM-PREV-DATES  COMP-3.
  2083         16  AM-PREV-EXP-DT                PIC 9(11).
  2084         16  AM-PREV-EFF-DT                PIC 9(11).
  2085
  2086     12  AM-REPORT-CODE-1                  PIC X(10).
  2087     12  AM-REPORT-CODE-2                  PIC X(10).
  2088
  2089     12  AM-CITY-CODE                      PIC X(4).
  2090     12  AM-COUNTY-PARISH                  PIC X(6).
  2091
  2092     12  AM-NAME                           PIC X(30).
  2093     12  AM-PERSON                         PIC X(30).
  2094     12  AM-ADDRS                          PIC X(30).
  2095     12  AM-CITY.
  2096         16  AM-ADDR-CITY                  PIC X(28).
  2097         16  AM-ADDR-STATE                 PIC XX.
  2098     12  AM-ZIP.
  2099         16  AM-ZIP-PRIME.
  2100             20  AM-ZIP-PRI-1ST            PIC X.
  2101                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2102             20  FILLER                    PIC X(4).
  2103         16  AM-ZIP-PLUS4                  PIC X(4).
  2104     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2105         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL631.cbl
  2106         16  AM-CAN-POSTAL-2               PIC XXX.
  2107         16  FILLER                        PIC XXX.
  2108     12  AM-TEL-NO.
  2109         16  AM-AREA-CODE                  PIC 999.
  2110         16  AM-TEL-PRE                    PIC 999.
  2111         16  AM-TEL-NBR                    PIC 9(4).
  2112     12  AM-TEL-LOC                        PIC X.
  2113         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2114         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2115
  2116     12  AM-COMM-STRUCTURE.
  2117         16  AM-DEFN-1.
  2118             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2119                 24  AM-AGT.
  2120                     28  AM-AGT-PREFIX     PIC X(4).
  2121                     28  AM-AGT-PRIME      PIC X(6).
  2122                 24  AM-COM-TYP            PIC X.
  2123                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2124                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2125                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2126                 24  AM-RECALC-LV-INDIC    PIC X.
  2127                 24  AM-RETRO-LV-INDIC     PIC X.
  2128                 24  AM-GL-CODES           PIC X.
  2129                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2130                 24  FILLER                PIC X(01).
  2131         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2132             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2133                 24  FILLER                PIC X(11).
  2134                 24  AM-L-COMA             PIC XXX.
  2135                 24  AM-J-COMA             PIC XXX.
  2136                 24  AM-A-COMA             PIC XXX.
  2137                 24  FILLER                PIC X(6).
  2138
  2139     12  AM-COMM-CHANGE-STATUS             PIC X.
  2140         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2141
  2142     12  AM-CSR-CODE                       PIC X(4).
  2143
  2144     12  AM-BILLING-STATUS                 PIC X.
  2145         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2146         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2147     12  AM-AUTO-REFUND-SW                 PIC X.
  2148         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2149         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2150     12  AM-GPCD                           PIC 99.
  2151     12  AM-IG                             PIC X.
  2152         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2153         88  AM-HAS-GROUP                     VALUE '2'.
  2154     12  AM-STATUS                         PIC X.
  2155         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2156         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2157         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2158         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2159         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2160         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2161     12  AM-REMIT-TO                       PIC 99.
  2162     12  AM-ID-NO                          PIC X(11).
  2163
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL631.cbl
  2164     12  AM-CAL-TABLE                      PIC XX.
  2165     12  AM-LF-DEVIATION                   PIC XXX.
  2166     12  AM-AH-DEVIATION                   PIC XXX.
  2167     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2168     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2169     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2170     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2171     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2172     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2173
  2174     12  AM-USER-FIELDS.
  2175         16  AM-FLD-1                      PIC XX.
  2176         16  AM-FLD-2                      PIC XX.
  2177         16  AM-FLD-3                      PIC XX.
  2178         16  AM-FLD-4                      PIC XX.
  2179         16  AM-FLD-5                      PIC XX.
  2180
  2181     12  AM-1ST-PROD-DATE.
  2182         16  AM-1ST-PROD-YR                PIC XX.
  2183         16  AM-1ST-PROD-MO                PIC XX.
  2184         16  AM-1ST-PROD-DA                PIC XX.
  2185     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2186     12  AM-CERTS-PURGED-DATE.
  2187         16  AM-PUR-YR                     PIC XX.
  2188         16  AM-PUR-MO                     PIC XX.
  2189         16  AM-PUR-DA                     PIC XX.
  2190     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2191     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2192     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2193     12  AM-INACTIVE-DATE.
  2194         16  AM-INA-MO                     PIC 99.
  2195         16  AM-INA-DA                     PIC 99.
  2196         16  AM-INA-YR                     PIC 99.
  2197     12  AM-AR-HI-CERT-DATE                PIC XX.
  2198
  2199     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2200     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2201
  2202     12  AM-OB-PAYMENT-MODE                PIC X.
  2203         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2204         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2205         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2206         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2207
  2208     12  AM-AH-ONLY-INDICATOR              PIC X.
  2209         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2210         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2211
  2212     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2213
  2214     12  AM-OVER-SHORT.
  2215         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2216         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2217
  2218     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2219     12  AM-DCC-CLP-STATE                  PIC XX.
  2220
  2221     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL631.cbl
  2222     12  AM-RECALC-REIN                    PIC X.
  2223
  2224     12  AM-REI-TABLE                      PIC XXX.
  2225     12  AM-REI-ET-LF                      PIC X.
  2226     12  AM-REI-ET-AH                      PIC X.
  2227     12  AM-REI-PE-LF                      PIC X.
  2228     12  AM-REI-PE-AH                      PIC X.
  2229     12  AM-REI-PRT-ST                     PIC X.
  2230     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2231     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2232     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2233     12  AM-REI-GROUP-A                    PIC X(6).
  2234     12  AM-REI-MORT                       PIC X(4).
  2235     12  AM-REI-PRT-OW                     PIC X.
  2236     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2237     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2238     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2239     12  AM-REI-GROUP-B                    PIC X(6).
  2240
  2241     12  AM-TRUST-TYPE                     PIC X(2).
  2242
  2243     12  AM-EMPLOYER-STMT-USED             PIC X.
  2244     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2245
  2246     12  AM-STD-AH-TYPE                    PIC XX.
  2247     12  AM-EARN-METHODS.
  2248         16  AM-EARN-METHOD-R              PIC X.
  2249             88 AM-REF-RL-R78                 VALUE 'R'.
  2250             88 AM-REF-RL-PR                  VALUE 'P'.
  2251             88 AM-REF-RL-MEAN                VALUE 'M'.
  2252             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2253         16  AM-EARN-METHOD-L              PIC X.
  2254             88 AM-REF-LL-R78                 VALUE 'R'.
  2255             88 AM-REF-LL-PR                  VALUE 'P'.
  2256             88 AM-REF-LL-MEAN                VALUE 'M'.
  2257             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2258         16  AM-EARN-METHOD-A              PIC X.
  2259             88 AM-REF-AH-R78                 VALUE 'R'.
  2260             88 AM-REF-AH-PR                  VALUE 'P'.
  2261             88 AM-REF-AH-MEAN                VALUE 'M'.
  2262             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2263             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2264             88 AM-REF-AH-NET                 VALUE 'N'.
  2265
  2266     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2267     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2268     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2269
  2270     12  AM-RET-Y-N                        PIC X.
  2271     12  AM-RET-P-E                        PIC X.
  2272     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2273     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2274     12  AM-RET-GRP                        PIC X(6).
  2275     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2276         16  AM-POOL-PRIME                 PIC XXX.
  2277         16  AM-POOL-SUB                   PIC XXX.
  2278     12  AM-RETRO-EARNINGS.
  2279         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL631.cbl
  2280         16  AM-RET-EARN-L                 PIC X.
  2281         16  AM-RET-EARN-A                 PIC X.
  2282     12  AM-RET-ST-TAX-USE                 PIC X.
  2283         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2284         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2285     12  AM-RETRO-BEG-EARNINGS.
  2286         16  AM-RET-BEG-EARN-R             PIC X.
  2287         16  AM-RET-BEG-EARN-L             PIC X.
  2288         16  AM-RET-BEG-EARN-A             PIC X.
  2289     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2290     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2291
  2292     12  AM-USER-SELECT-OPTIONS.
  2293         16  AM-USER-SELECT-1              PIC X(10).
  2294         16  AM-USER-SELECT-2              PIC X(10).
  2295         16  AM-USER-SELECT-3              PIC X(10).
  2296         16  AM-USER-SELECT-4              PIC X(10).
  2297         16  AM-USER-SELECT-5              PIC X(10).
  2298
  2299     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2300
  2301     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2302
  2303     12  AM-RPT045A-SWITCH                 PIC X.
  2304         88  RPT045A-OFF                   VALUE 'N'.
  2305
  2306     12  AM-INSURANCE-LIMITS.
  2307         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2308         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2309
  2310     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2311         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2312
  2313     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2314         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2315         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2316
  2317     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2318
  2319     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2320     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2321     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2322     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2323     12  AM-DCC-UEF-STATE                  PIC XX.
  2324     12  FILLER                            PIC XXX.
  2325     12  AM-REPORT-CODE-3                  PIC X(10).
  2326*    12  FILLER                            PIC X(22).
  2327
  2328     12  AM-RESERVE-DATE.
  2329         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2330         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2331         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2332
  2333     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2334     12  AM-NOTIFICATION-TYPES.
  2335         16  AM-NOTIF-OF-LETTERS           PIC X.
  2336         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2337         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL631.cbl
  2338         16  AM-NOTIF-OF-STATUS            PIC X.
  2339
  2340     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2341         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2342         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2343         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2344         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2345
  2346     12  AM-BENEFIT-CONTROLS.
  2347         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2348             20  AM-BENEFIT-CODE           PIC XX.
  2349             20  AM-BENEFIT-TYPE           PIC X.
  2350             20  AM-BENEFIT-REVISION       PIC XXX.
  2351             20  AM-BENEFIT-REM-TERM       PIC X.
  2352             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2353             20  FILLER                    PIC XX.
  2354         16  FILLER                        PIC X(80).
  2355
  2356     12  AM-TRANSFER-DATA.
  2357         16  AM-TRANSFERRED-FROM.
  2358             20  AM-TRNFROM-CARRIER        PIC X.
  2359             20  AM-TRNFROM-GROUPING.
  2360                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2361                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2362             20  AM-TRNFROM-STATE          PIC XX.
  2363             20  AM-TRNFROM-ACCOUNT.
  2364                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2365                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2366             20  AM-TRNFROM-DTE            PIC XX.
  2367         16  AM-TRANSFERRED-TO.
  2368             20  AM-TRNTO-CARRIER          PIC X.
  2369             20  AM-TRNTO-GROUPING.
  2370                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2371                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2372             20  AM-TRNTO-STATE            PIC XX.
  2373             20  AM-TRNTO-ACCOUNT.
  2374                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2375                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2376             20  AM-TRNTO-DTE              PIC XX.
  2377         16  FILLER                        PIC X(10).
  2378
  2379     12  AM-SAVED-REMIT-TO                 PIC 99.
  2380
  2381     12  AM-COMM-STRUCTURE-SAVED.
  2382         16  AM-DEFN-1-SAVED.
  2383             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2384                 24  AM-AGT-SV             PIC X(10).
  2385                 24  AM-COM-TYP-SV         PIC X.
  2386                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2387                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2388                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2389                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2390                 24  FILLER                PIC X.
  2391                 24  AM-GL-CODES-SV        PIC X.
  2392                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2393                 24  FILLER                PIC X.
  2394         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2395             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL631.cbl
  2396                 24  FILLER                PIC X(11).
  2397                 24  AM-L-COMA-SV          PIC XXX.
  2398                 24  AM-J-COMA-SV          PIC XXX.
  2399                 24  AM-A-COMA-SV          PIC XXX.
  2400                 24  FILLER                PIC X(6).
  2401
  2402     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2403         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2404            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2405            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2406            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2407
  2408     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2409     12  FILLER                            PIC X(120).
  2410
  2411     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2412         16  AM-CONTROL-NAME               PIC X(30).
  2413         16  AM-EXECUTIVE-ONE.
  2414             20  AM-EXEC1-NAME             PIC X(15).
  2415             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2416                                                          COMP-3.
  2417             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2418                                                          COMP-3.
  2419         16  AM-EXECUTIVE-TWO.
  2420             20  AM-EXEC2-NAME             PIC X(15).
  2421             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2422                                                          COMP-3.
  2423             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2424                                                          COMP-3.
  2425
  2426     12  AM-RETRO-ADDITIONAL-DATA.
  2427         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2428         16  AM-RETRO-PREM-P-E             PIC X.
  2429         16  AM-RETRO-CLMS-P-I             PIC X.
  2430         16  AM-RETRO-RET-BRACKET-LF.
  2431             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2432                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2433                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2434             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2435                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2436                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2437             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2438                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2439                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2440         16  AM-RETRO-RET-BRACKET-AH.
  2441             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2442                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2443                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2444                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2445             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2446                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2447                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2448             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2449                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2450                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2451
  2452     12  AM-COMMENTS.
  2453         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL631.cbl
  2454
  2455     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2456         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2457         16  AM-FLI-BILLING-CODE           PIC X.
  2458         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2459         16  AM-FLI-UNITED-IDENT           PIC X.
  2460         16  AM-FLI-INTEREST-LOST-DATA.
  2461             20  AM-FLI-BANK-NO            PIC X(5).
  2462             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2463             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2464             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2465         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2466             20  AM-FLI-AGT                PIC X(9).
  2467             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2468             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2469         16  FILLER                        PIC X(102).
  2470
  2471     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2472         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2473             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2474             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2475             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2476             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2477             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2478         16  FILLER                          PIC X(10).
  2479******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL631.cbl
  2481 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  2482                          ACCOUNT-MASTER.
  2483 0000-DFHEXIT SECTION.
  2484     MOVE '9#                    $   ' TO DFHEIV0.
  2485     MOVE 'EL631' TO DFHEIV1.
  2486     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2487
  2488     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  2489     MOVE '5'                   TO DC-OPTION-CODE.
  2490     PERFORM 9700-DATE-LINK.
  2491     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  2492     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  2493
  2494     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  2495     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  2496     MOVE EIBTRMID               TO QID-TERM.
  2497
  2498     IF EIBCALEN = 0
  2499         GO TO 8800-UNAUTHORIZED-ACCESS.
  2500
  2501     MOVE LOW-VALUES             TO EL631AI.
  2502
  2503     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2504         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2505             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2506             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2507             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2508             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2509             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2510             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2511             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2512             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  2513             IF PI-COMPANY-ID = CLIENT-MIC OR CLIENT-PEM OR
  2514                                CLIENT-FLA
  2515                MOVE 'Y'               TO ORGINALI
  2516             END-IF
  2517         ELSE
  2518             MOVE PI-CALLING-PROGRAM   TO RETURN-FROM
  2519             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2520             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2521             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2522             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2523             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2524             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2525             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2526             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2527             PERFORM 6000-BUILD-SCREEN THRU 6099-EXIT.
  2528
  2529******************************************************************
  2530*                                                                *
  2531*        IF THERE WERE NO RECORDS FOUND FOR CARRIER AND ACCOUNT  *
  2532*        DISPLAY ORIGINAL SCREEN.                                *
  2533*                                                                *
  2534******************************************************************
  2535
  2536     IF PI-NO-PB-RECS-FOUND
  2537         MOVE SPACE TO PI-BROWSE-SW
  2538         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL631.cbl
  2539
  2540     IF EIBTRNID NOT = TRANS-ID
  2541         GO TO 8100-SEND-INITIAL-MAP.
  2542
  2543
  2544* EXEC CICS HANDLE CONDITION
  2545*        PGMIDERR  (9600-PGMID-ERROR)
  2546*        ERROR     (9990-ABEND)
  2547*    END-EXEC.
  2548*    MOVE '"$L.                  ! " #00002539' TO DFHEIV0
  2549     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2551     MOVE X'2220233030303032353339' TO DFHEIV0(25:11)
  2552     CALL 'kxdfhei1' USING DFHEIV0
  2553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2554
  2555
  2556     IF EIBAID = DFHCLEAR
  2557         GO TO 9400-CLEAR.
  2558
  2559     IF PI-PROCESSOR-ID = 'LGXX'
  2560         GO TO 0200-RECEIVE.
  2561
  2562
  2563* EXEC CICS READQ TS
  2564*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  2565*        INTO   (SECURITY-CONTROL)
  2566*        LENGTH (SC-COMM-LENGTH)
  2567*        ITEM   (SC-ITEM)
  2568*    END-EXEC.
  2569*    MOVE '*$II   L              ''   #00002550' TO DFHEIV0
  2570     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2571     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2572     MOVE X'2020233030303032353530' TO DFHEIV0(25:11)
  2573     CALL 'kxdfhei1' USING DFHEIV0,
  2574           PI-SECURITY-TEMP-STORE-ID,
  2575           SECURITY-CONTROL,
  2576           SC-COMM-LENGTH,
  2577           SC-ITEM,
  2578           DFHEIV99,
  2579           DFHEIV99
  2580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2581
  2582
  2583     MOVE SC-CREDIT-DISPLAY (12)  TO PI-DISPLAY-CAP.
  2584     MOVE SC-CREDIT-UPDATE  (12)  TO PI-MODIFY-CAP.
  2585
  2586     IF NOT DISPLAY-CAP
  2587         MOVE 'READ'          TO SM-READ
  2588         PERFORM 9995-SECURITY-VIOLATION
  2589         MOVE ER-0070         TO  EMI-ERROR
  2590         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2591         GO TO 8100-SEND-INITIAL-MAP.
  2592
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL631.cbl
  2594
  2595 0200-RECEIVE.
  2596     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2597         MOVE ER-0008            TO EMI-ERROR
  2598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2599         MOVE -1                 TO BATCHL
  2600         GO TO 8200-SEND-DATAONLY.
  2601
  2602
  2603* EXEC CICS RECEIVE
  2604*        MAP      (MAP-NAME)
  2605*        MAPSET   (MAPSET-NAME)
  2606*        INTO     (EL631AI)
  2607*    END-EXEC.
  2608     MOVE LENGTH OF
  2609      EL631AI
  2610       TO DFHEIV11
  2611*    MOVE '8"T I  L              ''   #00002576' TO DFHEIV0
  2612     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2613     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2614     MOVE X'2020233030303032353736' TO DFHEIV0(25:11)
  2615     CALL 'kxdfhei1' USING DFHEIV0,
  2616           MAP-NAME,
  2617           EL631AI,
  2618           DFHEIV11,
  2619           MAPSET-NAME,
  2620           DFHEIV99,
  2621           DFHEIV99
  2622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2623
  2624
  2625     IF PFENTERL = 0
  2626         GO TO 0300-CHECK-PFKEYS.
  2627
  2628     IF EIBAID NOT = DFHENTER
  2629         MOVE ER-0004            TO EMI-ERROR
  2630         GO TO 0320-INPUT-ERROR.
  2631
  2632     IF PFENTERI NUMERIC
  2633        IF PFENTERI GREATER 0 AND LESS 25
  2634           MOVE PF-VALUES (PFENTERI) TO EIBAID
  2635        ELSE
  2636           MOVE ER-0029            TO EMI-ERROR
  2637           GO TO 0320-INPUT-ERROR.
  2638
  2639 0300-CHECK-PFKEYS.
  2640     IF EIBAID = DFHPF1 OR DFHPF2 OR DFHPF3
  2641        GO TO 330-EDIT-INPUT-DATA.
  2642
  2643     IF EIBAID = DFHPF23
  2644         GO TO 8810-PF23.
  2645
  2646     IF EIBAID = DFHPF24
  2647         GO TO 9200-RETURN-MAIN-MENU.
  2648
  2649     IF EIBAID = DFHPF12
  2650         GO TO 9500-PF12.
  2651
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL631.cbl
  2652     IF EIBAID = DFHENTER
  2653         GO TO 330-EDIT-INPUT-DATA.
  2654
  2655     MOVE ER-0029                TO EMI-ERROR.
  2656
  2657 0320-INPUT-ERROR.
  2658     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2659     MOVE AL-UNBON               TO PFENTERA.
  2660
  2661     IF PFENTERL = 0
  2662         MOVE -1                 TO BATCHL
  2663     ELSE
  2664         MOVE -1                 TO PFENTERL.
  2665
  2666     GO TO 8200-SEND-DATAONLY.
  2667
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL631.cbl
  2669
  2670 330-EDIT-INPUT-DATA.
  2671     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  2672     MOVE PI-ENTRY-CD-1          TO PI-CSR-SESSION-SW
  2673     MOVE LOW-VALUES             TO PI-ERPNDB-KEY
  2674                                    PI-ERPNDB-ALT-KEY.
  2675
  2676     MOVE PI-COMPANY-CD          TO PI-PB-COMPANY-CD
  2677                                    PI-PB-COMPANY-CD-A1.
  2678
  2679     IF ANYISSI NOT = 'N' AND 'Y'
  2680        MOVE -1                  TO ANYISSL
  2681        MOVE AL-UABON            TO ANYISSA
  2682        PERFORM 0350-SELECTION-ERROR
  2683     ELSE
  2684        MOVE ANYISSI             TO PI-ISSUES-IN-ERROR-SW.
  2685
  2686     IF ANYCANI NOT = 'N' AND 'Y'
  2687        MOVE -1                  TO ANYCANL
  2688        MOVE AL-UABON            TO ANYCANA
  2689        PERFORM 0350-SELECTION-ERROR
  2690     ELSE
  2691        MOVE ANYCANI             TO PI-CANCELS-IN-ERROR-SW.
  2692
  2693     IF ALLISSI NOT = 'N' AND 'Y'
  2694        MOVE -1                  TO ALLISSL
  2695        MOVE AL-UABON            TO ALLISSA
  2696        PERFORM 0350-SELECTION-ERROR
  2697     ELSE
  2698        MOVE ALLISSI             TO PI-ALL-ISSUES-SW.
  2699
  2700     IF ALLCANI NOT = 'N' AND 'Y'
  2701        MOVE -1                  TO ALLCANL
  2702        MOVE AL-UABON            TO ALLCANA
  2703        PERFORM 0350-SELECTION-ERROR
  2704     ELSE
  2705        MOVE ALLCANI             TO PI-ALL-CANCELS-SW.
  2706
  2707     IF ONLYHDRI NOT = 'N' AND 'Y'
  2708        MOVE -1                  TO ONLYHDRL
  2709        MOVE AL-UABON            TO ONLYHDRA
  2710        PERFORM 0350-SELECTION-ERROR
  2711     ELSE
  2712        MOVE ONLYHDRI             TO PI-ONLY-BATCH-HEADERS-SW.
  2713
  2714     IF OUTBALI NOT = 'N' AND 'Y'
  2715        MOVE -1                  TO OUTBALL
  2716        MOVE AL-UABON            TO OUTBALA
  2717        PERFORM 0350-SELECTION-ERROR
  2718     ELSE
  2719        MOVE OUTBALI             TO PI-ALL-OUT-OF-BAL-SW.
  2720
  2721     IF HLDRECI NOT = 'N' AND 'Y'
  2722        MOVE -1                  TO HLDRECL
  2723        MOVE AL-UABON            TO HLDRECA
  2724        PERFORM 0350-SELECTION-ERROR
  2725     ELSE
  2726        MOVE HLDRECI             TO PI-HOLD-REC-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL631.cbl
  2727
  2728     IF CHGRECI NOT = 'N' AND 'Y'
  2729        MOVE -1                  TO CHGRECL
  2730        MOVE AL-UABON            TO CHGRECA
  2731        PERFORM 0350-SELECTION-ERROR
  2732     ELSE
  2733        MOVE CHGRECI             TO PI-CHANGE-REC-SW.
  2734
  2735     IF CHKREQI NOT = 'N' AND 'Y'
  2736        MOVE -1                  TO CHKREQL
  2737        MOVE AL-UABON            TO CHKREQA
  2738        PERFORM 0350-SELECTION-ERROR
  2739     ELSE
  2740        MOVE CHKREQI             TO PI-CHK-REQ-REC-SW.
  2741
  2742     IF STARTATI NOT = 'N' AND 'Y'
  2743        MOVE -1                  TO STARTATL
  2744        MOVE AL-UABON            TO STARTATA
  2745        PERFORM 0350-SELECTION-ERROR.
  2746
  2747     IF ORGINALI NOT = 'N' AND 'Y'
  2748        MOVE -1                  TO ORGINALL
  2749        MOVE AL-UABON            TO ORGINALA
  2750        PERFORM 0350-SELECTION-ERROR
  2751     ELSE
  2752        MOVE ORGINALI            TO PI-ORIGINAL-BATCH-SW.
  2753
  2754     IF ANYISSWI NOT = 'N' AND 'Y'
  2755        MOVE -1                  TO ANYISSWL
  2756        MOVE AL-UABON            TO ANYISSWA
  2757        PERFORM 0350-SELECTION-ERROR
  2758     ELSE
  2759        MOVE ANYISSWI            TO PI-ISSUE-WARNING-SW.
  2760
  2761     IF ANYCANWI NOT = 'N' AND 'Y'
  2762        MOVE -1                  TO ANYCANWL
  2763        MOVE AL-UABON            TO ANYCANWA
  2764        PERFORM 0350-SELECTION-ERROR
  2765     ELSE
  2766        MOVE ANYCANWI            TO PI-CANCEL-WARNING-SW.
  2767
  2768     IF NOT EMI-NO-ERRORS
  2769        GO TO 8200-SEND-DATAONLY.
  2770
  2771     IF ANYISSI = 'Y' AND (ALLISSI = 'Y' OR ANYISSWI = 'Y')
  2772        MOVE -1                  TO ANYISSL
  2773        MOVE AL-UABON            TO ANYISSA  ANYISSWA ALLISSA
  2774        PERFORM 0360-COMBINATION-ERROR.
  2775
  2776     IF ANYISSWI = 'Y' AND (ALLISSI = 'Y' OR ANYISSI = 'Y')
  2777        MOVE -1                  TO ANYISSL
  2778        MOVE AL-UABON            TO ANYISSA  ANYISSWA ALLISSA
  2779        PERFORM 0360-COMBINATION-ERROR.
  2780
  2781     IF ANYCANI = 'Y' AND (ALLCANI = 'Y' OR ANYCANWI = 'Y')
  2782        MOVE -1                  TO ANYCANL
  2783        MOVE AL-UABON            TO ANYCANA  ANYCANWA ALLCANA
  2784        PERFORM 0360-COMBINATION-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL631.cbl
  2785
  2786     IF ANYCANWI = 'Y' AND (ALLCANI = 'Y' OR ANYCANI = 'Y')
  2787        MOVE -1                  TO ANYCANL
  2788        MOVE AL-UABON            TO ANYCANA  ANYCANWA ALLCANA
  2789        PERFORM 0360-COMBINATION-ERROR.
  2790
  2791     IF OUTBALI = 'Y' AND ONLYHDRI = 'Y'
  2792        MOVE -1                  TO ONLYHDRL
  2793        MOVE AL-UABON            TO ONLYHDRA  OUTBALA
  2794        PERFORM 0360-COMBINATION-ERROR.
  2795
  2796     IF STARTATI = 'Y'
  2797        IF BATCHL NOT GREATER THAN ZEROS
  2798           MOVE -1                  TO BATCHL
  2799           MOVE AL-UANOF            TO BATCHA
  2800           MOVE ER-2201             TO EMI-ERROR
  2801           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2802
  2803     IF ANYISSI  = 'N' AND ALLISSI  = 'N' AND
  2804        ANYCANI  = 'N' AND ALLCANI  = 'N' AND
  2805        OUTBALI  = 'N' AND ONLYHDRI = 'N' AND
  2806        ANYISSWI = 'N' AND ANYCANWI = 'N'
  2807        MOVE ER-0329             TO EMI-ERROR
  2808        MOVE -1                  TO ANYISSL
  2809        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2810
  2811     IF PI-COMPANY-ID = CLIENT-MIC OR CLIENT-PEM OR CLIENT-FLA
  2812        IF ORGINALI = 'N'
  2813           NEXT SENTENCE
  2814        ELSE
  2815           IF CARRIERL = ZEROS AND GROUPL = ZEROS AND
  2816              STATEL = ZEROS   AND ACCOUNTL = ZEROS AND
  2817              BATCHL = ZEROS
  2818              MOVE -1            TO BATCHL
  2819              MOVE ER-2150       TO EMI-ERROR
  2820              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2821
  2822     IF (ONLYHDRI = 'Y' OR OUTBALI = 'Y' OR
  2823        CHGRECI  = 'Y') AND ORGINALI = 'Y'
  2824        MOVE -1                  TO ORGINALL
  2825        PERFORM 0360-COMBINATION-ERROR.
  2826
  2827     IF (ANYISSI  = 'Y' OR ALLISSI  = 'Y' OR
  2828         ANYISSWI = 'Y' OR ANYCANWI = 'Y' OR
  2829         ANYCANI  = 'Y' OR ALLCANI  = 'Y')   AND
  2830        (OUTBALI  = 'Y' OR ONLYHDRI = 'Y')
  2831        MOVE -1                  TO ANYISSL
  2832        PERFORM 0360-COMBINATION-ERROR.
  2833
  2834     IF (ANYISSI = 'Y' OR ALLISSI   = 'Y' OR
  2835         CHGRECI = 'Y' OR ONLYHDRI  = 'Y' OR
  2836         OUTBALI = 'Y' OR ANYISSWI  = 'Y')
  2837         AND CHKREQI = 'Y'
  2838         MOVE -1                  TO ANYISSL
  2839         PERFORM 0360-COMBINATION-ERROR.
  2840
  2841     IF  EIBAID = DFHPF1
  2842         GO TO 330-CHECK-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL631.cbl
  2843
  2844     IF PI-CARRIER-SECURITY GREATER THAN SPACES
  2845        IF  CARRIERL GREATER THAN ZEROS
  2846            IF PI-CARRIER-SECURITY = CARRIERI
  2847               MOVE AL-UANON     TO CARRIERA
  2848            ELSE
  2849               MOVE ER-2372      TO EMI-ERROR
  2850               MOVE -1           TO CARRIERL
  2851               MOVE AL-UABON     TO CARRIERA
  2852               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2853
  2854     IF PI-ACCOUNT-SECURITY GREATER THAN SPACES
  2855        IF  ACCOUNTL GREATER THAN ZEROS
  2856            IF PI-ACCOUNT-SECURITY = ACCOUNTI
  2857               MOVE AL-UANON     TO ACCOUNTA
  2858            ELSE
  2859               MOVE ER-2372      TO EMI-ERROR
  2860               MOVE -1           TO ACCOUNTL
  2861               MOVE AL-UABON     TO ACCOUNTA
  2862               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2863
  2864     IF BATCHL  GREATER THAN +0
  2865        IF CSRL GREATER THAN +0
  2866           MOVE AL-UABON         TO BATCHA
  2867                                    CSRA
  2868           MOVE ER-2971          TO EMI-ERROR
  2869           MOVE -1               TO BATCHL
  2870           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2871
  2872 330-CHECK-ERRORS.
  2873     IF NOT EMI-NO-ERRORS
  2874        GO TO 8200-SEND-DATAONLY.
  2875
  2876     IF EIBAID = DFHPF1
  2877         PERFORM 5000-CREATE-TEMP-STORAGE THRU 5000-EXIT
  2878         MOVE XCTL-630            TO PGM-NAME
  2879         GO TO 9300-XCTL.
  2880
  2881     IF EIBAID = DFHPF2
  2882         PERFORM 5000-CREATE-TEMP-STORAGE THRU 5000-EXIT
  2883         MOVE XCTL-663            TO PGM-NAME
  2884         GO TO 9300-XCTL.
  2885
  2886     IF EIBAID = DFHPF3
  2887         PERFORM 5000-CREATE-TEMP-STORAGE THRU 5000-EXIT
  2888         MOVE XCTL-656            TO PGM-NAME
  2889         GO TO 9300-XCTL.
  2890
  2891     IF PI-NO-ACCOUNT-SECURITY
  2892        IF PI-NO-CARRIER-SECURITY
  2893           GO TO 330-CONTINUE-EDIT.
  2894
  2895     IF ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL
  2896         GO TO 330-CONTINUE-EDIT.
  2897
  2898     IF BATCHL GREATER THAN ZEROS
  2899         GO TO 330-CONTINUE-EDIT.
  2900
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL631.cbl
  2901     IF CARRIERL GREATER THAN ZEROS
  2902         GO TO 330-CONTINUE-EDIT.
  2903
  2904     MOVE -1                     TO BATCHL.
  2905     MOVE ER-2377                TO EMI-ERROR.
  2906     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2907     GO TO 8200-SEND-DATAONLY.
  2908
  2909 330-CONTINUE-EDIT.
  2910     MOVE ZEROS                  TO PI-PB-BATCH-SEQ-NO.
  2911
  2912     IF BATCHL NOT = ZERO
  2913        MOVE BATCHI              TO PI-PB-ENTRY-BATCH
  2914        PERFORM 6200-READ-FILE  THRU 6299-EXIT
  2915     ELSE
  2916        GO TO 330-SET-BROWSE-CONTROL.
  2917
  2918     IF SEQL NOT = ZERO
  2919         IF SEQI NOT NUMERIC
  2920             MOVE ER-2314 TO EMI-ERROR
  2921             MOVE -1             TO SEQL
  2922             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2923             GO TO 8200-SEND-DATAONLY
  2924         ELSE
  2925             MOVE SEQI TO PI-PB-BATCH-SEQ-NO.
  2926
  2927     IF PI-CARRIER-SECURITY GREATER THAN SPACES
  2928        IF PI-CARRIER-SECURITY = PB-CARRIER NEXT SENTENCE
  2929     ELSE
  2930        MOVE ER-2372             TO EMI-ERROR
  2931        MOVE -1                  TO BATCHL
  2932        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2933        GO TO 8200-SEND-DATAONLY.
  2934
  2935     IF PI-ACCOUNT-SECURITY GREATER THAN SPACES
  2936        IF PI-ACCOUNT-SECURITY = PB-ACCOUNT
  2937         NEXT SENTENCE
  2938     ELSE
  2939        MOVE ER-2372             TO EMI-ERROR
  2940        MOVE -1                  TO BATCHL
  2941        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2942        GO TO 8200-SEND-DATAONLY.
  2943
  2944 330-SET-BROWSE-CONTROL.
  2945
  2946     IF CSRL GREATER THAN +0
  2947        IF OUTBALI = 'Y' OR ONLYHDRI = 'Y'
  2948           MOVE LOW-VALUES          TO PI-ERPNDB-CSR-KEY
  2949           MOVE PI-COMPANY-CD       TO PI-PB-CSR-COMPANY-CD-A2
  2950           MOVE CSRI                TO PI-PB-CSR-ID
  2951           MOVE SPACES           TO PI-PB-CARRIER   PI-PB-GROUPING
  2952                                    PI-PB-STATE     PI-PB-ACCOUNT
  2953           MOVE '4'                 TO PI-BROWSE-TYPE
  2954           GO TO 0340-XCTL.
  2955
  2956     IF OUTBALI = 'Y' OR ONLYHDRI = 'Y'
  2957        IF CARRIERL = ZEROS AND GROUPL = ZEROS AND
  2958           STATEL = ZEROS   AND ACCOUNTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL631.cbl
  2959           MOVE SPACES           TO PI-PB-CARRIER   PI-PB-GROUPING
  2960                                    PI-PB-STATE     PI-PB-ACCOUNT
  2961           MOVE  '1'             TO PI-BROWSE-TYPE
  2962           GO TO 0340-XCTL
  2963        ELSE
  2964           PERFORM 6100-BUILD-KEY THRU 6199-EXIT
  2965           MOVE  '1'             TO PI-BROWSE-TYPE
  2966           GO TO 0340-XCTL.
  2967
  2968     IF CERTNOL NOT = ZEROS
  2969        MOVE CERTNOI             TO PI-PB-CERT-PRIME
  2970        MOVE SPACE               TO PI-PB-CERT-SFX
  2971        IF SUFFIXL NOT = ZEROS
  2972           MOVE SUFFIXI          TO PI-PB-CERT-SFX
  2973        ELSE
  2974           NEXT SENTENCE
  2975     ELSE
  2976        MOVE LOW-VALUES          TO PI-PB-CERT-NO.
  2977
  2978     IF EFFDTL NOT = ZEROS
  2979        MOVE EFFDTI                 TO DEEDIT-FIELD
  2980        PERFORM 8600-DEEDIT
  2981        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  2982        MOVE '4'                    TO DC-OPTION-CODE
  2983        PERFORM 9700-DATE-LINK
  2984        IF DATE-CONVERSION-ERROR
  2985           MOVE ER-0348             TO EMI-ERROR
  2986           MOVE -1                  TO EFFDTL
  2987           MOVE AL-UABON            TO EFFDTA
  2988           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2989        ELSE
  2990           MOVE DC-GREG-DATE-1-EDIT TO EFFDTI
  2991           MOVE AL-UANON            TO EFFDTA
  2992           MOVE DC-BIN-DATE-1       TO PI-PB-CERT-EFF-DT.
  2993
  2994     IF CSRL GREATER THAN +0
  2995        MOVE LOW-VALUES             TO PI-ERPNDB-CSR-KEY
  2996        MOVE PI-COMPANY-CD          TO PI-PB-CSR-COMPANY-CD-A2
  2997        MOVE CSRI                   TO PI-PB-CSR-ID
  2998        MOVE '4'                    TO PI-BROWSE-TYPE
  2999        GO TO 0340-XCTL.
  3000
  3001     IF CARRIERL = ZEROS AND
  3002        GROUPL   = ZEROS AND
  3003        STATEL   = ZEROS AND
  3004        ACCOUNTL = ZEROS
  3005        IF BATCHL NOT = ZEROS
  3006           GO TO 0335-SET-BROWSE-TYPE
  3007        ELSE
  3008           MOVE ' '                 TO PI-BROWSE-TYPE
  3009           GO TO 0340-XCTL.
  3010
  3011     PERFORM 6100-BUILD-KEY THRU 6199-EXIT.
  3012
  3013     IF NOT EMI-NO-ERRORS
  3014        GO TO 8200-SEND-DATAONLY.
  3015
  3016     IF PI-COMPANY-ID NOT = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL631.cbl
  3017         PERFORM 6300-READ-ACCOUNT-FILE THRU 6399-EXIT.
  3018
  3019 0335-SET-BROWSE-TYPE.
  3020     IF STARTATI = 'Y'
  3021        MOVE BATCHI              TO PI-PB-ENTRY-BATCH
  3022        MOVE SPACE               TO PI-BROWSE-TYPE
  3023        GO TO 0340-XCTL.
  3024
  3025     IF BATCHL NOT = ZEROS
  3026        IF CERTNOL = ZEROS AND EFFDTL = ZEROS
  3027           MOVE '1'              TO PI-BROWSE-TYPE
  3028        ELSE
  3029           MOVE '3'              TO PI-BROWSE-TYPE
  3030     ELSE
  3031        MOVE '2'              TO PI-BROWSE-TYPE.
  3032
  3033 0340-XCTL.
  3034     MOVE XCTL-6311              TO PGM-NAME.
  3035     display ' el631 csr session ' PI-CSR-SESSION-SW
  3036
  3037
  3038* EXEC CICS XCTL
  3039*        PROGRAM    (PGM-NAME)
  3040*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3041*        LENGTH     (1300)
  3042*    END-EXEC.
  3043     MOVE 1300
  3044       TO DFHEIV11
  3045*    MOVE '.$C                   $   #00002994' TO DFHEIV0
  3046     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3047     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3048     MOVE X'2020233030303032393934' TO DFHEIV0(25:11)
  3049     CALL 'kxdfhei1' USING DFHEIV0,
  3050           PGM-NAME,
  3051           PROGRAM-INTERFACE-BLOCK,
  3052           DFHEIV11
  3053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3054
  3055
  3056 0350-SELECTION-ERROR.
  3057     MOVE ER-2190                TO EMI-ERROR.
  3058     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3059
  3060 0360-COMBINATION-ERROR.
  3061     MOVE ER-2191                TO EMI-ERROR.
  3062     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3063
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL631.cbl
  3065
  3066 5000-CREATE-TEMP-STORAGE.
  3067
  3068* EXEC CICS WRITEQ TS
  3069*        QUEUE    (QID)
  3070*        FROM     (PROGRAM-INTERFACE-BLOCK)
  3071*        LENGTH   (PI-COMM-LENGTH)
  3072*    END-EXEC.
  3073*    MOVE '*"                    ''   #00003011' TO DFHEIV0
  3074     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3075     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3076     MOVE X'2020233030303033303131' TO DFHEIV0(25:11)
  3077     CALL 'kxdfhei1' USING DFHEIV0,
  3078           QID,
  3079           PROGRAM-INTERFACE-BLOCK,
  3080           PI-COMM-LENGTH,
  3081           DFHEIV99,
  3082           DFHEIV99,
  3083           DFHEIV99
  3084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3085
  3086
  3087 5000-EXIT.
  3088      EXIT.
  3089
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL631.cbl
  3091
  3092 5050-RECOVER-TEMP-STORAGE.
  3093
  3094* EXEC CICS HANDLE CONDITION
  3095*        QIDERR  (5050-QID-ERROR)
  3096*    END-EXEC.
  3097*    MOVE '"$N                   ! # #00003023' TO DFHEIV0
  3098     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3100     MOVE X'2320233030303033303233' TO DFHEIV0(25:11)
  3101     CALL 'kxdfhei1' USING DFHEIV0
  3102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3103
  3104
  3105
  3106* EXEC CICS READQ TS
  3107*         QUEUE   (QID)
  3108*         INTO    (PROGRAM-INTERFACE-BLOCK)
  3109*         LENGTH  (PI-COMM-LENGTH)
  3110*     END-EXEC.
  3111*    MOVE '*$I    L              ''   #00003027' TO DFHEIV0
  3112     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3114     MOVE X'2020233030303033303237' TO DFHEIV0(25:11)
  3115     CALL 'kxdfhei1' USING DFHEIV0,
  3116           QID,
  3117           PROGRAM-INTERFACE-BLOCK,
  3118           PI-COMM-LENGTH,
  3119           DFHEIV99,
  3120           DFHEIV99,
  3121           DFHEIV99
  3122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3123
  3124
  3125
  3126* EXEC CICS DELETEQ TS
  3127*        QUEUE   (QID)
  3128*    END-EXEC.
  3129*    MOVE '*&                    #   #00003033' TO DFHEIV0
  3130     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3131     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3132     MOVE X'2020233030303033303333' TO DFHEIV0(25:11)
  3133     CALL 'kxdfhei1' USING DFHEIV0,
  3134           QID,
  3135           DFHEIV99
  3136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3137
  3138
  3139     GO TO 5050-EXIT.
  3140
  3141 5050-QID-ERROR.
  3142     MOVE ER-0033                TO EMI-ERROR.
  3143     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3144
  3145 5050-EXIT.
  3146      EXIT.
  3147
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL631.cbl
  3149
  3150 6000-BUILD-SCREEN.
  3151     IF RETURN-FROM = XCTL-630 OR XCTL-663 OR XCTL-656
  3152        PERFORM 5050-RECOVER-TEMP-STORAGE THRU 5050-EXIT.
  3153
  3154     MOVE PI-ISSUES-IN-ERROR-SW      TO ANYISSI.
  3155     MOVE PI-CANCELS-IN-ERROR-SW     TO ANYCANI.
  3156     MOVE PI-ALL-ISSUES-SW           TO ALLISSI.
  3157     MOVE PI-ALL-CANCELS-SW          TO ALLCANI.
  3158     MOVE PI-ONLY-BATCH-HEADERS-SW   TO ONLYHDRI.
  3159     MOVE PI-ALL-OUT-OF-BAL-SW       TO OUTBALI.
  3160     MOVE PI-HOLD-REC-SW             TO HLDRECI.
  3161     MOVE PI-CHANGE-REC-SW           TO CHGRECI.
  3162     MOVE PI-ORIGINAL-BATCH-SW       TO ORGINALI.
  3163     MOVE PI-ISSUE-WARNING-SW        TO ANYISSWI.
  3164     MOVE PI-CANCEL-WARNING-SW       TO ANYCANWI.
  3165
  3166     IF PI-PB-ENTRY-BATCH  = SPACES OR = LOW-VALUES
  3167        NEXT SENTENCE
  3168     ELSE
  3169        MOVE AL-UANON            TO BATCHA
  3170        MOVE PI-PB-ENTRY-BATCH   TO BATCHI.
  3171
  3172     IF PI-PB-CERT-NO = SPACES OR = LOW-VALUES
  3173        NEXT SENTENCE
  3174     ELSE
  3175        MOVE AL-UANON            TO CERTNOA
  3176        MOVE PI-PB-CERT-PRIME    TO CERTNOI
  3177        MOVE AL-UANON            TO SUFFIXA
  3178        MOVE PI-PB-CERT-SFX      TO SUFFIXI.
  3179
  3180     IF PI-PB-CERT-EFF-DT = LOW-VALUES OR SPACES
  3181        NEXT SENTENCE
  3182     ELSE
  3183        MOVE PI-PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  3184        MOVE ' '                    TO DC-OPTION-CODE
  3185        PERFORM 9700-DATE-LINK
  3186        MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI
  3187        MOVE AL-UANON               TO EFFDTA.
  3188
  3189     IF PI-NO-PB-RECS-FOUND
  3190        MOVE ER-2375             TO EMI-ERROR
  3191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3192
  3193     IF NOT PI-ALTERNATE-BROWSE
  3194        GO TO 6099-EXIT.
  3195
  3196     IF PI-PB-CARRIER = SPACES OR = LOW-VALUES
  3197        NEXT SENTENCE
  3198     ELSE
  3199        MOVE PI-PB-CARRIER       TO CARRIERI
  3200        MOVE AL-UANON            TO CARRIERA.
  3201
  3202     IF PI-PB-GROUPING = SPACES OR = LOW-VALUES
  3203        NEXT SENTENCE
  3204     ELSE
  3205        MOVE PI-PB-GROUPING      TO GROUPI
  3206        MOVE AL-UANON            TO GROUPA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL631.cbl
  3207
  3208     IF PI-PB-STATE  = SPACES OR = LOW-VALUES
  3209        NEXT SENTENCE
  3210     ELSE
  3211        MOVE PI-PB-STATE         TO STATEI
  3212        MOVE AL-UANON            TO STATEA.
  3213
  3214     IF PI-PB-ACCOUNT  = SPACES OR = LOW-VALUES
  3215        NEXT SENTENCE
  3216     ELSE
  3217        MOVE PI-PB-ACCOUNT       TO ACCOUNTI
  3218        MOVE AL-UANON            TO ACCOUNTA.
  3219
  3220 6099-EXIT.
  3221     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL631.cbl
  3223 6100-BUILD-KEY.
  3224     MOVE SPACES                 TO PI-PB-CARRIER
  3225                                    PI-PB-GROUPING
  3226                                    PI-PB-STATE.
  3227
  3228     IF CARRIERL GREATER THAN ZEROS
  3229        IF (CARR-ACCNT-CNTL       OR
  3230            CARR-ST-ACCNT-CNTL    OR
  3231            CARR-GROUP-ST-ACCNT-CNTL)
  3232            MOVE CARRIERI         TO PI-PB-CARRIER.
  3233
  3234
  3235     IF GROUPL GREATER THAN ZEROS
  3236        IF CARR-GROUP-ST-ACCNT-CNTL
  3237           MOVE GROUPI            TO PI-PB-GROUPING.
  3238
  3239
  3240     IF STATEL GREATER THAN ZEROS
  3241        IF (ST-ACCNT-CNTL         OR
  3242            CARR-ST-ACCNT-CNTL    OR
  3243            CARR-GROUP-ST-ACCNT-CNTL)
  3244            MOVE STATEI           TO PI-PB-STATE.
  3245
  3246     IF ACCOUNTI = SPACES OR = LOW-VALUES
  3247        MOVE SPACES              TO PI-PB-ACCOUNT
  3248        ELSE
  3249        MOVE ACCOUNTI            TO PI-PB-ACCOUNT.
  3250
  3251     IF PI-PB-CARRIER = SPACES AND
  3252        (CARR-ACCNT-CNTL       OR
  3253         CARR-ST-ACCNT-CNTL    OR
  3254         CARR-GROUP-ST-ACCNT-CNTL)
  3255        MOVE ER-0193             TO EMI-ERROR
  3256        MOVE -1                  TO CARRIERL
  3257        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3258
  3259     IF PI-PB-GROUPING = SPACES AND
  3260         CARR-GROUP-ST-ACCNT-CNTL
  3261        MOVE ER-0195             TO EMI-ERROR
  3262        MOVE -1                  TO GROUPL
  3263        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3264
  3265     IF PI-PB-STATE = SPACES AND
  3266        (ST-ACCNT-CNTL         OR
  3267         CARR-ST-ACCNT-CNTL    OR
  3268         CARR-GROUP-ST-ACCNT-CNTL)
  3269        MOVE ER-0144             TO EMI-ERROR
  3270        MOVE -1                  TO STATEL
  3271        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3272
  3273 6199-EXIT.
  3274     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL631.cbl
  3276 6200-READ-FILE.
  3277
  3278* EXEC CICS HANDLE CONDITION
  3279*        NOTFND   (6250-NOT-FOUND)
  3280*    END-EXEC.
  3281*    MOVE '"$I                   ! $ #00003175' TO DFHEIV0
  3282     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3283     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3284     MOVE X'2420233030303033313735' TO DFHEIV0(25:11)
  3285     CALL 'kxdfhei1' USING DFHEIV0
  3286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3287
  3288
  3289     IF PI-COMPANY-ID = CLIENT-MIC OR CLIENT-PEM OR CLIENT-FLA
  3290        IF PI-DISPLAY-ORIGINAL-BATCH
  3291           MOVE ERPNDB3-FILE-ID     TO FILE-ID
  3292        ELSE
  3293           MOVE ERPNDB-FILE-ID      TO FILE-ID
  3294     ELSE
  3295        MOVE ERPNDB-FILE-ID         TO FILE-ID.
  3296
  3297
  3298* EXEC CICS READ
  3299*        GTEQ
  3300*        DATASET   (FILE-ID)
  3301*        SET       (ADDRESS OF PENDING-BUSINESS)
  3302*        RIDFLD    (PI-ERPNDB-KEY)
  3303*    END-EXEC.
  3304*    MOVE '&"S        G          (   #00003187' TO DFHEIV0
  3305     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3307     MOVE X'2020233030303033313837' TO DFHEIV0(25:11)
  3308     CALL 'kxdfhei1' USING DFHEIV0,
  3309           FILE-ID,
  3310           DFHEIV20,
  3311           DFHEIV99,
  3312           PI-ERPNDB-KEY,
  3313           DFHEIV99,
  3314           DFHEIV99,
  3315           DFHEIV99
  3316     SET ADDRESS OF PENDING-BUSINESS TO
  3317         DFHEIV20
  3318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3319
  3320
  3321     IF ORGINALL GREATER THAN ZEROS
  3322        AND ORGINALI = 'Y'
  3323        IF PI-PB-ENTRY-BATCH = PB-ORIGINAL-ENTRY-BATCH AND
  3324           PI-PB-COMPANY-CD  = PB-ORIGINAL-COMPANY-CD
  3325           GO TO 6299-EXIT.
  3326
  3327     IF PI-PB-COMPANY-CD  = PB-COMPANY-CD
  3328        IF STARTATI = 'Y'
  3329            MOVE PB-ENTRY-BATCH TO PI-PB-ENTRY-BATCH
  3330            GO TO 6299-EXIT
  3331        ELSE
  3332            IF PI-PB-ENTRY-BATCH = PB-ENTRY-BATCH
  3333                GO TO 6299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL631.cbl
  3334
  3335 6250-NOT-FOUND.
  3336     MOVE ER-2193                TO EMI-ERROR
  3337     MOVE -1                     TO BATCHL
  3338     MOVE AL-UABON               TO BATCHA
  3339     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3340     GO TO 8200-SEND-DATAONLY.
  3341
  3342 6299-EXIT.
  3343      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL631.cbl
  3345 6300-READ-ACCOUNT-FILE.
  3346     MOVE PI-ERPNDB-ALT-KEY       TO WS-ACCT-KEY.
  3347     MOVE LOW-VALUES              TO WS-EFF-DT.
  3348
  3349
  3350* EXEC CICS HANDLE CONDITION
  3351*        NOTFND   (6350-NOT-FOUND)
  3352*    END-EXEC.
  3353*    MOVE '"$I                   ! % #00003222' TO DFHEIV0
  3354     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3355     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3356     MOVE X'2520233030303033323232' TO DFHEIV0(25:11)
  3357     CALL 'kxdfhei1' USING DFHEIV0
  3358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3359
  3360
  3361
  3362* EXEC CICS READ
  3363*        GTEQ
  3364*        DATASET   (ERACCT2-FILE-ID)
  3365*        SET       (ADDRESS OF ACCOUNT-MASTER)
  3366*        RIDFLD    (WS-ACCT-KEY)
  3367*    END-EXEC.
  3368*    MOVE '&"S        G          (   #00003226' TO DFHEIV0
  3369     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3371     MOVE X'2020233030303033323236' TO DFHEIV0(25:11)
  3372     CALL 'kxdfhei1' USING DFHEIV0,
  3373           ERACCT2-FILE-ID,
  3374           DFHEIV20,
  3375           DFHEIV99,
  3376           WS-ACCT-KEY,
  3377           DFHEIV99,
  3378           DFHEIV99,
  3379           DFHEIV99
  3380     SET ADDRESS OF ACCOUNT-MASTER TO
  3381         DFHEIV20
  3382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3383
  3384
  3385     IF PI-PB-ACCOUNT    = AM-VG-ACCOUNT   AND
  3386        PI-PB-STATE      = AM-VG-STATE     AND
  3387        PI-PB-GROUPING   = AM-VG-GROUPING  AND
  3388        PI-PB-CARRIER    = AM-VG-CARRIER   AND
  3389        PI-PB-COMPANY-CD = AM-COMPANY-CD-A1
  3390          GO TO 6399-EXIT.
  3391
  3392 6350-NOT-FOUND.
  3393     MOVE ER-0179                TO EMI-ERROR.
  3394     MOVE -1                     TO BATCHL.
  3395     MOVE AL-UABON               TO BATCHA.
  3396     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3397     GO TO 8200-SEND-DATAONLY.
  3398
  3399 6399-EXIT.
  3400      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL631.cbl
  3402 8100-SEND-INITIAL-MAP.
  3403     MOVE SPACE                  TO PI-DISPLAY-SCREEN-SW.
  3404
  3405     IF PI-COMPANY-ID = CLIENT-MIC OR CLIENT-PEM OR CLIENT-FLA
  3406        MOVE AL-SANOF            TO ORGHDRA
  3407        MOVE AL-UANON            TO ORGINALA
  3408        MOVE 'N'                 TO ORGINALI
  3409     ELSE
  3410        MOVE AL-SADOF            TO ORGHDRA
  3411        MOVE 'N'                 TO ORGINALI
  3412        MOVE AL-SADON            TO ORGINALA.
  3413
  3414     MOVE PI-ENTRY-CD-1          TO PI-CSR-SESSION-SW
  3415     IF CSR-EDIT-SESSION
  3416        MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
  3417                                 TO HEADO
  3418     END-IF
  3419     MOVE SAVE-DATE              TO DATEO.
  3420     MOVE EIBTIME                TO TIME-IN.
  3421     MOVE TIME-OUT               TO TIMEO.
  3422     MOVE -1                     TO BATCHL.
  3423     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3424     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  3425
  3426
  3427* EXEC CICS SEND
  3428*        MAP      (MAP-NAME)
  3429*        MAPSET   (MAPSET-NAME)
  3430*        FROM     (EL631AO)
  3431*        ERASE
  3432*        CURSOR
  3433*    END-EXEC.
  3434     MOVE LENGTH OF
  3435      EL631AO
  3436       TO DFHEIV12
  3437     MOVE -1
  3438       TO DFHEIV11
  3439*    MOVE '8$     CT  E    H L F ,   #00003274' TO DFHEIV0
  3440     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3441     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3442     MOVE X'2020233030303033323734' TO DFHEIV0(25:11)
  3443     CALL 'kxdfhei1' USING DFHEIV0,
  3444           MAP-NAME,
  3445           EL631AO,
  3446           DFHEIV12,
  3447           MAPSET-NAME,
  3448           DFHEIV99,
  3449           DFHEIV99,
  3450           DFHEIV99,
  3451           DFHEIV11,
  3452           DFHEIV99,
  3453           DFHEIV99,
  3454           DFHEIV99
  3455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3456
  3457
  3458     GO TO 9100-RETURN-TRAN.
  3459
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL631.cbl
  3460 8200-SEND-DATAONLY.
  3461     MOVE SAVE-DATE              TO DATEO.
  3462     MOVE EIBTIME                TO TIME-IN.
  3463     MOVE TIME-OUT               TO TIMEO.
  3464     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3465     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  3466
  3467
  3468* EXEC CICS SEND
  3469*        MAP      (MAP-NAME)
  3470*        MAPSET   (MAPSET-NAME)
  3471*        FROM     (EL631AO)
  3472*        DATAONLY
  3473*        ERASEAUP
  3474*        CURSOR
  3475*    END-EXEC.
  3476     MOVE LENGTH OF
  3477      EL631AO
  3478       TO DFHEIV12
  3479     MOVE -1
  3480       TO DFHEIV11
  3481*    MOVE '8$D    CT  A    H L F ,   #00003291' TO DFHEIV0
  3482     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  3483     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3484     MOVE X'2020233030303033323931' TO DFHEIV0(25:11)
  3485     CALL 'kxdfhei1' USING DFHEIV0,
  3486           MAP-NAME,
  3487           EL631AO,
  3488           DFHEIV12,
  3489           MAPSET-NAME,
  3490           DFHEIV99,
  3491           DFHEIV99,
  3492           DFHEIV99,
  3493           DFHEIV11,
  3494           DFHEIV99,
  3495           DFHEIV99,
  3496           DFHEIV99
  3497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3498
  3499
  3500     GO TO 9100-RETURN-TRAN.
  3501
  3502 8300-SEND-TEXT.
  3503
  3504* EXEC CICS SEND TEXT
  3505*        FROM     (LOGOFF-TEXT)
  3506*        LENGTH   (LOGOFF-LENGTH)
  3507*        ERASE
  3508*        FREEKB
  3509*    END-EXEC.
  3510*    MOVE '8&      T  E F  H   F -   #00003303' TO DFHEIV0
  3511     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3512     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3513     MOVE X'2020233030303033333033' TO DFHEIV0(25:11)
  3514     CALL 'kxdfhei1' USING DFHEIV0,
  3515           LOGOFF-TEXT,
  3516           LOGOFF-LENGTH,
  3517           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL631.cbl
  3518           DFHEIV99,
  3519           DFHEIV99,
  3520           DFHEIV99,
  3521           DFHEIV99,
  3522           DFHEIV99,
  3523           DFHEIV99,
  3524           DFHEIV99,
  3525           DFHEIV99,
  3526           DFHEIV99
  3527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3528
  3529
  3530
  3531* EXEC CICS RETURN
  3532*    END-EXEC.
  3533*    MOVE '.(                    &   #00003310' TO DFHEIV0
  3534     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3535     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3536     MOVE X'2020233030303033333130' TO DFHEIV0(25:11)
  3537     CALL 'kxdfhei1' USING DFHEIV0,
  3538           DFHEIV99,
  3539           DFHEIV99,
  3540           DFHEIV99,
  3541           DFHEIV99,
  3542           DFHEIV99
  3543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3544
  3545
  3546 8600-DEEDIT.
  3547
  3548* EXEC CICS BIF DEEDIT
  3549*         FIELD   (DEEDIT-FIELD)
  3550*         LENGTH  (15)
  3551*    END-EXEC.
  3552     MOVE 15
  3553       TO DFHEIV11
  3554*    MOVE '@"L                   #   #00003314' TO DFHEIV0
  3555     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3556     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3557     MOVE X'2020233030303033333134' TO DFHEIV0(25:11)
  3558     CALL 'kxdfhei1' USING DFHEIV0,
  3559           DEEDIT-FIELD,
  3560           DFHEIV11
  3561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3562
  3563
  3564 8800-UNAUTHORIZED-ACCESS.
  3565     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3566     GO TO 8300-SEND-TEXT.
  3567
  3568 8810-PF23.
  3569     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3570     MOVE XCTL-005               TO PGM-NAME.
  3571     GO TO 9300-XCTL.
  3572
  3573 9000-RETURN-CICS.
  3574
  3575* EXEC CICS RETURN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL631.cbl
  3576*    END-EXEC.
  3577*    MOVE '.(                    &   #00003329' TO DFHEIV0
  3578     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3579     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3580     MOVE X'2020233030303033333239' TO DFHEIV0(25:11)
  3581     CALL 'kxdfhei1' USING DFHEIV0,
  3582           DFHEIV99,
  3583           DFHEIV99,
  3584           DFHEIV99,
  3585           DFHEIV99,
  3586           DFHEIV99
  3587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3588
  3589
  3590 9100-RETURN-TRAN.
  3591     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3592     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  3593
  3594* EXEC CICS RETURN
  3595*        TRANSID    (TRANS-ID)
  3596*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3597*        LENGTH     (PI-COMM-LENGTH)
  3598*    END-EXEC.
  3599*    MOVE '.(CT                  &   #00003335' TO DFHEIV0
  3600     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3601     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3602     MOVE X'2020233030303033333335' TO DFHEIV0(25:11)
  3603     CALL 'kxdfhei1' USING DFHEIV0,
  3604           TRANS-ID,
  3605           PROGRAM-INTERFACE-BLOCK,
  3606           PI-COMM-LENGTH,
  3607           DFHEIV99,
  3608           DFHEIV99
  3609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3610
  3611
  3612 9200-RETURN-MAIN-MENU.
  3613     MOVE XCTL-626               TO PGM-NAME.
  3614     GO TO 9300-XCTL.
  3615
  3616 9300-XCTL.
  3617
  3618* EXEC CICS XCTL
  3619*        PROGRAM    (PGM-NAME)
  3620*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3621*        LENGTH     (PI-COMM-LENGTH)
  3622*    END-EXEC.
  3623*    MOVE '.$C                   $   #00003346' TO DFHEIV0
  3624     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3625     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3626     MOVE X'2020233030303033333436' TO DFHEIV0(25:11)
  3627     CALL 'kxdfhei1' USING DFHEIV0,
  3628           PGM-NAME,
  3629           PROGRAM-INTERFACE-BLOCK,
  3630           PI-COMM-LENGTH
  3631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3632
  3633
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL631.cbl
  3634 9400-CLEAR.
  3635     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  3636     GO TO 9300-XCTL.
  3637
  3638 9500-PF12.
  3639     MOVE XCTL-010               TO PGM-NAME.
  3640     GO TO 9300-XCTL.
  3641
  3642 9600-PGMID-ERROR.
  3643
  3644* EXEC CICS HANDLE CONDITION
  3645*        PGMIDERR    (8300-SEND-TEXT)
  3646*    END-EXEC.
  3647*    MOVE '"$L                   ! & #00003361' TO DFHEIV0
  3648     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3650     MOVE X'2620233030303033333631' TO DFHEIV0(25:11)
  3651     CALL 'kxdfhei1' USING DFHEIV0
  3652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3653
  3654
  3655     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  3656     MOVE ' '                    TO PI-ENTRY-CD-1.
  3657     MOVE XCTL-005               TO PGM-NAME.
  3658     MOVE PGM-NAME               TO LOGOFF-PGM.
  3659     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  3660     GO TO 9300-XCTL.
  3661
  3662 9700-DATE-LINK.
  3663     MOVE LINK-ELDATCV           TO PGM-NAME
  3664
  3665* EXEC CICS LINK
  3666*        PROGRAM    (PGM-NAME)
  3667*        COMMAREA   (DATE-CONVERSION-DATA)
  3668*        LENGTH     (DC-COMM-LENGTH)
  3669*    END-EXEC.
  3670*    MOVE '."C                   ''   #00003374' TO DFHEIV0
  3671     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3672     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3673     MOVE X'2020233030303033333734' TO DFHEIV0(25:11)
  3674     CALL 'kxdfhei1' USING DFHEIV0,
  3675           PGM-NAME,
  3676           DATE-CONVERSION-DATA,
  3677           DC-COMM-LENGTH,
  3678           DFHEIV99,
  3679           DFHEIV99,
  3680           DFHEIV99
  3681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3682
  3683
  3684 9900-ERROR-FORMAT.
  3685     IF NOT EMI-ERRORS-COMPLETE
  3686         MOVE LINK-001           TO PGM-NAME
  3687
  3688* EXEC CICS LINK
  3689*            PROGRAM    (PGM-NAME)
  3690*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3691*            LENGTH     (EMI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL631.cbl
  3692*        END-EXEC.
  3693*    MOVE '."C                   ''   #00003383' TO DFHEIV0
  3694     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3695     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3696     MOVE X'2020233030303033333833' TO DFHEIV0(25:11)
  3697     CALL 'kxdfhei1' USING DFHEIV0,
  3698           PGM-NAME,
  3699           ERROR-MESSAGE-INTERFACE-BLOCK,
  3700           EMI-COMM-LENGTH,
  3701           DFHEIV99,
  3702           DFHEIV99,
  3703           DFHEIV99
  3704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3705
  3706
  3707 9900-EXIT.
  3708     EXIT.
  3709
  3710 9990-ABEND.
  3711     MOVE LINK-004               TO PGM-NAME.
  3712     MOVE DFHEIBLK               TO EMI-LINE1.
  3713
  3714* EXEC CICS LINK
  3715*        PROGRAM   (PGM-NAME)
  3716*        COMMAREA  (EMI-LINE1)
  3717*        LENGTH    (72)
  3718*    END-EXEC.
  3719     MOVE 72
  3720       TO DFHEIV11
  3721*    MOVE '."C                   ''   #00003395' TO DFHEIV0
  3722     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3723     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3724     MOVE X'2020233030303033333935' TO DFHEIV0(25:11)
  3725     CALL 'kxdfhei1' USING DFHEIV0,
  3726           PGM-NAME,
  3727           EMI-LINE1,
  3728           DFHEIV11,
  3729           DFHEIV99,
  3730           DFHEIV99,
  3731           DFHEIV99
  3732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3733
  3734
  3735     GO TO 8200-SEND-DATAONLY.
  3736
  3737
  3738* GOBACK.
  3739     MOVE '9%                    "   ' TO DFHEIV0
  3740     MOVE 'EL631' TO DFHEIV1
  3741     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3742     GOBACK.
  3743
  3744 9995-SECURITY-VIOLATION.
  3745*                            COPY ELCSCTP.
  3746******************************************************************
  3747*                                                                *
  3748*                            ELCSCTP                             *
  3749*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL631.cbl
  3750*                                                                *
  3751*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3752******************************************************************
  3753
  3754
  3755     MOVE EIBDATE          TO SM-JUL-DATE.
  3756     MOVE EIBTRMID         TO SM-TERMID.
  3757     MOVE THIS-PGM         TO SM-PGM.
  3758     MOVE EIBTIME          TO TIME-IN.
  3759     MOVE TIME-OUT         TO SM-TIME.
  3760     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3761
  3762
  3763* EXEC CICS LINK
  3764*         PROGRAM  ('EL003')
  3765*         COMMAREA (SECURITY-MESSAGE)
  3766*         LENGTH   (80)
  3767*    END-EXEC.
  3768     MOVE 'EL003' TO DFHEIV1
  3769     MOVE 80
  3770       TO DFHEIV11
  3771*    MOVE '."C                   ''   #00003423' TO DFHEIV0
  3772     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3773     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3774     MOVE X'2020233030303033343233' TO DFHEIV0(25:11)
  3775     CALL 'kxdfhei1' USING DFHEIV0,
  3776           DFHEIV1,
  3777           SECURITY-MESSAGE,
  3778           DFHEIV11,
  3779           DFHEIV99,
  3780           DFHEIV99,
  3781           DFHEIV99
  3782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3783
  3784
  3785******************************************************************
  3786
  3787
  3788 9995-EXIT.
  3789     EXIT.
  3790
  3791
  3792
  3793 9999-DFHBACK SECTION.
  3794     MOVE '9%                    "   ' TO DFHEIV0
  3795     MOVE 'EL631' TO DFHEIV1
  3796     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3797     GOBACK.
  3798 9999-DFHEXIT.
  3799     IF DFHEIGDJ EQUAL 0001
  3800         NEXT SENTENCE
  3801     ELSE IF DFHEIGDJ EQUAL 2
  3802         GO TO 9600-PGMID-ERROR,
  3803               9990-ABEND
  3804         DEPENDING ON DFHEIGDI
  3805     ELSE IF DFHEIGDJ EQUAL 3
  3806         GO TO 5050-QID-ERROR
  3807         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL631.cbl
  3808     ELSE IF DFHEIGDJ EQUAL 4
  3809         GO TO 6250-NOT-FOUND
  3810         DEPENDING ON DFHEIGDI
  3811     ELSE IF DFHEIGDJ EQUAL 5
  3812         GO TO 6350-NOT-FOUND
  3813         DEPENDING ON DFHEIGDI
  3814     ELSE IF DFHEIGDJ EQUAL 6
  3815         GO TO 8300-SEND-TEXT
  3816         DEPENDING ON DFHEIGDI.
  3817     MOVE '9%                    "   ' TO DFHEIV0
  3818     MOVE 'EL631' TO DFHEIV1
  3819     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3820     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3980     Code:        8093
