* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page   1
* ELRAMT.cbl
* Options: int("ELRAMT.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRAMT.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRAMT.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRAMT.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ELRAMT.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:15.
     7*                           VMOD=2.007
     8*
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page   2
* ELRAMT.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE REMAINING AMOUNTS    *
    28*            *    FOR A CERTIFICATE.                             *
    29*            *                                                   *
    30*            *    ORIGINAL BENEFIT = CP-ORIGINAL-BENEFIT         *
    31*            *    ORIGINAL TERM = CP-ORIGINAL-TERM               *
    32*            *    REMAINING-TERM  = CP-REMAINING-TERM            *
    33*            *    A.P.R (FOR NET PAY) = CP-LOAN-APR              *
    34*            *    BENEFIT TYPE = CP-BENEFIT-TYPE                 *
    35*            *    METHOD = CP-EARNING-METHOD                     *
    36*            *    IF COMPANY SPECIAL METHOD  - PUT COMPANY       *
    37*            *     I.D. IN CP-COMPANY-ID.                        *
    38*            *                                                   *
    39*            *****************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page   3
* ELRAMT.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER   PIC X(32) VALUE '********************************'.
    47 77  FILLER   PIC X(32) VALUE '**  ELRAMT  WORKING STORAGE   **'.
    48 77  FILLER   PIC X(32) VALUE '********* VMOD 2.007 ***********'.
    49
    50*                          COPY ELCRAMTW.
    51*****************************************************************
    52*                                                               *
    53*                                                               *
    54*                            ELCRAMTW.                          *
    55*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    56*                            VMOD=2.004                         *
    57*                                                               *
    58*****************************************************************.
    59******************************************************************
    60*                   C H A N G E   L O G
    61*
    62* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    63*-----------------------------------------------------------------
    64*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    65* EFFECTIVE    NUMBER
    66*-----------------------------------------------------------------
    67* 041710    2007111300001  AJRA  CALC SC NET PAY PLUS 6
    68* 071312  CR2012042600002  PEMA  AHL GROSS TRUNC RAMT
    69******************************************************************
    70
    71 01  FILLER.
    72     12  WS-PASS-SW          PIC 9                  VALUE ZERO.
    73       88 COMPUTING-CURRENT-MO                      VALUE ZERO.
    74       88 COMPUTING-PRIOR-MO                        VALUE 1.
    75
    76 01  WS-WORK-MISC.
    77     12  ws-extra-pmts       pic s999        comp-3.
    78     12  WS-REMAINING-TERM   PIC S9(4)V9     COMP-3.
    79     12  WS-TEMP-RESULT      PIC S9(9)V9(6)  COMP-3.
    80     12  WS-REMAINING-AMT    PIC S9(9)V99    COMP-3.
    81
    82 01  TEXAS-REG-WORK-AREAS.
    83     12  TEX-FACT-1          PIC S9(9)V9(2)  COMP-3.
    84     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    85     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    86     12  TEX-FACT-4          PIC S9(7)       COMP-3.
    87     12  TEX-FACT-5          PIC S9(3)       COMP-3.
    88     12  TEX-FACT-6          PIC S9(3)       COMP-3.
    89     12  TEX-FACT-7          PIC S9(7)       COMP-3.
    90     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
    91     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
    92
    93 01  NET-PAY-INTERFACE.
    94     12  NP-APR              PIC S9(3)V9(4)  COMP-3.
    95     12  NP-ORIG             PIC S9(3)       COMP-3.
    96     12  NP-LOAN-TERM        PIC S9(3)       COMP-3.
    97     12  NP-REM              PIC S9(3)       COMP-3.
    98     12  NP-CAP              PIC S9(3)       COMP-3.
    99     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
   100     12  NP-WORK1            PIC S9(6)V9(6)  COMP-3.
   101     12  NP-WORK2            PIC S9(6)V9(6)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page   4
* ELRAMT.cbl
   102     12  NP-OPT              PIC X(01).
   103         88  NPO-STD                         VALUE ' '.
   104         88  NPO-ALT                         VALUE 'A'.
   105         88  NPO-SIMPLE                      VALUE 'S'.
   106         88  NPO-2MO                         VALUE 'I'.
   107         88  NPO-TRUNC                       VALUE 'T' 'U' 'V'.
   108         88  NPO-TRUNC-0                     VALUE 'T'.
   109         88  NPO-TRUNC-1                     VALUE 'U'.
   110         88  NPO-TRUNC-2                     VALUE 'V'.
   111         88  NPO-REFUND                      VALUE 'R'.
   112     12  NP-TYPE             PIC X(01).
   113         88  NET-STD                         VALUE 'N'.
   114         88  NET-SMP                         VALUE 'S'.
   115
   116 01  COMP-3-WORK-AREA         COMP-3.
   117     12  V               PIC SV9(9)    VALUE +.0.
   118     12  I               PIC SV9(9)    VALUE +.0.
   119     12  Y               PIC S9(2)V9(5) VALUE +.0.
   120     12  WK1             PIC S9(4)V9(9).
   121     12  WK2             PIC S9(4)V9(9).
   122     12  WK3             PIC S9(4)V9(9).
   123     12  K1              PIC S999,     VALUE +1.
   124     12  K12             PIC S999,     VALUE +12.
   125     12  K100            PIC S999,     VALUE +100.
   126     12  K1000           PIC S9(7),    VALUE +1000.
   127     12  ANNUAL-INT-RATE PIC S9(3)V9(4).
   128     12  ORIGINAL-TERM   PIC S999.
   129     12  REMAINING-TERM  PIC S999.
   130     12  CAPPED-TERM     PIC S999.
   131     12  FACTOR          PIC S9(4)V9(9).
   132     12  VX              PIC S9V9(8)        VALUE +0.0.
   133     12  SV              PIC S9V9(8)        VALUE +0.0.
   134     12  SX              PIC S9V9(8)        VALUE +0.0.
   135     12  RA              PIC S9(6)V9(9)     VALUE +0.0.
   136     12  N2              PIC S9(7)          VALUE +0.
   137     12  N3              PIC S9(7)          VALUE +0.
   138     12  K-I             PIC S9V9(8)        VALUE +0.0.
   139     12  ODF             PIC S9(3)V9(10)    VALUE +0.0.
   140     12  OD              PIC S9(3)V9(10)    VALUE +0.0.
   141     12  ANGLEM          PIC S9(7)V9(10)    VALUE +0.0.
   142     12  ANGLEN          PIC S9(7)V9(10)    VALUE +0.0.
   143     12  ANGLEU          PIC S9(7)V9(10)    VALUE +0.0.
   144     12  ANGLEM1         PIC S9(7)V9(10)    VALUE +0.0.
   145     12  ANGLEN1         PIC S9(7)V9(10)    VALUE +0.0.
   146
   147 01  BINARY-WORK-AREA        COMP.
   148     12  X1      PIC S999        VALUE +0.
   149     12  X2      PIC S999        VALUE +0.
   150     12  MAX-X   PIC S9(5)       VALUE +0.
   151     12  B1      PIC S9(5)       VALUE +1.
   152     12  B2      PIC S9(5)       VALUE +2.
   153
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page   5
* ELRAMT.cbl
   155*                          COPY ELCCALC.
   156******************************************************************
   157*                                                                *
   158*                           ELCCALC.                            *
   159*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   160*                            VMOD=2.025                          *
   161*                                                                *
   162*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   163*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   164*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   165*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   166*                                                                *
   167*  PASSED TO ELRTRM                                              *
   168*  -----------------                                             *
   169*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   170*  ORIGINAL TERM                                                 *
   171*  BEGINNING DATE                                                *
   172*  ENDING DATE                                                   *
   173*  COMPANY I.D.                                                  *
   174*  ACCOUNT MASTER USER FIELD                                     *
   175*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   176*  FREE LOOK DAYS                                                *
   177*                                                                *
   178*  RETURNED FROM ELRTRM                                          *
   179*  ---------------------                                         *
   180*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   181*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   182*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   183*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   184*----------------------------------------------------------------*
   185*  PASSED TO ELRAMT                                              *
   186*  ----------------                                              *
   187*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   188*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   189*  ORIGINAL AMOUNT                                               *
   190*  ALTERNATE BENEFIT (BALLON)                                    *
   191*  A.P.R. - NET PAY ONLY                                         *
   192*  METHOD
   193*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   194*  COMPANY I.D.                                                  *
   195*  BENEFIT TYPE                                                  *
   196*                                                                *
   197*  RETURNED FROM ELRAMT                                          *
   198*  --------------------                                          *
   199*  REMAINING AMOUNT 1 - CURRENT                                  *
   200*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   201*  REMAINING AMOUNT FACTOR
   202*----------------------------------------------------------------*
   203*  PASSED TO ELRESV                                              *
   204*  -----------------                                             *
   205*  CERTIFICATE EFFECTIVE DATE                                    *
   206*  VALUATION DATE                                                *
   207*  PAID THRU DATE                                                *
   208*  BENEFIT                                                       *
   209*  INCURRED DATE                                                 *
   210*  REPORTED DATE                                                 *
   211*  ISSUE AGE                                                     *
   212*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page   6
* ELRAMT.cbl
   213*  CDT PERCENT                                                   *
   214*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   215* *CLAIM TYPE (LIFE, A/H)                                        *
   216* *REMAINING BENEFIT (FROM ELRAMT)                               *
   217* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   218*                                                                *
   219*  RETURNED FROM ELRESV                                          *
   220*  --------------------                                          *
   221*  CDT TABLE USED                                                *
   222*  CDT FACTOR USED                                               *
   223*  PAY TO CURRENT RESERVE                                        *
   224*  I.B.N.R. - A/H ONLY                                           *
   225*  FUTURE (ACCRUED) AH ONLY                                      *
   226*----------------------------------------------------------------*
   227*  PASSED TO ELRATE                                              *
   228*  ----------------                                              *
   229*  CERT ISSUE DATE                                               *
   230*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   231*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   232*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   233*  STATE CODE (CLIENT DEFINED)                                   *
   234*  STATE CODE (STANDARD P.O. ABBRV)                              *
   235*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   236*  DEVIATION CODE                                                *
   237*  ISSUE AGE                                                     *
   238*  ORIGINAL BENEFIT AMOUNT                                       *
   239*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   240*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   241*  BENEFIT KIND (LIFE OR A/H)                                    *
   242*  A.P.R.                                                        *
   243*  METHOD
   244*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   245*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   246*  COMPANY I.D. (3 CHARACTER)                                    *
   247*  BENEFIT CODE                                                  *
   248*  BENEFIT OVERRIDE CODE                                         *
   249*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   250*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   251*  JOINT INDICATOR (CSL ONLY)                                    *
   252*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   253*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   254*                                                                *
   255*  RETURNED FROM ELRATE                                          *
   256*  --------------------                                          *
   257*  CALCULATED PREMIUM                                            *
   258*  PREMIUM RATE                                                  *
   259*  MORTALITY CODE                                                *
   260*  MAX ATTAINED AGE                                              *
   261*  MAX AGE                                                       *
   262*  MAX TERM                                                      *
   263*  MAX MONTHLY BENEFIT                                           *
   264*  MAX TOTAL BENIFIT                                             *
   265*  COMPOSITE RATE (OPEN-END ONLY)                                *
   266*----------------------------------------------------------------*
   267*  PASSED TO ELRFND                                              *
   268*  ----------------                                              *
   269*  CERT ISSUE DATE                                               *
   270*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page   7
* ELRAMT.cbl
   271*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   272*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   273*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   274*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   275*  STATE CODE (CLIENT DEFINED)                                   *
   276*  STATE CODE (STANDARD P.O. ABBRV)                              *
   277*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   278*  DEVIATION CODE                                                *
   279*  ISSUE AGE                                                     *
   280*  ORIGINAL BENEFIT AMOUNT                                       *
   281*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   282*  PROCESS TYPE (CANCEL)                                         *
   283*  BENEFIT KIND (LIFE OR A/H)                                    *
   284*  A.P.R.                                                        *
   285*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   286*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   287*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   288*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   289*  COMPANY I.D. (3 CHARACTER)                                    *
   290*  BENEFIT CODE                                                  *
   291*  BENEFIT OVERRIDE CODE                                         *
   292*                                                                *
   293*  RETURNED FROM ELRFND                                          *
   294*  --------------------                                          *
   295*  CALCULATED REFUND                                             *
   296*----------------------------------------------------------------*
   297*  PASSED TO ELEARN                                              *
   298*  ----------------                                              *
   299*  CERT ISSUE DATE                                               *
   300*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   301*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   302*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   303*  STATE CODE (CLIENT DEFINED)                                   *
   304*  STATE CODE (STANDARD P.O. ABBRV)                              *
   305*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   306*  DEVIATION CODE                                                *
   307*  ISSUE AGE                                                     *
   308*  ORIGINAL BENEFIT AMOUNT                                       *
   309*  BENEFIT KIND (LIFE OR A/H)                                    *
   310*  A.P.R.                                                        *
   311*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   312*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   313*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   314*  COMPANY I.D. (3 CHARACTER)                                    *
   315*  BENEFIT CODE                                                  *
   316*  BENEFIT OVERRIDE CODE                                         *
   317*                                                                *
   318*  RETURNED FROM ELEARN                                          *
   319*  --------------------                                          *
   320*  INDICATED  EARNINGS                                           *
   321*----------------------------------------------------------------*
   322*                 LENGTH = 450                                   *
   323*                                                                *
   324******************************************************************
   325******************************************************************
   326*                   C H A N G E   L O G
   327*
   328* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page   8
* ELRAMT.cbl
   329*-----------------------------------------------------------------
   330*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   331* EFFECTIVE    NUMBER
   332*-----------------------------------------------------------------
   333* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   334* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   335* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   336* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   337* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   338* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   339* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   340* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   341* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   342******************************************************************
   343
   344 01  CALCULATION-PASS-AREA.
   345     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   346                                     COMP.
   347
   348     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   349       88  NO-CP-ERROR                             VALUE ZERO.
   350       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   351                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   352       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   353       88  CP-ERROR-IN-DATES                       VALUE '2'.
   354       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   355       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   356       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   357       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   358       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   359       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   360       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   361       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   362       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   363       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   364       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   365       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   366       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   367       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   368       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   369
   370     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   371       88  NO-CP-ERROR-2                           VALUE ZERO.
   372***********************  INPUT AREAS ****************************
   373
   374     12  CP-CALCULATION-AREA.
   375         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   376         16  CP-CERT-EFF-DT        PIC XX.
   377         16  CP-VALUATION-DT       PIC XX.
   378         16  CP-PAID-THRU-DT       PIC XX.
   379         16  CP-BENEFIT-TYPE       PIC X.
   380           88  CP-AH                               VALUE 'A' 'D'
   381                                                   'I' 'U'.
   382           88  CP-REDUCING-LIFE                    VALUE 'R'.
   383           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   384         16  CP-INCURRED-DT        PIC XX.
   385         16  CP-REPORTED-DT        PIC XX.
   386         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page   9
* ELRAMT.cbl
   387         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   388         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   389                                     COMP-3.
   390         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   391                                     COMP-3.
   392         16  CP-CDT-METHOD         PIC X.
   393           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   394           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   395           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   396         16  CP-CLAIM-TYPE         PIC X.
   397           88  CP-AH-CLAIM                         VALUE 'A'.
   398           88  CP-LIFE-CLAIM                       VALUE 'L'.
   399         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   400                                     COMP-3.
   401         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   402                                     COMP-3.
   403         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   404                                     COMP-3.
   405         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   406                                     COMP-3.
   407         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   408                                     COMP-3.
   409         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   410                                     COMP-3.
   411         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   412                                     COMP-3.
   413         16  CP-REM-TERM-METHOD    PIC X.
   414           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   415           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   416           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   417           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   418           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   419           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   420           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   421         16  CP-EARNING-METHOD     PIC X.
   422           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   423           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   424           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   425           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   426           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   427           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   428           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   429           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   430           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   431           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   432           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   433           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   434           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   435           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   436         16  CP-PROCESS-TYPE       PIC X.
   437           88  CP-CLAIM                            VALUE '1'.
   438           88  CP-CANCEL                           VALUE '2'.
   439           88  CP-ISSUE                            VALUE '3'.
   440         16  CP-SPECIAL-CALC-CD    PIC X.
   441           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   442           88  CP-1-MTH-INTEREST               VALUE ' '.
   443           88  CP-0-MTH-INTEREST               VALUE 'A'.
   444           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  10
* ELRAMT.cbl
   445           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   446           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   447           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   448           88  CP-FARM-PLAN                    VALUE 'F'.
   449           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   450           88  CP-2-MTH-INTEREST               VALUE 'I'.
   451           88  CP-3-MTH-INTEREST               VALUE 'J'.
   452           88  CP-4-MTH-INTEREST               VALUE 'K'.
   453           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   454           88  CP-MORTGAGE-REC                 VALUE 'M'.
   455           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   456           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   457           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   458           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   459                                                     'W' 'X'.
   460           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   461           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   462           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   463           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   464           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   465           88  CP-SUMMARY-REC                  VALUE 'Z'.
   466           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   467           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   468           88  CP-AD-D-BENEFIT                 VALUE '4'.
   469           88  CP-CSL-METH-1                   VALUE '5'.
   470           88  CP-CSL-METH-2                   VALUE '6'.
   471           88  CP-CSL-METH-3                   VALUE '7'.
   472           88  CP-CSL-METH-4                   VALUE '8'.
   473
   474         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   475                                     COMP-3.
   476         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   477         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   478         16  CP-STATE              PIC XX          VALUE SPACE.
   479         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   480         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   481           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   482               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   483         16  CP-R78-OPTION         PIC X.
   484           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   485           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   486
   487         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   488         16  CP-IBNR-RESERVE-SW    PIC X.
   489         16  CP-CLAIM-STATUS       PIC X.
   490         16  CP-RATE-FILE          PIC X.
   491         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   492                                     COMP-3.
   493
   494         16  CP-LIFE-OVERRIDE-CODE PIC X.
   495         16  CP-AH-OVERRIDE-CODE   PIC X.
   496
   497         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   498                                     COMP-3.
   499         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   500                                   PIC S9(5)V99 COMP-3.
   501         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   502                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  11
* ELRAMT.cbl
   503         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   504                                     COMP-3.
   505         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   506                                     COMP-3.
   507         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   508                                  PIC S9(7)V99 COMP-3.
   509
   510         16  CP-PAID-FROM-DATE     PIC X(02).
   511         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   512         16  CP-EXT-DAYS-CALC      PIC X.
   513           88  CP-EXT-NO-CHG                   VALUE ' '.
   514           88  CP-EXT-CHG-LF                   VALUE '1'.
   515           88  CP-EXT-CHG-AH                   VALUE '2'.
   516           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   517         16  CP-DOMICILE-STATE     PIC XX.
   518         16  CP-CARRIER            PIC X.
   519         16  CP-REIN-FLAG          PIC X.
   520         16  CP-REM-TRM-CALC-OPTION PIC X.
   521           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   522                      '2' '3' '4' '5'.
   523           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   524           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   525           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   526           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   527           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   528           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   529           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   530           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   531         16  CP-SIG-SWITCH         PIC X.
   532         16  CP-RATING-METHOD      PIC X.
   533           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   534           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   535           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   536           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   537           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   538           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   539           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   540           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   541           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   542         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   543                                     COMP-3.
   544         16  CP-BEN-CATEGORY       PIC X.
   545         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   546         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   547                                   PIC S99V9(5) COMP-3.
   548         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   549         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   550                                   PIC S99V9(5) COMP-3.
   551         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   552         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   553         16  CP-EXPIRE-DT          PIC XX.
   554         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   555         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   556         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   557         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   558         16  CP-DDF-SPEC-CALC      PIC X.
   559             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   560             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  12
* ELRAMT.cbl
   561         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   562         16  CP-CANCEL-REASON      PIC X.
   563         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   564         16  CP-PMT-MODE           PIC X.
   565         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   566         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   567         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   568         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   569         16  FILLER                PIC X.
   570
   571***************    OUTPUT FROM ELRESV   ************************
   572
   573         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   574
   575         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   576                                     COMP-3.
   577         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   578                                     COMP-3.
   579         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   580                                     COMP-3.
   581         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   582                                     COMP-3.
   583         16  FILLER                PIC X(09).
   584***************    OUTPUT FROM ELRTRM   *************************
   585
   586         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   587                                     COMP-3.
   588         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   589                                     COMP-3.
   590         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   591                                     COMP-3.
   592         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   593                                     COMP-3.
   594         16  FILLER                PIC X(12).
   595
   596***************    OUTPUT FROM ELRAMT   *************************
   597
   598         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   599                                     COMP-3.
   600         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   601                                     COMP-3.
   602         16  FILLER                PIC X(12).
   603
   604***************    OUTPUT FROM ELRATE   *************************
   605
   606         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   607                                     COMP-3.
   608         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   609                                     COMP-3.
   610         16  CP-MORTALITY-CODE     PIC X(4).
   611         16  CP-RATE-EDIT-FLAG     PIC X.
   612             88  CP-RATES-NEED-APR                  VALUE '1'.
   613         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   614                                     COMP-3.
   615         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   616         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   617         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   618                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  13
* ELRAMT.cbl
   619         16  FILLER                PIC X(07).
   620
   621***************    OUTPUT FROM ELRFND   *************************
   622
   623         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   624                                     COMP-3.
   625         16  CP-REFUND-TYPE-USED   PIC X.
   626           88  CP-R-AS-R78                         VALUE '1'.
   627           88  CP-R-AS-PRORATA                     VALUE '2'.
   628           88  CP-R-AS-CALIF                       VALUE '3'.
   629           88  CP-R-AS-TEXAS                       VALUE '4'.
   630           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   631           88  CP-R-AS-NET-PAY                     VALUE '5'.
   632           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   633           88  CP-R-AS-MEAN                        VALUE '8'.
   634           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   635           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   636           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   637           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   638           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   639           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   640         16  FILLER                PIC X(12).
   641
   642***************    OUTPUT FROM ELEARN   *************************
   643
   644         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   645                                     COMP-3.
   646         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   647                                     COMP-3.
   648         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   649                                     COMP-3.
   650         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   651                                     COMP-3.
   652         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   653                                     COMP-3.
   654         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   655                                     COMP-3.
   656         16  CP-EARNING-TYPE-USED  PIC X.
   657           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   658           88  CP-E-AS-R78                         VALUE '1'.
   659           88  CP-E-AS-PRORATA                     VALUE '2'.
   660           88  CP-E-AS-TEXAS                       VALUE '4'.
   661           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   662           88  CP-E-AS-NET-PAY                     VALUE '5'.
   663           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   664           88  CP-E-AS-MEAN                        VALUE '8'.
   665           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   666         16  FILLER                PIC X(12).
   667
   668***************    OUTPUT FROM ELPMNT   *************************
   669
   670         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   671                                     COMP-3.
   672         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   673                                     COMP-3.
   674         16  FILLER                PIC X(12).
   675
   676***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  14
* ELRAMT.cbl
   677         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   678                                     COMP-3.
   679         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   680                                     COMP-3.
   681         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   682                                     COMP-3.
   683         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   684                                     COMP-3.
   685         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   686                                     COMP-3.
   687         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   688                                     COMP-3.
   689         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   690             88  OPEN-RATE-FILE                   VALUE 'O'.
   691             88  CLOSE-RATE-FILE                  VALUE 'C'.
   692             88  IO-ERROR                         VALUE 'E'.
   693
   694         16  CP-FIRST-PAY-DATE     PIC XX.
   695
   696         16  CP-JOINT-INDICATOR    PIC X.
   697
   698         16  CP-RESERVE-REMAINING-TERM
   699                                   PIC S9(4)V9    VALUE ZERO
   700                                     COMP-3.
   701
   702         16  CP-INSURED-BIRTH-DT   PIC XX.
   703
   704         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   705                                     COMP-3.
   706
   707         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   708                                     COMP-3.
   709
   710         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   711                                     COMP-3.
   712
   713         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   714                                     COMP-3.
   715
   716         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   717                                     COMP-3.
   718
   719         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   720                                     COMP-3.
   721
   722         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   723                                     COMP-3.
   724
   725         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   726             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   727
   728         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   729                                     COMP-3.
   730         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   731                                     COMP-3.
   732         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
   733         16  FILLER                PIC X(15).
   734******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  15
* ELRAMT.cbl
   736*                          COPY ELCDATE.
   737******************************************************************
   738*                                                                *
   739*                                                                *
   740*                            ELCDATE.                            *
   741*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   742*                            VMOD=2.003
   743*                                                                *
   744*                                                                *
   745*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   746*                 LENGTH = 200                                   *
   747******************************************************************
   748
   749 01  DATE-CONVERSION-DATA.
   750     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   751     12  DC-OPTION-CODE                PIC X.
   752         88  BIN-TO-GREG                VALUE ' '.
   753         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   754         88  EDIT-GREG-TO-BIN           VALUE '2'.
   755         88  YMD-GREG-TO-BIN            VALUE '3'.
   756         88  MDY-GREG-TO-BIN            VALUE '4'.
   757         88  JULIAN-TO-BIN              VALUE '5'.
   758         88  BIN-PLUS-ELAPSED           VALUE '6'.
   759         88  FIND-CENTURY               VALUE '7'.
   760         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   761         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   762         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   763         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   764         88  JULIAN-TO-BIN-3            VALUE 'C'.
   765         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   766         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   767         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   768         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   769         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   770         88  CHECK-LEAP-YEAR            VALUE 'H'.
   771         88  BIN-3-TO-GREG              VALUE 'I'.
   772         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   773         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   774         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   775         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   776         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   777         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   778         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   779         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   780         88  THREE-CHARACTER-BIN
   781                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   782         88  GREGORIAN-TO-BIN
   783                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   784         88  BIN-TO-GREGORIAN
   785                  VALUES ' ' '1' 'I' '8' 'G'.
   786         88  JULIAN-TO-BINARY
   787                  VALUES '5' 'C' 'E' 'F'.
   788     12  DC-ERROR-CODE                 PIC X.
   789         88  NO-CONVERSION-ERROR        VALUE ' '.
   790         88  DATE-CONVERSION-ERROR
   791                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   792         88  DATE-IS-ZERO               VALUE '1'.
   793         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  16
* ELRAMT.cbl
   794         88  DATE-IS-INVALID            VALUE '3'.
   795         88  DATE1-GREATER-DATE2        VALUE '4'.
   796         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   797         88  DATE-INVALID-OPTION        VALUE '9'.
   798         88  INVALID-CENTURY            VALUE 'A'.
   799         88  ONLY-CENTURY               VALUE 'B'.
   800         88  ONLY-LEAP-YEAR             VALUE 'C'.
   801         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   802     12  DC-END-OF-MONTH               PIC X.
   803         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   804     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   805         88  USE-NORMAL-PROCESS         VALUE ' '.
   806         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   807         88  ADJUST-UP-100-YRS          VALUE '2'.
   808     12  FILLER                        PIC X.
   809     12  DC-CONVERSION-DATES.
   810         16  DC-BIN-DATE-1             PIC XX.
   811         16  DC-BIN-DATE-2             PIC XX.
   812         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   813         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   814                       DC-GREG-DATE-1-EDIT.
   815             20  DC-EDIT1-MONTH        PIC 99.
   816             20  SLASH1-1              PIC X.
   817             20  DC-EDIT1-DAY          PIC 99.
   818             20  SLASH1-2              PIC X.
   819             20  DC-EDIT1-YEAR         PIC 99.
   820         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   821         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   822                     DC-GREG-DATE-2-EDIT.
   823             20  DC-EDIT2-MONTH        PIC 99.
   824             20  SLASH2-1              PIC X.
   825             20  DC-EDIT2-DAY          PIC 99.
   826             20  SLASH2-2              PIC X.
   827             20  DC-EDIT2-YEAR         PIC 99.
   828         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   829         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   830                     DC-GREG-DATE-1-YMD.
   831             20  DC-YMD-YEAR           PIC 99.
   832             20  DC-YMD-MONTH          PIC 99.
   833             20  DC-YMD-DAY            PIC 99.
   834         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   835         16  DC-GREG-DATE-1-MDY-R REDEFINES
   836                      DC-GREG-DATE-1-MDY.
   837             20  DC-MDY-MONTH          PIC 99.
   838             20  DC-MDY-DAY            PIC 99.
   839             20  DC-MDY-YEAR           PIC 99.
   840         16  DC-GREG-DATE-1-ALPHA.
   841             20  DC-ALPHA-MONTH        PIC X(10).
   842             20  DC-ALPHA-DAY          PIC 99.
   843             20  FILLER                PIC XX.
   844             20  DC-ALPHA-CENTURY.
   845                 24 DC-ALPHA-CEN-N     PIC 99.
   846             20  DC-ALPHA-YEAR         PIC 99.
   847         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   848         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   849         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   850         16  DC-JULIAN-DATE            PIC 9(05).
   851         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  17
* ELRAMT.cbl
   852                                       PIC 9(05).
   853         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   854             20  DC-JULIAN-YEAR        PIC 99.
   855             20  DC-JULIAN-DAYS        PIC 999.
   856         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   857         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   858         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   859     12  DATE-CONVERSION-VARIBLES.
   860         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   861         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   862             20  FILLER                PIC 9(3).
   863             20  HOLD-CEN-1-CCYY.
   864                 24  HOLD-CEN-1-CC     PIC 99.
   865                 24  HOLD-CEN-1-YY     PIC 99.
   866             20  HOLD-CEN-1-MO         PIC 99.
   867             20  HOLD-CEN-1-DA         PIC 99.
   868         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   869             20  HOLD-CEN-1-R-MO       PIC 99.
   870             20  HOLD-CEN-1-R-DA       PIC 99.
   871             20  HOLD-CEN-1-R-CCYY.
   872                 24  HOLD-CEN-1-R-CC   PIC 99.
   873                 24  HOLD-CEN-1-R-YY   PIC 99.
   874             20  FILLER                PIC 9(3).
   875         16  HOLD-CENTURY-1-X.
   876             20  FILLER                PIC X(3)  VALUE SPACES.
   877             20  HOLD-CEN-1-X-CCYY.
   878                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   879                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   880             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   881             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   882         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   883             20  HOLD-CEN-1-R-X-MO     PIC XX.
   884             20  HOLD-CEN-1-R-X-DA     PIC XX.
   885             20  HOLD-CEN-1-R-X-CCYY.
   886                 24  HOLD-CEN-1-R-X-CC PIC XX.
   887                 24  HOLD-CEN-1-R-X-YY PIC XX.
   888             20  FILLER                PIC XXX.
   889         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   890         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   891         16  DC-JULIAN-DATE-1          PIC 9(07).
   892         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   893             20  DC-JULIAN-1-CCYY.
   894                 24  DC-JULIAN-1-CC    PIC 99.
   895                 24  DC-JULIAN-1-YR    PIC 99.
   896             20  DC-JULIAN-DA-1        PIC 999.
   897         16  DC-JULIAN-DATE-2          PIC 9(07).
   898         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   899             20  DC-JULIAN-2-CCYY.
   900                 24  DC-JULIAN-2-CC    PIC 99.
   901                 24  DC-JULIAN-2-YR    PIC 99.
   902             20  DC-JULIAN-DA-2        PIC 999.
   903         16  DC-GREG-DATE-A-EDIT.
   904             20  DC-EDITA-MONTH        PIC 99.
   905             20  SLASHA-1              PIC X VALUE '/'.
   906             20  DC-EDITA-DAY          PIC 99.
   907             20  SLASHA-2              PIC X VALUE '/'.
   908             20  DC-EDITA-CCYY.
   909                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  18
* ELRAMT.cbl
   910                 24  DC-EDITA-YEAR     PIC 99.
   911         16  DC-GREG-DATE-B-EDIT.
   912             20  DC-EDITB-MONTH        PIC 99.
   913             20  SLASHB-1              PIC X VALUE '/'.
   914             20  DC-EDITB-DAY          PIC 99.
   915             20  SLASHB-2              PIC X VALUE '/'.
   916             20  DC-EDITB-CCYY.
   917                 24  DC-EDITB-CENT     PIC 99.
   918                 24  DC-EDITB-YEAR     PIC 99.
   919         16  DC-GREG-DATE-CYMD         PIC 9(08).
   920         16  DC-GREG-DATE-CYMD-R REDEFINES
   921                              DC-GREG-DATE-CYMD.
   922             20  DC-CYMD-CEN           PIC 99.
   923             20  DC-CYMD-YEAR          PIC 99.
   924             20  DC-CYMD-MONTH         PIC 99.
   925             20  DC-CYMD-DAY           PIC 99.
   926         16  DC-GREG-DATE-MDCY         PIC 9(08).
   927         16  DC-GREG-DATE-MDCY-R REDEFINES
   928                              DC-GREG-DATE-MDCY.
   929             20  DC-MDCY-MONTH         PIC 99.
   930             20  DC-MDCY-DAY           PIC 99.
   931             20  DC-MDCY-CEN           PIC 99.
   932             20  DC-MDCY-YEAR          PIC 99.
   933    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   934        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   935    12  DC-EL310-DATE                  PIC X(21).
   936    12  FILLER                         PIC X(28).
   937
   938****************************************************************
   939*
   940* Copyright (c) 2007 by Clerity Solutions, Inc.
   941* All rights reserved.
   942*
   943****************************************************************
   944 01  DFHEIV.
   945   02  DFHEIV0               PIC X(35).
   946   02  DFHEIV1               PIC X(08).
   947   02  DFHEIV2               PIC X(08).
   948   02  DFHEIV3               PIC X(08).
   949   02  DFHEIV4               PIC X(06).
   950   02  DFHEIV5               PIC X(04).
   951   02  DFHEIV6               PIC X(04).
   952   02  DFHEIV7               PIC X(02).
   953   02  DFHEIV8               PIC X(02).
   954   02  DFHEIV9               PIC X(01).
   955   02  DFHEIV10              PIC S9(7) COMP-3.
   956   02  DFHEIV11              PIC S9(4) COMP SYNC.
   957   02  DFHEIV12              PIC S9(4) COMP SYNC.
   958   02  DFHEIV13              PIC S9(4) COMP SYNC.
   959   02  DFHEIV14              PIC S9(4) COMP SYNC.
   960   02  DFHEIV15              PIC S9(4) COMP SYNC.
   961   02  DFHEIV16              PIC S9(9) COMP SYNC.
   962   02  DFHEIV17              PIC X(04).
   963   02  DFHEIV18              PIC X(04).
   964   02  DFHEIV19              PIC X(04).
   965   02  DFHEIV20              USAGE IS POINTER.
   966   02  DFHEIV21              USAGE IS POINTER.
   967   02  DFHEIV22              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  19
* ELRAMT.cbl
   968   02  DFHEIV23              USAGE IS POINTER.
   969   02  DFHEIV24              USAGE IS POINTER.
   970   02  DFHEIV25              PIC S9(9) COMP SYNC.
   971   02  DFHEIV26              PIC S9(9) COMP SYNC.
   972   02  DFHEIV27              PIC S9(9) COMP SYNC.
   973   02  DFHEIV28              PIC S9(9) COMP SYNC.
   974   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   975   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   976   02  FILLER                PIC X(02).
   977   02  DFHEIV99              PIC X(08) VALUE SPACE.
   978   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   979   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   980   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   981   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   982 LINKAGE  SECTION.
   983*****************************************************************
   984*                                                               *
   985* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   986* All rights reserved.                                          *
   987*                                                               *
   988*****************************************************************
   989 01  dfheiblk.
   990     02  eibtime          pic s9(7) comp-3.
   991     02  eibdate          pic s9(7) comp-3.
   992     02  eibtrnid         pic x(4).
   993     02  eibtaskn         pic s9(7) comp-3.
   994     02  eibtrmid         pic x(4).
   995     02  dfheigdi         pic s9(4) comp.
   996     02  eibcposn         pic s9(4) comp.
   997     02  eibcalen         pic s9(4) comp.
   998     02  eibaid           pic x(1).
   999     02  eibfiller1       pic x(1).
  1000     02  eibfn            pic x(2).
  1001     02  eibfiller2       pic x(2).
  1002     02  eibrcode         pic x(6).
  1003     02  eibfiller3       pic x(2).
  1004     02  eibds            pic x(8).
  1005     02  eibreqid         pic x(8).
  1006     02  eibrsrce         pic x(8).
  1007     02  eibsync          pic x(1).
  1008     02  eibfree          pic x(1).
  1009     02  eibrecv          pic x(1).
  1010     02  eibsend          pic x(1).
  1011     02  eibatt           pic x(1).
  1012     02  eibeoc           pic x(1).
  1013     02  eibfmh           pic x(1).
  1014     02  eibcompl         pic x(1).
  1015     02  eibsig           pic x(1).
  1016     02  eibconf          pic x(1).
  1017     02  eiberr           pic x(1).
  1018     02  eibrldbk         pic x(1).
  1019     02  eiberrcd         pic x(4).
  1020     02  eibsynrb         pic x(1).
  1021     02  eibnodat         pic x(1).
  1022     02  eibfiller5       pic x(2).
  1023     02  eibresp          pic 9(09) comp.
  1024     02  eibresp2         pic 9(09) comp.
  1025     02  dfheigdj         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  20
* ELRAMT.cbl
  1026     02  dfheigdk         pic s9(4) comp.
  1027 01  DFHCOMMAREA                 PIC X(450).
  1028
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  21
* ELRAMT.cbl
  1030 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1031 0000-DFHEXIT SECTION.
  1032     MOVE '9#                    $   ' TO DFHEIV0.
  1033     MOVE 'ELRAMT' TO DFHEIV1.
  1034     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1035     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1036
  1037 000-START-REM-CALC.
  1038*                           COPY ELCRAMTP.
  1039*****************************************************************
  1040*                                                               *
  1041*                                                               *
  1042*                            ELCRAMTP.                          *
  1043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1044*                            VMOD=2.015                         *
  1045*                                                               *
  1046*                CALCULATE THE REMAINING AMOUNT.                *
  1047*****************************************************************
  1048*****************************************************************
  1049*                   C H A N G E   L O G
  1050*
  1051* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1052*-----------------------------------------------------------------
  1053*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1054* EFFECTIVE    NUMBER
  1055*-----------------------------------------------------------------
  1056* 041710    2007111300001  AJRA  CALC SC NET PAY PLUS 6
  1057* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1058* 032612  CR2011110200001  PEMA  AHL CHANGES
  1059* 071312  CR2012042600002  PEMA  AHL GROSS TRUNC RAMT
  1060******************************************************************
  1061
  1062     MOVE ZERO                   TO  CP-RETURN-CODE
  1063                                     CP-REMAINING-AMT
  1064                                     CP-REMAINING-AMT-PRV
  1065                                     CP-REMAMT-FACTOR
  1066                                     NP-FACTOR
  1067                                     WS-PASS-SW.
  1068
  1069 050-START.
  1070     IF COMPUTING-PRIOR-MO
  1071         COMPUTE WS-REMAINING-TERM = CP-REMAINING-TERM + +1
  1072      ELSE
  1073          MOVE CP-REMAINING-TERM   TO WS-REMAINING-TERM.
  1074
  1075     IF CP-BENEFIT-TYPE = 'A'
  1076        IF CP-R-MAX-MON-BEN NOT = ZEROS
  1077           COMPUTE CP-REMAINING-AMT = CP-REMAINING-TERM *
  1078              CP-R-MAX-MON-BEN
  1079        ELSE
  1080           COMPUTE CP-REMAINING-AMT = CP-REMAINING-TERM  *
  1081              CP-ORIGINAL-BENEFIT
  1082        END-IF
  1083        GO TO 999-CALC-REM-AMT-X
  1084     END-IF
  1085
  1086     IF CP-BENEFIT-TYPE = 'L' OR 'P'
  1087         IF CP-EARN-AS-NET-PAY
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  22
* ELRAMT.cbl
  1088             NEXT SENTENCE
  1089         ELSE
  1090             MOVE CP-ORIGINAL-BENEFIT    TO  WS-REMAINING-AMT
  1091             GO TO 800-CALC-REM-RESULT.
  1092
  1093     IF CP-ORIGINAL-TERM = ZERO
  1094         MOVE '4'                TO  CP-RETURN-CODE
  1095         GO TO 999-CALC-REM-AMT-X.
  1096
  1097*    IF (CP-EARN-AS-REG-BALLOON)
  1098*      AND
  1099*       (NOT CP-BALLOON-LAST-PMT)
  1100*       COMPUTE WS-TEMP-RESULT ROUNDED EQUAL
  1101*         CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM - 1)
  1102*    ELSE
  1103     if (cp-company-id = 'AHL')
  1104        and (cp-lf-claim-calc-sw = 'Y')
  1105        and (cp-loan-term > cp-original-term)
  1106        compute ws-temp-result rounded =
  1107           cp-original-benefit / cp-loan-term
  1108     else
  1109        COMPUTE WS-TEMP-RESULT ROUNDED EQUAL
  1110                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM
  1111     end-if
  1112
  1113     IF CP-EARN-AS-REG-BALLOON
  1114        GO TO 400-CALC-REM-BALLOON.
  1115
  1116     IF (CP-EARN-AS-NET-PAY)
  1117*       AND (CP-LOAN-APR > ZEROS)
  1118        GO TO 300-CALC-NET-PAY-REM
  1119     END-IF
  1120
  1121     IF CP-SPECIAL-CALC-CD IS EQUAL TO 'N'
  1122         GO TO 300-CALC-NET-PAY-REM.
  1123
  1124     MOVE CP-CERT-EFF-DT            TO  DC-BIN-DATE-1.
  1125     MOVE ' '                       TO  DC-OPTION-CODE.
  1126     PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT.
  1127
  1128*    IF CP-STATE-STD-ABBRV IS EQUAL TO 'OH'   AND
  1129     IF (CP-STATE-STD-ABBRV IS EQUAL TO 'OH')   AND
  1130        (CP-CLASS-CODE NOT = 'L ') AND
  1131        CP-ORIGINAL-TERM IS GREATER THAN +60  AND
  1132        CP-LOAN-APR IS GREATER THAN +0
  1133         IF DC-GREG-DATE-CYMD IS GREATER THAN 19831031
  1134             GO TO 300-CALC-NET-PAY-REM.
  1135
  1136     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT'   AND
  1137        CP-ORIGINAL-TERM IS GREATER THAN +61  AND
  1138        CP-LOAN-APR IS GREATER THAN +0
  1139         IF DC-GREG-DATE-CYMD IS GREATER THAN 19830318
  1140             GO TO 300-CALC-NET-PAY-REM.
  1141
  1142     IF CP-STATE-STD-ABBRV IS EQUAL TO 'UT'   AND
  1143        CP-ORIGINAL-TERM IS GREATER THAN +62  AND
  1144        CP-LOAN-APR IS GREATER THAN +0
  1145         IF DC-GREG-DATE-CYMD IS GREATER THAN 19810831  AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  23
* ELRAMT.cbl
  1146            DC-GREG-DATE-CYMD IS LESS    THAN 19830901
  1147             GO TO 300-CALC-NET-PAY-REM.
  1148
  1149     IF CP-STATE-STD-ABBRV IS EQUAL TO 'RI'   AND
  1150        CP-ORIGINAL-TERM IS GREATER THAN +60  AND
  1151        CP-LOAN-APR IS GREATER THAN +0
  1152         IF DC-GREG-DATE-CYMD IS GREATER THAN 19831231
  1153             GO TO 300-CALC-NET-PAY-REM.
  1154
  1155     IF WS-REMAINING-TERM = CP-ORIGINAL-TERM
  1156         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1157         GO TO 800-CALC-REM-RESULT.
  1158
  1159     IF CP-EARN-AS-TEXAS
  1160         GO TO 200-CALC-TEXAS-REM.
  1161
  1162 100-ORDINARY-REM.
  1163     if (cp-company-id = 'AHL')
  1164        and (cp-loan-term > cp-original-term)
  1165        compute ws-temp-result rounded =
  1166           cp-original-benefit / cp-loan-term
  1167        compute ws-remaining-amt rounded = ws-temp-result *
  1168           (ws-remaining-term + cp-loan-term - cp-original-term)
  1169     else
  1170        COMPUTE WS-REMAINING-AMT ROUNDED = WS-TEMP-RESULT *
  1171                                          WS-REMAINING-TERM
  1172     end-if
  1173     GO TO 800-CALC-REM-RESULT.
  1174
  1175 200-CALC-TEXAS-REM.
  1176     DIVIDE CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  1177         GIVING TEX-FACT-1.
  1178
  1179     IF CP-PAY-FREQUENCY = ZERO
  1180         MOVE '5'                TO  CP-RETURN-CODE
  1181         GO TO 999-CALC-REM-AMT-X.
  1182
  1183     DIVIDE WS-REMAINING-TERM BY CP-PAY-FREQUENCY
  1184         GIVING TEX-FACT-2
  1185         REMAINDER TEX-FACT-3.
  1186
  1187     IF TEX-FACT-3 NOT = ZERO
  1188         ADD +1 TO TEX-FACT-2.
  1189
  1190     IF (TEX-FACT-2 * CP-PAY-FREQUENCY) = CP-ORIGINAL-TERM
  1191         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1192     ELSE
  1193         COMPUTE WS-REMAINING-AMT ROUNDED =
  1194             (TEX-FACT-1 * (TEX-FACT-2 * CP-PAY-FREQUENCY)).
  1195
  1196     GO TO 800-CALC-REM-RESULT.
  1197
  1198 300-CALC-NET-PAY-REM.
  1199
  1200     MOVE CP-LOAN-APR            TO  NP-APR.
  1201     MOVE CP-ORIGINAL-TERM       TO  NP-ORIG.
  1202     MOVE WS-REMAINING-TERM      TO  NP-REM.
  1203     MOVE CP-LOAN-TERM           TO  NP-LOAN-TERM.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  24
* ELRAMT.cbl
  1204     MOVE CP-SPECIAL-CALC-CD     TO  NP-OPT.
  1205
  1206     IF CP-COMPANY-ID IS NOT EQUAL TO 'NCL'
  1207         GO TO 300-CONT-CALC-NET-PAY-REM.
  1208
  1209     MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  1210     MOVE CP-FIRST-PAY-DATE      TO  DC-BIN-DATE-2.
  1211     MOVE '1'                    TO  DC-OPTION-CODE.
  1212     PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT.
  1213
  1214     IF DATE-CONVERSION-ERROR
  1215         MOVE '2'                TO  CP-RETURN-CODE
  1216         GO TO 999-CALC-REM-AMT-X
  1217     ELSE
  1218         MOVE DC-ELAPSED-MONTHS  TO  CP-MNTHS-TO-FIRST-PMT
  1219         MOVE DC-ODD-DAYS-OVER   TO  CP-ODD-DAYS-TO-PMT.
  1220
  1221     IF WS-REMAINING-TERM = CP-ORIGINAL-TERM
  1222         MOVE +1                 TO ODF
  1223     ELSE
  1224         COMPUTE ODF =
  1225         ((1 + (NP-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  1226         ((1 + (CP-ODD-DAYS-TO-PMT * NP-APR / 36500))).
  1227
  1228 300-CONT-CALC-NET-PAY-REM.
  1229
  1230     PERFORM 1000-NET-TERM.
  1231
  1232     IF ANNUAL-INT-RATE = ZEROS
  1233         COMPUTE WS-REMAINING-AMT ROUNDED =
  1234             (CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM)
  1235              * WS-REMAINING-TERM
  1236     ELSE
  1237     COMPUTE WS-REMAINING-AMT ROUNDED =
  1238             NP-FACTOR * (CP-ORIGINAL-BENEFIT / +1000).
  1239
  1240     IF CP-COMPANY-ID NOT = 'CID' AND 'AHL'
  1241        IF CP-STATE-STD-ABBRV IS EQUAL TO 'NC'
  1242                  AND
  1243           CP-EARN-AS-NET-PAY
  1244            MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1
  1245            MOVE ' '                    TO  DC-OPTION-CODE
  1246            PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT
  1247            IF DC-GREG-DATE-CYMD IS GREATER THAN 19931231
  1248                GO TO 500-CALC-REM-RESULT.
  1249     evaluate true
  1250        when (cp-company-id = 'AHL')
  1251           and (cp-benefit-cd = '5M' OR '6M')
  1252           and (cp-lf-claim-calc-sw = 'Y')
  1253           move 1                to ws-extra-pmts
  1254           go to 600-calc-rem-result
  1255        when (cp-company-id = 'AHL')
  1256           and (cp-benefit-cd = '5G' or '5J' or '5S'
  1257                or '6D' or '6H' or '6R')
  1258           and (cp-lf-claim-calc-sw = 'Y')
  1259           move 2                to ws-extra-pmts
  1260           go to 600-calc-rem-result
  1261        when (cp-company-id = 'AHL')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  25
* ELRAMT.cbl
  1262           and (cp-benefit-cd = '5I' OR '6J')
  1263           and (cp-lf-claim-calc-sw = 'Y')
  1264           move 6                to ws-extra-pmts
  1265           go to 600-calc-rem-result
  1266        when(CP-COMPANY-ID = 'CID' AND
  1267           CP-STATE-STD-ABBRV = 'SC' AND
  1268           CP-EARN-AS-NET-PAY AND
  1269           CP-LF-CLAIM-CALC-SW = 'Y' AND
  1270           (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L'))
  1271           move 6                to ws-extra-pmts
  1272           GO TO 600-CALC-REM-RESULT
  1273     end-evaluate
  1274     GO TO 800-CALC-REM-RESULT.
  1275
  1276 400-CALC-REM-BALLOON.
  1277     IF CP-ORIGINAL-TERM LESS THAN CP-REMAINING-TERM
  1278        MOVE CP-ORIGINAL-BENEFIT TO CP-REMAINING-AMT
  1279        ADD CP-ALTERNATE-BENEFIT TO CP-REMAINING-AMT
  1280        GO TO 999-CALC-REM-AMT-X.
  1281
  1282     IF NOT CP-BALLOON-LAST-PMT
  1283        COMPUTE WS-REMAINING-AMT ROUNDED =
  1284          (WS-TEMP-RESULT * CP-REMAINING-TERM) +
  1285*         (WS-TEMP-RESULT * (CP-REMAINING-TERM - 1)) +
  1286           CP-ALTERNATE-BENEFIT
  1287     ELSE
  1288        COMPUTE WS-REMAINING-AMT ROUNDED =
  1289          (WS-TEMP-RESULT * CP-REMAINING-TERM ) +
  1290           CP-ALTERNATE-BENEFIT.
  1291
  1292     GO TO 800-CALC-REM-RESULT.
  1293
  1294 500-CALC-REM-RESULT.
  1295
  1296     IF ANNUAL-INT-RATE = ZEROS
  1297         MOVE CP-ORIGINAL-BENEFIT
  1298                              TO  WS-REMAINING-AMT
  1299         GO TO 999-CALC-REM-AMT-X.
  1300
  1301     IF REMAINING-TERM  = ZEROS
  1302         GO TO 999-CALC-REM-AMT-X.
  1303
  1304     COMPUTE ANGLEN = WK1 / I.
  1305     COMPUTE WS-TEMP-RESULT = CP-ORIGINAL-BENEFIT / ANGLEN.
  1306     COMPUTE WS-REMAINING-AMT =
  1307             WS-REMAINING-AMT + (WS-TEMP-RESULT * 3).
  1308     MOVE WS-TEMP-RESULT      TO  CP-MONTHLY-PAYMENT.
  1309
  1310     GO TO 800-CALC-REM-RESULT.
  1311
  1312 600-CALC-REM-RESULT.
  1313
  1314     IF WS-REMAINING-TERM  = ZEROS
  1315         GO TO 800-CALC-REM-RESULT
  1316     END-IF.
  1317
  1318     IF ANNUAL-INT-RATE = ZEROS
  1319         COMPUTE WS-TEMP-RESULT ROUNDED = CP-ORIGINAL-BENEFIT /
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  26
* ELRAMT.cbl
  1320                                  CP-ORIGINAL-TERM
  1321         COMPUTE WS-REMAINING-AMT ROUNDED =
  1322             WS-TEMP-RESULT * (WS-REMAINING-TERM + WS-EXTRA-PMTS)
  1323         IF WS-REMAINING-AMT > CP-ORIGINAL-BENEFIT
  1324            MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1325         END-IF
  1326         MOVE WS-TEMP-RESULT      TO  CP-MONTHLY-PAYMENT
  1327         GO TO 800-CALC-REM-RESULT
  1328     END-IF.
  1329
  1330     COMPUTE ANGLEN = WK1 / I.
  1331     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  1332                 / (1 + I)
  1333     COMPUTE ANGLEN1 = ANGLEN / Y
  1334     COMPUTE WS-TEMP-RESULT ROUNDED = CP-ORIGINAL-BENEFIT /
  1335                                   ANGLEN1.
  1336     COMPUTE CP-SCNP-6MO-AMT ROUNDED = WS-TEMP-RESULT
  1337        * WS-EXTRA-PMTS.
  1338     COMPUTE WS-REMAINING-AMT ROUNDED =
  1339             WS-REMAINING-AMT + CP-SCNP-6MO-AMT.
  1340     IF WS-REMAINING-AMT > CP-ORIGINAL-BENEFIT
  1341         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1342     END-IF
  1343     .
  1344 800-CALC-REM-RESULT.
  1345     IF COMPUTING-CURRENT-MO
  1346        MOVE WS-REMAINING-AMT TO CP-REMAINING-AMT
  1347        MOVE NP-FACTOR        TO CP-REMAMT-FACTOR
  1348        MOVE 1                TO WS-PASS-SW
  1349        IF (CP-R-MAX-TOT-BEN NOT = ZEROS)
  1350           AND (CP-R-MAX-TOT-BEN < CP-REMAINING-AMT)
  1351           MOVE CP-R-MAX-TOT-BEN TO CP-REMAINING-AMT
  1352        END-IF
  1353        GO TO 050-START
  1354      ELSE
  1355        MOVE WS-REMAINING-AMT TO CP-REMAINING-AMT-PRV
  1356        IF (CP-R-MAX-TOT-BEN NOT = ZEROS)
  1357           AND (CP-R-MAX-TOT-BEN < CP-REMAINING-AMT-PRV)
  1358           MOVE CP-R-MAX-TOT-BEN TO CP-REMAINING-AMT-PRV
  1359        END-IF
  1360     END-IF
  1361     .
  1362 999-CALC-REM-AMT-X.
  1363
  1364
  1365     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  1366
  1367
  1368* EXEC CICS RETURN
  1369*        END-EXEC.
  1370*    MOVE '.(                    ''   #00001363' TO DFHEIV0
  1371     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1372     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1373     MOVE X'2020233030303031333633' TO DFHEIV0(25:11)
  1374     CALL 'kxdfhei1' USING DFHEIV0,
  1375           DFHEIV99,
  1376           DFHEIV99,
  1377           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  27
* ELRAMT.cbl
  1378           DFHEIV99,
  1379           DFHEIV99,
  1380           DFHEIV99
  1381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1382
  1383
  1384
  1385* GOBACK.
  1386     MOVE '9%                    "   ' TO DFHEIV0
  1387     MOVE 'ELRAMT' TO DFHEIV1
  1388     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1389     GOBACK.
  1390
  1391 0030-CNVT-DT.
  1392
  1393
  1394* EXEC CICS LINK
  1395*        PROGRAM    ('ELDATCV')
  1396*        COMMAREA   (DATE-CONVERSION-DATA)
  1397*        LENGTH     (DC-COMM-LENGTH)
  1398*    END-EXEC.
  1399     MOVE 'ELDATCV' TO DFHEIV1
  1400*    MOVE '."C                   (   #00001370' TO DFHEIV0
  1401     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1403     MOVE X'2020233030303031333730' TO DFHEIV0(25:11)
  1404     CALL 'kxdfhei1' USING DFHEIV0,
  1405           DFHEIV1,
  1406           DATE-CONVERSION-DATA,
  1407           DC-COMM-LENGTH,
  1408           DFHEIV99,
  1409           DFHEIV99,
  1410           DFHEIV99,
  1411           DFHEIV99
  1412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1413
  1414
  1415 0030-CNVT-EXIT.
  1416     EXIT.
  1417
  1418 1000-NET-TERM SECTION.
  1419*                                COPY ELCRAMTN.
  1420*****************************************************************
  1421*                                                               *
  1422*                                                               *
  1423*                            ELCRAMTN.                          *
  1424*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1425*                            VMOD=2.008                         *
  1426*                                                               *
  1427*             CALCULATE NET PAY REMAINING AMOUNT                *
  1428*****************************************************************.
  1429
  1430     MOVE NP-APR                 TO  ANNUAL-INT-RATE.
  1431     MOVE NP-ORIG                TO  ORIGINAL-TERM.
  1432     MOVE NP-REM                 TO  REMAINING-TERM.
  1433
  1434 1000-EDIT-DATA.
  1435     MOVE +0 TO FACTOR.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  28
* ELRAMT.cbl
  1436
  1437     IF ANNUAL-INT-RATE = ZERO
  1438         GO TO 9000-ERROR.
  1439
  1440     IF ORIGINAL-TERM  = ZERO OR
  1441        REMAINING-TERM = ZERO
  1442         GO TO 9500-RETURN.
  1443
  1444     IF NP-LOAN-TERM NOT NUMERIC
  1445        MOVE +0 TO NP-LOAN-TERM.
  1446
  1447     IF NP-LOAN-TERM EQUAL +0
  1448        MOVE ORIGINAL-TERM TO NP-LOAN-TERM.
  1449
  1450     IF REMAINING-TERM GREATER ORIGINAL-TERM
  1451         GO TO 9000-ERROR.
  1452
  1453*    IF ANNUAL-INT-RATE LESS THAN +3
  1454*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  1455*    IF ANNUAL-INT-RATE LESS THAN +3
  1456*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  1457*    IF ANNUAL-INT-RATE LESS THAN +3
  1458*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  1459
  1460     IF NPO-SIMPLE
  1461         MOVE 'S'                TO  NP-TYPE
  1462     ELSE
  1463         MOVE 'N'                TO  NP-TYPE.
  1464
  1465     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  1466
  1467     COMPUTE V ROUNDED = K1 / (K1 + I).
  1468
  1469     IF (NP-LOAN-TERM GREATER THAN NP-ORIG)
  1470                AND
  1471        (CP-TRUNCATED-LIFE OR CP-SPECIAL-CALC-CD = 'N')
  1472         MOVE NP-LOAN-TERM TO MAX-X
  1473         COMPUTE REMAINING-TERM EQUAL REMAINING-TERM +
  1474             (NP-LOAN-TERM - NP-ORIG)
  1475     ELSE
  1476         MOVE ORIGINAL-TERM TO MAX-X.
  1477
  1478     COMPUTE X1 = MAX-X - ORIGINAL-TERM.
  1479
  1480     MOVE B1 TO X1 SX.
  1481     MOVE V TO VX  SV.
  1482
  1483     IF MAX-X = B1
  1484         GO TO 1000-COMPUTE-REMAINING-FACTOR.
  1485
  1486 1000-VX-LOOP.
  1487     COMPUTE VX ROUNDED = VX * V.
  1488
  1489     ADD B1 TO X1.
  1490
  1491     IF X1 = REMAINING-TERM
  1492         MOVE VX TO SV.
  1493
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  29
* ELRAMT.cbl
  1494     IF X1 = X2
  1495         MOVE VX TO SX.
  1496
  1497     IF X1 NOT = MAX-X
  1498         GO TO 1000-VX-LOOP.
  1499
  1500 1000-COMPUTE-REMAINING-FACTOR.
  1501     COMPUTE WK1 = K1 - VX.
  1502
  1503     COMPUTE WK2 = K1 - SV.
  1504
  1505     IF CP-COMPANY-ID IS EQUAL TO 'NCL'       AND
  1506        CP-EARN-AS-NET-PAY
  1507         GO TO 2100-CHECK-NCL-NET-PAY.
  1508
  1509     IF CP-COMPANY-ID IS EQUAL TO 'NCL'
  1510        IF CP-SPECIAL-CALC-CD IS EQUAL TO 'N'
  1511            IF CP-LOAN-TERM IS GREATER THAN CP-ORIGINAL-TERM
  1512                GO TO 2100-NCL-NET-TRUNC
  1513            ELSE
  1514                GO TO 2100-NCL-NET-PAY.
  1515
  1516*    IF CP-TRUNCATED-LIFE
  1517*        IF CP-LOAN-TERM = REMAINING-TERM
  1518*            GO TO 2000-PREMIUM-RATE.
  1519
  1520*    IF NOT CP-TRUNCATED-LIFE
  1521*        IF ORIGINAL-TERM = REMAINING-TERM
  1522*            GO TO 2000-PREMIUM-RATE.
  1523
  1524     COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  1525
  1526     MOVE WK3 TO FACTOR.
  1527
  1528     GO TO 9500-RETURN.
  1529
  1530 2000-PREMIUM-RATE.
  1531
  1532     COMPUTE K-I = K1 + I
  1533
  1534     IF NPO-ALT OR NPO-TRUNC
  1535         MOVE K1                 TO  K-I.
  1536
  1537     IF NPO-2MO OR NPO-TRUNC-2
  1538         COMPUTE K-I = K1 + (2 * I).
  1539
  1540     COMPUTE RA ROUNDED = 1 -
  1541         ((X2 * (X2 + 1)) /
  1542          (MAX-X * (MAX-X + 1))).
  1543
  1544     IF NET-STD
  1545         COMPUTE WK3 ROUNDED =
  1546             ((I * ORIGINAL-TERM) + VX - SX) * 2 * MAX-X
  1547         COMPUTE WK3 ROUNDED =
  1548             WK3 / (( 1 - VX) * ORIGINAL-TERM * I)
  1549         COMPUTE WK3 ROUNDED =
  1550             WK3 / ((2 * MAX-X) - ORIGINAL-TERM + 1)
  1551         COMPUTE WK3 ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  30
* ELRAMT.cbl
  1552             WK3 * RA * K-I.
  1553
  1554     IF NET-SMP
  1555         COMPUTE N2 = MAX-X * MAX-X
  1556         COMPUTE N3 = N2 * MAX-X
  1557         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  1558         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  1559         COMPUTE WK3 ROUNDED = WK3 + (4 * MAX-X * WK1)
  1560         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  1561         COMPUTE WK3 ROUNDED = WK3 / (36 * (MAX-X + 1) * WK1).
  1562
  1563     MOVE WK3                    TO  FACTOR.
  1564     GO TO 9500-RETURN.
  1565
  1566 2100-CHECK-NCL-NET-PAY.
  1567
  1568     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MN'    AND
  1569        CP-ORIGINAL-TERM IS GREATER THAN +63   AND
  1570        CP-TRUNCATED-LIFE
  1571         GO TO 2100-CHECK-MINN-TRUNC.
  1572
  1573     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MN' AND
  1574        CP-ORIGINAL-TERM IS GREATER THAN +63
  1575         GO TO 2100-CHECK-MINN.
  1576
  1577     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT'    AND
  1578        CP-ORIGINAL-TERM IS GREATER THAN +63   AND
  1579        CP-TRUNCATED-LIFE
  1580         GO TO 2100-CHECK-MONTANA-TRUNC.
  1581
  1582     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT' AND
  1583        CP-ORIGINAL-TERM IS GREATER THAN +63
  1584         GO TO 2100-CHECK-MONTANA.
  1585
  1586     IF CP-TRUNCATED-LIFE
  1587         GO TO 2100-NCL-NET-TRUNC.
  1588
  1589 2100-NCL-NET-PAY.
  1590
  1591     COMPUTE ANGLEN = WK1 / I.
  1592
  1593     COMPUTE ANGLEU = WK2 / I.
  1594
  1595     COMPUTE ANGLEN1 = ANGLEN * ODF.
  1596
  1597     COMPUTE FACTOR = (ANGLEU / ANGLEN1) * 1000.
  1598
  1599     COMPUTE WS-REMAINING-AMT ROUNDED =
  1600         (CP-ORIGINAL-BENEFIT * ANGLEU) / ANGLEN1.
  1601
  1602     GO TO 9500-RETURN.
  1603
  1604 2100-NCL-NET-TRUNC.
  1605
  1606     COMPUTE ANGLEM = WK1 / I.
  1607
  1608     COMPUTE ANGLEU = WK2 / I.
  1609
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  31
* ELRAMT.cbl
  1610     COMPUTE ANGLEM1 = ANGLEM * ODF.
  1611
  1612     COMPUTE FACTOR = (ANGLEU / ANGLEM1) * 1000.
  1613
  1614     COMPUTE WS-REMAINING-AMT ROUNDED =
  1615         (CP-ORIGINAL-BENEFIT * ANGLEU) / ANGLEM1.
  1616
  1617     GO TO 9500-RETURN.
  1618
  1619 2100-CHECK-MINN-TRUNC.
  1620
  1621     COMPUTE ANGLEM = WK1 / I.
  1622
  1623     COMPUTE ANGLEU = WK2 / I.
  1624
  1625     COMPUTE ANGLEM1 = ANGLEM * ODF.
  1626
  1627     COMPUTE FACTOR = ((ANGLEU + 2) / ANGLEM1) * 1000.
  1628
  1629     COMPUTE WS-REMAINING-AMT ROUNDED =
  1630         (CP-ORIGINAL-BENEFIT * (ANGLEU + 2)) / ANGLEM1.
  1631
  1632     GO TO 9500-RETURN.
  1633
  1634 2100-CHECK-MINN.
  1635
  1636     COMPUTE ANGLEN = WK1 / I.
  1637
  1638     COMPUTE ANGLEU = WK2 / I.
  1639
  1640     COMPUTE ANGLEN1 = ANGLEN * ODF.
  1641
  1642     COMPUTE FACTOR = ((ANGLEU + 2) / ANGLEN1) * 1000.
  1643
  1644     COMPUTE WS-REMAINING-AMT ROUNDED =
  1645         (CP-ORIGINAL-BENEFIT * (ANGLEU + 2)) / ANGLEN1.
  1646
  1647     GO TO 9500-RETURN.
  1648
  1649 2100-CHECK-MONTANA-TRUNC.
  1650
  1651     COMPUTE ANGLEM = WK1 / I.
  1652
  1653     COMPUTE ANGLEU = WK2 / I.
  1654
  1655     COMPUTE ANGLEM1 = ANGLEM * ODF.
  1656
  1657     COMPUTE FACTOR = ((ANGLEU + 4) / ANGLEM1) * 1000.
  1658
  1659     COMPUTE WS-REMAINING-AMT ROUNDED =
  1660         (CP-ORIGINAL-BENEFIT * (ANGLEU + 4)) / ANGLEM1.
  1661
  1662     GO TO 9500-RETURN.
  1663
  1664 2100-CHECK-MONTANA.
  1665
  1666     COMPUTE ANGLEN = WK1 / I.
  1667
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 13:55 Page  32
* ELRAMT.cbl
  1668     COMPUTE ANGLEU = WK2 / I.
  1669
  1670     COMPUTE ANGLEN1 = ANGLEN * ODF.
  1671
  1672     COMPUTE FACTOR = ((ANGLEU + 4) / ANGLEN1) * 1000.
  1673
  1674     COMPUTE WS-REMAINING-AMT ROUNDED =
  1675         (CP-ORIGINAL-BENEFIT * (ANGLEU + 4)) / ANGLEN1.
  1676
  1677     GO TO 9500-RETURN.
  1678
  1679 9000-ERROR.
  1680     GO TO 9500-RETURN.
  1681
  1682 9500-RETURN.
  1683     MOVE FACTOR                 TO  NP-FACTOR.
  1684
  1685 9999-EXIT.
  1686     EXIT.
  1687
  1688
  1689
  1690 9999-DFHBACK SECTION.
  1691     MOVE '9%                    "   ' TO DFHEIV0
  1692     MOVE 'ELRAMT' TO DFHEIV1
  1693     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1694     GOBACK.
  1695 9999-DFHEXIT.
  1696     IF DFHEIGDJ EQUAL 0001
  1697         NEXT SENTENCE.
  1698     MOVE '9%                    "   ' TO DFHEIV0
  1699     MOVE 'ELRAMT' TO DFHEIV1
  1700     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1701     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1984     Code:        5078
