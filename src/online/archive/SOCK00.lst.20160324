* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   1
* SOCK00.cbl
* Options: int("SOCK00.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK00.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK00.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK00.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   2
* SOCK00.cbl
    14*-----------------------------------------------------------------
    15* 091609  CR2009082400002  PEMA  ADD USER SELECT 3
    16* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
    17* 042612  CR2012042500004  PEMA  ADD CODE TO HANDLE AHL
    18* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    19* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    20* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    21*-----------------------------------------------------------------
    22 identification division.
    23 program-id. SOCK00.
    24*         This program is the first invoked by the SOCK
    25*         transaction. This transaction must be submited
    26*         by a message transmited over a stream socket.
    27*         The first message format is:
    28*         aaaa,bbbbb              ccc
    29*         where "aaaa" is the tran id SOCK (1 to 4 characters)
    30*         and "bbbbb is either "RATE " or "STATE" and ccc is eithe
    31*         DCC or CID or any future company id
    32*         Information on the originating message and
    33*         remote socket is provided in the DFHCOMMAREA.
    34*         As its first action this program must send a
    35*         message to the requesting socket. This lets the
    36*         remote program know its request has been
    37*         accepted and the transaction started.
    38*         The program will make four transmissions to
    39*         the initating program in response to received
    40*         messages and then close the socket.
    41*         This program is provided to show method and
    42*         has minimal checking and error messages.
    43*         The Cobol compiler, unless instructed otherwise,
    44*         will hold its working storage integer data items in
    45*         machine idependent form. This matches the network
    46*         ordering of information. Care should be exercised
    47*         to ensure that this data ordering is correct when
    48*         calling system library functions or passing data
    49*         structure containing such data to functions.
    50 environment division.
    51 data division.
    52 working-storage section.
    53 01  DFH-START PIC X(04).
    54*
    55* program buffers
    56*
    57 77 ws-send-msg-size           pic s9(8) comp value 4096.
    58 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    59 77 ws-recv-buf                pic x(4096).
    60 77 ws-send-buf                pic x(4096) VALUE SPACES.
    61 77 ws-recv-total              pic s9(8) comp value 0.
    62 77 ws-recv-left               pic s9(8) comp value 0.
    63 77 ws-seq-num                 pic s9(8) comp value 0.
    64 77 ws-flags                   pic s9(8) comp value 0.
    65 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    66 77 WS-COMP-ID                   PIC XXX VALUE 'CID'.
    67 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    68 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    69 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    70 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    71 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   3
* SOCK00.cbl
    72 77 S1                           PIC S999 COMP-3 VALUE +0.
    73 77 S2                           PIC S999 COMP-3 VALUE +0.
    74 77 WS-BUILD-SW                  PIC X.
    75    88  TIME-TO-BUILD               VALUE 'Y'.
    76 77 WS-SAVE-ERACCT               PIC X(2000).
    77 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    78 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    79    88  GET-RATES                    VALUE 'R'.
    80    88  GET-ACT-ACCTS                VALUE 'A'.
    81 77 ws-bin-eff-dt                pic xx  value low-values.
    82 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    83 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    84 77 ws-disp-rate                 pic z9.99999.
    85 77  WS-ERACCT-SW                PIC X VALUE ' '.
    86     88  END-OF-ERACCT                 VALUE 'Y'.
    87 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    88     88  END-OF-ERCTBL                 VALUE 'Y'.
    89 77  WS-STATUS                   PIC X.
    90 01  ws-work-date.
    91     05  ws-work-ccyy            pic x(4).
    92     05  ws-work-mm              pic xx.
    93     05  ws-work-dd              pic xx.
    94 01  ws-work-date-num redefines ws-work-date
    95                                 pic 9(8).
    96 01  WS-AM-CITY-STATE            PIC X(30) VALUE SPACES.
    97 01  ws-work-apr.
    98     05  ws-apr-num              pic 99V999.
    99 01  ws-work-ben.
   100     05  ws-ben-num              pic 9(5).
   101 01  ws-work-term.
   102     05  ws-term-num             pic 999.
   103 01  ws-get-rate-data.
   104     05  rate-state              pic xx.
   105     05  rate-lf-ah              pic x.
   106     05  rate-ben-code           pic xx.
   107     05  rate-earn-meth          pic x.
   108     05  rate-ben-amt            pic x(5).
   109     05  rate-eff-date           pic x(10).
   110     05  rate-term               pic xxx.
   111     05  rate-apr                pic x(5).
   112 01  WS-FIN-RESP                 PIC X(10).
   113 01  WS-GA-DATA.
   114     05  WS-GA-NUM               PIC X(10).
   115     05  WS-GA-PRIMARY-CONTACT   PIC X(30).
   116     05  WS-GA-NAME              PIC X(30).
   117     05  WS-GA-MAIL-NAME         PIC X(30).
   118     05  WS-GA-ADDR1             PIC X(30).
   119     05  WS-GA-ADDR2             PIC X(30).
   120     05  WS-GA-ADDR3             PIC X(30).
   121     05  WS-GA-ZIP               PIC X(9).
   122     05  WS-GA-PHONE             PIC X(10).
   123 01  WS-AM-KEY.
   124     05  WS-AM-COMPANY-CD        PIC X.
   125     05  WS-AM-CARRIER           PIC X.
   126     05  WS-AM-GROUP             PIC X(6).
   127     05  WS-AM-STATE             PIC XX.
   128     05  WS-AM-ACCOUNT           PIC X(10).
   129     05  WS-AM-EXP-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   4
* SOCK00.cbl
   130     05  FILLER                  PIC X(4).
   131 01  WS-NT-KEY.
   132     05  WS-NT-COMPANY-CD        PIC X.
   133     05  WS-NT-CARRIER           PIC X.
   134     05  WS-NT-GROUP             PIC X(6).
   135     05  WS-NT-STATE             PIC XX.
   136     05  WS-NT-ACCOUNT           PIC X(10).
   137     05  WS-NT-REC-TYPE          PIC X.
   138     05  WS-NT-SEQ-NO            PIC S9(4) COMP.
   139 01  WS-AM-ALT-KEY.
   140     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   141     05  WS-AM-ALT-EXP-DT        PIC XX.
   142 01  WS-CT-KEY-SAVE              PIC X(5).
   143 01  WS-CT-KEY.
   144     05  WS-CT-COMPANY-CD        PIC X.
   145     05  WS-CT-TABLE             PIC XXX.
   146     05  WS-CT-BEN-TYPE          PIC X.
   147     05  WS-CT-BEN-CODE          PIC XX.
   148 01  WS-CF-KEY-SAVE              PIC X(10).
   149 01  WS-CF-KEY.
   150     05  WS-CF-COMPANY-ID        PIC XXX.
   151     05  WS-CF-RECORD-TYPE       PIC X.
   152     05  WS-CF-ACCESS            PIC X(4).
   153     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   154 01  WS-CO-KEY.
   155     05  WS-CO-COMPANY-CD        PIC X.
   156     05  WS-CO-CARRIER           PIC X.
   157     05  WS-CO-GROUP             PIC X(6).
   158     05  WS-CO-FIN-RESP          PIC X(10).
   159     05  WS-CO-ACCOUNT           PIC X(10).
   160     05  WS-CO-TYPE              PIC X.
   161 01  WS-WORK-SAH-COMM            PIC SV9(5) VALUE +0.
   162 01  WS-WORK-JAH-COMM            PIC SV9(5) VALUE +0.
   163 01  WS-POLICY-NO                PIC X(6).
   164 01  WS-SHORT-ACCT-NAME          PIC X(30).
   165 01  WS-LONG-ACCT-NAME           PIC X(60).
   166 01  WS-CONTR-NAME               PIC X(60).
   167 01  WS-SL-COMM                  PIC 9.99999.
   168 01  WS-JL-COMM                  PIC 9.99999.
   169 01  WS-SAH-COMM                 PIC 9.99999.
   170 01  WS-JAH-COMM                 PIC 9.99999.
   171 01  WS-CID-NO                   PIC X(8).
   172 01  WS-DISP-RESP                PIC 9(5).
   173 01  WS-RESPONSE                 PIC S9(8)   COMP.
   174     88  RESP-NORMAL                  VALUE +00.
   175     88  RESP-NOTFND                  VALUE +13.
   176     88  RESP-NOTOPEN                 VALUE +19.
   177     88  RESP-ENDFILE                 VALUE +20.
   178*                                 COPY ERCACNT.
   179******************************************************************
   180*                                                                *
   181*                                                                *
   182*                            ERCACNT.                            *
   183*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   184*                            VMOD=2.002                          *
   185*                                                                *
   186*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
   187*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   5
* SOCK00.cbl
   188*   FILE TYPE = VSAM,KSDS                                        *
   189*   RECORD SIZE = 120   RECFORM = FIXED                          *
   190*                                                                *
   191*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
   192*       ALTERNATE INDEX = NONE                                   *
   193*                                                                *
   194*                                                                *
   195*   LOG = YES                                                    *
   196*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   197******************************************************************
   198*                   C H A N G E   L O G
   199*
   200* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   201*-----------------------------------------------------------------
   202*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   203* EFFECTIVE    NUMBER
   204*-----------------------------------------------------------------
   205* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
   206*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
   207******************************************************************
   208 01  NOTE-FILE.
   209     12  NT-FILE-ID                  PIC XX.
   210         88  VALID-NOTE-ID              VALUE 'NT'.
   211
   212     12  NT-CONTROL-PRIMARY.
   213         16  NT-COMPANY-CD           PIC X.
   214         16  NT-ACCT-NOTE-KEY.
   215             18  NT-CARRIER              PIC X.
   216             18  NT-GROUPING             PIC X(06).
   217             18  NT-STATE                PIC XX.
   218             18  NT-ACCOUNT              PIC X(10).
   219         16  NT-RECORD-TYPE          PIC X.
   220              88  ACCT-NOTE          VALUE '1'.
   221              88  ACCT-BRANCH-LOC    VALUE '2'.
   222              88  ACCT-SHIPPING-ADDR VALUE '3'.
   223         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
   224
   225     12  NT-LAST-MAINT-DT            PIC XX.
   226     12  NT-LAST-MAINT-BY            PIC X(4).
   227     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
   228
   229*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
   230*     SEQUENCE NUMBERS
   231     12  NT-NOTE-INFORMATION.
   232         16  NT-NOTE-LINE            PIC X(60).
   233         16  FILLER                  PIC X(25).
   234*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
   235     12  NT-LOCATION-INFORMATION REDEFINES
   236                         NT-NOTE-INFORMATION.
   237         16  NT-BRANCH-LOC-LINE      PIC X(60).
   238         16  FILLER                  PIC X(25).
   239*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
   240*     SEQUENCE NUMBER 1 IS NAME LINE 1
   241*     SEQUENCE NUMBER 2 IS NAME LINE 2
   242*     SEQUENCE NUMBER 3 IS ADDR LINE 1
   243*     SEQUENCE NUMBER 4 IS ADDR LINE 2
   244*     SEQUENCE NUMBER 5 IS ADDR LINE 3
   245*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   6
* SOCK00.cbl
   246     12  NT-SHIPPING-INFORMATION REDEFINES
   247                         NT-NOTE-INFORMATION.
   248         16  NT-SHIPPING-LINE        PIC X(60).
   249         16  NT-SHIP-STATE           PIC XX.
   250         16  NT-SHIP-ZIP             PIC X(10).
   251         16  FILLER                  PIC X(13).
   252*****************************************************************
   253*                                 COPY ERCACCT.
   254******************************************************************
   255*                                                                *
   256*                                                                *
   257*                            ERCACCT                             *
   258*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   259*                            VMOD=2.031                          *
   260*                                                                *
   261*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   262*                                                                *
   263*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   264*   VSAM ACCOUNT MASTER FILES.                                   *
   265*                                                                *
   266*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   267*                                                                *
   268*   FILE TYPE = VSAM,KSDS                                        *
   269*   RECORD SIZE = 2000  RECFORM = FIX                            *
   270*                                                                *
   271*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   272*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   273*                                                                *
   274*   LOG = NO                                                     *
   275*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   276*                                                                *
   277*                                                                *
   278******************************************************************
   279*                   C H A N G E   L O G
   280*
   281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   282*-----------------------------------------------------------------
   283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   284* EFFECTIVE    NUMBER
   285*-----------------------------------------------------------------
   286* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   287* 092705    2005050300006  PEMA  ADD SPP LEASES
   288* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   289* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   290* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   291* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   292* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   293******************************************************************
   294
   295 01  ACCOUNT-MASTER.
   296     12  AM-RECORD-ID                      PIC XX.
   297         88  VALID-AM-ID                      VALUE 'AM'.
   298
   299     12  AM-CONTROL-PRIMARY.
   300         16  AM-COMPANY-CD                 PIC X.
   301         16  AM-MSTR-CNTRL.
   302             20  AM-CONTROL-A.
   303                 24  AM-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   7
* SOCK00.cbl
   304                 24  AM-GROUPING.
   305                     28 AM-GROUPING-PREFIX PIC XXX.
   306                     28 AM-GROUPING-PRIME  PIC XXX.
   307                 24  AM-STATE              PIC XX.
   308                 24  AM-ACCOUNT.
   309                     28  AM-ACCOUNT-PREFIX PIC X(4).
   310                     28  AM-ACCOUNT-PRIME  PIC X(6).
   311             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   312                                           PIC X(19).
   313             20  AM-CNTRL-B.
   314                 24  AM-EXPIRATION-DT      PIC XX.
   315                 24  FILLER                PIC X(4).
   316             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   317                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   318
   319     12  AM-CONTROL-BY-VAR-GRP.
   320         16  AM-COMPANY-CD-A1              PIC X.
   321         16  AM-VG-CARRIER                 PIC X.
   322         16  AM-VG-GROUPING                PIC X(6).
   323         16  AM-VG-STATE                   PIC XX.
   324         16  AM-VG-ACCOUNT                 PIC X(10).
   325         16  AM-VG-DATE.
   326             20  AM-VG-EXPIRATION-DT       PIC XX.
   327             20  FILLER                    PIC X(4).
   328         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   329                                           PIC 9(11)      COMP-3.
   330     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   331         16  FILLER                        PIC X(10).
   332         16  AM-VG-KEY3.
   333             20  AM-VG3-ACCOUNT            PIC X(10).
   334             20  AM-VG3-EXP-DT             PIC XX.
   335         16  FILLER                        PIC X(4).
   336     12  AM-MAINT-INFORMATION.
   337         16  AM-LAST-MAINT-DT              PIC XX.
   338         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   339         16  AM-LAST-MAINT-USER            PIC X(4).
   340         16  FILLER                        PIC XX.
   341
   342     12  AM-EFFECTIVE-DT                   PIC XX.
   343     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   344
   345     12  AM-PREV-DATES  COMP-3.
   346         16  AM-PREV-EXP-DT                PIC 9(11).
   347         16  AM-PREV-EFF-DT                PIC 9(11).
   348
   349     12  AM-REPORT-CODE-1                  PIC X(10).
   350     12  AM-REPORT-CODE-2                  PIC X(10).
   351
   352     12  AM-CITY-CODE                      PIC X(4).
   353     12  AM-COUNTY-PARISH                  PIC X(6).
   354
   355     12  AM-NAME                           PIC X(30).
   356     12  AM-PERSON                         PIC X(30).
   357     12  AM-ADDRS                          PIC X(30).
   358     12  AM-CITY.
   359         16  AM-ADDR-CITY                  PIC X(28).
   360         16  AM-ADDR-STATE                 PIC XX.
   361     12  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   8
* SOCK00.cbl
   362         16  AM-ZIP-PRIME.
   363             20  AM-ZIP-PRI-1ST            PIC X.
   364                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   365             20  FILLER                    PIC X(4).
   366         16  AM-ZIP-PLUS4                  PIC X(4).
   367     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   368         16  AM-CAN-POSTAL-1               PIC XXX.
   369         16  AM-CAN-POSTAL-2               PIC XXX.
   370         16  FILLER                        PIC XXX.
   371     12  AM-TEL-NO.
   372         16  AM-AREA-CODE                  PIC 999.
   373         16  AM-TEL-PRE                    PIC 999.
   374         16  AM-TEL-NBR                    PIC 9(4).
   375     12  AM-TEL-LOC                        PIC X.
   376         88  AM-TEL-AT-HOME                   VALUE 'H'.
   377         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   378
   379     12  AM-COMM-STRUCTURE.
   380         16  AM-DEFN-1.
   381             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   382                 24  AM-AGT.
   383                     28  AM-AGT-PREFIX     PIC X(4).
   384                     28  AM-AGT-PRIME      PIC X(6).
   385                 24  AM-COM-TYP            PIC X.
   386                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   387                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   388                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   389                 24  AM-RECALC-LV-INDIC    PIC X.
   390                 24  AM-RETRO-LV-INDIC     PIC X.
   391                 24  AM-GL-CODES           PIC X.
   392                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   393                 24  FILLER                PIC X(01).
   394         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   395             20  AM-COM-TBLS        OCCURS 10 TIMES.
   396                 24  FILLER                PIC X(11).
   397                 24  AM-L-COMA             PIC XXX.
   398                 24  AM-J-COMA             PIC XXX.
   399                 24  AM-A-COMA             PIC XXX.
   400                 24  FILLER                PIC X(6).
   401
   402     12  AM-COMM-CHANGE-STATUS             PIC X.
   403         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   404
   405     12  AM-CSR-CODE                       PIC X(4).
   406
   407     12  AM-BILLING-STATUS                 PIC X.
   408         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   409         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   410     12  AM-AUTO-REFUND-SW                 PIC X.
   411         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   412         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   413     12  AM-GPCD                           PIC 99.
   414     12  AM-IG                             PIC X.
   415         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   416         88  AM-HAS-GROUP                     VALUE '2'.
   417     12  AM-STATUS                         PIC X.
   418         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   419         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   9
* SOCK00.cbl
   420         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   421         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   422         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   423         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   424     12  AM-REMIT-TO                       PIC 99.
   425     12  AM-ID-NO                          PIC X(11).
   426
   427     12  AM-CAL-TABLE                      PIC XX.
   428     12  AM-LF-DEVIATION                   PIC XXX.
   429     12  AM-AH-DEVIATION                   PIC XXX.
   430     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   431     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   432     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   433     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   434     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   435     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   436
   437     12  AM-USER-FIELDS.
   438         16  AM-FLD-1                      PIC XX.
   439         16  AM-FLD-2                      PIC XX.
   440         16  AM-FLD-3                      PIC XX.
   441         16  AM-FLD-4                      PIC XX.
   442         16  AM-FLD-5                      PIC XX.
   443
   444     12  AM-1ST-PROD-DATE.
   445         16  AM-1ST-PROD-YR                PIC XX.
   446         16  AM-1ST-PROD-MO                PIC XX.
   447         16  AM-1ST-PROD-DA                PIC XX.
   448     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   449     12  AM-CERTS-PURGED-DATE.
   450         16  AM-PUR-YR                     PIC XX.
   451         16  AM-PUR-MO                     PIC XX.
   452         16  AM-PUR-DA                     PIC XX.
   453     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   454     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   455     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   456     12  AM-INACTIVE-DATE.
   457         16  AM-INA-MO                     PIC 99.
   458         16  AM-INA-DA                     PIC 99.
   459         16  AM-INA-YR                     PIC 99.
   460     12  AM-AR-HI-CERT-DATE                PIC XX.
   461
   462     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   463     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   464
   465     12  AM-OB-PAYMENT-MODE                PIC X.
   466         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   467         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   468         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   469         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   470
   471     12  AM-AH-ONLY-INDICATOR              PIC X.
   472         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   473         88  AM-NO-AH-ONLY                    VALUE 'N'.
   474
   475     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   476
   477     12  AM-OVER-SHORT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  10
* SOCK00.cbl
   478         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   479         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   480
   481     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   482     12  AM-DCC-CLP-STATE                  PIC XX.
   483
   484     12  AM-RECALC-COMM                    PIC X.
   485     12  AM-RECALC-REIN                    PIC X.
   486
   487     12  AM-REI-TABLE                      PIC XXX.
   488     12  AM-REI-ET-LF                      PIC X.
   489     12  AM-REI-ET-AH                      PIC X.
   490     12  AM-REI-PE-LF                      PIC X.
   491     12  AM-REI-PE-AH                      PIC X.
   492     12  AM-REI-PRT-ST                     PIC X.
   493     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   494     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   495     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   496     12  AM-REI-GROUP-A                    PIC X(6).
   497     12  AM-REI-MORT                       PIC X(4).
   498     12  AM-REI-PRT-OW                     PIC X.
   499     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   500     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   501     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   502     12  AM-REI-GROUP-B                    PIC X(6).
   503
   504     12  AM-TRUST-TYPE                     PIC X(2).
   505
   506     12  AM-EMPLOYER-STMT-USED             PIC X.
   507     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   508
   509     12  AM-STD-AH-TYPE                    PIC XX.
   510     12  AM-EARN-METHODS.
   511         16  AM-EARN-METHOD-R              PIC X.
   512             88 AM-REF-RL-R78                 VALUE 'R'.
   513             88 AM-REF-RL-PR                  VALUE 'P'.
   514             88 AM-REF-RL-MEAN                VALUE 'M'.
   515             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   516         16  AM-EARN-METHOD-L              PIC X.
   517             88 AM-REF-LL-R78                 VALUE 'R'.
   518             88 AM-REF-LL-PR                  VALUE 'P'.
   519             88 AM-REF-LL-MEAN                VALUE 'M'.
   520             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   521         16  AM-EARN-METHOD-A              PIC X.
   522             88 AM-REF-AH-R78                 VALUE 'R'.
   523             88 AM-REF-AH-PR                  VALUE 'P'.
   524             88 AM-REF-AH-MEAN                VALUE 'M'.
   525             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   526             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   527             88 AM-REF-AH-NET                 VALUE 'N'.
   528
   529     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   530     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   531     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   532
   533     12  AM-RET-Y-N                        PIC X.
   534     12  AM-RET-P-E                        PIC X.
   535     12  AM-LF-RET                         PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  11
* SOCK00.cbl
   536     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   537     12  AM-RET-GRP                        PIC X(6).
   538     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   539         16  AM-POOL-PRIME                 PIC XXX.
   540         16  AM-POOL-SUB                   PIC XXX.
   541     12  AM-RETRO-EARNINGS.
   542         16  AM-RET-EARN-R                 PIC X.
   543         16  AM-RET-EARN-L                 PIC X.
   544         16  AM-RET-EARN-A                 PIC X.
   545     12  AM-RET-ST-TAX-USE                 PIC X.
   546         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   547         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   548     12  AM-RETRO-BEG-EARNINGS.
   549         16  AM-RET-BEG-EARN-R             PIC X.
   550         16  AM-RET-BEG-EARN-L             PIC X.
   551         16  AM-RET-BEG-EARN-A             PIC X.
   552     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   553     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   554
   555     12  AM-USER-SELECT-OPTIONS.
   556         16  AM-USER-SELECT-1              PIC X(10).
   557         16  AM-USER-SELECT-2              PIC X(10).
   558         16  AM-USER-SELECT-3              PIC X(10).
   559         16  AM-USER-SELECT-4              PIC X(10).
   560         16  AM-USER-SELECT-5              PIC X(10).
   561
   562     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   563
   564     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   565
   566     12  AM-RPT045A-SWITCH                 PIC X.
   567         88  RPT045A-OFF                   VALUE 'N'.
   568
   569     12  AM-INSURANCE-LIMITS.
   570         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   571         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   572
   573     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   574         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   575
   576     12  AM-DISMBR-COVERAGE-SW             PIC X.
   577         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   578         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   579
   580     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   581
   582     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   583     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   584     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   585     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   586     12  AM-DCC-UEF-STATE                  PIC XX.
   587     12  FILLER                            PIC XXX.
   588     12  AM-REPORT-CODE-3                  PIC X(10).
   589*    12  FILLER                            PIC X(22).
   590
   591     12  AM-RESERVE-DATE.
   592         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   593         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  12
* SOCK00.cbl
   594         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   595
   596     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   597     12  AM-NOTIFICATION-TYPES.
   598         16  AM-NOTIF-OF-LETTERS           PIC X.
   599         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   600         16  AM-NOTIF-OF-REPORTS           PIC X.
   601         16  AM-NOTIF-OF-STATUS            PIC X.
   602
   603     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   604         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   605         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   606         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   607         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   608
   609     12  AM-BENEFIT-CONTROLS.
   610         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   611             20  AM-BENEFIT-CODE           PIC XX.
   612             20  AM-BENEFIT-TYPE           PIC X.
   613             20  AM-BENEFIT-REVISION       PIC XXX.
   614             20  AM-BENEFIT-REM-TERM       PIC X.
   615             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   616             20  FILLER                    PIC XX.
   617         16  FILLER                        PIC X(80).
   618
   619     12  AM-TRANSFER-DATA.
   620         16  AM-TRANSFERRED-FROM.
   621             20  AM-TRNFROM-CARRIER        PIC X.
   622             20  AM-TRNFROM-GROUPING.
   623                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   624                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   625             20  AM-TRNFROM-STATE          PIC XX.
   626             20  AM-TRNFROM-ACCOUNT.
   627                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   628                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   629             20  AM-TRNFROM-DTE            PIC XX.
   630         16  AM-TRANSFERRED-TO.
   631             20  AM-TRNTO-CARRIER          PIC X.
   632             20  AM-TRNTO-GROUPING.
   633                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   634                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   635             20  AM-TRNTO-STATE            PIC XX.
   636             20  AM-TRNTO-ACCOUNT.
   637                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   638                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   639             20  AM-TRNTO-DTE              PIC XX.
   640         16  FILLER                        PIC X(10).
   641
   642     12  AM-SAVED-REMIT-TO                 PIC 99.
   643
   644     12  AM-COMM-STRUCTURE-SAVED.
   645         16  AM-DEFN-1-SAVED.
   646             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   647                 24  AM-AGT-SV             PIC X(10).
   648                 24  AM-COM-TYP-SV         PIC X.
   649                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   650                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   651                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  13
* SOCK00.cbl
   652                 24  AM-RECALC-LV-INDIC-SV PIC X.
   653                 24  FILLER                PIC X.
   654                 24  AM-GL-CODES-SV        PIC X.
   655                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   656                 24  FILLER                PIC X.
   657         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   658             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   659                 24  FILLER                PIC X(11).
   660                 24  AM-L-COMA-SV          PIC XXX.
   661                 24  AM-J-COMA-SV          PIC XXX.
   662                 24  AM-A-COMA-SV          PIC XXX.
   663                 24  FILLER                PIC X(6).
   664
   665     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   666         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   667            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   668            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   669            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   670
   671     12  AM-ORIG-DEALER-NO                 PIC X(10).
   672     12  FILLER                            PIC X(120).
   673
   674     12  AM-ACCOUNT-EXECUTIVE-DATA.
   675         16  AM-CONTROL-NAME               PIC X(30).
   676         16  AM-EXECUTIVE-ONE.
   677             20  AM-EXEC1-NAME             PIC X(15).
   678             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   679                                                          COMP-3.
   680             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   681                                                          COMP-3.
   682         16  AM-EXECUTIVE-TWO.
   683             20  AM-EXEC2-NAME             PIC X(15).
   684             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   685                                                          COMP-3.
   686             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   687                                                          COMP-3.
   688
   689     12  AM-RETRO-ADDITIONAL-DATA.
   690         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   691         16  AM-RETRO-PREM-P-E             PIC X.
   692         16  AM-RETRO-CLMS-P-I             PIC X.
   693         16  AM-RETRO-RET-BRACKET-LF.
   694             20  AM-RETRO-RET-METHOD-LF    PIC X.
   695                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
   696                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
   697             20  AM-RETRO-RET-BASIS-LF     PIC X.
   698                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
   699                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
   700             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
   701                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
   702                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
   703         16  AM-RETRO-RET-BRACKET-AH.
   704             20  AM-RETRO-RET-METHOD-AH    PIC X.
   705                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
   706                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
   707                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
   708             20  AM-RETRO-RET-BASIS-AH     PIC X.
   709                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  14
* SOCK00.cbl
   710                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
   711             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
   712                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
   713                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
   714
   715     12  AM-COMMENTS.
   716         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
   717
   718     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
   719         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
   720         16  AM-FLI-BILLING-CODE           PIC X.
   721         16  AM-FLI-ALT-STATE-CODE         PIC XX.
   722         16  AM-FLI-UNITED-IDENT           PIC X.
   723         16  AM-FLI-INTEREST-LOST-DATA.
   724             20  AM-FLI-BANK-NO            PIC X(5).
   725             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
   726             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
   727             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
   728         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
   729             20  AM-FLI-AGT                PIC X(9).
   730             20  AM-FLI-AGT-COMM-ACC       PIC X.
   731             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
   732         16  FILLER                        PIC X(102).
   733
   734     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
   735         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
   736             20  AM-BENEFIT-DMD-CODE         PIC XX.
   737             20  AM-BENEFIT-DMD-TYPE         PIC X.
   738             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
   739             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
   740             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
   741         16  FILLER                          PIC X(10).
   742******************************************************************
   743*                                 COPY ERCCOMP.
   744******************************************************************
   745*                                                                *
   746*                                                                *
   747*                            ERCCOMP                             *
   748*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   749*                            VMOD=2.019                          *
   750*                                                                *
   751*   ONLINE CREDIT SYSTEM                                         *
   752*                                                                *
   753*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   754*                                                                *
   755*   FILE TYPE = VSAM,KSDS                                        *
   756*   RECORD SIZE = 700   RECFORM = FIXED                          *
   757*                                                                *
   758*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   759*       ALTERNATE PATH = NONE                                    *
   760*                                                                *
   761*   LOG = NO                                                     *
   762*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   763*                                                                *
   764******************************************************************
   765*                   C H A N G E   L O G
   766*
   767* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  15
* SOCK00.cbl
   768*-----------------------------------------------------------------
   769*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   770* EFFECTIVE    NUMBER
   771*-----------------------------------------------------------------
   772* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   773* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   774* 092205    2005050300006  PEMA  ADD LEASE FEE
   775* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   776* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   777* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   778* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   779* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   780* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   781******************************************************************
   782
   783 01  COMPENSATION-MASTER.
   784     12  CO-RECORD-ID                          PIC XX.
   785         88  VALID-CO-ID                          VALUE 'CO'.
   786
   787     12  CO-CONTROL-PRIMARY.
   788         16  CO-COMPANY-CD                     PIC X.
   789         16  CO-CONTROL.
   790             20  CO-CTL-1.
   791                 24  CO-CARR-GROUP.
   792                     28  CO-CARRIER            PIC X.
   793                     28  CO-GROUPING.
   794                         32  CO-GROUP-PREFIX   PIC XXX.
   795                         32  CO-GROUP-PRIME    PIC XXX.
   796                 24  CO-RESP-NO.
   797                     28  CO-RESP-PREFIX        PIC X(4).
   798                     28  CO-RESP-PRIME         PIC X(6).
   799             20  CO-CTL-2.
   800                 24  CO-ACCOUNT.
   801                     28  CO-ACCT-PREFIX        PIC X(4).
   802                     28  CO-ACCT-PRIME         PIC X(6).
   803         16  CO-TYPE                           PIC X.
   804             88  CO-COMPANY-TYPE                  VALUE 'C'.
   805             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   806             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   807
   808     12  CO-MAINT-INFORMATION.
   809         16  CO-LAST-MAINT-DT                  PIC XX.
   810         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   811         16  CO-LAST-MAINT-USER                PIC X(4).
   812     12  FILLER                                PIC XX.
   813     12  CO-STMT-TYPE                          PIC XXX.
   814     12  CO-COMP-TYPE                          PIC X.
   815         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   816     12  CO-STMT-OWNER                         PIC X(4).
   817     12  CO-BALANCE-CONTROL                    PIC X.
   818         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   819         88  CO-NO-BALANCE                        VALUE 'N'.
   820
   821     12  CO-INTERNAL-CONTROL-1                 PIC X.
   822         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   823         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   824         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   825
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  16
* SOCK00.cbl
   826     12  CO-INTERNAL-CONTROL-2                 PIC X.
   827         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   828         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   829
   830     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   831     12  CO-GA-DIRECT-DEP                      PIC X.
   832     12  CO-FUTURE-SPACE                       PIC X.
   833         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   834
   835     12  CO-ACCT-NAME                          PIC X(30).
   836     12  CO-MAIL-NAME                          PIC X(30).
   837     12  CO-ADDR-1                             PIC X(30).
   838     12  CO-ADDR-2                             PIC X(30).
   839     12  CO-ADDR-3.
   840         16  CO-ADDR-CITY                      PIC X(27).
   841         16  CO-ADDR-STATE                     PIC XX.
   842     12  CO-CSO-1099                           PIC X.
   843     12  CO-ZIP.
   844         16  CO-ZIP-PRIME.
   845             20  CO-ZIP-PRI-1ST                PIC X.
   846                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   847             20  FILLER                        PIC X(4).
   848         16  CO-ZIP-PLUS4                      PIC X(4).
   849     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   850         16  CO-CAN-POSTAL-1                   PIC XXX.
   851         16  CO-CAN-POSTAL-2                   PIC XXX.
   852         16  FILLER                            PIC XXX.
   853     12  CO-SOC-SEC                            PIC X(13).
   854     12  CO-TELEPHONE.
   855         16  CO-AREA-CODE                      PIC XXX.
   856         16  CO-PREFIX                         PIC XXX.
   857         16  CO-PHONE                          PIC X(4).
   858
   859     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   860
   861     12  CO-AR-BAL-LEVEL                       PIC X.
   862         88  CO-AR-REF-LVL                        VALUE '1'.
   863         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   864         88  CO-AR-BILL-LVL                       VALUE '2'.
   865         88  CO-AR-AGT-LVL                        VALUE '3'.
   866         88  CO-AR-FR-LVL                         VALUE '4'.
   867
   868     12  CO-AR-NORMAL-PRINT                    PIC X.
   869         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   870         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   871
   872     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   873
   874     12  CO-AR-REPORTING                       PIC X.
   875         88  CO-AR-NET-REPORT                     VALUE 'N'.
   876         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   877
   878     12  CO-AR-PULL-CHECK                      PIC X.
   879         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   880         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   881
   882     12  CO-AR-BALANCE-PRINT                   PIC X.
   883         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  17
* SOCK00.cbl
   884
   885     12  CO-AR-LAST-RUN-CODE                   PIC X.
   886         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   887         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   888         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   889
   890     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   891
   892     12  CO-USER-CODE                          PIC X.
   893     12  CO-REPORT-GROUP-ID                    PIC X(12).
   894
   895******************************************************************
   896*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   897*    THE LAST MONTH END RUN.
   898******************************************************************
   899
   900     12  CO-LAST-ACTIVITY-DATE.
   901         16  CO-ACT-YEAR                       PIC 99.
   902         16  CO-ACT-MONTH                      PIC 99.
   903         16  CO-ACT-DAY                        PIC 99.
   904
   905     12  CO-LAST-STMT-DT.
   906         16  CO-LAST-STMT-YEAR                 PIC 99.
   907         16  CO-LAST-STMT-MONTH                PIC 99.
   908         16  CO-LAST-STMT-DAY                  PIC 99.
   909
   910     12  CO-MO-END-TOTALS.
   911         16  CO-MONTHLY-TOTALS.
   912             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   913             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   914             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   915             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   916             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   917
   918         16  CO-AGING-TOTALS.
   919             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   920             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   921             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   922             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   923
   924         16  CO-YTD-TOTALS.
   925             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   926             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   927
   928         16  CO-OVER-UNDER-TOTALS.
   929             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   930             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   931
   932     12  CO-MISCELLANEOUS-TOTALS.
   933         16  CO-FICA-TOTALS.
   934             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   935             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   936
   937         16  CO-CLAIM-TOTALS.
   938             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   939             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   940
   941******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  18
* SOCK00.cbl
   942*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   943*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   944******************************************************************
   945
   946     12  CO-CURRENT-TOTALS.
   947         16  CO-CURRENT-LAST-STMT-DT.
   948             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   949             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   950             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   951
   952         16  CO-CURRENT-MONTHLY-TOTALS.
   953             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   954             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   955             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   956             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   957             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   958
   959         16  CO-CURRENT-AGING-TOTALS.
   960             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   961             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   962             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   963             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
   964
   965         16  CO-CURRENT-YTD-TOTALS.
   966             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   967             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   968
   969     12  CO-PAID-COMM-TOTALS.
   970         16  CO-YTD-PAID-COMMS.
   971             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   972             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   973
   974     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   975         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   976         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   977
   978     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   979         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   980         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   981         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   982         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   983         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   984         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   985         88  CO-FINAL-LETTER                  VALUE 'F'.
   986         88  CO-RECONCILING                   VALUE 'R'.
   987         88  CO-PHONE-CALL                    VALUE 'P'.
   988         88  CO-LEGAL                         VALUE 'L'.
   989         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   990         88  CO-WRITE-OFF                     VALUE 'W'.
   991         88  CO-NO-ACTION                     VALUE 'N' ' '.
   992
   993     12  CO-CSR-CODE                       PIC X(4).
   994
   995     12  CO-GA-STATUS-INFO.
   996         16  CO-GA-EFFECTIVE-DT            PIC XX.
   997         16  CO-GA-TERMINATION-DT          PIC XX.
   998         16  CO-GA-STATUS-CODE             PIC X.
   999             88  CO-GA-ACTIVE                 VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  19
* SOCK00.cbl
  1000             88  CO-GA-INACTIVE               VALUE 'I'.
  1001             88  CO-GA-PENDING                VALUE 'P'.
  1002         16  CO-GA-COMMENTS.
  1003             20  CO-GA-COMMENT-1           PIC X(40).
  1004             20  CO-GA-COMMENT-2           PIC X(40).
  1005             20  CO-GA-COMMENT-3           PIC X(40).
  1006             20  CO-GA-COMMENT-4           PIC X(40).
  1007
  1008     12  CO-RPTCD2                         PIC X(10).
  1009     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1010         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1011         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1012
  1013     12  CO-TYPE-AGENT                     PIC X(01).
  1014         88  CO-CORPORATION                   VALUE 'C'.
  1015         88  CO-PARTNERSHIP                   VALUE 'P'.
  1016         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1017         88  CO-TRUST                         VALUE 'T'.
  1018         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1019
  1020     12  CO-FAXNO.
  1021         16  CO-FAX-AREA-CODE                  PIC XXX.
  1022         16  CO-FAX-PREFIX                     PIC XXX.
  1023         16  CO-FAX-PHONE                      PIC X(4).
  1024
  1025     12  CO-BANK-INFORMATION.
  1026         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1027         16  CO-BANK-TRANSIT-NON REDEFINES
  1028             CO-BANK-TRANSIT-NO                PIC 9(8).
  1029
  1030         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1031     12  CO-MISC-DEDUCT-INFO REDEFINES
  1032                  CO-BANK-INFORMATION.
  1033         16  CO-MD-GL-ACCT                     PIC X(10).
  1034         16  CO-MD-DIV                         PIC XX.
  1035         16  CO-MD-CENTER                      PIC X(4).
  1036         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1037         16  CO-CREATE-AP-CHECK                PIC X.
  1038         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1039         16  FILLER                            PIC XXX.
  1040     12  CO-ACH-STATUS                         PIC X.
  1041         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1042         88  CO-ACH-PENDING                        VALUE 'P'.
  1043
  1044     12  CO-BILL-SW                            PIC X.
  1045     12  CO-CONTROL-NAME                       PIC X(30).
  1046     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1047     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1048     12  CO-CLP-STATE                          PIC XX.
  1049     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1050     12  CO-SPP-REFUND-EDIT                    PIC X.
  1051
  1052******************************************************************
  1053*                                 COPY ELCCNTL.
  1054******************************************************************
  1055*                                                                *
  1056*                                                                *
  1057*                            ELCCNTL.                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  20
* SOCK00.cbl
  1058*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1059*                            VMOD=2.059                          *
  1060*                                                                *
  1061*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1062*                                                                *
  1063*   FILE TYPE = VSAM,KSDS                                        *
  1064*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1065*                                                                *
  1066*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1067*       ALTERNATE INDEX = NONE                                   *
  1068*                                                                *
  1069*   LOG = YES                                                    *
  1070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1071******************************************************************
  1072*                   C H A N G E   L O G
  1073*
  1074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1075*-----------------------------------------------------------------
  1076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1077* EFFECTIVE    NUMBER
  1078*-----------------------------------------------------------------
  1079* 082503                   PEMA  ADD BENEFIT GROUP
  1080* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1081* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1082* 092705    2005050300006  PEMA  ADD SPP LEASES
  1083* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1084* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1085* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1086* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1087* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1088* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1089* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1090* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1091* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1092* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1093******************************************************************
  1094*
  1095 01  CONTROL-FILE.
  1096     12  CF-RECORD-ID                       PIC XX.
  1097         88  VALID-CF-ID                        VALUE 'CF'.
  1098
  1099     12  CF-CONTROL-PRIMARY.
  1100         16  CF-COMPANY-ID                  PIC XXX.
  1101         16  CF-RECORD-TYPE                 PIC X.
  1102             88  CF-COMPANY-MASTER              VALUE '1'.
  1103             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1104             88  CF-STATE-MASTER                VALUE '3'.
  1105             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1106             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1107             88  CF-CARRIER-MASTER              VALUE '6'.
  1108             88  CF-MORTALITY-MASTER            VALUE '7'.
  1109             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1110             88  CF-TERMINAL-MASTER             VALUE '9'.
  1111             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1112             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1113             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1114             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1115             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  21
* SOCK00.cbl
  1116             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1117             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1118             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1119             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1120         16  CF-ACCESS-CD-GENL              PIC X(4).
  1121         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1122             20  CF-PROCESSOR               PIC X(4).
  1123         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1124             20  CF-STATE-CODE              PIC XX.
  1125             20  FILLER                     PIC XX.
  1126         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1127             20  FILLER                     PIC XX.
  1128             20  CF-HI-BEN-IN-REC           PIC XX.
  1129         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1130             20  FILLER                     PIC XXX.
  1131             20  CF-CARRIER-CNTL            PIC X.
  1132         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1133             20  FILLER                     PIC XX.
  1134             20  CF-HI-TYPE-IN-REC          PIC 99.
  1135         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1136             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1137                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1138             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1139             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1140         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1141             20  FILLER                     PIC X.
  1142             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1143         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1144             20  FILLER                     PIC XX.
  1145             20  CF-MORTGAGE-PLAN           PIC XX.
  1146         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1147
  1148     12  CF-LAST-MAINT-DT                   PIC XX.
  1149     12  CF-LAST-MAINT-BY                   PIC X(4).
  1150     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1151
  1152     12  CF-RECORD-BODY                     PIC X(728).
  1153
  1154
  1155****************************************************************
  1156*             COMPANY MASTER RECORD                            *
  1157****************************************************************
  1158
  1159     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1160         16  CF-COMPANY-ADDRESS.
  1161             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1162             20  CF-CL-IN-CARE-OF           PIC X(30).
  1163             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1164             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1165             20  CF-CL-CITY-STATE           PIC X(30).
  1166             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1167             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1168         16  CF-COMPANY-CD                  PIC X.
  1169         16  CF-COMPANY-PASSWORD            PIC X(8).
  1170         16  CF-SECURITY-OPTION             PIC X.
  1171             88  ALL-SECURITY                   VALUE '1'.
  1172             88  COMPANY-VERIFY                 VALUE '2'.
  1173             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  22
* SOCK00.cbl
  1174             88  NO-SECURITY                    VALUE '4'.
  1175             88  ALL-BUT-TERM                   VALUE '5'.
  1176         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1177             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1178         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1179             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1180         16  CF-INFORCE-LOCATION            PIC X.
  1181             88  CERTS-ARE-ONLINE               VALUE '1'.
  1182             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1183             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1184         16  CF-LOWER-CASE-LETTERS          PIC X.
  1185         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1186             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1187             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1188             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1189             88  CF-ACCNT-CNTL                  VALUE '3'.
  1190             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1191
  1192         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1193         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1194
  1195         16  CF-LGX-CREDIT-USER             PIC X.
  1196             88  CO-IS-NOT-USER                 VALUE 'N'.
  1197             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1198
  1199         16 CF-CREDIT-CALC-CODES.
  1200             20  CF-CR-REM-TERM-CALC PIC X.
  1201               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1202               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1203               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1204               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1205               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1206               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1207               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1208             20  CF-CR-R78-METHOD           PIC X.
  1209               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1210               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1211
  1212         16  CF-CLAIM-CONTROL-COUNTS.
  1213             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1214                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1215
  1216             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1217                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1218
  1219             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1220                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1221
  1222             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1223                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1224
  1225         16  CF-CURRENT-MONTH-END           PIC XX.
  1226
  1227         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1228             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1229             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1230             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1231             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  23
* SOCK00.cbl
  1232                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1233                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1234             20  CF-CO-PREM-REJECT-SW       PIC X.
  1235                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1236                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1237             20  CF-CO-REF-REJECT-SW        PIC X.
  1238                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1239                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1240
  1241         16  CF-CO-REPORTING-DT             PIC XX.
  1242         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1243         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1244           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1245           88  CF-CO-MONTH-END                  VALUE '1'.
  1246
  1247         16  CF-LGX-CLAIM-USER              PIC X.
  1248             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1249             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1250
  1251         16  CF-CREDIT-EDIT-CONTROLS.
  1252             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1253             20  CF-MIN-AGE                 PIC 99.
  1254             20  CF-DEFAULT-AGE             PIC 99.
  1255             20  CF-MIN-TERM                PIC S999      COMP-3.
  1256             20  CF-MAX-TERM                PIC S999      COMP-3.
  1257             20  CF-DEFAULT-SEX             PIC X.
  1258             20  CF-JOINT-AGE-INPUT         PIC X.
  1259                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1260             20  CF-BIRTH-DATE-INPUT        PIC X.
  1261                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1262             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1263                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1264                 88  CF-ZERO-CARRIER            VALUE '1'.
  1265                 88  CF-ZERO-GROUPING           VALUE '2'.
  1266                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1267             20  CF-EDIT-SW                 PIC X.
  1268                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1269             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1270             20  CF-CR-PR-METHOD            PIC X.
  1271               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1272               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1273             20  FILLER                     PIC X.
  1274
  1275         16  CF-CREDIT-MISC-CONTROLS.
  1276             20  CF-REIN-TABLE-SW           PIC X.
  1277                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1278             20  CF-COMP-TABLE-SW           PIC X.
  1279                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1280             20  CF-EXPERIENCE-RETENTION-AGE
  1281                                            PIC S9        COMP-3.
  1282             20  CF-CONVERSION-DT           PIC XX.
  1283             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1284             20  CF-RUN-FREQUENCY-SW        PIC X.
  1285                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1286                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1287
  1288             20  CF-CR-CHECK-NO-CONTROL.
  1289                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  24
* SOCK00.cbl
  1290                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1291                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1292                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1293                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1294                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1295
  1296                 24  CF-CR-CHECK-COUNT       REDEFINES
  1297                     CF-CR-CHECK-COUNTER      PIC X(4).
  1298
  1299                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1300                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1301
  1302                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1303                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1304                 24  CF-MAIL-PROCESSING       PIC X.
  1305                     88  MAIL-PROCESSING          VALUE 'Y'.
  1306
  1307         16  CF-MISC-SYSTEM-CONTROL.
  1308             20  CF-SYSTEM-C                 PIC X.
  1309                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1310             20  CF-SYSTEM-D                 PIC X.
  1311                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1312             20  CF-SOC-SEC-NO-SW            PIC X.
  1313                 88  SOC-SEC-NO-USED             VALUE '1'.
  1314             20  CF-MEMBER-NO-SW             PIC X.
  1315                 88  MEMBER-NO-USED              VALUE '1'.
  1316             20  CF-TAX-ID-NUMBER            PIC X(11).
  1317             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1318             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1319                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1320                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1321                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1322                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1323             20  CF-SYSTEM-E                 PIC X.
  1324                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1325
  1326         16  CF-LGX-LIFE-USER               PIC X.
  1327             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1328             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1329
  1330         16  CF-CR-MONTH-END-DT             PIC XX.
  1331
  1332         16  CF-FILE-MAINT-DATES.
  1333             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1334                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1335             20  CF-LAST-BATCH       REDEFINES
  1336                 CF-LAST-BATCH-NO               PIC X(4).
  1337             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1338             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1339             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1340             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1341             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1342             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1343             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1344             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1345             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1346             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1347
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  25
* SOCK00.cbl
  1348         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1349         16  FILLER                         PIC X.
  1350
  1351         16  CF-ALT-MORT-CODE               PIC X(4).
  1352         16  CF-MEMBER-CAPTION              PIC X(10).
  1353
  1354         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1355             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1356             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1357             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1358             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1359             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1360
  1361         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1362
  1363         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1364         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1365         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1366         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1367
  1368         16  CF-AH-OVERRIDE-L1              PIC X.
  1369         16  CF-AH-OVERRIDE-L2              PIC XX.
  1370         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1371         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1372
  1373         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1374         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1375
  1376         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1377         16  CF-AR-LAST-EL860-DT            PIC XX.
  1378         16  CF-MP-MONTH-END-DT             PIC XX.
  1379
  1380         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1381         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1382             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1383
  1384         16  CF-AR-MONTH-END-DT             PIC XX.
  1385
  1386         16  CF-CRDTCRD-USER                PIC X.
  1387             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1388             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1389
  1390         16  CF-CC-MONTH-END-DT             PIC XX.
  1391
  1392         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1393
  1394         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1395             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1396             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1397             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1398         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1399         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1400         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1401         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1402             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1403             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1404         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1405         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  26
* SOCK00.cbl
  1406         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1407             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1408         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1409
  1410         16  CF-CL-ZIP-CODE.
  1411             20  CF-CL-ZIP-PRIME.
  1412                 24  CF-CL-ZIP-1ST          PIC X.
  1413                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1414                 24  FILLER                 PIC X(4).
  1415             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1416         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1417             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1418             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1419             20  FILLER                     PIC XXX.
  1420
  1421         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1422         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1423         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1424         16  CF-CO-OPTION-START-DATE        PIC XX.
  1425         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1426           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1427                                                      '3' '4'.
  1428           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1429           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1430           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1431           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1432           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1433           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1434
  1435         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1436
  1437         16  CF-PAYMENT-APPROVAL-LEVELS.
  1438             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1439             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1440             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1441             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1442             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1443             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1444
  1445         16  CF-END-USER-REPORTING-USER     PIC X.
  1446             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1447             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1448
  1449         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1450             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1451             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1452
  1453         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1454
  1455         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1456         16  FILLER                         PIC X.
  1457
  1458         16  CF-CREDIT-ARCHIVE-CNTL.
  1459             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1460             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1461             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1462
  1463         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  27
* SOCK00.cbl
  1464
  1465         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1466             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1467             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1468
  1469         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1470             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1471             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1472
  1473         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1474
  1475         16  CF-CO-ACH-ID-CODE              PIC  X.
  1476             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1477             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1478             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1479         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1480         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1481         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1482         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1483         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1484         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1485         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1486         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1487         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1488                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1489         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1490                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1491
  1492         16  CF-CO-OVER-SHORT.
  1493             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1494             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1495
  1496*         16  FILLER                         PIC X(102).
  1497         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1498             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1499             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1500
  1501         16  CF-AH-APPROVAL-DAYS.
  1502             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1503             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1504             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1505             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1506
  1507         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1508
  1509         16  CF-APPROV-LEV-5.
  1510             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1511             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1512             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1513
  1514         16  FILLER                         PIC X(68).
  1515****************************************************************
  1516*             PROCESSOR/USER RECORD                            *
  1517****************************************************************
  1518
  1519     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1520         16  CF-PROCESSOR-NAME              PIC X(30).
  1521         16  CF-PROCESSOR-PASSWORD          PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  28
* SOCK00.cbl
  1522         16  CF-PROCESSOR-TITLE             PIC X(26).
  1523         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1524                 88  MESSAGE-YES                VALUE 'Y'.
  1525                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1526
  1527*****************************************************
  1528****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1529****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1530****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1531****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1532*****************************************************
  1533
  1534         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1535             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1536             20  CF-APPLICATION-FORCE       PIC X.
  1537             20  CF-INDIVIDUAL-APP.
  1538                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1539                     28  CF-BROWSE-APP      PIC X.
  1540                     28  CF-UPDATE-APP      PIC X.
  1541
  1542         16  CF-CURRENT-TERM-ON             PIC X(4).
  1543         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1544             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1545             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1546             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1547             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1548             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1549             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1550             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1551         16  CF-PROCESSOR-CARRIER           PIC X.
  1552             88  NO-CARRIER-SECURITY            VALUE ' '.
  1553         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1554             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1555         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1556             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1557         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1558             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1559
  1560         16  CF-PROC-SYS-ACCESS-SW.
  1561             20  CF-PROC-CREDIT-CLAIMS-SW.
  1562                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1563                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1564                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1565                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1566             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1567                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1568                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1569             20  CF-PROC-LIFE-GNRLDGR-SW.
  1570                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1571                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1572                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1573                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1574             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1575                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1576                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1577         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1578             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1579             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  29
* SOCK00.cbl
  1580         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1581
  1582         16  CF-APPROVAL-LEVEL                  PIC X.
  1583             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1584             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1585             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1586             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1587             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1588
  1589         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1590
  1591         16  CF-LANGUAGE-TYPE                   PIC X.
  1592             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1593             88  CF-LANG-IS-FR                      VALUE 'F'.
  1594
  1595         16  CF-CSR-IND                         PIC X.
  1596         16  FILLER                             PIC X(239).
  1597
  1598****************************************************************
  1599*             PROCESSOR/REMINDERS RECORD                       *
  1600****************************************************************
  1601
  1602     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1603         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1604             20  CF-START-REMIND-DT         PIC XX.
  1605             20  CF-END-REMIND-DT           PIC XX.
  1606             20  CF-REMINDER-TEXT           PIC X(50).
  1607         16  FILLER                         PIC X(296).
  1608
  1609
  1610****************************************************************
  1611*             STATE MASTER RECORD                              *
  1612****************************************************************
  1613
  1614     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1615         16  CF-STATE-ABBREVIATION          PIC XX.
  1616         16  CF-STATE-NAME                  PIC X(25).
  1617         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1618         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1619             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1620             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1621             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1622             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1623                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1624                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1625             20  CF-ST-PREM-REJECT-SW       PIC X.
  1626                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1627                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1628             20  CF-ST-REF-REJECT-SW        PIC X.
  1629                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1630                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1631         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1632         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1633         16  CF-ST-REFUND-RULES.
  1634             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1635             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1636             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1637         16  CF-ST-FST-PMT-EXTENSION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  30
* SOCK00.cbl
  1638             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1639             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1640                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1641                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1642                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1643                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1644         16  CF-ST-STATE-CALL.
  1645             20  CF-ST-CALL-UNEARNED        PIC X.
  1646             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1647             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1648         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1649             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1650             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1651         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1652         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1653         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1654         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1655         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1656         16  FILLER                         PIC X.
  1657         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1658             20  CF-ST-BENEFIT-CD           PIC XX.
  1659             20  CF-ST-BENEFIT-KIND         PIC X.
  1660                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1661                 88  CF-ST-AH-KIND              VALUE 'A'.
  1662             20  CF-ST-REM-TERM-CALC        PIC X.
  1663                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1664                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1665                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1666                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1667                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1668                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1669                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1670                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1671
  1672             20  CF-ST-REFUND-CALC          PIC X.
  1673                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1674                 88  ST-REFD-BY-R78             VALUE '1'.
  1675                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1676                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1677                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1678                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1679                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1680                 88  ST-REFD-UTAH               VALUE '7'.
  1681                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1682                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1683                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1684
  1685             20  CF-ST-EARNING-CALC         PIC X.
  1686                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1687                 88  ST-EARN-BY-R78             VALUE '1'.
  1688                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1689                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1690                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1691                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1692                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1693                 88  ST-EARN-MEAN               VALUE '8'.
  1694                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1695
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  31
* SOCK00.cbl
  1696             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1697                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1698                 88  ST-OVRD-BY-R78             VALUE '1'.
  1699                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1700                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1701                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1702                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1703                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1704                 88  ST-OVRD-MEAN               VALUE '8'.
  1705                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1706             20  cf-st-extra-periods        pic 9.
  1707*            20  FILLER                     PIC X.
  1708
  1709         16  CF-ST-COMMISSION-CAPS.
  1710             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1711             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1712             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1713             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1714         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1715                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1716
  1717         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1718
  1719         16  CF-ST-STATUTORY-INTEREST.
  1720             20  CF-ST-STAT-DATE-FROM       PIC X.
  1721                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1722                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1723             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1724             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1725             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1726             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1727             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1728
  1729         16  CF-ST-OVER-SHORT.
  1730             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1731             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1732
  1733         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1734
  1735         16  CF-ST-RT-CALC                  PIC X.
  1736
  1737         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1738         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1739         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1740         16  CF-ST-RF-LR-CALC               PIC X.
  1741         16  CF-ST-RF-LL-CALC               PIC X.
  1742         16  CF-ST-RF-LN-CALC               PIC X.
  1743         16  CF-ST-RF-AH-CALC               PIC X.
  1744         16  CF-ST-RF-CP-CALC               PIC X.
  1745*        16  FILLER                         PIC X(206).
  1746*CIDMOD         16  FILLER                         PIC X(192).
  1747         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1748             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1749         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1750         16  CF-ST-VFY-2ND-BENE             PIC X.
  1751         16  CF-ST-CAUSAL-STATE             PIC X.
  1752         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1753         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  32
* SOCK00.cbl
  1754         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1755             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1756         16  CF-ST-NET-ONLY-STATE           PIC X.
  1757             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1758         16  FILLER                         PIC X(181).
  1759
  1760****************************************************************
  1761*             BENEFIT MASTER RECORD                            *
  1762****************************************************************
  1763
  1764     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1765         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1766             20  CF-BENEFIT-CODE            PIC XX.
  1767             20  CF-BENEFIT-NUMERIC  REDEFINES
  1768                 CF-BENEFIT-CODE            PIC XX.
  1769             20  CF-BENEFIT-ALPHA           PIC XXX.
  1770             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1771             20  CF-BENEFIT-COMMENT         PIC X(10).
  1772
  1773             20  CF-LF-COVERAGE-TYPE        PIC X.
  1774                 88  CF-REDUCING                VALUE 'R'.
  1775                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1776
  1777             20  CF-SPECIAL-CALC-CD         PIC X.
  1778                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1779                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1780                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1781                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1782                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1783                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1784                 88  CF-FARM-PLAN               VALUE 'F'.
  1785                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1786                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1787                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1788                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1789                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1790                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1791                 88  CF-PRUDENTIAL              VALUE 'P'.
  1792                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1793                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1794                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1795                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1796                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1797                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1798
  1799             20  CF-JOINT-INDICATOR         PIC X.
  1800                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1801
  1802*            20  FILLER                     PIC X(12).
  1803             20  cf-maximum-benefits        pic s999 comp-3.
  1804             20  FILLER                     PIC X(09).
  1805             20  CF-BENEFIT-CATEGORY        PIC X.
  1806             20  CF-LOAN-TYPE               PIC X(8).
  1807
  1808             20  CF-CO-REM-TERM-CALC        PIC X.
  1809                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1810                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1811                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  33
* SOCK00.cbl
  1812                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1813                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1814
  1815             20  CF-CO-EARNINGS-CALC        PIC X.
  1816                 88  CO-EARN-BY-R78             VALUE '1'.
  1817                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1818                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1819                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1820                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1821                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1822                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1823                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1824
  1825             20  CF-CO-REFUND-CALC          PIC X.
  1826                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1827                 88  CO-REFD-BY-R78             VALUE '1'.
  1828                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1829                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1830                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1831                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1832                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1833                 88  CO-REFD-MEAN               VALUE '8'.
  1834                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1835                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1836                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1837
  1838             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1839                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1840                 88  CO-OVRD-BY-R78             VALUE '1'.
  1841                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1842                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1843                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1844                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1845                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1846                 88  CO-OVRD-MEAN               VALUE '8'.
  1847                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1848
  1849             20  CF-CO-BEN-I-G-CD           PIC X.
  1850                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1851                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1852                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1853
  1854         16  FILLER                         PIC X(304).
  1855
  1856
  1857****************************************************************
  1858*             CARRIER MASTER RECORD                            *
  1859****************************************************************
  1860
  1861     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1862         16  CF-ADDRESS-DATA.
  1863             20  CF-MAIL-TO-NAME            PIC X(30).
  1864             20  CF-IN-CARE-OF              PIC X(30).
  1865             20  CF-ADDRESS-LINE-1          PIC X(30).
  1866             20  CF-ADDRESS-LINE-2          PIC X(30).
  1867             20  CF-CITY-STATE              PIC X(30).
  1868             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1869             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  34
* SOCK00.cbl
  1870
  1871         16  CF-CLAIM-NO-CONTROL.
  1872             20  CF-CLAIM-NO-METHOD         PIC X.
  1873                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1874                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1875                 88  CLAIM-NO-SEQ               VALUE '3'.
  1876                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1877             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1878                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1879                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1880                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1881
  1882         16  CF-CHECK-NO-CONTROL.
  1883             20  CF-CHECK-NO-METHOD         PIC X.
  1884                 88  CHECK-NO-MANUAL            VALUE '1'.
  1885                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1886                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1887                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1888             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1889                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1890
  1891         16  CF-DOMICILE-STATE              PIC XX.
  1892
  1893         16  CF-EXPENSE-CONTROLS.
  1894             20  CF-EXPENSE-METHOD          PIC X.
  1895                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1896                 88  DOLLARS-PER-PMT            VALUE '2'.
  1897                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1898                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1899             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1900             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1901
  1902         16  CF-CORRESPONDENCE-CONTROL.
  1903             20  CF-LETTER-RESEND-OPT       PIC X.
  1904                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1905                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1906             20  FILLER                     PIC X(4).
  1907
  1908         16  CF-RESERVE-CONTROLS.
  1909             20  CF-MANUAL-SW               PIC X.
  1910                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1911             20  CF-FUTURE-SW               PIC X.
  1912                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1913             20  CF-PTC-SW                  PIC X.
  1914                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1915             20  CF-IBNR-SW                 PIC X.
  1916                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1917             20  CF-PTC-LF-SW               PIC X.
  1918                 88  CF-LF-PTC-USED             VALUE '1'.
  1919             20  CF-CDT-ACCESS-METHOD       PIC X.
  1920                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1921                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1922                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1923             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1924
  1925         16  CF-CLAIM-CALC-METHOD           PIC X.
  1926             88  360-PLUS-MONTHS                VALUE '1'.
  1927             88  365-PLUS-MONTHS                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  35
* SOCK00.cbl
  1928             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1929             88  360-DAILY                      VALUE '4'.
  1930             88  365-DAILY                      VALUE '5'.
  1931
  1932         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1933         16  FILLER                         PIC X(11).
  1934
  1935         16  CF-LIMIT-AMOUNTS.
  1936             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1937             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1938             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1939             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1940             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1941             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1942             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1943             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1944             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1945             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1946
  1947         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1948         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1949         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1950
  1951         16  CF-ZIP-CODE.
  1952             20  CF-ZIP-PRIME.
  1953                 24  CF-ZIP-1ST             PIC X.
  1954                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1955                 24  FILLER                 PIC X(4).
  1956             20  CF-ZIP-PLUS4               PIC X(4).
  1957         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1958             20  CF-CAN-POSTAL-1            PIC XXX.
  1959             20  CF-CAN-POSTAL-2            PIC XXX.
  1960             20  FILLER                     PIC XXX.
  1961
  1962         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1963         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1964         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1965
  1966         16  CF-RATING-SWITCH               PIC X.
  1967             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1968             88  CF-NO-RATING                   VALUE 'N'.
  1969
  1970         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1971
  1972         16  CF-CARRIER-OVER-SHORT.
  1973             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1974             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1975
  1976         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1977         16  CF-SECPAY-SWITCH               PIC X.
  1978             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1979             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1980         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1981         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1982         16  FILLER                         PIC X(444).
  1983*        16  FILLER                         PIC X(452).
  1984
  1985
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  36
* SOCK00.cbl
  1986****************************************************************
  1987*             MORTALITY MASTER RECORD                          *
  1988****************************************************************
  1989
  1990     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1991         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1992                                INDEXED BY CF-MORT-NDX.
  1993             20  CF-MORT-TABLE              PIC X(5).
  1994             20  CF-MORT-TABLE-TYPE         PIC X.
  1995                 88  CF-MORT-JOINT              VALUE 'J'.
  1996                 88  CF-MORT-SINGLE             VALUE 'S'.
  1997                 88  CF-MORT-COMBINED           VALUE 'C'.
  1998                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1999                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2000             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2001             20  CF-MORT-AGE-METHOD         PIC XX.
  2002                 88  CF-AGE-LAST                VALUE 'AL'.
  2003                 88  CF-AGE-NEAR                VALUE 'AN'.
  2004             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2005             20  CF-MORT-ADJUSTMENT-DIRECTION
  2006                                            PIC X.
  2007                 88  CF-MINUS                   VALUE '-'.
  2008                 88  CF-PLUS                    VALUE '+'.
  2009             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2010             20  CF-MORT-JOINT-CODE         PIC X.
  2011                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2012             20  CF-MORT-PC-Q               PIC X.
  2013                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2014             20  CF-MORT-TABLE-CODE         PIC X(4).
  2015             20  CF-MORT-COMMENTS           PIC X(15).
  2016             20  FILLER                     PIC X(14).
  2017
  2018         16  FILLER                         PIC X(251).
  2019
  2020
  2021****************************************************************
  2022*             BUSSINESS TYPE MASTER RECORD                     *
  2023****************************************************************
  2024
  2025     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2026* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2027* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2028* AND RECORD 05 IS TYPES 81-99
  2029         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2030             20  CF-BUSINESS-TITLE          PIC  X(19).
  2031             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2032                                            PIC S9V9(4) COMP-3.
  2033             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2034             20  FILLER                     PIC  X.
  2035         16  FILLER                         PIC  X(248).
  2036
  2037
  2038****************************************************************
  2039*             TERMINAL MASTER RECORD                           *
  2040****************************************************************
  2041
  2042     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2043
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  37
* SOCK00.cbl
  2044         16  CF-COMPANY-TERMINALS.
  2045             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2046                                  PIC X(4).
  2047         16  FILLER               PIC X(248).
  2048
  2049
  2050****************************************************************
  2051*             LIFE EDIT MASTER RECORD                          *
  2052****************************************************************
  2053
  2054     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2055         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2056             20  CF-LIFE-CODE-IN            PIC XX.
  2057             20  CF-LIFE-CODE-OUT           PIC XX.
  2058         16  FILLER                         PIC X(248).
  2059
  2060
  2061****************************************************************
  2062*             AH EDIT MASTER RECORD                            *
  2063****************************************************************
  2064
  2065     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2066         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2067             20  CF-AH-CODE-IN              PIC XXX.
  2068             20  CF-AH-CODE-OUT             PIC XX.
  2069         16  FILLER                         PIC X(248).
  2070
  2071
  2072****************************************************************
  2073*             CREDIBILITY TABLES                               *
  2074****************************************************************
  2075
  2076     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2077         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2078                             INDEXED BY CF-CRDB-NDX.
  2079             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2080             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2081             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2082         16  FILLER                         PIC  X(332).
  2083
  2084
  2085****************************************************************
  2086*             REPORT CUSTOMIZATION RECORD                      *
  2087****************************************************************
  2088
  2089     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2090         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2091             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2092             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2093             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2094**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2095****       A T-TRANSFER.                                   ****
  2096             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2097
  2098         16  FILLER                         PIC XX.
  2099
  2100         16  CF-CARRIER-CNTL-OPT.
  2101             20  CF-CARRIER-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  38
* SOCK00.cbl
  2102                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2103                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2104             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2105                                            PIC X.
  2106         16  CF-GROUP-CNTL-OPT.
  2107             20  CF-GROUP-OPT-SEQ           PIC 9.
  2108                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2109                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2110             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2111                                            PIC X(6).
  2112         16  CF-STATE-CNTL-OPT.
  2113             20  CF-STATE-OPT-SEQ           PIC 9.
  2114                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2115                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2116             20  CF-STATE-SELECT OCCURS 3 TIMES
  2117                                            PIC XX.
  2118         16  CF-ACCOUNT-CNTL-OPT.
  2119             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2120                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2121                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2122             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2123                                            PIC X(10).
  2124         16  CF-BUS-TYP-CNTL-OPT.
  2125             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2126                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2127                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2128             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2129                                            PIC XX.
  2130         16  CF-LF-TYP-CNTL-OPT.
  2131             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2132                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2133                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2134             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2135                                            PIC XX.
  2136         16  CF-AH-TYP-CNTL-OPT.
  2137             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2138                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2139                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2140             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2141                                            PIC XX.
  2142         16  CF-REPTCD1-CNTL-OPT.
  2143             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2144                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2145                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2146             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2147                                            PIC X(10).
  2148         16  CF-REPTCD2-CNTL-OPT.
  2149             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2150                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2151                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2152             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2153                                            PIC X(10).
  2154         16  CF-USER1-CNTL-OPT.
  2155             20  CF-USER1-OPT-SEQ           PIC 9.
  2156                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2157                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2158             20  CF-USER1-SELECT OCCURS 3 TIMES
  2159                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  39
* SOCK00.cbl
  2160         16  CF-USER2-CNTL-OPT.
  2161             20  CF-USER2-OPT-SEQ           PIC 9.
  2162                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2163                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2164             20  CF-USER2-SELECT OCCURS 3 TIMES
  2165                                            PIC X(10).
  2166         16  CF-USER3-CNTL-OPT.
  2167             20  CF-USER3-OPT-SEQ           PIC 9.
  2168                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2169                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2170             20  CF-USER3-SELECT OCCURS 3 TIMES
  2171                                            PIC X(10).
  2172         16  CF-USER4-CNTL-OPT.
  2173             20  CF-USER4-OPT-SEQ           PIC 9.
  2174                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2175                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2176             20  CF-USER4-SELECT OCCURS 3 TIMES
  2177                                            PIC X(10).
  2178         16  CF-USER5-CNTL-OPT.
  2179             20  CF-USER5-OPT-SEQ           PIC 9.
  2180                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2181                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2182             20  CF-USER5-SELECT OCCURS 3 TIMES
  2183                                            PIC X(10).
  2184         16  CF-REINS-CNTL-OPT.
  2185             20  CF-REINS-OPT-SEQ           PIC 9.
  2186                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2187                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2188             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2189                 24  CF-REINS-PRIME         PIC XXX.
  2190                 24  CF-REINS-SUB           PIC XXX.
  2191
  2192         16  CF-AGENT-CNTL-OPT.
  2193             20  CF-AGENT-OPT-SEQ           PIC 9.
  2194                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2195                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2196             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2197                                            PIC X(10).
  2198
  2199         16  FILLER                         PIC X(43).
  2200
  2201         16  CF-LOSS-RATIO-SELECT.
  2202             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2203             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2204         16  CF-ENTRY-DATE-SELECT.
  2205             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2206             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2207         16  CF-EFFECTIVE-DATE-SELECT.
  2208             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2209             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2210
  2211         16  CF-EXCEPTION-LIST-IND          PIC X.
  2212             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2213
  2214         16  FILLER                         PIC X(318).
  2215
  2216****************************************************************
  2217*                  EXCEPTION REPORTING RECORD                  *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  40
* SOCK00.cbl
  2218****************************************************************
  2219
  2220     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2221         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2222             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2223
  2224         16  CF-COMBINED-LIFE-AH-OPT.
  2225             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2226             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2227             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2228             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2229
  2230         16  CF-LIFE-OPT.
  2231             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2232             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2233             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2234             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2235             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2236             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2237             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2238             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2239             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2240             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2241
  2242         16  CF-AH-OPT.
  2243             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2244             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2245             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2246             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2247             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2248             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2249             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2250             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2251             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2252             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2253
  2254         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2255             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2256             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2257             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2258
  2259         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2260
  2261         16  FILLER                         PIC X(673).
  2262
  2263
  2264****************************************************************
  2265*             MORTGAGE SYSTEM PLAN RECORD                      *
  2266****************************************************************
  2267
  2268     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2269         16  CF-PLAN-TYPE                   PIC X.
  2270             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2271             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2272             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2273         16  CF-PLAN-ABBREV                 PIC XXX.
  2274         16  CF-PLAN-DESCRIPT               PIC X(10).
  2275         16  CF-PLAN-NOTES                  PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  41
* SOCK00.cbl
  2276         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2277         16  CF-PLAN-UNDERWRITING.
  2278             20  CF-PLAN-TERM-DATA.
  2279                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2280                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2281             20  CF-PLAN-AGE-DATA.
  2282                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2283                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2284                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2285             20  CF-PLAN-BENEFIT-DATA.
  2286                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2287                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2288                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2289                                            PIC S9(7)V99  COMP-3.
  2290         16  CF-PLAN-POLICY-FORMS.
  2291             20  CF-POLICY-FORM             PIC X(12).
  2292             20  CF-MASTER-APPLICATION      PIC X(12).
  2293             20  CF-MASTER-POLICY           PIC X(12).
  2294         16  CF-PLAN-RATING.
  2295             20  CF-RATE-CODE               PIC X(5).
  2296             20  CF-SEX-RATING              PIC X.
  2297                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2298                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2299             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2300             20  CF-SUB-STD-TYPE            PIC X.
  2301                 88  CF-PCT-OF-PREM            VALUE '1'.
  2302                 88  CF-PCT-OF-BENE            VALUE '2'.
  2303         16  CF-PLAN-PREM-TOLERANCES.
  2304             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2305             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2306         16  CF-PLAN-PYMT-TOLERANCES.
  2307             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2308             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2309         16  CF-PLAN-MISC-DATA.
  2310             20  FILLER                     PIC X.
  2311             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2312             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2313         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2314         16  CF-PLAN-IND-GRP                PIC X.
  2315             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2316                                                     '1'.
  2317             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2318                                                     '2'.
  2319         16  CF-MIB-SEARCH-SW               PIC X.
  2320             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2321             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2322             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2323             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2324         16  CF-ALPHA-SEARCH-SW             PIC X.
  2325             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2326             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2327             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2328             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2329             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2330             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2331             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2332             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2333             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  42
* SOCK00.cbl
  2334             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2335                                                     'A' 'B' 'C'
  2336                                                     'X' 'Y' 'Z'.
  2337         16  CF-EFF-DT-RULE-SW              PIC X.
  2338             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2339             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2340             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2341             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2342             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2343         16  FILLER                         PIC X(4).
  2344         16  CF-HEALTH-QUESTIONS            PIC X.
  2345             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2346         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2347         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2348         16  CF-PLAN-SNGL-JNT               PIC X.
  2349             88  CF-COMBINED-PLAN              VALUE 'C'.
  2350             88  CF-JNT-PLAN                   VALUE 'J'.
  2351             88  CF-SNGL-PLAN                  VALUE 'S'.
  2352         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2353         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2354         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2355         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2356         16  CF-RERATE-CNTL                 PIC  X.
  2357             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2358             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2359             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2360             88  CF-AUTO-RECALC                 VALUE '4'.
  2361         16  CF-BENEFIT-TYPE                PIC  X.
  2362             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2363             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2364         16  CF-POLICY-FEE                  PIC S999V99
  2365                                                    COMP-3.
  2366         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2367         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2368         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2369         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2370         16  FILLER                         PIC  X(32).
  2371         16  CF-TERMINATION-FORM            PIC  X(04).
  2372         16  FILLER                         PIC  X(08).
  2373         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2374                                                       COMP-3.
  2375         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2376         16  CF-ISSUE-LETTER                PIC  X(4).
  2377         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2378         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2379             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2380             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2381         16  CF-MP-REFUND-CALC              PIC X.
  2382             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2383             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2384             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2385             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2386             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2387             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2388             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2389             88  CF-MP-REFD-MEAN                VALUE '8'.
  2390         16  CF-ALT-RATE-CODE               PIC  X(5).
  2391
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  43
* SOCK00.cbl
  2392
  2393         16  FILLER                         PIC X(498).
  2394****************************************************************
  2395*             MORTGAGE COMPANY MASTER RECORD                   *
  2396****************************************************************
  2397
  2398     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2399         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2400         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2401             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2402             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2403             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2404             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2405             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2406
  2407         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2408         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2409         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2410         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2411         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2412
  2413         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2414             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2415         16  CF-MP-RECON-USE-IND            PIC X(1).
  2416             88  CF-MP-USE-RECON             VALUE 'Y'.
  2417         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2418             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2419         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2420             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2421             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2422         16  FILLER                         PIC X(1).
  2423         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2424             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2425         16  CF-MORTG-MIB-VERSION           PIC X.
  2426             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2427             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2428             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2429         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2430             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2431                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2432             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2433                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2434             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2435                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2436             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2437                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2438             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2439                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2440             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2441                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2442         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2443         16  FILLER                         PIC X(7).
  2444         16  CF-MORTG-DESTINATION-SYMBOL.
  2445             20  CF-MORTG-MIB-COMM          PIC X(5).
  2446             20  CF-MORTG-MIB-TERM          PIC X(5).
  2447         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2448             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2449         16  FILLER                         PIC X(03).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  44
* SOCK00.cbl
  2450         16  CF-MP-CHECK-NO-CONTROL.
  2451             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2452                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2453                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2454                                                ' ' LOW-VALUES.
  2455                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2456                                               VALUE '3'.
  2457         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2458         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2459         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2460             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2461                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2462             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2463                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2464             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2465                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2466             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2467                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2468             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2469                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2470             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2471                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2472         16  CF-MORTG-BILLING-AREA.
  2473             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2474                                            PIC X.
  2475         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2476         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2477         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2478         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2479             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2480             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2481         16  FILLER                         PIC X.
  2482         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2483             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2484             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2485         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2486         16  FILLER                         PIC X(8).
  2487         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2488         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2489         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2490         16  CF-ACH-COMPANY-ID.
  2491             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2492                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2493                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2494                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2495             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2496         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2497             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2498         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2499             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2500             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2501         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2502         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2503         16  FILLER                         PIC X(536).
  2504
  2505****************************************************************
  2506*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2507****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  45
* SOCK00.cbl
  2508
  2509     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2510         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2511             20  CF-FEMALE-HEIGHT.
  2512                 24  CF-FEMALE-FT           PIC 99.
  2513                 24  CF-FEMALE-IN           PIC 99.
  2514             20  CF-FEMALE-MIN-WT           PIC 999.
  2515             20  CF-FEMALE-MAX-WT           PIC 999.
  2516         16  FILLER                         PIC X(428).
  2517
  2518     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2519         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2520             20  CF-MALE-HEIGHT.
  2521                 24  CF-MALE-FT             PIC 99.
  2522                 24  CF-MALE-IN             PIC 99.
  2523             20  CF-MALE-MIN-WT             PIC 999.
  2524             20  CF-MALE-MAX-WT             PIC 999.
  2525         16  FILLER                         PIC X(428).
  2526******************************************************************
  2527*             AUTOMATIC ACTIVITY RECORD                          *
  2528******************************************************************
  2529     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2530         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2531             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2532             20  CF-SYS-LETTER-ID           PIC X(04).
  2533             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2534             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2535             20  CF-SYS-RESET-SW            PIC X(01).
  2536             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2537             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2538
  2539         16  FILLER                         PIC X(50).
  2540
  2541         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2542             20  CF-USER-ACTIVE-SW          PIC X(01).
  2543             20  CF-USER-LETTER-ID          PIC X(04).
  2544             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2545             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2546             20  CF-USER-RESET-SW           PIC X(01).
  2547             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2548             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2549             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2550
  2551         16  FILLER                         PIC X(246).
  2552*                                 COPY ERCCTBL.
  2553******************************************************************
  2554*                                                                *
  2555*                                                                *
  2556*                            ERCCTBL                             *
  2557*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2558*                            VMOD=2.003
  2559*                                                                *
  2560*   ONLINE CREDIT SYSTEM                                         *
  2561*                                                                *
  2562*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2563*                                                                *
  2564*   FILE TYPE = VSAM,KSDS                                        *
  2565*   RECORD SIZE = 200   RECFORM = FIXED                          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  46
* SOCK00.cbl
  2566*                                                                *
  2567*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2568*       ALTERNATE PATH = NONE                                    *
  2569*                                                                *
  2570*   LOG = NO                                                     *
  2571*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2572*                                                                *
  2573*                                                                *
  2574******************************************************************
  2575
  2576 01  COMM-TABLE-RECORD.
  2577     12  CT-RECORD-ID                      PIC XX.
  2578         88  VALID-CT-ID                      VALUE 'CT'.
  2579
  2580     12  CT-CONTROL-PRIMARY.
  2581         16  CT-COMPANY-CD                 PIC X.
  2582         16  CT-TABLE                      PIC XXX.
  2583         16  CT-CNTRL-2.
  2584             20  CT-BEN-TYPE               PIC X.
  2585             20  CT-BEN-CODE               PIC XX.
  2586
  2587     12  CT-MAINT-INFORMATION.
  2588         16  CT-LAST-MAINT-DT              PIC XX.
  2589         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2590         16  CT-LAST-MAINT-USER            PIC X(4).
  2591         16  FILLER                        PIC X(31).
  2592
  2593     12  CT-LIMITS.
  2594         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2595
  2596         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2597
  2598         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2599
  2600     12  CT-RATES.
  2601         16  CT-RTX          OCCURS 27 TIMES.
  2602             20  CT-RT                     PIC SV9(5)     COMP-3.
  2603             20  CT-RT-R   REDEFINES
  2604                 CT-RT                     PIC XXX.
  2605
  2606     12  FILLER                            PIC  X(42).
  2607
  2608******************************************************************
  2609*                                 COPY ELCDATE.
  2610******************************************************************
  2611*                                                                *
  2612*                                                                *
  2613*                            ELCDATE.                            *
  2614*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2615*                            VMOD=2.003
  2616*                                                                *
  2617*                                                                *
  2618*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2619*                 LENGTH = 200                                   *
  2620******************************************************************
  2621
  2622 01  DATE-CONVERSION-DATA.
  2623     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  47
* SOCK00.cbl
  2624     12  DC-OPTION-CODE                PIC X.
  2625         88  BIN-TO-GREG                VALUE ' '.
  2626         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2627         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2628         88  YMD-GREG-TO-BIN            VALUE '3'.
  2629         88  MDY-GREG-TO-BIN            VALUE '4'.
  2630         88  JULIAN-TO-BIN              VALUE '5'.
  2631         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2632         88  FIND-CENTURY               VALUE '7'.
  2633         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2634         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2635         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2636         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2637         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2638         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2639         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2640         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2641         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2642         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2643         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2644         88  BIN-3-TO-GREG              VALUE 'I'.
  2645         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2646         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2647         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2648         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2649         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2650         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2651         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2652         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2653         88  THREE-CHARACTER-BIN
  2654                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2655         88  GREGORIAN-TO-BIN
  2656                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2657         88  BIN-TO-GREGORIAN
  2658                  VALUES ' ' '1' 'I' '8' 'G'.
  2659         88  JULIAN-TO-BINARY
  2660                  VALUES '5' 'C' 'E' 'F'.
  2661     12  DC-ERROR-CODE                 PIC X.
  2662         88  NO-CONVERSION-ERROR        VALUE ' '.
  2663         88  DATE-CONVERSION-ERROR
  2664                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2665         88  DATE-IS-ZERO               VALUE '1'.
  2666         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2667         88  DATE-IS-INVALID            VALUE '3'.
  2668         88  DATE1-GREATER-DATE2        VALUE '4'.
  2669         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2670         88  DATE-INVALID-OPTION        VALUE '9'.
  2671         88  INVALID-CENTURY            VALUE 'A'.
  2672         88  ONLY-CENTURY               VALUE 'B'.
  2673         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2674         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2675     12  DC-END-OF-MONTH               PIC X.
  2676         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2677     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2678         88  USE-NORMAL-PROCESS         VALUE ' '.
  2679         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2680         88  ADJUST-UP-100-YRS          VALUE '2'.
  2681     12  FILLER                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  48
* SOCK00.cbl
  2682     12  DC-CONVERSION-DATES.
  2683         16  DC-BIN-DATE-1             PIC XX.
  2684         16  DC-BIN-DATE-2             PIC XX.
  2685         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2686         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2687                       DC-GREG-DATE-1-EDIT.
  2688             20  DC-EDIT1-MONTH        PIC 99.
  2689             20  SLASH1-1              PIC X.
  2690             20  DC-EDIT1-DAY          PIC 99.
  2691             20  SLASH1-2              PIC X.
  2692             20  DC-EDIT1-YEAR         PIC 99.
  2693         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2694         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2695                     DC-GREG-DATE-2-EDIT.
  2696             20  DC-EDIT2-MONTH        PIC 99.
  2697             20  SLASH2-1              PIC X.
  2698             20  DC-EDIT2-DAY          PIC 99.
  2699             20  SLASH2-2              PIC X.
  2700             20  DC-EDIT2-YEAR         PIC 99.
  2701         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2702         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2703                     DC-GREG-DATE-1-YMD.
  2704             20  DC-YMD-YEAR           PIC 99.
  2705             20  DC-YMD-MONTH          PIC 99.
  2706             20  DC-YMD-DAY            PIC 99.
  2707         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2708         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2709                      DC-GREG-DATE-1-MDY.
  2710             20  DC-MDY-MONTH          PIC 99.
  2711             20  DC-MDY-DAY            PIC 99.
  2712             20  DC-MDY-YEAR           PIC 99.
  2713         16  DC-GREG-DATE-1-ALPHA.
  2714             20  DC-ALPHA-MONTH        PIC X(10).
  2715             20  DC-ALPHA-DAY          PIC 99.
  2716             20  FILLER                PIC XX.
  2717             20  DC-ALPHA-CENTURY.
  2718                 24 DC-ALPHA-CEN-N     PIC 99.
  2719             20  DC-ALPHA-YEAR         PIC 99.
  2720         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2721         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2722         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2723         16  DC-JULIAN-DATE            PIC 9(05).
  2724         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2725                                       PIC 9(05).
  2726         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2727             20  DC-JULIAN-YEAR        PIC 99.
  2728             20  DC-JULIAN-DAYS        PIC 999.
  2729         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2730         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2731         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2732     12  DATE-CONVERSION-VARIBLES.
  2733         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2734         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2735             20  FILLER                PIC 9(3).
  2736             20  HOLD-CEN-1-CCYY.
  2737                 24  HOLD-CEN-1-CC     PIC 99.
  2738                 24  HOLD-CEN-1-YY     PIC 99.
  2739             20  HOLD-CEN-1-MO         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  49
* SOCK00.cbl
  2740             20  HOLD-CEN-1-DA         PIC 99.
  2741         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2742             20  HOLD-CEN-1-R-MO       PIC 99.
  2743             20  HOLD-CEN-1-R-DA       PIC 99.
  2744             20  HOLD-CEN-1-R-CCYY.
  2745                 24  HOLD-CEN-1-R-CC   PIC 99.
  2746                 24  HOLD-CEN-1-R-YY   PIC 99.
  2747             20  FILLER                PIC 9(3).
  2748         16  HOLD-CENTURY-1-X.
  2749             20  FILLER                PIC X(3)  VALUE SPACES.
  2750             20  HOLD-CEN-1-X-CCYY.
  2751                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2752                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2753             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2754             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2755         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2756             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2757             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2758             20  HOLD-CEN-1-R-X-CCYY.
  2759                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2760                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2761             20  FILLER                PIC XXX.
  2762         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2763         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2764         16  DC-JULIAN-DATE-1          PIC 9(07).
  2765         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2766             20  DC-JULIAN-1-CCYY.
  2767                 24  DC-JULIAN-1-CC    PIC 99.
  2768                 24  DC-JULIAN-1-YR    PIC 99.
  2769             20  DC-JULIAN-DA-1        PIC 999.
  2770         16  DC-JULIAN-DATE-2          PIC 9(07).
  2771         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2772             20  DC-JULIAN-2-CCYY.
  2773                 24  DC-JULIAN-2-CC    PIC 99.
  2774                 24  DC-JULIAN-2-YR    PIC 99.
  2775             20  DC-JULIAN-DA-2        PIC 999.
  2776         16  DC-GREG-DATE-A-EDIT.
  2777             20  DC-EDITA-MONTH        PIC 99.
  2778             20  SLASHA-1              PIC X VALUE '/'.
  2779             20  DC-EDITA-DAY          PIC 99.
  2780             20  SLASHA-2              PIC X VALUE '/'.
  2781             20  DC-EDITA-CCYY.
  2782                 24  DC-EDITA-CENT     PIC 99.
  2783                 24  DC-EDITA-YEAR     PIC 99.
  2784         16  DC-GREG-DATE-B-EDIT.
  2785             20  DC-EDITB-MONTH        PIC 99.
  2786             20  SLASHB-1              PIC X VALUE '/'.
  2787             20  DC-EDITB-DAY          PIC 99.
  2788             20  SLASHB-2              PIC X VALUE '/'.
  2789             20  DC-EDITB-CCYY.
  2790                 24  DC-EDITB-CENT     PIC 99.
  2791                 24  DC-EDITB-YEAR     PIC 99.
  2792         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2793         16  DC-GREG-DATE-CYMD-R REDEFINES
  2794                              DC-GREG-DATE-CYMD.
  2795             20  DC-CYMD-CEN           PIC 99.
  2796             20  DC-CYMD-YEAR          PIC 99.
  2797             20  DC-CYMD-MONTH         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  50
* SOCK00.cbl
  2798             20  DC-CYMD-DAY           PIC 99.
  2799         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2800         16  DC-GREG-DATE-MDCY-R REDEFINES
  2801                              DC-GREG-DATE-MDCY.
  2802             20  DC-MDCY-MONTH         PIC 99.
  2803             20  DC-MDCY-DAY           PIC 99.
  2804             20  DC-MDCY-CEN           PIC 99.
  2805             20  DC-MDCY-YEAR          PIC 99.
  2806    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2807        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2808    12  DC-EL310-DATE                  PIC X(21).
  2809    12  FILLER                         PIC X(28).
  2810*                                 COPY ELCCALC.
  2811******************************************************************
  2812*                                                                *
  2813*                           ELCCALC.                            *
  2814*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2815*                            VMOD=2.025                          *
  2816*                                                                *
  2817*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2818*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2819*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2820*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2821*                                                                *
  2822*  PASSED TO ELRTRM                                              *
  2823*  -----------------                                             *
  2824*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2825*  ORIGINAL TERM                                                 *
  2826*  BEGINNING DATE                                                *
  2827*  ENDING DATE                                                   *
  2828*  COMPANY I.D.                                                  *
  2829*  ACCOUNT MASTER USER FIELD                                     *
  2830*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2831*  FREE LOOK DAYS                                                *
  2832*                                                                *
  2833*  RETURNED FROM ELRTRM                                          *
  2834*  ---------------------                                         *
  2835*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2836*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2837*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2838*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2839*----------------------------------------------------------------*
  2840*  PASSED TO ELRAMT                                              *
  2841*  ----------------                                              *
  2842*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2843*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2844*  ORIGINAL AMOUNT                                               *
  2845*  ALTERNATE BENEFIT (BALLON)                                    *
  2846*  A.P.R. - NET PAY ONLY                                         *
  2847*  METHOD
  2848*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2849*  COMPANY I.D.                                                  *
  2850*  BENEFIT TYPE                                                  *
  2851*                                                                *
  2852*  RETURNED FROM ELRAMT                                          *
  2853*  --------------------                                          *
  2854*  REMAINING AMOUNT 1 - CURRENT                                  *
  2855*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  51
* SOCK00.cbl
  2856*  REMAINING AMOUNT FACTOR
  2857*----------------------------------------------------------------*
  2858*  PASSED TO ELRESV                                              *
  2859*  -----------------                                             *
  2860*  CERTIFICATE EFFECTIVE DATE                                    *
  2861*  VALUATION DATE                                                *
  2862*  PAID THRU DATE                                                *
  2863*  BENEFIT                                                       *
  2864*  INCURRED DATE                                                 *
  2865*  REPORTED DATE                                                 *
  2866*  ISSUE AGE                                                     *
  2867*  TERM                                                          *
  2868*  CDT PERCENT                                                   *
  2869*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2870* *CLAIM TYPE (LIFE, A/H)                                        *
  2871* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2872* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2873*                                                                *
  2874*  RETURNED FROM ELRESV                                          *
  2875*  --------------------                                          *
  2876*  CDT TABLE USED                                                *
  2877*  CDT FACTOR USED                                               *
  2878*  PAY TO CURRENT RESERVE                                        *
  2879*  I.B.N.R. - A/H ONLY                                           *
  2880*  FUTURE (ACCRUED) AH ONLY                                      *
  2881*----------------------------------------------------------------*
  2882*  PASSED TO ELRATE                                              *
  2883*  ----------------                                              *
  2884*  CERT ISSUE DATE                                               *
  2885*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2886*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2887*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2888*  STATE CODE (CLIENT DEFINED)                                   *
  2889*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2890*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2891*  DEVIATION CODE                                                *
  2892*  ISSUE AGE                                                     *
  2893*  ORIGINAL BENEFIT AMOUNT                                       *
  2894*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2895*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2896*  BENEFIT KIND (LIFE OR A/H)                                    *
  2897*  A.P.R.                                                        *
  2898*  METHOD
  2899*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2900*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2901*  COMPANY I.D. (3 CHARACTER)                                    *
  2902*  BENEFIT CODE                                                  *
  2903*  BENEFIT OVERRIDE CODE                                         *
  2904*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2905*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2906*  JOINT INDICATOR (CSL ONLY)                                    *
  2907*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2908*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2909*                                                                *
  2910*  RETURNED FROM ELRATE                                          *
  2911*  --------------------                                          *
  2912*  CALCULATED PREMIUM                                            *
  2913*  PREMIUM RATE                                                  *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  52
* SOCK00.cbl
  2914*  MORTALITY CODE                                                *
  2915*  MAX ATTAINED AGE                                              *
  2916*  MAX AGE                                                       *
  2917*  MAX TERM                                                      *
  2918*  MAX MONTHLY BENEFIT                                           *
  2919*  MAX TOTAL BENIFIT                                             *
  2920*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2921*----------------------------------------------------------------*
  2922*  PASSED TO ELRFND                                              *
  2923*  ----------------                                              *
  2924*  CERT ISSUE DATE                                               *
  2925*  REFUND DATE                                                   *
  2926*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2927*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2928*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2929*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2930*  STATE CODE (CLIENT DEFINED)                                   *
  2931*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2932*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2933*  DEVIATION CODE                                                *
  2934*  ISSUE AGE                                                     *
  2935*  ORIGINAL BENEFIT AMOUNT                                       *
  2936*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2937*  PROCESS TYPE (CANCEL)                                         *
  2938*  BENEFIT KIND (LIFE OR A/H)                                    *
  2939*  A.P.R.                                                        *
  2940*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2941*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2942*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2943*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2944*  COMPANY I.D. (3 CHARACTER)                                    *
  2945*  BENEFIT CODE                                                  *
  2946*  BENEFIT OVERRIDE CODE                                         *
  2947*                                                                *
  2948*  RETURNED FROM ELRFND                                          *
  2949*  --------------------                                          *
  2950*  CALCULATED REFUND                                             *
  2951*----------------------------------------------------------------*
  2952*  PASSED TO ELEARN                                              *
  2953*  ----------------                                              *
  2954*  CERT ISSUE DATE                                               *
  2955*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2956*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2957*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2958*  STATE CODE (CLIENT DEFINED)                                   *
  2959*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2960*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2961*  DEVIATION CODE                                                *
  2962*  ISSUE AGE                                                     *
  2963*  ORIGINAL BENEFIT AMOUNT                                       *
  2964*  BENEFIT KIND (LIFE OR A/H)                                    *
  2965*  A.P.R.                                                        *
  2966*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2967*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2968*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2969*  COMPANY I.D. (3 CHARACTER)                                    *
  2970*  BENEFIT CODE                                                  *
  2971*  BENEFIT OVERRIDE CODE                                         *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  53
* SOCK00.cbl
  2972*                                                                *
  2973*  RETURNED FROM ELEARN                                          *
  2974*  --------------------                                          *
  2975*  INDICATED  EARNINGS                                           *
  2976*----------------------------------------------------------------*
  2977*                 LENGTH = 450                                   *
  2978*                                                                *
  2979******************************************************************
  2980******************************************************************
  2981*                   C H A N G E   L O G
  2982*
  2983* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2984*-----------------------------------------------------------------
  2985*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2986* EFFECTIVE    NUMBER
  2987*-----------------------------------------------------------------
  2988* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2989* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2990* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2991* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2992* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2993* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2994* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2995* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2996* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2997* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2998* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2999******************************************************************
  3000
  3001 01  CALCULATION-PASS-AREA.
  3002     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3003                                     COMP.
  3004
  3005     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3006       88  NO-CP-ERROR                             VALUE ZERO.
  3007       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3008                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3009       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3010       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3011       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3012       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3013       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3014       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3015       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3016       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3017       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3018       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3019       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3020       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3021       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3022       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3023       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3024       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3025       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3026
  3027     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3028       88  NO-CP-ERROR-2                           VALUE ZERO.
  3029***********************  INPUT AREAS ****************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  54
* SOCK00.cbl
  3030
  3031     12  CP-CALCULATION-AREA.
  3032         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3033         16  CP-CERT-EFF-DT        PIC XX.
  3034         16  CP-VALUATION-DT       PIC XX.
  3035         16  CP-PAID-THRU-DT       PIC XX.
  3036         16  CP-BENEFIT-TYPE       PIC X.
  3037           88  CP-AH                               VALUE 'A' 'D'
  3038                                                   'I' 'U'.
  3039           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3040           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3041         16  CP-INCURRED-DT        PIC XX.
  3042         16  CP-REPORTED-DT        PIC XX.
  3043         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3044         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3045         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3046                                     COMP-3.
  3047         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3048                                     COMP-3.
  3049         16  CP-CDT-METHOD         PIC X.
  3050           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3051           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3052           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3053         16  CP-CLAIM-TYPE         PIC X.
  3054           88  CP-AH-CLAIM                         VALUE 'A'.
  3055           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3056         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3057                                     COMP-3.
  3058         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3059                                     COMP-3.
  3060         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3061                                     COMP-3.
  3062         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3063                                     COMP-3.
  3064         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3065                                     COMP-3.
  3066         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3067                                     COMP-3.
  3068         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3069                                     COMP-3.
  3070         16  CP-REM-TERM-METHOD    PIC X.
  3071           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3072           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3073           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3074           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3075           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3076           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3077           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3078         16  CP-EARNING-METHOD     PIC X.
  3079           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3080           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3081           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3082           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3083           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3084           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3085           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3086           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3087           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  55
* SOCK00.cbl
  3088           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3089           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3090           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3091           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3092           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3093         16  CP-PROCESS-TYPE       PIC X.
  3094           88  CP-CLAIM                            VALUE '1'.
  3095           88  CP-CANCEL                           VALUE '2'.
  3096           88  CP-ISSUE                            VALUE '3'.
  3097         16  CP-SPECIAL-CALC-CD    PIC X.
  3098           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3099           88  CP-1-MTH-INTEREST               VALUE ' '.
  3100           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3101           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3102           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3103           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3104           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3105           88  CP-FARM-PLAN                    VALUE 'F'.
  3106           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3107           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3108           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3109           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3110           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3111           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3112           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3113           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3114           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3115           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3116                                                     'W' 'X'.
  3117           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3118           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3119           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3120           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3121           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3122           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3123           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3124           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3125           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3126           88  CP-CSL-METH-1                   VALUE '5'.
  3127           88  CP-CSL-METH-2                   VALUE '6'.
  3128           88  CP-CSL-METH-3                   VALUE '7'.
  3129           88  CP-CSL-METH-4                   VALUE '8'.
  3130
  3131         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3132                                     COMP-3.
  3133         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3134         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3135         16  CP-STATE              PIC XX          VALUE SPACE.
  3136         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3137         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3138           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3139               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3140         16  CP-R78-OPTION         PIC X.
  3141           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3142           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3143
  3144         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3145         16  CP-IBNR-RESERVE-SW    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  56
* SOCK00.cbl
  3146         16  CP-CLAIM-STATUS       PIC X.
  3147         16  CP-RATE-FILE          PIC X.
  3148         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3149                                     COMP-3.
  3150
  3151         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3152         16  CP-AH-OVERRIDE-CODE   PIC X.
  3153
  3154         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3155                                     COMP-3.
  3156         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3157                                   PIC S9(5)V99 COMP-3.
  3158         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3159                                     COMP-3.
  3160         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3161                                     COMP-3.
  3162         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3163                                     COMP-3.
  3164         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3165                                  PIC S9(7)V99 COMP-3.
  3166
  3167         16  CP-PAID-FROM-DATE     PIC X(02).
  3168         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3169         16  CP-EXT-DAYS-CALC      PIC X.
  3170           88  CP-EXT-NO-CHG                   VALUE ' '.
  3171           88  CP-EXT-CHG-LF                   VALUE '1'.
  3172           88  CP-EXT-CHG-AH                   VALUE '2'.
  3173           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3174         16  CP-DOMICILE-STATE     PIC XX.
  3175         16  CP-CARRIER            PIC X.
  3176         16  CP-REIN-FLAG          PIC X.
  3177         16  CP-REM-TRM-CALC-OPTION PIC X.
  3178           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3179                      '2' '3' '4' '5'.
  3180           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3181           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3182           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3183           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3184           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3185           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3186           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3187           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3188         16  CP-SIG-SWITCH         PIC X.
  3189         16  CP-RATING-METHOD      PIC X.
  3190           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3191           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3192           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3193           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3194           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3195           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3196           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3197           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3198           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3199         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3200                                     COMP-3.
  3201         16  CP-BEN-CATEGORY       PIC X.
  3202         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3203         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  57
* SOCK00.cbl
  3204                                   PIC S99V9(5) COMP-3.
  3205         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3206         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3207                                   PIC S99V9(5) COMP-3.
  3208         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3209         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3210         16  CP-EXPIRE-DT          PIC XX.
  3211         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3212         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3213         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3214         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3215         16  CP-DDF-SPEC-CALC      PIC X.
  3216             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3217             88  CP-CALC-CLP              VALUE 'C'.
  3218         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3219         16  CP-CANCEL-REASON      PIC X.
  3220         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3221         16  CP-PMT-MODE           PIC X.
  3222         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3223         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3224         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3225         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3226         16  FILLER                PIC X.
  3227
  3228***************    OUTPUT FROM ELRESV   ************************
  3229
  3230         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3231
  3232         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3233                                     COMP-3.
  3234         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3235                                     COMP-3.
  3236         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3237                                     COMP-3.
  3238         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3239                                     COMP-3.
  3240         16  FILLER                PIC X(09).
  3241***************    OUTPUT FROM ELRTRM   *************************
  3242
  3243         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3244                                     COMP-3.
  3245         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3246                                     COMP-3.
  3247         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3248                                     COMP-3.
  3249         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3250                                     COMP-3.
  3251         16  FILLER                PIC X(12).
  3252
  3253***************    OUTPUT FROM ELRAMT   *************************
  3254
  3255         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3256                                     COMP-3.
  3257         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3258                                     COMP-3.
  3259         16  FILLER                PIC X(12).
  3260
  3261***************    OUTPUT FROM ELRATE   *************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  58
* SOCK00.cbl
  3262
  3263         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3264                                     COMP-3.
  3265         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3266                                     COMP-3.
  3267         16  CP-MORTALITY-CODE     PIC X(4).
  3268         16  CP-RATE-EDIT-FLAG     PIC X.
  3269             88  CP-RATES-NEED-APR                  VALUE '1'.
  3270         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3271                                     COMP-3.
  3272         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3273         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3274         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3275                                   PIC S9(7)V99 COMP-3.
  3276         16  FILLER                PIC X(07).
  3277
  3278***************    OUTPUT FROM ELRFND   *************************
  3279
  3280         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3281                                     COMP-3.
  3282         16  CP-REFUND-TYPE-USED   PIC X.
  3283           88  CP-R-AS-R78                         VALUE '1'.
  3284           88  CP-R-AS-PRORATA                     VALUE '2'.
  3285           88  CP-R-AS-CALIF                       VALUE '3'.
  3286           88  CP-R-AS-TEXAS                       VALUE '4'.
  3287           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3288           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3289           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3290           88  CP-R-AS-MEAN                        VALUE '8'.
  3291           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3292           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3293           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3294           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3295           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3296           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3297         16  FILLER                PIC X(12).
  3298
  3299***************    OUTPUT FROM ELEARN   *************************
  3300
  3301         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3302                                     COMP-3.
  3303         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3304                                     COMP-3.
  3305         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3306                                     COMP-3.
  3307         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3308                                     COMP-3.
  3309         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3310                                     COMP-3.
  3311         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3312                                     COMP-3.
  3313         16  CP-EARNING-TYPE-USED  PIC X.
  3314           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3315           88  CP-E-AS-R78                         VALUE '1'.
  3316           88  CP-E-AS-PRORATA                     VALUE '2'.
  3317           88  CP-E-AS-TEXAS                       VALUE '4'.
  3318           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3319           88  CP-E-AS-NET-PAY                     VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  59
* SOCK00.cbl
  3320           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3321           88  CP-E-AS-MEAN                        VALUE '8'.
  3322           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3323         16  FILLER                PIC X(12).
  3324
  3325***************    OUTPUT FROM ELPMNT   *************************
  3326
  3327         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3328                                     COMP-3.
  3329         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3330                                     COMP-3.
  3331         16  FILLER                PIC X(12).
  3332
  3333***************   MISC WORK AREAS    *****************************
  3334         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3335                                     COMP-3.
  3336         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3337                                     COMP-3.
  3338         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3339                                     COMP-3.
  3340         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3341                                     COMP-3.
  3342         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3343                                     COMP-3.
  3344         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3345                                     COMP-3.
  3346         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3347             88  OPEN-RATE-FILE                   VALUE 'O'.
  3348             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3349             88  IO-ERROR                         VALUE 'E'.
  3350
  3351         16  CP-FIRST-PAY-DATE     PIC XX.
  3352
  3353         16  CP-JOINT-INDICATOR    PIC X.
  3354
  3355         16  CP-RESERVE-REMAINING-TERM
  3356                                   PIC S9(4)V9    VALUE ZERO
  3357                                     COMP-3.
  3358
  3359         16  CP-INSURED-BIRTH-DT   PIC XX.
  3360
  3361         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3362                                     COMP-3.
  3363
  3364         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3365                                     COMP-3.
  3366
  3367         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3368                                     COMP-3.
  3369
  3370         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3371                                     COMP-3.
  3372
  3373         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3374                                     COMP-3.
  3375
  3376         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3377                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  60
* SOCK00.cbl
  3378
  3379         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3380                                     COMP-3.
  3381
  3382         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3383             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3384
  3385         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3386                                     COMP-3.
  3387         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3388                                     COMP-3.
  3389         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3390         16  cp-extra-periods      pic 9 value zeros.
  3391         16  cp-net-only-state     pic x value spaces.
  3392         16  FILLER                PIC X(13).
  3393******************************************************************
  3394****************************************************************
  3395*
  3396* Copyright (c) 2007 by Clerity Solutions, Inc.
  3397* All rights reserved.
  3398*
  3399****************************************************************
  3400 01  DFHEIV.
  3401   02  DFHEIV0               PIC X(35).
  3402   02  DFHEIV1               PIC X(08).
  3403   02  DFHEIV2               PIC X(08).
  3404   02  DFHEIV3               PIC X(08).
  3405   02  DFHEIV4               PIC X(06).
  3406   02  DFHEIV5               PIC X(04).
  3407   02  DFHEIV6               PIC X(04).
  3408   02  DFHEIV7               PIC X(02).
  3409   02  DFHEIV8               PIC X(02).
  3410   02  DFHEIV9               PIC X(01).
  3411   02  DFHEIV10              PIC S9(7) COMP-3.
  3412   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3413   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3414   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3415   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3416   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3417   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3418   02  DFHEIV17              PIC X(04).
  3419   02  DFHEIV18              PIC X(04).
  3420   02  DFHEIV19              PIC X(04).
  3421   02  DFHEIV20              USAGE IS POINTER.
  3422   02  DFHEIV21              USAGE IS POINTER.
  3423   02  DFHEIV22              USAGE IS POINTER.
  3424   02  DFHEIV23              USAGE IS POINTER.
  3425   02  DFHEIV24              USAGE IS POINTER.
  3426   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3427   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3428   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3429   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3430   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3431   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3432   02  FILLER                PIC X(02).
  3433   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3434   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3435   02  DFHEIVL1              PIC X(48) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  61
* SOCK00.cbl
  3436   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3437   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3438 LINKAGE  SECTION.
  3439*****************************************************************
  3440*                                                               *
  3441* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3442* All rights reserved.                                          *
  3443*                                                               *
  3444*****************************************************************
  3445 01  dfheiblk.
  3446     02  eibtime          pic s9(7) comp-3.
  3447     02  eibdate          pic s9(7) comp-3.
  3448     02  eibtrnid         pic x(4).
  3449     02  eibtaskn         pic s9(7) comp-3.
  3450     02  eibtrmid         pic x(4).
  3451     02  dfheigdi         pic s9(4) comp.
  3452     02  eibcposn         pic s9(4) comp.
  3453     02  eibcalen         pic s9(4) comp.
  3454     02  eibaid           pic x(1).
  3455     02  eibfiller1       pic x(1).
  3456     02  eibfn            pic x(2).
  3457     02  eibfiller2       pic x(2).
  3458     02  eibrcode         pic x(6).
  3459     02  eibfiller3       pic x(2).
  3460     02  eibds            pic x(8).
  3461     02  eibreqid         pic x(8).
  3462     02  eibrsrce         pic x(8).
  3463     02  eibsync          pic x(1).
  3464     02  eibfree          pic x(1).
  3465     02  eibrecv          pic x(1).
  3466     02  eibsend          pic x(1).
  3467     02  eibatt           pic x(1).
  3468     02  eibeoc           pic x(1).
  3469     02  eibfmh           pic x(1).
  3470     02  eibcompl         pic x(1).
  3471     02  eibsig           pic x(1).
  3472     02  eibconf          pic x(1).
  3473     02  eiberr           pic x(1).
  3474     02  eibrldbk         pic x(1).
  3475     02  eiberrcd         pic x(4).
  3476     02  eibsynrb         pic x(1).
  3477     02  eibnodat         pic x(1).
  3478     02  eibfiller5       pic x(2).
  3479     02  eibresp          pic 9(09) comp.
  3480     02  eibresp2         pic 9(09) comp.
  3481     02  dfheigdj         pic s9(4) comp.
  3482     02  dfheigdk         pic s9(4) comp.
  3483 01  DFHCOMMAREA.
  3484   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3485   05 LSTN-NAME                PIC X(8).
  3486   05 LSTN-SUBNAME             PIC X(8).
  3487   05 CLIENT-IN-DATA.
  3488      15  CLIENT-CAR           PIC X.
  3489      15  CLIENT-GRP           PIC X(6).
  3490      15  CLIENT-ST            PIC XX.
  3491      15  CLIENT-ACT           PIC X(10).
  3492      15  CLIENT-ID            PIC XXX.
  3493      15  FILLER               PIC X(14).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  62
* SOCK00.cbl
  3494   05 SOCKADDR-IN-PARM.
  3495     15 SIN-FAMILY             PIC 9(4) COMP.
  3496     15 SIN-PORT               PIC 9(4) COMP.
  3497     15 SIN-ADDRESS            PIC 9(8) COMP.
  3498     15 SIN-ZERO               PIC X(8).
  3499 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3500 0000-DFHEXIT SECTION.
  3501     MOVE '9#                    $   ' TO DFHEIV0.
  3502     MOVE 'SOCK00' TO DFHEIV1.
  3503     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3504*
  3505* when calling a C function the function returns its value
  3506* in the system variable return code.
  3507*
  3508 start-here.
  3509*
  3510* data with transaction
  3511*
  3512     display 'SOCK00:transaction data =', CLIENT-IN-DATA.
  3513     display 'SOCK00:socket number    =', GIVE-TAKE-SOCKET.
  3514     IF CLIENT-IN-DATA (1:4) = "RATE"
  3515        SET GET-RATES            TO TRUE
  3516     ELSE
  3517        IF CLIENT-IN-DATA (1:5) = "STATE"
  3518           SET GET-ACT-ACCTS     TO TRUE
  3519        END-IF
  3520     END-IF
  3521     IF CLIENT-ID = 'AHL'
  3522        MOVE X'06'               TO WS-COMP-CD
  3523        MOVE 'AHL'               TO WS-SEND-BUF (5:3)
  3524                                    WS-COMP-ID
  3525     ELSE
  3526        IF CLIENT-ID = 'DCC'
  3527           MOVE X'05'            TO WS-COMP-CD
  3528           MOVE 'DCC'            TO WS-SEND-BUF (5:3)
  3529                                    WS-COMP-ID
  3530        ELSE
  3531           IF CLIENT-ID = 'VPP'
  3532              MOVE X'07'         TO WS-COMP-CD
  3533              MOVE 'VPP'         TO WS-SEND-BUF (5:3)
  3534                                    WS-COMP-ID
  3535           ELSE
  3536              MOVE X'04'         TO WS-COMP-CD
  3537              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  3538                                    WS-COMP-ID
  3539           END-IF
  3540        END-IF
  3541     END-IF
  3542     move 'CSO'                  to ws-send-buf (1:3)
  3543     move +25                    to ws-send-msg-size
  3544* send data
  3545*
  3546     display 'SOCK00:sequence number  =', ws-seq-num.
  3547     display 'SOCK00:send buffer      =', ws-send-buf(1:25).
  3548     call "send" using by value GIVE-TAKE-SOCKET,
  3549         by reference ws-send-buf,
  3550         by value ws-send-msg-size,
  3551         by value ws-flags.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  63
* SOCK00.cbl
  3552     if return-code <= zero
  3553         display 'SOCK00:send error ',
  3554         go to socket-error.
  3555*
  3556* set up the receive buffer
  3557*
  3558     move low-values to ws-recv-buf.
  3559     set ws-recv-total to zero.
  3560     compute ws-recv-left = ws-recv-msg-size.
  3561*
  3562* receive data
  3563*
  3564     display 'SOCK00:About to recv '
  3565     call "recv" using by value GIVE-TAKE-SOCKET,
  3566         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3567         by value ws-recv-left,
  3568         by value ws-flags.
  3569*
  3570* test what was received and decide what we should do
  3571*
  3572     if return-code < zero
  3573        display 'SOCK00:recv error ',
  3574        go to socket-error.
  3575     if return-code = zero
  3576        display 'SOCK00:client disconnected',
  3577        go to socket-error.
  3578*
  3579     display 'SOCK00:Good recv  '
  3580     display 'SOCK00:return code      = ', return-code
  3581     display 'SOCK00:receive buffer   = ', ws-recv-buf(1:50)
  3582     move +4096                  to ws-send-msg-size
  3583*    move +750                   to ws-send-msg-size
  3584     if get-rates
  3585        perform 0300-get-rates   thru 0300-exit
  3586     end-if
  3587     IF GET-ACT-ACCTS
  3588        PERFORM 0400-GET-ACT-ACCTS
  3589                                 THRU 0400-EXIT
  3590     END-IF
  3591     move ws-recv-buf (1:19)     to client-in-data
  3592     IF (CLIENT-CAR NOT = ZEROS)
  3593        AND (CLIENT-ST NOT = ZEROS)
  3594        PERFORM 0500-GET-ONE-ACCT
  3595                                 THRU 0500-EXIT
  3596     END-IF
  3597     MOVE ' '                    TO WS-BUILD-SW
  3598     MOVE CLIENT-ACT             TO WS-AM-ALT-ACCOUNT
  3599     MOVE LOW-VALUES             TO WS-AM-ALT-EXP-DT
  3600     PERFORM 0010-STARTBR-ERACCT THRU 0010-EXIT
  3601     IF NOT RESP-NORMAL
  3602        MOVE 'BAD STARTBR ON ERACCT  '
  3603                                 TO WS-SEND-BUF
  3604        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3605        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3606        GO TO SEND-BUFFER
  3607     END-IF
  3608     PERFORM 0020-READNEXT-ERACCT
  3609                                 THRU 0020-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  64
* SOCK00.cbl
  3610     IF (NOT RESP-NORMAL)
  3611        OR (AM-ACCOUNT NOT = CLIENT-ACT)
  3612        MOVE 'BAD READNEXT ON ERACCT '
  3613                                 TO WS-SEND-BUF
  3614        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3615        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3616        GO TO SEND-BUFFER
  3617     ELSE
  3618        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  3619     END-IF
  3620     PERFORM UNTIL
  3621        (TIME-TO-BUILD)
  3622        IF AM-ACCOUNT = CLIENT-ACT
  3623         IF (AM-STATE = CLIENT-ST)
  3624                 OR
  3625            (CLIENT-ST = 00)
  3626           IF AM-EXPIRATION-DT = HIGH-VALUES
  3627              SET TIME-TO-BUILD  TO TRUE
  3628           ELSE
  3629              MOVE ACCOUNT-MASTER
  3630                                 TO WS-SAVE-ERACCT
  3631              PERFORM 0020-READNEXT-ERACCT
  3632                                 THRU 0020-EXIT
  3633              IF NOT RESP-NORMAL
  3634                 MOVE WS-SAVE-ERACCT
  3635                                 TO ACCOUNT-MASTER
  3636                 SET TIME-TO-BUILD
  3637                                 TO TRUE
  3638              END-IF
  3639           END-IF
  3640         ELSE
  3641          PERFORM 0020-READNEXT-ERACCT
  3642                            THRU 0020-EXIT
  3643         END-IF
  3644        ELSE
  3645           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  3646           SET TIME-TO-BUILD     TO TRUE
  3647        END-IF
  3648     END-PERFORM
  3649     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  3650     .
  3651*
  3652* send data
  3653*
  3654 SEND-BUFFER.
  3655     display 'SOCK00:About to send      '
  3656     display 'SOCK00:sequence number  =', ws-seq-num.
  3657     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  3658     call "send" using by value GIVE-TAKE-SOCKET,
  3659         by reference ws-send-buf,
  3660         by value ws-send-msg-size,
  3661         by value ws-flags.
  3662     if return-code <= zero
  3663         display 'SOCK00:send error ',
  3664         go to socket-error.
  3665     GO TO SOCKET-FIN
  3666*
  3667* set up the receive buffer
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  65
* SOCK00.cbl
  3668*
  3669     move low-values to ws-recv-buf.
  3670     set ws-recv-total to zero.
  3671     compute ws-recv-left = ws-recv-msg-size.
  3672*
  3673* receive data
  3674*
  3675 recv-1.
  3676     call "recv" using by value GIVE-TAKE-SOCKET,
  3677         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3678         by value ws-recv-left,
  3679         by value ws-flags.
  3680*
  3681* test what was received and decide what we should do
  3682*
  3683     if return-code < zero
  3684        display 'SOCK00:recv error ',
  3685        go to socket-error.
  3686     if return-code = zero
  3687        display 'SOCK00:client disconnected',
  3688        go to socket-error.
  3689*
  3690* have we received all the data yet?
  3691*
  3692     compute ws-recv-total = ws-recv-total + return-code.
  3693     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  3694*
  3695* not yet
  3696*
  3697     if ws-recv-left > 0 go to recv-1.
  3698*
  3699* received all the data
  3700*
  3701     display 'SOCK00:receive buffer   =', ws-recv-buf(1:50).
  3702*
  3703* make sure what we received was what we sent
  3704*
  3705*    if ws-recv-buf <> ws-send-buf
  3706*        display "SOCK00:data doesn't match",
  3707*        go to socket-error.
  3708*
  3709* end of pass
  3710*
  3711*loop-end.
  3712*    if ws-seq-num = 5 go to socket-error.
  3713*    go to loop-1.
  3714*
  3715* program end
  3716*
  3717 socket-error.
  3718     if ws-seq-num <> 0
  3719         display "SOCK00:did not complete".
  3720*
  3721* flush the send buffer and deallocate
  3722*
  3723*    display 'SOCK00:closing socket'.
  3724*    call "close" using by value GIVE-TAKE-SOCKET .
  3725*
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  66
* SOCK00.cbl
  3726* finised return to cics
  3727*
  3728 socket-fin.
  3729*    display 'SOCK00:closing socket'.
  3730*    call "close" using by value GIVE-TAKE-SOCKET .
  3731     display 'SOCK00:done'.
  3732
  3733* exec cics return end-exec.
  3734*    MOVE '.(                    ''   #00003728' TO DFHEIV0
  3735     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3736     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3737     MOVE X'2020233030303033373238' TO DFHEIV0(25:11)
  3738     CALL 'kxdfhei1' USING DFHEIV0,
  3739           DFHEIV99,
  3740           DFHEIV99,
  3741           DFHEIV99,
  3742           DFHEIV99,
  3743           DFHEIV99,
  3744           DFHEIV99
  3745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3746
  3747
  3748* goback.
  3749     MOVE '9%                    "   ' TO DFHEIV0
  3750     MOVE 'SOCK00' TO DFHEIV1
  3751     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3752     goback.
  3753 0010-STARTBR-ERACCT.
  3754
  3755* EXEC CICS STARTBR
  3756*         DATASET    ('ERACCT3')
  3757*         RIDFLD     (WS-AM-ALT-KEY)
  3758*         GENERIC
  3759*         GTEQ
  3760*         KEYLENGTH  (10)
  3761*         RESP       (WS-RESPONSE)
  3762*    END-EXEC
  3763     MOVE 'ERACCT3' TO DFHEIV1
  3764     MOVE 10
  3765       TO DFHEIV11
  3766     MOVE 0
  3767       TO DFHEIV12
  3768*    MOVE '&,   KG    G          &  N#00003731' TO DFHEIV0
  3769     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3770     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3771     MOVE X'204E233030303033373331' TO DFHEIV0(25:11)
  3772     CALL 'kxdfhei1' USING DFHEIV0,
  3773           DFHEIV1,
  3774           WS-AM-ALT-KEY,
  3775           DFHEIV11,
  3776           DFHEIV12,
  3777           DFHEIV99
  3778     MOVE EIBRESP  TO WS-RESPONSE
  3779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3780     .
  3781 0010-EXIT.
  3782     EXIT.
  3783 0020-READNEXT-ERACCT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  67
* SOCK00.cbl
  3784
  3785* EXEC CICS READNEXT
  3786*         INTO    (ACCOUNT-MASTER)
  3787*         DATASET ('ERACCT3')
  3788*         RIDFLD  (WS-AM-ALT-KEY)
  3789*         RESP    (WS-RESPONSE)
  3790*    END-EXEC
  3791     MOVE LENGTH OF
  3792      ACCOUNT-MASTER
  3793       TO DFHEIV12
  3794     MOVE 'ERACCT3' TO DFHEIV1
  3795     MOVE 0
  3796       TO DFHEIV11
  3797*    MOVE '&.IL                  )  N#00003743' TO DFHEIV0
  3798     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3799     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3800     MOVE X'204E233030303033373433' TO DFHEIV0(25:11)
  3801     CALL 'kxdfhei1' USING DFHEIV0,
  3802           DFHEIV1,
  3803           ACCOUNT-MASTER,
  3804           DFHEIV12,
  3805           WS-AM-ALT-KEY,
  3806           DFHEIV99,
  3807           DFHEIV11,
  3808           DFHEIV99,
  3809           DFHEIV99
  3810     MOVE EIBRESP  TO WS-RESPONSE
  3811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3812     .
  3813 0020-EXIT.
  3814     EXIT.
  3815 0030-BUILD-BUFFER.
  3816     PERFORM 0100-BUILD-ERACCT-STUFF
  3817                                 THRU 0100-EXIT
  3818     MOVE SPACES                 TO WS-SEND-BUF
  3819     EVALUATE AM-STATUS
  3820        WHEN '1'
  3821           MOVE 'I'              TO WS-STATUS
  3822        WHEN '2'
  3823           MOVE 'T'              TO WS-STATUS
  3824        WHEN '3'
  3825           MOVE 'C'              TO WS-STATUS
  3826        WHEN '4'
  3827           MOVE 'I'              TO WS-STATUS
  3828        WHEN '5'
  3829           MOVE 'S'              TO WS-STATUS
  3830        WHEN OTHER
  3831           MOVE 'A'              TO WS-STATUS
  3832     END-EVALUATE
  3833     IF AM-REMIT-TO NOT NUMERIC
  3834        MOVE ZEROS         TO AM-REMIT-TO
  3835     END-IF
  3836     IF AM-REMIT-TO = ZEROS
  3837        MOVE 01        TO AM-REMIT-TO
  3838     END-IF
  3839     MOVE AM-AGT (AM-REMIT-TO) TO WS-FIN-RESP
  3840     MOVE SPACES                 TO WS-AM-CITY-STATE
  3841     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  68
* SOCK00.cbl
  3842        DELIMITED BY '  ' INTO WS-AM-CITY-STATE
  3843     END-STRING
  3844     IF NOT GET-ACT-ACCTS
  3845* this is when a single account is selected
  3846       STRING
  3847        AM-ACCOUNT      ';'
  3848        WS-LONG-ACCT-NAME    ';'
  3849        WS-CONTR-NAME   ';'
  3850        AM-ADDRS        ';'
  3851        WS-AM-CITY-STATE ';'
  3852        AM-ZIP          ';'
  3853        AM-GPCD         ';'
  3854        WS-EFF-DATE     ';'
  3855        WS-EXP-DATE     ';'
  3856        WS-POLICY-NO    ';'
  3857        WS-SL-COMM      ';'
  3858        WS-JL-COMM      ';'
  3859        WS-SAH-COMM     ';'
  3860        WS-JAH-COMM     ';'
  3861        WS-CID-NO       ';'
  3862        AM-STATE        ';'
  3863        WS-GA-NUM       ';'
  3864        WS-GA-PRIMARY-CONTACT ';'
  3865        WS-GA-NAME      ';'
  3866        WS-GA-MAIL-NAME ';'
  3867        WS-GA-ADDR1     ';'
  3868        WS-GA-ADDR2     ';'
  3869        WS-GA-ADDR3     ';'
  3870        WS-GA-ZIP       ';'
  3871        WS-GA-PHONE     ';'
  3872        AM-CONTROL-NAME ';'
  3873        WS-ORIG-EFF-DT  ';'
  3874        AM-COMMENT-LINE (1) ';'
  3875        AM-COMMENT-LINE (2) ';'
  3876        AM-COMMENT-LINE (3) ';'
  3877        AM-COMMENT-LINE (4) ';'
  3878        AM-COMMENT-LINE (5) ';'
  3879        AM-TEL-NO       ';'
  3880        AM-REPORT-CODE-1    ';'
  3881        AM-REPORT-CODE-2    ';'
  3882        WS-STATUS           ';'
  3883        AM-REPORT-CODE-3    ';'
  3884        AM-USER-SELECT-2    ';'
  3885        AM-CARRIER          ';'
  3886        WS-FIN-RESP         ';'
  3887        AM-USER-SELECT-3    ';'
  3888        WS-SHORT-ACCT-NAME  ';'
  3889           DELIMITED BY SIZE INTO WS-SEND-BUF
  3890       END-STRING
  3891     ELSE
  3892       STRING
  3893        AM-ACCOUNT      ';'
  3894        WS-LONG-ACCT-NAME    ';'
  3895        WS-CONTR-NAME   ';'
  3896        AM-ADDRS        ';'
  3897        WS-AM-CITY-STATE ';'
  3898        AM-ZIP          ';'
  3899        AM-GPCD         ';'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  69
* SOCK00.cbl
  3900        WS-EFF-DATE     ';'
  3901        WS-EXP-DATE     ';'
  3902        WS-POLICY-NO    ';'
  3903        WS-SL-COMM      ';'
  3904        WS-JL-COMM      ';'
  3905        WS-SAH-COMM     ';'
  3906        WS-JAH-COMM     ';'
  3907        WS-CID-NO       ';'
  3908        AM-STATE        ';'
  3909        WS-GA-NUM       ';'
  3910        WS-GA-PRIMARY-CONTACT ';'
  3911        WS-GA-NAME      ';'
  3912        WS-GA-MAIL-NAME ';'
  3913        WS-GA-ADDR1     ';'
  3914        WS-GA-ADDR2     ';'
  3915        WS-GA-ADDR3     ';'
  3916        WS-GA-ZIP       ';'
  3917        WS-GA-PHONE     ';'
  3918        AM-COMMENT-LINE (1) ';'
  3919        AM-COMMENT-LINE (2) ';'
  3920        AM-COMMENT-LINE (3) ';'
  3921        AM-COMMENT-LINE (4) ';'
  3922        AM-COMMENT-LINE (5) ';'
  3923        AM-CONTROL-NAME     ';'
  3924        WS-ORIG-EFF-DT      ';'
  3925        AM-TEL-NO           ';'
  3926        AM-REPORT-CODE-1    ';'
  3927        AM-REPORT-CODE-2    ';'
  3928        WS-STATUS           ';'
  3929        AM-REPORT-CODE-3    ';'
  3930        AM-USER-SELECT-2    ';'
  3931        AM-CARRIER          ';'
  3932        WS-FIN-RESP         ';'
  3933        AM-USER-SELECT-3    ';'
  3934        WS-SHORT-ACCT-NAME  ';'
  3935           DELIMITED BY SIZE INTO WS-SEND-BUF
  3936       END-STRING
  3937     END-IF
  3938     .
  3939 0030-EXIT.
  3940     EXIT.
  3941 0100-BUILD-ERACCT-STUFF.
  3942     MOVE AM-EFFECTIVE-DT        TO DC-BIN-DATE-1
  3943     MOVE ' '                    TO DC-OPTION-CODE
  3944     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3945     IF NO-CONVERSION-ERROR
  3946        MOVE DC-GREG-DATE-A-EDIT TO WS-EFF-DATE
  3947     ELSE
  3948        MOVE '00/00/0000'        TO WS-EFF-DATE
  3949     END-IF
  3950     IF AM-EXPIRATION-DT = HIGH-VALUES
  3951        MOVE '99/99/9999'        TO WS-EXP-DATE
  3952     ELSE
  3953        MOVE AM-EXPIRATION-DT    TO DC-BIN-DATE-1
  3954        MOVE ' '                 TO DC-OPTION-CODE
  3955        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  3956        IF NO-CONVERSION-ERROR
  3957           MOVE DC-GREG-DATE-A-EDIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  70
* SOCK00.cbl
  3958                                 TO WS-EXP-DATE
  3959        ELSE
  3960           MOVE '00/00/0000'     TO WS-EXP-DATE
  3961        END-IF
  3962     END-IF
  3963     MOVE WS-BIN-ORIG-EFF-DT     TO DC-BIN-DATE-1
  3964     MOVE ' '                    TO DC-OPTION-CODE
  3965     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3966     IF NO-CONVERSION-ERROR
  3967        MOVE DC-GREG-DATE-A-EDIT TO WS-ORIG-EFF-DT
  3968     ELSE
  3969        MOVE '00/00/0000'        TO WS-ORIG-EFF-DT
  3970     END-IF
  3971     MOVE AM-COMMENT-LINE (2)    TO WS-POLICY-NO
  3972     PERFORM VARYING S1 FROM +7 BY +1 UNTIL
  3973        (S1 > +48)
  3974        OR (AM-COMMENT-LINE (2) (S1:3) = 'CID')
  3975     END-PERFORM
  3976     IF S1 > +48
  3977        MOVE SPACES              TO WS-CID-NO
  3978     ELSE
  3979        MOVE AM-COMMENT-LINE (2) (S1:8)
  3980                                 TO WS-CID-NO
  3981     END-IF
  3982     MOVE AM-NAME                TO WS-SHORT-ACCT-NAME
  3983                                    WS-LONG-ACCT-NAME
  3984     MOVE AM-PERSON              TO WS-CONTR-NAME
  3985*    IF AM-REPORT-CODE-3 = 'RLIC'
  3986        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  3987        MOVE '3'                 TO WS-NT-REC-TYPE
  3988        MOVE +1                  TO WS-NT-SEQ-NO
  3989
  3990* EXEC CICS READ
  3991*          DATASET    ('ERACNT')
  3992*          RIDFLD     (WS-NT-KEY)
  3993*          INTO       (NOTE-FILE)
  3994*          RESP       (WS-RESPONSE)
  3995*       END-EXEC
  3996     MOVE LENGTH OF
  3997      NOTE-FILE
  3998       TO DFHEIV11
  3999     MOVE 'ERACNT' TO DFHEIV1
  4000*    MOVE '&"IL       E          (  N#00003926' TO DFHEIV0
  4001     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4003     MOVE X'204E233030303033393236' TO DFHEIV0(25:11)
  4004     CALL 'kxdfhei1' USING DFHEIV0,
  4005           DFHEIV1,
  4006           NOTE-FILE,
  4007           DFHEIV11,
  4008           WS-NT-KEY,
  4009           DFHEIV99,
  4010           DFHEIV99,
  4011           DFHEIV99
  4012     MOVE EIBRESP  TO WS-RESPONSE
  4013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4014        IF RESP-NORMAL
  4015           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  71
* SOCK00.cbl
  4016              MOVE NT-SHIPPING-LINE TO WS-LONG-ACCT-NAME
  4017           END-IF
  4018        END-IF
  4019        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  4020        MOVE '3'                 TO WS-NT-REC-TYPE
  4021        MOVE +2                  TO WS-NT-SEQ-NO
  4022
  4023* EXEC CICS READ
  4024*          DATASET    ('ERACNT')
  4025*          RIDFLD     (WS-NT-KEY)
  4026*          INTO       (NOTE-FILE)
  4027*          RESP       (WS-RESPONSE)
  4028*       END-EXEC
  4029     MOVE LENGTH OF
  4030      NOTE-FILE
  4031       TO DFHEIV11
  4032     MOVE 'ERACNT' TO DFHEIV1
  4033*    MOVE '&"IL       E          (  N#00003940' TO DFHEIV0
  4034     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4036     MOVE X'204E233030303033393430' TO DFHEIV0(25:11)
  4037     CALL 'kxdfhei1' USING DFHEIV0,
  4038           DFHEIV1,
  4039           NOTE-FILE,
  4040           DFHEIV11,
  4041           WS-NT-KEY,
  4042           DFHEIV99,
  4043           DFHEIV99,
  4044           DFHEIV99
  4045     MOVE EIBRESP  TO WS-RESPONSE
  4046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4047        IF RESP-NORMAL
  4048           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  4049              MOVE NT-SHIPPING-LINE TO WS-CONTR-NAME
  4050           END-IF
  4051        END-IF
  4052*    END-IF
  4053     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4054        (S1 > +10)
  4055        OR (AM-COM-TYP (S1) = 'D' OR 'C')
  4056     END-PERFORM
  4057     IF S1 > +10
  4058        CONTINUE
  4059     ELSE
  4060        PERFORM 0150-BUILD-DW-COMM
  4061                                 THRU 0150-EXIT
  4062     END-IF
  4063     MOVE SPACES                 TO WS-GA-DATA
  4064     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4065        (S1 > +10)
  4066        OR (AM-COM-TYP (S1) = 'O' OR 'P' OR 'K' OR 'S')
  4067     END-PERFORM
  4068     IF S1 > +10
  4069        MOVE ZEROS               TO WS-GA-NUM
  4070     ELSE
  4071        MOVE AM-AGT (S1)         TO WS-GA-NUM
  4072     END-IF
  4073     IF WS-GA-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  72
* SOCK00.cbl
  4074        PERFORM 0200-GET-ERCOMP  THRU 0200-EXIT
  4075     END-IF
  4076     .
  4077 0100-EXIT.
  4078     EXIT.
  4079 0150-BUILD-DW-COMM.
  4080     MOVE ZEROS                  TO WS-SL-COMM
  4081                                    WS-JL-COMM
  4082                                    WS-SAH-COMM
  4083                                    WS-JAH-COMM
  4084                                    WS-WORK-SAH-COMM
  4085                                    WS-WORK-JAH-COMM
  4086     IF (AM-L-COM (S1) NOT NUMERIC)
  4087        OR (AM-L-COMA (S1) (3:1) = 'L' OR 'M')
  4088        CONTINUE
  4089     ELSE
  4090        MOVE AM-L-COM (S1)       TO WS-SL-COMM
  4091     END-IF
  4092     IF (AM-J-COM (S1) NOT NUMERIC)
  4093        OR (AM-J-COMA (S1) (3:1) = 'L' OR 'M')
  4094        CONTINUE
  4095     ELSE
  4096        MOVE AM-J-COM (S1)       TO WS-JL-COMM
  4097     END-IF
  4098     IF (AM-A-COM (S1) NOT NUMERIC)
  4099        OR (AM-A-COMA (S1) (3:1) = 'L' OR 'M')
  4100        PERFORM 0160-ERCTBL-STARTBR
  4101                                 THRU 0160-EXIT
  4102        IF RESP-NORMAL
  4103           PERFORM 0165-ERCTBL-READNEXT
  4104                                 THRU 0165-EXIT
  4105           UNTIL
  4106           ((WS-WORK-SAH-COMM NOT = ZEROS)
  4107            AND (WS-WORK-JAH-COMM NOT = ZEROS))
  4108                       OR
  4109            END-OF-ERCTBL
  4110            MOVE WS-WORK-JAH-COMM TO WS-JAH-COMM
  4111            MOVE WS-WORK-SAH-COMM TO WS-SAH-COMM
  4112        END-IF
  4113     ELSE
  4114        MOVE AM-A-COM (S1)       TO WS-SAH-COMM
  4115                                    WS-JAH-COMM
  4116     END-IF
  4117     .
  4118 0150-EXIT.
  4119     EXIT.
  4120 0160-ERCTBL-STARTBR.
  4121     MOVE AM-COMPANY-CD          TO WS-CT-COMPANY-CD
  4122     MOVE AM-A-COMA (S1)         TO WS-CT-TABLE
  4123     MOVE 'A'                    TO WS-CT-BEN-TYPE
  4124     MOVE LOW-VALUES             TO WS-CT-BEN-CODE
  4125     MOVE WS-CT-KEY              TO WS-CT-KEY-SAVE
  4126
  4127* EXEC CICS STARTBR
  4128*         DATASET    ('ERCTBL')
  4129*         RIDFLD     (WS-CT-KEY)
  4130*         GTEQ
  4131*         RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  73
* SOCK00.cbl
  4132*    END-EXEC
  4133     MOVE 'ERCTBL' TO DFHEIV1
  4134     MOVE 0
  4135       TO DFHEIV11
  4136*    MOVE '&,         G          &  N#00004025' TO DFHEIV0
  4137     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4138     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4139     MOVE X'204E233030303034303235' TO DFHEIV0(25:11)
  4140     CALL 'kxdfhei1' USING DFHEIV0,
  4141           DFHEIV1,
  4142           WS-CT-KEY,
  4143           DFHEIV99,
  4144           DFHEIV11,
  4145           DFHEIV99
  4146     MOVE EIBRESP  TO WS-RESPONSE
  4147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4148     .
  4149 0160-EXIT.
  4150     EXIT.
  4151 0165-ERCTBL-READNEXT.
  4152
  4153* EXEC CICS READNEXT
  4154*         INTO    (COMM-TABLE-RECORD)
  4155*         DATASET ('ERCTBL')
  4156*         RIDFLD  (WS-CT-KEY)
  4157*         RESP    (WS-RESPONSE)
  4158*    END-EXEC
  4159     MOVE LENGTH OF
  4160      COMM-TABLE-RECORD
  4161       TO DFHEIV12
  4162     MOVE 'ERCTBL' TO DFHEIV1
  4163     MOVE 0
  4164       TO DFHEIV11
  4165*    MOVE '&.IL                  )  N#00004035' TO DFHEIV0
  4166     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4167     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4168     MOVE X'204E233030303034303335' TO DFHEIV0(25:11)
  4169     CALL 'kxdfhei1' USING DFHEIV0,
  4170           DFHEIV1,
  4171           COMM-TABLE-RECORD,
  4172           DFHEIV12,
  4173           WS-CT-KEY,
  4174           DFHEIV99,
  4175           DFHEIV11,
  4176           DFHEIV99,
  4177           DFHEIV99
  4178     MOVE EIBRESP  TO WS-RESPONSE
  4179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4180     IF (RESP-NORMAL)
  4181        AND (WS-CT-KEY (1:5) = WS-CT-KEY-SAVE (1:5))
  4182        PERFORM 0170-PROCESS-BEN-CODE
  4183                                 THRU 0170-EXIT
  4184     ELSE
  4185        SET END-OF-ERCTBL        TO TRUE
  4186     END-IF
  4187     .
  4188 0165-EXIT.
  4189     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  74
* SOCK00.cbl
  4190 0170-PROCESS-BEN-CODE.
  4191     MOVE SPACES                 TO WS-CF-KEY
  4192     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  4193     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4194     MOVE CT-BEN-CODE            TO WS-CF-ACCESS (3:2)
  4195     MOVE +0                     TO WS-CF-SEQ-NO
  4196     MOVE WS-CF-KEY              TO WS-CF-KEY-SAVE
  4197
  4198* EXEC CICS READ
  4199*         DATASET    ('ELCNTL')
  4200*         RIDFLD     (WS-CF-KEY)
  4201*         INTO       (CONTROL-FILE)
  4202*         GTEQ
  4203*         RESP       (WS-RESPONSE)
  4204*    END-EXEC
  4205     MOVE LENGTH OF
  4206      CONTROL-FILE
  4207       TO DFHEIV11
  4208     MOVE 'ELCNTL' TO DFHEIV1
  4209*    MOVE '&"IL       G          (  N#00004058' TO DFHEIV0
  4210     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4212     MOVE X'204E233030303034303538' TO DFHEIV0(25:11)
  4213     CALL 'kxdfhei1' USING DFHEIV0,
  4214           DFHEIV1,
  4215           CONTROL-FILE,
  4216           DFHEIV11,
  4217           WS-CF-KEY,
  4218           DFHEIV99,
  4219           DFHEIV99,
  4220           DFHEIV99
  4221     MOVE EIBRESP  TO WS-RESPONSE
  4222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4223     IF NOT RESP-NORMAL
  4224        MOVE WS-RESPONSE         TO WS-DISP-RESP
  4225        DISPLAY ' ERROR - ELCNTL - READ ' WS-DISP-RESP
  4226        GO TO 0170-EXIT
  4227     END-IF
  4228     IF WS-CF-KEY (1:4) = WS-CF-KEY-SAVE (1:4)
  4229        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  4230           (S2 > +8)
  4231           OR (CT-BEN-CODE = CF-BENEFIT-CODE (S2))
  4232        END-PERFORM
  4233        IF CT-BEN-CODE = CF-BENEFIT-CODE (S2)
  4234           IF CF-JOINT-INDICATOR (S2) = 'J'
  4235              IF WS-WORK-JAH-COMM = ZEROS
  4236                 MOVE CT-RT (1)  TO WS-WORK-JAH-COMM
  4237              END-IF
  4238           ELSE
  4239              IF WS-WORK-SAH-COMM = ZEROS
  4240                 MOVE CT-RT (1)  TO WS-WORK-SAH-COMM
  4241              END-IF
  4242           END-IF
  4243        END-IF
  4244     END-IF
  4245     .
  4246 0170-EXIT.
  4247     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  75
* SOCK00.cbl
  4248 0200-GET-ERCOMP.
  4249     MOVE LOW-VALUES             TO WS-CO-KEY
  4250     MOVE AM-COMPANY-CD          TO WS-CO-COMPANY-CD
  4251     MOVE AM-CARRIER             TO WS-CO-CARRIER
  4252     MOVE AM-GROUPING            TO WS-CO-GROUP
  4253     MOVE WS-GA-NUM              TO WS-CO-FIN-RESP
  4254     MOVE LOW-VALUES             TO WS-CO-ACCOUNT
  4255     MOVE 'G'                    TO WS-CO-TYPE
  4256
  4257* EXEC CICS READ
  4258*         INTO    (COMPENSATION-MASTER)
  4259*         DATASET ('ERCOMP')
  4260*         RIDFLD  (WS-CO-KEY)
  4261*         RESP    (WS-RESPONSE)
  4262*    END-EXEC
  4263     MOVE LENGTH OF
  4264      COMPENSATION-MASTER
  4265       TO DFHEIV11
  4266     MOVE 'ERCOMP' TO DFHEIV1
  4267*    MOVE '&"IL       E          (  N#00004098' TO DFHEIV0
  4268     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4269     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4270     MOVE X'204E233030303034303938' TO DFHEIV0(25:11)
  4271     CALL 'kxdfhei1' USING DFHEIV0,
  4272           DFHEIV1,
  4273           COMPENSATION-MASTER,
  4274           DFHEIV11,
  4275           WS-CO-KEY,
  4276           DFHEIV99,
  4277           DFHEIV99,
  4278           DFHEIV99
  4279     MOVE EIBRESP  TO WS-RESPONSE
  4280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4281     IF RESP-NORMAL
  4282        MOVE CO-CONTROL-NAME     TO WS-GA-PRIMARY-CONTACT
  4283        MOVE CO-ACCT-NAME        TO WS-GA-NAME
  4284        MOVE CO-MAIL-NAME        TO WS-GA-MAIL-NAME
  4285        MOVE CO-ADDR-1           TO WS-GA-ADDR1
  4286        MOVE CO-ADDR-2           TO WS-GA-ADDR2
  4287*       MOVE CO-ADDR-3           TO WS-GA-ADDR3
  4288        MOVE SPACES              TO WS-GA-ADDR3
  4289        STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  4290           DELIMITED BY '  ' INTO WS-GA-ADDR3
  4291        END-STRING
  4292        MOVE CO-ZIP              TO WS-GA-ZIP
  4293        MOVE CO-TELEPHONE        TO WS-GA-PHONE
  4294     ELSE
  4295        MOVE SPACES              TO WS-GA-DATA
  4296        MOVE 'GA NOT FOUND '     TO WS-GA-NAME
  4297     END-IF
  4298     .
  4299 0200-EXIT.
  4300     EXIT.
  4301 0300-get-rates.
  4302     move +30                    to ws-send-msg-size
  4303     move ws-recv-buf (1:31)     to ws-get-rate-data
  4304     if rate-apr not numeric
  4305        move zeros               to rate-apr
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  76
* SOCK00.cbl
  4306     end-if
  4307     move rate-apr               to ws-work-apr
  4308     if rate-ben-amt not numeric
  4309        move zeros               to rate-ben-amt
  4310     end-if
  4311     move rate-ben-amt           to ws-work-ben
  4312     if rate-term not numeric
  4313        move zeros               to rate-term
  4314     end-if
  4315     move rate-term              to ws-work-term
  4316     move rate-eff-date (7:4)    to ws-work-date (1:4)
  4317     move rate-eff-date (1:2)    to ws-work-date (5:2)
  4318     move rate-eff-date (4:2)    to ws-work-date (7:2)
  4319     move ws-work-date-num       to dc-greg-date-cymd
  4320     move 'L'                    to dc-option-code
  4321     perform 9700-date-link      thru 9700-exit
  4322     if no-conversion-error
  4323        move dc-bin-date-1       to ws-bin-eff-dt
  4324     else
  4325        move 'bad eff dt convert ' to ws-send-buf
  4326        go to send-rate-buf
  4327     end-if
  4328     move +1                     to dc-elapsed-months
  4329     move +0                     to dc-elapsed-days
  4330     move '6'                    to dc-option-code
  4331     perform 9700-date-link      thru 9700-exit
  4332     if no-conversion-error
  4333        move dc-bin-date-2       to ws-bin-1st-pay-dt
  4334     else
  4335        move 'bad 1st dt convert ' to ws-send-buf
  4336        go to send-rate-buf
  4337     end-if
  4338*    move spaces                 to calculation-pass-area
  4339     move zeros                  to cp-r-max-mon-ben
  4340                                    cp-r-max-tot-ben
  4341                                    cp-class-code
  4342                                    cp-deviation-code
  4343                                    cp-rate-dev-pct
  4344                                    cp-original-premium
  4345                                    cp-critical-months
  4346                                    cp-term-or-ext-days
  4347     move rate-state             to cp-state
  4348                                    cp-state-std-abbrv
  4349     move rate-lf-ah             to cp-benefit-type
  4350     move rate-ben-code          to cp-benefit-cd
  4351     move ws-ben-num             to cp-original-benefit
  4352                                    cp-rating-benefit-amt
  4353     move 40                     to cp-issue-age
  4354     move WS-COMP-ID             to cp-company-id
  4355     move WS-COMP-CD             to cp-company-cd
  4356     move ws-apr-num             to cp-loan-apr
  4357     move ws-term-num            to cp-original-term
  4358                                    cp-loan-term
  4359                                    cp-remaining-term
  4360     move 'L'                    to cp-life-override-code
  4361     move 'A'                    to cp-ah-override-code
  4362     move '3'                    to cp-process-type
  4363     move rate-earn-meth         to cp-earning-method
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  77
* SOCK00.cbl
  4364                                    cp-rating-method
  4365     move 'R'                    to cp-rate-file
  4366     move ws-bin-eff-dt          to cp-cert-eff-dt
  4367     move ws-bin-1st-pay-dt      to cp-first-pay-date
  4368     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4369     if not no-cp-error
  4370        move cp-return-code      to ws-send-buf
  4371     else
  4372        move cp-calc-premium     to ws-disp-amt
  4373        move cp-premium-rate     to ws-disp-rate
  4374        string ws-disp-amt ';' ws-disp-rate delimited
  4375           by size into ws-send-buf
  4376        end-string
  4377     end-if
  4378     .
  4379 SEND-RATE-BUF.
  4380     display 'SOCK00:About to send      '
  4381     display 'SOCK00:sequence number  =', ws-seq-num.
  4382     display 'SOCK00:send buffer      =', ws-send-buf(1:30).
  4383     call "send" using by value GIVE-TAKE-SOCKET,
  4384         by reference ws-send-buf,
  4385         by value ws-send-msg-size,
  4386         by value ws-flags.
  4387     if return-code <= zero
  4388         display 'SOCK00:send error ',
  4389         go to socket-error.
  4390     GO TO SOCKET-FIN
  4391     .
  4392 0300-exit.
  4393     exit.
  4394 0400-GET-ACT-ACCTS.
  4395     MOVE WS-RECV-BUF (1:2)      TO CLIENT-ST
  4396     MOVE ' '                    TO WS-BUILD-SW
  4397     MOVE LOW-VALUES             TO WS-AM-KEY
  4398     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4399     PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4400     IF NOT RESP-NORMAL
  4401        MOVE 'BAD STARTBR ON ERACCT  '
  4402                                 TO WS-SEND-BUF
  4403        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4404        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4405        GO TO SEND-BUFFER
  4406     END-IF
  4407     PERFORM 0420-READNEXT-ERACCT
  4408                                 THRU 0420-EXIT
  4409     IF NOT RESP-NORMAL
  4410        MOVE 'BAD READNEXT ON ERACCT '
  4411                                 TO WS-SEND-BUF
  4412        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4413        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4414        GO TO SEND-BUFFER
  4415     ELSE
  4416        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4417        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4418     END-IF
  4419     PERFORM UNTIL END-OF-ERACCT
  4420        IF NOT (RESP-NORMAL)
  4421           OR (AM-COMPANY-CD > WS-COMP-CD)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  78
* SOCK00.cbl
  4422           SET END-OF-ERACCT     TO TRUE
  4423        ELSE
  4424           IF AM-ACCOUNT NOT = WS-SAVE-ACCOUNT
  4425              MOVE AM-EFFECTIVE-DT TO WS-BIN-ORIG-EFF-DT
  4426           END-IF
  4427           IF (AM-STATE = CLIENT-ST)
  4428              AND (AM-EXPIRATION-DT = HIGH-VALUES)
  4429*             AND (AM-STATUS = '0')
  4430              PERFORM 0030-BUILD-BUFFER
  4431                                 THRU 0030-EXIT
  4432              PERFORM 0430-SEND-BUFFER
  4433                                 THRU 0430-EXIT
  4434           END-IF
  4435           PERFORM 0420-READNEXT-ERACCT
  4436                                 THRU 0420-EXIT
  4437        END-IF
  4438     END-PERFORM
  4439     GO TO SOCKET-FIN
  4440     .
  4441 0400-EXIT.
  4442     EXIT.
  4443 0410-STARTBR-ERACCT.
  4444
  4445* EXEC CICS STARTBR
  4446*         DATASET    ('ERACCT')
  4447*         RIDFLD     (WS-AM-KEY)
  4448*         GTEQ
  4449*         RESP       (WS-RESPONSE)
  4450*    END-EXEC
  4451     MOVE 'ERACCT' TO DFHEIV1
  4452     MOVE 0
  4453       TO DFHEIV11
  4454*    MOVE '&,         G          &  N#00004267' TO DFHEIV0
  4455     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4456     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4457     MOVE X'204E233030303034323637' TO DFHEIV0(25:11)
  4458     CALL 'kxdfhei1' USING DFHEIV0,
  4459           DFHEIV1,
  4460           WS-AM-KEY,
  4461           DFHEIV99,
  4462           DFHEIV11,
  4463           DFHEIV99
  4464     MOVE EIBRESP  TO WS-RESPONSE
  4465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4466     .
  4467 0410-EXIT.
  4468     EXIT.
  4469 0420-READNEXT-ERACCT.
  4470
  4471* EXEC CICS READNEXT
  4472*         INTO    (ACCOUNT-MASTER)
  4473*         DATASET ('ERACCT')
  4474*         RIDFLD  (WS-AM-KEY)
  4475*         RESP    (WS-RESPONSE)
  4476*    END-EXEC
  4477     MOVE LENGTH OF
  4478      ACCOUNT-MASTER
  4479       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  79
* SOCK00.cbl
  4480     MOVE 'ERACCT' TO DFHEIV1
  4481     MOVE 0
  4482       TO DFHEIV11
  4483*    MOVE '&.IL                  )  N#00004277' TO DFHEIV0
  4484     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4485     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4486     MOVE X'204E233030303034323737' TO DFHEIV0(25:11)
  4487     CALL 'kxdfhei1' USING DFHEIV0,
  4488           DFHEIV1,
  4489           ACCOUNT-MASTER,
  4490           DFHEIV12,
  4491           WS-AM-KEY,
  4492           DFHEIV99,
  4493           DFHEIV11,
  4494           DFHEIV99,
  4495           DFHEIV99
  4496     MOVE EIBRESP  TO WS-RESPONSE
  4497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4498     .
  4499 0420-EXIT.
  4500     EXIT.
  4501 0430-SEND-BUFFER.
  4502     display 'SOCK00:About to send      '
  4503     display 'SOCK00:sequence number  =', ws-seq-num.
  4504     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  4505     call "send" using by value GIVE-TAKE-SOCKET,
  4506         by reference ws-send-buf,
  4507         by value ws-send-msg-size,
  4508         by value ws-flags.
  4509     if return-code <= zero
  4510         display 'SOCK00:send error ',
  4511         go to socket-error.
  4512     .
  4513 0430-EXIT.
  4514     EXIT.
  4515 0500-GET-ONE-ACCT.
  4516     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4517     MOVE CLIENT-CAR             TO WS-AM-CARRIER
  4518     MOVE CLIENT-GRP             TO WS-AM-GROUP
  4519     MOVE CLIENT-ST              TO WS-AM-STATE
  4520     MOVE CLIENT-ACT             TO WS-AM-ACCOUNT
  4521     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4522     MOVE '5'                    TO DC-OPTION-CODE
  4523     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4524     MOVE DC-BIN-DATE-1          TO WS-AM-EXP-DT
  4525     MOVE LOW-VALUES             TO WS-AM-EXP-DT
  4526     MOVE ' '                    TO WS-BUILD-SW
  4527    PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4528     IF NOT RESP-NORMAL
  4529        MOVE 'BAD STARTBR ON ERACCT  '
  4530                                 TO WS-SEND-BUF
  4531        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4532        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4533        GO TO SEND-BUFFER
  4534     END-IF
  4535     PERFORM 0420-READNEXT-ERACCT
  4536                                 THRU 0420-EXIT
  4537     IF NOT RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  80
* SOCK00.cbl
  4538        MOVE 'BAD READNEXT ON ERACCT '
  4539                                 TO WS-SEND-BUF
  4540        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4541        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4542        GO TO SEND-BUFFER
  4543     ELSE
  4544        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4545        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4546     END-IF
  4547     PERFORM UNTIL
  4548        (TIME-TO-BUILD)
  4549        IF AM-ACCOUNT = CLIENT-ACT
  4550           IF AM-EXPIRATION-DT = HIGH-VALUES
  4551              SET TIME-TO-BUILD  TO TRUE
  4552           ELSE
  4553              MOVE ACCOUNT-MASTER
  4554                                 TO WS-SAVE-ERACCT
  4555              PERFORM 0420-READNEXT-ERACCT
  4556                                 THRU 0420-EXIT
  4557              IF NOT RESP-NORMAL
  4558                 MOVE WS-SAVE-ERACCT
  4559                                 TO ACCOUNT-MASTER
  4560                 SET TIME-TO-BUILD
  4561                                 TO TRUE
  4562              END-IF
  4563           END-IF
  4564        ELSE
  4565           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  4566           SET TIME-TO-BUILD     TO TRUE
  4567        END-IF
  4568     END-PERFORM
  4569     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4570     PERFORM 0430-SEND-BUFFER    THRU 0430-EXIT
  4571     GO TO SOCKET-FIN
  4572     .
  4573 0500-EXIT.
  4574     EXIT.
  4575 7000-GET-RATE.
  4576
  4577* EXEC CICS LINK
  4578*       PROGRAM ('ELRATE')
  4579*       COMMAREA (CALCULATION-PASS-AREA)
  4580*       LENGTH   (CP-COMM-LENGTH)
  4581*    END-EXEC
  4582     MOVE 'ELRATE' TO DFHEIV1
  4583*    MOVE '."C                   (   #00004361' TO DFHEIV0
  4584     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4585     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4586     MOVE X'2020233030303034333631' TO DFHEIV0(25:11)
  4587     CALL 'kxdfhei1' USING DFHEIV0,
  4588           DFHEIV1,
  4589           CALCULATION-PASS-AREA,
  4590           CP-COMM-LENGTH,
  4591           DFHEIV99,
  4592           DFHEIV99,
  4593           DFHEIV99,
  4594           DFHEIV99
  4595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  81
* SOCK00.cbl
  4596     .
  4597 7000-EXIT.
  4598     EXIT.
  4599 9700-DATE-LINK.
  4600
  4601* EXEC CICS LINK
  4602*         PROGRAM  ('ELDATCV')
  4603*         COMMAREA (DATE-CONVERSION-DATA)
  4604*         LENGTH   (DC-COMM-LENGTH)
  4605*    END-EXEC.
  4606     MOVE 'ELDATCV' TO DFHEIV1
  4607*    MOVE '."C                   (   #00004370' TO DFHEIV0
  4608     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4609     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4610     MOVE X'2020233030303034333730' TO DFHEIV0(25:11)
  4611     CALL 'kxdfhei1' USING DFHEIV0,
  4612           DFHEIV1,
  4613           DATE-CONVERSION-DATA,
  4614           DC-COMM-LENGTH,
  4615           DFHEIV99,
  4616           DFHEIV99,
  4617           DFHEIV99,
  4618           DFHEIV99
  4619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4620
  4621 9700-EXIT.
  4622      EXIT.
  4623
  4624 9999-DFHBACK SECTION.
  4625     MOVE '9%                    "   ' TO DFHEIV0
  4626     MOVE 'SOCK00' TO DFHEIV1
  4627     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4628     GOBACK.
  4629 9999-DFHEXIT.
  4630     IF DFHEIGDJ EQUAL 0001
  4631         NEXT SENTENCE.
  4632     MOVE '9%                    "   ' TO DFHEIV0
  4633     MOVE 'SOCK00' TO DFHEIV1
  4634     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4635     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16548     Code:        8756
