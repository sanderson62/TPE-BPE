* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    54* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    55******************************************************************
    56
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page   3
* EL156.cbl
    58 ENVIRONMENT DIVISION.
    59
    60 DATA DIVISION.
    61
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64
    65 77  FILLER  PIC X(32)  VALUE '********************************'.
    66 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    67 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    68 77  WS-SSN  PIC X(9) VALUE ZEROS.
    69 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    70 77  C0                          PIC S999 COMP-3 VALUE +0.
    71 77  C1                          PIC S999 COMP-3 VALUE +0.
    72 77  C2                          PIC S999 COMP-3 VALUE +0.
    73 77  C3                          PIC S999 COMP-3 VALUE +0.
    74 77  s1                          PIC S999 COMP-3 VALUE +0.
    75 77  s2                          pic s999 comp-3 value +0.
    76 77  P1                          PIC S999 COMP-3 VALUE +0.
    77 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    78 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    79 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    80 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    81 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    82 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    83 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    84 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    85 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    86 77  ws-max-bens                 pic s999 comp-3 value +0.
    87 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    88 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    89 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    90 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    91 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    92
    93*    COPY ELCSCTM.
    94******************************************************************
    95*                                                                *
    96*                                                                *
    97*                            ELCSCTM                             *
    98*                            VMOD=2.001                          *
    99*                                                                *
   100*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   101*                                                                *
   102******************************************************************
   103 01  SECURITY-MESSAGE.
   104     12  FILLER                          PIC X(30)
   105            VALUE '** LOGIC SECURITY VIOLATION -'.
   106     12  SM-READ                         PIC X(6).
   107     12  FILLER                          PIC X(5)
   108            VALUE ' PGM='.
   109     12  SM-PGM                          PIC X(6).
   110     12  FILLER                          PIC X(5)
   111            VALUE ' OPR='.
   112     12  SM-PROCESSOR-ID                 PIC X(4).
   113     12  FILLER                          PIC X(6)
   114            VALUE ' TERM='.
   115     12  SM-TERMID                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page   4
* EL156.cbl
   116     12  FILLER                          PIC XX   VALUE SPACE.
   117     12  SM-JUL-DATE                     PIC 9(5).
   118     12  FILLER                          PIC X    VALUE SPACE.
   119     12  SM-TIME                         PIC 99.99.
   120
   121
   122*    COPY ELCSCRTY.
   123******************************************************************
   124*                                                                *
   125*                                                                *
   126*                            ELCSCRTY                            *
   127*                            VMOD=2.001                          *
   128*                                                                *
   129*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   130*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   131*        SAVED IN PI-SECURITY-ADDRESS.                           *
   132*                                                                *
   133******************************************************************
   134 01  SECURITY-CONTROL.
   135     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   136     12  FILLER                       PIC XX    VALUE 'SC'.
   137     12  SC-CREDIT-CODES.
   138         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   139             20  SC-CREDIT-DISPLAY    PIC X.
   140             20  SC-CREDIT-UPDATE     PIC X.
   141     12  SC-CLAIMS-CODES.
   142         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   143             20  SC-CLAIMS-DISPLAY    PIC X.
   144             20  SC-CLAIMS-UPDATE     PIC X.
   145
   146 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   147 01  WS-DATE-AREA.
   148     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   149     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   150     12  SAVE-DATE-CCYYMMDD.
   151         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   152         16  SAVE-DATE-YMD.
   153             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   154             20  FILLER              PIC X(04)   VALUE SPACES.
   155
   156 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   157 01  STANDARD-AREAS.
   158     12  WS-RESPONSE         PIC S9(8)   COMP.
   159         88  WS-RESP-NORMAL              VALUE +00.
   160         88  WS-RESP-ERROR               VALUE +01.
   161         88  WS-RESP-NOTFND              VALUE +13.
   162         88  WS-RESP-DUPREC              VALUE +14.
   163         88  WS-RESP-ENDFILE             VALUE +20.
   164     12  PMT-HEAD-A.
   165         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   166         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   167         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   168-        '     RESERVES  TYPE    AMOUNT'.
   169     12  PMT-HEAD-B.
   170         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   171         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   172         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   173     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page   5
* EL156.cbl
   174     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   175     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   176     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   177     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   178     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   179     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   180     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   181     12  PGM-NAME            PIC X(8).
   182     12  TIME-IN             PIC S9(7).
   183     12  TIME-OUT-R  REDEFINES TIME-IN.
   184         16  FILLER          PIC X.
   185         16  TIME-OUT        PIC 99V99.
   186         16  FILLER          PIC XX.
   187     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   188     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   189     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   190     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   191     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   192     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   193     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   194     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   195     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   196     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   197     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   198     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   199     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   200     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   201     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   202     12  WS-BLANK            PIC X       VALUE ' '.
   203
   204 01  MISC-WORK-AREAS.
   205     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   206     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   207     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   208     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   209     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   210     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   211     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   212     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   213     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   214     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   215     12  W-CALLED-NAME           PIC X(08).
   216     12  W-EOB-CODES.
   217         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   218             20  W-EOB-CODE      PIC XXX.
   219             20  W-EOB-FILLER    PIC X.
   220     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   221     12  W-NAME-LAST             PIC X(15).
   222     12  W-NAME-FIRST            PIC X(15).
   223     12  W-NAME-MIDDLE.
   224         16  FILLER              PIC X.
   225         16  W-NAME-MIDDLE-2     PIC X.
   226         16  FILLER              PIC X(13).
   227     12  W-DMD-CHECK-NO.
   228         16  W-DMD-CHECK-NO-1    PIC X(4).
   229         16  W-DMD-CHECK-NO-2    PIC X.
   230         16  W-DMD-CHECK-NO-3    PIC XX.
   231
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page   6
* EL156.cbl
   232     12  WS-COMPUTE-FROM-DT  PIC XX.
   233     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   234     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   235     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   236     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   237     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   238     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   239         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   240         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   241     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   242         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   243     12  WS-UPDATE-SW        PIC X VALUE ' '.
   244     12  WS-GROUPING.
   245         16  WS-GROUP-1      PIC X VALUE SPACES.
   246         16  FILLER          PIC X(05) VALUE SPACES.
   247     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   248     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   249     12  WS-WORK-STATE-ACCT.
   250         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   251         16  FILLER          PIC X       VALUE '/'.
   252         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   253     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   254     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   255     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   256     12  QID.
   257         16  QID-TERM        PIC X(4)    VALUE SPACES.
   258         16  FILLER          PIC X(4)    VALUE '156A'.
   259     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   260     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   261     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   262     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   263     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   264     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   265     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   266     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   267     12  WS-STATUS           PIC X       VALUE SPACES.
   268     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   269     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   270     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   271     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   272     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   273     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   274     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   275     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   276     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   277     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   278     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   279     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   280     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   281     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   282     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   283     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   284     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   285     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   286     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   287     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   288     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   289     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page   7
* EL156.cbl
   290     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   291     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   292     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   293     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   294     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   295     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   296     12  WORK-DATE-FROM.
   297         16  WDF-MONTH       PIC 99        VALUE ZERO.
   298         16  WDF-DAY         PIC 99        VALUE ZERO.
   299         16  WDF-YEAR        PIC 99        VALUE ZERO.
   300     12  WORK-DATE-THRU.
   301         16  WDT-MONTH       PIC 99        VALUE ZERO.
   302         16  WDT-DAY         PIC 99        VALUE ZERO.
   303         16  WDT-YEAR        PIC 99        VALUE ZERO.
   304     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   305     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   306     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   307     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   308     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   309     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   310     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   311     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   312     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   313     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   314     12  WS-PY-WK REDEFINES WS-PY-WORK.
   315         16  WS-PY-NUM       PIC S9(7)V99.
   316         16  WS-PY-SIGN      PIC X.
   317     12  WS-DY-WORK          PIC S9(5).
   318     12  WS-DY-WK REDEFINES WS-DY-WORK.
   319         16  WS-DY-NUM       PIC S9(4).
   320         16  WS-DY-SIGN      PIC X.
   321     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   322         88  COMP-REC-FOUND              VALUE 'Y'.
   323     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   324         88  BENEFIT-FOUND       VALUE 'Y'.
   325         88  NO-BENEFIT-FOUND    VALUE 'N'.
   326     12  WS-TERMS.
   327         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   328         16  FILLER          PIC X       VALUE '/'.
   329         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   330         16  WST-REM-DAYS-GRP.
   331             20  WST-SLASH   PIC X       VALUE '/'.
   332             20  WST-REM-DAYS
   333                             PIC --9.
   334     12  WS-ACCESS.
   335         16  FILLER          PIC XX      VALUE SPACES.
   336         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   337     12  WS-STATE-ACCESS.
   338         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   339         16  FILLER          PIC XX      VALUE SPACES.
   340     12  WS-CARR-ACCESS.
   341         16  FILLER          PIC X(3)    VALUE SPACES.
   342         16  WS-CARR         PIC X       VALUE SPACES.
   343     12  DATE-WORK.
   344         16  FILLER          PIC XX      VALUE SPACES.
   345         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   346     12  WS-SAVE-INPUT.
   347         16  WS-PMTTYPE      PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page   8
* EL156.cbl
   348         16  WS-PAYEE        PIC XX      VALUE SPACE.
   349         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   350         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   351         16  WS-OFFLINE      PIC X       VALUE SPACE.
   352         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   353         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   354         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   355         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   356         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   357         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   358         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   359         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   360         16  WS-ETYPE        PIC X       VALUE SPACE.
   361         16  WS-CASH         PIC X       VALUE SPACE.
   362         16  WS-GROUPED      PIC X       VALUE SPACE.
   363         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   364         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   365         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   366         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   367         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   368         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   369         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   370         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   371     12  LAST-ERROR-LINE.
   372         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   373         16  FILLER              PIC X(30)
   374             VALUE ' FATAL ERRORS ENCOUNTERED'.
   375         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   376         16  FILLER              PIC X(28)
   377             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   378     12  WS-CHECK-AREA.
   379         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   380         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   381     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   382     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   383         16  FILLER              PIC XX.
   384         16  WS-A-CHECK-NUM-5    PIC 9(5).
   385     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   386         16  FILLER              PIC X.
   387         16  WS-A-CHECK-NUM-6    PIC 9(6).
   388     12  OPTION-1-SAVE-AREA.
   389         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   390         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   391     12  WS-WORK-ZIP.
   392         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   393         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   394     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   395                                 PIC 9(9).
   396     12  WS-FLI-PMTNOTE.
   397         16  WS-PMTOPTION        PIC XX.
   398         16  WS-DOCNAME          PIC X(28).
   399         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   400             20  WS-AMOUNT       PIC X(8).
   401             20  FILLER          PIC X(20).
   402         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   403             20  WS-NUM-AMT      PIC 9(6)V99.
   404             20  FILLER          PIC X(20).
   405
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page   9
* EL156.cbl
   406     12  WS-HAN-PMTNOTE.
   407         16  WS-HAN-PMT-CODE     PIC X.
   408         16  WS-HAN-PMT-NOTE     PIC X(39).
   409
   410     12  WS-NCL-PMT-OPTION       PIC XX.
   411         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   412
   413     12  WS-CLAIM-SEQUENCE.
   414         16  FILLER              PIC X VALUE '('.
   415         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   416         16  FILLER              PIC X(04) VALUE ' OF '.
   417         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   418         16  FILLER              PIC X VALUE ')'.
   419
   420     12  WS-REFUND-AMT           PIC Z(7).99.
   421     12  WS-CALC-INT             PIC S9(7)V99.
   422     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   423
   424     12  SUB                     PIC 99 VALUE ZEROS.
   425
   426     12  WS-BOANOTE1.
   427         16  WS-BOANOTE1-DESC    PIC X(11).
   428         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   429         16  FILLER              PIC X(17).
   430     12  WS-BOANOTE2.
   431         16  WS-BOANOTE2-DESC    PIC X(11).
   432         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   433         16  FILLER              PIC X(17).
   434
   435     12  WS-NCLNOTE1.
   436         16  WS-NCLNOTE1-DESC    PIC X(11).
   437         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   438         16  FILLER              PIC X(17).
   439     12  WS-NCLNOTE2.
   440         16  WS-NCLNOTE2-DESC    PIC X(11).
   441         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   442         16  FILLER              PIC X(17).
   443
   444     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   445     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   446     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   447     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   448     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   449     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   450     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   451     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   452     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   453     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   454
   455     12  WS-AIG-WORK-AREAS.
   456         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   457             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   458         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   459             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   460         16  WS-FROM-DATE-MDY.
   461             20  WS-FROM-MO      PIC 99.
   462             20  WS-FROM-DA      PIC 99.
   463             20  WS-FROM-YR      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  10
* EL156.cbl
   464         16  WS-TEMP-DATE-MDY.
   465             20  WS-TEMP-MO      PIC 99.
   466             20  WS-TEMP-DA      PIC 99.
   467             20  WS-TEMP-YR      PIC 99.
   468         16  WS-BIN-FROM-DT      PIC XX.
   469         16  WS-TEMP-INC-MDY.
   470             20  WS-TEMP-INC-MO  PIC 99.
   471             20  WS-TEMP-INC-DA  PIC 99.
   472             20  WS-TEMP-INC-YR  PIC 99.
   473         16  WS-PMT-DUE-MDY.
   474             20  WS-PMT-DUE-MO   PIC 99.
   475             20  WS-PMT-DUE-DA   PIC 99.
   476             20  WS-PMT-DUE-YR   PIC 99.
   477         16  WS-PMT-DUE-DT       PIC XX.
   478         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   479         16  WS-RETRO-ELIM-DT    PIC XX.
   480         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   481             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   482         16  WS-SAVE-DUE-DA      PIC 99.
   483         16  WS-CDAYS            PIC S9(05).
   484         16  WS-DAYS-OFF         PIC S9(05).
   485         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   486             88  ELIM-SATISFIED            VALUE 'Y'.
   487         16  WS-AIG-CHECKNO.
   488             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   489             20  WS-A-CHECKNO-3-7.
   490                 24  FILLER              PIC X(3)    VALUE SPACES.
   491                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   492                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   493         16  WS-AIG-GROUPING.
   494             20  WS-A-BENE               PIC XXX.
   495             20  FILLER                  PIC XXX.
   496         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   497             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   498             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   499         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   500                 VALUE 'UNEMPLOYMENT PAYMENT'.
   501         16  WS-CHK-THRU-DT              PIC XX.
   502         16  WS-HOLD-BIN-DATE-1          PIC XX.
   503
   504 01  MISC-CSO-AREA.
   505     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   506     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   507     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   508         88  APPROVAL-NEEDED                        VALUE 'Y'.
   509     12  WS-APPROV-NOTE                  PIC X(43)
   510         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   511     12  WS-3550-APPROV-NOTE             PIC X(43)
   512         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   513     12  WS-REAUDIT-NOTE                 PIC X(43)
   514         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   515     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   516     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   517     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   518     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   519     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   520     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   521     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  11
* EL156.cbl
   522         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   523     12  WS-PAYEE-CITY-STATE     PIC X(30).
   524     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   525         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   526     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   527     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   528     12  WS-WORK-NAME            PIC X(30).
   529     12  FILLER  REDEFINES WS-WORK-NAME.
   530         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   531     12  WS-INSURED-NAME         PIC X(30).
   532     12  FILLER  REDEFINES WS-INSURED-NAME.
   533         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   534     12  WS-PAYEE-NAME           PIC X(30).
   535     12  FILLER  REDEFINES WS-PAYEE-NAME.
   536         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   537
   538 01  ERROR-MESSAGES.
   539     12  ER-0000                 PIC X(4)  VALUE '0000'.
   540     12  ER-0004                 PIC X(4)  VALUE '0004'.
   541     12  ER-0008                 PIC X(4)  VALUE '0008'.
   542     12  ER-0019                 PIC X(4)  VALUE '0019'.
   543     12  ER-0029                 PIC X(4)  VALUE '0029'.
   544     12  ER-0042                 PIC X(4)  VALUE '0042'.
   545     12  ER-0070                 PIC X(4)  VALUE '0070'.
   546     12  ER-0130                 PIC X(4)  VALUE '0130'.
   547     12  ER-0149                 PIC X(4)  VALUE '0149'.
   548     12  ER-0154                 PIC X(4)  VALUE '0154'.
   549     12  ER-0168                 PIC X(4)  VALUE '0168'.
   550     12  ER-0169                 PIC X(4)  VALUE '0169'.
   551     12  ER-0172                 PIC X(4)  VALUE '0174'.
   552     12  ER-0198                 PIC X(4)  VALUE '0198'.
   553     12  ER-0204                 PIC X(4)  VALUE '0204'.
   554     12  ER-0206                 PIC X(4)  VALUE '0206'.
   555     12  ER-0252                 PIC X(4)  VALUE '0252'.
   556     12  ER-0254                 PIC X(4)  VALUE '0254'.
   557     12  ER-0282                 PIC X(4)  VALUE '0282'.
   558     12  ER-0283                 PIC X(4)  VALUE '0283'.
   559     12  ER-0294                 PIC X(4)  VALUE '0294'.
   560     12  ER-0338                 PIC X(4)  VALUE '0338'.
   561     12  ER-0419                 PIC X(4)  VALUE '0419'.
   562     12  ER-0420                 PIC X(4)  VALUE '0420'.
   563     12  ER-0421                 PIC X(4)  VALUE '0421'.
   564     12  ER-0422                 PIC X(4)  VALUE '0422'.
   565     12  ER-0433                 PIC X(4)  VALUE '0433'.
   566     12  ER-0436                 PIC X(4)  VALUE '0436'.
   567     12  ER-0437                 PIC X(4)  VALUE '0437'.
   568     12  ER-0438                 PIC X(4)  VALUE '0438'.
   569     12  ER-0439                 PIC X(4)  VALUE '0439'.
   570     12  ER-0440                 PIC X(4)  VALUE '0440'.
   571     12  ER-0441                 PIC X(4)  VALUE '0441'.
   572     12  ER-0442                 PIC X(4)  VALUE '0442'.
   573     12  ER-0443                 PIC X(4)  VALUE '0443'.
   574     12  ER-0444                 PIC X(4)  VALUE '0444'.
   575     12  ER-0445                 PIC X(4)  VALUE '0445'.
   576     12  ER-0446                 PIC X(4)  VALUE '0446'.
   577     12  ER-0447                 PIC X(4)  VALUE '0447'.
   578     12  ER-0448                 PIC X(4)  VALUE '0448'.
   579     12  ER-0449                 PIC X(4)  VALUE '0449'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  12
* EL156.cbl
   580     12  ER-0452                 PIC X(4)  VALUE '0452'.
   581     12  ER-0458                 PIC X(4)  VALUE '0458'.
   582     12  ER-0459                 PIC X(4)  VALUE '0459'.
   583     12  ER-0460                 PIC X(4)  VALUE '0460'.
   584     12  ER-0461                 PIC X(4)  VALUE '0461'.
   585     12  ER-0462                 PIC X(4)  VALUE '0462'.
   586     12  ER-0463                 PIC X(4)  VALUE '0463'.
   587     12  ER-0464                 PIC X(4)  VALUE '0464'.
   588     12  ER-0465                 PIC X(4)  VALUE '0465'.
   589     12  ER-0466                 PIC X(4)  VALUE '0466'.
   590     12  ER-0467                 PIC X(4)  VALUE '0467'.
   591     12  ER-0468                 PIC X(4)  VALUE '0468'.
   592     12  ER-0469                 PIC X(4)  VALUE '0469'.
   593     12  ER-0473                 PIC X(4)  VALUE '0473'.
   594     12  ER-0474                 PIC X(4)  VALUE '0474'.
   595     12  ER-0475                 PIC X(4)  VALUE '0475'.
   596     12  ER-0476                 PIC X(4)  VALUE '0476'.
   597     12  ER-0477                 PIC X(4)  VALUE '0477'.
   598     12  ER-0478                 PIC X(4)  VALUE '0478'.
   599     12  ER-0479                 PIC X(4)  VALUE '0479'.
   600     12  ER-0481                 PIC X(4)  VALUE '0481'.
   601     12  ER-0491                 PIC X(4)  VALUE '0491'.
   602     12  ER-0492                 PIC X(4)  VALUE '0492'.
   603     12  ER-0493                 PIC X(4)  VALUE '0493'.
   604     12  ER-0494                 PIC X(4)  VALUE '0494'.
   605     12  ER-0495                 PIC X(4)  VALUE '0495'.
   606     12  ER-0499                 PIC X(4)  VALUE '0499'.
   607     12  ER-0500                 PIC X(4)  VALUE '0500'.
   608     12  ER-0501                 PIC X(4)  VALUE '0501'.
   609     12  ER-0502                 PIC X(4)  VALUE '0502'.
   610     12  ER-0508                 PIC X(4)  VALUE '0508'.
   611     12  ER-0513                 PIC X(4)  VALUE '0513'.
   612     12  ER-0518                 PIC X(4)  VALUE '0518'.
   613     12  ER-0524                 PIC X(4)  VALUE '0524'.
   614     12  ER-0525                 PIC X(4)  VALUE '0525'.
   615     12  ER-0526                 PIC X(4)  VALUE '0526'.
   616     12  ER-0530                 PIC X(4)  VALUE '0530'.
   617     12  ER-0540                 PIC X(4)  VALUE '0540'.
   618     12  ER-0541                 PIC X(4)  VALUE '0541'.
   619     12  ER-0542                 PIC X(4)  VALUE '0542'.
   620     12  ER-0543                 PIC X(4)  VALUE '0543'.
   621     12  ER-0545                 PIC X(4)  VALUE '0545'.
   622     12  ER-0552                 PIC X(4)  VALUE '0552'.
   623     12  ER-0555                 PIC X(4)  VALUE '0555'.
   624     12  ER-0556                 PIC X(4)  VALUE '0556'.
   625     12  ER-0557                 PIC X(4)  VALUE '0557'.
   626     12  ER-0572                 PIC X(4)  VALUE '0572'.
   627     12  ER-0573                 PIC X(4)  VALUE '0573'.
   628     12  ER-0594                 PIC X(4)  VALUE '0594'.
   629     12  ER-0616                 PIC X(4)  VALUE '0616'.
   630     12  ER-0617                 PIC X(4)  VALUE '0617'.
   631     12  ER-0618                 PIC X(4)  VALUE '0618'.
   632     12  ER-0657                 PIC X(4)  VALUE '0657'.
   633     12  ER-0658                 PIC X(4)  VALUE '0658'.
   634     12  ER-0699                 PIC X(4)  VALUE '0699'.
   635     12  ER-0730                 PIC X(4)  VALUE '0730'.
   636     12  ER-0737                 PIC X(4)  VALUE '0737'.
   637     12  ER-0760                 PIC X(4)  VALUE '0760'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  13
* EL156.cbl
   638     12  ER-0768                 PIC X(4)  VALUE '0768'.
   639     12  ER-0769                 PIC X(4)  VALUE '0769'.
   640     12  ER-0770                 PIC X(4)  VALUE '0770'.
   641     12  ER-0802                 PIC X(4)  VALUE '0802'.
   642     12  ER-0803                 PIC X(4)  VALUE '0803'.
   643     12  ER-0819                 PIC X(4)  VALUE '0819'.
   644     12  ER-0834                 PIC X(4)  VALUE '0834'.
   645     12  ER-0836                 PIC X(4)  VALUE '0836'.
   646     12  ER-0844                 PIC X(4)  VALUE '0844'.
   647     12  ER-0845                 PIC X(4)  VALUE '0845'.
   648     12  ER-0846                 PIC X(4)  VALUE '0846'.
   649     12  ER-0849                 PIC X(4)  VALUE '0849'.
   650     12  ER-0851                 PIC X(4)  VALUE '0851'.
   651     12  ER-0872                 PIC X(4)  VALUE '0872'.
   652     12  ER-0873                 PIC X(4)  VALUE '0873'.
   653     12  ER-0874                 PIC X(4)  VALUE '0874'.
   654     12  ER-0879                 PIC X(4)  VALUE '0879'.
   655     12  ER-0919                 PIC X(4)  VALUE '0919'.
   656     12  ER-0921                 PIC X(4)  VALUE '0921'.
   657     12  ER-0923                 PIC X(4)  VALUE '0923'.
   658     12  ER-0925                 PIC X(4)  VALUE '0925'.
   659     12  ER-0944                 PIC X(4)  VALUE '0944'.
   660     12  ER-0945                 PIC X(4)  VALUE '0945'.
   661     12  ER-0946                 PIC X(4)  VALUE '0946'.
   662     12  ER-0947                 PIC X(4)  VALUE '0947'.
   663     12  ER-0948                 PIC X(4)  VALUE '0948'.
   664     12  ER-0949                 PIC X(4)  VALUE '0949'.
   665     12  ER-0950                 PIC X(4)  VALUE '0950'.
   666     12  ER-0951                 PIC X(4)  VALUE '0951'.
   667     12  ER-0954                 PIC X(4)  VALUE '0954'.
   668     12  ER-0956                 PIC X(4)  VALUE '0956'.
   669     12  ER-0967                 PIC X(4)  VALUE '0967'.
   670     12  ER-0968                 PIC X(4)  VALUE '0968'.
   671     12  ER-0974                 PIC X(4)  VALUE '0974'.
   672     12  ER-0975                 PIC X(4)  VALUE '0975'.
   673     12  ER-1561                 PIC X(4)  VALUE '1561'.
   674     12  ER-1566                 PIC X(4)  VALUE '1566'.
   675     12  ER-1567                 PIC X(4)  VALUE '1567'.
   676     12  ER-1569                 PIC X(4)  VALUE '1569'.
   677     12  er-1657                 pic x(4)  value '1657'.
   678     12  er-1658                 pic x(4)  value '1658'.
   679     12  er-1667                 pic x(4)  value '1667'.
   680     12  er-1670                 pic x(4)  value '1670'.
   681     12  er-1671                 pic x(4)  value '1671'.
   682     12  er-1672                 pic x(4)  value '1672'.
   683     12  er-1673                 pic x(4)  value '1673'.
   684     12  er-1674                 pic x(4)  value '1674'.
   685     12  ER-1775                 PIC X(4)  VALUE '1775'.
   686     12  ER-1880                 PIC X(4)  VALUE '1880'.
   687     12  ER-2044                 PIC X(4)  VALUE '2044'.
   688     12  ER-3140                 PIC X(4)  VALUE '3140'.
   689     12  ER-3141                 PIC X(4)  VALUE '3141'.
   690     12  ER-3255                 PIC X(4)  VALUE '3255'.
   691     12  ER-3516                 PIC X(4)  VALUE '3516'.
   692     12  ER-3527                 PIC X(4)  VALUE '3527'.
   693     12  ER-3528                 PIC X(4)  VALUE '3528'.
   694     12  ER-3529                 PIC X(4)  VALUE '3529'.
   695     12  ER-3530                 PIC X(4)  VALUE '3530'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  14
* EL156.cbl
   696     12  ER-3531                 PIC X(4)  VALUE '3531'.
   697     12  ER-3532                 PIC X(4)  VALUE '3532'.
   698     12  ER-3533                 PIC X(4)  VALUE '3533'.
   699     12  ER-3534                 PIC X(4)  VALUE '3534'.
   700     12  ER-3535                 PIC X(4)  VALUE '3535'.
   701     12  ER-3536                 PIC X(4)  VALUE '3536'.
   702     12  ER-3537                 PIC X(4)  VALUE '3537'.
   703     12  ER-3538                 PIC X(4)  VALUE '3538'.
   704     12  ER-3539                 PIC X(4)  VALUE '3539'.
   705     12  ER-3540                 PIC X(4)  VALUE '3540'.
   706     12  ER-3541                 PIC X(4)  VALUE '3541'.
   707     12  ER-3542                 PIC X(4)  VALUE '3542'.
   708     12  ER-3543                 PIC X(4)  VALUE '3543'.
   709     12  ER-3546                 PIC X(4)  VALUE '3546'.
   710     12  ER-3549                 PIC X(4)  VALUE '3549'.
   711     12  ER-3818                 PIC X(4)  VALUE '3818'.
   712     12  ER-7540                 PIC X(4)  VALUE '7540'.
   713     12  ER-7576                 PIC X(4)  VALUE '7576'.
   714     12  ER-7579                 PIC X(4)  VALUE '7579'.
   715     12  ER-7580                 PIC X(4)  VALUE '7580'.
   716     12  ER-7583                 PIC X(4)  VALUE '7583'.
   717     12  ER-7830                 PIC X(4)  VALUE '7830'.
   718     12  ER-7831                 PIC X(4)  VALUE '7831'.
   719     12  ER-7832                 PIC X(4)  VALUE '7832'.
   720     12  ER-7833                 PIC X(4)  VALUE '7833'.
   721     12  ER-7834                 PIC X(4)  VALUE '7834'.
   722     12  ER-7835                 PIC X(4)  VALUE '7835'.
   723     12  ER-7836                 PIC X(4)  VALUE '7836'.
   724     12  ER-7837                 PIC X(4)  VALUE '7837'.
   725     12  ER-7838                 PIC X(4)  VALUE '7838'.
   726     12  ER-7841                 PIC X(4)  VALUE '7841'.
   727     12  ER-7844                 PIC X(4)  VALUE '7844'.
   728     12  ER-7845                 PIC X(4)  VALUE '7845'.
   729     12  ER-8000                 PIC X(4)  VALUE '8000'.
   730     12  ER-8051                 PIC X(4)  VALUE '8051'.
   731     12  ER-8052                 PIC X(4)  VALUE '8052'.
   732     12  ER-8053                 PIC X(4)  VALUE '8053'.
   733     12  ER-8054                 PIC X(4)  VALUE '8054'.
   734     12  ER-8055                 PIC X(4)  VALUE '8055'.
   735     12  ER-8056                 PIC X(4)  VALUE '8056'.
   736     12  ER-8057                 PIC X(4)  VALUE '8057'.
   737     12  ER-8058                 PIC X(4)  VALUE '8058'.
   738     12  ER-8059                 PIC X(4)  VALUE '8059'.
   739     12  ER-8060                 PIC X(4)  VALUE '8060'.
   740     12  ER-8061                 PIC X(4)  VALUE '8061'.
   741     12  ER-8062                 PIC X(4)  VALUE '8062'.
   742     12  ER-8063                 PIC X(4)  VALUE '8063'.
   743     12  ER-8064                 PIC X(4)  VALUE '8064'.
   744     12  ER-8065                 PIC X(4)  VALUE '8065'.
   745     12  ER-8066                 PIC X(4)  VALUE '8066'.
   746     12  ER-8146                 PIC X(4)  VALUE '8146'.
   747     12  ER-8147                 PIC X(4)  VALUE '8147'.
   748     12  ER-8152                 PIC X(4)  VALUE '8152'.
   749     12  ER-8153                 PIC X(4)  VALUE '8153'.
   750     12  ER-8154                 PIC X(4)  VALUE '8154'.
   751     12  ER-8155                 PIC X(4)  VALUE '8155'.
   752     12  ER-8310                 PIC X(4)  VALUE '8310'.
   753     12  ER-8311                 PIC X(4)  VALUE '8311'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  15
* EL156.cbl
   754     12  ER-8312                 PIC X(4)  VALUE '8312'.
   755     12  ER-8313                 PIC X(4)  VALUE '8313'.
   756     12  ER-8314                 PIC X(4)  VALUE '8314'.
   757     12  ER-8315                 PIC X(4)  VALUE '8315'.
   758     12  ER-8316                 PIC X(4)  VALUE '8316'.
   759     12  ER-8317                 PIC X(4)  VALUE '8317'.
   760
   761 01  CSO-WORK-FIELDS.
   762     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   763       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   764
   765     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   766     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   767         88  CERT-NOTE-ADDED           VALUE 'Y'.
   768     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   769         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   770     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   771
   772     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   773
   774 01  SC-NP6-CERT-NOTE.
   775     12  FILLER                  PIC X(12)
   776               VALUE 'REM BENEFIT '.
   777     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   778     12  SC-NP6-COMM             PIC X(8)
   779               VALUE ' + 6 MO '.
   780     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   781     12  FILLER                  PIC X(12)
   782               VALUE ' = AMT PAID '.
   783     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   784
   785 01  SC-NP6-ORIG-NOTE.
   786     12  FILLER                  PIC X(63)  VALUE
   787         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   788 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   789     88  PDEF-FOUND                   VALUE 'Y'.
   790 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   791     88  ACCT-FOUND                   VALUE 'Y'.
   792 01  CTBL-KEY-SAVE               PIC X(5).
   793 01  CTBL-KEY.
   794     05  CTBL-COMPANY-CD         PIC X.
   795     05  CTBL-TABLE              PIC XXX.
   796     05  CTBL-BEN-TYPE           PIC X.
   797     05  CTBL-BEN-CODE           PIC XX.
   798 01  ERPDEF-KEY-SAVE             PIC X(18).
   799 01  ERPDEF-KEY.
   800     12  ERPDEF-COMPANY-CD       PIC X.
   801     12  ERPDEF-STATE            PIC XX.
   802     12  ERPDEF-PROD-CD          PIC XXX.
   803     12  F                       PIC X(7).
   804     12  ERPDEF-BEN-TYPE         PIC X.
   805     12  ERPDEF-BEN-CODE         PIC XX.
   806     12  ERPDEF-EXP-DT           PIC XX.
   807 01  ELCRTT-KEY.
   808     05  CTRLR-COMP-CD       PIC X.
   809     05  CTRLR-CARRIER       PIC X.
   810     05  CTRLR-GROUPING      PIC X(6).
   811     05  CTRLR-STATE         PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  16
* EL156.cbl
   812     05  CTRLR-ACCOUNT       PIC X(10).
   813     05  CTRLR-EFF-DT        PIC XX.
   814     05  CTRLR-CERT-NO       PIC X(11).
   815     05  CTRLR-REC-TYPE      PIC X.
   816 01  ACCESS-KEYS.
   817     12  ELARCH-KEY.
   818         16  ARCH-CO             PIC X.
   819         16  ARCH-NUMBER         PIC S9(08) COMP.
   820         16  ARCH-REC-TYPE       PIC X.
   821         16  ARCH-SEQ            PIC S9(04) COMP.
   822     12  ELMSTR-KEY.
   823         16  MSTR-COMP-CD        PIC X.
   824         16  MSTR-CARRIER        PIC X.
   825         16  MSTR-CLAIM-NO       PIC X(7).
   826         16  MSTR-CERT-NO        PIC X(11).
   827     12  ELCNTL-KEY.
   828         16  CNTL-COMP-ID        PIC X(3).
   829         16  CNTL-REC-TYPE       PIC X.
   830         16  CNTL-ACCESS         PIC X(4).
   831         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   832     12  ELCERT-KEY.
   833         16  CERT-COMP-CD        PIC X.
   834         16  CERT-CARRIER        PIC X.
   835         16  CERT-GROUPING       PIC X(6).
   836         16  CERT-STATE          PIC XX.
   837         16  CERT-ACCOUNT        PIC X(10).
   838         16  CERT-EFF-DT         PIC XX.
   839         16  CERT-CERT-NO        PIC X(11).
   840     12  ELTRLR-KEY.
   841         16  TRLR-COMP-CD        PIC X.
   842         16  TRLR-CARRIER        PIC X.
   843         16  TRLR-CLAIM-NO       PIC X(7).
   844         16  TRLR-CERT-NO        PIC X(11).
   845         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   846     12  ELACTQ-KEY.
   847         16  ACTQ-COMP-CD        PIC X.
   848         16  ACTQ-CARRIER        PIC X.
   849         16  ACTQ-CLAIM-NO       PIC X(7).
   850         16  ACTQ-CERT-NO        PIC X(11).
   851     12  W-NOTE-KEY.
   852         16  W-NOTE-COMP-CD      PIC X.
   853         16  W-NOTE-CERT-KEY.
   854             20  W-NOTE-CARRIER  PIC X.
   855             20  W-NOTE-GROUPING PIC X(6).
   856             20  W-NOTE-STATE    PIC XX.
   857             20  W-NOTE-ACCOUNT  PIC X(10).
   858             20  W-NOTE-EFF-DT   PIC XX.
   859             20  W-NOTE-CERT-NO  PIC X(11).
   860     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   861     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   862     12  ERACCT-KEY.
   863         16  ERACCT-PARTIAL-KEY.
   864             20  ACCT-COMP-CD    PIC X.
   865             20  ACCT-CARRIER    PIC X.
   866             20  ACCT-GROUPING   PIC X(6).
   867             20  ACCT-STATE      PIC XX.
   868             20  ACCT-ACCOUNT    PIC X(10).
   869         16  ACCT-EXP-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  17
* EL156.cbl
   870         16  FILLER              PIC X(4) VALUE SPACES.
   871     12  ELCHKQ-KEY.
   872         16  CHKQ-COMP-CD        PIC X.
   873         16  CHKQ-CONTROL        PIC S9(8) COMP.
   874         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   875     12  ELBENE-KEY.
   876         16  BENE-COMP-CD         PIC X.
   877         16  BENE-RECORD-TYPE     PIC X.
   878         16  BENE-NUMBER          PIC X(10).
   879     12  ERCOMP-KEY.
   880         16  COMP-COMP-CD        PIC X.
   881         16  COMP-CARRIER        PIC X.
   882         16  COMP-GROUP          PIC X(06).
   883         16  COMP-FIN-RESP       PIC X(10).
   884         16  COMP-ACCOUNT        PIC X(10).
   885         16  COMP-TYPE           PIC X.
   886
   887     12  DLO035-KEY.
   888         16  DL35-PROCESS-TYPE   PIC X.
   889         16  DL35-CREDIT-CARD    PIC X(20).
   890         16  DL35-BEN-TYPE       PIC XX.
   891         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   892         16  DL35-RETURN-CODE    PIC XX.
   893
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  18
* EL156.cbl
   895*    COPY ELCDATE.
   896******************************************************************
   897*                                                                *
   898*                                                                *
   899*                            ELCDATE.                            *
   900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   901*                            VMOD=2.003
   902*                                                                *
   903*                                                                *
   904*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   905*                 LENGTH = 200                                   *
   906******************************************************************
   907
   908 01  DATE-CONVERSION-DATA.
   909     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   910     12  DC-OPTION-CODE                PIC X.
   911         88  BIN-TO-GREG                VALUE ' '.
   912         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   913         88  EDIT-GREG-TO-BIN           VALUE '2'.
   914         88  YMD-GREG-TO-BIN            VALUE '3'.
   915         88  MDY-GREG-TO-BIN            VALUE '4'.
   916         88  JULIAN-TO-BIN              VALUE '5'.
   917         88  BIN-PLUS-ELAPSED           VALUE '6'.
   918         88  FIND-CENTURY               VALUE '7'.
   919         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   920         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   921         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   922         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   923         88  JULIAN-TO-BIN-3            VALUE 'C'.
   924         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   925         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   926         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   927         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   928         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   929         88  CHECK-LEAP-YEAR            VALUE 'H'.
   930         88  BIN-3-TO-GREG              VALUE 'I'.
   931         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   932         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   933         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   934         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   935         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   936         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   937         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   938         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   939         88  THREE-CHARACTER-BIN
   940                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   941         88  GREGORIAN-TO-BIN
   942                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   943         88  BIN-TO-GREGORIAN
   944                  VALUES ' ' '1' 'I' '8' 'G'.
   945         88  JULIAN-TO-BINARY
   946                  VALUES '5' 'C' 'E' 'F'.
   947     12  DC-ERROR-CODE                 PIC X.
   948         88  NO-CONVERSION-ERROR        VALUE ' '.
   949         88  DATE-CONVERSION-ERROR
   950                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   951         88  DATE-IS-ZERO               VALUE '1'.
   952         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  19
* EL156.cbl
   953         88  DATE-IS-INVALID            VALUE '3'.
   954         88  DATE1-GREATER-DATE2        VALUE '4'.
   955         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   956         88  DATE-INVALID-OPTION        VALUE '9'.
   957         88  INVALID-CENTURY            VALUE 'A'.
   958         88  ONLY-CENTURY               VALUE 'B'.
   959         88  ONLY-LEAP-YEAR             VALUE 'C'.
   960         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   961     12  DC-END-OF-MONTH               PIC X.
   962         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   963     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   964         88  USE-NORMAL-PROCESS         VALUE ' '.
   965         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   966         88  ADJUST-UP-100-YRS          VALUE '2'.
   967     12  FILLER                        PIC X.
   968     12  DC-CONVERSION-DATES.
   969         16  DC-BIN-DATE-1             PIC XX.
   970         16  DC-BIN-DATE-2             PIC XX.
   971         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   972         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   973                       DC-GREG-DATE-1-EDIT.
   974             20  DC-EDIT1-MONTH        PIC 99.
   975             20  SLASH1-1              PIC X.
   976             20  DC-EDIT1-DAY          PIC 99.
   977             20  SLASH1-2              PIC X.
   978             20  DC-EDIT1-YEAR         PIC 99.
   979         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   980         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   981                     DC-GREG-DATE-2-EDIT.
   982             20  DC-EDIT2-MONTH        PIC 99.
   983             20  SLASH2-1              PIC X.
   984             20  DC-EDIT2-DAY          PIC 99.
   985             20  SLASH2-2              PIC X.
   986             20  DC-EDIT2-YEAR         PIC 99.
   987         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   988         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   989                     DC-GREG-DATE-1-YMD.
   990             20  DC-YMD-YEAR           PIC 99.
   991             20  DC-YMD-MONTH          PIC 99.
   992             20  DC-YMD-DAY            PIC 99.
   993         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   994         16  DC-GREG-DATE-1-MDY-R REDEFINES
   995                      DC-GREG-DATE-1-MDY.
   996             20  DC-MDY-MONTH          PIC 99.
   997             20  DC-MDY-DAY            PIC 99.
   998             20  DC-MDY-YEAR           PIC 99.
   999         16  DC-GREG-DATE-1-ALPHA.
  1000             20  DC-ALPHA-MONTH        PIC X(10).
  1001             20  DC-ALPHA-DAY          PIC 99.
  1002             20  FILLER                PIC XX.
  1003             20  DC-ALPHA-CENTURY.
  1004                 24 DC-ALPHA-CEN-N     PIC 99.
  1005             20  DC-ALPHA-YEAR         PIC 99.
  1006         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1007         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1008         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1009         16  DC-JULIAN-DATE            PIC 9(05).
  1010         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  20
* EL156.cbl
  1011                                       PIC 9(05).
  1012         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1013             20  DC-JULIAN-YEAR        PIC 99.
  1014             20  DC-JULIAN-DAYS        PIC 999.
  1015         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1016         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1017         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1018     12  DATE-CONVERSION-VARIBLES.
  1019         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1020         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1021             20  FILLER                PIC 9(3).
  1022             20  HOLD-CEN-1-CCYY.
  1023                 24  HOLD-CEN-1-CC     PIC 99.
  1024                 24  HOLD-CEN-1-YY     PIC 99.
  1025             20  HOLD-CEN-1-MO         PIC 99.
  1026             20  HOLD-CEN-1-DA         PIC 99.
  1027         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1028             20  HOLD-CEN-1-R-MO       PIC 99.
  1029             20  HOLD-CEN-1-R-DA       PIC 99.
  1030             20  HOLD-CEN-1-R-CCYY.
  1031                 24  HOLD-CEN-1-R-CC   PIC 99.
  1032                 24  HOLD-CEN-1-R-YY   PIC 99.
  1033             20  FILLER                PIC 9(3).
  1034         16  HOLD-CENTURY-1-X.
  1035             20  FILLER                PIC X(3)  VALUE SPACES.
  1036             20  HOLD-CEN-1-X-CCYY.
  1037                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1038                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1039             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1040             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1041         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1042             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1043             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1044             20  HOLD-CEN-1-R-X-CCYY.
  1045                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1046                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1047             20  FILLER                PIC XXX.
  1048         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1049         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1050         16  DC-JULIAN-DATE-1          PIC 9(07).
  1051         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1052             20  DC-JULIAN-1-CCYY.
  1053                 24  DC-JULIAN-1-CC    PIC 99.
  1054                 24  DC-JULIAN-1-YR    PIC 99.
  1055             20  DC-JULIAN-DA-1        PIC 999.
  1056         16  DC-JULIAN-DATE-2          PIC 9(07).
  1057         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1058             20  DC-JULIAN-2-CCYY.
  1059                 24  DC-JULIAN-2-CC    PIC 99.
  1060                 24  DC-JULIAN-2-YR    PIC 99.
  1061             20  DC-JULIAN-DA-2        PIC 999.
  1062         16  DC-GREG-DATE-A-EDIT.
  1063             20  DC-EDITA-MONTH        PIC 99.
  1064             20  SLASHA-1              PIC X VALUE '/'.
  1065             20  DC-EDITA-DAY          PIC 99.
  1066             20  SLASHA-2              PIC X VALUE '/'.
  1067             20  DC-EDITA-CCYY.
  1068                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  21
* EL156.cbl
  1069                 24  DC-EDITA-YEAR     PIC 99.
  1070         16  DC-GREG-DATE-B-EDIT.
  1071             20  DC-EDITB-MONTH        PIC 99.
  1072             20  SLASHB-1              PIC X VALUE '/'.
  1073             20  DC-EDITB-DAY          PIC 99.
  1074             20  SLASHB-2              PIC X VALUE '/'.
  1075             20  DC-EDITB-CCYY.
  1076                 24  DC-EDITB-CENT     PIC 99.
  1077                 24  DC-EDITB-YEAR     PIC 99.
  1078         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1079         16  DC-GREG-DATE-CYMD-R REDEFINES
  1080                              DC-GREG-DATE-CYMD.
  1081             20  DC-CYMD-CEN           PIC 99.
  1082             20  DC-CYMD-YEAR          PIC 99.
  1083             20  DC-CYMD-MONTH         PIC 99.
  1084             20  DC-CYMD-DAY           PIC 99.
  1085         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1086         16  DC-GREG-DATE-MDCY-R REDEFINES
  1087                              DC-GREG-DATE-MDCY.
  1088             20  DC-MDCY-MONTH         PIC 99.
  1089             20  DC-MDCY-DAY           PIC 99.
  1090             20  DC-MDCY-CEN           PIC 99.
  1091             20  DC-MDCY-YEAR          PIC 99.
  1092    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1093        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1094    12  DC-EL310-DATE                  PIC X(21).
  1095    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  22
* EL156.cbl
  1097*    COPY ELCLOGOF.
  1098******************************************************************
  1099*                                                                *
  1100*                                                                *
  1101*                            ELCLOGOF.                           *
  1102*                            VMOD=2.001                          *
  1103*                                                                *
  1104*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1105*                                                                *
  1106******************************************************************
  1107 01  CLASIC-LOGOFF.
  1108     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1109     12  LOGOFF-TEXT.
  1110         16  FILLER          PIC X(5)    VALUE SPACES.
  1111         16  LOGOFF-MSG.
  1112             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1113             20  FILLER      PIC X       VALUE SPACES.
  1114             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1115         16  FILLER          PIC X(80)
  1116           VALUE '* YOU ARE NOW LOGGED OFF'.
  1117         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1118         16  FILLER          PIC X       VALUE QUOTE.
  1119         16  LOGOFF-SYS-MSG  PIC X(17)
  1120           VALUE 'S CLAS-IC SYSTEM '.
  1121     12  TEXT-MESSAGES.
  1122         16  UNACCESS-MSG    PIC X(29)
  1123             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1124         16  PGMIDERR-MSG    PIC X(17)
  1125             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  23
* EL156.cbl
  1127*    COPY ELCCALC.
  1128******************************************************************
  1129*                                                                *
  1130*                           ELCCALC.                            *
  1131*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1132*                            VMOD=2.025                          *
  1133*                                                                *
  1134*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1135*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1136*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1137*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1138*                                                                *
  1139*  PASSED TO ELRTRM                                              *
  1140*  -----------------                                             *
  1141*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1142*  ORIGINAL TERM                                                 *
  1143*  BEGINNING DATE                                                *
  1144*  ENDING DATE                                                   *
  1145*  COMPANY I.D.                                                  *
  1146*  ACCOUNT MASTER USER FIELD                                     *
  1147*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1148*  FREE LOOK DAYS                                                *
  1149*                                                                *
  1150*  RETURNED FROM ELRTRM                                          *
  1151*  ---------------------                                         *
  1152*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1153*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1154*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1155*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1156*----------------------------------------------------------------*
  1157*  PASSED TO ELRAMT                                              *
  1158*  ----------------                                              *
  1159*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1160*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1161*  ORIGINAL AMOUNT                                               *
  1162*  ALTERNATE BENEFIT (BALLON)                                    *
  1163*  A.P.R. - NET PAY ONLY                                         *
  1164*  METHOD
  1165*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1166*  COMPANY I.D.                                                  *
  1167*  BENEFIT TYPE                                                  *
  1168*                                                                *
  1169*  RETURNED FROM ELRAMT                                          *
  1170*  --------------------                                          *
  1171*  REMAINING AMOUNT 1 - CURRENT                                  *
  1172*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1173*  REMAINING AMOUNT FACTOR
  1174*----------------------------------------------------------------*
  1175*  PASSED TO ELRESV                                              *
  1176*  -----------------                                             *
  1177*  CERTIFICATE EFFECTIVE DATE                                    *
  1178*  VALUATION DATE                                                *
  1179*  PAID THRU DATE                                                *
  1180*  BENEFIT                                                       *
  1181*  INCURRED DATE                                                 *
  1182*  REPORTED DATE                                                 *
  1183*  ISSUE AGE                                                     *
  1184*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  24
* EL156.cbl
  1185*  CDT PERCENT                                                   *
  1186*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1187* *CLAIM TYPE (LIFE, A/H)                                        *
  1188* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1189* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1190*                                                                *
  1191*  RETURNED FROM ELRESV                                          *
  1192*  --------------------                                          *
  1193*  CDT TABLE USED                                                *
  1194*  CDT FACTOR USED                                               *
  1195*  PAY TO CURRENT RESERVE                                        *
  1196*  I.B.N.R. - A/H ONLY                                           *
  1197*  FUTURE (ACCRUED) AH ONLY                                      *
  1198*----------------------------------------------------------------*
  1199*  PASSED TO ELRATE                                              *
  1200*  ----------------                                              *
  1201*  CERT ISSUE DATE                                               *
  1202*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1203*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1204*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1205*  STATE CODE (CLIENT DEFINED)                                   *
  1206*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1207*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1208*  DEVIATION CODE                                                *
  1209*  ISSUE AGE                                                     *
  1210*  ORIGINAL BENEFIT AMOUNT                                       *
  1211*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1212*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1213*  BENEFIT KIND (LIFE OR A/H)                                    *
  1214*  A.P.R.                                                        *
  1215*  METHOD
  1216*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1217*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1218*  COMPANY I.D. (3 CHARACTER)                                    *
  1219*  BENEFIT CODE                                                  *
  1220*  BENEFIT OVERRIDE CODE                                         *
  1221*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1222*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1223*  JOINT INDICATOR (CSL ONLY)                                    *
  1224*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1225*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1226*                                                                *
  1227*  RETURNED FROM ELRATE                                          *
  1228*  --------------------                                          *
  1229*  CALCULATED PREMIUM                                            *
  1230*  PREMIUM RATE                                                  *
  1231*  MORTALITY CODE                                                *
  1232*  MAX ATTAINED AGE                                              *
  1233*  MAX AGE                                                       *
  1234*  MAX TERM                                                      *
  1235*  MAX MONTHLY BENEFIT                                           *
  1236*  MAX TOTAL BENIFIT                                             *
  1237*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1238*----------------------------------------------------------------*
  1239*  PASSED TO ELRFND                                              *
  1240*  ----------------                                              *
  1241*  CERT ISSUE DATE                                               *
  1242*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  25
* EL156.cbl
  1243*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1244*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1245*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1246*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1247*  STATE CODE (CLIENT DEFINED)                                   *
  1248*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1249*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1250*  DEVIATION CODE                                                *
  1251*  ISSUE AGE                                                     *
  1252*  ORIGINAL BENEFIT AMOUNT                                       *
  1253*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1254*  PROCESS TYPE (CANCEL)                                         *
  1255*  BENEFIT KIND (LIFE OR A/H)                                    *
  1256*  A.P.R.                                                        *
  1257*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1258*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1259*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1260*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1261*  COMPANY I.D. (3 CHARACTER)                                    *
  1262*  BENEFIT CODE                                                  *
  1263*  BENEFIT OVERRIDE CODE                                         *
  1264*                                                                *
  1265*  RETURNED FROM ELRFND                                          *
  1266*  --------------------                                          *
  1267*  CALCULATED REFUND                                             *
  1268*----------------------------------------------------------------*
  1269*  PASSED TO ELEARN                                              *
  1270*  ----------------                                              *
  1271*  CERT ISSUE DATE                                               *
  1272*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1273*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1274*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1275*  STATE CODE (CLIENT DEFINED)                                   *
  1276*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1277*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1278*  DEVIATION CODE                                                *
  1279*  ISSUE AGE                                                     *
  1280*  ORIGINAL BENEFIT AMOUNT                                       *
  1281*  BENEFIT KIND (LIFE OR A/H)                                    *
  1282*  A.P.R.                                                        *
  1283*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1284*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1285*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1286*  COMPANY I.D. (3 CHARACTER)                                    *
  1287*  BENEFIT CODE                                                  *
  1288*  BENEFIT OVERRIDE CODE                                         *
  1289*                                                                *
  1290*  RETURNED FROM ELEARN                                          *
  1291*  --------------------                                          *
  1292*  INDICATED  EARNINGS                                           *
  1293*----------------------------------------------------------------*
  1294*                 LENGTH = 450                                   *
  1295*                                                                *
  1296******************************************************************
  1297******************************************************************
  1298*                   C H A N G E   L O G
  1299*
  1300* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  26
* EL156.cbl
  1301*-----------------------------------------------------------------
  1302*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1303* EFFECTIVE    NUMBER
  1304*-----------------------------------------------------------------
  1305* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1306* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1307* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1308* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1309* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1310* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1311* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1312* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1313* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1314******************************************************************
  1315
  1316 01  CALCULATION-PASS-AREA.
  1317     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1318                                     COMP.
  1319
  1320     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1321       88  NO-CP-ERROR                             VALUE ZERO.
  1322       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1323                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1324       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1325       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1326       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1327       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1328       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1329       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1330       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1331       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1332       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1333       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1334       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1335       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1336       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1337       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1338       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1339       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1340       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1341
  1342     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1343       88  NO-CP-ERROR-2                           VALUE ZERO.
  1344***********************  INPUT AREAS ****************************
  1345
  1346     12  CP-CALCULATION-AREA.
  1347         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1348         16  CP-CERT-EFF-DT        PIC XX.
  1349         16  CP-VALUATION-DT       PIC XX.
  1350         16  CP-PAID-THRU-DT       PIC XX.
  1351         16  CP-BENEFIT-TYPE       PIC X.
  1352           88  CP-AH                               VALUE 'A' 'D'
  1353                                                   'I' 'U'.
  1354           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1355           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1356         16  CP-INCURRED-DT        PIC XX.
  1357         16  CP-REPORTED-DT        PIC XX.
  1358         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  27
* EL156.cbl
  1359         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1360         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1361                                     COMP-3.
  1362         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1363                                     COMP-3.
  1364         16  CP-CDT-METHOD         PIC X.
  1365           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1366           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1367           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1368         16  CP-CLAIM-TYPE         PIC X.
  1369           88  CP-AH-CLAIM                         VALUE 'A'.
  1370           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1371         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1372                                     COMP-3.
  1373         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1374                                     COMP-3.
  1375         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1376                                     COMP-3.
  1377         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1378                                     COMP-3.
  1379         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1380                                     COMP-3.
  1381         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1382                                     COMP-3.
  1383         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1384                                     COMP-3.
  1385         16  CP-REM-TERM-METHOD    PIC X.
  1386           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1387           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1388           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1389           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1390           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1391           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1392           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1393         16  CP-EARNING-METHOD     PIC X.
  1394           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1395           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1396           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1397           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1398           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1399           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1400           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1401           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1402           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1403           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1404           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1405           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1406           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1407           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1408         16  CP-PROCESS-TYPE       PIC X.
  1409           88  CP-CLAIM                            VALUE '1'.
  1410           88  CP-CANCEL                           VALUE '2'.
  1411           88  CP-ISSUE                            VALUE '3'.
  1412         16  CP-SPECIAL-CALC-CD    PIC X.
  1413           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1414           88  CP-1-MTH-INTEREST               VALUE ' '.
  1415           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1416           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  28
* EL156.cbl
  1417           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1418           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1419           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1420           88  CP-FARM-PLAN                    VALUE 'F'.
  1421           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1422           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1423           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1424           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1425           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1426           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1427           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1428           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1429           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1430           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1431                                                     'W' 'X'.
  1432           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1433           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1434           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1435           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1436           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1437           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1438           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1439           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1440           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1441           88  CP-CSL-METH-1                   VALUE '5'.
  1442           88  CP-CSL-METH-2                   VALUE '6'.
  1443           88  CP-CSL-METH-3                   VALUE '7'.
  1444           88  CP-CSL-METH-4                   VALUE '8'.
  1445
  1446         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1447                                     COMP-3.
  1448         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1449         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1450         16  CP-STATE              PIC XX          VALUE SPACE.
  1451         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1452         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1453           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1454               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1455         16  CP-R78-OPTION         PIC X.
  1456           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1457           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1458
  1459         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1460         16  CP-IBNR-RESERVE-SW    PIC X.
  1461         16  CP-CLAIM-STATUS       PIC X.
  1462         16  CP-RATE-FILE          PIC X.
  1463         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1464                                     COMP-3.
  1465
  1466         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1467         16  CP-AH-OVERRIDE-CODE   PIC X.
  1468
  1469         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1470                                     COMP-3.
  1471         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1472                                   PIC S9(5)V99 COMP-3.
  1473         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1474                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  29
* EL156.cbl
  1475         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1476                                     COMP-3.
  1477         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1478                                     COMP-3.
  1479         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1480                                  PIC S9(7)V99 COMP-3.
  1481
  1482         16  CP-PAID-FROM-DATE     PIC X(02).
  1483         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1484         16  CP-EXT-DAYS-CALC      PIC X.
  1485           88  CP-EXT-NO-CHG                   VALUE ' '.
  1486           88  CP-EXT-CHG-LF                   VALUE '1'.
  1487           88  CP-EXT-CHG-AH                   VALUE '2'.
  1488           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1489         16  CP-DOMICILE-STATE     PIC XX.
  1490         16  CP-CARRIER            PIC X.
  1491         16  CP-REIN-FLAG          PIC X.
  1492         16  CP-REM-TRM-CALC-OPTION PIC X.
  1493           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1494                      '2' '3' '4' '5'.
  1495           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1496           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1497           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1498           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1499           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1500           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1501           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1502           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1503         16  CP-SIG-SWITCH         PIC X.
  1504         16  CP-RATING-METHOD      PIC X.
  1505           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1506           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1507           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1508           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1509           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1510           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1511           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1512           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1513           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1514         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1515                                     COMP-3.
  1516         16  CP-BEN-CATEGORY       PIC X.
  1517         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1518         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1519                                   PIC S99V9(5) COMP-3.
  1520         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1521         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1522                                   PIC S99V9(5) COMP-3.
  1523         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1524         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1525         16  CP-EXPIRE-DT          PIC XX.
  1526         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1527         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1528         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1529         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1530         16  CP-DDF-SPEC-CALC      PIC X.
  1531             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1532             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  30
* EL156.cbl
  1533         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1534         16  CP-CANCEL-REASON      PIC X.
  1535         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1536         16  CP-PMT-MODE           PIC X.
  1537         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1538         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1539         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1540         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1541         16  FILLER                PIC X.
  1542
  1543***************    OUTPUT FROM ELRESV   ************************
  1544
  1545         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1546
  1547         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1548                                     COMP-3.
  1549         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1550                                     COMP-3.
  1551         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1552                                     COMP-3.
  1553         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1554                                     COMP-3.
  1555         16  FILLER                PIC X(09).
  1556***************    OUTPUT FROM ELRTRM   *************************
  1557
  1558         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1559                                     COMP-3.
  1560         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1561                                     COMP-3.
  1562         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1563                                     COMP-3.
  1564         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1565                                     COMP-3.
  1566         16  FILLER                PIC X(12).
  1567
  1568***************    OUTPUT FROM ELRAMT   *************************
  1569
  1570         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1571                                     COMP-3.
  1572         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1573                                     COMP-3.
  1574         16  FILLER                PIC X(12).
  1575
  1576***************    OUTPUT FROM ELRATE   *************************
  1577
  1578         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1579                                     COMP-3.
  1580         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1581                                     COMP-3.
  1582         16  CP-MORTALITY-CODE     PIC X(4).
  1583         16  CP-RATE-EDIT-FLAG     PIC X.
  1584             88  CP-RATES-NEED-APR                  VALUE '1'.
  1585         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1586                                     COMP-3.
  1587         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1588         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1589         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1590                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  31
* EL156.cbl
  1591         16  FILLER                PIC X(07).
  1592
  1593***************    OUTPUT FROM ELRFND   *************************
  1594
  1595         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1596                                     COMP-3.
  1597         16  CP-REFUND-TYPE-USED   PIC X.
  1598           88  CP-R-AS-R78                         VALUE '1'.
  1599           88  CP-R-AS-PRORATA                     VALUE '2'.
  1600           88  CP-R-AS-CALIF                       VALUE '3'.
  1601           88  CP-R-AS-TEXAS                       VALUE '4'.
  1602           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1603           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1604           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1605           88  CP-R-AS-MEAN                        VALUE '8'.
  1606           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1607           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1608           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1609           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1610           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1611           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1612         16  FILLER                PIC X(12).
  1613
  1614***************    OUTPUT FROM ELEARN   *************************
  1615
  1616         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1617                                     COMP-3.
  1618         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1619                                     COMP-3.
  1620         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1621                                     COMP-3.
  1622         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1623                                     COMP-3.
  1624         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1625                                     COMP-3.
  1626         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1627                                     COMP-3.
  1628         16  CP-EARNING-TYPE-USED  PIC X.
  1629           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1630           88  CP-E-AS-R78                         VALUE '1'.
  1631           88  CP-E-AS-PRORATA                     VALUE '2'.
  1632           88  CP-E-AS-TEXAS                       VALUE '4'.
  1633           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1634           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1635           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1636           88  CP-E-AS-MEAN                        VALUE '8'.
  1637           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1638         16  FILLER                PIC X(12).
  1639
  1640***************    OUTPUT FROM ELPMNT   *************************
  1641
  1642         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1643                                     COMP-3.
  1644         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1645                                     COMP-3.
  1646         16  FILLER                PIC X(12).
  1647
  1648***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  32
* EL156.cbl
  1649         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1650                                     COMP-3.
  1651         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1652                                     COMP-3.
  1653         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1654                                     COMP-3.
  1655         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1656                                     COMP-3.
  1657         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1658                                     COMP-3.
  1659         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1660                                     COMP-3.
  1661         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1662             88  OPEN-RATE-FILE                   VALUE 'O'.
  1663             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1664             88  IO-ERROR                         VALUE 'E'.
  1665
  1666         16  CP-FIRST-PAY-DATE     PIC XX.
  1667
  1668         16  CP-JOINT-INDICATOR    PIC X.
  1669
  1670         16  CP-RESERVE-REMAINING-TERM
  1671                                   PIC S9(4)V9    VALUE ZERO
  1672                                     COMP-3.
  1673
  1674         16  CP-INSURED-BIRTH-DT   PIC XX.
  1675
  1676         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1677                                     COMP-3.
  1678
  1679         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1680                                     COMP-3.
  1681
  1682         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1683                                     COMP-3.
  1684
  1685         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1686                                     COMP-3.
  1687
  1688         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1689                                     COMP-3.
  1690
  1691         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1692                                     COMP-3.
  1693
  1694         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1695                                     COMP-3.
  1696
  1697         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1698             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1699
  1700         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1701                                     COMP-3.
  1702         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1703                                     COMP-3.
  1704         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1705         16  FILLER                PIC X(15).
  1706******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  33
* EL156.cbl
  1707*    COPY ELCICALC.
  1708******************************************************************
  1709*                                                                *
  1710*                           ELCCICALC.                           *
  1711*                            VMOD=2.001                          *
  1712*                                                                *
  1713*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1714*                 CALCULATION MODULE                             *
  1715*                                                                *
  1716*  PASSED TO ELCLMI                                              *
  1717*  -----------------                                             *
  1718*  STATE                                                         *
  1719*  PRODUCT                                                       *
  1720*  COVERAGE                                                      *
  1721*  EFFECTIVE DATE                                                *
  1722*  INCURRED DATE                                                 *
  1723*  ESTABLISHED DATE                                              *
  1724*  LAST PAID DATE                                                *
  1725*  REPORTED DATE                                                 *
  1726*  CLAIM PAYMENT AMOUNT                                          *
  1727*                                                                *
  1728*  RETURNED FROM ELRTRM                                          *
  1729*  ---------------------                                         *
  1730*  RETURN CODE                                                   *
  1731*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1732*  CLAIM INTEREST AMOUNT                                         *
  1733*----------------------------------------------------------------*
  1734*----------------------------------------------------------------*
  1735*                 LENGTH = 100                                   *
  1736*                                                                *
  1737******************************************************************
  1738******************************************************************
  1739*                   C H A N G E   L O G
  1740*
  1741* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1742*-----------------------------------------------------------------
  1743*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1744* EFFECTIVE    NUMBER
  1745*-----------------------------------------------------------------
  1746* 120905    2004040700004  PEMA  NEW COPYBOOK
  1747* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1748******************************************************************
  1749
  1750 01  CLAIM-INT-PASS-AREA.
  1751     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1752                                     COMP.
  1753
  1754     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1755       88  NO-CI-ERROR                             VALUE ZERO.
  1756       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1757       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1758       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1759       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1760       88  CP-AMT-LT-5000                          VALUE '4'.
  1761       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1762       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1763       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1764       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  34
* EL156.cbl
  1765***********************  INPUT AREAS ****************************
  1766
  1767     12  CP-CALCULATION-AREA.
  1768         16  CP-COMPANY-CD         PIC X.
  1769         16  CP-STATE              PIC XX.
  1770         16  CP-PRODUCT            PIC XX.
  1771         16  CP-COVERAGE           PIC XX.
  1772         16  CP-INC-DT             PIC XX.
  1773         16  CP-EST-DT             PIC XX.
  1774         16  CP-LSTPD-DT           PIC XX.
  1775         16  CP-RPT-DT             PIC XX.
  1776         16  CP-PRF-DT             PIC XX.
  1777         16  CP-EFF-DT             PIC XX.
  1778         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1779         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1780         16  FILLER                PIC X(37).
  1781
  1782***************    OUTPUT FROM ELCLMI   ************************
  1783
  1784         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1785
  1786         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1787         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1788         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1789         16  FILLER                PIC X(19).
  1790******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  35
* EL156.cbl
  1792*    COPY ELCATTR.
  1793******************************************************************
  1794*                                                                *
  1795*                            ELCATTR.                            *
  1796*                            VMOD=2.001                          *
  1797*                                                                *
  1798*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1799*                                                                *
  1800*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1801*                                                                *
  1802*                   POS 1   P=PROTECTED                          *
  1803*                           U=UNPROTECTED                        *
  1804*                           S=ASKIP                              *
  1805*                   POS 2   A=ALPHA/NUMERIC                      *
  1806*                           N=NUMERIC                            *
  1807*                   POS 3   N=NORMAL                             *
  1808*                           B=BRIGHT                             *
  1809*                           D=DARK                               *
  1810*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1811*                           OF=MODIFIED DATA TAG OFF             *
  1812*                                                                *
  1813*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1814******************************************************************
  1815 01  ATTRIBUTE-LIST.
  1816     12  AL-PABOF            PIC X       VALUE 'Y'.
  1817     12  AL-PABON            PIC X       VALUE 'Z'.
  1818     12  AL-PADOF            PIC X       VALUE '%'.
  1819     12  AL-PADON            PIC X       VALUE '_'.
  1820     12  AL-PANOF            PIC X       VALUE '-'.
  1821     12  AL-PANON            PIC X       VALUE '/'.
  1822     12  AL-SABOF            PIC X       VALUE '8'.
  1823     12  AL-SABON            PIC X       VALUE '9'.
  1824     12  AL-SADOF            PIC X       VALUE '@'.
  1825     12  AL-SADON            PIC X       VALUE QUOTE.
  1826     12  AL-SANOF            PIC X       VALUE '0'.
  1827     12  AL-SANON            PIC X       VALUE '1'.
  1828     12  AL-UABOF            PIC X       VALUE 'H'.
  1829     12  AL-UABON            PIC X       VALUE 'I'.
  1830     12  AL-UADOF            PIC X       VALUE '<'.
  1831     12  AL-UADON            PIC X       VALUE '('.
  1832     12  AL-UANOF            PIC X       VALUE ' '.
  1833     12  AL-UANON            PIC X       VALUE 'A'.
  1834     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1835     12  AL-UNBON            PIC X       VALUE 'R'.
  1836     12  AL-UNDOF            PIC X       VALUE '*'.
  1837     12  AL-UNDON            PIC X       VALUE ')'.
  1838     12  AL-UNNOF            PIC X       VALUE '&'.
  1839     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  36
* EL156.cbl
  1841*    COPY ELCEMIB.
  1842******************************************************************
  1843*                                                                *
  1844*                                                                *
  1845*                            ELCEMIB.                            *
  1846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1847*                            VMOD=2.005                          *
  1848*                                                                *
  1849*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1850*                                                                *
  1851******************************************************************
  1852 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1853     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1854     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1855     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1856     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1857     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1858     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1859     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1860     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1861     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1862         88  EMI-NO-ERRORS                    VALUE '1'.
  1863         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1864         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1865     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1866         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1867     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1868         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1869         88  EMI-AREA1-FULL                   VALUE '2'.
  1870     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1871         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1872         88  EMI-AREA2-FULL                   VALUE '2'.
  1873     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1874         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1875         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1876         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1877         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1878         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1879     12  EMI-ERROR-LINES.
  1880         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1881         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1882         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1883         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1884             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1885                 24  EMI-ERR-NUM         PIC X(4).
  1886                 24  EMI-FILLER          PIC X.
  1887                 24  EMI-SEV             PIC X.
  1888                 24  FILLER              PIC X.
  1889             20  FILLER                  PIC X(02).
  1890     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1891         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1892             20  EMI-ERROR-NUMBER    PIC X(4).
  1893             20  EMI-FILL            PIC X.
  1894             20  EMI-SEVERITY        PIC X.
  1895             20  FILLER              PIC X.
  1896             20  EMI-ERROR-TEXT.
  1897                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1898                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  37
* EL156.cbl
  1899     12  EMI-SEVERITY-SAVE           PIC X.
  1900         88  EMI-NOTE                    VALUE 'N'.
  1901         88  EMI-WARNING                 VALUE 'W'.
  1902         88  EMI-FORCABLE                VALUE 'F'.
  1903         88  EMI-FATAL                   VALUE 'X'.
  1904     12  EMI-MESSAGE-FLAG            PIC X.
  1905         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1906         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1907     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1908     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1909         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1910         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1911         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1912     12  emi-claim-no                pic x(7).
  1913     12  emi-claim-type              pic x(6).
  1914     12  FILLER                      PIC X(124)  VALUE SPACES.
  1915     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1916     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1917     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1918     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  38
* EL156.cbl
  1920*    COPY ELCLNKLT.
  1921******************************************************************
  1922*                                                                *
  1923*                                                                *
  1924*                           ELCLNKLT                             *
  1925*                            VMOD=2.003                          *
  1926*                                                                *
  1927*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1928*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1929*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1930*                                                                *
  1931*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1932*   COMPLETING THE REQUIRED FIELDS.                              *
  1933*                                                                *
  1934*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1935*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1936*                              9999 INDICATES AN UNKNOWN ABEND   *
  1937*                                   WAS DETECTED.                *
  1938*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1939*                              CODES FOUND IN THE ERROR FILE.    *
  1940******************************************************************
  1941 01  W-1523-LINKDATA.
  1942     12  W-1523-COMMON-PI-DATA.
  1943         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1944         16  FILLER              PIC  X(67).
  1945         16  W-1523-COMPANY-CD   PIC  X(01).
  1946         16  FILLER              PIC  X(10).
  1947         16  W-1523-CONTROL-IN-PROGRESS.
  1948             20  W-1523-CARRIER  PIC  X(01).
  1949             20  W-1523-GROUPING PIC  X(06).
  1950             20  W-1523-STATE    PIC  X(02).
  1951             20  W-1523-ACCOUNT  PIC  X(10).
  1952             20  W-1523-CLAIM-CERT-GRP.
  1953                 24  W-1523-CLAIM-NO
  1954                                 PIC  X(07).
  1955                 24  W-1523-CERT-NO.
  1956                     28  W-1523-CERT-PRIME
  1957                                 PIC  X(10).
  1958                     28  W-1523-CERT-SFX
  1959                                 PIC  X(01).
  1960                 24  W-1523-CERT-EFF-DT
  1961                                 PIC  X(02).
  1962         16  FILLER              PIC X(265).
  1963
  1964     12  W-1523-WORK-AREA.
  1965         16  W-1523-FORM-NUMBER  PIC  X(04).
  1966         16  W-1523-NUMBER-COPIES
  1967                                 PIC  9(01).
  1968         16  W-1523-ADDR-TYPE    PIC  X(02).
  1969         16  W-1523-FOLLOW-UP-DATE
  1970                                 PIC  X(02).
  1971         16  W-1523-RESEND-DATE  PIC  X(02).
  1972         16  W-1523-ERROR-CODE   PIC  9(04).
  1973             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1974             88  W-1523-FATAL-ERROR
  1975                                    VALUES  0006 0013 0042
  1976                                            0154 0168 0169
  1977                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  39
* EL156.cbl
  1978                                            0179 0186 0281
  1979                                            0332 2055 3697
  1980                                            3698 3699 3770
  1981                                            3771 3772 7675
  1982                                            9106 9808 9883
  1983                                            9887.
  1984             88  W-1523-STOP-ERRORS
  1985                                    VALUES  0013 0042 0154
  1986                                            0168 0169 0172
  1987                                            0281 0332 2055
  1988                                            3698 3699 7675
  1989                                            9106 9808 9883
  1990                                            9999.
  1991         16  W-1523-REASON       PIC  X(70).
  1992         16  W-1523-ARCHIVE-NUMBER
  1993                                 PIC  9(08).
  1994     12  W-1523-POINTER-AREA.
  1995         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1996         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1997         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1998         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1999         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  40
* EL156.cbl
  2001*    COPY ELCNWA.
  2002*****************************************************************
  2003*                                                               *
  2004*                                                               *
  2005*                            ELCNWA.                            *
  2006*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2007*                            VMOD=2.003                         *
  2008*                                                               *
  2009*            M O V E   N A M E   W O R K   A R E A.             *
  2010*                                                               *
  2011*****************************************************************.
  2012
  2013 01  WS-NAME-WORK-AREA.
  2014     05  WS-INSURED-LAST-NAME        PIC X(15).
  2015     05  WS-INSURED-1ST-NAME         PIC X(12).
  2016     05  WS-INSURED-MID-INIT         PIC X.
  2017
  2018     05  WS-NAME-WORK.
  2019         10  WS-NW                   PIC X
  2020             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2021
  2022     05  WS-NAME-WORK2.
  2023         10  WS-NW2                  PIC X
  2024             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2025                                        NWA-INDEX0.
  2026
  2027     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2028                                     COMP-3.
  2029
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  41
* EL156.cbl
  2031*    COPY ELCDMO.
  2032******************************************************************
  2033*                                                                *
  2034*                                                                *
  2035*                            ELCDMO.                             *
  2036*                            VMOD=2.004                          *
  2037*                                                                *
  2038*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2039*        COMMUNICATION AREA                                      *
  2040*   FILE TYPE = NA                                               *
  2041*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2042*                                                                *
  2043******************************************************************
  2044 01  DMO-COMMUNICATION-AREA.
  2045     12  DM-RECORD-TYPE                  PIC  X(02).
  2046             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2047             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2048             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2049     12  DM-DIST-CODE                    PIC  X(04).
  2050     12  DM-MAIL-CODE                    PIC  X(05).
  2051     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2052     12  DM-INSURED-NAME                 PIC  X(30).
  2053     12  DM-CLAIM-NO                     PIC  X(07).
  2054     12  DM-CLAIM-TYPE                   PIC  X.
  2055
  2056     12  DM-STATUS-DATA-AREA.
  2057         16  DM-CLAIM-STATUS             PIC  X.
  2058             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2059             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2060             88  DM-CLOSED                        VALUE '3'.
  2061             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2062             88  DM-DEFAULT                       VALUE '9'.
  2063         16  DM-STATUS-DATE              PIC  X(08).
  2064******YYYYMMDD
  2065         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2066             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2067             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2068             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2069             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2070             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2071             88  DM-RE-OPENED                     VALUE 'R'.
  2072             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2073             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2074             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2075         16  DM-STAT-CARRIER             PIC X.
  2076
  2077     12  DM-DRAFT-DATA-AREA.
  2078         16  DM-PAYMENT-TYPE             PIC  X.
  2079             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2080         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2081         16  DM-PAYMENT-DATE             PIC  X(08).
  2082******YYYYMMDD
  2083         16  DM-CERT-NO                  PIC  X(11).
  2084         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2085         16  DM-CARRIER                  PIC  X.
  2086
  2087     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  42
* EL156.cbl
  2089*    COPY ELCDMDCD.
  2090******************************************************************
  2091*                                                                *
  2092*                                                                *
  2093*                            ELCDMDCD.                           *
  2094*                            VMOD=2.001                          *
  2095*                                                                *
  2096*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2097*       COMMUNICATIONS AREA                                      *
  2098*                                                                *
  2099******************************************************************
  2100 01  CD-COMMUNICATION-AREA.
  2101     12  CD-SYSTEM-ID            PIC  X(02).
  2102         88 CD-CLAIMS                      VALUE 'CL'.
  2103         88 CD-CREDIT                      VALUE 'CR'.
  2104     12  CD-RECORD-TYPE          PIC  X(02).
  2105         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2106         88 CD-EOB-CODE                    VALUE 'EO'.
  2107         88 CD-ICD9-CODE                   VALUE 'I9'.
  2108         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2109         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2110         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2111         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2112         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2113     12  CD-RECORD-KEY           PIC  X(06).
  2114         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2115     12  CD-RETURN-CODE          PIC  X(02).
  2116     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2117     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2118     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2119     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  43
* EL156.cbl
  2121*    COPY ELCDCTB.
  2122******************************************************************
  2123*                                                                *
  2124*                                                                *
  2125*                            ELCDCTB.                            *
  2126*                            VMOD=2.002                          *
  2127*                                                                *
  2128*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2129*       COMMUNICATIONS AREA                                      *
  2130*                                                                *
  2131******************************************************************
  2132 01  DCT-COMMUNICATION-AREA.
  2133     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2134     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2135     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2136     12  DCT-PRODUCT-CODE         PIC  X(02).
  2137     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2138     12  DCT-RETURN-CODE          PIC  X(02).
  2139     12  DCT-MAIL-CODE            PIC  X(05).
  2140     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2141     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  44
* EL156.cbl
  2143 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2144 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2145 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2146 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  45
* EL156.cbl
  2148*    COPY ELCINTF.
  2149******************************************************************
  2150*                                                                *
  2151*                                                                *
  2152*                            ELCINTF.                            *
  2153*                            VMOD=2.017                          *
  2154*                                                                *
  2155*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2156*                                                                *
  2157*       LENGTH = 1024                                            *
  2158*                                                                *
  2159******************************************************************
  2160*                   C H A N G E   L O G
  2161*
  2162* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2163*-----------------------------------------------------------------
  2164*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2165* EFFECTIVE    NUMBER
  2166*-----------------------------------------------------------------
  2167* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2168******************************************************************
  2169 01  PROGRAM-INTERFACE-BLOCK.
  2170     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2171     12  PI-CALLING-PROGRAM              PIC X(8).
  2172     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2173     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2174     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2175     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2176     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2177     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2178     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2179     12  PI-COMPANY-ID                   PIC XXX.
  2180     12  PI-COMPANY-CD                   PIC X.
  2181
  2182     12  PI-COMPANY-PASSWORD             PIC X(8).
  2183
  2184     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2185
  2186     12  PI-CONTROL-IN-PROGRESS.
  2187         16  PI-CARRIER                  PIC X.
  2188         16  PI-GROUPING                 PIC X(6).
  2189         16  PI-STATE                    PIC XX.
  2190         16  PI-ACCOUNT                  PIC X(10).
  2191         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2192                                         PIC X(10).
  2193         16  PI-CLAIM-CERT-GRP.
  2194             20  PI-CLAIM-NO             PIC X(7).
  2195             20  PI-CERT-NO.
  2196                 25  PI-CERT-PRIME       PIC X(10).
  2197                 25  PI-CERT-SFX         PIC X.
  2198             20  PI-CERT-EFF-DT          PIC XX.
  2199         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2200             20  PI-PLAN-CODE            PIC X(2).
  2201             20  PI-REVISION-NUMBER      PIC X(3).
  2202             20  PI-PLAN-EFF-DT          PIC X(2).
  2203             20  PI-PLAN-EXP-DT          PIC X(2).
  2204             20  FILLER                  PIC X(11).
  2205         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  46
* EL156.cbl
  2206             20  PI-OE-REFERENCE-1.
  2207                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2208                 25  PI-OE-REF-1-SUFF    PIC XX.
  2209
  2210     12  PI-SESSION-IN-PROGRESS          PIC X.
  2211         88  CLAIM-SESSION                   VALUE '1'.
  2212         88  CREDIT-SESSION                  VALUE '2'.
  2213         88  WARRANTY-SESSION                VALUE '3'.
  2214         88  MORTGAGE-SESSION                VALUE '4'.
  2215         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2216
  2217
  2218*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2219
  2220     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2221     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2222
  2223     12  PI-CREDIT-USER                  PIC X.
  2224         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2225         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2226
  2227     12  PI-CLAIM-USER                   PIC X.
  2228         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2229         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2230
  2231     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2232         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2233         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2234         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2235         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2236         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2237
  2238     12  PI-PROCESSOR-ID                 PIC X(4).
  2239
  2240     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2241
  2242     12  PI-MEMBER-CAPTION               PIC X(10).
  2243
  2244     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2245         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2246
  2247     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2248     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2249     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2250     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2251
  2252     12  PI-AH-OVERRIDE-L1               PIC X.
  2253     12  PI-AH-OVERRIDE-L2               PIC XX.
  2254     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2255     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2256
  2257     12  PI-NEW-SYSTEM                   PIC X(2).
  2258
  2259     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2260     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2261         88  PI-USES-PAID-TO                 VALUE '1'.
  2262     12  PI-CRDTCRD-SYSTEM.
  2263         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  47
* EL156.cbl
  2264             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2265             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2266         16  PI-CC-MONTH-END-DT          PIC XX.
  2267     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2268
  2269     12  PI-OE-REFERENCE-2.
  2270         16  PI-OE-REF-2-PRIME           PIC X(10).
  2271         16  PI-OE-REF-2-SUFF            PIC X.
  2272
  2273     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2274
  2275     12  PI-LANGUAGE-TYPE                PIC X.
  2276             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2277             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2278             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2279
  2280     12  PI-POLICY-LINKAGE-IND           PIC X.
  2281         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2282         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2283                                                   LOW-VALUES.
  2284
  2285     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2286     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2287         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2288         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2289
  2290     12  PI-PROCESSOR-CSR-IND            PIC X.
  2291         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2292         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2293
  2294     12  FILLER                          PIC X(3).
  2295
  2296     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2297
  2298     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2299         PI-SYSTEM-LEVEL.
  2300
  2301         16  PI-ENTRY-CODES.
  2302             20  PI-ENTRY-CD-1           PIC X.
  2303             20  PI-ENTRY-CD-2           PIC X.
  2304
  2305         16  PI-RETURN-CODES.
  2306             20  PI-RETURN-CD-1          PIC X.
  2307             20  PI-RETURN-CD-2          PIC X.
  2308
  2309         16  PI-UPDATE-STATUS-SAVE.
  2310             20  PI-UPDATE-BY            PIC X(4).
  2311             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2312
  2313         16  PI-LOWER-CASE-LETTERS       PIC X.
  2314             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2315
  2316*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2317*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2318*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2319
  2320         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2321             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  48
* EL156.cbl
  2322             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2323             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2324             88  ACCNT-CNTL                  VALUE '3'.
  2325             88  CARR-ACCNT-CNTL             VALUE '4'.
  2326
  2327         16  PI-PROCESSOR-CAP-LIST.
  2328             20  PI-SYSTEM-CONTROLS.
  2329                24 PI-SYSTEM-DISPLAY     PIC X.
  2330                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2331                24 PI-SYSTEM-MODIFY      PIC X.
  2332                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2333             20  FILLER                  PIC XX.
  2334             20  PI-DISPLAY-CAP          PIC X.
  2335                 88  DISPLAY-CAP             VALUE 'Y'.
  2336             20  PI-MODIFY-CAP           PIC X.
  2337                 88  MODIFY-CAP              VALUE 'Y'.
  2338             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2339                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2340             20  PI-FORCE-CAP            PIC X.
  2341                 88  FORCE-CAP               VALUE 'Y'.
  2342
  2343         16  PI-PROGRAM-CONTROLS.
  2344             20  PI-PGM-PRINT-OPT        PIC X.
  2345             20  PI-PGM-FORMAT-OPT       PIC X.
  2346             20  PI-PGM-PROCESS-OPT      PIC X.
  2347             20  PI-PGM-TOTALS-OPT       PIC X.
  2348
  2349         16  PI-HELP-INTERFACE.
  2350             20  PI-LAST-ERROR-NO        PIC X(4).
  2351             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2352
  2353         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2354             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2355
  2356         16  PI-CR-CONTROL-IN-PROGRESS.
  2357             20  PI-CR-CARRIER           PIC X.
  2358             20  PI-CR-GROUPING          PIC X(6).
  2359             20  PI-CR-STATE             PIC XX.
  2360             20  PI-CR-ACCOUNT           PIC X(10).
  2361             20  PI-CR-FIN-RESP          PIC X(10).
  2362             20  PI-CR-TYPE              PIC X.
  2363
  2364         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2365
  2366         16  PI-CR-MONTH-END-DT          PIC XX.
  2367
  2368         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2369             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2370             88  PI-ZERO-CARRIER             VALUE '1'.
  2371             88  PI-ZERO-GROUPING            VALUE '2'.
  2372             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2373
  2374         16  PI-CARRIER-SECURITY         PIC X.
  2375             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2376
  2377         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2378             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2379             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  49
* EL156.cbl
  2380
  2381         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2382             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2383                                         INDEXED BY PI-ACCESS-NDX
  2384                                         PIC X.
  2385
  2386         16  PI-GA-BILLING-CONTROL       PIC X.
  2387             88  PI-GA-BILLING               VALUE '1'.
  2388
  2389         16  PI-MAIL-PROCESSING          PIC X.
  2390             88  PI-MAIL-YES                 VALUE 'Y'.
  2391
  2392         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2393
  2394         16  PI-AR-SYSTEM.
  2395             20  PI-AR-PROCESSING-CNTL   PIC X.
  2396                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2397             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2398             20  PI-AR-MONTH-END-DT      PIC XX.
  2399
  2400         16  PI-MP-SYSTEM.
  2401             20  PI-MORTGAGE-USER            PIC X.
  2402                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2403                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2404             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2405                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2406                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2407                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2408                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2409                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2410             20  PI-MP-MONTH-END-DT          PIC XX.
  2411             20  PI-MP-REFERENCE-NO.
  2412                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2413                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2414
  2415         16  PI-LABEL-CONTROL            PIC X(01).
  2416             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2417             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2418
  2419         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2420             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2421
  2422         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2423             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2424             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2425
  2426         16  FILLER                      PIC X(14).
  2427
  2428     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2429******************************************************************
  2430     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2431         16  PI-SAVE-FORM        PIC X(12).
  2432         16  PI-ACCT-KEY         PIC X(26).
  2433         16  PI-PAYEE-NAME       PIC X(30).
  2434         16  PI-DAILY-RATE       PIC S9(3)V99.
  2435         16  PI-MONTH-END-SAVE   PIC XX.
  2436         16  PI-BENEFIT-SAVE.
  2437             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  50
* EL156.cbl
  2438             20  PI-BEN-TYPE     PIC X.
  2439         16  PI-MANUAL-SW        PIC 9.
  2440         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2441         16  PI-PASS-SW          PIC X.
  2442         16  PI-PFKEY-USED       PIC X.
  2443         16  PI-CK-ASSIGN        PIC X.
  2444         16  PI-FATAL-COUNT      PIC 99.
  2445         16  PI-FORCE-COUNT      PIC 99.
  2446         16  PI-SAVE-INPUT.
  2447             20  PI-PMTTYPE      PIC X.
  2448             20  PI-PAYEE.
  2449                 24  PI-PAYEE-TYPE PIC X.
  2450                 24  PI-PAYEE-SEQ  PIC X.
  2451                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2452                   PI-PAYEE-SEQ    PIC S9.
  2453             20  PI-PMTNOTE1     PIC X(60).
  2454             20  PI-PMTNOTE2     PIC X(60).
  2455             20  PI-OFFLINE      PIC X.
  2456             20  PI-ECHECKNO     PIC X(7).
  2457             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2458                 28  PI-ECHECKNO-N     PIC X.
  2459                 28  PI-ECHECKNO-6     PIC X(6).
  2460             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2461                 24  PI-ECHECKNO-CR    PIC XX.
  2462                 24  PI-ECHECKNO-5     PIC X(5).
  2463             20  PI-HOLDTIL      PIC 9(6).
  2464             20  PI-EPYFROM      PIC 9(6).
  2465             20  PI-EPYTHRU      PIC 9(6).
  2466             20  PI-EDAYS        PIC S9(5).
  2467             20  PI-EPYAMT       PIC S9(7)V99.
  2468             20  PI-ERESV        PIC S9(7)V99.
  2469             20  PI-EEXPENS      PIC 9(6)V99.
  2470             20  PI-ETYPE        PIC X.
  2471             20  PI-CASH         PIC X.
  2472             20  PI-GROUPED      PIC X.
  2473             20  PI-INT-RATE     PIC S99V9(5).
  2474             20  PI-AIGFROM      PIC 9(6).
  2475             20  PI-LOAN-NO      PIC X(20).
  2476             20  PI-PROOF-DATE   PIC 9(6).
  2477             20  PI-PRINT-EOB-YN PIC X.
  2478             20  PI-PRINT-CLM-FRM-YN PIC X.
  2479             20  PI-PRINT-SURVEY-YN PIC X.
  2480             20  PI-SPECIAL-RELEASE-YN PIC X.
  2481         16  PI-SAVE-COMPUTED.
  2482             20  PI-CCHECKNO     PIC X(7).
  2483             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2484                 28  PI-CCHECKNO-N     PIC X.
  2485                 28  PI-CCHECKNO-6     PIC X(6).
  2486             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2487                 24  PI-CCHECKNO-CR    PIC XX.
  2488                 24  PI-CCHECKNO-5     PIC X(5).
  2489             20  PI-CPYFROM      PIC XX.
  2490             20  PI-CPYTHRU      PIC XX.
  2491             20  PI-CDAYS        PIC S9(5).
  2492             20  PI-CPYAMT       PIC S9(7)V99.
  2493             20  PI-CRESV        PIC 9(6)V99.
  2494             20  PI-CEXPENS      PIC 9(6)V99.
  2495             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  51
* EL156.cbl
  2496                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2497                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2498                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2499         16  PI-PREV-CLMNO       PIC X(7).
  2500         16  PI-LF-COVERAGE-TYPE PIC X.
  2501         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2502         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2503         16  PI-PROVISIONAL-IND  PIC X.
  2504             88 PI-PROV-PMT      VALUE 'P'.
  2505         16  PI-PREV-TRLR-KEY    PIC X(22).
  2506         16  PI-SPLIT-PMT-SW     PIC X.
  2507         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2508         16  PI-ACTIVITY-CODE    PIC 99.
  2509         16  PI-RESET-SW         PIC X.
  2510         16  PI-SPECIAL-BEN-SW   PIC X.
  2511             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2512         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2513         16  PI-EXP-DT           PIC XX.
  2514         16  PI-LOAN-DUE-DAY     PIC 99.
  2515         16  PI-3RD-PARTY-SW     PIC X.
  2516         16  PI-LOAN-UPDATE-SW   PIC X.
  2517
  2518         16  PI-DMD-DATA.
  2519             20  PI-SV-CERT-KEY       PIC X(21).
  2520             20  PI-SV-CERT-NO        PIC X(11).
  2521             20  PI-SV-BEN            PIC X(10).
  2522             20  PI-SV-CCN            PIC X(16).
  2523             20  PI-INTEREST-PAID-IND PIC X.
  2524                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2525             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2526             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2527             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2528             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2529         16  PI-AT-EOB-CODES.
  2530             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2531         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2532         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2533         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2534         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2535         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2536         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2537         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2538         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2539         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2540         16  PI-LF-BENEFIT-CD         PIC X(2).
  2541         16  PI-EOB-CODES-EXIST PIC X.
  2542         16  PI-SET-NOTE2-MDT   PIC X.
  2543         16  PI-VFY-2ND-BENE          PIC X.
  2544         16  PI-CLM-TYPE              PIC X.
  2545         16  PI-APPROVAL-LEVEL        PIC X.
  2546         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2547         16  PI-REAUDIT-NEEDED        PIC X.
  2548         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2549         16  PI-AH-BENEFIT-CD         PIC XX.
  2550         16  pi-ah-term               pic s999 comp-3.
  2551         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2552         16  pi-max-ext               pic 999.
  2553         16  pi-max-ext-used          pic x.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  52
* EL156.cbl
  2554         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2555         16  PI-JOINT-COV-IND         PIC X.
  2556             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2557             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2558         16  PI-JOINT-INSURED-IND     PIC X.
  2559             88  PI-JOINT-INSURED        VALUE 'Y'.
  2560             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2561*00781          16  FILLER                   PIC X(176).
  2562*052506         16  FILLER                   PIC X(161).
  2563*031808         16  FILLER                   PIC X(154).
  2564*091808         16  FILLER                   PIC X(152).
  2565*041710         16  FILLER                   PIC X(94).
  2566         16  FILLER                   PIC X(67).
  2567
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  53
* EL156.cbl
  2569*    COPY ELCJPFX.
  2570******************************************************************
  2571*                                                                *
  2572*                                                                *
  2573*                            ELCJPFX.                            *
  2574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2575*                            VMOD=2.002                          *
  2576*                                                                *
  2577*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2578*                                                                *
  2579*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2580*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2581*        ELCNTL - CONTROL FILE                                   *
  2582*        ELMSTR - CLAIM MASTERS                                  *
  2583*        ELTRLR - ACTIVITY TRAILERS                              *
  2584*        ELCHKQ - CHECK QUE                                      *
  2585******************************************************************
  2586 01  JOURNAL-RECORD.
  2587     12  jp-date                     pic s9(5) comp-3.
  2588     12  jp-time                     pic s9(7) comp-3.
  2589     12  JP-USER-ID                  PIC X(4).
  2590     12  JP-FILE-ID                  PIC X(8).
  2591     12  JP-PROGRAM-ID               PIC X(8).
  2592     12  JP-RECORD-TYPE              PIC X.
  2593         88 JP-ADD              VALUE 'A'.
  2594         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2595         88 JP-AFTER-CHANGE     VALUE 'C'.
  2596         88 JP-DELETE           VALUE 'D'.
  2597         88 JP-GENERIC-DELETE   VALUE 'G'.
  2598         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2599         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2600     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2601     12  JP-RECORD-AREA
  2602
  2603
  2604                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  54
* EL156.cbl
  2606*    COPY ELCAID.
  2607******************************************************************
  2608*                                                                *
  2609*                            ELCAID.                             *
  2610*                            VMOD=2.001                          *
  2611*                                                                *
  2612*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2613*                                                                *
  2614*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2615*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2616******************************************************************
  2617
  2618 01  DFHAID.
  2619   02  DFHNULL   PIC  X  VALUE  ' '.
  2620   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2621   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2622   02  DFHPEN    PIC  X  VALUE  '='.
  2623   02  DFHOPID   PIC  X  VALUE  'W'.
  2624   02  DFHPA1    PIC  X  VALUE  '%'.
  2625   02  DFHPA2    PIC  X  VALUE  '>'.
  2626   02  DFHPA3    PIC  X  VALUE  ','.
  2627   02  DFHPF1    PIC  X  VALUE  '1'.
  2628   02  DFHPF2    PIC  X  VALUE  '2'.
  2629   02  DFHPF3    PIC  X  VALUE  '3'.
  2630   02  DFHPF4    PIC  X  VALUE  '4'.
  2631   02  DFHPF5    PIC  X  VALUE  '5'.
  2632   02  DFHPF6    PIC  X  VALUE  '6'.
  2633   02  DFHPF7    PIC  X  VALUE  '7'.
  2634   02  DFHPF8    PIC  X  VALUE  '8'.
  2635   02  DFHPF9    PIC  X  VALUE  '9'.
  2636   02  DFHPF10   PIC  X  VALUE  ':'.
  2637   02  DFHPF11   PIC  X  VALUE  '#'.
  2638   02  DFHPF12   PIC  X  VALUE  '@'.
  2639   02  DFHPF13   PIC  X  VALUE  'A'.
  2640   02  DFHPF14   PIC  X  VALUE  'B'.
  2641   02  DFHPF15   PIC  X  VALUE  'C'.
  2642   02  DFHPF16   PIC  X  VALUE  'D'.
  2643   02  DFHPF17   PIC  X  VALUE  'E'.
  2644   02  DFHPF18   PIC  X  VALUE  'F'.
  2645   02  DFHPF19   PIC  X  VALUE  'G'.
  2646   02  DFHPF20   PIC  X  VALUE  'H'.
  2647   02  DFHPF21   PIC  X  VALUE  'I'.
  2648*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2649   02  DFHPF22   PIC  X  VALUE  '['.
  2650   02  DFHPF23   PIC  X  VALUE  '.'.
  2651   02  DFHPF24   PIC  X  VALUE  '<'.
  2652   02  DFHMSRE   PIC  X  VALUE  'X'.
  2653   02  DFHSTRF   PIC  X  VALUE  'h'.
  2654   02  DFHTRIG   PIC  X  VALUE  '"'.
  2655 01  FILLER    REDEFINES DFHAID.
  2656     12  FILLER              PIC X(8).
  2657     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  55
* EL156.cbl
  2659*    COPY EL156S.
  2660 01  EL156AI.
  2661     05  FILLER            PIC  X(0012).
  2662*    -------------------------------
  2663     05  RUNDTEAL PIC S9(0004) COMP.
  2664     05  RUNDTEAF PIC  X(0001).
  2665     05  FILLER REDEFINES RUNDTEAF.
  2666         10  RUNDTEAA PIC  X(0001).
  2667     05  RUNDTEAI PIC  X(0008).
  2668*    -------------------------------
  2669     05  RUNTIMAL PIC S9(0004) COMP.
  2670     05  RUNTIMAF PIC  X(0001).
  2671     05  FILLER REDEFINES RUNTIMAF.
  2672         10  RUNTIMAA PIC  X(0001).
  2673     05  RUNTIMAI PIC  X(0005).
  2674*    -------------------------------
  2675     05  SEQUL PIC S9(0004) COMP.
  2676     05  SEQUF PIC  X(0001).
  2677     05  FILLER REDEFINES SEQUF.
  2678         10  SEQUA PIC  X(0001).
  2679     05  SEQUI PIC  X(0010).
  2680*    -------------------------------
  2681     05  CLMNOL PIC S9(0004) COMP.
  2682     05  CLMNOF PIC  X(0001).
  2683     05  FILLER REDEFINES CLMNOF.
  2684         10  CLMNOA PIC  X(0001).
  2685     05  CLMNOI PIC  X(0007).
  2686*    -------------------------------
  2687     05  CARRL PIC S9(0004) COMP.
  2688     05  CARRF PIC  X(0001).
  2689     05  FILLER REDEFINES CARRF.
  2690         10  CARRA PIC  X(0001).
  2691     05  CARRI PIC  X(0001).
  2692*    -------------------------------
  2693     05  CERTNOL PIC S9(0004) COMP.
  2694     05  CERTNOF PIC  X(0001).
  2695     05  FILLER REDEFINES CERTNOF.
  2696         10  CERTNOA PIC  X(0001).
  2697     05  CERTNOI PIC  X(0010).
  2698*    -------------------------------
  2699     05  SUFXL PIC S9(0004) COMP.
  2700     05  SUFXF PIC  X(0001).
  2701     05  FILLER REDEFINES SUFXF.
  2702         10  SUFXA PIC  X(0001).
  2703     05  SUFXI PIC  X(0001).
  2704*    -------------------------------
  2705     05  CLMTYPL PIC S9(0004) COMP.
  2706     05  CLMTYPF PIC  X(0001).
  2707     05  FILLER REDEFINES CLMTYPF.
  2708         10  CLMTYPA PIC  X(0001).
  2709     05  CLMTYPI PIC  X(0006).
  2710*    -------------------------------
  2711     05  CLMSTATL PIC S9(0004) COMP.
  2712     05  CLMSTATF PIC  X(0001).
  2713     05  FILLER REDEFINES CLMSTATF.
  2714         10  CLMSTATA PIC  X(0001).
  2715     05  CLMSTATI PIC  X(0006).
  2716*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  56
* EL156.cbl
  2717     05  LSTNMEL PIC S9(0004) COMP.
  2718     05  LSTNMEF PIC  X(0001).
  2719     05  FILLER REDEFINES LSTNMEF.
  2720         10  LSTNMEA PIC  X(0001).
  2721     05  LSTNMEI PIC  X(0015).
  2722*    -------------------------------
  2723     05  FSTNMEL PIC S9(0004) COMP.
  2724     05  FSTNMEF PIC  X(0001).
  2725     05  FILLER REDEFINES FSTNMEF.
  2726         10  FSTNMEA PIC  X(0001).
  2727     05  FSTNMEI PIC  X(0012).
  2728*    -------------------------------
  2729     05  MINITL PIC S9(0004) COMP.
  2730     05  MINITF PIC  X(0001).
  2731     05  FILLER REDEFINES MINITF.
  2732         10  MINITA PIC  X(0001).
  2733     05  MINITI PIC  X(0001).
  2734*    -------------------------------
  2735     05  PRIMHDGL PIC S9(0004) COMP.
  2736     05  PRIMHDGF PIC  X(0001).
  2737     05  FILLER REDEFINES PRIMHDGF.
  2738         10  PRIMHDGA PIC  X(0001).
  2739     05  PRIMHDGI PIC  X(0012).
  2740*    -------------------------------
  2741     05  PCERTNOL PIC S9(0004) COMP.
  2742     05  PCERTNOF PIC  X(0001).
  2743     05  FILLER REDEFINES PCERTNOF.
  2744         10  PCERTNOA PIC  X(0001).
  2745     05  PCERTNOI PIC  X(0010).
  2746*    -------------------------------
  2747     05  PSUFXL PIC S9(0004) COMP.
  2748     05  PSUFXF PIC  X(0001).
  2749     05  FILLER REDEFINES PSUFXF.
  2750         10  PSUFXA PIC  X(0001).
  2751     05  PSUFXI PIC  X(0001).
  2752*    -------------------------------
  2753     05  STATUSL PIC S9(0004) COMP.
  2754     05  STATUSF PIC  X(0001).
  2755     05  FILLER REDEFINES STATUSF.
  2756         10  STATUSA PIC  X(0001).
  2757     05  STATUSI PIC  X(0010).
  2758*    -------------------------------
  2759     05  LOANHL PIC S9(0004) COMP.
  2760     05  LOANHF PIC  X(0001).
  2761     05  FILLER REDEFINES LOANHF.
  2762         10  LOANHA PIC  X(0001).
  2763     05  LOANHI PIC  X(0014).
  2764*    -------------------------------
  2765     05  LOANNOL PIC S9(0004) COMP.
  2766     05  LOANNOF PIC  X(0001).
  2767     05  FILLER REDEFINES LOANNOF.
  2768         10  LOANNOA PIC  X(0001).
  2769     05  LOANNOI PIC  X(0025).
  2770*    -------------------------------
  2771     05  DUEDAYHL PIC S9(0004) COMP.
  2772     05  DUEDAYHF PIC  X(0001).
  2773     05  FILLER REDEFINES DUEDAYHF.
  2774         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  57
* EL156.cbl
  2775     05  DUEDAYHI PIC  X(0008).
  2776*    -------------------------------
  2777     05  DUEDAYL PIC S9(0004) COMP.
  2778     05  DUEDAYF PIC  X(0001).
  2779     05  FILLER REDEFINES DUEDAYF.
  2780         10  DUEDAYA PIC  X(0001).
  2781     05  DUEDAYI PIC  X(0002).
  2782*    -------------------------------
  2783     05  ZINTHL PIC S9(0004) COMP.
  2784     05  ZINTHF PIC  X(0001).
  2785     05  FILLER REDEFINES ZINTHF.
  2786         10  ZINTHA PIC  X(0001).
  2787     05  ZINTHI PIC  X(0009).
  2788*    -------------------------------
  2789     05  ZINTL PIC S9(0004) COMP.
  2790     05  ZINTF PIC  X(0001).
  2791     05  FILLER REDEFINES ZINTF.
  2792         10  ZINTA PIC  X(0001).
  2793     05  ZINTI PIC  99V99999.
  2794*    -------------------------------
  2795     05  PTHRHDGL PIC S9(0004) COMP.
  2796     05  PTHRHDGF PIC  X(0001).
  2797     05  FILLER REDEFINES PTHRHDGF.
  2798         10  PTHRHDGA PIC  X(0001).
  2799     05  PTHRHDGI PIC  X(0014).
  2800*    -------------------------------
  2801     05  PDTHRUL PIC S9(0004) COMP.
  2802     05  PDTHRUF PIC  X(0001).
  2803     05  FILLER REDEFINES PDTHRUF.
  2804         10  PDTHRUA PIC  X(0001).
  2805     05  PDTHRUI PIC  X(0008).
  2806*    -------------------------------
  2807     05  TOTPAIDL PIC S9(0004) COMP.
  2808     05  TOTPAIDF PIC  X(0001).
  2809     05  FILLER REDEFINES TOTPAIDF.
  2810         10  TOTPAIDA PIC  X(0001).
  2811     05  TOTPAIDI PIC  X(0010).
  2812*    -------------------------------
  2813     05  COVERL PIC S9(0004) COMP.
  2814     05  COVERF PIC  X(0001).
  2815     05  FILLER REDEFINES COVERF.
  2816         10  COVERA PIC  X(0001).
  2817     05  COVERI PIC  X(0010).
  2818*    -------------------------------
  2819     05  INCURL PIC S9(0004) COMP.
  2820     05  INCURF PIC  X(0001).
  2821     05  FILLER REDEFINES INCURF.
  2822         10  INCURA PIC  X(0001).
  2823     05  INCURI PIC  X(0008).
  2824*    -------------------------------
  2825     05  LSTDTEL PIC S9(0004) COMP.
  2826     05  LSTDTEF PIC  X(0001).
  2827     05  FILLER REDEFINES LSTDTEF.
  2828         10  LSTDTEA PIC  X(0001).
  2829     05  LSTDTEI PIC  X(0008).
  2830*    -------------------------------
  2831     05  CRTSTATL PIC S9(0004) COMP.
  2832     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  58
* EL156.cbl
  2833     05  FILLER REDEFINES CRTSTATF.
  2834         10  CRTSTATA PIC  X(0001).
  2835     05  CRTSTATI PIC  X(0010).
  2836*    -------------------------------
  2837     05  EFFECTL PIC S9(0004) COMP.
  2838     05  EFFECTF PIC  X(0001).
  2839     05  FILLER REDEFINES EFFECTF.
  2840         10  EFFECTA PIC  X(0001).
  2841     05  EFFECTI PIC  X(0008).
  2842*    -------------------------------
  2843     05  TERMSL PIC S9(0004) COMP.
  2844     05  TERMSF PIC  X(0001).
  2845     05  FILLER REDEFINES TERMSF.
  2846         10  TERMSA PIC  X(0001).
  2847     05  TERMSI PIC  X(0011).
  2848*    -------------------------------
  2849     05  STACCTL PIC S9(0004) COMP.
  2850     05  STACCTF PIC  X(0001).
  2851     05  FILLER REDEFINES STACCTF.
  2852         10  STACCTA PIC  X(0001).
  2853     05  STACCTI PIC  X(0013).
  2854*    -------------------------------
  2855     05  EXPDTEHL PIC S9(0004) COMP.
  2856     05  EXPDTEHF PIC  X(0001).
  2857     05  FILLER REDEFINES EXPDTEHF.
  2858         10  EXPDTEHA PIC  X(0001).
  2859     05  EXPDTEHI PIC  X(0014).
  2860*    -------------------------------
  2861     05  EXPDTEL PIC S9(0004) COMP.
  2862     05  EXPDTEF PIC  X(0001).
  2863     05  FILLER REDEFINES EXPDTEF.
  2864         10  EXPDTEA PIC  X(0001).
  2865     05  EXPDTEI PIC  X(0008).
  2866*    -------------------------------
  2867     05  BENECAPL PIC S9(0004) COMP.
  2868     05  BENECAPF PIC  X(0001).
  2869     05  FILLER REDEFINES BENECAPF.
  2870         10  BENECAPA PIC  X(0001).
  2871     05  BENECAPI PIC  X(0013).
  2872*    -------------------------------
  2873     05  BENEL PIC S9(0004) COMP.
  2874     05  BENEF PIC  X(0001).
  2875     05  FILLER REDEFINES BENEF.
  2876         10  BENEA PIC  X(0001).
  2877     05  BENEI PIC  X(0009).
  2878*    -------------------------------
  2879     05  FORMTYPL PIC S9(0004) COMP.
  2880     05  FORMTYPF PIC  X(0001).
  2881     05  FILLER REDEFINES FORMTYPF.
  2882         10  FORMTYPA PIC  X(0001).
  2883     05  FORMTYPI PIC  X(0001).
  2884*    -------------------------------
  2885     05  PMTTYPEL PIC S9(0004) COMP.
  2886     05  PMTTYPEF PIC  X(0001).
  2887     05  FILLER REDEFINES PMTTYPEF.
  2888         10  PMTTYPEA PIC  X(0001).
  2889     05  PMTTYPEI PIC  X(0001).
  2890*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  59
* EL156.cbl
  2891     05  PAYEEL PIC S9(0004) COMP.
  2892     05  PAYEEF PIC  X(0001).
  2893     05  FILLER REDEFINES PAYEEF.
  2894         10  PAYEEA PIC  X(0001).
  2895     05  PAYEEI PIC  X(0002).
  2896*    -------------------------------
  2897     05  CHECKNOL PIC S9(0004) COMP.
  2898     05  CHECKNOF PIC  X(0001).
  2899     05  FILLER REDEFINES CHECKNOF.
  2900         10  CHECKNOA PIC  X(0001).
  2901     05  CHECKNOI PIC  X(0007).
  2902*    -------------------------------
  2903     05  OFFLINEL PIC S9(0004) COMP.
  2904     05  OFFLINEF PIC  X(0001).
  2905     05  FILLER REDEFINES OFFLINEF.
  2906         10  OFFLINEA PIC  X(0001).
  2907     05  OFFLINEI PIC  X(0001).
  2908*    -------------------------------
  2909     05  HOLDTILL PIC S9(0004) COMP.
  2910     05  HOLDTILF PIC  X(0001).
  2911     05  FILLER REDEFINES HOLDTILF.
  2912         10  HOLDTILA PIC  X(0001).
  2913     05  HOLDTILI PIC  X(0008).
  2914*    -------------------------------
  2915     05  NOTE1L PIC S9(0004) COMP.
  2916     05  NOTE1F PIC  X(0001).
  2917     05  FILLER REDEFINES NOTE1F.
  2918         10  NOTE1A PIC  X(0001).
  2919     05  NOTE1I PIC  X(0060).
  2920*    -------------------------------
  2921     05  NOTE2L PIC S9(0004) COMP.
  2922     05  NOTE2F PIC  X(0001).
  2923     05  FILLER REDEFINES NOTE2F.
  2924         10  NOTE2A PIC  X(0001).
  2925     05  NOTE2I PIC  X(0060).
  2926*    -------------------------------
  2927     05  EOBYNL PIC S9(0004) COMP.
  2928     05  EOBYNF PIC  X(0001).
  2929     05  FILLER REDEFINES EOBYNF.
  2930         10  EOBYNA PIC  X(0001).
  2931     05  EOBYNI PIC  X(0001).
  2932*    -------------------------------
  2933     05  CLMFMYNL PIC S9(0004) COMP.
  2934     05  CLMFMYNF PIC  X(0001).
  2935     05  FILLER REDEFINES CLMFMYNF.
  2936         10  CLMFMYNA PIC  X(0001).
  2937     05  CLMFMYNI PIC  X(0001).
  2938*    -------------------------------
  2939     05  SURVYYNL PIC S9(0004) COMP.
  2940     05  SURVYYNF PIC  X(0001).
  2941     05  FILLER REDEFINES SURVYYNF.
  2942         10  SURVYYNA PIC  X(0001).
  2943     05  SURVYYNI PIC  X(0001).
  2944*    -------------------------------
  2945     05  SPRELYNL PIC S9(0004) COMP.
  2946     05  SPRELYNF PIC  X(0001).
  2947     05  FILLER REDEFINES SPRELYNF.
  2948         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  60
* EL156.cbl
  2949     05  SPRELYNI PIC  X(0001).
  2950*    -------------------------------
  2951     05  PINTHL PIC S9(0004) COMP.
  2952     05  PINTHF PIC  X(0001).
  2953     05  FILLER REDEFINES PINTHF.
  2954         10  PINTHA PIC  X(0001).
  2955     05  PINTHI PIC  X(0004).
  2956*    -------------------------------
  2957     05  PINTL PIC S9(0004) COMP.
  2958     05  PINTF PIC  X(0001).
  2959     05  FILLER REDEFINES PINTF.
  2960         10  PINTA PIC  X(0001).
  2961     05  PINTI PIC  X(0008).
  2962*    -------------------------------
  2963     05  PROOFDTL PIC S9(0004) COMP.
  2964     05  PROOFDTF PIC  X(0001).
  2965     05  FILLER REDEFINES PROOFDTF.
  2966         10  PROOFDTA PIC  X(0001).
  2967     05  PROOFDTI PIC  X(0008).
  2968*    -------------------------------
  2969     05  AIGFRMHL PIC S9(0004) COMP.
  2970     05  AIGFRMHF PIC  X(0001).
  2971     05  FILLER REDEFINES AIGFRMHF.
  2972         10  AIGFRMHA PIC  X(0001).
  2973     05  AIGFRMHI PIC  X(0012).
  2974*    -------------------------------
  2975     05  AIGFROML PIC S9(0004) COMP.
  2976     05  AIGFROMF PIC  X(0001).
  2977     05  FILLER REDEFINES AIGFROMF.
  2978         10  AIGFROMA PIC  X(0001).
  2979     05  AIGFROMI PIC  X(0008).
  2980*    -------------------------------
  2981     05  PMTHDGAL PIC S9(0004) COMP.
  2982     05  PMTHDGAF PIC  X(0001).
  2983     05  FILLER REDEFINES PMTHDGAF.
  2984         10  PMTHDGAA PIC  X(0001).
  2985     05  PMTHDGAI PIC  X(0066).
  2986*    -------------------------------
  2987     05  EPYFROML PIC S9(0004) COMP.
  2988     05  EPYFROMF PIC  X(0001).
  2989     05  FILLER REDEFINES EPYFROMF.
  2990         10  EPYFROMA PIC  X(0001).
  2991     05  EPYFROMI PIC  X(0008).
  2992*    -------------------------------
  2993     05  EPYTHRUL PIC S9(0004) COMP.
  2994     05  EPYTHRUF PIC  X(0001).
  2995     05  FILLER REDEFINES EPYTHRUF.
  2996         10  EPYTHRUA PIC  X(0001).
  2997     05  EPYTHRUI PIC  X(0008).
  2998*    -------------------------------
  2999     05  EDAYSL PIC S9(0004) COMP.
  3000     05  EDAYSF PIC  X(0001).
  3001     05  FILLER REDEFINES EDAYSF.
  3002         10  EDAYSA PIC  X(0001).
  3003     05  EDAYSI PIC  S9(6).
  3004*    -------------------------------
  3005     05  EPYAMTL PIC S9(0004) COMP.
  3006     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  61
* EL156.cbl
  3007     05  FILLER REDEFINES EPYAMTF.
  3008         10  EPYAMTA PIC  X(0001).
  3009     05  EPYAMTI PIC  S9(8)V99.
  3010*    -------------------------------
  3011     05  ERESVL PIC S9(0004) COMP.
  3012     05  ERESVF PIC  X(0001).
  3013     05  FILLER REDEFINES ERESVF.
  3014         10  ERESVA PIC  X(0001).
  3015     05  ERESVI PIC  S9(7)V99.
  3016*    -------------------------------
  3017     05  ETYPEL PIC S9(0004) COMP.
  3018     05  ETYPEF PIC  X(0001).
  3019     05  FILLER REDEFINES ETYPEF.
  3020         10  ETYPEA PIC  X(0001).
  3021     05  ETYPEI PIC  X(0001).
  3022*    -------------------------------
  3023     05  EEXPENSL PIC S9(0004) COMP.
  3024     05  EEXPENSF PIC  X(0001).
  3025     05  FILLER REDEFINES EEXPENSF.
  3026         10  EEXPENSA PIC  X(0001).
  3027     05  EEXPENSI PIC  9(6)V99.
  3028*    -------------------------------
  3029     05  CPYFROML PIC S9(0004) COMP.
  3030     05  CPYFROMF PIC  X(0001).
  3031     05  FILLER REDEFINES CPYFROMF.
  3032         10  CPYFROMA PIC  X(0001).
  3033     05  CPYFROMI PIC  X(0008).
  3034*    -------------------------------
  3035     05  CPYTHRUL PIC S9(0004) COMP.
  3036     05  CPYTHRUF PIC  X(0001).
  3037     05  FILLER REDEFINES CPYTHRUF.
  3038         10  CPYTHRUA PIC  X(0001).
  3039     05  CPYTHRUI PIC  X(0008).
  3040*    -------------------------------
  3041     05  CDAYSL PIC S9(0004) COMP.
  3042     05  CDAYSF PIC  X(0001).
  3043     05  FILLER REDEFINES CDAYSF.
  3044         10  CDAYSA PIC  X(0001).
  3045     05  CDAYSI PIC  9(6).
  3046*    -------------------------------
  3047     05  CPYAMTL PIC S9(0004) COMP.
  3048     05  CPYAMTF PIC  X(0001).
  3049     05  FILLER REDEFINES CPYAMTF.
  3050         10  CPYAMTA PIC  X(0001).
  3051     05  CPYAMTI PIC  S9(8)V99.
  3052*    -------------------------------
  3053     05  CRESVL PIC S9(0004) COMP.
  3054     05  CRESVF PIC  X(0001).
  3055     05  FILLER REDEFINES CRESVF.
  3056         10  CRESVA PIC  X(0001).
  3057     05  CRESVI PIC  9(6)V99.
  3058*    -------------------------------
  3059     05  CEXPENSL PIC S9(0004) COMP.
  3060     05  CEXPENSF PIC  X(0001).
  3061     05  FILLER REDEFINES CEXPENSF.
  3062         10  CEXPENSA PIC  X(0001).
  3063     05  CEXPENSI PIC  9(6)V99.
  3064*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  62
* EL156.cbl
  3065     05  ERRMSG0L PIC S9(0004) COMP.
  3066     05  ERRMSG0F PIC  X(0001).
  3067     05  FILLER REDEFINES ERRMSG0F.
  3068         10  ERRMSG0A PIC  X(0001).
  3069     05  ERRMSG0I PIC  X(0072).
  3070*    -------------------------------
  3071     05  ERRMSG1L PIC S9(0004) COMP.
  3072     05  ERRMSG1F PIC  X(0001).
  3073     05  FILLER REDEFINES ERRMSG1F.
  3074         10  ERRMSG1A PIC  X(0001).
  3075     05  ERRMSG1I PIC  X(0072).
  3076*    -------------------------------
  3077     05  ERRMSG2L PIC S9(0004) COMP.
  3078     05  ERRMSG2F PIC  X(0001).
  3079     05  FILLER REDEFINES ERRMSG2F.
  3080         10  ERRMSG2A PIC  X(0001).
  3081     05  ERRMSG2I PIC  X(0072).
  3082*    -------------------------------
  3083     05  ENTERPFL PIC S9(0004) COMP.
  3084     05  ENTERPFF PIC  X(0001).
  3085     05  FILLER REDEFINES ENTERPFF.
  3086         10  ENTERPFA PIC  X(0001).
  3087     05  ENTERPFI PIC  99.
  3088*    -------------------------------
  3089     05  PF6TITL PIC S9(0004) COMP.
  3090     05  PF6TITF PIC  X(0001).
  3091     05  FILLER REDEFINES PF6TITF.
  3092         10  PF6TITA PIC  X(0001).
  3093     05  PF6TITI PIC  X(0016).
  3094 01  EL156AO REDEFINES EL156AI.
  3095     05  FILLER            PIC  X(0012).
  3096*    -------------------------------
  3097     05  FILLER            PIC  X(0003).
  3098     05  RUNDTEAO PIC  X(0008).
  3099*    -------------------------------
  3100     05  FILLER            PIC  X(0003).
  3101     05  RUNTIMAO PIC  99.99.
  3102*    -------------------------------
  3103     05  FILLER            PIC  X(0003).
  3104     05  SEQUO PIC  X(0010).
  3105*    -------------------------------
  3106     05  FILLER            PIC  X(0003).
  3107     05  CLMNOO PIC  X(0007).
  3108*    -------------------------------
  3109     05  FILLER            PIC  X(0003).
  3110     05  CARRO PIC  X(0001).
  3111*    -------------------------------
  3112     05  FILLER            PIC  X(0003).
  3113     05  CERTNOO PIC  X(0010).
  3114*    -------------------------------
  3115     05  FILLER            PIC  X(0003).
  3116     05  SUFXO PIC  X(0001).
  3117*    -------------------------------
  3118     05  FILLER            PIC  X(0003).
  3119     05  CLMTYPO PIC  X(0006).
  3120*    -------------------------------
  3121     05  FILLER            PIC  X(0003).
  3122     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  63
* EL156.cbl
  3123*    -------------------------------
  3124     05  FILLER            PIC  X(0003).
  3125     05  LSTNMEO PIC  X(0015).
  3126*    -------------------------------
  3127     05  FILLER            PIC  X(0003).
  3128     05  FSTNMEO PIC  X(0012).
  3129*    -------------------------------
  3130     05  FILLER            PIC  X(0003).
  3131     05  MINITO PIC  X(0001).
  3132*    -------------------------------
  3133     05  FILLER            PIC  X(0003).
  3134     05  PRIMHDGO PIC  X(0012).
  3135*    -------------------------------
  3136     05  FILLER            PIC  X(0003).
  3137     05  PCERTNOO PIC  X(0010).
  3138*    -------------------------------
  3139     05  FILLER            PIC  X(0003).
  3140     05  PSUFXO PIC  X(0001).
  3141*    -------------------------------
  3142     05  FILLER            PIC  X(0003).
  3143     05  STATUSO PIC  X(0010).
  3144*    -------------------------------
  3145     05  FILLER            PIC  X(0003).
  3146     05  LOANHO PIC  X(0014).
  3147*    -------------------------------
  3148     05  FILLER            PIC  X(0003).
  3149     05  LOANNOO PIC  X(0025).
  3150*    -------------------------------
  3151     05  FILLER            PIC  X(0003).
  3152     05  DUEDAYHO PIC  X(0008).
  3153*    -------------------------------
  3154     05  FILLER            PIC  X(0003).
  3155     05  DUEDAYO PIC  X(0002).
  3156*    -------------------------------
  3157     05  FILLER            PIC  X(0003).
  3158     05  ZINTHO PIC  X(0009).
  3159*    -------------------------------
  3160     05  FILLER            PIC  X(0003).
  3161     05  ZINTO PIC  9.99999.
  3162*    -------------------------------
  3163     05  FILLER            PIC  X(0003).
  3164     05  PTHRHDGO PIC  X(0014).
  3165*    -------------------------------
  3166     05  FILLER            PIC  X(0003).
  3167     05  PDTHRUO PIC  X(0008).
  3168*    -------------------------------
  3169     05  FILLER            PIC  X(0003).
  3170     05  TOTPAIDO PIC  Z(6).99-.
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  COVERO PIC  X(0010).
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  INCURO PIC  X(0008).
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  LSTDTEO PIC  X(0008).
  3180*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  64
* EL156.cbl
  3181     05  FILLER            PIC  X(0003).
  3182     05  CRTSTATO PIC  X(0010).
  3183*    -------------------------------
  3184     05  FILLER            PIC  X(0003).
  3185     05  EFFECTO PIC  X(0008).
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  TERMSO PIC  X(0011).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  STACCTO PIC  X(0013).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  EXPDTEHO PIC  X(0014).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  EXPDTEO PIC  X(0008).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  BENECAPO PIC  X(0013).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  BENEO PIC  Z(6).99.
  3204*    -------------------------------
  3205     05  FILLER            PIC  X(0003).
  3206     05  FORMTYPO PIC  X(0001).
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
  3209     05  PMTTYPEO PIC  X(0001).
  3210*    -------------------------------
  3211     05  FILLER            PIC  X(0003).
  3212     05  PAYEEO PIC  X(0002).
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  CHECKNOO PIC  X(0007).
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  OFFLINEO PIC  X(0001).
  3219*    -------------------------------
  3220     05  FILLER            PIC  X(0003).
  3221     05  HOLDTILO PIC  99B99B99.
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  NOTE1O PIC  X(0060).
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  NOTE2O PIC  X(0060).
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  EOBYNO PIC  X(0001).
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  CLMFMYNO PIC  X(0001).
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  SURVYYNO PIC  X(0001).
  3237*    -------------------------------
  3238     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  65
* EL156.cbl
  3239     05  SPRELYNO PIC  X(0001).
  3240*    -------------------------------
  3241     05  FILLER            PIC  X(0003).
  3242     05  PINTHO PIC  X(0004).
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
  3245     05  PINTO PIC  Z,ZZ9.99.
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  PROOFDTO PIC  99B99B99.
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  AIGFRMHO PIC  X(0012).
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  AIGFROMO PIC  99B99B99.
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  PMTHDGAO PIC  X(0066).
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  EPYFROMO PIC  99B99B99.
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
  3263     05  EPYTHRUO PIC  99B99B99.
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  EDAYSO PIC  Z(4)9-.
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
  3269     05  EPYAMTO PIC  Z(6).99-.
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  ERESVO PIC  Z(5).99-.
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  ETYPEO PIC  X(0001).
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
  3278     05  EEXPENSO PIC  Z(5).99.
  3279*    -------------------------------
  3280     05  FILLER            PIC  X(0003).
  3281     05  CPYFROMO PIC  99B99B99.
  3282*    -------------------------------
  3283     05  FILLER            PIC  X(0003).
  3284     05  CPYTHRUO PIC  99B99B99.
  3285*    -------------------------------
  3286     05  FILLER            PIC  X(0003).
  3287     05  CDAYSO PIC  Z(4)9-.
  3288*    -------------------------------
  3289     05  FILLER            PIC  X(0003).
  3290     05  CPYAMTO PIC  Z(6).99-.
  3291*    -------------------------------
  3292     05  FILLER            PIC  X(0003).
  3293     05  CRESVO PIC  Z(5).99.
  3294*    -------------------------------
  3295     05  FILLER            PIC  X(0003).
  3296     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  66
* EL156.cbl
  3297*    -------------------------------
  3298     05  FILLER            PIC  X(0003).
  3299     05  ERRMSG0O PIC  X(0072).
  3300*    -------------------------------
  3301     05  FILLER            PIC  X(0003).
  3302     05  ERRMSG1O PIC  X(0072).
  3303*    -------------------------------
  3304     05  FILLER            PIC  X(0003).
  3305     05  ERRMSG2O PIC  X(0072).
  3306*    -------------------------------
  3307     05  FILLER            PIC  X(0003).
  3308     05  ENTERPFO PIC  X(0002).
  3309*    -------------------------------
  3310     05  FILLER            PIC  X(0003).
  3311     05  PF6TITO PIC  X(0016).
  3312*    -------------------------------
  3313 01  EL156BI REDEFINES EL156AI.
  3314     05  FILLER            PIC  X(0012).
  3315*    -------------------------------
  3316     05  RUNDTEBL PIC S9(0004) COMP.
  3317     05  RUNDTEBF PIC  X(0001).
  3318     05  FILLER REDEFINES RUNDTEBF.
  3319         10  RUNDTEBA PIC  X(0001).
  3320     05  RUNDTEBI PIC  X(0008).
  3321*    -------------------------------
  3322     05  RUNTIMBL PIC S9(0004) COMP.
  3323     05  RUNTIMBF PIC  X(0001).
  3324     05  FILLER REDEFINES RUNTIMBF.
  3325         10  RUNTIMBA PIC  X(0001).
  3326     05  RUNTIMBI PIC  X(0005).
  3327*    -------------------------------
  3328     05  PAYDTBL PIC S9(0004) COMP.
  3329     05  PAYDTBF PIC  X(0001).
  3330     05  FILLER REDEFINES PAYDTBF.
  3331         10  PAYDTBA PIC  X(0001).
  3332     05  PAYDTBI PIC  X(0008).
  3333*    -------------------------------
  3334     05  PAYTYPBL PIC S9(0004) COMP.
  3335     05  PAYTYPBF PIC  X(0001).
  3336     05  FILLER REDEFINES PAYTYPBF.
  3337         10  PAYTYPBA PIC  X(0001).
  3338     05  PAYTYPBI PIC  X(0015).
  3339*    -------------------------------
  3340     05  PAYAMTBL PIC S9(0004) COMP.
  3341     05  PAYAMTBF PIC  X(0001).
  3342     05  FILLER REDEFINES PAYAMTBF.
  3343         10  PAYAMTBA PIC  X(0001).
  3344     05  PAYAMTBI PIC  X(0011).
  3345*    -------------------------------
  3346     05  LOANHBL PIC S9(0004) COMP.
  3347     05  LOANHBF PIC  X(0001).
  3348     05  FILLER REDEFINES LOANHBF.
  3349         10  LOANHBA PIC  X(0001).
  3350     05  LOANHBI PIC  X(0012).
  3351*    -------------------------------
  3352     05  LOANNBL PIC S9(0004) COMP.
  3353     05  LOANNBF PIC  X(0001).
  3354     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  67
* EL156.cbl
  3355         10  LOANNBA PIC  X(0001).
  3356     05  LOANNBI PIC  X(0025).
  3357*    -------------------------------
  3358     05  CKNUMHDL PIC S9(0004) COMP.
  3359     05  CKNUMHDF PIC  X(0001).
  3360     05  FILLER REDEFINES CKNUMHDF.
  3361         10  CKNUMHDA PIC  X(0001).
  3362     05  CKNUMHDI PIC  X(0012).
  3363*    -------------------------------
  3364     05  CKNUMBL PIC S9(0004) COMP.
  3365     05  CKNUMBF PIC  X(0001).
  3366     05  FILLER REDEFINES CKNUMBF.
  3367         10  CKNUMBA PIC  X(0001).
  3368     05  CKNUMBI PIC  X(0007).
  3369*    -------------------------------
  3370     05  AGTHDGL PIC S9(0004) COMP.
  3371     05  AGTHDGF PIC  X(0001).
  3372     05  FILLER REDEFINES AGTHDGF.
  3373         10  AGTHDGA PIC  X(0001).
  3374     05  AGTHDGI PIC  X(0016).
  3375*    -------------------------------
  3376     05  NAMEBL PIC S9(0004) COMP.
  3377     05  NAMEBF PIC  X(0001).
  3378     05  FILLER REDEFINES NAMEBF.
  3379         10  NAMEBA PIC  X(0001).
  3380     05  NAMEBI PIC  X(0030).
  3381*    -------------------------------
  3382     05  NAMEB2L PIC S9(0004) COMP.
  3383     05  NAMEB2F PIC  X(0001).
  3384     05  FILLER REDEFINES NAMEB2F.
  3385         10  NAMEB2A PIC  X(0001).
  3386     05  NAMEB2I PIC  X(0030).
  3387*    -------------------------------
  3388     05  ADDR1BL PIC S9(0004) COMP.
  3389     05  ADDR1BF PIC  X(0001).
  3390     05  FILLER REDEFINES ADDR1BF.
  3391         10  ADDR1BA PIC  X(0001).
  3392     05  ADDR1BI PIC  X(0030).
  3393*    -------------------------------
  3394     05  ADDR1B2L PIC S9(0004) COMP.
  3395     05  ADDR1B2F PIC  X(0001).
  3396     05  FILLER REDEFINES ADDR1B2F.
  3397         10  ADDR1B2A PIC  X(0001).
  3398     05  ADDR1B2I PIC  X(0030).
  3399*    -------------------------------
  3400     05  ADDR2BL PIC S9(0004) COMP.
  3401     05  ADDR2BF PIC  X(0001).
  3402     05  FILLER REDEFINES ADDR2BF.
  3403         10  ADDR2BA PIC  X(0001).
  3404     05  ADDR2BI PIC  X(0030).
  3405*    -------------------------------
  3406     05  ADDR2B2L PIC S9(0004) COMP.
  3407     05  ADDR2B2F PIC  X(0001).
  3408     05  FILLER REDEFINES ADDR2B2F.
  3409         10  ADDR2B2A PIC  X(0001).
  3410     05  ADDR2B2I PIC  X(0030).
  3411*    -------------------------------
  3412     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  68
* EL156.cbl
  3413     05  CITYSTBF PIC  X(0001).
  3414     05  FILLER REDEFINES CITYSTBF.
  3415         10  CITYSTBA PIC  X(0001).
  3416     05  CITYSTBI PIC  X(0030).
  3417*    -------------------------------
  3418     05  CITYST2L PIC S9(0004) COMP.
  3419     05  CITYST2F PIC  X(0001).
  3420     05  FILLER REDEFINES CITYST2F.
  3421         10  CITYST2A PIC  X(0001).
  3422     05  CITYST2I PIC  X(0030).
  3423*    -------------------------------
  3424     05  ZIPBL PIC S9(0004) COMP.
  3425     05  ZIPBF PIC  X(0001).
  3426     05  FILLER REDEFINES ZIPBF.
  3427         10  ZIPBA PIC  X(0001).
  3428     05  ZIPBI PIC  X(0009).
  3429*    -------------------------------
  3430     05  ZIPB2L PIC S9(0004) COMP.
  3431     05  ZIPB2F PIC  X(0001).
  3432     05  FILLER REDEFINES ZIPB2F.
  3433         10  ZIPB2A PIC  X(0001).
  3434     05  ZIPB2I PIC  X(0009).
  3435*    -------------------------------
  3436     05  INTHDBL PIC S9(0004) COMP.
  3437     05  INTHDBF PIC  X(0001).
  3438     05  FILLER REDEFINES INTHDBF.
  3439         10  INTHDBA PIC  X(0001).
  3440     05  INTHDBI PIC  X(0012).
  3441*    -------------------------------
  3442     05  INTAMTBL PIC S9(0004) COMP.
  3443     05  INTAMTBF PIC  X(0001).
  3444     05  FILLER REDEFINES INTAMTBF.
  3445         10  INTAMTBA PIC  X(0001).
  3446     05  INTAMTBI PIC  X(0011).
  3447*    -------------------------------
  3448     05  PMTHDGBL PIC S9(0004) COMP.
  3449     05  PMTHDGBF PIC  X(0001).
  3450     05  FILLER REDEFINES PMTHDGBF.
  3451         10  PMTHDGBA PIC  X(0001).
  3452     05  PMTHDGBI PIC  X(0034).
  3453*    -------------------------------
  3454     05  CLMNOBL PIC S9(0004) COMP.
  3455     05  CLMNOBF PIC  X(0001).
  3456     05  FILLER REDEFINES CLMNOBF.
  3457         10  CLMNOBA PIC  X(0001).
  3458     05  CLMNOBI PIC  X(0007).
  3459*    -------------------------------
  3460     05  CARRBL PIC S9(0004) COMP.
  3461     05  CARRBF PIC  X(0001).
  3462     05  FILLER REDEFINES CARRBF.
  3463         10  CARRBA PIC  X(0001).
  3464     05  CARRBI PIC  X(0001).
  3465*    -------------------------------
  3466     05  CERTNOBL PIC S9(0004) COMP.
  3467     05  CERTNOBF PIC  X(0001).
  3468     05  FILLER REDEFINES CERTNOBF.
  3469         10  CERTNOBA PIC  X(0001).
  3470     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  69
* EL156.cbl
  3471*    -------------------------------
  3472     05  SUFXBL PIC S9(0004) COMP.
  3473     05  SUFXBF PIC  X(0001).
  3474     05  FILLER REDEFINES SUFXBF.
  3475         10  SUFXBA PIC  X(0001).
  3476     05  SUFXBI PIC  X(0001).
  3477*    -------------------------------
  3478     05  CLMTYPBL PIC S9(0004) COMP.
  3479     05  CLMTYPBF PIC  X(0001).
  3480     05  FILLER REDEFINES CLMTYPBF.
  3481         10  CLMTYPBA PIC  X(0001).
  3482     05  CLMTYPBI PIC  X(0006).
  3483*    -------------------------------
  3484     05  INCURBL PIC S9(0004) COMP.
  3485     05  INCURBF PIC  X(0001).
  3486     05  FILLER REDEFINES INCURBF.
  3487         10  INCURBA PIC  X(0001).
  3488     05  INCURBI PIC  X(0008).
  3489*    -------------------------------
  3490     05  PYFROMBL PIC S9(0004) COMP.
  3491     05  PYFROMBF PIC  X(0001).
  3492     05  FILLER REDEFINES PYFROMBF.
  3493         10  PYFROMBA PIC  X(0001).
  3494     05  PYFROMBI PIC  X(0008).
  3495*    -------------------------------
  3496     05  PYTHRUBL PIC S9(0004) COMP.
  3497     05  PYTHRUBF PIC  X(0001).
  3498     05  FILLER REDEFINES PYTHRUBF.
  3499         10  PYTHRUBA PIC  X(0001).
  3500     05  PYTHRUBI PIC  X(0008).
  3501*    -------------------------------
  3502     05  DAYSBL PIC S9(0004) COMP.
  3503     05  DAYSBF PIC  X(0001).
  3504     05  FILLER REDEFINES DAYSBF.
  3505         10  DAYSBA PIC  X(0001).
  3506     05  DAYSBI PIC  X(0005).
  3507*    -------------------------------
  3508     05  BYBL PIC S9(0004) COMP.
  3509     05  BYBF PIC  X(0001).
  3510     05  FILLER REDEFINES BYBF.
  3511         10  BYBA PIC  X(0001).
  3512     05  BYBI PIC  X(0004).
  3513*    -------------------------------
  3514     05  PROOFDBL PIC S9(0004) COMP.
  3515     05  PROOFDBF PIC  X(0001).
  3516     05  FILLER REDEFINES PROOFDBF.
  3517         10  PROOFDBA PIC  X(0001).
  3518     05  PROOFDBI PIC  X(0008).
  3519*    -------------------------------
  3520     05  ACCTBL PIC S9(0004) COMP.
  3521     05  ACCTBF PIC  X(0001).
  3522     05  FILLER REDEFINES ACCTBF.
  3523         10  ACCTBA PIC  X(0001).
  3524     05  ACCTBI PIC  X(0010).
  3525*    -------------------------------
  3526     05  STATEBL PIC S9(0004) COMP.
  3527     05  STATEBF PIC  X(0001).
  3528     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  70
* EL156.cbl
  3529         10  STATEBA PIC  X(0001).
  3530     05  STATEBI PIC  X(0002).
  3531*    -------------------------------
  3532     05  GROUPBL PIC S9(0004) COMP.
  3533     05  GROUPBF PIC  X(0001).
  3534     05  FILLER REDEFINES GROUPBF.
  3535         10  GROUPBA PIC  X(0001).
  3536     05  GROUPBI PIC  X(0006).
  3537*    -------------------------------
  3538     05  ACARRBL PIC S9(0004) COMP.
  3539     05  ACARRBF PIC  X(0001).
  3540     05  FILLER REDEFINES ACARRBF.
  3541         10  ACARRBA PIC  X(0001).
  3542     05  ACARRBI PIC  X(0001).
  3543*    -------------------------------
  3544     05  ACCTNMBL PIC S9(0004) COMP.
  3545     05  ACCTNMBF PIC  X(0001).
  3546     05  FILLER REDEFINES ACCTNMBF.
  3547         10  ACCTNMBA PIC  X(0001).
  3548     05  ACCTNMBI PIC  X(0030).
  3549*    -------------------------------
  3550     05  UNDISBL PIC S9(0004) COMP.
  3551     05  UNDISBF PIC  X(0001).
  3552     05  FILLER REDEFINES UNDISBF.
  3553         10  UNDISBA PIC  X(0001).
  3554     05  UNDISBI PIC  X(0010).
  3555*    -------------------------------
  3556     05  RATEBL PIC S9(0004) COMP.
  3557     05  RATEBF PIC  X(0001).
  3558     05  FILLER REDEFINES RATEBF.
  3559         10  RATEBA PIC  X(0001).
  3560     05  RATEBI PIC  X(0006).
  3561*    -------------------------------
  3562     05  ERMSG1BL PIC S9(0004) COMP.
  3563     05  ERMSG1BF PIC  X(0001).
  3564     05  FILLER REDEFINES ERMSG1BF.
  3565         10  ERMSG1BA PIC  X(0001).
  3566     05  ERMSG1BI PIC  X(0072).
  3567*    -------------------------------
  3568     05  ENTPFBL PIC S9(0004) COMP.
  3569     05  ENTPFBF PIC  X(0001).
  3570     05  FILLER REDEFINES ENTPFBF.
  3571         10  ENTPFBA PIC  X(0001).
  3572     05  ENTPFBI PIC  99.
  3573 01  EL156BO REDEFINES EL156AI.
  3574     05  FILLER            PIC  X(0012).
  3575*    -------------------------------
  3576     05  FILLER            PIC  X(0003).
  3577     05  RUNDTEBO PIC  X(0008).
  3578*    -------------------------------
  3579     05  FILLER            PIC  X(0003).
  3580     05  RUNTIMBO PIC  99.99.
  3581*    -------------------------------
  3582     05  FILLER            PIC  X(0003).
  3583     05  PAYDTBO PIC  99B99B99.
  3584*    -------------------------------
  3585     05  FILLER            PIC  X(0003).
  3586     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  71
* EL156.cbl
  3587*    -------------------------------
  3588     05  FILLER            PIC  X(0003).
  3589     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3590*    -------------------------------
  3591     05  FILLER            PIC  X(0003).
  3592     05  LOANHBO PIC  X(0012).
  3593*    -------------------------------
  3594     05  FILLER            PIC  X(0003).
  3595     05  LOANNBO PIC  X(0025).
  3596*    -------------------------------
  3597     05  FILLER            PIC  X(0003).
  3598     05  CKNUMHDO PIC  X(0012).
  3599*    -------------------------------
  3600     05  FILLER            PIC  X(0003).
  3601     05  CKNUMBO PIC  X(0007).
  3602*    -------------------------------
  3603     05  FILLER            PIC  X(0003).
  3604     05  AGTHDGO PIC  X(0016).
  3605*    -------------------------------
  3606     05  FILLER            PIC  X(0003).
  3607     05  NAMEBO PIC  X(0030).
  3608*    -------------------------------
  3609     05  FILLER            PIC  X(0003).
  3610     05  NAMEB2O PIC  X(0030).
  3611*    -------------------------------
  3612     05  FILLER            PIC  X(0003).
  3613     05  ADDR1BO PIC  X(0030).
  3614*    -------------------------------
  3615     05  FILLER            PIC  X(0003).
  3616     05  ADDR1B2O PIC  X(0030).
  3617*    -------------------------------
  3618     05  FILLER            PIC  X(0003).
  3619     05  ADDR2BO PIC  X(0030).
  3620*    -------------------------------
  3621     05  FILLER            PIC  X(0003).
  3622     05  ADDR2B2O PIC  X(0030).
  3623*    -------------------------------
  3624     05  FILLER            PIC  X(0003).
  3625     05  CITYSTBO PIC  X(0030).
  3626*    -------------------------------
  3627     05  FILLER            PIC  X(0003).
  3628     05  CITYST2O PIC  X(0030).
  3629*    -------------------------------
  3630     05  FILLER            PIC  X(0003).
  3631     05  ZIPBO PIC  ZZZZ99999.
  3632*    -------------------------------
  3633     05  FILLER            PIC  X(0003).
  3634     05  ZIPB2O PIC  ZZZZZZZZZ.
  3635*    -------------------------------
  3636     05  FILLER            PIC  X(0003).
  3637     05  INTHDBO PIC  X(0012).
  3638*    -------------------------------
  3639     05  FILLER            PIC  X(0003).
  3640     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3641*    -------------------------------
  3642     05  FILLER            PIC  X(0003).
  3643     05  PMTHDGBO PIC  X(0034).
  3644*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  72
* EL156.cbl
  3645     05  FILLER            PIC  X(0003).
  3646     05  CLMNOBO PIC  X(0007).
  3647*    -------------------------------
  3648     05  FILLER            PIC  X(0003).
  3649     05  CARRBO PIC  X(0001).
  3650*    -------------------------------
  3651     05  FILLER            PIC  X(0003).
  3652     05  CERTNOBO PIC  X(0010).
  3653*    -------------------------------
  3654     05  FILLER            PIC  X(0003).
  3655     05  SUFXBO PIC  X(0001).
  3656*    -------------------------------
  3657     05  FILLER            PIC  X(0003).
  3658     05  CLMTYPBO PIC  X(0006).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  INCURBO PIC  X(0008).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  PYFROMBO PIC  99B99B99.
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  PYTHRUBO PIC  99B99B99.
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
  3670     05  DAYSBO PIC  X(0005).
  3671*    -------------------------------
  3672     05  FILLER            PIC  X(0003).
  3673     05  BYBO PIC  X(0004).
  3674*    -------------------------------
  3675     05  FILLER            PIC  X(0003).
  3676     05  PROOFDBO PIC  99B99B99.
  3677*    -------------------------------
  3678     05  FILLER            PIC  X(0003).
  3679     05  ACCTBO PIC  X(0010).
  3680*    -------------------------------
  3681     05  FILLER            PIC  X(0003).
  3682     05  STATEBO PIC  X(0002).
  3683*    -------------------------------
  3684     05  FILLER            PIC  X(0003).
  3685     05  GROUPBO PIC  X(0006).
  3686*    -------------------------------
  3687     05  FILLER            PIC  X(0003).
  3688     05  ACARRBO PIC  X(0001).
  3689*    -------------------------------
  3690     05  FILLER            PIC  X(0003).
  3691     05  ACCTNMBO PIC  X(0030).
  3692*    -------------------------------
  3693     05  FILLER            PIC  X(0003).
  3694     05  UNDISBO PIC  ZZZ,Z99.99.
  3695*    -------------------------------
  3696     05  FILLER            PIC  X(0003).
  3697     05  RATEBO PIC  ZZZ.99.
  3698*    -------------------------------
  3699     05  FILLER            PIC  X(0003).
  3700     05  ERMSG1BO PIC  X(0072).
  3701*    -------------------------------
  3702     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  73
* EL156.cbl
  3703     05  ENTPFBO PIC  X(0002).
  3704*    -------------------------------
  3705****************************************************************
  3706*
  3707* Copyright (c) 2007 by Clerity Solutions, Inc.
  3708* All rights reserved.
  3709*
  3710****************************************************************
  3711 01  DFHEIV.
  3712   02  DFHEIV0               PIC X(35).
  3713   02  DFHEIV1               PIC X(08).
  3714   02  DFHEIV2               PIC X(08).
  3715   02  DFHEIV3               PIC X(08).
  3716   02  DFHEIV4               PIC X(06).
  3717   02  DFHEIV5               PIC X(04).
  3718   02  DFHEIV6               PIC X(04).
  3719   02  DFHEIV7               PIC X(02).
  3720   02  DFHEIV8               PIC X(02).
  3721   02  DFHEIV9               PIC X(01).
  3722   02  DFHEIV10              PIC S9(7) COMP-3.
  3723   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3724   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3725   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3726   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3727   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3728   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3729   02  DFHEIV17              PIC X(04).
  3730   02  DFHEIV18              PIC X(04).
  3731   02  DFHEIV19              PIC X(04).
  3732   02  DFHEIV20              USAGE IS POINTER.
  3733   02  DFHEIV21              USAGE IS POINTER.
  3734   02  DFHEIV22              USAGE IS POINTER.
  3735   02  DFHEIV23              USAGE IS POINTER.
  3736   02  DFHEIV24              USAGE IS POINTER.
  3737   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3738   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3739   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3740   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3741   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3742   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3743   02  FILLER                PIC X(02).
  3744   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3745   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3746   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3747   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3748   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3749 LINKAGE  SECTION.
  3750*****************************************************************
  3751*                                                               *
  3752* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3753* All rights reserved.                                          *
  3754*                                                               *
  3755*****************************************************************
  3756 01  dfheiblk.
  3757     02  eibtime          pic s9(7) comp-3.
  3758     02  eibdate          pic s9(7) comp-3.
  3759     02  eibtrnid         pic x(4).
  3760     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  74
* EL156.cbl
  3761     02  eibtrmid         pic x(4).
  3762     02  dfheigdi         pic s9(4) comp.
  3763     02  eibcposn         pic s9(4) comp.
  3764     02  eibcalen         pic s9(4) comp.
  3765     02  eibaid           pic x(1).
  3766     02  eibfiller1       pic x(1).
  3767     02  eibfn            pic x(2).
  3768     02  eibfiller2       pic x(2).
  3769     02  eibrcode         pic x(6).
  3770     02  eibfiller3       pic x(2).
  3771     02  eibds            pic x(8).
  3772     02  eibreqid         pic x(8).
  3773     02  eibrsrce         pic x(8).
  3774     02  eibsync          pic x(1).
  3775     02  eibfree          pic x(1).
  3776     02  eibrecv          pic x(1).
  3777     02  eibsend          pic x(1).
  3778     02  eibatt           pic x(1).
  3779     02  eibeoc           pic x(1).
  3780     02  eibfmh           pic x(1).
  3781     02  eibcompl         pic x(1).
  3782     02  eibsig           pic x(1).
  3783     02  eibconf          pic x(1).
  3784     02  eiberr           pic x(1).
  3785     02  eibrldbk         pic x(1).
  3786     02  eiberrcd         pic x(4).
  3787     02  eibsynrb         pic x(1).
  3788     02  eibnodat         pic x(1).
  3789     02  eibfiller5       pic x(2).
  3790     02  eibresp          pic 9(09) comp.
  3791     02  eibresp2         pic 9(09) comp.
  3792     02  dfheigdj         pic s9(4) comp.
  3793     02  dfheigdk         pic s9(4) comp.
  3794 01  DFHCOMMAREA             PIC X(1024).
  3795
  3796*    COPY ELCMSTR.
  3797******************************************************************
  3798*                                                                *
  3799*                            ELCMSTR.                            *
  3800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3801*                            VMOD=2.012                          *
  3802*                                                                *
  3803*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3804*                                                                *
  3805*   FILE TYPE = VSAM,KSDS                                        *
  3806*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3807*                                                                *
  3808*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3809*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3810*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3811*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3812*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3813*                                                 RKP=75,LEN=21  *
  3814*                                                                *
  3815*   **** NOTE ****                                               *
  3816*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3817*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3818*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  75
* EL156.cbl
  3819*   LOG = YES                                                    *
  3820*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3821******************************************************************
  3822*                   C H A N G E   L O G
  3823*
  3824* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3825*-----------------------------------------------------------------
  3826*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3827* EFFECTIVE    NUMBER
  3828*-----------------------------------------------------------------
  3829* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3830* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3831* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3832* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3833* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3834******************************************************************
  3835 01  CLAIM-MASTER.
  3836     12  CL-RECORD-ID                PIC XX.
  3837         88  VALID-CL-ID         VALUE 'CL'.
  3838
  3839     12  CL-CONTROL-PRIMARY.
  3840         16  CL-COMPANY-CD           PIC X.
  3841         16  CL-CARRIER              PIC X.
  3842         16  CL-CLAIM-NO             PIC X(7).
  3843         16  CL-CERT-NO.
  3844             20  CL-CERT-PRIME       PIC X(10).
  3845             20  CL-CERT-SFX         PIC X.
  3846
  3847     12  CL-CONTROL-BY-NAME.
  3848         16  CL-COMPANY-CD-A1        PIC X.
  3849         16  CL-INSURED-LAST-NAME    PIC X(15).
  3850         16  CL-INSURED-NAME.
  3851             20  CL-INSURED-1ST-NAME PIC X(12).
  3852             20  CL-INSURED-MID-INIT PIC X.
  3853
  3854     12  CL-CONTROL-BY-SSN.
  3855         16  CL-COMPANY-CD-A2        PIC X.
  3856         16  CL-SOC-SEC-NO.
  3857             20  CL-SSN-STATE        PIC XX.
  3858             20  CL-SSN-ACCOUNT      PIC X(6).
  3859             20  CL-SSN-LN3          PIC X(3).
  3860
  3861     12  CL-CONTROL-BY-CERT-NO.
  3862         16  CL-COMPANY-CD-A4        PIC X.
  3863         16  CL-CERT-NO-A4.
  3864             20  CL-CERT-A4-PRIME    PIC X(10).
  3865             20  CL-CERT-A4-SFX      PIC X.
  3866
  3867     12  CL-CONTROL-BY-CCN.
  3868         16  CL-COMPANY-CD-A5        PIC X.
  3869         16  CL-CCN-A5.
  3870             20  CL-CCN.
  3871                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3872                 24  CL-CCN-PRIME-A5 PIC X(12).
  3873             20  CL-CCN-FILLER-A5    PIC X(4).
  3874
  3875     12  CL-INSURED-PROFILE-DATA.
  3876         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  76
* EL156.cbl
  3877         16  CL-INSURED-SEX-CD       PIC X.
  3878             88  INSURED-IS-MALE        VALUE 'M'.
  3879             88  INSURED-IS-FEMALE      VALUE 'F'.
  3880             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3881         16  CL-INSURED-OCC-CD       PIC X(6).
  3882         16  FILLER                  PIC X(5).
  3883
  3884     12  CL-PROCESSING-INFO.
  3885         16  CL-PROCESSOR-ID         PIC X(4).
  3886         16  CL-CLAIM-STATUS         PIC X.
  3887             88  CLAIM-IS-OPEN          VALUE 'O'.
  3888             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3889         16  CL-CLAIM-TYPE           PIC X.
  3890*            88  AH-CLAIM               VALUE 'A'.
  3891*            88  LIFE-CLAIM             VALUE 'L'.
  3892*            88  PROPERTY-CLAIM         VALUE 'P'.
  3893*            88  IUI-CLAIM              VALUE 'I'.
  3894*            88  GAP-CLAIM              VALUE 'G'.
  3895*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3896         16  CL-CLAIM-PREM-TYPE      PIC X.
  3897             88  SINGLE-PREMIUM         VALUE '1'.
  3898             88  O-B-COVERAGE           VALUE '2'.
  3899             88  OPEN-END-COVERAGE      VALUE '3'.
  3900         16  CL-INCURRED-DT          PIC XX.
  3901         16  CL-REPORTED-DT          PIC XX.
  3902         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3903         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3904         16  CL-LAST-PMT-DT          PIC XX.
  3905         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3906         16  CL-PAID-THRU-DT         PIC XX.
  3907         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3908         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3909         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3910         16  CL-PMT-CALC-METHOD      PIC X.
  3911             88  CL-360-DAY-YR          VALUE '1'.
  3912             88  CL-365-DAY-YR          VALUE '2'.
  3913             88  CL-FULL-MONTHS         VALUE '3'.
  3914         16  CL-CAUSE-CD             PIC X(6).
  3915
  3916         16  CL-PRIME-CERT-NO.
  3917             20  CL-PRIME-CERT-PRIME PIC X(10).
  3918             20  CL-PRIME-CERT-SFX   PIC X.
  3919
  3920         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3921             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3922             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3923
  3924         16  CL-MICROFILM-NO         PIC X(10).
  3925         16  FILLER REDEFINES CL-MICROFILM-NO.
  3926             20  CL-BENEFIT-PERIOD   PIC 99.
  3927             20  FILLER              PIC X(8).
  3928         16  CL-PROG-FORM-TYPE       PIC X.
  3929         16  CL-LAST-ADD-ON-DT       PIC XX.
  3930
  3931         16  CL-LAST-REOPEN-DT       PIC XX.
  3932         16  CL-LAST-CLOSE-DT        PIC XX.
  3933         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3934             88  FINAL-PAID             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  77
* EL156.cbl
  3935             88  CLAIM-DENIED           VALUE '2'.
  3936             88  AUTO-CLOSE             VALUE '3'.
  3937             88  MANUAL-CLOSE           VALUE '4'.
  3938             88  BENEFITS-CHANGED       VALUE 'C'.
  3939             88  SETUP-ERRORS           VALUE 'E'.
  3940         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3941         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3942         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3943             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3944         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3945         16  FILLER                  PIC X.
  3946
  3947     12  CL-CERTIFICATE-DATA.
  3948         16  CL-CERT-ORIGIN          PIC X.
  3949             88  CERT-WAS-ONLINE        VALUE '1'.
  3950             88  CERT-WAS-CREATED       VALUE '2'.
  3951             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3952         16  CL-CERT-KEY-DATA.
  3953             20  CL-CERT-CARRIER     PIC X.
  3954             20  CL-CERT-GROUPING    PIC X(6).
  3955             20  CL-CERT-STATE       PIC XX.
  3956             20  CL-CERT-ACCOUNT.
  3957                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3958                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3959             20  CL-CERT-EFF-DT      PIC XX.
  3960
  3961     12  CL-STATUS-CONTROLS.
  3962         16  CL-PRIORITY-CD          PIC X.
  3963             88  CONFIDENTIAL-DATA      VALUE '8'.
  3964             88  HIGHEST-PRIORITY       VALUE '9'.
  3965         16  CL-SUPV-ATTN-CD         PIC X.
  3966             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3967             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3968         16  CL-PURGED-DT            PIC XX.
  3969         16  CL-RESTORED-DT          PIC XX.
  3970         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3971         16  CL-NEXT-RESEND-DT       PIC XX.
  3972         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3973         16  CL-CRITICAL-PERIOD      PIC 99.
  3974*        16  FILLER                  PIC XX.
  3975         16  CL-LAST-MAINT-DT        PIC XX.
  3976         16  CL-LAST-MAINT-USER      PIC X(4).
  3977         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3978         16  CL-LAST-MAINT-TYPE      PIC X.
  3979             88  CLAIM-SET-UP           VALUE ' '.
  3980             88  PAYMENT-MADE           VALUE '1'.
  3981             88  LETTER-SENT            VALUE '2'.
  3982             88  MASTER-WAS-ALTERED     VALUE '3'.
  3983             88  MASTER-WAS-RESTORED    VALUE '4'.
  3984             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3985             88  FILE-CONVERTED         VALUE '6'.
  3986             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3987             88  ERROR-CORRECTION       VALUE 'E'.
  3988         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3989         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3990         16  CL-BENEFICIARY          PIC X(10).
  3991         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3992         16  CL-DENIAL-TYPE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  78
* EL156.cbl
  3993             88  CL-TYPE-DENIAL          VALUE '1'.
  3994             88  CL-TYPE-RESCISSION      VALUE '2'.
  3995             88  CL-TYPE-REFORMATION     VALUE '3'.
  3996             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3997             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3998         16  filler                  pic x(5).
  3999*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4000*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4001*        16  CL-RTW-DT               PIC XX.
  4002
  4003     12  CL-TRAILER-CONTROLS.
  4004         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4005             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4006             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4007             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4008         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4009         16  FILLER                  PIC XX.
  4010         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4011         16  CL-ADDRESS-TRAILER-CNT.
  4012             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4013                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4014             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4015                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4016             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4017                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4018             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4019                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4020             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4021                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4022             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4023                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4024             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4025                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4026
  4027     12  CL-CV-REFERENCE-NO.
  4028         16  CL-CV-REFNO-PRIME       PIC X(18).
  4029         16  CL-CV-REFNO-SFX         PIC XX.
  4030
  4031     12  CL-FILE-LOCATION            PIC X(4).
  4032
  4033     12  CL-PROCESS-ERRORS.
  4034         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4035             88  NO-FATAL-ERRORS        VALUE ZERO.
  4036         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4037             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4038
  4039     12  CL-PRODUCT-CD               PIC X.
  4040
  4041     12  CL-CURRENT-KEY-DATA.
  4042         16  CL-CURRENT-CARRIER      PIC X.
  4043         16  CL-CURRENT-GROUPING     PIC X(6).
  4044         16  CL-CURRENT-STATE        PIC XX.
  4045         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4046
  4047     12  CL-ASSOCIATES               PIC X.
  4048         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4049         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4050         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  79
* EL156.cbl
  4051         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4052
  4053     12  CL-ACTIVITY-CODE            PIC 99.
  4054     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4055     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4056
  4057     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4058     12  CL-LAG-REPORT-CODE          PIC 9.
  4059     12  CL-LOAN-TYPE                PIC XX.
  4060     12  CL-LEGAL-STATE              PIC XX.
  4061
  4062     12  CL-YESNOSW                  PIC X.
  4063     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4064         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4065         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4066         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4067     12  cl-insured-type             pic x.
  4068         88  cl-claim-on-primary         value 'P'.
  4069         88  cl-claim-on-co-borrower     value 'C'.
  4070     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  80
* EL156.cbl
  4072*    COPY ELCCNTL.
  4073******************************************************************
  4074*                                                                *
  4075*                                                                *
  4076*                            ELCCNTL.                            *
  4077*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4078*                            VMOD=2.059                          *
  4079*                                                                *
  4080*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4081*                                                                *
  4082*   FILE TYPE = VSAM,KSDS                                        *
  4083*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4084*                                                                *
  4085*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4086*       ALTERNATE INDEX = NONE                                   *
  4087*                                                                *
  4088*   LOG = YES                                                    *
  4089*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4090******************************************************************
  4091*                   C H A N G E   L O G
  4092*
  4093* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4094*-----------------------------------------------------------------
  4095*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4096* EFFECTIVE    NUMBER
  4097*-----------------------------------------------------------------
  4098* 082503                   PEMA  ADD BENEFIT GROUP
  4099* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4100* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4101* 092705    2005050300006  PEMA  ADD SPP LEASES
  4102* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4103* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4104* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4105* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4106* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4107* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4108* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4109* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4110* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4111* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4112******************************************************************
  4113*
  4114 01  CONTROL-FILE.
  4115     12  CF-RECORD-ID                       PIC XX.
  4116         88  VALID-CF-ID                        VALUE 'CF'.
  4117
  4118     12  CF-CONTROL-PRIMARY.
  4119         16  CF-COMPANY-ID                  PIC XXX.
  4120         16  CF-RECORD-TYPE                 PIC X.
  4121             88  CF-COMPANY-MASTER              VALUE '1'.
  4122             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4123             88  CF-STATE-MASTER                VALUE '3'.
  4124             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4125             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4126             88  CF-CARRIER-MASTER              VALUE '6'.
  4127             88  CF-MORTALITY-MASTER            VALUE '7'.
  4128             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4129             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  81
* EL156.cbl
  4130             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4131             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4132             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4133             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4134             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4135             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4136             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4137             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4138             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4139         16  CF-ACCESS-CD-GENL              PIC X(4).
  4140         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4141             20  CF-PROCESSOR               PIC X(4).
  4142         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4143             20  CF-STATE-CODE              PIC XX.
  4144             20  FILLER                     PIC XX.
  4145         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4146             20  FILLER                     PIC XX.
  4147             20  CF-HI-BEN-IN-REC           PIC XX.
  4148         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4149             20  FILLER                     PIC XXX.
  4150             20  CF-CARRIER-CNTL            PIC X.
  4151         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4152             20  FILLER                     PIC XX.
  4153             20  CF-HI-TYPE-IN-REC          PIC 99.
  4154         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4155             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4156                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4157             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4158             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4159         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4160             20  FILLER                     PIC X.
  4161             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4162         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4163             20  FILLER                     PIC XX.
  4164             20  CF-MORTGAGE-PLAN           PIC XX.
  4165         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4166
  4167     12  CF-LAST-MAINT-DT                   PIC XX.
  4168     12  CF-LAST-MAINT-BY                   PIC X(4).
  4169     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4170
  4171     12  CF-RECORD-BODY                     PIC X(728).
  4172
  4173
  4174****************************************************************
  4175*             COMPANY MASTER RECORD                            *
  4176****************************************************************
  4177
  4178     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4179         16  CF-COMPANY-ADDRESS.
  4180             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4181             20  CF-CL-IN-CARE-OF           PIC X(30).
  4182             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4183             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4184             20  CF-CL-CITY-STATE           PIC X(30).
  4185             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4186             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4187         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  82
* EL156.cbl
  4188         16  CF-COMPANY-PASSWORD            PIC X(8).
  4189         16  CF-SECURITY-OPTION             PIC X.
  4190             88  ALL-SECURITY                   VALUE '1'.
  4191             88  COMPANY-VERIFY                 VALUE '2'.
  4192             88  PROCESSOR-VERIFY               VALUE '3'.
  4193             88  NO-SECURITY                    VALUE '4'.
  4194             88  ALL-BUT-TERM                   VALUE '5'.
  4195         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4196             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4197         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4198             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4199         16  CF-INFORCE-LOCATION            PIC X.
  4200             88  CERTS-ARE-ONLINE               VALUE '1'.
  4201             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4202             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4203         16  CF-LOWER-CASE-LETTERS          PIC X.
  4204         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4205             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4206             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4207             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4208             88  CF-ACCNT-CNTL                  VALUE '3'.
  4209             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4210
  4211         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4212         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4213
  4214         16  CF-LGX-CREDIT-USER             PIC X.
  4215             88  CO-IS-NOT-USER                 VALUE 'N'.
  4216             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4217
  4218         16 CF-CREDIT-CALC-CODES.
  4219             20  CF-CR-REM-TERM-CALC PIC X.
  4220               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4221               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4222               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4223               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4224               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4225               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4226               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4227             20  CF-CR-R78-METHOD           PIC X.
  4228               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4229               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4230
  4231         16  CF-CLAIM-CONTROL-COUNTS.
  4232             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4233                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4234
  4235             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4236                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4237
  4238             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4239                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4240
  4241             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4242                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4243
  4244         16  CF-CURRENT-MONTH-END           PIC XX.
  4245
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  83
* EL156.cbl
  4246         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4247             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4248             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4249             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4250             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4251                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4252                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4253             20  CF-CO-PREM-REJECT-SW       PIC X.
  4254                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4255                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4256             20  CF-CO-REF-REJECT-SW        PIC X.
  4257                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4258                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4259
  4260         16  CF-CO-REPORTING-DT             PIC XX.
  4261         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4262         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4263           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4264           88  CF-CO-MONTH-END                  VALUE '1'.
  4265
  4266         16  CF-LGX-CLAIM-USER              PIC X.
  4267             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4268             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4269
  4270         16  CF-CREDIT-EDIT-CONTROLS.
  4271             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4272             20  CF-MIN-AGE                 PIC 99.
  4273             20  CF-DEFAULT-AGE             PIC 99.
  4274             20  CF-MIN-TERM                PIC S999      COMP-3.
  4275             20  CF-MAX-TERM                PIC S999      COMP-3.
  4276             20  CF-DEFAULT-SEX             PIC X.
  4277             20  CF-JOINT-AGE-INPUT         PIC X.
  4278                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4279             20  CF-BIRTH-DATE-INPUT        PIC X.
  4280                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4281             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4282                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4283                 88  CF-ZERO-CARRIER            VALUE '1'.
  4284                 88  CF-ZERO-GROUPING           VALUE '2'.
  4285                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4286             20  CF-EDIT-SW                 PIC X.
  4287                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4288             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4289             20  CF-CR-PR-METHOD            PIC X.
  4290               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4291               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4292             20  FILLER                     PIC X.
  4293
  4294         16  CF-CREDIT-MISC-CONTROLS.
  4295             20  CF-REIN-TABLE-SW           PIC X.
  4296                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4297             20  CF-COMP-TABLE-SW           PIC X.
  4298                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4299             20  CF-EXPERIENCE-RETENTION-AGE
  4300                                            PIC S9        COMP-3.
  4301             20  CF-CONVERSION-DT           PIC XX.
  4302             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4303             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  84
* EL156.cbl
  4304                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4305                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4306
  4307             20  CF-CR-CHECK-NO-CONTROL.
  4308                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4309                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4310                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4311                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4312                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4313                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4314
  4315                 24  CF-CR-CHECK-COUNT       REDEFINES
  4316                     CF-CR-CHECK-COUNTER      PIC X(4).
  4317
  4318                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4319                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4320
  4321                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4322                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4323                 24  CF-MAIL-PROCESSING       PIC X.
  4324                     88  MAIL-PROCESSING          VALUE 'Y'.
  4325
  4326         16  CF-MISC-SYSTEM-CONTROL.
  4327             20  CF-SYSTEM-C                 PIC X.
  4328                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4329             20  CF-SYSTEM-D                 PIC X.
  4330                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4331             20  CF-SOC-SEC-NO-SW            PIC X.
  4332                 88  SOC-SEC-NO-USED             VALUE '1'.
  4333             20  CF-MEMBER-NO-SW             PIC X.
  4334                 88  MEMBER-NO-USED              VALUE '1'.
  4335             20  CF-TAX-ID-NUMBER            PIC X(11).
  4336             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4337             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4338                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4339                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4340                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4341                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4342             20  CF-SYSTEM-E                 PIC X.
  4343                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4344
  4345         16  CF-LGX-LIFE-USER               PIC X.
  4346             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4347             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4348
  4349         16  CF-CR-MONTH-END-DT             PIC XX.
  4350
  4351         16  CF-FILE-MAINT-DATES.
  4352             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4353                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4354             20  CF-LAST-BATCH       REDEFINES
  4355                 CF-LAST-BATCH-NO               PIC X(4).
  4356             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4357             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4358             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4359             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4360             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4361             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  85
* EL156.cbl
  4362             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4363             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4364             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4365             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4366
  4367         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4368         16  FILLER                         PIC X.
  4369
  4370         16  CF-ALT-MORT-CODE               PIC X(4).
  4371         16  CF-MEMBER-CAPTION              PIC X(10).
  4372
  4373         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4374             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4375             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4376             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4377             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4378             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4379
  4380         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4381
  4382         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4383         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4384         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4385         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4386
  4387         16  CF-AH-OVERRIDE-L1              PIC X.
  4388         16  CF-AH-OVERRIDE-L2              PIC XX.
  4389         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4390         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4391
  4392         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4393         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4394
  4395         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4396         16  CF-AR-LAST-EL860-DT            PIC XX.
  4397         16  CF-MP-MONTH-END-DT             PIC XX.
  4398
  4399         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4400         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4401             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4402
  4403         16  CF-AR-MONTH-END-DT             PIC XX.
  4404
  4405         16  CF-CRDTCRD-USER                PIC X.
  4406             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4407             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4408
  4409         16  CF-CC-MONTH-END-DT             PIC XX.
  4410
  4411         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4412
  4413         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4414             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4415             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4416             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4417         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4418         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4419         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  86
* EL156.cbl
  4420         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4421             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4422             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4423         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4424         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4425         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4426             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4427         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4428
  4429         16  CF-CL-ZIP-CODE.
  4430             20  CF-CL-ZIP-PRIME.
  4431                 24  CF-CL-ZIP-1ST          PIC X.
  4432                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4433                 24  FILLER                 PIC X(4).
  4434             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4435         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4436             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4437             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4438             20  FILLER                     PIC XXX.
  4439
  4440         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4441         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4442         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4443         16  CF-CO-OPTION-START-DATE        PIC XX.
  4444         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4445           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4446                                                      '3' '4'.
  4447           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4448           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4449           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4450           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4451           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4452           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4453
  4454         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4455
  4456         16  CF-PAYMENT-APPROVAL-LEVELS.
  4457             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4458             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4459             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4460             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4461             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4462             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4463
  4464         16  CF-END-USER-REPORTING-USER     PIC X.
  4465             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4466             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4467
  4468         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4469             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4470             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4471
  4472         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4473
  4474         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4475         16  FILLER                         PIC X.
  4476
  4477         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  87
* EL156.cbl
  4478             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4479             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4480             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4481
  4482         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4483
  4484         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4485             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4486             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4487
  4488         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4489             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4490             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4491
  4492         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4493
  4494         16  CF-CO-ACH-ID-CODE              PIC  X.
  4495             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4496             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4497             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4498         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4499         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4500         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4501         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4502         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4503         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4504         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4505         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4506         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4507                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4508         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4509                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4510
  4511         16  CF-CO-OVER-SHORT.
  4512             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4513             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4514
  4515*         16  FILLER                         PIC X(102).
  4516         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4517             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4518             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4519
  4520         16  CF-AH-APPROVAL-DAYS.
  4521             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4522             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4523             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4524             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4525
  4526         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4527
  4528         16  CF-APPROV-LEV-5.
  4529             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4530             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4531             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4532
  4533         16  FILLER                         PIC X(68).
  4534****************************************************************
  4535*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  88
* EL156.cbl
  4536****************************************************************
  4537
  4538     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4539         16  CF-PROCESSOR-NAME              PIC X(30).
  4540         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4541         16  CF-PROCESSOR-TITLE             PIC X(26).
  4542         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4543                 88  MESSAGE-YES                VALUE 'Y'.
  4544                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4545
  4546*****************************************************
  4547****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4548****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4549****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4550****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4551*****************************************************
  4552
  4553         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4554             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4555             20  CF-APPLICATION-FORCE       PIC X.
  4556             20  CF-INDIVIDUAL-APP.
  4557                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4558                     28  CF-BROWSE-APP      PIC X.
  4559                     28  CF-UPDATE-APP      PIC X.
  4560
  4561         16  CF-CURRENT-TERM-ON             PIC X(4).
  4562         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4563             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4564             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4565             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4566             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4567             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4568             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4569             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4570         16  CF-PROCESSOR-CARRIER           PIC X.
  4571             88  NO-CARRIER-SECURITY            VALUE ' '.
  4572         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4573             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4574         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4575             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4576         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4577             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4578
  4579         16  CF-PROC-SYS-ACCESS-SW.
  4580             20  CF-PROC-CREDIT-CLAIMS-SW.
  4581                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4582                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4583                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4584                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4585             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4586                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4587                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4588             20  CF-PROC-LIFE-GNRLDGR-SW.
  4589                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4590                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4591                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4592                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4593             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  89
* EL156.cbl
  4594                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4595                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4596         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4597             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4598             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4599         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4600
  4601         16  CF-APPROVAL-LEVEL                  PIC X.
  4602             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4603             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4604             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4605             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4606             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4607
  4608         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4609
  4610         16  CF-LANGUAGE-TYPE                   PIC X.
  4611             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4612             88  CF-LANG-IS-FR                      VALUE 'F'.
  4613
  4614         16  CF-CSR-IND                         PIC X.
  4615         16  FILLER                             PIC X(239).
  4616
  4617****************************************************************
  4618*             PROCESSOR/REMINDERS RECORD                       *
  4619****************************************************************
  4620
  4621     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4622         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4623             20  CF-START-REMIND-DT         PIC XX.
  4624             20  CF-END-REMIND-DT           PIC XX.
  4625             20  CF-REMINDER-TEXT           PIC X(50).
  4626         16  FILLER                         PIC X(296).
  4627
  4628
  4629****************************************************************
  4630*             STATE MASTER RECORD                              *
  4631****************************************************************
  4632
  4633     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4634         16  CF-STATE-ABBREVIATION          PIC XX.
  4635         16  CF-STATE-NAME                  PIC X(25).
  4636         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4637         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4638             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4639             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4640             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4641             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4642                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4643                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4644             20  CF-ST-PREM-REJECT-SW       PIC X.
  4645                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4646                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4647             20  CF-ST-REF-REJECT-SW        PIC X.
  4648                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4649                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4650         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4651         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  90
* EL156.cbl
  4652         16  CF-ST-REFUND-RULES.
  4653             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4654             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4655             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4656         16  CF-ST-FST-PMT-EXTENSION.
  4657             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4658             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4659                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4660                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4661                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4662                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4663         16  CF-ST-STATE-CALL.
  4664             20  CF-ST-CALL-UNEARNED        PIC X.
  4665             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4666             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4667         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4668             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4669             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4670         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4671         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4672         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4673         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4674         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4675         16  FILLER                         PIC X.
  4676         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4677             20  CF-ST-BENEFIT-CD           PIC XX.
  4678             20  CF-ST-BENEFIT-KIND         PIC X.
  4679                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4680                 88  CF-ST-AH-KIND              VALUE 'A'.
  4681             20  CF-ST-REM-TERM-CALC        PIC X.
  4682                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4683                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4684                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4685                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4686                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4687                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4688                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4689                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4690
  4691             20  CF-ST-REFUND-CALC          PIC X.
  4692                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4693                 88  ST-REFD-BY-R78             VALUE '1'.
  4694                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4695                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4696                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4697                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4698                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4699                 88  ST-REFD-UTAH               VALUE '7'.
  4700                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4701                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4702                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4703
  4704             20  CF-ST-EARNING-CALC         PIC X.
  4705                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4706                 88  ST-EARN-BY-R78             VALUE '1'.
  4707                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4708                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4709                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  91
* EL156.cbl
  4710                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4711                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4712                 88  ST-EARN-MEAN               VALUE '8'.
  4713                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4714
  4715             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4716                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4717                 88  ST-OVRD-BY-R78             VALUE '1'.
  4718                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4719                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4720                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4721                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4722                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4723                 88  ST-OVRD-MEAN               VALUE '8'.
  4724                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4725             20  FILLER                     PIC X.
  4726
  4727         16  CF-ST-COMMISSION-CAPS.
  4728             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4729             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4730             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4731             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4732         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4733                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4734
  4735         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4736
  4737         16  CF-ST-STATUTORY-INTEREST.
  4738             20  CF-ST-STAT-DATE-FROM       PIC X.
  4739                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4740                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4741             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4742             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4743             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4744             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4745             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4746
  4747         16  CF-ST-OVER-SHORT.
  4748             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4749             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4750
  4751         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4752
  4753         16  CF-ST-RT-CALC                  PIC X.
  4754
  4755         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4756         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4757         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4758         16  CF-ST-RF-LR-CALC               PIC X.
  4759         16  CF-ST-RF-LL-CALC               PIC X.
  4760         16  CF-ST-RF-LN-CALC               PIC X.
  4761         16  CF-ST-RF-AH-CALC               PIC X.
  4762         16  CF-ST-RF-CP-CALC               PIC X.
  4763*        16  FILLER                         PIC X(206).
  4764*CIDMOD         16  FILLER                         PIC X(192).
  4765         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4766             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4767         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  92
* EL156.cbl
  4768         16  CF-ST-VFY-2ND-BENE             PIC X.
  4769         16  CF-ST-CAUSAL-STATE             PIC X.
  4770         16  FILLER                         PIC X(185).
  4771
  4772****************************************************************
  4773*             BENEFIT MASTER RECORD                            *
  4774****************************************************************
  4775
  4776     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4777         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4778             20  CF-BENEFIT-CODE            PIC XX.
  4779             20  CF-BENEFIT-NUMERIC  REDEFINES
  4780                 CF-BENEFIT-CODE            PIC XX.
  4781             20  CF-BENEFIT-ALPHA           PIC XXX.
  4782             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4783             20  CF-BENEFIT-COMMENT         PIC X(10).
  4784
  4785             20  CF-LF-COVERAGE-TYPE        PIC X.
  4786                 88  CF-REDUCING                VALUE 'R'.
  4787                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4788
  4789             20  CF-SPECIAL-CALC-CD         PIC X.
  4790                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4791                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4792                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4793                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4794                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4795                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4796                 88  CF-FARM-PLAN               VALUE 'F'.
  4797                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4798                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4799                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4800                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4801                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4802                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4803                 88  CF-PRUDENTIAL              VALUE 'P'.
  4804                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4805                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4806                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4807                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4808                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4809                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4810
  4811             20  CF-JOINT-INDICATOR         PIC X.
  4812                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4813
  4814*            20  FILLER                     PIC X(12).
  4815             20  cf-maximum-benefits        pic s999 comp-3.
  4816             20  FILLER                     PIC X(09).
  4817             20  CF-BENEFIT-CATEGORY        PIC X.
  4818             20  CF-LOAN-TYPE               PIC X(8).
  4819
  4820             20  CF-CO-REM-TERM-CALC        PIC X.
  4821                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4822                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4823                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4824                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4825                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  93
* EL156.cbl
  4826
  4827             20  CF-CO-EARNINGS-CALC        PIC X.
  4828                 88  CO-EARN-BY-R78             VALUE '1'.
  4829                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4830                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4831                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4832                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4833                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4834                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4835                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4836
  4837             20  CF-CO-REFUND-CALC          PIC X.
  4838                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4839                 88  CO-REFD-BY-R78             VALUE '1'.
  4840                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4841                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4842                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4843                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4844                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4845                 88  CO-REFD-MEAN               VALUE '8'.
  4846                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4847                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4848                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4849
  4850             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4851                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4852                 88  CO-OVRD-BY-R78             VALUE '1'.
  4853                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4854                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4855                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4856                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4857                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4858                 88  CO-OVRD-MEAN               VALUE '8'.
  4859                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4860
  4861             20  CF-CO-BEN-I-G-CD           PIC X.
  4862                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4863                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4864                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4865
  4866         16  FILLER                         PIC X(304).
  4867
  4868
  4869****************************************************************
  4870*             CARRIER MASTER RECORD                            *
  4871****************************************************************
  4872
  4873     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4874         16  CF-ADDRESS-DATA.
  4875             20  CF-MAIL-TO-NAME            PIC X(30).
  4876             20  CF-IN-CARE-OF              PIC X(30).
  4877             20  CF-ADDRESS-LINE-1          PIC X(30).
  4878             20  CF-ADDRESS-LINE-2          PIC X(30).
  4879             20  CF-CITY-STATE              PIC X(30).
  4880             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4881             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4882
  4883         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  94
* EL156.cbl
  4884             20  CF-CLAIM-NO-METHOD         PIC X.
  4885                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4886                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4887                 88  CLAIM-NO-SEQ               VALUE '3'.
  4888                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4889             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4890                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4891                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4892                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4893
  4894         16  CF-CHECK-NO-CONTROL.
  4895             20  CF-CHECK-NO-METHOD         PIC X.
  4896                 88  CHECK-NO-MANUAL            VALUE '1'.
  4897                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4898                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4899                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4900             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4901                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4902
  4903         16  CF-DOMICILE-STATE              PIC XX.
  4904
  4905         16  CF-EXPENSE-CONTROLS.
  4906             20  CF-EXPENSE-METHOD          PIC X.
  4907                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4908                 88  DOLLARS-PER-PMT            VALUE '2'.
  4909                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4910                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4911             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4912             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4913
  4914         16  CF-CORRESPONDENCE-CONTROL.
  4915             20  CF-LETTER-RESEND-OPT       PIC X.
  4916                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4917                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4918             20  FILLER                     PIC X(4).
  4919
  4920         16  CF-RESERVE-CONTROLS.
  4921             20  CF-MANUAL-SW               PIC X.
  4922                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4923             20  CF-FUTURE-SW               PIC X.
  4924                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4925             20  CF-PTC-SW                  PIC X.
  4926                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4927             20  CF-IBNR-SW                 PIC X.
  4928                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4929             20  CF-PTC-LF-SW               PIC X.
  4930                 88  CF-LF-PTC-USED             VALUE '1'.
  4931             20  CF-CDT-ACCESS-METHOD       PIC X.
  4932                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4933                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4934                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4935             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4936
  4937         16  CF-CLAIM-CALC-METHOD           PIC X.
  4938             88  360-PLUS-MONTHS                VALUE '1'.
  4939             88  365-PLUS-MONTHS                VALUE '2'.
  4940             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4941             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  95
* EL156.cbl
  4942             88  365-DAILY                      VALUE '5'.
  4943
  4944         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4945         16  FILLER                         PIC X(11).
  4946
  4947         16  CF-LIMIT-AMOUNTS.
  4948             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4949             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4950             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4951             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4952             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4953             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4954             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4955             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4956             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4957             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4958
  4959         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4960         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4961         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4962
  4963         16  CF-ZIP-CODE.
  4964             20  CF-ZIP-PRIME.
  4965                 24  CF-ZIP-1ST             PIC X.
  4966                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4967                 24  FILLER                 PIC X(4).
  4968             20  CF-ZIP-PLUS4               PIC X(4).
  4969         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4970             20  CF-CAN-POSTAL-1            PIC XXX.
  4971             20  CF-CAN-POSTAL-2            PIC XXX.
  4972             20  FILLER                     PIC XXX.
  4973
  4974         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4975         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4976         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4977
  4978         16  CF-RATING-SWITCH               PIC X.
  4979             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4980             88  CF-NO-RATING                   VALUE 'N'.
  4981
  4982         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4983
  4984         16  CF-CARRIER-OVER-SHORT.
  4985             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4986             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4987
  4988         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4989         16  CF-SECPAY-SWITCH               PIC X.
  4990             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4991             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4992         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4993         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4994         16  FILLER                         PIC X(444).
  4995*        16  FILLER                         PIC X(452).
  4996
  4997
  4998****************************************************************
  4999*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  96
* EL156.cbl
  5000****************************************************************
  5001
  5002     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5003         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5004                                INDEXED BY CF-MORT-NDX.
  5005             20  CF-MORT-TABLE              PIC X(5).
  5006             20  CF-MORT-TABLE-TYPE         PIC X.
  5007                 88  CF-MORT-JOINT              VALUE 'J'.
  5008                 88  CF-MORT-SINGLE             VALUE 'S'.
  5009                 88  CF-MORT-COMBINED           VALUE 'C'.
  5010                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5011                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5012             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5013             20  CF-MORT-AGE-METHOD         PIC XX.
  5014                 88  CF-AGE-LAST                VALUE 'AL'.
  5015                 88  CF-AGE-NEAR                VALUE 'AN'.
  5016             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5017             20  CF-MORT-ADJUSTMENT-DIRECTION
  5018                                            PIC X.
  5019                 88  CF-MINUS                   VALUE '-'.
  5020                 88  CF-PLUS                    VALUE '+'.
  5021             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5022             20  CF-MORT-JOINT-CODE         PIC X.
  5023                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5024             20  CF-MORT-PC-Q               PIC X.
  5025                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5026             20  CF-MORT-TABLE-CODE         PIC X(4).
  5027             20  CF-MORT-COMMENTS           PIC X(15).
  5028             20  FILLER                     PIC X(14).
  5029
  5030         16  FILLER                         PIC X(251).
  5031
  5032
  5033****************************************************************
  5034*             BUSSINESS TYPE MASTER RECORD                     *
  5035****************************************************************
  5036
  5037     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5038* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5039* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5040* AND RECORD 05 IS TYPES 81-99
  5041         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5042             20  CF-BUSINESS-TITLE          PIC  X(19).
  5043             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5044                                            PIC S9V9(4) COMP-3.
  5045             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5046             20  FILLER                     PIC  X.
  5047         16  FILLER                         PIC  X(248).
  5048
  5049
  5050****************************************************************
  5051*             TERMINAL MASTER RECORD                           *
  5052****************************************************************
  5053
  5054     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5055
  5056         16  CF-COMPANY-TERMINALS.
  5057             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  97
* EL156.cbl
  5058                                  PIC X(4).
  5059         16  FILLER               PIC X(248).
  5060
  5061
  5062****************************************************************
  5063*             LIFE EDIT MASTER RECORD                          *
  5064****************************************************************
  5065
  5066     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5067         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5068             20  CF-LIFE-CODE-IN            PIC XX.
  5069             20  CF-LIFE-CODE-OUT           PIC XX.
  5070         16  FILLER                         PIC X(248).
  5071
  5072
  5073****************************************************************
  5074*             AH EDIT MASTER RECORD                            *
  5075****************************************************************
  5076
  5077     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5078         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5079             20  CF-AH-CODE-IN              PIC XXX.
  5080             20  CF-AH-CODE-OUT             PIC XX.
  5081         16  FILLER                         PIC X(248).
  5082
  5083
  5084****************************************************************
  5085*             CREDIBILITY TABLES                               *
  5086****************************************************************
  5087
  5088     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5089         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5090                             INDEXED BY CF-CRDB-NDX.
  5091             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5092             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5093             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5094         16  FILLER                         PIC  X(332).
  5095
  5096
  5097****************************************************************
  5098*             REPORT CUSTOMIZATION RECORD                      *
  5099****************************************************************
  5100
  5101     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5102         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5103             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5104             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5105             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5106**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5107****       A T-TRANSFER.                                   ****
  5108             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5109
  5110         16  FILLER                         PIC XX.
  5111
  5112         16  CF-CARRIER-CNTL-OPT.
  5113             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5114                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5115                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  98
* EL156.cbl
  5116             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5117                                            PIC X.
  5118         16  CF-GROUP-CNTL-OPT.
  5119             20  CF-GROUP-OPT-SEQ           PIC 9.
  5120                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5121                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5122             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5123                                            PIC X(6).
  5124         16  CF-STATE-CNTL-OPT.
  5125             20  CF-STATE-OPT-SEQ           PIC 9.
  5126                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5127                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5128             20  CF-STATE-SELECT OCCURS 3 TIMES
  5129                                            PIC XX.
  5130         16  CF-ACCOUNT-CNTL-OPT.
  5131             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5132                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5133                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5134             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5135                                            PIC X(10).
  5136         16  CF-BUS-TYP-CNTL-OPT.
  5137             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5138                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5139                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5140             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5141                                            PIC XX.
  5142         16  CF-LF-TYP-CNTL-OPT.
  5143             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5144                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5145                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5146             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5147                                            PIC XX.
  5148         16  CF-AH-TYP-CNTL-OPT.
  5149             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5150                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5151                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5152             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5153                                            PIC XX.
  5154         16  CF-REPTCD1-CNTL-OPT.
  5155             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5156                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5157                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5158             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5159                                            PIC X(10).
  5160         16  CF-REPTCD2-CNTL-OPT.
  5161             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5162                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5163                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5164             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5165                                            PIC X(10).
  5166         16  CF-USER1-CNTL-OPT.
  5167             20  CF-USER1-OPT-SEQ           PIC 9.
  5168                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5169                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5170             20  CF-USER1-SELECT OCCURS 3 TIMES
  5171                                            PIC X(10).
  5172         16  CF-USER2-CNTL-OPT.
  5173             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page  99
* EL156.cbl
  5174                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5175                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5176             20  CF-USER2-SELECT OCCURS 3 TIMES
  5177                                            PIC X(10).
  5178         16  CF-USER3-CNTL-OPT.
  5179             20  CF-USER3-OPT-SEQ           PIC 9.
  5180                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5181                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5182             20  CF-USER3-SELECT OCCURS 3 TIMES
  5183                                            PIC X(10).
  5184         16  CF-USER4-CNTL-OPT.
  5185             20  CF-USER4-OPT-SEQ           PIC 9.
  5186                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5187                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5188             20  CF-USER4-SELECT OCCURS 3 TIMES
  5189                                            PIC X(10).
  5190         16  CF-USER5-CNTL-OPT.
  5191             20  CF-USER5-OPT-SEQ           PIC 9.
  5192                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5193                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5194             20  CF-USER5-SELECT OCCURS 3 TIMES
  5195                                            PIC X(10).
  5196         16  CF-REINS-CNTL-OPT.
  5197             20  CF-REINS-OPT-SEQ           PIC 9.
  5198                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5199                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5200             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5201                 24  CF-REINS-PRIME         PIC XXX.
  5202                 24  CF-REINS-SUB           PIC XXX.
  5203
  5204         16  CF-AGENT-CNTL-OPT.
  5205             20  CF-AGENT-OPT-SEQ           PIC 9.
  5206                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5207                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5208             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5209                                            PIC X(10).
  5210
  5211         16  FILLER                         PIC X(43).
  5212
  5213         16  CF-LOSS-RATIO-SELECT.
  5214             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5215             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5216         16  CF-ENTRY-DATE-SELECT.
  5217             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5218             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5219         16  CF-EFFECTIVE-DATE-SELECT.
  5220             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5221             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5222
  5223         16  CF-EXCEPTION-LIST-IND          PIC X.
  5224             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5225
  5226         16  FILLER                         PIC X(318).
  5227
  5228****************************************************************
  5229*                  EXCEPTION REPORTING RECORD                  *
  5230****************************************************************
  5231
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 100
* EL156.cbl
  5232     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5233         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5234             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5235
  5236         16  CF-COMBINED-LIFE-AH-OPT.
  5237             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5238             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5239             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5240             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5241
  5242         16  CF-LIFE-OPT.
  5243             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5244             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5245             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5246             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5247             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5248             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5249             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5250             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5251             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5252             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5253
  5254         16  CF-AH-OPT.
  5255             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5256             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5257             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5258             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5259             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5260             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5261             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5262             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5263             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5264             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5265
  5266         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5267             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5268             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5269             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5270
  5271         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5272
  5273         16  FILLER                         PIC X(673).
  5274
  5275
  5276****************************************************************
  5277*             MORTGAGE SYSTEM PLAN RECORD                      *
  5278****************************************************************
  5279
  5280     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5281         16  CF-PLAN-TYPE                   PIC X.
  5282             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5283             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5284             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5285         16  CF-PLAN-ABBREV                 PIC XXX.
  5286         16  CF-PLAN-DESCRIPT               PIC X(10).
  5287         16  CF-PLAN-NOTES                  PIC X(20).
  5288         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5289         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 101
* EL156.cbl
  5290             20  CF-PLAN-TERM-DATA.
  5291                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5292                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5293             20  CF-PLAN-AGE-DATA.
  5294                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5295                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5296                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5297             20  CF-PLAN-BENEFIT-DATA.
  5298                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5299                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5300                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5301                                            PIC S9(7)V99  COMP-3.
  5302         16  CF-PLAN-POLICY-FORMS.
  5303             20  CF-POLICY-FORM             PIC X(12).
  5304             20  CF-MASTER-APPLICATION      PIC X(12).
  5305             20  CF-MASTER-POLICY           PIC X(12).
  5306         16  CF-PLAN-RATING.
  5307             20  CF-RATE-CODE               PIC X(5).
  5308             20  CF-SEX-RATING              PIC X.
  5309                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5310                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5311             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5312             20  CF-SUB-STD-TYPE            PIC X.
  5313                 88  CF-PCT-OF-PREM            VALUE '1'.
  5314                 88  CF-PCT-OF-BENE            VALUE '2'.
  5315         16  CF-PLAN-PREM-TOLERANCES.
  5316             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5317             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5318         16  CF-PLAN-PYMT-TOLERANCES.
  5319             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5320             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5321         16  CF-PLAN-MISC-DATA.
  5322             20  FILLER                     PIC X.
  5323             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5324             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5325         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5326         16  CF-PLAN-IND-GRP                PIC X.
  5327             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5328                                                     '1'.
  5329             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5330                                                     '2'.
  5331         16  CF-MIB-SEARCH-SW               PIC X.
  5332             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5333             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5334             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5335             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5336         16  CF-ALPHA-SEARCH-SW             PIC X.
  5337             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5338             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5339             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5340             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5341             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5342             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5343             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5344             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5345             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5346             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5347                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 102
* EL156.cbl
  5348                                                     'X' 'Y' 'Z'.
  5349         16  CF-EFF-DT-RULE-SW              PIC X.
  5350             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5351             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5352             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5353             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5354             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5355         16  FILLER                         PIC X(4).
  5356         16  CF-HEALTH-QUESTIONS            PIC X.
  5357             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5358         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5359         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5360         16  CF-PLAN-SNGL-JNT               PIC X.
  5361             88  CF-COMBINED-PLAN              VALUE 'C'.
  5362             88  CF-JNT-PLAN                   VALUE 'J'.
  5363             88  CF-SNGL-PLAN                  VALUE 'S'.
  5364         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5365         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5366         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5367         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5368         16  CF-RERATE-CNTL                 PIC  X.
  5369             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5370             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5371             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5372             88  CF-AUTO-RECALC                 VALUE '4'.
  5373         16  CF-BENEFIT-TYPE                PIC  X.
  5374             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5375             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5376         16  CF-POLICY-FEE                  PIC S999V99
  5377                                                    COMP-3.
  5378         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5379         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5380         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5381         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5382         16  FILLER                         PIC  X(32).
  5383         16  CF-TERMINATION-FORM            PIC  X(04).
  5384         16  FILLER                         PIC  X(08).
  5385         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5386                                                       COMP-3.
  5387         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5388         16  CF-ISSUE-LETTER                PIC  X(4).
  5389         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5390         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5391             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5392             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5393         16  CF-MP-REFUND-CALC              PIC X.
  5394             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5395             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5396             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5397             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5398             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5399             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5400             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5401             88  CF-MP-REFD-MEAN                VALUE '8'.
  5402         16  CF-ALT-RATE-CODE               PIC  X(5).
  5403
  5404
  5405         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 103
* EL156.cbl
  5406****************************************************************
  5407*             MORTGAGE COMPANY MASTER RECORD                   *
  5408****************************************************************
  5409
  5410     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5411         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5412         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5413             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5414             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5415             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5416             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5417             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5418
  5419         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5420         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5421         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5422         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5423         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5424
  5425         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5426             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5427         16  CF-MP-RECON-USE-IND            PIC X(1).
  5428             88  CF-MP-USE-RECON             VALUE 'Y'.
  5429         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5430             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5431         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5432             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5433             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5434         16  FILLER                         PIC X(1).
  5435         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5436             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5437         16  CF-MORTG-MIB-VERSION           PIC X.
  5438             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5439             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5440             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5441         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5442             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5443                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5444             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5445                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5446             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5447                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5448             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5449                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5450             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5451                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5452             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5453                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5454         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5455         16  FILLER                         PIC X(7).
  5456         16  CF-MORTG-DESTINATION-SYMBOL.
  5457             20  CF-MORTG-MIB-COMM          PIC X(5).
  5458             20  CF-MORTG-MIB-TERM          PIC X(5).
  5459         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5460             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5461         16  FILLER                         PIC X(03).
  5462         16  CF-MP-CHECK-NO-CONTROL.
  5463             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 104
* EL156.cbl
  5464                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5465                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5466                                                ' ' LOW-VALUES.
  5467                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5468                                               VALUE '3'.
  5469         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5470         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5471         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5472             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5473                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5474             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5475                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5476             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5477                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5478             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5479                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5480             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5481                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5482             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5483                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5484         16  CF-MORTG-BILLING-AREA.
  5485             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5486                                            PIC X.
  5487         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5488         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5489         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5490         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5491             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5492             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5493         16  FILLER                         PIC X.
  5494         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5495             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5496             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5497         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5498         16  FILLER                         PIC X(8).
  5499         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5500         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5501         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5502         16  CF-ACH-COMPANY-ID.
  5503             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5504                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5505                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5506                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5507             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5508         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5509             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5510         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5511             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5512             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5513         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5514         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5515         16  FILLER                         PIC X(536).
  5516
  5517****************************************************************
  5518*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5519****************************************************************
  5520
  5521     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 105
* EL156.cbl
  5522         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5523             20  CF-FEMALE-HEIGHT.
  5524                 24  CF-FEMALE-FT           PIC 99.
  5525                 24  CF-FEMALE-IN           PIC 99.
  5526             20  CF-FEMALE-MIN-WT           PIC 999.
  5527             20  CF-FEMALE-MAX-WT           PIC 999.
  5528         16  FILLER                         PIC X(428).
  5529
  5530     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5531         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5532             20  CF-MALE-HEIGHT.
  5533                 24  CF-MALE-FT             PIC 99.
  5534                 24  CF-MALE-IN             PIC 99.
  5535             20  CF-MALE-MIN-WT             PIC 999.
  5536             20  CF-MALE-MAX-WT             PIC 999.
  5537         16  FILLER                         PIC X(428).
  5538******************************************************************
  5539*             AUTOMATIC ACTIVITY RECORD                          *
  5540******************************************************************
  5541     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5542         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5543             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5544             20  CF-SYS-LETTER-ID           PIC X(04).
  5545             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5546             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5547             20  CF-SYS-RESET-SW            PIC X(01).
  5548             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5549             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5550
  5551         16  FILLER                         PIC X(50).
  5552
  5553         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5554             20  CF-USER-ACTIVE-SW          PIC X(01).
  5555             20  CF-USER-LETTER-ID          PIC X(04).
  5556             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5557             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5558             20  CF-USER-RESET-SW           PIC X(01).
  5559             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5560             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5561             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5562
  5563         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 106
* EL156.cbl
  5565*    COPY ELCCERT.
  5566******************************************************************
  5567*                                                                *
  5568*                            ELCCERT.                            *
  5569*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5570*                            VMOD=2.013                          *
  5571*                                                                *
  5572*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5573*                                                                *
  5574*   FILE TYPE = VSAM,KSDS                                        *
  5575*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5576*                                                                *
  5577*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5578*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5579*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5580*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5581*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5582*                                                                *
  5583*   LOG = YES                                                    *
  5584*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5585******************************************************************
  5586*                   C H A N G E   L O G
  5587*
  5588* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5589*-----------------------------------------------------------------
  5590*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5591* EFFECTIVE    NUMBER
  5592*-----------------------------------------------------------------
  5593* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5594* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5595* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5596* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5597* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5598* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5599* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5600* 032612  CR2011110200001  PEMA  AHL CHANGES
  5601******************************************************************
  5602
  5603 01  CERTIFICATE-MASTER.
  5604     12  CM-RECORD-ID                      PIC XX.
  5605         88  VALID-CM-ID                      VALUE 'CM'.
  5606
  5607     12  CM-CONTROL-PRIMARY.
  5608         16  CM-COMPANY-CD                 PIC X.
  5609         16  CM-CARRIER                    PIC X.
  5610         16  CM-GROUPING.
  5611             20  CM-GROUPING-PREFIX        PIC X(3).
  5612             20  CM-GROUPING-PRIME         PIC X(3).
  5613         16  CM-STATE                      PIC XX.
  5614         16  CM-ACCOUNT.
  5615             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5616             20  CM-ACCOUNT-PRIME          PIC X(6).
  5617         16  CM-CERT-EFF-DT                PIC XX.
  5618         16  CM-CERT-NO.
  5619             20  CM-CERT-PRIME             PIC X(10).
  5620             20  CM-CERT-SFX               PIC X.
  5621
  5622     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 107
* EL156.cbl
  5623         16  CM-COMPANY-CD-A1              PIC X.
  5624         16  CM-INSURED-LAST-NAME          PIC X(15).
  5625         16  CM-INSURED-INITIALS.
  5626             20  CM-INSURED-INITIAL1       PIC X.
  5627             20  CM-INSURED-INITIAL2       PIC X.
  5628
  5629     12  CM-CONTROL-BY-SSN.
  5630         16  CM-COMPANY-CD-A2              PIC X.
  5631         16  CM-SOC-SEC-NO.
  5632             20  CM-SSN-STATE              PIC XX.
  5633             20  CM-SSN-ACCOUNT            PIC X(6).
  5634             20  CM-SSN-LN3.
  5635                 25  CM-INSURED-INITIALS-A2.
  5636                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5637                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5638                 25 CM-PART-LAST-NAME-A2         PIC X.
  5639
  5640     12  CM-CONTROL-BY-CERT-NO.
  5641         16  CM-COMPANY-CD-A4              PIC X.
  5642         16  CM-CERT-NO-A4                 PIC X(11).
  5643
  5644     12  CM-CONTROL-BY-MEMB.
  5645         16  CM-COMPANY-CD-A5              PIC X.
  5646         16  CM-MEMBER-NO.
  5647             20  CM-MEMB-STATE             PIC XX.
  5648             20  CM-MEMB-ACCOUNT           PIC X(6).
  5649             20  CM-MEMB-LN4.
  5650                 25  CM-INSURED-INITIALS-A5.
  5651                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5652                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5653                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5654
  5655     12  CM-INSURED-PROFILE-DATA.
  5656         16  CM-INSURED-FIRST-NAME.
  5657             20  CM-INSURED-1ST-INIT       PIC X.
  5658             20  FILLER                    PIC X(9).
  5659         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5660         16  CM-INSURED-SEX                PIC X.
  5661             88  CM-SEX-MALE                  VALUE 'M'.
  5662             88  CM-SEX-FEMAL                 VALUE 'F'.
  5663         16  CM-INSURED-JOINT-AGE          PIC 99.
  5664         16  CM-JOINT-INSURED-NAME.
  5665             20  CM-JT-LAST-NAME           PIC X(15).
  5666             20  CM-JT-FIRST-NAME.
  5667                 24  CM-JT-1ST-INIT        PIC X.
  5668                 24  FILLER                PIC X(9).
  5669             20  CM-JT-INITIAL             PIC X.
  5670
  5671     12  CM-LIFE-DATA.
  5672         16  CM-LF-BENEFIT-CD              PIC XX.
  5673         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5674         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5675         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5676         16  CM-LF-DEV-CODE                PIC XXX.
  5677         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5678         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5679         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5680         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 108
* EL156.cbl
  5681         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5682         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5683         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5684         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5685         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5686         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5687         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5688         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5689         16  FILLER                        PIC XX.
  5690
  5691     12  CM-AH-DATA.
  5692         16  CM-AH-BENEFIT-CD              PIC XX.
  5693         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5694         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5695         16  CM-AH-DEV-CODE                PIC XXX.
  5696         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5697         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5698         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5699         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5700         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5701         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5702         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5703         16  CM-AH-PAID-THRU-DT            PIC XX.
  5704             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5705         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5706         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5707         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5708         16  FILLER                        PIC X.
  5709
  5710     12  CM-LOAN-INFORMATION.
  5711         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5712         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5713                                           PIC S9(5)V99  COMP-3.
  5714         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5715         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5716         16  CM-PAY-FREQUENCY              PIC S99.
  5717         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5718         16  CM-RATE-CLASS                 PIC XX.
  5719         16  CM-BENEFICIARY                PIC X(25).
  5720         16  CM-POLICY-FORM-NO             PIC X(12).
  5721         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5722         16  CM-LAST-ADD-ON-DT             PIC XX.
  5723         16  CM-DEDUCTIBLE-AMOUNTS.
  5724             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5725             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5726         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5727             20  CM-RESIDENT-STATE         PIC XX.
  5728             20  CM-RATE-CODE              PIC X(4).
  5729             20  FILLER                    PIC XX.
  5730         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5731             20  CM-LOAN-OFFICER           PIC X(5).
  5732             20  FILLER                    PIC XXX.
  5733         16  CM-CSR-CODE                   PIC XXX.
  5734         16  CM-UNDERWRITING-CODE          PIC X.
  5735             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5736         16  CM-POST-CARD-IND              PIC X.
  5737         16  CM-NH-INTERFACE-SW            PIC X.
  5738         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 109
* EL156.cbl
  5739             88  CM-SING-PRM                  VALUE '1'.
  5740             88  CM-O-B-COVERAGE              VALUE '2'.
  5741             88  CM-OPEN-END                  VALUE '3'.
  5742         16  CM-IND-GRP-TYPE               PIC X.
  5743             88  CM-INDIVIDUAL                VALUE 'I'.
  5744             88  CM-GROUP                     VALUE 'G'.
  5745         16  CM-SKIP-CODE                  PIC X.
  5746             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5747             88  SKIP-JULY                    VALUE '1'.
  5748             88  SKIP-AUGUST                  VALUE '2'.
  5749             88  SKIP-SEPTEMBER               VALUE '3'.
  5750             88  SKIP-JULY-AUG                VALUE '4'.
  5751             88  SKIP-AUG-SEPT                VALUE '5'.
  5752             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5753             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5754             88  SKIP-JUNE                    VALUE '8'.
  5755             88  SKIP-JUNE-JULY               VALUE '9'.
  5756             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5757             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5758         16  CM-PAYMENT-MODE               PIC X.
  5759             88  PAY-MONTHLY                  VALUE SPACE.
  5760             88  PAY-WEEKLY                   VALUE '1'.
  5761             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5762             88  PAY-BI-WEEKLY                VALUE '3'.
  5763             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5764         16  CM-LOAN-NUMBER                PIC X(8).
  5765         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5766         16  CM-OLD-LOF                    PIC XXX.
  5767*        16  CM-LOAN-OFFICER               PIC XXX.
  5768         16  CM-REIN-TABLE                 PIC XXX.
  5769         16  CM-SPECIAL-REIN-CODE          PIC X.
  5770         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5771         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5772         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5773
  5774     12  CM-STATUS-DATA.
  5775         16  CM-ENTRY-STATUS               PIC X.
  5776         16  CM-ENTRY-DT                   PIC XX.
  5777
  5778         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5779         16  CM-LF-CANCEL-DT               PIC XX.
  5780         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5781
  5782         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5783         16  CM-LF-DEATH-DT                PIC XX.
  5784         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5785
  5786         16  CM-LF-CURRENT-STATUS          PIC X.
  5787             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5788                                                'M' '4' '5' '9'.
  5789             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5790             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5791             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5792             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5793             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5794             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5795             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5796             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 110
* EL156.cbl
  5797             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5798             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5799             88  CM-LF-DECLINED               VALUE 'D'.
  5800             88  CM-LF-VOIDED                 VALUE 'V'.
  5801
  5802         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5803         16  CM-AH-CANCEL-DT               PIC XX.
  5804         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5805
  5806         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5807         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5808         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5809
  5810         16  CM-AH-CURRENT-STATUS          PIC X.
  5811             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5812                                                'M' '4' '5' '9'.
  5813             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5814             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5815             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5816             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5817             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5818             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5819             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5820             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5821             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5822             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5823             88  CM-AH-DECLINED               VALUE 'D'.
  5824             88  CM-AH-VOIDED                 VALUE 'V'.
  5825
  5826         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5827             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5828             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5829             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5830         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5831
  5832         16  CM-ENTRY-BATCH                PIC X(6).
  5833         16  CM-LF-EXIT-BATCH              PIC X(6).
  5834         16  CM-AH-EXIT-BATCH              PIC X(6).
  5835         16  CM-LAST-MONTH-END             PIC XX.
  5836
  5837     12  CM-NOTE-SW                        PIC X.
  5838         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5839         88  CERT-NOTES-PRESENT               VALUE '1'.
  5840         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5841         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5842         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5843         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5844         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5845         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5846     12  CM-COMP-EXCP-SW                   PIC X.
  5847         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5848         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5849     12  CM-INSURED-ADDRESS-SW             PIC X.
  5850         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5851         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5852
  5853*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5854     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 111
* EL156.cbl
  5855     12  FILLER                            PIC X.
  5856
  5857*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5858     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5859     12  FILLER                            PIC X.
  5860*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5861     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5862
  5863     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5864         88  CERT-ADDED-BATCH                 VALUE ' '.
  5865         88  CERT-ADDED-ONLINE                VALUE '1'.
  5866         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5867         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5868         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5869     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5870         88  CERT-AS-LOADED                   VALUE ' '.
  5871         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5872         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5873         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5874         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5875         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5876         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5877         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5878
  5879     12  CM-ACCOUNT-COMM-PCTS.
  5880         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5881         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5882
  5883     12  CM-USER-FIELD                     PIC X.
  5884     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5885     12  CM-CLP-STATE                      PIC XX.
  5886     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5887     12  CM-USER-RESERVED                  PIC XXX.
  5888     12  FILLER REDEFINES CM-USER-RESERVED.
  5889         16  CM-AH-CLASS-CD                PIC XX.
  5890         16  F                             PIC X.
  5891******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 112
* EL156.cbl
  5893*    COPY ELCTRLR.
  5894******************************************************************
  5895*                                                                *
  5896*                            ELCTRLR.                            *
  5897*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5898*                            VMOD=2.014                          *
  5899*                                                                *
  5900*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5901*                                                                *
  5902*   FILE TYPE = VSAM,KSDS                                        *
  5903*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5904*                                                                *
  5905*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5906*       ALTERNATE INDEX = NONE                                   *
  5907*                                                                *
  5908*   LOG = YES                                                    *
  5909*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5910******************************************************************
  5911*                   C H A N G E   L O G
  5912*
  5913* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5914*-----------------------------------------------------------------
  5915*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5916* EFFECTIVE    NUMBER
  5917*-----------------------------------------------------------------
  5918* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5919* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5920* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5921* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5922* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5923* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5924* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5925* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5926* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5927* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5928* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5929* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5930* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5931* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5932* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5933* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5934* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5935* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5936* 040814    2014030500002  AJRA  ADD ICD CODES
  5937* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5938******************************************************************
  5939 01  ACTIVITY-TRAILERS.
  5940     12  AT-RECORD-ID                    PIC XX.
  5941         88  VALID-AT-ID                       VALUE 'AT'.
  5942
  5943     12  AT-CONTROL-PRIMARY.
  5944         16  AT-COMPANY-CD               PIC X.
  5945         16  AT-CARRIER                  PIC X.
  5946         16  AT-CLAIM-NO                 PIC X(7).
  5947         16  AT-CERT-NO.
  5948             20  AT-CERT-PRIME           PIC X(10).
  5949             20  AT-CERT-SFX             PIC X.
  5950         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 113
* EL156.cbl
  5951             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5952             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5953             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5954             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5955             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5956             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5957             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5958             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5959             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5960             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5961             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5962             88  AT-BENEFICIARY-TRL           VALUE +91.
  5963             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5964             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5965             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5966             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5967
  5968     12  AT-TRAILER-TYPE                 PIC X.
  5969         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5970         88  PAYMENT-TR                       VALUE '2'.
  5971         88  AUTO-PAY-TR                      VALUE '3'.
  5972         88  CORRESPONDENCE-TR                VALUE '4'.
  5973         88  ADDRESS-TR                       VALUE '5'.
  5974         88  GENERAL-INFO-TR                  VALUE '6'.
  5975         88  AUTO-PROMPT-TR                   VALUE '7'.
  5976         88  DENIAL-TR                        VALUE '8'.
  5977         88  INCURRED-CHG-TR                  VALUE '9'.
  5978         88  FORM-CONTROL-TR                  VALUE 'A'.
  5979
  5980     12  AT-RECORDED-DT                  PIC XX.
  5981     12  AT-RECORDED-BY                  PIC X(4).
  5982     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5983
  5984     12  AT-TRAILER-BODY                 PIC X(165).
  5985
  5986     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5987         16  AT-RESERVE-CONTROLS.
  5988             20  AT-MANUAL-SW            PIC X.
  5989                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5990             20  AT-FUTURE-SW            PIC X.
  5991                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5992             20  AT-PTC-SW               PIC X.
  5993                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5994             20  AT-IBNR-SW              PIC X.
  5995                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5996             20  AT-PTC-LF-SW            PIC X.
  5997                 88  AT-LF-PTC-USED          VALUE '1'.
  5998             20  AT-CDT-ACCESS-METHOD    PIC X.
  5999                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6000                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6001                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6002             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6003         16  AT-LAST-COMPUTED-DT         PIC XX.
  6004         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6005         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6006         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6007         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6008         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 114
* EL156.cbl
  6009         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6010         16  AT-EXPENSE-CONTROLS.
  6011             20  AT-EXPENSE-METHOD       PIC X.
  6012                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6013                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6014                 88  PERCENT-OF-PMT           VALUE '3'.
  6015                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6016             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6017             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6018         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6019         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6020
  6021         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6022         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6023
  6024*        16  FILLER                      PIC X(53).
  6025         16  FILLER                      PIC X(47).
  6026
  6027         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6028         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6029
  6030         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6031             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6032             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6033*                    C = CLOSED
  6034*                    O = OPEN
  6035             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6036*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6037
  6038     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6039         16  AT-PAYMENT-TYPE             PIC X.
  6040             88  PARTIAL-PAYMENT                VALUE '1'.
  6041             88  FINAL-PAYMENT                  VALUE '2'.
  6042             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6043             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6044             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6045             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6046             88  VOIDED-PAYMENT                 VALUE '9'.
  6047             88  TRANSFER                       VALUE 'T'.
  6048             88  LIFE-INTEREST                  VALUE 'I'.
  6049
  6050         16  AT-CLAIM-TYPE               PIC X.
  6051             88  PAID-FOR-AH                    VALUE 'A'.
  6052             88  PAID-FOR-LIFE                  VALUE 'L'.
  6053             88  PAID-FOR-IUI                   VALUE 'I'.
  6054             88  PAID-FOR-GAP                   VALUE 'G'.
  6055             88  PAID-FOR-FAM                   VALUE 'F'.
  6056         16  AT-CLAIM-PREM-TYPE          PIC X.
  6057             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6058             88  AT-O-B-COVERAGE                VALUE '2'.
  6059             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6060         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6061         16  AT-CHECK-NO                 PIC X(7).
  6062         16  AT-PAID-FROM-DT             PIC XX.
  6063         16  AT-PAID-THRU-DT             PIC XX.
  6064         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6065         16  FILLER                      PIC X.
  6066         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 115
* EL156.cbl
  6067         16  AT-PAYMENT-ORIGIN           PIC X.
  6068             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6069             88  ONLINE-AUTO-PMT                VALUE '2'.
  6070             88  OFFLINE-PMT                    VALUE '3'.
  6071         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6072         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6073         16  AT-VOID-DATA.
  6074             20  AT-VOID-DT              PIC XX.
  6075*00144       20  AT-VOID-REASON          PIC X(30).
  6076             20  AT-VOID-REASON          PIC X(26).
  6077         16  AT-PMT-APPROVED-BY          PIC X(04).
  6078         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6079         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6080         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6081                                         PIC S99V9(5)  COMP-3.
  6082         16  AT-CREDIT-INTERFACE.
  6083             20  AT-PMT-SELECT-DT        PIC XX.
  6084                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6085             20  AT-PMT-ACCEPT-DT        PIC XX.
  6086                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6087             20  AT-VOID-SELECT-DT       PIC XX.
  6088                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6089             20  AT-VOID-ACCEPT-DT       PIC XX.
  6090                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6091
  6092         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6093                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6094                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6095         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6096
  6097         16  AT-FORCE-CONTROL            PIC X.
  6098             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6099         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6100         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6101         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6102         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6103         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6104         16  AT-BENEFIT-TYPE             PIC X.
  6105
  6106         16  AT-EXPENSE-TYPE             PIC X.
  6107         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6108
  6109         16  AT-PAYEE-TYPE-CD.
  6110             20  AT-PAYEE-TYPE           PIC X.
  6111                 88  INSURED-PAID           VALUE 'I'.
  6112                 88  BENEFICIARY-PAID       VALUE 'B'.
  6113                 88  ACCOUNT-PAID           VALUE 'A'.
  6114                 88  OTHER-1-PAID           VALUE 'O'.
  6115                 88  OTHER-2-PAID           VALUE 'Q'.
  6116                 88  DOCTOR-PAID            VALUE 'P'.
  6117                 88  EMPLOYER-PAID          VALUE 'E'.
  6118             20  AT-PAYEE-SEQ            PIC X.
  6119
  6120         16  AT-CASH-PAYMENT             PIC X.
  6121         16  AT-GROUPED-PAYMENT          PIC X.
  6122         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6123         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6124         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 116
* EL156.cbl
  6125         16  AT-VOID-TYPE                PIC X.
  6126             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6127             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6128         16  AT-AIG-UNEMP-IND            PIC X.
  6129             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6130         16  AT-ASSOCIATES               PIC X.
  6131             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6132             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6133
  6134         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6135         16  AT-CV-PMT-CODE              PIC X.
  6136             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6137             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6138             88  FULL-ADD-PAYMENT           VALUE '3'.
  6139             88  HALF-ADD-PAYMENT           VALUE '4'.
  6140             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6141             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6142             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6143             88  ADDL-PAYMENT               VALUE '8'.
  6144
  6145         16  AT-EOB-CODE1                PIC XXX.
  6146         16  AT-EOB-CODE2                PIC XXX.
  6147         16  AT-EOB-CODE3                PIC XXX.
  6148         16  FILLER REDEFINES AT-EOB-CODE3.
  6149             20  AT-PRINT-CLM-FORM       PIC X.
  6150             20  AT-PRINT-SURVEY         PIC X.
  6151             20  AT-SPECIAL-RELEASE      PIC X.
  6152         16  AT-EOB-CODE4                PIC XXX.
  6153         16  FILLER REDEFINES AT-EOB-CODE4.
  6154             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6155             20  FILLER                  PIC X.
  6156         16  AT-EOB-CODE5                PIC XXX.
  6157         16  FILLER REDEFINES AT-EOB-CODE5.
  6158             20  AT-PMT-PROOF-DT         PIC XX.
  6159             20  FILLER                  PIC X.
  6160
  6161         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6162             88  AT-PRINT-EOB            VALUE 'Y'.
  6163
  6164         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6165         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6166
  6167     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6168         16  AT-SCHEDULE-START-DT        PIC XX.
  6169         16  AT-SCHEDULE-END-DT          PIC XX.
  6170         16  AT-TERMINATED-DT            PIC XX.
  6171         16  AT-LAST-PMT-TYPE            PIC X.
  6172             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6173             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6174         16  AT-FIRST-PMT-DATA.
  6175             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6176             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6177             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6178         16  AT-REGULAR-PMT-DATA.
  6179             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6180             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6181             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6182         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 117
* EL156.cbl
  6183             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6184                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6185                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6186                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6187                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6188                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6189             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6190         16  AT-AUTO-PAY-DAY             PIC 99.
  6191         16  AT-AUTO-CASH                PIC X.
  6192             88  AT-CASH                      VALUE 'Y'.
  6193             88  AT-NON-CASH                  VALUE 'N'.
  6194*        16  FILLER                      PIC X(129).
  6195         16  AT-AUTO-END-LETTER          PIC X(4).
  6196         16  FILLER                      PIC X(125).
  6197
  6198         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6199         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6200
  6201     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6202         16  AT-LETTER-SENT-DT           PIC XX.
  6203         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6204         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6205         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6206         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6207         16  AT-LETTER-ORIGIN            PIC X.
  6208             88  ONLINE-CREATION              VALUE '1' '3'.
  6209             88  OFFLINE-CREATION             VALUE '2' '4'.
  6210             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6211             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6212         16  AT-STD-LETTER-FORM          PIC X(4).
  6213         16  AT-REASON-TEXT              PIC X(70).
  6214         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6215         16  AT-ADDRESEE-TYPE            PIC X.
  6216              88  INSURED-ADDRESEE            VALUE 'I'.
  6217              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6218              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6219              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6220              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6221              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6222              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6223         16  AT-ADDRESSEE-NAME           PIC X(30).
  6224         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6225         16  AT-RESEND-PRINT-DATE        PIC XX.
  6226         16  AT-CORR-SOL-UNSOL           PIC X.
  6227         16  AT-LETTER-PURGED-DT         PIC XX.
  6228*
  6229*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6230*
  6231         16  AT-CSO-REDEFINITION.
  6232             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6233             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6234             20  AT-LETTER-TO-BENE       PIC X(1).
  6235             20  AT-STOP-LETTER-DT       PIC X(2).
  6236             20  FILLER                  PIC X(19).
  6237*             20  FILLER                  PIC X(27).
  6238             20  AT-CSO-LETTER-STATUS    PIC X.
  6239                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6240                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 118
* EL156.cbl
  6241                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6242             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6243             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6244*
  6245*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6246*
  6247*        16  FILLER                      PIC X(26).
  6248*
  6249*        16  AT-DMD-BSR-CODE             PIC X.
  6250*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6251*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6252*
  6253*        16  AT-DMD-LETTER-STATUS        PIC X.
  6254*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6255*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6256*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6257*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6258*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6259
  6260         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6261         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6262
  6263     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6264         16  AT-ADDRESS-TYPE             PIC X.
  6265             88  INSURED-ADDRESS               VALUE 'I'.
  6266             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6267             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6268             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6269             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6270             88  OTHER-ADDRESS-1               VALUE 'O'.
  6271             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6272         16  AT-MAIL-TO-NAME             PIC X(30).
  6273         16  AT-ADDRESS-LINE-1           PIC X(30).
  6274         16  AT-ADDRESS-LINE-2           PIC X(30).
  6275         16  AT-CITY-STATE.
  6276             20  AT-CITY                 PIC X(28).
  6277             20  AT-STATE                PIC XX.
  6278         16  AT-ZIP.
  6279             20  AT-ZIP-CODE.
  6280                 24  AT-ZIP-1ST          PIC X.
  6281                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6282                 24  FILLER              PIC X(4).
  6283             20  AT-ZIP-PLUS4            PIC X(4).
  6284         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6285             20  AT-CAN-POSTAL-1         PIC XXX.
  6286             20  AT-CAN-POSTAL-2         PIC XXX.
  6287             20  FILLER                  PIC XXX.
  6288         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6289*         16  FILLER                      PIC X(23).
  6290         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6291         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6292         16  FILLER                      PIC X(13).
  6293         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6294         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6295
  6296     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6297         16  AT-INFO-LINE-1              PIC X(60).
  6298         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 119
* EL156.cbl
  6299             20  AT-NOTE-ERROR-NO OCCURS 15
  6300                                         PIC X(4).
  6301         16  AT-INFO-LINE-2              PIC X(60).
  6302         16  FILLER REDEFINES AT-INFO-LINE-2.
  6303             20  AT-ICD-CODE-1           PIC X(8).
  6304             20  AT-ICD-CODE-2           PIC X(8).
  6305             20  FILLER                  PIC X(44).
  6306         16  AT-INFO-TRAILER-TYPE        PIC X.
  6307             88  AT-ERRORS-NOTE          VALUE 'E'.
  6308             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6309             88  AT-CALL-NOTE            VALUE 'C'.
  6310             88  AT-MAINT-NOTE           VALUE 'M'.
  6311             88  AT-CERT-CHANGE          VALUE 'X'.
  6312             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6313             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6314             88  AT-CERT-CANCELLED       VALUE 'T'.
  6315         16  AT-CALL-TYPE                PIC X.
  6316             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6317             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6318         16  AT-NOTE-CONTINUATION        PIC X.
  6319             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6320         16  AT-EOB-CODES-EXIST          PIC X.
  6321             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6322         16  FILLER                      PIC X(35).
  6323         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6324         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6325
  6326     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6327         16  AT-PROMPT-LINE-1            PIC X(60).
  6328         16  AT-PROMPT-LINE-2            PIC X(60).
  6329         16  AT-PROMPT-START-DT          PIC XX.
  6330         16  AT-PROMPT-END-DT            PIC XX.
  6331         16  FILLER                      PIC X(35).
  6332         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6333         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6334
  6335     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6336         16  AT-DENIAL-INFO-1            PIC X(60).
  6337         16  AT-DENIAL-INFO-2            PIC X(60).
  6338         16  AT-DENIAL-DT                PIC XX.
  6339         16  AT-RETRACTION-DT            PIC XX.
  6340         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6341*         16  FILLER                      PIC X(31).
  6342         16  AT-DENIAL-PROOF-DT          PIC XX.
  6343         16  FILLER                      PIC X(29).
  6344         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6345         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6346
  6347     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6348         16  AT-OLD-INCURRED-DT          PIC XX.
  6349         16  AT-OLD-REPORTED-DT          PIC XX.
  6350         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6351         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6352         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6353         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6354         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6355         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6356         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 120
* EL156.cbl
  6357         16  AT-OLD-DIAG-CODE            PIC X(6).
  6358         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6359         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6360         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6361         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6362         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6363         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6364         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6365         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6366         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6367         16  FILLER                      PIC X(9).
  6368         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6369
  6370     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6371         16  AT-FORM-SEND-ON-DT          PIC XX.
  6372         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6373         16  AT-FORM-RE-SEND-DT          PIC XX.
  6374         16  AT-FORM-ANSWERED-DT         PIC XX.
  6375         16  AT-FORM-PRINTED-DT          PIC XX.
  6376         16  AT-FORM-REPRINT-DT          PIC XX.
  6377         16  AT-FORM-TYPE                PIC X.
  6378             88  INITIAL-FORM                  VALUE '1'.
  6379             88  PROGRESS-FORM                 VALUE '2'.
  6380         16  AT-INSTRUCT-LN-1            PIC X(28).
  6381         16  AT-INSTRUCT-LN-2            PIC X(28).
  6382         16  AT-INSTRUCT-LN-3            PIC X(28).
  6383         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6384         16  AT-FORM-ADDRESS             PIC X.
  6385             88  FORM-TO-INSURED              VALUE 'I'.
  6386             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6387             88  FORM-TO-OTHER-1              VALUE 'O'.
  6388             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6389         16  AT-RELATED-1.
  6390             20 AT-REL-CARR-1            PIC X.
  6391             20 AT-REL-CLAIM-1           PIC X(7).
  6392             20 AT-REL-CERT-1            PIC X(11).
  6393         16  AT-RELATED-2.
  6394             20 AT-REL-CARR-2            PIC X.
  6395             20 AT-REL-CLAIM-2           PIC X(7).
  6396             20 AT-REL-CERT-2            PIC X(11).
  6397         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6398         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6399         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6400         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6401         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6402         16  AT-STOP-FORM-DT             PIC X(2).
  6403
  6404         16  FILLER                      PIC X(09).
  6405         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6406         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6407******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 121
* EL156.cbl
  6409*    COPY ELCACTQ.
  6410******************************************************************
  6411*                                                                *
  6412*                            ELCACTQ.                            *
  6413*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6414*                            VMOD=2.004                          *
  6415*                                                                *
  6416*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6417*                                                                *
  6418*   FILE TYPE = VSAM,KSDS                                        *
  6419*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6420*                                                                *
  6421*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6422*       ALTERNATE INDEX = NONE                                   *
  6423*                                                                *
  6424*   LOG = YES                                                    *
  6425*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6426*                                                                *
  6427*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6428******************************************************************
  6429
  6430 01  ACTIVITY-QUE.
  6431     12  AQ-RECORD-ID                PIC XX.
  6432         88  VALID-AQ-ID                VALUE 'AQ'.
  6433
  6434     12  AQ-CONTROL-PRIMARY.
  6435         16  AQ-COMPANY-CD           PIC X.
  6436         16  AQ-CARRIER              PIC X.
  6437         16  AQ-CLAIM-NO             PIC X(7).
  6438         16  AQ-CERT-NO.
  6439             20  AQ-CERT-PRIME       PIC X(10).
  6440             20  AQ-CERT-SFX         PIC X.
  6441
  6442     12  AQ-PENDING-ACTIVITY-FLAGS.
  6443         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6444         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6445             88  PENDING-PAYMENTS       VALUE '1'.
  6446         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6447             88  PENDING-FULL-PRINT     VALUE '1'.
  6448             88  PENDING-PART-PRINT     VALUE '2'.
  6449         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6450             88  PENDING-LETTERS        VALUE '1'.
  6451         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6452             88  PENDING-RESTORE        VALUE 'C'.
  6453             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6454
  6455     12  FILLER                      PIC X(20).
  6456
  6457     12  AQ-RESEND-DATE              PIC XX.
  6458     12  AQ-FOLLOWUP-DATE            PIC XX.
  6459     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6460     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6461     12  AQ-AUTO-LETTER              PIC X(4).
  6462     12  FILLER                      PIC XX.
  6463     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6464*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 122
* EL156.cbl
  6466*    COPY ERCACCT.
  6467******************************************************************
  6468*                                                                *
  6469*                                                                *
  6470*                            ERCACCT                             *
  6471*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6472*                            VMOD=2.031                          *
  6473*                                                                *
  6474*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6475*                                                                *
  6476*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6477*   VSAM ACCOUNT MASTER FILES.                                   *
  6478*                                                                *
  6479*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6480*                                                                *
  6481*   FILE TYPE = VSAM,KSDS                                        *
  6482*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6483*                                                                *
  6484*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6485*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6486*                                                                *
  6487*   LOG = NO                                                     *
  6488*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6489*                                                                *
  6490*                                                                *
  6491******************************************************************
  6492*                   C H A N G E   L O G
  6493*
  6494* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6495*-----------------------------------------------------------------
  6496*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6497* EFFECTIVE    NUMBER
  6498*-----------------------------------------------------------------
  6499* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6500* 092705    2005050300006  PEMA  ADD SPP LEASES
  6501* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6502* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6503* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6504* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6505* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6506******************************************************************
  6507
  6508 01  ACCOUNT-MASTER.
  6509     12  AM-RECORD-ID                      PIC XX.
  6510         88  VALID-AM-ID                      VALUE 'AM'.
  6511
  6512     12  AM-CONTROL-PRIMARY.
  6513         16  AM-COMPANY-CD                 PIC X.
  6514         16  AM-MSTR-CNTRL.
  6515             20  AM-CONTROL-A.
  6516                 24  AM-CARRIER            PIC X.
  6517                 24  AM-GROUPING.
  6518                     28 AM-GROUPING-PREFIX PIC XXX.
  6519                     28 AM-GROUPING-PRIME  PIC XXX.
  6520                 24  AM-STATE              PIC XX.
  6521                 24  AM-ACCOUNT.
  6522                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6523                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 123
* EL156.cbl
  6524             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6525                                           PIC X(19).
  6526             20  AM-CNTRL-B.
  6527                 24  AM-EXPIRATION-DT      PIC XX.
  6528                 24  FILLER                PIC X(4).
  6529             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6530                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6531
  6532     12  AM-CONTROL-BY-VAR-GRP.
  6533         16  AM-COMPANY-CD-A1              PIC X.
  6534         16  AM-VG-CARRIER                 PIC X.
  6535         16  AM-VG-GROUPING                PIC X(6).
  6536         16  AM-VG-STATE                   PIC XX.
  6537         16  AM-VG-ACCOUNT                 PIC X(10).
  6538         16  AM-VG-DATE.
  6539             20  AM-VG-EXPIRATION-DT       PIC XX.
  6540             20  FILLER                    PIC X(4).
  6541         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6542                                           PIC 9(11)      COMP-3.
  6543     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6544         16  FILLER                        PIC X(10).
  6545         16  AM-VG-KEY3.
  6546             20  AM-VG3-ACCOUNT            PIC X(10).
  6547             20  AM-VG3-EXP-DT             PIC XX.
  6548         16  FILLER                        PIC X(4).
  6549     12  AM-MAINT-INFORMATION.
  6550         16  AM-LAST-MAINT-DT              PIC XX.
  6551         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6552         16  AM-LAST-MAINT-USER            PIC X(4).
  6553         16  FILLER                        PIC XX.
  6554
  6555     12  AM-EFFECTIVE-DT                   PIC XX.
  6556     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6557
  6558     12  AM-PREV-DATES  COMP-3.
  6559         16  AM-PREV-EXP-DT                PIC 9(11).
  6560         16  AM-PREV-EFF-DT                PIC 9(11).
  6561
  6562     12  AM-REPORT-CODE-1                  PIC X(10).
  6563     12  AM-REPORT-CODE-2                  PIC X(10).
  6564
  6565     12  AM-CITY-CODE                      PIC X(4).
  6566     12  AM-COUNTY-PARISH                  PIC X(6).
  6567
  6568     12  AM-NAME                           PIC X(30).
  6569     12  AM-PERSON                         PIC X(30).
  6570     12  AM-ADDRS                          PIC X(30).
  6571     12  AM-CITY.
  6572         16  AM-ADDR-CITY                  PIC X(28).
  6573         16  AM-ADDR-STATE                 PIC XX.
  6574     12  AM-ZIP.
  6575         16  AM-ZIP-PRIME.
  6576             20  AM-ZIP-PRI-1ST            PIC X.
  6577                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6578             20  FILLER                    PIC X(4).
  6579         16  AM-ZIP-PLUS4                  PIC X(4).
  6580     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6581         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 124
* EL156.cbl
  6582         16  AM-CAN-POSTAL-2               PIC XXX.
  6583         16  FILLER                        PIC XXX.
  6584     12  AM-TEL-NO.
  6585         16  AM-AREA-CODE                  PIC 999.
  6586         16  AM-TEL-PRE                    PIC 999.
  6587         16  AM-TEL-NBR                    PIC 9(4).
  6588     12  AM-TEL-LOC                        PIC X.
  6589         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6590         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6591
  6592     12  AM-COMM-STRUCTURE.
  6593         16  AM-DEFN-1.
  6594             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6595                 24  AM-AGT.
  6596                     28  AM-AGT-PREFIX     PIC X(4).
  6597                     28  AM-AGT-PRIME      PIC X(6).
  6598                 24  AM-COM-TYP            PIC X.
  6599                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6600                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6601                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6602                 24  AM-RECALC-LV-INDIC    PIC X.
  6603                 24  AM-RETRO-LV-INDIC     PIC X.
  6604                 24  AM-GL-CODES           PIC X.
  6605                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6606                 24  FILLER                PIC X(01).
  6607         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6608             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6609                 24  FILLER                PIC X(11).
  6610                 24  AM-L-COMA             PIC XXX.
  6611                 24  AM-J-COMA             PIC XXX.
  6612                 24  AM-A-COMA             PIC XXX.
  6613                 24  FILLER                PIC X(6).
  6614
  6615     12  AM-COMM-CHANGE-STATUS             PIC X.
  6616         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6617
  6618     12  AM-CSR-CODE                       PIC X(4).
  6619
  6620     12  AM-BILLING-STATUS                 PIC X.
  6621         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6622         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6623     12  AM-AUTO-REFUND-SW                 PIC X.
  6624         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6625         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6626     12  AM-GPCD                           PIC 99.
  6627     12  AM-IG                             PIC X.
  6628         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6629         88  AM-HAS-GROUP                     VALUE '2'.
  6630     12  AM-STATUS                         PIC X.
  6631         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6632         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6633         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6634         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6635         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6636         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6637     12  AM-REMIT-TO                       PIC 99.
  6638     12  AM-ID-NO                          PIC X(11).
  6639
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 125
* EL156.cbl
  6640     12  AM-CAL-TABLE                      PIC XX.
  6641     12  AM-LF-DEVIATION                   PIC XXX.
  6642     12  AM-AH-DEVIATION                   PIC XXX.
  6643     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6644     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6645     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6646     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6647     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6648     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6649
  6650     12  AM-USER-FIELDS.
  6651         16  AM-FLD-1                      PIC XX.
  6652         16  AM-FLD-2                      PIC XX.
  6653         16  AM-FLD-3                      PIC XX.
  6654         16  AM-FLD-4                      PIC XX.
  6655         16  AM-FLD-5                      PIC XX.
  6656
  6657     12  AM-1ST-PROD-DATE.
  6658         16  AM-1ST-PROD-YR                PIC XX.
  6659         16  AM-1ST-PROD-MO                PIC XX.
  6660         16  AM-1ST-PROD-DA                PIC XX.
  6661     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6662     12  AM-CERTS-PURGED-DATE.
  6663         16  AM-PUR-YR                     PIC XX.
  6664         16  AM-PUR-MO                     PIC XX.
  6665         16  AM-PUR-DA                     PIC XX.
  6666     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6667     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6668     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6669     12  AM-INACTIVE-DATE.
  6670         16  AM-INA-MO                     PIC 99.
  6671         16  AM-INA-DA                     PIC 99.
  6672         16  AM-INA-YR                     PIC 99.
  6673     12  AM-AR-HI-CERT-DATE                PIC XX.
  6674
  6675     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6676     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6677
  6678     12  AM-OB-PAYMENT-MODE                PIC X.
  6679         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6680         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6681         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6682         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6683
  6684     12  AM-AH-ONLY-INDICATOR              PIC X.
  6685         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6686         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6687
  6688     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6689
  6690     12  AM-OVER-SHORT.
  6691         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6692         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6693
  6694     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6695     12  AM-DCC-CLP-STATE                  PIC XX.
  6696
  6697     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 126
* EL156.cbl
  6698     12  AM-RECALC-REIN                    PIC X.
  6699
  6700     12  AM-REI-TABLE                      PIC XXX.
  6701     12  AM-REI-ET-LF                      PIC X.
  6702     12  AM-REI-ET-AH                      PIC X.
  6703     12  AM-REI-PE-LF                      PIC X.
  6704     12  AM-REI-PE-AH                      PIC X.
  6705     12  AM-REI-PRT-ST                     PIC X.
  6706     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6707     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6708     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6709     12  AM-REI-GROUP-A                    PIC X(6).
  6710     12  AM-REI-MORT                       PIC X(4).
  6711     12  AM-REI-PRT-OW                     PIC X.
  6712     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6713     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6714     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6715     12  AM-REI-GROUP-B                    PIC X(6).
  6716
  6717     12  AM-TRUST-TYPE                     PIC X(2).
  6718
  6719     12  AM-EMPLOYER-STMT-USED             PIC X.
  6720     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6721
  6722     12  AM-STD-AH-TYPE                    PIC XX.
  6723     12  AM-EARN-METHODS.
  6724         16  AM-EARN-METHOD-R              PIC X.
  6725             88 AM-REF-RL-R78                 VALUE 'R'.
  6726             88 AM-REF-RL-PR                  VALUE 'P'.
  6727             88 AM-REF-RL-MEAN                VALUE 'M'.
  6728             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6729         16  AM-EARN-METHOD-L              PIC X.
  6730             88 AM-REF-LL-R78                 VALUE 'R'.
  6731             88 AM-REF-LL-PR                  VALUE 'P'.
  6732             88 AM-REF-LL-MEAN                VALUE 'M'.
  6733             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6734         16  AM-EARN-METHOD-A              PIC X.
  6735             88 AM-REF-AH-R78                 VALUE 'R'.
  6736             88 AM-REF-AH-PR                  VALUE 'P'.
  6737             88 AM-REF-AH-MEAN                VALUE 'M'.
  6738             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6739             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6740             88 AM-REF-AH-NET                 VALUE 'N'.
  6741
  6742     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6743     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6744     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6745
  6746     12  AM-RET-Y-N                        PIC X.
  6747     12  AM-RET-P-E                        PIC X.
  6748     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6749     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6750     12  AM-RET-GRP                        PIC X(6).
  6751     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6752         16  AM-POOL-PRIME                 PIC XXX.
  6753         16  AM-POOL-SUB                   PIC XXX.
  6754     12  AM-RETRO-EARNINGS.
  6755         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 127
* EL156.cbl
  6756         16  AM-RET-EARN-L                 PIC X.
  6757         16  AM-RET-EARN-A                 PIC X.
  6758     12  AM-RET-ST-TAX-USE                 PIC X.
  6759         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6760         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6761     12  AM-RETRO-BEG-EARNINGS.
  6762         16  AM-RET-BEG-EARN-R             PIC X.
  6763         16  AM-RET-BEG-EARN-L             PIC X.
  6764         16  AM-RET-BEG-EARN-A             PIC X.
  6765     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6766     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6767
  6768     12  AM-USER-SELECT-OPTIONS.
  6769         16  AM-USER-SELECT-1              PIC X(10).
  6770         16  AM-USER-SELECT-2              PIC X(10).
  6771         16  AM-USER-SELECT-3              PIC X(10).
  6772         16  AM-USER-SELECT-4              PIC X(10).
  6773         16  AM-USER-SELECT-5              PIC X(10).
  6774
  6775     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6776
  6777     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6778
  6779     12  AM-RPT045A-SWITCH                 PIC X.
  6780         88  RPT045A-OFF                   VALUE 'N'.
  6781
  6782     12  AM-INSURANCE-LIMITS.
  6783         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6784         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6785
  6786     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6787         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6788
  6789     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6790         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6791         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6792
  6793     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6794
  6795     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6796     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6797     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6798     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6799     12  AM-DCC-UEF-STATE                  PIC XX.
  6800     12  FILLER                            PIC XXX.
  6801     12  AM-REPORT-CODE-3                  PIC X(10).
  6802*    12  FILLER                            PIC X(22).
  6803
  6804     12  AM-RESERVE-DATE.
  6805         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6806         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6807         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6808
  6809     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6810     12  AM-NOTIFICATION-TYPES.
  6811         16  AM-NOTIF-OF-LETTERS           PIC X.
  6812         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6813         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 128
* EL156.cbl
  6814         16  AM-NOTIF-OF-STATUS            PIC X.
  6815
  6816     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6817         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6818         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6819         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6820         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6821
  6822     12  AM-BENEFIT-CONTROLS.
  6823         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6824             20  AM-BENEFIT-CODE           PIC XX.
  6825             20  AM-BENEFIT-TYPE           PIC X.
  6826             20  AM-BENEFIT-REVISION       PIC XXX.
  6827             20  AM-BENEFIT-REM-TERM       PIC X.
  6828             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6829             20  FILLER                    PIC XX.
  6830         16  FILLER                        PIC X(80).
  6831
  6832     12  AM-TRANSFER-DATA.
  6833         16  AM-TRANSFERRED-FROM.
  6834             20  AM-TRNFROM-CARRIER        PIC X.
  6835             20  AM-TRNFROM-GROUPING.
  6836                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6837                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6838             20  AM-TRNFROM-STATE          PIC XX.
  6839             20  AM-TRNFROM-ACCOUNT.
  6840                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6841                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6842             20  AM-TRNFROM-DTE            PIC XX.
  6843         16  AM-TRANSFERRED-TO.
  6844             20  AM-TRNTO-CARRIER          PIC X.
  6845             20  AM-TRNTO-GROUPING.
  6846                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6847                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6848             20  AM-TRNTO-STATE            PIC XX.
  6849             20  AM-TRNTO-ACCOUNT.
  6850                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6851                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6852             20  AM-TRNTO-DTE              PIC XX.
  6853         16  FILLER                        PIC X(10).
  6854
  6855     12  AM-SAVED-REMIT-TO                 PIC 99.
  6856
  6857     12  AM-COMM-STRUCTURE-SAVED.
  6858         16  AM-DEFN-1-SAVED.
  6859             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6860                 24  AM-AGT-SV             PIC X(10).
  6861                 24  AM-COM-TYP-SV         PIC X.
  6862                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6863                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6864                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6865                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6866                 24  FILLER                PIC X.
  6867                 24  AM-GL-CODES-SV        PIC X.
  6868                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6869                 24  FILLER                PIC X.
  6870         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6871             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 129
* EL156.cbl
  6872                 24  FILLER                PIC X(11).
  6873                 24  AM-L-COMA-SV          PIC XXX.
  6874                 24  AM-J-COMA-SV          PIC XXX.
  6875                 24  AM-A-COMA-SV          PIC XXX.
  6876                 24  FILLER                PIC X(6).
  6877
  6878     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6879         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6880            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6881            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6882            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6883
  6884     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6885     12  FILLER                            PIC X(120).
  6886
  6887     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6888         16  AM-CONTROL-NAME               PIC X(30).
  6889         16  AM-EXECUTIVE-ONE.
  6890             20  AM-EXEC1-NAME             PIC X(15).
  6891             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6892                                                          COMP-3.
  6893             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6894                                                          COMP-3.
  6895         16  AM-EXECUTIVE-TWO.
  6896             20  AM-EXEC2-NAME             PIC X(15).
  6897             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6898                                                          COMP-3.
  6899             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6900                                                          COMP-3.
  6901
  6902     12  AM-RETRO-ADDITIONAL-DATA.
  6903         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6904         16  AM-RETRO-PREM-P-E             PIC X.
  6905         16  AM-RETRO-CLMS-P-I             PIC X.
  6906         16  AM-RETRO-RET-BRACKET-LF.
  6907             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6908                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6909                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6910             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6911                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6912                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6913             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6914                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6915                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6916         16  AM-RETRO-RET-BRACKET-AH.
  6917             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6918                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6919                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6920                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6921             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6922                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6923                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6924             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6925                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6926                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6927
  6928     12  AM-COMMENTS.
  6929         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 130
* EL156.cbl
  6930
  6931     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6932         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6933         16  AM-FLI-BILLING-CODE           PIC X.
  6934         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6935         16  AM-FLI-UNITED-IDENT           PIC X.
  6936         16  AM-FLI-INTEREST-LOST-DATA.
  6937             20  AM-FLI-BANK-NO            PIC X(5).
  6938             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6939             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6940             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6941         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6942             20  AM-FLI-AGT                PIC X(9).
  6943             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6944             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6945         16  FILLER                        PIC X(102).
  6946
  6947     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6948         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6949             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6950             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6951             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6952             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6953             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6954         16  FILLER                          PIC X(10).
  6955******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 131
* EL156.cbl
  6957*    COPY ELCCHKQ.
  6958******************************************************************
  6959*                                                                *
  6960*                                                                *
  6961*                            ELCCHKQ.                            *
  6962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6963*                            VMOD=2.007                          *
  6964*                                                                *
  6965*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6966*                                                                *
  6967*   FILE TYPE = VSAM,KSDS                                        *
  6968*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6969*                                                                *
  6970*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6971*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6972*                                                                *
  6973*   LOG = YES                                                    *
  6974*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6975******************************************************************
  6976 01  CHECK-QUE.
  6977     12  CQ-RECORD-ID                PIC XX.
  6978         88  VALID-CQ-ID         VALUE 'CQ'.
  6979
  6980     12  CQ-CONTROL-PRIMARY.
  6981         16  CQ-COMPANY-CD           PIC X.
  6982         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6983         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6984
  6985     12  CQ-CONTROL-BY-PAYEE.
  6986         16  CQ-CONTROL-BY-NUMBER.
  6987             20  CQ-COMPANY-CD-A1     PIC X.
  6988             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6989         16  CQ-PAYEE-CARRIER        PIC X.
  6990         16  CQ-PAYEE-GROUPING       PIC X(6).
  6991         16  CQ-PAYEE-STATE          PIC XX.
  6992         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6993         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6994
  6995     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6996         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6997         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6998         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6999         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7000         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7001         16  FILLER                  PIC X(3).
  7002
  7003     12  CQ-ENTRY-TYPE               PIC X.
  7004             88  CHECK-ON-QUE           VALUE 'Q'.
  7005             88  ALIGNMENT-CHECK        VALUE 'A'.
  7006             88  SPOILED-CHECK          VALUE 'S'.
  7007             88  PAYMENT-ABORTED        VALUE 'X'.
  7008
  7009     12  CQ-CLAIM-MAST-CNTL.
  7010         16  CQ-CARRIER              PIC X.
  7011         16  CQ-CLAIM-NO             PIC X(7).
  7012         16  CQ-CERT-NO.
  7013             20  CQ-CERT-PRIME       PIC X(10).
  7014             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 132
* EL156.cbl
  7015         16  CQ-CLAIM-TYPE           PIC X.
  7016             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7017             88  CQ-AH-CLAIM            VALUE 'A'.
  7018         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7019             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7020             88  CQ-O-B-COVERAGE        VALUE '2'.
  7021             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7022
  7023     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7024     12  CQ-CHECK-NUMBER             PIC X(7).
  7025     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7026     12  CQ-PAYMENT-TYPE             PIC X.
  7027             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7028             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7029             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7030             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7031             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7032             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7033             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7034             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7035     12  CQ-VOID-INDICATOR           PIC X.
  7036             88  CHECK-IS-STOPPED          VALUE 'S'.
  7037             88  CHECK-IS-VOID             VALUE 'V'.
  7038     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7039     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7040     12  CQ-CHECK-BY-USER            PIC X(4).
  7041     12  CQ-PRE-NUMBERING-SW         PIC X.
  7042       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7043       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7044
  7045     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7046     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7047     12  CQ-LEDGER-FLAG              PIC X(01).
  7048     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7049     12  CQ-LAST-UPDATED-DT          PIC XX.
  7050     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7051     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7052
  7053     12  FILLER                      PIC X(04).
  7054
  7055******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 133
* EL156.cbl
  7057*    COPY ELCBENE.
  7058******************************************************************
  7059*                                                                *
  7060*                            ELCBENE.                            *
  7061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7062*                            VMOD=2.006                          *
  7063*                                                                *
  7064*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7065*                                                                *
  7066*   FILE TYPE = VSAM,KSDS                                        *
  7067*   RECORD SIZE = 500   RECFORM = FIX                            *
  7068*                                                                *
  7069*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7070*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7071*                                                                *
  7072*   LOG = YES                                                    *
  7073*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7074*                                                                *
  7075*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7076******************************************************************
  7077
  7078 01  BENEFICIARY-MASTER.
  7079     12  BE-RECORD-ID                PIC XX.
  7080         88  VALID-BE-ID                VALUE 'BE'.
  7081
  7082     12  BE-CONTROL-PRIMARY.
  7083         16  BE-COMPANY-CD           PIC X.
  7084         16  BE-RECORD-TYPE          PIC X.
  7085             88  BENEFICIARY-RECORD  VALUE 'B'.
  7086             88  ADJUSTOR-RECORD     VALUE 'A'.
  7087         16  BE-BENEFICIARY          PIC X(10).
  7088     12  BE-CONTROL-BY-NAME.
  7089         16  BE-COMPANY-CD-A1        PIC X.
  7090         16  BE-RECORD-TYPE-A1       PIC X.
  7091         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7092         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7093
  7094     12  BE-LAST-MAINT-DT            PIC XX.
  7095     12  BE-LAST-MAINT-BY            PIC X(4).
  7096     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7097
  7098     12  BE-ADDRESS-DATA.
  7099         16  BE-MAIL-TO-NAME         PIC X(30).
  7100         16  BE-ADDRESS-LINE-1       PIC X(30).
  7101         16  BE-ADDRESS-LINE-2       PIC X(30).
  7102         16  BE-ADDRESS-LINE-3       PIC X(30).
  7103         16  BE-CITY-STATE.
  7104             20  BE-CITY             PIC X(28).
  7105             20  BE-STATE            PIC XX.
  7106         16  BE-ZIP-CODE.
  7107             20  BE-ZIP-PRIME.
  7108                 24  BE-ZIP-1ST      PIC X.
  7109                     88  BE-CANADIAN-POST-CODE
  7110                                         VALUE 'A' THRU 'Z'.
  7111                 24  FILLER          PIC X(4).
  7112             20  BE-ZIP-PLUS4        PIC X(4).
  7113         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7114             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 134
* EL156.cbl
  7115             20  BE-CAN-POSTAL-2     PIC XXX.
  7116             20  FILLER              PIC XXX.
  7117         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7118         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7119
  7120******************************************************************
  7121*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7122*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7123******************************************************************
  7124     12  BE-CARRIER                  PIC X.
  7125
  7126     12  BE-ADDRESS-DATA2.
  7127         16  BE-MAIL-TO-NAME2        PIC X(30).
  7128         16  BE-ADDRESS-LINE-12      PIC X(30).
  7129         16  BE-ADDRESS-LINE-22      PIC X(30).
  7130         16  BE-ADDRESS-LINE-32      PIC X(30).
  7131         16  BE-CITY-STATE2.
  7132             20  BE-CITY2            PIC X(28).
  7133             20  BE-STATE2           PIC XX.
  7134         16  BE-ZIP-CODE2.
  7135             20  BE-ZIP-PRIME2.
  7136                 24  BE-ZIP-1ST2     PIC X.
  7137                     88  BE-CANADIAN-POST-CODE2
  7138                                         VALUE 'A' THRU 'Z'.
  7139                 24  FILLER          PIC X(4).
  7140             20  BE-ZIP-PLUS42       PIC X(4).
  7141         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7142             20  BE-CAN-POSTAL-12    PIC XXX.
  7143             20  BE-CAN-POSTAL-22    PIC XXX.
  7144             20  FILLER              PIC XXX.
  7145         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7146         16  BE-BILLING-STMT-DATA.
  7147             20  BE-BSR              PIC X.
  7148                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7149                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7150             20  BE-BSR-FROM         PIC X(30).
  7151             20  BE-BSR-DEPT         PIC X(30).
  7152             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7153             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7154             20  BE-OUTPUT-TYPE      PIC X.
  7155                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7156                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7157
  7158     12  FILLER                      PIC X(28).
  7159******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 135
* EL156.cbl
  7161*    COPY ELCARCH.
  7162******************************************************************
  7163*                                                                *
  7164*                            ELCARCH.                            *
  7165*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7166*                            VMOD=2.007                          *
  7167*                                                                *
  7168*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7169*                                                                *
  7170*   FILE TYPE = VSAM,KSDS                                        *
  7171*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7172*                                                                *
  7173*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7174*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7175*                                                                *
  7176*   LOG = NO                                                     *
  7177*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7178*                                                                *
  7179*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7180******************************************************************
  7181 01  LETTER-ARCHIVE.
  7182     12  LA-RECORD-ID                PIC XX.
  7183         88  VALID-LA-ID                VALUE 'LA'.
  7184
  7185     12  LA-CONTROL-PRIMARY.
  7186         16  LA-COMPANY-CD           PIC X.
  7187         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7188         16  LA-RECORD-TYPE          PIC X.
  7189             88  LA-HEADER-DATA         VALUE '1'.
  7190             88  LA-ADDRESS-DATA        VALUE '2'.
  7191             88  LA-TEXT-DATA           VALUE '3'.
  7192             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7193         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7194
  7195     12  LA-CONTROL-BY-TYPE.
  7196         16  LA-COMPANY-CD-A1        PIC X.
  7197         16  LA-RECORD-TYPE-A1       PIC X.
  7198         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7199         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7200
  7201     12  LA-TEXT-RECORD.
  7202         16  LA-SKIP-CONTROL         PIC XX.
  7203             88  NO-LINES-SKIPPED       VALUE SPACES.
  7204             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7205         16  LA-TEXT-LINE            PIC X(70).
  7206
  7207     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7208         16  FILLER                  PIC XX.
  7209         16  LA-ADDRESS-LINE         PIC X(30).
  7210         16  FILLER                  PIC X(40).
  7211
  7212     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7213         16  FILLER                  PIC XX.
  7214         16  LA-CARRIER              PIC X.
  7215         16  LA-CLAIM-NO             PIC X(7).
  7216         16  LA-CERT-NO.
  7217             20  LA-CERT-PRIME       PIC X(10).
  7218             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 136
* EL156.cbl
  7219         16  LA-NO-OF-COPIES         PIC S9.
  7220         16  LA-RESEND-DATE          PIC XX.
  7221         16  LA-PROCESSOR-CD         PIC X(4).
  7222         16  LA-CREATION-DT          PIC XX.
  7223         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7224         16  LA-RESEND-PRINT-DATE    PIC XX.
  7225         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7226         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7227*
  7228* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7229*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7230*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7231*   I        20  LA-DMD-RES-ST           PIC XX.
  7232*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7233*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7234*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7235*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7236*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7237*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7238*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7239*   I        20  LA-DMD-UND-CODE         PIC XX.
  7240*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7241*   V    16  FILLER                  PIC X(15).
  7242* -----
  7243*
  7244* REINSERTED  CSO  MODS
  7245*
  7246         16  FILLER.
  7247             20  FILLER                  PIC X(29).
  7248             20  LA-CSO-LETTER-STATUS    PIC X.
  7249                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7250                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7251                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7252             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7253             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7254*
  7255
  7256     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7257         16  FILLER                  PIC XX.
  7258         16  LA4-CARRIER             PIC X.
  7259         16  LA4-CLAIM-NO            PIC X(7).
  7260         16  LA4-CERT-NO.
  7261             20  LA4-CERT-PRIME      PIC X(10).
  7262             20  LA4-CERT-SFX        PIC X.
  7263         16  LA4-NO-OF-COPIES        PIC S9.
  7264         16  LA4-RESEND-DATE         PIC XX.
  7265         16  LA4-PROCESSOR-CD        PIC X(4).
  7266         16  LA4-CREATION-DT         PIC XX.
  7267         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7268         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7269         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7270         16  LA4-FORM-TYPE           PIC X.
  7271             88  LA4-INITIAL-FORM    VALUE '1'.
  7272             88  LA4-PROGRESS-FORM   VALUE '2'.
  7273         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7274         16  LA4-STATE               PIC X(02).
  7275         16  FILLER                  PIC X(31).
  7276******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 137
* EL156.cbl
  7278*    COPY ELCDAR.
  7279******************************************************************
  7280*                                                                *
  7281*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7282*   FILE TYPE = VSAM,KSDS                                        *
  7283*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7284*   BASE CLUSTER = DLYACTV                                       *
  7285*   LOG = YES                                                    *
  7286*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7287*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7288*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7289*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7290*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7291*               BY PROGRAM "LGINFCE".                            *
  7292*                                                                *
  7293******************************************************************
  7294 01  DAILY-ACTIVITY-RECORD.
  7295     05  DA-KEY.
  7296         10  DA-COMP-CD          PIC X.
  7297         10  DA-CARRIER          PIC X.
  7298         10  DA-CLAIM-NO         PIC X(7).
  7299         10  DA-CERT-NO.
  7300             15  DA-CERT-PRIME   PIC X(10).
  7301             15  DA-CERT-SFX     PIC X.
  7302     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7303     05  DA-RECORD-TYPE          PIC X.
  7304     05  FILLER                  PIC X(2).
  7305******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 138
* EL156.cbl
  7307*    COPY ERCCOMP.
  7308******************************************************************
  7309*                                                                *
  7310*                                                                *
  7311*                            ERCCOMP                             *
  7312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7313*                            VMOD=2.019                          *
  7314*                                                                *
  7315*   ONLINE CREDIT SYSTEM                                         *
  7316*                                                                *
  7317*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7318*                                                                *
  7319*   FILE TYPE = VSAM,KSDS                                        *
  7320*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7321*                                                                *
  7322*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7323*       ALTERNATE PATH = NONE                                    *
  7324*                                                                *
  7325*   LOG = NO                                                     *
  7326*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7327*                                                                *
  7328******************************************************************
  7329*                   C H A N G E   L O G
  7330*
  7331* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7332*-----------------------------------------------------------------
  7333*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7334* EFFECTIVE    NUMBER
  7335*-----------------------------------------------------------------
  7336* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7337* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7338* 092205    2005050300006  PEMA  ADD LEASE FEE
  7339* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7340* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7341* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7342* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7343* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7344* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7345******************************************************************
  7346
  7347 01  COMPENSATION-MASTER.
  7348     12  CO-RECORD-ID                          PIC XX.
  7349         88  VALID-CO-ID                          VALUE 'CO'.
  7350
  7351     12  CO-CONTROL-PRIMARY.
  7352         16  CO-COMPANY-CD                     PIC X.
  7353         16  CO-CONTROL.
  7354             20  CO-CTL-1.
  7355                 24  CO-CARR-GROUP.
  7356                     28  CO-CARRIER            PIC X.
  7357                     28  CO-GROUPING.
  7358                         32  CO-GROUP-PREFIX   PIC XXX.
  7359                         32  CO-GROUP-PRIME    PIC XXX.
  7360                 24  CO-RESP-NO.
  7361                     28  CO-RESP-PREFIX        PIC X(4).
  7362                     28  CO-RESP-PRIME         PIC X(6).
  7363             20  CO-CTL-2.
  7364                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 139
* EL156.cbl
  7365                     28  CO-ACCT-PREFIX        PIC X(4).
  7366                     28  CO-ACCT-PRIME         PIC X(6).
  7367         16  CO-TYPE                           PIC X.
  7368             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7369             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7370             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7371
  7372     12  CO-MAINT-INFORMATION.
  7373         16  CO-LAST-MAINT-DT                  PIC XX.
  7374         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7375         16  CO-LAST-MAINT-USER                PIC X(4).
  7376     12  FILLER                                PIC XX.
  7377     12  CO-STMT-TYPE                          PIC XXX.
  7378     12  CO-COMP-TYPE                          PIC X.
  7379         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7380     12  CO-STMT-OWNER                         PIC X(4).
  7381     12  CO-BALANCE-CONTROL                    PIC X.
  7382         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7383         88  CO-NO-BALANCE                        VALUE 'N'.
  7384
  7385     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7386         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7387         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7388         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7389
  7390     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7391         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7392         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7393
  7394     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7395     12  CO-GA-DIRECT-DEP                      PIC X.
  7396     12  CO-FUTURE-SPACE                       PIC X.
  7397         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7398
  7399     12  CO-ACCT-NAME                          PIC X(30).
  7400     12  CO-MAIL-NAME                          PIC X(30).
  7401     12  CO-ADDR-1                             PIC X(30).
  7402     12  CO-ADDR-2                             PIC X(30).
  7403     12  CO-ADDR-3.
  7404         16  CO-ADDR-CITY                      PIC X(27).
  7405         16  CO-ADDR-STATE                     PIC XX.
  7406     12  CO-CSO-1099                           PIC X.
  7407     12  CO-ZIP.
  7408         16  CO-ZIP-PRIME.
  7409             20  CO-ZIP-PRI-1ST                PIC X.
  7410                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7411             20  FILLER                        PIC X(4).
  7412         16  CO-ZIP-PLUS4                      PIC X(4).
  7413     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7414         16  CO-CAN-POSTAL-1                   PIC XXX.
  7415         16  CO-CAN-POSTAL-2                   PIC XXX.
  7416         16  FILLER                            PIC XXX.
  7417     12  CO-SOC-SEC                            PIC X(13).
  7418     12  CO-TELEPHONE.
  7419         16  CO-AREA-CODE                      PIC XXX.
  7420         16  CO-PREFIX                         PIC XXX.
  7421         16  CO-PHONE                          PIC X(4).
  7422
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 140
* EL156.cbl
  7423     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7424
  7425     12  CO-AR-BAL-LEVEL                       PIC X.
  7426         88  CO-AR-REF-LVL                        VALUE '1'.
  7427         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7428         88  CO-AR-BILL-LVL                       VALUE '2'.
  7429         88  CO-AR-AGT-LVL                        VALUE '3'.
  7430         88  CO-AR-FR-LVL                         VALUE '4'.
  7431
  7432     12  CO-AR-NORMAL-PRINT                    PIC X.
  7433         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7434         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7435
  7436     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7437
  7438     12  CO-AR-REPORTING                       PIC X.
  7439         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7440         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7441
  7442     12  CO-AR-PULL-CHECK                      PIC X.
  7443         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7444         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7445
  7446     12  CO-AR-BALANCE-PRINT                   PIC X.
  7447         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7448
  7449     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7450         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7451         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7452         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7453
  7454     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7455
  7456     12  CO-USER-CODE                          PIC X.
  7457     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7458
  7459******************************************************************
  7460*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7461*    THE LAST MONTH END RUN.
  7462******************************************************************
  7463
  7464     12  CO-LAST-ACTIVITY-DATE.
  7465         16  CO-ACT-YEAR                       PIC 99.
  7466         16  CO-ACT-MONTH                      PIC 99.
  7467         16  CO-ACT-DAY                        PIC 99.
  7468
  7469     12  CO-LAST-STMT-DT.
  7470         16  CO-LAST-STMT-YEAR                 PIC 99.
  7471         16  CO-LAST-STMT-MONTH                PIC 99.
  7472         16  CO-LAST-STMT-DAY                  PIC 99.
  7473
  7474     12  CO-MO-END-TOTALS.
  7475         16  CO-MONTHLY-TOTALS.
  7476             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7477             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7478             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7479             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7480             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 141
* EL156.cbl
  7481
  7482         16  CO-AGING-TOTALS.
  7483             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7484             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7485             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7486             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7487
  7488         16  CO-YTD-TOTALS.
  7489             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7490             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7491
  7492         16  CO-OVER-UNDER-TOTALS.
  7493             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7494             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7495
  7496     12  CO-MISCELLANEOUS-TOTALS.
  7497         16  CO-FICA-TOTALS.
  7498             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7499             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7500
  7501         16  CO-CLAIM-TOTALS.
  7502             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7503             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7504
  7505******************************************************************
  7506*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7507*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7508******************************************************************
  7509
  7510     12  CO-CURRENT-TOTALS.
  7511         16  CO-CURRENT-LAST-STMT-DT.
  7512             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7513             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7514             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7515
  7516         16  CO-CURRENT-MONTHLY-TOTALS.
  7517             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7518             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7519             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7520             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7521             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7522
  7523         16  CO-CURRENT-AGING-TOTALS.
  7524             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7525             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7526             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7527             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7528
  7529         16  CO-CURRENT-YTD-TOTALS.
  7530             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7531             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7532
  7533     12  CO-PAID-COMM-TOTALS.
  7534         16  CO-YTD-PAID-COMMS.
  7535             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7536             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7537
  7538     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 142
* EL156.cbl
  7539         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7540         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7541
  7542     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7543         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7544         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7545         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7546         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7547         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7548         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7549         88  CO-FINAL-LETTER                  VALUE 'F'.
  7550         88  CO-RECONCILING                   VALUE 'R'.
  7551         88  CO-PHONE-CALL                    VALUE 'P'.
  7552         88  CO-LEGAL                         VALUE 'L'.
  7553         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7554         88  CO-WRITE-OFF                     VALUE 'W'.
  7555         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7556
  7557     12  CO-CSR-CODE                       PIC X(4).
  7558
  7559     12  CO-GA-STATUS-INFO.
  7560         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7561         16  CO-GA-TERMINATION-DT          PIC XX.
  7562         16  CO-GA-STATUS-CODE             PIC X.
  7563             88  CO-GA-ACTIVE                 VALUE 'A'.
  7564             88  CO-GA-INACTIVE               VALUE 'I'.
  7565             88  CO-GA-PENDING                VALUE 'P'.
  7566         16  CO-GA-COMMENTS.
  7567             20  CO-GA-COMMENT-1           PIC X(40).
  7568             20  CO-GA-COMMENT-2           PIC X(40).
  7569             20  CO-GA-COMMENT-3           PIC X(40).
  7570             20  CO-GA-COMMENT-4           PIC X(40).
  7571
  7572     12  CO-RPTCD2                         PIC X(10).
  7573     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7574         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7575         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7576
  7577     12  CO-TYPE-AGENT                     PIC X(01).
  7578         88  CO-CORPORATION                   VALUE 'C'.
  7579         88  CO-PARTNERSHIP                   VALUE 'P'.
  7580         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7581         88  CO-TRUST                         VALUE 'T'.
  7582         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7583
  7584     12  CO-FAXNO.
  7585         16  CO-FAX-AREA-CODE                  PIC XXX.
  7586         16  CO-FAX-PREFIX                     PIC XXX.
  7587         16  CO-FAX-PHONE                      PIC X(4).
  7588
  7589     12  CO-BANK-INFORMATION.
  7590         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7591         16  CO-BANK-TRANSIT-NON REDEFINES
  7592             CO-BANK-TRANSIT-NO                PIC 9(8).
  7593
  7594         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7595     12  CO-MISC-DEDUCT-INFO REDEFINES
  7596                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 143
* EL156.cbl
  7597         16  CO-MD-GL-ACCT                     PIC X(10).
  7598         16  CO-MD-DIV                         PIC XX.
  7599         16  CO-MD-CENTER                      PIC X(4).
  7600         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7601         16  CO-CREATE-AP-CHECK                PIC X.
  7602         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7603         16  FILLER                            PIC XXX.
  7604     12  CO-ACH-STATUS                         PIC X.
  7605         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7606         88  CO-ACH-PENDING                        VALUE 'P'.
  7607
  7608     12  CO-BILL-SW                            PIC X.
  7609     12  CO-CONTROL-NAME                       PIC X(30).
  7610     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7611     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7612     12  CO-CLP-STATE                          PIC XX.
  7613     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7614     12  CO-SPP-REFUND-EDIT                    PIC X.
  7615
  7616******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 144
* EL156.cbl
  7618*    COPY ERCDMDNT.
  7619******************************************************************
  7620*                                                                *
  7621*                            ERCDMDNT                            *
  7622*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7623*                            VMOD=2.005                          *
  7624*                                                                *
  7625*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7626*                                                                *
  7627*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7628*                                                                *
  7629*        FILE TYPE= VSAM,KSDS                                    *
  7630*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7631*                                                                *
  7632*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7633*                                                                *
  7634*        LOG = YES                                               *
  7635*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7636*                                                                *
  7637******************************************************************
  7638
  7639 01  CERTIFICATE-NOTE.
  7640     12  CN-RECORD-ID                     PIC  XX.
  7641         88  VALID-CN-ID                      VALUE 'CN'.
  7642
  7643     12  CN-CONTROL-PRIMARY.
  7644         16  CN-COMPANY-CD                PIC X.
  7645         16  CN-CERT-KEY.
  7646             20  CN-CARRIER               PIC X.
  7647             20  CN-GROUPING.
  7648                 24  CN-GROUPING-PREFIX   PIC XXX.
  7649                 24  CN-GROUPING-PRIME    PIC XXX.
  7650             20  CN-STATE                 PIC XX.
  7651             20  CN-ACCOUNT.
  7652                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7653                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7654             20  CN-CERT-EFF-DT           PIC XX.
  7655             20  CN-CERT-NO.
  7656                 24  CN-CERT-PRIME        PIC X(10).
  7657                 24  CN-CERT-SFX          PIC X.
  7658
  7659     12  CN-BILLING-START-LINE-NO         PIC 99.
  7660     12  CN-BILLING-END-LINE-NO           PIC 99.
  7661
  7662     12  CN-LINES.
  7663         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7664
  7665     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7666         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7667         16  CN-CSI-GENERAL-DATA-AREA.
  7668             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7669
  7670         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7671             CN-CSI-GENERAL-DATA-AREA.
  7672             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7673             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7674             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7675             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 145
* EL156.cbl
  7676             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7677             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7678             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7679             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7680             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7681             20  FILLER                       PIC XX.
  7682             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7683             20  FILLER                       PIC X(38).
  7684
  7685         16  CN-CSI-PRODUCT-DATA-AREA.
  7686             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7687
  7688         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7689             CN-CSI-PRODUCT-DATA-AREA.
  7690             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7691             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7692             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7693             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7694             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7695             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7696             20  FILLER                   PIC XX.
  7697             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7698             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7699             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7700             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7701             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7702             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7703             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7704             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7705             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7706             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7707             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7708             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7709             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7710             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7711             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7712             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7713             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7714             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7715             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7716             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7717             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7718             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7719             20  FILLER                   PIC X(25).
  7720
  7721         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7722             CN-CSI-CREDIT-CARD-DATA.
  7723             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7724             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7725             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7726             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7727             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7728             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7729             20  FILLER                   PIC XX.
  7730             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7731             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7732             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7733             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 146
* EL156.cbl
  7734             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7735             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7736             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7737             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7738             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7739             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7740             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7741             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7742             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7743             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7744             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7745             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7746             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7747             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7748             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7749             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7750             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7751             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7752             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7753             20  FILLER                   PIC X(17).
  7754
  7755         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7756             CN-CSI-FAMILY-LEAVE-DATA.
  7757             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7758             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7759             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7760             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7761             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7762             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7763             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7764             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7765             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7766             20  CN-CSI-SL-INT-ON-PROCEEDS
  7767                                          PIC S9(5)V99  COMP-3.
  7768             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7769             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7770             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7771             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7772             20  CN-CSI-SL-POLICY-BENEFITS
  7773                                          PIC S9(5)V99  COMP-3.
  7774             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7775             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7776             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7777             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7778             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7779             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7780             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7781             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7782             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7783             20  CN-CSI-SL-STATE-NOT      PIC X.
  7784             20  FILLER                   PIC XX.
  7785
  7786         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7787             CN-CSI-SENIOR-LIFE-DATA.
  7788             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7789             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7790             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7791                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 147
* EL156.cbl
  7792             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7793             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7794             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7795             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7796             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7797             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7798             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7799             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7800             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7801             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7802             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7803             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7804             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7805             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7806             20  CN-CSI-PP-REPAIR         PIC X.
  7807             20  CN-CSI-PP-REPLACE        PIC X.
  7808             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7809             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7810             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7811             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7812             20  FILLER                   PIC X(5).
  7813
  7814         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7815             CN-CSI-PURCH-PROP-DATA.
  7816             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7817             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7818             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7819             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7820             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7821             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7822             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7823             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7824             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7825             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7826             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7827             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7828             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7829             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7830             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7831             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7832             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7833             20  CN-CSI-EW-REPLACE        PIC X.
  7834             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7835             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7836             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7837             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7838             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7839             20  FILLER                   PIC X(4).
  7840
  7841     12  CN-LAST-MAINT-DT                 PIC XX.
  7842     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7843     12  CN-LAST-MAINT-USER               PIC X(4).
  7844     12  FILLER                           PIC X(6).
  7845
  7846******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 148
* EL156.cbl
  7848*    COPY ERCCNOT.
  7849******************************************************************
  7850*                                                                *
  7851*                            ERCCNOT                             *
  7852*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7853*                            VMOD=2.003                          *
  7854*                                                                *
  7855*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7856*                                                                *
  7857*        FILE TYPE= VSAM,KSDS                                    *
  7858*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7859*                                                                *
  7860*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7861*                                                                *
  7862*        LOG = YES                                               *
  7863*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7864*                                                                *
  7865******************************************************************
  7866*                   C H A N G E   L O G
  7867*
  7868* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7869*-----------------------------------------------------------------
  7870*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7871* EFFECTIVE    NUMBER
  7872*-----------------------------------------------------------------
  7873* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7874******************************************************************
  7875
  7876 01  CERT-NOTE-FILE.
  7877     12  CZ-RECORD-ID                PIC  XX.
  7878         88  VALID-CZ-ID                  VALUE 'CZ'.
  7879
  7880     12  CZ-CONTROL-PRIMARY.
  7881         16  CZ-COMPANY-CD           PIC X.
  7882         16  CZ-CARRIER              PIC X.
  7883         16  CZ-GROUPING.
  7884             20 CZ-GROUPING-PREFIX   PIC XXX.
  7885             20 CZ-GROUPING-PRIME    PIC XXX.
  7886         16  CZ-STATE                PIC XX.
  7887         16  CZ-ACCOUNT.
  7888             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7889             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7890         16  CZ-CERT-EFF-DT          PIC XX.
  7891         16  CZ-CERT-NO.
  7892             20  CZ-CERT-PRIME       PIC X(10).
  7893             20  CZ-CERT-SFX         PIC X.
  7894         16  CZ-RECORD-TYPE          PIC X.
  7895             88  CERT-NOTE           VALUE '1'.
  7896             88  CLAIM-CERT-NOTE     VALUE '2'.
  7897         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7898
  7899     12  CZ-LAST-MAINT-DT            PIC XX.
  7900     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7901     12  CZ-LAST-MAINT-USER          PIC X(4).
  7902
  7903     12  CZ-NOTE-INFORMATION.
  7904         16  CZ-NOTE                 PIC X(63).
  7905         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 149
* EL156.cbl
  7906******************************************************************
  7907*                            COPY ERCPDEF.
  7908******************************************************************
  7909*                                                                *
  7910*                                                                *
  7911*                            ERCPDEF.                            *
  7912*                                                                *
  7913*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7914*                                                                *
  7915*    FILE TYPE = VSAM,KSDS                                       *
  7916*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7917*                                                                *
  7918*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7919*                                                                *
  7920*    LOG = YES                                                   *
  7921*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7922******************************************************************
  7923*                   C H A N G E   L O G
  7924*
  7925* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7926*-----------------------------------------------------------------
  7927*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7928* EFFECTIVE    NUMBER
  7929*-----------------------------------------------------------------
  7930* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7931* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7932******************************************************************
  7933 01  PRODUCT-MASTER.
  7934    12  PD-RECORD-ID                 PIC X(02).
  7935        88  VALID-PD-ID                  VALUE 'PD'.
  7936    12  PD-CONTROL-PRIMARY.
  7937        16  PD-COMPANY-CD            PIC X.
  7938        16  PD-STATE                 PIC XX.
  7939        16  PD-PRODUCT-CD            PIC XXX.
  7940        16  PD-FILLER                PIC X(7).
  7941        16  PD-BEN-TYPE              PIC X.
  7942        16  PD-BEN-CODE              PIC XX.
  7943        16  PD-PROD-EXP-DT           PIC XX.
  7944    12  FILLER                       PIC X(50).
  7945    12  PD-PRODUCT-DATA OCCURS 8.
  7946        16  PD-PROD-CODE             PIC X.
  7947            88  PD-PROD-LIFE           VALUE 'L'.
  7948            88  PD-PROD-PROP           VALUE 'P'.
  7949            88  PD-PROD-AH             VALUE 'A'.
  7950            88  PD-PROD-IU             VALUE 'I'.
  7951            88  PD-PROD-GAP            VALUE 'G'.
  7952            88  PD-PROD-FAML           VALUE 'F'.
  7953        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7954        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7955        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7956        16  PD-MAX-TERM              PIC S999        COMP-3.
  7957        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7958        16  FILLER                   PIC X.
  7959        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7960        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7961        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7962        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  7963        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 150
* EL156.cbl
  7964        16  PD-REC-CRIT-PERIOD       PIC 99.
  7965        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  7966            20  PD-RECURRING-YN      PIC X.
  7967            20  FILLER               PIC X.
  7968        16  PD-RTW-MOS               PIC 99.
  7969        16  PD-MAX-EXTENSION         PIC 99.
  7970        16  FILLER                   PIC XX.
  7971    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7972    12  PD-TERM-LIMITS OCCURS 15.
  7973        16  PD-LOW-TERM              PIC S999        COMP-3.
  7974        16  PD-HI-TERM               PIC S999        COMP-3.
  7975*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7976    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7977        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7978        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  7979    12  PD-EARN-FACTORS.
  7980        16  FILLER OCCURS 15.
  7981            20  FILLER OCCURS 15.
  7982                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7983    12  PD-PRODUCT-DESC              PIC X(80).
  7984    12  PD-TRUNCATED                 PIC X.
  7985    12  FILLER                       PIC X(59).
  7986    12  PD-MAINT-INFORMATION.
  7987        16  PD-LAST-MAINT-DT         PIC X(02).
  7988        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7989        16  PD-LAST-MAINT-BY         PIC X(04).
  7990*                            COPY ELCCRTT.
  7991******************************************************************
  7992*                                                                *
  7993*                            ELCCRTT.                            *
  7994*                                                                *
  7995*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7996*                                                                *
  7997*   FILE TYPE = VSAM,KSDS                                        *
  7998*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7999*                                                                *
  8000*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8001*                                                                *
  8002*   LOG = YES                                                    *
  8003*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8004******************************************************************
  8005*                   C H A N G E   L O G
  8006*
  8007* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8008*-----------------------------------------------------------------
  8009*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8010* EFFECTIVE    NUMBER
  8011*-----------------------------------------------------------------
  8012* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8013* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8014* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8015* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8016* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8017* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8018* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8019******************************************************************
  8020
  8021 01  CERTIFICATE-TRAILERS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 151
* EL156.cbl
  8022     12  CS-RECORD-ID                      PIC XX.
  8023         88  VALID-CS-ID                      VALUE 'CS'.
  8024
  8025     12  CS-CONTROL-PRIMARY.
  8026         16  CS-COMPANY-CD                 PIC X.
  8027         16  CS-CARRIER                    PIC X.
  8028         16  CS-GROUPING                   PIC X(6).
  8029         16  CS-STATE                      PIC XX.
  8030         16  CS-ACCOUNT                    PIC X(10).
  8031         16  CS-CERT-EFF-DT                PIC XX.
  8032         16  CS-CERT-NO.
  8033             20  CS-CERT-PRIME             PIC X(10).
  8034             20  CS-CERT-SFX               PIC X.
  8035         16  CS-TRAILER-TYPE               PIC X.
  8036             88  COMM-TRLR           VALUE 'A'.
  8037             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8038             88  CERT-DATA-TRLR      VALUE 'C'.
  8039
  8040     12  CS-DATA-AREA                      PIC X(516).
  8041
  8042     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8043         16  CS-BANK-COMMISSION-AREA.
  8044             20  CS-BANK-COMMS       OCCURS 10.
  8045                 24  CS-AGT                PIC X(10).
  8046                 24  CS-COM-TYP            PIC X.
  8047                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8048                 24  CS-RECALC-LV-INDIC    PIC X.
  8049                 24  FILLER                PIC X(10).
  8050         16  FILLER                        PIC X(256).
  8051
  8052     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8053****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8054         16  CS-MB-CLAIM-DATA OCCURS 24.
  8055             20  CS-CLAIM-NO               PIC X(7).
  8056             20  CS-CLAIM-TYPE             PIC X.
  8057                 88  CS-AH-CLM               VALUE 'A'.
  8058                 88  CS-IU-CLM               VALUE 'I'.
  8059                 88  CS-GP-CLM               VALUE 'G'.
  8060                 88  CS-LF-CLM               VALUE 'L'.
  8061                 88  CS-PR-CLM               VALUE 'P'.
  8062                 88  CS-FL-CLM               VALUE 'F'.
  8063             20  CS-INSURED-TYPE           PIC X.
  8064                 88  CS-PRIM-INSURED          VALUE 'P'.
  8065                 88  CS-CO-BORROWER           VALUE 'C'.
  8066             20  CS-BENEFIT-PERIOD         PIC 99.
  8067             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8068             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8069             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8070         16  FILLER                        PIC X(12).
  8071     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8072         16  CS-VIN-NUMBER                 PIC X(17).
  8073         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8074         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8075         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8076         16  FILLER                        PIC X(496).
  8077 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8078                          CONTROL-FILE CERTIFICATE-MASTER
  8079                          ACTIVITY-TRAILERS ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 152
* EL156.cbl
  8080                          ACCOUNT-MASTER CHECK-QUE
  8081                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8082                          DAILY-ACTIVITY-RECORD
  8083                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8084                          CERT-NOTE-FILE PRODUCT-MASTER
  8085                          CERTIFICATE-TRAILERS.
  8086 0000-DFHEXIT SECTION.
  8087     MOVE '9#                    $   ' TO DFHEIV0.
  8088     MOVE 'EL156' TO DFHEIV1.
  8089     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8090
  8091     IF EIBCALEN = 0
  8092         GO TO 8800-UNAUTHORIZED-ACCESS.
  8093
  8094     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8095     MOVE EIBTRMID               TO QID-TERM.
  8096     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8097     MOVE '2'                    TO EMI-SWITCH2.
  8098     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8099     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8100
  8101     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8102     MOVE '5'                    TO DC-OPTION-CODE.
  8103     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8104     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8105                                    SAVE-BIN-DATE.
  8106     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8107     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8108
  8109     IF SAVE-DATE-YY > 70
  8110         MOVE 19                 TO SAVE-DATE-CC
  8111     ELSE
  8112         MOVE 20                 TO SAVE-DATE-CC.
  8113
  8114     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8115         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8116     END-IF.
  8117
  8118     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8119        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8120     ELSE
  8121        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8122     END-IF
  8123
  8124     IF PI-PRINT-CLM-FRM-YN = 'N'
  8125         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8126     ELSE
  8127         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8128     END-IF
  8129
  8130     IF PI-PRINT-SURVEY-YN = 'N'
  8131         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8132     ELSE
  8133         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8134     END-IF
  8135
  8136     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8137         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 153
* EL156.cbl
  8138     ELSE
  8139         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8140     END-IF
  8141
  8142* EXEC CICS HANDLE CONDITION
  8143*        NOTOPEN   (9990-ABEND)
  8144*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8145*        MAPFAIL   (0400-FIRST-TIME)
  8146*        DUPREC    (6180-DUPREC)
  8147*        ERROR     (9990-ABEND)
  8148*    END-EXEC.
  8149*    MOVE '"$JL?%.               ! " #00008137' TO DFHEIV0
  8150     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8152     MOVE X'2220233030303038313337' TO DFHEIV0(25:11)
  8153     CALL 'kxdfhei1' USING DFHEIV0
  8154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8155
  8156
  8157     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8158         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8159
  8160     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8161         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8162             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8163             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8164             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8165             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8166             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8167             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8168             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8169             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8170             MOVE LOW-VALUES           TO EL156AI
  8171             MOVE 'Y'                  TO FIRST-ENTRY
  8172         ELSE
  8173             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8174             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8175             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8176             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8177             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8178             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8179             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8180             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8181
  8182     IF RETURNED-FROM NOT = SPACES
  8183        IF (RETURNED-FROM = 'EL614')
  8184           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8185           IF WS-SAVED-EOB-CODES NOT = SPACES
  8186              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8187           ELSE
  8188              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8189           END-IF
  8190        END-IF
  8191         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8192            MOVE 'Y'             TO FIRST-ENTRY
  8193            IF RETURNED-FROM = 'EL614'
  8194               AND (PI-PASS-SW NOT = 'C')
  8195               IF WS-SAVED-EOB-CODES NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 154
* EL156.cbl
  8196                  MOVE WS-SAVED-EOB-CODES
  8197                                 TO PI-PMTNOTE2
  8198                                    WS-PMTNOTE2
  8199                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8200               ELSE
  8201                  MOVE SPACES    TO PI-PMTNOTE2
  8202                                    WS-PMTNOTE2
  8203                                    PI-EOB-CODES-EXIST
  8204               END-IF
  8205            END-IF
  8206            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8207            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8208            IF RETURNED-FROM = 'EL614'
  8209               GO TO 1000-EDIT-DATA
  8210            END-IF
  8211            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8212               (PAYEEI   = LOW-VALUES OR SPACES)
  8213               GO TO 8100-SEND-INITIAL-MAP
  8214            ELSE
  8215               GO TO 1000-EDIT-DATA.
  8216
  8217     IF EIBTRNID NOT = TRANS-ID
  8218         GO TO 0400-FIRST-TIME.
  8219
  8220     IF EIBAID = DFHCLEAR
  8221        IF PI-PASS-SW = 'C'
  8222           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8223           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8224           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8225           MOVE 'Y'            TO RETURNED-FROM-B
  8226           GO TO 1000-EDIT-DATA
  8227        ELSE
  8228           GO TO 9400-CLEAR.
  8229
  8230     IF PI-PASS-SW = 'C'
  8231         MOVE MAP-NAMEB          TO MAP-NAME
  8232         IF EIBAID = DFHPF1 OR DFHPF13
  8233             GO TO 5000-UPDATE
  8234           ELSE
  8235             IF EIBAID NOT = DFHENTER
  8236                 MOVE LOW-VALUES TO EL156BI
  8237                 MOVE MAP-NAMEB  TO MAP-NAME
  8238                 MOVE ER-0029    TO EMI-ERROR
  8239                 MOVE -1         TO  ENTPFBL
  8240                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8241                 GO TO 8200-SEND-DATAONLY.
  8242
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 155
* EL156.cbl
  8244 0200-RECEIVE.
  8245     MOVE LOW-VALUES             TO EL156AI.
  8246     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8247         MOVE ER-0008            TO EMI-ERROR
  8248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8249         IF PI-PASS-SW = 'C'
  8250             MOVE -1             TO ENTPFBL
  8251             GO TO 8200-SEND-DATAONLY
  8252         ELSE
  8253             MOVE -1             TO PMTTYPEL
  8254             GO TO 8200-SEND-DATAONLY.
  8255
  8256     IF PI-COMPANY-ID = 'DMD'
  8257         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8258
  8259     IF PI-PASS-SW = 'C'
  8260         MOVE MAP-NAMEB          TO MAP-NAME.
  8261
  8262
  8263* EXEC CICS RECEIVE
  8264*        MAP   (MAP-NAME)
  8265*        MAPSET(MAPSET-NAME)
  8266*        ASIS
  8267*        INTO  (EL156AI)
  8268*    END-EXEC.
  8269     MOVE LENGTH OF
  8270      EL156AI
  8271       TO DFHEIV11
  8272*    MOVE '8"TAI  L              ''   #00008250' TO DFHEIV0
  8273     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8275     MOVE X'2020233030303038323530' TO DFHEIV0(25:11)
  8276     CALL 'kxdfhei1' USING DFHEIV0,
  8277           MAP-NAME,
  8278           EL156AI,
  8279           DFHEIV11,
  8280           MAPSET-NAME,
  8281           DFHEIV99,
  8282           DFHEIV99
  8283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8284
  8285
  8286     IF PI-PASS-SW NOT = 'C'
  8287         GO TO 0250-MAPA.
  8288
  8289     IF ENTPFBL NOT > ZERO
  8290         MOVE MAP-NAMEB          TO MAP-NAME
  8291         MOVE ER-0029            TO EMI-ERROR
  8292         MOVE -1                 TO  ENTPFBL
  8293         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8294         GO TO 8200-SEND-DATAONLY.
  8295
  8296     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8297         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8298       ELSE
  8299         MOVE MAP-NAMEB           TO MAP-NAME
  8300         MOVE ER-0029             TO EMI-ERROR
  8301         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 156
* EL156.cbl
  8302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8303         GO TO 8200-SEND-DATAONLY.
  8304
  8305     IF EIBAID = DFHPF1 OR DFHPF13
  8306         IF MODIFY-CAP
  8307            GO TO 5000-UPDATE
  8308          ELSE
  8309            MOVE 'UPDATE'           TO SM-READ
  8310            PERFORM 9995-SECURITY-VIOLATION
  8311            MOVE MAP-NAMEB          TO MAP-NAME
  8312            MOVE ER-0070            TO EMI-ERROR
  8313            MOVE -1                 TO  ENTPFBL
  8314            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8315            GO TO 8200-SEND-DATAONLY.
  8316
  8317 0250-MAPA.
  8318     IF ENTERPFL = 0
  8319         GO TO 0300-CHECK-PFKEYS.
  8320
  8321     IF EIBAID NOT = DFHENTER
  8322         MOVE ER-0004            TO EMI-ERROR
  8323         GO TO 0320-INPUT-ERROR.
  8324
  8325     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8326         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8327     ELSE
  8328         MOVE ER-0029            TO EMI-ERROR
  8329         GO TO 0320-INPUT-ERROR.
  8330
  8331 0300-CHECK-PFKEYS.
  8332     IF EIBAID = DFHPF7 OR DFHPF8
  8333         GO TO 8820-PF7-8.
  8334
  8335     IF EIBAID = DFHPF23
  8336         GO TO 8810-PF23.
  8337
  8338     IF EIBAID = DFHPF24
  8339         GO TO 9200-RETURN-MAIN-MENU.
  8340
  8341     IF EIBAID = DFHPF12
  8342         GO TO 9500-PF12.
  8343
  8344     IF EIBAID = DFHPF1
  8345        IF PI-PASS-SW = 'A' OR 'B'
  8346          GO TO 0330-BROWSE-FORWARD.
  8347
  8348     IF EIBAID = DFHPF2
  8349        IF PI-PASS-SW = 'A' OR 'B'
  8350          GO TO 0350-BROWSE-BACKWARD.
  8351
  8352     IF EIBAID = DFHPF6
  8353        IF PI-EOB-CODES-EXIST = 'Y'
  8354           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8355        ELSE
  8356           MOVE SPACES              TO WS-PMTNOTE2
  8357        END-IF
  8358         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8359         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 157
* EL156.cbl
  8360            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8361         END-IF
  8362         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8363         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8364             MOVE 'EL614'        TO PGM-NAME
  8365             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8366             GO TO 9300-XCTL
  8367         ELSE
  8368             MOVE XCTL-157       TO PGM-NAME
  8369             GO TO 9300-XCTL.
  8370
  8371     IF EIBAID = DFHPF9
  8372        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8373        MOVE XCTL-141            TO PGM-NAME
  8374        GO TO 9300-XCTL.
  8375
  8376     IF EIBAID = DFHPF10
  8377        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8378        MOVE XCTL-155            TO PGM-NAME
  8379        GO TO 9300-XCTL.
  8380
  8381     MOVE SPACES                 TO ERRMSG0O
  8382                                    ERRMSG1O
  8383                                    ERRMSG2O.
  8384
  8385     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8386         IF PI-PASS-SW NOT = 'B'
  8387             MOVE ER-0422        TO EMI-ERROR
  8388             GO TO 0320-INPUT-ERROR
  8389           ELSE
  8390             GO TO 0700-TEST-FOR-CHANGES.
  8391
  8392     IF EIBAID = DFHPF11
  8393        IF PI-PASS-SW = 'C'
  8394           MOVE ER-0029          TO EMI-ERROR
  8395           GO TO 0320-INPUT-ERROR.
  8396
  8397     IF EIBAID = DFHENTER OR DFHPF11
  8398        NEXT SENTENCE
  8399     ELSE
  8400        MOVE ER-0029             TO EMI-ERROR
  8401        GO TO 0320-INPUT-ERROR.
  8402
  8403     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8404
  8405     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8406         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8407         GO TO 1000-EDIT-DATA
  8408     ELSE
  8409         IF PI-FATAL-COUNT NOT = 0 OR
  8410            PI-FORCE-COUNT NOT = 0
  8411             GO TO 1000-EDIT-DATA
  8412         ELSE
  8413             GO TO 2000-EDIT-DONE.
  8414
  8415 0320-INPUT-ERROR.
  8416     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8417
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 158
* EL156.cbl
  8418     IF ENTERPFL = 0
  8419         MOVE -1                 TO PMTTYPEL
  8420     ELSE
  8421         MOVE AL-UNBON           TO ENTERPFA
  8422         MOVE -1                 TO ENTERPFL.
  8423
  8424     GO TO 8200-SEND-DATAONLY.
  8425
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 159
* EL156.cbl
  8427 0330-BROWSE-FORWARD.
  8428
  8429     MOVE CLMNOI            TO PI-CLAIM-NO.
  8430     MOVE CARRI             TO PI-CARRIER.
  8431     MOVE CERTNOI           TO PI-CERT-PRIME.
  8432     MOVE SUFXI             TO PI-CERT-SFX.
  8433
  8434     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8435     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8436     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8437     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8438
  8439     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8440
  8441
  8442* EXEC CICS HANDLE CONDITION
  8443*         NOTFND   (0380-CLAIM-END-FILE)
  8444*         ENDFILE  (0380-CLAIM-END-FILE)
  8445*    END-EXEC.
  8446*    MOVE '"$I''                  ! # #00008412' TO DFHEIV0
  8447     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8449     MOVE X'2320233030303038343132' TO DFHEIV0(25:11)
  8450     CALL 'kxdfhei1' USING DFHEIV0
  8451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8452
  8453
  8454
  8455* EXEC CICS STARTBR
  8456*         DATASET    ('ELMSTR')
  8457*         RIDFLD     (ELMSTR-KEY)
  8458*         GTEQ
  8459*    END-EXEC.
  8460     MOVE 'ELMSTR' TO DFHEIV1
  8461     MOVE 0
  8462       TO DFHEIV11
  8463*    MOVE '&,         G          &   #00008417' TO DFHEIV0
  8464     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8465     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8466     MOVE X'2020233030303038343137' TO DFHEIV0(25:11)
  8467     CALL 'kxdfhei1' USING DFHEIV0,
  8468           DFHEIV1,
  8469           ELMSTR-KEY,
  8470           DFHEIV99,
  8471           DFHEIV11,
  8472           DFHEIV99
  8473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8474
  8475
  8476     MOVE 'Y' TO WS-BROWSE-START-SW.
  8477
  8478 0335-READNEXT.
  8479
  8480
  8481* EXEC CICS READNEXT
  8482*         DATASET    ('ELMSTR')
  8483*         RIDFLD     (ELMSTR-KEY)
  8484*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 160
* EL156.cbl
  8485*    END-EXEC.
  8486     MOVE 'ELMSTR' TO DFHEIV1
  8487     MOVE 0
  8488       TO DFHEIV11
  8489*    MOVE '&.S                   )   #00008427' TO DFHEIV0
  8490     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8491     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8492     MOVE X'2020233030303038343237' TO DFHEIV0(25:11)
  8493     CALL 'kxdfhei1' USING DFHEIV0,
  8494           DFHEIV1,
  8495           DFHEIV20,
  8496           DFHEIV99,
  8497           ELMSTR-KEY,
  8498           DFHEIV99,
  8499           DFHEIV11,
  8500           DFHEIV99,
  8501           DFHEIV99
  8502     SET ADDRESS OF CLAIM-MASTER TO
  8503         DFHEIV20
  8504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8505
  8506
  8507     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8508        GO TO 0380-CLAIM-END-FILE.
  8509
  8510     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8511        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8512        GO TO 0335-READNEXT.
  8513
  8514     IF PI-COMPANY-ID = 'CRI'
  8515         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8516            GO TO 0380-CLAIM-END-FILE.
  8517
  8518     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8519         GO TO 0335-READNEXT.
  8520
  8521     IF PI-CARRIER-SECURITY > SPACES
  8522         IF CL-CARRIER = PI-CARRIER-SECURITY
  8523             NEXT SENTENCE
  8524         ELSE
  8525             GO TO 0335-READNEXT.
  8526
  8527     IF PI-ACCOUNT-SECURITY > SPACES
  8528         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8529             NEXT SENTENCE
  8530         ELSE
  8531             GO TO 0335-READNEXT.
  8532
  8533     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8534     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8535     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8536
  8537     GO TO 0400-FIRST-TIME.
  8538
  8539 0350-BROWSE-BACKWARD.
  8540
  8541     MOVE CLMNOI            TO PI-CLAIM-NO
  8542                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 161
* EL156.cbl
  8543     MOVE CARRI             TO PI-CARRIER.
  8544     MOVE CERTNOI           TO PI-CERT-PRIME.
  8545     MOVE SUFXI             TO PI-CERT-SFX.
  8546
  8547     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8548
  8549     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8550     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8551     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8552
  8553
  8554* EXEC CICS HANDLE CONDITION
  8555*         NOTFND   (0380-CLAIM-END-FILE)
  8556*         ENDFILE  (0380-CLAIM-END-FILE)
  8557*    END-EXEC.
  8558*    MOVE '"$I''                  ! $ #00008479' TO DFHEIV0
  8559     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8561     MOVE X'2420233030303038343739' TO DFHEIV0(25:11)
  8562     CALL 'kxdfhei1' USING DFHEIV0
  8563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8564
  8565
  8566
  8567* EXEC CICS STARTBR
  8568*         DATASET    ('ELMSTR')
  8569*         RIDFLD     (ELMSTR-KEY)
  8570*         GTEQ
  8571*    END-EXEC.
  8572     MOVE 'ELMSTR' TO DFHEIV1
  8573     MOVE 0
  8574       TO DFHEIV11
  8575*    MOVE '&,         G          &   #00008484' TO DFHEIV0
  8576     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8577     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8578     MOVE X'2020233030303038343834' TO DFHEIV0(25:11)
  8579     CALL 'kxdfhei1' USING DFHEIV0,
  8580           DFHEIV1,
  8581           ELMSTR-KEY,
  8582           DFHEIV99,
  8583           DFHEIV11,
  8584           DFHEIV99
  8585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8586
  8587
  8588     MOVE 'Y' TO WS-BROWSE-START-SW.
  8589
  8590
  8591* EXEC CICS READNEXT
  8592*         DATASET    ('ELMSTR')
  8593*         RIDFLD     (ELMSTR-KEY)
  8594*         SET        (ADDRESS OF CLAIM-MASTER)
  8595*    END-EXEC.
  8596     MOVE 'ELMSTR' TO DFHEIV1
  8597     MOVE 0
  8598       TO DFHEIV11
  8599*    MOVE '&.S                   )   #00008492' TO DFHEIV0
  8600     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 162
* EL156.cbl
  8601     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8602     MOVE X'2020233030303038343932' TO DFHEIV0(25:11)
  8603     CALL 'kxdfhei1' USING DFHEIV0,
  8604           DFHEIV1,
  8605           DFHEIV20,
  8606           DFHEIV99,
  8607           ELMSTR-KEY,
  8608           DFHEIV99,
  8609           DFHEIV11,
  8610           DFHEIV99,
  8611           DFHEIV99
  8612     SET ADDRESS OF CLAIM-MASTER TO
  8613         DFHEIV20
  8614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8615
  8616
  8617
  8618* EXEC CICS READPREV
  8619*         DATASET    ('ELMSTR')
  8620*         RIDFLD     (ELMSTR-KEY)
  8621*         SET        (ADDRESS OF CLAIM-MASTER)
  8622*    END-EXEC.
  8623     MOVE 'ELMSTR' TO DFHEIV1
  8624     MOVE 0
  8625       TO DFHEIV11
  8626*    MOVE '&0S                   )   #00008498' TO DFHEIV0
  8627     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8628     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8629     MOVE X'2020233030303038343938' TO DFHEIV0(25:11)
  8630     CALL 'kxdfhei1' USING DFHEIV0,
  8631           DFHEIV1,
  8632           DFHEIV20,
  8633           DFHEIV99,
  8634           ELMSTR-KEY,
  8635           DFHEIV99,
  8636           DFHEIV11,
  8637           DFHEIV99,
  8638           DFHEIV99
  8639     SET ADDRESS OF CLAIM-MASTER TO
  8640         DFHEIV20
  8641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8642
  8643
  8644 0360-BROWSE-BACKWARD.
  8645
  8646
  8647* EXEC CICS READPREV
  8648*         DATASET    ('ELMSTR')
  8649*         RIDFLD     (ELMSTR-KEY)
  8650*         SET        (ADDRESS OF CLAIM-MASTER)
  8651*    END-EXEC.
  8652     MOVE 'ELMSTR' TO DFHEIV1
  8653     MOVE 0
  8654       TO DFHEIV11
  8655*    MOVE '&0S                   )   #00008506' TO DFHEIV0
  8656     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8657     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8658     MOVE X'2020233030303038353036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 163
* EL156.cbl
  8659     CALL 'kxdfhei1' USING DFHEIV0,
  8660           DFHEIV1,
  8661           DFHEIV20,
  8662           DFHEIV99,
  8663           ELMSTR-KEY,
  8664           DFHEIV99,
  8665           DFHEIV11,
  8666           DFHEIV99,
  8667           DFHEIV99
  8668     SET ADDRESS OF CLAIM-MASTER TO
  8669         DFHEIV20
  8670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8671
  8672
  8673     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8674        GO TO 0380-CLAIM-END-FILE.
  8675
  8676     IF PI-COMPANY-ID = 'CRI'
  8677         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8678            GO TO 0380-CLAIM-END-FILE.
  8679
  8680     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8681         GO TO 0360-BROWSE-BACKWARD.
  8682
  8683     IF PI-CARRIER-SECURITY > SPACES
  8684         IF CL-CARRIER = PI-CARRIER-SECURITY
  8685             NEXT SENTENCE
  8686         ELSE
  8687             GO TO 0360-BROWSE-BACKWARD.
  8688
  8689     IF PI-ACCOUNT-SECURITY > SPACES
  8690         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8691             NEXT SENTENCE
  8692         ELSE
  8693             GO TO 0360-BROWSE-BACKWARD.
  8694
  8695     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8696     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8697     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8698
  8699     GO TO 0400-FIRST-TIME.
  8700
  8701 0380-CLAIM-END-FILE.
  8702
  8703     MOVE ER-0130     TO EMI-ERROR.
  8704     MOVE -1          TO CLMNOL.
  8705     MOVE AL-UABON    TO CARRA
  8706                         CLMNOA
  8707                         CERTNOA
  8708                         SUFXA.
  8709
  8710     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8711
  8712     GO TO 8200-SEND-DATAONLY.
  8713
  8714 0400-FIRST-TIME.
  8715
  8716     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 164
* EL156.cbl
  8717        MOVE 'N'         TO WS-BROWSE-START-SW
  8718
  8719* EXEC CICS ENDBR
  8720*            DATASET    ('ELMSTR')
  8721*       END-EXEC.
  8722     MOVE 'ELMSTR' TO DFHEIV1
  8723     MOVE 0
  8724       TO DFHEIV11
  8725*    MOVE '&2                    $   #00008557' TO DFHEIV0
  8726     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8727     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8728     MOVE X'2020233030303038353537' TO DFHEIV0(25:11)
  8729     CALL 'kxdfhei1' USING DFHEIV0,
  8730           DFHEIV1,
  8731           DFHEIV11,
  8732           DFHEIV99
  8733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8734
  8735
  8736     IF PI-PROCESSOR-ID = 'LGXX'
  8737         NEXT SENTENCE
  8738     ELSE
  8739
  8740* EXEC CICS READQ TS
  8741*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8742*            INTO    (SECURITY-CONTROL)
  8743*            LENGTH  (SC-COMM-LENGTH)
  8744*            ITEM    (SC-ITEM)
  8745*        END-EXEC
  8746*    MOVE '*$II   L              ''   #00008564' TO DFHEIV0
  8747     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8748     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8749     MOVE X'2020233030303038353634' TO DFHEIV0(25:11)
  8750     CALL 'kxdfhei1' USING DFHEIV0,
  8751           PI-SECURITY-TEMP-STORE-ID,
  8752           SECURITY-CONTROL,
  8753           SC-COMM-LENGTH,
  8754           SC-ITEM,
  8755           DFHEIV99,
  8756           DFHEIV99
  8757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8758         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8759         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8760
  8761     MOVE LOW-VALUES             TO EL156AI.
  8762     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8763     MOVE 'Y'                    TO FIRST-ENTRY.
  8764     GO TO 7000-SHOW-CLAIM.
  8765
  8766 0500-CREATE-TEMP-STORAGE.
  8767     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8768
  8769
  8770* EXEC CICS WRITEQ TS
  8771*        QUEUE (QID)
  8772*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8773*        LENGTH(PI-COMM-LENGTH)
  8774*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 165
* EL156.cbl
  8775*    MOVE '*"                    ''   #00008581' TO DFHEIV0
  8776     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8777     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8778     MOVE X'2020233030303038353831' TO DFHEIV0(25:11)
  8779     CALL 'kxdfhei1' USING DFHEIV0,
  8780           QID,
  8781           PROGRAM-INTERFACE-BLOCK,
  8782           PI-COMM-LENGTH,
  8783           DFHEIV99,
  8784           DFHEIV99,
  8785           DFHEIV99
  8786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8787
  8788
  8789
  8790* EXEC CICS WRITEQ TS
  8791*        QUEUE (QID)
  8792*        FROM  (EL156AI)
  8793*        LENGTH(MAP-LENGTH)
  8794*    END-EXEC.
  8795*    MOVE '*"                    ''   #00008587' TO DFHEIV0
  8796     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8797     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8798     MOVE X'2020233030303038353837' TO DFHEIV0(25:11)
  8799     CALL 'kxdfhei1' USING DFHEIV0,
  8800           QID,
  8801           EL156AI,
  8802           MAP-LENGTH,
  8803           DFHEIV99,
  8804           DFHEIV99,
  8805           DFHEIV99
  8806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8807
  8808
  8809 0599-EXIT.
  8810      EXIT.
  8811
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 166
* EL156.cbl
  8813 0600-RECOVER-TEMP-STORAGE.
  8814
  8815* EXEC CICS READQ TS
  8816*        QUEUE (QID)
  8817*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8818*        LENGTH(PI-COMM-LENGTH)
  8819*    END-EXEC.
  8820*    MOVE '*$I    L              ''   #00008598' TO DFHEIV0
  8821     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8822     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8823     MOVE X'2020233030303038353938' TO DFHEIV0(25:11)
  8824     CALL 'kxdfhei1' USING DFHEIV0,
  8825           QID,
  8826           PROGRAM-INTERFACE-BLOCK,
  8827           PI-COMM-LENGTH,
  8828           DFHEIV99,
  8829           DFHEIV99,
  8830           DFHEIV99
  8831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8832
  8833
  8834
  8835* EXEC CICS READQ TS
  8836*        QUEUE (QID)
  8837*        INTO  (EL156AI)
  8838*        LENGTH(MAP-LENGTH)
  8839*    END-EXEC.
  8840*    MOVE '*$I    L              ''   #00008604' TO DFHEIV0
  8841     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8842     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8843     MOVE X'2020233030303038363034' TO DFHEIV0(25:11)
  8844     CALL 'kxdfhei1' USING DFHEIV0,
  8845           QID,
  8846           EL156AI,
  8847           MAP-LENGTH,
  8848           DFHEIV99,
  8849           DFHEIV99,
  8850           DFHEIV99
  8851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8852
  8853
  8854     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8855
  8856     IF PMTTYPEI NOT = LOW-VALUES
  8857         MOVE AL-UANON           TO PMTTYPEA.
  8858
  8859     IF PAYEEI NOT = LOW-VALUES
  8860         MOVE AL-UANON           TO PAYEEA.
  8861
  8862     IF NOTE1I NOT = LOW-VALUES
  8863         MOVE AL-UANON           TO NOTE1A.
  8864
  8865     IF (RETURNED-FROM = 'EL614')
  8866        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8867     END-IF
  8868*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8869*       AND (PI-EOB-CODES-EXIST = 'Y')
  8870*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 167
* EL156.cbl
  8871*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8872     IF PI-SET-NOTE2-MDT = 'Y'
  8873         MOVE AL-SANON           TO NOTE2A
  8874     END-IF
  8875
  8876     IF OFFLINEI NOT = LOW-VALUES
  8877         MOVE AL-UANON           TO OFFLINEA.
  8878
  8879*    IF GROUPEDI NOT = LOW-VALUES
  8880*        MOVE AL-UANON           TO GROUPEDA.
  8881
  8882*    IF CASHI NOT = LOW-VALUES
  8883*        MOVE AL-UANON           TO CASHA.
  8884
  8885     IF CHECKNOI NOT = LOW-VALUES
  8886         MOVE AL-UANON           TO CHECKNOA.
  8887
  8888     IF HOLDTILI NOT = LOW-VALUES
  8889         MOVE AL-UANON           TO HOLDTILA.
  8890
  8891     IF EPYFROMI NOT = LOW-VALUES
  8892         MOVE AL-UANON           TO EPYFROMA.
  8893
  8894     IF AIGFROMI NOT = LOW-VALUES
  8895         MOVE AL-UANON           TO AIGFROMA.
  8896
  8897     IF EPYTHRUI NOT = LOW-VALUES
  8898         MOVE AL-UANON           TO EPYTHRUA.
  8899
  8900     IF EDAYSI NOT = LOW-VALUES
  8901         MOVE AL-UNNON           TO EDAYSA.
  8902
  8903     IF EPYAMTL NOT = +0
  8904         MOVE AL-UNNON           TO EPYAMTA.
  8905
  8906     IF ERESVL NOT = +0
  8907         MOVE AL-UNNON           TO ERESVA.
  8908
  8909     IF EEXPENSL NOT = +0
  8910         MOVE AL-UNNON           TO EEXPENSA.
  8911
  8912     IF ETYPEI NOT = LOW-VALUES
  8913         MOVE AL-UNNON           TO ETYPEA.
  8914
  8915     IF PROOFDTI NOT = 0
  8916         MOVE AL-UNNON           TO PROOFDTA.
  8917
  8918     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8919        MOVE AL-UANON            TO EOBYNA
  8920     END-IF
  8921     IF CLMFMYNI = 'Y' OR 'N'
  8922        MOVE AL-UANON            TO CLMFMYNA
  8923     END-IF
  8924
  8925     IF SURVYYNI = 'Y' OR 'N'
  8926        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8927           MOVE AL-UANON         TO SURVYYNA
  8928        END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 168
* EL156.cbl
  8929     END-IF
  8930
  8931     IF SPRELYNI = 'Y' OR 'N'
  8932        MOVE AL-UANON            TO SPRELYNA
  8933     END-IF
  8934
  8935     .
  8936 0699-EXIT.
  8937      EXIT.
  8938
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 169
* EL156.cbl
  8940 0700-TEST-FOR-CHANGES.
  8941     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8942         MOVE ER-0433            TO EMI-ERROR
  8943         GO TO 0750-FUNCTION-ERROR.
  8944
  8945     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8946
  8947     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8948         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8949         MOVE 'A'                TO PI-PASS-SW
  8950         GO TO 1000-EDIT-DATA.
  8951
  8952     IF PI-FATAL-COUNT NOT = 0
  8953         MOVE ER-0499            TO EMI-ERROR
  8954         GO TO 0750-FUNCTION-ERROR.
  8955
  8956     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8957         MOVE ER-0500            TO EMI-ERROR
  8958         GO TO 0750-FUNCTION-ERROR.
  8959
  8960     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8961        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8962           MOVE ER-0542          TO EMI-ERROR
  8963           MOVE -1               TO EPYAMTL
  8964           GO TO 0750-FUNCTION-ERROR.
  8965
  8966     IF PI-OFFLINE = 'Y'  OR
  8967        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8968        MOVE EIBAID              TO PI-PFKEY-USED
  8969        GO TO 5000-UPDATE.
  8970
  8971     GO TO 6000-BUILD-SCREEN-B.
  8972
  8973 0750-FUNCTION-ERROR.
  8974     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8975
  8976     IF ENTERPFL > 0
  8977         MOVE -1                 TO ENTERPFL
  8978         MOVE AL-UNBON           TO ENTERPFA
  8979         GO TO 8200-SEND-DATAONLY
  8980     ELSE
  8981         MOVE -1                 TO ENTERPFL
  8982         MOVE AL-UNNOF           TO ENTERPFA
  8983         GO TO 8200-SEND-DATAONLY.
  8984
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 170
* EL156.cbl
  8986 0800-DELETE-TS.
  8987
  8988* EXEC CICS HANDLE CONDITION
  8989*        QIDERR(0800-EXIT)
  8990*    END-EXEC.
  8991*    MOVE '"$N                   ! % #00008743' TO DFHEIV0
  8992     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8994     MOVE X'2520233030303038373433' TO DFHEIV0(25:11)
  8995     CALL 'kxdfhei1' USING DFHEIV0
  8996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8997
  8998
  8999
  9000* EXEC CICS DELETEQ TS
  9001*        QUEUE(QID)
  9002*    END-EXEC.
  9003*    MOVE '*&                    #   #00008747' TO DFHEIV0
  9004     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9005     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9006     MOVE X'2020233030303038373437' TO DFHEIV0(25:11)
  9007     CALL 'kxdfhei1' USING DFHEIV0,
  9008           QID,
  9009           DFHEIV99
  9010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9011
  9012
  9013 0800-EXIT.
  9014      EXIT.
  9015 0900-GET-DDF-LIMITS.
  9016
  9017     if cm-clp-state = zeros or spaces or low-values
  9018        move cm-state            to cm-clp-state
  9019     end-if
  9020     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9021     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9022     MOVE cm-clp-state           TO ERPDEF-STATE
  9023     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9024     if (cl-claim-type = 'L' or 'P')
  9025        and (pi-lf-benefit-cd not = '00' and '  ' and 'DD')
  9026        move 'L'                 to erpdef-ben-type
  9027        move pi-lf-benefit-cd    to erpdef-ben-code
  9028     else
  9029        MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9030        MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9031     end-if
  9032     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9033
  9034     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9035
  9036
  9037* EXEC CICS STARTBR
  9038*        DATASET  ('ERPDEF')
  9039*        RIDFLD   (ERPDEF-KEY)
  9040*        GTEQ
  9041*        RESP     (WS-RESPONSE)
  9042*    END-EXEC
  9043     MOVE 'ERPDEF' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 171
* EL156.cbl
  9044     MOVE 0
  9045       TO DFHEIV11
  9046*    MOVE '&,         G          &  N#00008774' TO DFHEIV0
  9047     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9048     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9049     MOVE X'204E233030303038373734' TO DFHEIV0(25:11)
  9050     CALL 'kxdfhei1' USING DFHEIV0,
  9051           DFHEIV1,
  9052           ERPDEF-KEY,
  9053           DFHEIV99,
  9054           DFHEIV11,
  9055           DFHEIV99
  9056     MOVE EIBRESP  TO WS-RESPONSE
  9057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9058
  9059     IF NOT WS-RESP-NORMAL
  9060        GO TO 0900-EXIT
  9061     END-IF
  9062
  9063     .
  9064 0900-READNEXT.
  9065
  9066
  9067* EXEC CICS READNEXT
  9068*       DATASET  ('ERPDEF')
  9069*       SET      (ADDRESS OF PRODUCT-MASTER)
  9070*       RIDFLD   (ERPDEF-KEY)
  9071*       RESP     (WS-RESPONSE)
  9072*    END-EXEC
  9073     MOVE 'ERPDEF' TO DFHEIV1
  9074     MOVE 0
  9075       TO DFHEIV11
  9076*    MOVE '&.S                   )  N#00008788' TO DFHEIV0
  9077     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9078     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9079     MOVE X'204E233030303038373838' TO DFHEIV0(25:11)
  9080     CALL 'kxdfhei1' USING DFHEIV0,
  9081           DFHEIV1,
  9082           DFHEIV20,
  9083           DFHEIV99,
  9084           ERPDEF-KEY,
  9085           DFHEIV99,
  9086           DFHEIV11,
  9087           DFHEIV99,
  9088           DFHEIV99
  9089     SET ADDRESS OF PRODUCT-MASTER TO
  9090         DFHEIV20
  9091     MOVE EIBRESP  TO WS-RESPONSE
  9092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9093
  9094     IF NOT WS-RESP-NORMAL
  9095        GO TO 0900-ENDBR
  9096     END-IF
  9097
  9098     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9099        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9100           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9101        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 172
* EL156.cbl
  9102           GO TO 0900-READNEXT
  9103        END-IF
  9104     ELSE
  9105        GO TO 0900-ENDBR
  9106     END-IF
  9107
  9108     IF CM-LOAN-TERM = ZEROS
  9109        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9110     END-IF
  9111
  9112     .
  9113 0900-ENDBR.
  9114
  9115
  9116* EXEC CICS ENDBR
  9117*       DATASET  ('ERPDEF')
  9118*    END-EXEC
  9119     MOVE 'ERPDEF' TO DFHEIV1
  9120     MOVE 0
  9121       TO DFHEIV11
  9122*    MOVE '&2                    $   #00008816' TO DFHEIV0
  9123     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9124     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9125     MOVE X'2020233030303038383136' TO DFHEIV0(25:11)
  9126     CALL 'kxdfhei1' USING DFHEIV0,
  9127           DFHEIV1,
  9128           DFHEIV11,
  9129           DFHEIV99
  9130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9131
  9132     .
  9133 0900-EXIT.
  9134     EXIT.
  9135 1000-EDIT-DATA.
  9136
  9137     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9138         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9139         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9140
  9141     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9142
  9143     IF NOT MODIFY-CAP
  9144         MOVE ER-0070            TO EMI-ERROR
  9145         MOVE -1                 TO PMTTYPEL
  9146         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9147         GO TO 2000-EDIT-DONE.
  9148
  9149     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9150                         '5' AND '6'
  9151         MOVE ER-0420            TO EMI-ERROR
  9152         MOVE -1                 TO PMTTYPEL
  9153         MOVE AL-UABON           TO PMTTYPEA
  9154         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9155     ELSE
  9156         MOVE AL-UANON           TO PMTTYPEA.
  9157
  9158*    IF PI-OFFLINE = 'Y'
  9159*       IF PI-GROUPED = 'Y'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 173
* EL156.cbl
  9160*          MOVE ER-1880         TO EMI-ERROR
  9161*          MOVE -1              TO GROUPEDL
  9162*          MOVE AL-UABON        TO GROUPEDA
  9163*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9164*
  9165*    IF GROUPEDL > +0
  9166*       IF PI-GROUPED = 'Y' OR 'N'
  9167*          MOVE AL-UANON TO GROUPEDA
  9168*       ELSE
  9169*          MOVE ER-3140            TO EMI-ERROR
  9170*          MOVE -1                 TO GROUPEDL
  9171*          MOVE AL-UABON           TO GROUPEDA
  9172*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9173*
  9174*    IF CASHL > +0
  9175*       IF PI-CASH = 'Y' OR 'N'
  9176*          MOVE AL-UANON           TO CASHA
  9177*       ELSE
  9178*          MOVE ER-3141            TO EMI-ERROR
  9179*          MOVE -1                 TO CASHL
  9180*          MOVE AL-UABON           TO CASHA
  9181*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9182
  9183     IF LOANNOL > +0
  9184         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9185
  9186 1000-EDIT-PAYEE.
  9187
  9188     IF PI-PAYEE-SEQ NOT NUMERIC
  9189         MOVE ER-0294            TO  EMI-ERROR
  9190         MOVE -1                 TO  PAYEEL
  9191         MOVE AL-UABON           TO  PAYEEA
  9192         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9193         GO TO 1000-CONT-EDIT.
  9194
  9195     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9196                         'E' OR 'O' OR 'Q'
  9197         NEXT SENTENCE
  9198     ELSE
  9199         MOVE ER-0294            TO  EMI-ERROR
  9200         MOVE -1                 TO  PAYEEL
  9201         MOVE AL-UABON           TO  PAYEEA
  9202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9203         GO TO 1000-CONT-EDIT.
  9204
  9205     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9206        (PI-PAYEE-SEQ NOT < '1' AND
  9207         PI-PAYEE-SEQ NOT > '9'))
  9208      OR
  9209        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9210         (PI-PAYEE-SEQ NOT > '9'))
  9211         MOVE AL-UANON            TO PAYEEA
  9212     ELSE
  9213         MOVE ER-0294            TO EMI-ERROR
  9214         MOVE -1                 TO PAYEEL
  9215         MOVE AL-UABON           TO PAYEEA
  9216         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9217
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 174
* EL156.cbl
  9218     IF PI-COMPANY-ID = 'DMD'
  9219         IF PI-PAYEE-TYPE = 'B' AND
  9220            PI-PAYEE-SEQ NOT = '0'
  9221               MOVE ER-7841            TO EMI-ERROR
  9222               MOVE -1                 TO PAYEEL
  9223               MOVE AL-UABON           TO PAYEEA
  9224               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9225
  9226     IF PI-COMPANY-ID = 'JHL'
  9227         IF PI-PAYEE = 'B0'
  9228             NEXT SENTENCE
  9229           ELSE
  9230
  9231* EXEC CICS HANDLE CONDITION
  9232*            ENDFILE(1950-NOT-FOUND)
  9233*            NOTFND (1950-NOT-FOUND)
  9234*        END-EXEC
  9235*    MOVE '"$''I                  ! & #00008918' TO DFHEIV0
  9236     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9238     MOVE X'2620233030303038393138' TO DFHEIV0(25:11)
  9239     CALL 'kxdfhei1' USING DFHEIV0
  9240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9241         MOVE 'N'                    TO FOUND-TOL-SW
  9242         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9243         MOVE '2'                    TO CNTL-REC-TYPE
  9244         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9245         MOVE +0                     TO CNTL-SEQ-NO
  9246         MOVE 'PROC'                 TO FILE-SWITCH
  9247         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9248         IF PI-PAYEE = 'I1' AND
  9249            APPROVAL-LEVEL-2
  9250             NEXT SENTENCE
  9251           ELSE
  9252         IF NOT PI-USER-ALMIGHTY-YES
  9253             MOVE ER-3546        TO EMI-ERROR
  9254             MOVE -1             TO PAYEEL
  9255             MOVE AL-UABON       TO PAYEEA
  9256             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9257
  9258     IF PI-PAYEE-TYPE = 'E'
  9259        IF PI-PMTTYPE = '5' OR '6'
  9260            NEXT SENTENCE
  9261        ELSE
  9262            MOVE ER-3539            TO EMI-ERROR
  9263            MOVE -1                 TO PAYEEL
  9264            MOVE AL-UABON           TO PAYEEA
  9265            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9266
  9267 1000-CONT-EDIT.
  9268
  9269     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9270        IF PI-EPYAMT NOT NEGATIVE
  9271            MOVE ER-0421         TO EMI-ERROR
  9272            MOVE -1              TO OFFLINEL
  9273            MOVE AL-UABON        TO OFFLINEA
  9274            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9275        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 175
* EL156.cbl
  9276            MOVE AL-UANON        TO OFFLINEA.
  9277
  9278     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9279        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9280           CONTINUE
  9281        ELSE
  9282           IF PI-PRINT-EOB-YN = 'S' AND
  9283              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9284                CONTINUE
  9285           ELSE
  9286              MOVE ER-1561       TO EMI-ERROR
  9287              MOVE -1            TO EOBYNL
  9288              MOVE AL-UABON      TO EOBYNA
  9289              PERFORM 9900-ERROR-FORMAT
  9290                                 THRU 9900-EXIT
  9291           END-IF
  9292        END-IF
  9293
  9294        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9295            MOVE ER-1566        TO EMI-ERROR
  9296            MOVE -1             TO CLMFMYNL
  9297            MOVE AL-UABON       TO CLMFMYNA
  9298            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9299        END-IF
  9300
  9301        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9302            MOVE ER-1567        TO EMI-ERROR
  9303            MOVE -1             TO SURVYYNL
  9304            MOVE AL-UABON       TO SURVYYNA
  9305            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9306        END-IF
  9307
  9308        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9309            MOVE ER-1569        TO EMI-ERROR
  9310            MOVE -1             TO SPRELYNL
  9311            MOVE AL-UABON       TO SPRELYNA
  9312            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9313        END-IF
  9314
  9315     END-IF
  9316     IF PI-EPYAMT IS NEGATIVE
  9317         IF PI-OFFLINE NOT = 'Y'
  9318             MOVE ER-0836        TO  EMI-ERROR
  9319             MOVE -1             TO  OFFLINEL
  9320             MOVE AL-UABON       TO  OFFLINEA
  9321             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9322
  9323     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9324        MOVE ER-0872             TO EMI-ERROR
  9325        MOVE -1                  TO PROOFDTL
  9326        MOVE AL-UABON            TO PROOFDTA
  9327        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9328     ELSE
  9329        MOVE '4'                TO DC-OPTION-CODE
  9330        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9331        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9332        IF DATE-CONVERSION-ERROR
  9333            MOVE ER-0873        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 176
* EL156.cbl
  9334            MOVE -1                  TO PROOFDTL
  9335            MOVE AL-UABON            TO PROOFDTA
  9336            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9337        ELSE
  9338            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9339            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9340                MOVE ER-0873    TO EMI-ERROR
  9341                MOVE -1                  TO PROOFDTL
  9342                MOVE AL-UABON            TO PROOFDTA
  9343                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9344            END-IF
  9345        END-IF
  9346     END-IF.
  9347
  9348     IF PI-COMPANY-ID = 'DMD'
  9349        IF NOTE1L NOT = ZEROS
  9350            MOVE ER-7844        TO  EMI-ERROR
  9351            MOVE -1             TO  NOTE1L
  9352            MOVE AL-UABON       TO  NOTE1A
  9353            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9354
  9355     IF PI-COMPANY-ID = 'DMD'
  9356        IF NOTE2L NOT = ZEROS
  9357          GO TO 1004-DMD-EOB-CHECKS.
  9358
  9359     IF NOTE1L NOT > +0
  9360         GO TO 1005-CHECK-ERRORS.
  9361
  9362     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9363         GO TO 1005-CHECK-ERRORS.
  9364
  9365     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9366         GO TO 1003-HAN-PMT-NOTES.
  9367
  9368     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  9369
  9370     IF WS-PMTOPTION NUMERIC
  9371        IF WS-PMTOPTION > '00' AND < '17'
  9372           NEXT SENTENCE
  9373        ELSE
  9374           MOVE ER-0618          TO EMI-ERROR
  9375           MOVE -1               TO NOTE1L
  9376           MOVE AL-UABON         TO NOTE1A
  9377           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9378     ELSE
  9379        GO TO 1005-CHECK-ERRORS.
  9380
  9381     IF WS-PMTOPTION = '05' AND
  9382        WS-DOCNAME = SPACES
  9383          MOVE ER-0616             TO EMI-ERROR
  9384          MOVE -1                  TO NOTE1L
  9385          MOVE AL-UABON            TO NOTE1A
  9386          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9387
  9388     IF WS-PMTOPTION = '15' OR '16'
  9389
  9390* EXEC CICS BIF DEEDIT
  9391*            FIELD (WS-AMOUNT)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 177
* EL156.cbl
  9392*            LENGTH(08)
  9393*        END-EXEC
  9394     MOVE 08
  9395       TO DFHEIV11
  9396*    MOVE '@"L                   #   #00009070' TO DFHEIV0
  9397     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9398     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9399     MOVE X'2020233030303039303730' TO DFHEIV0(25:11)
  9400     CALL 'kxdfhei1' USING DFHEIV0,
  9401           WS-AMOUNT,
  9402           DFHEIV11
  9403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9404        IF (WS-NUM-AMT = ZEROS) OR
  9405           (WS-AMOUNT NOT NUMERIC)
  9406           MOVE ER-0617          TO EMI-ERROR
  9407           MOVE -1               TO NOTE1L
  9408           MOVE AL-UABON         TO NOTE1A
  9409           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9410
  9411     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9412
  9413     GO TO 1005-CHECK-ERRORS.
  9414
  9415 1003-HAN-PMT-NOTES.
  9416
  9417     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9418
  9419     IF WS-HAN-PMT-CODE = SPACE
  9420         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9421     ELSE
  9422     IF WS-HAN-PMT-CODE = 'A'
  9423         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9424                                 TO WS-HAN-PMT-NOTE
  9425     ELSE
  9426     IF WS-HAN-PMT-CODE = 'B'
  9427         MOVE ':FINAL PAYMENT / DECEASED'
  9428                                 TO WS-HAN-PMT-NOTE
  9429     ELSE
  9430     IF WS-HAN-PMT-CODE = 'C'
  9431         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9432                                 TO WS-HAN-PMT-NOTE
  9433     ELSE
  9434     IF WS-HAN-PMT-CODE = 'D'
  9435         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9436                                 TO WS-HAN-PMT-NOTE
  9437     ELSE
  9438     IF WS-HAN-PMT-CODE = 'E'
  9439         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9440                                 TO WS-HAN-PMT-NOTE
  9441     ELSE
  9442     IF WS-HAN-PMT-CODE = 'F'
  9443         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9444                                 TO WS-HAN-PMT-NOTE
  9445     ELSE
  9446     IF WS-HAN-PMT-CODE = 'P'
  9447         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9448
  9449     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 178
* EL156.cbl
  9450     GO TO 1005-CHECK-ERRORS.
  9451
  9452 1004-DMD-EOB-CHECKS.
  9453
  9454     INITIALIZE PI-AT-EOB-CODES.
  9455
  9456     IF NOTE2I (20:21) > SPACES
  9457         MOVE ER-7845          TO EMI-ERROR
  9458         MOVE -1               TO NOTE2L
  9459         MOVE AL-UABON         TO NOTE2A
  9460         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9461         GO TO 1005-CHECK-ERRORS
  9462      ELSE
  9463         MOVE NOTE2I             TO W-EOB-CODES.
  9464
  9465     MOVE +1                     TO W-EOB-NDX.
  9466
  9467 1004-CHECK-EACH-EOB.
  9468
  9469     IF W-EOB-NDX > +5
  9470             OR
  9471        W-EOB-CODE (W-EOB-NDX) = SPACES
  9472         GO TO 1004-CHECK-DUP-EOB.
  9473
  9474     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9475         MOVE ER-0956            TO EMI-ERROR
  9476         MOVE -1                 TO NOTE2L
  9477         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9478         GO TO 1005-CHECK-ERRORS.
  9479
  9480     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9481     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9482     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9483     MOVE 'DLO023'               TO PGM-NAME.
  9484
  9485
  9486* EXEC CICS LINK
  9487*        PROGRAM    (PGM-NAME)
  9488*        COMMAREA   (CD-COMMUNICATION-AREA)
  9489*        LENGTH     (CD-RCRD-LENGTH)
  9490*    END-EXEC.
  9491*    MOVE '."C                   (   #00009155' TO DFHEIV0
  9492     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9493     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9494     MOVE X'2020233030303039313535' TO DFHEIV0(25:11)
  9495     CALL 'kxdfhei1' USING DFHEIV0,
  9496           PGM-NAME,
  9497           CD-COMMUNICATION-AREA,
  9498           CD-RCRD-LENGTH,
  9499           DFHEIV99,
  9500           DFHEIV99,
  9501           DFHEIV99,
  9502           DFHEIV99
  9503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9504
  9505
  9506     IF CD-RETURN-CODE = 'OK'
  9507         GO TO 1004-CONT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 179
* EL156.cbl
  9508
  9509     MOVE -1                     TO NOTE2L.
  9510
  9511     IF CD-RETURN-CODE = '01'
  9512         MOVE ER-8310            TO EMI-ERROR
  9513         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9514         GO TO 1005-CHECK-ERRORS.
  9515
  9516     IF CD-RETURN-CODE = '02'
  9517         MOVE ER-8311            TO EMI-ERROR
  9518         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9519         GO TO 1005-CHECK-ERRORS.
  9520
  9521     IF CD-RETURN-CODE = '03'
  9522         MOVE ER-8312            TO EMI-ERROR
  9523         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9524         GO TO 1005-CHECK-ERRORS.
  9525
  9526     IF CD-RETURN-CODE = '04'
  9527         MOVE ER-8313            TO EMI-ERROR
  9528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9529         GO TO 1005-CHECK-ERRORS.
  9530
  9531     IF CD-RETURN-CODE = '05'
  9532         MOVE ER-8314            TO EMI-ERROR
  9533         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9534         GO TO 1005-CHECK-ERRORS.
  9535
  9536     IF CD-RETURN-CODE = '06'
  9537         MOVE ER-8315            TO EMI-ERROR
  9538         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9539         GO TO 1005-CHECK-ERRORS.
  9540
  9541     IF CD-RETURN-CODE = 'E1'
  9542         MOVE ER-8316            TO EMI-ERROR
  9543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9544         GO TO 1005-CHECK-ERRORS.
  9545
  9546     IF CD-RETURN-CODE = 'N1'
  9547         MOVE ER-8317            TO EMI-ERROR
  9548         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9549         GO TO 1005-CHECK-ERRORS.
  9550
  9551 1004-CONT.
  9552     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9553
  9554     ADD +1 TO W-EOB-NDX.
  9555     GO TO 1004-CHECK-EACH-EOB.
  9556
  9557 1004-CHECK-DUP-EOB.
  9558     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9559         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9560                               PI-AT-EOB-CODE (3) OR
  9561                               PI-AT-EOB-CODE (4) OR
  9562                               PI-AT-EOB-CODE (5)))
  9563                  OR
  9564        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9565         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 180
* EL156.cbl
  9566                               PI-AT-EOB-CODE (4) OR
  9567                               PI-AT-EOB-CODE (5)))
  9568                  OR
  9569        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9570         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9571                               PI-AT-EOB-CODE (5)))
  9572                  OR
  9573        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9574         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9575            MOVE ER-8000            TO EMI-ERROR
  9576            MOVE AL-UABON           TO NOTE2A
  9577            MOVE -1                 TO NOTE2L
  9578            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9579            GO TO 1005-CHECK-ERRORS.
  9580
  9581 1005-CHECK-ERRORS.
  9582*    IF PI-COMPANY-ID NOT = 'DMD'
  9583        GO TO 1006-CHECK-ERRORS.
  9584
  9585*********  DMD CODE START ******************
  9586*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9587*       GO TO 1006-CHECK-ERRORS.
  9588*
  9589*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9590*
  9591*    COMPUTE W-PAYMENT-TOTAL
  9592*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9593*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9594*               AND
  9595*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9596*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9597*          MOVE ER-0967    TO EMI-ERROR
  9598*          MOVE -1         TO PMTTYPEL
  9599*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9600*
  9601*    GO TO 1006-CHECK-ERRORS.
  9602*********  DMD CODE END ******************
  9603
  9604 1006-CHECK-ERRORS.
  9605     IF NOT EMI-NO-ERRORS
  9606        GO TO 2000-EDIT-DONE.
  9607
  9608
  9609* EXEC CICS HANDLE CONDITION
  9610*        NOTFND(1950-NOT-FOUND)
  9611*    END-EXEC.
  9612*    MOVE '"$I                   ! '' #00009263' TO DFHEIV0
  9613     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9615     MOVE X'2720233030303039323633' TO DFHEIV0(25:11)
  9616     CALL 'kxdfhei1' USING DFHEIV0
  9617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9618
  9619
  9620     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9621     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9622     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9623     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 181
* EL156.cbl
  9624     MOVE 'MSTR'                 TO FILE-SWITCH.
  9625
  9626     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9627
  9628     IF PI-COMPANY-ID = 'DMD'
  9629         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9630
  9631     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9632        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9633           MOVE ER-0873    TO EMI-ERROR
  9634           MOVE -1                  TO PROOFDTL
  9635           MOVE AL-UABON            TO PROOFDTA
  9636           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9637        END-IF
  9638     END-IF
  9639     if cl-benefit-period = zeros
  9640        move er-1667             to emi-error
  9641        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9642     end-if
  9643     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9644     MOVE +95                    TO TRLR-SEQ-NO
  9645
  9646* EXEC CICS READ
  9647*       DATASET  ('ELTRLR')
  9648*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9649*       RIDFLD   (ELTRLR-KEY)
  9650*       RESP     (WS-RESPONSE)
  9651*    END-EXEC
  9652     MOVE 'ELTRLR' TO DFHEIV1
  9653*    MOVE '&"S        E          (  N#00009292' TO DFHEIV0
  9654     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9656     MOVE X'204E233030303039323932' TO DFHEIV0(25:11)
  9657     CALL 'kxdfhei1' USING DFHEIV0,
  9658           DFHEIV1,
  9659           DFHEIV20,
  9660           DFHEIV99,
  9661           ELTRLR-KEY,
  9662           DFHEIV99,
  9663           DFHEIV99,
  9664           DFHEIV99
  9665     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9666         DFHEIV20
  9667     MOVE EIBRESP  TO WS-RESPONSE
  9668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9669
  9670     if ws-resp-normal
  9671        perform varying s1 from +1 by +1 until
  9672           at-note-error-no (s1) = spaces
  9673           if at-note-error-no (s1) = '1662'
  9674              continue
  9675           else
  9676              move at-note-error-no (s1)
  9677                                 to emi-error
  9678              if at-note-error-no (s1) = '1653'
  9679                 evaluate true
  9680                    when cl-claim-type = 'L'
  9681                       move '  LF  '
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 182
* EL156.cbl
  9682                                 to emi-claim-type
  9683                    when cl-claim-type = 'I'
  9684                       move '  IU  '
  9685                                 to emi-claim-type
  9686                    when cl-claim-type = 'F'
  9687                       move '  FL  '
  9688                                 to emi-claim-type
  9689                    when other
  9690                       move '  AH  '
  9691                                 to emi-claim-type
  9692                 end-evaluate
  9693              end-if
  9694              PERFORM 9900-ERROR-FORMAT
  9695                                 THRU 9900-EXIT
  9696           end-if
  9697        end-perform
  9698     end-if
  9699     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9700         IF PI-PMTTYPE = '5' OR '6'
  9701             NEXT SENTENCE
  9702         ELSE
  9703             MOVE ER-0555             TO EMI-ERROR
  9704             MOVE -1                  TO PMTTYPEL
  9705             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9706
  9707     IF CL-LAST-CLOSE-REASON = '2'
  9708         IF CL-CLAIM-STATUS = 'C'
  9709             MOVE ER-0760        TO  EMI-ERROR
  9710             MOVE -1             TO  PMTTYPEL
  9711             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9712
  9713     IF PI-ACTIVITY-CODE = 9
  9714         MOVE ER-3538            TO  EMI-ERROR
  9715         MOVE -1                 TO  PMTTYPEL
  9716         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9717
  9718     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9719         GO TO 1008-READ-CERT.
  9720**********************AIG LOGIC STARTS *********************
  9721     IF CL-CERT-PRIME = 'INCOMPLETE'
  9722         MOVE ER-3540            TO  EMI-ERROR
  9723         MOVE -1                 TO  PMTTYPEL
  9724         MOVE AL-UABON           TO  PMTTYPEA
  9725         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9726         GO TO 2000-EDIT-DONE.
  9727
  9728     IF PI-PMTTYPE = '4'
  9729         IF PI-EPYAMT IS NEGATIVE
  9730             IF PI-ECHECKNO-CR = 'CR'
  9731                 NEXT SENTENCE
  9732             ELSE
  9733                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9734
  9735     IF PI-PMTTYPE = '4'
  9736         IF PI-ECHECKNO-CR = 'CR'
  9737             IF PI-EPYAMT IS NEGATIVE
  9738                 NEXT SENTENCE
  9739             ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 183
* EL156.cbl
  9740                 MOVE ER-0834    TO  EMI-ERROR
  9741                 MOVE -1         TO  EPYAMTL
  9742                 MOVE AL-UNBON   TO  EPYAMTA
  9743                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9744
  9745     IF PI-PMTTYPE = '4'
  9746         IF PI-EPYAMT IS NEGATIVE
  9747             IF PI-OFFLINE = 'Y'
  9748                 NEXT SENTENCE
  9749             ELSE
  9750                 MOVE 'Y'        TO  PI-OFFLINE
  9751                                     WS-OFFLINE
  9752                                     OFFLINEO
  9753                 MOVE AL-UANON   TO  OFFLINEA.
  9754
  9755*    IF PI-PMTTYPE = '4'
  9756*        IF PI-EPYAMT IS NEGATIVE
  9757*            IF PI-CASH = 'Y'
  9758*                NEXT SENTENCE
  9759*            ELSE
  9760*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9761*                MOVE AL-UANON   TO  CASHA
  9762*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9763*
  9764*    IF PI-CASH NOT = 'Y' AND 'N'
  9765*         IF PI-OFFLINE = 'Y'  AND
  9766*            PI-ECHECKNO-CR = 'CR'
  9767*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9768*              MOVE AL-UANON     TO  CASHA
  9769*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9770*
  9771*    IF PI-CASH NOT = 'Y' AND 'N'
  9772*        IF PI-PMTTYPE = '5' OR '6'
  9773*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9774*            MOVE AL-UANON       TO  CASHA
  9775*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9776*
  9777*    IF PI-CASH NOT = 'Y' AND 'N'
  9778*       IF CL-ASSOCIATES = 'N' OR 'A'
  9779*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9780*           MOVE AL-UANON        TO  CASHA
  9781*       ELSE
  9782*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9783*           MOVE AL-UANON        TO  CASHA.
  9784*
  9785*    IF PI-PMTTYPE = '5' OR '6'
  9786*        IF PI-CASH = 'N'
  9787*            MOVE ER-0819        TO  EMI-ERROR
  9788*            MOVE AL-UANON       TO  CASHA
  9789*            MOVE -1             TO  CASHL
  9790*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9791*
  9792*    IF CL-ASSOCIATES = 'N' OR 'A'
  9793*       IF CASHI = 'N'
  9794*        MOVE ER-3537            TO  EMI-ERROR
  9795*        MOVE AL-UANON           TO  CASHA
  9796*        MOVE -1                 TO  CASHL
  9797*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 184
* EL156.cbl
  9798
  9799 1007-DEFAULT-AIG-CHECKNO.
  9800
  9801     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9802         MOVE ER-3532            TO  EMI-ERROR
  9803         MOVE -1                 TO  PMTTYPEL
  9804         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9805**********************AIG LOGIC ENDS ***********************
  9806
  9807 1008-READ-CERT.
  9808
  9809     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9810     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9811     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9812     MOVE CL-CERT-STATE          TO CERT-STATE.
  9813     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9814     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9815     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9816     MOVE 'CERT'                 TO FILE-SWITCH.
  9817
  9818     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9819
  9820     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9821         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9822     ELSE
  9823         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9824
  9825*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9826*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9827
  9828     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9829         MOVE ER-0458            TO EMI-ERROR
  9830         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9831
  9832     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9833         MOVE ER-0459            TO EMI-ERROR
  9834         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9835
  9836     IF CL-REPORTED-DT = LOW-VALUES
  9837        MOVE ER-0530             TO EMI-ERROR
  9838        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9839
  9840     IF PI-COMPANY-ID = 'NCL'
  9841        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9842            MOVE ER-0770            TO EMI-ERROR
  9843            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9844
  9845     IF PI-COMPANY-ID = 'NCL'
  9846        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9847            MOVE ER-0737            TO EMI-ERROR
  9848            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9849
  9850     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9851         MOVE ER-0768            TO  EMI-ERROR
  9852         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9853
  9854     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9855         MOVE ER-0769            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 185
* EL156.cbl
  9856         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9857
  9858     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9859         GO TO 1020-DO-LIFE-EDITS
  9860     ELSE
  9861         GO TO 1030-DO-AH-EDITS.
  9862
  9863 1010-GENERAL-ERROR.
  9864     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9865
  9866     IF EMI-MESSAGE-FORMATTED
  9867         MOVE -1                 TO PMTTYPEL.
  9868
  9869 1010-EXIT.
  9870     EXIT.
  9871
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 186
* EL156.cbl
  9873 1020-DO-LIFE-EDITS.
  9874     IF CM-LF-BENEFIT-CD = '00'
  9875         IF PI-PMTTYPE = '5' OR '6'
  9876             MOVE ER-0658        TO EMI-ERROR
  9877             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9878         ELSE
  9879             MOVE ER-1775        TO EMI-ERROR
  9880             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9881
  9882     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9883     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9884         MOVE ER-0460            TO EMI-ERROR
  9885         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9886
  9887     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9888     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9889     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9890     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9891     MOVE '4'                    TO  CNTL-REC-TYPE.
  9892     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9893     MOVE 'BENE'                 TO  FILE-SWITCH.
  9894     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9895     IF NO-BENEFIT-FOUND
  9896         GO TO 1950-NOT-FOUND.
  9897
  9898     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9899
  9900     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9901         IF PI-PMTTYPE = '4'
  9902             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9903                PI-LF-COVERAGE-TYPE = 'P'
  9904                 NEXT SENTENCE
  9905             ELSE
  9906                 MOVE ER-0461        TO EMI-ERROR
  9907                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9908         ELSE
  9909            NEXT SENTENCE
  9910     ELSE
  9911         IF PI-PMTTYPE = '2'
  9912            IF NOT CM-O-B-COVERAGE
  9913              AND CM-LF-CURRENT-STATUS = '7'
  9914                MOVE ER-0462     TO EMI-ERROR
  9915                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9916
  9917     IF PI-PMTTYPE = '2'
  9918         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9919            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9920             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9921             MOVE ER-0730            TO  EMI-ERROR
  9922             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9923             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9924
  9925     IF PI-PMTTYPE = '2'
  9926         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9927            PI-LF-COVERAGE-TYPE = 'P'
  9928             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9929                 MOVE ER-0462    TO  EMI-ERROR
  9930                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 187
* EL156.cbl
  9931
  9932     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9933       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9934         MOVE ER-0466            TO EMI-ERROR
  9935         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9936
  9937     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9938         IF PI-PMTTYPE = '3'
  9939             MOVE 0436           TO EMI-ERROR
  9940             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9941             GO TO 1045-EDIT-PAYEE-ADDR
  9942         ELSE
  9943             GO TO 1045-EDIT-PAYEE-ADDR.
  9944
  9945     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9946        PI-LF-COVERAGE-TYPE = 'P'
  9947         IF PI-PMTTYPE = '3'
  9948             MOVE ER-0436          TO  EMI-ERROR
  9949             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9950         ELSE
  9951             NEXT SENTENCE
  9952     ELSE
  9953         IF PI-PMTTYPE = '1' OR '3'
  9954             MOVE ER-0436            TO EMI-ERROR
  9955             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9956*
  9957     IF PI-COMPANY-ID = 'CID' AND
  9958        CL-CERT-STATE = 'SC'  AND
  9959        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9960           MOVE ER-0879    TO  EMI-ERROR
  9961           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9962           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
  9963     END-IF.
  9964     IF PI-COMPANY-ID = 'AHL'
  9965        evaluate true
  9966           when CM-LF-BENEFIT-CD = '5I' OR '6J'
  9967              MOVE ER-0879       TO  EMI-ERROR
  9968              PERFORM 1040-PMTTYPE-ERROR
  9969                                 THRU 1040-EXIT
  9970              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
  9971           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
  9972                 '6D' OR '6H' OR '6R'
  9973              MOVE ER-0879       TO  EMI-ERROR
  9974              PERFORM 1040-PMTTYPE-ERROR
  9975                                 THRU 1040-EXIT
  9976              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
  9977           when CM-LF-BENEFIT-CD = '5M' OR '6M'
  9978              MOVE ER-0879       TO  EMI-ERROR
  9979              PERFORM 1040-PMTTYPE-ERROR
  9980                                 THRU 1040-EXIT
  9981              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
  9982        end-evaluate
  9983     END-IF
  9984     GO TO 1045-EDIT-PAYEE-ADDR.
  9985
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 188
* EL156.cbl
  9987 1030-DO-AH-EDITS.
  9988     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
  9989     IF CM-AH-BENEFIT-CD = '00'
  9990         IF PI-PMTTYPE = '5' OR '6'
  9991             MOVE ER-0658        TO EMI-ERROR
  9992             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9993         ELSE
  9994             MOVE ER-1775        TO EMI-ERROR
  9995             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9996
  9997     IF CL-TOTAL-PAID-AMT = ZEROS
  9998         IF PI-PMTTYPE = '4'
  9999             MOVE ER-0438        TO EMI-ERROR
 10000             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10001
 10002     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10003         IF PI-PMTTYPE = '3'
 10004             MOVE ER-0463        TO EMI-ERROR
 10005             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10006         ELSE
 10007             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10008              AND CM-LF-CURRENT-STATUS = '7'
 10009                 MOVE ER-0465    TO EMI-ERROR
 10010                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10011
 10012     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10013         IF PI-PMTTYPE = '3'
 10014             MOVE ER-0464        TO EMI-ERROR
 10015             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10016         ELSE
 10017             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10018                 MOVE ER-0469    TO EMI-ERROR
 10019                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10020
 10021     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10022         IF PI-PMTTYPE = '3'
 10023             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10024                 MOVE ER-0467    TO EMI-ERROR
 10025                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10026             ELSE
 10027                 NEXT SENTENCE
 10028         ELSE
 10029             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10030                 MOVE ER-0468    TO EMI-ERROR
 10031                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10032
 10033     GO TO 1045-EDIT-PAYEE-ADDR.
 10034
 10035 1040-PMTTYPE-ERROR.
 10036     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10037
 10038     IF EMI-MESSAGE-FORMATTED
 10039         MOVE -1                 TO PMTTYPEL
 10040         MOVE AL-UABON           TO PMTTYPEA.
 10041
 10042 1040-EXIT.
 10043     EXIT.
 10044
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 189
* EL156.cbl
 10046 1045-EDIT-PAYEE-ADDR.
 10047
 10048     IF PI-OFFLINE = 'N' AND
 10049        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10050           < PI-PAYEE-SEQ-NUM)
 10051        OR
 10052         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10053         (PI-PAYEE-TYPE = 'B')                 AND
 10054         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10055        OR
 10056         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10057           < PI-PAYEE-SEQ-NUM)
 10058        OR
 10059         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10060           < PI-PAYEE-SEQ-NUM)
 10061        OR
 10062         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10063           < PI-PAYEE-SEQ-NUM)
 10064        OR
 10065         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10066           < PI-PAYEE-SEQ-NUM)
 10067        OR
 10068         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10069           < PI-PAYEE-SEQ-NUM))
 10070             MOVE ER-0437        TO EMI-ERROR
 10071             MOVE -1             TO PAYEEL
 10072             MOVE AL-UABON       TO PAYEEA
 10073             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10074
 10075     IF PI-OFFLINE    = 'N' AND
 10076        PI-PAYEE-TYPE = 'B' AND
 10077        PI-PAYEE-SEQ  = '0'
 10078         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10079         IF BENE-FOUND-SW = 'N'
 10080             MOVE ER-0437        TO EMI-ERROR
 10081             MOVE -1             TO PAYEEL
 10082             MOVE AL-UABON       TO PAYEEA
 10083             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10084
 10085     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10086        IF PI-OFFLINE    = 'N'  AND
 10087           PI-PAYEE-TYPE = 'B'  AND
 10088           PI-PAYEE-SEQ  = '9'
 10089             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10090             IF BENE-FOUND-SW = 'N'
 10091                MOVE ER-0437        TO EMI-ERROR
 10092                MOVE -1             TO PAYEEL
 10093                MOVE AL-UABON       TO PAYEEA
 10094                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10095
 10096*    IF PI-COMPANY-ID = 'CRI'
 10097*        IF CL-CLAIM-TYPE = 'L'
 10098*            MOVE 'N'                TO  WS-GROUPED
 10099*                                        PI-GROUPED
 10100*                                        GROUPEDI
 10101*            MOVE AL-UANON           TO  GROUPEDA
 10102*            GO TO 1050-EDIT-CHECK-NO
 10103*        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 190
* EL156.cbl
 10104*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10105*            IF WS-GROUP-1 = 'C'
 10106*                NEXT SENTENCE
 10107*            ELSE
 10108*                MOVE 'N'            TO  WS-GROUPED
 10109*                                        PI-GROUPED
 10110*                                        GROUPEDI
 10111*                MOVE AL-UANON       TO  GROUPEDA
 10112*                GO TO 1050-EDIT-CHECK-NO.
 10113
 10114*     IF PI-GROUPED = 'Y'
 10115*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10116*           NEXT SENTENCE
 10117*        ELSE
 10118*           MOVE ER-0437        TO EMI-ERROR
 10119*           MOVE -1             TO PAYEEL
 10120**02180            MOVE AL-UABON       TO PAYEEA
 10121*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10122*
 10123*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10124*        (PI-GROUPED    = ' ')
 10125*        NEXT SENTENCE
 10126*     ELSE
 10127*
 10128     GO TO 1050-EDIT-CHECK-NO.
 10129*     IF PI-COMPANY-ID = 'CRI'
 10130*        MOVE 'N'           TO GROUPEDI
 10131*                              PI-GROUPED
 10132*                              WS-GROUPED
 10133*        MOVE AL-UANON      TO GROUPEDA.
 10134*
 10135*     IF PI-COMPANY-ID = 'CRI'
 10136*        IF PI-PAYEE-TYPE = 'B'
 10137*           IF BENE-FOUND-SW = 'Y'
 10138*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10139*                 MOVE 'Y'           TO GROUPEDI
 10140*                                       PI-GROUPED
 10141*                                       WS-GROUPED
 10142*                 MOVE AL-UANON      TO GROUPEDA
 10143*              ELSE
 10144*                 NEXT SENTENCE
 10145*           ELSE
 10146*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10147*              IF BENE-FOUND-SW = 'Y'
 10148*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10149*                    MOVE 'Y'      TO GROUPEDI
 10150*                                     PI-GROUPED
 10151*                                     WS-GROUPED
 10152*                    MOVE AL-UANON TO GROUPEDA.
 10153*
 10154
 10155     IF PI-COMPANY-ID NOT = 'CRI'
 10156        GO TO 1050-EDIT-CHECK-NO.
 10157
 10158*************** CRI CODE START ******************
 10159     IF PI-PAYEE-TYPE NOT = 'A'
 10160        GO TO 1050-EDIT-CHECK-NO.
 10161
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 191
* EL156.cbl
 10162     MOVE LOW-VALUES             TO ERACCT-KEY.
 10163     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10164     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10165     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10166     MOVE PI-STATE               TO ACCT-STATE.
 10167     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10168     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10169     MOVE 'ACCT'                 TO FILE-SWITCH.
 10170
 10171     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10172     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10173
 10174
 10175* EXEC CICS HANDLE CONDITION
 10176*         NOTFND   (1950-NOT-FOUND)
 10177*         ENDFILE  (1950-NOT-FOUND)
 10178*    END-EXEC.
 10179*    MOVE '"$I''                  ! ( #00009803' TO DFHEIV0
 10180     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10181     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10182     MOVE X'2820233030303039383033' TO DFHEIV0(25:11)
 10183     CALL 'kxdfhei1' USING DFHEIV0
 10184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10185
 10186
 10187
 10188* EXEC CICS STARTBR
 10189*         DATASET   ('ERACCT')
 10190*         RIDFLD    (ERACCT-KEY)
 10191*         GTEQ
 10192*    END-EXEC.
 10193     MOVE 'ERACCT' TO DFHEIV1
 10194     MOVE 0
 10195       TO DFHEIV11
 10196*    MOVE '&,         G          &   #00009808' TO DFHEIV0
 10197     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10198     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10199     MOVE X'2020233030303039383038' TO DFHEIV0(25:11)
 10200     CALL 'kxdfhei1' USING DFHEIV0,
 10201           DFHEIV1,
 10202           ERACCT-KEY,
 10203           DFHEIV99,
 10204           DFHEIV11,
 10205           DFHEIV99
 10206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10207
 10208
 10209 1046-READNEXT-ERACCT.
 10210
 10211
 10212* EXEC CICS READNEXT
 10213*         DATASET   ('ERACCT')
 10214*         RIDFLD    (ERACCT-KEY)
 10215*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10216*    END-EXEC.
 10217     MOVE 'ERACCT' TO DFHEIV1
 10218     MOVE 0
 10219       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 192
* EL156.cbl
 10220*    MOVE '&.S                   )   #00009816' TO DFHEIV0
 10221     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10222     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10223     MOVE X'2020233030303039383136' TO DFHEIV0(25:11)
 10224     CALL 'kxdfhei1' USING DFHEIV0,
 10225           DFHEIV1,
 10226           DFHEIV20,
 10227           DFHEIV99,
 10228           ERACCT-KEY,
 10229           DFHEIV99,
 10230           DFHEIV11,
 10231           DFHEIV99,
 10232           DFHEIV99
 10233     SET ADDRESS OF ACCOUNT-MASTER TO
 10234         DFHEIV20
 10235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10236
 10237
 10238     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10239        IF WS-ERACCT-HOLD-RECORD = SPACES
 10240           GO TO 1950-NOT-FOUND
 10241        ELSE
 10242           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10243           GO TO 1048-CONTINUE.
 10244
 10245     IF ACCT-EXP-DT = HIGH-VALUES
 10246        NEXT SENTENCE
 10247     ELSE
 10248        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10249        GO TO 1046-READNEXT-ERACCT.
 10250
 10251 1048-CONTINUE.
 10252
 10253*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10254*       MOVE 'Y'                 TO GROUPEDI
 10255*                                   PI-GROUPED
 10256*                                   WS-GROUPED
 10257*       MOVE AL-UANON            TO GROUPEDA.
 10258*************** CRI CODE END ******************
 10259
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 193
* EL156.cbl
 10261 1050-EDIT-CHECK-NO.
 10262
 10263     IF PI-OFFLINE = 'Y'
 10264         IF PI-ECHECKNO = SPACES
 10265              MOVE ER-0439        TO EMI-ERROR
 10266              GO TO 1090-CHECK-NO-ERROR
 10267           ELSE
 10268*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10269*           IF PI-ECHECKNO-N = 'N' AND
 10270*              PI-CASH       = 'Y'
 10271*                MOVE ER-3535        TO EMI-ERROR
 10272*                GO TO 1090-CHECK-NO-ERROR
 10273*             ELSE
 10274*                MOVE AL-UANON    TO CHECKNOA
 10275*                GO TO 1100-EDIT-HOLDTIL
 10276*         ELSE
 10277            MOVE AL-UANON    TO CHECKNOA
 10278            GO TO 1100-EDIT-HOLDTIL.
 10279
 10280     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10281     MOVE '6'                    TO CNTL-REC-TYPE.
 10282
 10283     IF CONTROL-IS-ACTUAL-CARRIER
 10284         MOVE PI-CARRIER         TO WS-CARR
 10285     ELSE
 10286         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10287
 10288     IF PI-COMPANY-ID = 'FIA'
 10289         MOVE PI-CARRIER         TO WS-CARR.
 10290
 10291     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10292     MOVE 0                      TO CNTL-SEQ-NO.
 10293     MOVE 'CARR'                 TO FILE-SWITCH.
 10294
 10295     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10296
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 194
* EL156.cbl
 10298     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10299         GO TO 1051-EDIT-CHECKNO-CONT.
 10300
 10301**********************AIG LOGIC STARTS**********************
 10302     IF PI-ECHECKNO = SPACES
 10303         IF CHECK-NO-MANUAL
 10304             MOVE ER-0441        TO EMI-ERROR
 10305             GO TO 1090-CHECK-NO-ERROR
 10306         ELSE
 10307             MOVE AL-UANOF       TO CHECKNOA
 10308             GO TO 1100-EDIT-HOLDTIL.
 10309
 10310     IF PI-ECHECKNO NOT = SPACES
 10311         IF CHECK-NO-MANUAL
 10312             MOVE AL-UANON       TO CHECKNOA
 10313             GO TO 1100-EDIT-HOLDTIL.
 10314
 10315     IF PI-ECHECKNO-CR = 'CR'
 10316        IF PI-OFFLINE = 'Y'
 10317            MOVE AL-UANON       TO CHECKNOA
 10318            GO TO 1100-EDIT-HOLDTIL
 10319        ELSE
 10320            MOVE ER-3534        TO EMI-ERROR
 10321            GO TO 1090-CHECK-NO-ERROR.
 10322
 10323     IF PI-ECHECKNO-N = 'N'
 10324        IF PI-CASH = 'N'
 10325            MOVE AL-UANON       TO CHECKNOA
 10326            GO TO 1100-EDIT-HOLDTIL
 10327        ELSE
 10328            MOVE ER-3535          TO EMI-ERROR
 10329            GO TO 1090-CHECK-NO-ERROR.
 10330
 10331     MOVE ER-0442        TO EMI-ERROR
 10332     GO TO 1090-CHECK-NO-ERROR.
 10333**********************AIG LOGIC ENDS************************
 10334
 10335 1051-EDIT-CHECKNO-CONT.
 10336
 10337     IF PI-COMPANY-ID = 'DMD'
 10338        IF PI-ECHECKNO NOT = SPACES
 10339           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10340              MOVE ER-0442        TO EMI-ERROR
 10341              GO TO 1090-CHECK-NO-ERROR
 10342            ELSE
 10343              GO TO 1100-EDIT-HOLDTIL
 10344          ELSE
 10345           GO TO 1100-EDIT-HOLDTIL.
 10346
 10347     IF PI-ECHECKNO = SPACES
 10348         IF CHECK-NO-MANUAL
 10349             MOVE ER-0441        TO EMI-ERROR
 10350             GO TO 1090-CHECK-NO-ERROR
 10351         ELSE
 10352             MOVE AL-UANOF       TO CHECKNOA
 10353             GO TO 1100-EDIT-HOLDTIL
 10354     ELSE
 10355         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 195
* EL156.cbl
 10356             MOVE AL-UANON       TO CHECKNOA
 10357             GO TO 1100-EDIT-HOLDTIL
 10358         ELSE
 10359             MOVE ER-0442        TO EMI-ERROR
 10360             GO TO 1090-CHECK-NO-ERROR.
 10361
 10362 1090-CHECK-NO-ERROR.
 10363     MOVE -1                     TO CHECKNOL.
 10364     MOVE AL-UABON               TO CHECKNOA.
 10365     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10366
 10367     GO TO 2000-EDIT-DONE.
 10368
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 196
* EL156.cbl
 10370 1100-EDIT-HOLDTIL.
 10371     MOVE AL-UANON               TO HOLDTILA.
 10372
 10373     IF PI-HOLDTIL = ZEROS
 10374        IF PI-OFFLINE = 'Y'
 10375           MOVE ER-0572          TO EMI-ERROR
 10376           GO TO 1105-HOLDTIL-ERROR
 10377        ELSE
 10378           GO TO 1110-EDIT-PAID-FROM.
 10379
 10380     MOVE '4'                    TO DC-OPTION-CODE.
 10381     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10382     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10383
 10384     IF DATE-CONVERSION-ERROR
 10385         MOVE ER-0446            TO EMI-ERROR
 10386         GO TO 1105-HOLDTIL-ERROR
 10387     END-IF
 10388     IF PI-OFFLINE = 'Y'
 10389        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10390           MOVE ER-0446            TO EMI-ERROR
 10391           GO TO 1105-HOLDTIL-ERROR
 10392        END-IF
 10393     END-IF
 10394
 10395     IF PI-OFFLINE = 'Y'
 10396        GO TO 1110-EDIT-PAID-FROM.
 10397
 10398     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10399     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10400     MOVE '1'                    TO DC-OPTION-CODE.
 10401     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10402
 10403     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10404         MOVE ER-0447            TO EMI-ERROR
 10405         GO TO 1105-HOLDTIL-ERROR.
 10406
 10407     GO TO 1110-EDIT-PAID-FROM.
 10408
 10409 1105-HOLDTIL-ERROR.
 10410     MOVE -1                     TO HOLDTILL.
 10411     MOVE AL-UNBON               TO HOLDTILA.
 10412     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10413
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 197
* EL156.cbl
 10415 1110-EDIT-PAID-FROM.
 10416     MOVE AL-UANON               TO EPYFROMA.
 10417
 10418     IF PI-EPYFROM = ZEROS
 10419         GO TO 1120-CALCULATE-PAID-FROM.
 10420
 10421     IF PI-PMTTYPE = '5' OR '6'
 10422         MOVE ER-0448            TO EMI-ERROR
 10423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10424         MOVE AL-UNBON           TO EPYFROMA
 10425         MOVE -1                 TO EPYFROML
 10426         GO TO 1150-EDIT-PAID-THRU.
 10427
 10428     MOVE '4'                    TO DC-OPTION-CODE.
 10429     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10430     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10431
 10432     IF DATE-CONVERSION-ERROR
 10433         MOVE ER-0449            TO EMI-ERROR
 10434         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10435         MOVE AL-UNBON           TO EPYFROMA
 10436         MOVE -1                 TO EPYFROML
 10437     ELSE
 10438         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10439
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 198
* EL156.cbl
 10441 1120-CALCULATE-PAID-FROM.
 10442     IF PI-PMTTYPE = '5' OR '6'
 10443         GO TO 1150-EDIT-PAID-THRU.
 10444
 10445*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10446*       IF PI-PMTTYPE = '4'
 10447*         GO TO 1150-EDIT-PAID-THRU.
 10448
 10449     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10450         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10451         MOVE ' '                TO DC-OPTION-CODE
 10452         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10453         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10454         GO TO 1145-TEST-PAID-FROM.
 10455
 10456     IF PI-PMTTYPE = '4'
 10457        GO TO 1150-EDIT-PAID-THRU.
 10458
 10459     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10460     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10461     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10462     MOVE '5'                    TO CNTL-REC-TYPE.
 10463     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10464     MOVE 'BENE'                 TO FILE-SWITCH.
 10465
 10466     IF WS-BEN-CD = ZEROS
 10467         GO TO 1950-NOT-FOUND.
 10468
 10469     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10470
 10471     IF NO-BENEFIT-FOUND
 10472         GO TO 1950-NOT-FOUND.
 10473
 10474     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10475     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10476
 10477     IF PI-BEN-DAYS NOT NUMERIC
 10478        MOVE ZEROS               TO PI-BEN-DAYS.
 10479
 10480     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10481
 10482     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10483        (CL-TOTAL-PAID-AMT > ZEROS)
 10484         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10485         MOVE '6'                 TO DC-OPTION-CODE
 10486         MOVE +0                  TO DC-ELAPSED-MONTHS
 10487         MOVE +1                  TO DC-ELAPSED-DAYS
 10488         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10489         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10490         GO TO 1145-TEST-PAID-FROM.
 10491
 10492******************************************************************
 10493****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10494****** SPECIAL ENTERED DATE.
 10495******************************************************************
 10496
 10497     IF PI-AIGFROM = ZEROS
 10498         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 199
* EL156.cbl
 10499
 10500     MOVE AL-UANON TO AIGFROMA.
 10501
 10502     MOVE '4'                    TO DC-OPTION-CODE.
 10503     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10504     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10505
 10506     IF DATE-CONVERSION-ERROR
 10507         MOVE ER-0449            TO EMI-ERROR
 10508         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10509         MOVE AL-UNBON           TO AIGFROMA
 10510         MOVE -1                 TO AIGFROML
 10511         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10512     ELSE
 10513         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10514         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10515
 10516     GO TO 1140-CONTINUE-PAID-FROM.
 10517
 10518 1130-CONTINUE-PAID-FROM.
 10519
 10520     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10521        (CL-TOTAL-PAID-AMT = ZEROS)
 10522           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10523
 10524 1140-CONTINUE-PAID-FROM.
 10525
 10526     IF PI-BEN-TYPE = 'R'
 10527         IF PI-BEN-DAYS = ZEROS
 10528             NEXT SENTENCE
 10529         ELSE
 10530         IF PI-COMPANY-ID NOT = 'DMD'
 10531             SUBTRACT 1 FROM PI-BEN-DAYS.
 10532
 10533     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10534
 10535     IF PI-COMPANY-ID = 'DMD'
 10536         MOVE -1                 TO DC-ELAPSED-DAYS
 10537         MOVE +0                 TO DC-ELAPSED-MONTHS
 10538         MOVE '6'                TO DC-OPTION-CODE
 10539         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10540         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10541         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10542                               REMAINDER DC-ELAPSED-DAYS
 10543      ELSE
 10544         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10545         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10546
 10547     MOVE '6'                    TO DC-OPTION-CODE.
 10548     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10549     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10550
 10551     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10552
 10553     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10554         MOVE ER-0541            TO EMI-ERROR
 10555         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10556         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 200
* EL156.cbl
 10557         MOVE AL-UNBON           TO EPYFROMA.
 10558
 10559     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10560        (PI-BENEFIT-SAVE = '60E')
 10561        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10562           (CL-TOTAL-PAID-AMT = ZEROS)
 10563             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10564             MOVE 30                  TO DC-ELAPSED-DAYS
 10565             MOVE +0                  TO DC-ELAPSED-MONTHS
 10566             MOVE '6'                 TO DC-OPTION-CODE
 10567             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10568
 10569     IF PI-BEN-TYPE = 'R'
 10570         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10571     ELSE
 10572         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10573         IF WS-SV-EPYFROM = LOW-VALUES
 10574            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10575
 10576     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10577         IF WS-USE-AIG-PAYFROM   OR
 10578            WS-AIG-RECALC-PAYFROM
 10579              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10580                                      DC-BIN-DATE-1
 10581              MOVE ' '            TO  DC-OPTION-CODE
 10582              MOVE +0             TO  DC-ELAPSED-MONTHS
 10583                                      DC-ELAPSED-DAYS
 10584              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10585              IF NO-CONVERSION-ERROR
 10586                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10587
 10588     IF PI-CPYFROM < CL-INCURRED-DT
 10589        MOVE -1                  TO EPYFROML
 10590        MOVE ER-3542             TO EMI-ERROR
 10591        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10592
 10593     IF CM-ENTRY-DT < CL-INCURRED-DT
 10594        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10595        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10596        MOVE +0                     TO DC-ELAPSED-DAYS
 10597        MOVE +0                     TO DC-ELAPSED-MONTHS
 10598        MOVE '1'                    TO DC-OPTION-CODE
 10599        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10600        ELSE
 10601        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10602
 10603     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10604         NEXT SENTENCE
 10605     ELSE
 10606         IF DC-ELAPSED-MONTHS < 2
 10607             MOVE ER-3255        TO EMI-ERROR
 10608             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10609
 10610 1145-TEST-PAID-FROM.
 10611     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10612         GO TO 1150-EDIT-PAID-THRU.
 10613
 10614     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 201
* EL156.cbl
 10615         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10616         MOVE ' '                TO DC-OPTION-CODE
 10617         MOVE +0                 TO DC-ELAPSED-MONTHS
 10618                                    DC-ELAPSED-DAYS
 10619         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10620         IF NO-CONVERSION-ERROR
 10621             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10622         ELSE
 10623             MOVE SPACES             TO EMI-DATE-FIELD.
 10624
 10625     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10626         IF CL-TOTAL-PAID-AMT = ZEROS
 10627             MOVE ER-3543            TO EMI-ERROR
 10628             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10629             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10630             IF EMI-MESSAGE-FORMATTED
 10631                MOVE -1             TO EPYFROML
 10632                MOVE AL-UNBON       TO EPYFROMA
 10633             ELSE
 10634                NEXT SENTENCE
 10635         ELSE
 10636             MOVE ER-0452            TO EMI-ERROR
 10637             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10638             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10639             IF EMI-MESSAGE-FORMATTED
 10640                MOVE -1             TO EPYFROML
 10641                MOVE AL-UNBON       TO EPYFROMA.
 10642
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 202
* EL156.cbl
 10644 1150-EDIT-PAID-THRU.
 10645
 10646     MOVE AL-UANON               TO EPYTHRUA.
 10647
 10648     IF PI-EPYTHRU = ZEROS
 10649         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10650             GO TO 1200-EDIT-FIND-TOLERANCES
 10651         ELSE
 10652            IF (PI-PMTTYPE = '3') OR
 10653               (PI-PMTTYPE = '2' AND
 10654                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10655               GO TO 1152-CHECK-TYPE
 10656            ELSE
 10657               MOVE ER-0473      TO EMI-ERROR
 10658               GO TO 1170-PAID-THRU-FATAL-ERROR
 10659     ELSE
 10660         IF PI-PMTTYPE = '5' OR '6'
 10661             MOVE ER-0474        TO EMI-ERROR
 10662             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10663
 10664     MOVE '4'                    TO DC-OPTION-CODE.
 10665     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10666     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10667
 10668     IF DATE-CONVERSION-ERROR
 10669         MOVE ER-0475            TO EMI-ERROR
 10670         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10671
 10672     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10673
 10674     IF PI-COMPANY-ID = 'DMD'
 10675         IF PI-PMTTYPE NOT = '2'
 10676                 AND
 10677            WS-EXP-DT > WS-SV-EPYTHRU
 10678             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10679             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10680             MOVE '1'              TO DC-OPTION-CODE
 10681             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10682             IF DATE-CONVERSION-ERROR
 10683                 MOVE ER-0944      TO EMI-ERROR
 10684                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10685             ELSE
 10686                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10687                    DC-ELAPSED-DAYS   = 1
 10688                     MOVE ER-0945  TO EMI-ERROR
 10689                     MOVE -1       TO EPYTHRUL
 10690                     MOVE AL-UABON TO EPYTHRUA
 10691                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10692
 10693     IF PI-PMTTYPE = '4'
 10694         NEXT SENTENCE
 10695     ELSE
 10696         IF WS-SV-EPYTHRU = WS-EXP-DT
 10697             IF PI-PMTTYPE NOT = '2' AND '3'
 10698                 MOVE ER-3541    TO EMI-ERROR
 10699                 MOVE -1         TO PMTTYPEL
 10700                 MOVE AL-UABON   TO PMTTYPEA
 10701                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 203
* EL156.cbl
 10702
 10703     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10704         MOVE ER-0501            TO EMI-ERROR
 10705         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10706
 10707     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10708        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 10709*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10710*              MOVE ER-0540         TO EMI-ERROR
 10711*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10712*              MOVE -1              TO EPYTHRUL
 10713*              MOVE AL-UNBON        TO EPYTHRUA
 10714*          ELSE
 10715*          IF PI-COMPANY-ID = 'DMD'
 10716*              MOVE ER-7540         TO EMI-ERROR
 10717*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10718*              MOVE -1              TO EPYTHRUL
 10719*              MOVE AL-UNBON        TO EPYTHRUA
 10720*          ELSE
 10721               IF PI-PMTTYPE NOT = '2' AND '3'
 10722                  IF PI-COMPANY-ID = '???'
 10723                      MOVE ER-7540  TO EMI-ERROR
 10724                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10725                      MOVE -1       TO EPYTHRUL
 10726                      MOVE AL-UNBON TO EPYTHRUA
 10727                  ELSE
 10728                      MOVE ER-0540  TO EMI-ERROR
 10729                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10730                      MOVE -1       TO EPYTHRUL
 10731                      MOVE AL-UNBON TO EPYTHRUA.
 10732
 10733     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10734            OR
 10735        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10736         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10737            OR
 10738        (PI-CPYFROM NOT = LOW-VALUES AND
 10739         PI-CPYFROM < CL-PAID-THRU-DT)
 10740        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10741
 10742 1152-CHECK-TYPE.
 10743     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 10744        OR (PI-PMTTYPE = '5' OR '6')
 10745         GO TO 1160-EDIT-PAID-THRU-AH.
 10746
 10747 1155-EDIT-PAID-THRU-LIFE.
 10748     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10749     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10750     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10751     MOVE '4'                    TO CNTL-REC-TYPE.
 10752     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10753     MOVE 'BENE'                 TO FILE-SWITCH.
 10754
 10755     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10756
 10757     IF NO-BENEFIT-FOUND
 10758         GO TO 1950-NOT-FOUND.
 10759
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 204
* EL156.cbl
 10760     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10761
 10762     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10763
 10764     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10765        PI-LF-COVERAGE-TYPE = 'P'
 10766         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10767         GO TO 1200-EDIT-FIND-TOLERANCES.
 10768
 10769     IF PI-EPYTHRU = ZEROS
 10770        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10771
 10772     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10773         MOVE ER-0476            TO EMI-ERROR
 10774         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10775
 10776     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10777*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10778     move cl-critical-period    to dc-elapsed-months
 10779     MOVE +0                    TO DC-ELAPSED-DAYS.
 10780     MOVE '6'                   TO DC-OPTION-CODE.
 10781     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10782
 10783     IF (NO-CONVERSION-ERROR AND
 10784         WS-SPECIAL-CALC-CD = 'C')
 10785        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10786            MOVE ER-0657 TO EMI-ERROR
 10787            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10788
 10789     IF PI-COMPANY-ID = 'NCL'
 10790         IF WS-SPECIAL-CALC-CD = 'C' AND
 10791            cl-critical-period = zeros
 10792*           CM-LF-CRITICAL-PERIOD = +0
 10793             MOVE ER-0844       TO EMI-ERROR
 10794             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10795
 10796     GO TO 1200-EDIT-FIND-TOLERANCES.
 10797
 10798 1160-EDIT-PAID-THRU-AH.
 10799     IF PI-EPYTHRU = ZEROS
 10800        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10801                                    WS-SV-EPYTHRU
 10802     ELSE
 10803        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10804
 10805     IF WS-SV-EPYTHRU < PI-CPYFROM
 10806         MOVE ER-0508            TO EMI-ERROR
 10807         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10808
 10809     perform 7975-read-acct      thru 7975-exit
 10810     move zeros                  to pi-max-ext
 10811     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10812        PERFORM 0900-GET-DDF-LIMITS
 10813                                 THRU 0900-EXIT
 10814        IF PDEF-FOUND
 10815           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10816              (P1 > +8)
 10817              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 205
* EL156.cbl
 10818           END-PERFORM
 10819           IF P1 < +9
 10820              MOVE PD-MAX-extension (P1)
 10821                                 TO pi-max-ext
 10822           else
 10823              move er-1674       to emi-error
 10824              PERFORM 9900-ERROR-FORMAT
 10825                                 THRU 9900-EXIT
 10826           END-IF
 10827        else
 10828           move er-1672          to emi-error
 10829           PERFORM 9900-ERROR-FORMAT
 10830                                 THRU 9900-EXIT
 10831        END-IF
 10832     end-if
 10833     move spaces                 to pi-max-ext-used
 10834     IF PI-PMTTYPE = '3'
 10835        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10836        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10837           MOVE ER-0477          TO EMI-ERROR
 10838           PERFORM 1165-PAID-THRU-ERROR
 10839                                 THRU 1165-EXIT
 10840        ELSE
 10841           continue
 10842        end-if
 10843     ELSE
 10844        IF WS-SV-EPYTHRU > WS-EXP-DT
 10845           move ws-exp-dt        to dc-bin-date-1
 10846           move ws-sv-epythru    to dc-bin-date-2
 10847           MOVE '1'              TO DC-OPTION-CODE
 10848           MOVE +0               TO DC-ELAPSED-DAYS
 10849                                    DC-ELAPSED-MONTHS
 10850           PERFORM 9700-LINK-DATE-CONVERT
 10851                                 THRU 9700-EXIT
 10852           if no-conversion-error
 10853              if dc-elapsed-days > zeros
 10854                 add +1 to dc-elapsed-months
 10855              end-if
 10856              if dc-elapsed-months > pi-max-ext
 10857                 MOVE ER-0557    TO EMI-ERROR
 10858                 PERFORM 1165-PAID-THRU-ERROR
 10859                                 THRU 1165-EXIT
 10860              else
 10861                 move 'Y'        to pi-max-ext-used
 10862                 move er-1670    to emi-error
 10863                 perform 9900-error-format
 10864                                 thru 9900-exit
 10865              end-if
 10866           end-if
 10867        end-if
 10868     end-if
 10869
 10870     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10871         PI-PMTTYPE NOT = '3'
 10872         MOVE ER-0541        TO EMI-ERROR
 10873         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10874
 10875     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 206
* EL156.cbl
 10876        (PI-PMTTYPE NOT = '3')
 10877         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10878             MOVE ER-0478        TO EMI-ERROR
 10879             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10880
 10881     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10882        (PI-PMTTYPE NOT = '4')
 10883         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10884             MOVE ER-0479        TO EMI-ERROR
 10885             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10886
 10887     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10888         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10889             MOVE ER-0545        TO EMI-ERROR
 10890             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10891
 10892     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10893         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10894             MOVE ER-0481        TO EMI-ERROR
 10895             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10896
 10897*    IF PI-COMPANY-ID = 'NCL'
 10898*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10899*           CM-AH-CRITICAL-PERIOD = +0
 10900*            MOVE ER-0844        TO  EMI-ERROR
 10901*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10902
 10903*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10904     if (cl-critical-period = zeros)
 10905        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10906          GO TO 1200-EDIT-FIND-TOLERANCES.
 10907
 10908     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10909     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10910     MOVE '1'        TO DC-OPTION-CODE.
 10911     MOVE +0         TO DC-ELAPSED-DAYS
 10912                        DC-ELAPSED-MONTHS.
 10913     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10914
 10915*    IF NO-CONVERSION-ERROR
 10916*       COMPUTE ws-benefits-paid =
 10917*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10918*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 10919*           MOVE ER-0657 TO EMI-ERROR
 10920*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10921
 10922     GO TO 1200-EDIT-FIND-TOLERANCES.
 10923
 10924 1165-PAID-THRU-ERROR.
 10925     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10926
 10927     IF EMI-MESSAGE-FORMATTED
 10928         MOVE -1                 TO EPYTHRUL
 10929         MOVE AL-UNBON           TO EPYTHRUA.
 10930
 10931 1165-EXIT.
 10932     EXIT.
 10933
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 207
* EL156.cbl
 10934 1166-CHECK-ALL-TRLRS.
 10935
 10936     IF PI-PMTTYPE = '4'
 10937        GO TO 1166-TRLR-EXIT.
 10938
 10939     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10940
 10941     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10942        WS-SV-EPYFROM = LOW-VALUES
 10943          GO TO 1166-END-CHECK.
 10944
 10945
 10946* EXEC CICS HANDLE CONDITION
 10947*        ENDFILE   (1166-END-CHECK)
 10948*        NOTFND    (1166-END-CHECK)
 10949*    END-EXEC.
 10950*    MOVE '"$''I                  ! ) #00010529' TO DFHEIV0
 10951     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10952     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10953     MOVE X'2920233030303130353239' TO DFHEIV0(25:11)
 10954     CALL 'kxdfhei1' USING DFHEIV0
 10955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10956
 10957
 10958     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10959     MOVE +100                   TO TRLR-SEQ-NO.
 10960
 10961
 10962* EXEC CICS STARTBR
 10963*         DATASET    ('ELTRLR')
 10964*         RIDFLD     (ELTRLR-KEY)
 10965*         GTEQ
 10966*    END-EXEC.
 10967     MOVE 'ELTRLR' TO DFHEIV1
 10968     MOVE 0
 10969       TO DFHEIV11
 10970*    MOVE '&,         G          &   #00010537' TO DFHEIV0
 10971     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10972     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10973     MOVE X'2020233030303130353337' TO DFHEIV0(25:11)
 10974     CALL 'kxdfhei1' USING DFHEIV0,
 10975           DFHEIV1,
 10976           ELTRLR-KEY,
 10977           DFHEIV99,
 10978           DFHEIV11,
 10979           DFHEIV99
 10980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10981
 10982
 10983     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10984
 10985 1166-READ-TRLR-NEXT.
 10986
 10987
 10988* EXEC CICS READNEXT
 10989*         DATASET    ('ELTRLR')
 10990*         RIDFLD     (ELTRLR-KEY)
 10991*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 208
* EL156.cbl
 10992*    END-EXEC.
 10993     MOVE 'ELTRLR' TO DFHEIV1
 10994     MOVE 0
 10995       TO DFHEIV11
 10996*    MOVE '&.S                   )   #00010547' TO DFHEIV0
 10997     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10998     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10999     MOVE X'2020233030303130353437' TO DFHEIV0(25:11)
 11000     CALL 'kxdfhei1' USING DFHEIV0,
 11001           DFHEIV1,
 11002           DFHEIV20,
 11003           DFHEIV99,
 11004           ELTRLR-KEY,
 11005           DFHEIV99,
 11006           DFHEIV11,
 11007           DFHEIV99,
 11008           DFHEIV99
 11009     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11010         DFHEIV20
 11011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11012
 11013
 11014     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11015        TRLR-CARRIER  = MSTR-CARRIER  AND
 11016        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11017        TRLR-CERT-NO  = MSTR-CERT-NO
 11018          NEXT SENTENCE
 11019      ELSE
 11020          GO TO 1166-END-CHECK.
 11021
 11022* **  BYPASS ALL NON-PAYMENT TRAILERS
 11023
 11024     IF AT-TRAILER-TYPE = '2'
 11025        NEXT SENTENCE
 11026     ELSE
 11027        GO TO 1166-READ-TRLR-NEXT.
 11028
 11029* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11030
 11031     IF AT-PAYMENT-TYPE = '1' OR '2'
 11032        NEXT SENTENCE
 11033     ELSE
 11034        GO TO 1166-READ-TRLR-NEXT.
 11035
 11036* **  BYPASS ALL VOID PAYMENTS
 11037
 11038     IF AT-VOID-DT NOT = LOW-VALUES
 11039        GO TO 1166-READ-TRLR-NEXT.
 11040
 11041     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11042        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11043          GO TO 1166-READ-TRLR-NEXT.
 11044
 11045     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11046         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11047            OR
 11048        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11049         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 209
* EL156.cbl
 11050        NEXT SENTENCE
 11051     ELSE
 11052         IF CL-TOTAL-PAID-AMT > ZEROS
 11053             MOVE ER-0502            TO EMI-ERROR
 11054             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11055             MOVE -1                 TO EPYTHRUL
 11056             MOVE AL-UNBON           TO EPYTHRUA.
 11057
 11058     GO TO 1166-READ-TRLR-NEXT.
 11059
 11060 1166-END-CHECK.
 11061
 11062     IF WS-BROWSE-TRLR-SW = 'Y'
 11063
 11064* EXEC CICS ENDBR
 11065*            DATASET   ('ELTRLR')
 11066*       END-EXEC.
 11067     MOVE 'ELTRLR' TO DFHEIV1
 11068     MOVE 0
 11069       TO DFHEIV11
 11070*    MOVE '&2                    $   #00010602' TO DFHEIV0
 11071     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11072     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11073     MOVE X'2020233030303130363032' TO DFHEIV0(25:11)
 11074     CALL 'kxdfhei1' USING DFHEIV0,
 11075           DFHEIV1,
 11076           DFHEIV11,
 11077           DFHEIV99
 11078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11079
 11080
 11081     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11082
 11083 1166-TRLR-EXIT.
 11084     EXIT.
 11085
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 210
* EL156.cbl
 11087 1170-PAID-THRU-FATAL-ERROR.
 11088     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11089
 11090     MOVE -1                     TO EPYTHRUL.
 11091     MOVE AL-UNBON               TO EPYTHRUA.
 11092
 11093 1200-EDIT-FIND-TOLERANCES.
 11094
 11095* EXEC CICS HANDLE CONDITION
 11096*        ENDFILE(1950-NOT-FOUND)
 11097*        NOTFND (1950-NOT-FOUND)
 11098*    END-EXEC.
 11099*    MOVE '"$''I                  ! * #00010619' TO DFHEIV0
 11100     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11102     MOVE X'2A20233030303130363139' TO DFHEIV0(25:11)
 11103     CALL 'kxdfhei1' USING DFHEIV0
 11104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11105
 11106
 11107     IF PI-PROCESSOR-ID = 'LGXX'
 11108        GO TO 1240-FIND-ACCT-TOLERANCES.
 11109
 11110     MOVE 'N'                    TO FOUND-TOL-SW.
 11111     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11112     MOVE '2'                    TO CNTL-REC-TYPE.
 11113     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11114     MOVE +0                     TO CNTL-SEQ-NO.
 11115     MOVE 'PROC'                 TO FILE-SWITCH.
 11116
 11117     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11118
 11119     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11120     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11121                                    PI-MAX-PMT-TOL.
 11122     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11123
 11124     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11125         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11126
 11127     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11128     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11129                                    PI-MAX-LF-PMT-TOL.
 11130
 11131     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11132         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11133
 11134     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11135                                    PI-MAX-EXP-PMT.
 11136
 11137 1240-FIND-ACCT-TOLERANCES.
 11138
 11139     IF WS-PMT-TOL NOT = +0
 11140         MOVE 'Y'                TO FOUND-TOL-SW.
 11141
 11142     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11143         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11144         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 211
* EL156.cbl
 11145         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11146         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11147         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11148         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11149     ELSE
 11150         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11151         MOVE PI-CARRIER             TO ACCT-CARRIER
 11152         MOVE PI-GROUPING            TO ACCT-GROUPING
 11153         MOVE PI-STATE               TO ACCT-STATE
 11154         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11155         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11156
 11157     MOVE 'ACCT'                 TO FILE-SWITCH.
 11158
 11159     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11160     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11161
 11162
 11163* EXEC CICS HANDLE CONDITION
 11164*         NOTFND   (1950-NOT-FOUND)
 11165*         ENDFILE  (1950-NOT-FOUND)
 11166*    END-EXEC.
 11167*    MOVE '"$I''                  ! + #00010679' TO DFHEIV0
 11168     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11169     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11170     MOVE X'2B20233030303130363739' TO DFHEIV0(25:11)
 11171     CALL 'kxdfhei1' USING DFHEIV0
 11172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11173
 11174
 11175
 11176* EXEC CICS STARTBR
 11177*        DATASET('ERACCT')
 11178*        RIDFLD (ERACCT-KEY)
 11179*        GTEQ
 11180*    END-EXEC.
 11181     MOVE 'ERACCT' TO DFHEIV1
 11182     MOVE 0
 11183       TO DFHEIV11
 11184*    MOVE '&,         G          &   #00010684' TO DFHEIV0
 11185     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11186     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11187     MOVE X'2020233030303130363834' TO DFHEIV0(25:11)
 11188     CALL 'kxdfhei1' USING DFHEIV0,
 11189           DFHEIV1,
 11190           ERACCT-KEY,
 11191           DFHEIV99,
 11192           DFHEIV11,
 11193           DFHEIV99
 11194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11195
 11196
 11197 1245-FIND-ACCT-TOLERANCES-LOOP.
 11198
 11199
 11200* EXEC CICS READNEXT
 11201*        DATASET('ERACCT')
 11202*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 212
* EL156.cbl
 11203*        RIDFLD (ERACCT-KEY)
 11204*    END-EXEC.
 11205     MOVE 'ERACCT' TO DFHEIV1
 11206     MOVE 0
 11207       TO DFHEIV11
 11208*    MOVE '&.S                   )   #00010692' TO DFHEIV0
 11209     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11210     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11211     MOVE X'2020233030303130363932' TO DFHEIV0(25:11)
 11212     CALL 'kxdfhei1' USING DFHEIV0,
 11213           DFHEIV1,
 11214           DFHEIV20,
 11215           DFHEIV99,
 11216           ERACCT-KEY,
 11217           DFHEIV99,
 11218           DFHEIV11,
 11219           DFHEIV99,
 11220           DFHEIV99
 11221     SET ADDRESS OF ACCOUNT-MASTER TO
 11222         DFHEIV20
 11223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11224
 11225
 11226     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11227        IF WS-ERACCT-HOLD-RECORD = SPACES
 11228           GO TO 1950-NOT-FOUND
 11229        ELSE
 11230           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11231           GO TO 1250-CONTINUE.
 11232
 11233     IF ACCT-EXP-DT = HIGH-VALUES
 11234        NEXT SENTENCE
 11235     ELSE
 11236        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11237        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11238
 11239 1250-CONTINUE.
 11240
 11241     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11242
 11243     IF FOUND-TOL-SW = 'N'
 11244         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11245
 11246********* 1260-FIND-STATE-TOLERANCES.
 11247
 11248     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11249     MOVE PI-STATE               TO WS-ST-ACCESS.
 11250     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11251     MOVE '3'                    TO CNTL-REC-TYPE.
 11252     MOVE +0                     TO CNTL-SEQ-NO.
 11253     MOVE 'STAT'                 TO FILE-SWITCH.
 11254
 11255     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11256
 11257     IF WS-PMT-TOL = +0
 11258         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11259
 11260     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 213
* EL156.cbl
 11261     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11262     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11263     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11264     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11265
 11266****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11267****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11268     IF PI-PAYEE-TYPE <> 'B'
 11269           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11270     END-IF.
 11271
 11272     IF PI-PMTTYPE      = '2'  AND
 11273        PI-SPLIT-PMT-SW = 'Y'  AND
 11274        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11275          MOVE ER-3530                TO EMI-ERROR
 11276          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11277
 11278********* 1280-FIND-BENEFIT-TOLERANCES.
 11279
 11280     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 11281        OR (PI-PMTTYPE = '5' OR '6')
 11282         GO TO 1300-FIND-CARR-TOLERANCES.
 11283
 11284     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11285     MOVE '4'                    TO CNTL-REC-TYPE.
 11286     MOVE +0                     TO CNTL-SEQ-NO.
 11287     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11288     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11289     MOVE 'BENE'                 TO FILE-SWITCH.
 11290
 11291     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11292
 11293     IF NO-BENEFIT-FOUND
 11294         GO TO 1950-NOT-FOUND.
 11295
 11296     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11297     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11298     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11299
 11300
 11301* EXEC CICS HANDLE CONDITION
 11302*        NOTFND(1950-NOT-FOUND)
 11303*    END-EXEC.
 11304*    MOVE '"$I                   ! , #00010772' TO DFHEIV0
 11305     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11307     MOVE X'2C20233030303130373732' TO DFHEIV0(25:11)
 11308     CALL 'kxdfhei1' USING DFHEIV0
 11309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11310
 11311
 11312 1300-FIND-CARR-TOLERANCES.
 11313     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11314     MOVE '6'                    TO CNTL-REC-TYPE.
 11315
 11316     IF CONTROL-IS-ACTUAL-CARRIER
 11317         MOVE PI-CARRIER               TO WS-CARR
 11318     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 214
* EL156.cbl
 11319         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11320
 11321     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11322     MOVE +0                     TO CNTL-SEQ-NO.
 11323     MOVE 'CARR'                 TO FILE-SWITCH.
 11324
 11325     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11326
 11327     IF WS-DAYS-TOL = +0
 11328         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11329
 11330     IF WS-PMT-TOL = +0
 11331         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11332
 11333     IF WS-MAX-DAYS-TOL = +0
 11334         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11335
 11336     IF WS-MAX-PMT-TOL = +0
 11337         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11338                                    PI-MAX-PMT-TOL.
 11339
 11340     IF WS-MAX-LF-PMT-TOL = +0
 11341        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11342                                    PI-MAX-LF-PMT-TOL.
 11343
 11344     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11345
 11346********* 1320-FIND-COMP-TOLERANCES.
 11347
 11348     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11349     MOVE '1'                    TO CNTL-REC-TYPE.
 11350     MOVE SPACES                 TO CNTL-ACCESS.
 11351     MOVE +0                     TO CNTL-SEQ-NO.
 11352     MOVE 'COMP'                 TO FILE-SWITCH.
 11353
 11354     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11355
 11356     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11357     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11358
 11359     IF WS-PMT-TOL NOT = +0
 11360        IF WS-TOL-SEVERITY NOT = ' '
 11361         GO TO 1360-EDIT-DAYS.
 11362
 11363     IF WS-PMT-TOL = +0
 11364         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11365
 11366     IF WS-TOL-SEVERITY = ' '
 11367         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11368
 11369 1360-EDIT-DAYS.
 11370     IF PI-PMTTYPE NOT = '4'
 11371        IF PI-EDAYS NEGATIVE OR
 11372           PI-EPYAMT NEGATIVE
 11373          MOVE ER-0513             TO EMI-ERROR
 11374          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11375          MOVE -1                  TO PMTTYPEL.
 11376
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 215
* EL156.cbl
 11377     IF PI-PMTTYPE = '5' OR '6'
 11378        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11379
 11380     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11381        IF PI-PMTTYPE = '4'
 11382          MOVE PI-EDAYS          TO PI-CDAYS.
 11383
 11384     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11385         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11386
 11387     IF PI-PMTTYPE = '4'
 11388        MOVE PI-EDAYS            TO PI-CDAYS
 11389        GO TO 1400-EDIT-PAYMENT.
 11390
 11391     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11392        GO TO 1500-EDIT-EXPENSES.
 11393
 11394*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11395*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11396*          CM-AH-BENEFIT-CD = '23'              AND
 11397*          CL-CERT-STATE    = '04'              AND
 11398*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11399*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11400*            GO TO 1362-CHECK-MAX-DAYS.
 11401
 11402     IF PI-EDAYS = ZEROS
 11403*        IF PI-COMPANY-ID = 'DMD'
 11404*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11405*            MOVE -1             TO DC-ELAPSED-DAYS
 11406*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11407*            MOVE '6'            TO DC-OPTION-CODE
 11408*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11409*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11410*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11411*            MOVE '1'            TO DC-OPTION-CODE
 11412*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11413*            IF NO-CONVERSION-ERROR
 11414*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11415*                                 + DC-ODD-DAYS-OVER
 11416*               MOVE 6           TO EDAYSL
 11417*               MOVE AL-UNNON    TO EDAYSA
 11418*            ELSE
 11419*                NEXT SENTENCE
 11420*       ELSE
 11421            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11422            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11423            MOVE '1'             TO DC-OPTION-CODE
 11424            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11425            IF NO-CONVERSION-ERROR
 11426                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11427                ADD 1                 TO PI-EDAYS
 11428                MOVE AL-UNNON         TO EDAYSA.
 11429
 11430*    IF PI-COMPANY-ID = 'DMD'
 11431*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11432*        MOVE -1                 TO DC-ELAPSED-DAYS
 11433*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11434*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 216
* EL156.cbl
 11435*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11436*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11437*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11438*        MOVE '1'                TO DC-OPTION-CODE
 11439*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11440*    ELSE
 11441         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11442         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11443         MOVE '1'                TO DC-OPTION-CODE.
 11444         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11445
 11446     IF NO-CONVERSION-ERROR
 11447        IF PI-COMPANY-ID = 'DMD'
 11448            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11449                             + DC-ODD-DAYS-OVER
 11450        ELSE
 11451            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11452            ADD 1                TO PI-CDAYS.
 11453
 11454     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11455        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11456        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11457
 11458     IF PI-EDAYS NOT NUMERIC
 11459         MOVE ER-0491            TO EMI-ERROR
 11460         GO TO 1370-DAYS-ERROR.
 11461
 11462     IF CL-NO-OF-PMTS-MADE = 0
 11463        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11464        AND CL-CERT-STATE = 'MI'
 11465        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11466            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11467     END-IF.
 11468
 11469 1362-CHECK-MAX-DAYS.
 11470
 11471     IF WS-MAX-DAYS-TOL = +999
 11472         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11473
 11474     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11475         IF PI-EDAYS = ZEROS
 11476             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11477         ELSE
 11478             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11479
 11480     IF WS-MAX-DAYS-TOL NOT = ZERO
 11481        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11482           PI-CDAYS > WS-MAX-DAYS-TOL
 11483             MOVE ER-0492          TO EMI-ERROR
 11484             GO TO 1370-DAYS-ERROR.
 11485
 11486 1365-SKIP-MAX-DAYS-EDIT.
 11487     IF PI-EDAYS = ZEROS
 11488        GO TO 1400-EDIT-PAYMENT.
 11489
 11490     IF WS-DAYS-TOL NOT = ZERO
 11491        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11492           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 217
* EL156.cbl
 11493                MOVE ER-0493     TO EMI-ERROR
 11494                GO TO 1370-DAYS-ERROR.
 11495
 11496     GO TO 1400-EDIT-PAYMENT.
 11497
 11498 1370-DAYS-ERROR.
 11499     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11500
 11501     IF EMI-MESSAGE-FORMATTED
 11502         MOVE -1                 TO EDAYSL
 11503         MOVE AL-UABON           TO EDAYSA.
 11504
 11505     GO TO 1400-EDIT-PAYMENT.
 11506
 11507 1380-EDIT-EXPENSE-PMT-AMT.
 11508     IF PI-PMTTYPE = '5' OR '6'
 11509         NEXT SENTENCE
 11510     ELSE
 11511         GO TO 1400-EDIT-PAYMENT.
 11512
 11513     IF WS-MAX-EXP-PMT NOT = ZEROS
 11514        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11515            MOVE ER-3529            TO EMI-ERROR
 11516            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11517
 11518     GO TO 1500-EDIT-EXPENSES.
 11519
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 218
* EL156.cbl
 11521
 11522 1390-CHECK-PAYMENT-DAYS.
 11523
 11524     IF PI-EDAYS = 0
 11525         MOVE PI-CDAYS TO WS-PD-DAYS
 11526     ELSE
 11527         MOVE PI-EDAYS TO WS-PD-DAYS
 11528     END-IF.
 11529
 11530     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11531         IF WS-PD-DAYS = 14
 11532            GO TO 1390-EXIT
 11533         END-IF
 11534     END-IF.
 11535
 11536     IF PI-COMPANY-ID = 'AHL'  AND
 11537        CM-AH-BENEFIT-CD = '1K'
 11538         IF WS-PD-DAYS = 14
 11539            GO TO 1390-EXIT
 11540         END-IF
 11541     END-IF.
 11542
 11543     IF WS-PD-DAYS < 30
 11544         MOVE ER-3549              TO EMI-ERROR
 11545         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11546     END-IF.
 11547
 11548 1390-EXIT.
 11549      EXIT.
 11550
 11551 1400-EDIT-PAYMENT.
 11552*    IF PI-COMPANY-ID = 'DMD'
 11553*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11554*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11555
 11556     IF PI-COMPANY-ID = 'DCC'
 11557        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11558        MOVE PI-CARRIER          TO ACCT-CARRIER
 11559        MOVE PI-GROUPING         TO ACCT-GROUPING
 11560        MOVE PI-STATE            TO ACCT-STATE
 11561        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11562        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11563        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11564        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11565
 11566
 11567* EXEC CICS READ
 11568*          DATASET ('ERACCT')
 11569*          RIDFLD  (ERACCT-KEY)
 11570*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11571*          GTEQ
 11572*          resp    (WS-RESPONSE)
 11573*       END-EXEC
 11574     MOVE 'ERACCT' TO DFHEIV1
 11575*    MOVE '&"S        G          (  N#00011030' TO DFHEIV0
 11576     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11577     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11578     MOVE X'204E233030303131303330' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 219
* EL156.cbl
 11579     CALL 'kxdfhei1' USING DFHEIV0,
 11580           DFHEIV1,
 11581           DFHEIV20,
 11582           DFHEIV99,
 11583           ERACCT-KEY,
 11584           DFHEIV99,
 11585           DFHEIV99,
 11586           DFHEIV99
 11587     SET ADDRESS OF ACCOUNT-MASTER TO
 11588         DFHEIV20
 11589     MOVE EIBRESP  TO WS-RESPONSE
 11590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11591        IF WS-RESP-NORMAL
 11592           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11593           and pi-cert-eff-dt < am-expiration-dt
 11594           and pi-cert-eff-dt >= am-effective-dt
 11595           move am-dcc-product-code to pi-dcc-product-code
 11596        else
 11597           move spaces           to pi-dcc-product-code
 11598        end-if
 11599        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11600           PERFORM 0900-GET-DDF-LIMITS
 11601                                 THRU 0900-EXIT
 11602           IF PDEF-FOUND
 11603              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11604                 (P1 > +8)
 11605                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11606              END-PERFORM
 11607              IF P1 < +9
 11608                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11609                    MOVE PD-MAX-AMT (P1)
 11610                                 TO CM-AH-BENEFIT-AMT
 11611                 end-if
 11612              else
 11613                 move er-1674    to emi-error
 11614                 PERFORM 9900-ERROR-FORMAT
 11615                                 THRU 9900-EXIT
 11616              END-IF
 11617           else
 11618              move er-1672       to emi-error
 11619              PERFORM 9900-ERROR-FORMAT
 11620                                 THRU 9900-EXIT
 11621           END-IF
 11622        end-if
 11623     END-IF
 11624     IF PI-PMTTYPE NOT = '4'
 11625        GO TO 1405-CALC-PAYMENT.
 11626
 11627     IF PI-EDAYS NOT NUMERIC
 11628         MOVE PI-EPYAMT           TO PI-CPYAMT
 11629         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11630         GO TO 1430-CHECK-AH-TOLERANCE.
 11631
 11632*    IF PI-COMPANY-ID = 'FIA'
 11633*       IF CERT-ACCOUNT = '0000011043'
 11634*        COMPUTE PI-DAILY-RATE ROUNDED =
 11635*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11636*        COMPUTE PI-CPYAMT ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 220
* EL156.cbl
 11637*                          PI-DAILY-RATE * PI-EDAYS
 11638*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11639*        GO TO 1430-CHECK-AH-TOLERANCE.
 11640
 11641     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11642         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11643         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11644         GO TO 1420-CHECK-AIG-BENEFIT.
 11645
 11646     IF WS-CALC-METHOD = '2' OR  '5'
 11647         COMPUTE PI-DAILY-RATE ROUNDED =
 11648                        (CM-AH-BENEFIT-AMT * 12) / 365
 11649         COMPUTE PI-CPYAMT ROUNDED =
 11650                           PI-DAILY-RATE * PI-EDAYS
 11651        GO TO 1420-CHECK-AIG-BENEFIT.
 11652
 11653     IF WS-CALC-METHOD = '3'
 11654         COMPUTE PI-DAILY-RATE =
 11655                         (CM-AH-BENEFIT-AMT * 12) / 365
 11656         COMPUTE PI-CPYAMT ROUNDED =
 11657                           PI-DAILY-RATE * PI-EDAYS
 11658        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 221
* EL156.cbl
 11660*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11661
 11662****************************************************************
 11663****************************************************************
 11664*                  CALCULATED FROM      PAYMENT      PAYMENT
 11665*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11666* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11667*1-01-83  1-15-83    0    15     15        15           15
 11668*1-01-83  1-30-83    0    30     30        30           30
 11669*1-01-83  1-31-83    1     0     31        30           30
 11670*1-01-83  2-01-83    1     1     32        31           31
 11671*1-01-83  2-15-83    1    15     46        45           45
 11672*1-01-83  2-28-83    2     0     59        60           60
 11673*1-01-83  3-01-83    2     1     60        61           61
 11674*1-01-83  3-31-83    3     0     90        90           90
 11675*1-15-83  1-31-83    0    17     17        17           16
 11676*1-15-83  2-01-83    0    18     18        18           17
 11677*1-15-83  2-28-83    1    14     45        44           46
 11678*1-21-83  3-09-83    1    20     48        50           49
 11679*2-05-83  3-06-83    1     2     30        32           32
 11680*2-05-83  3-23-83    1    19     47        49           49
 11681*2-15-83  2-28-83    0    14     14        14           16
 11682*2-15-83  3-01-83    0    15     15        15           17
 11683*2-21-83  3-19-83    0    27     27        27           29
 11684*2-21-83  3-20-83    1     0     28        30           30
 11685*2-21-83  4-10-83    1    18     49        30           50
 11686*2-21-83  5-19-83    2    27     88        87           89
 11687*2-21-83  5-22-83    3     2     91        92           92
 11688*3-21-83  5-19-83    1    30     60        60           59
 11689****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 222
* EL156.cbl
 11691 1405-CALC-PAYMENT.
 11692     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11693     MOVE ' '                    TO DC-OPTION-CODE.
 11694     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11695     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11696     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11697
 11698     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11699     MOVE ' '                    TO DC-OPTION-CODE.
 11700     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11701     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11702     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11703
 11704     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11705     MOVE -1                     TO DC-ELAPSED-DAYS.
 11706     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11707     MOVE '6'                    TO DC-OPTION-CODE.
 11708     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11709     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11710
 11711     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11712     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11713     MOVE '1'                    TO DC-OPTION-CODE.
 11714     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11715
 11716     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11717     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11718     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11719
 11720******************************************************************
 11721*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11722*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11723*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11724******************************************************************
 11725
 11726     IF WS-CALC-METHOD = '1'           AND
 11727        DC-ELAPSED-MONTHS > ZERO AND
 11728        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11729        WDF-DAY > WDT-DAY
 11730          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11731          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11732          MOVE -1                  TO DC-ELAPSED-MONTHS
 11733          MOVE '6'                 TO DC-OPTION-CODE
 11734          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11735          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11736          COMPUTE WS-SAVE-ODD-DAYS =
 11737          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11738          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11739
 11740     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11741     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11742     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11743
 11744     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11745     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11746
 11747*    IF PI-COMPANY-ID = 'FIA'
 11748*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 223
* EL156.cbl
 11749*        COMPUTE PI-DAILY-RATE ROUNDED =
 11750*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11751*        COMPUTE PI-CPYAMT ROUNDED =
 11752*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11753*        GO TO 1420-CHECK-AIG-BENEFIT.
 11754
 11755*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11756*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11757*          CM-AH-BENEFIT-CD = '23'               AND
 11758*          CL-CERT-STATE    = '04'               AND
 11759*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11760*            COMPUTE WS-DAILY-RATE ROUNDED =
 11761*                               CM-AH-BENEFIT-AMT / 30
 11762*            COMPUTE PI-CPYAMT ROUNDED =
 11763*                               (WS-DAILY-RATE * PI-CDAYS)
 11764*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11765*            GO TO 1420-CHECK-AIG-BENEFIT.
 11766
 11767     IF WS-CALC-METHOD = '1'
 11768         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11769         COMPUTE PI-CPYAMT ROUNDED =
 11770             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11771             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11772         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11773         GO TO 1420-CHECK-AIG-BENEFIT.
 11774
 11775     IF WS-CALC-METHOD = '2'
 11776         COMPUTE PI-DAILY-RATE ROUNDED =
 11777                          (CM-AH-BENEFIT-AMT * 12) / 365
 11778         COMPUTE PI-CPYAMT ROUNDED =
 11779             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11780             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11781         GO TO 1420-CHECK-AIG-BENEFIT.
 11782
 11783     IF WS-CALC-METHOD = '4'
 11784         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11785         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11786         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11787         COMPUTE PI-CPYAMT ROUNDED =
 11788                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11789         GO TO 1420-CHECK-AIG-BENEFIT.
 11790
 11791     IF WS-CALC-METHOD = '5'
 11792         COMPUTE PI-DAILY-RATE ROUNDED =
 11793                            (CM-AH-BENEFIT-AMT * 12) / 365
 11794         COMPUTE PI-CPYAMT ROUNDED =
 11795                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11796         GO TO 1420-CHECK-AIG-BENEFIT.
 11797
 11798     IF WS-CALC-METHOD NOT = '3'
 11799        GO TO 1410-CHECK-PAYMENT.
 11800
 11801******   CALCULATION METHOD  3  ROUTINE
 11802     COMPUTE PI-DAILY-RATE =
 11803                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11804
 11805******CHECK TO SEE IF WITHIN SAME MONTH
 11806     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 224
* EL156.cbl
 11807        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11808                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11809         GO TO 1420-CHECK-AIG-BENEFIT.
 11810
 11811******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11812     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11813             SAVE-ODD-DAYS-OVER = ZEROS
 11814      COMPUTE PI-CPYAMT  ROUNDED =
 11815                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11816      GO TO 1420-CHECK-AIG-BENEFIT.
 11817
 11818******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11819******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11820     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11821        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11822        IF WDF-MONTH > 12
 11823           ADD 1                 TO WDF-YEAR
 11824           SUBTRACT 12         FROM WDF-MONTH.
 11825
 11826******CONVERT THE NEW FROM MONTH TO BINARY
 11827     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11828        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11829        MOVE '4'              TO DC-OPTION-CODE
 11830        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11831        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11832
 11833     IF WDF-MONTH = WDT-MONTH AND
 11834        WDF-YEAR  = WDT-YEAR
 11835          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11836                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11837                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11838        ELSE
 11839          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11840          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11841          COMPUTE PI-CPYAMT ROUNDED =
 11842       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11843       +
 11844       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11845       +
 11846       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11847
 11848     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 225
* EL156.cbl
 11850 1410-CHECK-PAYMENT.
 11851******PAYMENT OPTION 6
 11852******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11853     IF SAVE-ELAPSED-MONTHS > ZERO
 11854        IF SAVE-ODD-DAYS-OVER = ZEROS
 11855           GO TO 1412-CHECK-TO-DAY
 11856        ELSE
 11857           IF WDF-DAY > WDT-DAY
 11858              IF WDF-MONTH = 02
 11859                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11860                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11861                  GO TO 1412-CHECK-TO-DAY
 11862              ELSE
 11863                  IF FROM-DAYS-IN-MONTH = 31
 11864                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11865                     GO TO 1412-CHECK-TO-DAY
 11866                  ELSE
 11867                     GO TO 1412-CHECK-TO-DAY
 11868           ELSE
 11869               GO TO 1412-CHECK-TO-DAY.
 11870
 11871     IF WDF-MONTH NOT = WDT-MONTH
 11872        IF WDF-MONTH = 02
 11873           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11874           IF WDF-DAY = 29
 11875              ADD 1              TO SAVE-ODD-DAYS-OVER
 11876           ELSE
 11877              ADD 2              TO SAVE-ODD-DAYS-OVER
 11878        ELSE
 11879           IF FROM-DAYS-IN-MONTH = 31
 11880              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11881
 11882 1412-CHECK-TO-DAY.
 11883        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11884           IF WDT-DAY = 28
 11885              ADD 2              TO SAVE-ODD-DAYS-OVER
 11886           ELSE
 11887              IF WDT-DAY = 29
 11888                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11889              ELSE
 11890                 NEXT SENTENCE
 11891        ELSE
 11892           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11893              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11894
 11895     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11896     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11897     COMPUTE PI-CPYAMT ROUNDED =
 11898         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11899         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11900
 11901     GO TO 1420-CHECK-AIG-BENEFIT.
 11902
 11903 1415-CHECK-LEAP-YEAR.
 11904     IF FROM-DAYS-IN-MONTH = 29
 11905        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11906
 11907 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 226
* EL156.cbl
 11908     EXIT.
 11909
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 227
* EL156.cbl
 11911 1420-CHECK-AIG-BENEFIT.
 11912
 11913     IF WS-SPECIAL-CALC-CD = 'Q'
 11914         GO TO 1425-CHECK-WHOLE-MONTH.
 11915
 11916*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11917*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11918*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11919*       (PI-PMTTYPE = '1' OR '2')
 11920*        NEXT SENTENCE
 11921*    ELSE
 11922         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11923         GO TO 1430-CHECK-AH-TOLERANCE.
 11924
 11925******************AIG LOGIC STARTS**********************
 11926*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11927*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11928*    MOVE ER-3533      TO EMI-ERROR.
 11929*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11930*    GO TO 1430-CHECK-AH-TOLERANCE.
 11931******************AIG LOGIC ENDS************************
 11932
 11933 1425-CHECK-WHOLE-MONTH.
 11934******************************************************************
 11935****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11936****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11937****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11938****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11939****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11940****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11941****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11942****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11943****          PAID * MONTHLY BENEFIT.                         ****
 11944******************************************************************
 11945
 11946     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11947
 11948     IF CL-NO-OF-PMTS-MADE > +0
 11949         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11950
 11951     IF PI-CDAYS < WS-BEN-DAYS
 11952         GO TO 1430-CHECK-AH-TOLERANCE.
 11953
 11954     IF PI-CDAYS = WS-BEN-DAYS
 11955         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11956         GO TO 1430-CHECK-AH-TOLERANCE.
 11957
 11958*    IF PI-COMPANY-ID = 'ACM'
 11959*       NEXT SENTENCE
 11960*    ELSE
 11961        GO TO 1425-NOT-ACM-W15C.
 11962
 11963*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11964*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11965*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11966*    MOVE '6'                    TO  DC-OPTION-CODE.
 11967*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11968*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 228
* EL156.cbl
 11969*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11970*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11971*       MOVE '1'                 TO  DC-OPTION-CODE
 11972*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11973*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11974*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11975*       IF NO-CONVERSION-ERROR
 11976*          IF (DC-ELAPSED-MONTHS > +0) OR
 11977*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11978*             NEXT SENTENCE
 11979*          ELSE
 11980*             MOVE +0            TO  PI-CPYAMT
 11981*             MOVE ER-0846       TO  EMI-ERROR
 11982*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11983*             GO TO 1430-CHECK-AH-TOLERANCE
 11984*       ELSE
 11985*           MOVE ER-0846         TO  EMI-ERROR
 11986*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11987*           GO TO 1430-CHECK-AH-TOLERANCE.
 11988*
 11989*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11990*       ADD +1 TO DC-ELAPSED-MONTHS.
 11991*
 11992*    COMPUTE PI-CPYAMT ROUNDED =
 11993*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11994*
 11995*    GO TO 1430-CHECK-AH-TOLERANCE.
 11996
 11997 1425-NOT-ACM-W15C.
 11998
 11999     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12000     MOVE '6'                        TO  DC-OPTION-CODE.
 12001     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12002     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12003
 12004     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12005     IF NO-CONVERSION-ERROR
 12006         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12007     ELSE
 12008         MOVE ER-0846                TO  EMI-ERROR
 12009         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12010         GO TO 1430-CHECK-AH-TOLERANCE.
 12011
 12012     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12013     MOVE '1'                        TO  DC-OPTION-CODE.
 12014     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12015     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12016     IF NO-CONVERSION-ERROR
 12017         IF DC-ODD-DAYS-OVER = +0
 12018             NEXT SENTENCE
 12019         ELSE
 12020             MOVE ER-0846            TO  EMI-ERROR
 12021             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12022             GO TO 1430-CHECK-AH-TOLERANCE
 12023     ELSE
 12024         MOVE ER-0846                TO  EMI-ERROR
 12025         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12026         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 229
* EL156.cbl
 12027
 12028     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12029         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12030
 12031     GO TO 1430-CHECK-AH-TOLERANCE.
 12032
 12033 1425-CONT-WHOLE-MONTH-PMTS.
 12034******************************************************************
 12035****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12036****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12037****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12038******************************************************************
 12039
 12040     IF PI-COMPANY-ID = 'ACM'
 12041        NEXT SENTENCE
 12042     ELSE
 12043        IF DC-ODD-DAYS-OVER = +0
 12044            NEXT SENTENCE
 12045        ELSE
 12046            MOVE ER-0845            TO  EMI-ERROR
 12047            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12048            GO TO 1430-CHECK-AH-TOLERANCE.
 12049
 12050     COMPUTE PI-CPYAMT ROUNDED =
 12051                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12052
 12053 1430-CHECK-AH-TOLERANCE.
 12054     IF PI-PMT-APPR-SW = 'G'
 12055         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12056
 12057*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12058*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12059*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12060*
 12061*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12062*      IF WDF-MONTH = 02
 12063*        IF SAVE-ELAPSED-MONTHS = 0
 12064*          NEXT SENTENCE
 12065*        ELSE
 12066*          IF SAVE-ODD-DAYS-OVER > 0
 12067*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12068*            COMPUTE WS-PMT-MOS ROUNDED =
 12069*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12070*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12071*                                     WS-PMT-MOS
 12072*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12073*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12074*          ELSE
 12075*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12076*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12077*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12078*                                     WS-PMT-MOS.
 12079
 12080     IF WS-MAX-PMT-TOL NOT = ZERO
 12081        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12082           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12083            MOVE ER-0494         TO  EMI-ERROR
 12084            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 230
* EL156.cbl
 12085            GO TO 1500-EDIT-EXPENSES.
 12086
 12087 1430-CONT-CHECK-AH-TOLERANCE.
 12088
 12089     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12090        GO TO 1500-EDIT-EXPENSES.
 12091
 12092     IF CM-O-B-COVERAGE
 12093        GO TO 1500-EDIT-EXPENSES.
 12094
 12095     IF PI-COMPANY-ID = 'NCL'
 12096       IF FOUND-TOL-SW = 'Y'
 12097         IF WS-PMT-TOL NOT = ZERO
 12098           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12099              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12100                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12101                  IF WS-NCL-PMT-OPTION = SPACES
 12102                      MOVE ER-0699 TO EMI-ERROR
 12103                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12104                  ELSE
 12105                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12106                      NEXT SENTENCE
 12107                  ELSE
 12108                  IF NOT WS-VALID-NCL-OPTION
 12109                      MOVE ER-0699 TO EMI-ERROR
 12110                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12111
 12112     IF WS-PMT-TOL NOT = ZERO
 12113        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12114           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12115           MOVE ER-0495          TO EMI-ERROR
 12116           PERFORM 1490-PAYMENT-ERROR
 12117                                 THRU 1490-EXIT
 12118        end-if
 12119     end-if
 12120
 12121     GO TO 1500-EDIT-EXPENSES.
 12122
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 231
* EL156.cbl
 12124 1440-COMPUTE-LIFE-REMAINING.
 12125
 12126     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12127        IF PI-PMTTYPE = '4'
 12128          MOVE PI-EPYAMT TO PI-CPYAMT
 12129          GO TO 1460-TEST-TYPE.
 12130
 12131     IF WS-LF-COVERAGE-TYPE = 'L'
 12132        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12133                          - CL-TOTAL-PAID-AMT
 12134        GO TO 1450-CHECK-MAX.
 12135
 12136     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12137        PI-LF-COVERAGE-TYPE = 'P'
 12138          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12139                              CM-LF-ITD-DEATH-AMT
 12140          GO TO 1450-CHECK-MAX.
 12141
 12142     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12143     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12144     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12145     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12146     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12147     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12148     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12149     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12150     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12151
 12152     PERFORM 9800-LINK-REM-TERM.
 12153
 12154     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12155     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12156     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12157     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12158     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12159     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12160     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12161     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12162     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12163     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12164     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12165     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12166     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12167     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12168     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12169     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12170     IF PI-COMPANY-ID = 'DCC'
 12171        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12172        MOVE PI-CARRIER          TO ACCT-CARRIER
 12173        MOVE PI-GROUPING         TO ACCT-GROUPING
 12174        MOVE PI-STATE            TO ACCT-STATE
 12175        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12176        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12177        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12178        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12179
 12180
 12181* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 232
* EL156.cbl
 12182*          DATASET ('ERACCT')
 12183*          RIDFLD  (ERACCT-KEY)
 12184*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12185*          GTEQ
 12186*          resp    (WS-RESPONSE)
 12187*       END-EXEC
 12188     MOVE 'ERACCT' TO DFHEIV1
 12189*    MOVE '&"S        G          (  N#00011626' TO DFHEIV0
 12190     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12191     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12192     MOVE X'204E233030303131363236' TO DFHEIV0(25:11)
 12193     CALL 'kxdfhei1' USING DFHEIV0,
 12194           DFHEIV1,
 12195           DFHEIV20,
 12196           DFHEIV99,
 12197           ERACCT-KEY,
 12198           DFHEIV99,
 12199           DFHEIV99,
 12200           DFHEIV99
 12201     SET ADDRESS OF ACCOUNT-MASTER TO
 12202         DFHEIV20
 12203     MOVE EIBRESP  TO WS-RESPONSE
 12204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12205        IF WS-RESP-NORMAL
 12206           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12207           and (pi-cert-eff-dt < am-expiration-dt)
 12208           and (pi-cert-eff-dt >= am-effective-dt)
 12209           move am-dcc-product-code to pi-dcc-product-code
 12210        else
 12211           move spaces           to pi-dcc-product-code
 12212        end-if
 12213        if pi-dcc-product-code not = spaces
 12214           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12215           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12216           PERFORM 0900-GET-DDF-limits
 12217                                 THRU 0900-EXIT
 12218           IF PDEF-FOUND
 12219              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12220                 (P1 > +8)
 12221                 OR (PD-PROD-CODE (P1) = 'L')
 12222              END-PERFORM
 12223              IF P1 < +9
 12224                 MOVE PD-MAX-AMT (P1)
 12225                                 TO CP-R-MAX-TOT-BEN
 12226              else
 12227                 move er-1674    to emi-error
 12228                 PERFORM 9900-ERROR-FORMAT
 12229                                 THRU 9900-EXIT
 12230              END-IF
 12231           else
 12232              move er-1672       to emi-error
 12233              PERFORM 9900-ERROR-FORMAT
 12234                                 THRU 9900-EXIT
 12235           END-IF
 12236        end-if
 12237     END-IF
 12238
 12239* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 233
* EL156.cbl
 12240*       PROGRAM  (LINK-REMAMT)
 12241*       COMMAREA (CALCULATION-PASS-AREA)
 12242*       LENGTH   (CP-COMM-LENGTH)
 12243*    END-EXEC.
 12244*    MOVE '."C                   (   #00011666' TO DFHEIV0
 12245     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12246     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12247     MOVE X'2020233030303131363636' TO DFHEIV0(25:11)
 12248     CALL 'kxdfhei1' USING DFHEIV0,
 12249           LINK-REMAMT,
 12250           CALCULATION-PASS-AREA,
 12251           CP-COMM-LENGTH,
 12252           DFHEIV99,
 12253           DFHEIV99,
 12254           DFHEIV99,
 12255           DFHEIV99
 12256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12257
 12258
 12259     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12260
 12261     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12262     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12263
 12264     IF PI-COMPANY-ID = 'BOA' AND
 12265        PI-PMTTYPE    = '2'   AND
 12266        PI-OFFLINE    = 'N'
 12267           GO TO 1441-COMPUTE-BOA-INTEREST.
 12268
 12269     IF PI-COMPANY-ID = 'NCL' AND
 12270        PI-PMTTYPE    = '2'   AND
 12271        PI-OFFLINE    = 'N'
 12272          GO TO 1442-COMPUTE-NCL-INTEREST
 12273       ELSE
 12274          GO TO 1445-CONTINUE.
 12275
 12276 1441-COMPUTE-BOA-INTEREST.
 12277     MOVE +0             TO WS-CALC-INT.
 12278
 12279     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12280     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12281     MOVE +0             TO DC-ELAPSED-MONTHS
 12282                            DC-ELAPSED-DAYS.
 12283     MOVE '1'            TO DC-OPTION-CODE.
 12284     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12285     IF NO-CONVERSION-ERROR
 12286         NEXT SENTENCE
 12287     ELSE
 12288         GO TO 1445-CONTINUE.
 12289
 12290     IF (PI-INT-RATE NOT > ZEROS)  AND
 12291        (DC-ELAPSED-DAYS > +30)
 12292         MOVE ER-3531            TO EMI-ERROR
 12293         MOVE -1                 TO PINTL
 12294         MOVE AL-UNBON           TO PINTA
 12295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12296
 12297     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 234
* EL156.cbl
 12298         GO TO 1445-CONTINUE.
 12299
 12300     IF (PI-INT-RATE NOT > ZEROS)  OR
 12301        (DC-ELAPSED-DAYS NOT > +30)
 12302         MOVE PI-EPYAMT TO PI-CPYAMT
 12303         GO TO 1441-FORMAT-NOTE.
 12304
 12305     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12306                                 *  PI-INT-RATE
 12307                                 *  DC-ELAPSED-DAYS
 12308                                 /  365
 12309                                 /  100.
 12310
 12311     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12312
 12313 1441-FORMAT-NOTE.
 12314
 12315     MOVE SPACES        TO WS-BOANOTE1.
 12316     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12317     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12318     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12319     MOVE AL-UANON      TO NOTE1A.
 12320
 12321     IF WS-CALC-INT > ZEROS
 12322         MOVE SPACES        TO WS-BOANOTE2
 12323         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12324         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12325         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12326         MOVE AL-UANON      TO NOTE2A.
 12327
 12328     GO TO 1445-CONTINUE.
 12329
 12330 1442-COMPUTE-NCL-INTEREST.
 12331     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12332     MOVE PI-STATE               TO WS-ST-ACCESS.
 12333     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12334     MOVE '3'                    TO CNTL-REC-TYPE.
 12335     MOVE +0                     TO CNTL-SEQ-NO.
 12336     MOVE 'STAT'                 TO FILE-SWITCH.
 12337
 12338     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12339
 12340     MOVE +0                 TO WS-CALC-INT.
 12341
 12342     IF ST-STAT-FROM-INCURRED
 12343         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12344       ELSE
 12345     IF ST-STAT-FROM-REPORTED
 12346         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12347       ELSE
 12348         GO TO 1445-CONTINUE.
 12349
 12350     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12351     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12352     MOVE +0                 TO DC-ELAPSED-MONTHS
 12353                                DC-ELAPSED-DAYS.
 12354     MOVE '1'                TO DC-OPTION-CODE.
 12355     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 235
* EL156.cbl
 12356     IF NO-CONVERSION-ERROR
 12357         NEXT SENTENCE
 12358     ELSE
 12359         GO TO 1445-CONTINUE.
 12360
 12361     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12362        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12363         GO TO 1445-CONTINUE.
 12364
 12365     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12366                                 *  CF-ST-STAT-INTEREST.
 12367
 12368     MOVE SPACES              TO WS-NCLNOTE1.
 12369     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12370     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12371     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12372                                 PI-PMTNOTE1
 12373                                 NOTE1I.
 12374     MOVE AL-UANON            TO NOTE1A.
 12375
 12376     IF WS-CALC-INT > ZEROS
 12377         MOVE SPACES          TO WS-NCLNOTE2
 12378         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12379         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12380         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12381                                 PI-PMTNOTE2
 12382                                 NOTE2I
 12383         MOVE AL-UANON        TO NOTE2A.
 12384
 12385     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12386
 12387 1445-CONTINUE.
 12388
 12389     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12390        GO TO 1460-TEST-TYPE.
 12391
 12392     IF CM-O-B-COVERAGE
 12393        GO TO 1460-TEST-TYPE.
 12394
 12395     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12396         GO TO 1450-CHECK-MAX.
 12397
 12398     if (pi-company-id = 'DCC')
 12399        and (pdef-found)
 12400        and (pi-epyamt > pd-max-amt (p1))
 12401        move er-1657             to emi-error
 12402        perform 1490-payment-error
 12403                                 thru 1490-exit
 12404        go to 1460-test-type
 12405     else
 12406        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12407           > PI-EPYAMT)
 12408                         OR
 12409           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12410           < PI-EPYAMT)
 12411           MOVE ER-0594          TO EMI-ERROR
 12412           PERFORM 1490-PAYMENT-ERROR
 12413                                 THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 236
* EL156.cbl
 12414           GO TO 1460-TEST-TYPE
 12415        end-if
 12416     end-if
 12417     .
 12418 1450-CHECK-MAX.
 12419
 12420     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12421        PI-LF-COVERAGE-TYPE = 'P'
 12422         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12423                                   CM-LF-ITD-DEATH-AMT
 12424     ELSE
 12425         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12426                                   CL-TOTAL-PAID-AMT.
 12427
 12428     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12429          MOVE ER-0543           TO EMI-ERROR
 12430          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12431
 12432 1460-TEST-TYPE.
 12433
 12434     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12435        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12436           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12437                                   CM-LF-ALT-BENEFIT-AMT -
 12438                                   CL-TOTAL-PAID-AMT
 12439           IF PI-EPYAMT > WS-LF-BEN-AMT
 12440               MOVE ER-0543      TO EMI-ERROR
 12441               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12442           END-IF
 12443        END-IF
 12444     END-IF
 12445
 12446     IF PI-PMT-APPR-SW = 'G'
 12447       NEXT SENTENCE
 12448     ELSE
 12449       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12450         IF PI-EPYAMT = ZERO
 12451             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12452                 MOVE ER-0494    TO  EMI-ERROR
 12453                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12454                 GO TO 1500-EDIT-EXPENSES
 12455             ELSE
 12456                 NEXT SENTENCE
 12457         ELSE
 12458             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12459                 MOVE ER-0494    TO  EMI-ERROR
 12460                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12461                 GO TO 1500-EDIT-EXPENSES.
 12462
 12463     IF PI-PMTTYPE NOT = '2' OR
 12464        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12465         GO TO 1500-EDIT-EXPENSES.
 12466
 12467     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12468     MOVE ER-0526                TO EMI-ERROR.
 12469     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12470
 12471     IF EMI-ERROR-NUMBER (1) = '0526'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 237
* EL156.cbl
 12472        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12473
 12474     IF EMI-ERROR-NUMBER (2) = '0526'
 12475        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12476
 12477     GO TO 1500-EDIT-EXPENSES.
 12478
 12479 1490-PAYMENT-ERROR.
 12480     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12481
 12482     IF EMI-MESSAGE-FORMATTED
 12483         MOVE -1                 TO EPYAMTL
 12484         MOVE AL-UNBON           TO EPYAMTA.
 12485
 12486 1490-EXIT.
 12487      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 238
* EL156.cbl
 12489 1500-EDIT-EXPENSES.
 12490     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12491         GO TO 1500-SKIP-ERROR-0556.
 12492
 12493 1500-CONTINUE-ON.
 12494
 12495     IF CM-O-B-COVERAGE
 12496        MOVE ER-0556             TO EMI-ERROR
 12497        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12498
 12499 1500-SKIP-ERROR-0556.
 12500     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12501        IF PI-EEXPENS NOT = ZEROS
 12502           MOVE ER-0524          TO EMI-ERROR
 12503           GO TO 1590-EXPENSE-ERROR
 12504        ELSE
 12505           GO TO 1600-EDIT-RESERVES.
 12506
 12507     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12508     MOVE '6'                    TO CNTL-REC-TYPE.
 12509
 12510     IF CONTROL-IS-ACTUAL-CARRIER
 12511         MOVE PI-CARRIER         TO WS-CARR
 12512     ELSE
 12513         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12514
 12515     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12516     MOVE +0                     TO CNTL-SEQ-NO.
 12517     MOVE 'CARR'                 TO FILE-SWITCH.
 12518
 12519     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12520
 12521     IF EXPENSE-CALC-MANUAL
 12522        GO TO 1600-EDIT-RESERVES.
 12523
 12524     IF DOLLARS-PER-PMT
 12525        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12526        GO TO 1600-EDIT-RESERVES.
 12527
 12528     IF DOLLARS-PER-MONTH AND
 12529        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 12530       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12531       GO TO 1600-EDIT-RESERVES.
 12532
 12533     IF PERCENT-OF-PAYMENT
 12534        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12535
 12536     GO TO 1600-EDIT-RESERVES.
 12537
 12538 1590-EXPENSE-ERROR.
 12539     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12540
 12541     IF EMI-MESSAGE-FORMATTED
 12542        MOVE -1                  TO EEXPENSL
 12543        MOVE AL-UNBON            TO EEXPENSA.
 12544
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 239
* EL156.cbl
 12546 1600-EDIT-RESERVES.
 12547     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12548        IF PI-ERESV = ZEROS
 12549           GO TO 1700-EDIT-EXPENSE-TYPE
 12550        ELSE
 12551           MOVE ER-0525          TO EMI-ERROR
 12552           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12553           GO TO 1700-EDIT-EXPENSE-TYPE.
 12554
 12555     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12556     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12557     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12558
 12559     IF NOT AT-MANUAL-RESERVES-USED
 12560        IF PI-ERESV NOT = ZEROS
 12561           MOVE ER-0518          TO EMI-ERROR
 12562           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12563
 12564     IF AT-MANUAL-RESERVES-USED
 12565        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12566        GO TO 1700-EDIT-EXPENSE-TYPE.
 12567
 12568     IF AT-FUTURE-RESERVES-USED
 12569        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12570
 12571     IF AT-FUTURE-RESERVES-USED
 12572        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12573
 12574     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12575        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12576
 12577     IF AT-IBNR-RESERVES-USED
 12578        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12579
 12580     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12581     GO TO 1700-EDIT-EXPENSE-TYPE.
 12582
 12583 1690-RESERVE-ERROR.
 12584     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12585
 12586     IF EMI-MESSAGE-FORMATTED
 12587        MOVE AL-UNBON            TO ERESVA
 12588        MOVE -1                  TO ERESVL.
 12589
 12590 1690-EXIT.
 12591      EXIT.
 12592
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 240
* EL156.cbl
 12594 1700-EDIT-EXPENSE-TYPE.
 12595     IF PI-PMTTYPE NOT = '5' AND '6'
 12596        GO TO 2000-EDIT-DONE.
 12597
 12598     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12599                   '6' OR '7' OR '8' OR '9'
 12600        GO TO 2000-EDIT-DONE.
 12601
 12602 1705-EXPENSE-ERROR.
 12603     MOVE ER-0573                TO EMI-ERROR.
 12604     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12605
 12606     IF EMI-MESSAGE-FORMATTED
 12607        MOVE AL-UABON            TO ETYPEA
 12608        MOVE -1                  TO ETYPEL.
 12609
 12610     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 241
* EL156.cbl
 12612 1950-NOT-FOUND.
 12613     IF FILE-SWITCH = 'MSTR'
 12614        MOVE ER-0204             TO EMI-ERROR.
 12615
 12616     IF FILE-SWITCH = 'CARR'
 12617        MOVE ER-0252             TO EMI-ERROR.
 12618
 12619     IF FILE-SWITCH = 'COMP'
 12620        MOVE ER-0254             TO EMI-ERROR.
 12621
 12622     IF FILE-SWITCH = 'STAT'
 12623        MOVE ER-0149             TO EMI-ERROR.
 12624
 12625     IF FILE-SWITCH = 'PROC'
 12626        MOVE ER-0019             TO EMI-ERROR.
 12627
 12628     IF FILE-SWITCH = 'ACCT'
 12629        MOVE ER-0198             TO EMI-ERROR.
 12630
 12631     IF FILE-SWITCH = 'BENE'
 12632        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12633           MOVE ER-0282          TO EMI-ERROR
 12634        ELSE
 12635           MOVE ER-0283          TO EMI-ERROR.
 12636
 12637     MOVE -1                     TO PMTTYPEL.
 12638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12639
 12640     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12641                                     WS-FORCE-CTR.
 12642
 12643     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12644                                     WS-FATAL-CTR.
 12645
 12646     GO TO 8200-SEND-DATAONLY.
 12647
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 242
* EL156.cbl
 12649 2000-EDIT-DONE.
 12650*********************
 12651     perform 2210-dcc-max-benes thru 2210-exit
 12652     if pi-company-id not = 'DCC'
 12653        IF (WS-SPECIAL-CALC-CD = 'C')
 12654           and (cl-critical-period > 0)
 12655           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12656              IF PI-EPYAMT > ZEROS
 12657                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12658                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12659              ELSE
 12660                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12661                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12662              END-IF
 12663              if ws-benefits-paid > cl-critical-period
 12664                 MOVE ER-0657          TO EMI-ERROR
 12665                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12666              END-IF
 12667           END-IF
 12668        END-IF
 12669     end-if
 12670     IF PI-HOLDTIL NOT = ZEROS
 12671        MOVE PI-HOLDTIL          TO HOLDTILO
 12672        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12673
 12674     IF PI-EPYFROM NOT = ZEROS
 12675        MOVE PI-EPYFROM          TO EPYFROMO
 12676        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12677
 12678     IF PI-EPYTHRU NOT = ZEROS
 12679        MOVE PI-EPYTHRU            TO EPYTHRUO
 12680        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12681        IF PI-USES-PAID-TO
 12682           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12683           MOVE '4'                TO DC-OPTION-CODE
 12684           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12685           IF NO-CONVERSION-ERROR
 12686              MOVE +1              TO DC-ELAPSED-DAYS
 12687              MOVE +0              TO DC-ELAPSED-MONTHS
 12688              MOVE '6'             TO DC-OPTION-CODE
 12689              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12690              IF NO-CONVERSION-ERROR
 12691                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12692
 12693     MOVE PI-EDAYS               TO EDAYSO.
 12694
 12695     IF PI-AIGFROM NOT = ZEROS
 12696        MOVE PI-AIGFROM          TO AIGFROMO
 12697        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12698
 12699     MOVE PI-EPYAMT              TO EPYAMTO.
 12700     MOVE PI-ERESV               TO ERESVO.
 12701     MOVE PI-EEXPENS             TO EEXPENSO.
 12702
 12703     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12704     MOVE SPACES                 TO DC-OPTION-CODE.
 12705     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12706
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 243
* EL156.cbl
 12707     IF DATE-CONVERSION-ERROR
 12708        MOVE SPACES              TO CPYFROMI
 12709     ELSE
 12710        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12711        IF PI-EPYFROM = ZEROS
 12712           MOVE AL-UANON             TO EPYFROMA
 12713           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12714           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12715
 12716     IF PI-USES-PAID-TO
 12717        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12718        MOVE +1                            TO DC-ELAPSED-DAYS
 12719        MOVE +0                            TO DC-ELAPSED-MONTHS
 12720        MOVE '6'                           TO DC-OPTION-CODE
 12721        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12722        IF NO-CONVERSION-ERROR
 12723           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12724           IF PI-EPYTHRU = ZEROS
 12725              MOVE AL-UANON                TO EPYTHRUA
 12726              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12727              MOVE ' '                     TO DC-OPTION-CODE
 12728              MOVE +0                      TO DC-ELAPSED-DAYS
 12729                                              DC-ELAPSED-MONTHS
 12730              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12731              IF NO-CONVERSION-ERROR
 12732                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12733                  GO TO 2001-CONTINUE
 12734              ELSE
 12735                  GO TO 2001-CONTINUE
 12736           ELSE
 12737              GO TO 2001-CONTINUE.
 12738
 12739     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12740     MOVE SPACES                 TO DC-OPTION-CODE.
 12741     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12742
 12743     IF DATE-CONVERSION-ERROR
 12744        MOVE SPACES              TO CPYTHRUI
 12745     ELSE
 12746        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12747        IF PI-EPYTHRU = ZEROS
 12748           MOVE AL-UANON TO EPYTHRUA
 12749           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12750           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12751
 12752 2001-CONTINUE.
 12753
 12754     MOVE PI-CDAYS               TO CDAYSO.
 12755
 12756     IF PI-EDAYS = ZEROS
 12757        MOVE AL-UNNON TO EDAYSA
 12758        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12759
 12760     MOVE PI-CPYAMT              TO CPYAMTO.
 12761
 12762     IF PI-EPYAMT = ZEROS
 12763        MOVE AL-UNNON            TO EPYAMTA
 12764        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 244
* EL156.cbl
 12765
 12766     MOVE PI-CRESV               TO CRESVO.
 12767     MOVE PI-CEXPENS             TO CEXPENSO.
 12768
 12769     IF PI-EEXPENS = ZEROS
 12770        MOVE AL-UNNON TO EEXPENSA
 12771        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12772
 12773     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12774        AND (CL-CLAIM-TYPE = 'L')
 12775        AND (PI-OFFLINE NOT EQUAL 'Y')
 12776        IF PI-PMTTYPE = '2' OR '4'
 12777           PERFORM 2200-CALC-INTEREST
 12778                                 THRU 2200-EXIT
 12779        END-IF
 12780     END-IF
 12781     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12782     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12783     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12784
 12785     IF EMI-FATAL-CTR = ZEROS
 12786        MOVE 'B'                 TO PI-PASS-SW.
 12787
 12788     IF NOT EMI-MESSAGE-FORMATTED
 12789         MOVE -1                 TO EPYFROML
 12790     ELSE
 12791         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12792            EMI-ERROR-NUMBER (2) = SPACES
 12793             MOVE -1             TO EPYFROML.
 12794
 12795     GO TO 8200-SEND-DATAONLY.
 12796
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 245
* EL156.cbl
 12798 2200-CALC-INTEREST.
 12799     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12800        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12801        MOVE '4'                 TO DC-OPTION-CODE
 12802        PERFORM 9700-LINK-DATE-CONVERT
 12803        IF DATE-CONVERSION-ERROR
 12804            MOVE LOW-VALUES      TO CP-PRF-DT
 12805        ELSE
 12806           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12807        END-IF
 12808     END-IF
 12809     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12810        IN CLAIM-INT-PASS-AREA
 12811     MOVE CL-CERT-STATE          TO CP-STATE
 12812        IN CLAIM-INT-PASS-AREA
 12813     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12814     MOVE 'LF'                   TO CP-COVERAGE
 12815     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12816     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12817     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12818     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12819     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12820     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12821
 12822* EXEC CICS LINK
 12823*       PROGRAM   ('ELCLMI')
 12824*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12825*       LENGTH    (CP-CLAIM-LENGTH)
 12826*    END-EXEC
 12827     MOVE 'ELCLMI' TO DFHEIV1
 12828*    MOVE '."C                   (   #00012234' TO DFHEIV0
 12829     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12830     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12831     MOVE X'2020233030303132323334' TO DFHEIV0(25:11)
 12832     CALL 'kxdfhei1' USING DFHEIV0,
 12833           DFHEIV1,
 12834           CLAIM-INT-PASS-AREA,
 12835           CP-CLAIM-LENGTH,
 12836           DFHEIV99,
 12837           DFHEIV99,
 12838           DFHEIV99,
 12839           DFHEIV99
 12840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12841     MOVE AL-PANOF               TO PINTHA
 12842                                    PINTA
 12843     IF NO-CI-ERROR
 12844        MOVE CP-CLM-INT-AMT      TO PINTO
 12845                                    PI-INT-AMT
 12846        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12847        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12848        MOVE AL-PANOF            TO PINTHA
 12849                                    PINTA
 12850     ELSE
 12851        IF CI-RETURN-CODE = '8'
 12852           MOVE ER-3818          TO EMI-ERROR
 12853           MOVE -1               TO ZINTL
 12854           PERFORM 9900-ERROR-FORMAT
 12855                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 246
* EL156.cbl
 12856           GO TO 2200-EXIT
 12857        ELSE
 12858           MOVE ZEROS            TO PINTO
 12859                                    PI-INT-AMT
 12860                                    PI-INT-DAYS
 12861                                    PI-INT-RATE-USED
 12862        END-IF
 12863     END-IF
 12864     IF PI-INT-AMT NOT = ZEROS
 12865        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12866           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12867           CONTINUE
 12868        ELSE
 12869           MOVE CL-SOC-SEC-NO (1:3)
 12870                                 TO WS-SSN (1:3)
 12871           MOVE CL-SOC-SEC-NO (5:2)
 12872                                 TO WS-SSN (4:2)
 12873           MOVE CL-SOC-SEC-NO (8:4)
 12874                                 TO WS-SSN (6:4)
 12875           IF (WS-SSN NUMERIC)
 12876              AND (WS-SSN NOT = ZEROS)
 12877              CONTINUE
 12878           ELSE
 12879              MOVE ER-2044       TO EMI-ERROR
 12880              PERFORM 9900-ERROR-FORMAT
 12881                                 THRU 9900-EXIT
 12882           END-IF
 12883        END-IF
 12884        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12885        MOVE +51                 TO TRLR-SEQ-NO
 12886
 12887* EXEC CICS READ
 12888*          DATASET  ('ELTRLR')
 12889*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12890*          RIDFLD   (ELTRLR-KEY)
 12891*          RESP     (WS-RESPONSE)
 12892*       END-EXEC
 12893     MOVE 'ELTRLR' TO DFHEIV1
 12894*    MOVE '&"S        E          (  N#00012284' TO DFHEIV0
 12895     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12896     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12897     MOVE X'204E233030303132323834' TO DFHEIV0(25:11)
 12898     CALL 'kxdfhei1' USING DFHEIV0,
 12899           DFHEIV1,
 12900           DFHEIV20,
 12901           DFHEIV99,
 12902           ELTRLR-KEY,
 12903           DFHEIV99,
 12904           DFHEIV99,
 12905           DFHEIV99
 12906     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12907         DFHEIV20
 12908     MOVE EIBRESP  TO WS-RESPONSE
 12909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12910        IF (NOT WS-RESP-NORMAL)
 12911                    OR
 12912           ((WS-RESP-NORMAL)
 12913           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 247
* EL156.cbl
 12914           OR (AT-CITY-STATE = SPACES)))
 12915           MOVE ER-0874          TO EMI-ERROR
 12916           PERFORM 9900-ERROR-FORMAT
 12917                                 THRU 9900-EXIT
 12918        END-IF
 12919     END-IF
 12920     .
 12921 2200-EXIT.
 12922     EXIT.
 12923 2210-dcc-max-benes.
 12924
 12925     move pi-ah-term             to ws-max-bens
 12926     if cl-critical-period not = zeros and spaces
 12927        move cl-critical-period  to ws-max-bens
 12928     end-if
 12929     move cm-ah-benefit-amt      to ws-monthly-benefit
 12930     if pdef-found
 12931        and (pd-max-amt (p1) not = zeros)
 12932        and (pd-max-amt (p1) < ws-monthly-benefit)
 12933        move pd-max-amt (p1)     to ws-monthly-benefit
 12934     end-if
 12935
 12936     move cl-cert-key-data       to elcrtt-key (2:21)
 12937     move cl-company-cd          to ctrlr-comp-cd
 12938     move cl-cert-no             to ctrlr-cert-no
 12939     move 'B'                    to ctrlr-rec-type
 12940
 12941
 12942* EXEC CICS READ
 12943*       DATASET  ('ELCRTT')
 12944*       set      (address of CERTIFICATE-TRAILERS)
 12945*       RIDFLD   (ELCRTT-KEY)
 12946*       RESP     (WS-RESPONSE)
 12947*    END-EXEC
 12948     MOVE 'ELCRTT' TO DFHEIV1
 12949*    MOVE '&"S        E          (  N#00012321' TO DFHEIV0
 12950     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12951     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12952     MOVE X'204E233030303132333231' TO DFHEIV0(25:11)
 12953     CALL 'kxdfhei1' USING DFHEIV0,
 12954           DFHEIV1,
 12955           DFHEIV20,
 12956           DFHEIV99,
 12957           ELCRTT-KEY,
 12958           DFHEIV99,
 12959           DFHEIV99,
 12960           DFHEIV99
 12961     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12962         DFHEIV20
 12963     MOVE EIBRESP  TO WS-RESPONSE
 12964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12965     IF not WS-RESP-NORMAL
 12966        go to 2210-exit
 12967     end-if
 12968
 12969*    if instypei = 'P'
 12970*       move +1 to s1
 12971*    else
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 248
* EL156.cbl
 12972*       MOVE +2 to s1
 12973*    end-if
 12974
 12975*    move +1 to s1
 12976*    evaluate cl-claim-type
 12977*       when 'A'
 12978*          move +1 to s2
 12979*       when 'I'
 12980*          move +2 to s2
 12981*       when 'G'
 12982*          move +3 to s2
 12983*       when 'L'
 12984*          move +4 to s2
 12985*       when 'P'
 12986*          move +5 to s2
 12987*    end-evaluate
 12988
 12989     move zeros                  to ws-prev-days-paid
 12990                                    ws-benefits-paid
 12991                                    ws-prev-amt-paid
 12992     perform varying s1 from +1 by +1 until
 12993        (s1 > +24)
 12994        or (cs-claim-type (s1) = spaces)
 12995        if pi-company-id not = 'DCC'
 12996           if cs-claim-type (s1) = cl-claim-type
 12997              compute ws-prev-days-paid =
 12998                 ws-prev-days-paid + cs-days-paid (s1)
 12999              compute ws-prev-amt-paid =
 13000                 ws-prev-amt-paid + cs-total-paid (s1)
 13001           end-if
 13002        else
 13003           if (cs-claim-type (s1) = cl-claim-type)
 13004              and (cs-benefit-period (s1) = cl-benefit-period)
 13005              and (cs-insured-type (s1) = cl-insured-type)
 13006              compute ws-prev-days-paid =
 13007                 ws-prev-days-paid + cs-days-paid (s1)
 13008              compute ws-prev-amt-paid =
 13009                 ws-prev-amt-paid + cs-total-paid (s1)
 13010           end-if
 13011        end-if
 13012     end-perform
 13013     if pi-epyamt > zeros
 13014        compute ws-benefits-paid =
 13015           (ws-prev-amt-paid + pi-epyamt)
 13016           / ws-monthly-benefit
 13017     else
 13018        compute ws-benefits-paid =
 13019           (ws-prev-amt-paid + pi-cpyamt)
 13020           / ws-monthly-benefit
 13021     end-if
 13022     if pi-company-id = 'DCC'
 13023     if cl-claim-type not = 'L' and 'P'
 13024        if ws-benefits-paid > ws-max-bens
 13025           move er-1658          to emi-error
 13026           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13027        end-if
 13028     end-if
 13029     end-if
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 249
* EL156.cbl
 13030*     if s1 < +25
 13031*        if pi-epyamt > zeros
 13032*           compute ws-benefits-paid =
 13033*              (cs-total-paid (s1) + PI-EPYAMT)
 13034*              / ws-monthly-benefit
 13035*        else
 13036*           compute ws-benefits-paid =
 13037*              (cs-total-paid (s1) + PI-CPYAMT)
 13038*              / ws-monthly-benefit
 13039*        end-if
 13040
 13041*       if ws-benefits-paid > pd-crit-period (p1)
 13042*        if ws-benefits-paid > ws-max-bens
 13043*           move er-1658          to emi-error
 13044*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13045*        end-if
 13046*     end-if
 13047     .
 13048 2210-exit.
 13049     exit.
 13050
 13051 2220-update-elcrtt.
 13052
 13053
 13054* EXEC CICS GETMAIN
 13055*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13056*       LENGTH   (ELCRTT-LENGTH)
 13057*       INITIMG  (GETMAIN-SPACE)
 13058*    END-EXEC
 13059*    MOVE ',"IL                  $   #00012415' TO DFHEIV0
 13060     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13061     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13062     MOVE X'2020233030303132343135' TO DFHEIV0(25:11)
 13063     CALL 'kxdfhei1' USING DFHEIV0,
 13064           DFHEIV20,
 13065           ELCRTT-LENGTH,
 13066           GETMAIN-SPACE
 13067     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13068         DFHEIV20
 13069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13070
 13071     move cl-cert-key-data       to elcrtt-key (2:21)
 13072     move cl-company-cd          to ctrlr-comp-cd
 13073     move cl-cert-no             to ctrlr-cert-no
 13074     move 'B'                    to ctrlr-rec-type
 13075
 13076
 13077* EXEC CICS READ
 13078*       UPDATE
 13079*       DATASET  (ELCRTT-DSID)
 13080*       into     (CERTIFICATE-TRAILERS)
 13081*       RIDFLD   (ELCRTT-KEY)
 13082*       RESP     (WS-RESPONSE)
 13083*    END-EXEC
 13084     MOVE LENGTH OF
 13085      CERTIFICATE-TRAILERS
 13086       TO DFHEIV11
 13087*    MOVE '&"IL       EU         (  N#00012426' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 250
* EL156.cbl
 13088     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13089     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13090     MOVE X'204E233030303132343236' TO DFHEIV0(25:11)
 13091     CALL 'kxdfhei1' USING DFHEIV0,
 13092           ELCRTT-DSID,
 13093           CERTIFICATE-TRAILERS,
 13094           DFHEIV11,
 13095           ELCRTT-KEY,
 13096           DFHEIV99,
 13097           DFHEIV99,
 13098           DFHEIV99
 13099     MOVE EIBRESP  TO WS-RESPONSE
 13100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13101
 13102     IF WS-RESP-NORMAL
 13103        perform 2225-upd-crt-trlr thru 2225-exit
 13104
 13105* EXEC CICS REWRITE
 13106*          DATASET  (ELCRTT-DSID)
 13107*          from     (CERTIFICATE-TRAILERS)
 13108*          RESP     (WS-RESPONSE)
 13109*       END-EXEC
 13110     MOVE LENGTH OF
 13111      CERTIFICATE-TRAILERS
 13112       TO DFHEIV11
 13113*    MOVE '&& L                  %  N#00012436' TO DFHEIV0
 13114     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13115     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13116     MOVE X'204E233030303132343336' TO DFHEIV0(25:11)
 13117     CALL 'kxdfhei1' USING DFHEIV0,
 13118           ELCRTT-DSID,
 13119           CERTIFICATE-TRAILERS,
 13120           DFHEIV11,
 13121           DFHEIV99
 13122     MOVE EIBRESP  TO WS-RESPONSE
 13123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13124     else
 13125        if ws-resp-notfnd
 13126           move 'CS'             to certificate-trailers
 13127           move cl-company-cd    to cs-company-cd
 13128           move cl-cert-key-data to cs-control-primary (2:21)
 13129           move cl-cert-no       to cs-cert-no
 13130           move 'B'              to cs-trailer-type
 13131           perform varying s1 from +1 by +1 until s1 > +24
 13132              move zeros         to cs-benefit-period (s1)
 13133                                    cs-days-paid (s1)
 13134                                    cs-total-paid (s1)
 13135                                    cs-remaining-bens (s1)
 13136           end-perform
 13137           perform 2225-upd-crt-trlr
 13138                                 thru 2225-exit
 13139
 13140* EXEC CICS WRITE
 13141*             DATASET  (ELCRTT-DSID)
 13142*             from     (CERTIFICATE-TRAILERS)
 13143*             RIDFLD   (cs-control-primary)
 13144*             RESP     (WS-RESPONSE)
 13145*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 251
* EL156.cbl
 13146     MOVE LENGTH OF
 13147      CERTIFICATE-TRAILERS
 13148       TO DFHEIV11
 13149*    MOVE '&$ L                  ''  N#00012456' TO DFHEIV0
 13150     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13151     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13152     MOVE X'204E233030303132343536' TO DFHEIV0(25:11)
 13153     CALL 'kxdfhei1' USING DFHEIV0,
 13154           ELCRTT-DSID,
 13155           CERTIFICATE-TRAILERS,
 13156           DFHEIV11,
 13157           cs-control-primary,
 13158           DFHEIV99,
 13159           DFHEIV99
 13160     MOVE EIBRESP  TO WS-RESPONSE
 13161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13162        end-if
 13163     END-IF
 13164
 13165     .
 13166 2220-exit.
 13167     exit.
 13168
 13169 2225-upd-crt-trlr.
 13170
 13171*    if instypei = 'P'
 13172*       move +1 to s1
 13173*    else
 13174*       MOVE +2 to s1
 13175*    end-if
 13176
 13177*    move +1 to s1
 13178*    evaluate cl-claim-type
 13179*       when 'A'
 13180*          move +1 to s2
 13181*       when 'I'
 13182*          move +2 to s2
 13183*       when 'G'
 13184*          move +3 to s2
 13185*       when 'L'
 13186*          move +4 to s2
 13187*       when 'P'
 13188*          move +5 to s2
 13189*    end-evaluate
 13190     perform varying s1 from +1 by +1 until
 13191        (s1 > +24)
 13192        or (cl-claim-no = cs-claim-no (s1))
 13193     end-perform
 13194     if s1 < +25
 13195        compute cs-total-paid (s1) =
 13196           cs-total-paid (s1) + at-amount-paid
 13197        compute cs-days-paid (s1) =
 13198           cs-days-paid (s1) +  at-days-in-period
 13199*       compute cs-remaining-bens (s1) =
 13200*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13201        perform 2230-accum-bens-paid thru 2230-exit
 13202     end-if
 13203
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 252
* EL156.cbl
 13204     .
 13205 2225-exit.
 13206     exit.
 13207 2230-accum-bens-paid.
 13208     if cl-claim-type not = 'L' and 'P'
 13209        move pi-ah-term          to ws-max-bens
 13210        if cl-critical-period not = zeros and spaces
 13211           move cl-critical-period
 13212                                 to ws-max-bens
 13213        end-if
 13214     else
 13215        move 01                  to ws-max-bens
 13216     end-if
 13217     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13218     perform varying s2 from +1 by +1 until
 13219        (s2 > +24)
 13220        or (cs-claim-no (s2) = spaces)
 13221        if pi-company-id not = 'DCC'
 13222           if cs-claim-type (s2) = cl-claim-type
 13223              compute ws-tot-days-paid =
 13224                 ws-tot-days-paid + cs-days-paid (s2)
 13225              compute ws-tot-amt-paid =
 13226                 ws-tot-amt-paid + cs-total-paid (s2)
 13227           end-if
 13228        else
 13229           if (cs-benefit-period (s2) = cl-benefit-period)
 13230              and (cs-claim-type (s2) = cl-claim-type)
 13231              and (cs-insured-type (s2) = cl-insured-type)
 13232              compute ws-tot-days-paid =
 13233                 ws-tot-days-paid + cs-days-paid (s2)
 13234              compute ws-tot-amt-paid =
 13235                 ws-tot-amt-paid + cs-total-paid (s2)
 13236           end-if
 13237        end-if
 13238     end-perform
 13239     if cl-claim-type = 'L' and 'P'
 13240        if ws-tot-amt-paid > zeros
 13241           move zeros            to cs-remaining-bens (s1)
 13242        else
 13243           move 01               to cs-remaining-bens (s1)
 13244        end-if
 13245     else
 13246        compute ws-pd-bens rounded =
 13247           ws-tot-amt-paid / pi-ah-benefit-amt
 13248        compute cs-remaining-bens (s1) =
 13249           ws-max-bens - ws-pd-bens
 13250        if cs-remaining-bens (s1) < zeros
 13251           move zeros            to cs-remaining-bens (s1)
 13252        end-if
 13253     end-if
 13254     .
 13255 2230-exit.
 13256     exit.
 13257 3000-MOVE-INPUT-TO-SAVE-AREA.
 13258     IF PMTTYPEL > 0
 13259         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13260
 13261     MOVE SPACES                 TO PI-PROVISIONAL-IND.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 253
* EL156.cbl
 13262
 13263     IF WS-PMTTYPE = '9'
 13264         MOVE 'P'                TO PI-PROVISIONAL-IND
 13265         MOVE '1'                TO WS-PMTTYPE.
 13266
 13267     IF PAYEEL > 0
 13268         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13269         MOVE PAYEEI             TO WS-PAYEE.
 13270
 13271     IF NOTE1L > +0
 13272         MOVE NOTE1I             TO WS-PMTNOTE1
 13273                                    WS-FLI-PMTNOTE
 13274                                    WS-HAN-PMTNOTE.
 13275
 13276     IF NOTE2L > +0
 13277         MOVE NOTE2I             TO WS-PMTNOTE2.
 13278
 13279     IF OFFLINEL > 0
 13280         MOVE OFFLINEI           TO WS-OFFLINE.
 13281
 13282     IF PROOFDTL > 0
 13283         MOVE PROOFDTI            TO DATE-WORK
 13284         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13285         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13286         MOVE '4'                 TO DC-OPTION-CODE
 13287         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13288         IF NO-CONVERSION-ERROR
 13289            MOVE NUM-WORK         TO PROOFDTO
 13290            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13291            MOVE NUM-WORK         TO WS-PROOF-DATE
 13292         ELSE
 13293            MOVE ZEROS            TO WS-PROOF-DATE
 13294         END-IF
 13295     END-IF.
 13296
 13297     IF EOBYNL > +0
 13298         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13299         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13300     END-IF
 13301
 13302     IF CLMFMYNL > +0
 13303         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13304         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13305     END-IF
 13306
 13307     IF SURVYYNL > +0
 13308         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13309         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13310     END-IF
 13311
 13312     IF SPRELYNL > +0
 13313         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13314         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13315     END-IF
 13316*    IF GROUPEDL > +0
 13317*        MOVE GROUPEDI           TO WS-GROUPED.
 13318*
 13319*    IF CASHL > +0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 254
* EL156.cbl
 13320*       MOVE CASHI               TO WS-CASH.
 13321     IF LOANNOL > +0
 13322         MOVE LOANNOI            TO WS-LOAN-NO.
 13323
 13324     IF CHECKNOL > 0
 13325         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13326
 13327     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13328         IF WS-AIG-CREDIT-ENTERED
 13329             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13330             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13331             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13332             MOVE AL-UANON         TO CHECKNOA.
 13333
 13334     IF HOLDTILL > 0
 13335         MOVE HOLDTILI           TO DATE-WORK
 13336         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13337         MOVE NUM-WORK           TO WS-HOLDTIL.
 13338
 13339     IF ZINTL > +0
 13340
 13341* EXEC CICS BIF DEEDIT
 13342*           FIELD   (ZINTI)
 13343*           LENGTH  (07)
 13344*       END-EXEC
 13345     MOVE 07
 13346       TO DFHEIV11
 13347*    MOVE '@"L                   #   #00012640' TO DFHEIV0
 13348     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13349     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13350     MOVE X'2020233030303132363430' TO DFHEIV0(25:11)
 13351     CALL 'kxdfhei1' USING DFHEIV0,
 13352           ZINTI,
 13353           DFHEIV11
 13354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13355        IF ZINTI NOT NUMERIC
 13356           MOVE ER-0419          TO EMI-ERROR
 13357           PERFORM 9900-ERROR-FORMAT
 13358           MOVE AL-UABON         TO ZINTA
 13359           MOVE -1               TO ZINTL
 13360        ELSE
 13361           MOVE ZINTI            TO CP-INT-RATE
 13362                                    WS-INT-RATE
 13363           MOVE CP-INT-RATE      TO ZINTO
 13364           MOVE AL-UNNON         TO ZINTA
 13365        END-IF
 13366     ELSE
 13367        MOVE ZEROS               TO CP-INT-RATE
 13368     END-IF
 13369     IF EPYFROML > 0
 13370         MOVE EPYFROMI           TO DATE-WORK
 13371         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13372         MOVE NUM-WORK           TO WS-EPYFROM.
 13373
 13374     IF AIGFROML > 0
 13375         MOVE AIGFROMI           TO DATE-WORK
 13376         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13377         MOVE NUM-WORK           TO WS-AIGFROM
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 255
* EL156.cbl
 13378     ELSE
 13379         IF (AIGFROMI = LOW-VALUES) AND
 13380            (PI-AIGFROM NOT = ZEROS)
 13381              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13382
 13383     IF EPYTHRUL > +0
 13384        MOVE EPYTHRUI           TO DATE-WORK
 13385        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13386        MOVE NUM-WORK           TO WS-EPYTHRU
 13387        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13388        MOVE '4'                TO DC-OPTION-CODE
 13389        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13390        IF NO-CONVERSION-ERROR
 13391           IF PI-USES-PAID-TO
 13392              MOVE '6'                TO DC-OPTION-CODE
 13393              MOVE -1                 TO DC-ELAPSED-DAYS
 13394              MOVE +0                 TO DC-ELAPSED-MONTHS
 13395              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13396              IF NO-CONVERSION-ERROR
 13397                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13398                 MOVE ' '             TO DC-OPTION-CODE
 13399                 MOVE +0              TO DC-ELAPSED-DAYS
 13400                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13401              IF NO-CONVERSION-ERROR
 13402                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13403
 13404*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13405*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13406     IF EDAYSL > 0
 13407
 13408* EXEC CICS BIF DEEDIT
 13409*            FIELD(EDAYSI)
 13410*            LENGTH(6)
 13411*        END-EXEC
 13412     MOVE 6
 13413       TO DFHEIV11
 13414*    MOVE '@"L                   #   #00012696' TO DFHEIV0
 13415     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13416     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13417     MOVE X'2020233030303132363936' TO DFHEIV0(25:11)
 13418     CALL 'kxdfhei1' USING DFHEIV0,
 13419           EDAYSI,
 13420           DFHEIV11
 13421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13422         MOVE EDAYSI             TO WS-DY-WORK
 13423         IF WS-DY-SIGN = SPACES
 13424            MOVE WS-DY-NUM       TO WS-EDAYS
 13425            ADD 0                TO WS-EDAYS
 13426         ELSE
 13427            MOVE EDAYSI          TO WS-EDAYS
 13428            ADD 0                TO WS-EDAYS.
 13429
 13430*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13431*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13432     IF EPYAMTL > 0
 13433
 13434* EXEC CICS BIF DEEDIT
 13435*            FIELD(EPYAMTI)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 256
* EL156.cbl
 13436*            LENGTH(10)
 13437*        END-EXEC
 13438     MOVE 10
 13439       TO DFHEIV11
 13440*    MOVE '@"L                   #   #00012711' TO DFHEIV0
 13441     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13442     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13443     MOVE X'2020233030303132373131' TO DFHEIV0(25:11)
 13444     CALL 'kxdfhei1' USING DFHEIV0,
 13445           EPYAMTI,
 13446           DFHEIV11
 13447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13448         MOVE EPYAMTI            TO WS-PY-WORK
 13449         IF WS-PY-SIGN = SPACES
 13450            MOVE WS-PY-NUM       TO WS-EPYAMT
 13451            ADD 0                TO WS-EPYAMT
 13452         ELSE
 13453            MOVE EPYAMTI         TO WS-EPYAMT
 13454            ADD 0                TO WS-EPYAMT.
 13455
 13456     IF ERESVL > 0
 13457
 13458* EXEC CICS BIF DEEDIT
 13459*            FIELD(ERESVI)
 13460*            LENGTH(9)
 13461*        END-EXEC
 13462     MOVE 9
 13463       TO DFHEIV11
 13464*    MOVE '@"L                   #   #00012724' TO DFHEIV0
 13465     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13466     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13467     MOVE X'2020233030303132373234' TO DFHEIV0(25:11)
 13468     CALL 'kxdfhei1' USING DFHEIV0,
 13469           ERESVI,
 13470           DFHEIV11
 13471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13472         MOVE ERESVI TO WS-ERESV.
 13473
 13474     IF EEXPENSL > 0
 13475
 13476* EXEC CICS BIF DEEDIT
 13477*            FIELD(EEXPENSI)
 13478*            LENGTH(8)
 13479*        END-EXEC
 13480     MOVE 8
 13481       TO DFHEIV11
 13482*    MOVE '@"L                   #   #00012731' TO DFHEIV0
 13483     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13484     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13485     MOVE X'2020233030303132373331' TO DFHEIV0(25:11)
 13486     CALL 'kxdfhei1' USING DFHEIV0,
 13487           EEXPENSI,
 13488           DFHEIV11
 13489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13490         MOVE EEXPENSI           TO WS-EEXPENS.
 13491
 13492     IF ETYPEL > ZEROS
 13493         MOVE ETYPEI             TO WS-ETYPE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 257
* EL156.cbl
 13494
 13495     IF PI-COMPANY-ID = 'BOA'
 13496        IF PINTL > ZEROS
 13497
 13498* EXEC CICS BIF DEEDIT
 13499*            FIELD (PINTI)
 13500*            LENGTH(05)
 13501*          END-EXEC
 13502     MOVE 05
 13503       TO DFHEIV11
 13504*    MOVE '@"L                   #   #00012742' TO DFHEIV0
 13505     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13506     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13507     MOVE X'2020233030303132373432' TO DFHEIV0(25:11)
 13508     CALL 'kxdfhei1' USING DFHEIV0,
 13509           PINTI,
 13510           DFHEIV11
 13511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13512           IF PINTI NUMERIC
 13513               MOVE AL-UNNON     TO PINTA
 13514               MOVE PINTI        TO WS-INT-RATE
 13515               MOVE WS-INT-RATE  TO PINTO.
 13516
 13517 3000-EXIT.
 13518     EXIT.
 13519
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 258
* EL156.cbl
 13521 3050-REBUILD-ENTERED.
 13522
 13523     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13524
 13525     IF PI-PROV-PMT
 13526         MOVE '9'           TO PMTTYPEO
 13527     ELSE
 13528         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13529
 13530     MOVE PI-PAYEE          TO PAYEEO.
 13531     MOVE PI-PMTNOTE1       TO NOTE1O.
 13532     MOVE PI-PMTNOTE2       TO NOTE2O.
 13533     MOVE PI-OFFLINE        TO OFFLINEO.
 13534     IF PI-PROOF-DATE NOT = ZEROS
 13535         MOVE PI-PROOF-DATE TO PROOFDTO
 13536         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13537     END-IF.
 13538*    MOVE PI-GROUPED        TO GROUPEDO.
 13539
 13540*    MOVE PI-CASH           TO CASHO.
 13541
 13542     IF PI-INT-RATE > ZEROS
 13543         MOVE PI-INT-RATE   TO PINTO.
 13544
 13545     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13546        IF PI-INT-AMT > ZEROS
 13547           MOVE PI-INT-AMT       TO PINTO
 13548           MOVE AL-PANOF         TO PINTA
 13549                                    PINTHA
 13550        END-IF
 13551     END-IF
 13552     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13553     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13554     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13555     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13556     IF PI-HOLDTIL NOT = ZEROS
 13557        MOVE PI-HOLDTIL          TO HOLDTILO
 13558        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13559
 13560     IF PI-EPYFROM NOT = ZEROS
 13561        MOVE PI-EPYFROM          TO EPYFROMO
 13562        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13563
 13564     IF PI-AIGFROM NOT = ZEROS
 13565        MOVE PI-AIGFROM          TO AIGFROMO
 13566        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13567
 13568     IF PI-EPYTHRU NOT = ZEROS
 13569        MOVE PI-EPYTHRU          TO EPYTHRUO
 13570        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13571        IF PI-USES-PAID-TO
 13572           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13573           MOVE '4'                TO DC-OPTION-CODE
 13574           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13575           IF NO-CONVERSION-ERROR
 13576              MOVE +1 TO DC-ELAPSED-DAYS
 13577              MOVE +0 TO DC-ELAPSED-MONTHS
 13578              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 259
* EL156.cbl
 13579              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13580              IF NO-CONVERSION-ERROR
 13581                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13582
 13583     IF PI-EDAYS NOT = ZEROS
 13584        MOVE PI-EDAYS TO EDAYSO.
 13585
 13586     IF PI-EPYAMT NOT = ZEROS
 13587        MOVE PI-EPYAMT TO EPYAMTO.
 13588
 13589     IF PI-ERESV NOT = ZEROS
 13590        MOVE PI-ERESV TO ERESVO.
 13591
 13592     IF PI-EEXPENS NOT = ZEROS
 13593        MOVE PI-EEXPENS TO EEXPENSO.
 13594
 13595     MOVE PI-ETYPE TO ETYPEO.
 13596
 13597     IF PI-ECHECKNO NOT = SPACES
 13598        MOVE PI-ECHECKNO         TO CHECKNOO
 13599     ELSE
 13600        MOVE PI-CCHECKNO         TO CHECKNOO.
 13601
 13602     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13603     MOVE SPACES                 TO DC-OPTION-CODE.
 13604     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13605
 13606     IF DATE-CONVERSION-ERROR
 13607        MOVE SPACES              TO CPYFROMI
 13608     ELSE
 13609        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13610
 13611     IF PI-USES-PAID-TO
 13612        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13613        MOVE +1                  TO DC-ELAPSED-DAYS
 13614        MOVE +0                  TO DC-ELAPSED-MONTHS
 13615        MOVE '6'                 TO DC-OPTION-CODE
 13616        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13617        IF NO-CONVERSION-ERROR
 13618           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13619           GO TO 3051-CONTINUE.
 13620
 13621     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13622     MOVE SPACES                 TO DC-OPTION-CODE.
 13623     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13624
 13625     IF DATE-CONVERSION-ERROR
 13626        MOVE SPACES              TO CPYTHRUI
 13627     ELSE
 13628        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13629
 13630 3051-CONTINUE.
 13631
 13632     IF PI-CDAYS NOT = ZEROS
 13633        MOVE PI-CDAYS TO CDAYSO.
 13634
 13635     IF PI-CPYAMT NOT = ZEROS
 13636        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 260
* EL156.cbl
 13637
 13638     IF PI-CRESV NOT = ZEROS
 13639        MOVE PI-CRESV TO CRESVO.
 13640
 13641     IF PI-CEXPENS NOT = ZEROS
 13642        MOVE PI-CEXPENS TO CEXPENSO.
 13643
 13644 3059-EXIT.
 13645     EXIT.
 13646
 13647 3100-DEEDIT-DATE.
 13648
 13649* EXEC CICS BIF DEEDIT
 13650*        FIELD(DATE-WORK)
 13651*        LENGTH(8)
 13652*    END-EXEC.
 13653     MOVE 8
 13654       TO DFHEIV11
 13655*    MOVE '@"L                   #   #00012882' TO DFHEIV0
 13656     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13657     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13658     MOVE X'2020233030303132383832' TO DFHEIV0(25:11)
 13659     CALL 'kxdfhei1' USING DFHEIV0,
 13660           DATE-WORK,
 13661           DFHEIV11
 13662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13663
 13664
 13665 3100-EXIT.
 13666     EXIT.
 13667
 13668 3200-CALC-AIG-DAYS.
 13669
 13670     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13671
 13672     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13673     MOVE ' '                    TO DC-OPTION-CODE.
 13674     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13675     IF NO-CONVERSION-ERROR
 13676         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13677     ELSE
 13678         GO TO 3290-ERROR.
 13679
 13680     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13681         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13682                                WS-BIN-FROM-DT
 13683     ELSE
 13684         IF CL-TOTAL-PAID-AMT > ZEROS
 13685             IF WS-SV-EPYFROM = LOW-VALUES
 13686                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13687                                        WS-BIN-FROM-DT
 13688             ELSE
 13689                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13690                                        WS-BIN-FROM-DT
 13691         ELSE
 13692             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13693                                        WS-BIN-FROM-DT.
 13694
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 261
* EL156.cbl
 13695 3210-CONTINUE.
 13696
 13697     MOVE ' '                    TO DC-OPTION-CODE.
 13698     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13699     IF DATE-CONVERSION-ERROR
 13700         GO TO 3290-ERROR.
 13701
 13702     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13703
 13704     IF PI-LOAN-DUE-DAY = 31
 13705         MOVE 30              TO WS-PMT-DUE-DA
 13706                                 WS-SAVE-DUE-DA
 13707     ELSE
 13708         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13709                                 WS-SAVE-DUE-DA.
 13710
 13711     IF (PI-LOAN-DUE-DAY > 28) AND
 13712        (WS-PMT-DUE-MO = 2)
 13713         MOVE 'Y'                TO WS-DUE-DAY-SW
 13714         MOVE 28                 TO WS-PMT-DUE-DA.
 13715
 13716     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13717     MOVE '4'                    TO DC-OPTION-CODE.
 13718     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13719     IF NO-CONVERSION-ERROR
 13720         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13721     ELSE
 13722         GO TO 3290-ERROR.
 13723
 13724*--------------------------------------------------------------*
 13725*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13726*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13727*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13728*                                                              *
 13729*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13730*             INCURRED DATE      - 04/15/91                    *
 13731*             PMT DUE DATE       - 04/03/91                    *
 13732*             PMT DUE DATE       - 05/03/91                    *
 13733*--------------------------------------------------------------*
 13734
 13735     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13736        (WS-SV-AIGFROM = LOW-VALUES)
 13737         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13738            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13739             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13740             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13741             IF NO-CONVERSION-ERROR
 13742                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13743                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13744             ELSE
 13745                 GO TO 3290-ERROR.
 13746
 13747     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13748        (WS-SV-AIGFROM = LOW-VALUES)
 13749         GO TO 3205-CONT-CALC-PMT.
 13750
 13751     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13752     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 262
* EL156.cbl
 13753     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13754     IF NO-CONVERSION-ERROR
 13755         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13756     ELSE
 13757         GO TO 3290-ERROR.
 13758
 13759     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13760        (WS-PMT-DUE-DA < WS-FROM-DA)
 13761          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13762          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13763          IF NO-CONVERSION-ERROR
 13764              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13765              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13766          ELSE
 13767              GO TO 3290-ERROR.
 13768
 13769 3205-CONT-CALC-PMT.
 13770
 13771*--------------------------------------------------------------*
 13772*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13773*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13774*--------------------------------------------------------------*
 13775
 13776     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13777        PI-PMTTYPE = '2'
 13778          NEXT SENTENCE
 13779     ELSE
 13780        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13781           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13782             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13783             MOVE ER-3527            TO EMI-ERROR
 13784             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13785             MOVE -1                 TO EPYTHRUL
 13786             MOVE AL-UNBON           TO EPYTHRUA
 13787                                        EPYFROMA
 13788             GO TO 3299-EXIT.
 13789
 13790*--------------------------------------------------------------*
 13791*    CALCULATE RETRO ELIMINATION DATE                          *
 13792*--------------------------------------------------------------*
 13793
 13794     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13795         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13796     ELSE
 13797         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13798
 13799     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13800     MOVE +0             TO DC-ELAPSED-MONTHS.
 13801     MOVE '6'            TO DC-OPTION-CODE.
 13802     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13803     IF NO-CONVERSION-ERROR
 13804         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13805     ELSE
 13806         GO TO 3290-ERROR.
 13807
 13808 3210-CHECK-PMT-DATE.
 13809
 13810*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 263
* EL156.cbl
 13811*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13812*    THE ENTERED PAY FROM DATE                                 *
 13813*--------------------------------------------------------------*
 13814
 13815     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13816         NEXT SENTENCE
 13817     ELSE
 13818         GO TO 3220-COMPUTE-DAYS.
 13819
 13820     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13821     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13822     IF NO-CONVERSION-ERROR
 13823         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13824         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13825         GO TO 3210-CHECK-PMT-DATE
 13826     ELSE
 13827         GO TO 3290-ERROR.
 13828
 13829 3220-COMPUTE-DAYS.
 13830
 13831     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13832     MOVE ZEROS         TO WS-CDAYS.
 13833     MOVE 'N'           TO WS-ELIMINATION-SW.
 13834
 13835*--------------------------------------------------------------*
 13836*    COMPUTE CALIFORNIA DUE DAYS                               *
 13837*--------------------------------------------------------------*
 13838
 13839     IF CL-TOTAL-PAID-AMT > ZEROS
 13840         MOVE 'Y' TO WS-ELIMINATION-SW
 13841         GO TO 3240-FIRST-PMT-DUE
 13842     ELSE
 13843        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13844            NEXT SENTENCE
 13845        ELSE
 13846            GO TO 3240-FIRST-PMT-DUE.
 13847
 13848 3230-NEXT-PMT-DUE.
 13849
 13850     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13851     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13852     IF NO-CONVERSION-ERROR
 13853         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13854         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13855     ELSE
 13856         GO TO 3290-ERROR.
 13857
 13858 3240-FIRST-PMT-DUE.
 13859
 13860     IF CL-TOTAL-PAID-AMT > ZEROS
 13861         NEXT SENTENCE
 13862     ELSE
 13863        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13864            GO TO 3230-NEXT-PMT-DUE.
 13865
 13866     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13867         GO TO 3250-VERIFY-ELIMINATION.
 13868
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 264
* EL156.cbl
 13869     ADD +30 TO WS-CDAYS.
 13870     MOVE 'Y' TO WS-ELIMINATION-SW.
 13871     GO TO 3230-NEXT-PMT-DUE.
 13872
 13873 3250-VERIFY-ELIMINATION.
 13874
 13875     IF ELIM-SATISFIED
 13876         GO TO 3260-END-CALC.
 13877
 13878     IF PI-PMTTYPE = '1'
 13879         MOVE ZEROS TO WS-CDAYS
 13880         GO TO 3260-END-CALC.
 13881
 13882     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13883         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13884     ELSE
 13885         IF CL-TOTAL-PAID-AMT > ZEROS
 13886             IF WS-SV-EPYFROM = LOW-VALUES
 13887                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13888             ELSE
 13889                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13890         ELSE
 13891             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 13892
 13893     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 13894     MOVE '1'                    TO DC-OPTION-CODE.
 13895     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13896     IF NO-CONVERSION-ERROR
 13897         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 13898     ELSE
 13899         GO TO 3290-ERROR.
 13900
 13901     IF CL-TOTAL-PAID-AMT > ZEROS
 13902         MOVE WS-DAYS-OFF TO WS-CDAYS
 13903     ELSE
 13904         IF PI-BEN-DAYS > WS-DAYS-OFF
 13905             MOVE ZEROS TO WS-CDAYS
 13906         ELSE
 13907             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 13908
 13909 3260-END-CALC.
 13910
 13911     MOVE WS-CDAYS TO PI-CDAYS.
 13912
 13913     IF PI-EDAYS = ZEROS
 13914         MOVE PI-CDAYS TO PI-EDAYS
 13915         MOVE AL-UNNON TO EDAYSA.
 13916
 13917     GO TO 3299-EXIT.
 13918
 13919 3290-ERROR.
 13920
 13921     MOVE ER-3528            TO EMI-ERROR.
 13922     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13923     MOVE -1                 TO CDAYSL.
 13924     MOVE AL-UNBON           TO CDAYSA.
 13925
 13926 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 265
* EL156.cbl
 13927     EXIT.
 13928
 13929 3300-BUMP-DATE.
 13930
 13931     IF WS-RESTORE-DUE-DAY
 13932         MOVE 'N'              TO WS-DUE-DAY-SW
 13933         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 13934         ADD 1                 TO WS-PMT-DUE-MO
 13935         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 13936         MOVE '4'              TO DC-OPTION-CODE
 13937         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13938         IF NO-CONVERSION-ERROR
 13939             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13940             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 13941             GO TO 3399-EXIT
 13942         ELSE
 13943             MOVE '9'          TO DC-ERROR-CODE
 13944             GO TO 3399-EXIT.
 13945
 13946     IF (WS-PMT-DUE-MO = 1) AND
 13947        (WS-SAVE-DUE-DA > 28)
 13948           MOVE 'Y' TO WS-DUE-DAY-SW.
 13949
 13950     MOVE +0                 TO DC-ELAPSED-DAYS.
 13951     MOVE +1                 TO DC-ELAPSED-MONTHS.
 13952     MOVE '6'                TO DC-OPTION-CODE.
 13953     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13954
 13955 3399-EXIT.
 13956     EXIT.
 13957
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 266
* EL156.cbl
 13959 3400-COMPUTE-EXPIRY.
 13960
 13961     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 13962     MOVE +0                    TO DC-ELAPSED-DAYS
 13963                                   DC-ODD-DAYS-OVER.
 13964     MOVE '1'                   TO DC-END-OF-MONTH.
 13965     MOVE '6'                   TO DC-OPTION-CODE.
 13966
 13967     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13968         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 13969     ELSE
 13970         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 13971
 13972     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13973     IF NO-CONVERSION-ERROR
 13974         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 13975     ELSE
 13976         GO TO 3390-CONTINUE.
 13977
 13978     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 13979         GO TO 3390-CONTINUE.
 13980
 13981     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13982     MOVE '4'                    TO CNTL-REC-TYPE.
 13983     MOVE +0                     TO CNTL-SEQ-NO.
 13984     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 13985     MOVE WS-ACCESS              TO CNTL-ACCESS.
 13986     MOVE 'BENE'                 TO FILE-SWITCH.
 13987
 13988     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 13989
 13990     IF NO-BENEFIT-FOUND
 13991         GO TO 3390-CONTINUE.
 13992
 13993     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 13994        IF (PI-OFFLINE = 'Y') OR
 13995           (PI-PMTTYPE = '7')
 13996           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 13997                                     THRU 9870-EXIT
 13998           IF ERROR-ON-OUTPUT
 13999             MOVE -1                 TO ENTERPFL
 14000             MOVE AL-UANON           TO ENTERPFA
 14001             MOVE MAP-NAMEA          TO MAP-NAME
 14002             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14003             GO TO 8200-SEND-DATAONLY.
 14004
 14005     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14006        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14007        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14008          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14009          MOVE +0        TO DC-ELAPSED-DAYS
 14010          MOVE +1        TO DC-ELAPSED-MONTHS
 14011          MOVE 6         TO DC-OPTION-CODE
 14012          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14013          IF NO-CONVERSION-ERROR
 14014              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14015
 14016 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 267
* EL156.cbl
 14017
 14018      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14019         MOVE CM-AH-LOAN-EXPIRE-DT
 14020                                 TO DC-BIN-DATE-1
 14021      ELSE
 14022         MOVE CM-LF-LOAN-EXPIRE-DT
 14023                                 TO DC-BIN-DATE-1
 14024      END-IF
 14025
 14026      MOVE ' '                    TO DC-OPTION-CODE.
 14027      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14028      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14029      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14030
 14031 3499-EXIT.
 14032     EXIT.
 14033
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 268
* EL156.cbl
 14035
 14036 3600-CHECK-VERIFICATION.
 14037
 14038     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14039
 14040     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14041
 14042     IF PI-PAYEE-TYPE = 'I'
 14043        GO TO 3600-READ-TRAILER.
 14044
 14045     IF PI-PAYEE-TYPE = 'B'
 14046        ADD +10                  TO TRLR-SEQ-NO
 14047        GO TO 3600-READ-TRAILER.
 14048
 14049     IF PI-PAYEE-TYPE = 'A'
 14050        ADD +20                  TO TRLR-SEQ-NO
 14051        GO TO 3600-READ-TRAILER.
 14052
 14053     IF PI-PAYEE-TYPE = 'O'
 14054        ADD +50                  TO TRLR-SEQ-NO
 14055        GO TO 3600-READ-TRAILER.
 14056
 14057     IF PI-PAYEE-TYPE = 'Q'
 14058        ADD +60                  TO TRLR-SEQ-NO
 14059        GO TO 3600-READ-TRAILER.
 14060
 14061     IF PI-PAYEE-TYPE = 'P'
 14062        ADD +30                  TO TRLR-SEQ-NO
 14063        GO TO 3600-READ-TRAILER.
 14064
 14065     IF PI-PAYEE-TYPE = 'E'
 14066        ADD +40                  TO TRLR-SEQ-NO.
 14067
 14068 3600-READ-TRAILER.
 14069
 14070
 14071* EXEC CICS HANDLE CONDITION
 14072*         NOTFND(3600-CONTINUE)
 14073*    END-EXEC.
 14074*    MOVE '"$I                   ! - #00013292' TO DFHEIV0
 14075     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14076     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14077     MOVE X'2D20233030303133323932' TO DFHEIV0(25:11)
 14078     CALL 'kxdfhei1' USING DFHEIV0
 14079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14080
 14081
 14082     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14083
 14084 3600-CONTINUE.
 14085
 14086     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14087         GO TO 3600-AH-VERIFY
 14088     END-IF.
 14089
 14090     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14091       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14092         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 269
* EL156.cbl
 14093           MOVE ER-7576            TO EMI-ERROR
 14094           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14095           MOVE -1                 TO PAYEEL
 14096           MOVE AL-UABON           TO PAYEEA
 14097           GO TO 3600-EXIT
 14098         END-IF
 14099       END-IF
 14100     END-IF.
 14101
 14102     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14103     MOVE 1 TO WS-SUB2
 14104     MOVE SPACES TO WS-PAYEE-NAME
 14105     PERFORM VARYING WS-SUB FROM 1 BY 1
 14106             UNTIL WS-SUB > 30
 14107         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14108            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14109                 WS-PAYEE-NAME-X (WS-SUB2)
 14110            ADD +1 TO WS-SUB2
 14111         END-IF
 14112     END-PERFORM.
 14113
 14114     STRING CL-INSURED-1ST-NAME
 14115            CL-INSURED-MID-INIT
 14116            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14117     MOVE 1 TO WS-SUB2
 14118     MOVE SPACES TO WS-INSURED-NAME
 14119     PERFORM VARYING WS-SUB FROM 1 BY 1
 14120             UNTIL WS-SUB > 30
 14121         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14122            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14123                 WS-INSURED-NAME-X (WS-SUB2)
 14124            ADD +1 TO WS-SUB2
 14125         END-IF
 14126     END-PERFORM.
 14127
 14128     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14129        MOVE ER-7579            TO EMI-ERROR
 14130        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14131        MOVE -1                 TO PAYEEL
 14132        MOVE AL-UABON           TO PAYEEA
 14133     END-IF.
 14134
 14135     IF PI-PMTTYPE = '4'  AND
 14136        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14137        PI-PAYEE-TYPE <> 'I'
 14138          MOVE ER-7580          TO EMI-ERROR
 14139          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14140          MOVE -1               TO PAYEEL
 14141          MOVE AL-UABON         TO PAYEEA
 14142     END-IF.
 14143
 14144     GO TO 3600-EXIT.
 14145
 14146 3600-AH-VERIFY.
 14147
 14148     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14149        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14150           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 270
* EL156.cbl
 14151           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14152           MOVE -1                 TO PAYEEL
 14153           MOVE AL-UABON           TO PAYEEA
 14154        END-IF
 14155     END-IF.
 14156
 14157
 14158 3600-EXIT.
 14159     EXIT.
 14160
 14161 5000-UPDATE.
 14162
 14163     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14164
 14165     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14166
 14167     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14168        PI-OFFLINE = 'Y'
 14169        NEXT SENTENCE
 14170     ELSE
 14171        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14172
 14173*    IF PI-COMPANY-ID = 'CRI'
 14174*       IF PI-PMTTYPE = '1' OR  '2'
 14175*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14176*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14177*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14178
 14179*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14180*       IF PI-PMTTYPE = '1'
 14181*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14182*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14183
 14184     IF PI-PMTTYPE      = '2' AND
 14185        PI-SPLIT-PMT-SW = 'Y' AND
 14186        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14187          MOVE ER-3530                TO EMI-ERROR
 14188          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14189
 14190     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14191        AND (CL-CLAIM-TYPE = 'L')
 14192        IF PI-PMTTYPE = '2' OR '4'
 14193           IF PI-INT-AMT NOT = ZEROS
 14194              PERFORM 7110-BUILD-PMT-TRLR
 14195                                 THRU 7130-EXIT
 14196           ELSE
 14197              IF PI-PMTTYPE = '2'
 14198                 PERFORM 7140-BUILD-NOTE-TRLR
 14199                                 THRU 7170-EXIT
 14200              END-IF
 14201           END-IF
 14202        END-IF
 14203     END-IF
 14204*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14205*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14206*            MOVE 'N'                 TO  WS-LETTER-SW.
 14207
 14208*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 271
* EL156.cbl
 14209*        IF CL-NO-OF-PMTS-MADE = +1
 14210*                OR
 14211*           PI-PMTTYPE = '2'
 14212*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14213
 14214     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14215
 14216*    IF PI-COMPANY-ID = 'DMD'
 14217*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14218*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14219
 14220
 14221* EXEC CICS REWRITE
 14222*         DATASET('ELMSTR')
 14223*         FROM(CLAIM-MASTER)
 14224*     END-EXEC.
 14225     MOVE LENGTH OF
 14226      CLAIM-MASTER
 14227       TO DFHEIV11
 14228     MOVE 'ELMSTR' TO DFHEIV1
 14229*    MOVE '&& L                  %   #00013434' TO DFHEIV0
 14230     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14231     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14232     MOVE X'2020233030303133343334' TO DFHEIV0(25:11)
 14233     CALL 'kxdfhei1' USING DFHEIV0,
 14234           DFHEIV1,
 14235           CLAIM-MASTER,
 14236           DFHEIV11,
 14237           DFHEIV99
 14238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14239
 14240
 14241     IF WS-LETTER-SW = 'N'
 14242         GO TO 5000-END-UPDATE.
 14243
 14244 5000-GENERATE-AUTO-LETTER.
 14245
 14246
 14247* EXEC CICS LINK
 14248*        PROGRAM    (LINK-1523)
 14249*        COMMAREA   (W-1523-LINKDATA)
 14250*        LENGTH     (W-1523-COMM-LENGTH)
 14251*    END-EXEC.
 14252*    MOVE '."C                   (   #00013444' TO DFHEIV0
 14253     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14254     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14255     MOVE X'2020233030303133343434' TO DFHEIV0(25:11)
 14256     CALL 'kxdfhei1' USING DFHEIV0,
 14257           LINK-1523,
 14258           W-1523-LINKDATA,
 14259           W-1523-COMM-LENGTH,
 14260           DFHEIV99,
 14261           DFHEIV99,
 14262           DFHEIV99,
 14263           DFHEIV99
 14264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14265
 14266
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 272
* EL156.cbl
 14267     IF W-1523-FATAL-ERROR
 14268         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14269         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14270         MOVE ER-0802                TO  EMI-ERROR
 14271         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14272
 14273     IF W-1523-ERROR-CODE = 0191
 14274         MOVE ER-0803                TO  EMI-ERROR
 14275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14276
 14277     IF PI-COMPANY-ID      = 'HAN' AND
 14278        PI-PMTTYPE         = '1'   AND
 14279        PI-3RD-PARTY-SW    = 'Y'   AND
 14280        W-1523-FORM-NUMBER = 'EOB1'
 14281           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14282           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14283           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14284           GO TO 5000-GENERATE-AUTO-LETTER.
 14285
 14286 5000-END-UPDATE.
 14287
 14288     MOVE ER-0000                TO EMI-ERROR.
 14289     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14290     GO TO 7000-SHOW-CLAIM.
 14291
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 273
* EL156.cbl
 14293 5000-MOVE-NAME.
 14294     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14295     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14296     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14297
 14298 5000-EXIT.
 14299     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 274
* EL156.cbl
 14301 5300-CREATE-DMO.
 14302
 14303     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14304     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14305     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14306
 14307
 14308* EXEC CICS HANDLE CONDITION
 14309*         NOTFND   (5300-NOTE-NOT-FOUND)
 14310*    END-EXEC.
 14311*    MOVE '"$I                   ! . #00013490' TO DFHEIV0
 14312     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14314     MOVE X'2E20233030303133343930' TO DFHEIV0(25:11)
 14315     CALL 'kxdfhei1' USING DFHEIV0
 14316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14317
 14318
 14319
 14320* EXEC CICS READ
 14321*         DATASET('ERNOTE')
 14322*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14323*         RIDFLD (W-NOTE-KEY)
 14324*    END-EXEC.
 14325     MOVE 'ERNOTE' TO DFHEIV1
 14326*    MOVE '&"S        E          (   #00013494' TO DFHEIV0
 14327     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14329     MOVE X'2020233030303133343934' TO DFHEIV0(25:11)
 14330     CALL 'kxdfhei1' USING DFHEIV0,
 14331           DFHEIV1,
 14332           DFHEIV20,
 14333           DFHEIV99,
 14334           W-NOTE-KEY,
 14335           DFHEIV99,
 14336           DFHEIV99,
 14337           DFHEIV99
 14338     SET ADDRESS OF CERTIFICATE-NOTE TO
 14339         DFHEIV20
 14340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14341
 14342
 14343     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14344     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14345     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14346
 14347     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14348         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14349     ELSE
 14350         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14351
 14352     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14353     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14354     MOVE 'DLO006'               TO PGM-NAME.
 14355
 14356
 14357* EXEC CICS LINK
 14358*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 275
* EL156.cbl
 14359*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14360*        LENGTH     (DCT-RCRD-LENGTH)
 14361*    END-EXEC.
 14362*    MOVE '."C                   (   #00013513' TO DFHEIV0
 14363     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14365     MOVE X'2020233030303133353133' TO DFHEIV0(25:11)
 14366     CALL 'kxdfhei1' USING DFHEIV0,
 14367           PGM-NAME,
 14368           DCT-COMMUNICATION-AREA,
 14369           DCT-RCRD-LENGTH,
 14370           DFHEIV99,
 14371           DFHEIV99,
 14372           DFHEIV99,
 14373           DFHEIV99
 14374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14375
 14376
 14377     IF DCT-RETURN-CODE = 'OK'
 14378         GO TO 5300-CONT.
 14379
 14380     IF DCT-RETURN-CODE = '01' OR '02'
 14381         GO TO 5300-EXIT.
 14382
 14383     IF DCT-RETURN-CODE = '03'
 14384         MOVE ER-0951            TO EMI-ERROR
 14385         GO TO 5300-BAD-EXIT.
 14386
 14387     IF DCT-RETURN-CODE = '04'
 14388         MOVE ER-0946            TO EMI-ERROR
 14389         GO TO 5300-BAD-EXIT.
 14390
 14391     IF DCT-RETURN-CODE = '05'
 14392         MOVE ER-0947            TO EMI-ERROR
 14393         GO TO 5300-BAD-EXIT.
 14394
 14395     IF DCT-RETURN-CODE = '06'
 14396         MOVE ER-0921            TO EMI-ERROR
 14397         GO TO 5300-BAD-EXIT.
 14398
 14399     IF DCT-RETURN-CODE = '07'
 14400         MOVE ER-0849            TO EMI-ERROR
 14401         GO TO 5300-BAD-EXIT.
 14402
 14403     IF DCT-RETURN-CODE = '08'
 14404         MOVE ER-0948            TO EMI-ERROR
 14405         GO TO 5300-BAD-EXIT.
 14406
 14407     IF DCT-RETURN-CODE = 'N1'
 14408         MOVE ER-0950            TO EMI-ERROR
 14409         GO TO 5300-BAD-EXIT.
 14410
 14411     IF DCT-RETURN-CODE = 'E1'
 14412         MOVE ER-0974            TO EMI-ERROR
 14413         GO TO 5300-BAD-EXIT.
 14414
 14415     IF DCT-RETURN-CODE = 'E2'
 14416         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 276
* EL156.cbl
 14417         GO TO 5300-BAD-EXIT.
 14418
 14419     IF DCT-RETURN-CODE NOT = 'OK'
 14420         MOVE ER-0949            TO EMI-ERROR
 14421         GO TO 5300-BAD-EXIT.
 14422
 14423 5300-CONT.
 14424
 14425     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14426     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14427     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14428     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14429     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14430     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14431     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14432     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14433
 14434     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14435     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14436     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14437     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14438     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14439
 14440     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14441
 14442     IF PI-PMTTYPE = '2'
 14443         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14444         MOVE '4'                TO DM-CLAIM-STATUS
 14445     ELSE
 14446         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14447         MOVE '2'                TO DM-CLAIM-STATUS.
 14448
 14449     MOVE 'DLO025'               TO PGM-NAME.
 14450
 14451
 14452* EXEC CICS LINK
 14453*        PROGRAM    (PGM-NAME)
 14454*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14455*        LENGTH     (DM-DMO-LENGTH)
 14456*    END-EXEC.
 14457*    MOVE '."C                   (   #00013593' TO DFHEIV0
 14458     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14459     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14460     MOVE X'2020233030303133353933' TO DFHEIV0(25:11)
 14461     CALL 'kxdfhei1' USING DFHEIV0,
 14462           PGM-NAME,
 14463           DMO-COMMUNICATION-AREA,
 14464           DM-DMO-LENGTH,
 14465           DFHEIV99,
 14466           DFHEIV99,
 14467           DFHEIV99,
 14468           DFHEIV99
 14469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14470
 14471
 14472     IF DM-RETURN-CODE = 'OK'
 14473         GO TO 5300-EXIT.
 14474
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 277
* EL156.cbl
 14475     IF DM-RETURN-CODE = '01'
 14476         MOVE ER-8051            TO EMI-ERROR
 14477         GO TO 5300-BAD-EXIT.
 14478
 14479     IF DM-RETURN-CODE = '02'
 14480         MOVE ER-8052            TO EMI-ERROR
 14481         GO TO 5300-BAD-EXIT.
 14482
 14483     IF DM-RETURN-CODE = '03'
 14484         MOVE ER-8053            TO EMI-ERROR
 14485         GO TO 5300-BAD-EXIT.
 14486
 14487     IF DM-RETURN-CODE = '04'
 14488         MOVE ER-8054            TO EMI-ERROR
 14489         GO TO 5300-BAD-EXIT.
 14490
 14491     IF DM-RETURN-CODE = '05'
 14492         MOVE ER-8055            TO EMI-ERROR
 14493         GO TO 5300-BAD-EXIT.
 14494
 14495     IF DM-RETURN-CODE = '06'
 14496         MOVE ER-8056            TO EMI-ERROR
 14497         GO TO 5300-BAD-EXIT.
 14498
 14499     IF DM-RETURN-CODE = '07'
 14500         MOVE ER-8057            TO EMI-ERROR
 14501         GO TO 5300-BAD-EXIT.
 14502
 14503     IF DM-RETURN-CODE = '08'
 14504         MOVE ER-8058            TO EMI-ERROR
 14505         GO TO 5300-BAD-EXIT.
 14506
 14507     IF DM-RETURN-CODE = '09'
 14508         MOVE ER-8059            TO EMI-ERROR
 14509         GO TO 5300-BAD-EXIT.
 14510
 14511     IF DM-RETURN-CODE = '10'
 14512         MOVE ER-8060            TO EMI-ERROR
 14513         GO TO 5300-BAD-EXIT.
 14514
 14515     IF DM-RETURN-CODE = '11'
 14516         MOVE ER-8061            TO EMI-ERROR
 14517         GO TO 5300-BAD-EXIT.
 14518
 14519     IF DM-RETURN-CODE = '12'
 14520         MOVE ER-8062            TO EMI-ERROR
 14521         GO TO 5300-BAD-EXIT.
 14522
 14523     IF DM-RETURN-CODE = '13'
 14524         MOVE ER-8063            TO EMI-ERROR
 14525         GO TO 5300-BAD-EXIT.
 14526
 14527     IF DM-RETURN-CODE = '14'
 14528         MOVE ER-8064            TO EMI-ERROR
 14529         GO TO 5300-BAD-EXIT.
 14530
 14531     IF DM-RETURN-CODE = '15'
 14532         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 278
* EL156.cbl
 14533         GO TO 5300-BAD-EXIT.
 14534
 14535     IF DM-RETURN-CODE = '16'
 14536         MOVE ER-8154            TO EMI-ERROR
 14537         GO TO 5300-BAD-EXIT.
 14538
 14539     IF DM-RETURN-CODE = '17'
 14540         MOVE ER-8155            TO EMI-ERROR
 14541         GO TO 5300-BAD-EXIT.
 14542
 14543     IF DM-RETURN-CODE = 'N1'
 14544         MOVE ER-8152            TO EMI-ERROR
 14545         GO TO 5300-BAD-EXIT.
 14546
 14547     IF DM-RETURN-CODE = 'E1'
 14548         MOVE ER-8153            TO EMI-ERROR
 14549         GO TO 5300-BAD-EXIT.
 14550
 14551     MOVE ER-8066            TO EMI-ERROR.
 14552     GO TO 5300-BAD-EXIT.
 14553
 14554 5300-NOTE-NOT-FOUND.
 14555
 14556     MOVE ER-0954                TO EMI-ERROR.
 14557     GO TO 5300-BAD-EXIT.
 14558
 14559 5300-BAD-EXIT.
 14560
 14561* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14562*    MOVE '6"R                   !   #00013687' TO DFHEIV0
 14563     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14565     MOVE X'2020233030303133363837' TO DFHEIV0(25:11)
 14566     CALL 'kxdfhei1' USING DFHEIV0
 14567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14568
 14569     IF MAP-NAME = 'EL156A'
 14570         MOVE -1             TO ENTERPFL
 14571       ELSE
 14572         MOVE LOW-VALUES     TO EL156BI
 14573         MOVE -1             TO ENTPFBL.
 14574
 14575     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14576     GO TO 8200-SEND-DATAONLY.
 14577
 14578 5300-EXIT.
 14579     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 279
* EL156.cbl
 14581 5350-FORMAT-LAST-NAME-1ST.
 14582*****************************************************************
 14583*             M O V E   N A M E   R O U T I N E                 *
 14584*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14585*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14586*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14587*                  FIELD                   VALUE                *
 14588*           W-NAME-LAST    (CL15)      SMITH                    *
 14589*           W-NAME-FIRST   (CL15)      JOHN                     *
 14590*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14591*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14592*     CONTAIN                                                   *
 14593*                SMITH, JOHN ALLEN                              *
 14594*     OR                                                        *
 14595*                SMITH, JOHN A.                                 *
 14596*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14597*     COPYBOOK, ELCNWA.                                         *
 14598*****************************************************************.
 14599
 14600     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14601     MOVE ZERO                   TO  WS-NAME-SW.
 14602     SET NWA-INDEX               TO +1.
 14603
 14604     IF W-NAME-LAST   = SPACES AND
 14605        W-NAME-MIDDLE = SPACES
 14606         MOVE +1                 TO WS-NAME-SW.
 14607
 14608     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14609     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14610
 14611     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14612     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14613
 14614     SET NWA-INDEX UP BY +1.
 14615
 14616     IF W-NAME-MIDDLE NOT = SPACES
 14617         IF W-NAME-MIDDLE-2 = SPACES
 14618             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14619             SET NWA-INDEX UP BY +1
 14620             MOVE '.'            TO WS-NW (NWA-INDEX)
 14621             SET NWA-INDEX UP BY +2
 14622         ELSE
 14623             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14624             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14625
 14626 5350-EXIT.
 14627     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 280
* EL156.cbl
 14629 5360-MOVE-NAME.
 14630
 14631     IF WS-NAME-SW > +1
 14632         GO TO 5360-EXIT.
 14633
 14634     IF WS-NAME-WORK2 = SPACES
 14635         GO TO 5360-EXIT.
 14636
 14637     SET NWA-INDEX2            TO +1.
 14638     SET NWA-INDEX3            TO +2.
 14639
 14640 5360-MOVE-NAME-CYCLE.
 14641
 14642     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14643
 14644     IF NWA-INDEX < +30
 14645         SET NWA-INDEX UP BY +1
 14646     ELSE
 14647         ADD +2                TO  WS-NAME-SW
 14648         GO TO 5360-EXIT.
 14649
 14650     IF NWA-INDEX2 < +20
 14651         SET NWA-INDEX3 UP BY +1
 14652         SET NWA-INDEX2 UP BY +1.
 14653
 14654     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14655        WS-NW2 (NWA-INDEX3) = SPACES
 14656         IF WS-NAME-SW = ZERO
 14657             MOVE ','            TO  WS-NW (NWA-INDEX)
 14658             SET NWA-INDEX UP BY +2
 14659             MOVE +1             TO  WS-NAME-SW
 14660             GO TO 5360-EXIT
 14661         ELSE
 14662             GO TO 5360-EXIT.
 14663
 14664     GO TO 5360-MOVE-NAME-CYCLE.
 14665
 14666 5360-EXIT.
 14667     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 281
* EL156.cbl
 14669 6000-BUILD-SCREEN-B.
 14670     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14671     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14672     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14673     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14674
 14675     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14676
 14677 6050-BUILD-SCREEN.
 14678     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14679     MOVE LOW-VALUES             TO EL156BI.
 14680     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14681
 14682     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14683
 14684     IF PI-PAYEE-TYPE = 'I'
 14685        GO TO 6060-READ-TRAILER.
 14686
 14687     IF PI-PAYEE-TYPE = 'B'
 14688        ADD +10                  TO TRLR-SEQ-NO
 14689        GO TO 6060-READ-TRAILER.
 14690
 14691     IF PI-PAYEE-TYPE = 'A'
 14692        ADD +20                  TO TRLR-SEQ-NO
 14693        GO TO 6060-READ-TRAILER.
 14694
 14695     IF PI-PAYEE-TYPE = 'O'
 14696        ADD +50                  TO TRLR-SEQ-NO
 14697        GO TO 6060-READ-TRAILER.
 14698
 14699     IF PI-PAYEE-TYPE = 'Q'
 14700        ADD +60                  TO TRLR-SEQ-NO
 14701        GO TO 6060-READ-TRAILER.
 14702
 14703     IF PI-PAYEE-TYPE = 'P'
 14704        ADD +30                  TO TRLR-SEQ-NO
 14705        GO TO 6060-READ-TRAILER.
 14706
 14707     IF PI-PAYEE-TYPE = 'E'
 14708        ADD +40                  TO TRLR-SEQ-NO.
 14709
 14710 6060-READ-TRAILER.
 14711
 14712     IF PI-PAYEE-TYPE    = 'A' AND
 14713        PI-PAYEE-SEQ-NUM = 0
 14714          GO TO 6061-READ-ACCOUNT.
 14715
 14716     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14717        (PI-PAYEE-TYPE    = 'B')             AND
 14718        (PI-PAYEE-SEQ-NUM = 9)
 14719          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14720          IF BENE-FOUND-SW = 'N'
 14721            GO TO 6065-NOT-FOUND
 14722          ELSE
 14723            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14724            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14725            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14726*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 282
* EL156.cbl
 14727            STRING BE-CITY ' ' BE-STATE
 14728               DELIMITED BY '  ' INTO CITYSTBO
 14729            END-STRING
 14730            MOVE BE-ZIP-CODE       TO ZIPBO
 14731            GO TO 6061-READ-ACCOUNT.
 14732
 14733     IF PI-PAYEE-TYPE    = 'B' AND
 14734        PI-PAYEE-SEQ-NUM = 0
 14735          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14736          IF BENE-FOUND-SW = 'N'
 14737            GO TO 6065-NOT-FOUND
 14738          ELSE
 14739            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14740            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14741            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14742*           MOVE BE-CITY-STATE     TO CITYSTBO
 14743            STRING BE-CITY ' ' BE-STATE
 14744               DELIMITED BY '  ' INTO CITYSTBO
 14745            END-STRING
 14746            MOVE BE-ZIP-CODE       TO ZIPBO
 14747            GO TO 6061-READ-ACCOUNT.
 14748
 14749
 14750* EXEC CICS HANDLE CONDITION
 14751*         NOTFND(6065-NOT-FOUND)
 14752*     END-EXEC.
 14753*    MOVE '"$I                   ! / #00013868' TO DFHEIV0
 14754     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14756     MOVE X'2F20233030303133383638' TO DFHEIV0(25:11)
 14757     CALL 'kxdfhei1' USING DFHEIV0
 14758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14759
 14760
 14761     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14762
 14763     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14764     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14765     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14766     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14767*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14768     STRING AT-CITY ' ' AT-STATE
 14769        DELIMITED BY '  ' INTO CITYSTBO
 14770     END-STRING
 14771     MOVE AT-ZIP-CODE            TO ZIPBO.
 14772
 14773 6061-READ-ACCOUNT.
 14774
 14775* EXEC CICS HANDLE CONDITION
 14776*         NOTFND(6068-ACCT-NOT-FND)
 14777*     END-EXEC.
 14778*    MOVE '"$I                   ! 0 #00013885' TO DFHEIV0
 14779     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14780     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14781     MOVE X'3020233030303133383835' TO DFHEIV0(25:11)
 14782     CALL 'kxdfhei1' USING DFHEIV0
 14783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14784
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 283
* EL156.cbl
 14785
 14786
 14787* EXEC CICS READ
 14788*         DATASET('ERACCT')
 14789*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14790*         RIDFLD (PI-ACCT-KEY)
 14791*     END-EXEC.
 14792     MOVE 'ERACCT' TO DFHEIV1
 14793*    MOVE '&"S        E          (   #00013889' TO DFHEIV0
 14794     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14795     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14796     MOVE X'2020233030303133383839' TO DFHEIV0(25:11)
 14797     CALL 'kxdfhei1' USING DFHEIV0,
 14798           DFHEIV1,
 14799           DFHEIV20,
 14800           DFHEIV99,
 14801           PI-ACCT-KEY,
 14802           DFHEIV99,
 14803           DFHEIV99,
 14804           DFHEIV99
 14805     SET ADDRESS OF ACCOUNT-MASTER TO
 14806         DFHEIV20
 14807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14808
 14809
 14810     MOVE AM-CARRIER             TO ACARRBO.
 14811     MOVE AM-GROUPING            TO GROUPBO.
 14812     MOVE AM-STATE               TO STATEBO.
 14813     MOVE AM-ACCOUNT             TO ACCTBO.
 14814     MOVE AM-NAME                TO ACCTNMBO.
 14815
 14816     IF PI-PAYEE-TYPE = 'A' AND
 14817        PI-PAYEE-SEQ-NUM = 0
 14818          MOVE AM-NAME             TO NAMEBO
 14819                                      PI-PAYEE-NAME
 14820          MOVE AM-ADDRS            TO ADDR1BO
 14821          MOVE SPACES              TO ADDR2BO
 14822*         MOVE AM-CITY             TO CITYSTBO
 14823          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14824             DELIMITED BY '  ' INTO CITYSTBO
 14825          END-STRING
 14826          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14827          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14828          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14829          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14830
 14831     IF CITYSTBO EQUAL SPACES
 14832         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14833         GO TO 6070-FORMAT-DATA
 14834     END-IF.
 14835
 14836     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14837     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14838     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14839     PERFORM VARYING WS-SUB FROM 30 BY -1
 14840          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14841        IF WS-END-SUB = 0  AND
 14842           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 284
* EL156.cbl
 14843              OR LOW-VALUES  OR '.')
 14844            CONTINUE
 14845        ELSE
 14846            IF WS-END-SUB = 0
 14847                MOVE WS-SUB TO WS-END-SUB
 14848            ELSE
 14849                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14850                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14851                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14852                END-IF
 14853            END-IF
 14854        END-IF
 14855        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14856            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14857            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14858        END-IF
 14859     END-PERFORM.
 14860
 14861     IF WS-BEG-SUB > 0
 14862         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14863         IF WS-STATE-LENGTH = 2
 14864             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14865                  TO PI-CHECK-STATE-FOR-AK
 14866         ELSE
 14867             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14868                'ALASKA'
 14869                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14870             ELSE
 14871                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14872             END-IF
 14873         END-IF
 14874     ELSE
 14875         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14876     END-IF.
 14877
 14878     GO TO 6070-FORMAT-DATA.
 14879
 14880 6065-NOT-FOUND.
 14881     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14882     GO TO 6061-READ-ACCOUNT.
 14883
 14884 6068-ACCT-NOT-FND.
 14885     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 14886
 14887 6070-FORMAT-DATA.
 14888     IF PI-HOLDTIL = ZEROS
 14889        MOVE SAVE-DATE           TO PAYDTBI
 14890       ELSE
 14891        MOVE PI-HOLDTIL          TO PAYDTBO
 14892        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 14893
 14894     MOVE PI-PROOF-DATE          TO PROOFDBO.
 14895     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 14896
 14897     IF EIBAID = DFHPF3 OR DFHPF4
 14898        NEXT SENTENCE
 14899     ELSE
 14900       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 285
* EL156.cbl
 14901
 14902     MOVE PI-EPYFROM          TO PYFROMBO.
 14903     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 14904
 14905     IF NOT PI-USES-PAID-TO
 14906        MOVE PI-EPYTHRU          TO PYTHRUBO
 14907        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 14908     ELSE
 14909        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 14910        MOVE '4'              TO DC-OPTION-CODE
 14911        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14912        IF NO-CONVERSION-ERROR
 14913           MOVE +1            TO DC-ELAPSED-DAYS
 14914           MOVE +0            TO DC-ELAPSED-MONTHS
 14915           MOVE '6'           TO DC-OPTION-CODE
 14916           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14917           IF NO-CONVERSION-ERROR
 14918              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14919
 14920     MOVE PI-EDAYS            TO DAYSBO.
 14921     MOVE PI-EPYAMT           TO PAYAMTBO.
 14922     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14923        IF PI-INT-AMT > ZEROS
 14924           MOVE PI-INT-AMT       TO INTAMTBO
 14925        END-IF
 14926     END-IF
 14927     GO TO 6072-SET-TYPE.
 14928
 14929 6071-CONTINUE.
 14930
 14931     IF PI-CPYFROM NOT = LOW-VALUES
 14932        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 14933        MOVE SPACES              TO DC-OPTION-CODE
 14934        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14935        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 14936
 14937     IF PI-CPYTHRU NOT = LOW-VALUES
 14938        IF NOT PI-USES-PAID-TO
 14939           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14940           MOVE SPACES             TO DC-OPTION-CODE
 14941           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14942           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 14943        ELSE
 14944           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14945           MOVE '6'                TO DC-OPTION-CODE
 14946           MOVE +1                 TO DC-ELAPSED-DAYS
 14947           MOVE +0                 TO DC-ELAPSED-MONTHS
 14948           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14949           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14950
 14951     MOVE PI-CDAYS               TO DAYSBO.
 14952     MOVE PI-CPYAMT              TO PAYAMTBO.
 14953     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14954        IF PI-INT-AMT > ZEROS
 14955           MOVE PI-INT-AMT       TO INTAMTBO
 14956        END-IF
 14957     END-IF
 14958     .
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 286
* EL156.cbl
 14959 6072-SET-TYPE.
 14960     IF PI-PMTTYPE = '1'
 14961        MOVE 'PARTIAL'           TO PAYTYPBO.
 14962
 14963     IF PI-PMTTYPE = '2'
 14964        MOVE 'FINAL'             TO PAYTYPBO.
 14965
 14966     IF PI-PMTTYPE = '3'
 14967        MOVE 'LUMP SUM'          TO PAYTYPBO.
 14968
 14969     IF PI-PMTTYPE = '4'
 14970        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 14971
 14972     IF PI-PMTTYPE = '5'
 14973        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 14974
 14975     IF PI-PMTTYPE = '6'
 14976        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 14977
 14978     IF PI-PROV-PMT
 14979        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 14980
 14981     IF PI-ECHECKNO NOT = SPACES
 14982        MOVE PI-ECHECKNO         TO CKNUMBO
 14983     ELSE
 14984        MOVE PI-CCHECKNO         TO CKNUMBO.
 14985
 14986     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 14987        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 14988        MOVE +91                 TO  TRLR-SEQ-NO
 14989
 14990* EXEC CICS READ
 14991*           DATASET  ('ELTRLR')
 14992*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14993*           RIDFLD   (ELTRLR-KEY)
 14994*           RESP     (WS-RESPONSE)
 14995*       END-EXEC
 14996     MOVE 'ELTRLR' TO DFHEIV1
 14997*    MOVE '&"S        E          (  N#00014074' TO DFHEIV0
 14998     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14999     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15000     MOVE X'204E233030303134303734' TO DFHEIV0(25:11)
 15001     CALL 'kxdfhei1' USING DFHEIV0,
 15002           DFHEIV1,
 15003           DFHEIV20,
 15004           DFHEIV99,
 15005           ELTRLR-KEY,
 15006           DFHEIV99,
 15007           DFHEIV99,
 15008           DFHEIV99
 15009     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15010         DFHEIV20
 15011     MOVE EIBRESP  TO WS-RESPONSE
 15012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15013
 15014        IF WS-RESP-NORMAL
 15015           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15016        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 287
* EL156.cbl
 15017           MOVE SPACES           TO  LOANNBO
 15018        END-IF
 15019     END-IF
 15020
 15021*       MOVE PI-LOAN-NO          TO LOANNBO
 15022
 15023     IF CKNUMBO = SPACES
 15024         MOVE SPACES             TO CKNUMHDO.
 15025
 15026     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15027     MOVE CL-CARRIER             TO CARRBO.
 15028     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15029     MOVE CL-CERT-SFX            TO SUFXBO.
 15030
 15031     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 15032        EVALUATE CL-CLAIM-TYPE
 15033           WHEN 'I'
 15034              MOVE '  IU  '      TO CLMTYPBO
 15035           WHEN 'G'
 15036              MOVE ' GAP  '      TO CLMTYPBO
 15037           WHEN 'F'
 15038              MOVE ' FAM  '      TO CLMTYPBO
 15039           WHEN OTHER
 15040              MOVE PI-AH-OVERRIDE-L6
 15041                                 TO CLMTYPBO
 15042        END-EVALUATE
 15043        MOVE ZEROS               TO UNDISBO
 15044*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15045        IF PI-PMTTYPE = '5' OR '6'
 15046           GO TO 6073-GET-NOTIFY-DATA
 15047        ELSE
 15048           MOVE PI-DAILY-RATE    TO RATEBO
 15049           GO TO 6073-GET-NOTIFY-DATA.
 15050
 15051     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15052
 15053     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15054        MOVE ZEROS               TO UNDISBO
 15055     ELSE
 15056        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15057
 15058 6073-GET-NOTIFY-DATA.
 15059
 15060     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15061
 15062     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15063         MOVE SPACES             TO  NAMEB2O
 15064                                     ADDR1B2O
 15065                                     ADDR2B2O
 15066                                     CITYST2O
 15067                                     AGTHDGO
 15068         MOVE ZEROS              TO  ZIPB2O
 15069         GO TO 6080-SET-INCURRED.
 15070
 15071     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15072     MOVE +29                    TO  TRLR-SEQ-NO.
 15073
 15074
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 288
* EL156.cbl
 15075* EXEC CICS HANDLE CONDITION
 15076*        NOTFND   (6074-GET-COMP-DATA)
 15077*    END-EXEC.
 15078*    MOVE '"$I                   ! 1 #00014141' TO DFHEIV0
 15079     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15081     MOVE X'3120233030303134313431' TO DFHEIV0(25:11)
 15082     CALL 'kxdfhei1' USING DFHEIV0
 15083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15084
 15085
 15086     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15087
 15088     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15089     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15090     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15091*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15092     STRING AT-CITY ' ' AT-STATE
 15093        DELIMITED BY '  ' INTO CITYST2O
 15094     END-STRING
 15095     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15096     GO TO 6080-SET-INCURRED.
 15097
 15098 6074-GET-COMP-DATA.
 15099
 15100     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15101         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15102
 15103     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15104         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15105                                         ADDR1B2O
 15106                                         ADDR2B2O
 15107                                         CITYST2O
 15108         MOVE ZEROS                  TO  ZIPB2O
 15109         GO TO 6080-SET-INCURRED.
 15110
 15111     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15112     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15113     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15114     MOVE AM-GROUPING            TO  COMP-GROUP.
 15115     MOVE 'A'                    TO  COMP-TYPE.
 15116     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15117                                 TO  COMP-FIN-RESP.
 15118
 15119     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15120         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15121                                       'G' OR 'B'
 15122             MOVE 'G'            TO  COMP-TYPE
 15123             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15124         ELSE
 15125             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15126                                 TO  COMP-ACCOUNT
 15127     ELSE
 15128         MOVE 'G'                TO  COMP-TYPE
 15129         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15130
 15131     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15132
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 289
* EL156.cbl
 15133     IF COMP-REC-FOUND
 15134         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15135         MOVE CO-ADDR-1          TO  ADDR1B2O
 15136         MOVE CO-ADDR-2          TO  ADDR2B2O
 15137*        MOVE CO-ADDR-3          TO  CITYST2O
 15138         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15139            DELIMITED BY '  ' INTO CITYST2O
 15140         END-STRING
 15141         MOVE CO-ZIP             TO  ZIPB2O
 15142     ELSE
 15143         MOVE 'NO COMP ADDRESS AVAILABLE'
 15144                                 TO  NAMEB2O
 15145                                     ADDR1B2O
 15146                                     ADDR2B2O
 15147                                     CITYST2O
 15148         MOVE ZEROS               TO ZIPB2O.
 15149
 15150 6080-SET-INCURRED.
 15151     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15152     MOVE SPACES                 TO DC-OPTION-CODE.
 15153     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15154     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15155     MOVE PI-PROCESSOR-ID        TO BYBO.
 15156     MOVE MAP-NAMEB              TO MAP-NAME.
 15157     MOVE 'C'                    TO PI-PASS-SW.
 15158     MOVE EIBAID                 TO PI-PFKEY-USED.
 15159     MOVE -1                     TO ENTPFBL.
 15160     GO TO 8100-SEND-INITIAL-MAP.
 15161
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 290
* EL156.cbl
 15163 6100-BUILD-PAYMENT-TRAILER.
 15164
 15165     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 15166       (PI-COMPANY-ID = 'CID' OR 'AHL')
 15167         GO TO 6105-STATE-CHECK-NUMBER
 15168     END-IF.
 15169
 15170     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15171     MOVE '6'                    TO CNTL-REC-TYPE.
 15172
 15173     IF CONTROL-IS-ACTUAL-CARRIER
 15174         MOVE PI-CARRIER         TO WS-CARR
 15175     ELSE
 15176         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15177
 15178     IF PI-COMPANY-ID = 'FIA'
 15179         MOVE PI-CARRIER         TO  WS-CARR.
 15180
 15181     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15182     MOVE 0                      TO CNTL-SEQ-NO.
 15183     MOVE 'CARR'                 TO FILE-SWITCH.
 15184
 15185     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15186
 15187     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15188         IF PI-OFFLINE     = 'Y' AND
 15189            PI-ECHECKNO-CR = 'CR'
 15190              GO TO 6110-READ-CONTROL
 15191         ELSE
 15192            IF PI-CASH = 'N'
 15193                GO TO 6110-READ-CONTROL.
 15194
 15195     IF CHECK-NO-MANUAL    OR
 15196        CHECK-NO-AT-PRINT  OR
 15197        PI-OFFLINE = 'Y'
 15198          GO TO 6130-BUILD-TRAILER.
 15199
 15200     IF PI-COMPANY-ID = 'FIA'
 15201         NEXT SENTENCE
 15202     ELSE
 15203         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15204             GO TO 6110-READ-CONTROL.
 15205
 15206     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15207
 15208     IF CHECK-CNT-RESET-VALUE
 15209        MOVE +1                  TO CF-CHECK-COUNTER
 15210     ELSE
 15211        ADD +1                   TO CF-CHECK-COUNTER.
 15212
 15213     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15214
 15215     IF CHECK-NO-CARR-SEQ
 15216        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15217
 15218     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15219
 15220     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 291
* EL156.cbl
 15221     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15222        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15223         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15224         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15225            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15226         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15227                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15228     END-IF.
 15229
 15230     GO TO 6120-REWRITE.
 15231
 15232 6105-STATE-CHECK-NUMBER.
 15233     IF CHECK-NO-MANUAL    OR
 15234        CHECK-NO-AT-PRINT  OR
 15235        PI-OFFLINE = 'Y'
 15236           GO TO 6130-BUILD-TRAILER
 15237     END-IF.
 15238
 15239     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15240     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15241     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15242     MOVE '3'                TO CNTL-REC-TYPE.
 15243     MOVE +0                 TO CNTL-SEQ-NO.
 15244     MOVE 'STAT'             TO FILE-SWITCH.
 15245     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15246
 15247     IF CF-ST-CHECK-CNT-RESET
 15248         MOVE +1             TO CF-ST-CHECK-COUNTER
 15249     ELSE
 15250         ADD +1              TO CF-ST-CHECK-COUNTER
 15251     END-IF.
 15252
 15253     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15254     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15255     GO TO 6120-REWRITE.
 15256
 15257 6110-READ-CONTROL.
 15258     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15259     MOVE '1'                    TO CNTL-REC-TYPE.
 15260     MOVE SPACES                 TO CNTL-ACCESS.
 15261     MOVE 0                      TO CNTL-SEQ-NO.
 15262
 15263     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15264
 15265     IF CO-CHECK-COUNT-RESET
 15266        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15267     ELSE
 15268        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15269
 15270     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15271
 15272     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15273         IF PI-OFFLINE     = 'Y'  AND
 15274            PI-ECHECKNO-CR = 'CR'
 15275              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15276              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15277              MOVE AL-UANON           TO CHECKNOA
 15278              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 292
* EL156.cbl
 15279         ELSE
 15280         IF PI-CASH = 'N'
 15281             MOVE 'N'                TO PI-ECHECKNO-N
 15282             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15283             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15284             MOVE AL-UANON           TO CHECKNOA
 15285             GO TO 6120-REWRITE.
 15286
 15287     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15288
 15289 6120-REWRITE.
 15290
 15291* EXEC CICS REWRITE
 15292*         DATASET('ELCNTL')
 15293*         FROM(CONTROL-FILE)
 15294*     END-EXEC.
 15295     MOVE LENGTH OF
 15296      CONTROL-FILE
 15297       TO DFHEIV11
 15298     MOVE 'ELCNTL' TO DFHEIV1
 15299*    MOVE '&& L                  %   #00014349' TO DFHEIV0
 15300     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15301     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15302     MOVE X'2020233030303134333439' TO DFHEIV0(25:11)
 15303     CALL 'kxdfhei1' USING DFHEIV0,
 15304           DFHEIV1,
 15305           CONTROL-FILE,
 15306           DFHEIV11,
 15307           DFHEIV99
 15308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15309
 15310
 15311     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15312
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 293
* EL156.cbl
 15314 6130-BUILD-TRAILER.
 15315
 15316
 15317* EXEC CICS GETMAIN
 15318*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15319*         LENGTH    (200)
 15320*         INITIMG   (GETMAIN-SPACE)
 15321*     END-EXEC.
 15322     MOVE 200
 15323       TO DFHEIV11
 15324*    MOVE ',"IL                  $   #00014359' TO DFHEIV0
 15325     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15326     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15327     MOVE X'2020233030303134333539' TO DFHEIV0(25:11)
 15328     CALL 'kxdfhei1' USING DFHEIV0,
 15329           DFHEIV20,
 15330           DFHEIV11,
 15331           GETMAIN-SPACE
 15332     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15333         DFHEIV20
 15334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15335
 15336
 15337     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15338                                    AT-PREV-PAID-THRU-DT.
 15339     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15340     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15341     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15342     MOVE 'AT'                   TO AT-RECORD-ID.
 15343     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15344
 15345     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15346        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15347           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15348     ELSE
 15349           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15350           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15351
 15352     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15353         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15354             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15355             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15356           ELSE
 15357             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15358             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15359
 15360     MOVE '2'                    TO AT-TRAILER-TYPE.
 15361     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15362                                    AT-PAYMENT-LAST-MAINT-DT.
 15363     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15364                                    AT-PAYMENT-LAST-UPDATED-BY.
 15365     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15366     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15367     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15368     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15369
 15370     IF PI-PMT-APPROVED
 15371        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 294
* EL156.cbl
 15372           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15373
 15374     IF PI-PFKEY-USED = DFHPF5
 15375        GO TO 6140-PF5-ENTERED.
 15376
 15377     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15378     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15379
 15380     IF PI-AIG-SPECIAL-BENEFIT
 15381         IF WS-1ST-SPECIAL-PMT
 15382             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15383             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15384                                        AT-AMOUNT-PAID
 15385         ELSE
 15386             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15387
 15388     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15389
 15390     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15391     MOVE '4'                    TO DC-OPTION-CODE.
 15392     PERFORM 9700-LINK-DATE-CONVERT.
 15393
 15394     IF DATE-CONVERSION-ERROR
 15395        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15396     ELSE
 15397        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15398
 15399     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15400     MOVE '4'                    TO DC-OPTION-CODE.
 15401     PERFORM 9700-LINK-DATE-CONVERT.
 15402
 15403     IF DATE-CONVERSION-ERROR
 15404        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15405     ELSE
 15406        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15407
 15408     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15409     GO TO 6150-FINISH-MOVE.
 15410
 15411 6140-PF5-ENTERED.
 15412     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15413     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15414
 15415     IF PI-AIG-SPECIAL-BENEFIT
 15416         IF WS-1ST-SPECIAL-PMT
 15417             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15418             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15419                                        AT-AMOUNT-PAID
 15420         ELSE
 15421             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15422
 15423     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15424     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15425     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15426
 15427 6150-FINISH-MOVE.
 15428
 15429     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 295
* EL156.cbl
 15430         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15431     ELSE
 15432         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15433
 15434     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15435     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15436
 15437*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15438*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15439
 15440     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15441         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15442
 15443     IF PI-OFFLINE = 'N'
 15444        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15445        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15446     ELSE
 15447        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15448        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15449
 15450     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15451
 15452     IF WS-2ND-SPECIAL-PMT
 15453         MOVE 'Y'                TO AT-CASH-PAYMENT
 15454         MOVE SPACES             TO AT-CHECK-NO
 15455         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15456         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15457         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15458         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15459
 15460     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15461                                    AT-TO-BE-WRITTEN-DT.
 15462
 15463     IF PI-HOLDTIL NOT = ZEROS
 15464        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15465        MOVE '4'                 TO DC-OPTION-CODE
 15466        PERFORM 9700-LINK-DATE-CONVERT
 15467        IF PI-OFFLINE = 'N'
 15468           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15469        ELSE
 15470           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15471
 15472     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15473     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15474                                    AT-CHECK-QUE-SEQUENCE.
 15475
 15476     IF PI-PFKEY-USED = DFHPF4
 15477        MOVE '1'                 TO AT-FORCE-CONTROL.
 15478
 15479     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15480        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15481        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15482        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15483
 15484     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15485                                    AT-VOID-SELECT-DT
 15486                                    AT-VOID-ACCEPT-DT
 15487                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 296
* EL156.cbl
 15488     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 15489        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15490        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15491        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15492        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15493     ELSE
 15494        MOVE ZEROS               TO AT-DAILY-RATE
 15495                                    AT-ELIMINATION-DAYS
 15496        MOVE SPACES              TO AT-BENEFIT-TYPE
 15497     END-IF
 15498     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15499     MOVE '4'                    TO DC-OPTION-CODE.
 15500     PERFORM 9700-LINK-DATE-CONVERT.
 15501     IF DATE-CONVERSION-ERROR
 15502         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15503     ELSE
 15504         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15505     END-IF.
 15506     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15507     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15508     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15509     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15510     IF (PI-REAUDIT-NEEDED = 'Y')
 15511        or (pi-max-ext-used = 'Y')
 15512        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15513         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15514         MOVE 'Y' TO WS-NEED-APPROVAL
 15515         GO TO 6170-WRITE
 15516     END-IF.
 15517*******************************************************
 15518     IF NOT PI-PMT-GRADUATED
 15519         GO TO 6170-WRITE.
 15520
 15521     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15522     MOVE '1'                    TO CNTL-REC-TYPE.
 15523     MOVE SPACES                 TO CNTL-ACCESS.
 15524     MOVE +0                     TO CNTL-SEQ-NO.
 15525     MOVE 'COMP'                 TO FILE-SWITCH.
 15526
 15527     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15528
 15529     IF PAID-FOR-LIFE
 15530         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15531             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15532                                     WS-PMT-APPROVAL-SW
 15533             GO TO 6170-WRITE.
 15534
 15535*05999      IF PAID-FOR-AH
 15536     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15537         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15538             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15539                                     WS-PMT-APPROVAL-SW
 15540             GO TO 6170-WRITE.
 15541
 15542     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15543
 15544******A&H Limits are set as a monthly payment.  Calculate the mont
 15545******equivalent of the amount paid today
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 297
* EL156.cbl
 15546     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15547        PI-SAVE-ODD-DAYS-OVER > 0
 15548           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15549                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15550           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15551                                  WS-CALC-PMT-MONTHS
 15552     ELSE
 15553           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15554     END-IF.
 15555*06007      IF ((PAID-FOR-AH) AND
 15556     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15557*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15558        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15559              OR
 15560        ((PAID-FOR-LIFE) AND
 15561        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15562            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15563       ELSE
 15564*06014      IF ((PAID-FOR-AH)  AND
 15565         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15566*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15567           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15568              OR
 15569        ((PAID-FOR-LIFE) AND
 15570        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15571            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15572         ELSE
 15573*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15574           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15575               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15576              OR
 15577          ((PAID-FOR-LIFE) AND
 15578          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15579            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15580       ELSE
 15581           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15582               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15583              OR
 15584          ((PAID-FOR-LIFE) AND
 15585          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15586            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15587       ELSE
 15588            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15589
 15590     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15591        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15592        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15593            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15594        END-IF
 15595     ELSE
 15596     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15597        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15598        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15599            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15600        END-IF
 15601     ELSE
 15602     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15603        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 298
* EL156.cbl
 15604        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15605            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15606        END-IF
 15607     ELSE
 15608     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15609        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15610        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15611            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15612        END-IF
 15613     ELSE
 15614     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15615            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15616
 15617     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15618
 15619     IF NOT PI-PMT-GRADUATED
 15620         GO TO 6170-WRITE.
 15621
 15622
 15623* EXEC CICS HANDLE CONDITION
 15624*        NOTFND   (6170-WRITE)
 15625*    END-EXEC.
 15626*    MOVE '"$I                   ! 2 #00014650' TO DFHEIV0
 15627     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15629     MOVE X'3220233030303134363530' TO DFHEIV0(25:11)
 15630     CALL 'kxdfhei1' USING DFHEIV0
 15631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15632
 15633
 15634     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15635     MOVE '2'                    TO CNTL-REC-TYPE.
 15636     MOVE +0                     TO CNTL-SEQ-NO.
 15637     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15638
 15639
 15640* EXEC CICS READ
 15641*         DATASET  ('ELCNTL')
 15642*         SET      (ADDRESS OF CONTROL-FILE)
 15643*         RIDFLD   (ELCNTL-KEY)
 15644*    END-EXEC.
 15645     MOVE 'ELCNTL' TO DFHEIV1
 15646*    MOVE '&"S        E          (   #00014659' TO DFHEIV0
 15647     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15648     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15649     MOVE X'2020233030303134363539' TO DFHEIV0(25:11)
 15650     CALL 'kxdfhei1' USING DFHEIV0,
 15651           DFHEIV1,
 15652           DFHEIV20,
 15653           DFHEIV99,
 15654           ELCNTL-KEY,
 15655           DFHEIV99,
 15656           DFHEIV99,
 15657           DFHEIV99
 15658     SET ADDRESS OF CONTROL-FILE TO
 15659         DFHEIV20
 15660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15661
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 299
* EL156.cbl
 15662
 15663     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15664
 15665     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15666                         OR '4' OR '5'
 15667         NEXT SENTENCE
 15668     ELSE
 15669         MOVE 'Y' TO WS-NEED-APPROVAL
 15670         GO TO 6170-WRITE.
 15671
 15672     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15673         MOVE 'Y' TO WS-NEED-APPROVAL
 15674         IF WS-APPROVAL-LEVEL = '1'
 15675             MOVE '2'        TO  AT-APPROVED-LEVEL
 15676                            WS-SAVE-APPROVED-LEVEL
 15677             GO TO 6170-WRITE
 15678         ELSE
 15679             IF WS-APPROVAL-LEVEL = '2'
 15680                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15681                                WS-SAVE-APPROVED-LEVEL
 15682                 GO TO 6170-WRITE
 15683             ELSE IF WS-APPROVAL-LEVEL = '3'
 15684                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15685                                WS-SAVE-APPROVED-LEVEL
 15686                 GO TO 6170-WRITE
 15687             ELSE IF WS-APPROVAL-LEVEL = '4'
 15688                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15689                                WS-SAVE-APPROVED-LEVEL
 15690                 GO TO 6170-WRITE.
 15691
 15692     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15693                             WS-PMT-APPROVAL-SW.
 15694     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15695                             AT-APPROVAL-LEVEL-REQD.
 15696
 15697*******************************************************
 15698
 15699 6170-WRITE.
 15700
 15701     if pi-company-id = 'DCC'
 15702        PERFORM 0900-GET-DDF-limits
 15703                                 THRU 0900-EXIT
 15704     end-if
 15705     perform 2220-update-elcrtt  thru 2220-exit
 15706     IF PI-COMPANY-ID = 'DMD'
 15707        IF PI-AT-EOB-CODES NOT = SPACES
 15708           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15709           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15710           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15711           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15712           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15713
 15714
 15715* EXEC CICS HANDLE CONDITION
 15716*        DUPREC    (6180-DUPREC)
 15717*    END-EXEC.
 15718*    MOVE '"$%                   ! 3 #00014716' TO DFHEIV0
 15719     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 300
* EL156.cbl
 15720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15721     MOVE X'3320233030303134373136' TO DFHEIV0(25:11)
 15722     CALL 'kxdfhei1' USING DFHEIV0
 15723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15724
 15725
 15726
 15727* EXEC CICS WRITE
 15728*         DATASET       ('ELTRLR')
 15729*         FROM          (ACTIVITY-TRAILERS)
 15730*         RIDFLD        (AT-CONTROL-PRIMARY)
 15731*     END-EXEC.
 15732     MOVE LENGTH OF
 15733      ACTIVITY-TRAILERS
 15734       TO DFHEIV11
 15735     MOVE 'ELTRLR' TO DFHEIV1
 15736*    MOVE '&$ L                  ''   #00014720' TO DFHEIV0
 15737     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15738     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15739     MOVE X'2020233030303134373230' TO DFHEIV0(25:11)
 15740     CALL 'kxdfhei1' USING DFHEIV0,
 15741           DFHEIV1,
 15742           ACTIVITY-TRAILERS,
 15743           DFHEIV11,
 15744           AT-CONTROL-PRIMARY,
 15745           DFHEIV99,
 15746           DFHEIV99
 15747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15748
 15749
 15750     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15751        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15752*06088           GO TO 6199-EXIT.
 15753           GO TO 6176-APPROVAL-NOTE.
 15754
 15755
 15756* EXEC CICS GETMAIN
 15757*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15758*         LENGTH    (200)
 15759*         INITIMG   (GETMAIN-SPACE)
 15760*     END-EXEC.
 15761     MOVE 200
 15762       TO DFHEIV11
 15763*    MOVE ',"IL                  $   #00014731' TO DFHEIV0
 15764     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15765     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15766     MOVE X'2020233030303134373331' TO DFHEIV0(25:11)
 15767     CALL 'kxdfhei1' USING DFHEIV0,
 15768           DFHEIV20,
 15769           DFHEIV11,
 15770           GETMAIN-SPACE
 15771     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15772         DFHEIV20
 15773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15774
 15775
 15776     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15777
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 301
* EL156.cbl
 15778     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15779     MOVE 'AT'                   TO AT-RECORD-ID.
 15780     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15781     MOVE '6'                    TO AT-TRAILER-TYPE.
 15782     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15783                                    AT-GEN-INFO-LAST-MAINT-DT
 15784     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15785                                    AT-GEN-INFO-LAST-UPDATED-BY
 15786     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15787
 15788     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15789     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15790     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15791
 15792     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15793
 15794 6175-WRITE.
 15795
 15796
 15797* EXEC CICS HANDLE CONDITION
 15798*        DUPREC    (6190-DUPREC)
 15799*    END-EXEC.
 15800*    MOVE '"$%                   ! 4 #00014757' TO DFHEIV0
 15801     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15803     MOVE X'3420233030303134373537' TO DFHEIV0(25:11)
 15804     CALL 'kxdfhei1' USING DFHEIV0
 15805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15806
 15807
 15808
 15809* EXEC CICS WRITE
 15810*         DATASET     ('ELTRLR')
 15811*         FROM        (ACTIVITY-TRAILERS)
 15812*         RIDFLD      (AT-CONTROL-PRIMARY)
 15813*     END-EXEC.
 15814     MOVE LENGTH OF
 15815      ACTIVITY-TRAILERS
 15816       TO DFHEIV11
 15817     MOVE 'ELTRLR' TO DFHEIV1
 15818*    MOVE '&$ L                  ''   #00014761' TO DFHEIV0
 15819     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15820     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15821     MOVE X'2020233030303134373631' TO DFHEIV0(25:11)
 15822     CALL 'kxdfhei1' USING DFHEIV0,
 15823           DFHEIV1,
 15824           ACTIVITY-TRAILERS,
 15825           DFHEIV11,
 15826           AT-CONTROL-PRIMARY,
 15827           DFHEIV99,
 15828           DFHEIV99
 15829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15830
 15831
 15832 6176-APPROVAL-NOTE.
 15833
 15834     IF NOT APPROVAL-NEEDED
 15835         GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 302
* EL156.cbl
 15836
 15837
 15838* EXEC CICS GETMAIN
 15839*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15840*        LENGTH    (200)
 15841*        INITIMG   (GETMAIN-SPACE)
 15842*    END-EXEC.
 15843     MOVE 200
 15844       TO DFHEIV11
 15845*    MOVE ',"IL                  $   #00014772' TO DFHEIV0
 15846     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15847     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15848     MOVE X'2020233030303134373732' TO DFHEIV0(25:11)
 15849     CALL 'kxdfhei1' USING DFHEIV0,
 15850           DFHEIV20,
 15851           DFHEIV11,
 15852           GETMAIN-SPACE
 15853     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15854         DFHEIV20
 15855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15856
 15857
 15858     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15859
 15860     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15861     MOVE 'AT'               TO AT-RECORD-ID
 15862     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15863     MOVE '6'                TO AT-TRAILER-TYPE
 15864     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15865                                AT-GEN-INFO-LAST-MAINT-DT
 15866     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15867                                AT-GEN-INFO-LAST-UPDATED-BY
 15868     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15869
 15870     IF PI-REAUDIT-NEEDED = 'Y'
 15871         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15872     ELSE
 15873         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15874     END-IF
 15875     IF PI-APPROVAL-3550-NEEDED = 'Y'
 15876         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 15877     END-IF
 15878     MOVE SPACES             TO AT-INFO-LINE-2
 15879
 15880     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15881 6177-WRITE.
 15882
 15883
 15884* EXEC CICS HANDLE CONDITION
 15885*        DUPREC    (6185-DUPREC)
 15886*    END-EXEC.
 15887*    MOVE '"$%                   ! 5 #00014803' TO DFHEIV0
 15888     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15889     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15890     MOVE X'3520233030303134383033' TO DFHEIV0(25:11)
 15891     CALL 'kxdfhei1' USING DFHEIV0
 15892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15893
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 303
* EL156.cbl
 15894
 15895
 15896* EXEC CICS WRITE
 15897*         DATASET     ('ELTRLR')
 15898*         FROM        (ACTIVITY-TRAILERS)
 15899*         RIDFLD      (AT-CONTROL-PRIMARY)
 15900*     END-EXEC.
 15901     MOVE LENGTH OF
 15902      ACTIVITY-TRAILERS
 15903       TO DFHEIV11
 15904     MOVE 'ELTRLR' TO DFHEIV1
 15905*    MOVE '&$ L                  ''   #00014807' TO DFHEIV0
 15906     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15907     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15908     MOVE X'2020233030303134383037' TO DFHEIV0(25:11)
 15909     CALL 'kxdfhei1' USING DFHEIV0,
 15910           DFHEIV1,
 15911           ACTIVITY-TRAILERS,
 15912           DFHEIV11,
 15913           AT-CONTROL-PRIMARY,
 15914           DFHEIV99,
 15915           DFHEIV99
 15916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15917
 15918
 15919
 15920     GO TO 6199-EXIT.
 15921
 15922 6180-DUPREC.
 15923
 15924     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15925     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15926     GO TO 6170-WRITE.
 15927
 15928 6185-DUPREC.
 15929     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15930     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15931     GO TO 6177-WRITE.
 15932
 15933 6190-DUPREC.
 15934     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15935     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15936     GO TO 6175-WRITE.
 15937
 15938 6199-EXIT.
 15939      EXIT.
 15940
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 304
* EL156.cbl
 15942 6200-UPDATE-CLAIM-MSTR.
 15943     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15944     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15945     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15946     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15947
 15948     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 15949
 15950     MOVE ZEROS                  TO W-INTEREST.
 15951
 15952     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 15953        IF (PI-OFFLINE = 'Y') OR
 15954           (PI-PMTTYPE = '7')
 15955           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 15956                                 THRU 9870-EXIT
 15957        END-IF
 15958     END-IF
 15959     IF NOT ERROR-ON-OUTPUT
 15960        CONTINUE
 15961     ELSE
 15962
 15963* EXEC CICS REWRITE
 15964*          DATASET('ELMSTR')
 15965*          FROM(CLAIM-MASTER)
 15966*       END-EXEC
 15967     MOVE LENGTH OF
 15968      CLAIM-MASTER
 15969       TO DFHEIV11
 15970     MOVE 'ELMSTR' TO DFHEIV1
 15971*    MOVE '&& L                  %   #00014856' TO DFHEIV0
 15972     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15973     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15974     MOVE X'2020233030303134383536' TO DFHEIV0(25:11)
 15975     CALL 'kxdfhei1' USING DFHEIV0,
 15976           DFHEIV1,
 15977           CLAIM-MASTER,
 15978           DFHEIV11,
 15979           DFHEIV99
 15980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15981
 15982        MOVE -1                  TO ENTPFBL
 15983        MOVE AL-UANON            TO ENTPFBA
 15984        MOVE MAP-NAMEB           TO MAP-NAME
 15985        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15986        GO TO 8200-SEND-DATAONLY
 15987     END-IF
 15988
 15989     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 15990
 15991     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 15992
 15993     IF PI-AIG-SPECIAL-BENEFIT
 15994         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 15995
 15996     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 15997
 15998     IF PI-SPECIAL-BEN-SW = 'Y'
 15999         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 305
* EL156.cbl
 16000         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16001
 16002     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16003         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16004     ELSE
 16005         IF PI-PMTTYPE NOT = '4'
 16006            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16007
 16008     IF PI-PMTTYPE = '5' OR '6'
 16009        GO TO  6250-SET-MAINT.
 16010
 16011     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16012                                         CL-LAG-REPORT-CODE.
 16013
 16014     IF CL-ACTIVITY-CODE = 09
 16015         GO TO 6200-CONT-UPDATE.
 16016
 16017     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16018         IF CL-ACTIVITY-CODE = 11
 16019             GO TO 6200-CONT-UPDATE.
 16020
 16021     IF WS-ACT-REC-FOUND-SW = 'N'
 16022         GO TO 6200-CONT-UPDATE.
 16023
 16024     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16025         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16026         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16027         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16028
 16029     IF WS-UPDATE-SW = 'Y'
 16030         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16031                                         CL-NEXT-FOLLOWUP-DT.
 16032
 16033 6200-CONT-UPDATE.
 16034
 16035     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16036       IF CLAIM-IS-CLOSED
 16037         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16038           IF WS-OPEN-CLOSE-SW = '2'
 16039             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16040                                        CL-LAST-CLOSE-DT.
 16041
 16042     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16043        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16044        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16045
 16046     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16047        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16048        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16049        MOVE 'C'                 TO CL-CLAIM-STATUS
 16050        IF PI-PMTTYPE = '2'
 16051           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16052                  OR 'F')
 16053           CONTINUE
 16054        ELSE
 16055           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16056        END-IF
 16057     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 306
* EL156.cbl
 16058        IF PI-PMTTYPE = '2' OR '3'
 16059           IF PI-PMTTYPE = '2' AND
 16060              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16061                 OR 'F')
 16062              CONTINUE
 16063           ELSE
 16064              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16065           END-IF
 16066        END-IF
 16067     END-IF
 16068
 16069     IF PI-PMTTYPE = '4'
 16070        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16071
 16072     IF PI-COMPANY-ID = 'CVL'
 16073         IF PI-LOAN-UPDATE-SW = 'Y'
 16074             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16075             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16076             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16077             MOVE CL-CERT-STATE      TO  CERT-STATE
 16078             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16079             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16080             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16081             MOVE 'CERT'             TO  FILE-SWITCH
 16082             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16083             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16084             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16085
 16086     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16087        GO TO 6220-USE-COMPUTED.
 16088
 16089     IF (PI-PMTTYPE = '4')  AND
 16090        (PI-EPYAMT < ZEROS)
 16091          COMPUTE CL-NO-OF-DAYS-PAID =
 16092                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16093          IF CL-NO-OF-DAYS-PAID < +0
 16094              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16095          ELSE
 16096              NEXT SENTENCE
 16097     ELSE
 16098          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16099
 16100     IF PI-PROCESSOR-ID = 'FIX '
 16101        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16102           NEXT SENTENCE
 16103        ELSE
 16104           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16105     ELSE
 16106        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16107
 16108     IF PI-PMTTYPE = '4'
 16109        GO TO 6250-SET-MAINT.
 16110
 16111     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16112
 16113     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16114     MOVE '4'                    TO DC-OPTION-CODE.
 16115     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 307
* EL156.cbl
 16116     IF DATE-CONVERSION-ERROR
 16117        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16118     ELSE
 16119        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16120           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16121           IF PI-AIG-SPECIAL-BENEFIT
 16122               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16123           ELSE
 16124               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16125
 16126     GO TO 6250-SET-MAINT.
 16127
 16128 6220-USE-COMPUTED.
 16129
 16130     IF (PI-PMTTYPE = '4')  AND
 16131        (PI-CPYAMT < ZEROS)
 16132          COMPUTE CL-NO-OF-DAYS-PAID =
 16133                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16134          IF CL-NO-OF-DAYS-PAID < +0
 16135              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16136          ELSE
 16137              NEXT SENTENCE
 16138     ELSE
 16139          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16140
 16141     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16142
 16143     IF PI-PMTTYPE = '4'
 16144        GO TO 6250-SET-MAINT.
 16145
 16146     IF PI-AIG-SPECIAL-BENEFIT
 16147         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16148     ELSE
 16149         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16150
 16151     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16152
 16153     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16154        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16155
 16156 6250-SET-MAINT.
 16157     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16158
 16159     IF PI-PROCESSOR-ID = 'FIX '
 16160        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16161           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16162        ELSE
 16163           NEXT SENTENCE
 16164     ELSE
 16165        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16166
 16167     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16168     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16169     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16170
 16171 6299-EXIT.
 16172      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 308
* EL156.cbl
 16174 6300-UPDATE-CERT.
 16175
 16176*  ADD CERTNOTE FOR SC NP+6
 16177     IF PI-COMPANY-ID = 'CID' AND
 16178       (PI-PMTTYPE = '2' OR '3') AND
 16179        CL-CERT-STATE = 'SC'  AND
 16180        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16181           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16182     END-IF.
 16183
 16184     IF PI-COMPANY-ID = 'AHL' AND
 16185       (PI-PMTTYPE = '2' OR '3') AND
 16186        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16187           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16188           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16189     END-IF.
 16190
 16191     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16192     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16193     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16194     MOVE CL-CERT-STATE    TO CERT-STATE.
 16195     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16196     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16197     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16198     MOVE 'CERT'           TO FILE-SWITCH.
 16199
 16200     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16201
 16202     IF CERT-NOTE-ADDED
 16203        IF CM-NOTE-SW = ' '
 16204           MOVE '4'             TO CM-NOTE-SW
 16205        ELSE
 16206           IF CM-NOTE-SW = '1'
 16207               MOVE '5'           TO CM-NOTE-SW
 16208           ELSE
 16209              IF CM-NOTE-SW = '2'
 16210                 MOVE '6'         TO CM-NOTE-SW
 16211              ELSE
 16212                 IF CM-NOTE-SW = '3'
 16213                    MOVE '7'      TO CM-NOTE-SW
 16214                 END-IF
 16215              END-IF
 16216           END-IF
 16217        END-IF
 16218     END-IF.
 16219
 16220     IF PI-COMPANY-ID = 'CVL'
 16221         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16222         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16223
 16224     IF PI-PMTTYPE NOT = '4'
 16225        GO TO 6340-UPDATE-CERT.
 16226
 16227     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16228        IF PI-PFKEY-USED = DFHPF5
 16229           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16230        ELSE
 16231           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 309
* EL156.cbl
 16232
 16233*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16234*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16235*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16236*               PI-LF-COVERAGE-TYPE = 'P'
 16237*                GO TO 6350-REWRITE-CERT.
 16238
 16239     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16240       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16241          PI-LF-COVERAGE-TYPE = 'P'
 16242           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16243                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16244                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16245                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16246                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16247                GO TO 6350-REWRITE-CERT
 16248            ELSE
 16249                GO TO 6350-REWRITE-CERT.
 16250
 16251     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16252         GO TO 6350-REWRITE-CERT.
 16253
 16254     IF NOT CM-AH-LUMP-SUM-DISAB
 16255        GO TO 6380-UNLOCK-CERT.
 16256
 16257     IF PI-PFKEY-USED = DFHPF5
 16258        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16259                                    CM-AH-ITD-AH-PMT
 16260        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16261        GO TO 6350-REWRITE-CERT
 16262     ELSE
 16263        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16264                                    CM-AH-ITD-AH-PMT
 16265        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16266        GO TO 6350-REWRITE-CERT.
 16267
 16268 6340-UPDATE-CERT.
 16269
 16270     IF CL-CLAIM-TYPE = 'L'
 16271         IF PI-PFKEY-USED = DFHPF5
 16272             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16273         ELSE
 16274             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16275
 16276     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16277         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16278             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16279                PI-LF-COVERAGE-TYPE = 'P'
 16280                 GO TO 6350-REWRITE-CERT.
 16281
 16282     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16283       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16284          PI-LF-COVERAGE-TYPE = 'P'
 16285           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16286                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16287                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16288                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16289                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 310
* EL156.cbl
 16290                GO TO 6350-REWRITE-CERT.
 16291
 16292     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16293         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16294            PI-LF-COVERAGE-TYPE NOT = 'P'
 16295             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16296             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16297             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16298             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16299             GO TO 6350-REWRITE-CERT.
 16300
 16301     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 16302         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16303         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16304         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16305         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16306         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16307         IF PI-PFKEY-USED = DFHPF5
 16308             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16309                                        CM-AH-ITD-AH-PMT
 16310             GO TO 6350-REWRITE-CERT
 16311         ELSE
 16312             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16313                                        CM-AH-ITD-AH-PMT
 16314             GO TO 6350-REWRITE-CERT.
 16315
 16316 6350-REWRITE-CERT.
 16317
 16318
 16319* EXEC CICS REWRITE
 16320*         DATASET  ('ELCERT')
 16321*         FROM(CERTIFICATE-MASTER)
 16322*     END-EXEC.
 16323     MOVE LENGTH OF
 16324      CERTIFICATE-MASTER
 16325       TO DFHEIV11
 16326     MOVE 'ELCERT' TO DFHEIV1
 16327*    MOVE '&& L                  %   #00015197' TO DFHEIV0
 16328     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16329     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16330     MOVE X'2020233030303135313937' TO DFHEIV0(25:11)
 16331     CALL 'kxdfhei1' USING DFHEIV0,
 16332           DFHEIV1,
 16333           CERTIFICATE-MASTER,
 16334           DFHEIV11,
 16335           DFHEIV99
 16336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16337
 16338
 16339     GO TO 6399-EXIT.
 16340
 16341 6380-UNLOCK-CERT.
 16342
 16343* EXEC CICS UNLOCK
 16344*         DATASET  ('ELCERT')
 16345*     END-EXEC.
 16346     MOVE 'ELCERT' TO DFHEIV1
 16347*    MOVE '&*                    #   #00015205' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 311
* EL156.cbl
 16348     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16349     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16350     MOVE X'2020233030303135323035' TO DFHEIV0(25:11)
 16351     CALL 'kxdfhei1' USING DFHEIV0,
 16352           DFHEIV1,
 16353           DFHEIV99
 16354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16355
 16356
 16357 6399-EXIT.
 16358      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 312
* EL156.cbl
 16360 6400-UPDATE-ZERO-TRAILER.
 16361     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16362     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16363
 16364     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16365
 16366     IF PI-EPYAMT NOT = ZEROS
 16367         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16368     ELSE
 16369         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16370
 16371     IF PI-ERESV NOT = ZEROS
 16372        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16373
 16374     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16375        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16376
 16377     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16378        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16379     ELSE
 16380        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16381
 16382     IF PI-PMTTYPE = '5'
 16383        IF PI-EPYAMT = ZEROS
 16384           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16385        ELSE
 16386           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16387
 16388     IF PI-PMTTYPE = '6'
 16389        IF PI-EPYAMT = ZEROS
 16390           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16391        ELSE
 16392           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16393
 16394 6420-CHECK-OPEN-CLOSE.
 16395     IF PI-PMTTYPE = '5' OR '6'
 16396        GO TO 6450-REWRITE.
 16397
 16398     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16399         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16400             IF CLAIM-IS-CLOSED
 16401                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16402                 MOVE 1          TO  SUB-1
 16403                 GO TO 6440-AIG-LOOP.
 16404
 16405     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16406        GO TO 6450-REWRITE.
 16407
 16408     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16409        GO TO 6450-REWRITE.
 16410
 16411     MOVE 1                      TO SUB-1.
 16412
 16413 6430-LOOP.
 16414     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16415        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16416        IF PI-PMTTYPE = '1' OR '4'
 16417           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 313
* EL156.cbl
 16418           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16419           GO TO 6450-REWRITE
 16420        ELSE
 16421           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16422           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16423           GO TO 6450-REWRITE.
 16424
 16425     IF SUB-1 = 6
 16426      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16427      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16428      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16429      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16430      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16431      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16432      GO TO 6430-LOOP.
 16433
 16434     ADD 1                       TO SUB-1.
 16435     GO TO 6430-LOOP.
 16436
 16437
 16438 6440-AIG-LOOP.
 16439
 16440     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16441       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16442       IF WS-OPEN-CLOSE-SW = '1'
 16443         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16444         IF PI-PMTTYPE = '2'
 16445           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16446           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16447         ELSE
 16448           IF PI-PMTTYPE = '3'
 16449             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16450             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16451           ELSE
 16452             IF PI-PMTTYPE = '4'
 16453               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16454               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16455             ELSE
 16456               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16457               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16458       ELSE
 16459         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16460         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16461         GO TO 6450-REWRITE.
 16462
 16463     IF SUB-1 = 6
 16464      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16465      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16466      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16467      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16468      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16469      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16470      GO TO 6440-AIG-LOOP.
 16471
 16472     ADD 1                       TO SUB-1.
 16473     GO TO 6440-AIG-LOOP.
 16474
 16475 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 314
* EL156.cbl
 16476     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16477     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16478     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16479
 16480     IF PI-COMPANY-ID = 'DMD'
 16481         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16482         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16483         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16484         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16485         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16486
 16487
 16488* EXEC CICS REWRITE
 16489*         DATASET  ('ELTRLR')
 16490*         FROM     (ACTIVITY-TRAILERS)
 16491*     END-EXEC.
 16492     MOVE LENGTH OF
 16493      ACTIVITY-TRAILERS
 16494       TO DFHEIV11
 16495     MOVE 'ELTRLR' TO DFHEIV1
 16496*    MOVE '&& L                  %   #00015339' TO DFHEIV0
 16497     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16498     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16499     MOVE X'2020233030303135333339' TO DFHEIV0(25:11)
 16500     CALL 'kxdfhei1' USING DFHEIV0,
 16501           DFHEIV1,
 16502           ACTIVITY-TRAILERS,
 16503           DFHEIV11,
 16504           DFHEIV99
 16505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16506
 16507
 16508 6499-EXIT.
 16509      EXIT.
 16510
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 315
* EL156.cbl
 16512 6500-READ-DLO035.
 16513     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16514     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16515     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16516     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16517
 16518
 16519* EXEC CICS LINK
 16520*        PROGRAM    ('DLO035')
 16521*        COMMAREA   (DLO035-KEY)
 16522*        LENGTH     (DL35-LENGTH)
 16523*    END-EXEC.
 16524     MOVE 'DLO035' TO DFHEIV1
 16525*    MOVE '."C                   (   #00015354' TO DFHEIV0
 16526     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16527     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16528     MOVE X'2020233030303135333534' TO DFHEIV0(25:11)
 16529     CALL 'kxdfhei1' USING DFHEIV0,
 16530           DFHEIV1,
 16531           DLO035-KEY,
 16532           DL35-LENGTH,
 16533           DFHEIV99,
 16534           DFHEIV99,
 16535           DFHEIV99,
 16536           DFHEIV99
 16537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16538
 16539
 16540     IF DL35-RETURN-CODE = 'OK'
 16541         GO TO 6500-EXIT.
 16542
 16543     IF DL35-RETURN-CODE = '01'
 16544         MOVE ER-7830            TO EMI-ERROR
 16545         GO TO 6500-BAD-EXIT.
 16546
 16547     IF DL35-RETURN-CODE = '02'
 16548         MOVE ER-7831            TO EMI-ERROR
 16549         GO TO 6500-BAD-EXIT.
 16550
 16551     IF DL35-RETURN-CODE = '03'
 16552         MOVE ER-7832            TO EMI-ERROR
 16553         GO TO 6500-BAD-EXIT.
 16554
 16555     IF DL35-RETURN-CODE = '04'
 16556         MOVE ER-7833            TO EMI-ERROR
 16557         GO TO 6500-BAD-EXIT.
 16558
 16559     IF DL35-RETURN-CODE = '05'
 16560         MOVE ER-7834            TO EMI-ERROR
 16561         GO TO 6500-BAD-EXIT.
 16562
 16563     IF DL35-RETURN-CODE = '06'
 16564         MOVE ER-7835            TO EMI-ERROR
 16565         GO TO 6500-BAD-EXIT.
 16566
 16567     IF DL35-RETURN-CODE = '07'
 16568         MOVE ER-7836            TO EMI-ERROR
 16569         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 316
* EL156.cbl
 16570
 16571     IF DL35-RETURN-CODE = 'E1'
 16572         MOVE ER-7837            TO EMI-ERROR
 16573         GO TO 6500-BAD-EXIT.
 16574
 16575     IF DL35-RETURN-CODE NOT = 'OK'
 16576         MOVE ER-7838            TO EMI-ERROR
 16577         GO TO 6500-BAD-EXIT.
 16578
 16579 6500-EXIT.
 16580      EXIT.
 16581
 16582 6500-BAD-EXIT.
 16583
 16584* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16585*    MOVE '6"R                   !   #00015403' TO DFHEIV0
 16586     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16587     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16588     MOVE X'2020233030303135343033' TO DFHEIV0(25:11)
 16589     CALL 'kxdfhei1' USING DFHEIV0
 16590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16591
 16592     MOVE -1                 TO PMTTYPEL.
 16593     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16594     GO TO 8200-SEND-DATAONLY.
 16595
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 317
* EL156.cbl
 16597 6600-UPDATE-DLO035.
 16598     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16599     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16600     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16601     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16602
 16603
 16604* EXEC CICS LINK
 16605*        PROGRAM    ('DLO035')
 16606*        COMMAREA   (DLO035-KEY)
 16607*        LENGTH     (DL35-LENGTH)
 16608*    END-EXEC.
 16609     MOVE 'DLO035' TO DFHEIV1
 16610*    MOVE '."C                   (   #00015415' TO DFHEIV0
 16611     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16612     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16613     MOVE X'2020233030303135343135' TO DFHEIV0(25:11)
 16614     CALL 'kxdfhei1' USING DFHEIV0,
 16615           DFHEIV1,
 16616           DLO035-KEY,
 16617           DL35-LENGTH,
 16618           DFHEIV99,
 16619           DFHEIV99,
 16620           DFHEIV99,
 16621           DFHEIV99
 16622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16623
 16624
 16625     IF DL35-RETURN-CODE = 'OK'
 16626         GO TO 6600-EXIT.
 16627
 16628     IF DL35-RETURN-CODE = '01'
 16629         MOVE ER-7830            TO EMI-ERROR
 16630         GO TO 6500-BAD-EXIT.
 16631
 16632     IF DL35-RETURN-CODE = '02'
 16633         MOVE ER-7831            TO EMI-ERROR
 16634         GO TO 6500-BAD-EXIT.
 16635
 16636     IF DL35-RETURN-CODE = '03'
 16637         MOVE ER-7832            TO EMI-ERROR
 16638         GO TO 6500-BAD-EXIT.
 16639
 16640     IF DL35-RETURN-CODE = '04'
 16641         MOVE ER-7833            TO EMI-ERROR
 16642         GO TO 6500-BAD-EXIT.
 16643
 16644     IF DL35-RETURN-CODE = '05'
 16645         MOVE ER-7834            TO EMI-ERROR
 16646         GO TO 6500-BAD-EXIT.
 16647
 16648     IF DL35-RETURN-CODE = '06'
 16649         MOVE ER-7835            TO EMI-ERROR
 16650         GO TO 6500-BAD-EXIT.
 16651
 16652     IF DL35-RETURN-CODE = '07'
 16653         MOVE ER-7836            TO EMI-ERROR
 16654         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 318
* EL156.cbl
 16655
 16656     IF DL35-RETURN-CODE = 'E1'
 16657         MOVE ER-7837            TO EMI-ERROR
 16658         GO TO 6500-BAD-EXIT.
 16659
 16660     IF DL35-RETURN-CODE NOT = 'OK'
 16661         MOVE ER-7838            TO EMI-ERROR
 16662         GO TO 6500-BAD-EXIT.
 16663
 16664 6600-EXIT.
 16665      EXIT.
 16666
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 319
* EL156.cbl
 16668 6700-UPDATE-ACTQ.
 16669***************************************************************
 16670*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16671*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16672*    ONE ALREADY THERE.                                       *
 16673***************************************************************
 16674
 16675
 16676* EXEC CICS HANDLE CONDITION
 16677*         NOTFND(6720-BUILD-NEW-RECORD)
 16678*     END-EXEC.
 16679*    MOVE '"$I                   ! 6 #00015471' TO DFHEIV0
 16680     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16682     MOVE X'3620233030303135343731' TO DFHEIV0(25:11)
 16683     CALL 'kxdfhei1' USING DFHEIV0
 16684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16685
 16686
 16687
 16688* EXEC CICS READ
 16689*         DATASET('ELACTQ')
 16690*         RIDFLD (ELMSTR-KEY)
 16691*         SET    (ADDRESS OF ACTIVITY-QUE)
 16692*         UPDATE
 16693*     END-EXEC.
 16694     MOVE 'ELACTQ' TO DFHEIV1
 16695*    MOVE '&"S        EU         (   #00015475' TO DFHEIV0
 16696     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16697     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16698     MOVE X'2020233030303135343735' TO DFHEIV0(25:11)
 16699     CALL 'kxdfhei1' USING DFHEIV0,
 16700           DFHEIV1,
 16701           DFHEIV20,
 16702           DFHEIV99,
 16703           ELMSTR-KEY,
 16704           DFHEIV99,
 16705           DFHEIV99,
 16706           DFHEIV99
 16707     SET ADDRESS OF ACTIVITY-QUE TO
 16708         DFHEIV20
 16709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16710
 16711
 16712     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16713
 16714     IF PI-AIG-SPECIAL-BENEFIT AND
 16715        PI-CASH = 'Y'
 16716         ADD 2                   TO AQ-PAYMENT-COUNTER
 16717     ELSE
 16718         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16719
 16720     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16721         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16722
 16723     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16724
 16725     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 320
* EL156.cbl
 16726         IF WS-PMT-APPROVAL-SW = 'A'
 16727             NEXT SENTENCE
 16728         ELSE
 16729            IF PI-AIG-SPECIAL-BENEFIT AND
 16730               PI-CASH = 'Y'
 16731                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16732                                     WS-PMT-UNAPPROVED-CNT
 16733            ELSE
 16734                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16735                                     WS-PMT-UNAPPROVED-CNT
 16736     ELSE
 16737         IF PI-PMT-APPR-SW = 'Y'
 16738            IF PI-AIG-SPECIAL-BENEFIT AND
 16739               PI-CASH = 'Y'
 16740                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16741                                     WS-PMT-UNAPPROVED-CNT
 16742            ELSE
 16743                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16744                                     WS-PMT-UNAPPROVED-CNT.
 16745
 16746     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16747         MOVE ER-3536 TO EMI-ERROR
 16748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16749
 16750     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16751
 16752
 16753* EXEC CICS REWRITE
 16754*         DATASET('ELACTQ')
 16755*         FROM   (ACTIVITY-QUE)
 16756*     END-EXEC.
 16757     MOVE LENGTH OF
 16758      ACTIVITY-QUE
 16759       TO DFHEIV11
 16760     MOVE 'ELACTQ' TO DFHEIV1
 16761*    MOVE '&& L                  %   #00015522' TO DFHEIV0
 16762     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16763     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16764     MOVE X'2020233030303135353232' TO DFHEIV0(25:11)
 16765     CALL 'kxdfhei1' USING DFHEIV0,
 16766           DFHEIV1,
 16767           ACTIVITY-QUE,
 16768           DFHEIV11,
 16769           DFHEIV99
 16770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16771
 16772
 16773     GO TO 6799-EXIT.
 16774
 16775 6720-BUILD-NEW-RECORD.
 16776
 16777* EXEC CICS GETMAIN
 16778*         SET    (ADDRESS OF ACTIVITY-QUE)
 16779*         LENGTH (60)
 16780*         INITIMG(GETMAIN-SPACE)
 16781*     END-EXEC.
 16782     MOVE 60
 16783       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 321
* EL156.cbl
 16784*    MOVE ',"IL                  $   #00015530' TO DFHEIV0
 16785     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16786     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16787     MOVE X'2020233030303135353330' TO DFHEIV0(25:11)
 16788     CALL 'kxdfhei1' USING DFHEIV0,
 16789           DFHEIV20,
 16790           DFHEIV11,
 16791           GETMAIN-SPACE
 16792     SET ADDRESS OF ACTIVITY-QUE TO
 16793         DFHEIV20
 16794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16795
 16796
 16797     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16798
 16799     IF PI-AIG-SPECIAL-BENEFIT AND
 16800        PI-CASH = 'Y'
 16801         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16802     ELSE
 16803         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16804
 16805     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16806     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16807     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16808     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16809                                    AQ-FOLLOWUP-DATE.
 16810     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16811     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16812
 16813     IF PI-PMT-GRADUATED
 16814         IF WS-PMT-APPROVAL-SW = 'A'
 16815             NEXT SENTENCE
 16816         ELSE
 16817            IF PI-AIG-SPECIAL-BENEFIT AND
 16818               PI-CASH = 'Y'
 16819                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16820            ELSE
 16821                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16822     ELSE
 16823         IF PI-PMT-APPR-SW = 'Y'
 16824            IF PI-AIG-SPECIAL-BENEFIT AND
 16825               PI-CASH = 'Y'
 16826                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16827            ELSE
 16828                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16829
 16830     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16831         MOVE ER-3536 TO EMI-ERROR
 16832         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16833
 16834
 16835* EXEC CICS WRITE
 16836*         DATASET('ELACTQ')
 16837*         RIDFLD (ELMSTR-KEY)
 16838*         FROM   (ACTIVITY-QUE)
 16839*     END-EXEC.
 16840     MOVE LENGTH OF
 16841      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 322
* EL156.cbl
 16842       TO DFHEIV11
 16843     MOVE 'ELACTQ' TO DFHEIV1
 16844*    MOVE '&$ L                  ''   #00015573' TO DFHEIV0
 16845     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16846     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16847     MOVE X'2020233030303135353733' TO DFHEIV0(25:11)
 16848     CALL 'kxdfhei1' USING DFHEIV0,
 16849           DFHEIV1,
 16850           ACTIVITY-QUE,
 16851           DFHEIV11,
 16852           ELMSTR-KEY,
 16853           DFHEIV99,
 16854           DFHEIV99
 16855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16856
 16857
 16858 6799-EXIT.
 16859      EXIT.
 16860
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 323
* EL156.cbl
 16862 6800-BUILD-FORM-TRAILER.
 16863
 16864
 16865* EXEC CICS GETMAIN
 16866*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16867*         LENGTH   (200)
 16868*         INITIMG  (GETMAIN-SPACE)
 16869*    END-EXEC.
 16870     MOVE 200
 16871       TO DFHEIV11
 16872*    MOVE ',"IL                  $   #00015585' TO DFHEIV0
 16873     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16874     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16875     MOVE X'2020233030303135353835' TO DFHEIV0(25:11)
 16876     CALL 'kxdfhei1' USING DFHEIV0,
 16877           DFHEIV20,
 16878           DFHEIV11,
 16879           GETMAIN-SPACE
 16880     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16881         DFHEIV20
 16882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16883
 16884
 16885     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 16886
 16887     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 16888     MOVE 'AT'                   TO AT-RECORD-ID.
 16889     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16890
 16891     MOVE 'A'                    TO AT-TRAILER-TYPE.
 16892     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16893                                    AT-FORM-LAST-MAINT-DT
 16894                                    AT-FORM-SEND-ON-DT.
 16895     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16896                                    AT-FORM-LAST-UPDATED-BY.
 16897     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16898     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 16899     MOVE '6'                    TO DC-OPTION-CODE.
 16900     MOVE +29                    TO DC-ELAPSED-DAYS.
 16901     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16902     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16903     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 16904
 16905     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16906         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 16907
 16908     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 16909                                    AT-FORM-RE-SEND-DT
 16910                                    AT-EMP-FORM-ANSWERED-DT
 16911                                    AT-PHY-FORM-ANSWERED-DT
 16912                                    AT-EMP-FORM-SEND-ON-DT
 16913                                    AT-PHY-FORM-SEND-ON-DT
 16914                                    AT-FORM-PRINTED-DT
 16915                                    AT-FORM-REPRINT-DT.
 16916     MOVE '2'                    TO AT-FORM-TYPE.
 16917
 16918     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 16919     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 324
* EL156.cbl
 16920
 16921     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16922         NEXT SENTENCE
 16923     ELSE
 16924         IF CL-PROG-FORM-TYPE NOT = 'S'
 16925            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 16926
 16927
 16928* EXEC CICS WRITE
 16929*         DATASET  ('ELTRLR')
 16930*         FROM     (ACTIVITY-TRAILERS)
 16931*         RIDFLD   (AT-CONTROL-PRIMARY)
 16932*     END-EXEC.
 16933     MOVE LENGTH OF
 16934      ACTIVITY-TRAILERS
 16935       TO DFHEIV11
 16936     MOVE 'ELTRLR' TO DFHEIV1
 16937*    MOVE '&$ L                  ''   #00015633' TO DFHEIV0
 16938     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16940     MOVE X'2020233030303135363333' TO DFHEIV0(25:11)
 16941     CALL 'kxdfhei1' USING DFHEIV0,
 16942           DFHEIV1,
 16943           ACTIVITY-TRAILERS,
 16944           DFHEIV11,
 16945           AT-CONTROL-PRIMARY,
 16946           DFHEIV99,
 16947           DFHEIV99
 16948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16949
 16950
 16951 6899-EXIT.
 16952      EXIT.
 16953
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 325
* EL156.cbl
 16955 6900-BUILD-ARCHIVE-HEADER.
 16956
 16957     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16958     MOVE '1'                    TO CNTL-REC-TYPE.
 16959     MOVE +0                     TO CNTL-SEQ-NO.
 16960     MOVE SPACES                 TO CNTL-ACCESS.
 16961
 16962
 16963* EXEC CICS READ
 16964*         DATASET  ('ELCNTL')
 16965*         SET      (ADDRESS OF CONTROL-FILE)
 16966*         RIDFLD   (ELCNTL-KEY)
 16967*         UPDATE
 16968*    END-EXEC.
 16969     MOVE 'ELCNTL' TO DFHEIV1
 16970*    MOVE '&"S        EU         (   #00015650' TO DFHEIV0
 16971     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16972     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16973     MOVE X'2020233030303135363530' TO DFHEIV0(25:11)
 16974     CALL 'kxdfhei1' USING DFHEIV0,
 16975           DFHEIV1,
 16976           DFHEIV20,
 16977           DFHEIV99,
 16978           ELCNTL-KEY,
 16979           DFHEIV99,
 16980           DFHEIV99,
 16981           DFHEIV99
 16982     SET ADDRESS OF CONTROL-FILE TO
 16983         DFHEIV20
 16984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16985
 16986
 16987     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 16988     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 16989
 16990
 16991* EXEC CICS REWRITE
 16992*         FROM     (CONTROL-FILE)
 16993*         DATASET  ('ELCNTL')
 16994*    END-EXEC.
 16995     MOVE LENGTH OF
 16996      CONTROL-FILE
 16997       TO DFHEIV11
 16998     MOVE 'ELCNTL' TO DFHEIV1
 16999*    MOVE '&& L                  %   #00015660' TO DFHEIV0
 17000     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17001     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17002     MOVE X'2020233030303135363630' TO DFHEIV0(25:11)
 17003     CALL 'kxdfhei1' USING DFHEIV0,
 17004           DFHEIV1,
 17005           CONTROL-FILE,
 17006           DFHEIV11,
 17007           DFHEIV99
 17008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17009
 17010
 17011
 17012* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 326
* EL156.cbl
 17013*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17014*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17015*    END-EXEC.
 17016*    MOVE '"$$%                  ! 7 #00015665' TO DFHEIV0
 17017     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17019     MOVE X'3720233030303135363635' TO DFHEIV0(25:11)
 17020     CALL 'kxdfhei1' USING DFHEIV0
 17021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17022
 17023
 17024
 17025* EXEC CICS GETMAIN
 17026*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17027*         LENGTH  (ELARCH-LENGTH)
 17028*         INITIMG (GETMAIN-SPACE)
 17029*    END-EXEC.
 17030*    MOVE ',"IL                  $   #00015670' TO DFHEIV0
 17031     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17032     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17033     MOVE X'2020233030303135363730' TO DFHEIV0(25:11)
 17034     CALL 'kxdfhei1' USING DFHEIV0,
 17035           DFHEIV20,
 17036           ELARCH-LENGTH,
 17037           GETMAIN-SPACE
 17038     SET ADDRESS OF LETTER-ARCHIVE TO
 17039         DFHEIV20
 17040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17041
 17042
 17043     MOVE 'LA'                   TO LA-RECORD-ID.
 17044     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17045                                    LA-ARCHIVE-NO-A1.
 17046     MOVE '4'                    TO LA-RECORD-TYPE
 17047                                    LA-RECORD-TYPE-A1.
 17048     MOVE +0                     TO LA-LINE-SEQ-NO
 17049                                    LA-LINE-SEQ-NO-A1.
 17050     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17051                                    LA-COMPANY-CD-A1.
 17052     MOVE CL-CARRIER             TO LA4-CARRIER.
 17053     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17054     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17055     MOVE CL-CERT-STATE          TO LA4-STATE.
 17056     MOVE +0                     TO LA4-NO-OF-COPIES.
 17057     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17058     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17059     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17060                                    LA4-INITIAL-PRINT-DATE
 17061                                    LA4-RESEND-PRINT-DATE
 17062                                    LA4-FORM-REM-PRINT-DT.
 17063     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17064     MOVE '2'                    TO LA4-FORM-TYPE.
 17065
 17066
 17067* EXEC CICS WRITE
 17068*         DATASET  ('ELARCH')
 17069*         FROM     (LETTER-ARCHIVE)
 17070*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 327
* EL156.cbl
 17071*    END-EXEC.
 17072     MOVE LENGTH OF
 17073      LETTER-ARCHIVE
 17074       TO DFHEIV11
 17075     MOVE 'ELARCH' TO DFHEIV1
 17076*    MOVE '&$ L                  ''   #00015699' TO DFHEIV0
 17077     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17078     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17079     MOVE X'2020233030303135363939' TO DFHEIV0(25:11)
 17080     CALL 'kxdfhei1' USING DFHEIV0,
 17081           DFHEIV1,
 17082           LETTER-ARCHIVE,
 17083           DFHEIV11,
 17084           LA-CONTROL-PRIMARY,
 17085           DFHEIV99,
 17086           DFHEIV99
 17087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17088
 17089
 17090 6999-EXIT.
 17091      EXIT.
 17092
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 328
* EL156.cbl
 17094 7000-SHOW-CLAIM.
 17095     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17096     MOVE 'A'                    TO PI-PASS-SW.
 17097     MOVE LOW-VALUES             TO PI-CPYFROM
 17098                                    PI-MONTH-END-SAVE
 17099                                    PI-CPYTHRU.
 17100
 17101     MOVE ZEROS                  TO PI-FATAL-COUNT
 17102                                    PI-DAILY-RATE
 17103                                    PI-BEN-DAYS
 17104                                    PI-MANUAL-SW
 17105                                    PI-SAVE-CURSOR
 17106                                    PI-FORCE-COUNT
 17107                                    PI-HOLDTIL
 17108                                    PI-EPYFROM
 17109                                    PI-EPYTHRU
 17110                                    PI-EDAYS
 17111                                    PI-EPYAMT
 17112                                    PI-ERESV
 17113                                    PI-EEXPENS
 17114                                    PI-CDAYS
 17115                                    PI-CPYAMT
 17116                                    PI-CRESV
 17117                                    PI-CEXPENS
 17118                                    PI-INT-RATE
 17119                                    PI-AIGFROM.
 17120     MOVE ZEROS                  TO PI-PROOF-DATE.
 17121     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17122                                    PI-REM-BEN-AMT
 17123                                    PI-MO-BEN-AMT
 17124                                    pi-ah-term.
 17125
 17126     MOVE LOW-VALUES             TO EL156AI.
 17127     MOVE MAP-NAMEA              TO MAP-NAME.
 17128
 17129* EXEC CICS HANDLE CONDITION
 17130*        NOTFND   (7010-BUILD-MAP)
 17131*    END-EXEC.
 17132*    MOVE '"$I                   ! 8 #00015743' TO DFHEIV0
 17133     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17135     MOVE X'3820233030303135373433' TO DFHEIV0(25:11)
 17136     CALL 'kxdfhei1' USING DFHEIV0
 17137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17138
 17139
 17140     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17141     MOVE '2'                    TO CNTL-REC-TYPE.
 17142     MOVE +0                     TO CNTL-SEQ-NO.
 17143     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17144
 17145
 17146* EXEC CICS READ
 17147*         DATASET  ('ELCNTL')
 17148*         SET      (ADDRESS OF CONTROL-FILE)
 17149*         RIDFLD   (ELCNTL-KEY)
 17150*    END-EXEC.
 17151     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 329
* EL156.cbl
 17152*    MOVE '&"S        E          (   #00015752' TO DFHEIV0
 17153     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17154     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17155     MOVE X'2020233030303135373532' TO DFHEIV0(25:11)
 17156     CALL 'kxdfhei1' USING DFHEIV0,
 17157           DFHEIV1,
 17158           DFHEIV20,
 17159           DFHEIV99,
 17160           ELCNTL-KEY,
 17161           DFHEIV99,
 17162           DFHEIV99,
 17163           DFHEIV99
 17164     SET ADDRESS OF CONTROL-FILE TO
 17165         DFHEIV20
 17166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17167
 17168
 17169     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17170
 17171     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17172         MOVE AL-UANON      TO SURVYYNA
 17173     END-IF.
 17174
 17175
 17176     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17177     MOVE '1'                    TO CNTL-REC-TYPE.
 17178     MOVE SPACES                 TO CNTL-ACCESS.
 17179     MOVE +0                     TO CNTL-SEQ-NO.
 17180
 17181
 17182* EXEC CICS READ
 17183*         DATASET  ('ELCNTL')
 17184*         SET      (ADDRESS OF CONTROL-FILE)
 17185*         RIDFLD   (ELCNTL-KEY)
 17186*    END-EXEC.
 17187     MOVE 'ELCNTL' TO DFHEIV1
 17188*    MOVE '&"S        E          (   #00015770' TO DFHEIV0
 17189     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17191     MOVE X'2020233030303135373730' TO DFHEIV0(25:11)
 17192     CALL 'kxdfhei1' USING DFHEIV0,
 17193           DFHEIV1,
 17194           DFHEIV20,
 17195           DFHEIV99,
 17196           ELCNTL-KEY,
 17197           DFHEIV99,
 17198           DFHEIV99,
 17199           DFHEIV99
 17200     SET ADDRESS OF CONTROL-FILE TO
 17201         DFHEIV20
 17202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17203
 17204
 17205     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17206
 17207 7010-BUILD-MAP.
 17208
 17209
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 330
* EL156.cbl
 17210* EXEC CICS HANDLE CONDITION
 17211*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17212*    END-EXEC.
 17213*    MOVE '"$I                   ! 9 #00015780' TO DFHEIV0
 17214     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17216     MOVE X'3920233030303135373830' TO DFHEIV0(25:11)
 17217     CALL 'kxdfhei1' USING DFHEIV0
 17218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17219
 17220
 17221     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17222     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17223     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17224     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17225     MOVE 'MSTR'                 TO FILE-SWITCH.
 17226
 17227     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17228
 17229     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17230     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17231     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17232     MOVE CL-CCN                 TO PI-SV-CCN.
 17233
 17234     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17235     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17236     MOVE CL-CLAIM-NO            TO CLMNOO.
 17237     MOVE CL-CARRIER             TO CARRO.
 17238     MOVE CL-CERT-PRIME          TO CERTNOO.
 17239     MOVE CL-CERT-SFX            TO SUFXO.
 17240
 17241     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17242        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17243        CONTINUE
 17244     ELSE
 17245        MOVE AL-SADOF            TO ZINTHA
 17246                                    ZINTA
 17247                                    PINTHA
 17248                                    PINTA
 17249     END-IF
 17250     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17251     EVALUATE TRUE
 17252     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17253         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17254     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17255         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17256
 17257     WHEN CL-CLAIM-TYPE = 'I'
 17258         MOVE '  IU  '           TO CLMTYPO
 17259     WHEN CL-CLAIM-TYPE = 'G'
 17260         MOVE ' GAP  '           TO CLMTYPO
 17261
 17262     WHEN CL-CLAIM-TYPE = 'F'
 17263         MOVE ' FAM  '           TO CLMTYPO
 17264     END-EVALUATE.
 17265     IF CLAIM-IS-OPEN
 17266         MOVE ' OPEN'            TO CLMSTATO
 17267     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 331
* EL156.cbl
 17268         MOVE 'CLOSED'           TO CLMSTATO.
 17269
 17270     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17271
 17272     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17273         MOVE SPACES             TO  PCERTNOO
 17274                                     PSUFXO
 17275                                     PRIMHDGO
 17276                                     SEQUO
 17277         MOVE AL-SADOF           TO  PCERTNOA
 17278                                     PSUFXA
 17279                                     PRIMHDGA
 17280                                     SEQUA
 17281     ELSE
 17282         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17283         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17284         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17285         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17286         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17287         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17288         MOVE AL-SANON               TO  PCERTNOA
 17289                                         PSUFXA
 17290                                         PRIMHDGA
 17291         MOVE AL-SABON               TO  SEQUA.
 17292
 17293     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17294
 17295     IF CL-NO-OF-PMTS-MADE = 0 AND
 17296        CL-TOTAL-PAID-AMT = 0
 17297         NEXT SENTENCE
 17298     ELSE
 17299         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17300             IF NOT PI-USES-PAID-TO
 17301                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17302                 MOVE ' '                 TO DC-OPTION-CODE
 17303                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17304                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17305             ELSE
 17306                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17307                 MOVE '6'                 TO DC-OPTION-CODE
 17308                 MOVE +1                  TO DC-ELAPSED-DAYS
 17309                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17310                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17311                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17312
 17313     IF MAP-NAME = 'EL156A'
 17314        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17315           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17316             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17317           end-if
 17318        end-if
 17319     end-if
 17320     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17321         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17322         MOVE ' '                TO DC-OPTION-CODE
 17323         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17324         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17325
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 332
* EL156.cbl
 17326     IF CL-INCURRED-DT NOT = LOW-VALUES
 17327         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17328         MOVE ' '                TO DC-OPTION-CODE
 17329         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17330         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17331
 17332     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17333
 17334     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17335         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17336         MOVE ' '                TO DC-OPTION-CODE
 17337         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17338         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17339
 17340     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17341         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17342         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17343     ELSE
 17344         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17345         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17346
 17347     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17348     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17349     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17350     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17351                                    PI-GROUPING.
 17352     MOVE CL-CERT-STATE          TO CERT-STATE
 17353                                    PI-STATE.
 17354     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17355                                    PI-ACCOUNT.
 17356     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17357     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17358     MOVE 'CERT'                 TO FILE-SWITCH.
 17359
 17360     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17361     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17362        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17363        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17364            MOVE 'N' TO PI-JOINT-INSURED-IND
 17365     ELSE
 17366            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17367     END-IF.
 17368
 17369     perform 7975-read-acct      thru 7975-exit
 17370     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17371     MOVE PI-STATE               TO WS-ST-ACCESS.
 17372     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17373     MOVE '3'                    TO CNTL-REC-TYPE.
 17374     MOVE +0                     TO CNTL-SEQ-NO.
 17375     MOVE 'STAT'                 TO FILE-SWITCH.
 17376
 17377     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17378
 17379     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17380     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17381
 17382     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 17383        GO TO 7020-BYPASS-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 333
* EL156.cbl
 17384
 17385     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17386     MOVE '4'                    TO CNTL-REC-TYPE.
 17387     MOVE +0                     TO CNTL-SEQ-NO.
 17388     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17389     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17390     MOVE 'BENE'                 TO FILE-SWITCH.
 17391
 17392     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17393
 17394     IF NO-BENEFIT-FOUND
 17395        GO TO 7020-BYPASS-BENEFIT.
 17396
 17397     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17398     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17399     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17400
 17401 7020-BYPASS-BENEFIT.
 17402
 17403*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17404*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17405*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17406
 17407     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 17408       AND 'F'
 17409         GO TO 7021-GO-TO-LIFE.
 17410     move zeros                  to PI-MAX-BENEFIT-AMT
 17411     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17412     move cm-ah-orig-term        to pi-ah-term
 17413     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17414
 17415     IF (PI-COMPANY-ID = 'DCC')
 17416        and (acct-found)
 17417        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17418        PERFORM 0900-GET-DDF-limits
 17419                                 THRU 0900-EXIT
 17420        IF PDEF-FOUND
 17421           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17422              (P1 > +8)
 17423              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17424           END-PERFORM
 17425           IF P1 < +9
 17426              MOVE PD-MAX-AMT (P1)
 17427                                 TO PI-MAX-BENEFIT-AMT
 17428           END-IF
 17429        END-IF
 17430     end-if
 17431     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17432     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17433     if (pi-max-benefit-amt not = zeros)
 17434        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17435        move pi-max-benefit-amt  to beneo
 17436     else
 17437        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17438     end-if
 17439     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17440     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17441                                    CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 334
* EL156.cbl
 17442     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17443
 17444*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17445*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17446*    ELSE
 17447         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17448
 17449     MOVE ' '                    TO DC-OPTION-CODE.
 17450     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17451     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17452
 17453     IF PI-COMPANY-ID = 'DMD'
 17454         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17455         GO TO 7023-BYPASS-REMAINING-TERM.
 17456
 17457     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17458     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17459     GO TO 7022-AROUND-LIFE.
 17460
 17461 7021-GO-TO-LIFE.
 17462
 17463     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17464     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17465     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17466                                    CP-ORIGINAL-TERM.
 17467     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17468     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17469     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17470     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17471
 17472     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17473         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17474     ELSE
 17475         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17476
 17477     MOVE ' '                    TO DC-OPTION-CODE.
 17478     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17479     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17480
 17481 7022-AROUND-LIFE.
 17482
 17483     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17484     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17485     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17486     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17487     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17488     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17489     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17490
 17491     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17492
 17493     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 17494        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17495           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17496
 17497     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17498        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17499           MOVE CM-LF-ORIG-TERM  TO WST-REM.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 335
* EL156.cbl
 17500
 17501 7023-BYPASS-REMAINING-TERM.
 17502     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17503       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17504          MOVE ZEROS                  TO BENEO
 17505       ELSE
 17506          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17507          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17508          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17509          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17510          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17511          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17512          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17513          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17514          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17515          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17516          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17517          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17518          IF (PI-COMPANY-ID = 'DCC')
 17519             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17520             PERFORM 0900-GET-DDF-limits
 17521                                 THRU 0900-EXIT
 17522             IF PDEF-FOUND
 17523                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17524                   (P1 > +8)
 17525                   OR (PD-PROD-CODE (P1) = 'L')
 17526                END-PERFORM
 17527                IF P1 < +9
 17528                   MOVE PD-MAX-AMT (P1)
 17529                                 TO CP-R-MAX-TOT-BEN
 17530                END-IF
 17531             END-IF
 17532          END-IF
 17533
 17534* EXEC CICS LINK
 17535*            PROGRAM  (LINK-REMAMT)
 17536*            COMMAREA (CALCULATION-PASS-AREA)
 17537*            LENGTH   (CP-COMM-LENGTH)
 17538*         END-EXEC
 17539*    MOVE '."C                   (   #00016096' TO DFHEIV0
 17540     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17542     MOVE X'2020233030303136303936' TO DFHEIV0(25:11)
 17543     CALL 'kxdfhei1' USING DFHEIV0,
 17544           LINK-REMAMT,
 17545           CALCULATION-PASS-AREA,
 17546           CP-COMM-LENGTH,
 17547           DFHEIV99,
 17548           DFHEIV99,
 17549           DFHEIV99,
 17550           DFHEIV99
 17551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17552          MOVE CP-REMAINING-AMT       TO BENEO
 17553       end-if
 17554     end-if
 17555     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17556     MOVE +95                    TO TRLR-SEQ-NO
 17557
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 336
* EL156.cbl
 17558* EXEC CICS READ
 17559*       DATASET  ('ELTRLR')
 17560*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17561*       RIDFLD   (ELTRLR-KEY)
 17562*       RESP     (WS-RESPONSE)
 17563*    END-EXEC
 17564     MOVE 'ELTRLR' TO DFHEIV1
 17565*    MOVE '&"S        E          (  N#00016106' TO DFHEIV0
 17566     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17567     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17568     MOVE X'204E233030303136313036' TO DFHEIV0(25:11)
 17569     CALL 'kxdfhei1' USING DFHEIV0,
 17570           DFHEIV1,
 17571           DFHEIV20,
 17572           DFHEIV99,
 17573           ELTRLR-KEY,
 17574           DFHEIV99,
 17575           DFHEIV99,
 17576           DFHEIV99
 17577     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17578         DFHEIV20
 17579     MOVE EIBRESP  TO WS-RESPONSE
 17580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17581
 17582     if ws-resp-normal
 17583        perform varying s1 from +1 by +1 until
 17584           at-note-error-no (s1) = spaces
 17585           move at-note-error-no (s1)
 17586                                 to emi-error
 17587           if at-note-error-no (s1) = '1653'
 17588              evaluate true
 17589                 when cl-claim-type = 'L'
 17590                    move '  LF  '
 17591                                 to emi-claim-type
 17592                 when cl-claim-type = 'I'
 17593                    move '  IU  '
 17594                                 to emi-claim-type
 17595                 when cl-claim-type = 'F'
 17596                    move '  FL  '
 17597                                 to emi-claim-type
 17598                 when other
 17599                    move '  AH  '
 17600                                 to emi-claim-type
 17601              end-evaluate
 17602           end-if
 17603           PERFORM 9900-ERROR-FORMAT
 17604                                 THRU 9900-EXIT
 17605        end-perform
 17606     end-if
 17607     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17608         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17609            WS-LF-COVERAGE-TYPE = 'P'
 17610             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17611                                        CM-LF-ITD-DEATH-AMT
 17612             MOVE WS-REMAINING-AMT  TO  BENEO.
 17613
 17614     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17615     MOVE BENEO                  TO PI-REM-BEN-AMT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 337
* EL156.cbl
 17616     MOVE WS-TERMS               TO TERMSO.
 17617
 17618     IF WS-STATUS = '6' OR '7' OR '8'
 17619         MOVE AL-SABOF           TO CRTSTATA.
 17620
 17621     IF WS-STATUS = '1' OR '4'
 17622        IF CP-REMAINING-TERM-3 = ZEROS
 17623           MOVE 'EXPIRED'        TO CRTSTATO
 17624        ELSE
 17625           MOVE 'ACTIVE  '       TO CRTSTATO.
 17626
 17627     IF WS-STATUS = '2'
 17628         MOVE 'PEND    '         TO CRTSTATO.
 17629
 17630     IF WS-STATUS = '3'
 17631         MOVE 'RESTORE '         TO CRTSTATO.
 17632
 17633     IF WS-STATUS = '5'
 17634         MOVE 'REISSUE '         TO CRTSTATO.
 17635
 17636     IF WS-STATUS = '6'
 17637         MOVE 'LMP DIS'          TO CRTSTATO.
 17638
 17639     IF WS-STATUS = '7'
 17640         MOVE 'DEATH'            TO CRTSTATO.
 17641
 17642     IF WS-STATUS = '8'
 17643         MOVE 'CANCEL'           TO CRTSTATO.
 17644
 17645     IF WS-STATUS = '9'
 17646         MOVE 'RE-ONLY '         TO CRTSTATO.
 17647
 17648     IF WS-STATUS = 'V'
 17649         MOVE 'VOID  '           TO CRTSTATO.
 17650
 17651     IF WS-STATUS = 'D'
 17652         MOVE 'DECLINE '         TO CRTSTATO.
 17653
 17654     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 17655         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17656         MOVE '5'                TO CNTL-REC-TYPE
 17657     ELSE
 17658         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17659         MOVE '4'                TO CNTL-REC-TYPE.
 17660
 17661     MOVE '** NONE **'           TO COVERO.
 17662     MOVE AL-SABON               TO COVERA.
 17663
 17664     IF PI-COMPANY-ID = 'CVL'
 17665         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17666             MOVE CM-BENEFICIARY TO LOANNOO
 17667             MOVE AL-UANON       TO LOANNOA.
 17668
 17669     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17670        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17671        MOVE +91                 TO  TRLR-SEQ-NO
 17672
 17673* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 338
* EL156.cbl
 17674*           DATASET  ('ELTRLR')
 17675*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17676*           RIDFLD   (ELTRLR-KEY)
 17677*           RESP     (WS-RESPONSE)
 17678*       END-EXEC
 17679     MOVE 'ELTRLR' TO DFHEIV1
 17680*    MOVE '&"S        E          (  N#00016203' TO DFHEIV0
 17681     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17682     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17683     MOVE X'204E233030303136323033' TO DFHEIV0(25:11)
 17684     CALL 'kxdfhei1' USING DFHEIV0,
 17685           DFHEIV1,
 17686           DFHEIV20,
 17687           DFHEIV99,
 17688           ELTRLR-KEY,
 17689           DFHEIV99,
 17690           DFHEIV99,
 17691           DFHEIV99
 17692     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17693         DFHEIV20
 17694     MOVE EIBRESP  TO WS-RESPONSE
 17695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17696
 17697        IF WS-RESP-NORMAL
 17698           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17699        ELSE
 17700           MOVE SPACES           TO  LOANNOO
 17701        END-IF
 17702*052506
 17703*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17704*052506
 17705     END-IF
 17706
 17707     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17708        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17709
 17710     IF WS-BEN-CD = ZEROS
 17711         GO TO 7050-SHOW-CONTINUE.
 17712
 17713     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17714     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17715     MOVE +0                     TO CNTL-SEQ-NO.
 17716     MOVE 'BENE'                 TO FILE-SWITCH.
 17717
 17718     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17719
 17720     IF BENEFIT-FOUND
 17721         MOVE CF-JOINT-INDICATOR (SUB-1)  TO PI-JOINT-COV-IND
 17722         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 17723         MOVE AL-SANON                    TO COVERA.
 17724
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 339
* EL156.cbl
 17726 7050-SHOW-CONTINUE.
 17727
 17728     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 17729        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 17730            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 17731     END-IF
 17732
 17733     IF PI-COMPANY-ID = 'DMD'
 17734         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17735
 17736     MOVE -1                     TO PMTTYPEL.
 17737     GO TO 8100-SEND-INITIAL-MAP.
 17738
 17739 7100-SHOW-RECORD-NOT-FOUND.
 17740     IF FILE-SWITCH = 'MSTR'
 17741         MOVE ER-0204            TO EMI-ERROR.
 17742
 17743     IF FILE-SWITCH = 'CERT'
 17744         MOVE ER-0206            TO EMI-ERROR.
 17745
 17746     IF FILE-SWITCH = 'STAT'
 17747         MOVE ER-0149            TO EMI-ERROR.
 17748
 17749     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17750
 17751     MOVE -1                     TO PMTTYPEL.
 17752     GO TO 8100-SEND-INITIAL-MAP
 17753
 17754     .
 17755 7110-BUILD-PMT-TRLR.
 17756     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17757     MOVE +51                    TO TRLR-SEQ-NO
 17758
 17759* EXEC CICS READ
 17760*        DATASET  ('ELTRLR')
 17761*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17762*        RIDFLD   (ELTRLR-KEY)
 17763*        RESP     (WS-RESPONSE)
 17764*    END-EXEC
 17765     MOVE 'ELTRLR' TO DFHEIV1
 17766*    MOVE '&"S        E          (  N#00016271' TO DFHEIV0
 17767     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17768     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17769     MOVE X'204E233030303136323731' TO DFHEIV0(25:11)
 17770     CALL 'kxdfhei1' USING DFHEIV0,
 17771           DFHEIV1,
 17772           DFHEIV20,
 17773           DFHEIV99,
 17774           ELTRLR-KEY,
 17775           DFHEIV99,
 17776           DFHEIV99,
 17777           DFHEIV99
 17778     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17779         DFHEIV20
 17780     MOVE EIBRESP  TO WS-RESPONSE
 17781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17782     IF WS-RESP-NORMAL
 17783        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 340
* EL156.cbl
 17784     END-IF
 17785     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17786
 17787* EXEC CICS GETMAIN
 17788*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17789*         LENGTH    (200)
 17790*         INITIMG   (GETMAIN-SPACE)
 17791*     END-EXEC
 17792     MOVE 200
 17793       TO DFHEIV11
 17794*    MOVE ',"IL                  $   #00016281' TO DFHEIV0
 17795     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17796     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17797     MOVE X'2020233030303136323831' TO DFHEIV0(25:11)
 17798     CALL 'kxdfhei1' USING DFHEIV0,
 17799           DFHEIV20,
 17800           DFHEIV11,
 17801           GETMAIN-SPACE
 17802     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17803         DFHEIV20
 17804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17805     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17806                                    AT-PREV-PAID-THRU-DT
 17807     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17808     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17809     MOVE 'AT'                   TO AT-RECORD-ID
 17810     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17811     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17812     MOVE '2'                    TO AT-TRAILER-TYPE
 17813     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17814                                    AT-PAYMENT-LAST-MAINT-DT
 17815     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17816                                    AT-PAYMENT-LAST-UPDATED-BY
 17817     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17818     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17819     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17820     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17821     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17822     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17823     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17824     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17825     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17826     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17827     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17828     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17829     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17830     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17831     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17832     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17833                                    AT-TO-BE-WRITTEN-DT
 17834     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17835                                    AT-CHECK-QUE-SEQUENCE
 17836                                    AT-ADDL-RESERVE
 17837     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17838                                    AT-VOID-SELECT-DT
 17839                                    AT-VOID-ACCEPT-DT
 17840                                    AT-VOID-DT
 17841                                    AT-PMT-PROOF-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 341
* EL156.cbl
 17842                                    AT-INT-PMT-SELECT-DT
 17843     MOVE ZEROS                  TO AT-DAILY-RATE
 17844                                    AT-ELIMINATION-DAYS
 17845     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17846*    EXEC CICS HANDLE CONDITION
 17847*        DUPREC    (7120-DUPREC)
 17848*    END-EXEC
 17849     .
 17850 7115-WRITE-INT-TRLR.
 17851
 17852* EXEC CICS WRITE
 17853*         DATASET       ('ELTRLR')
 17854*         FROM          (ACTIVITY-TRAILERS)
 17855*         RIDFLD        (AT-CONTROL-PRIMARY)
 17856*         RESP          (WS-RESPONSE)
 17857*     END-EXEC
 17858     MOVE LENGTH OF
 17859      ACTIVITY-TRAILERS
 17860       TO DFHEIV11
 17861     MOVE 'ELTRLR' TO DFHEIV1
 17862*    MOVE '&$ L                  ''  N#00016332' TO DFHEIV0
 17863     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17864     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17865     MOVE X'204E233030303136333332' TO DFHEIV0(25:11)
 17866     CALL 'kxdfhei1' USING DFHEIV0,
 17867           DFHEIV1,
 17868           ACTIVITY-TRAILERS,
 17869           DFHEIV11,
 17870           AT-CONTROL-PRIMARY,
 17871           DFHEIV99,
 17872           DFHEIV99
 17873     MOVE EIBRESP  TO WS-RESPONSE
 17874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17875      IF WS-RESP-DUPREC
 17876         GO TO 7120-DUPREC
 17877      END-IF
 17878     GO TO 7130-EXIT
 17879     .
 17880 7120-DUPREC.
 17881     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17882     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17883     GO TO 7115-WRITE-INT-TRLR
 17884     .
 17885 7130-EXIT.
 17886      EXIT.
 17887 7140-BUILD-NOTE-TRLR.
 17888
 17889
 17890* EXEC CICS GETMAIN
 17891*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17892*         LENGTH    (200)
 17893*         INITIMG   (GETMAIN-SPACE)
 17894*     END-EXEC
 17895     MOVE 200
 17896       TO DFHEIV11
 17897*    MOVE ',"IL                  $   #00016352' TO DFHEIV0
 17898     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17899     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 342
* EL156.cbl
 17900     MOVE X'2020233030303136333532' TO DFHEIV0(25:11)
 17901     CALL 'kxdfhei1' USING DFHEIV0,
 17902           DFHEIV20,
 17903           DFHEIV11,
 17904           GETMAIN-SPACE
 17905     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17906         DFHEIV20
 17907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17908     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17909     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17910     MOVE 'AT'                   TO AT-RECORD-ID
 17911     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17912     MOVE '6'                    TO AT-TRAILER-TYPE
 17913     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17914                                    AT-GEN-INFO-LAST-MAINT-DT
 17915     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17916                                    AT-GEN-INFO-LAST-UPDATED-BY
 17917     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17918     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 17919     .
 17920 7150-WRITE.
 17921
 17922* EXEC CICS HANDLE CONDITION
 17923*        DUPREC    (7160-DUPREC)
 17924*    END-EXEC
 17925*    MOVE '"$%                   ! : #00016370' TO DFHEIV0
 17926     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17927     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17928     MOVE X'3A20233030303136333730' TO DFHEIV0(25:11)
 17929     CALL 'kxdfhei1' USING DFHEIV0
 17930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17931
 17932* EXEC CICS WRITE
 17933*         DATASET     ('ELTRLR')
 17934*         FROM        (ACTIVITY-TRAILERS)
 17935*         RIDFLD      (AT-CONTROL-PRIMARY)
 17936*         RESP        (WS-RESPONSE)
 17937*     END-EXEC
 17938     MOVE LENGTH OF
 17939      ACTIVITY-TRAILERS
 17940       TO DFHEIV11
 17941     MOVE 'ELTRLR' TO DFHEIV1
 17942*    MOVE '&$ L                  ''  N#00016373' TO DFHEIV0
 17943     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17944     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17945     MOVE X'204E233030303136333733' TO DFHEIV0(25:11)
 17946     CALL 'kxdfhei1' USING DFHEIV0,
 17947           DFHEIV1,
 17948           ACTIVITY-TRAILERS,
 17949           DFHEIV11,
 17950           AT-CONTROL-PRIMARY,
 17951           DFHEIV99,
 17952           DFHEIV99
 17953     MOVE EIBRESP  TO WS-RESPONSE
 17954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17955      IF WS-RESP-DUPREC
 17956         GO TO 7160-DUPREC
 17957      END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 343
* EL156.cbl
 17958     GO TO 7170-EXIT
 17959     .
 17960 7160-DUPREC.
 17961     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17962     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17963     GO TO 7150-WRITE
 17964     .
 17965 7170-EXIT.
 17966      EXIT.
 17967
 17968 7180-ADD-CERT-NOTE.
 17969*ADD CERT NOTE FOR SC NP+6
 17970
 17971
 17972* EXEC CICS GETMAIN
 17973*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17974*         LENGTH    (150)
 17975*         INITIMG   (GETMAIN-SPACE)
 17976*     END-EXEC.
 17977     MOVE 150
 17978       TO DFHEIV11
 17979*    MOVE ',"IL                  $   #00016395' TO DFHEIV0
 17980     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17981     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17982     MOVE X'2020233030303136333935' TO DFHEIV0(25:11)
 17983     CALL 'kxdfhei1' USING DFHEIV0,
 17984           DFHEIV20,
 17985           DFHEIV11,
 17986           GETMAIN-SPACE
 17987     SET ADDRESS OF CERT-NOTE-FILE TO
 17988         DFHEIV20
 17989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17990
 17991
 17992     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 17993     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 17994     MOVE +1                     TO WRK-NOTE-SEQ.
 17995     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17996     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17997     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17998     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17999     MOVE CL-CERT-STATE          TO CZ-STATE.
 18000     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18001     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18002     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18003     MOVE '2'                    TO CZ-RECORD-TYPE.
 18004     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18005     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18006     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18007     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18008     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18009     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18010     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18011     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18012     IF PI-COMPANY-ID = 'AHL'
 18013        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18014           CONTINUE
 18015        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 344
* EL156.cbl
 18016           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18017              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18018           ELSE
 18019              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18020           END-IF
 18021        END-IF
 18022     END-IF
 18023     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18024     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18025
 18026 7181-WRITE.
 18027
 18028
 18029* EXEC CICS WRITE
 18030*         DATASET     ('ERCNOT')
 18031*         FROM        (CERT-NOTE-FILE)
 18032*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18033*         RESP        (WS-RESPONSE)
 18034*    END-EXEC.
 18035     MOVE LENGTH OF
 18036      CERT-NOTE-FILE
 18037       TO DFHEIV11
 18038     MOVE 'ERCNOT' TO DFHEIV1
 18039*    MOVE '&$ L                  ''  N#00016437' TO DFHEIV0
 18040     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18041     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18042     MOVE X'204E233030303136343337' TO DFHEIV0(25:11)
 18043     CALL 'kxdfhei1' USING DFHEIV0,
 18044           DFHEIV1,
 18045           CERT-NOTE-FILE,
 18046           DFHEIV11,
 18047           CZ-CONTROL-PRIMARY,
 18048           DFHEIV99,
 18049           DFHEIV99
 18050     MOVE EIBRESP  TO WS-RESPONSE
 18051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18052
 18053
 18054     IF WS-RESP-DUPREC
 18055         GO TO 7182-DUPREC
 18056     END-IF.
 18057
 18058     SET CERT-NOTE-ADDED TO TRUE.
 18059
 18060     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18061         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18062     END-IF.
 18063
 18064     GO TO 7189-EXIT.
 18065
 18066 7182-DUPREC.
 18067
 18068     ADD +1                      TO  WRK-NOTE-SEQ.
 18069     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18070     GO TO 7181-WRITE.
 18071
 18072 7189-EXIT.
 18073      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 345
* EL156.cbl
 18074
 18075 7190-ADD-ORIG-NOTE.
 18076
 18077
 18078* EXEC CICS GETMAIN
 18079*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18080*         LENGTH    (150)
 18081*         INITIMG   (GETMAIN-SPACE)
 18082*     END-EXEC.
 18083     MOVE 150
 18084       TO DFHEIV11
 18085*    MOVE ',"IL                  $   #00016467' TO DFHEIV0
 18086     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18087     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18088     MOVE X'2020233030303136343637' TO DFHEIV0(25:11)
 18089     CALL 'kxdfhei1' USING DFHEIV0,
 18090           DFHEIV20,
 18091           DFHEIV11,
 18092           GETMAIN-SPACE
 18093     SET ADDRESS OF CERT-NOTE-FILE TO
 18094         DFHEIV20
 18095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18096
 18097
 18098     ADD +1                      TO WRK-NOTE-SEQ.
 18099     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18100     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18101     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18102     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18103     MOVE CL-CERT-STATE          TO CZ-STATE.
 18104     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18105     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18106     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18107     MOVE '2'                    TO CZ-RECORD-TYPE.
 18108     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18109     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18110     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18111     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18112     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18113     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18114
 18115 7191-WRITE.
 18116
 18117
 18118* EXEC CICS WRITE
 18119*         DATASET     ('ERCNOT')
 18120*         FROM        (CERT-NOTE-FILE)
 18121*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18122*         RESP        (WS-RESPONSE)
 18123*    END-EXEC.
 18124     MOVE LENGTH OF
 18125      CERT-NOTE-FILE
 18126       TO DFHEIV11
 18127     MOVE 'ERCNOT' TO DFHEIV1
 18128*    MOVE '&$ L                  ''  N#00016492' TO DFHEIV0
 18129     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18130     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18131     MOVE X'204E233030303136343932' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 346
* EL156.cbl
 18132     CALL 'kxdfhei1' USING DFHEIV0,
 18133           DFHEIV1,
 18134           CERT-NOTE-FILE,
 18135           DFHEIV11,
 18136           CZ-CONTROL-PRIMARY,
 18137           DFHEIV99,
 18138           DFHEIV99
 18139     MOVE EIBRESP  TO WS-RESPONSE
 18140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18141
 18142
 18143     IF WS-RESP-DUPREC
 18144         GO TO 7192-DUPREC
 18145     END-IF.
 18146
 18147     GO TO 7199-EXIT.
 18148
 18149 7192-DUPREC.
 18150
 18151     ADD +1                      TO  WRK-NOTE-SEQ.
 18152     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18153     GO TO 7191-WRITE.
 18154
 18155 7199-EXIT.
 18156      EXIT.
 18157 7200-FIND-BENEFIT.
 18158     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18159
 18160
 18161* EXEC CICS HANDLE CONDITION
 18162*        ENDFILE(7200-EXIT)
 18163*        NOTFND(7200-EXIT)
 18164*    END-EXEC.
 18165*    MOVE '"$''I                  ! ; #00016516' TO DFHEIV0
 18166     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18168     MOVE X'3B20233030303136353136' TO DFHEIV0(25:11)
 18169     CALL 'kxdfhei1' USING DFHEIV0
 18170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18171
 18172
 18173
 18174* EXEC CICS READ
 18175*        DATASET('ELCNTL')
 18176*        SET(ADDRESS OF CONTROL-FILE)
 18177*        RIDFLD(ELCNTL-KEY)
 18178*        GTEQ
 18179*    END-EXEC.
 18180     MOVE 'ELCNTL' TO DFHEIV1
 18181*    MOVE '&"S        G          (   #00016521' TO DFHEIV0
 18182     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18184     MOVE X'2020233030303136353231' TO DFHEIV0(25:11)
 18185     CALL 'kxdfhei1' USING DFHEIV0,
 18186           DFHEIV1,
 18187           DFHEIV20,
 18188           DFHEIV99,
 18189           ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 347
* EL156.cbl
 18190           DFHEIV99,
 18191           DFHEIV99,
 18192           DFHEIV99
 18193     SET ADDRESS OF CONTROL-FILE TO
 18194         DFHEIV20
 18195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18196
 18197
 18198     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18199        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18200           GO TO 7200-EXIT.
 18201
 18202     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18203         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18204            ((SUB-1 > 8) OR
 18205            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18206
 18207     IF SUB-1 NOT = 9
 18208         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18209
 18210     GO TO 7200-EXIT.
 18211
 18212 7200-BENEFIT-DUMMY.
 18213
 18214 7200-DUMMY-EXIT.
 18215     EXIT.
 18216
 18217 7200-EXIT.
 18218     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 348
* EL156.cbl
 18220*052506
 18221*052506 7250-FIND-LETTER-TRLR.
 18222*052506     EXEC CICS HANDLE CONDITION
 18223*052506         ENDFILE  (7250-END)
 18224*052506         NOTFND   (7250-END)
 18225*052506     END-EXEC.
 18226*052506
 18227*052506     EXEC CICS STARTBR
 18228*052506         DATASET   ('ELTRLR')
 18229*052506         RIDFLD    (ELTRLR-KEY)
 18230*052506         GTEQ
 18231*052506     END-EXEC.
 18232*052506
 18233*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18234*052506
 18235*052506 7250-FIND-LOOP.
 18236*052506     EXEC CICS READNEXT
 18237*052506         DATASET   ('ELTRLR')
 18238*052506         RIDFLD    (ELTRLR-KEY)
 18239*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18240*052506     END-EXEC.
 18241*052506
 18242*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18243*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18244*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18245*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18246*052506        GO TO 7250-END
 18247*052506     END-IF.
 18248*052506
 18249*052506     IF AT-TRAILER-TYPE NOT = '4'
 18250*052506         GO TO 7250-FIND-LOOP
 18251*052506     END-IF.
 18252*052506
 18253*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18254*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18255*052506     END-IF.
 18256*052506
 18257*052506     GO TO 7250-FIND-LOOP.
 18258*052506
 18259*052506 7250-END.
 18260*052506
 18261*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18262*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18263*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18264*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18265*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18266*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18267*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18268*052506     END-IF.
 18269*052506
 18270*052506     EXEC CICS ENDBR
 18271*052506          DATASET    ('ELTRLR')
 18272*052506     END-EXEC.
 18273*052506
 18274*052506 7250-EXIT.
 18275*052506     EXIT.
 18276*052506     EJECT
 18277*052506
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 349
* EL156.cbl
 18278 7300-CHECK-AUTO-ACTIVITY.
 18279
 18280     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18281         NEXT SENTENCE
 18282     ELSE
 18283         GO TO 7399-EXIT.
 18284
 18285     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18286
 18287     IF WS-ACT-REC-FOUND-SW = 'N'
 18288         GO TO 7399-EXIT.
 18289
 18290     IF PI-ACTIVITY-CODE = 09
 18291         GO TO 7300-CONT-AUTO-ACTIVITY.
 18292
 18293     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18294        (PI-ACTIVITY-CODE = 11)
 18295         GO TO 7300-CONT-AUTO-ACTIVITY.
 18296
 18297     IF PI-PROVISIONAL-IND = 'P'
 18298         IF PI-PMTTYPE = '1'
 18299             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18300                 MOVE 'N'    TO  PI-RESET-SW
 18301                 GO TO 7399-EXIT.
 18302
 18303     IF PI-PMTTYPE = '1'
 18304         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18305             MOVE 'N'        TO  PI-RESET-SW
 18306             GO TO 7399-EXIT.
 18307
 18308     IF PI-PMTTYPE = '2' OR '3'
 18309         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18310             MOVE 'N'        TO  PI-RESET-SW
 18311             GO TO 7399-EXIT.
 18312
 18313     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18314         IF PI-PROVISIONAL-IND = 'P'
 18315             NEXT SENTENCE
 18316         ELSE
 18317             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18318
 18319 7300-CONT-AUTO-ACTIVITY.
 18320
 18321     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18322         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18323         MOVE '4'            TO DC-OPTION-CODE
 18324         MOVE +0             TO DC-ELAPSED-DAYS
 18325                                DC-ELAPSED-MONTHS
 18326         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18327         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18328         IF PI-USES-PAID-TO
 18329             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18330             IF NO-CONVERSION-ERROR
 18331                 MOVE +1     TO DC-ELAPSED-DAYS
 18332                 MOVE +0     TO DC-ELAPSED-MONTHS
 18333                 MOVE '6'    TO DC-OPTION-CODE
 18334                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18335                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 350
* EL156.cbl
 18336                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18337
 18338     IF PI-PFKEY-USED = DFHPF5
 18339         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18340         IF PI-USES-PAID-TO
 18341             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18342             MOVE +1                  TO DC-ELAPSED-DAYS
 18343             MOVE +0                  TO DC-ELAPSED-MONTHS
 18344             MOVE '6'                 TO DC-OPTION-CODE
 18345             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18346             IF NO-CONVERSION-ERROR
 18347                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18348
 18349     IF WS-CHK-THRU-DT < PI-EXP-DT
 18350         NEXT SENTENCE
 18351     ELSE
 18352         MOVE 03                     TO  WS-ACTIVITY-CODE
 18353         GO TO 7390-PROCESS-ACTIVITY.
 18354
 18355     IF PI-PROV-PMT
 18356         MOVE 09                     TO  WS-ACTIVITY-CODE
 18357     ELSE
 18358        IF PI-PMTTYPE = '1'
 18359            MOVE 02                  TO  WS-ACTIVITY-CODE
 18360        ELSE
 18361        IF PI-PMTTYPE = '2' OR '3'
 18362            MOVE 07                  TO  WS-ACTIVITY-CODE
 18363        ELSE
 18364        IF PI-PMTTYPE = '4'
 18365            MOVE 00                  TO  WS-ACTIVITY-CODE
 18366        ELSE
 18367            MOVE 'N'                 TO  PI-RESET-SW
 18368            GO TO 7399-EXIT.
 18369
 18370 7390-PROCESS-ACTIVITY.
 18371
 18372     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18373
 18374 7399-EXIT.
 18375     EXIT.
 18376
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 351
* EL156.cbl
 18378 7400-CHECK-AUTO-ACTIVITY.
 18379
 18380
 18381* EXEC CICS HANDLE CONDITION
 18382*        NOTFND   (7400-NOT-FOUND)
 18383*    END-EXEC.
 18384*    MOVE '"$I                   ! < #00016710' TO DFHEIV0
 18385     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18387     MOVE X'3C20233030303136373130' TO DFHEIV0(25:11)
 18388     CALL 'kxdfhei1' USING DFHEIV0
 18389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18390
 18391
 18392     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18393     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18394     MOVE SPACES                 TO  CNTL-ACCESS.
 18395     MOVE +0                     TO  CNTL-SEQ-NO.
 18396
 18397
 18398* EXEC CICS READ
 18399*        DATASET   ('ELCNTL')
 18400*        RIDFLD    (ELCNTL-KEY)
 18401*        SET       (ADDRESS OF CONTROL-FILE)
 18402*    END-EXEC.
 18403     MOVE 'ELCNTL' TO DFHEIV1
 18404*    MOVE '&"S        E          (   #00016719' TO DFHEIV0
 18405     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18406     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18407     MOVE X'2020233030303136373139' TO DFHEIV0(25:11)
 18408     CALL 'kxdfhei1' USING DFHEIV0,
 18409           DFHEIV1,
 18410           DFHEIV20,
 18411           DFHEIV99,
 18412           ELCNTL-KEY,
 18413           DFHEIV99,
 18414           DFHEIV99,
 18415           DFHEIV99
 18416     SET ADDRESS OF CONTROL-FILE TO
 18417         DFHEIV20
 18418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18419
 18420
 18421     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18422     GO TO 7400-EXIT.
 18423
 18424 7400-NOT-FOUND.
 18425     MOVE 'N'                        TO  PI-RESET-SW
 18426                                         WS-LETTER-SW
 18427                                         WS-ACT-REC-FOUND-SW.
 18428
 18429     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18430
 18431 7400-EXIT.
 18432     EXIT.
 18433
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 352
* EL156.cbl
 18435 7450-FORMAT-AUTO-LETTER.
 18436
 18437     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18438         MOVE 'Y'                    TO PI-RESET-SW
 18439         GO TO 7450-CONTINUE-PROCESS.
 18440
 18441     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18442
 18443     IF SUB > 9
 18444         SUBTRACT 9 FROM SUB
 18445         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18446     ELSE
 18447         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18448
 18449 7450-CONTINUE-PROCESS.
 18450
 18451     IF WS-ACTIVITY-CODE = ZEROS
 18452         MOVE 'N'                    TO  WS-LETTER-SW
 18453         GO TO 7450-EXIT.
 18454
 18455     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18456
 18457     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18458         MOVE 'N'                    TO  PI-RESET-SW
 18459                                         WS-LETTER-SW
 18460         GO TO 7450-EXIT.
 18461
 18462     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18463         MOVE 'N'                    TO  WS-LETTER-SW
 18464         GO TO 7450-EXIT.
 18465
 18466     MOVE 'Y'                        TO  WS-LETTER-SW.
 18467     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18468     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18469
 18470     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18471
 18472     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18473         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18474         MOVE '6'                    TO  DC-OPTION-CODE
 18475         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18476         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18477         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18478         IF NO-CONVERSION-ERROR
 18479             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18480         ELSE
 18481              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18482
 18483     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18484         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18485         MOVE '6'                    TO  DC-OPTION-CODE
 18486         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18487         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18488         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18489         IF NO-CONVERSION-ERROR
 18490             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18491         ELSE
 18492             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 353
* EL156.cbl
 18493
 18494 7450-EXIT.
 18495     EXIT.
 18496
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 354
* EL156.cbl
 18498 7500-RESET-AUTO-ACTIVITY.
 18499
 18500     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18501     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18502     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18503     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18504     MOVE +100                   TO  TRLR-SEQ-NO.
 18505
 18506 7500-STARTBR-TRLR.
 18507
 18508
 18509* EXEC CICS HANDLE CONDITION
 18510*        ENDFILE  (7590-END)
 18511*        NOTFND   (7590-END)
 18512*    END-EXEC.
 18513*    MOVE '"$''I                  ! = #00016812' TO DFHEIV0
 18514     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18515     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18516     MOVE X'3D20233030303136383132' TO DFHEIV0(25:11)
 18517     CALL 'kxdfhei1' USING DFHEIV0
 18518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18519
 18520
 18521
 18522* EXEC CICS STARTBR
 18523*        DATASET   ('ELTRLR')
 18524*        RIDFLD    (ELTRLR-KEY)
 18525*        GTEQ
 18526*    END-EXEC.
 18527     MOVE 'ELTRLR' TO DFHEIV1
 18528     MOVE 0
 18529       TO DFHEIV11
 18530*    MOVE '&,         G          &   #00016817' TO DFHEIV0
 18531     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18532     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18533     MOVE X'2020233030303136383137' TO DFHEIV0(25:11)
 18534     CALL 'kxdfhei1' USING DFHEIV0,
 18535           DFHEIV1,
 18536           ELTRLR-KEY,
 18537           DFHEIV99,
 18538           DFHEIV11,
 18539           DFHEIV99
 18540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18541
 18542
 18543     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18544
 18545 7500-READ-NEXT.
 18546
 18547
 18548* EXEC CICS READNEXT
 18549*        DATASET   ('ELTRLR')
 18550*        RIDFLD    (ELTRLR-KEY)
 18551*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18552*    END-EXEC.
 18553     MOVE 'ELTRLR' TO DFHEIV1
 18554     MOVE 0
 18555       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 355
* EL156.cbl
 18556*    MOVE '&.S                   )   #00016827' TO DFHEIV0
 18557     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18558     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18559     MOVE X'2020233030303136383237' TO DFHEIV0(25:11)
 18560     CALL 'kxdfhei1' USING DFHEIV0,
 18561           DFHEIV1,
 18562           DFHEIV20,
 18563           DFHEIV99,
 18564           ELTRLR-KEY,
 18565           DFHEIV99,
 18566           DFHEIV11,
 18567           DFHEIV99,
 18568           DFHEIV99
 18569     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18570         DFHEIV20
 18571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18572
 18573
 18574     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18575        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18576        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18577        PI-CERT-NO    NOT = TRLR-CERT-NO
 18578         GO TO 7590-END.
 18579
 18580     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18581         GO TO 7500-READ-NEXT.
 18582
 18583     IF AT-TRAILER-TYPE NOT = '4'
 18584         GO TO 7500-READ-NEXT.
 18585
 18586     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18587         GO TO 7500-READ-NEXT.
 18588
 18589     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18590        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18591         GO TO 7500-READ-NEXT.
 18592
 18593     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18594        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18595        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18596         GO TO 7500-READ-NEXT.
 18597
 18598     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18599                         AND
 18600        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18601                         AND
 18602        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18603            GO TO 7500-READ-NEXT.
 18604
 18605     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18606
 18607
 18608* EXEC CICS ENDBR
 18609*        DATASET   ('ELTRLR')
 18610*    END-EXEC.
 18611     MOVE 'ELTRLR' TO DFHEIV1
 18612     MOVE 0
 18613       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 356
* EL156.cbl
 18614*    MOVE '&2                    $   #00016866' TO DFHEIV0
 18615     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18616     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18617     MOVE X'2020233030303136383636' TO DFHEIV0(25:11)
 18618     CALL 'kxdfhei1' USING DFHEIV0,
 18619           DFHEIV1,
 18620           DFHEIV11,
 18621           DFHEIV99
 18622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18623
 18624
 18625     MOVE 'N'                        TO  WS-BROWSE-SW.
 18626
 18627
 18628* EXEC CICS READ
 18629*        DATASET   ('ELTRLR')
 18630*        RIDFLD    (ELTRLR-KEY)
 18631*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18632*        UPDATE
 18633*    END-EXEC.
 18634     MOVE 'ELTRLR' TO DFHEIV1
 18635*    MOVE '&"S        EU         (   #00016872' TO DFHEIV0
 18636     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18637     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18638     MOVE X'2020233030303136383732' TO DFHEIV0(25:11)
 18639     CALL 'kxdfhei1' USING DFHEIV0,
 18640           DFHEIV1,
 18641           DFHEIV20,
 18642           DFHEIV99,
 18643           ELTRLR-KEY,
 18644           DFHEIV99,
 18645           DFHEIV99,
 18646           DFHEIV99
 18647     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18648         DFHEIV20
 18649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18650
 18651
 18652     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18653
 18654     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18655         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18656     ELSE
 18657         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18658             NEXT SENTENCE
 18659         ELSE
 18660             GO TO 7500-REWRITE-TRLR.
 18661
 18662     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18663
 18664     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18665     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18666     MOVE '1'                        TO  ARCH-REC-TYPE.
 18667     MOVE +0                         TO  ARCH-SEQ.
 18668
 18669     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18670
 18671 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 357
* EL156.cbl
 18672
 18673
 18674* EXEC CICS REWRITE
 18675*        DATASET   ('ELTRLR')
 18676*        FROM      (ACTIVITY-TRAILERS)
 18677*    END-EXEC.
 18678     MOVE LENGTH OF
 18679      ACTIVITY-TRAILERS
 18680       TO DFHEIV11
 18681     MOVE 'ELTRLR' TO DFHEIV1
 18682*    MOVE '&& L                  %   #00016900' TO DFHEIV0
 18683     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18684     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18685     MOVE X'2020233030303136393030' TO DFHEIV0(25:11)
 18686     CALL 'kxdfhei1' USING DFHEIV0,
 18687           DFHEIV1,
 18688           ACTIVITY-TRAILERS,
 18689           DFHEIV11,
 18690           DFHEIV99
 18691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18692
 18693
 18694     GO TO 7500-STARTBR-TRLR.
 18695
 18696 7590-END.
 18697
 18698     IF WS-BROWSE-SW = 'Y'
 18699         MOVE 'N'                    TO  WS-BROWSE-SW
 18700
 18701* EXEC CICS ENDBR
 18702*            DATASET   ('ELTRLR')
 18703*        END-EXEC.
 18704     MOVE 'ELTRLR' TO DFHEIV1
 18705     MOVE 0
 18706       TO DFHEIV11
 18707*    MOVE '&2                    $   #00016911' TO DFHEIV0
 18708     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18709     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18710     MOVE X'2020233030303136393131' TO DFHEIV0(25:11)
 18711     CALL 'kxdfhei1' USING DFHEIV0,
 18712           DFHEIV1,
 18713           DFHEIV11,
 18714           DFHEIV99
 18715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18716
 18717
 18718 7599-EXIT.
 18719     EXIT.
 18720
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 358
* EL156.cbl
 18722 7600-READ-ARCH-UPDATE.
 18723
 18724
 18725* EXEC CICS HANDLE CONDITION
 18726*        NOTFND   (7699-EXIT)
 18727*    END-EXEC.
 18728*    MOVE '"$I                   ! > #00016921' TO DFHEIV0
 18729     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18730     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18731     MOVE X'3E20233030303136393231' TO DFHEIV0(25:11)
 18732     CALL 'kxdfhei1' USING DFHEIV0
 18733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18734
 18735
 18736
 18737* EXEC CICS READ
 18738*        DATASET   ('ELARCH')
 18739*        RIDFLD    (ELARCH-KEY)
 18740*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18741*        UPDATE
 18742*    END-EXEC.
 18743     MOVE 'ELARCH' TO DFHEIV1
 18744*    MOVE '&"S        EU         (   #00016925' TO DFHEIV0
 18745     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18746     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18747     MOVE X'2020233030303136393235' TO DFHEIV0(25:11)
 18748     CALL 'kxdfhei1' USING DFHEIV0,
 18749           DFHEIV1,
 18750           DFHEIV20,
 18751           DFHEIV99,
 18752           ELARCH-KEY,
 18753           DFHEIV99,
 18754           DFHEIV99,
 18755           DFHEIV99
 18756     SET ADDRESS OF LETTER-ARCHIVE TO
 18757         DFHEIV20
 18758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18759
 18760
 18761     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18762
 18763
 18764* EXEC CICS REWRITE
 18765*        DATASET   ('ELARCH')
 18766*        FROM      (LETTER-ARCHIVE)
 18767*    END-EXEC.
 18768     MOVE LENGTH OF
 18769      LETTER-ARCHIVE
 18770       TO DFHEIV11
 18771     MOVE 'ELARCH' TO DFHEIV1
 18772*    MOVE '&& L                  %   #00016934' TO DFHEIV0
 18773     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18774     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18775     MOVE X'2020233030303136393334' TO DFHEIV0(25:11)
 18776     CALL 'kxdfhei1' USING DFHEIV0,
 18777           DFHEIV1,
 18778           LETTER-ARCHIVE,
 18779           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 359
* EL156.cbl
 18780           DFHEIV99
 18781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18782
 18783
 18784 7699-EXIT.
 18785     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 360
* EL156.cbl
 18787 7700-GET-DCT.
 18788
 18789     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18790     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18791     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18792     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18793                                    PI-MAX-BENEFIT-AMT
 18794                                    PI-MAX-BENEFIT-PYMT
 18795                                    PI-MIN-PAYMENT-AMT
 18796                                    PI-TIME-OF-LOSS-BAL.
 18797
 18798
 18799* EXEC CICS HANDLE CONDITION
 18800*         NOTFND (5300-NOTE-NOT-FOUND)
 18801*     END-EXEC.
 18802*    MOVE '"$I                   ! ? #00016953' TO DFHEIV0
 18803     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18804     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18805     MOVE X'3F20233030303136393533' TO DFHEIV0(25:11)
 18806     CALL 'kxdfhei1' USING DFHEIV0
 18807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18808
 18809
 18810
 18811* EXEC CICS READ
 18812*         DATASET('ERNOTE')
 18813*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18814*         RIDFLD (W-NOTE-KEY)
 18815*     END-EXEC.
 18816     MOVE 'ERNOTE' TO DFHEIV1
 18817*    MOVE '&"S        E          (   #00016957' TO DFHEIV0
 18818     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18819     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18820     MOVE X'2020233030303136393537' TO DFHEIV0(25:11)
 18821     CALL 'kxdfhei1' USING DFHEIV0,
 18822           DFHEIV1,
 18823           DFHEIV20,
 18824           DFHEIV99,
 18825           W-NOTE-KEY,
 18826           DFHEIV99,
 18827           DFHEIV99,
 18828           DFHEIV99
 18829     SET ADDRESS OF CERTIFICATE-NOTE TO
 18830         DFHEIV20
 18831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18832
 18833
 18834     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18835     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18836     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18837     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18838     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18839
 18840     IF PI-PAYEE-TYPE NOT = 'B'
 18841         GO TO 7700-EXIT.
 18842
 18843     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18844     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 361
* EL156.cbl
 18845     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18846
 18847     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18848         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18849     ELSE
 18850         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18851
 18852     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18853     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18854     MOVE 'DLO006'               TO PGM-NAME.
 18855
 18856
 18857* EXEC CICS LINK
 18858*        PROGRAM    (PGM-NAME)
 18859*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18860*        LENGTH     (DCT-RCRD-LENGTH)
 18861*    END-EXEC.
 18862*    MOVE '."C                   (   #00016985' TO DFHEIV0
 18863     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18865     MOVE X'2020233030303136393835' TO DFHEIV0(25:11)
 18866     CALL 'kxdfhei1' USING DFHEIV0,
 18867           PGM-NAME,
 18868           DCT-COMMUNICATION-AREA,
 18869           DCT-RCRD-LENGTH,
 18870           DFHEIV99,
 18871           DFHEIV99,
 18872           DFHEIV99,
 18873           DFHEIV99
 18874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18875
 18876
 18877     IF DCT-RETURN-CODE = 'OK'
 18878         GO TO 7700-CONT.
 18879
 18880     IF DCT-RETURN-CODE = '01' OR '02'
 18881         GO TO 7700-SET-TO-YES.
 18882
 18883     IF DCT-RETURN-CODE = '03'
 18884
 18885* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18886*    MOVE '6"R                   !   #00016998' TO DFHEIV0
 18887     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18889     MOVE X'2020233030303136393938' TO DFHEIV0(25:11)
 18890     CALL 'kxdfhei1' USING DFHEIV0
 18891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18892         MOVE ER-0951            TO EMI-ERROR
 18893         MOVE -1                 TO PMTTYPEL
 18894         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18895         GO TO 8200-SEND-DATAONLY.
 18896
 18897     IF DCT-RETURN-CODE = '04'
 18898
 18899* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18900*    MOVE '6"R                   !   #00017005' TO DFHEIV0
 18901     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 362
* EL156.cbl
 18903     MOVE X'2020233030303137303035' TO DFHEIV0(25:11)
 18904     CALL 'kxdfhei1' USING DFHEIV0
 18905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18906         MOVE ER-0946            TO EMI-ERROR
 18907         MOVE -1                 TO PMTTYPEL
 18908         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18909         GO TO 8200-SEND-DATAONLY.
 18910
 18911     IF DCT-RETURN-CODE = '05'
 18912
 18913* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18914*    MOVE '6"R                   !   #00017012' TO DFHEIV0
 18915     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18917     MOVE X'2020233030303137303132' TO DFHEIV0(25:11)
 18918     CALL 'kxdfhei1' USING DFHEIV0
 18919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18920         MOVE ER-0947            TO EMI-ERROR
 18921         MOVE -1                 TO PMTTYPEL
 18922         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18923         GO TO 8200-SEND-DATAONLY.
 18924
 18925     IF DCT-RETURN-CODE = '06'
 18926
 18927* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18928*    MOVE '6"R                   !   #00017019' TO DFHEIV0
 18929     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18930     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18931     MOVE X'2020233030303137303139' TO DFHEIV0(25:11)
 18932     CALL 'kxdfhei1' USING DFHEIV0
 18933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18934         MOVE ER-0921            TO EMI-ERROR
 18935         MOVE -1                 TO PMTTYPEL
 18936         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18937         GO TO 8200-SEND-DATAONLY.
 18938
 18939     IF DCT-RETURN-CODE = '07'
 18940
 18941* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18942*    MOVE '6"R                   !   #00017026' TO DFHEIV0
 18943     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18945     MOVE X'2020233030303137303236' TO DFHEIV0(25:11)
 18946     CALL 'kxdfhei1' USING DFHEIV0
 18947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18948         MOVE ER-0919            TO EMI-ERROR
 18949         MOVE -1                 TO PMTTYPEL
 18950         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18951         GO TO 8200-SEND-DATAONLY.
 18952
 18953     IF DCT-RETURN-CODE = '08'
 18954
 18955* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18956*    MOVE '6"R                   !   #00017033' TO DFHEIV0
 18957     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18958     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18959     MOVE X'2020233030303137303333' TO DFHEIV0(25:11)
 18960     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 363
* EL156.cbl
 18961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18962         MOVE ER-0948            TO EMI-ERROR
 18963         MOVE -1                 TO PMTTYPEL
 18964         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18965         GO TO 8200-SEND-DATAONLY.
 18966
 18967     IF DCT-RETURN-CODE = 'N1'
 18968
 18969* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18970*    MOVE '6"R                   !   #00017040' TO DFHEIV0
 18971     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18972     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18973     MOVE X'2020233030303137303430' TO DFHEIV0(25:11)
 18974     CALL 'kxdfhei1' USING DFHEIV0
 18975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18976         MOVE ER-0950            TO EMI-ERROR
 18977         MOVE -1                 TO PMTTYPEL
 18978         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18979         GO TO 8200-SEND-DATAONLY.
 18980
 18981     IF DCT-RETURN-CODE = 'E1'
 18982
 18983* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18984*    MOVE '6"R                   !   #00017047' TO DFHEIV0
 18985     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18986     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18987     MOVE X'2020233030303137303437' TO DFHEIV0(25:11)
 18988     CALL 'kxdfhei1' USING DFHEIV0
 18989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18990         MOVE ER-0974            TO EMI-ERROR
 18991         MOVE -1                 TO PMTTYPEL
 18992         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18993         GO TO 8200-SEND-DATAONLY.
 18994
 18995     IF DCT-RETURN-CODE = 'E2'
 18996
 18997* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18998*    MOVE '6"R                   !   #00017054' TO DFHEIV0
 18999     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19001     MOVE X'2020233030303137303534' TO DFHEIV0(25:11)
 19002     CALL 'kxdfhei1' USING DFHEIV0
 19003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19004         MOVE ER-0975            TO EMI-ERROR
 19005         MOVE -1                 TO PMTTYPEL
 19006         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19007         GO TO 8200-SEND-DATAONLY.
 19008
 19009     IF DCT-RETURN-CODE NOT = 'OK'
 19010
 19011* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19012*    MOVE '6"R                   !   #00017061' TO DFHEIV0
 19013     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19015     MOVE X'2020233030303137303631' TO DFHEIV0(25:11)
 19016     CALL 'kxdfhei1' USING DFHEIV0
 19017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19018         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 364
* EL156.cbl
 19019         MOVE -1                 TO PMTTYPEL
 19020         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19021         GO TO 8200-SEND-DATAONLY.
 19022
 19023 7700-CONT.
 19024
 19025*    MOVE 'N'                    TO CASHO.
 19026*    MOVE +1                     TO CASHL.
 19027*    MOVE AL-UANON               TO CASHA.
 19028
 19029     IF PI-OFFLINE = 'Y'
 19030         GO TO 7700-EXIT.
 19031
 19032     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19033     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19034     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19035     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19036     MOVE +7                     TO CHECKNOL.
 19037     MOVE AL-UANON               TO CHECKNOA.
 19038     GO TO 7700-EXIT.
 19039
 19040 7700-SET-TO-YES.
 19041
 19042*    MOVE 'Y'                    TO CASHO.
 19043*    MOVE +1                     TO CASHL.
 19044*    MOVE AL-UANON               TO CASHA.
 19045
 19046 7700-EXIT.
 19047     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 365
* EL156.cbl
 19049 7800-READ-COMP-MSTR.
 19050
 19051
 19052* EXEC CICS HANDLE CONDITION
 19053*        NOTFND   (7800-COMP-NOTFND)
 19054*    END-EXEC.
 19055*    MOVE '"$I                   ! @ #00017095' TO DFHEIV0
 19056     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19057     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19058     MOVE X'4020233030303137303935' TO DFHEIV0(25:11)
 19059     CALL 'kxdfhei1' USING DFHEIV0
 19060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19061
 19062
 19063
 19064* EXEC CICS READ
 19065*        DATASET   ('ERCOMP')
 19066*        RIDFLD    (ERCOMP-KEY)
 19067*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19068*    END-EXEC.
 19069     MOVE 'ERCOMP' TO DFHEIV1
 19070*    MOVE '&"S        E          (   #00017099' TO DFHEIV0
 19071     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19073     MOVE X'2020233030303137303939' TO DFHEIV0(25:11)
 19074     CALL 'kxdfhei1' USING DFHEIV0,
 19075           DFHEIV1,
 19076           DFHEIV20,
 19077           DFHEIV99,
 19078           ERCOMP-KEY,
 19079           DFHEIV99,
 19080           DFHEIV99,
 19081           DFHEIV99
 19082     SET ADDRESS OF COMPENSATION-MASTER TO
 19083         DFHEIV20
 19084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19085
 19086
 19087     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19088     GO TO 7800-COMP-EXIT.
 19089
 19090 7800-COMP-NOTFND.
 19091     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19092
 19093 7800-COMP-EXIT.
 19094     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 366
* EL156.cbl
 19096 7900-READ-CLAIM.
 19097
 19098* EXEC CICS READ
 19099*        DATASET  ('ELMSTR')
 19100*        SET      (ADDRESS OF CLAIM-MASTER)
 19101*        RIDFLD   (ELMSTR-KEY)
 19102*    END-EXEC.
 19103     MOVE 'ELMSTR' TO DFHEIV1
 19104*    MOVE '&"S        E          (   #00017115' TO DFHEIV0
 19105     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19107     MOVE X'2020233030303137313135' TO DFHEIV0(25:11)
 19108     CALL 'kxdfhei1' USING DFHEIV0,
 19109           DFHEIV1,
 19110           DFHEIV20,
 19111           DFHEIV99,
 19112           ELMSTR-KEY,
 19113           DFHEIV99,
 19114           DFHEIV99,
 19115           DFHEIV99
 19116     SET ADDRESS OF CLAIM-MASTER TO
 19117         DFHEIV20
 19118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19119
 19120
 19121 7900-EXIT.
 19122      EXIT.
 19123
 19124 7910-READ-CLAIM-UPDATE.
 19125
 19126* EXEC CICS READ
 19127*        DATASET  ('ELMSTR')
 19128*        SET      (ADDRESS OF CLAIM-MASTER)
 19129*        RIDFLD   (ELMSTR-KEY)
 19130*        UPDATE
 19131*    END-EXEC.
 19132     MOVE 'ELMSTR' TO DFHEIV1
 19133*    MOVE '&"S        EU         (   #00017125' TO DFHEIV0
 19134     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19135     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19136     MOVE X'2020233030303137313235' TO DFHEIV0(25:11)
 19137     CALL 'kxdfhei1' USING DFHEIV0,
 19138           DFHEIV1,
 19139           DFHEIV20,
 19140           DFHEIV99,
 19141           ELMSTR-KEY,
 19142           DFHEIV99,
 19143           DFHEIV99,
 19144           DFHEIV99
 19145     SET ADDRESS OF CLAIM-MASTER TO
 19146         DFHEIV20
 19147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19148
 19149
 19150 7910-EXIT.
 19151      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 367
* EL156.cbl
 19153 7920-READ-BENE.
 19154     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19155     MOVE 'B'                TO BENE-RECORD-TYPE.
 19156     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19157
 19158     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19159        IF PI-PAYEE-TYPE    = 'B' AND
 19160           PI-PAYEE-SEQ-NUM = 9
 19161             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19162             MOVE WS-A-BENE           TO BENE-NUMBER.
 19163
 19164
 19165* EXEC CICS HANDLE CONDITION
 19166*        NOTFND   (7920-NOT-FOUND)
 19167*    END-EXEC.
 19168*    MOVE '"$I                   ! A #00017146' TO DFHEIV0
 19169     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19171     MOVE X'4120233030303137313436' TO DFHEIV0(25:11)
 19172     CALL 'kxdfhei1' USING DFHEIV0
 19173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19174
 19175
 19176
 19177* EXEC CICS READ
 19178*        DATASET  ('ELBENE')
 19179*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19180*        RIDFLD   (ELBENE-KEY)
 19181*    END-EXEC.
 19182     MOVE 'ELBENE' TO DFHEIV1
 19183*    MOVE '&"S        E          (   #00017150' TO DFHEIV0
 19184     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19186     MOVE X'2020233030303137313530' TO DFHEIV0(25:11)
 19187     CALL 'kxdfhei1' USING DFHEIV0,
 19188           DFHEIV1,
 19189           DFHEIV20,
 19190           DFHEIV99,
 19191           ELBENE-KEY,
 19192           DFHEIV99,
 19193           DFHEIV99,
 19194           DFHEIV99
 19195     SET ADDRESS OF BENEFICIARY-MASTER TO
 19196         DFHEIV20
 19197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19198
 19199
 19200     MOVE 'Y' TO BENE-FOUND-SW.
 19201     GO TO 7920-EXIT.
 19202
 19203 7920-NOT-FOUND.
 19204     MOVE 'N'                    TO BENE-FOUND-SW.
 19205
 19206 7920-EXIT.
 19207      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 368
* EL156.cbl
 19209 7930-READ-CONTROL.
 19210
 19211* EXEC CICS READ
 19212*        DATASET  ('ELCNTL')
 19213*        SET      (ADDRESS OF CONTROL-FILE)
 19214*        RIDFLD   (ELCNTL-KEY)
 19215*    END-EXEC.
 19216     MOVE 'ELCNTL' TO DFHEIV1
 19217*    MOVE '&"S        E          (   #00017166' TO DFHEIV0
 19218     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19219     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19220     MOVE X'2020233030303137313636' TO DFHEIV0(25:11)
 19221     CALL 'kxdfhei1' USING DFHEIV0,
 19222           DFHEIV1,
 19223           DFHEIV20,
 19224           DFHEIV99,
 19225           ELCNTL-KEY,
 19226           DFHEIV99,
 19227           DFHEIV99,
 19228           DFHEIV99
 19229     SET ADDRESS OF CONTROL-FILE TO
 19230         DFHEIV20
 19231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19232
 19233
 19234 7930-EXIT.
 19235      EXIT.
 19236
 19237 7940-READ-CONTROL-UPDATE.
 19238
 19239* EXEC CICS READ
 19240*        DATASET  ('ELCNTL')
 19241*        SET      (ADDRESS OF CONTROL-FILE)
 19242*        RIDFLD   (ELCNTL-KEY)
 19243*        UPDATE
 19244*    END-EXEC.
 19245     MOVE 'ELCNTL' TO DFHEIV1
 19246*    MOVE '&"S        EU         (   #00017176' TO DFHEIV0
 19247     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19248     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19249     MOVE X'2020233030303137313736' TO DFHEIV0(25:11)
 19250     CALL 'kxdfhei1' USING DFHEIV0,
 19251           DFHEIV1,
 19252           DFHEIV20,
 19253           DFHEIV99,
 19254           ELCNTL-KEY,
 19255           DFHEIV99,
 19256           DFHEIV99,
 19257           DFHEIV99
 19258     SET ADDRESS OF CONTROL-FILE TO
 19259         DFHEIV20
 19260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19261
 19262
 19263 7940-EXIT.
 19264      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 369
* EL156.cbl
 19266 7950-READ-TRAILER.
 19267
 19268* EXEC CICS READ
 19269*        DATASET  ('ELTRLR')
 19270*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19271*        RIDFLD   (ELTRLR-KEY)
 19272*    END-EXEC.
 19273     MOVE 'ELTRLR' TO DFHEIV1
 19274*    MOVE '&"S        E          (   #00017187' TO DFHEIV0
 19275     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19277     MOVE X'2020233030303137313837' TO DFHEIV0(25:11)
 19278     CALL 'kxdfhei1' USING DFHEIV0,
 19279           DFHEIV1,
 19280           DFHEIV20,
 19281           DFHEIV99,
 19282           ELTRLR-KEY,
 19283           DFHEIV99,
 19284           DFHEIV99,
 19285           DFHEIV99
 19286     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19287         DFHEIV20
 19288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19289
 19290
 19291 7950-EXIT.
 19292      EXIT.
 19293
 19294 7960-READ-TRAILER-UPDATE.
 19295
 19296* EXEC CICS READ
 19297*        DATASET  ('ELTRLR')
 19298*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19299*        RIDFLD   (ELTRLR-KEY)
 19300*        UPDATE
 19301*    END-EXEC.
 19302     MOVE 'ELTRLR' TO DFHEIV1
 19303*    MOVE '&"S        EU         (   #00017197' TO DFHEIV0
 19304     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19305     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19306     MOVE X'2020233030303137313937' TO DFHEIV0(25:11)
 19307     CALL 'kxdfhei1' USING DFHEIV0,
 19308           DFHEIV1,
 19309           DFHEIV20,
 19310           DFHEIV99,
 19311           ELTRLR-KEY,
 19312           DFHEIV99,
 19313           DFHEIV99,
 19314           DFHEIV99
 19315     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19316         DFHEIV20
 19317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19318
 19319
 19320 7960-EXIT.
 19321      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 370
* EL156.cbl
 19323 7970-READ-CERT.
 19324
 19325* EXEC CICS READ
 19326*        DATASET  ('ELCERT')
 19327*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19328*        RIDFLD   (ELCERT-KEY)
 19329*    END-EXEC.
 19330     MOVE 'ELCERT' TO DFHEIV1
 19331*    MOVE '&"S        E          (   #00017208' TO DFHEIV0
 19332     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19334     MOVE X'2020233030303137323038' TO DFHEIV0(25:11)
 19335     CALL 'kxdfhei1' USING DFHEIV0,
 19336           DFHEIV1,
 19337           DFHEIV20,
 19338           DFHEIV99,
 19339           ELCERT-KEY,
 19340           DFHEIV99,
 19341           DFHEIV99,
 19342           DFHEIV99
 19343     SET ADDRESS OF CERTIFICATE-MASTER TO
 19344         DFHEIV20
 19345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19346
 19347
 19348 7970-EXIT.
 19349      EXIT.
 19350 7975-read-acct.
 19351
 19352     move spaces              to WS-ACCT-RECORD-SW
 19353                                 pi-dcc-product-code
 19354
 19355     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19356     MOVE PI-CARRIER          TO ACCT-CARRIER
 19357     MOVE PI-GROUPING         TO ACCT-GROUPING
 19358     MOVE PI-STATE            TO ACCT-STATE
 19359     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19360     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19361     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19362     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19363
 19364
 19365* EXEC CICS READ
 19366*       DATASET ('ERACCT')
 19367*       RIDFLD  (ERACCT-KEY)
 19368*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19369*       GTEQ
 19370*       resp    (WS-RESPONSE)
 19371*    END-EXEC
 19372     MOVE 'ERACCT' TO DFHEIV1
 19373*    MOVE '&"S        G          (  N#00017230' TO DFHEIV0
 19374     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19375     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19376     MOVE X'204E233030303137323330' TO DFHEIV0(25:11)
 19377     CALL 'kxdfhei1' USING DFHEIV0,
 19378           DFHEIV1,
 19379           DFHEIV20,
 19380           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 371
* EL156.cbl
 19381           ERACCT-KEY,
 19382           DFHEIV99,
 19383           DFHEIV99,
 19384           DFHEIV99
 19385     SET ADDRESS OF ACCOUNT-MASTER TO
 19386         DFHEIV20
 19387     MOVE EIBRESP  TO WS-RESPONSE
 19388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19389     IF WS-RESP-NORMAL
 19390        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19391        and pi-cert-eff-dt < am-expiration-dt
 19392        and pi-cert-eff-dt >= am-effective-dt
 19393        move am-dcc-product-code to pi-dcc-product-code
 19394        set acct-found to true
 19395     end-if
 19396
 19397     .
 19398 7975-exit.
 19399     exit.
 19400 7980-READ-CERT-UPDATE.
 19401
 19402* EXEC CICS READ
 19403*        DATASET  ('ELCERT')
 19404*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19405*        RIDFLD   (ELCERT-KEY)
 19406*        UPDATE
 19407*    END-EXEC.
 19408     MOVE 'ELCERT' TO DFHEIV1
 19409*    MOVE '&"S        EU         (   #00017249' TO DFHEIV0
 19410     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19411     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19412     MOVE X'2020233030303137323439' TO DFHEIV0(25:11)
 19413     CALL 'kxdfhei1' USING DFHEIV0,
 19414           DFHEIV1,
 19415           DFHEIV20,
 19416           DFHEIV99,
 19417           ELCERT-KEY,
 19418           DFHEIV99,
 19419           DFHEIV99,
 19420           DFHEIV99
 19421     SET ADDRESS OF CERTIFICATE-MASTER TO
 19422         DFHEIV20
 19423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19424
 19425
 19426 7980-EXIT.
 19427      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 372
* EL156.cbl
 19429 8000-LOAD-ERROR-MESSAGES.
 19430     IF PI-PASS-SW = 'C'
 19431        MOVE EMI-LINE1           TO ERMSG1BO
 19432     ELSE
 19433        MOVE EMI-LINE1           TO ERRMSG1O
 19434        MOVE EMI-LINE2           TO ERRMSG2O.
 19435
 19436 8000-EXIT.
 19437     EXIT.
 19438
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 373
* EL156.cbl
 19440
 19441 8010-DMD-ERROR-CHECKS.
 19442     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19443
 19444     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19445         GO TO 8051-ISSUE-ERROR.
 19446
 19447     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19448     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19449     MOVE '3'                    TO DC-OPTION-CODE.
 19450     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19451     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19452         GO TO 8051-ISSUE-ERROR.
 19453
 19454     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19455       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19456                           OR
 19457          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19458           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19459             MOVE ER-0851         TO EMI-ERROR
 19460             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19461       END-IF
 19462       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19463             MOVE ER-8147         TO EMI-ERROR
 19464             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19465
 19466     GO TO 8090-EXIT.
 19467
 19468 8051-ISSUE-ERROR.
 19469     MOVE ER-8146            TO EMI-ERROR.
 19470     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19471     GO TO 8090-EXIT.
 19472
 19473 8090-EXIT.
 19474      EXIT.
 19475
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 374
* EL156.cbl
 19477 8100-SEND-INITIAL-MAP.
 19478
 19479     MOVE SAVE-DATE              TO RUNDTEAO.
 19480     MOVE EIBTIME                TO TIME-IN.
 19481     MOVE TIME-OUT               TO RUNTIMAO.
 19482     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19483
 19484     IF MAP-NAME = 'EL156A'
 19485        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19486           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19487        END-IF
 19488     END-IF
 19489*    IF MAP-NAME = 'EL156A'
 19490*       IF PI-COMPANY-ID = 'CRI'
 19491*          NEXT SENTENCE
 19492*       ELSE
 19493*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19494
 19495     IF MAP-NAME = 'EL156A'
 19496        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19497           NEXT SENTENCE
 19498        ELSE
 19499           MOVE AL-SADOF TO  PINTA    PINTHA.
 19500
 19501     IF MAP-NAME = 'EL156A'
 19502        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19503            NEXT SENTENCE
 19504        ELSE
 19505           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19506
 19507*    IF MAP-NAME = 'EL156A'
 19508*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19509*          NEXT SENTENCE
 19510*       ELSE
 19511*          MOVE AL-SADOF TO CASHHA CASHA.
 19512
 19513     IF MAP-NAME = 'EL156A'
 19514        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19515           NEXT SENTENCE
 19516        ELSE
 19517           MOVE AL-SADOF        TO  LOANHA
 19518                                    LOANNOA.
 19519
 19520     IF MAP-NAME = 'EL156A'
 19521        MOVE -1                 TO  ENTERPFL
 19522        IF PI-USES-PAID-TO
 19523           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19524           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19525           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19526        ELSE
 19527           NEXT SENTENCE
 19528     ELSE
 19529        IF MAP-NAME = 'EL156B'
 19530           IF PI-USES-PAID-TO
 19531              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19532              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19533
 19534
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 375
* EL156.cbl
 19535* EXEC CICS SEND
 19536*        MAP   (MAP-NAME)
 19537*        MAPSET(MAPSET-NAME)
 19538*        FROM  (EL156AI)
 19539*        ERASE
 19540*        CURSOR
 19541*    END-EXEC.
 19542     MOVE LENGTH OF
 19543      EL156AI
 19544       TO DFHEIV12
 19545     MOVE -1
 19546       TO DFHEIV11
 19547*    MOVE '8$     CT  E    H L F ,   #00017364' TO DFHEIV0
 19548     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19549     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19550     MOVE X'2020233030303137333634' TO DFHEIV0(25:11)
 19551     CALL 'kxdfhei1' USING DFHEIV0,
 19552           MAP-NAME,
 19553           EL156AI,
 19554           DFHEIV12,
 19555           MAPSET-NAME,
 19556           DFHEIV99,
 19557           DFHEIV99,
 19558           DFHEIV99,
 19559           DFHEIV11,
 19560           DFHEIV99,
 19561           DFHEIV99,
 19562           DFHEIV99
 19563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19564
 19565
 19566     GO TO 9100-RETURN-TRAN.
 19567
 19568 8200-SEND-DATAONLY.
 19569
 19570     IF FIRST-ENTRY = 'Y'
 19571         GO TO 8100-SEND-INITIAL-MAP.
 19572
 19573     IF RETURNED-FROM-B = 'Y'
 19574         GO TO 8100-SEND-INITIAL-MAP.
 19575
 19576     MOVE SAVE-DATE              TO RUNDTEAO.
 19577     MOVE EIBTIME                TO TIME-IN.
 19578     MOVE TIME-OUT               TO RUNTIMAO.
 19579
 19580     IF EIBAID = DFHPF11
 19581        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19582        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19583        MOVE 'EL001   '          TO RETURNED-FROM
 19584        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19585        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19586        GO TO 8100-SEND-INITIAL-MAP.
 19587
 19588     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19589
 19590     IF MAP-NAME =  'EL156A'
 19591        MOVE -1                 TO  ENTERPFL
 19592        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 376
* EL156.cbl
 19593           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19594           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19595           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19596        ELSE
 19597           NEXT SENTENCE
 19598     ELSE
 19599        IF MAP-NAME = 'EL156B'
 19600           IF PI-USES-PAID-TO
 19601              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19602              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19603
 19604     IF MAP-NAME =  'EL156A'
 19605        IF PI-COMPANY-ID = 'BOA'
 19606            IF PI-INT-RATE NUMERIC
 19607                MOVE PI-INT-RATE TO PINTO.
 19608     IF MAP-NAME = 'EL156A'
 19609        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19610           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19611*          MOVE 'Y'              TO EOBYNO
 19612        END-IF
 19613     END-IF
 19614
 19615
 19616* EXEC CICS SEND
 19617*        MAP   (MAP-NAME)
 19618*        MAPSET(MAPSET-NAME)
 19619*        FROM  (EL156AI)
 19620*        DATAONLY
 19621*        CURSOR
 19622*    END-EXEC.
 19623     MOVE LENGTH OF
 19624      EL156AI
 19625       TO DFHEIV12
 19626     MOVE -1
 19627       TO DFHEIV11
 19628*    MOVE '8$D    CT       H L F ,   #00017421' TO DFHEIV0
 19629     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19630     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19631     MOVE X'2020233030303137343231' TO DFHEIV0(25:11)
 19632     CALL 'kxdfhei1' USING DFHEIV0,
 19633           MAP-NAME,
 19634           EL156AI,
 19635           DFHEIV12,
 19636           MAPSET-NAME,
 19637           DFHEIV99,
 19638           DFHEIV99,
 19639           DFHEIV99,
 19640           DFHEIV11,
 19641           DFHEIV99,
 19642           DFHEIV99,
 19643           DFHEIV99
 19644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19645
 19646
 19647     GO TO 9100-RETURN-TRAN.
 19648
 19649 8300-SEND-TEXT.
 19650
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 377
* EL156.cbl
 19651* EXEC CICS SEND TEXT
 19652*        FROM(LOGOFF-TEXT)
 19653*        LENGTH(LOGOFF-LENGTH)
 19654*        ERASE
 19655*        FREEKB
 19656*    END-EXEC.
 19657*    MOVE '8&      T  E F  H   F -   #00017432' TO DFHEIV0
 19658     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19659     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19660     MOVE X'2020233030303137343332' TO DFHEIV0(25:11)
 19661     CALL 'kxdfhei1' USING DFHEIV0,
 19662           LOGOFF-TEXT,
 19663           LOGOFF-LENGTH,
 19664           DFHEIV99,
 19665           DFHEIV99,
 19666           DFHEIV99,
 19667           DFHEIV99,
 19668           DFHEIV99,
 19669           DFHEIV99,
 19670           DFHEIV99,
 19671           DFHEIV99,
 19672           DFHEIV99,
 19673           DFHEIV99
 19674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19675
 19676
 19677
 19678* EXEC CICS RETURN
 19679*    END-EXEC.
 19680*    MOVE '.(                    ''   #00017439' TO DFHEIV0
 19681     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19682     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19683     MOVE X'2020233030303137343339' TO DFHEIV0(25:11)
 19684     CALL 'kxdfhei1' USING DFHEIV0,
 19685           DFHEIV99,
 19686           DFHEIV99,
 19687           DFHEIV99,
 19688           DFHEIV99,
 19689           DFHEIV99,
 19690           DFHEIV99
 19691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19692
 19693
 19694 8500-FILE-NOTOPEN.
 19695     IF FILE-SWITCH = 'MSTR'
 19696         MOVE ER-0154            TO EMI-ERROR.
 19697     IF FILE-SWITCH = 'TRLR'
 19698         MOVE ER-0172            TO EMI-ERROR.
 19699     IF FILE-SWITCH = 'CERT'
 19700         MOVE ER-0169            TO EMI-ERROR.
 19701     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19702                      'PROC' OR 'STAT'
 19703         MOVE ER-0042            TO EMI-ERROR.
 19704     IF FILE-SWITCH = 'ACTQ'
 19705         MOVE ER-0338            TO EMI-ERROR.
 19706     IF FILE-SWITCH = 'ACCT'
 19707         MOVE ER-0168            TO EMI-ERROR.
 19708
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 378
* EL156.cbl
 19709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19710     MOVE -1                     TO PMTTYPEL.
 19711
 19712     IF FIRST-ENTRY = 'Y'
 19713         GO TO 8100-SEND-INITIAL-MAP.
 19714
 19715     GO TO 8200-SEND-DATAONLY.
 19716
 19717 8600-PGRM-NOT-FOUND.
 19718
 19719     MOVE ER-0923                TO EMI-ERROR.
 19720     MOVE -1                     TO ENTPFBL.
 19721     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19722
 19723     IF FIRST-ENTRY = 'Y'
 19724         GO TO 8100-SEND-INITIAL-MAP
 19725     ELSE
 19726         GO TO 8200-SEND-DATAONLY.
 19727
 19728 8800-UNAUTHORIZED-ACCESS.
 19729     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19730     GO TO 8300-SEND-TEXT.
 19731
 19732 8810-PF23.
 19733     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19734     MOVE XCTL-005               TO PGM-NAME.
 19735     GO TO 9300-XCTL.
 19736
 19737 8820-PF7-8.
 19738     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19739     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19740                                    PI-SAVED-PROGRAM-2
 19741                                    PI-SAVED-PROGRAM-3
 19742                                    PI-SAVED-PROGRAM-4
 19743                                    PI-SAVED-PROGRAM-5
 19744                                    PI-SAVED-PROGRAM-6
 19745                                    PI-RETURN-TO-PROGRAM.
 19746     IF EIBAID = DFHPF8
 19747        MOVE XCTL-132            TO PGM-NAME
 19748     ELSE
 19749        MOVE XCTL-130            TO PGM-NAME.
 19750
 19751     GO TO 9300-XCTL.
 19752
 19753 9100-RETURN-TRAN.
 19754     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19755     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19756
 19757
 19758* EXEC CICS RETURN
 19759*        TRANSID(TRANS-ID)
 19760*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19761*        LENGTH(PI-COMM-LENGTH)
 19762*    END-EXEC.
 19763*    MOVE '.(CT                  ''   #00017505' TO DFHEIV0
 19764     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19765     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19766     MOVE X'2020233030303137353035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 379
* EL156.cbl
 19767     CALL 'kxdfhei1' USING DFHEIV0,
 19768           TRANS-ID,
 19769           PROGRAM-INTERFACE-BLOCK,
 19770           PI-COMM-LENGTH,
 19771           DFHEIV99,
 19772           DFHEIV99,
 19773           DFHEIV99
 19774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19775
 19776
 19777 9200-RETURN-MAIN-MENU.
 19778     MOVE XCTL-126               TO PGM-NAME.
 19779     GO TO 9300-XCTL.
 19780
 19781 9300-XCTL.
 19782
 19783* EXEC CICS XCTL
 19784*        PROGRAM(PGM-NAME)
 19785*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19786*        LENGTH(PI-COMM-LENGTH)
 19787*    END-EXEC.
 19788*    MOVE '.$C                   %   #00017516' TO DFHEIV0
 19789     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19790     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19791     MOVE X'2020233030303137353136' TO DFHEIV0(25:11)
 19792     CALL 'kxdfhei1' USING DFHEIV0,
 19793           PGM-NAME,
 19794           PROGRAM-INTERFACE-BLOCK,
 19795           PI-COMM-LENGTH,
 19796           DFHEIV99
 19797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19798
 19799
 19800 9400-CLEAR.
 19801     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19802     GO TO 9300-XCTL.
 19803
 19804 9500-PF12.
 19805     MOVE XCTL-010               TO PGM-NAME.
 19806     GO TO 9300-XCTL.
 19807
 19808 9700-LINK-DATE-CONVERT.
 19809     MOVE LINK-ELDATCV           TO PGM-NAME.
 19810
 19811* EXEC CICS LINK
 19812*        PROGRAM   (PGM-NAME)
 19813*        COMMAREA  (DATE-CONVERSION-DATA)
 19814*        LENGTH    (DC-COMM-LENGTH)
 19815*    END-EXEC.
 19816*    MOVE '."C                   (   #00017532' TO DFHEIV0
 19817     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19818     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19819     MOVE X'2020233030303137353332' TO DFHEIV0(25:11)
 19820     CALL 'kxdfhei1' USING DFHEIV0,
 19821           PGM-NAME,
 19822           DATE-CONVERSION-DATA,
 19823           DC-COMM-LENGTH,
 19824           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 380
* EL156.cbl
 19825           DFHEIV99,
 19826           DFHEIV99,
 19827           DFHEIV99
 19828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19829
 19830
 19831 9700-EXIT.
 19832     EXIT.
 19833
 19834 9800-LINK-REM-TERM.
 19835     MOVE LINK-REMTERM TO PGM-NAME.
 19836
 19837
 19838* EXEC CICS LINK
 19839*        PROGRAM   (PGM-NAME)
 19840*        COMMAREA  (CALCULATION-PASS-AREA)
 19841*        LENGTH    (CP-COMM-LENGTH)
 19842*    END-EXEC.
 19843*    MOVE '."C                   (   #00017544' TO DFHEIV0
 19844     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19846     MOVE X'2020233030303137353434' TO DFHEIV0(25:11)
 19847     CALL 'kxdfhei1' USING DFHEIV0,
 19848           PGM-NAME,
 19849           CALCULATION-PASS-AREA,
 19850           CP-COMM-LENGTH,
 19851           DFHEIV99,
 19852           DFHEIV99,
 19853           DFHEIV99,
 19854           DFHEIV99
 19855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19856
 19857
 19858 9800-EXIT.
 19859     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 381
* EL156.cbl
 19861 9830-DMD-REMAINING-TERM.
 19862
 19863     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19864         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19865
 19866     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19867                              CM-PMT-EXTENSION-DAYS.
 19868
 19869     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19870                                  CL-NO-OF-DAYS-PAID.
 19871
 19872     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19873         GIVING W-REM REMAINDER W-REM-DAYS.
 19874
 19875     MOVE W-REM                  TO WST-REM.
 19876
 19877     IF W-REM-DAYS > ZEROS
 19878         MOVE '/'                TO WST-SLASH
 19879         MOVE W-REM-DAYS         TO WST-REM-DAYS
 19880     ELSE
 19881         MOVE SPACES             TO WST-REM-DAYS-GRP.
 19882
 19883 9830-EXIT.
 19884     EXIT.
 19885
 19886 9870-OUTPUT-ACTIVITY-RECORD.
 19887
 19888
 19889* EXEC CICS GETMAIN
 19890*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 19891*         LENGTH(25)
 19892*         INITIMG(WS-BLANK)
 19893*    END-EXEC.
 19894     MOVE 25
 19895       TO DFHEIV11
 19896*    MOVE ',"IL                  $   #00017580' TO DFHEIV0
 19897     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 19898     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19899     MOVE X'2020233030303137353830' TO DFHEIV0(25:11)
 19900     CALL 'kxdfhei1' USING DFHEIV0,
 19901           DFHEIV20,
 19902           DFHEIV11,
 19903           WS-BLANK
 19904     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 19905         DFHEIV20
 19906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19907
 19908
 19909     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 19910     MOVE ELMSTR-KEY             TO DA-KEY.
 19911     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 19912
 19913     IF PI-PMTTYPE EQUAL '7'
 19914         MOVE 'V'                TO DA-RECORD-TYPE
 19915     ELSE
 19916         MOVE 'P'                TO DA-RECORD-TYPE.
 19917
 19918
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 382
* EL156.cbl
 19919* EXEC CICS HANDLE CONDITION
 19920*         NOTOPEN(9870-NOTOPEN)
 19921*         DUPREC(9870-EXIT)
 19922*    END-EXEC.
 19923*    MOVE '"$J%                  ! B #00017595' TO DFHEIV0
 19924     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 19925     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19926     MOVE X'4220233030303137353935' TO DFHEIV0(25:11)
 19927     CALL 'kxdfhei1' USING DFHEIV0
 19928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19929
 19930
 19931
 19932* EXEC CICS WRITE
 19933*         DATASET('DLYACTV')
 19934*         RIDFLD(DA-KEY)
 19935*         FROM(DAILY-ACTIVITY-RECORD)
 19936*         LENGTH(25)
 19937*    END-EXEC.
 19938     MOVE 'DLYACTV' TO DFHEIV1
 19939     MOVE 25
 19940       TO DFHEIV11
 19941*    MOVE '&$ L                  ''   #00017600' TO DFHEIV0
 19942     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19943     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19944     MOVE X'2020233030303137363030' TO DFHEIV0(25:11)
 19945     CALL 'kxdfhei1' USING DFHEIV0,
 19946           DFHEIV1,
 19947           DAILY-ACTIVITY-RECORD,
 19948           DFHEIV11,
 19949           DA-KEY,
 19950           DFHEIV99,
 19951           DFHEIV99
 19952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19953
 19954     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 19955     GO TO 9870-EXIT.
 19956
 19957 9870-NOTOPEN.
 19958
 19959     MOVE '2955'                 TO EMI-ERROR.
 19960     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 19961
 19962 9870-EXIT.
 19963     EXIT.
 19964
 19965 9900-ERROR-FORMAT.
 19966
 19967     IF EMI-ERROR = ER-0923
 19968         MOVE PGM-NAME           TO W-CALLED-NAME.
 19969
 19970     MOVE LINK-001      TO PGM-NAME.
 19971     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 19972
 19973
 19974* EXEC CICS LINK
 19975*        PROGRAM (PGM-NAME)
 19976*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 383
* EL156.cbl
 19977*        LENGTH  (EMI-COMM-LENGTH)
 19978*    END-EXEC.
 19979*    MOVE '."C                   (   #00017625' TO DFHEIV0
 19980     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19982     MOVE X'2020233030303137363235' TO DFHEIV0(25:11)
 19983     CALL 'kxdfhei1' USING DFHEIV0,
 19984           PGM-NAME,
 19985           ERROR-MESSAGE-INTERFACE-BLOCK,
 19986           EMI-COMM-LENGTH,
 19987           DFHEIV99,
 19988           DFHEIV99,
 19989           DFHEIV99,
 19990           DFHEIV99
 19991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19992
 19993
 19994     IF EMI-ERROR = ER-0923
 19995         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 19996
 19997 9900-EXIT.
 19998     EXIT.
 19999
 20000 9990-ABEND.
 20001     MOVE LINK-004               TO PGM-NAME.
 20002     MOVE DFHEIBLK               TO EMI-LINE1.
 20003
 20004* EXEC CICS LINK
 20005*        PROGRAM   (PGM-NAME)
 20006*        COMMAREA  (EMI-LINE1)
 20007*        LENGTH    (64)
 20008*    END-EXEC.
 20009     MOVE 64
 20010       TO DFHEIV11
 20011*    MOVE '."C                   (   #00017640' TO DFHEIV0
 20012     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20013     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20014     MOVE X'2020233030303137363430' TO DFHEIV0(25:11)
 20015     CALL 'kxdfhei1' USING DFHEIV0,
 20016           PGM-NAME,
 20017           EMI-LINE1,
 20018           DFHEIV11,
 20019           DFHEIV99,
 20020           DFHEIV99,
 20021           DFHEIV99,
 20022           DFHEIV99
 20023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20024
 20025
 20026     MOVE 'EL156A'               TO  MAP-NAME.
 20027     MOVE LOW-VALUES             TO  EL156AO.
 20028     GO TO 8100-SEND-INITIAL-MAP.
 20029
 20030 9995-SECURITY-VIOLATION.
 20031*    COPY ELCSCTP.
 20032******************************************************************
 20033*                                                                *
 20034*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 384
* EL156.cbl
 20035*                            VMOD=2.001                          *
 20036*                                                                *
 20037*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20038******************************************************************
 20039
 20040
 20041     MOVE EIBDATE          TO SM-JUL-DATE.
 20042     MOVE EIBTRMID         TO SM-TERMID.
 20043     MOVE THIS-PGM         TO SM-PGM.
 20044     MOVE EIBTIME          TO TIME-IN.
 20045     MOVE TIME-OUT         TO SM-TIME.
 20046     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20047
 20048
 20049* EXEC CICS LINK
 20050*         PROGRAM  ('EL003')
 20051*         COMMAREA (SECURITY-MESSAGE)
 20052*         LENGTH   (80)
 20053*    END-EXEC.
 20054     MOVE 'EL003' TO DFHEIV1
 20055     MOVE 80
 20056       TO DFHEIV11
 20057*    MOVE '."C                   (   #00017668' TO DFHEIV0
 20058     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20060     MOVE X'2020233030303137363638' TO DFHEIV0(25:11)
 20061     CALL 'kxdfhei1' USING DFHEIV0,
 20062           DFHEIV1,
 20063           SECURITY-MESSAGE,
 20064           DFHEIV11,
 20065           DFHEIV99,
 20066           DFHEIV99,
 20067           DFHEIV99,
 20068           DFHEIV99
 20069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20070
 20071
 20072******************************************************************
 20073
 20074
 20075
 20076 9999-DFHBACK SECTION.
 20077     MOVE '9%                    "   ' TO DFHEIV0
 20078     MOVE 'EL156' TO DFHEIV1
 20079     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20080     GOBACK.
 20081 9999-DFHEXIT.
 20082     IF DFHEIGDJ EQUAL 0001
 20083         NEXT SENTENCE
 20084     ELSE IF DFHEIGDJ EQUAL 2
 20085         GO TO 9990-ABEND,
 20086               8600-PGRM-NOT-FOUND,
 20087               0400-FIRST-TIME,
 20088               6180-DUPREC,
 20089               9990-ABEND
 20090         DEPENDING ON DFHEIGDI
 20091     ELSE IF DFHEIGDJ EQUAL 3
 20092         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 385
* EL156.cbl
 20093               0380-CLAIM-END-FILE
 20094         DEPENDING ON DFHEIGDI
 20095     ELSE IF DFHEIGDJ EQUAL 4
 20096         GO TO 0380-CLAIM-END-FILE,
 20097               0380-CLAIM-END-FILE
 20098         DEPENDING ON DFHEIGDI
 20099     ELSE IF DFHEIGDJ EQUAL 5
 20100         GO TO 0800-EXIT
 20101         DEPENDING ON DFHEIGDI
 20102     ELSE IF DFHEIGDJ EQUAL 6
 20103         GO TO 1950-NOT-FOUND,
 20104               1950-NOT-FOUND
 20105         DEPENDING ON DFHEIGDI
 20106     ELSE IF DFHEIGDJ EQUAL 7
 20107         GO TO 1950-NOT-FOUND
 20108         DEPENDING ON DFHEIGDI
 20109     ELSE IF DFHEIGDJ EQUAL 8
 20110         GO TO 1950-NOT-FOUND,
 20111               1950-NOT-FOUND
 20112         DEPENDING ON DFHEIGDI
 20113     ELSE IF DFHEIGDJ EQUAL 9
 20114         GO TO 1166-END-CHECK,
 20115               1166-END-CHECK
 20116         DEPENDING ON DFHEIGDI
 20117     ELSE IF DFHEIGDJ EQUAL 10
 20118         GO TO 1950-NOT-FOUND,
 20119               1950-NOT-FOUND
 20120         DEPENDING ON DFHEIGDI
 20121     ELSE IF DFHEIGDJ EQUAL 11
 20122         GO TO 1950-NOT-FOUND,
 20123               1950-NOT-FOUND
 20124         DEPENDING ON DFHEIGDI
 20125     ELSE IF DFHEIGDJ EQUAL 12
 20126         GO TO 1950-NOT-FOUND
 20127         DEPENDING ON DFHEIGDI
 20128     ELSE IF DFHEIGDJ EQUAL 13
 20129         GO TO 3600-CONTINUE
 20130         DEPENDING ON DFHEIGDI
 20131     ELSE IF DFHEIGDJ EQUAL 14
 20132         GO TO 5300-NOTE-NOT-FOUND
 20133         DEPENDING ON DFHEIGDI
 20134     ELSE IF DFHEIGDJ EQUAL 15
 20135         GO TO 6065-NOT-FOUND
 20136         DEPENDING ON DFHEIGDI
 20137     ELSE IF DFHEIGDJ EQUAL 16
 20138         GO TO 6068-ACCT-NOT-FND
 20139         DEPENDING ON DFHEIGDI
 20140     ELSE IF DFHEIGDJ EQUAL 17
 20141         GO TO 6074-GET-COMP-DATA
 20142         DEPENDING ON DFHEIGDI
 20143     ELSE IF DFHEIGDJ EQUAL 18
 20144         GO TO 6170-WRITE
 20145         DEPENDING ON DFHEIGDI
 20146     ELSE IF DFHEIGDJ EQUAL 19
 20147         GO TO 6180-DUPREC
 20148         DEPENDING ON DFHEIGDI
 20149     ELSE IF DFHEIGDJ EQUAL 20
 20150         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:15 Page 386
* EL156.cbl
 20151         DEPENDING ON DFHEIGDI
 20152     ELSE IF DFHEIGDJ EQUAL 21
 20153         GO TO 6185-DUPREC
 20154         DEPENDING ON DFHEIGDI
 20155     ELSE IF DFHEIGDJ EQUAL 22
 20156         GO TO 6720-BUILD-NEW-RECORD
 20157         DEPENDING ON DFHEIGDI
 20158     ELSE IF DFHEIGDJ EQUAL 23
 20159         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20160               6900-BUILD-ARCHIVE-HEADER
 20161         DEPENDING ON DFHEIGDI
 20162     ELSE IF DFHEIGDJ EQUAL 24
 20163         GO TO 7010-BUILD-MAP
 20164         DEPENDING ON DFHEIGDI
 20165     ELSE IF DFHEIGDJ EQUAL 25
 20166         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20167         DEPENDING ON DFHEIGDI
 20168     ELSE IF DFHEIGDJ EQUAL 26
 20169         GO TO 7160-DUPREC
 20170         DEPENDING ON DFHEIGDI
 20171     ELSE IF DFHEIGDJ EQUAL 27
 20172         GO TO 7200-EXIT,
 20173               7200-EXIT
 20174         DEPENDING ON DFHEIGDI
 20175     ELSE IF DFHEIGDJ EQUAL 28
 20176         GO TO 7400-NOT-FOUND
 20177         DEPENDING ON DFHEIGDI
 20178     ELSE IF DFHEIGDJ EQUAL 29
 20179         GO TO 7590-END,
 20180               7590-END
 20181         DEPENDING ON DFHEIGDI
 20182     ELSE IF DFHEIGDJ EQUAL 30
 20183         GO TO 7699-EXIT
 20184         DEPENDING ON DFHEIGDI
 20185     ELSE IF DFHEIGDJ EQUAL 31
 20186         GO TO 5300-NOTE-NOT-FOUND
 20187         DEPENDING ON DFHEIGDI
 20188     ELSE IF DFHEIGDJ EQUAL 32
 20189         GO TO 7800-COMP-NOTFND
 20190         DEPENDING ON DFHEIGDI
 20191     ELSE IF DFHEIGDJ EQUAL 33
 20192         GO TO 7920-NOT-FOUND
 20193         DEPENDING ON DFHEIGDI
 20194     ELSE IF DFHEIGDJ EQUAL 34
 20195         GO TO 9870-NOTOPEN,
 20196               9870-EXIT
 20197         DEPENDING ON DFHEIGDI.
 20198     MOVE '9%                    "   ' TO DFHEIV0
 20199     MOVE 'EL156' TO DFHEIV1
 20200     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20201     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12172     Code:       74723
