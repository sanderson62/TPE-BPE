* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* ELRFND.cbl
* Options: int("ELRFND.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRFND.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRFND.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRFND.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFND.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:23:50.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* ELRFND.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  LOAN TERM        - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    42*  STATE CODE       - CP-STATE                                   *
    43*  STATE CODE       - CP-STATE-STD-ABBV                          *
    44*  CLASS CODE       - CP-CLASS-CODE                              *
    45*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    46*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    47*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    48*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    49*  A.P.R.           - CP-LOAN-APR                                *
    50*  METHOD           - CP-EARNING-METHOD                          *
    51*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  COMPANY I.D.     - CP-COMPANY-ID                              *
    54*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    55*  INSURED AGE      - CP-ISSUE-AGE                               *
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* ELRFND.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  ELRFND  WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '********VMOD=2.011 *************'.
    66 77  WS-UE-CLP                   PIC S9(5)V99 COMP-3 VALUE +0.
    67 77  WS-GFR3                     PIC S9(5)V99 COMP-3 VALUE +0.
    68 77  WS-MONTH                    PIC S999     COMP-3 VALUE +0.
    69
    70 01  WS-WORK-MISC.
    71     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    72     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    73     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    74     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    75     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    76     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    77     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    78     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    79     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    80     12  WS-SAVE-EARN-METHOD PIC X.
    81     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    82     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    83     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    84     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    85     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    86     12  FACTOR-5            PIC S9(7)        COMP-3.
    87     12  FACTOR-6            PIC S9(7)        COMP-3.
    88     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    89     12  RATE-FACTOR-2       PIC S999         COMP-3.
    90     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    91     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    92     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    93     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    94
    95 01  TEXAS-REG-WORK-AREAS.
    96     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    97     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    98     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    99     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   100     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   101     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   102     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   103     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   104     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   105
   106 01  NET-PAY-INTERFACE.
   107     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   108     12  N-P-ORIG            PIC S9(3)       COMP-3.
   109     12  N-P-REM             PIC S9(3)       COMP-3.
   110     12  N-P-OPT             PIC X.
   111     12  N-P-LOAN            PIC S9(3)       COMP-3.
   112     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   113
   114*                        COPY ERCNETWS.
   115*****************************************************************
   116*                                                               *
   117*                                                               *
   118*                            ERCNETWS                           *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* ELRFND.cbl
   119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   120*                            VMOD=2.014                         *
   121*                                                               *
   122*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   123*                                                               *
   124*****************************************************************.
   125*                   C H A N G E   L O G
   126*
   127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   128*-----------------------------------------------------------------
   129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   130* EFFECTIVE    NUMBER
   131*-----------------------------------------------------------------
   132* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   133* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   134* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   135* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   136******************************************************************
   137
   138 01  NET-PAY-WORK-AREA.
   139     12  OPTION-SW               PIC X   VALUE 'X'.
   140        88  NPO-STD         VALUE SPACE.
   141        88  NPO-ALT         VALUE 'A'.
   142        88  NPO-SIMPLE      VALUE 'S'.
   143        88  NPO-2MO         VALUE 'I'.
   144        88  NPO-3MO         VALUE 'J'.
   145        88  NPO-4MO         VALUE 'K'.
   146        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   147        88  NPO-TRUNC-0     VALUE 'T'.
   148        88  NPO-TRUNC-1     VALUE 'U'.
   149        88  NPO-TRUNC-2     VALUE 'V'.
   150        88  NPO-TRUNC-3     VALUE 'W'.
   151        88  NPO-TRUNC-4     VALUE 'X'.
   152        88  NPO-REFUND      VALUE 'R'.
   153        88  NPO-PRUDENTIAL  VALUE 'P'.
   154
   155     12  TYPE-SW             PIC X   VALUE 'N'.
   156        88  NET-STD             VALUE 'N'.
   157        88  NET-SMP             VALUE 'S'.
   158
   159     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   160        88  NP-RATING           VALUE '1'.
   161        88  NP-REFUND           VALUE '2'.
   162        88  NP-REMAIN-AMT       VALUE '3'.
   163
   164     12  COMP-3-WORK-AREA         COMP-3.
   165         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   166         16  V               PIC SV9(13)       VALUE +.0.
   167         16  J               PIC SV9(9)        VALUE +0.
   168         16  K               PIC SV9(9)        VALUE +0.
   169         16  I               PIC SV9(10)       VALUE +.0.
   170         16  D               PIC S9(5)         VALUE +.0.
   171         16  APR100          PIC SV9(9)        VALUE +.0.
   172         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   173         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   174         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   175         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   176         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* ELRFND.cbl
   177         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   178         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   179         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   180         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   181         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   182         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   183         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   184         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   185         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   186         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   187         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   188         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   189         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   190         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   191         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   192         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   193         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   194         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   195         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   196         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   197         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   198         16  K1              PIC S999          VALUE +1.
   199         16  K12             PIC S999          VALUE +12.
   200         16  K100            PIC S999          VALUE +100.
   201         16  K1000           PIC S9(7)         VALUE +1000.
   202         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   203         16  Y REDEFINES NC-LR
   204                             PIC S99V9(5).
   205         16  TI              PIC S999V9(5)     VALUE +0.
   206         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   207         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   208         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   209         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   210         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   211         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   212         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   213         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   214
   215         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   216         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   217         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   218         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   219         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   220         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   221         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   222         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   223         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   224         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   225         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   226         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   227         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   228
   229         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   230
   231         16  ORIGINAL-TERM   PIC S999.
   232         16  M              REDEFINES ORIGINAL-TERM
   233                             PIC S999.
   234
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* ELRFND.cbl
   235         16  REMAINING-TERM  PIC S999.
   236         16  R              REDEFINES REMAINING-TERM
   237                             PIC S999.
   238
   239         16  LOAN-TERM       PIC S999.
   240         16  N              REDEFINES LOAN-TERM
   241                             PIC S999.
   242
   243         16  EXPIRED-TERM    PIC S999.
   244         16  E              REDEFINES EXPIRED-TERM
   245                             PIC S999.
   246
   247         16  PRUDENTIAL-WORK-AMT
   248                             PIC S9(7)V9(8).
   249         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   250                             PIC S9(7)V9(8).
   251
   252         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   253         16  VX              PIC S9V9(13)      VALUE +0.0.
   254         16  SV              PIC S9V9(13)      VALUE +0.0.
   255         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   256         16  SX              PIC S9V9(13)      VALUE +0.0.
   257         16  SE              PIC S9V9(10)      VALUE +0.0.
   258         16  N2              PIC S9(7)         VALUE +0.
   259         16  N3              PIC S9(7)         VALUE +0.
   260         16  K-I             PIC S9V9(8)       VALUE +0.0.
   261
   262     12  BINARY-WORK-AREA        COMP.
   263         16  X1              PIC S999        VALUE +0.
   264         16  X2              PIC S999        VALUE +0.
   265         16  MAX-X           PIC S9(5)       VALUE +0.
   266         16  B1              PIC S9(5)       VALUE +1.
   267         16  LINDX           PIC S999        VALUE ZEROS.
   268         16  AHNDX           PIC S999        VALUE ZEROS.
   269
   270     12  CSO-RATE-WORK-AREAS.
   271         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   272         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   273         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   274     12  WS-WORK-MISC.
   275         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   276         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   277*        16  WS-AGE              PIC 99           VALUE ZEROS.
   278         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   279         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   280         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   281         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   282         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   283         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   284         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   285         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   286         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   287         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   288         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   289         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   290******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* ELRFND.cbl
   292*                        COPY ELCDATE.
   293******************************************************************
   294*                                                                *
   295*                                                                *
   296*                            ELCDATE.                            *
   297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   298*                            VMOD=2.003
   299*                                                                *
   300*                                                                *
   301*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   302*                 LENGTH = 200                                   *
   303******************************************************************
   304
   305 01  DATE-CONVERSION-DATA.
   306     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   307     12  DC-OPTION-CODE                PIC X.
   308         88  BIN-TO-GREG                VALUE ' '.
   309         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   310         88  EDIT-GREG-TO-BIN           VALUE '2'.
   311         88  YMD-GREG-TO-BIN            VALUE '3'.
   312         88  MDY-GREG-TO-BIN            VALUE '4'.
   313         88  JULIAN-TO-BIN              VALUE '5'.
   314         88  BIN-PLUS-ELAPSED           VALUE '6'.
   315         88  FIND-CENTURY               VALUE '7'.
   316         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   317         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   318         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   319         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   320         88  JULIAN-TO-BIN-3            VALUE 'C'.
   321         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   322         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   323         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   324         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   325         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   326         88  CHECK-LEAP-YEAR            VALUE 'H'.
   327         88  BIN-3-TO-GREG              VALUE 'I'.
   328         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   329         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   330         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   331         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   332         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   333         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   334         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   335         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   336         88  THREE-CHARACTER-BIN
   337                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   338         88  GREGORIAN-TO-BIN
   339                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   340         88  BIN-TO-GREGORIAN
   341                  VALUES ' ' '1' 'I' '8' 'G'.
   342         88  JULIAN-TO-BINARY
   343                  VALUES '5' 'C' 'E' 'F'.
   344     12  DC-ERROR-CODE                 PIC X.
   345         88  NO-CONVERSION-ERROR        VALUE ' '.
   346         88  DATE-CONVERSION-ERROR
   347                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   348         88  DATE-IS-ZERO               VALUE '1'.
   349         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* ELRFND.cbl
   350         88  DATE-IS-INVALID            VALUE '3'.
   351         88  DATE1-GREATER-DATE2        VALUE '4'.
   352         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   353         88  DATE-INVALID-OPTION        VALUE '9'.
   354         88  INVALID-CENTURY            VALUE 'A'.
   355         88  ONLY-CENTURY               VALUE 'B'.
   356         88  ONLY-LEAP-YEAR             VALUE 'C'.
   357         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   358     12  DC-END-OF-MONTH               PIC X.
   359         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   360     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   361         88  USE-NORMAL-PROCESS         VALUE ' '.
   362         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   363         88  ADJUST-UP-100-YRS          VALUE '2'.
   364     12  FILLER                        PIC X.
   365     12  DC-CONVERSION-DATES.
   366         16  DC-BIN-DATE-1             PIC XX.
   367         16  DC-BIN-DATE-2             PIC XX.
   368         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   369         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   370                       DC-GREG-DATE-1-EDIT.
   371             20  DC-EDIT1-MONTH        PIC 99.
   372             20  SLASH1-1              PIC X.
   373             20  DC-EDIT1-DAY          PIC 99.
   374             20  SLASH1-2              PIC X.
   375             20  DC-EDIT1-YEAR         PIC 99.
   376         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   377         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   378                     DC-GREG-DATE-2-EDIT.
   379             20  DC-EDIT2-MONTH        PIC 99.
   380             20  SLASH2-1              PIC X.
   381             20  DC-EDIT2-DAY          PIC 99.
   382             20  SLASH2-2              PIC X.
   383             20  DC-EDIT2-YEAR         PIC 99.
   384         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   385         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   386                     DC-GREG-DATE-1-YMD.
   387             20  DC-YMD-YEAR           PIC 99.
   388             20  DC-YMD-MONTH          PIC 99.
   389             20  DC-YMD-DAY            PIC 99.
   390         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   391         16  DC-GREG-DATE-1-MDY-R REDEFINES
   392                      DC-GREG-DATE-1-MDY.
   393             20  DC-MDY-MONTH          PIC 99.
   394             20  DC-MDY-DAY            PIC 99.
   395             20  DC-MDY-YEAR           PIC 99.
   396         16  DC-GREG-DATE-1-ALPHA.
   397             20  DC-ALPHA-MONTH        PIC X(10).
   398             20  DC-ALPHA-DAY          PIC 99.
   399             20  FILLER                PIC XX.
   400             20  DC-ALPHA-CENTURY.
   401                 24 DC-ALPHA-CEN-N     PIC 99.
   402             20  DC-ALPHA-YEAR         PIC 99.
   403         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   404         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   405         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   406         16  DC-JULIAN-DATE            PIC 9(05).
   407         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* ELRFND.cbl
   408                                       PIC 9(05).
   409         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   410             20  DC-JULIAN-YEAR        PIC 99.
   411             20  DC-JULIAN-DAYS        PIC 999.
   412         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   413         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   414         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   415     12  DATE-CONVERSION-VARIBLES.
   416         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   417         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   418             20  FILLER                PIC 9(3).
   419             20  HOLD-CEN-1-CCYY.
   420                 24  HOLD-CEN-1-CC     PIC 99.
   421                 24  HOLD-CEN-1-YY     PIC 99.
   422             20  HOLD-CEN-1-MO         PIC 99.
   423             20  HOLD-CEN-1-DA         PIC 99.
   424         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   425             20  HOLD-CEN-1-R-MO       PIC 99.
   426             20  HOLD-CEN-1-R-DA       PIC 99.
   427             20  HOLD-CEN-1-R-CCYY.
   428                 24  HOLD-CEN-1-R-CC   PIC 99.
   429                 24  HOLD-CEN-1-R-YY   PIC 99.
   430             20  FILLER                PIC 9(3).
   431         16  HOLD-CENTURY-1-X.
   432             20  FILLER                PIC X(3)  VALUE SPACES.
   433             20  HOLD-CEN-1-X-CCYY.
   434                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   435                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   436             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   437             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   438         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   439             20  HOLD-CEN-1-R-X-MO     PIC XX.
   440             20  HOLD-CEN-1-R-X-DA     PIC XX.
   441             20  HOLD-CEN-1-R-X-CCYY.
   442                 24  HOLD-CEN-1-R-X-CC PIC XX.
   443                 24  HOLD-CEN-1-R-X-YY PIC XX.
   444             20  FILLER                PIC XXX.
   445         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   446         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   447         16  DC-JULIAN-DATE-1          PIC 9(07).
   448         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   449             20  DC-JULIAN-1-CCYY.
   450                 24  DC-JULIAN-1-CC    PIC 99.
   451                 24  DC-JULIAN-1-YR    PIC 99.
   452             20  DC-JULIAN-DA-1        PIC 999.
   453         16  DC-JULIAN-DATE-2          PIC 9(07).
   454         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   455             20  DC-JULIAN-2-CCYY.
   456                 24  DC-JULIAN-2-CC    PIC 99.
   457                 24  DC-JULIAN-2-YR    PIC 99.
   458             20  DC-JULIAN-DA-2        PIC 999.
   459         16  DC-GREG-DATE-A-EDIT.
   460             20  DC-EDITA-MONTH        PIC 99.
   461             20  SLASHA-1              PIC X VALUE '/'.
   462             20  DC-EDITA-DAY          PIC 99.
   463             20  SLASHA-2              PIC X VALUE '/'.
   464             20  DC-EDITA-CCYY.
   465                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* ELRFND.cbl
   466                 24  DC-EDITA-YEAR     PIC 99.
   467         16  DC-GREG-DATE-B-EDIT.
   468             20  DC-EDITB-MONTH        PIC 99.
   469             20  SLASHB-1              PIC X VALUE '/'.
   470             20  DC-EDITB-DAY          PIC 99.
   471             20  SLASHB-2              PIC X VALUE '/'.
   472             20  DC-EDITB-CCYY.
   473                 24  DC-EDITB-CENT     PIC 99.
   474                 24  DC-EDITB-YEAR     PIC 99.
   475         16  DC-GREG-DATE-CYMD         PIC 9(08).
   476         16  DC-GREG-DATE-CYMD-R REDEFINES
   477                              DC-GREG-DATE-CYMD.
   478             20  DC-CYMD-CEN           PIC 99.
   479             20  DC-CYMD-YEAR          PIC 99.
   480             20  DC-CYMD-MONTH         PIC 99.
   481             20  DC-CYMD-DAY           PIC 99.
   482         16  DC-GREG-DATE-MDCY         PIC 9(08).
   483         16  DC-GREG-DATE-MDCY-R REDEFINES
   484                              DC-GREG-DATE-MDCY.
   485             20  DC-MDCY-MONTH         PIC 99.
   486             20  DC-MDCY-DAY           PIC 99.
   487             20  DC-MDCY-CEN           PIC 99.
   488             20  DC-MDCY-YEAR          PIC 99.
   489    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   490        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   491    12  DC-EL310-DATE                  PIC X(21).
   492    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* ELRFND.cbl
   494*                        COPY ELCCALC.
   495******************************************************************
   496*                                                                *
   497*                           ELCCALC.                            *
   498*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   499*                            VMOD=2.025                          *
   500*                                                                *
   501*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   502*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   503*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   504*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   505*                                                                *
   506*  PASSED TO ELRTRM                                              *
   507*  -----------------                                             *
   508*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   509*  ORIGINAL TERM                                                 *
   510*  BEGINNING DATE                                                *
   511*  ENDING DATE                                                   *
   512*  COMPANY I.D.                                                  *
   513*  ACCOUNT MASTER USER FIELD                                     *
   514*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   515*  FREE LOOK DAYS                                                *
   516*                                                                *
   517*  RETURNED FROM ELRTRM                                          *
   518*  ---------------------                                         *
   519*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   520*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   521*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   522*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   523*----------------------------------------------------------------*
   524*  PASSED TO ELRAMT                                              *
   525*  ----------------                                              *
   526*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   527*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   528*  ORIGINAL AMOUNT                                               *
   529*  ALTERNATE BENEFIT (BALLON)                                    *
   530*  A.P.R. - NET PAY ONLY                                         *
   531*  METHOD
   532*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   533*  COMPANY I.D.                                                  *
   534*  BENEFIT TYPE                                                  *
   535*                                                                *
   536*  RETURNED FROM ELRAMT                                          *
   537*  --------------------                                          *
   538*  REMAINING AMOUNT 1 - CURRENT                                  *
   539*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   540*  REMAINING AMOUNT FACTOR
   541*----------------------------------------------------------------*
   542*  PASSED TO ELRESV                                              *
   543*  -----------------                                             *
   544*  CERTIFICATE EFFECTIVE DATE                                    *
   545*  VALUATION DATE                                                *
   546*  PAID THRU DATE                                                *
   547*  BENEFIT                                                       *
   548*  INCURRED DATE                                                 *
   549*  REPORTED DATE                                                 *
   550*  ISSUE AGE                                                     *
   551*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* ELRFND.cbl
   552*  CDT PERCENT                                                   *
   553*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   554* *CLAIM TYPE (LIFE, A/H)                                        *
   555* *REMAINING BENEFIT (FROM ELRAMT)                               *
   556* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   557*                                                                *
   558*  RETURNED FROM ELRESV                                          *
   559*  --------------------                                          *
   560*  CDT TABLE USED                                                *
   561*  CDT FACTOR USED                                               *
   562*  PAY TO CURRENT RESERVE                                        *
   563*  I.B.N.R. - A/H ONLY                                           *
   564*  FUTURE (ACCRUED) AH ONLY                                      *
   565*----------------------------------------------------------------*
   566*  PASSED TO ELRATE                                              *
   567*  ----------------                                              *
   568*  CERT ISSUE DATE                                               *
   569*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   570*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   571*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   572*  STATE CODE (CLIENT DEFINED)                                   *
   573*  STATE CODE (STANDARD P.O. ABBRV)                              *
   574*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   575*  DEVIATION CODE                                                *
   576*  ISSUE AGE                                                     *
   577*  ORIGINAL BENEFIT AMOUNT                                       *
   578*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   579*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   580*  BENEFIT KIND (LIFE OR A/H)                                    *
   581*  A.P.R.                                                        *
   582*  METHOD
   583*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   584*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   585*  COMPANY I.D. (3 CHARACTER)                                    *
   586*  BENEFIT CODE                                                  *
   587*  BENEFIT OVERRIDE CODE                                         *
   588*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   589*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   590*  JOINT INDICATOR (CSL ONLY)                                    *
   591*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   592*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   593*                                                                *
   594*  RETURNED FROM ELRATE                                          *
   595*  --------------------                                          *
   596*  CALCULATED PREMIUM                                            *
   597*  PREMIUM RATE                                                  *
   598*  MORTALITY CODE                                                *
   599*  MAX ATTAINED AGE                                              *
   600*  MAX AGE                                                       *
   601*  MAX TERM                                                      *
   602*  MAX MONTHLY BENEFIT                                           *
   603*  MAX TOTAL BENIFIT                                             *
   604*  COMPOSITE RATE (OPEN-END ONLY)                                *
   605*----------------------------------------------------------------*
   606*  PASSED TO ELRFND                                              *
   607*  ----------------                                              *
   608*  CERT ISSUE DATE                                               *
   609*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* ELRFND.cbl
   610*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   611*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   612*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   613*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   614*  STATE CODE (CLIENT DEFINED)                                   *
   615*  STATE CODE (STANDARD P.O. ABBRV)                              *
   616*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   617*  DEVIATION CODE                                                *
   618*  ISSUE AGE                                                     *
   619*  ORIGINAL BENEFIT AMOUNT                                       *
   620*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   621*  PROCESS TYPE (CANCEL)                                         *
   622*  BENEFIT KIND (LIFE OR A/H)                                    *
   623*  A.P.R.                                                        *
   624*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   625*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   626*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   627*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   628*  COMPANY I.D. (3 CHARACTER)                                    *
   629*  BENEFIT CODE                                                  *
   630*  BENEFIT OVERRIDE CODE                                         *
   631*                                                                *
   632*  RETURNED FROM ELRFND                                          *
   633*  --------------------                                          *
   634*  CALCULATED REFUND                                             *
   635*----------------------------------------------------------------*
   636*  PASSED TO ELEARN                                              *
   637*  ----------------                                              *
   638*  CERT ISSUE DATE                                               *
   639*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   640*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   641*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   642*  STATE CODE (CLIENT DEFINED)                                   *
   643*  STATE CODE (STANDARD P.O. ABBRV)                              *
   644*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   645*  DEVIATION CODE                                                *
   646*  ISSUE AGE                                                     *
   647*  ORIGINAL BENEFIT AMOUNT                                       *
   648*  BENEFIT KIND (LIFE OR A/H)                                    *
   649*  A.P.R.                                                        *
   650*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   651*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   652*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   653*  COMPANY I.D. (3 CHARACTER)                                    *
   654*  BENEFIT CODE                                                  *
   655*  BENEFIT OVERRIDE CODE                                         *
   656*                                                                *
   657*  RETURNED FROM ELEARN                                          *
   658*  --------------------                                          *
   659*  INDICATED  EARNINGS                                           *
   660*----------------------------------------------------------------*
   661*                 LENGTH = 450                                   *
   662*                                                                *
   663******************************************************************
   664******************************************************************
   665*                   C H A N G E   L O G
   666*
   667* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* ELRFND.cbl
   668*-----------------------------------------------------------------
   669*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   670* EFFECTIVE    NUMBER
   671*-----------------------------------------------------------------
   672* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   673* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   674* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   675* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   676* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   677* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   678* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   679* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   680* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   681******************************************************************
   682
   683 01  CALCULATION-PASS-AREA.
   684     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   685                                     COMP.
   686
   687     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   688       88  NO-CP-ERROR                             VALUE ZERO.
   689       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   690                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   691       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   692       88  CP-ERROR-IN-DATES                       VALUE '2'.
   693       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   694       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   695       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   696       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   697       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   698       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   699       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   700       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   701       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   702       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   703       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   704       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   705       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   706       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   707       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   708
   709     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   710       88  NO-CP-ERROR-2                           VALUE ZERO.
   711***********************  INPUT AREAS ****************************
   712
   713     12  CP-CALCULATION-AREA.
   714         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   715         16  CP-CERT-EFF-DT        PIC XX.
   716         16  CP-VALUATION-DT       PIC XX.
   717         16  CP-PAID-THRU-DT       PIC XX.
   718         16  CP-BENEFIT-TYPE       PIC X.
   719           88  CP-AH                               VALUE 'A' 'D'
   720                                                   'I' 'U'.
   721           88  CP-REDUCING-LIFE                    VALUE 'R'.
   722           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   723         16  CP-INCURRED-DT        PIC XX.
   724         16  CP-REPORTED-DT        PIC XX.
   725         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* ELRFND.cbl
   726         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   727         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   728                                     COMP-3.
   729         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   730                                     COMP-3.
   731         16  CP-CDT-METHOD         PIC X.
   732           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   733           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   734           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   735         16  CP-CLAIM-TYPE         PIC X.
   736           88  CP-AH-CLAIM                         VALUE 'A'.
   737           88  CP-LIFE-CLAIM                       VALUE 'L'.
   738         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   739                                     COMP-3.
   740         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   741                                     COMP-3.
   742         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   743                                     COMP-3.
   744         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   745                                     COMP-3.
   746         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   747                                     COMP-3.
   748         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   749                                     COMP-3.
   750         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   751                                     COMP-3.
   752         16  CP-REM-TERM-METHOD    PIC X.
   753           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   754           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   755           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   756           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   757           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   758           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   759           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   760         16  CP-EARNING-METHOD     PIC X.
   761           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   762           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   763           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   764           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   765           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   766           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   767           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   768           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   769           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   770           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   771           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   772           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   773           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   774           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   775         16  CP-PROCESS-TYPE       PIC X.
   776           88  CP-CLAIM                            VALUE '1'.
   777           88  CP-CANCEL                           VALUE '2'.
   778           88  CP-ISSUE                            VALUE '3'.
   779         16  CP-SPECIAL-CALC-CD    PIC X.
   780           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   781           88  CP-1-MTH-INTEREST               VALUE ' '.
   782           88  CP-0-MTH-INTEREST               VALUE 'A'.
   783           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* ELRFND.cbl
   784           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   785           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   786           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   787           88  CP-FARM-PLAN                    VALUE 'F'.
   788           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   789           88  CP-2-MTH-INTEREST               VALUE 'I'.
   790           88  CP-3-MTH-INTEREST               VALUE 'J'.
   791           88  CP-4-MTH-INTEREST               VALUE 'K'.
   792           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   793           88  CP-MORTGAGE-REC                 VALUE 'M'.
   794           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   795           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   796           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   797           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   798                                                     'W' 'X'.
   799           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   800           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   801           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   802           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   803           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   804           88  CP-SUMMARY-REC                  VALUE 'Z'.
   805           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   806           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   807           88  CP-AD-D-BENEFIT                 VALUE '4'.
   808           88  CP-CSL-METH-1                   VALUE '5'.
   809           88  CP-CSL-METH-2                   VALUE '6'.
   810           88  CP-CSL-METH-3                   VALUE '7'.
   811           88  CP-CSL-METH-4                   VALUE '8'.
   812
   813         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   814                                     COMP-3.
   815         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   816         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   817         16  CP-STATE              PIC XX          VALUE SPACE.
   818         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   819         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   820           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   821               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   822         16  CP-R78-OPTION         PIC X.
   823           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   824           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   825
   826         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   827         16  CP-IBNR-RESERVE-SW    PIC X.
   828         16  CP-CLAIM-STATUS       PIC X.
   829         16  CP-RATE-FILE          PIC X.
   830         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   831                                     COMP-3.
   832
   833         16  CP-LIFE-OVERRIDE-CODE PIC X.
   834         16  CP-AH-OVERRIDE-CODE   PIC X.
   835
   836         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   837                                     COMP-3.
   838         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   839                                   PIC S9(5)V99 COMP-3.
   840         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   841                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* ELRFND.cbl
   842         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   843                                     COMP-3.
   844         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   845                                     COMP-3.
   846         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   847                                  PIC S9(7)V99 COMP-3.
   848
   849         16  CP-PAID-FROM-DATE     PIC X(02).
   850         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   851         16  CP-EXT-DAYS-CALC      PIC X.
   852           88  CP-EXT-NO-CHG                   VALUE ' '.
   853           88  CP-EXT-CHG-LF                   VALUE '1'.
   854           88  CP-EXT-CHG-AH                   VALUE '2'.
   855           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   856         16  CP-DOMICILE-STATE     PIC XX.
   857         16  CP-CARRIER            PIC X.
   858         16  CP-REIN-FLAG          PIC X.
   859         16  CP-REM-TRM-CALC-OPTION PIC X.
   860           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   861                      '2' '3' '4' '5'.
   862           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   863           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   864           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   865           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   866           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   867           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   868           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   869           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   870         16  CP-SIG-SWITCH         PIC X.
   871         16  CP-RATING-METHOD      PIC X.
   872           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   873           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   874           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   875           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   876           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   877           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   878           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   879           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   880           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   881         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   882                                     COMP-3.
   883         16  CP-BEN-CATEGORY       PIC X.
   884         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   885         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   886                                   PIC S99V9(5) COMP-3.
   887         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   888         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   889                                   PIC S99V9(5) COMP-3.
   890         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   891         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   892         16  CP-EXPIRE-DT          PIC XX.
   893         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   894         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   895         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   896         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   897         16  CP-DDF-SPEC-CALC      PIC X.
   898             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   899             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* ELRFND.cbl
   900         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   901         16  CP-CANCEL-REASON      PIC X.
   902         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   903         16  CP-PMT-MODE           PIC X.
   904         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   905         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   906         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   907         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   908         16  FILLER                PIC X.
   909
   910***************    OUTPUT FROM ELRESV   ************************
   911
   912         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   913
   914         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   915                                     COMP-3.
   916         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   917                                     COMP-3.
   918         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   919                                     COMP-3.
   920         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   921                                     COMP-3.
   922         16  FILLER                PIC X(09).
   923***************    OUTPUT FROM ELRTRM   *************************
   924
   925         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   926                                     COMP-3.
   927         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   928                                     COMP-3.
   929         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   930                                     COMP-3.
   931         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   932                                     COMP-3.
   933         16  FILLER                PIC X(12).
   934
   935***************    OUTPUT FROM ELRAMT   *************************
   936
   937         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   938                                     COMP-3.
   939         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   940                                     COMP-3.
   941         16  FILLER                PIC X(12).
   942
   943***************    OUTPUT FROM ELRATE   *************************
   944
   945         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   946                                     COMP-3.
   947         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   948                                     COMP-3.
   949         16  CP-MORTALITY-CODE     PIC X(4).
   950         16  CP-RATE-EDIT-FLAG     PIC X.
   951             88  CP-RATES-NEED-APR                  VALUE '1'.
   952         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   953                                     COMP-3.
   954         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   955         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   956         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   957                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* ELRFND.cbl
   958         16  FILLER                PIC X(07).
   959
   960***************    OUTPUT FROM ELRFND   *************************
   961
   962         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   963                                     COMP-3.
   964         16  CP-REFUND-TYPE-USED   PIC X.
   965           88  CP-R-AS-R78                         VALUE '1'.
   966           88  CP-R-AS-PRORATA                     VALUE '2'.
   967           88  CP-R-AS-CALIF                       VALUE '3'.
   968           88  CP-R-AS-TEXAS                       VALUE '4'.
   969           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   970           88  CP-R-AS-NET-PAY                     VALUE '5'.
   971           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   972           88  CP-R-AS-MEAN                        VALUE '8'.
   973           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   974           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   975           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   976           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   977           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   978           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   979         16  FILLER                PIC X(12).
   980
   981***************    OUTPUT FROM ELEARN   *************************
   982
   983         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   984                                     COMP-3.
   985         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   986                                     COMP-3.
   987         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   988                                     COMP-3.
   989         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   990                                     COMP-3.
   991         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   992                                     COMP-3.
   993         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   994                                     COMP-3.
   995         16  CP-EARNING-TYPE-USED  PIC X.
   996           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   997           88  CP-E-AS-R78                         VALUE '1'.
   998           88  CP-E-AS-PRORATA                     VALUE '2'.
   999           88  CP-E-AS-TEXAS                       VALUE '4'.
  1000           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1001           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1002           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1003           88  CP-E-AS-MEAN                        VALUE '8'.
  1004           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1005         16  FILLER                PIC X(12).
  1006
  1007***************    OUTPUT FROM ELPMNT   *************************
  1008
  1009         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1010                                     COMP-3.
  1011         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1012                                     COMP-3.
  1013         16  FILLER                PIC X(12).
  1014
  1015***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* ELRFND.cbl
  1016         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1017                                     COMP-3.
  1018         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1019                                     COMP-3.
  1020         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1021                                     COMP-3.
  1022         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1023                                     COMP-3.
  1024         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1025                                     COMP-3.
  1026         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1027                                     COMP-3.
  1028         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1029             88  OPEN-RATE-FILE                   VALUE 'O'.
  1030             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1031             88  IO-ERROR                         VALUE 'E'.
  1032
  1033         16  CP-FIRST-PAY-DATE     PIC XX.
  1034
  1035         16  CP-JOINT-INDICATOR    PIC X.
  1036
  1037         16  CP-RESERVE-REMAINING-TERM
  1038                                   PIC S9(4)V9    VALUE ZERO
  1039                                     COMP-3.
  1040
  1041         16  CP-INSURED-BIRTH-DT   PIC XX.
  1042
  1043         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1044                                     COMP-3.
  1045
  1046         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1047                                     COMP-3.
  1048
  1049         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1050                                     COMP-3.
  1051
  1052         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1053                                     COMP-3.
  1054
  1055         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1056                                     COMP-3.
  1057
  1058         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1059                                     COMP-3.
  1060
  1061         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1062                                     COMP-3.
  1063
  1064         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1065             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1066
  1067         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1068                                     COMP-3.
  1069         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1070                                     COMP-3.
  1071         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1072         16  FILLER                PIC X(15).
  1073******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* ELRFND.cbl
  1074
  1075
  1076****************************************************************
  1077*
  1078* Copyright (c) 2007 by Clerity Solutions, Inc.
  1079* All rights reserved.
  1080*
  1081****************************************************************
  1082 01  DFHEIV.
  1083   02  DFHEIV0               PIC X(35).
  1084   02  DFHEIV1               PIC X(08).
  1085   02  DFHEIV2               PIC X(08).
  1086   02  DFHEIV3               PIC X(08).
  1087   02  DFHEIV4               PIC X(06).
  1088   02  DFHEIV5               PIC X(04).
  1089   02  DFHEIV6               PIC X(04).
  1090   02  DFHEIV7               PIC X(02).
  1091   02  DFHEIV8               PIC X(02).
  1092   02  DFHEIV9               PIC X(01).
  1093   02  DFHEIV10              PIC S9(7) COMP-3.
  1094   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1095   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1096   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1097   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1098   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1099   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1100   02  DFHEIV17              PIC X(04).
  1101   02  DFHEIV18              PIC X(04).
  1102   02  DFHEIV19              PIC X(04).
  1103   02  DFHEIV20              USAGE IS POINTER.
  1104   02  DFHEIV21              USAGE IS POINTER.
  1105   02  DFHEIV22              USAGE IS POINTER.
  1106   02  DFHEIV23              USAGE IS POINTER.
  1107   02  DFHEIV24              USAGE IS POINTER.
  1108   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1109   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1110   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1111   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1112   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1113   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1114   02  FILLER                PIC X(02).
  1115   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1116   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1117   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1118   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1119   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1120 LINKAGE  SECTION.
  1121*****************************************************************
  1122*                                                               *
  1123* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1124* All rights reserved.                                          *
  1125*                                                               *
  1126*****************************************************************
  1127 01  dfheiblk.
  1128     02  eibtime          pic s9(7) comp-3.
  1129     02  eibdate          pic s9(7) comp-3.
  1130     02  eibtrnid         pic x(4).
  1131     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* ELRFND.cbl
  1132     02  eibtrmid         pic x(4).
  1133     02  dfheigdi         pic s9(4) comp.
  1134     02  eibcposn         pic s9(4) comp.
  1135     02  eibcalen         pic s9(4) comp.
  1136     02  eibaid           pic x(1).
  1137     02  eibfiller1       pic x(1).
  1138     02  eibfn            pic x(2).
  1139     02  eibfiller2       pic x(2).
  1140     02  eibrcode         pic x(6).
  1141     02  eibfiller3       pic x(2).
  1142     02  eibds            pic x(8).
  1143     02  eibreqid         pic x(8).
  1144     02  eibrsrce         pic x(8).
  1145     02  eibsync          pic x(1).
  1146     02  eibfree          pic x(1).
  1147     02  eibrecv          pic x(1).
  1148     02  eibsend          pic x(1).
  1149     02  eibatt           pic x(1).
  1150     02  eibeoc           pic x(1).
  1151     02  eibfmh           pic x(1).
  1152     02  eibcompl         pic x(1).
  1153     02  eibsig           pic x(1).
  1154     02  eibconf          pic x(1).
  1155     02  eiberr           pic x(1).
  1156     02  eibrldbk         pic x(1).
  1157     02  eiberrcd         pic x(4).
  1158     02  eibsynrb         pic x(1).
  1159     02  eibnodat         pic x(1).
  1160     02  eibfiller5       pic x(2).
  1161     02  eibresp          pic 9(09) comp.
  1162     02  eibresp2         pic 9(09) comp.
  1163     02  dfheigdj         pic s9(4) comp.
  1164     02  dfheigdk         pic s9(4) comp.
  1165 01  DFHCOMMAREA                PIC X(450).
  1166
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* ELRFND.cbl
  1168 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1169 0000-DFHEXIT SECTION.
  1170     MOVE '9#                    $   ' TO DFHEIV0.
  1171     MOVE 'ELRFND' TO DFHEIV1.
  1172     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1173     MOVE DFHCOMMAREA    TO  CALCULATION-PASS-AREA.
  1174
  1175 000-START-REFUND-CALC.
  1176*                      COPY ELCRFNDP.
  1177****************************************************************
  1178*                                                              *
  1179*                            ELCRFNDP.                         *
  1180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1181*                            VMOD=2.028                        *
  1182*                                                              *
  1183****************************************************************.
  1184*                   C H A N G E   L O G
  1185*
  1186* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1187*-----------------------------------------------------------------
  1188*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1189* EFFECTIVE    NUMBER
  1190*-----------------------------------------------------------------
  1191* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1192* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1193* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1194* 110609  CR2009092300002  PEMA CHANGE MN REFUNDS
  1195* 000000  CR2008042200001  PEMA ADD 0 APR PROCESSING
  1196* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  1197* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1198* 032612  CR2011110200001  PEMA AHL CHANGES
  1199******************************************************************
  1200
  1201     MOVE ZERO                   TO  CP-RETURN-CODE
  1202                                     CP-CALC-REFUND.
  1203     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1204
  1205 0001-GET-CANCEL-TYPE.
  1206     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1207        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1208        GO TO 1999-CALC-REF-AMT-X.
  1209
  1210     IF CP-CANCEL-REASON = 'R'
  1211        IF CP-CALC-CLP
  1212           MOVE CP-ORIGINAL-PREMIUM
  1213                                 TO CP-CALC-REFUND
  1214        ELSE
  1215           COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM -
  1216              CP-DDF-ADMIN-FEES
  1217        END-IF
  1218        MOVE 'R'                 TO CP-REFUND-TYPE-USED
  1219        GO TO 1999-CALC-REF-AMT-X
  1220     END-IF
  1221     IF CP-REMAINING-TERM = ZERO   OR
  1222        CP-REMAINING-TERM NEGATIVE
  1223          MOVE ZERO TO CP-CALC-REFUND
  1224          GO TO 1999-CALC-REF-AMT-X.
  1225
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* ELRFND.cbl
  1226     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1227     MOVE SPACE              TO DC-OPTION-CODE.
  1228     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1229
  1230     IF DATE-CONVERSION-ERROR
  1231         MOVE '2' TO CP-RETURN-CODE
  1232         GO TO 1999-CALC-REF-AMT-X.
  1233
  1234     IF CP-AH
  1235        GO TO 1030-GET-AH-REFUND.
  1236
  1237********************    LIFE REFUNDS    **************************
  1238
  1239     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1240         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1241
  1242     IF CP-LOAN-TERM NOT NUMERIC
  1243         MOVE +0                TO CP-LOAN-TERM.
  1244
  1245     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1246
  1247     COMPUTE R78-FACTOR =
  1248            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1249              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1250************************************************************
  1251***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1252***---------------------------------------------------------
  1253     IF CP-TRUNCATED-LIFE
  1254        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1255     ELSE
  1256        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1257***
  1258************************************************************
  1259**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1260**** FOLLOWING.
  1261****       FOR NC. LIFE..
  1262****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1263****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1264****                             TERM <= 60 USE SUM OF DIGITS.
  1265****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1266****                             TERM > 60 USE RULE OF ANTIC
  1267****                             OTHERWISE USE RULE OF 78.
  1268****
  1269****
  1270
  1271     IF (CP-COMPANY-ID = 'NCL') AND
  1272        (CP-STATE-STD-ABBRV = 'NC')
  1273        IF CP-LEVEL-LIFE
  1274           GO TO 1023-REF-PR
  1275        ELSE
  1276        IF CP-EARN-AS-NET-PAY AND
  1277           CP-TRUNCATED-LIFE
  1278           IF CP-ORIGINAL-TERM GREATER THAN 60
  1279              GO TO 1021-ANTICIPATION-REF
  1280           ELSE
  1281              GO TO 1026-REF-R78
  1282        ELSE
  1283        IF CP-REDUCING-LIFE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* ELRFND.cbl
  1284           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
  1285              CP-ORIGINAL-TERM GREATER THAN 60)
  1286              GO TO 1021-ANTICIPATION-REF
  1287           ELSE
  1288              GO TO 1075-SUM-OF-DIGITS.
  1289
  1290****
  1291**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1292**** FOLLOWING.
  1293****       FOR OH. LIFE..
  1294****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1295****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1296****  GROSS DECREASING       --- RULE OF 78
  1297****
  1298****
  1299
  1300     IF (CP-COMPANY-ID = 'CID') AND
  1301        (CP-STATE-STD-ABBRV = 'OH') AND
  1302        (CP-CLASS-CODE NOT = 'L ')
  1303        IF CP-LEVEL-LIFE
  1304           GO TO 1023-REF-PR
  1305        ELSE
  1306           IF (CP-ORIGINAL-TERM > 60) OR
  1307              (CP-EARN-AS-NET-PAY)
  1308              GO TO 1028-NET-PAY-REFUND
  1309           ELSE
  1310              GO TO 1026-REF-R78
  1311           END-IF
  1312        END-IF
  1313     END-IF
  1314
  1315**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1316**** FOLLOWING.
  1317****       FOR VA. LIFE..
  1318****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1319****           NET COVERAGES --- USE RULE OF ANTIC.
  1320****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1321****                         --- EFF DATE > 123194 USE ANTIC.
  1322****                         --- EFF DATE BETWEEN 010193 AND 12319
  1323****                             WITH TERM > 61 USE RULE OF ANTIC
  1324****                             OTHERWISE USE RULE OF 78.
  1325****
  1326****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1327****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1328****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1329****            WILL FOLLOW.
  1330****
  1331****
  1332****
  1333
  1334     IF (CP-COMPANY-ID = 'NCL') AND
  1335        (CP-STATE-STD-ABBRV = 'VA')
  1336        IF CP-LEVEL-LIFE
  1337           GO TO 1023-REF-PR
  1338        ELSE
  1339        IF CP-EARN-AS-NET-PAY
  1340           GO TO 1021-ANTICIPATION-REF
  1341        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* ELRFND.cbl
  1342        IF CP-REDUCING-LIFE
  1343           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1344              GO TO 1026-REF-R78
  1345           ELSE
  1346           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1347              GO TO 1021-ANTICIPATION-REF
  1348           ELSE
  1349           IF CP-ORIGINAL-TERM GREATER THAN 61
  1350              GO TO 1021-ANTICIPATION-REF
  1351           ELSE
  1352              GO TO 1026-REF-R78.
  1353
  1354     IF (CP-COMPANY-ID = 'CID')
  1355        AND (CP-STATE-STD-ABBRV = 'IN')
  1356        AND (DC-GREG-DATE-CYMD < 20030401)
  1357        IF CP-REDUCING-LIFE
  1358           GO TO 1026-REF-R78
  1359        ELSE
  1360           IF CP-LEVEL-LIFE
  1361              GO TO 1023-REF-PR
  1362           END-IF
  1363        END-IF
  1364     END-IF
  1365
  1366     IF (CP-COMPANY-ID = 'CID')
  1367        AND (CP-STATE-STD-ABBRV = 'FL')
  1368        AND (DC-GREG-DATE-CYMD > 20030630)
  1369        IF CP-RATE-AS-NET-PAY
  1370           GO TO 1028-NET-PAY-REFUND
  1371        END-IF
  1372     END-IF
  1373
  1374     IF (CP-COMPANY-ID = 'CID')
  1375        AND (CP-STATE-STD-ABBRV = 'MN')
  1376        AND (CP-EARN-AS-NET-PAY)
  1377        AND (CP-RATE-AS-REG-BALLOON)
  1378        AND (DC-GREG-DATE-CYMD > 20091231)
  1379        GO TO 1028-NET-PAY-REFUND
  1380     END-IF
  1381     IF (CP-COMPANY-ID = 'CID')
  1382        AND (CP-STATE-STD-ABBRV = 'MN')
  1383        AND (DC-GREG-DATE-CYMD > 20091231)
  1384        AND (CP-RATE-AS-NET-PAY)
  1385        GO TO 1021-ANTICIPATION-REF
  1386     END-IF
  1387     IF (CP-COMPANY-ID = 'CID')
  1388        AND (CP-STATE-STD-ABBRV = 'MO')
  1389        AND (DC-GREG-DATE-CYMD > 20030630)
  1390        AND (CP-LOAN-TERM < +121)
  1391        IF CP-RATE-AS-NET-PAY
  1392           GO TO 1028-NET-PAY-REFUND
  1393        END-IF
  1394     END-IF
  1395
  1396     IF (CP-COMPANY-ID = 'CID')
  1397        AND (CP-STATE-STD-ABBRV = 'ND')
  1398        AND (DC-GREG-DATE-CYMD > 20011231)
  1399        AND (CP-REDUCING-LIFE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* ELRFND.cbl
  1400        GO TO 1021-ANTICIPATION-REF
  1401     END-IF
  1402
  1403     IF CP-CRITICAL-PERIOD
  1404        IF CP-COMPANY-ID = 'NCL'
  1405           NEXT SENTENCE
  1406        ELSE
  1407           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1408
  1409     IF CP-TERM-IS-DAYS  AND
  1410        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1411         GO TO 1024-REF-PR-DAYS.
  1412
  1413     IF CP-STATE-STD-ABBRV = 'NM'
  1414       IF CP-REDUCING-LIFE
  1415*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1416         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1417             GO TO 1026-REF-R78.
  1418
  1419     IF CP-EARN-ANTICIPATION
  1420         GO TO 1021-ANTICIPATION-REF.
  1421
  1422     IF CP-STATE-STD-ABBRV = 'ME'
  1423         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1424            NEXT SENTENCE
  1425         ELSE
  1426            IF CP-REDUCING-LIFE
  1427               GO TO 1021-ANTICIPATION-REF.
  1428
  1429     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1430        IF CP-STATE-STD-ABBRV = 'TX'
  1431            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1432        END-IF
  1433     END-IF.
  1434
  1435     IF CP-STATE-STD-ABBRV = 'TX'
  1436       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1437          NEXT SENTENCE
  1438       END-IF
  1439        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1440           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1441           GO TO 1021-ANTICIPATION-REF.
  1442
  1443 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1444
  1445     IF CP-EARN-BY-PRORATA
  1446         GO TO 1023-REF-PR.
  1447
  1448     IF CP-EARN-AS-MEAN
  1449         GO TO 1025-REF-MEAN.
  1450
  1451     IF CP-EARN-AS-TEXAS
  1452         GO TO 1027-TEXAS-REFUND.
  1453
  1454     IF CP-EARN-AS-NET-PAY
  1455         GO TO 1028-NET-PAY-REFUND.
  1456
  1457     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* ELRFND.cbl
  1458         GO TO 1000-NO-NET-PAY.
  1459
  1460     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1461       IF CP-STATE-STD-ABBRV = 'NC'
  1462         IF CP-REDUCING-LIFE
  1463           IF CP-ORIGINAL-TERM GREATER 60  AND
  1464              DC-GREG-DATE-CYMD GREATER 19810930
  1465                GO TO 1028-NET-PAY-REFUND
  1466           ELSE
  1467              GO TO 1026-REF-R78.
  1468
  1469
  1470     IF CP-STATE-STD-ABBRV = 'NC'
  1471       IF CP-COMPANY-ID EQUAL 'NCL'
  1472          NEXT SENTENCE
  1473       END-IF
  1474       IF CP-REDUCING-LIFE
  1475         IF CP-ORIGINAL-TERM GREATER 60  AND
  1476            DC-GREG-DATE-CYMD GREATER 19810930
  1477             GO TO 1021-ANTICIPATION-REF
  1478         ELSE
  1479             GO TO 1026-REF-R78.
  1480
  1481     IF CP-STATE-STD-ABBRV = 'UT'
  1482       IF CP-COMPANY-ID EQUAL 'NCL'
  1483          NEXT SENTENCE
  1484       END-IF
  1485         IF CP-ORIGINAL-TERM GREATER 62         AND
  1486            CP-LOAN-APR GREATER ZERO            AND
  1487            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1488            DC-GREG-DATE-CYMD LESS    19830901
  1489             GO TO 1028-NET-PAY-REFUND
  1490         ELSE
  1491             GO TO 1026-REF-R78.
  1492
  1493     IF CP-STATE-STD-ABBRV = 'OH'
  1494       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1495          NEXT SENTENCE
  1496       END-IF
  1497           IF CP-ORIGINAL-TERM GREATER 60         AND
  1498              CP-CLASS-CODE NOT = 'L '            AND
  1499              CP-LOAN-APR GREATER ZERO            AND
  1500              DC-GREG-DATE-CYMD GREATER 19831031
  1501              GO TO 1028-NET-PAY-REFUND
  1502           ELSE
  1503              GO TO 1026-REF-R78.
  1504
  1505     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1506       IF CP-STATE-STD-ABBRV = 'MT'
  1507         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1508
  1509
  1510     IF CP-STATE-STD-ABBRV = 'MT'
  1511       IF CP-COMPANY-ID EQUAL 'NCL'
  1512          NEXT SENTENCE
  1513       END-IF
  1514         IF CP-ORIGINAL-TERM GREATER 61         AND
  1515            CP-LOAN-APR GREATER ZERO            AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* ELRFND.cbl
  1516            DC-GREG-DATE-CYMD GREATER 19830318
  1517             GO TO 1028-NET-PAY-REFUND
  1518         ELSE
  1519             GO TO 1026-REF-R78.
  1520
  1521 SKIP-CSO-MT-LF-PROCESSING.
  1522
  1523     IF CP-STATE-STD-ABBRV = 'RI'
  1524       IF CP-COMPANY-ID EQUAL 'NCL'
  1525          NEXT SENTENCE
  1526       END-IF
  1527         IF CP-ORIGINAL-TERM GREATER 60         AND
  1528            CP-LOAN-APR GREATER ZERO            AND
  1529            DC-GREG-DATE-CYMD GREATER 19831231
  1530             GO TO 1028-NET-PAY-REFUND
  1531         ELSE
  1532             GO TO 1026-REF-R78.
  1533
  1534
  1535 1000-NO-NET-PAY.
  1536
  1537     IF CP-STATE-STD-ABBRV = 'WY'
  1538       IF CP-COMPANY-ID EQUAL 'NCL'
  1539          NEXT SENTENCE
  1540       END-IF
  1541        IF CP-COMPANY-ID = 'TMS'
  1542           GO TO 1026-REF-R78
  1543        ELSE
  1544           GO TO 1023-REF-PR.
  1545
  1546     IF CP-EARN-BY-R78
  1547         GO TO 1026-REF-R78.
  1548
  1549     IF CP-EARN-AS-SUM-OF-DIGITS
  1550         GO TO 1075-SUM-OF-DIGITS.
  1551
  1552     IF CP-LEVEL-LIFE
  1553         GO TO 1023-REF-PR
  1554     ELSE
  1555         GO TO 1026-REF-R78.
  1556
  1557*-----------------------------------------------------------------
  1558 1021-ANTICIPATION-REF.
  1559     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1560
  1561     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1562     IF CP-LOAN-TERM = ZEROS
  1563        MOVE CP-ORIGINAL-TERM TO CP-LOAN-TERM
  1564     END-IF
  1565     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1566                            CP-REMAINING-TERM.
  1567
  1568     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
  1569     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
  1570     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
  1571
  1572     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
  1573     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* ELRFND.cbl
  1574     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
  1575
  1576     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1577         MOVE 'N'              TO CP-ROA-REFUND
  1578     ELSE
  1579         MOVE 'Y'              TO CP-ROA-REFUND.
  1580
  1581******    TO COMPUTE PREMIUM AT REFUND DATE
  1582     PERFORM 2500-GET-RATE.
  1583
  1584     MOVE 'N'                  TO CP-ROA-REFUND.
  1585     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1586     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1587     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
  1588
  1589     IF CP-PREMIUM-RATE = ZEROS
  1590        MOVE '7'                 TO CP-RETURN-CODE
  1591        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1592        GO TO 1999-CALC-REF-AMT-X.
  1593
  1594     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1595
  1596******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1597     PERFORM 2500-GET-RATE.
  1598
  1599     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1600
  1601     IF CP-PREMIUM-RATE = ZEROS
  1602        MOVE '7'            TO CP-RETURN-CODE
  1603        GO TO 1999-CALC-REF-AMT-X.
  1604
  1605     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1606
  1607     IF  WS-ORIG-PREM = ZEROS
  1608         MOVE ZEROS TO WS-NP-REF-FACTOR
  1609        ELSE
  1610         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1611                                            WS-ORIG-PREM.
  1612
  1613     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1614                                        CP-ORIGINAL-PREMIUM.
  1615
  1616     GO TO 1999-CALC-REF-AMT-X.
  1617
  1618*---------------------------------------------------------------
  1619 1022-REF-CRITICAL-PERIOD-LF.
  1620     GO TO 1023-REF-PR.
  1621
  1622*---------------------------------------------------------------
  1623 1023-REF-PR.
  1624     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1625     COMPUTE CP-CALC-REFUND ROUNDED =
  1626            CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1627
  1628     GO TO 1999-CALC-REF-AMT-X.
  1629
  1630*---------------------------------------------------------------
  1631 1024-REF-PR-DAYS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* ELRFND.cbl
  1632     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1633     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1634     MOVE '1'                TO DC-OPTION-CODE.
  1635     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1636
  1637     IF DATE-CONVERSION-ERROR
  1638         MOVE '2' TO CP-RETURN-CODE
  1639         GO TO 1999-CALC-REF-AMT-X.
  1640
  1641     COMPUTE CP-CALC-REFUND ROUNDED =
  1642         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1643                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1644
  1645     GO TO 1999-CALC-REF-AMT-X.
  1646
  1647*---------------------------------------------------------------
  1648 1025-REF-MEAN.
  1649     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1650     COMPUTE CP-CALC-REFUND ROUNDED =
  1651          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1652           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1653
  1654     GO TO 1999-CALC-REF-AMT-X.
  1655
  1656*---------------------------------------------------------------
  1657 1026-REF-R78.
  1658     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1659*    IF CP-TERM-TIMES-TERM
  1660*        COMPUTE R78-FACTOR =
  1661*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1662*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1663*
  1664     COMPUTE CP-CALC-REFUND ROUNDED =
  1665        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1666
  1667     GO TO 1999-CALC-REF-AMT-X.
  1668
  1669*---------------------------------------------------------------
  1670 1027-TEXAS-REFUND.
  1671     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1672     IF CP-PAY-FREQUENCY = ZERO
  1673        MOVE ZERO TO CP-CALC-REFUND
  1674        MOVE '5'  TO CP-RETURN-CODE
  1675        GO TO 1999-CALC-REF-AMT-X.
  1676
  1677     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1678         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1679
  1680     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1681         GIVING TEX-FACT-5
  1682             REMAINDER TEX-FACT-6.
  1683
  1684     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1685
  1686     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1687         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1688         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1689
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* ELRFND.cbl
  1690     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1691
  1692     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1693                                        * TEX-FACT-8.
  1694
  1695     GO TO 1999-CALC-REF-AMT-X.
  1696
  1697*---------------------------------------------------------------
  1698 1028-NET-PAY-REFUND.
  1699     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1700     IF CP-LOAN-APR = ZERO
  1701        MOVE ZERO TO CP-CALC-REFUND
  1702        MOVE '1'  TO CP-RETURN-CODE
  1703        GO TO 1999-CALC-REF-AMT-X.
  1704
  1705     MOVE CP-LOAN-APR           TO N-P-APR.
  1706     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1707     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1708
  1709     IF CP-TRUNCATED-LIFE
  1710        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1711
  1712     MOVE 'R'                   TO N-P-OPT.
  1713
  1714     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1715
  1716     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1717                                        CP-ORIGINAL-PREMIUM.
  1718
  1719 1029-UTAH-REFUND.
  1720*
  1721*---------------------------------------------------------------
  1722* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1723*---------------------------------------------------------------
  1724*
  1725     GO TO 1999-CALC-REF-AMT-X.
  1726*
  1727*---------------------------------------------------------------
  1728     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1729                      OR
  1730        (CP-COMPANY-ID EQUAL 'NCL')
  1731         GO TO 1999-CALC-REF-AMT-X.
  1732     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1733
  1734     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1735        GREATER ZERO AND LESS 13
  1736         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1737                 (CP-CALC-REFUND * .05).
  1738
  1739     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1740        GREATER 12 AND LESS 25
  1741         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1742                 (CP-CALC-REFUND * .025).
  1743
  1744     GO TO 1999-CALC-REF-AMT-X.
  1745*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* ELRFND.cbl
  1747*---------------------------------------------------------------
  1748 1030-GET-AH-REFUND.
  1749     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1750
  1751     COMPUTE R78-FACTOR =
  1752            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1753                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1754
  1755*    IF CP-TERM-TIMES-TERM
  1756*        COMPUTE R78-FACTOR =
  1757*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1758*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1759*
  1760
  1761**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1762**** FOLLOWING.
  1763****       FOR VA. DISABILITY
  1764****                         --- EFF DATE > 123192 AND
  1765****                             TERM > 61 USE RULE OF ANTIC
  1766****                             OTHERWISE USE RULE OF 78.
  1767****
  1768****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1769****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1770****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1771****            WILL FOLLOW.
  1772****
  1773****
  1774****
  1775     IF CP-COMPANY-ID = 'NCL' or 'AHL'
  1776        IF CP-STATE-STD-ABBRV = 'VA'
  1777           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1778              (CP-ORIGINAL-TERM GREATER THAN 61)
  1779               MOVE '6'        TO CP-EARNING-METHOD
  1780               GO TO 1060-ANTICIPATION-REF
  1781            ELSE
  1782               MOVE '1'        TO CP-EARNING-METHOD
  1783               GO TO 1050-R78-REF.
  1784
  1785     IF CP-STATE-STD-ABBRV = 'WY'
  1786        IF CP-COMPANY-ID = 'TMS'
  1787           GO TO 1050-R78-REF.
  1788
  1789     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC' OR 'AHL'
  1790         NEXT SENTENCE
  1791     ELSE
  1792         IF CP-CRITICAL-PERIOD
  1793             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1794
  1795*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1796*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1797*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1798*    DAY FREE LOOK PERIOD. ALSO, 55 AND 56 ARE THE BIU CODES
  1799     IF (CP-GAP-NON-REFUNDABLE)
  1800        IF (CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM)
  1801           OR (CP-BENEFIT-CD = '55' OR '56')
  1802           MOVE ZEROS            TO CP-CALC-REFUND
  1803           MOVE 'G'              TO CP-REFUND-TYPE-USED
  1804           GO TO 1999-CALC-REF-AMT-X
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* ELRFND.cbl
  1805        END-IF
  1806     END-IF
  1807     IF CP-GAP-ACTUARIAL
  1808         GO TO 1070-NET-PAY-REFUND
  1809     END-IF
  1810     IF (CP-COMPANY-ID = 'CID')
  1811        AND (CP-STATE-STD-ABBRV = 'MN')
  1812        AND (DC-GREG-DATE-CYMD > 20091231)
  1813        IF (CP-CRITICAL-PERIOD)
  1814           GO TO 1040-PR-REF
  1815        ELSE
  1816           GO TO 1055-MEAN-REF
  1817     END-IF
  1818     IF CP-COMPANY-ID EQUAL 'CID' OR 'DCC'
  1819        IF CP-STATE-STD-ABBRV = 'NC'
  1820           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1821
  1822     IF (CP-COMPANY-ID = 'CID')
  1823        AND (CP-STATE-STD-ABBRV = 'IN')
  1824        AND (DC-GREG-DATE-CYMD < 20030401)
  1825        GO TO 1026-REF-R78
  1826     END-IF
  1827
  1828     IF (CP-COMPANY-ID = 'CID')
  1829        AND (CP-STATE-STD-ABBRV = 'FL')
  1830        AND (DC-GREG-DATE-CYMD > 20030630)
  1831        AND (CP-CRITICAL-PERIOD)
  1832        GO TO 1040-PR-REF
  1833     END-IF
  1834
  1835     IF (CP-COMPANY-ID = 'CID')
  1836        AND (CP-STATE-STD-ABBRV = 'MO')
  1837        AND (DC-GREG-DATE-CYMD > 20030630)
  1838        AND (CP-CRITICAL-PERIOD)
  1839        GO TO 1040-PR-REF
  1840     END-IF
  1841
  1842     IF (CP-COMPANY-ID = 'CID')
  1843        AND (CP-STATE-STD-ABBRV = 'ND')
  1844        AND (CP-CRITICAL-PERIOD)
  1845        AND (DC-GREG-DATE-CYMD > 20011231)
  1846        GO TO 1040-PR-REF
  1847     END-IF
  1848
  1849     IF (CP-COMPANY-ID = 'CID')
  1850        AND (CP-STATE-STD-ABBRV = 'ND')
  1851        AND (DC-GREG-DATE-CYMD > 20011231)
  1852        GO TO 1060-ANTICIPATION-REF
  1853     END-IF
  1854
  1855     IF CP-STATE-STD-ABBRV = 'NC'
  1856       IF CP-COMPANY-ID = 'NCL' OR 'NCB'
  1857          NEXT SENTENCE
  1858       END-IF
  1859         IF DC-GREG-DATE-CYMD GREATER 19810930
  1860            IF CP-EARN-ANTICIPATION
  1861                GO TO 1060-ANTICIPATION-REF
  1862            ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* ELRFND.cbl
  1863                GO TO 1055-MEAN-REF.
  1864
  1865 SKIP-CSO-NC-AH-PROCESSING.
  1866
  1867     IF CP-STATE-STD-ABBRV = 'NM'
  1868       IF CP-COMPANY-ID = 'NCL' OR 'DCC' OR 'AHL'
  1869          NEXT SENTENCE
  1870       END-IF
  1871         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1872            IF CP-COMPANY-ID = 'MON'
  1873              MOVE '6'             TO CP-EARNING-METHOD
  1874              GO TO 1060-ANTICIPATION-REF
  1875             ELSE
  1876              GO TO 1055-MEAN-REF.
  1877
  1878     IF CP-STATE-STD-ABBRV = 'CT'
  1879       IF CP-COMPANY-ID EQUAL 'NCL' OR 'DCC'
  1880          NEXT SENTENCE
  1881       END-IF
  1882          MOVE '6'              TO CP-EARNING-METHOD
  1883          GO TO 1060-ANTICIPATION-REF.
  1884
  1885     IF CP-STATE-STD-ABBRV = 'ME'
  1886       IF CP-COMPANY-ID = 'NCL' OR 'CVL' OR 'DCC'
  1887          NEXT SENTENCE
  1888       END-IF
  1889           IF CP-EARN-BY-PRORATA
  1890              GO TO 1040-PR-REF
  1891           ELSE
  1892              MOVE '6'           TO CP-EARNING-METHOD
  1893              GO TO 1060-ANTICIPATION-REF.
  1894
  1895
  1896     IF CP-COMPANY-ID = 'CID' OR 'DCC'
  1897        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1898            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1899
  1900     IF CP-STATE-STD-ABBRV = 'TX'
  1901       IF CP-COMPANY-ID = 'NCL' OR 'HER'
  1902          NEXT SENTENCE
  1903       END-IF
  1904        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1905           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1906           MOVE '6'              TO CP-EARNING-METHOD
  1907           GO TO 1060-ANTICIPATION-REF.
  1908
  1909     IF CP-STATE-STD-ABBRV = 'VA'
  1910       IF CP-COMPANY-ID EQUAL 'NCL'
  1911          NEXT SENTENCE
  1912       END-IF
  1913       IF CP-COMPANY-ID = 'NCB'
  1914           MOVE '6'                TO CP-EARNING-METHOD
  1915           GO TO 1060-ANTICIPATION-REF
  1916       ELSE
  1917           IF DC-GREG-DATE-CYMD GREATER 19921231
  1918               IF CP-ORIGINAL-TERM GREATER THAN 61
  1919                   MOVE '6'        TO CP-EARNING-METHOD
  1920                   GO TO 1060-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* ELRFND.cbl
  1921               ELSE
  1922                   MOVE '1'        TO CP-EARNING-METHOD
  1923                   GO TO 1050-R78-REF.
  1924
  1925 SKIP-CSO-TX-VA-AH-PROCESSING.
  1926
  1927     IF CP-EARN-BY-PRORATA
  1928         GO TO 1040-PR-REF.
  1929
  1930     IF CP-EARN-BY-R78
  1931         GO TO 1050-R78-REF.
  1932
  1933     IF CP-EARN-AS-MEAN
  1934        GO TO 1055-MEAN-REF.
  1935
  1936     IF CP-EARN-AS-SUM-OF-DIGITS
  1937         GO TO 1075-SUM-OF-DIGITS.
  1938     IF CP-DCC-SPP-DDF
  1939        GO TO 1080-DCC-DDF-SPECIAL
  1940     END-IF
  1941     IF CP-EARN-AS-CALIF
  1942         GO TO 1060-ANTICIPATION-REF.
  1943
  1944     IF CP-EARN-ANTICIPATION
  1945         GO TO 1060-ANTICIPATION-REF.
  1946
  1947     IF CP-EARN-AS-NET-PAY
  1948         GO TO 1070-NET-PAY-REFUND.
  1949
  1950     GO TO 1050-R78-REF.
  1951
  1952*---------------------------------------------------------------
  1953 1035-REF-AH-CRITICAL-PERIOD.
  1954     IF CP-REMAINING-TERM GREATER +6
  1955        COMPUTE CP-CALC-REFUND ROUNDED =
  1956          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1957                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1958      ELSE
  1959        COMPUTE CP-CALC-REFUND ROUNDED =
  1960          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1961                                           CP-REMAINING-TERM + 1)
  1962                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  1963
  1964     IF CP-CALC-REFUND LESS ZERO
  1965         MOVE ZERO TO CP-CALC-REFUND.
  1966
  1967     GO TO 1999-CALC-REF-AMT-X.
  1968
  1969*---------------------------------------------------------------
  1970 1040-PR-REF.
  1971     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1972     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1973
  1974     GO TO 1999-CALC-REF-AMT-X.
  1975
  1976*---------------------------------------------------------------
  1977 1050-R78-REF.
  1978     MOVE '1'               TO CP-REFUND-TYPE-USED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* ELRFND.cbl
  1979     COMPUTE CP-CALC-REFUND ROUNDED =
  1980           CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1981
  1982     GO TO 1999-CALC-REF-AMT-X.
  1983
  1984*---------------------------------------------------------------
  1985 1055-MEAN-REF.
  1986     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1987     COMPUTE CP-CALC-REFUND ROUNDED =
  1988         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  1989          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  1990
  1991     GO TO 1999-CALC-REF-AMT-X.
  1992
  1993*---------------------------------------------------------------
  1994 1060-ANTICIPATION-REF.
  1995     MOVE '6'               TO CP-REFUND-TYPE-USED.
  1996
  1997     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  1998     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  1999     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  2000
  2001     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  2002                               CP-LOAN-TERM.
  2003     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  2004
  2005     PERFORM 2500-GET-RATE.
  2006
  2007     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  2008     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  2009
  2010     IF CP-PREMIUM-RATE = ZEROS
  2011        MOVE '7'                 TO CP-RETURN-CODE
  2012        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  2013        GO TO 1999-CALC-REF-AMT-X.
  2014
  2015     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  2016
  2017     PERFORM 2500-GET-RATE.
  2018
  2019     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  2020
  2021     IF CP-PREMIUM-RATE = ZEROS
  2022        MOVE '7'            TO CP-RETURN-CODE
  2023        GO TO 1999-CALC-REF-AMT-X.
  2024
  2025     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  2026
  2027     IF  WS-ORIG-PREM = ZERO
  2028         MOVE ZERO                TO WS-NP-REF-FACTOR
  2029        ELSE
  2030         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  2031                                            WS-ORIG-PREM.
  2032
  2033     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  2034                                        CP-ORIGINAL-PREMIUM.
  2035
  2036     IF NOT CP-EARN-AS-CALIF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* ELRFND.cbl
  2037         GO TO 1999-CALC-REF-AMT-X.
  2038
  2039*---------------------------------------------------------------
  2040 1065-CALIF-REGS.
  2041     MOVE '3'               TO CP-REFUND-TYPE-USED.
  2042     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2043         GIVING FACTOR-5.
  2044
  2045     IF FACTOR-5 NOT GREATER +6  AND
  2046        CP-CLASS-CODE = 'A '
  2047         GO TO 1050-R78-REF.
  2048
  2049     IF FACTOR-5 = ZERO
  2050         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  2051         GO TO 1999-CALC-REF-AMT-X.
  2052
  2053     IF CP-ORIGINAL-TERM LESS +014
  2054         GO TO 1999-CALC-REF-AMT-X.
  2055
  2056     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  2057                                   GIVING FACTOR-5 ROUNDED.
  2058
  2059     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  2060
  2061     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  2062                                   GIVING FACTOR-2 ROUNDED.
  2063
  2064     SUBTRACT FACTOR-2 FROM FACTOR-1.
  2065     ADD +0.099375 TO FACTOR-1.
  2066
  2067     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2068                                   GIVING FACTOR-5 ROUNDED.
  2069
  2070     SUBTRACT +1.00 FROM FACTOR-5.
  2071
  2072     IF CP-ORIGINAL-TERM LESS +049
  2073         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  2074                                   GIVING FACTOR-6 ROUNDED
  2075     ELSE
  2076         MOVE +035 TO FACTOR-6.
  2077
  2078     MOVE +001 TO FACTOR-2.
  2079
  2080     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  2081     SUBTRACT FACTOR-4 FROM FACTOR-2.
  2082     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  2083     MOVE +001 TO FACTOR-2.
  2084     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  2085
  2086     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
  2087         GIVING CAL-RFND ROUNDED.
  2088
  2089     IF CAL-RFND LESS +0.01
  2090         MOVE ZEROS TO CAL-RFND.
  2091
  2092     IF CAL-RFND LESS CP-CALC-REFUND
  2093         MOVE CAL-RFND TO CP-CALC-REFUND.
  2094
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* ELRFND.cbl
  2095     GO TO 1999-CALC-REF-AMT-X.
  2096
  2097*-----------------------------------------------------------------
  2098 1070-NET-PAY-REFUND.
  2099     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  2100     IF CP-LOAN-APR = ZERO
  2101         MOVE ZEROS              TO  CP-CALC-REFUND
  2102         MOVE '1'                TO  CP-RETURN-CODE
  2103         GO TO 1999-CALC-REF-AMT-X.
  2104
  2105     MOVE CP-LOAN-APR            TO  N-P-APR.
  2106     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  2107     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  2108
  2109     MOVE 'R'                    TO  N-P-OPT.
  2110
  2111     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2112
  2113     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  2114                                        CP-ORIGINAL-PREMIUM.
  2115
  2116     GO TO 1999-CALC-REF-AMT-X.
  2117*---------------------------------------------------------------
  2118
  2119 1075-SUM-OF-DIGITS.
  2120
  2121     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2122
  2123     COMPUTE RSUM-REMAINING-TERM =
  2124             CP-LOAN-TERM -
  2125                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2126
  2127     COMPUTE RSUM-FACTOR =
  2128        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2129               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2130                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2131            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2132               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2133                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2134
  2135     COMPUTE CP-CALC-REFUND ROUNDED =
  2136           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2137
  2138     GO TO 1999-CALC-REF-AMT-X
  2139     .
  2140 1080-DCC-DDF-SPECIAL.
  2141     COMPUTE CP-MONTH =
  2142        FUNCTION REM(CP-ORIGINAL-TERM - CP-REMAINING-TERM, 12)
  2143*    DISPLAY ' BEGIN ELCRFNDP ************** '
  2144*    DISPLAY ' SPEC       ' CP-DDF-SPEC-CALC
  2145*    DISPLAY ' MONTH      ' CP-MONTH
  2146*    DISPLAY ' ORIG TERM  ' CP-ORIGINAL-TERM
  2147*    DISPLAY ' REM TERM   ' CP-REMAINING-TERM
  2148*    DISPLAY ' ORIG PREM  ' CP-ORIGINAL-PREMIUM
  2149*    DISPLAY ' 1YR EXP AL ' CP-1ST-YR-ALLOW
  2150*    DISPLAY ' HI FACT    ' CP-DDF-HI-FACT
  2151*    DISPLAY ' LO FACT    ' CP-DDF-LO-FACT
  2152*    DISPLAY ' RATE UP    ' CP-IU-RATE-UP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* ELRFND.cbl
  2153*    DISPLAY ' CLP RAT UP ' CP-CLP-RATE-UP
  2154*    DISPLAY ' EARM METH  ' CP-EARNING-METHOD
  2155*    DISPLAY '   END ELCRFNDP ************** '
  2156     IF CP-MONTH = 0
  2157        MOVE 12                  TO CP-MONTH
  2158     END-IF
  2159     MOVE CP-MONTH               TO WS-MONTH
  2160     MOVE 'D'                    TO CP-REFUND-TYPE-USED
  2161     IF CP-DCC-SPP-DDF-IU
  2162        GO TO 1090-DCC-DDF-IU
  2163     END-IF
  2164     IF CP-CALC-CLP
  2165        GO TO 1085-DCC-DDF-SPECIAL-CLP
  2166     END-IF
  2167     EVALUATE TRUE
  2168        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2169           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2170           MOVE CP-ORIGINAL-PREMIUM
  2171                                 TO CP-CALC-REFUND
  2172        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2173           MOVE CP-MONTH         TO WS-MONTH
  2174           PERFORM 1150-UE-GROSS-LT-4
  2175           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2176        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2177           MOVE CP-MONTH         TO WS-MONTH
  2178           PERFORM 1160-UE-GROSS-LT-13
  2179           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2180        WHEN OTHER
  2181           MOVE CP-MONTH         TO WS-MONTH
  2182           PERFORM 1170-UE-GROSS-GT-12
  2183           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2184     END-EVALUATE
  2185     GO TO 1999-CALC-REF-AMT-X
  2186     .
  2187 1085-DCC-DDF-SPECIAL-CLP.
  2188     EVALUATE TRUE
  2189        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2190           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2191           MOVE CP-ORIGINAL-PREMIUM
  2192                                 TO CP-CALC-REFUND
  2193        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2194           MOVE CP-MONTH         TO WS-MONTH
  2195           PERFORM 1100-UE-CLP-LT-4
  2196           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2197        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2198           MOVE CP-MONTH         TO WS-MONTH
  2199           PERFORM 1110-UE-CLP-LT-13
  2200           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2201        WHEN OTHER
  2202           MOVE CP-MONTH         TO WS-MONTH
  2203           PERFORM 1120-UE-CLP-GT-12
  2204           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2205     END-EVALUATE
  2206     GO TO 1999-CALC-REF-AMT-X
  2207     .
  2208 1090-DCC-DDF-IU.
  2209     MOVE 'I'                    TO CP-REFUND-TYPE-USED
  2210     IF CP-CALC-CLP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* ELRFND.cbl
  2211        GO TO 1095-DCC-DDF-IU-SPECIAL-CLP
  2212     END-IF
  2213     EVALUATE TRUE
  2214        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2215           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2216           MOVE CP-ORIGINAL-PREMIUM
  2217                                 TO CP-CALC-REFUND
  2218        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2219           MOVE CP-MONTH         TO WS-MONTH
  2220           PERFORM 1250-IU-UE-GROSS-LT-4
  2221           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2222        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2223           MOVE CP-MONTH         TO WS-MONTH
  2224           PERFORM 1260-IU-UE-GROSS-LT-13
  2225           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2226        WHEN OTHER
  2227           MOVE CP-MONTH         TO WS-MONTH
  2228           PERFORM 1270-IU-UE-GROSS-GT-12
  2229           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2230     END-EVALUATE
  2231     GO TO 1999-CALC-REF-AMT-X
  2232     .
  2233 1095-DCC-DDF-IU-SPECIAL-CLP.
  2234     EVALUATE TRUE
  2235        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2236           OR (CP-DDF-CLP = ZEROS)
  2237           MOVE CP-DDF-CLP       TO CP-CALC-REFUND
  2238        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2239           MOVE CP-MONTH         TO WS-MONTH
  2240           PERFORM 1200-IU-UE-CLP-LT-4
  2241           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2242        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2243           MOVE CP-MONTH         TO WS-MONTH
  2244           PERFORM 1210-IU-UE-CLP-LT-13
  2245           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2246        WHEN OTHER
  2247           MOVE CP-MONTH         TO WS-MONTH
  2248           PERFORM 1220-IU-UE-CLP-GT-12
  2249           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2250     END-EVALUATE
  2251     GO TO 1999-CALC-REF-AMT-X
  2252     .
  2253 1100-UE-CLP-LT-4.
  2254*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*mo/12}
  2255     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2256        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2257        / CP-DDF-CLP - CP-DDF-HI-FACT)
  2258        * WS-MONTH / 12)
  2259     .
  2260 1110-UE-CLP-LT-13.
  2261*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12}
  2262*****  -[(CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12
  2263*****  -CLP*UEF1}*(mo-3)/9]
  2264     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2265        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2266        / CP-DDF-CLP - CP-DDF-HI-FACT) * 3 / 12)
  2267        -  ((CP-DDF-CLP - 0) - CP-DDF-CLP
  2268        * (((CP-DDF-CLP - 0) / CP-DDF-CLP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* ELRFND.cbl
  2269        - CP-DDF-HI-FACT) * 3 / 12) - CP-DDF-CLP
  2270        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2271     .
  2272 1120-UE-CLP-GT-12.
  2273*****  CLP * {UEF1 - (UEF1 -UEF2)*mo/12}
  2274     COMPUTE WS-TEMP-RESULT ROUNDED = CP-DDF-CLP *
  2275        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2276        * WS-MONTH / 12)
  2277     .
  2278 1150-UE-GROSS-LT-4.
  2279     COMPUTE CP-1ST-YR-ALLOW = CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2280     COMPUTE WS-TEMP-RESULT ROUNDED =
  2281        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2282        * WS-MONTH / 3) - (CP-ORIGINAL-PREMIUM -
  2283        CP-1ST-YR-ALLOW - CP-DDF-YR1AF) * (1 - CP-DDF-HI-FACT)
  2284        * WS-MONTH / 12
  2285     .
  2286 1160-UE-GROSS-LT-13.
  2287     MOVE 3                      TO WS-MONTH
  2288     PERFORM 1150-UE-GROSS-LT-4
  2289     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2290     MOVE CP-MONTH               TO WS-MONTH
  2291     COMPUTE WS-TEMP-RESULT ROUNDED = WS-GFR3 - (WS-GFR3
  2292        - (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF)
  2293        * (CP-DDF-HI-FACT)) * ((WS-MONTH - 3) / 9)
  2294     .
  2295 1170-UE-GROSS-GT-12.
  2296*****  (GF-Yr1 Texp) * {UEF1 - (UEF1 -UEF2)*mo/12}
  2297     COMPUTE WS-TEMP-RESULT ROUNDED =
  2298        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW)
  2299        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2300        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2301     .
  2302 1200-IU-UE-CLP-LT-4.
  2303*****  no changes with < 4  pema 08/03/11
  2304*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*mo/12)
  2305     COMPUTE WS-TEMP-RESULT ROUNDED =
  2306        (CP-DDF-CLP - 0)
  2307        - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2308        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2309        * WS-MONTH / 12
  2310     .
  2311 1210-IU-UE-CLP-LT-13.
  2312*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2313*****  -[(CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2314*****  - CLP*UEF1]*(mo-3)/9
  2315     MOVE 3                      TO WS-MONTH
  2316     PERFORM 1200-IU-UE-CLP-LT-4
  2317     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2318     MOVE CP-MONTH               TO WS-MONTH
  2319     COMPUTE WS-TEMP-RESULT ROUNDED =
  2320        WS-UE-CLP - (WS-UE-CLP - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2321          * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2322     .
  2323 1220-IU-UE-CLP-GT-12.
  2324*****  CLP*{UEF1 - (UEF1 -UEF2)*mo/12}
  2325     COMPUTE WS-TEMP-RESULT ROUNDED =
  2326        (CP-DDF-CLP - CP-CLP-RATE-UP)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* ELRFND.cbl
  2327        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2328        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2329     .
  2330 1250-IU-UE-GROSS-LT-4.
  2331*****  (Comm+MngtFee)*UECLPmo/CLPCounty+CLPCounty+AdminFee-
  2332*****  Yr1 AF*(mo/3)-[CLP*(UEF1-UEF2)+(AdminFee-Yr1AF)*
  2333*****  (1-UEF1)]*mo/12
  2334     PERFORM 1200-IU-UE-CLP-LT-4
  2335     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2336     COMPUTE WS-TEMP-RESULT = CP-DDF-COMM-AND-MFEE *
  2337        WS-UE-CLP / CP-DDF-CLP + CP-DDF-CLP +
  2338        CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF *
  2339        WS-MONTH / 3 - ((CP-DDF-CLP - CP-CLP-RATE-UP)
  2340        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2341        + (CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF)
  2342        * (1 - CP-DDF-HI-FACT)) * WS-MONTH / 12
  2343     .
  2344 1260-IU-UE-GROSS-LT-13.
  2345***** uegf3-(uegf3-(gf - 1st yr - clprateu)*hi))*(mo-3)/9
  2346     MOVE 3                      TO WS-MONTH
  2347     PERFORM 1250-IU-UE-GROSS-LT-4
  2348     move cp-month               to ws-month
  2349     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2350     COMPUTE WS-TEMP-RESULT ROUNDED =
  2351        WS-GFR3 - (WS-GFR3 - ((CP-ORIGINAL-PREMIUM
  2352        - CP-1ST-YR-ALLOW - cp-clp-rate-up))
  2353        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2354     .
  2355 1270-IU-UE-GROSS-GT-12.
  2356***** (gf - 1st yr - clprateu)*(hi-(hi-lo)*mo/12)
  2357     COMPUTE WS-TEMP-RESULT ROUNDED =
  2358        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW
  2359        - CP-CLP-RATE-UP) *
  2360        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2361        * WS-MONTH / 12)
  2362     .
  2363 1299-END-DDF-CALCS.
  2364     .
  2365 1999-CALC-REF-AMT-X.
  2366
  2367     MOVE CALCULATION-PASS-AREA TO DFHCOMMAREA.
  2368
  2369
  2370* EXEC CICS RETURN
  2371*    END-EXEC.
  2372*    MOVE '.(                    &   #00002365' TO DFHEIV0
  2373     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2374     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2375     MOVE X'2020233030303032333635' TO DFHEIV0(25:11)
  2376     CALL 'kxdfhei1' USING DFHEIV0,
  2377           DFHEIV99,
  2378           DFHEIV99,
  2379           DFHEIV99,
  2380           DFHEIV99,
  2381           DFHEIV99
  2382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2383
  2384
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* ELRFND.cbl
  2385* GOBACK.
  2386     MOVE '9%                    "   ' TO DFHEIV0
  2387     MOVE 'ELRFND' TO DFHEIV1
  2388     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2389     GOBACK.
  2390
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* ELRFND.cbl
  2392  2500-GET-RATE.
  2393
  2394* EXEC CICS LINK
  2395*        PROGRAM    ('ELRATE')
  2396*        COMMAREA   (CALCULATION-PASS-AREA)
  2397*        LENGTH     (CP-COMM-LENGTH)
  2398*        END-EXEC.
  2399     MOVE 'ELRATE' TO DFHEIV1
  2400*    MOVE '."C                   ''   #00002371' TO DFHEIV0
  2401     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2402     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2403     MOVE X'2020233030303032333731' TO DFHEIV0(25:11)
  2404     CALL 'kxdfhei1' USING DFHEIV0,
  2405           DFHEIV1,
  2406           CALCULATION-PASS-AREA,
  2407           CP-COMM-LENGTH,
  2408           DFHEIV99,
  2409           DFHEIV99,
  2410           DFHEIV99
  2411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2412
  2413
  2414  2500-EXIT.
  2415       EXIT.
  2416
  2417  9100-CONVERT-DATE.
  2418
  2419* EXEC CICS LINK
  2420*         PROGRAM   ('ELDATCV')
  2421*         COMMAREA  (DATE-CONVERSION-DATA)
  2422*         LENGTH    (DC-COMM-LENGTH)
  2423*    END-EXEC.
  2424     MOVE 'ELDATCV' TO DFHEIV1
  2425*    MOVE '."C                   ''   #00002381' TO DFHEIV0
  2426     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2427     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2428     MOVE X'2020233030303032333831' TO DFHEIV0(25:11)
  2429     CALL 'kxdfhei1' USING DFHEIV0,
  2430           DFHEIV1,
  2431           DATE-CONVERSION-DATA,
  2432           DC-COMM-LENGTH,
  2433           DFHEIV99,
  2434           DFHEIV99,
  2435           DFHEIV99
  2436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2437
  2438
  2439  9100-EXIT.
  2440       EXIT.
  2441
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* ELRFND.cbl
  2443  10000-NET-TERM  SECTION.
  2444*                      COPY ERCNETP.
  2445*****************************************************************
  2446*                                                               *
  2447*                            ERCNETP                            *
  2448*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2449*                            VMOD=2.029                         *
  2450*                                                               *
  2451*****************************************************************.
  2452*
  2453*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  2454*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  2455*                                   ORIGINAL TERM (S999)
  2456*                                   REMAINING TERM (S999)
  2457*                                   NET PAY OPTION (X)
  2458*                                   LOAN TERM (S999)
  2459*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  2460*
  2461*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  2462*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  2463*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  2464*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  2465*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  2466*    CHARGED.
  2467*
  2468*    OPTIONS - S = NET SIMPLE
  2469*          SPACE = NET PAY  (1 MO. INTEREST)
  2470*              A = NET PAY  (0 MO. INTEREST)
  2471*              I = NET PAY  (2 MO. INTEREST)
  2472*              J = NET PAY  (3 MO. INTEREST)
  2473*              K = NET PAY  (4 MO. INTEREST)
  2474*              T = TRUNCATED  (0 MO. INTEREST)
  2475*              U = TRUNCATED  (1 MO. INTEREST)
  2476*              V = TRUNCATED  (2 MO. INTEREST)
  2477*              W = TRUNCATED  (3 MO. INTEREST)
  2478*              X = TRUNCATED  (4 MO. INTEREST)
  2479*              R = REFUNDS (REGULAR OR TRUNCATED)
  2480******************************************************************
  2481*                   C H A N G E   L O G
  2482*
  2483* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2484*-----------------------------------------------------------------
  2485*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2486* EFFECTIVE    NUMBER
  2487*-----------------------------------------------------------------
  2488* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2489* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2490* 120403                   PEMA  ADD SPECIAL TX CALC
  2491* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2492* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2493* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2494* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2495* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2496* 021207                   PEMA  ADD PA NP
  2497* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2498* 032807                   PEMA  ADD VT NP PLUS 2
  2499* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2500* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* ELRFND.cbl
  2501* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2502* 110207      TO 'AL' NET PAY CALC
  2503* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2504* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2505* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2506* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2507* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2508* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2509* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2510* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2511* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2512* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2513* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  2514* 032612  CR2011110200001  PEMA  AHL CHANGES
  2515******************************************************************
  2516
  2517     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  2518     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  2519     MOVE N-P-LOAN    TO LOAN-TERM.
  2520     MOVE N-P-REM     TO REMAINING-TERM.
  2521     MOVE N-P-OPT     TO OPTION-SW.
  2522
  2523     MOVE +0 TO FACTOR.
  2524
  2525     IF ANNUAL-INT-RATE = ZERO
  2526         GO TO 99000-ERROR.
  2527     IF ORIGINAL-TERM = ZERO
  2528         GO TO 99999-RETURN.
  2529     IF REMAINING-TERM = ZERO
  2530         GO TO 99999-RETURN.
  2531     IF REMAINING-TERM GREATER ORIGINAL-TERM
  2532         GO TO 99000-ERROR.
  2533     IF LOAN-TERM = ZERO
  2534         GO TO 99999-RETURN.
  2535     IF LOAN-TERM LESS ORIGINAL-TERM
  2536         GO TO 99000-ERROR.
  2537
  2538*    IF ANNUAL-INT-RATE LESS +2
  2539*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2540*    IF ANNUAL-INT-RATE LESS +2
  2541*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2542*    IF ANNUAL-INT-RATE LESS +2
  2543*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2544
  2545     IF NPO-REFUND
  2546         MOVE '2' TO NP-PROCESS-SW
  2547       ELSE
  2548         IF ORIGINAL-TERM = REMAINING-TERM
  2549            MOVE '1'   TO NP-PROCESS-SW
  2550           ELSE
  2551            MOVE '3'   TO NP-PROCESS-SW.
  2552
  2553     IF NPO-SIMPLE
  2554         MOVE 'S' TO TYPE-SW
  2555     ELSE
  2556         MOVE 'N' TO TYPE-SW.
  2557
  2558     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* ELRFND.cbl
  2559
  2560     COMPUTE V ROUNDED = K1 / (K1 + I).
  2561
  2562     MOVE V     TO VX
  2563                   SV.
  2564
  2565     MOVE +1    TO X1
  2566                   SX.
  2567
  2568     MOVE LOAN-TERM TO MAX-X.
  2569
  2570     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  2571
  2572     IF MAX-X = +1
  2573        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  2574
  2575     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  2576
  2577     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  2578         OR 'DCC'        OR 'NCL') AND
  2579        (NOT NP-REFUND)
  2580        NEXT SENTENCE
  2581     ELSE
  2582     IF LOAN-TERM NOT = ORIGINAL-TERM
  2583        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  2584
  2585     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  2586
  2587 10500-VX-LOOP.
  2588
  2589***  VX = AMORT. LOAN TERM.
  2590***  SV = AMORT. INSURANCE TERM.
  2591***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  2592***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  2593***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  2594
  2595     IF X2 = 1
  2596        MOVE V         TO SX
  2597     END-IF
  2598     COMPUTE VX ROUNDED = VX * V.
  2599
  2600     ADD B1 TO X1.
  2601
  2602     IF X1 = REMAINING-TERM
  2603          MOVE VX    TO SV.
  2604
  2605     IF X1 EQUAL SV-MINUS-ONE
  2606        MOVE VX      TO SV-MINUS-ONE.
  2607
  2608     IF X1 = X2
  2609          MOVE VX    TO SX.
  2610
  2611     IF X1 NOT = MAX-X
  2612          GO TO 10500-VX-LOOP.
  2613
  2614 10700-COMPUTE-REMAINING-FACTOR.
  2615*****  WK1 = LOAN TERM AMORT
  2616     COMPUTE WK1 = K1 - VX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* ELRFND.cbl
  2617*****  WK2 = INS TERM AMORT
  2618     COMPUTE WK2 = K1 - SV.
  2619*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  2620     COMPUTE WK5 = K1 - SX.
  2621*****  WK6 = INS TERM - 1
  2622     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  2623
  2624     IF NP-RATING
  2625         GO TO 12000-PREMIUM-RATE.
  2626
  2627     IF NP-REFUND
  2628         GO TO 11000-REFUND-CALC.
  2629
  2630     IF NET-STD
  2631         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  2632
  2633     IF NET-SMP
  2634         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  2635         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  2636         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  2637         COMPUTE WK3 ROUNDED = WK3 * 1000.
  2638
  2639     IF REMAINING-TERM LESS THAN X2
  2640         MOVE +0 TO WK3.
  2641
  2642     MOVE WK3 TO FACTOR.
  2643
  2644     GO TO 99999-RETURN.
  2645
  2646 11000-REFUND-CALC.
  2647     IF REMAINING-TERM NOT LESS MAX-X
  2648        MOVE +1 TO FACTOR
  2649        GO TO 99999-RETURN.
  2650
  2651     IF REMAINING-TERM LESS +1
  2652        MOVE 0 TO FACTOR
  2653        GO TO 99999-RETURN.
  2654
  2655     COMPUTE WK2 ROUNDED = WK2 / I.
  2656     COMPUTE WK5 ROUNDED = WK5 / I.
  2657     COMPUTE WK1 ROUNDED = WK1 / I.
  2658
  2659     IF (CP-COMPANY-ID EQUAL 'CID')
  2660        AND (CP-STATE-STD-ABBRV = 'MN')
  2661        AND (CP-CERT-EFF-DT > X'A4FF')
  2662        AND (CP-RATE-AS-REG-BALLOON)
  2663        AND (CP-EARN-AS-NET-PAY)
  2664        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2665        CONTINUE
  2666     ELSE
  2667        GO TO 11000-CHECK-MN-LEV-BALLOON
  2668     END-IF
  2669
  2670     COMPUTE R = M - E
  2671     COMPUTE FACTOR = (R - WK2 + WK5) /
  2672        (M - WK1 + WK5)
  2673
  2674     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* ELRFND.cbl
  2675
  2676      .
  2677 11000-CHECK-MN-LEV-BALLOON.
  2678
  2679     IF (CP-COMPANY-ID EQUAL 'CID')
  2680        AND (CP-STATE-STD-ABBRV = 'MN')
  2681        AND (CP-CERT-EFF-DT > X'A4FF')
  2682        AND (CP-RATE-AS-REG-BALLOON)
  2683        AND (CP-EARN-AS-NET-PAY)
  2684        AND (CP-DEVIATION-CODE = 'LEV')
  2685        CONTINUE
  2686     ELSE
  2687        GO TO 11000-CONTINUE-REFUND
  2688     END-IF
  2689
  2690     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2691     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2692        ** (M - E)) / I
  2693
  2694     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2695
  2696     GO TO 99999-RETURN
  2697
  2698     .
  2699 11000-CONTINUE-REFUND.
  2700*    IF CP-GAP-ACTUARIAL
  2701*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2702*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2703*       COMPUTE WK3 = WK2 / ANGLEN
  2704*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2705     IF CP-GAP-ACTUARIAL
  2706        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2707           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2708        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2709     ELSE
  2710        COMPUTE WK3 ROUNDED =
  2711          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2712     END-IF
  2713
  2714     MOVE WK3  TO FACTOR.
  2715
  2716     GO TO 99999-RETURN.
  2717
  2718 12000-PREMIUM-RATE.
  2719*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  2720*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  2721*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  2722*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  2723*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  2724*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  2725
  2726     COMPUTE K-I = K1 + I.
  2727     MOVE K-I TO ONE-PLUS-I.
  2728
  2729     IF NPO-ALT OR NPO-TRUNC-0
  2730         MOVE K1 TO K-I.
  2731
  2732     IF NPO-2MO OR NPO-TRUNC-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* ELRFND.cbl
  2733         COMPUTE K-I = K1 + (2 * I).
  2734
  2735     IF NPO-3MO OR NPO-TRUNC-3
  2736         COMPUTE K-I = K1 + (3 * I).
  2737
  2738     IF NPO-4MO OR NPO-TRUNC-4
  2739         COMPUTE K-I = K1 + (4 * I).
  2740
  2741     COMPUTE RA ROUNDED = 1 -
  2742             ((X2 * (X2 + 1)) /
  2743              (N *  (N  + 1))).
  2744
  2745     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2746        (CP-CSL-VALID-NP-BENEFIT-CD)
  2747        NEXT SENTENCE
  2748     ELSE
  2749        GO TO XXXX-CHECK-DISCOUNT-5.
  2750
  2751     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2752     MOVE ' ' TO DC-OPTION-CODE.
  2753     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2754
  2755     IF DATE-CONVERSION-ERROR
  2756        MOVE '2'                 TO CP-RETURN-CODE
  2757        MOVE ZEROS               TO FACTOR
  2758                                    CP-CALC-PREMIUM
  2759         GO TO 99999-RETURN.
  2760
  2761     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  2762     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  2763     MOVE ' ' TO DC-OPTION-CODE
  2764     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2765
  2766     IF DATE-CONVERSION-ERROR
  2767        MOVE '2'                 TO CP-RETURN-CODE
  2768        MOVE ZEROS               TO FACTOR
  2769                                    CP-CALC-PREMIUM
  2770         GO TO 99999-RETURN.
  2771
  2772     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  2773
  2774     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  2775
  2776     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  2777        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  2778        CP-PAY-FREQUENCY / 365) * I
  2779     ELSE
  2780        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  2781        CP-PAY-FREQUENCY / 365) * I.
  2782
  2783     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  2784     13).
  2785
  2786     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  2787     (N - ( ANGLEN-1 / WK3)).
  2788
  2789     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  2790
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* ELRFND.cbl
  2791     COMPUTE WS-CALC-FREQ-RATE EQUAL
  2792       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  2793
  2794     COMPUTE WS-Y-X-FACTOR EQUAL
  2795       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  2796       WS-CALC-FREQ-RATE).
  2797
  2798     COMPUTE WS-ODD-DAY-UNITS EQUAL
  2799       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  2800
  2801     COMPUTE WS-X-Y-FACTOR EQUAL
  2802       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  2803
  2804     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  2805       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  2806       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  2807
  2808     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  2809
  2810     GO TO 99999-RETURN.
  2811
  2812 XXXX-CHECK-DISCOUNT-5.
  2813
  2814     IF WS-DISCOUNT-OPTION EQUAL '5'
  2815        NEXT SENTENCE
  2816     ELSE
  2817        GO TO 12000-CHECK-CLIENT.
  2818
  2819      COMPUTE ANGLEN EQUAL WK1 / I.
  2820
  2821      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2822
  2823      COMPUTE WK3 EQUAL
  2824        (12 *
  2825        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  2826        CP-ORIGINAL-BENEFIT)) /
  2827        APR100.
  2828
  2829     COMPUTE WK3 EQUAL
  2830        (WK3 * CP-PREMIUM-RATE) / +1000.
  2831
  2832     COMPUTE WK3 EQUAL
  2833        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  2834
  2835      MOVE WK3 TO CP-CALC-PREMIUM.
  2836
  2837     GO TO 99999-RETURN.
  2838
  2839 12000-CHECK-CLIENT.
  2840
  2841     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2842        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2843        (CP-TRUNCATED-LIFE)
  2844        NEXT SENTENCE
  2845     ELSE
  2846        GO TO 12000-CHECK-NEXT.
  2847
  2848     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* ELRFND.cbl
  2849
  2850     COMPUTE ANGLEN EQUAL WK1 / I.
  2851     COMPUTE ANGLEM EQUAL WK2 / I.
  2852
  2853     COMPUTE FM EQUAL
  2854                    (((ONE-PLUS-I ** M) * I * M) /
  2855                    ((ONE-PLUS-I ** M) - 1))
  2856                    - 1.
  2857
  2858     COMPUTE FN EQUAL
  2859                    (((ONE-PLUS-I ** N) * I * N) /
  2860                    ((ONE-PLUS-I ** N) - 1))
  2861                    - 1.
  2862
  2863     COMPUTE FNM EQUAL
  2864                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  2865                    ((ONE-PLUS-I ** (N - M)) - 1))
  2866                    - 1.
  2867
  2868     COMPUTE GR EQUAL
  2869                    (WS-WORK-RATE * ANGLEM * I) /
  2870                    (M - ANGLEM).
  2871
  2872     COMPUTE ODF EQUAL
  2873                     (1 +
  2874                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  2875                     360)) /
  2876                     ONE-PLUS-I.
  2877
  2878     COMPUTE OD EQUAL
  2879                    (1 + (ODF * (FN / I - 1))) +
  2880                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  2881
  2882     COMPUTE WK3 EQUAL
  2883*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  2884                    ((1 + FN) * ODF *
  2885                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  2886                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  2887                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  2888
  2889     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  2890     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  2891
  2892     COMPUTE WK3 EQUAL
  2893                    (WK3 / (ODF * (1 + FN))) -
  2894*                   CP-ORIGINAL-BENEFIT.
  2895                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  2896
  2897      MOVE WK3 TO CP-CALC-PREMIUM.
  2898
  2899     GO TO 99999-RETURN.
  2900
  2901 12000-CHECK-NEXT.
  2902
  2903     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  2904        NEXT SENTENCE
  2905     ELSE
  2906        GO TO 12000-CHECK-PA-TRUNC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* ELRFND.cbl
  2907
  2908      IF WS-WORK-DIS-RATE EQUAL +0
  2909         MOVE '7'                TO CP-RETURN-CODE
  2910         MOVE ZEROS              TO FACTOR
  2911                                    CP-CALC-PREMIUM
  2912         GO TO 99999-RETURN.
  2913
  2914      COMPUTE ANGLEN EQUAL WK1 / I.
  2915
  2916      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2917
  2918      IF WS-WORK-DIS-RATE EQUAL APR100
  2919         ADD .00001 TO APR100.
  2920
  2921      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  2922      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  2923
  2924     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2925        / (1 + I)
  2926     COMPUTE ANGLEN-1 = ANGLEN / Y
  2927      IF CP-COMPANY-ID EQUAL 'CDL'
  2928         COMPUTE WK3 EQUAL
  2929
  2930          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  2931          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  2932
  2933          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2934
  2935          ((WK8 ** N) /
  2936          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2937
  2938          ((WK9 ** N) /
  2939          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  2940
  2941      ELSE
  2942         COMPUTE WK3 EQUAL
  2943
  2944          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  2945          (12 + WS-WORK-DIS-RATE) * 12) *
  2946
  2947          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2948
  2949          ((WK8 ** N) /
  2950          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2951
  2952          ((WK9 ** N) /
  2953          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  2954
  2955      COMPUTE WK3 EQUAL
  2956          (WK3 * CP-PREMIUM-RATE) / +1000.
  2957
  2958      MOVE WK3 TO CP-CALC-PREMIUM.
  2959
  2960     GO TO 99999-RETURN.
  2961
  2962 12000-CHECK-PA-TRUNC.
  2963
  2964     IF (CP-COMPANY-ID EQUAL 'NCL') AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* ELRFND.cbl
  2965        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  2966        (CP-EARN-AS-NET-PAY) AND
  2967        (CP-TRUNCATED-LIFE)
  2968        NEXT SENTENCE
  2969     ELSE
  2970        GO TO 12000-CHECK-MD-TRUNC.
  2971
  2972     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2973
  2974     COMPUTE ANGLEN-M EQUAL WK5 / I.
  2975     COMPUTE ANGLEN EQUAL WK1 / I.
  2976
  2977     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  2978
  2979     COMPUTE WK3 EQUAL
  2980        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  2981        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  2982
  2983     MOVE WK3 TO CP-CALC-PREMIUM.
  2984
  2985     GO TO 99999-RETURN.
  2986
  2987 12000-CHECK-MD-TRUNC.
  2988
  2989     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2990        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2991        (CP-EARN-AS-NET-PAY) AND
  2992        (CP-TRUNCATED-LIFE)
  2993        NEXT SENTENCE
  2994     ELSE
  2995        GO TO 12000-CHECK-MD.
  2996
  2997     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2998
  2999     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3000     COMPUTE ANGLEM EQUAL WK2 / I.
  3001     COMPUTE ANGLEN EQUAL WK1 / I.
  3002
  3003     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3004
  3005     COMPUTE WK3 EQUAL
  3006        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3007        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3008        (ANGLEN-1 * (M - ANGLEM))).
  3009
  3010     MOVE WK3 TO CP-CALC-PREMIUM.
  3011
  3012     GO TO 99999-RETURN.
  3013
  3014 12000-CHECK-MD.
  3015
  3016     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3017        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3018        (CP-EARN-AS-NET-PAY)
  3019        NEXT SENTENCE
  3020     ELSE
  3021        GO TO 12000-CHECK-ME-TRUNC.
  3022
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* ELRFND.cbl
  3023     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3024
  3025     COMPUTE WK3 EQUAL
  3026        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3027
  3028     MOVE WK3 TO CP-CALC-PREMIUM.
  3029
  3030     GO TO 99999-RETURN.
  3031
  3032 12000-CHECK-ME-TRUNC.
  3033
  3034     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3035        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3036        AND (CP-EARN-AS-NET-PAY)
  3037        AND (CP-TRUNCATED-LIFE)
  3038        CONTINUE
  3039     ELSE
  3040        GO TO 12000-CHECK-CID-FARMPLAN
  3041     END-IF
  3042
  3043     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3044     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3045     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3046     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3047     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3048     COMPUTE ANGLEN-1 = ANGLEN / Y
  3049     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3050     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3051     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3052     COMPUTE WK3
  3053        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3054        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3055            * (1 / (1.0635 ** (M / 12))))
  3056*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3057*    COMPUTE WK9 EQUAL
  3058*       1 / (1 + (.045 * (N - M) / 24))
  3059*    COMPUTE WK7 EQUAL
  3060*       WS-WORK-RATE * 20 / (M + 1).
  3061*    COMPUTE WK3 EQUAL
  3062*       ((( N - ANGLEN) * WK7 * WK8) /
  3063*       (10 * ANGLEN-1 * I)) -
  3064*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3065*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3066*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3067*
  3068     MOVE WK3 TO CP-CALC-PREMIUM.
  3069
  3070     GO TO 99999-RETURN.
  3071 12000-CHECK-CID-FARMPLAN.
  3072     IF (CP-COMPANY-ID EQUAL 'CID')
  3073        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3074           OR 'IN' OR 'AZ')
  3075        AND (CP-FARM-PLAN)
  3076        CONTINUE
  3077     ELSE
  3078        GO TO 12000-CHECK-SC-CID
  3079     END-IF
  3080     COMPUTE N = M / CP-PAY-FREQUENCY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* ELRFND.cbl
  3081     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3082     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3083        ** CP-PAY-FREQUENCY) - 1
  3084     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3085     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3086        ** TI) / WS-WORK-DIS-RATE
  3087     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3088     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3089     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3090        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3091     COMPUTE WK2 = WK2 * (1 + J)
  3092     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3093     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3094     COMPUTE WK3 = WK3 * (1 + J)
  3095     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3096        ** (N - 1))) / J
  3097     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3098        ((N * WK2) - WK5)) + (N * WK1)) *
  3099        (CP-PREMIUM-RATE / 1000)
  3100     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3101     COMPUTE WK6 = (WK7 * GR)
  3102     MOVE WK6 TO CP-CALC-PREMIUM
  3103     GO TO 99999-RETURN
  3104     .
  3105 12000-CHECK-SC-CID.
  3106     IF (CP-COMPANY-ID EQUAL 'CID')
  3107        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  3108        AND (CP-EARN-AS-NET-PAY)
  3109        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3110        CONTINUE
  3111     ELSE
  3112        GO TO 12000-CHECK-AL-CID
  3113     END-IF
  3114     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3115     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3116     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3117     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3118     COMPUTE ANGLEN-1 = ANGLEN / Y
  3119     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3120        / 12)) / ((M + 1) / 2)
  3121     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3122     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3123        + 6 * M) * (WK2 / 100) * (1 + I)
  3124     MOVE WK3 TO CP-CALC-PREMIUM
  3125     GO TO 99999-RETURN
  3126     .
  3127 12000-CHECK-AL-CID.
  3128     IF (CP-COMPANY-ID EQUAL 'CID')
  3129        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3130        AND (CP-EARN-AS-NET-PAY)
  3131        CONTINUE
  3132     ELSE
  3133        GO TO 12000-CHECK-NH-CID
  3134     END-IF
  3135     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3136     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3137     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3138     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* ELRFND.cbl
  3139                   / (1 + I)
  3140     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3141     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3142     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3143        (CP-PREMIUM-RATE / 1000)
  3144     MOVE WK3 TO CP-CALC-PREMIUM
  3145     GO TO 99999-RETURN
  3146     .
  3147 12000-CHECK-NH-CID.
  3148     IF (CP-COMPANY-ID EQUAL 'CID')
  3149        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3150        AND (CP-EARN-AS-NET-PAY)
  3151        CONTINUE
  3152     ELSE
  3153        GO TO 12000-CHECK-PA-CID
  3154     END-IF
  3155     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3156     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3157     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3158                   / (1 + I)
  3159     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3160     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3161     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3162        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  3163     MOVE WK3 TO CP-CALC-PREMIUM
  3164     GO TO 99999-RETURN
  3165     .
  3166 12000-CHECK-PA-CID.
  3167     IF (CP-COMPANY-ID EQUAL 'CID')
  3168        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  3169        AND (CP-EARN-AS-NET-PAY)
  3170        CONTINUE
  3171     ELSE
  3172        GO TO 12000-CHECK-ME-CID
  3173     END-IF
  3174
  3175     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3176     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3177     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3178     COMPUTE ANGLEN-1 = ANGLEN / Y
  3179     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  3180     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3181     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  3182     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3183        * WK5
  3184     MOVE WK3 TO CP-CALC-PREMIUM
  3185     GO TO 99999-RETURN
  3186     .
  3187 12000-CHECK-ME-CID.
  3188     IF (CP-COMPANY-ID EQUAL 'CID')
  3189        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3190        AND (CP-EARN-AS-NET-PAY)
  3191        CONTINUE
  3192     ELSE
  3193        GO TO 12000-CHECK-VT-TRUNC
  3194     END-IF
  3195     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3196     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* ELRFND.cbl
  3197     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3198     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3199     COMPUTE ANGLEN-1 = ANGLEN / Y
  3200     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3201     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3202     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3203        * WK5
  3204     MOVE WK3 TO CP-CALC-PREMIUM
  3205     GO TO 99999-RETURN
  3206     .
  3207 12000-CHECK-VT-TRUNC.
  3208
  3209     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3210        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3211        (CP-EARN-AS-NET-PAY) AND
  3212        (CP-TRUNCATED-LIFE)
  3213        NEXT SENTENCE
  3214     ELSE
  3215        GO TO 12000-CHECK-VT.
  3216
  3217      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3218
  3219      COMPUTE ANGLEN EQUAL WK1 / I.
  3220
  3221      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3222
  3223      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  3224      COMPUTE WK9 EQUAL
  3225        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  3226        ((.0054 - I) / (1 + I)).
  3227      COMPUTE WK7 EQUAL
  3228        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  3229      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3230        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  3231
  3232      MOVE WK3 TO CP-CALC-PREMIUM.
  3233
  3234     GO TO 99999-RETURN.
  3235
  3236 12000-CHECK-VT.
  3237
  3238     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3239        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3240        (CP-EARN-AS-NET-PAY)
  3241        NEXT SENTENCE
  3242     ELSE
  3243        GO TO 12000-CHECK-MINN-WDS.
  3244
  3245      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3246
  3247      COMPUTE ANGLEN EQUAL WK1 / I.
  3248
  3249      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3250
  3251      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  3252                        (ANGLEN-1 * I)) *
  3253
  3254                        (((1.0054 ** N - 1) /
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* ELRFND.cbl
  3255                        (1.0054 ** (N - 1) * .0054)) -
  3256
  3257                        ((V * (1 - 1.0054 ** N * VX)) /
  3258                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  3259
  3260      MOVE WK3 TO CP-CALC-PREMIUM.
  3261
  3262     GO TO 99999-RETURN.
  3263
  3264 12000-CHECK-MINN-WDS.
  3265
  3266     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3267        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3268        (CP-EARN-AS-NET-PAY)
  3269        NEXT SENTENCE
  3270     ELSE
  3271        GO TO 12000-CHECK-MINN-BALL-LEV.
  3272
  3273     COMPUTE ANGLEN EQUAL WK1 / I.
  3274     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  3275              (N / +12) * (2 / (N + 1)).
  3276     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  3277         WK3 * ((N - ANGLEN) / I).
  3278
  3279      MOVE WK3 TO CP-CALC-PREMIUM.
  3280
  3281     GO TO 99999-RETURN.
  3282
  3283 12000-CHECK-MINN-BALL-LEV.
  3284
  3285     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3286        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3287        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3288        (CP-EARN-AS-REG-BALLOON)
  3289        NEXT SENTENCE
  3290     ELSE
  3291        GO TO 12000-CHECK-MINN-BALL.
  3292
  3293     COMPUTE ANGLEN EQUAL WK1 / I.
  3294
  3295     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  3296
  3297     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3298        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  3299
  3300     MOVE WK3 TO CP-CALC-PREMIUM.
  3301
  3302     GO TO 99999-RETURN.
  3303
  3304 12000-CHECK-MINN-BALL.
  3305
  3306     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3307        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3308        (CP-EARN-AS-REG-BALLOON)
  3309        NEXT SENTENCE
  3310     ELSE
  3311        GO TO 12000-CHECK-CID-MN-BALL.
  3312
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* ELRFND.cbl
  3313     COMPUTE ANGLEN EQUAL WK1 / I.
  3314     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3315
  3316     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3317     / +100 * (N - 1) / 12 * 2 / N *
  3318     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  3319
  3320      MOVE WK3 TO CP-CALC-PREMIUM.
  3321
  3322     GO TO 99999-RETURN.
  3323
  3324 12000-CHECK-CID-MN-BALL.
  3325     IF (CP-COMPANY-ID EQUAL 'CID')
  3326        AND (CP-STATE-STD-ABBRV = 'MN')
  3327        AND (CP-CERT-EFF-DT > X'A4FF')
  3328        AND (CP-EARN-AS-REG-BALLOON)
  3329        CONTINUE
  3330     ELSE
  3331        GO TO 12000-CHECK-NC-WDS
  3332     END-IF
  3333     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3334     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3335     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3336     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3337     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3338     COMPUTE V = 1 / (1 + I)
  3339     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3340     COMPUTE Y = (1 + (D * I) / +30)
  3341        / (1 + I)
  3342     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3343        * CP-PREMIUM-RATE / 1000
  3344*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3345*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3346*    ELSE
  3347*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3348*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  3349*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3350*       DISPLAY ' BALLOON TOP ' WK6
  3351*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3352*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3353*          / 100
  3354*       DISPLAY ' BALLOON BOTTOM ' WK7
  3355*       COMPUTE GR = WK6 / WK7
  3356*       DISPLAY ' BALLOON PAYMENT ' GR
  3357*    END-IF
  3358     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3359     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3360        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3361     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  3362     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3363        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3364           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3365           * CP-PREMIUM-RATE / 1000
  3366     MOVE WK3                    TO CP-CALC-PREMIUM
  3367     GO TO 99999-RETURN.
  3368     .
  3369 12000-CHECK-NC-WDS.
  3370
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* ELRFND.cbl
  3371     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3372        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3373        (CP-EARN-AS-NET-PAY)
  3374        NEXT SENTENCE
  3375     ELSE
  3376        GO TO 12000-CHECK-NC-BALL-LEV.
  3377
  3378     COMPUTE WK4 EQUAL N * (1 + I * 2).
  3379     COMPUTE ANGLEN EQUAL WK1 / I.
  3380     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3381              CP-PREMIUM-RATE / +100 *
  3382              N / +12 * 2 / (N + 1) *
  3383              (WK4 - ANGLEN) / (I * ANGLEN).
  3384
  3385      MOVE WK3 TO CP-CALC-PREMIUM.
  3386
  3387     GO TO 99999-RETURN.
  3388
  3389 12000-CHECK-NC-BALL-LEV.
  3390
  3391     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3392        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3393        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3394        (CP-EARN-AS-REG-BALLOON)
  3395        NEXT SENTENCE
  3396     ELSE
  3397        GO TO 12000-CHECK-NC-BALL.
  3398
  3399     COMPUTE ANGLEN EQUAL WK1 / I.
  3400
  3401**** VX = 1 / (1 + I)**N.
  3402
  3403     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3404        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  3405
  3406     MOVE WK3 TO CP-CALC-PREMIUM.
  3407
  3408     GO TO 99999-RETURN.
  3409
  3410 12000-CHECK-NC-BALL.
  3411
  3412     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3413        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3414        (CP-EARN-AS-REG-BALLOON)
  3415        NEXT SENTENCE
  3416     ELSE
  3417        GO TO 12000-CHECK-MINN-TRUNC.
  3418
  3419     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  3420     COMPUTE ANGLEN EQUAL WK1 / I.
  3421     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3422**** VX = 1 / (1 + I)**N.
  3423
  3424     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3425     / +100 * (N - 1) / 12 * 2 / N *
  3426     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  3427
  3428      MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* ELRFND.cbl
  3429
  3430     GO TO 99999-RETURN.
  3431
  3432 12000-CHECK-MINN-TRUNC.
  3433
  3434     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3435        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3436        (M GREATER THAN +63) AND
  3437        (CP-EARN-AS-NET-PAY) AND
  3438        (CP-TRUNCATED-LIFE)
  3439        NEXT SENTENCE
  3440     ELSE
  3441        GO TO 12000-CHECK-MINN.
  3442
  3443      COMPUTE ANGLEN EQUAL WK1 / I.
  3444      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3445
  3446      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3447
  3448      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3449       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3450       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  3451
  3452      MOVE WK3 TO CP-CALC-PREMIUM.
  3453
  3454     GO TO 99999-RETURN.
  3455
  3456 12000-CHECK-MINN.
  3457
  3458     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3459        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3460        (M GREATER THAN +63) AND
  3461        (CP-EARN-AS-NET-PAY)
  3462        NEXT SENTENCE
  3463     ELSE
  3464        GO TO 12000-CHECK-MONTANA-TRUNC.
  3465
  3466      COMPUTE ANGLEN EQUAL WK1 / I.
  3467
  3468      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3469
  3470      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3471       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3472       (((N - ANGLEN) / I) + (2 * N)).
  3473
  3474      MOVE WK3 TO CP-CALC-PREMIUM.
  3475
  3476     GO TO 99999-RETURN.
  3477
  3478 12000-CHECK-MONTANA-TRUNC.
  3479
  3480     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3481        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3482        (M GREATER THAN +63) AND
  3483        (CP-EARN-AS-NET-PAY) AND
  3484        (CP-TRUNCATED-LIFE)
  3485        NEXT SENTENCE
  3486     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* ELRFND.cbl
  3487        GO TO 12000-CHECK-MONTANA.
  3488
  3489      COMPUTE ANGLEN EQUAL WK1 / I.
  3490      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3491
  3492      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3493
  3494      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3495      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3496       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  3497
  3498      MOVE WK3 TO CP-CALC-PREMIUM.
  3499
  3500     GO TO 99999-RETURN.
  3501
  3502 12000-CHECK-MONTANA.
  3503
  3504     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3505        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3506        (M GREATER THAN +63) AND
  3507        (CP-EARN-AS-NET-PAY)
  3508        NEXT SENTENCE
  3509     ELSE
  3510        GO TO 12001-CONTINUE-NCL-TRUNC.
  3511
  3512      COMPUTE ANGLEN EQUAL WK1 / I.
  3513
  3514      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3515
  3516      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3517       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3518       (((N - ANGLEN) / I) + (4 * N)).
  3519
  3520      MOVE WK3 TO CP-CALC-PREMIUM.
  3521
  3522     GO TO 99999-RETURN.
  3523
  3524 12001-CONTINUE-NCL-TRUNC.
  3525
  3526     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3527        (CP-EARN-AS-NET-PAY) AND
  3528        (CP-TRUNCATED-LIFE)
  3529        NEXT SENTENCE
  3530     ELSE
  3531        GO TO 12001-CONTINUE-NCL.
  3532
  3533      COMPUTE ANGLEN EQUAL WK1 / I.
  3534      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3535
  3536      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3537
  3538      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  3539      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  3540      (ANGLEN-1 * (N + 1) * I).
  3541
  3542      MOVE WK3 TO CP-CALC-PREMIUM.
  3543
  3544     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* ELRFND.cbl
  3545
  3546 12001-CONTINUE-NCL.
  3547
  3548     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3549        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3550        (CP-EARN-AS-NET-PAY)
  3551        GO TO 12001-CHECK-NC-NET-PLUS3.
  3552
  3553     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3554        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3555        (CP-EARN-AS-NET-PAY)
  3556        GO TO 12001-CHECK-CA.
  3557
  3558     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3559        (CP-EARN-AS-NET-PAY)
  3560        NEXT SENTENCE
  3561     ELSE
  3562        GO TO 12000-CONTINUE-NET.
  3563
  3564      COMPUTE ANGLEN EQUAL WK1 / I.
  3565      MOVE ANGLEN                TO ANGLEN-1.
  3566
  3567      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3568
  3569      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3570       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3571       ((N - ANGLEN) / I).
  3572
  3573      MOVE WK3 TO CP-CALC-PREMIUM.
  3574
  3575     GO TO 99999-RETURN.
  3576
  3577 12000-CONTINUE-NET.
  3578
  3579     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  3580        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  3581        (CP-EARN-AS-NET-PAY)
  3582        NEXT SENTENCE
  3583     ELSE
  3584        GO TO 12001-CONTINUE-MINN.
  3585
  3586      COMPUTE ANGLEN EQUAL WK6 / I.
  3587      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  3588
  3589      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  3590      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  3591      COMPUTE WK3 EQUAL (WK3 / I) *
  3592       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  3593
  3594      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  3595         MOVE +0 TO CP-R-MAX-TOT-BEN.
  3596
  3597      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  3598
  3599      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  3600         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  3601         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  3602
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* ELRFND.cbl
  3603      MOVE WK3 TO CP-CALC-PREMIUM.
  3604
  3605     GO TO 99999-RETURN.
  3606
  3607 12001-CONTINUE-MINN.
  3608
  3609     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3610        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  3611        (CP-TRUNCATED-LIFE)
  3612        NEXT SENTENCE
  3613     ELSE
  3614        GO TO 12001-CHECK-RI-GTL.
  3615
  3616      COMPUTE ANGLEN EQUAL WK1 / I.
  3617      COMPUTE ANGLEM EQUAL WK2 / I.
  3618
  3619      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  3620       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  3621       * M / 2400) * 1000 + .5) / 1000000.
  3622
  3623      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  3624       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  3625
  3626     GO TO 99999-RETURN.
  3627
  3628 12001-CHECK-RI-GTL.
  3629
  3630     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3631        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3632        (CP-EARN-AS-NET-PAY)
  3633        NEXT SENTENCE
  3634     ELSE
  3635        GO TO 12001-CHECK-RI-LEASE-GTL.
  3636
  3637      COMPUTE ANGLEN EQUAL WK1 / I.
  3638*     COMPUTE ANGLEM EQUAL WK2 / I.
  3639
  3640      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  3641               (1 + WS-WORK-DIS-RATE * N).
  3642      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  3643         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  3644
  3645
  3646     GO TO 99999-RETURN.
  3647
  3648 12001-CHECK-RI-LEASE-GTL.
  3649
  3650     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3651        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3652        (CP-SPECIAL-CALC-CD EQUAL 'H')
  3653        NEXT SENTENCE
  3654     ELSE
  3655        GO TO 12001-CHECK-OR-GTL.
  3656
  3657     COMPUTE ANGLEN EQUAL WK1 / I.
  3658
  3659     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  3660        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* ELRFND.cbl
  3661                        /
  3662        (1000 * I * (1 + .0021 * N)).
  3663     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  3664       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  3665                            /
  3666       (1000 * (1 + .0027 * (N + 1))).
  3667
  3668     GO TO 99999-RETURN.
  3669
  3670 12001-CHECK-OR-GTL.
  3671
  3672     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3673        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  3674        (CP-EARN-AS-NET-PAY)
  3675        NEXT SENTENCE
  3676     ELSE
  3677        GO TO 12001-CHECK-GA-GTL.
  3678
  3679     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3680     COMPUTE ANGLEN EQUAL WK1 / I.
  3681
  3682     IF M LESS THAN +64
  3683        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  3684         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  3685                   /
  3686         (I * ANGLEN * (N - (N - M) + 1) * 600)
  3687        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  3688     ELSE
  3689        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  3690        CP-PREMIUM-RATE * (1 + I))
  3691                  /
  3692        (+1000 * I * ANGLEN)
  3693        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3694*    MOVE WK3 TO CP-CALC-PREMIUM.
  3695     GO TO 99999-RETURN.
  3696
  3697 12001-CHECK-GA-GTL.
  3698
  3699     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3700        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  3701        (CP-EARN-AS-NET-PAY)
  3702*       (CP-TRUNCATED-LIFE)
  3703        NEXT SENTENCE
  3704     ELSE
  3705        GO TO 12001-CHECK-MA-GTL.
  3706
  3707     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3708     COMPUTE ANGLEN EQUAL WK1 / I.
  3709
  3710     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  3711     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  3712      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  3713     MOVE WK3 TO CP-CALC-PREMIUM.
  3714
  3715     GO TO 99999-RETURN.
  3716
  3717 12001-CHECK-MA-GTL.
  3718
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* ELRFND.cbl
  3719     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3720        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  3721        (CP-EARN-AS-NET-PAY) AND
  3722        (CP-SPECIAL-CALC-CD EQUAL 'H')
  3723        NEXT SENTENCE
  3724     ELSE
  3725        GO TO 12001-CHECK-NV-NET.
  3726
  3727     COMPUTE ANGLEN EQUAL WK1 / I.
  3728
  3729     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  3730      CP-ALTERNATE-BENEFIT * N.
  3731
  3732     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  3733     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  3734
  3735     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  3736     WK7 * (N - ANGLEN) / I.
  3737     MOVE WK3 TO CP-CALC-PREMIUM.
  3738
  3739     GO TO 99999-RETURN.
  3740
  3741 12001-CHECK-NV-NET.
  3742     IF (CP-COMPANY-ID EQUAL 'CID')
  3743        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  3744        AND (CP-EARN-AS-NET-PAY)
  3745        CONTINUE
  3746     ELSE
  3747        GO TO 12001-CHECK-MN-NET
  3748     END-IF
  3749     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3750     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3751     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3752                   / (1 + I)
  3753     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3754     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3755     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3756        (CP-PREMIUM-RATE * K-I / 1000)
  3757     MOVE WK3                    TO CP-CALC-PREMIUM
  3758     GO TO 99999-RETURN
  3759      .
  3760 12001-CHECK-MN-NET.
  3761     IF (CP-COMPANY-ID EQUAL 'CID')
  3762        AND (CP-STATE-STD-ABBRV = 'MN')
  3763        AND (CP-EARN-AS-NET-PAY)
  3764        AND (NOT CP-LEVEL-LIFE)
  3765        AND (WS-DISCOUNT-OPTION = '1')
  3766        CONTINUE
  3767     ELSE
  3768        GO TO 12001-CHECK-NC-NET
  3769     END-IF
  3770     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3771     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3772     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3773                   / (1 + I)
  3774     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3775     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3776     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* ELRFND.cbl
  3777        (CP-PREMIUM-RATE / 1000) * (1 + I)
  3778     MOVE WK3                    TO CP-CALC-PREMIUM
  3779     GO TO 99999-RETURN
  3780      .
  3781 12001-CHECK-NC-NET.
  3782
  3783     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  3784        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3785        (CP-EARN-AS-NET-PAY)
  3786        NEXT SENTENCE
  3787     ELSE
  3788        GO TO 12001-CHECK-NC-NET-PLUS3.
  3789
  3790      COMPUTE ANGLEN EQUAL WK1 / I.
  3791      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3792
  3793      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  3794          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  3795          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  3796          N * (CP-PREMIUM-RATE / 1000)).
  3797
  3798      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  3799          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  3800
  3801      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  3802          ((N - ANGLEN) / I + 3) / ANGLEN) /
  3803          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  3804          (ANGLEN * 2))
  3805
  3806      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  3807
  3808      IF ANGLEN IS NOT LESS THAN WK7
  3809          COMPUTE CP-PREMIUM-RATE ROUNDED =
  3810              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  3811          COMPUTE WK3 ROUNDED =
  3812              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  3813
  3814     MOVE WK3 TO CP-CALC-PREMIUM.
  3815
  3816     GO TO 99999-RETURN.
  3817
  3818 12001-CHECK-NC-NET-PLUS3.
  3819
  3820     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3821        (CP-EARN-AS-NET-PAY) AND
  3822        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  3823        NEXT SENTENCE
  3824     ELSE
  3825        GO TO 12001-CHECK-CA.
  3826
  3827     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3828     MOVE ' ' TO DC-OPTION-CODE.
  3829     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3830
  3831     IF DATE-CONVERSION-ERROR
  3832        MOVE '2'                 TO CP-RETURN-CODE
  3833        MOVE ZEROS               TO FACTOR
  3834                                    CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* ELRFND.cbl
  3835         GO TO 99999-RETURN.
  3836
  3837     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  3838        NEXT SENTENCE
  3839     ELSE
  3840        GO TO 12001-CONTINUE-NET.
  3841
  3842     COMPUTE ANGLEN EQUAL WK1 / I.
  3843     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3844
  3845     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  3846
  3847     COMPUTE NC-R = 20 *
  3848                    ((NC-LR * ORIGINAL-TERM) / 12)
  3849                          / (ORIGINAL-TERM + 1).
  3850
  3851     COMPUTE NC-OB = NC-R / 1000.
  3852
  3853     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  3854                    (NC-OB * ORIGINAL-TERM * 3).
  3855
  3856     IF CP-EXT-CHG-LF
  3857         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  3858     ELSE
  3859         MOVE 30                 TO  NC-BIG-D.
  3860
  3861     COMPUTE NC-LITTLE-D = (1 + I) /
  3862             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  3863
  3864     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  3865             (ANGLEN * NC-LITTLE-D ).
  3866
  3867     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  3868
  3869     GO TO 99999-RETURN.
  3870
  3871 12001-CHECK-CA.
  3872
  3873     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3874        (WS-DISCOUNT-OPTION = '6')
  3875        NEXT SENTENCE
  3876     ELSE
  3877        GO TO 12001-CHECK-GTL-IA.
  3878
  3879     COMPUTE CA-J = CA-DISCOUNT / 12.
  3880     COMPUTE ANGLEN EQUAL WK1 / I.
  3881     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  3882     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  3883     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  3884     COMPUTE CA-VI = (1 + I)** -1.
  3885     COMPUTE CP-CALC-PREMIUM =
  3886         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  3887         ((1 + CA-J) / I) *
  3888         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  3889         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  3890         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  3891
  3892     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* ELRFND.cbl
  3893
  3894 12001-CHECK-GTL-IA.
  3895
  3896     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  3897        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  3898        (CP-EARN-AS-NET-PAY)
  3899        NEXT SENTENCE
  3900     ELSE
  3901        GO TO 12001-CHECK-CID-TRN-VA.
  3902
  3903***************************************************************
  3904
  3905     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  3906
  3907     IF GTL-IA-ODD-DAYS = ZEROS
  3908         MOVE ZERO               TO  GTL-IA-SGN
  3909     ELSE
  3910         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  3911             MOVE +1             TO  GTL-IA-SGN
  3912         ELSE
  3913             MOVE -1             TO  GTL-IA-SGN.
  3914
  3915     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  3916     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  3917
  3918     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  3919                          GTL-IA-SGN.
  3920
  3921     COMPUTE ANGLEN EQUAL WK1 / I.
  3922     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3923
  3924     IF GTL-IA-ODF NOT = ZERO
  3925         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  3926         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  3927
  3928     COMPUTE GTL-IA-DIVIDEND =
  3929           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  3930                             (ANGLEN - ANGLEN-M))) *
  3931           ((K1 + I) * CP-PREMIUM-RATE *
  3932                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  3933
  3934     COMPUTE GTL-IA-DIVISOR =
  3935      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  3936
  3937     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  3938
  3939     COMPUTE CP-CALC-PREMIUM =
  3940                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  3941     GO TO 99999-RETURN.
  3942
  3943
  3944 12001-CHECK-CID-TRN-VA.
  3945
  3946     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3947        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  3948        (CP-EARN-AS-NET-PAY) AND
  3949        (CP-TRUNCATED-LIFE) AND
  3950        (CP-STATE-STD-ABBRV = CP-STATE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* ELRFND.cbl
  3951        CONTINUE
  3952     ELSE
  3953        GO TO 12001-CHECK-CID-TX
  3954     END-IF
  3955
  3956     COMPUTE ANGLEN EQUAL WK1 / I
  3957     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3958     IF WS-WORK-DIS-RATE = ZEROS
  3959        CONTINUE
  3960     ELSE
  3961        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3962        COMPUTE WK7 = (1 / I) *
  3963              (((WK4 ** M - 1) / (WK4 - 1)) -
  3964              ((WK4 ** M * SX - VX) /
  3965              (WK4 * (1 + I) - 1))) *
  3966              (CP-PREMIUM-RATE / 1000)
  3967        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  3968        COMPUTE WK8 = WK7 * 100 / ANGLEN
  3969        COMPUTE CP-CALC-PREMIUM =
  3970           WK8 *  ((WK4 * ANGLEN) / 100)
  3971     END-IF
  3972
  3973     GO TO 99999-RETURN
  3974
  3975     .
  3976
  3977 12001-CHECK-CID-TX.
  3978     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3979        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  3980        (CP-EARN-AS-NET-PAY) AND
  3981        (WS-WORK-DIS-RATE > ZEROS) AND
  3982        (CP-STATE-STD-ABBRV = CP-STATE)
  3983        CONTINUE
  3984     ELSE
  3985        GO TO 12001-CHECK-CID-LEV-MN-NEW
  3986     END-IF
  3987* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  3988     COMPUTE K-I = 1 + (1 * I)
  3989     COMPUTE ANGLEN EQUAL WK1 / I
  3990     COMPUTE ANGLEM EQUAL WK2 / I
  3991     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3992     IF WS-WORK-DIS-RATE = ZEROS
  3993        CONTINUE
  3994     ELSE
  3995        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3996        COMPUTE WK7 = (K-I / I) *
  3997              (((WK4 ** M - 1) / (WK4 - 1)) -
  3998*             ((WK4 ** M * SX - VX) /
  3999              ((WK4 ** M * SX) - VX) /
  4000*             (WK4 * (1 + I) - 1))) *
  4001              (WK4 * (1 + I) - 1)) *
  4002              (CP-PREMIUM-RATE / 1000)
  4003        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4004        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4005        COMPUTE CP-CALC-PREMIUM =
  4006           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4007     END-IF
  4008
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* ELRFND.cbl
  4009     GO TO 99999-RETURN
  4010     .
  4011 12001-CHECK-CID-LEV-MN-NEW.
  4012*    IF (CP-COMPANY-ID EQUAL 'CID')
  4013*       AND (CP-STATE-STD-ABBRV = 'MN')
  4014*       AND (CP-EARN-AS-NET-PAY)
  4015*       AND (CP-LEVEL-LIFE)
  4016*       AND (CP-CERT-EFF-DT > X'A4FF')
  4017*       CONTINUE
  4018*    ELSE
  4019*       GO TO 12001-CHECK-CID-LEV-MN
  4020*    END-IF
  4021*
  4022*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4023*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4024*    MOVE '1'                    TO DC-OPTION-CODE
  4025*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4026*
  4027*    IF DATE-CONVERSION-ERROR
  4028*       MOVE '2'                 TO CP-RETURN-CODE
  4029*       MOVE ZEROS               TO FACTOR
  4030*                                   CP-CALC-PREMIUM
  4031*       GO TO 99999-RETURN
  4032*    END-IF
  4033*
  4034*    COMPUTE I = CP-LOAN-APR / 100
  4035*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4036*
  4037*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4038*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4039*      * 12 / 360 * D)
  4040*
  4041*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4042*       * 12 / 360 * D
  4043*
  4044*    GO TO 99999-RETURN
  4045      .
  4046 12001-CHECK-CID-LEV-MN.
  4047
  4048     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4049        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4050        (CP-EARN-AS-NET-PAY) AND
  4051        (CP-LEVEL-LIFE) AND
  4052        (CP-STATE-STD-ABBRV = CP-STATE)
  4053        CONTINUE
  4054     ELSE
  4055        GO TO 12001-CHECK-CID-LEV-CA
  4056     END-IF
  4057
  4058     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4059         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4060         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4061
  4062     GO TO 99999-RETURN
  4063
  4064      .
  4065 12001-CHECK-CID-LEV-CA.
  4066
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* ELRFND.cbl
  4067     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4068        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4069        (CP-EARN-AS-NET-PAY) AND
  4070        (CP-LEVEL-LIFE) AND
  4071        (CP-STATE-STD-ABBRV = CP-STATE)
  4072        CONTINUE
  4073     ELSE
  4074        GO TO 12001-CHECK-CID-TRN-CA
  4075     END-IF
  4076
  4077     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4078     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4079     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4080     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4081     COMPUTE CP-CALC-PREMIUM =
  4082          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4083          (CP-PREMIUM-RATE / 1000)) /
  4084          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4085
  4086     GO TO 99999-RETURN
  4087
  4088      .
  4089 12001-CHECK-CID-TRN-CA.
  4090
  4091     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4092        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4093        (CP-EARN-AS-NET-PAY) AND
  4094        (CP-TRUNCATED-LIFE) AND
  4095        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4096        (WS-DISCOUNT-OPTION NOT = ' ')
  4097        CONTINUE
  4098     ELSE
  4099        GO TO 12001-CHECK-CID-TRN-MT
  4100     END-IF
  4101
  4102     COMPUTE ANGLEN EQUAL WK1 / I
  4103     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4104     IF WS-WORK-DIS-RATE = ZEROS
  4105        CONTINUE
  4106     ELSE
  4107        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4108        COMPUTE WK7 = (1 / I) *
  4109              (((WK4 ** M - 1) / (WK4 - 1)) -
  4110              ((WK4 ** M * SX - VX) /
  4111              (WK4 * (1 + I) - 1))) *
  4112              (CP-PREMIUM-RATE / 1000)
  4113        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4114        COMPUTE CP-CALC-PREMIUM =
  4115           WK4 *  WK7
  4116     END-IF
  4117
  4118     GO TO 99999-RETURN
  4119
  4120      .
  4121 12001-CHECK-CID-TRN-MT.
  4122
  4123     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4124        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* ELRFND.cbl
  4125                   OR
  4126        ((CP-STATE-STD-ABBRV = 'IN') AND
  4127        (CP-CERT-EFF-DT > X'9A7F'))
  4128                   OR
  4129        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4130        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4131        (CP-EARN-AS-NET-PAY) AND
  4132        (CP-TRUNCATED-LIFE) AND
  4133        (CP-STATE-STD-ABBRV = CP-STATE)
  4134        CONTINUE
  4135     ELSE
  4136        GO TO 12001-CHECK-CID-MT
  4137     END-IF
  4138
  4139* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4140     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4141        MOVE 0                   TO K-I
  4142     ELSE
  4143        MOVE 2                   TO K-I
  4144     END-IF
  4145     COMPUTE CP-TERM-OR-EXT-DAYS =
  4146           CP-TERM-OR-EXT-DAYS + 30
  4147
  4148     COMPUTE ANGLEN EQUAL WK1 / I
  4149     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4150     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4151                   / (1 + I)
  4152     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4153     IF WS-WORK-DIS-RATE = ZEROS
  4154        CONTINUE
  4155     ELSE
  4156        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4157*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4158        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4159              (((WK4 ** M - 1) / (WK4 - 1)) -
  4160              ((WK4 ** M * SX - VX) /
  4161              (WK4 * (1 + I) - 1))) *
  4162              (CP-PREMIUM-RATE / 1000)
  4163        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4164*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4165        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4166        COMPUTE CP-CALC-PREMIUM =
  4167           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4168*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4169     END-IF
  4170
  4171     GO TO 99999-RETURN
  4172
  4173     .
  4174 12001-CHECK-CID-MT.
  4175
  4176     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4177        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4178                                OR 'VT')
  4179                   OR
  4180        ((CP-STATE-STD-ABBRV = 'IN') AND
  4181        (CP-CERT-EFF-DT > X'9A7F'))
  4182                   OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* ELRFND.cbl
  4183        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4184        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4185        (CP-EARN-AS-NET-PAY) AND
  4186        (CP-STATE-STD-ABBRV = CP-STATE)
  4187        CONTINUE
  4188     ELSE
  4189        GO TO 12001-CHECK-DCC-DD
  4190     END-IF
  4191
  4192     COMPUTE CP-TERM-OR-EXT-DAYS =
  4193           CP-TERM-OR-EXT-DAYS + 30
  4194
  4195* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4196     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4197        MOVE 0                   TO K-I
  4198     ELSE
  4199        IF CP-STATE-STD-ABBRV = 'NJ'
  4200           MOVE 1                TO K-I
  4201        ELSE
  4202           MOVE 2                TO K-I
  4203        END-IF
  4204     END-IF
  4205     COMPUTE ANGLEN EQUAL WK1 / I
  4206     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4207     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4208                   / (1 + I)
  4209     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4210     IF WS-WORK-DIS-RATE = ZEROS
  4211        CONTINUE
  4212     ELSE
  4213        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4214*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4215        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4216              (((WK4 ** N - 1) / (WK4 - 1)) -
  4217              ((WK4 ** N - SV) /
  4218              (WK4 * (1 + I) - 1))) *
  4219              (CP-PREMIUM-RATE / 1000)
  4220        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4221*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4222        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4223        COMPUTE CP-CALC-PREMIUM =
  4224           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4225*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4226     END-IF
  4227
  4228     GO TO 99999-RETURN
  4229
  4230     .
  4231 12001-CHECK-DCC-DD.
  4232     IF (CP-COMPANY-ID EQUAL 'DCC')
  4233        AND (CP-EARN-AS-NET-PAY)
  4234        AND (CP-BEN-CATEGORY = 'D')
  4235        CONTINUE
  4236     ELSE
  4237        GO TO 12001-CHECK-DCC-NET
  4238     END-IF
  4239
  4240     COMPUTE CP-TERM-OR-EXT-DAYS =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* ELRFND.cbl
  4241           CP-TERM-OR-EXT-DAYS + 30
  4242
  4243     COMPUTE ANGLEN EQUAL WK1 / I.
  4244     COMPUTE ANGLEM EQUAL WK2 / I.
  4245     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4246
  4247     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4248           / (1 + I)
  4249     COMPUTE GR     = ANGLEN / ODF
  4250*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  4251*      CP-RATE-DEV-PCT
  4252     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4253     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4254       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  4255     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4256     MOVE WK3                    TO CP-CALC-PREMIUM
  4257
  4258     GO TO 99999-RETURN
  4259
  4260     .
  4261 12001-CHECK-DCC-NET.
  4262
  4263     IF (CP-COMPANY-ID EQUAL 'DCC')
  4264        AND (CP-EARN-AS-NET-PAY)
  4265        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  4266             AND 'H' AND 'S' AND 'P')
  4267        CONTINUE
  4268     ELSE
  4269        GO TO 12001-CHECK-DCC-PNET
  4270     END-IF
  4271
  4272     COMPUTE CP-TERM-OR-EXT-DAYS =
  4273           CP-TERM-OR-EXT-DAYS + 30
  4274
  4275     COMPUTE ANGLEN EQUAL WK1 / I.
  4276     COMPUTE ANGLEM EQUAL WK2 / I.
  4277     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4278
  4279     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4280           / (1 + I)
  4281     COMPUTE GR     = ANGLEN / ODF
  4282     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4283     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4284       CP-RATE-DEV-PCT
  4285     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4286*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4287
  4288     COMPUTE WK8 = CP-PREMIUM-RATE *
  4289        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  4290     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4291     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4292     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4293       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4294     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4295     MOVE WK3                    TO CP-CALC-PREMIUM
  4296
  4297     GO TO 99999-RETURN
  4298
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* ELRFND.cbl
  4299     .
  4300 12001-CHECK-DCC-PNET.
  4301     IF (CP-COMPANY-ID EQUAL 'DCC')
  4302        AND (CP-EARN-AS-NET-PAY)
  4303        AND (CP-BENEFIT-CD (1:1) = 'P')
  4304        CONTINUE
  4305     ELSE
  4306        GO TO 12001-CHECK-DCC-MNET
  4307     END-IF
  4308     IF CP-NO-OF-PMTS NOT NUMERIC
  4309        MOVE +0                  TO CP-NO-OF-PMTS
  4310     END-IF
  4311     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  4312        AND ' ' AND 'M'
  4313        MOVE ' '                 TO CP-PMT-MODE
  4314     END-IF
  4315     EVALUATE CP-PMT-MODE
  4316        WHEN 'W'
  4317           MOVE +7               TO C-DAYS-IN-PMT-PER
  4318           MOVE +52              TO C-PMTS-PER-YEAR
  4319           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4320        WHEN 'B'
  4321           MOVE +14              TO C-DAYS-IN-PMT-PER
  4322           MOVE +26              TO C-PMTS-PER-YEAR
  4323           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4324        WHEN OTHER
  4325           MOVE +30              TO C-DAYS-IN-PMT-PER
  4326           MOVE +12              TO C-PMTS-PER-YEAR
  4327           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  4328     END-EVALUATE
  4329     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4330     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4331        C-DAYS-IN-PMT-PER)) / (1 + I)
  4332     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  4333     COMPUTE ANGLEN-1 = ANGLEN / Y
  4334     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4335     IF CP-RATE-DEV-PCT NOT = ZEROS
  4336        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4337           CP-PREMIUM-RATE
  4338     END-IF
  4339     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  4340     GO TO 99999-RETURN
  4341     .
  4342 12001-CHECK-DCC-MNET.
  4343
  4344     IF (CP-COMPANY-ID EQUAL 'DCC')
  4345        AND (CP-EARN-AS-NET-PAY)
  4346        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4347        CONTINUE
  4348     ELSE
  4349        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  4350     END-IF
  4351
  4352*    COMPUTE ANGLEN EQUAL WK1 / I.
  4353*    COMPUTE ANGLEM EQUAL WK2 / I.
  4354*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  4355
  4356     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* ELRFND.cbl
  4357     MOVE WK3                    TO CP-CALC-PREMIUM
  4358
  4359     GO TO 99999-RETURN
  4360
  4361     .
  4362 12001-CHECK-DCC-MNET-LF-BAL.
  4363
  4364     IF (CP-COMPANY-ID EQUAL 'DCC')
  4365        AND (CP-EARN-AS-NET-PAY)
  4366        AND (CP-BENEFIT-CD (1:1) = 'N')
  4367        AND (CP-BEN-CATEGORY NOT = 'N')
  4368        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4369        CONTINUE
  4370     ELSE
  4371        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4372     END-IF
  4373
  4374     IF CP-RATE-DEV-PCT NOT = ZEROS
  4375        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4376           CP-PREMIUM-RATE
  4377     END-IF
  4378*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4379     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4380        / (1 + I)
  4381     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4382     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4383     COMPUTE WK2 = (1 + J) ** (M * -1)
  4384     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4385     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4386          ** ((M - 1) * -1))) / J)
  4387     COMPUTE ANGLEM = ((1 - ((1 + J)
  4388          ** (M * -1))) / J) / OD
  4389     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4390        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4391        / ANGLEM-1
  4392     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4393          ** ((N - M) * -1))) / I)
  4394     MOVE +0                     TO WK3
  4395     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4396        (WS-COUNTER > M)
  4397        COMPUTE ANGLEM = (1 - ((1 + J)
  4398          ** ((M - WS-COUNTER) * -1))) / J
  4399        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4400        COMPUTE WK5-CSL = (RA * ANGLEM)
  4401        + (CP-ALTERNATE-BENEFIT * WK2)
  4402        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4403     END-PERFORM
  4404     MOVE WK3                    TO CP-CALC-PREMIUM
  4405
  4406     GO TO 99999-RETURN
  4407
  4408     .
  4409 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4410
  4411     IF (CP-COMPANY-ID EQUAL 'DCC')
  4412        AND (CP-EARN-AS-NET-PAY)
  4413        AND (CP-BENEFIT-CD (1:1) = 'S')
  4414        AND (CP-BEN-CATEGORY NOT = 'N')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* ELRFND.cbl
  4415        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4416        CONTINUE
  4417     ELSE
  4418        GO TO 12001-CHECK-DCC-MNET-LF
  4419     END-IF
  4420
  4421     IF CP-RATE-DEV-PCT NOT = ZEROS
  4422        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4423           CP-PREMIUM-RATE
  4424     END-IF
  4425     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4426     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4427          ** ((M - 1) * -1))) / K)
  4428     COMPUTE ANGLEM = ((1 - ((1 + K)
  4429          ** (M * -1))) / K)
  4430     MOVE CP-MONTHLY-PAYMENT     TO RA
  4431     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4432        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4433        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4434        CP-PREMIUM-RATE / 1000
  4435     MOVE WK3                    TO CP-CALC-PREMIUM
  4436
  4437     GO TO 99999-RETURN
  4438
  4439     .
  4440 12001-CHECK-DCC-MNET-LF.
  4441
  4442     IF (CP-COMPANY-ID EQUAL 'DCC')
  4443        AND (CP-EARN-AS-NET-PAY)
  4444        AND (CP-BENEFIT-CD (1:1) = 'N')
  4445        AND (CP-BEN-CATEGORY NOT = 'N')
  4446        CONTINUE
  4447     ELSE
  4448        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4449     END-IF
  4450
  4451     IF CP-RATE-DEV-PCT NOT = ZEROS
  4452        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4453           CP-PREMIUM-RATE
  4454     END-IF
  4455*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4456     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4457        / (1 + I)
  4458     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4459     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4460     COMPUTE WK2 = (1 + J) ** (M * -1)
  4461     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4462     COMPUTE ANGLEM = ((1 - ((1 + J)
  4463          ** (M * -1))) / J) / OD
  4464     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4465     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4466          ** ((N - M) * -1))) / I)
  4467     MOVE +0                     TO WK3
  4468     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4469        (WS-COUNTER > M)
  4470        COMPUTE ANGLEM = (1 - ((1 + J)
  4471          ** ((M - WS-COUNTER + 1) * -1))) / J
  4472        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* ELRFND.cbl
  4473        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4474        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4475     END-PERFORM
  4476     MOVE WK3                    TO CP-CALC-PREMIUM
  4477
  4478     GO TO 99999-RETURN
  4479
  4480     .
  4481 12001-CHECK-DCC-MNET-SUMLF.
  4482
  4483     IF (CP-COMPANY-ID EQUAL 'DCC')
  4484        AND (CP-EARN-AS-NET-PAY)
  4485        AND (CP-BENEFIT-CD (1:1) = 'S')
  4486        AND (CP-BEN-CATEGORY NOT = 'N')
  4487        CONTINUE
  4488     ELSE
  4489        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4490     END-IF
  4491
  4492     IF CP-RATE-DEV-PCT NOT = ZEROS
  4493        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4494           CP-PREMIUM-RATE
  4495     END-IF
  4496     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4497     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4498        / (1 + K)
  4499     COMPUTE ANGLEN-M = (WK5 / I)
  4500     COMPUTE WK2 = (1 + K) ** (M * -1)
  4501     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4502     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4503     COMPUTE ANGLEM = ((1 - ((1 + K)
  4504          ** (M * -1))) / K) / Y
  4505     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4506     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4507        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4508        - 1)) / K) * RA
  4509     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4510        + (CP-DAYS-TO-1ST-PMT - +30)
  4511        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4512        +0 / 1000 * 12 / 12)
  4513     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4514        * (12 / 12)
  4515     MOVE WK3                    TO CP-CALC-PREMIUM
  4516
  4517     GO TO 99999-RETURN
  4518
  4519     .
  4520 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4521
  4522     IF (CP-COMPANY-ID EQUAL 'DCC')
  4523        AND (CP-EARN-AS-NET-PAY)
  4524        AND (CP-BENEFIT-CD (1:1) = 'N')
  4525        AND (CP-BEN-CATEGORY = 'N')
  4526        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4527        CONTINUE
  4528     ELSE
  4529        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  4530     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* ELRFND.cbl
  4531
  4532*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4533     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4534        / (1 + I)
  4535     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4536     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  4537     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4538     COMPUTE WK2 = (1 + J) ** (M * -1)
  4539     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4540     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4541          ** ((M - 1) * -1))) / J)
  4542     COMPUTE ANGLEM = ((1 - ((1 + J)
  4543          ** (M * -1))) / J) / OD
  4544     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4545        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  4546        / ANGLEM-1
  4547     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4548          ** ((N - M) * -1))) / I)
  4549     MOVE +0                     TO WK3
  4550     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4551        (WS-COUNTER > M)
  4552        COMPUTE ANGLEM = (1 - ((1 + J)
  4553          ** ((M - WS-COUNTER) * -1))) / J
  4554        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  4555        COMPUTE WK5-CSL = (RA * ANGLEM)
  4556        + (CP-ALTERNATE-BENEFIT * WK2)
  4557        COMPUTE WK3 = WK3 +
  4558         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  4559        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  4560          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  4561          (CP-DCC-AH-RATE / 1000)
  4562     END-PERFORM
  4563     MOVE WK3                    TO CP-CALC-PREMIUM
  4564
  4565     GO TO 99999-RETURN
  4566
  4567     .
  4568 12001-CHECK-DCC-MNET-TOT-BAL-S.
  4569
  4570     IF (CP-COMPANY-ID EQUAL 'DCC')
  4571        AND (CP-EARN-AS-NET-PAY)
  4572        AND (CP-BENEFIT-CD (1:1) = 'S')
  4573        AND (CP-BEN-CATEGORY = 'N')
  4574        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4575        CONTINUE
  4576     ELSE
  4577        GO TO 12001-CHECK-DCC-MNET-TOT-N
  4578     END-IF
  4579
  4580     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4581     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4582          ** ((M - 1) * -1))) / K)
  4583     COMPUTE ANGLEM = ((1 - ((1 + K)
  4584          ** (M * -1))) / K)
  4585     MOVE CP-MONTHLY-PAYMENT     TO RA
  4586     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4587        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  4588        * CP-DCC-AH-RATE / 1000))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* ELRFND.cbl
  4589        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4590        CP-DCC-LF-RATE / 1000
  4591     MOVE WK3                    TO CP-LF-PREM
  4592     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  4593        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  4594        * CP-DCC-AH-RATE / 1000
  4595     COMPUTE WK3 = WK3 + WK5-CSL
  4596     MOVE WK3                    TO CP-CALC-PREMIUM
  4597
  4598     GO TO 99999-RETURN
  4599      .
  4600 12001-CHECK-DCC-MNET-TOT-N.
  4601
  4602     IF (CP-COMPANY-ID EQUAL 'DCC')
  4603        AND (CP-EARN-AS-NET-PAY)
  4604        AND (CP-BENEFIT-CD (1:1) = 'N')
  4605        AND (CP-BEN-CATEGORY = 'N')
  4606        CONTINUE
  4607     ELSE
  4608        GO TO 12001-CHECK-DCC-MNET-TOT-S
  4609     END-IF
  4610
  4611*    I = APR/1200
  4612*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4613*    RA = PAYMENT AMOUNT
  4614*    WK5-CSL = THE BALANCE (PAY OFF )
  4615*    WK3 = THE ACCUMULATED PREMIUM
  4616*    WK2 = (1 + I) ^ (m * -1)
  4617*    OD  = GAMMA
  4618*
  4619*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4620     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4621        / (1 + I)
  4622     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4623     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  4624        (CP-DCC-AH-RATE / +1000)
  4625     COMPUTE WK2 = (1 + J) ** (M * -1)
  4626     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4627     COMPUTE ANGLEM = ((1 - ((1 + J)
  4628          ** (M * -1))) / J) / OD
  4629     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4630     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4631          ** ((N - M) * -1))) / I)
  4632     MOVE +0                     TO WK3
  4633     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4634        (WS-COUNTER > M)
  4635        COMPUTE ANGLEM = (1 - ((1 + J)
  4636          ** ((M - WS-COUNTER + 1) * -1))) / J
  4637        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4638        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4639        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  4640           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  4641     END-PERFORM
  4642     MOVE WK3                    TO CP-CALC-PREMIUM
  4643
  4644     GO TO 99999-RETURN
  4645
  4646     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* ELRFND.cbl
  4647 12001-CHECK-DCC-MNET-TOT-S.
  4648
  4649     IF (CP-COMPANY-ID EQUAL 'DCC')
  4650        AND (CP-EARN-AS-NET-PAY)
  4651        AND (CP-BENEFIT-CD (1:1) = 'S')
  4652        AND (CP-BEN-CATEGORY = 'N')
  4653        CONTINUE
  4654     ELSE
  4655        GO TO 12001-CONTINUE-NET
  4656     END-IF
  4657
  4658*    I = APR/1200
  4659*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  4660*    RA = PAYMENT AMOUNT
  4661*    WK5-CSL = THE BALANCE (PAY OFF )
  4662*    WK3 = THE ACCUMULATED PREMIUM
  4663*    WK2 = (1 + I) ^ (m * -1)
  4664*    OD  = GAMMA
  4665*
  4666     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  4667     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  4668        / (1 + J)
  4669     COMPUTE ANGLEM = ((1 - ((1 + J)
  4670          ** (M * -1))) / J) / OD
  4671     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4672          ** ((N - M) * -1))) / I)
  4673          * (1 + J) ** (-1 * M)
  4674     COMPUTE ANGLEN-M = ANGLEN-M / OD
  4675     MOVE CP-MONTHLY-PAYMENT     TO RA
  4676     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  4677        / +30)
  4678     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  4679        ** (WK1) - 1)) / J) * RA
  4680     COMPUTE WK5 = (((((M * (M + 1) / 2)
  4681        + (CP-DAYS-TO-1ST-PMT - +30)
  4682        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  4683        CP-DCC-AH-RATE / +1000 * 12 / 12)
  4684     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  4685        (12 / 12)
  4686     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  4687        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  4688        (CP-DCC-AH-RATE / +1000) * 12 / 12
  4689     COMPUTE WK3 = WK3 + WK5-CSL
  4690     MOVE WK3                    TO CP-CALC-PREMIUM
  4691     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4692     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4693        / (1 + K)
  4694     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4695          ** ((N - M) * -1))) / I)
  4696     COMPUTE WK2 = (1 + K) ** (M * -1)
  4697     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4698     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4699     COMPUTE ANGLEM = ((1 - ((1 + K)
  4700          ** (M * -1))) / K) / Y
  4701*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4702     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  4703        ((1 + K) ** (M + 1 / Y
  4704        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* ELRFND.cbl
  4705        - 1)) / K) * RA
  4706     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4707        + (CP-DAYS-TO-1ST-PMT - +30)
  4708        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4709        CP-DCC-AH-RATE / 1000 * 12 / 12)
  4710     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  4711        * (12 / 12)
  4712     MOVE WK3                    TO CP-LF-PREM
  4713
  4714     GO TO 99999-RETURN
  4715
  4716     .
  4717 12001-CONTINUE-NET.
  4718
  4719     IF NET-STD
  4720        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  4721*          OR 'DCC'
  4722         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  4723         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  4724         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  4725         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  4726                               * ((1 + N) / (1 + M))
  4727        ELSE
  4728         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  4729         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  4730         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  4731         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  4732
  4733     IF NET-SMP
  4734         COMPUTE N2 = N * N
  4735         COMPUTE N3 = N2 * N
  4736         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  4737         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  4738         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  4739         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  4740         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  4741
  4742     IF NPO-PRUDENTIAL
  4743       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  4744           VARYING WS-COUNTER FROM 1 BY 1
  4745               UNTIL WS-COUNTER = N
  4746       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  4747       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  4748
  4749     MOVE WK3 TO FACTOR.
  4750
  4751     GO TO 99999-RETURN.
  4752
  4753 12100-PRU-CALC.
  4754     IF WS-COUNTER = 1
  4755         COMPUTE PWK = (I + 1)
  4756     ELSE
  4757         COMPUTE PWK = PWK * (I + 1).
  4758
  4759 12199-EXIT.
  4760      EXIT.
  4761
  4762 99000-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* ELRFND.cbl
  4763     MOVE +9999.999999999 TO N-P-FACTOR.
  4764     MOVE '4'             TO CP-RETURN-CODE.
  4765
  4766     GO TO 99999-EXIT.
  4767
  4768 99999-RETURN.
  4769     MOVE FACTOR          TO N-P-FACTOR.
  4770
  4771 99999-EXIT.
  4772      EXIT.
  4773
  4774 9999-DFHBACK SECTION.
  4775     MOVE '9%                    "   ' TO DFHEIV0
  4776     MOVE 'ELRFND' TO DFHEIV1
  4777     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4778     GOBACK.
  4779 9999-DFHEXIT.
  4780     IF DFHEIGDJ EQUAL 0001
  4781         NEXT SENTENCE.
  4782     MOVE '9%                    "   ' TO DFHEIV0
  4783     MOVE 'ELRFND' TO DFHEIV1
  4784     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4785     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2488     Code:       38991
