* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 102212  CR2012013100001  PEMA  ALLOW MN OVERRIDE RF
    54* 112612  CR2012101700002  AJRA  FIX CANCEL WHEN DEATH CLAIM
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57* 050713  CR2011062300001  PEMA  REM CHG FOR EXT DYS FOR ROA REF
    58******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page   3
* EL1278.cbl
    60 ENVIRONMENT DIVISION.
    61 DATA DIVISION.
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64 77  FILLER  PIC  X(32) VALUE '********************************'.
    65 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    66 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    67 77  S1                          PIC S999 COMP-3 VALUE +0.
    68 77  P1                          PIC S999 COMP-3 VALUE +0.
    69 77  P2                          PIC S999 COMP-3 VALUE +0.
    70 77  C0                          PIC S999 COMP-3 VALUE +0.
    71 77  C1                          PIC S999 COMP-3 VALUE +0.
    72 77  C2                          PIC S999 COMP-3 VALUE +0.
    73 77  C3                          PIC S999 COMP-3 VALUE +0.
    74 77  WS-STOP-SW                  PIC X  VALUE ' '.
    75     88  I-SAY-TO-STOP      VALUE 'Y'.
    76 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    77     88  OPEN-LF-CLAIM              VALUE 'Y'.
    78 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    79     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    80 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    81     88  OPEN-AH-CLAIM              VALUE 'Y'.
    82 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    83     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    84 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    85     88  FOUND-A-CLAIM              VALUE 'Y'.
    86 77  WS-ST-REF-IND               PIC X.
    87 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    88 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    89 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    90 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    91 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    92 77  DD-IU-SW                    PIC X   VALUE ' '.
    93     88  DD-IU-PRESENT                 VALUE 'Y'.
    94 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    95 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    96 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    97 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    98 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    99 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   100 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   101 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   102 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
   103     88  NO-CERT-RW                 VALUE 'N'.
   104     88  CERT-RW                    VALUE 'Y'.
   105 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   106     88  ERMAIL-FOUND                 VALUE 'Y'.
   107 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE ZERO.
   108
   109*                            COPY ELCSCTM.
   110******************************************************************
   111*                                                                *
   112*                                                                *
   113*                            ELCSCTM                             *
   114*                            VMOD=2.001                          *
   115*                                                                *
   116*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   117*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page   4
* EL1278.cbl
   118******************************************************************
   119 01  SECURITY-MESSAGE.
   120     12  FILLER                          PIC X(30)
   121            VALUE '** LOGIC SECURITY VIOLATION -'.
   122     12  SM-READ                         PIC X(6).
   123     12  FILLER                          PIC X(5)
   124            VALUE ' PGM='.
   125     12  SM-PGM                          PIC X(6).
   126     12  FILLER                          PIC X(5)
   127            VALUE ' OPR='.
   128     12  SM-PROCESSOR-ID                 PIC X(4).
   129     12  FILLER                          PIC X(6)
   130            VALUE ' TERM='.
   131     12  SM-TERMID                       PIC X(4).
   132     12  FILLER                          PIC XX   VALUE SPACE.
   133     12  SM-JUL-DATE                     PIC 9(5).
   134     12  FILLER                          PIC X    VALUE SPACE.
   135     12  SM-TIME                         PIC 99.99.
   136
   137
   138*                            COPY ELCSCRTY.
   139******************************************************************
   140*                                                                *
   141*                                                                *
   142*                            ELCSCRTY                            *
   143*                            VMOD=2.001                          *
   144*                                                                *
   145*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   146*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   147*        SAVED IN PI-SECURITY-ADDRESS.                           *
   148*                                                                *
   149******************************************************************
   150 01  SECURITY-CONTROL.
   151     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   152     12  FILLER                       PIC XX    VALUE 'SC'.
   153     12  SC-CREDIT-CODES.
   154         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   155             20  SC-CREDIT-DISPLAY    PIC X.
   156             20  SC-CREDIT-UPDATE     PIC X.
   157     12  SC-CLAIMS-CODES.
   158         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   159             20  SC-CLAIMS-DISPLAY    PIC X.
   160             20  SC-CLAIMS-UPDATE     PIC X.
   161
   162 01  FILLER          COMP-3.
   163     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   164     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   165     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   166     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   167     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   168     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   169     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   170     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   171     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   172
   173 01  WS-DATE-AREA.
   174     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   175     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page   5
* EL1278.cbl
   176     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   177     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   178     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   179     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   180
   181 01  ERPDEF-KEY-SAVE             PIC X(18).
   182 01  ERPDEF-KEY.
   183     12  ERPDEF-COMPANY-CD       PIC X.
   184     12  ERPDEF-STATE            PIC XX.
   185     12  ERPDEF-PROD-CD          PIC XXX.
   186     12  F                       PIC X(7).
   187     12  ERPDEF-BEN-TYPE         PIC X.
   188     12  ERPDEF-BEN-CODE         PIC XX.
   189     12  ERPDEF-EXP-DT           PIC XX.
   190 01  ELMSTR-KEY.
   191     12  ELMSTR-COMP-CD          PIC X.
   192     12  ELMSTR-CERT-NO          PIC X(11).
   193 01  ELCRTT-KEY.
   194     12  ELCRTT-PRIMARY          PIC X(33).
   195     12  ELCRTT-REC-TYPE         PIC X(1).
   196
   197 01  ELCRTO-KEY.
   198     05  ELCRTO-COMPANY-CD       PIC X.
   199     05  ELCRTO-CARRIER          PIC X.
   200     05  ELCRTO-GROUPING         PIC X(6).
   201     05  ELCRTO-STATE            PIC XX.
   202     05  ELCRTO-ACCOUNT          PIC X(10).
   203     05  ELCRTO-CERT-EFF-DT      PIC XX.
   204     05  ELCRTO-CERT-NO.
   205         10  ELCRTO-CERT-PRIME   PIC X(10).
   206         10  ELCRTO-CERT-SFX     PIC X.
   207     05  ELCRTO-RECORD-TYPE      PIC X.
   208     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   209
   210 01  STANDARD-AREAS.
   211     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   212     12  SUB3                    PIC S9(04) COMP VALUE +0.
   213     12  SUB4                    PIC S9(04) COMP VALUE +0.
   214     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   215     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   216     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   217     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   218     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   219     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   220     12  PGM-NAME                PIC  X(08).
   221     12  TIME-IN                 PIC S9(07).
   222     12  TIME-OUT-R  REDEFINES  TIME-IN.
   223         16  FILLER              PIC  X(01).
   224         16  TIME-OUT            PIC  9(02)V99.
   225         16  FILLER              PIC  X(02).
   226     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   227     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   228     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   229     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   230     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   231     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   232     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   233     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page   6
* EL1278.cbl
   234     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   235     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   236     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   237     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   238     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
   239     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   240     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   241     12  ELCRTT-ID               PIC  X(08)      VALUE 'ELCRTT'.
   242     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   243     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   244         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   245     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   246         88  BROWSE-STARTED                      VALUE 'Y'.
   247     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   248         88  FORM-FOUND                          VALUE 'Y'.
   249     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   250         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   251     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   252         88  WS-REDUCING                         VALUE 'R'.
   253         88  WS-LEVEL                            VALUE 'L'  'P'.
   254     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   255         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   256     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   257         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   258     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   259     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   260         'CLAIM PMTS'.
   261     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   262         'ITD REFUND'.
   263     12  WS-ACCESS.
   264         16  FILLER              PIC  X(02).
   265         16  WS-BEN-CD           PIC  X(02).
   266     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   267     12  WS-LF-KIND              PIC  X(03)      VALUE SPACES.
   268     12  WS-AH-KIND              PIC  X(03)      VALUE SPACES.
   269     12  WS-LOOKUP-TYPE          PIC  X(01).
   270     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   271     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   272     12  WS-CALC-CD              PIC  X(01).
   273     12  DEEDIT-FIELD            PIC  X(15).
   274     12  DEEDIT-FIELD-V0  REDEFINES
   275         DEEDIT-FIELD            PIC S9(15).
   276     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   277     12  RETURN-FROM             PIC  X(08).
   278     12  QID.
   279         16  QID-TERM            PIC  X(04).
   280         16  FILLER              PIC  X(04)      VALUE '127H'.
   281     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   282         88  FIRST-ENTRY                         VALUE 'Y'.
   283     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   284         88  PDEF-FOUND                          VALUE 'Y'.
   285     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   286         88  CERT-FOUND                          VALUE 'Y'.
   287         88  CERT-NOT-FOUND                      VALUE 'N'.
   288     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   289         88  CNTL-FOUND                          VALUE 'Y'.
   290         88  CNTL-NOT-FOUND                      VALUE 'N'.
   291     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page   7
* EL1278.cbl
   292         88  BEN-FOUND                           VALUE 'Y'.
   293     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   294         88  STATE-FOUND                         VALUE 'Y'.
   295     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   296         88  ST-BEN-FOUND                        VALUE 'Y'.
   297     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   298         88  ACCT-FOUND                          VALUE 'Y'.
   299     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   300         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   301     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   302                                                 VALUE ZERO.
   303         88  BENEFIT-FOUND                       VALUE +1.
   304     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   305                                                 VALUE ZERO.
   306     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   307                                                 VALUE ZERO.
   308     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   309     12  WS-SUB1                 PIC S99    COMP.
   310     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   311     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   312     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   313     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   314     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   315     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   316     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   317     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   318     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   319     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   320     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   321     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   322     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   323     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   324     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   325     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   326     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   327     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   328     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   329     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   330     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   331     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   332     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   333     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   334     12  ERROR-MESSAGES.
   335         16  ER-0000             PIC  X(04)      VALUE '0000'.
   336         16  ER-0004             PIC  X(04)      VALUE '0004'.
   337         16  ER-0008             PIC  X(04)      VALUE '0008'.
   338         16  ER-0028             PIC  X(04)      VALUE '0028'.
   339         16  ER-0029             PIC  X(04)      VALUE '0029'.
   340         16  ER-0070             PIC  X(04)      VALUE '0070'.
   341         16  ER-0142             PIC  X(04)      VALUE '0142'.
   342         16  ER-0214             PIC  X(04)      VALUE '0214'.
   343         16  ER-0681             PIC  X(04)      VALUE '0681'.
   344         16  ER-0682             PIC  X(04)      VALUE '0682'.
   345         16  ER-0683             PIC  X(04)      VALUE '0683'.
   346         16  ER-0684             PIC  X(04)      VALUE '0684'.
   347         16  ER-2227             PIC  X(04)      VALUE '2227'.
   348         16  ER-2601             PIC  X(04)      VALUE '2601'.
   349         16  ER-2616             PIC  X(04)      VALUE '2616'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page   8
* EL1278.cbl
   350         16  ER-2617             PIC  X(04)      VALUE '2617'.
   351         16  ER-2619             PIC  X(04)      VALUE '2619'.
   352         16  ER-2740             PIC  X(04)      VALUE '2740'.
   353         16  ER-2756             PIC  X(04)      VALUE '2756'.
   354         16  ER-2768             PIC  X(04)      VALUE '2768'.
   355         16  ER-2774             PIC  X(04)      VALUE '2774'.
   356         16  ER-2775             PIC  X(04)      VALUE '2775'.
   357         16  ER-2965             PIC  X(04)      VALUE '2965'.
   358         16  ER-2966             PIC  X(04)      VALUE '2966'.
   359         16  ER-2967             PIC  X(04)      VALUE '2967'.
   360         16  ER-2968             PIC  X(04)      VALUE '2968'.
   361         16  ER-2969             PIC  X(04)      VALUE '2969'.
   362         16  ER-3037             PIC  X(04)      VALUE '3037'.
   363         16  ER-3038             PIC  X(04)      VALUE '3038'.
   364         16  ER-3039             PIC  X(04)      VALUE '3039'.
   365         16  ER-3780             PIC  X(04)      VALUE '3780'.
   366         16  ER-3781             PIC  X(04)      VALUE '3781'.
   367         16  ER-3830             PIC  X(04)      VALUE '3830'.
   368         16  ER-8160             PIC  X(04)      VALUE '8160'.
   369         16  ER-8161             PIC  X(04)      VALUE '8161'.
   370         16  ER-9999             PIC  X(04)      VALUE '9999'.
   371     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   372     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   373     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   374     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   375
   376     12  WS-RESPONSE             PIC S9(8)       COMP.
   377         88  WS-RESP-NORMAL                      VALUE +00.
   378         88  WS-RESP-NOTFND                      VALUE +13.
   379         88  WS-RESP-DUPREC                      VALUE +14.
   380         88  WS-RESP-DUPKEY                      VALUE +15.
   381         88  WS-RESP-NOTOPEN                     VALUE +19.
   382         88  WS-RESP-ENDFILE                     VALUE +20.
   383
   384     12  WS-01-CANCEL-ERR        PIC X(25)
   385         VALUE 'CANCEL DATE ERROR'.
   386     12  WS-02-CANCEL-ERR        PIC X(25)
   387         VALUE 'CERT NOT FOUND'.
   388     12  WS-04-CANCEL-ERR        PIC X(25)
   389         VALUE 'CANCEL AMOUNT ERROR'.
   390     12  WS-05-CANCEL-ERR        PIC X(25)
   391         VALUE 'CANCEL OPTION ERROR'.
   392     12  WS-06-CANCEL-ERR        PIC X(25)
   393         VALUE 'PREVIOUSLY CANCELLED'.
   394     12  WS-07-CANCEL-ERR        PIC X(25)
   395         VALUE 'INVALID DATA'.
   396     12  WS-08-CANCEL-ERR        PIC X(25)
   397         VALUE 'NO ACCOUNT MASTER'.
   398     12  WS-09-CANCEL-ERR        PIC X(25)
   399         VALUE 'SUFFIX ALREADY EXISTS'.
   400     12  WS-99-CANCEL-ERR        PIC X(25)
   401         VALUE 'MISC CANCEL ERROR'.
   402
   403 01  WS-SAVE-ALLOWABLE-BENEFIT.
   404     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   405     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   406     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   407     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page   9
* EL1278.cbl
   408     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   409     16  FILLER                    PIC XX.
   410 01  CTBL-KEY-SAVE               PIC X(5).
   411 01  CTBL-KEY.
   412     05  CTBL-COMPANY-CD         PIC X.
   413     05  CTBL-TABLE              PIC XXX.
   414     05  CTBL-BEN-TYPE           PIC X.
   415     05  CTBL-BEN-CODE           PIC XX.
   416 01  CANCEL-GEN-PASS-AREA.
   417     05  CG-OPTION-CODE          PIC X.
   418         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   419         88  CG-FLAT-CANCEL        VALUE '1'.
   420         88  CG-CANCEL             VALUE '2'.
   421         88  CG-CANCEL-REISSUE     VALUE '3'.
   422     05  CG-ERROR-CODE           PIC 99.
   423         88  CG-SUCCESS            VALUE 00.
   424         88  CG-DATE-ERROR         VALUE 01.
   425         88  CG-CERT-NOT-FOUND     VALUE 02.
   426         88  CG-AMOUNT-ERROR       VALUE 04.
   427         88  CG-OPTION-ERROR       VALUE 05.
   428         88  CG-PREV-CAN           VALUE 06.
   429         88  CG-INVALID-DATA       VALUE 07.
   430         88  CG-NO-ACCT-MSTR       VALUE 08.
   431         88  CG-SFX-A-EXIST        VALUE 09.
   432         88  CG-MISC-ERROR         VALUE 99.
   433     05  CG-COMPANY-ID           PIC XXX.
   434     05  CG-PROC-ID              PIC XXXX.
   435     05  CG-CURRENT-DT           PIC XX.
   436     05  CG-MONTH-END-DT         PIC XX.
   437     05  CG-CERT-KEY.
   438         10  CG-CERT-COMPANY-CD  PIC X.
   439         10  CG-CERT-CARRIER     PIC X.
   440         10  CG-CERT-GROUP       PIC X(6).
   441         10  CG-CERT-STATE       PIC XX.
   442         10  CG-CERT-ACCOUNT     PIC X(10).
   443         10  CG-CERT-EFF-DT      PIC XX.
   444         10  CG-CERT-CERT-NO     PIC X(11).
   445     05  CG-LF-CAN-DATA.
   446         10  CG-LF-CAN-DT        PIC XX.
   447         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   448     05  CG-AH-CAN-DATA.
   449         10  CG-AH-CAN-DT        PIC XX.
   450         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   451     05  CG-CERT-PROFILE-DATA.
   452         10  CG-INS-LNAME        PIC X(15).
   453         10  CG-INS-FNAME        PIC X(10).
   454         10  CG-INS-MID-INIT     PIC X.
   455         10  CG-INS-AGE          PIC 99.
   456         10  CG-JNT-LNAME        PIC X(15).
   457         10  CG-JNT-FNAME        PIC X(10).
   458         10  CG-JNT-MID-INIT     PIC X.
   459         10  CG-JNT-AGE          PIC 99.
   460     05  CG-LF-ISS-DATA.
   461         10  CG-LF-BENCD         PIC XX.
   462         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   463         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   464     05  CG-AH-ISS-DATA.
   465         10  CG-AH-BENCD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  10
* EL1278.cbl
   466         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   467     05  CG-BATCH-NO             PIC X(6).
   468     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   469     05  FILLER                  PIC X(306).
   470 01  WS-CAN-QUOTE-NOTE.
   471     12  WS-CN-DT-QUOTED         PIC  X(09).
   472     12  FILLER                  PIC  X(10)      VALUE
   473         'RF QUOTE: '.
   474     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   475     12  FILLER                  PIC  X(4)       VALUE
   476         ' LF '.
   477     12  WS-CN-LF-REF-METH       PIC  X.
   478     12  FILLER                  PIC  X          VALUE ','.
   479     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   480     12  FILLER                  PIC  X(5)       VALUE
   481         ' AH '.
   482     12  WS-CN-AH-REF-METH       PIC  X.
   483     12  FILLER                  PIC  XX         VALUE ','.
   484     12  FILLER                  PIC  X(6)       VALUE
   485         'TOTAL '.
   486     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   487     12  FILLER                  PIC  X(01)      VALUE ' '.
   488     12  WS-CN-CANCEL-DT         PIC  X(08).
   489     12  FILLER                  PIC  X(01)      VALUE ';'.
   490     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   491
   492 01  WS-CM-CONTROL-PRIMARY.
   493     12  WS-CM-COMPANY-CD        PIC  X(01).
   494     12  WS-CM-CARRIER           PIC  X(01).
   495     12  WS-CM-GROUPING          PIC  X(06).
   496     12  WS-CM-STATE             PIC  X(02).
   497     12  WS-CM-ACCOUNT           PIC  X(10).
   498     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   499     12  WS-CM-CERT-NO.
   500         16  WS-CM-CERT-PRIME    PIC  X(10).
   501         16  WS-CM-CERT-SFX      PIC  X(01).
   502
   503 01  WS-MA-CONTROL-PRIMARY.
   504     12  WS-MA-COMPANY-CD        PIC  X(01).
   505     12  WS-MA-CARRIER           PIC  X(01).
   506     12  WS-MA-GROUPING          PIC  X(06).
   507     12  WS-MA-STATE             PIC  X(02).
   508     12  WS-MA-ACCOUNT           PIC  X(10).
   509     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   510     12  WS-MA-CERT-NO.
   511         16  WS-MA-CERT-PRIME    PIC  X(10).
   512         16  WS-MA-CERT-SFX      PIC  X(01).
   513 01  WS-CF-CONTROL-PRIMARY.
   514     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   515     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   516*        88  COMPANY-MASTER                      VALUE '1'.
   517*        88  STATE-MASTER                        VALUE '3'.
   518*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   519*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   520     12  WS-CF-ACCESS.
   521         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   522         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   523             20  FILLER          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  11
* EL1278.cbl
   524             20  WS-CF-CARRIER   PIC  X(01).
   525     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   526
   527 01  WS-AM-CONTROL-PRIMARY.
   528     12  WS-AM-COMPANY-CD        PIC  X(01).
   529     12  WS-AM-CARRIER           PIC  X(01).
   530     12  WS-AM-GROUPING          PIC  X(06).
   531     12  WS-AM-STATE             PIC  X(02).
   532     12  WS-AM-ACCOUNT           PIC  X(10).
   533     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   534     12  WS-AM-FILLER            PIC  X(04).
   535
   536 01  WS-CN-CONTROL-PRIMARY.
   537     12  WS-CN-COMPANY-CD        PIC  X(01).
   538     12  WS-CN-CARRIER           PIC  X(01).
   539     12  WS-CN-GROUPING          PIC  X(06).
   540     12  WS-CN-STATE             PIC  X(02).
   541     12  WS-CN-ACCOUNT           PIC  X(10).
   542     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   543     12  WS-CN-CERT-NO.
   544         16  WS-CN-CERT-PRIME    PIC  X(10).
   545         16  WS-CN-CERT-SFX      PIC  X.
   546     12  WS-CN-REC-TYPE          PIC X.
   547     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   548
   549 01  WS-FO-CONTROL-PRIMARY.
   550     12  WS-FO-COMPANY-CD        PIC  X(01).
   551     12  WS-FO-STATE             PIC  X(02).
   552     12  WS-FO-FORM-ID           PIC  X(12).
   553     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  12
* EL1278.cbl
   555*                            COPY ERCCNOT.
   556******************************************************************
   557*                                                                *
   558*                            ERCCNOT                             *
   559*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   560*                            VMOD=2.003                          *
   561*                                                                *
   562*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   563*                                                                *
   564*        FILE TYPE= VSAM,KSDS                                    *
   565*        RECORD SIZE = 150    RECFORM = FIXED                    *
   566*                                                                *
   567*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   568*                                                                *
   569*        LOG = YES                                               *
   570*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   571*                                                                *
   572******************************************************************
   573*                   C H A N G E   L O G
   574*
   575* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   576*-----------------------------------------------------------------
   577*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   578* EFFECTIVE    NUMBER
   579*-----------------------------------------------------------------
   580* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   581******************************************************************
   582
   583 01  CERT-NOTE-FILE.
   584     12  CZ-RECORD-ID                PIC  XX.
   585         88  VALID-CZ-ID                  VALUE 'CZ'.
   586
   587     12  CZ-CONTROL-PRIMARY.
   588         16  CZ-COMPANY-CD           PIC X.
   589         16  CZ-CARRIER              PIC X.
   590         16  CZ-GROUPING.
   591             20 CZ-GROUPING-PREFIX   PIC XXX.
   592             20 CZ-GROUPING-PRIME    PIC XXX.
   593         16  CZ-STATE                PIC XX.
   594         16  CZ-ACCOUNT.
   595             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   596             20 CZ-ACCOUNT-PRIME     PIC X(6).
   597         16  CZ-CERT-EFF-DT          PIC XX.
   598         16  CZ-CERT-NO.
   599             20  CZ-CERT-PRIME       PIC X(10).
   600             20  CZ-CERT-SFX         PIC X.
   601         16  CZ-RECORD-TYPE          PIC X.
   602             88  CERT-NOTE           VALUE '1'.
   603             88  CLAIM-CERT-NOTE     VALUE '2'.
   604         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   605
   606     12  CZ-LAST-MAINT-DT            PIC XX.
   607     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   608     12  CZ-LAST-MAINT-USER          PIC X(4).
   609
   610     12  CZ-NOTE-INFORMATION.
   611         16  CZ-NOTE                 PIC X(63).
   612         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  13
* EL1278.cbl
   613******************************************************************
   614*                            COPY ELCDATE.
   615******************************************************************
   616*                                                                *
   617*                                                                *
   618*                            ELCDATE.                            *
   619*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   620*                            VMOD=2.003
   621*                                                                *
   622*                                                                *
   623*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   624*                 LENGTH = 200                                   *
   625******************************************************************
   626
   627 01  DATE-CONVERSION-DATA.
   628     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   629     12  DC-OPTION-CODE                PIC X.
   630         88  BIN-TO-GREG                VALUE ' '.
   631         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   632         88  EDIT-GREG-TO-BIN           VALUE '2'.
   633         88  YMD-GREG-TO-BIN            VALUE '3'.
   634         88  MDY-GREG-TO-BIN            VALUE '4'.
   635         88  JULIAN-TO-BIN              VALUE '5'.
   636         88  BIN-PLUS-ELAPSED           VALUE '6'.
   637         88  FIND-CENTURY               VALUE '7'.
   638         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   639         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   640         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   641         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   642         88  JULIAN-TO-BIN-3            VALUE 'C'.
   643         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   644         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   645         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   646         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   647         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   648         88  CHECK-LEAP-YEAR            VALUE 'H'.
   649         88  BIN-3-TO-GREG              VALUE 'I'.
   650         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   651         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   652         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   653         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   654         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   655         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   656         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   657         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   658         88  THREE-CHARACTER-BIN
   659                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   660         88  GREGORIAN-TO-BIN
   661                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   662         88  BIN-TO-GREGORIAN
   663                  VALUES ' ' '1' 'I' '8' 'G'.
   664         88  JULIAN-TO-BINARY
   665                  VALUES '5' 'C' 'E' 'F'.
   666     12  DC-ERROR-CODE                 PIC X.
   667         88  NO-CONVERSION-ERROR        VALUE ' '.
   668         88  DATE-CONVERSION-ERROR
   669                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   670         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  14
* EL1278.cbl
   671         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   672         88  DATE-IS-INVALID            VALUE '3'.
   673         88  DATE1-GREATER-DATE2        VALUE '4'.
   674         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   675         88  DATE-INVALID-OPTION        VALUE '9'.
   676         88  INVALID-CENTURY            VALUE 'A'.
   677         88  ONLY-CENTURY               VALUE 'B'.
   678         88  ONLY-LEAP-YEAR             VALUE 'C'.
   679         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   680     12  DC-END-OF-MONTH               PIC X.
   681         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   682     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   683         88  USE-NORMAL-PROCESS         VALUE ' '.
   684         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   685         88  ADJUST-UP-100-YRS          VALUE '2'.
   686     12  FILLER                        PIC X.
   687     12  DC-CONVERSION-DATES.
   688         16  DC-BIN-DATE-1             PIC XX.
   689         16  DC-BIN-DATE-2             PIC XX.
   690         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   691         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   692                       DC-GREG-DATE-1-EDIT.
   693             20  DC-EDIT1-MONTH        PIC 99.
   694             20  SLASH1-1              PIC X.
   695             20  DC-EDIT1-DAY          PIC 99.
   696             20  SLASH1-2              PIC X.
   697             20  DC-EDIT1-YEAR         PIC 99.
   698         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   699         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   700                     DC-GREG-DATE-2-EDIT.
   701             20  DC-EDIT2-MONTH        PIC 99.
   702             20  SLASH2-1              PIC X.
   703             20  DC-EDIT2-DAY          PIC 99.
   704             20  SLASH2-2              PIC X.
   705             20  DC-EDIT2-YEAR         PIC 99.
   706         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   707         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   708                     DC-GREG-DATE-1-YMD.
   709             20  DC-YMD-YEAR           PIC 99.
   710             20  DC-YMD-MONTH          PIC 99.
   711             20  DC-YMD-DAY            PIC 99.
   712         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   713         16  DC-GREG-DATE-1-MDY-R REDEFINES
   714                      DC-GREG-DATE-1-MDY.
   715             20  DC-MDY-MONTH          PIC 99.
   716             20  DC-MDY-DAY            PIC 99.
   717             20  DC-MDY-YEAR           PIC 99.
   718         16  DC-GREG-DATE-1-ALPHA.
   719             20  DC-ALPHA-MONTH        PIC X(10).
   720             20  DC-ALPHA-DAY          PIC 99.
   721             20  FILLER                PIC XX.
   722             20  DC-ALPHA-CENTURY.
   723                 24 DC-ALPHA-CEN-N     PIC 99.
   724             20  DC-ALPHA-YEAR         PIC 99.
   725         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   726         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   727         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   728         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  15
* EL1278.cbl
   729         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   730                                       PIC 9(05).
   731         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   732             20  DC-JULIAN-YEAR        PIC 99.
   733             20  DC-JULIAN-DAYS        PIC 999.
   734         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   735         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   736         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   737     12  DATE-CONVERSION-VARIBLES.
   738         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   739         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   740             20  FILLER                PIC 9(3).
   741             20  HOLD-CEN-1-CCYY.
   742                 24  HOLD-CEN-1-CC     PIC 99.
   743                 24  HOLD-CEN-1-YY     PIC 99.
   744             20  HOLD-CEN-1-MO         PIC 99.
   745             20  HOLD-CEN-1-DA         PIC 99.
   746         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   747             20  HOLD-CEN-1-R-MO       PIC 99.
   748             20  HOLD-CEN-1-R-DA       PIC 99.
   749             20  HOLD-CEN-1-R-CCYY.
   750                 24  HOLD-CEN-1-R-CC   PIC 99.
   751                 24  HOLD-CEN-1-R-YY   PIC 99.
   752             20  FILLER                PIC 9(3).
   753         16  HOLD-CENTURY-1-X.
   754             20  FILLER                PIC X(3)  VALUE SPACES.
   755             20  HOLD-CEN-1-X-CCYY.
   756                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   757                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   758             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   759             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   760         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   761             20  HOLD-CEN-1-R-X-MO     PIC XX.
   762             20  HOLD-CEN-1-R-X-DA     PIC XX.
   763             20  HOLD-CEN-1-R-X-CCYY.
   764                 24  HOLD-CEN-1-R-X-CC PIC XX.
   765                 24  HOLD-CEN-1-R-X-YY PIC XX.
   766             20  FILLER                PIC XXX.
   767         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   768         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   769         16  DC-JULIAN-DATE-1          PIC 9(07).
   770         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   771             20  DC-JULIAN-1-CCYY.
   772                 24  DC-JULIAN-1-CC    PIC 99.
   773                 24  DC-JULIAN-1-YR    PIC 99.
   774             20  DC-JULIAN-DA-1        PIC 999.
   775         16  DC-JULIAN-DATE-2          PIC 9(07).
   776         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   777             20  DC-JULIAN-2-CCYY.
   778                 24  DC-JULIAN-2-CC    PIC 99.
   779                 24  DC-JULIAN-2-YR    PIC 99.
   780             20  DC-JULIAN-DA-2        PIC 999.
   781         16  DC-GREG-DATE-A-EDIT.
   782             20  DC-EDITA-MONTH        PIC 99.
   783             20  SLASHA-1              PIC X VALUE '/'.
   784             20  DC-EDITA-DAY          PIC 99.
   785             20  SLASHA-2              PIC X VALUE '/'.
   786             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  16
* EL1278.cbl
   787                 24  DC-EDITA-CENT     PIC 99.
   788                 24  DC-EDITA-YEAR     PIC 99.
   789         16  DC-GREG-DATE-B-EDIT.
   790             20  DC-EDITB-MONTH        PIC 99.
   791             20  SLASHB-1              PIC X VALUE '/'.
   792             20  DC-EDITB-DAY          PIC 99.
   793             20  SLASHB-2              PIC X VALUE '/'.
   794             20  DC-EDITB-CCYY.
   795                 24  DC-EDITB-CENT     PIC 99.
   796                 24  DC-EDITB-YEAR     PIC 99.
   797         16  DC-GREG-DATE-CYMD         PIC 9(08).
   798         16  DC-GREG-DATE-CYMD-R REDEFINES
   799                              DC-GREG-DATE-CYMD.
   800             20  DC-CYMD-CEN           PIC 99.
   801             20  DC-CYMD-YEAR          PIC 99.
   802             20  DC-CYMD-MONTH         PIC 99.
   803             20  DC-CYMD-DAY           PIC 99.
   804         16  DC-GREG-DATE-MDCY         PIC 9(08).
   805         16  DC-GREG-DATE-MDCY-R REDEFINES
   806                              DC-GREG-DATE-MDCY.
   807             20  DC-MDCY-MONTH         PIC 99.
   808             20  DC-MDCY-DAY           PIC 99.
   809             20  DC-MDCY-CEN           PIC 99.
   810             20  DC-MDCY-YEAR          PIC 99.
   811    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   812        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   813    12  DC-EL310-DATE                  PIC X(21).
   814    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  17
* EL1278.cbl
   816*                            COPY ELCLOGOF.
   817******************************************************************
   818*                                                                *
   819*                                                                *
   820*                            ELCLOGOF.                           *
   821*                            VMOD=2.001                          *
   822*                                                                *
   823*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   824*                                                                *
   825******************************************************************
   826 01  CLASIC-LOGOFF.
   827     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   828     12  LOGOFF-TEXT.
   829         16  FILLER          PIC X(5)    VALUE SPACES.
   830         16  LOGOFF-MSG.
   831             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   832             20  FILLER      PIC X       VALUE SPACES.
   833             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   834         16  FILLER          PIC X(80)
   835           VALUE '* YOU ARE NOW LOGGED OFF'.
   836         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   837         16  FILLER          PIC X       VALUE QUOTE.
   838         16  LOGOFF-SYS-MSG  PIC X(17)
   839           VALUE 'S CLAS-IC SYSTEM '.
   840     12  TEXT-MESSAGES.
   841         16  UNACCESS-MSG    PIC X(29)
   842             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   843         16  PGMIDERR-MSG    PIC X(17)
   844             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  18
* EL1278.cbl
   846*                            COPY ELCATTR.
   847******************************************************************
   848*                                                                *
   849*                            ELCATTR.                            *
   850*                            VMOD=2.001                          *
   851*                                                                *
   852*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   853*                                                                *
   854*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   855*                                                                *
   856*                   POS 1   P=PROTECTED                          *
   857*                           U=UNPROTECTED                        *
   858*                           S=ASKIP                              *
   859*                   POS 2   A=ALPHA/NUMERIC                      *
   860*                           N=NUMERIC                            *
   861*                   POS 3   N=NORMAL                             *
   862*                           B=BRIGHT                             *
   863*                           D=DARK                               *
   864*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   865*                           OF=MODIFIED DATA TAG OFF             *
   866*                                                                *
   867*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   868******************************************************************
   869 01  ATTRIBUTE-LIST.
   870     12  AL-PABOF            PIC X       VALUE 'Y'.
   871     12  AL-PABON            PIC X       VALUE 'Z'.
   872     12  AL-PADOF            PIC X       VALUE '%'.
   873     12  AL-PADON            PIC X       VALUE '_'.
   874     12  AL-PANOF            PIC X       VALUE '-'.
   875     12  AL-PANON            PIC X       VALUE '/'.
   876     12  AL-SABOF            PIC X       VALUE '8'.
   877     12  AL-SABON            PIC X       VALUE '9'.
   878     12  AL-SADOF            PIC X       VALUE '@'.
   879     12  AL-SADON            PIC X       VALUE QUOTE.
   880     12  AL-SANOF            PIC X       VALUE '0'.
   881     12  AL-SANON            PIC X       VALUE '1'.
   882     12  AL-UABOF            PIC X       VALUE 'H'.
   883     12  AL-UABON            PIC X       VALUE 'I'.
   884     12  AL-UADOF            PIC X       VALUE '<'.
   885     12  AL-UADON            PIC X       VALUE '('.
   886     12  AL-UANOF            PIC X       VALUE ' '.
   887     12  AL-UANON            PIC X       VALUE 'A'.
   888     12  AL-UNBOF            PIC X       VALUE 'Q'.
   889     12  AL-UNBON            PIC X       VALUE 'R'.
   890     12  AL-UNDOF            PIC X       VALUE '*'.
   891     12  AL-UNDON            PIC X       VALUE ')'.
   892     12  AL-UNNOF            PIC X       VALUE '&'.
   893     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  19
* EL1278.cbl
   895*                            COPY ELCEMIB.
   896******************************************************************
   897*                                                                *
   898*                                                                *
   899*                            ELCEMIB.                            *
   900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   901*                            VMOD=2.005                          *
   902*                                                                *
   903*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   904*                                                                *
   905******************************************************************
   906 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   907     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   908     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   909     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   910     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   911     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   912     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   913     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   914     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   915     12  EMI-SWITCH1             PIC X        VALUE '1'.
   916         88  EMI-NO-ERRORS                    VALUE '1'.
   917         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   918         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   919     12  EMI-SWITCH2             PIC X        VALUE '1'.
   920         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   921     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   922         88  EMI-AREA1-EMPTY                  VALUE '1'.
   923         88  EMI-AREA1-FULL                   VALUE '2'.
   924     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   925         88  EMI-AREA2-EMPTY                  VALUE '1'.
   926         88  EMI-AREA2-FULL                   VALUE '2'.
   927     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   928         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   929         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   930         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   931         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   932         88  EMI-BYPASS-FATALS                VALUE 'X'.
   933     12  EMI-ERROR-LINES.
   934         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   935         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   936         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   937         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   938             20  EMI-ERR-CODES OCCURS 10 TIMES.
   939                 24  EMI-ERR-NUM         PIC X(4).
   940                 24  EMI-FILLER          PIC X.
   941                 24  EMI-SEV             PIC X.
   942                 24  FILLER              PIC X.
   943             20  FILLER                  PIC X(02).
   944     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   945         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   946             20  EMI-ERROR-NUMBER    PIC X(4).
   947             20  EMI-FILL            PIC X.
   948             20  EMI-SEVERITY        PIC X.
   949             20  FILLER              PIC X.
   950             20  EMI-ERROR-TEXT.
   951                 24  EMI-TEXT-VARIABLE   PIC X(10).
   952                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  20
* EL1278.cbl
   953     12  EMI-SEVERITY-SAVE           PIC X.
   954         88  EMI-NOTE                    VALUE 'N'.
   955         88  EMI-WARNING                 VALUE 'W'.
   956         88  EMI-FORCABLE                VALUE 'F'.
   957         88  EMI-FATAL                   VALUE 'X'.
   958     12  EMI-MESSAGE-FLAG            PIC X.
   959         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   960         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   961     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   962     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   963         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   964         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   965         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   966     12  emi-claim-no                pic x(7).
   967     12  emi-claim-type              pic x(6).
   968     12  FILLER                      PIC X(124)  VALUE SPACES.
   969     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   970     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   971     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   972     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  21
* EL1278.cbl
   974 01  WS-PASS-631.
   975     12  WS-PASS-WORK-AREA         PIC X(384).
   976     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   977     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   978*        COPY ELC631PI.
   979******************************************************************
   980*                                                                *
   981*                                                                *
   982*                            ELC631PI                            *
   983*                            VMOD=2.012                          *
   984*                                                                *
   985*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   986*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   987*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   988*                                                                *
   989*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   990*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   991*    BETWEEN PROGRAMS.                                           *
   992*                                                                *
   993*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   994*                                                                *
   995*               EL631 - EL6311 - EL6312 - EL6313                 *
   996*                                                                *
   997******************************************************************
   998
   999         16  PI-631-DATA.
  1000             20  PI-ERPNDB-KEY.
  1001                 24  PI-PB-COMPANY-CD     PIC X.
  1002                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  1003                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  1004                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  1005
  1006             20  PI-ERPNDB-ALT-KEY.
  1007                 24  PI-PB-COMPANY-CD-A1  PIC X.
  1008                 24  PI-PB-CARRIER        PIC X.
  1009                 24  PI-PB-GROUPING       PIC X(6).
  1010                 24  PI-PB-STATE          PIC XX.
  1011                 24  PI-PB-ACCOUNT        PIC X(10).
  1012                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1013                 24  PI-PB-CERT-NO.
  1014                     28  PI-PB-CERT-PRIME PIC X(10).
  1015                     28  PI-PB-CERT-SFX   PIC X.
  1016                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1017                 24  PI-PB-RECORD-TYPE    PIC X.
  1018
  1019             20  PI-ERPNDB-CSR-KEY.
  1020                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1021                 24  PI-PB-CSR-ID             PIC X(4).
  1022                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  1023                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1024                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1025
  1026             20  PI-BROWSE-TYPE               PIC X.
  1027                 88  PI-FILE-BROWSE             VALUE ' '.
  1028                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1029                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1030                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1031                 88  PI-CSR-BROWSE              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  22
* EL1278.cbl
  1032
  1033             20  PI-MAINT-FUNCTION            PIC X.
  1034                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1035                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1036                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1037                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1038                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1039                 88  PI-PF5-FUNCTION            VALUE '5'.
  1040                 88  PI-PF6-FUNCTION            VALUE '6'.
  1041
  1042             20  PI-FILE-SWITCHES.
  1043                 24  PI-ALL-ISSUES-SW         PIC X.
  1044                     88  ALL-ISSUES             VALUE 'Y'.
  1045                 24  PI-ALL-CANCELS-SW        PIC X.
  1046                     88  ALL-CANCELS            VALUE 'Y'.
  1047                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1048                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1049                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1050                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1051                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1052                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1053                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1054                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1055                 24  PI-HOLD-REC-SW           PIC X.
  1056                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1057                 24  PI-CHANGE-REC-SW         PIC X.
  1058                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1059                 24  PI-CHK-REQ-REC-SW        PIC X.
  1060                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1061                 24  PI-ISSUE-WARNING-SW      PIC X.
  1062                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1063                 24  PI-CANCEL-WARNING-SW     PIC X.
  1064                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1065             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1066                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1067             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1068                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1069
  1070             20  PI-MAP-NAME                  PIC X(8).
  1071
  1072             20  PI-CURSOR                    PIC S9(4) COMP.
  1073
  1074             20  PI-PREV-ALT-KEY              PIC X(36).
  1075             20  PI-PREV-CSR-KEY              PIC X(15).
  1076             20  PI-PREV-KEY.
  1077                 24  PI-PREV-COMPANY-CD       PIC X.
  1078                 24  PI-PREV-BATCH            PIC X(6).
  1079                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1080                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  1081             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1082             20  PI-BROWSE-SW                 PIC X.
  1083                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1084                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1085             20  PI-SV-CARRIER                PIC X.
  1086             20  PI-SV-GROUPING               PIC X(6).
  1087             20  PI-SV-STATE                  PIC XX.
  1088             20  PI-EDIT-SW                   PIC X.
  1089             20  PI-DISPLAY-SW                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  23
* EL1278.cbl
  1090                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1091                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1092             20  PI-CRITERIA-DATA             PIC X(350).
  1093             20  PI-BMODE                     PIC X.
  1094             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1095             20  PI-BPMTS                     PIC S999     COMP-3.
  1096             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1097             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1098             20  PI-CSR-SESSION-SW            PIC X.
  1099                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1100             20  PI-ERRORS-SW                 PIC X.
  1101                 88  FATAL-ERRORS               VALUE 'X'.
  1102*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1103             20  FILLER                       PIC X(5).
  1104
  1105         16  FILLER                PIC X(94).
  1106
  1107
  1108*                            COPY ELCINTF.
  1109******************************************************************
  1110*                                                                *
  1111*                                                                *
  1112*                            ELCINTF.                            *
  1113*                            VMOD=2.017                          *
  1114*                                                                *
  1115*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1116*                                                                *
  1117*       LENGTH = 1024                                            *
  1118*                                                                *
  1119******************************************************************
  1120*                   C H A N G E   L O G
  1121*
  1122* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1123*-----------------------------------------------------------------
  1124*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1125* EFFECTIVE    NUMBER
  1126*-----------------------------------------------------------------
  1127* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1128******************************************************************
  1129 01  PROGRAM-INTERFACE-BLOCK.
  1130     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1131     12  PI-CALLING-PROGRAM              PIC X(8).
  1132     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1133     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1134     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1135     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1136     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1137     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1138     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1139     12  PI-COMPANY-ID                   PIC XXX.
  1140     12  PI-COMPANY-CD                   PIC X.
  1141
  1142     12  PI-COMPANY-PASSWORD             PIC X(8).
  1143
  1144     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1145
  1146     12  PI-CONTROL-IN-PROGRESS.
  1147         16  PI-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  24
* EL1278.cbl
  1148         16  PI-GROUPING                 PIC X(6).
  1149         16  PI-STATE                    PIC XX.
  1150         16  PI-ACCOUNT                  PIC X(10).
  1151         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1152                                         PIC X(10).
  1153         16  PI-CLAIM-CERT-GRP.
  1154             20  PI-CLAIM-NO             PIC X(7).
  1155             20  PI-CERT-NO.
  1156                 25  PI-CERT-PRIME       PIC X(10).
  1157                 25  PI-CERT-SFX         PIC X.
  1158             20  PI-CERT-EFF-DT          PIC XX.
  1159         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1160             20  PI-PLAN-CODE            PIC X(2).
  1161             20  PI-REVISION-NUMBER      PIC X(3).
  1162             20  PI-PLAN-EFF-DT          PIC X(2).
  1163             20  PI-PLAN-EXP-DT          PIC X(2).
  1164             20  FILLER                  PIC X(11).
  1165         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1166             20  PI-OE-REFERENCE-1.
  1167                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1168                 25  PI-OE-REF-1-SUFF    PIC XX.
  1169
  1170     12  PI-SESSION-IN-PROGRESS          PIC X.
  1171         88  CLAIM-SESSION                   VALUE '1'.
  1172         88  CREDIT-SESSION                  VALUE '2'.
  1173         88  WARRANTY-SESSION                VALUE '3'.
  1174         88  MORTGAGE-SESSION                VALUE '4'.
  1175         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1176
  1177
  1178*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1179
  1180     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1181     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1182
  1183     12  PI-CREDIT-USER                  PIC X.
  1184         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1185         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1186
  1187     12  PI-CLAIM-USER                   PIC X.
  1188         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1189         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1190
  1191     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1192         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1193         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1194         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1195         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1196         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1197
  1198     12  PI-PROCESSOR-ID                 PIC X(4).
  1199
  1200     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1201
  1202     12  PI-MEMBER-CAPTION               PIC X(10).
  1203
  1204     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1205         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  25
* EL1278.cbl
  1206
  1207     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1208     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1209     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1210     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1211
  1212     12  PI-AH-OVERRIDE-L1               PIC X.
  1213     12  PI-AH-OVERRIDE-L2               PIC XX.
  1214     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1215     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1216
  1217     12  PI-NEW-SYSTEM                   PIC X(2).
  1218
  1219     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1220     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1221         88  PI-USES-PAID-TO                 VALUE '1'.
  1222     12  PI-CRDTCRD-SYSTEM.
  1223         16  PI-CRDTCRD-USER             PIC X.
  1224             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1225             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1226         16  PI-CC-MONTH-END-DT          PIC XX.
  1227     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1228
  1229     12  PI-OE-REFERENCE-2.
  1230         16  PI-OE-REF-2-PRIME           PIC X(10).
  1231         16  PI-OE-REF-2-SUFF            PIC X.
  1232
  1233     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1234
  1235     12  PI-LANGUAGE-TYPE                PIC X.
  1236             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1237             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1238             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1239
  1240     12  PI-POLICY-LINKAGE-IND           PIC X.
  1241         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1242         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1243                                                   LOW-VALUES.
  1244
  1245     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1246     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1247         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1248         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1249
  1250     12  PI-PROCESSOR-CSR-IND            PIC X.
  1251         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1252         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1253
  1254     12  FILLER                          PIC X(3).
  1255
  1256     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1257
  1258     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1259         PI-SYSTEM-LEVEL.
  1260
  1261         16  PI-ENTRY-CODES.
  1262             20  PI-ENTRY-CD-1           PIC X.
  1263             20  PI-ENTRY-CD-2           PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  26
* EL1278.cbl
  1264
  1265         16  PI-RETURN-CODES.
  1266             20  PI-RETURN-CD-1          PIC X.
  1267             20  PI-RETURN-CD-2          PIC X.
  1268
  1269         16  PI-UPDATE-STATUS-SAVE.
  1270             20  PI-UPDATE-BY            PIC X(4).
  1271             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1272
  1273         16  PI-LOWER-CASE-LETTERS       PIC X.
  1274             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1275
  1276*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1277*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1278*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1279
  1280         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1281             88  ST-ACCNT-CNTL               VALUE ' '.
  1282             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1283             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1284             88  ACCNT-CNTL                  VALUE '3'.
  1285             88  CARR-ACCNT-CNTL             VALUE '4'.
  1286
  1287         16  PI-PROCESSOR-CAP-LIST.
  1288             20  PI-SYSTEM-CONTROLS.
  1289                24 PI-SYSTEM-DISPLAY     PIC X.
  1290                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1291                24 PI-SYSTEM-MODIFY      PIC X.
  1292                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1293             20  FILLER                  PIC XX.
  1294             20  PI-DISPLAY-CAP          PIC X.
  1295                 88  DISPLAY-CAP             VALUE 'Y'.
  1296             20  PI-MODIFY-CAP           PIC X.
  1297                 88  MODIFY-CAP              VALUE 'Y'.
  1298             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1299                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1300             20  PI-FORCE-CAP            PIC X.
  1301                 88  FORCE-CAP               VALUE 'Y'.
  1302
  1303         16  PI-PROGRAM-CONTROLS.
  1304             20  PI-PGM-PRINT-OPT        PIC X.
  1305             20  PI-PGM-FORMAT-OPT       PIC X.
  1306             20  PI-PGM-PROCESS-OPT      PIC X.
  1307             20  PI-PGM-TOTALS-OPT       PIC X.
  1308
  1309         16  PI-HELP-INTERFACE.
  1310             20  PI-LAST-ERROR-NO        PIC X(4).
  1311             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1312
  1313         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1314             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1315
  1316         16  PI-CR-CONTROL-IN-PROGRESS.
  1317             20  PI-CR-CARRIER           PIC X.
  1318             20  PI-CR-GROUPING          PIC X(6).
  1319             20  PI-CR-STATE             PIC XX.
  1320             20  PI-CR-ACCOUNT           PIC X(10).
  1321             20  PI-CR-FIN-RESP          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  27
* EL1278.cbl
  1322             20  PI-CR-TYPE              PIC X.
  1323
  1324         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1325
  1326         16  PI-CR-MONTH-END-DT          PIC XX.
  1327
  1328         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1329             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1330             88  PI-ZERO-CARRIER             VALUE '1'.
  1331             88  PI-ZERO-GROUPING            VALUE '2'.
  1332             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1333
  1334         16  PI-CARRIER-SECURITY         PIC X.
  1335             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1336
  1337         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1338             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1339             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1340
  1341         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1342             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1343                                         INDEXED BY PI-ACCESS-NDX
  1344                                         PIC X.
  1345
  1346         16  PI-GA-BILLING-CONTROL       PIC X.
  1347             88  PI-GA-BILLING               VALUE '1'.
  1348
  1349         16  PI-MAIL-PROCESSING          PIC X.
  1350             88  PI-MAIL-YES                 VALUE 'Y'.
  1351
  1352         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1353
  1354         16  PI-AR-SYSTEM.
  1355             20  PI-AR-PROCESSING-CNTL   PIC X.
  1356                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1357             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1358             20  PI-AR-MONTH-END-DT      PIC XX.
  1359
  1360         16  PI-MP-SYSTEM.
  1361             20  PI-MORTGAGE-USER            PIC X.
  1362                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1363                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1364             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1365                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1366                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1367                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1368                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1369                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1370             20  PI-MP-MONTH-END-DT          PIC XX.
  1371             20  PI-MP-REFERENCE-NO.
  1372                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1373                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1374
  1375         16  PI-LABEL-CONTROL            PIC X(01).
  1376             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1377             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1378
  1379         16  PI-BILL-GROUPING-CODE       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  28
* EL1278.cbl
  1380             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1381
  1382         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1383             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1384             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1385
  1386         16  FILLER                      PIC X(14).
  1387
  1388     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1389******************************************************************
  1390     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1391         16  FILLER                PIC  X(500).
  1392         16  PI-PEND-SW            PIC  X(01).
  1393         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1394         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1395         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1396         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1397         16  PI-EARNING-METHOD-LF  PIC  X.
  1398         16  PI-EARNING-METHOD-AH  PIC  X.
  1399         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1400         16  PI-LF-REFUND-METH     PIC  X.
  1401         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1402         16  PI-AH-REFUND-METH     PIC  X.
  1403         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1404         16  PI-MODIFY-CERT-CAP    PIC  X.
  1405             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1406         16  PI-CLP-YN             PIC X.
  1407         16  PI-CANCEL-REASON      PIC X.
  1408         16  FILLER                PIC  X(97).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  29
* EL1278.cbl
  1410*                            COPY ELCAID.
  1411******************************************************************
  1412*                                                                *
  1413*                            ELCAID.                             *
  1414*                            VMOD=2.001                          *
  1415*                                                                *
  1416*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1417*                                                                *
  1418*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1419*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1420******************************************************************
  1421
  1422 01  DFHAID.
  1423   02  DFHNULL   PIC  X  VALUE  ' '.
  1424   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1425   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1426   02  DFHPEN    PIC  X  VALUE  '='.
  1427   02  DFHOPID   PIC  X  VALUE  'W'.
  1428   02  DFHPA1    PIC  X  VALUE  '%'.
  1429   02  DFHPA2    PIC  X  VALUE  '>'.
  1430   02  DFHPA3    PIC  X  VALUE  ','.
  1431   02  DFHPF1    PIC  X  VALUE  '1'.
  1432   02  DFHPF2    PIC  X  VALUE  '2'.
  1433   02  DFHPF3    PIC  X  VALUE  '3'.
  1434   02  DFHPF4    PIC  X  VALUE  '4'.
  1435   02  DFHPF5    PIC  X  VALUE  '5'.
  1436   02  DFHPF6    PIC  X  VALUE  '6'.
  1437   02  DFHPF7    PIC  X  VALUE  '7'.
  1438   02  DFHPF8    PIC  X  VALUE  '8'.
  1439   02  DFHPF9    PIC  X  VALUE  '9'.
  1440   02  DFHPF10   PIC  X  VALUE  ':'.
  1441   02  DFHPF11   PIC  X  VALUE  '#'.
  1442   02  DFHPF12   PIC  X  VALUE  '@'.
  1443   02  DFHPF13   PIC  X  VALUE  'A'.
  1444   02  DFHPF14   PIC  X  VALUE  'B'.
  1445   02  DFHPF15   PIC  X  VALUE  'C'.
  1446   02  DFHPF16   PIC  X  VALUE  'D'.
  1447   02  DFHPF17   PIC  X  VALUE  'E'.
  1448   02  DFHPF18   PIC  X  VALUE  'F'.
  1449   02  DFHPF19   PIC  X  VALUE  'G'.
  1450   02  DFHPF20   PIC  X  VALUE  'H'.
  1451   02  DFHPF21   PIC  X  VALUE  'I'.
  1452*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1453   02  DFHPF22   PIC  X  VALUE  '['.
  1454   02  DFHPF23   PIC  X  VALUE  '.'.
  1455   02  DFHPF24   PIC  X  VALUE  '<'.
  1456   02  DFHMSRE   PIC  X  VALUE  'X'.
  1457   02  DFHSTRF   PIC  X  VALUE  'h'.
  1458   02  DFHTRIG   PIC  X  VALUE  '"'.
  1459
  1460 01  FILLER  REDEFINES  DFHAID.
  1461     12  FILLER                  PIC  X(08).
  1462     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  30
* EL1278.cbl
  1464*                            COPY EL1278S.
  1465 01  EL127HI.
  1466     05  FILLER            PIC  X(0012).
  1467*    -------------------------------
  1468     05  HDATEL PIC S9(0004) COMP.
  1469     05  HDATEF PIC  X(0001).
  1470     05  FILLER REDEFINES HDATEF.
  1471         10  HDATEA PIC  X(0001).
  1472     05  HDATEI PIC  X(0008).
  1473*    -------------------------------
  1474     05  HTIMEL PIC S9(0004) COMP.
  1475     05  HTIMEF PIC  X(0001).
  1476     05  FILLER REDEFINES HTIMEF.
  1477         10  HTIMEA PIC  X(0001).
  1478     05  HTIMEI PIC  999V99.
  1479*    -------------------------------
  1480     05  CMPNYIDL PIC S9(0004) COMP.
  1481     05  CMPNYIDF PIC  X(0001).
  1482     05  FILLER REDEFINES CMPNYIDF.
  1483         10  CMPNYIDA PIC  X(0001).
  1484     05  CMPNYIDI PIC  X(0003).
  1485*    -------------------------------
  1486     05  USERIDL PIC S9(0004) COMP.
  1487     05  USERIDF PIC  X(0001).
  1488     05  FILLER REDEFINES USERIDF.
  1489         10  USERIDA PIC  X(0001).
  1490     05  USERIDI PIC  X(0004).
  1491*    -------------------------------
  1492     05  HCARIERL PIC S9(0004) COMP.
  1493     05  HCARIERF PIC  X(0001).
  1494     05  FILLER REDEFINES HCARIERF.
  1495         10  HCARIERA PIC  X(0001).
  1496     05  HCARIERI PIC  X(0001).
  1497*    -------------------------------
  1498     05  HGROUPL PIC S9(0004) COMP.
  1499     05  HGROUPF PIC  X(0001).
  1500     05  FILLER REDEFINES HGROUPF.
  1501         10  HGROUPA PIC  X(0001).
  1502     05  HGROUPI PIC  X(0006).
  1503*    -------------------------------
  1504     05  HSTATEL PIC S9(0004) COMP.
  1505     05  HSTATEF PIC  X(0001).
  1506     05  FILLER REDEFINES HSTATEF.
  1507         10  HSTATEA PIC  X(0001).
  1508     05  HSTATEI PIC  X(0002).
  1509*    -------------------------------
  1510     05  HACCTNOL PIC S9(0004) COMP.
  1511     05  HACCTNOF PIC  X(0001).
  1512     05  FILLER REDEFINES HACCTNOF.
  1513         10  HACCTNOA PIC  X(0001).
  1514     05  HACCTNOI PIC  X(0010).
  1515*    -------------------------------
  1516     05  HEFFDTL PIC S9(0004) COMP.
  1517     05  HEFFDTF PIC  X(0001).
  1518     05  FILLER REDEFINES HEFFDTF.
  1519         10  HEFFDTA PIC  X(0001).
  1520     05  HEFFDTI PIC  X(0008).
  1521*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  31
* EL1278.cbl
  1522     05  HCERTNOL PIC S9(0004) COMP.
  1523     05  HCERTNOF PIC  X(0001).
  1524     05  FILLER REDEFINES HCERTNOF.
  1525         10  HCERTNOA PIC  X(0001).
  1526     05  HCERTNOI PIC  X(0010).
  1527*    -------------------------------
  1528     05  HCRTSFXL PIC S9(0004) COMP.
  1529     05  HCRTSFXF PIC  X(0001).
  1530     05  FILLER REDEFINES HCRTSFXF.
  1531         10  HCRTSFXA PIC  X(0001).
  1532     05  HCRTSFXI PIC  X(0001).
  1533*    -------------------------------
  1534     05  HLNAMEL PIC S9(0004) COMP.
  1535     05  HLNAMEF PIC  X(0001).
  1536     05  FILLER REDEFINES HLNAMEF.
  1537         10  HLNAMEA PIC  X(0001).
  1538     05  HLNAMEI PIC  X(0015).
  1539*    -------------------------------
  1540     05  HFNAMEL PIC S9(0004) COMP.
  1541     05  HFNAMEF PIC  X(0001).
  1542     05  FILLER REDEFINES HFNAMEF.
  1543         10  HFNAMEA PIC  X(0001).
  1544     05  HFNAMEI PIC  X(0010).
  1545*    -------------------------------
  1546     05  HINITL PIC S9(0004) COMP.
  1547     05  HINITF PIC  X(0001).
  1548     05  FILLER REDEFINES HINITF.
  1549         10  HINITA PIC  X(0001).
  1550     05  HINITI PIC  X(0001).
  1551*    -------------------------------
  1552     05  LCLMDTHL PIC S9(0004) COMP.
  1553     05  LCLMDTHF PIC  X(0001).
  1554     05  FILLER REDEFINES LCLMDTHF.
  1555         10  LCLMDTHA PIC  X(0001).
  1556     05  LCLMDTHI PIC  X(0022).
  1557*    -------------------------------
  1558     05  LCLMDTL PIC S9(0004) COMP.
  1559     05  LCLMDTF PIC  X(0001).
  1560     05  FILLER REDEFINES LCLMDTF.
  1561         10  LCLMDTA PIC  X(0001).
  1562     05  LCLMDTI PIC  X(0008).
  1563*    -------------------------------
  1564     05  HPCYNL PIC S9(0004) COMP.
  1565     05  HPCYNF PIC  X(0001).
  1566     05  FILLER REDEFINES HPCYNF.
  1567         10  HPCYNA PIC  X(0001).
  1568     05  HPCYNI PIC  X(0001).
  1569*    -------------------------------
  1570     05  ACLMDTHL PIC S9(0004) COMP.
  1571     05  ACLMDTHF PIC  X(0001).
  1572     05  FILLER REDEFINES ACLMDTHF.
  1573         10  ACLMDTHA PIC  X(0001).
  1574     05  ACLMDTHI PIC  X(0023).
  1575*    -------------------------------
  1576     05  ACLMDTL PIC S9(0004) COMP.
  1577     05  ACLMDTF PIC  X(0001).
  1578     05  FILLER REDEFINES ACLMDTF.
  1579         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  32
* EL1278.cbl
  1580     05  ACLMDTI PIC  X(0008).
  1581*    -------------------------------
  1582     05  PMTHDL PIC S9(0004) COMP.
  1583     05  PMTHDF PIC  X(0001).
  1584     05  FILLER REDEFINES PMTHDF.
  1585         10  PMTHDA PIC  X(0001).
  1586     05  PMTHDI PIC  X(0010).
  1587*    -------------------------------
  1588     05  CNCDTHDL PIC S9(0004) COMP.
  1589     05  CNCDTHDF PIC  X(0001).
  1590     05  FILLER REDEFINES CNCDTHDF.
  1591         10  CNCDTHDA PIC  X(0001).
  1592     05  CNCDTHDI PIC  X(0007).
  1593*    -------------------------------
  1594     05  HLKINDL PIC S9(0004) COMP.
  1595     05  HLKINDF PIC  X(0001).
  1596     05  FILLER REDEFINES HLKINDF.
  1597         10  HLKINDA PIC  X(0001).
  1598     05  HLKINDI PIC  X(0002).
  1599*    -------------------------------
  1600     05  HLCDL PIC S9(0004) COMP.
  1601     05  HLCDF PIC  X(0001).
  1602     05  FILLER REDEFINES HLCDF.
  1603         10  HLCDA PIC  X(0001).
  1604     05  HLCDI PIC  X(0002).
  1605*    -------------------------------
  1606     05  HLEDESCL PIC S9(0004) COMP.
  1607     05  HLEDESCF PIC  X(0001).
  1608     05  FILLER REDEFINES HLEDESCF.
  1609         10  HLEDESCA PIC  X(0001).
  1610     05  HLEDESCI PIC  X(0003).
  1611*    -------------------------------
  1612     05  HLTERML PIC S9(0004) COMP.
  1613     05  HLTERMF PIC  X(0001).
  1614     05  FILLER REDEFINES HLTERMF.
  1615         10  HLTERMA PIC  X(0001).
  1616     05  HLTERMI PIC  9(3).
  1617*    -------------------------------
  1618     05  HLREML PIC S9(0004) COMP.
  1619     05  HLREMF PIC  X(0001).
  1620     05  FILLER REDEFINES HLREMF.
  1621         10  HLREMA PIC  X(0001).
  1622     05  HLREMI PIC  X(0003).
  1623*    -------------------------------
  1624     05  HLPREML PIC S9(0004) COMP.
  1625     05  HLPREMF PIC  X(0001).
  1626     05  FILLER REDEFINES HLPREMF.
  1627         10  HLPREMA PIC  X(0001).
  1628     05  HLPREMI PIC  X(0011).
  1629*    -------------------------------
  1630     05  HLITDRL PIC S9(0004) COMP.
  1631     05  HLITDRF PIC  X(0001).
  1632     05  FILLER REDEFINES HLITDRF.
  1633         10  HLITDRA PIC  X(0001).
  1634     05  HLITDRI PIC  X(0011).
  1635*    -------------------------------
  1636     05  HLREFNDL PIC S9(0004) COMP.
  1637     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  33
* EL1278.cbl
  1638     05  FILLER REDEFINES HLREFNDF.
  1639         10  HLREFNDA PIC  X(0001).
  1640     05  HLREFNDI PIC  X(0011).
  1641*    -------------------------------
  1642     05  HLCANCL PIC S9(0004) COMP.
  1643     05  HLCANCF PIC  X(0001).
  1644     05  FILLER REDEFINES HLCANCF.
  1645         10  HLCANCA PIC  X(0001).
  1646     05  HLCANCI PIC  X(0008).
  1647*    -------------------------------
  1648     05  HLCAL1L PIC S9(0004) COMP.
  1649     05  HLCAL1F PIC  X(0001).
  1650     05  FILLER REDEFINES HLCAL1F.
  1651         10  HLCAL1A PIC  X(0001).
  1652     05  HLCAL1I PIC  X(0001).
  1653*    -------------------------------
  1654     05  HLCALCL PIC S9(0004) COMP.
  1655     05  HLCALCF PIC  X(0001).
  1656     05  FILLER REDEFINES HLCALCF.
  1657         10  HLCALCA PIC  X(0001).
  1658     05  HLCALCI PIC  X(0012).
  1659*    -------------------------------
  1660     05  HAKINDL PIC S9(0004) COMP.
  1661     05  HAKINDF PIC  X(0001).
  1662     05  FILLER REDEFINES HAKINDF.
  1663         10  HAKINDA PIC  X(0001).
  1664     05  HAKINDI PIC  X(0002).
  1665*    -------------------------------
  1666     05  HACDL PIC S9(0004) COMP.
  1667     05  HACDF PIC  X(0001).
  1668     05  FILLER REDEFINES HACDF.
  1669         10  HACDA PIC  X(0001).
  1670     05  HACDI PIC  X(0002).
  1671*    -------------------------------
  1672     05  HAEDESCL PIC S9(0004) COMP.
  1673     05  HAEDESCF PIC  X(0001).
  1674     05  FILLER REDEFINES HAEDESCF.
  1675         10  HAEDESCA PIC  X(0001).
  1676     05  HAEDESCI PIC  X(0003).
  1677*    -------------------------------
  1678     05  HATERML PIC S9(0004) COMP.
  1679     05  HATERMF PIC  X(0001).
  1680     05  FILLER REDEFINES HATERMF.
  1681         10  HATERMA PIC  X(0001).
  1682     05  HATERMI PIC  9(3).
  1683*    -------------------------------
  1684     05  HAREML PIC S9(0004) COMP.
  1685     05  HAREMF PIC  X(0001).
  1686     05  FILLER REDEFINES HAREMF.
  1687         10  HAREMA PIC  X(0001).
  1688     05  HAREMI PIC  X(0003).
  1689*    -------------------------------
  1690     05  HAPREML PIC S9(0004) COMP.
  1691     05  HAPREMF PIC  X(0001).
  1692     05  FILLER REDEFINES HAPREMF.
  1693         10  HAPREMA PIC  X(0001).
  1694     05  HAPREMI PIC  X(0011).
  1695*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  34
* EL1278.cbl
  1696     05  HAITDRL PIC S9(0004) COMP.
  1697     05  HAITDRF PIC  X(0001).
  1698     05  FILLER REDEFINES HAITDRF.
  1699         10  HAITDRA PIC  X(0001).
  1700     05  HAITDRI PIC  X(0011).
  1701*    -------------------------------
  1702     05  HAREFNDL PIC S9(0004) COMP.
  1703     05  HAREFNDF PIC  X(0001).
  1704     05  FILLER REDEFINES HAREFNDF.
  1705         10  HAREFNDA PIC  X(0001).
  1706     05  HAREFNDI PIC  X(0011).
  1707*    -------------------------------
  1708     05  HACANCL PIC S9(0004) COMP.
  1709     05  HACANCF PIC  X(0001).
  1710     05  FILLER REDEFINES HACANCF.
  1711         10  HACANCA PIC  X(0001).
  1712     05  HACANCI PIC  X(0008).
  1713*    -------------------------------
  1714     05  HACAL1L PIC S9(0004) COMP.
  1715     05  HACAL1F PIC  X(0001).
  1716     05  FILLER REDEFINES HACAL1F.
  1717         10  HACAL1A PIC  X(0001).
  1718     05  HACAL1I PIC  X(0001).
  1719*    -------------------------------
  1720     05  HACALCL PIC S9(0004) COMP.
  1721     05  HACALCF PIC  X(0001).
  1722     05  FILLER REDEFINES HACALCF.
  1723         10  HACALCA PIC  X(0001).
  1724     05  HACALCI PIC  X(0012).
  1725*    -------------------------------
  1726     05  TOPREML PIC S9(0004) COMP.
  1727     05  TOPREMF PIC  X(0001).
  1728     05  FILLER REDEFINES TOPREMF.
  1729         10  TOPREMA PIC  X(0001).
  1730     05  TOPREMI PIC  X(0011).
  1731*    -------------------------------
  1732     05  TOITDRL PIC S9(0004) COMP.
  1733     05  TOITDRF PIC  X(0001).
  1734     05  FILLER REDEFINES TOITDRF.
  1735         10  TOITDRA PIC  X(0001).
  1736     05  TOITDRI PIC  X(0011).
  1737*    -------------------------------
  1738     05  TORFNDL PIC S9(0004) COMP.
  1739     05  TORFNDF PIC  X(0001).
  1740     05  FILLER REDEFINES TORFNDF.
  1741         10  TORFNDA PIC  X(0001).
  1742     05  TORFNDI PIC  X(0011).
  1743*    -------------------------------
  1744     05  CANREAHL PIC S9(0004) COMP.
  1745     05  CANREAHF PIC  X(0001).
  1746     05  FILLER REDEFINES CANREAHF.
  1747         10  CANREAHA PIC  X(0001).
  1748     05  CANREAHI PIC  X(0015).
  1749*    -------------------------------
  1750     05  CANREAL PIC S9(0004) COMP.
  1751     05  CANREAF PIC  X(0001).
  1752     05  FILLER REDEFINES CANREAF.
  1753         10  CANREAA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  35
* EL1278.cbl
  1754     05  CANREAI PIC  X(0001).
  1755*    -------------------------------
  1756     05  CLPYNHL PIC S9(0004) COMP.
  1757     05  CLPYNHF PIC  X(0001).
  1758     05  FILLER REDEFINES CLPYNHF.
  1759         10  CLPYNHA PIC  X(0001).
  1760     05  CLPYNHI PIC  X(0005).
  1761*    -------------------------------
  1762     05  CLPYNL PIC S9(0004) COMP.
  1763     05  CLPYNF PIC  X(0001).
  1764     05  FILLER REDEFINES CLPYNF.
  1765         10  CLPYNA PIC  X(0001).
  1766     05  CLPYNI PIC  X(0001).
  1767*    -------------------------------
  1768     05  HLREDL PIC S9(0004) COMP.
  1769     05  HLREDF PIC  X(0001).
  1770     05  FILLER REDEFINES HLREDF.
  1771         10  HLREDA PIC  X(0001).
  1772     05  HLREDI PIC  X(0014).
  1773*    -------------------------------
  1774     05  FREMTRML PIC S9(0004) COMP.
  1775     05  FREMTRMF PIC  X(0001).
  1776     05  FILLER REDEFINES FREMTRMF.
  1777         10  FREMTRMA PIC  X(0001).
  1778     05  FREMTRMI PIC  X(0003).
  1779*    -------------------------------
  1780     05  HERMSG1L PIC S9(0004) COMP.
  1781     05  HERMSG1F PIC  X(0001).
  1782     05  FILLER REDEFINES HERMSG1F.
  1783         10  HERMSG1A PIC  X(0001).
  1784     05  HERMSG1I PIC  X(0079).
  1785*    -------------------------------
  1786     05  HERMSG2L PIC S9(0004) COMP.
  1787     05  HERMSG2F PIC  X(0001).
  1788     05  FILLER REDEFINES HERMSG2F.
  1789         10  HERMSG2A PIC  X(0001).
  1790     05  HERMSG2I PIC  X(0079).
  1791*    -------------------------------
  1792     05  HPFKEYL PIC S9(0004) COMP.
  1793     05  HPFKEYF PIC  X(0001).
  1794     05  FILLER REDEFINES HPFKEYF.
  1795         10  HPFKEYA PIC  X(0001).
  1796     05  HPFKEYI PIC  99.
  1797*    -------------------------------
  1798     05  PFKEY11L PIC S9(0004) COMP.
  1799     05  PFKEY11F PIC  X(0001).
  1800     05  FILLER REDEFINES PFKEY11F.
  1801         10  PFKEY11A PIC  X(0001).
  1802     05  PFKEY11I PIC  X(0034).
  1803 01  EL127HO REDEFINES EL127HI.
  1804     05  FILLER            PIC  X(0012).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  HDATEO PIC  X(0008).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  HTIMEO PIC  99.99.
  1811*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  36
* EL1278.cbl
  1812     05  FILLER            PIC  X(0003).
  1813     05  CMPNYIDO PIC  X(0003).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  USERIDO PIC  X(0004).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  HCARIERO PIC  X(0001).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  HGROUPO PIC  X(0006).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  HSTATEO PIC  X(0002).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  HACCTNOO PIC  X(0010).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  HEFFDTO PIC  X(0008).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  HCERTNOO PIC  X(0010).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  HCRTSFXO PIC  X(0001).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  HLNAMEO PIC  X(0015).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  HFNAMEO PIC  X(0010).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  HINITO PIC  X(0001).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  LCLMDTHO PIC  X(0022).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  LCLMDTO PIC  X(0008).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  HPCYNO PIC  X(0001).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  ACLMDTHO PIC  X(0023).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  ACLMDTO PIC  X(0008).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  PMTHDO PIC  X(0010).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  CNCDTHDO PIC  X(0007).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  37
* EL1278.cbl
  1870     05  HLKINDO PIC  X(0002).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  HLCDO PIC  X(0002).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  HLEDESCO PIC  X(0003).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  HLTERMO PIC  ZZ9.
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  HLREMO PIC  ZZ9.
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  HLCANCO PIC  X(0008).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  HLCAL1O PIC  X(0001).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  HLCALCO PIC  X(0012).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  HAKINDO PIC  X(0002).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  HACDO PIC  X(0002).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  HAEDESCO PIC  X(0003).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  HATERMO PIC  ZZ9.
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  HAREMO PIC  ZZ9.
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  HACANCO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  38
* EL1278.cbl
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  HACAL1O PIC  X(0001).
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  HACALCO PIC  X(0012).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  CANREAHO PIC  X(0015).
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  CANREAO PIC  X(0001).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  CLPYNHO PIC  X(0005).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  CLPYNO PIC  X(0001).
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  FREMTRMO PIC  ZZ9.
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  HERMSG1O PIC  X(0079).
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  HERMSG2O PIC  X(0079).
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  HPFKEYO PIC  99.
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  PFKEY11O PIC  X(0034).
  1973*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  39
* EL1278.cbl
  1975*                            COPY ELCCALC.
  1976******************************************************************
  1977*                                                                *
  1978*                           ELCCALC.                            *
  1979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1980*                            VMOD=2.025                          *
  1981*                                                                *
  1982*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1983*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1984*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1985*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1986*                                                                *
  1987*  PASSED TO ELRTRM                                              *
  1988*  -----------------                                             *
  1989*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1990*  ORIGINAL TERM                                                 *
  1991*  BEGINNING DATE                                                *
  1992*  ENDING DATE                                                   *
  1993*  COMPANY I.D.                                                  *
  1994*  ACCOUNT MASTER USER FIELD                                     *
  1995*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1996*  FREE LOOK DAYS                                                *
  1997*                                                                *
  1998*  RETURNED FROM ELRTRM                                          *
  1999*  ---------------------                                         *
  2000*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2001*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2002*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2003*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2004*----------------------------------------------------------------*
  2005*  PASSED TO ELRAMT                                              *
  2006*  ----------------                                              *
  2007*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2008*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2009*  ORIGINAL AMOUNT                                               *
  2010*  ALTERNATE BENEFIT (BALLON)                                    *
  2011*  A.P.R. - NET PAY ONLY                                         *
  2012*  METHOD
  2013*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2014*  COMPANY I.D.                                                  *
  2015*  BENEFIT TYPE                                                  *
  2016*                                                                *
  2017*  RETURNED FROM ELRAMT                                          *
  2018*  --------------------                                          *
  2019*  REMAINING AMOUNT 1 - CURRENT                                  *
  2020*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2021*  REMAINING AMOUNT FACTOR
  2022*----------------------------------------------------------------*
  2023*  PASSED TO ELRESV                                              *
  2024*  -----------------                                             *
  2025*  CERTIFICATE EFFECTIVE DATE                                    *
  2026*  VALUATION DATE                                                *
  2027*  PAID THRU DATE                                                *
  2028*  BENEFIT                                                       *
  2029*  INCURRED DATE                                                 *
  2030*  REPORTED DATE                                                 *
  2031*  ISSUE AGE                                                     *
  2032*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  40
* EL1278.cbl
  2033*  CDT PERCENT                                                   *
  2034*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2035* *CLAIM TYPE (LIFE, A/H)                                        *
  2036* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2037* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2038*                                                                *
  2039*  RETURNED FROM ELRESV                                          *
  2040*  --------------------                                          *
  2041*  CDT TABLE USED                                                *
  2042*  CDT FACTOR USED                                               *
  2043*  PAY TO CURRENT RESERVE                                        *
  2044*  I.B.N.R. - A/H ONLY                                           *
  2045*  FUTURE (ACCRUED) AH ONLY                                      *
  2046*----------------------------------------------------------------*
  2047*  PASSED TO ELRATE                                              *
  2048*  ----------------                                              *
  2049*  CERT ISSUE DATE                                               *
  2050*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2051*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2052*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2053*  STATE CODE (CLIENT DEFINED)                                   *
  2054*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2055*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2056*  DEVIATION CODE                                                *
  2057*  ISSUE AGE                                                     *
  2058*  ORIGINAL BENEFIT AMOUNT                                       *
  2059*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2060*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2061*  BENEFIT KIND (LIFE OR A/H)                                    *
  2062*  A.P.R.                                                        *
  2063*  METHOD
  2064*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2065*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2066*  COMPANY I.D. (3 CHARACTER)                                    *
  2067*  BENEFIT CODE                                                  *
  2068*  BENEFIT OVERRIDE CODE                                         *
  2069*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2070*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2071*  JOINT INDICATOR (CSL ONLY)                                    *
  2072*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2073*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2074*                                                                *
  2075*  RETURNED FROM ELRATE                                          *
  2076*  --------------------                                          *
  2077*  CALCULATED PREMIUM                                            *
  2078*  PREMIUM RATE                                                  *
  2079*  MORTALITY CODE                                                *
  2080*  MAX ATTAINED AGE                                              *
  2081*  MAX AGE                                                       *
  2082*  MAX TERM                                                      *
  2083*  MAX MONTHLY BENEFIT                                           *
  2084*  MAX TOTAL BENIFIT                                             *
  2085*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2086*----------------------------------------------------------------*
  2087*  PASSED TO ELRFND                                              *
  2088*  ----------------                                              *
  2089*  CERT ISSUE DATE                                               *
  2090*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  41
* EL1278.cbl
  2091*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2092*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2093*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2094*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2095*  STATE CODE (CLIENT DEFINED)                                   *
  2096*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2097*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2098*  DEVIATION CODE                                                *
  2099*  ISSUE AGE                                                     *
  2100*  ORIGINAL BENEFIT AMOUNT                                       *
  2101*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2102*  PROCESS TYPE (CANCEL)                                         *
  2103*  BENEFIT KIND (LIFE OR A/H)                                    *
  2104*  A.P.R.                                                        *
  2105*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2106*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2107*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2108*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2109*  COMPANY I.D. (3 CHARACTER)                                    *
  2110*  BENEFIT CODE                                                  *
  2111*  BENEFIT OVERRIDE CODE                                         *
  2112*                                                                *
  2113*  RETURNED FROM ELRFND                                          *
  2114*  --------------------                                          *
  2115*  CALCULATED REFUND                                             *
  2116*----------------------------------------------------------------*
  2117*  PASSED TO ELEARN                                              *
  2118*  ----------------                                              *
  2119*  CERT ISSUE DATE                                               *
  2120*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2121*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2122*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2123*  STATE CODE (CLIENT DEFINED)                                   *
  2124*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2125*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2126*  DEVIATION CODE                                                *
  2127*  ISSUE AGE                                                     *
  2128*  ORIGINAL BENEFIT AMOUNT                                       *
  2129*  BENEFIT KIND (LIFE OR A/H)                                    *
  2130*  A.P.R.                                                        *
  2131*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2132*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2133*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2134*  COMPANY I.D. (3 CHARACTER)                                    *
  2135*  BENEFIT CODE                                                  *
  2136*  BENEFIT OVERRIDE CODE                                         *
  2137*                                                                *
  2138*  RETURNED FROM ELEARN                                          *
  2139*  --------------------                                          *
  2140*  INDICATED  EARNINGS                                           *
  2141*----------------------------------------------------------------*
  2142*                 LENGTH = 450                                   *
  2143*                                                                *
  2144******************************************************************
  2145******************************************************************
  2146*                   C H A N G E   L O G
  2147*
  2148* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  42
* EL1278.cbl
  2149*-----------------------------------------------------------------
  2150*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2151* EFFECTIVE    NUMBER
  2152*-----------------------------------------------------------------
  2153* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2154* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2155* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2156* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2157* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2158* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2159* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2160* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2161* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2162******************************************************************
  2163
  2164 01  CALCULATION-PASS-AREA.
  2165     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2166                                     COMP.
  2167
  2168     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2169       88  NO-CP-ERROR                             VALUE ZERO.
  2170       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2171                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2172       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2173       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2174       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2175       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2176       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2177       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2178       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2179       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2180       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2181       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2182       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2183       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2184       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2185       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2186       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2187       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2188       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2189
  2190     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2191       88  NO-CP-ERROR-2                           VALUE ZERO.
  2192***********************  INPUT AREAS ****************************
  2193
  2194     12  CP-CALCULATION-AREA.
  2195         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2196         16  CP-CERT-EFF-DT        PIC XX.
  2197         16  CP-VALUATION-DT       PIC XX.
  2198         16  CP-PAID-THRU-DT       PIC XX.
  2199         16  CP-BENEFIT-TYPE       PIC X.
  2200           88  CP-AH                               VALUE 'A' 'D'
  2201                                                   'I' 'U'.
  2202           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2203           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2204         16  CP-INCURRED-DT        PIC XX.
  2205         16  CP-REPORTED-DT        PIC XX.
  2206         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  43
* EL1278.cbl
  2207         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2208         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2209                                     COMP-3.
  2210         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2211                                     COMP-3.
  2212         16  CP-CDT-METHOD         PIC X.
  2213           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2214           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2215           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2216         16  CP-CLAIM-TYPE         PIC X.
  2217           88  CP-AH-CLAIM                         VALUE 'A'.
  2218           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2219         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2220                                     COMP-3.
  2221         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2222                                     COMP-3.
  2223         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2224                                     COMP-3.
  2225         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2226                                     COMP-3.
  2227         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2228                                     COMP-3.
  2229         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2230                                     COMP-3.
  2231         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2232                                     COMP-3.
  2233         16  CP-REM-TERM-METHOD    PIC X.
  2234           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2235           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2236           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2237           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2238           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2239           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2240           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2241         16  CP-EARNING-METHOD     PIC X.
  2242           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2243           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2244           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2245           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2246           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2247           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2248           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2249           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2250           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2251           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2252           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2253           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2254           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2255           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2256         16  CP-PROCESS-TYPE       PIC X.
  2257           88  CP-CLAIM                            VALUE '1'.
  2258           88  CP-CANCEL                           VALUE '2'.
  2259           88  CP-ISSUE                            VALUE '3'.
  2260         16  CP-SPECIAL-CALC-CD    PIC X.
  2261           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2262           88  CP-1-MTH-INTEREST               VALUE ' '.
  2263           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2264           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  44
* EL1278.cbl
  2265           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2266           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2267           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2268           88  CP-FARM-PLAN                    VALUE 'F'.
  2269           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2270           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2271           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2272           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2273           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2274           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2275           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2276           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2277           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2278           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2279                                                     'W' 'X'.
  2280           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2281           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2282           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2283           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2284           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2285           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2286           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2287           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2288           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2289           88  CP-CSL-METH-1                   VALUE '5'.
  2290           88  CP-CSL-METH-2                   VALUE '6'.
  2291           88  CP-CSL-METH-3                   VALUE '7'.
  2292           88  CP-CSL-METH-4                   VALUE '8'.
  2293
  2294         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2295                                     COMP-3.
  2296         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2297         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2298         16  CP-STATE              PIC XX          VALUE SPACE.
  2299         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2300         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2301           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2302               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2303         16  CP-R78-OPTION         PIC X.
  2304           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2305           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2306
  2307         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2308         16  CP-IBNR-RESERVE-SW    PIC X.
  2309         16  CP-CLAIM-STATUS       PIC X.
  2310         16  CP-RATE-FILE          PIC X.
  2311         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2312                                     COMP-3.
  2313
  2314         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2315         16  CP-AH-OVERRIDE-CODE   PIC X.
  2316
  2317         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2318                                     COMP-3.
  2319         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2320                                   PIC S9(5)V99 COMP-3.
  2321         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2322                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  45
* EL1278.cbl
  2323         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2324                                     COMP-3.
  2325         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2326                                     COMP-3.
  2327         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2328                                  PIC S9(7)V99 COMP-3.
  2329
  2330         16  CP-PAID-FROM-DATE     PIC X(02).
  2331         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2332         16  CP-EXT-DAYS-CALC      PIC X.
  2333           88  CP-EXT-NO-CHG                   VALUE ' '.
  2334           88  CP-EXT-CHG-LF                   VALUE '1'.
  2335           88  CP-EXT-CHG-AH                   VALUE '2'.
  2336           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2337         16  CP-DOMICILE-STATE     PIC XX.
  2338         16  CP-CARRIER            PIC X.
  2339         16  CP-REIN-FLAG          PIC X.
  2340         16  CP-REM-TRM-CALC-OPTION PIC X.
  2341           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2342                      '2' '3' '4' '5'.
  2343           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2344           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2345           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2346           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2347           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2348           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2349           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2350           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2351         16  CP-SIG-SWITCH         PIC X.
  2352         16  CP-RATING-METHOD      PIC X.
  2353           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2354           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2355           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2356           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2357           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2358           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2359           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2360           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2361           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2362         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2363                                     COMP-3.
  2364         16  CP-BEN-CATEGORY       PIC X.
  2365         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2366         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2367                                   PIC S99V9(5) COMP-3.
  2368         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2369         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2370                                   PIC S99V9(5) COMP-3.
  2371         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2372         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2373         16  CP-EXPIRE-DT          PIC XX.
  2374         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2375         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2376         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2377         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2378         16  CP-DDF-SPEC-CALC      PIC X.
  2379             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2380             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  46
* EL1278.cbl
  2381         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2382         16  CP-CANCEL-REASON      PIC X.
  2383         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2384         16  CP-PMT-MODE           PIC X.
  2385         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2386         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2387         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2388         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2389         16  FILLER                PIC X.
  2390
  2391***************    OUTPUT FROM ELRESV   ************************
  2392
  2393         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2394
  2395         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2396                                     COMP-3.
  2397         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2398                                     COMP-3.
  2399         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2400                                     COMP-3.
  2401         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2402                                     COMP-3.
  2403         16  FILLER                PIC X(09).
  2404***************    OUTPUT FROM ELRTRM   *************************
  2405
  2406         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2407                                     COMP-3.
  2408         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2409                                     COMP-3.
  2410         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2411                                     COMP-3.
  2412         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2413                                     COMP-3.
  2414         16  FILLER                PIC X(12).
  2415
  2416***************    OUTPUT FROM ELRAMT   *************************
  2417
  2418         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2419                                     COMP-3.
  2420         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2421                                     COMP-3.
  2422         16  FILLER                PIC X(12).
  2423
  2424***************    OUTPUT FROM ELRATE   *************************
  2425
  2426         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2427                                     COMP-3.
  2428         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2429                                     COMP-3.
  2430         16  CP-MORTALITY-CODE     PIC X(4).
  2431         16  CP-RATE-EDIT-FLAG     PIC X.
  2432             88  CP-RATES-NEED-APR                  VALUE '1'.
  2433         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2434                                     COMP-3.
  2435         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2436         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2437         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2438                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  47
* EL1278.cbl
  2439         16  FILLER                PIC X(07).
  2440
  2441***************    OUTPUT FROM ELRFND   *************************
  2442
  2443         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2444                                     COMP-3.
  2445         16  CP-REFUND-TYPE-USED   PIC X.
  2446           88  CP-R-AS-R78                         VALUE '1'.
  2447           88  CP-R-AS-PRORATA                     VALUE '2'.
  2448           88  CP-R-AS-CALIF                       VALUE '3'.
  2449           88  CP-R-AS-TEXAS                       VALUE '4'.
  2450           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2451           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2452           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2453           88  CP-R-AS-MEAN                        VALUE '8'.
  2454           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2455           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2456           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2457           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2458           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2459           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2460         16  FILLER                PIC X(12).
  2461
  2462***************    OUTPUT FROM ELEARN   *************************
  2463
  2464         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2465                                     COMP-3.
  2466         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2467                                     COMP-3.
  2468         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2469                                     COMP-3.
  2470         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2471                                     COMP-3.
  2472         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2473                                     COMP-3.
  2474         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2475                                     COMP-3.
  2476         16  CP-EARNING-TYPE-USED  PIC X.
  2477           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2478           88  CP-E-AS-R78                         VALUE '1'.
  2479           88  CP-E-AS-PRORATA                     VALUE '2'.
  2480           88  CP-E-AS-TEXAS                       VALUE '4'.
  2481           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2482           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2483           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2484           88  CP-E-AS-MEAN                        VALUE '8'.
  2485           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2486         16  FILLER                PIC X(12).
  2487
  2488***************    OUTPUT FROM ELPMNT   *************************
  2489
  2490         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2491                                     COMP-3.
  2492         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2493                                     COMP-3.
  2494         16  FILLER                PIC X(12).
  2495
  2496***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  48
* EL1278.cbl
  2497         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2498                                     COMP-3.
  2499         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2500                                     COMP-3.
  2501         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2502                                     COMP-3.
  2503         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2504                                     COMP-3.
  2505         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2506                                     COMP-3.
  2507         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2508                                     COMP-3.
  2509         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2510             88  OPEN-RATE-FILE                   VALUE 'O'.
  2511             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2512             88  IO-ERROR                         VALUE 'E'.
  2513
  2514         16  CP-FIRST-PAY-DATE     PIC XX.
  2515
  2516         16  CP-JOINT-INDICATOR    PIC X.
  2517
  2518         16  CP-RESERVE-REMAINING-TERM
  2519                                   PIC S9(4)V9    VALUE ZERO
  2520                                     COMP-3.
  2521
  2522         16  CP-INSURED-BIRTH-DT   PIC XX.
  2523
  2524         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2525                                     COMP-3.
  2526
  2527         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2528                                     COMP-3.
  2529
  2530         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2531                                     COMP-3.
  2532
  2533         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2534                                     COMP-3.
  2535
  2536         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2537                                     COMP-3.
  2538
  2539         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2540                                     COMP-3.
  2541
  2542         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2543                                     COMP-3.
  2544
  2545         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2546             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2547
  2548         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2549                                     COMP-3.
  2550         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2551                                     COMP-3.
  2552         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2553         16  FILLER                PIC X(15).
  2554******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  49
* EL1278.cbl
  2556*                            COPY ERCNOTE.
  2557******************************************************************
  2558*                                                                *
  2559*                                                                *
  2560*                            ERCNOTE                             *
  2561*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2562*                            VMOD=2.003                          *
  2563*                                                                *
  2564*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2565*                                                                *
  2566*        FILE TYPE= VSAM,KSDS                                    *
  2567*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2568*                                                                *
  2569*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2570*                                                                *
  2571*        LOG = YES                                               *
  2572*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2573*                                                                *
  2574******************************************************************
  2575*                   C H A N G E   L O G
  2576*
  2577* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2578*-----------------------------------------------------------------
  2579*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2580* EFFECTIVE    NUMBER
  2581*-----------------------------------------------------------------
  2582* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2583*                                FILE WILL CONTAIN BILLING NOTES O
  2584******************************************************************
  2585
  2586 01  CERTIFICATE-NOTE.
  2587     12  CN-RECORD-ID                PIC  XX.
  2588         88  VALID-CN-ID                  VALUE 'CN'.
  2589
  2590     12  CN-CONTROL-PRIMARY.
  2591         16  CN-COMPANY-CD           PIC X.
  2592         16  CN-CARRIER              PIC X.
  2593         16  CN-GROUPING.
  2594             20 CN-GROUPING-PREFIX   PIC XXX.
  2595             20 CN-GROUPING-PRIME    PIC XXX.
  2596         16  CN-STATE                PIC XX.
  2597         16  CN-ACCOUNT.
  2598             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2599             20 CN-ACCOUNT-PRIME     PIC X(6).
  2600         16  CN-CERT-EFF-DT          PIC XX.
  2601         16  CN-CERT-NO.
  2602             20  CN-CERT-PRIME       PIC X(10).
  2603             20  CN-CERT-SFX         PIC X.
  2604
  2605     12  CN-BILLING-START-LINE-NO    PIC 99.
  2606     12  CN-BILLING-END-LINE-NO      PIC 99.
  2607
  2608     12  CN-LINES.
  2609         16  CN-LINE OCCURS 10       PIC X(77).
  2610
  2611     12  CN-LAST-MAINT-DT            PIC XX.
  2612     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2613     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  50
* EL1278.cbl
  2614     12  FILLER                      PIC X(6).
  2615******************************************************************
  2616*                            COPY ERCCTBL.
  2617******************************************************************
  2618*                                                                *
  2619*                                                                *
  2620*                            ERCCTBL                             *
  2621*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2622*                            VMOD=2.003
  2623*                                                                *
  2624*   ONLINE CREDIT SYSTEM                                         *
  2625*                                                                *
  2626*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2627*                                                                *
  2628*   FILE TYPE = VSAM,KSDS                                        *
  2629*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2630*                                                                *
  2631*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2632*       ALTERNATE PATH = NONE                                    *
  2633*                                                                *
  2634*   LOG = NO                                                     *
  2635*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2636*                                                                *
  2637*                                                                *
  2638******************************************************************
  2639
  2640 01  COMM-TABLE-RECORD.
  2641     12  CT-RECORD-ID                      PIC XX.
  2642         88  VALID-CT-ID                      VALUE 'CT'.
  2643
  2644     12  CT-CONTROL-PRIMARY.
  2645         16  CT-COMPANY-CD                 PIC X.
  2646         16  CT-TABLE                      PIC XXX.
  2647         16  CT-CNTRL-2.
  2648             20  CT-BEN-TYPE               PIC X.
  2649             20  CT-BEN-CODE               PIC XX.
  2650
  2651     12  CT-MAINT-INFORMATION.
  2652         16  CT-LAST-MAINT-DT              PIC XX.
  2653         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2654         16  CT-LAST-MAINT-USER            PIC X(4).
  2655         16  FILLER                        PIC X(31).
  2656
  2657     12  CT-LIMITS.
  2658         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2659
  2660         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2661
  2662         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2663
  2664     12  CT-RATES.
  2665         16  CT-RTX          OCCURS 27 TIMES.
  2666             20  CT-RT                     PIC SV9(5)     COMP-3.
  2667             20  CT-RT-R   REDEFINES
  2668                 CT-RT                     PIC XXX.
  2669
  2670     12  FILLER                            PIC  X(42).
  2671
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  51
* EL1278.cbl
  2672******************************************************************
  2673
  2674****************************************************************
  2675*
  2676* Copyright (c) 2007 by Clerity Solutions, Inc.
  2677* All rights reserved.
  2678*
  2679****************************************************************
  2680 01  DFHEIV.
  2681   02  DFHEIV0               PIC X(35).
  2682   02  DFHEIV1               PIC X(08).
  2683   02  DFHEIV2               PIC X(08).
  2684   02  DFHEIV3               PIC X(08).
  2685   02  DFHEIV4               PIC X(06).
  2686   02  DFHEIV5               PIC X(04).
  2687   02  DFHEIV6               PIC X(04).
  2688   02  DFHEIV7               PIC X(02).
  2689   02  DFHEIV8               PIC X(02).
  2690   02  DFHEIV9               PIC X(01).
  2691   02  DFHEIV10              PIC S9(7) COMP-3.
  2692   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2693   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2694   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2695   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2696   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2697   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2698   02  DFHEIV17              PIC X(04).
  2699   02  DFHEIV18              PIC X(04).
  2700   02  DFHEIV19              PIC X(04).
  2701   02  DFHEIV20              USAGE IS POINTER.
  2702   02  DFHEIV21              USAGE IS POINTER.
  2703   02  DFHEIV22              USAGE IS POINTER.
  2704   02  DFHEIV23              USAGE IS POINTER.
  2705   02  DFHEIV24              USAGE IS POINTER.
  2706   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2707   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2708   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2709   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2710   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2711   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2712   02  FILLER                PIC X(02).
  2713   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2714   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2715   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2716   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2717   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2718 LINKAGE  SECTION.
  2719*****************************************************************
  2720*                                                               *
  2721* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2722* All rights reserved.                                          *
  2723*                                                               *
  2724*****************************************************************
  2725 01  dfheiblk.
  2726     02  eibtime          pic s9(7) comp-3.
  2727     02  eibdate          pic s9(7) comp-3.
  2728     02  eibtrnid         pic x(4).
  2729     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  52
* EL1278.cbl
  2730     02  eibtrmid         pic x(4).
  2731     02  dfheigdi         pic s9(4) comp.
  2732     02  eibcposn         pic s9(4) comp.
  2733     02  eibcalen         pic s9(4) comp.
  2734     02  eibaid           pic x(1).
  2735     02  eibfiller1       pic x(1).
  2736     02  eibfn            pic x(2).
  2737     02  eibfiller2       pic x(2).
  2738     02  eibrcode         pic x(6).
  2739     02  eibfiller3       pic x(2).
  2740     02  eibds            pic x(8).
  2741     02  eibreqid         pic x(8).
  2742     02  eibrsrce         pic x(8).
  2743     02  eibsync          pic x(1).
  2744     02  eibfree          pic x(1).
  2745     02  eibrecv          pic x(1).
  2746     02  eibsend          pic x(1).
  2747     02  eibatt           pic x(1).
  2748     02  eibeoc           pic x(1).
  2749     02  eibfmh           pic x(1).
  2750     02  eibcompl         pic x(1).
  2751     02  eibsig           pic x(1).
  2752     02  eibconf          pic x(1).
  2753     02  eiberr           pic x(1).
  2754     02  eibrldbk         pic x(1).
  2755     02  eiberrcd         pic x(4).
  2756     02  eibsynrb         pic x(1).
  2757     02  eibnodat         pic x(1).
  2758     02  eibfiller5       pic x(2).
  2759     02  eibresp          pic 9(09) comp.
  2760     02  eibresp2         pic 9(09) comp.
  2761     02  dfheigdj         pic s9(4) comp.
  2762     02  dfheigdk         pic s9(4) comp.
  2763
  2764 01  DFHCOMMAREA                 PIC  X(1024).
  2765
  2766*01 PARMLIST .
  2767*    12  FILLER                  PIC S9(08)      COMP.
  2768*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2769*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2770*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2771*                            COPY ELCCNTL.
  2772******************************************************************
  2773*                                                                *
  2774*                                                                *
  2775*                            ELCCNTL.                            *
  2776*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2777*                            VMOD=2.059                          *
  2778*                                                                *
  2779*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2780*                                                                *
  2781*   FILE TYPE = VSAM,KSDS                                        *
  2782*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2783*                                                                *
  2784*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2785*       ALTERNATE INDEX = NONE                                   *
  2786*                                                                *
  2787*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  53
* EL1278.cbl
  2788*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2789******************************************************************
  2790*                   C H A N G E   L O G
  2791*
  2792* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2793*-----------------------------------------------------------------
  2794*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2795* EFFECTIVE    NUMBER
  2796*-----------------------------------------------------------------
  2797* 082503                   PEMA  ADD BENEFIT GROUP
  2798* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2799* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2800* 092705    2005050300006  PEMA  ADD SPP LEASES
  2801* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2802* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2803* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2804* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2805* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2806* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2807* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2808* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2809* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2810******************************************************************
  2811*
  2812 01  CONTROL-FILE.
  2813     12  CF-RECORD-ID                       PIC XX.
  2814         88  VALID-CF-ID                        VALUE 'CF'.
  2815
  2816     12  CF-CONTROL-PRIMARY.
  2817         16  CF-COMPANY-ID                  PIC XXX.
  2818         16  CF-RECORD-TYPE                 PIC X.
  2819             88  CF-COMPANY-MASTER              VALUE '1'.
  2820             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2821             88  CF-STATE-MASTER                VALUE '3'.
  2822             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2823             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2824             88  CF-CARRIER-MASTER              VALUE '6'.
  2825             88  CF-MORTALITY-MASTER            VALUE '7'.
  2826             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2827             88  CF-TERMINAL-MASTER             VALUE '9'.
  2828             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2829             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2830             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2831             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2832             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2833             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2834             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2835             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2836             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2837         16  CF-ACCESS-CD-GENL              PIC X(4).
  2838         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2839             20  CF-PROCESSOR               PIC X(4).
  2840         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2841             20  CF-STATE-CODE              PIC XX.
  2842             20  FILLER                     PIC XX.
  2843         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2844             20  FILLER                     PIC XX.
  2845             20  CF-HI-BEN-IN-REC           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  54
* EL1278.cbl
  2846         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2847             20  FILLER                     PIC XXX.
  2848             20  CF-CARRIER-CNTL            PIC X.
  2849         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2850             20  FILLER                     PIC XX.
  2851             20  CF-HI-TYPE-IN-REC          PIC 99.
  2852         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2853             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2854                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2855             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2856             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2857         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2858             20  FILLER                     PIC X.
  2859             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2860         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2861             20  FILLER                     PIC XX.
  2862             20  CF-MORTGAGE-PLAN           PIC XX.
  2863         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2864
  2865     12  CF-LAST-MAINT-DT                   PIC XX.
  2866     12  CF-LAST-MAINT-BY                   PIC X(4).
  2867     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2868
  2869     12  CF-RECORD-BODY                     PIC X(728).
  2870
  2871
  2872****************************************************************
  2873*             COMPANY MASTER RECORD                            *
  2874****************************************************************
  2875
  2876     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2877         16  CF-COMPANY-ADDRESS.
  2878             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2879             20  CF-CL-IN-CARE-OF           PIC X(30).
  2880             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2881             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2882             20  CF-CL-CITY-STATE           PIC X(30).
  2883             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2884             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2885         16  CF-COMPANY-CD                  PIC X.
  2886         16  CF-COMPANY-PASSWORD            PIC X(8).
  2887         16  CF-SECURITY-OPTION             PIC X.
  2888             88  ALL-SECURITY                   VALUE '1'.
  2889             88  COMPANY-VERIFY                 VALUE '2'.
  2890             88  PROCESSOR-VERIFY               VALUE '3'.
  2891             88  NO-SECURITY                    VALUE '4'.
  2892             88  ALL-BUT-TERM                   VALUE '5'.
  2893         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2894             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2895         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2896             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2897         16  CF-INFORCE-LOCATION            PIC X.
  2898             88  CERTS-ARE-ONLINE               VALUE '1'.
  2899             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2900             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2901         16  CF-LOWER-CASE-LETTERS          PIC X.
  2902         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2903             88  CF-ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  55
* EL1278.cbl
  2904             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2905             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2906             88  CF-ACCNT-CNTL                  VALUE '3'.
  2907             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2908
  2909         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2910         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2911
  2912         16  CF-LGX-CREDIT-USER             PIC X.
  2913             88  CO-IS-NOT-USER                 VALUE 'N'.
  2914             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2915
  2916         16 CF-CREDIT-CALC-CODES.
  2917             20  CF-CR-REM-TERM-CALC PIC X.
  2918               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2919               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2920               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2921               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2922               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2923               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2924               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2925             20  CF-CR-R78-METHOD           PIC X.
  2926               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2927               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2928
  2929         16  CF-CLAIM-CONTROL-COUNTS.
  2930             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2931                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2932
  2933             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2934                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2935
  2936             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2937                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2938
  2939             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2940                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2941
  2942         16  CF-CURRENT-MONTH-END           PIC XX.
  2943
  2944         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2945             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2946             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2947             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2948             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2949                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2950                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2951             20  CF-CO-PREM-REJECT-SW       PIC X.
  2952                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2953                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2954             20  CF-CO-REF-REJECT-SW        PIC X.
  2955                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2956                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2957
  2958         16  CF-CO-REPORTING-DT             PIC XX.
  2959         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2960         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2961           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  56
* EL1278.cbl
  2962           88  CF-CO-MONTH-END                  VALUE '1'.
  2963
  2964         16  CF-LGX-CLAIM-USER              PIC X.
  2965             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2966             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2967
  2968         16  CF-CREDIT-EDIT-CONTROLS.
  2969             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2970             20  CF-MIN-AGE                 PIC 99.
  2971             20  CF-DEFAULT-AGE             PIC 99.
  2972             20  CF-MIN-TERM                PIC S999      COMP-3.
  2973             20  CF-MAX-TERM                PIC S999      COMP-3.
  2974             20  CF-DEFAULT-SEX             PIC X.
  2975             20  CF-JOINT-AGE-INPUT         PIC X.
  2976                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2977             20  CF-BIRTH-DATE-INPUT        PIC X.
  2978                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2979             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2980                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2981                 88  CF-ZERO-CARRIER            VALUE '1'.
  2982                 88  CF-ZERO-GROUPING           VALUE '2'.
  2983                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2984             20  CF-EDIT-SW                 PIC X.
  2985                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2986             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2987             20  CF-CR-PR-METHOD            PIC X.
  2988               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2989               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2990             20  FILLER                     PIC X.
  2991
  2992         16  CF-CREDIT-MISC-CONTROLS.
  2993             20  CF-REIN-TABLE-SW           PIC X.
  2994                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2995             20  CF-COMP-TABLE-SW           PIC X.
  2996                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2997             20  CF-EXPERIENCE-RETENTION-AGE
  2998                                            PIC S9        COMP-3.
  2999             20  CF-CONVERSION-DT           PIC XX.
  3000             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3001             20  CF-RUN-FREQUENCY-SW        PIC X.
  3002                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3003                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3004
  3005             20  CF-CR-CHECK-NO-CONTROL.
  3006                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3007                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3008                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3009                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3010                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3011                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3012
  3013                 24  CF-CR-CHECK-COUNT       REDEFINES
  3014                     CF-CR-CHECK-COUNTER      PIC X(4).
  3015
  3016                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3017                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3018
  3019                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  57
* EL1278.cbl
  3020                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3021                 24  CF-MAIL-PROCESSING       PIC X.
  3022                     88  MAIL-PROCESSING          VALUE 'Y'.
  3023
  3024         16  CF-MISC-SYSTEM-CONTROL.
  3025             20  CF-SYSTEM-C                 PIC X.
  3026                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3027             20  CF-SYSTEM-D                 PIC X.
  3028                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3029             20  CF-SOC-SEC-NO-SW            PIC X.
  3030                 88  SOC-SEC-NO-USED             VALUE '1'.
  3031             20  CF-MEMBER-NO-SW             PIC X.
  3032                 88  MEMBER-NO-USED              VALUE '1'.
  3033             20  CF-TAX-ID-NUMBER            PIC X(11).
  3034             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3035             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3036                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3037                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3038                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3039                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3040             20  CF-SYSTEM-E                 PIC X.
  3041                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3042
  3043         16  CF-LGX-LIFE-USER               PIC X.
  3044             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3045             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3046
  3047         16  CF-CR-MONTH-END-DT             PIC XX.
  3048
  3049         16  CF-FILE-MAINT-DATES.
  3050             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3051                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3052             20  CF-LAST-BATCH       REDEFINES
  3053                 CF-LAST-BATCH-NO               PIC X(4).
  3054             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3055             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3056             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3057             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3058             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3059             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3060             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3061             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3062             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3063             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3064
  3065         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3066         16  FILLER                         PIC X.
  3067
  3068         16  CF-ALT-MORT-CODE               PIC X(4).
  3069         16  CF-MEMBER-CAPTION              PIC X(10).
  3070
  3071         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3072             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3073             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3074             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3075             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3076             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3077
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  58
* EL1278.cbl
  3078         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3079
  3080         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3081         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3082         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3083         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3084
  3085         16  CF-AH-OVERRIDE-L1              PIC X.
  3086         16  CF-AH-OVERRIDE-L2              PIC XX.
  3087         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3088         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3089
  3090         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3091         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3092
  3093         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3094         16  CF-AR-LAST-EL860-DT            PIC XX.
  3095         16  CF-MP-MONTH-END-DT             PIC XX.
  3096
  3097         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3098         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3099             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3100
  3101         16  CF-AR-MONTH-END-DT             PIC XX.
  3102
  3103         16  CF-CRDTCRD-USER                PIC X.
  3104             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3105             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3106
  3107         16  CF-CC-MONTH-END-DT             PIC XX.
  3108
  3109         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3110
  3111         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3112             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3113             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3114             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3115         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3116         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3117         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3118         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3119             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3120             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3121         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3122         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3123         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3124             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3125         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3126
  3127         16  CF-CL-ZIP-CODE.
  3128             20  CF-CL-ZIP-PRIME.
  3129                 24  CF-CL-ZIP-1ST          PIC X.
  3130                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3131                 24  FILLER                 PIC X(4).
  3132             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3133         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3134             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3135             20  CF-CL-CAN-POSTAL-2         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  59
* EL1278.cbl
  3136             20  FILLER                     PIC XXX.
  3137
  3138         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3139         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3140         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3141         16  CF-CO-OPTION-START-DATE        PIC XX.
  3142         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3143           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3144                                                      '3' '4'.
  3145           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3146           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3147           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3148           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3149           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3150           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3151
  3152         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3153
  3154         16  CF-PAYMENT-APPROVAL-LEVELS.
  3155             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3156             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3157             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3158             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3159             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3160             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3161
  3162         16  CF-END-USER-REPORTING-USER     PIC X.
  3163             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3164             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3165
  3166         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3167             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3168             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3169
  3170         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3171
  3172         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3173         16  FILLER                         PIC X.
  3174
  3175         16  CF-CREDIT-ARCHIVE-CNTL.
  3176             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3177             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3178             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3179
  3180         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3181
  3182         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3183             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3184             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3185
  3186         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3187             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3188             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3189
  3190         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3191
  3192         16  CF-CO-ACH-ID-CODE              PIC  X.
  3193             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  60
* EL1278.cbl
  3194             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3195             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3196         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3197         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3198         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3199         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3200         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3201         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3202         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3203         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3204         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3205                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3206         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3207                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3208
  3209         16  CF-CO-OVER-SHORT.
  3210             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3211             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3212
  3213*         16  FILLER                         PIC X(102).
  3214         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3215             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3216             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3217
  3218         16  CF-AH-APPROVAL-DAYS.
  3219             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3220             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3221             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3222             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3223
  3224         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3225
  3226         16  CF-APPROV-LEV-5.
  3227             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3228             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3229             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3230
  3231         16  FILLER                         PIC X(68).
  3232****************************************************************
  3233*             PROCESSOR/USER RECORD                            *
  3234****************************************************************
  3235
  3236     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3237         16  CF-PROCESSOR-NAME              PIC X(30).
  3238         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3239         16  CF-PROCESSOR-TITLE             PIC X(26).
  3240         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3241                 88  MESSAGE-YES                VALUE 'Y'.
  3242                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3243
  3244*****************************************************
  3245****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3246****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3247****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3248****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3249*****************************************************
  3250
  3251         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  61
* EL1278.cbl
  3252             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3253             20  CF-APPLICATION-FORCE       PIC X.
  3254             20  CF-INDIVIDUAL-APP.
  3255                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3256                     28  CF-BROWSE-APP      PIC X.
  3257                     28  CF-UPDATE-APP      PIC X.
  3258
  3259         16  CF-CURRENT-TERM-ON             PIC X(4).
  3260         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3261             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3262             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3263             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3264             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3265             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3266             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3267             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3268         16  CF-PROCESSOR-CARRIER           PIC X.
  3269             88  NO-CARRIER-SECURITY            VALUE ' '.
  3270         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3271             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3272         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3273             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3274         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3275             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3276
  3277         16  CF-PROC-SYS-ACCESS-SW.
  3278             20  CF-PROC-CREDIT-CLAIMS-SW.
  3279                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3280                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3281                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3282                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3283             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3284                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3285                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3286             20  CF-PROC-LIFE-GNRLDGR-SW.
  3287                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3288                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3289                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3290                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3291             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3292                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3293                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3294         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3295             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3296             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3297         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3298
  3299         16  CF-APPROVAL-LEVEL                  PIC X.
  3300             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3301             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3302             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3303             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3304             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3305
  3306         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3307
  3308         16  CF-LANGUAGE-TYPE                   PIC X.
  3309             88  CF-LANG-IS-ENG                     VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  62
* EL1278.cbl
  3310             88  CF-LANG-IS-FR                      VALUE 'F'.
  3311
  3312         16  CF-CSR-IND                         PIC X.
  3313         16  FILLER                             PIC X(239).
  3314
  3315****************************************************************
  3316*             PROCESSOR/REMINDERS RECORD                       *
  3317****************************************************************
  3318
  3319     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3320         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3321             20  CF-START-REMIND-DT         PIC XX.
  3322             20  CF-END-REMIND-DT           PIC XX.
  3323             20  CF-REMINDER-TEXT           PIC X(50).
  3324         16  FILLER                         PIC X(296).
  3325
  3326
  3327****************************************************************
  3328*             STATE MASTER RECORD                              *
  3329****************************************************************
  3330
  3331     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3332         16  CF-STATE-ABBREVIATION          PIC XX.
  3333         16  CF-STATE-NAME                  PIC X(25).
  3334         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3335         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3336             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3337             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3338             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3339             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3340                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3341                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3342             20  CF-ST-PREM-REJECT-SW       PIC X.
  3343                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3344                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3345             20  CF-ST-REF-REJECT-SW        PIC X.
  3346                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3347                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3348         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3349         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3350         16  CF-ST-REFUND-RULES.
  3351             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3352             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3353             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3354         16  CF-ST-FST-PMT-EXTENSION.
  3355             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3356             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3357                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3358                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3359                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3360                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3361         16  CF-ST-STATE-CALL.
  3362             20  CF-ST-CALL-UNEARNED        PIC X.
  3363             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3364             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3365         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3366             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3367             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  63
* EL1278.cbl
  3368         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3369         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3370         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3371         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3372         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3373         16  FILLER                         PIC X.
  3374         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3375             20  CF-ST-BENEFIT-CD           PIC XX.
  3376             20  CF-ST-BENEFIT-KIND         PIC X.
  3377                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3378                 88  CF-ST-AH-KIND              VALUE 'A'.
  3379             20  CF-ST-REM-TERM-CALC        PIC X.
  3380                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3381                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3382                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3383                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3384                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3385                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3386                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3387                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3388
  3389             20  CF-ST-REFUND-CALC          PIC X.
  3390                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3391                 88  ST-REFD-BY-R78             VALUE '1'.
  3392                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3393                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3394                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3395                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3396                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3397                 88  ST-REFD-UTAH               VALUE '7'.
  3398                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3399                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3400                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3401
  3402             20  CF-ST-EARNING-CALC         PIC X.
  3403                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3404                 88  ST-EARN-BY-R78             VALUE '1'.
  3405                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3406                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3407                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3408                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3409                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3410                 88  ST-EARN-MEAN               VALUE '8'.
  3411                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3412
  3413             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3414                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3415                 88  ST-OVRD-BY-R78             VALUE '1'.
  3416                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3417                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3418                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3419                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3420                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3421                 88  ST-OVRD-MEAN               VALUE '8'.
  3422                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3423             20  FILLER                     PIC X.
  3424
  3425         16  CF-ST-COMMISSION-CAPS.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  64
* EL1278.cbl
  3426             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3427             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3428             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3429             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3430         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3431                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3432
  3433         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3434
  3435         16  CF-ST-STATUTORY-INTEREST.
  3436             20  CF-ST-STAT-DATE-FROM       PIC X.
  3437                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3438                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3439             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3440             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3441             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3442             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3443             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3444
  3445         16  CF-ST-OVER-SHORT.
  3446             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3447             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3448
  3449         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3450
  3451         16  CF-ST-RT-CALC                  PIC X.
  3452
  3453         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3454         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3455         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3456         16  CF-ST-RF-LR-CALC               PIC X.
  3457         16  CF-ST-RF-LL-CALC               PIC X.
  3458         16  CF-ST-RF-LN-CALC               PIC X.
  3459         16  CF-ST-RF-AH-CALC               PIC X.
  3460         16  CF-ST-RF-CP-CALC               PIC X.
  3461*        16  FILLER                         PIC X(206).
  3462*CIDMOD         16  FILLER                         PIC X(192).
  3463         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3464             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3465         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3466         16  CF-ST-VFY-2ND-BENE             PIC X.
  3467         16  CF-ST-CAUSAL-STATE             PIC X.
  3468         16  FILLER                         PIC X(185).
  3469
  3470****************************************************************
  3471*             BENEFIT MASTER RECORD                            *
  3472****************************************************************
  3473
  3474     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3475         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3476             20  CF-BENEFIT-CODE            PIC XX.
  3477             20  CF-BENEFIT-NUMERIC  REDEFINES
  3478                 CF-BENEFIT-CODE            PIC XX.
  3479             20  CF-BENEFIT-ALPHA           PIC XXX.
  3480             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3481             20  CF-BENEFIT-COMMENT         PIC X(10).
  3482
  3483             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  65
* EL1278.cbl
  3484                 88  CF-REDUCING                VALUE 'R'.
  3485                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3486
  3487             20  CF-SPECIAL-CALC-CD         PIC X.
  3488                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3489                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3490                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3491                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3492                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3493                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3494                 88  CF-FARM-PLAN               VALUE 'F'.
  3495                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3496                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3497                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3498                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3499                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3500                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3501                 88  CF-PRUDENTIAL              VALUE 'P'.
  3502                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3503                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3504                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3505                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3506                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3507                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3508
  3509             20  CF-JOINT-INDICATOR         PIC X.
  3510                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3511
  3512*            20  FILLER                     PIC X(12).
  3513             20  FILLER                     PIC X(11).
  3514             20  CF-BENEFIT-CATEGORY        PIC X.
  3515             20  CF-LOAN-TYPE               PIC X(8).
  3516
  3517             20  CF-CO-REM-TERM-CALC        PIC X.
  3518                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3519                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3520                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3521                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3522                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3523
  3524             20  CF-CO-EARNINGS-CALC        PIC X.
  3525                 88  CO-EARN-BY-R78             VALUE '1'.
  3526                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3527                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3528                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3529                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3530                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3531                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3532                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3533
  3534             20  CF-CO-REFUND-CALC          PIC X.
  3535                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3536                 88  CO-REFD-BY-R78             VALUE '1'.
  3537                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3538                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3539                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3540                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3541                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  66
* EL1278.cbl
  3542                 88  CO-REFD-MEAN               VALUE '8'.
  3543                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3544                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3545                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3546
  3547             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3548                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3549                 88  CO-OVRD-BY-R78             VALUE '1'.
  3550                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3551                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3552                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3553                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3554                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3555                 88  CO-OVRD-MEAN               VALUE '8'.
  3556                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3557
  3558             20  CF-CO-BEN-I-G-CD           PIC X.
  3559                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3560                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3561                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3562
  3563         16  FILLER                         PIC X(304).
  3564
  3565
  3566****************************************************************
  3567*             CARRIER MASTER RECORD                            *
  3568****************************************************************
  3569
  3570     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3571         16  CF-ADDRESS-DATA.
  3572             20  CF-MAIL-TO-NAME            PIC X(30).
  3573             20  CF-IN-CARE-OF              PIC X(30).
  3574             20  CF-ADDRESS-LINE-1          PIC X(30).
  3575             20  CF-ADDRESS-LINE-2          PIC X(30).
  3576             20  CF-CITY-STATE              PIC X(30).
  3577             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3578             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3579
  3580         16  CF-CLAIM-NO-CONTROL.
  3581             20  CF-CLAIM-NO-METHOD         PIC X.
  3582                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3583                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3584                 88  CLAIM-NO-SEQ               VALUE '3'.
  3585                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3586             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3587                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3588                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3589                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3590
  3591         16  CF-CHECK-NO-CONTROL.
  3592             20  CF-CHECK-NO-METHOD         PIC X.
  3593                 88  CHECK-NO-MANUAL            VALUE '1'.
  3594                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3595                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3596                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3597             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3598                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3599
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  67
* EL1278.cbl
  3600         16  CF-DOMICILE-STATE              PIC XX.
  3601
  3602         16  CF-EXPENSE-CONTROLS.
  3603             20  CF-EXPENSE-METHOD          PIC X.
  3604                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3605                 88  DOLLARS-PER-PMT            VALUE '2'.
  3606                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3607                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3608             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3609             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3610
  3611         16  CF-CORRESPONDENCE-CONTROL.
  3612             20  CF-LETTER-RESEND-OPT       PIC X.
  3613                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3614                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3615             20  FILLER                     PIC X(4).
  3616
  3617         16  CF-RESERVE-CONTROLS.
  3618             20  CF-MANUAL-SW               PIC X.
  3619                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3620             20  CF-FUTURE-SW               PIC X.
  3621                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3622             20  CF-PTC-SW                  PIC X.
  3623                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3624             20  CF-IBNR-SW                 PIC X.
  3625                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3626             20  CF-PTC-LF-SW               PIC X.
  3627                 88  CF-LF-PTC-USED             VALUE '1'.
  3628             20  CF-CDT-ACCESS-METHOD       PIC X.
  3629                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3630                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3631                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3632             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3633
  3634         16  CF-CLAIM-CALC-METHOD           PIC X.
  3635             88  360-PLUS-MONTHS                VALUE '1'.
  3636             88  365-PLUS-MONTHS                VALUE '2'.
  3637             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3638             88  360-DAILY                      VALUE '4'.
  3639             88  365-DAILY                      VALUE '5'.
  3640
  3641         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3642         16  FILLER                         PIC X(11).
  3643
  3644         16  CF-LIMIT-AMOUNTS.
  3645             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3646             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3647             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3648             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3649             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3650             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3651             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3652             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3653             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3654             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3655
  3656         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3657         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  68
* EL1278.cbl
  3658         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3659
  3660         16  CF-ZIP-CODE.
  3661             20  CF-ZIP-PRIME.
  3662                 24  CF-ZIP-1ST             PIC X.
  3663                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3664                 24  FILLER                 PIC X(4).
  3665             20  CF-ZIP-PLUS4               PIC X(4).
  3666         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3667             20  CF-CAN-POSTAL-1            PIC XXX.
  3668             20  CF-CAN-POSTAL-2            PIC XXX.
  3669             20  FILLER                     PIC XXX.
  3670
  3671         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3672         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3673         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3674
  3675         16  CF-RATING-SWITCH               PIC X.
  3676             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3677             88  CF-NO-RATING                   VALUE 'N'.
  3678
  3679         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3680
  3681         16  CF-CARRIER-OVER-SHORT.
  3682             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3683             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3684
  3685         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3686         16  CF-SECPAY-SWITCH               PIC X.
  3687             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3688             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3689         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3690         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3691         16  FILLER                         PIC X(444).
  3692*        16  FILLER                         PIC X(452).
  3693
  3694
  3695****************************************************************
  3696*             MORTALITY MASTER RECORD                          *
  3697****************************************************************
  3698
  3699     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3700         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3701                                INDEXED BY CF-MORT-NDX.
  3702             20  CF-MORT-TABLE              PIC X(5).
  3703             20  CF-MORT-TABLE-TYPE         PIC X.
  3704                 88  CF-MORT-JOINT              VALUE 'J'.
  3705                 88  CF-MORT-SINGLE             VALUE 'S'.
  3706                 88  CF-MORT-COMBINED           VALUE 'C'.
  3707                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3708                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3709             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3710             20  CF-MORT-AGE-METHOD         PIC XX.
  3711                 88  CF-AGE-LAST                VALUE 'AL'.
  3712                 88  CF-AGE-NEAR                VALUE 'AN'.
  3713             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3714             20  CF-MORT-ADJUSTMENT-DIRECTION
  3715                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  69
* EL1278.cbl
  3716                 88  CF-MINUS                   VALUE '-'.
  3717                 88  CF-PLUS                    VALUE '+'.
  3718             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3719             20  CF-MORT-JOINT-CODE         PIC X.
  3720                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3721             20  CF-MORT-PC-Q               PIC X.
  3722                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3723             20  CF-MORT-TABLE-CODE         PIC X(4).
  3724             20  CF-MORT-COMMENTS           PIC X(15).
  3725             20  FILLER                     PIC X(14).
  3726
  3727         16  FILLER                         PIC X(251).
  3728
  3729
  3730****************************************************************
  3731*             BUSSINESS TYPE MASTER RECORD                     *
  3732****************************************************************
  3733
  3734     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3735* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3736* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3737* AND RECORD 05 IS TYPES 81-99
  3738         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3739             20  CF-BUSINESS-TITLE          PIC  X(19).
  3740             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3741                                            PIC S9V9(4) COMP-3.
  3742             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3743             20  FILLER                     PIC  X.
  3744         16  FILLER                         PIC  X(248).
  3745
  3746
  3747****************************************************************
  3748*             TERMINAL MASTER RECORD                           *
  3749****************************************************************
  3750
  3751     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3752
  3753         16  CF-COMPANY-TERMINALS.
  3754             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3755                                  PIC X(4).
  3756         16  FILLER               PIC X(248).
  3757
  3758
  3759****************************************************************
  3760*             LIFE EDIT MASTER RECORD                          *
  3761****************************************************************
  3762
  3763     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3764         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3765             20  CF-LIFE-CODE-IN            PIC XX.
  3766             20  CF-LIFE-CODE-OUT           PIC XX.
  3767         16  FILLER                         PIC X(248).
  3768
  3769
  3770****************************************************************
  3771*             AH EDIT MASTER RECORD                            *
  3772****************************************************************
  3773
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  70
* EL1278.cbl
  3774     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3775         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3776             20  CF-AH-CODE-IN              PIC XXX.
  3777             20  CF-AH-CODE-OUT             PIC XX.
  3778         16  FILLER                         PIC X(248).
  3779
  3780
  3781****************************************************************
  3782*             CREDIBILITY TABLES                               *
  3783****************************************************************
  3784
  3785     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3786         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3787                             INDEXED BY CF-CRDB-NDX.
  3788             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3789             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3790             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3791         16  FILLER                         PIC  X(332).
  3792
  3793
  3794****************************************************************
  3795*             REPORT CUSTOMIZATION RECORD                      *
  3796****************************************************************
  3797
  3798     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3799         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3800             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3801             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3802             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3803**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3804****       A T-TRANSFER.                                   ****
  3805             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3806
  3807         16  FILLER                         PIC XX.
  3808
  3809         16  CF-CARRIER-CNTL-OPT.
  3810             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3811                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3812                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3813             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3814                                            PIC X.
  3815         16  CF-GROUP-CNTL-OPT.
  3816             20  CF-GROUP-OPT-SEQ           PIC 9.
  3817                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3818                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3819             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3820                                            PIC X(6).
  3821         16  CF-STATE-CNTL-OPT.
  3822             20  CF-STATE-OPT-SEQ           PIC 9.
  3823                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3824                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3825             20  CF-STATE-SELECT OCCURS 3 TIMES
  3826                                            PIC XX.
  3827         16  CF-ACCOUNT-CNTL-OPT.
  3828             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3829                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3830                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3831             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  71
* EL1278.cbl
  3832                                            PIC X(10).
  3833         16  CF-BUS-TYP-CNTL-OPT.
  3834             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3835                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3836                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3837             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3838                                            PIC XX.
  3839         16  CF-LF-TYP-CNTL-OPT.
  3840             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3841                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3842                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3843             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3844                                            PIC XX.
  3845         16  CF-AH-TYP-CNTL-OPT.
  3846             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3847                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3848                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3849             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3850                                            PIC XX.
  3851         16  CF-REPTCD1-CNTL-OPT.
  3852             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3853                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3854                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3855             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3856                                            PIC X(10).
  3857         16  CF-REPTCD2-CNTL-OPT.
  3858             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3859                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3860                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3861             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3862                                            PIC X(10).
  3863         16  CF-USER1-CNTL-OPT.
  3864             20  CF-USER1-OPT-SEQ           PIC 9.
  3865                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3866                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3867             20  CF-USER1-SELECT OCCURS 3 TIMES
  3868                                            PIC X(10).
  3869         16  CF-USER2-CNTL-OPT.
  3870             20  CF-USER2-OPT-SEQ           PIC 9.
  3871                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3872                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3873             20  CF-USER2-SELECT OCCURS 3 TIMES
  3874                                            PIC X(10).
  3875         16  CF-USER3-CNTL-OPT.
  3876             20  CF-USER3-OPT-SEQ           PIC 9.
  3877                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3878                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3879             20  CF-USER3-SELECT OCCURS 3 TIMES
  3880                                            PIC X(10).
  3881         16  CF-USER4-CNTL-OPT.
  3882             20  CF-USER4-OPT-SEQ           PIC 9.
  3883                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3884                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3885             20  CF-USER4-SELECT OCCURS 3 TIMES
  3886                                            PIC X(10).
  3887         16  CF-USER5-CNTL-OPT.
  3888             20  CF-USER5-OPT-SEQ           PIC 9.
  3889                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  72
* EL1278.cbl
  3890                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3891             20  CF-USER5-SELECT OCCURS 3 TIMES
  3892                                            PIC X(10).
  3893         16  CF-REINS-CNTL-OPT.
  3894             20  CF-REINS-OPT-SEQ           PIC 9.
  3895                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3896                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3897             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3898                 24  CF-REINS-PRIME         PIC XXX.
  3899                 24  CF-REINS-SUB           PIC XXX.
  3900
  3901         16  CF-AGENT-CNTL-OPT.
  3902             20  CF-AGENT-OPT-SEQ           PIC 9.
  3903                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3904                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3905             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3906                                            PIC X(10).
  3907
  3908         16  FILLER                         PIC X(43).
  3909
  3910         16  CF-LOSS-RATIO-SELECT.
  3911             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3912             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3913         16  CF-ENTRY-DATE-SELECT.
  3914             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3915             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3916         16  CF-EFFECTIVE-DATE-SELECT.
  3917             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3918             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3919
  3920         16  CF-EXCEPTION-LIST-IND          PIC X.
  3921             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3922
  3923         16  FILLER                         PIC X(318).
  3924
  3925****************************************************************
  3926*                  EXCEPTION REPORTING RECORD                  *
  3927****************************************************************
  3928
  3929     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3930         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3931             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3932
  3933         16  CF-COMBINED-LIFE-AH-OPT.
  3934             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3935             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3936             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3937             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3938
  3939         16  CF-LIFE-OPT.
  3940             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3941             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3942             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3943             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3944             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3945             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3946             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3947             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  73
* EL1278.cbl
  3948             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3949             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3950
  3951         16  CF-AH-OPT.
  3952             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3953             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3954             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3955             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3956             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3957             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3958             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3959             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3960             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3961             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3962
  3963         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3964             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3965             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3966             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3967
  3968         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3969
  3970         16  FILLER                         PIC X(673).
  3971
  3972
  3973****************************************************************
  3974*             MORTGAGE SYSTEM PLAN RECORD                      *
  3975****************************************************************
  3976
  3977     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3978         16  CF-PLAN-TYPE                   PIC X.
  3979             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3980             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3981             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3982         16  CF-PLAN-ABBREV                 PIC XXX.
  3983         16  CF-PLAN-DESCRIPT               PIC X(10).
  3984         16  CF-PLAN-NOTES                  PIC X(20).
  3985         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3986         16  CF-PLAN-UNDERWRITING.
  3987             20  CF-PLAN-TERM-DATA.
  3988                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3989                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3990             20  CF-PLAN-AGE-DATA.
  3991                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3992                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3993                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3994             20  CF-PLAN-BENEFIT-DATA.
  3995                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3996                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3997                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3998                                            PIC S9(7)V99  COMP-3.
  3999         16  CF-PLAN-POLICY-FORMS.
  4000             20  CF-POLICY-FORM             PIC X(12).
  4001             20  CF-MASTER-APPLICATION      PIC X(12).
  4002             20  CF-MASTER-POLICY           PIC X(12).
  4003         16  CF-PLAN-RATING.
  4004             20  CF-RATE-CODE               PIC X(5).
  4005             20  CF-SEX-RATING              PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  74
* EL1278.cbl
  4006                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4007                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4008             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4009             20  CF-SUB-STD-TYPE            PIC X.
  4010                 88  CF-PCT-OF-PREM            VALUE '1'.
  4011                 88  CF-PCT-OF-BENE            VALUE '2'.
  4012         16  CF-PLAN-PREM-TOLERANCES.
  4013             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4014             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4015         16  CF-PLAN-PYMT-TOLERANCES.
  4016             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4017             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4018         16  CF-PLAN-MISC-DATA.
  4019             20  FILLER                     PIC X.
  4020             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4021             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4022         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4023         16  CF-PLAN-IND-GRP                PIC X.
  4024             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4025                                                     '1'.
  4026             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4027                                                     '2'.
  4028         16  CF-MIB-SEARCH-SW               PIC X.
  4029             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4030             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4031             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4032             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4033         16  CF-ALPHA-SEARCH-SW             PIC X.
  4034             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4035             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4036             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4037             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4038             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4039             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4040             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4041             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4042             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4043             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4044                                                     'A' 'B' 'C'
  4045                                                     'X' 'Y' 'Z'.
  4046         16  CF-EFF-DT-RULE-SW              PIC X.
  4047             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4048             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4049             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4050             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4051             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4052         16  FILLER                         PIC X(4).
  4053         16  CF-HEALTH-QUESTIONS            PIC X.
  4054             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4055         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4056         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4057         16  CF-PLAN-SNGL-JNT               PIC X.
  4058             88  CF-COMBINED-PLAN              VALUE 'C'.
  4059             88  CF-JNT-PLAN                   VALUE 'J'.
  4060             88  CF-SNGL-PLAN                  VALUE 'S'.
  4061         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4062         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4063         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  75
* EL1278.cbl
  4064         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4065         16  CF-RERATE-CNTL                 PIC  X.
  4066             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4067             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4068             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4069             88  CF-AUTO-RECALC                 VALUE '4'.
  4070         16  CF-BENEFIT-TYPE                PIC  X.
  4071             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4072             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4073         16  CF-POLICY-FEE                  PIC S999V99
  4074                                                    COMP-3.
  4075         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4076         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4077         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4078         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4079         16  FILLER                         PIC  X(32).
  4080         16  CF-TERMINATION-FORM            PIC  X(04).
  4081         16  FILLER                         PIC  X(08).
  4082         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4083                                                       COMP-3.
  4084         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4085         16  CF-ISSUE-LETTER                PIC  X(4).
  4086         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4087         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4088             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4089             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4090         16  CF-MP-REFUND-CALC              PIC X.
  4091             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4092             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4093             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4094             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4095             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4096             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4097             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4098             88  CF-MP-REFD-MEAN                VALUE '8'.
  4099         16  CF-ALT-RATE-CODE               PIC  X(5).
  4100
  4101
  4102         16  FILLER                         PIC X(498).
  4103****************************************************************
  4104*             MORTGAGE COMPANY MASTER RECORD                   *
  4105****************************************************************
  4106
  4107     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4108         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4109         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4110             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4111             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4112             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4113             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4114             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4115
  4116         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4117         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4118         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4119         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4120         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4121
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  76
* EL1278.cbl
  4122         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4123             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4124         16  CF-MP-RECON-USE-IND            PIC X(1).
  4125             88  CF-MP-USE-RECON             VALUE 'Y'.
  4126         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4127             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4128         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4129             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4130             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4131         16  FILLER                         PIC X(1).
  4132         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4133             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4134         16  CF-MORTG-MIB-VERSION           PIC X.
  4135             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4136             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4137             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4138         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4139             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4140                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4141             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4142                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4143             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4144                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4145             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4146                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4147             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4148                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4149             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4150                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4151         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4152         16  FILLER                         PIC X(7).
  4153         16  CF-MORTG-DESTINATION-SYMBOL.
  4154             20  CF-MORTG-MIB-COMM          PIC X(5).
  4155             20  CF-MORTG-MIB-TERM          PIC X(5).
  4156         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4157             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4158         16  FILLER                         PIC X(03).
  4159         16  CF-MP-CHECK-NO-CONTROL.
  4160             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4161                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4162                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4163                                                ' ' LOW-VALUES.
  4164                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4165                                               VALUE '3'.
  4166         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4167         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4168         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4169             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4170                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4171             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4172                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4173             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4174                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4175             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4176                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4177             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4178                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4179             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  77
* EL1278.cbl
  4180                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4181         16  CF-MORTG-BILLING-AREA.
  4182             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4183                                            PIC X.
  4184         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4185         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4186         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4187         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4188             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4189             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4190         16  FILLER                         PIC X.
  4191         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4192             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4193             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4194         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4195         16  FILLER                         PIC X(8).
  4196         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4197         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4198         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4199         16  CF-ACH-COMPANY-ID.
  4200             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4201                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4202                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4203                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4204             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4205         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4206             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4207         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4208             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4209             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4210         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4211         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4212         16  FILLER                         PIC X(536).
  4213
  4214****************************************************************
  4215*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4216****************************************************************
  4217
  4218     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4219         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4220             20  CF-FEMALE-HEIGHT.
  4221                 24  CF-FEMALE-FT           PIC 99.
  4222                 24  CF-FEMALE-IN           PIC 99.
  4223             20  CF-FEMALE-MIN-WT           PIC 999.
  4224             20  CF-FEMALE-MAX-WT           PIC 999.
  4225         16  FILLER                         PIC X(428).
  4226
  4227     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4228         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4229             20  CF-MALE-HEIGHT.
  4230                 24  CF-MALE-FT             PIC 99.
  4231                 24  CF-MALE-IN             PIC 99.
  4232             20  CF-MALE-MIN-WT             PIC 999.
  4233             20  CF-MALE-MAX-WT             PIC 999.
  4234         16  FILLER                         PIC X(428).
  4235******************************************************************
  4236*             AUTOMATIC ACTIVITY RECORD                          *
  4237******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  78
* EL1278.cbl
  4238     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4239         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4240             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4241             20  CF-SYS-LETTER-ID           PIC X(04).
  4242             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4243             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4244             20  CF-SYS-RESET-SW            PIC X(01).
  4245             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4246             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4247
  4248         16  FILLER                         PIC X(50).
  4249
  4250         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4251             20  CF-USER-ACTIVE-SW          PIC X(01).
  4252             20  CF-USER-LETTER-ID          PIC X(04).
  4253             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4254             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4255             20  CF-USER-RESET-SW           PIC X(01).
  4256             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4257             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4258             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4259
  4260         16  FILLER                         PIC X(246).
  4261*                            COPY ERCACCT.
  4262******************************************************************
  4263*                                                                *
  4264*                                                                *
  4265*                            ERCACCT                             *
  4266*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4267*                            VMOD=2.031                          *
  4268*                                                                *
  4269*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4270*                                                                *
  4271*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4272*   VSAM ACCOUNT MASTER FILES.                                   *
  4273*                                                                *
  4274*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4275*                                                                *
  4276*   FILE TYPE = VSAM,KSDS                                        *
  4277*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4278*                                                                *
  4279*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4280*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4281*                                                                *
  4282*   LOG = NO                                                     *
  4283*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4284*                                                                *
  4285*                                                                *
  4286******************************************************************
  4287*                   C H A N G E   L O G
  4288*
  4289* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4290*-----------------------------------------------------------------
  4291*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4292* EFFECTIVE    NUMBER
  4293*-----------------------------------------------------------------
  4294* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4295* 092705    2005050300006  PEMA  ADD SPP LEASES
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  79
* EL1278.cbl
  4296* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4297* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4298* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4299* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4300* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4301******************************************************************
  4302
  4303 01  ACCOUNT-MASTER.
  4304     12  AM-RECORD-ID                      PIC XX.
  4305         88  VALID-AM-ID                      VALUE 'AM'.
  4306
  4307     12  AM-CONTROL-PRIMARY.
  4308         16  AM-COMPANY-CD                 PIC X.
  4309         16  AM-MSTR-CNTRL.
  4310             20  AM-CONTROL-A.
  4311                 24  AM-CARRIER            PIC X.
  4312                 24  AM-GROUPING.
  4313                     28 AM-GROUPING-PREFIX PIC XXX.
  4314                     28 AM-GROUPING-PRIME  PIC XXX.
  4315                 24  AM-STATE              PIC XX.
  4316                 24  AM-ACCOUNT.
  4317                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4318                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4319             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4320                                           PIC X(19).
  4321             20  AM-CNTRL-B.
  4322                 24  AM-EXPIRATION-DT      PIC XX.
  4323                 24  FILLER                PIC X(4).
  4324             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4325                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4326
  4327     12  AM-CONTROL-BY-VAR-GRP.
  4328         16  AM-COMPANY-CD-A1              PIC X.
  4329         16  AM-VG-CARRIER                 PIC X.
  4330         16  AM-VG-GROUPING                PIC X(6).
  4331         16  AM-VG-STATE                   PIC XX.
  4332         16  AM-VG-ACCOUNT                 PIC X(10).
  4333         16  AM-VG-DATE.
  4334             20  AM-VG-EXPIRATION-DT       PIC XX.
  4335             20  FILLER                    PIC X(4).
  4336         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4337                                           PIC 9(11)      COMP-3.
  4338     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4339         16  FILLER                        PIC X(10).
  4340         16  AM-VG-KEY3.
  4341             20  AM-VG3-ACCOUNT            PIC X(10).
  4342             20  AM-VG3-EXP-DT             PIC XX.
  4343         16  FILLER                        PIC X(4).
  4344     12  AM-MAINT-INFORMATION.
  4345         16  AM-LAST-MAINT-DT              PIC XX.
  4346         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4347         16  AM-LAST-MAINT-USER            PIC X(4).
  4348         16  FILLER                        PIC XX.
  4349
  4350     12  AM-EFFECTIVE-DT                   PIC XX.
  4351     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4352
  4353     12  AM-PREV-DATES  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  80
* EL1278.cbl
  4354         16  AM-PREV-EXP-DT                PIC 9(11).
  4355         16  AM-PREV-EFF-DT                PIC 9(11).
  4356
  4357     12  AM-REPORT-CODE-1                  PIC X(10).
  4358     12  AM-REPORT-CODE-2                  PIC X(10).
  4359
  4360     12  AM-CITY-CODE                      PIC X(4).
  4361     12  AM-COUNTY-PARISH                  PIC X(6).
  4362
  4363     12  AM-NAME                           PIC X(30).
  4364     12  AM-PERSON                         PIC X(30).
  4365     12  AM-ADDRS                          PIC X(30).
  4366     12  AM-CITY.
  4367         16  AM-ADDR-CITY                  PIC X(28).
  4368         16  AM-ADDR-STATE                 PIC XX.
  4369     12  AM-ZIP.
  4370         16  AM-ZIP-PRIME.
  4371             20  AM-ZIP-PRI-1ST            PIC X.
  4372                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4373             20  FILLER                    PIC X(4).
  4374         16  AM-ZIP-PLUS4                  PIC X(4).
  4375     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4376         16  AM-CAN-POSTAL-1               PIC XXX.
  4377         16  AM-CAN-POSTAL-2               PIC XXX.
  4378         16  FILLER                        PIC XXX.
  4379     12  AM-TEL-NO.
  4380         16  AM-AREA-CODE                  PIC 999.
  4381         16  AM-TEL-PRE                    PIC 999.
  4382         16  AM-TEL-NBR                    PIC 9(4).
  4383     12  AM-TEL-LOC                        PIC X.
  4384         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4385         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4386
  4387     12  AM-COMM-STRUCTURE.
  4388         16  AM-DEFN-1.
  4389             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4390                 24  AM-AGT.
  4391                     28  AM-AGT-PREFIX     PIC X(4).
  4392                     28  AM-AGT-PRIME      PIC X(6).
  4393                 24  AM-COM-TYP            PIC X.
  4394                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4395                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4396                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4397                 24  AM-RECALC-LV-INDIC    PIC X.
  4398                 24  AM-RETRO-LV-INDIC     PIC X.
  4399                 24  AM-GL-CODES           PIC X.
  4400                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4401                 24  FILLER                PIC X(01).
  4402         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4403             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4404                 24  FILLER                PIC X(11).
  4405                 24  AM-L-COMA             PIC XXX.
  4406                 24  AM-J-COMA             PIC XXX.
  4407                 24  AM-A-COMA             PIC XXX.
  4408                 24  FILLER                PIC X(6).
  4409
  4410     12  AM-COMM-CHANGE-STATUS             PIC X.
  4411         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  81
* EL1278.cbl
  4412
  4413     12  AM-CSR-CODE                       PIC X(4).
  4414
  4415     12  AM-BILLING-STATUS                 PIC X.
  4416         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4417         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4418     12  AM-AUTO-REFUND-SW                 PIC X.
  4419         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4420         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4421     12  AM-GPCD                           PIC 99.
  4422     12  AM-IG                             PIC X.
  4423         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4424         88  AM-HAS-GROUP                     VALUE '2'.
  4425     12  AM-STATUS                         PIC X.
  4426         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4427         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4428         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4429         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4430         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4431         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4432     12  AM-REMIT-TO                       PIC 99.
  4433     12  AM-ID-NO                          PIC X(11).
  4434
  4435     12  AM-CAL-TABLE                      PIC XX.
  4436     12  AM-LF-DEVIATION                   PIC XXX.
  4437     12  AM-AH-DEVIATION                   PIC XXX.
  4438     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4439     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4440     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4441     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4442     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4443     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4444
  4445     12  AM-USER-FIELDS.
  4446         16  AM-FLD-1                      PIC XX.
  4447         16  AM-FLD-2                      PIC XX.
  4448         16  AM-FLD-3                      PIC XX.
  4449         16  AM-FLD-4                      PIC XX.
  4450         16  AM-FLD-5                      PIC XX.
  4451
  4452     12  AM-1ST-PROD-DATE.
  4453         16  AM-1ST-PROD-YR                PIC XX.
  4454         16  AM-1ST-PROD-MO                PIC XX.
  4455         16  AM-1ST-PROD-DA                PIC XX.
  4456     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4457     12  AM-CERTS-PURGED-DATE.
  4458         16  AM-PUR-YR                     PIC XX.
  4459         16  AM-PUR-MO                     PIC XX.
  4460         16  AM-PUR-DA                     PIC XX.
  4461     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4462     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4463     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4464     12  AM-INACTIVE-DATE.
  4465         16  AM-INA-MO                     PIC 99.
  4466         16  AM-INA-DA                     PIC 99.
  4467         16  AM-INA-YR                     PIC 99.
  4468     12  AM-AR-HI-CERT-DATE                PIC XX.
  4469
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  82
* EL1278.cbl
  4470     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4471     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4472
  4473     12  AM-OB-PAYMENT-MODE                PIC X.
  4474         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4475         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4476         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4477         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4478
  4479     12  AM-AH-ONLY-INDICATOR              PIC X.
  4480         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4481         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4482
  4483     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4484
  4485     12  AM-OVER-SHORT.
  4486         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4487         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4488
  4489     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4490     12  AM-DCC-CLP-STATE                  PIC XX.
  4491
  4492     12  AM-RECALC-COMM                    PIC X.
  4493     12  AM-RECALC-REIN                    PIC X.
  4494
  4495     12  AM-REI-TABLE                      PIC XXX.
  4496     12  AM-REI-ET-LF                      PIC X.
  4497     12  AM-REI-ET-AH                      PIC X.
  4498     12  AM-REI-PE-LF                      PIC X.
  4499     12  AM-REI-PE-AH                      PIC X.
  4500     12  AM-REI-PRT-ST                     PIC X.
  4501     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4502     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4503     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4504     12  AM-REI-GROUP-A                    PIC X(6).
  4505     12  AM-REI-MORT                       PIC X(4).
  4506     12  AM-REI-PRT-OW                     PIC X.
  4507     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4508     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4509     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4510     12  AM-REI-GROUP-B                    PIC X(6).
  4511
  4512     12  AM-TRUST-TYPE                     PIC X(2).
  4513
  4514     12  AM-EMPLOYER-STMT-USED             PIC X.
  4515     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4516
  4517     12  AM-STD-AH-TYPE                    PIC XX.
  4518     12  AM-EARN-METHODS.
  4519         16  AM-EARN-METHOD-R              PIC X.
  4520             88 AM-REF-RL-R78                 VALUE 'R'.
  4521             88 AM-REF-RL-PR                  VALUE 'P'.
  4522             88 AM-REF-RL-MEAN                VALUE 'M'.
  4523             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4524         16  AM-EARN-METHOD-L              PIC X.
  4525             88 AM-REF-LL-R78                 VALUE 'R'.
  4526             88 AM-REF-LL-PR                  VALUE 'P'.
  4527             88 AM-REF-LL-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  83
* EL1278.cbl
  4528             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4529         16  AM-EARN-METHOD-A              PIC X.
  4530             88 AM-REF-AH-R78                 VALUE 'R'.
  4531             88 AM-REF-AH-PR                  VALUE 'P'.
  4532             88 AM-REF-AH-MEAN                VALUE 'M'.
  4533             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4534             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4535             88 AM-REF-AH-NET                 VALUE 'N'.
  4536
  4537     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4538     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4539     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4540
  4541     12  AM-RET-Y-N                        PIC X.
  4542     12  AM-RET-P-E                        PIC X.
  4543     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4544     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4545     12  AM-RET-GRP                        PIC X(6).
  4546     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4547         16  AM-POOL-PRIME                 PIC XXX.
  4548         16  AM-POOL-SUB                   PIC XXX.
  4549     12  AM-RETRO-EARNINGS.
  4550         16  AM-RET-EARN-R                 PIC X.
  4551         16  AM-RET-EARN-L                 PIC X.
  4552         16  AM-RET-EARN-A                 PIC X.
  4553     12  AM-RET-ST-TAX-USE                 PIC X.
  4554         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4555         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4556     12  AM-RETRO-BEG-EARNINGS.
  4557         16  AM-RET-BEG-EARN-R             PIC X.
  4558         16  AM-RET-BEG-EARN-L             PIC X.
  4559         16  AM-RET-BEG-EARN-A             PIC X.
  4560     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4561     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4562
  4563     12  AM-USER-SELECT-OPTIONS.
  4564         16  AM-USER-SELECT-1              PIC X(10).
  4565         16  AM-USER-SELECT-2              PIC X(10).
  4566         16  AM-USER-SELECT-3              PIC X(10).
  4567         16  AM-USER-SELECT-4              PIC X(10).
  4568         16  AM-USER-SELECT-5              PIC X(10).
  4569
  4570     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4571
  4572     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4573
  4574     12  AM-RPT045A-SWITCH                 PIC X.
  4575         88  RPT045A-OFF                   VALUE 'N'.
  4576
  4577     12  AM-INSURANCE-LIMITS.
  4578         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4579         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4580
  4581     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4582         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4583
  4584     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4585         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  84
* EL1278.cbl
  4586         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4587
  4588     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4589
  4590     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4591     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4592     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4593     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4594     12  AM-DCC-UEF-STATE                  PIC XX.
  4595     12  FILLER                            PIC XXX.
  4596     12  AM-REPORT-CODE-3                  PIC X(10).
  4597*    12  FILLER                            PIC X(22).
  4598
  4599     12  AM-RESERVE-DATE.
  4600         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4601         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4602         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4603
  4604     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4605     12  AM-NOTIFICATION-TYPES.
  4606         16  AM-NOTIF-OF-LETTERS           PIC X.
  4607         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4608         16  AM-NOTIF-OF-REPORTS           PIC X.
  4609         16  AM-NOTIF-OF-STATUS            PIC X.
  4610
  4611     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4612         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4613         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4614         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4615         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4616
  4617     12  AM-BENEFIT-CONTROLS.
  4618         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4619             20  AM-BENEFIT-CODE           PIC XX.
  4620             20  AM-BENEFIT-TYPE           PIC X.
  4621             20  AM-BENEFIT-REVISION       PIC XXX.
  4622             20  AM-BENEFIT-REM-TERM       PIC X.
  4623             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4624             20  FILLER                    PIC XX.
  4625         16  FILLER                        PIC X(80).
  4626
  4627     12  AM-TRANSFER-DATA.
  4628         16  AM-TRANSFERRED-FROM.
  4629             20  AM-TRNFROM-CARRIER        PIC X.
  4630             20  AM-TRNFROM-GROUPING.
  4631                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4632                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4633             20  AM-TRNFROM-STATE          PIC XX.
  4634             20  AM-TRNFROM-ACCOUNT.
  4635                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4636                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4637             20  AM-TRNFROM-DTE            PIC XX.
  4638         16  AM-TRANSFERRED-TO.
  4639             20  AM-TRNTO-CARRIER          PIC X.
  4640             20  AM-TRNTO-GROUPING.
  4641                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4642                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4643             20  AM-TRNTO-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  85
* EL1278.cbl
  4644             20  AM-TRNTO-ACCOUNT.
  4645                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4646                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4647             20  AM-TRNTO-DTE              PIC XX.
  4648         16  FILLER                        PIC X(10).
  4649
  4650     12  AM-SAVED-REMIT-TO                 PIC 99.
  4651
  4652     12  AM-COMM-STRUCTURE-SAVED.
  4653         16  AM-DEFN-1-SAVED.
  4654             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4655                 24  AM-AGT-SV             PIC X(10).
  4656                 24  AM-COM-TYP-SV         PIC X.
  4657                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4658                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4659                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4660                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4661                 24  FILLER                PIC X.
  4662                 24  AM-GL-CODES-SV        PIC X.
  4663                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4664                 24  FILLER                PIC X.
  4665         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4666             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4667                 24  FILLER                PIC X(11).
  4668                 24  AM-L-COMA-SV          PIC XXX.
  4669                 24  AM-J-COMA-SV          PIC XXX.
  4670                 24  AM-A-COMA-SV          PIC XXX.
  4671                 24  FILLER                PIC X(6).
  4672
  4673     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4674         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4675            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4676            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4677            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4678
  4679     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4680     12  FILLER                            PIC X(120).
  4681
  4682     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4683         16  AM-CONTROL-NAME               PIC X(30).
  4684         16  AM-EXECUTIVE-ONE.
  4685             20  AM-EXEC1-NAME             PIC X(15).
  4686             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4687                                                          COMP-3.
  4688             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4689                                                          COMP-3.
  4690         16  AM-EXECUTIVE-TWO.
  4691             20  AM-EXEC2-NAME             PIC X(15).
  4692             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4693                                                          COMP-3.
  4694             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4695                                                          COMP-3.
  4696
  4697     12  AM-RETRO-ADDITIONAL-DATA.
  4698         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4699         16  AM-RETRO-PREM-P-E             PIC X.
  4700         16  AM-RETRO-CLMS-P-I             PIC X.
  4701         16  AM-RETRO-RET-BRACKET-LF.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  86
* EL1278.cbl
  4702             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4703                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4704                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4705             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4706                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4707                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4708             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4709                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4710                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4711         16  AM-RETRO-RET-BRACKET-AH.
  4712             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4713                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4714                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4715                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4716             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4717                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4718                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4719             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4720                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4721                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4722
  4723     12  AM-COMMENTS.
  4724         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4725
  4726     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4727         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4728         16  AM-FLI-BILLING-CODE           PIC X.
  4729         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4730         16  AM-FLI-UNITED-IDENT           PIC X.
  4731         16  AM-FLI-INTEREST-LOST-DATA.
  4732             20  AM-FLI-BANK-NO            PIC X(5).
  4733             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4734             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4735             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4736         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4737             20  AM-FLI-AGT                PIC X(9).
  4738             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4739             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4740         16  FILLER                        PIC X(102).
  4741
  4742     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4743         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4744             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4745             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4746             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4747             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4748             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4749         16  FILLER                          PIC X(10).
  4750******************************************************************
  4751*                            COPY ELCCERT.
  4752******************************************************************
  4753*                                                                *
  4754*                            ELCCERT.                            *
  4755*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4756*                            VMOD=2.013                          *
  4757*                                                                *
  4758*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4759*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  87
* EL1278.cbl
  4760*   FILE TYPE = VSAM,KSDS                                        *
  4761*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4762*                                                                *
  4763*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4764*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4765*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4766*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4767*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4768*                                                                *
  4769*   LOG = YES                                                    *
  4770*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4771******************************************************************
  4772*                   C H A N G E   L O G
  4773*
  4774* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4775*-----------------------------------------------------------------
  4776*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4777* EFFECTIVE    NUMBER
  4778*-----------------------------------------------------------------
  4779* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4780* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4781* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4782* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4783* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4784* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4785* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4786* 032612  CR2011110200001  PEMA  AHL CHANGES
  4787******************************************************************
  4788
  4789 01  CERTIFICATE-MASTER.
  4790     12  CM-RECORD-ID                      PIC XX.
  4791         88  VALID-CM-ID                      VALUE 'CM'.
  4792
  4793     12  CM-CONTROL-PRIMARY.
  4794         16  CM-COMPANY-CD                 PIC X.
  4795         16  CM-CARRIER                    PIC X.
  4796         16  CM-GROUPING.
  4797             20  CM-GROUPING-PREFIX        PIC X(3).
  4798             20  CM-GROUPING-PRIME         PIC X(3).
  4799         16  CM-STATE                      PIC XX.
  4800         16  CM-ACCOUNT.
  4801             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4802             20  CM-ACCOUNT-PRIME          PIC X(6).
  4803         16  CM-CERT-EFF-DT                PIC XX.
  4804         16  CM-CERT-NO.
  4805             20  CM-CERT-PRIME             PIC X(10).
  4806             20  CM-CERT-SFX               PIC X.
  4807
  4808     12  CM-CONTROL-BY-NAME.
  4809         16  CM-COMPANY-CD-A1              PIC X.
  4810         16  CM-INSURED-LAST-NAME          PIC X(15).
  4811         16  CM-INSURED-INITIALS.
  4812             20  CM-INSURED-INITIAL1       PIC X.
  4813             20  CM-INSURED-INITIAL2       PIC X.
  4814
  4815     12  CM-CONTROL-BY-SSN.
  4816         16  CM-COMPANY-CD-A2              PIC X.
  4817         16  CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  88
* EL1278.cbl
  4818             20  CM-SSN-STATE              PIC XX.
  4819             20  CM-SSN-ACCOUNT            PIC X(6).
  4820             20  CM-SSN-LN3.
  4821                 25  CM-INSURED-INITIALS-A2.
  4822                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4823                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4824                 25 CM-PART-LAST-NAME-A2         PIC X.
  4825
  4826     12  CM-CONTROL-BY-CERT-NO.
  4827         16  CM-COMPANY-CD-A4              PIC X.
  4828         16  CM-CERT-NO-A4                 PIC X(11).
  4829
  4830     12  CM-CONTROL-BY-MEMB.
  4831         16  CM-COMPANY-CD-A5              PIC X.
  4832         16  CM-MEMBER-NO.
  4833             20  CM-MEMB-STATE             PIC XX.
  4834             20  CM-MEMB-ACCOUNT           PIC X(6).
  4835             20  CM-MEMB-LN4.
  4836                 25  CM-INSURED-INITIALS-A5.
  4837                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4838                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4839                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4840
  4841     12  CM-INSURED-PROFILE-DATA.
  4842         16  CM-INSURED-FIRST-NAME.
  4843             20  CM-INSURED-1ST-INIT       PIC X.
  4844             20  FILLER                    PIC X(9).
  4845         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4846         16  CM-INSURED-SEX                PIC X.
  4847             88  CM-SEX-MALE                  VALUE 'M'.
  4848             88  CM-SEX-FEMAL                 VALUE 'F'.
  4849         16  CM-INSURED-JOINT-AGE          PIC 99.
  4850         16  CM-JOINT-INSURED-NAME.
  4851             20  CM-JT-LAST-NAME           PIC X(15).
  4852             20  CM-JT-FIRST-NAME.
  4853                 24  CM-JT-1ST-INIT        PIC X.
  4854                 24  FILLER                PIC X(9).
  4855             20  CM-JT-INITIAL             PIC X.
  4856
  4857     12  CM-LIFE-DATA.
  4858         16  CM-LF-BENEFIT-CD              PIC XX.
  4859         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4860         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4861         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4862         16  CM-LF-DEV-CODE                PIC XXX.
  4863         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4864         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4865         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4866         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4867         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4868         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4869         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4870         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4871         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4872         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4873         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4874         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4875         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  89
* EL1278.cbl
  4876
  4877     12  CM-AH-DATA.
  4878         16  CM-AH-BENEFIT-CD              PIC XX.
  4879         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4880         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4881         16  CM-AH-DEV-CODE                PIC XXX.
  4882         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4883         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4884         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4885         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4886         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4887         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4888         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4889         16  CM-AH-PAID-THRU-DT            PIC XX.
  4890             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4891         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4892         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4893         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4894         16  FILLER                        PIC X.
  4895
  4896     12  CM-LOAN-INFORMATION.
  4897         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4898         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4899                                           PIC S9(5)V99  COMP-3.
  4900         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4901         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4902         16  CM-PAY-FREQUENCY              PIC S99.
  4903         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4904         16  CM-RATE-CLASS                 PIC XX.
  4905         16  CM-BENEFICIARY                PIC X(25).
  4906         16  CM-POLICY-FORM-NO             PIC X(12).
  4907         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4908         16  CM-LAST-ADD-ON-DT             PIC XX.
  4909         16  CM-DEDUCTIBLE-AMOUNTS.
  4910             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4911             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4912         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4913             20  CM-RESIDENT-STATE         PIC XX.
  4914             20  CM-RATE-CODE              PIC X(4).
  4915             20  FILLER                    PIC XX.
  4916         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4917             20  CM-LOAN-OFFICER           PIC X(5).
  4918             20  FILLER                    PIC XXX.
  4919         16  CM-CSR-CODE                   PIC XXX.
  4920         16  CM-UNDERWRITING-CODE          PIC X.
  4921             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4922         16  CM-POST-CARD-IND              PIC X.
  4923         16  CM-NH-INTERFACE-SW            PIC X.
  4924         16  CM-PREMIUM-TYPE               PIC X.
  4925             88  CM-SING-PRM                  VALUE '1'.
  4926             88  CM-O-B-COVERAGE              VALUE '2'.
  4927             88  CM-OPEN-END                  VALUE '3'.
  4928         16  CM-IND-GRP-TYPE               PIC X.
  4929             88  CM-INDIVIDUAL                VALUE 'I'.
  4930             88  CM-GROUP                     VALUE 'G'.
  4931         16  CM-SKIP-CODE                  PIC X.
  4932             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4933             88  SKIP-JULY                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  90
* EL1278.cbl
  4934             88  SKIP-AUGUST                  VALUE '2'.
  4935             88  SKIP-SEPTEMBER               VALUE '3'.
  4936             88  SKIP-JULY-AUG                VALUE '4'.
  4937             88  SKIP-AUG-SEPT                VALUE '5'.
  4938             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4939             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4940             88  SKIP-JUNE                    VALUE '8'.
  4941             88  SKIP-JUNE-JULY               VALUE '9'.
  4942             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4943             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4944         16  CM-PAYMENT-MODE               PIC X.
  4945             88  PAY-MONTHLY                  VALUE SPACE.
  4946             88  PAY-WEEKLY                   VALUE '1'.
  4947             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4948             88  PAY-BI-WEEKLY                VALUE '3'.
  4949             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4950         16  CM-LOAN-NUMBER                PIC X(8).
  4951         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4952         16  CM-OLD-LOF                    PIC XXX.
  4953*        16  CM-LOAN-OFFICER               PIC XXX.
  4954         16  CM-REIN-TABLE                 PIC XXX.
  4955         16  CM-SPECIAL-REIN-CODE          PIC X.
  4956         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4957         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4958         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4959
  4960     12  CM-STATUS-DATA.
  4961         16  CM-ENTRY-STATUS               PIC X.
  4962         16  CM-ENTRY-DT                   PIC XX.
  4963
  4964         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4965         16  CM-LF-CANCEL-DT               PIC XX.
  4966         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4967
  4968         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4969         16  CM-LF-DEATH-DT                PIC XX.
  4970         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4971
  4972         16  CM-LF-CURRENT-STATUS          PIC X.
  4973             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4974                                                'M' '4' '5' '9'.
  4975             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4976             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4977             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4978             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4979             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4980             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4981             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4982             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4983             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4984             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4985             88  CM-LF-DECLINED               VALUE 'D'.
  4986             88  CM-LF-VOIDED                 VALUE 'V'.
  4987
  4988         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4989         16  CM-AH-CANCEL-DT               PIC XX.
  4990         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4991
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  91
* EL1278.cbl
  4992         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4993         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4994         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4995
  4996         16  CM-AH-CURRENT-STATUS          PIC X.
  4997             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4998                                                'M' '4' '5' '9'.
  4999             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5000             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5001             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5002             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5003             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5004             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5005             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5006             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5007             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5008             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5009             88  CM-AH-DECLINED               VALUE 'D'.
  5010             88  CM-AH-VOIDED                 VALUE 'V'.
  5011
  5012         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5013             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5014             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5015             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5016         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5017
  5018         16  CM-ENTRY-BATCH                PIC X(6).
  5019         16  CM-LF-EXIT-BATCH              PIC X(6).
  5020         16  CM-AH-EXIT-BATCH              PIC X(6).
  5021         16  CM-LAST-MONTH-END             PIC XX.
  5022
  5023     12  CM-NOTE-SW                        PIC X.
  5024         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5025         88  CERT-NOTES-PRESENT               VALUE '1'.
  5026         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5027         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5028         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5029         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5030         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5031         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5032     12  CM-COMP-EXCP-SW                   PIC X.
  5033         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5034         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5035     12  CM-INSURED-ADDRESS-SW             PIC X.
  5036         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5037         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5038
  5039*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5040     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5041     12  FILLER                            PIC X.
  5042
  5043*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5044     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5045     12  FILLER                            PIC X.
  5046*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5047     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5048
  5049     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  92
* EL1278.cbl
  5050         88  CERT-ADDED-BATCH                 VALUE ' '.
  5051         88  CERT-ADDED-ONLINE                VALUE '1'.
  5052         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5053         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5054         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5055     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5056         88  CERT-AS-LOADED                   VALUE ' '.
  5057         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5058         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5059         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5060         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5061         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5062         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5063         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5064
  5065     12  CM-ACCOUNT-COMM-PCTS.
  5066         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5067         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5068
  5069     12  CM-USER-FIELD                     PIC X.
  5070     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5071     12  CM-CLP-STATE                      PIC XX.
  5072     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5073     12  CM-USER-RESERVED                  PIC XXX.
  5074     12  FILLER REDEFINES CM-USER-RESERVED.
  5075         16  CM-AH-CLASS-CD                PIC XX.
  5076         16  F                             PIC X.
  5077******************************************************************
  5078*                            COPY ERCMAIL.
  5079******************************************************************
  5080*                                                                *
  5081*                                                                *
  5082*                            ERCMAIL                             *
  5083*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5084*                            VMOD=2.003                          *
  5085*                                                                *
  5086*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5087*                                                                *
  5088*   FILE TYPE = VSAM,KSDS                                        *
  5089*   RECORD SIZE = 374   RECFORM = FIX                            *
  5090*                                                                *
  5091*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5092*   ALTERNATE PATH    = NOT USED                                 *
  5093*                                                                *
  5094*   LOG = YES                                                    *
  5095*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5096******************************************************************
  5097*                   C H A N G E   L O G
  5098*
  5099* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5100*-----------------------------------------------------------------
  5101*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5102* EFFECTIVE    NUMBER
  5103*-----------------------------------------------------------------
  5104* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5105* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5106* 111108                   PEMA  ADD CRED BENE ADDR2
  5107******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  93
* EL1278.cbl
  5108
  5109 01  MAILING-DATA.
  5110     12  MA-RECORD-ID                      PIC XX.
  5111         88  VALID-MA-ID                       VALUE 'MA'.
  5112
  5113     12  MA-CONTROL-PRIMARY.
  5114         16  MA-COMPANY-CD                 PIC X.
  5115         16  MA-CARRIER                    PIC X.
  5116         16  MA-GROUPING.
  5117             20  MA-GROUPING-PREFIX        PIC XXX.
  5118             20  MA-GROUPING-PRIME         PIC XXX.
  5119         16  MA-STATE                      PIC XX.
  5120         16  MA-ACCOUNT.
  5121             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5122             20  MA-ACCOUNT-PRIME          PIC X(6).
  5123         16  MA-CERT-EFF-DT                PIC XX.
  5124         16  MA-CERT-NO.
  5125             20  MA-CERT-PRIME             PIC X(10).
  5126             20  MA-CERT-SFX               PIC X.
  5127
  5128     12  FILLER                            PIC XX.
  5129
  5130     12  MA-ACCESS-CONTROL.
  5131         16  MA-SOURCE-SYSTEM              PIC XX.
  5132             88  MA-FROM-CREDIT                VALUE 'CR'.
  5133             88  MA-FROM-VSI                   VALUE 'VS'.
  5134             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5135             88  MA-FROM-OTHER                 VALUE 'OT'.
  5136         16  MA-RECORD-ADD-DT              PIC XX.
  5137         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5138         16  MA-LAST-MAINT-DT              PIC XX.
  5139         16  MA-LAST-MAINT-BY              PIC XXXX.
  5140         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5141
  5142     12  MA-PROFILE-INFO.
  5143         16  MA-QUALIFY-CODE-1             PIC XX.
  5144         16  MA-QUALIFY-CODE-2             PIC XX.
  5145         16  MA-QUALIFY-CODE-3             PIC XX.
  5146         16  MA-QUALIFY-CODE-4             PIC XX.
  5147         16  MA-QUALIFY-CODE-5             PIC XX.
  5148
  5149         16  MA-INSURED-LAST-NAME          PIC X(15).
  5150         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5151         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5152         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5153         16  MA-INSURED-BIRTH-DT           PIC XX.
  5154         16  MA-INSURED-SEX                PIC X.
  5155             88  MA-SEX-MALE                   VALUE 'M'.
  5156             88  MA-SEX-FEMALE                 VALUE 'F'.
  5157         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5158
  5159         16  MA-ADDRESS-CORRECTED          PIC X.
  5160         16  MA-JOINT-BIRTH-DT             PIC XX.
  5161*        16  FILLER                        PIC X(12).
  5162
  5163         16  MA-ADDRESS-LINE-1             PIC X(30).
  5164         16  MA-ADDRESS-LINE-2             PIC X(30).
  5165         16  MA-CITY-STATE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  94
* EL1278.cbl
  5166             20  MA-CITY                   PIC X(28).
  5167             20  MA-ADDR-STATE             PIC XX.
  5168         16  MA-ZIP.
  5169             20  MA-ZIP-CODE.
  5170                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5171                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5172                 24  FILLER                PIC X(4).
  5173             20  MA-ZIP-PLUS4              PIC X(4).
  5174         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5175             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5176             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5177             20  FILLER                    PIC X(3).
  5178
  5179         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5180
  5181         16  FILLER                        PIC XXX.
  5182*        16  FILLER                        PIC X(10).
  5183
  5184     12  MA-CRED-BENE-INFO.
  5185         16  MA-CRED-BENE-NAME                 PIC X(25).
  5186         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5187         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5188         16  MA-CRED-BENE-CTYST.
  5189             20  MA-CRED-BENE-CITY             PIC X(28).
  5190             20  MA-CRED-BENE-STATE            PIC XX.
  5191         16  MA-CRED-BENE-ZIP.
  5192             20  MA-CB-ZIP-CODE.
  5193                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5194                     88  MA-CB-CANADIAN-POST-CODE
  5195                                           VALUE 'A' THRU 'Z'.
  5196                 24  FILLER                    PIC X(4).
  5197             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5198         16  MA-CB-CANADIAN-POSTAL-CODE
  5199                            REDEFINES MA-CRED-BENE-ZIP.
  5200             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5201             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5202             20  FILLER                        PIC X(3).
  5203     12  MA-POST-CARD-MAIL-DATA.
  5204         16  MA-MAIL-DATA OCCURS 7.
  5205             20  MA-MAIL-TYPE              PIC X.
  5206                 88  MA-12MO-MAILING           VALUE '1'.
  5207                 88  MA-EXP-MAILING            VALUE '2'.
  5208             20  MA-MAIL-STATUS            PIC X.
  5209                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5210                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5211                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5212             20  MA-MAIL-DATE              PIC XX.
  5213     12  FILLER                            PIC XX.
  5214     12  FILLER                            PIC XX.
  5215*    12  FILLER                            PIC X(30).
  5216******************************************************************
  5217*                            COPY ELCCRTO.
  5218******************************************************************
  5219*                                                                *
  5220*                            ELCCRTO.                            *
  5221*                                                                *
  5222*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5223*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  95
* EL1278.cbl
  5224*   FILE TYPE = VSAM,KSDS                                        *
  5225*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5226*                                                                *
  5227*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5228*                                                                *
  5229*   LOG = YES                                                    *
  5230*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5231******************************************************************
  5232*                   C H A N G E   L O G
  5233*
  5234* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5235*-----------------------------------------------------------------
  5236*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5237* EFFECTIVE    NUMBER
  5238*-----------------------------------------------------------------
  5239* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5240* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5241* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5242* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5243* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5244******************************************************************
  5245 01  ORIGINAL-CERTIFICATE.
  5246     12  OC-RECORD-ID                      PIC XX.
  5247         88  VALID-OC-ID                      VALUE 'OC'.
  5248     12  OC-CONTROL-PRIMARY.
  5249         16  OC-COMPANY-CD                 PIC X.
  5250         16  OC-CARRIER                    PIC X.
  5251         16  OC-GROUPING                   PIC X(6).
  5252         16  OC-STATE                      PIC XX.
  5253         16  OC-ACCOUNT                    PIC X(10).
  5254         16  OC-CERT-EFF-DT                PIC XX.
  5255         16  OC-CERT-NO.
  5256             20  OC-CERT-PRIME             PIC X(10).
  5257             20  OC-CERT-SFX               PIC X.
  5258         16  OC-RECORD-TYPE                PIC X.
  5259         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5260     12  OC-LAST-MAINT-DT                  PIC XX.
  5261     12  OC-LAST-MAINT-BY                  PIC X(4).
  5262     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5263     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5264     12  FILLER                            PIC X(49).
  5265     12  OC-ORIG-REC.
  5266         16  OC-INS-LAST-NAME              PIC X(15).
  5267         16  OC-INS-FIRST-NAME             PIC X(10).
  5268         16  OC-INS-MIDDLE-INIT            PIC X.
  5269         16  OC-INS-AGE                    PIC S999     COMP-3.
  5270         16  OC-JNT-LAST-NAME              PIC X(15).
  5271         16  OC-JNT-FIRST-NAME             PIC X(10).
  5272         16  OC-JNT-MIDDLE-INIT            PIC X.
  5273         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5274         16  OC-LF-BENCD                   PIC XX.
  5275         16  OC-LF-TERM                    PIC S999      COMP-3.
  5276         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5277         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5278         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5279         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5280         16  OC-LF-EXP-DT                  PIC XX.
  5281         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  96
* EL1278.cbl
  5282         16  OC-LF-CANCEL-DT               PIC XX.
  5283         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5284         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5285         16  OC-AH-BENCD                   PIC XX.
  5286         16  OC-AH-TERM                    PIC S999      COMP-3.
  5287         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5288         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5289         16  OC-AH-EXP-DT                  PIC XX.
  5290         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5291         16  OC-AH-CP                      PIC 99.
  5292         16  OC-AH-CANCEL-DT               PIC XX.
  5293         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5294         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5295         16  OC-CRED-BENE-NAME             PIC X(25).
  5296         16  OC-1ST-PMT-DT                 PIC XX.
  5297         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5298         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5299         16  OC-ISSUE-TRAN-IND             PIC X.
  5300         16  OC-CANCEL-TRAN-IND            PIC X.
  5301         16  FILLER                        PIC X(211).
  5302
  5303     12  FILLER                            PIC X(50).
  5304******************************************************************
  5305*                            COPY ERCFORM.
  5306******************************************************************
  5307*                                                                *
  5308*                                                                *
  5309*                            ERCFORM.                            *
  5310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5311*                            VMOD=2.003                          *
  5312*                                                                *
  5313*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5314*                                                                *
  5315*    FILE TYPE = VSAM,KSDS                                       *
  5316*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5317*                                                                *
  5318*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5319*                                                                *
  5320*    LOG = YES                                                   *
  5321*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5322******************************************************************
  5323 01  FORM-MASTER.
  5324    12  FO-RECORD-ID                 PIC X(02).
  5325        88  VALID-FO-ID                  VALUE 'FO'.
  5326
  5327    12  FO-CONTROL-PRIMARY.
  5328        16  FO-COMPANY-CD            PIC X(01).
  5329        16  FO-STATE                 PIC X(02).
  5330        16  FO-FORM-ID               PIC X(12).
  5331        16  FO-FORM-EXP-DT           PIC X(02).
  5332
  5333    12  FO-POLICY-FORM-DATA.
  5334        16  FO-IND-GRP-CD            PIC X(01).
  5335        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5336        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5337        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5338        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5339        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  97
* EL1278.cbl
  5340        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5341        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5342        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5343        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5344        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5345        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5346        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5347        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5348        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5349        16  FO-APP-CERT-USE-CD       PIC X(01).
  5350
  5351    12  FILLER                       PIC X(29).
  5352
  5353    12  FO-FORM-PLAN-TABLE.
  5354        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5355            20  FO-PLAN-TYPE         PIC X(01).
  5356            20  FO-PLAN-ID           PIC X(02).
  5357            20  FO-PLAN-TERM         PIC 9(03).
  5358            20  FO-PLAN-REFUND-METHOD
  5359                                     PIC X.
  5360
  5361    12  FILLER                       PIC X(30).
  5362
  5363    12  FO-COMMENTS-AREA.
  5364        16  FO-COMMENT-LINE-1        PIC X(78).
  5365
  5366    12  FILLER                       PIC X(20).
  5367
  5368    12  FO-MAINT-INFORMATION.
  5369        16  FO-LAST-MAINT-DT         PIC X(02).
  5370        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5371        16  FO-LAST-MAINT-BY         PIC X(04).
  5372*                            COPY ELCMSTR.
  5373******************************************************************
  5374*                                                                *
  5375*                            ELCMSTR.                            *
  5376*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5377*                            VMOD=2.012                          *
  5378*                                                                *
  5379*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5380*                                                                *
  5381*   FILE TYPE = VSAM,KSDS                                        *
  5382*   RECORD SIZE = 350  RECFORM = FIXED                           *
  5383*                                                                *
  5384*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5385*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5386*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5387*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5388*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5389*                                                 RKP=75,LEN=21  *
  5390*                                                                *
  5391*   **** NOTE ****                                               *
  5392*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5393*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5394*                                                                *
  5395*   LOG = YES                                                    *
  5396*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5397******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  98
* EL1278.cbl
  5398*                   C H A N G E   L O G
  5399*
  5400* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5401*-----------------------------------------------------------------
  5402*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5403* EFFECTIVE    NUMBER
  5404*-----------------------------------------------------------------
  5405* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5406* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5407* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  5408******************************************************************
  5409 01  CLAIM-MASTER.
  5410     12  CL-RECORD-ID                PIC XX.
  5411         88  VALID-CL-ID         VALUE 'CL'.
  5412
  5413     12  CL-CONTROL-PRIMARY.
  5414         16  CL-COMPANY-CD           PIC X.
  5415         16  CL-CARRIER              PIC X.
  5416         16  CL-CLAIM-NO             PIC X(7).
  5417         16  CL-CERT-NO.
  5418             20  CL-CERT-PRIME       PIC X(10).
  5419             20  CL-CERT-SFX         PIC X.
  5420
  5421     12  CL-CONTROL-BY-NAME.
  5422         16  CL-COMPANY-CD-A1        PIC X.
  5423         16  CL-INSURED-LAST-NAME    PIC X(15).
  5424         16  CL-INSURED-NAME.
  5425             20  CL-INSURED-1ST-NAME PIC X(12).
  5426             20  CL-INSURED-MID-INIT PIC X.
  5427
  5428     12  CL-CONTROL-BY-SSN.
  5429         16  CL-COMPANY-CD-A2        PIC X.
  5430         16  CL-SOC-SEC-NO.
  5431             20  CL-SSN-STATE        PIC XX.
  5432             20  CL-SSN-ACCOUNT      PIC X(6).
  5433             20  CL-SSN-LN3          PIC X(3).
  5434
  5435     12  CL-CONTROL-BY-CERT-NO.
  5436         16  CL-COMPANY-CD-A4        PIC X.
  5437         16  CL-CERT-NO-A4.
  5438             20  CL-CERT-A4-PRIME    PIC X(10).
  5439             20  CL-CERT-A4-SFX      PIC X.
  5440
  5441     12  CL-CONTROL-BY-CCN.
  5442         16  CL-COMPANY-CD-A5        PIC X.
  5443         16  CL-CCN-A5.
  5444             20  CL-CCN.
  5445                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5446                 24  CL-CCN-PRIME-A5 PIC X(12).
  5447             20  CL-CCN-FILLER-A5    PIC X(4).
  5448
  5449     12  CL-INSURED-PROFILE-DATA.
  5450         16  CL-INSURED-BIRTH-DT     PIC XX.
  5451         16  CL-INSURED-SEX-CD       PIC X.
  5452             88  INSURED-IS-MALE        VALUE 'M'.
  5453             88  INSURED-IS-FEMALE      VALUE 'F'.
  5454             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5455         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page  99
* EL1278.cbl
  5456         16  FILLER                  PIC X(5).
  5457
  5458     12  CL-PROCESSING-INFO.
  5459         16  CL-PROCESSOR-ID         PIC X(4).
  5460         16  CL-CLAIM-STATUS         PIC X.
  5461             88  CLAIM-IS-OPEN          VALUE 'O'.
  5462             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5463         16  CL-CLAIM-TYPE           PIC X.
  5464*            88  AH-CLAIM               VALUE 'A'.
  5465*            88  LIFE-CLAIM             VALUE 'L'.
  5466*            88  PROPERTY-CLAIM         VALUE 'P'.
  5467*            88  IUI-CLAIM              VALUE 'I'.
  5468*            88  GAP-CLAIM              VALUE 'G'.
  5469         16  CL-CLAIM-PREM-TYPE      PIC X.
  5470             88  SINGLE-PREMIUM         VALUE '1'.
  5471             88  O-B-COVERAGE           VALUE '2'.
  5472             88  OPEN-END-COVERAGE      VALUE '3'.
  5473         16  CL-INCURRED-DT          PIC XX.
  5474         16  CL-REPORTED-DT          PIC XX.
  5475         16  CL-FILE-ESTABLISH-DT    PIC XX.
  5476         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5477         16  CL-LAST-PMT-DT          PIC XX.
  5478         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5479         16  CL-PAID-THRU-DT         PIC XX.
  5480         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5481         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5482         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5483         16  CL-PMT-CALC-METHOD      PIC X.
  5484             88  CL-360-DAY-YR          VALUE '1'.
  5485             88  CL-365-DAY-YR          VALUE '2'.
  5486             88  CL-FULL-MONTHS         VALUE '3'.
  5487         16  CL-CAUSE-CD             PIC X(6).
  5488
  5489         16  CL-PRIME-CERT-NO.
  5490             20  CL-PRIME-CERT-PRIME PIC X(10).
  5491             20  CL-PRIME-CERT-SFX   PIC X.
  5492
  5493         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5494             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5495             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5496
  5497         16  CL-MICROFILM-NO         PIC X(10).
  5498         16  CL-PROG-FORM-TYPE       PIC X.
  5499         16  CL-LAST-ADD-ON-DT       PIC XX.
  5500
  5501         16  CL-LAST-REOPEN-DT       PIC XX.
  5502         16  CL-LAST-CLOSE-DT        PIC XX.
  5503         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5504             88  FINAL-PAID             VALUE '1'.
  5505             88  CLAIM-DENIED           VALUE '2'.
  5506             88  AUTO-CLOSE             VALUE '3'.
  5507             88  MANUAL-CLOSE           VALUE '4'.
  5508             88  BENEFITS-CHANGED       VALUE 'C'.
  5509             88  SETUP-ERRORS           VALUE 'E'.
  5510         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5511         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5512         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5513             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 100
* EL1278.cbl
  5514         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5515         16  FILLER                  PIC X.
  5516
  5517     12  CL-CERTIFICATE-DATA.
  5518         16  CL-CERT-ORIGIN          PIC X.
  5519             88  CERT-WAS-ONLINE        VALUE '1'.
  5520             88  CERT-WAS-CREATED       VALUE '2'.
  5521             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5522         16  CL-CERT-KEY-DATA.
  5523             20  CL-CERT-CARRIER     PIC X.
  5524             20  CL-CERT-GROUPING    PIC X(6).
  5525             20  CL-CERT-STATE       PIC XX.
  5526             20  CL-CERT-ACCOUNT.
  5527                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5528                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5529             20  CL-CERT-EFF-DT      PIC XX.
  5530
  5531     12  CL-STATUS-CONTROLS.
  5532         16  CL-PRIORITY-CD          PIC X.
  5533             88  CONFIDENTIAL-DATA      VALUE '8'.
  5534             88  HIGHEST-PRIORITY       VALUE '9'.
  5535         16  CL-SUPV-ATTN-CD         PIC X.
  5536             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5537             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5538         16  CL-PURGED-DT            PIC XX.
  5539         16  CL-RESTORED-DT          PIC XX.
  5540         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5541         16  CL-NEXT-RESEND-DT       PIC XX.
  5542         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5543         16  CL-CRITICAL-PERIOD      PIC 99.
  5544*        16  FILLER                  PIC XX.
  5545         16  CL-LAST-MAINT-DT        PIC XX.
  5546         16  CL-LAST-MAINT-USER      PIC X(4).
  5547         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5548         16  CL-LAST-MAINT-TYPE      PIC X.
  5549             88  CLAIM-SET-UP           VALUE ' '.
  5550             88  PAYMENT-MADE           VALUE '1'.
  5551             88  LETTER-SENT            VALUE '2'.
  5552             88  MASTER-WAS-ALTERED     VALUE '3'.
  5553             88  MASTER-WAS-RESTORED    VALUE '4'.
  5554             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5555             88  FILE-CONVERTED         VALUE '6'.
  5556             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5557             88  ERROR-CORRECTION       VALUE 'E'.
  5558         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5559         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5560         16  CL-BENEFICIARY          PIC X(10).
  5561         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5562         16  CL-DENIAL-TYPE          PIC X.
  5563             88  CL-TYPE-DENIAL          VALUE '1'.
  5564             88  CL-TYPE-RESCISSION      VALUE '2'.
  5565             88  CL-TYPE-REFORMATION     VALUE '3'.
  5566             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5567             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5568         16  CL-CRIT-PER-RECURRENT   PIC X.
  5569         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  5570         16  CL-RTW-DT               PIC XX.
  5571
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 101
* EL1278.cbl
  5572     12  CL-TRAILER-CONTROLS.
  5573         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5574             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5575             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5576             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5577         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5578         16  FILLER                  PIC XX.
  5579         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5580         16  CL-ADDRESS-TRAILER-CNT.
  5581             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5582                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5583             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5584                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5585             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5586                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5587             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5588                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5589             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5590                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5591             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5592                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5593             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5594                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  5595
  5596     12  CL-CV-REFERENCE-NO.
  5597         16  CL-CV-REFNO-PRIME       PIC X(18).
  5598         16  CL-CV-REFNO-SFX         PIC XX.
  5599
  5600     12  CL-FILE-LOCATION            PIC X(4).
  5601
  5602     12  CL-PROCESS-ERRORS.
  5603         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5604             88  NO-FATAL-ERRORS        VALUE ZERO.
  5605         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5606             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5607
  5608     12  CL-PRODUCT-CD               PIC X.
  5609
  5610     12  CL-CURRENT-KEY-DATA.
  5611         16  CL-CURRENT-CARRIER      PIC X.
  5612         16  CL-CURRENT-GROUPING     PIC X(6).
  5613         16  CL-CURRENT-STATE        PIC XX.
  5614         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5615
  5616     12  CL-ASSOCIATES               PIC X.
  5617         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5618         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5619         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5620         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5621
  5622     12  CL-ACTIVITY-CODE            PIC 99.
  5623     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5624     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5625
  5626     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5627     12  CL-LAG-REPORT-CODE          PIC 9.
  5628     12  CL-LOAN-TYPE                PIC XX.
  5629     12  CL-LEGAL-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 102
* EL1278.cbl
  5630
  5631     12  CL-YESNOSW                  PIC X.
  5632     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  5633         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  5634         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  5635         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  5636     12  cl-insured-claim            pic x.
  5637         88  cl-claim-on-primary         value 'P'.
  5638         88  cl-claim-on-secondary       value 'S'.
  5639     12  cl-benefit-expiration-dt    PIC XX.
  5640*                            COPY ERCPDEF.
  5641******************************************************************
  5642*                                                                *
  5643*                                                                *
  5644*                            ERCPDEF.                            *
  5645*                                                                *
  5646*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5647*                                                                *
  5648*    FILE TYPE = VSAM,KSDS                                       *
  5649*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5650*                                                                *
  5651*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5652*                                                                *
  5653*    LOG = YES                                                   *
  5654*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5655******************************************************************
  5656 01  PRODUCT-MASTER.
  5657    12  PD-RECORD-ID                 PIC X(02).
  5658        88  VALID-PD-ID                  VALUE 'PD'.
  5659    12  PD-CONTROL-PRIMARY.
  5660        16  PD-COMPANY-CD            PIC X.
  5661        16  PD-STATE                 PIC XX.
  5662        16  PD-PRODUCT-CD            PIC XXX.
  5663        16  PD-FILLER                PIC X(7).
  5664        16  PD-BEN-TYPE              PIC X.
  5665        16  PD-BEN-CODE              PIC XX.
  5666        16  PD-PROD-EXP-DT           PIC XX.
  5667    12  FILLER                       PIC X(50).
  5668    12  PD-PRODUCT-DATA OCCURS 8.
  5669        16  PD-PROD-CODE             PIC X.
  5670            88  PD-PROD-LIFE           VALUE 'L'.
  5671            88  PD-PROD-PROP           VALUE 'P'.
  5672            88  PD-PROD-AH             VALUE 'A'.
  5673            88  PD-PROD-IU             VALUE 'I'.
  5674            88  PD-PROD-GAP            VALUE 'G'.
  5675        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5676        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5677        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5678        16  PD-MAX-TERM              PIC S999        COMP-3.
  5679        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5680        16  FILLER                   PIC X.
  5681        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5682        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5683        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5684        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5685        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5686        16  PD-REC-CRIT-PERIOD       PIC X.
  5687        16  PD-RTW-MOS               PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 103
* EL1278.cbl
  5688        16  FILLER                   PIC X(5).
  5689    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5690    12  PD-TERM-LIMITS OCCURS 15.
  5691        16  PD-LOW-TERM              PIC S999        COMP-3.
  5692        16  PD-HI-TERM               PIC S999        COMP-3.
  5693*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5694    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5695        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5696        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5697    12  PD-EARN-FACTORS.
  5698        16  FILLER OCCURS 15.
  5699            20  FILLER OCCURS 15.
  5700                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5701    12  PD-PRODUCT-DESC              PIC X(80).
  5702    12  PD-TRUNCATED                 PIC X.
  5703    12  FILLER                       PIC X(59).
  5704    12  PD-MAINT-INFORMATION.
  5705        16  PD-LAST-MAINT-DT         PIC X(02).
  5706        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5707        16  PD-LAST-MAINT-BY         PIC X(04).
  5708*                            COPY ELCCRTT.
  5709******************************************************************
  5710*                                                                *
  5711*                            ELCCRTT.                            *
  5712*                                                                *
  5713*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5714*                                                                *
  5715*   FILE TYPE = VSAM,KSDS                                        *
  5716*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5717*                                                                *
  5718*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5719*                                                                *
  5720*   LOG = YES                                                    *
  5721*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5722******************************************************************
  5723*                   C H A N G E   L O G
  5724*
  5725* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5726*-----------------------------------------------------------------
  5727*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5728* EFFECTIVE    NUMBER
  5729*-----------------------------------------------------------------
  5730* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5731* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5732* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5733* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5734* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5735******************************************************************
  5736
  5737 01  CERTIFICATE-TRAILERS.
  5738     12  CS-RECORD-ID                      PIC XX.
  5739         88  VALID-CS-ID                      VALUE 'CS'.
  5740
  5741     12  CS-CONTROL-PRIMARY.
  5742         16  CS-COMPANY-CD                 PIC X.
  5743         16  CS-CARRIER                    PIC X.
  5744         16  CS-GROUPING                   PIC X(6).
  5745         16  CS-STATE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 104
* EL1278.cbl
  5746         16  CS-ACCOUNT                    PIC X(10).
  5747         16  CS-CERT-EFF-DT                PIC XX.
  5748         16  CS-CERT-NO.
  5749             20  CS-CERT-PRIME             PIC X(10).
  5750             20  CS-CERT-SFX               PIC X.
  5751         16  CS-TRAILER-TYPE               PIC X.
  5752             88  COMM-TRLR           VALUE 'A'.
  5753             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5754             88  CERT-DATA-TRLR      VALUE 'C'.
  5755
  5756     12  CS-DATA-AREA                      PIC X(516).
  5757
  5758     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5759         16  CS-BANK-COMMISSION-AREA.
  5760             20  CS-BANK-COMMS       OCCURS 10.
  5761                 24  CS-AGT                PIC X(10).
  5762                 24  CS-COM-TYP            PIC X.
  5763                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5764                 24  CS-RECALC-LV-INDIC    PIC X.
  5765                 24  FILLER                PIC X(10).
  5766         16  FILLER                        PIC X(256).
  5767
  5768     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5769****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5770****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5771         16  CS-MB-CLAIM-DATA OCCURS 2.
  5772             20  FILLER OCCURS 10.
  5773                 24  CS-CLAIM-TYPE         PIC X.
  5774                     88  CS-AH-CLM           VALUE 'A'.
  5775                     88  CS-IU-CLM           VALUE 'I'.
  5776                     88  CS-GP-CLM           VALUE 'G'.
  5777                     88  CS-LF-CLM           VALUE 'L'.
  5778                     88  CS-PR-CLM           VALUE 'P'.
  5779                 24  CS-BANK               PIC S999 COMP-3.
  5780                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5781                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5782                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5783         16  FILLER                        PIC X(216).
  5784     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5785         16  CS-VIN-NUMBER                 PIC X(17).
  5786         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5787         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5788         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5789         16  FILLER                        PIC X(496).
  5790******************************************************************
  5791 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5792                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5793                          MAILING-DATA ORIGINAL-CERTIFICATE
  5794                          FORM-MASTER CLAIM-MASTER
  5795                          PRODUCT-MASTER CERTIFICATE-TRAILERS.
  5796 0000-DFHEXIT SECTION.
  5797     MOVE '9#                    $   ' TO DFHEIV0.
  5798     MOVE 'EL1278' TO DFHEIV1.
  5799     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5800*    SERVICE RELOAD PARMLIST.
  5801
  5802     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5803     MOVE '5'                    TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 105
* EL1278.cbl
  5804
  5805     PERFORM 9600-DATE-LINK.
  5806
  5807     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5808     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5809     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5810     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5811     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5812     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5813     MOVE EIBTRMID               TO  QID-TERM.
  5814
  5815     IF EIBCALEN  IS EQUAL TO  ZERO
  5816         GO TO 8700-UNAUTHORIZED-ACCESS.
  5817
  5818     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5819         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5820             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5821             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5822             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5823             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5824             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5825             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5826             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5827             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5828         ELSE
  5829             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5830             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5831             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5832             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5833             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5834             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5835             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5836             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5837             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5838
  5839     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5840         GO TO 9300-CLEAR.
  5841
  5842     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5843         NEXT SENTENCE
  5844     ELSE
  5845
  5846* EXEC CICS READQ TS
  5847*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5848*            INTO    (SECURITY-CONTROL)
  5849*            LENGTH  (SC-COMM-LENGTH)
  5850*            ITEM    (SC-ITEM)
  5851*        END-EXEC
  5852*    MOVE '*$II   L              ''   #00005841' TO DFHEIV0
  5853     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5854     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5855     MOVE X'2020233030303035383431' TO DFHEIV0(25:11)
  5856     CALL 'kxdfhei1' USING DFHEIV0,
  5857           PI-SECURITY-TEMP-STORE-ID,
  5858           SECURITY-CONTROL,
  5859           SC-COMM-LENGTH,
  5860           SC-ITEM,
  5861           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 106
* EL1278.cbl
  5862           DFHEIV99
  5863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5864         MOVE SC-CREDIT-DISPLAY (33)
  5865                                 TO  PI-DISPLAY-CAP
  5866         MOVE SC-CREDIT-UPDATE  (33)
  5867                                 TO  PI-MODIFY-CAP
  5868         MOVE SC-CREDIT-UPDATE  (32)
  5869                                 TO  PI-MODIFY-CERT-CAP
  5870         IF NOT  DISPLAY-CAP
  5871             MOVE 'READ'         TO  SM-READ
  5872             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5873             MOVE ER-0070        TO  EMI-ERROR
  5874             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5875             GO TO 8100-SEND-INITIAL-MAP.
  5876
  5877     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  5878         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  5879         MOVE LOW-VALUES         TO  EL127HI
  5880         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  5881                                     PI-LF-CANCEL-DATE
  5882                                     WS-AH-CANCEL-DATE
  5883                                     PI-AH-CANCEL-DATE
  5884         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  5885                                     PI-LF-CANCEL-DATE-ED
  5886                                     WS-AH-CANCEL-DATE-ED
  5887                                     PI-AH-CANCEL-DATE-ED
  5888         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  5889                                     PI-EARNING-METHOD-AH
  5890         PERFORM 0500-FORMAT-SCREEN
  5891         GO TO 8100-SEND-INITIAL-MAP.
  5892
  5893     IF NOT  MODIFY-CAP
  5894         MOVE 'UPDATE'           TO  SM-READ
  5895         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5896         MOVE ER-0070            TO  EMI-ERROR
  5897         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5898         GO TO 8100-SEND-INITIAL-MAP.
  5899
  5900
  5901* EXEC CICS HANDLE CONDITION
  5902*        PGMIDERR  (9500-PGMID-ERROR)
  5903*        ERROR     (9900-ABEND)
  5904*    END-EXEC.
  5905*    MOVE '"$L.                  ! " #00005883' TO DFHEIV0
  5906     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5908     MOVE X'2220233030303035383833' TO DFHEIV0(25:11)
  5909     CALL 'kxdfhei1' USING DFHEIV0
  5910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5911
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 107
* EL1278.cbl
  5913 0200-RECEIVE.
  5914     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5915         MOVE ER-0008            TO  EMI-ERROR
  5916         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5917         MOVE -1                 TO  HLCANCL
  5918         GO TO 8200-SEND-DATAONLY.
  5919
  5920
  5921* EXEC CICS RECEIVE
  5922*        MAP     (MAP-NAME)
  5923*        MAPSET  (MAPSET-NAME)
  5924*        INTO    (EL127HI)
  5925*    END-EXEC.
  5926     MOVE LENGTH OF
  5927      EL127HI
  5928       TO DFHEIV11
  5929*    MOVE '8"T I  L              ''   #00005895' TO DFHEIV0
  5930     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5932     MOVE X'2020233030303035383935' TO DFHEIV0(25:11)
  5933     CALL 'kxdfhei1' USING DFHEIV0,
  5934           MAP-NAME,
  5935           EL127HI,
  5936           DFHEIV11,
  5937           MAPSET-NAME,
  5938           DFHEIV99,
  5939           DFHEIV99
  5940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5941
  5942
  5943     IF HPFKEYL  IS EQUAL TO  ZERO
  5944         GO TO 0300-CHECK-PFKEYS.
  5945
  5946     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  5947         MOVE ER-0004            TO  EMI-ERROR
  5948         GO TO 0320-INPUT-ERROR.
  5949
  5950     IF HPFKEYI NUMERIC
  5951         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  5952             MOVE PF-VALUES (HPFKEYI)
  5953                                 TO  EIBAID
  5954         ELSE
  5955             MOVE ER-0029        TO  EMI-ERROR
  5956             GO TO 0320-INPUT-ERROR.
  5957
  5958 0300-CHECK-PFKEYS.
  5959     IF EIBAID  IS EQUAL TO  DFHPF23
  5960         GO TO 8800-PF23.
  5961
  5962     IF EIBAID  IS EQUAL TO  DFHPF24
  5963         GO TO 9100-RETURN-MAIN-MENU.
  5964
  5965     IF EIBAID = DFHPF11
  5966        GO TO 1700-WRITE-CERT-NOTE
  5967     END-IF
  5968
  5969     IF EIBAID  IS EQUAL TO  DFHPF12
  5970         GO TO 9400-PF12.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 108
* EL1278.cbl
  5971
  5972     IF EIBAID = DFHENTER OR DFHPF10
  5973        GO TO 0400-EDIT-INPUT-DATA
  5974     END-IF
  5975
  5976     MOVE ER-0029                TO  EMI-ERROR.
  5977
  5978 0320-INPUT-ERROR.
  5979     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5980
  5981     MOVE AL-UNBON               TO  HPFKEYA.
  5982
  5983     IF HPFKEYL  IS EQUAL TO  ZERO
  5984         MOVE -1                 TO  HLCANCL
  5985     ELSE
  5986         MOVE -1                 TO  HPFKEYL.
  5987
  5988     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 109
* EL1278.cbl
  5990 0400-EDIT-INPUT-DATA.
  5991     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  5992                                     WS-NEW-LF-CANCEL-SW.
  5993
  5994     IF (HPCYNL > 0)
  5995        AND (HPCYNI = 'Y' OR 'N')
  5996        PERFORM 1800-READ-ELCERT-UPDATE
  5997                                 THRU 1800-EXIT
  5998        IF WS-RESP-NORMAL
  5999           MOVE HPCYNI           TO CM-POST-CARD-IND
  6000           PERFORM 1810-REWRITE-ELCERT
  6001                                 THRU 1810-EXIT
  6002        END-IF
  6003     END-IF
  6004     IF HLCAL1L GREATER ZERO
  6005         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  6006     IF CLPYNI = 'Y'
  6007        MOVE 'Y'                   TO PI-CLP-YN
  6008        MOVE AL-UANON              TO CLPYNA
  6009     ELSE
  6010        MOVE ' '                   TO PI-CLP-YN
  6011        MOVE AL-UANON              TO CLPYNA
  6012     END-IF
  6013     IF CANREAI = 'R'
  6014        MOVE 'R'                 TO PI-CANCEL-REASON
  6015        MOVE AL-UANON            TO CANREAA
  6016     ELSE
  6017        MOVE ' '                 TO PI-CANCEL-REASON
  6018        MOVE AL-UANON            TO CANREAA
  6019     END-IF
  6020
  6021     IF HLCANCL  IS EQUAL TO  ZERO
  6022       AND HACANCL  IS EQUAL TO  ZERO
  6023         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6024         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6025         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6026         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6027         GO TO 0420-CHECK-ERRORS.
  6028
  6029     IF HLCANCL  IS EQUAL TO  ZERO
  6030         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6031         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6032         GO TO 0410-CHECK-AH-DATE.
  6033
  6034     IF HLCANCI = SPACES
  6035        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  6036                                      WS-LF-CANCEL-DATE
  6037        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  6038                                      WS-LF-CANCEL-DATE-ED
  6039                                      PI-LF-REFUND-METH
  6040        MOVE +0                    TO PI-LF-REFUND-AMT
  6041        GO TO 0410-CHECK-AH-DATE
  6042     END-IF
  6043
  6044     MOVE AL-UNNON               TO  HLCANCA.
  6045     MOVE HLCANCI                TO  DEEDIT-FIELD.
  6046     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  6047
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 110
* EL1278.cbl
  6048     PERFORM 8600-DEEDIT.
  6049
  6050     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6051     MOVE '4'                    TO  DC-OPTION-CODE.
  6052
  6053     PERFORM 9600-DATE-LINK.
  6054
  6055     IF DATE-CONVERSION-ERROR
  6056         MOVE -1                 TO  HLCANCL
  6057         MOVE AL-UABON           TO  HLCANCA
  6058         MOVE ER-2227            TO  EMI-ERROR
  6059         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6060     ELSE
  6061        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6062           MOVE -1               TO  HACANCL
  6063           MOVE AL-UABON         TO  HACANCA
  6064           MOVE ER-2774          TO  EMI-ERROR
  6065           PERFORM 9700-ERROR-FORMAT
  6066                                 THRU  9799-EXIT
  6067        ELSE
  6068           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  6069                                    PI-LF-CANCEL-DATE
  6070           MOVE DC-GREG-DATE-1-EDIT
  6071                                 TO HLCANCO
  6072                                    WS-LF-CANCEL-DATE-ED
  6073                                    PI-LF-CANCEL-DATE-ED
  6074        END-IF
  6075     END-IF
  6076     .
  6077 0410-CHECK-AH-DATE.
  6078     IF HACAL1L GREATER ZERO
  6079         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  6080
  6081     IF HACANCL  IS EQUAL TO  ZERO
  6082         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6083         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6084         GO TO 0420-CHECK-ERRORS.
  6085     IF HACANCI = SPACES
  6086        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  6087                                      WS-AH-CANCEL-DATE
  6088        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  6089                                      WS-AH-CANCEL-DATE-ED
  6090                                      PI-AH-REFUND-METH
  6091        MOVE +0                    TO PI-AH-REFUND-AMT
  6092        GO TO 0420-CHECK-ERRORS
  6093     END-IF
  6094
  6095     MOVE AL-UNNON               TO  HACANCA.
  6096     MOVE HACANCI                TO  DEEDIT-FIELD.
  6097     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  6098
  6099     PERFORM 8600-DEEDIT.
  6100
  6101     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6102     MOVE '4'                    TO  DC-OPTION-CODE.
  6103
  6104     PERFORM 9600-DATE-LINK.
  6105
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 111
* EL1278.cbl
  6106     IF DATE-CONVERSION-ERROR
  6107         MOVE -1                 TO  HACANCL
  6108         MOVE AL-UABON           TO  HACANCA
  6109         MOVE ER-2227            TO  EMI-ERROR
  6110         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6111     ELSE
  6112        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6113           MOVE -1               TO  HACANCL
  6114           MOVE AL-UABON         TO  HACANCA
  6115           MOVE ER-2775          TO  EMI-ERROR
  6116           PERFORM 9700-ERROR-FORMAT
  6117                                 THRU  9799-EXIT
  6118        ELSE
  6119           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  6120                                    PI-AH-CANCEL-DATE
  6121           MOVE DC-GREG-DATE-1-EDIT
  6122                                 TO HACANCO
  6123                                    WS-AH-CANCEL-DATE-ED
  6124                                    PI-AH-CANCEL-DATE-ED
  6125        END-IF
  6126     END-IF
  6127     .
  6128 0420-CHECK-ERRORS.
  6129     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6130         NEXT SENTENCE
  6131     ELSE
  6132         GO TO 8200-SEND-DATAONLY.
  6133
  6134     PERFORM 0500-FORMAT-SCREEN.
  6135     IF EIBAID = DFHPF10
  6136        perform 4000-GEN-CANCEL-TRANS
  6137                                 thru 4000-exit
  6138        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6139        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6140        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6141        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6142        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6143        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6144                               PI-ALL-CANCELS-SW
  6145        IF PI-PROCESSOR-IS-CSR
  6146            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6147        ELSE
  6148            MOVE ' '        TO PI-CSR-SESSION-SW
  6149        END-IF
  6150        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6151                               PI-CANCELS-IN-ERROR-SW
  6152                               PI-ONLY-BATCH-HEADERS-SW
  6153                               PI-ALL-OUT-OF-BAL-SW
  6154                               PI-HOLD-REC-SW
  6155                               PI-CHANGE-REC-SW
  6156                               PI-CHK-REQ-REC-SW
  6157                               PI-ISSUE-WARNING-SW
  6158                               PI-CANCEL-WARNING-SW
  6159        MOVE '1'            TO PI-BROWSE-TYPE
  6160        MOVE DFHENTER       TO  EIBAID
  6161
  6162
  6163* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 112
* EL1278.cbl
  6164*           PROGRAM    ('EL6311')
  6165*           COMMAREA   (WS-PASS-631)
  6166*           LENGTH     (1300)
  6167*       END-EXEC
  6168     MOVE 'EL6311' TO DFHEIV1
  6169     MOVE 1300
  6170       TO DFHEIV11
  6171*    MOVE '.$C                   %   #00006120' TO DFHEIV0
  6172     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6173     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6174     MOVE X'2020233030303036313230' TO DFHEIV0(25:11)
  6175     CALL 'kxdfhei1' USING DFHEIV0,
  6176           DFHEIV1,
  6177           WS-PASS-631,
  6178           DFHEIV11,
  6179           DFHEIV99
  6180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6181
  6182*        PERFORM 0500-FORMAT-SCREEN
  6183     END-IF
  6184     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 113
* EL1278.cbl
  6186 0500-FORMAT-SCREEN  SECTION.
  6187     MOVE LOW-VALUES             TO  EL127HO.
  6188     MOVE PI-CARRIER             TO  HCARIERO.
  6189     MOVE PI-GROUPING            TO  HGROUPO.
  6190     MOVE PI-STATE               TO  HSTATEO.
  6191     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6192     MOVE ' '                    TO  DC-OPTION-CODE.
  6193     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6194
  6195     PERFORM 9600-DATE-LINK.
  6196
  6197     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6198     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6199     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6200     MOVE PI-CLP-YN              TO  CLPYNO
  6201     MOVE PI-CANCEL-REASON       TO  CANREAO
  6202     .
  6203 0510-GET-CERT.
  6204     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6205     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6206     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6207     MOVE PI-STATE               TO  WS-CM-STATE.
  6208     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6209     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6210     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6211     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6212
  6213     PERFORM 0900-READ-CERT-FILE.
  6214
  6215     IF CERT-NOT-FOUND
  6216         MOVE -1                 TO  HLCANCL
  6217         MOVE AL-SANON           TO  HLCANCA
  6218         MOVE ER-0214            TO  EMI-ERROR
  6219         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6220         GO TO 8100-SEND-INITIAL-MAP.
  6221
  6222     IF CM-CLAIM-ATTACHED-COUNT = +0
  6223        GO TO 0510-SKIP-CLAIM-CHECK
  6224     END-IF
  6225*    DISPLAY ' STARTING CLAIM TEST '
  6226     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6227     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6228
  6229* EXEC CICS STARTBR
  6230*       DATASET     ('ELMSTR5')
  6231*       RIDFLD      (ELMSTR-KEY)
  6232*       RESP        (WS-RESPONSE)
  6233*    END-EXEC
  6234     MOVE 'ELMSTR5' TO DFHEIV1
  6235     MOVE 0
  6236       TO DFHEIV11
  6237*    MOVE '&,         G          &  N#00006172' TO DFHEIV0
  6238     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6239     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6240     MOVE X'204E233030303036313732' TO DFHEIV0(25:11)
  6241     CALL 'kxdfhei1' USING DFHEIV0,
  6242           DFHEIV1,
  6243           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 114
* EL1278.cbl
  6244           DFHEIV99,
  6245           DFHEIV11,
  6246           DFHEIV99
  6247     MOVE EIBRESP  TO WS-RESPONSE
  6248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6249     IF WS-RESP-NORMAL
  6250     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6251
  6252* EXEC CICS READNEXT
  6253*          DATASET   ('ELMSTR5')
  6254*          RIDFLD    (ELMSTR-KEY)
  6255*          SET       (ADDRESS OF CLAIM-MASTER)
  6256*          RESP      (WS-RESPONSE)
  6257*       END-EXEC
  6258     MOVE 'ELMSTR5' TO DFHEIV1
  6259     MOVE 0
  6260       TO DFHEIV11
  6261*    MOVE '&.S                   )  N#00006179' TO DFHEIV0
  6262     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6263     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6264     MOVE X'204E233030303036313739' TO DFHEIV0(25:11)
  6265     CALL 'kxdfhei1' USING DFHEIV0,
  6266           DFHEIV1,
  6267           DFHEIV20,
  6268           DFHEIV99,
  6269           ELMSTR-KEY,
  6270           DFHEIV99,
  6271           DFHEIV11,
  6272           DFHEIV99,
  6273           DFHEIV99
  6274     SET ADDRESS OF CLAIM-MASTER TO
  6275         DFHEIV20
  6276     MOVE EIBRESP  TO WS-RESPONSE
  6277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6278        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6279           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6280           AND (CM-CERT-NO = CL-CERT-NO)
  6281           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6282              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6283              SET FOUND-A-CLAIM  TO TRUE
  6284              IF CL-CLAIM-TYPE = 'L'
  6285                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6286                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6287                 END-IF
  6288                 IF CLAIM-IS-OPEN
  6289                    SET OPEN-LF-CLAIM TO TRUE
  6290                 ELSE
  6291                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6292                       MOVE CL-LAST-CLOSE-DT
  6293                                 TO WS-LF-LAST-CLOSE-DT
  6294                    END-IF
  6295                    SET CLOSED-LF-CLAIM TO TRUE
  6296                 END-IF
  6297              ELSE
  6298                 IF CLAIM-IS-OPEN
  6299                    MOVE CL-PAID-THRU-DT
  6300                                 TO WS-AH-PAID-THRU-DT
  6301                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 115
* EL1278.cbl
  6302                 ELSE
  6303                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6304                       MOVE CL-PAID-THRU-DT
  6305                                 TO WS-AH-PAID-THRU-DT
  6306                    END-IF
  6307                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6308                       MOVE CL-LAST-CLOSE-DT
  6309                                 TO WS-AH-LAST-CLOSE-DT
  6310                    END-IF
  6311                    SET CLOSED-AH-CLAIM TO TRUE
  6312                 END-IF
  6313              END-IF
  6314           END-IF
  6315        ELSE
  6316           SET I-SAY-TO-STOP TO TRUE
  6317        END-IF
  6318     END-PERFORM
  6319     END-IF
  6320     IF FOUND-A-CLAIM
  6321        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6322           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6323           MOVE ' '              TO DC-OPTION-CODE
  6324           PERFORM 9600-DATE-LINK
  6325           IF NO-CONVERSION-ERROR
  6326              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6327              MOVE AL-SANOF      TO LCLMDTHA
  6328           END-IF
  6329        END-IF
  6330        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6331           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6332           MOVE ' '              TO DC-OPTION-CODE
  6333           PERFORM 9600-DATE-LINK
  6334           IF NO-CONVERSION-ERROR
  6335              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6336              MOVE AL-SANOF      TO ACLMDTHA
  6337           END-IF
  6338        END-IF
  6339        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6340        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6341        MOVE CM-STATE            TO WS-CF-ACCESS
  6342        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6343
  6344* EXEC CICS READ
  6345*          DATASET  (ELCNTL-ID)
  6346*          SET      (ADDRESS OF CONTROL-FILE)
  6347*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6348*          RESP     (WS-RESPONSE)
  6349*       END-EXEC
  6350*    MOVE '&"S        E          (  N#00006250' TO DFHEIV0
  6351     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6352     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6353     MOVE X'204E233030303036323530' TO DFHEIV0(25:11)
  6354     CALL 'kxdfhei1' USING DFHEIV0,
  6355           ELCNTL-ID,
  6356           DFHEIV20,
  6357           DFHEIV99,
  6358           WS-CF-CONTROL-PRIMARY,
  6359           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 116
* EL1278.cbl
  6360           DFHEIV99,
  6361           DFHEIV99
  6362     SET ADDRESS OF CONTROL-FILE TO
  6363         DFHEIV20
  6364     MOVE EIBRESP  TO WS-RESPONSE
  6365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6366        IF WS-RESP-NORMAL
  6367           MOVE CF-ST-REF-AH-DEATH-IND
  6368                                 TO WS-ST-REF-IND
  6369        END-IF
  6370     END-IF
  6371     .
  6372 0510-SKIP-CLAIM-CHECK.
  6373     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6374     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6375     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6376     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6377
  6378* EXEC CICS READ
  6379*        DATASET  (ERMAIL-ID)
  6380*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6381*        SET      (ADDRESS OF MAILING-DATA)
  6382*        RESP     (WS-RESPONSE)
  6383*    END-EXEC.
  6384*    MOVE '&"S        E          (  N#00006267' TO DFHEIV0
  6385     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6386     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6387     MOVE X'204E233030303036323637' TO DFHEIV0(25:11)
  6388     CALL 'kxdfhei1' USING DFHEIV0,
  6389           ERMAIL-ID,
  6390           DFHEIV20,
  6391           DFHEIV99,
  6392           WS-MA-CONTROL-PRIMARY,
  6393           DFHEIV99,
  6394           DFHEIV99,
  6395           DFHEIV99
  6396     SET ADDRESS OF MAILING-DATA TO
  6397         DFHEIV20
  6398     MOVE EIBRESP  TO WS-RESPONSE
  6399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6400
  6401     IF WS-RESP-NORMAL
  6402        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6403           (S1 > +7)
  6404           OR (MA-MAIL-STATUS (S1) = '1')
  6405        END-PERFORM
  6406        IF S1 > +7
  6407           MOVE AL-SANOF         TO HPCYNA
  6408        END-IF
  6409     END-IF
  6410     IF CM-POST-CARD-IND = 'Y'
  6411        MOVE 'Y'                 TO HPCYNO
  6412     ELSE
  6413        MOVE 'N'                 TO HPCYNO
  6414     END-IF
  6415     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6416        OR (NOT CERT-AS-LOADED)
  6417        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 117
* EL1278.cbl
  6418     END-IF
  6419*    IF (CERT-ADDED-BATCH)
  6420*       CONTINUE
  6421*    ELSE
  6422*       MOVE AL-SANOF            TO HPCYNA
  6423*    END-IF
  6424     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6425     MOVE '5'                    TO  DC-OPTION-CODE.
  6426
  6427     PERFORM 9600-DATE-LINK.
  6428
  6429     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6430     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6431     MOVE '1'                    TO  DC-OPTION-CODE.
  6432
  6433     PERFORM 9600-DATE-LINK.
  6434
  6435     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6436
  6437     MOVE ZEROS TO WS-TOT-ITDR.
  6438     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6439
  6440 0510-CHECK-LF-STATUS.
  6441
  6442     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6443         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6444                                    PI-LF-CANCEL-DATE
  6445         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6446                                    PI-LF-CANCEL-DATE-ED
  6447                                    PI-LF-REFUND-METH
  6448         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6449         GO TO 0510-CHECK-AH-STATUS.
  6450
  6451     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6452        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6453          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6454          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6455          IF FIRST-ENTRY
  6456              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6457              MOVE SPACES               TO DC-OPTION-CODE
  6458              PERFORM 9600-DATE-LINK
  6459              IF NOT DATE-CONVERSION-ERROR
  6460                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6461                                            PI-LF-CANCEL-DATE-ED
  6462                                            WS-LF-CANCEL-DATE-ED
  6463                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6464                                            WS-LF-CANCEL-DATE.
  6465
  6466     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6467        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6468          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6469          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  6470          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6471        IF FIRST-ENTRY
  6472            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6473            MOVE SPACES               TO DC-OPTION-CODE
  6474            PERFORM 9600-DATE-LINK
  6475            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 118
* EL1278.cbl
  6476                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6477                                          PI-LF-CANCEL-DATE-ED
  6478                                          WS-LF-CANCEL-DATE-ED
  6479                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6480                                          WS-LF-CANCEL-DATE.
  6481
  6482 0510-CHECK-AH-STATUS.
  6483
  6484     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6485         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6486                                    PI-AH-CANCEL-DATE
  6487         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6488                                    PI-AH-CANCEL-DATE-ED
  6489                                    PI-AH-REFUND-METH
  6490         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6491         GO TO 0510-CONT.
  6492
  6493     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6494        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6495          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6496          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6497        IF FIRST-ENTRY
  6498            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6499            MOVE SPACES               TO DC-OPTION-CODE
  6500            PERFORM 9600-DATE-LINK
  6501            IF NOT DATE-CONVERSION-ERROR
  6502                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6503                                            PI-AH-CANCEL-DATE-ED
  6504                                            WS-AH-CANCEL-DATE-ED
  6505                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6506                                            WS-AH-CANCEL-DATE.
  6507
  6508     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6509        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6510          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6511          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6512          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6513         IF FIRST-ENTRY
  6514             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6515             MOVE SPACES               TO DC-OPTION-CODE
  6516             PERFORM 9600-DATE-LINK
  6517             IF NOT DATE-CONVERSION-ERROR
  6518                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6519                                            PI-AH-CANCEL-DATE-ED
  6520                                            WS-AH-CANCEL-DATE-ED
  6521                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6522                                            WS-AH-CANCEL-DATE.
  6523
  6524     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6525         MOVE 'CANC DT'              TO  CNCDTHDO
  6526         GO TO 0510-CONT.
  6527
  6528     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6529         MOVE 'DTH DT '              TO  CNCDTHDO
  6530         IF FIRST-ENTRY
  6531             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6532             MOVE ' '                TO  DC-OPTION-CODE
  6533             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 119
* EL1278.cbl
  6534             IF NOT DATE-CONVERSION-ERROR
  6535                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6536                                             PI-AH-CANCEL-DATE-ED
  6537                                             WS-AH-CANCEL-DATE-ED
  6538                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6539                                             WS-AH-CANCEL-DATE.
  6540
  6541 0510-CONT.
  6542
  6543     IF WS-TOT-ITDR GREATER THAN ZEROS
  6544         MOVE WS-TOT-ITDR TO TOITDRO.
  6545
  6546 0520-GET-COMPANY-RECORD.
  6547     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6548     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6549     MOVE SPACES                 TO  WS-CF-ACCESS.
  6550     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6551
  6552     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6553
  6554     IF CNTL-NOT-FOUND
  6555         MOVE -1                 TO  HLCANCL
  6556         MOVE AL-SANON           TO  HLCANCA
  6557         MOVE ER-2616            TO  EMI-ERROR
  6558         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6559         GO TO 8100-SEND-INITIAL-MAP.
  6560
  6561     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6562       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6563         MOVE CF-LIFE-OVERRIDE-L1
  6564                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6565         MOVE CF-LIFE-OVERRIDE-L2
  6566                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6567         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6568         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6569         MOVE CF-CR-REM-TERM-CALC
  6570                                 TO  WS-CF-CR-REM-TERM-CALC
  6571         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6572         IF CF-DEFAULT-APR NUMERIC
  6573             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6574             GO TO 0525-GET-LF-BENEFIT
  6575         ELSE
  6576             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6577             GO TO 0525-GET-LF-BENEFIT.
  6578
  6579     MOVE -1                     TO  HLCANCL.
  6580     MOVE AL-SANON               TO  HLCANCA.
  6581     MOVE ER-2616                TO  EMI-ERROR.
  6582
  6583     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6584
  6585     GO TO 8100-SEND-INITIAL-MAP.
  6586
  6587 0525-GET-LF-BENEFIT.
  6588
  6589     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6590        GO TO 0527-GET-AH-BENEFIT
  6591     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 120
* EL1278.cbl
  6592
  6593     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6594     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6595                                     HLCDO.
  6596     MOVE WS-CF-LIFE-OVERRIDE-L2
  6597                                 TO  HLKINDO.
  6598
  6599     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6600
  6601     IF BENEFIT-FOUND
  6602         NEXT SENTENCE
  6603     ELSE
  6604         MOVE -1                 TO  HLCDL
  6605         MOVE AL-SANON           TO  HLCDA
  6606         MOVE ER-0028            TO  EMI-ERROR
  6607         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6608         GO TO 8100-SEND-INITIAL-MAP.
  6609
  6610     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6611         MOVE AL-UNNOF           TO  HLTERMA.
  6612
  6613*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6614     MOVE WS-KIND                TO WS-LF-KIND
  6615     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6616                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6617
  6618     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6619         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6620                                 TO  WS-LF-CO-REM-TERM-CALC.
  6621
  6622     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6623         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6624                                 TO  WS-LF-CO-EARNINGS-CALC
  6625                                     WS-LF-CO-REFUND-CALC.
  6626
  6627     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6628         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6629                                 TO  WS-LF-SPECIAL-CALC-CD.
  6630
  6631     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6632         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6633                                 TO  WS-LF-CO-REFUND-CALC.
  6634
  6635 0527-GET-AH-BENEFIT.
  6636
  6637     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6638        GO TO 0530-GET-STATE-RECORD
  6639     END-IF
  6640
  6641     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6642     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6643                                     HACDO.
  6644     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6645
  6646     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6647
  6648     IF BENEFIT-FOUND
  6649         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 121
* EL1278.cbl
  6650     ELSE
  6651         MOVE -1                 TO  HACDL
  6652         MOVE AL-SANON           TO  HACDA
  6653         MOVE ER-0028            TO  EMI-ERROR
  6654         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6655         GO TO 8100-SEND-INITIAL-MAP.
  6656
  6657     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6658         MOVE AL-UNNOF           TO  HATERMA.
  6659
  6660*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6661     MOVE WS-KIND                TO  WS-AH-KIND
  6662
  6663     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6664         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6665                                 TO  WS-AH-CO-REM-TERM-CALC.
  6666
  6667     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6668         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6669                                 TO  WS-AH-CO-EARNINGS-CALC
  6670                                     WS-AH-CO-REFUND-CALC.
  6671
  6672     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6673         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6674                                 TO  WS-AH-SPECIAL-CALC-CD.
  6675
  6676     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6677         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6678                                 TO  WS-AH-CO-REFUND-CALC.
  6679     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6680        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6681                                 TO WS-AH-BEN-CATEGORY
  6682     END-IF
  6683     .
  6684 0530-GET-STATE-RECORD.
  6685     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6686     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6687     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6688     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6689
  6690     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6691
  6692     IF CNTL-NOT-FOUND
  6693         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6694                                     WS-LF-ST-REM-TERM-CALC
  6695         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6696         GO TO 0560-FIND-ACCOUNT.
  6697
  6698     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6699       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6700       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6701         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6702     ELSE
  6703         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6704                                     WS-LF-ST-REM-TERM-CALC
  6705         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6706         GO TO 0560-FIND-ACCOUNT.
  6707
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 122
* EL1278.cbl
  6708     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6709     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  6710
  6711     IF CM-LF-BENEFIT-CD  = '00'
  6712         GO TO 0550-GET-AH-BEN-IN-STATE.
  6713
  6714 0540-GET-LF-BEN-IN-STATE.
  6715     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6716     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6717
  6718     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6719     IF CF-ST-RT-CALC NOT = SPACES
  6720        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6721     END-IF
  6722
  6723     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6724        IF CF-ST-RF-LR-CALC > '0'
  6725           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6726        END-IF
  6727        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6728           IF CF-ST-RF-LN-CALC > '0'
  6729              MOVE CF-ST-RF-LN-CALC
  6730                                 TO WS-LF-ST-REFUND-CALC
  6731           END-IF
  6732        END-IF
  6733     ELSE
  6734        IF CF-ST-RF-LL-CALC > '0'
  6735           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6736        END-IF
  6737     END-IF
  6738
  6739     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6740
  6741     IF NO-BENEFIT-FOUND
  6742*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6743         GO TO 0550-GET-AH-BEN-IN-STATE.
  6744
  6745     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6746         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6747                                 TO  WS-LF-ST-REM-TERM-CALC.
  6748
  6749     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6750         MOVE CF-ST-REFUND-CALC (SUB3)
  6751                                 TO  WS-LF-ST-REFUND-CALC.
  6752
  6753 0550-GET-AH-BEN-IN-STATE.
  6754     IF CM-AH-BENEFIT-CD  = '00'
  6755         GO TO 0560-FIND-ACCOUNT.
  6756
  6757     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6758     IF CF-ST-RT-CALC NOT = SPACES
  6759        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6760     END-IF
  6761
  6762     IF CF-ST-RF-AH-CALC > '0'
  6763        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6764     END-IF
  6765     IF WS-AH-SPECIAL-CALC-CD = 'C'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 123
* EL1278.cbl
  6766        IF CF-ST-RF-CP-CALC > '0'
  6767           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  6768        END-IF
  6769     END-IF
  6770
  6771     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6772     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6773
  6774     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6775
  6776     IF NO-BENEFIT-FOUND
  6777*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6778         GO TO 0560-FIND-ACCOUNT.
  6779
  6780     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6781         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6782                                 TO  WS-AH-ST-REM-TERM-CALC.
  6783
  6784     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6785         MOVE CF-ST-REFUND-CALC (SUB3)
  6786                                 TO  WS-AH-ST-REFUND-CALC.
  6787
  6788 0560-FIND-ACCOUNT.
  6789     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6790     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6791     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6792     MOVE CM-STATE               TO  WS-AM-STATE.
  6793     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6794     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6795     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6796
  6797     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6798
  6799     IF ACCT-FOUND
  6800         NEXT SENTENCE
  6801     ELSE
  6802         GO TO 0585-NO-ACCT.
  6803
  6804 0570-READ-NEXT-RANGE.
  6805     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6806
  6807     IF ACCT-FOUND
  6808         NEXT SENTENCE
  6809     ELSE
  6810         GO TO 0580-ACCT-NOT-FOUND.
  6811
  6812     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6813       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6814       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6815       AND CM-STATE  IS EQUAL TO  AM-STATE
  6816       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6817         NEXT SENTENCE
  6818     ELSE
  6819         GO TO 0580-ACCT-NOT-FOUND.
  6820
  6821     MOVE 'X'                    TO  DATE-RANGE-SW.
  6822
  6823     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 124
* EL1278.cbl
  6824         MOVE 'X'                TO  DATE-RANGE-SW
  6825         GO TO 0580-ACCT-NOT-FOUND.
  6826
  6827     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  6828         GO TO 0570-READ-NEXT-RANGE.
  6829
  6830     IF WS-BROWSE-STARTED-SW = 'Y'
  6831
  6832* EXEC CICS ENDBR
  6833*          DATASET    ('ERACCT')
  6834*       END-EXEC
  6835     MOVE 'ERACCT' TO DFHEIV1
  6836     MOVE 0
  6837       TO DFHEIV11
  6838*    MOVE '&2                    $   #00006703' TO DFHEIV0
  6839     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6840     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6841     MOVE X'2020233030303036373033' TO DFHEIV0(25:11)
  6842     CALL 'kxdfhei1' USING DFHEIV0,
  6843           DFHEIV1,
  6844           DFHEIV11,
  6845           DFHEIV99
  6846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6847        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  6848     END-IF
  6849     MOVE ' '                    TO  DATE-RANGE-SW.
  6850     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6851
  6852     GO TO 0590-SET-ACCOUNT.
  6853
  6854 0580-ACCT-NOT-FOUND.
  6855     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  6856         MOVE ER-2601            TO  EMI-ERROR
  6857     ELSE
  6858         MOVE ER-2619            TO  EMI-ERROR.
  6859
  6860     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  6861
  6862     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6863
  6864 0585-NO-ACCT.
  6865     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  6866     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6867                                     WS-AM-EARN-METHOD-R
  6868                                     WS-AM-EARN-METHOD-A
  6869                                     WS-LF-AM-REM-TERM-CALC
  6870                                     WS-AH-AM-REM-TERM-CALC.
  6871
  6872     GO TO 0600-CHECK-FOR-LIFE.
  6873
  6874 0590-SET-ACCOUNT.
  6875******************************************************************
  6876******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  6877******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  6878******* METHODS.
  6879******************************************************************
  6880     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  6881     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 125
* EL1278.cbl
  6882     IF PI-COMPANY-ID EQUAL TO 'NCL'
  6883          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  6884                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  6885                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  6886                  IF FORM-FOUND
  6887                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  6888******************************************************************
  6889
  6890     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  6891     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6892                                     WS-AM-EARN-METHOD-R
  6893                                     WS-AM-EARN-METHOD-A.
  6894
  6895*    EVALUATE AM-EARN-METHOD-R
  6896*       WHEN 'R'
  6897*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  6898*       WHEN 'P'
  6899*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  6900*       WHEN 'C'
  6901*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  6902*       WHEN 'A'
  6903*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  6904*       WHEN 'M'
  6905*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  6906*       WHEN 'S'
  6907*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  6908*    END-EVALUATE.
  6909
  6910*    EVALUATE AM-EARN-METHOD-L
  6911*       WHEN 'R'
  6912*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  6913*       WHEN 'P'
  6914*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  6915*       WHEN 'C'
  6916*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  6917*       WHEN 'A'
  6918*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  6919*       WHEN 'M'
  6920*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  6921*       WHEN 'S'
  6922*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  6923*    END-EVALUATE.
  6924
  6925*    EVALUATE AM-EARN-METHOD-A
  6926*       WHEN 'R'
  6927*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  6928*       WHEN 'P'
  6929*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  6930*       WHEN 'C'
  6931*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  6932*       WHEN 'A'
  6933*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  6934*       WHEN 'M'
  6935*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  6936*       WHEN 'N'
  6937*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  6938*       WHEN 'S'
  6939*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 126
* EL1278.cbl
  6940*    END-EVALUATE.
  6941
  6942     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  6943                                     WS-TOT-LF-PREM
  6944                                     WS-TOT-AH-RFND
  6945                                     WS-TOT-LF-RFND.
  6946
  6947 0600-CHECK-FOR-LIFE.
  6948     IF CM-LF-BENEFIT-CD  = '00'
  6949         GO TO 0640-AH-BENEFIT.
  6950
  6951 0610-GET-LIFE-BENEFIT.
  6952
  6953     IF ACCT-FOUND
  6954         MOVE +1                 TO SUB3
  6955         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  6956     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6957     MOVE WS-LF-KIND             TO  HLEDESCO.
  6958     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6959     IF WS-LF-CO-EARNINGS-CALC = 'B'
  6960        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  6961                             + CM-LF-ALT-PREMIUM-AMT
  6962     ELSE
  6963        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  6964     END-IF
  6965
  6966     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  6967     EVALUATE TRUE
  6968        WHEN ((OPEN-LF-CLAIM)
  6969           OR (CLOSED-LF-CLAIM))
  6970           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  6971           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  6972                                    WS-TOT-LF-RFND
  6973                                    PI-LF-REFUND-AMT
  6974           IF CM-AH-BENEFIT-CD NOT = '00'
  6975              MOVE ZEROS         TO HAREFNDO
  6976                                    WS-TOT-AH-RFND
  6977                                    PI-AH-REFUND-AMT
  6978              MOVE SPACES        TO PI-AH-REFUND-METH
  6979           END-IF
  6980           MOVE ER-2965          TO EMI-ERROR
  6981           PERFORM 9700-ERROR-FORMAT
  6982                                 THRU  9799-EXIT
  6983           GO TO 0640-AH-BENEFIT
  6984        WHEN OPEN-LF-CLAIM
  6985           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6986           AND WS-ST-REF-IND = '4'
  6987           MOVE ER-2966          TO EMI-ERROR
  6988           PERFORM 9700-ERROR-FORMAT
  6989                                 THRU  9799-EXIT
  6990        WHEN OPEN-LF-CLAIM
  6991           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6992           AND WS-ST-REF-IND NOT = '4'
  6993           MOVE ER-2967          TO EMI-ERROR
  6994           PERFORM 9700-ERROR-FORMAT
  6995                                 THRU  9799-EXIT
  6996           GO TO 0640-AH-BENEFIT
  6997        WHEN CLOSED-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 127
* EL1278.cbl
  6998           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6999           AND WS-ST-REF-IND = '4'
  7000           MOVE ER-2968          TO EMI-ERROR
  7001           PERFORM 9700-ERROR-FORMAT
  7002                                 THRU  9799-EXIT
  7003        WHEN CLOSED-LF-CLAIM
  7004           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7005           AND WS-ST-REF-IND NOT = '4'
  7006           MOVE ER-2969          TO EMI-ERROR
  7007           PERFORM 9700-ERROR-FORMAT
  7008                                 THRU  9799-EXIT
  7009           GO TO 0640-AH-BENEFIT
  7010        WHEN OTHER
  7011           CONTINUE
  7012     END-EVALUATE
  7013     .
  7014 0620-GET-REM-TERM.
  7015     MOVE WS-CF-LIFE-OVERRIDE-L1
  7016                                 TO  CP-LIFE-OVERRIDE-CODE.
  7017     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7018     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7019     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  7020     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7021     MOVE CM-STATE               TO  CP-STATE.
  7022     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7023     MOVE WS-CF-LF-COVERAGE-TYPE
  7024                                 TO  CP-BENEFIT-TYPE.
  7025     MOVE WS-LF-KIND             TO  HLEDESCO.
  7026     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7027     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7028     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7029     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7030     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7031     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7032     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7033     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7034     MOVE WS-CF-CR-REM-TERM-CALC
  7035                                 TO  CP-REM-TERM-METHOD.
  7036
  7037     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7038         MOVE WS-LF-CO-REM-TERM-CALC
  7039                                 TO  CP-REM-TERM-METHOD.
  7040
  7041     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7042         MOVE WS-LF-ST-REM-TERM-CALC
  7043                                 TO  CP-REM-TERM-METHOD.
  7044
  7045     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7046         MOVE WS-LF-AM-REM-TERM-CALC
  7047                                 TO  CP-REM-TERM-METHOD.
  7048
  7049     IF (PI-COMPANY-ID = 'CID')
  7050        AND (CP-STATE-STD-ABBRV = 'WI')
  7051        MOVE '7'                 TO CP-REM-TERM-METHOD
  7052        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7053     END-IF
  7054     IF (PI-COMPANY-ID = 'CID')
  7055        AND (CP-STATE-STD-ABBRV = 'MO')
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 128
* EL1278.cbl
  7056        AND (CM-CERT-EFF-DT >= X'9B41')
  7057        AND (CM-CERT-EFF-DT <= X'A2FB')
  7058        MOVE '7'                 TO CP-REM-TERM-METHOD
  7059        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7060     END-IF
  7061     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7062                                     CP-ORIGINAL-TERM
  7063                                     CP-LOAN-TERM.
  7064
  7065     IF CP-TRUNCATED-LIFE
  7066         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  7067
  7068     IF CP-TERM-IS-DAYS
  7069         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  7070             MOVE CM-LF-TERM-IN-DAYS
  7071                                 TO  CP-TERM-OR-EXT-DAYS
  7072         ELSE
  7073             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  7074     ELSE
  7075         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7076             MOVE CM-PMT-EXTENSION-DAYS
  7077                                 TO  CP-TERM-OR-EXT-DAYS
  7078         ELSE
  7079             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7080
  7081*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7082     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7083     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7084     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7085     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7086
  7087
  7088* EXEC CICS READ
  7089*        DATASET  (ELCNTL-ID)
  7090*        SET      (ADDRESS OF CONTROL-FILE)
  7091*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7092*        RESP     (WS-RESPONSE)
  7093*    END-EXEC.
  7094*    MOVE '&"S        E          (  N#00006946' TO DFHEIV0
  7095     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7097     MOVE X'204E233030303036393436' TO DFHEIV0(25:11)
  7098     CALL 'kxdfhei1' USING DFHEIV0,
  7099           ELCNTL-ID,
  7100           DFHEIV20,
  7101           DFHEIV99,
  7102           WS-CF-CONTROL-PRIMARY,
  7103           DFHEIV99,
  7104           DFHEIV99,
  7105           DFHEIV99
  7106     SET ADDRESS OF CONTROL-FILE TO
  7107         DFHEIV20
  7108     MOVE EIBRESP  TO WS-RESPONSE
  7109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7110
  7111
  7112     IF WS-RESP-NOTOPEN
  7113         MOVE ER-2617            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 129
* EL1278.cbl
  7114         GO TO 0320-INPUT-ERROR.
  7115
  7116     IF WS-RESP-NOTFND
  7117         MOVE ZERO               TO  CP-FREE-LOOK
  7118     ELSE
  7119         MOVE CF-ST-FREE-LOOK-PERIOD
  7120                                 TO CP-FREE-LOOK.
  7121
  7122     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7123        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7124        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  7125     END-IF
  7126
  7127     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7128
  7129     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7130        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7131        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7132        COMPUTE CP-REMAINING-TERM-1 =
  7133                CP-REMAINING-TERM-1 - +1
  7134        COMPUTE CP-REMAINING-TERM-2 =
  7135                CP-REMAINING-TERM-2 - +1
  7136     END-IF
  7137
  7138     IF CP-REMAINING-TERM-1 NEGATIVE
  7139        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7140     END-IF
  7141     IF CP-REMAINING-TERM-2 NEGATIVE
  7142        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7143     END-IF
  7144     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7145
  7146     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7147         GO TO 0640-AH-BENEFIT.
  7148*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7149*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7150
  7151     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7152         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7153             MOVE ER-0681        TO  EMI-ERROR
  7154             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7155
  7156     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7157         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  7158             MOVE ER-0682        TO  EMI-ERROR
  7159             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7160
  7161 0630-CONTINUE-LIFE.
  7162
  7163     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7164        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7165        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7166                                    FREMTRMO
  7167     ELSE
  7168        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7169                                     FREMTRMO
  7170     END-IF
  7171     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 130
* EL1278.cbl
  7172     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7173     if pi-company-id = 'AHL'
  7174        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7175        if cp-class-code = spaces
  7176           move zeros            to cp-class-code
  7177        end-if
  7178     ELSE
  7179        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7180     END-IF
  7181     IF (PI-COMPANY-ID = 'DCC')
  7182        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7183        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7184        PERFORM 0730-GET-DDF-FACTORS
  7185                                 THRU 0730-EXIT
  7186        IF PDEF-FOUND
  7187           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7188              (P1 > +8)
  7189              OR (PD-PROD-CODE (P1) = 'L')
  7190           END-PERFORM
  7191           IF P1 < +9
  7192              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7193           END-IF
  7194        END-IF
  7195     END-IF
  7196     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7197
  7198     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7199
  7200     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7201        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7202                             + CM-LF-ALT-PREMIUM-AMT
  7203     ELSE
  7204        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7205     END-IF
  7206
  7207     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7208                                     WS-TOT-LF-PREM.
  7209
  7210     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7211        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7212        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7213     ELSE
  7214        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7215     END-IF
  7216
  7217     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7218     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7219
  7220     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7221         MOVE WS-LF-ST-REFUND-CALC
  7222                                 TO  CP-EARNING-METHOD.
  7223
  7224     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7225         MOVE WS-LF-FO-REFUND-CALC
  7226                                 TO  CP-EARNING-METHOD.
  7227
  7228     if (pi-company-id = 'CID')
  7229        and (cp-state-std-abbrv = 'MN' OR 'WA')
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 131
* EL1278.cbl
  7230        continue
  7231     else
  7232        IF CP-RATING-METHOD = '4'
  7233           MOVE '4'              TO CP-EARNING-METHOD
  7234        END-IF
  7235     end-if
  7236*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  7237*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7238*            MOVE WS-AM-EARN-METHOD-R
  7239*                                TO  CP-EARNING-METHOD
  7240*        END-IF
  7241*    ELSE
  7242*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7243*            MOVE WS-AM-EARN-METHOD-L
  7244*                                TO  CP-EARNING-METHOD.
  7245
  7246     if pi-company-id = 'AHL'
  7247        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7248        if cp-class-code = spaces
  7249           move zeros            to cp-class-code
  7250        end-if
  7251     ELSE
  7252        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7253     END-IF
  7254     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7255     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7256                                     CP-RATING-BENEFIT-AMT.
  7257     IF CP-STATE-STD-ABBRV = 'OR'
  7258         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7259                                         CM-LF-ALT-BENEFIT-AMT.
  7260****   N O T E   ****
  7261*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7262*      THE OH HARD CODING IN ELCRFNDP
  7263
  7264     IF PI-COMPANY-ID = 'CID'
  7265        IF CP-STATE-STD-ABBRV = 'OH'
  7266           MOVE WS-LF-CO-EARNINGS-CALC
  7267                                 TO CP-EARNING-METHOD
  7268        END-IF
  7269     END-IF
  7270
  7271****   N O T E   ****
  7272
  7273****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  7274****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7275****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7276****     THE APPROPRIATE OPTIONS HERE
  7277*    IF PI-COMPANY-ID = 'CID'
  7278*       IF (CP-STATE-STD-ABBRV = 'MN')
  7279*          AND (CM-CERT-EFF-DT > X'A4FF')
  7280*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7281*          MOVE '5'              TO CP-EARNING-METHOD
  7282*       END-IF
  7283*    END-IF
  7284     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7285     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7286     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7287     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 132
* EL1278.cbl
  7288     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7289     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7290
  7291*    IF CP-EARN-AS-NET-PAY
  7292*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7293*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7294*               MOVE WS-CF-DEFAULT-APR
  7295*                                TO  CP-LOAN-APR
  7296*               MOVE ER-3780     TO  EMI-ERROR
  7297*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7298*           ELSE
  7299*               MOVE ER-3781     TO  EMI-ERROR
  7300*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7301
  7302*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7303*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7304*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7305*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7306*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7307*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7308*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7309*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7310*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7311*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7312*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7313*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7314*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7315*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7316*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7317*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7318*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7319*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7320     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7321
  7322     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7323
  7324     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7325
  7326     IF CP-ERROR-RATE-IS-ZERO
  7327       OR CP-ERROR-RATE-NOT-FOUND
  7328         MOVE ER-2740            TO  EMI-ERROR
  7329         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7330
  7331     IF CP-ERROR-RATE-FILE-NOTOPEN
  7332         MOVE ER-2617            TO  EMI-ERROR
  7333         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7334
  7335     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7336     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7337                                     WS-TOT-LF-RFND
  7338                                     PI-LF-REFUND-AMT.
  7339     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7340
  7341     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7342
  7343     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  7344         GO TO 0640-AH-BENEFIT.
  7345
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 133
* EL1278.cbl
  7346*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7347*        ADD +1                  TO  CP-REMAINING-TERM
  7348*                                    CP-ORIGINAL-TERM.
  7349
  7350     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7351     MOVE '2'                    TO  CP-EARNING-METHOD
  7352                                     CP-RATING-METHOD.
  7353     IF PI-COMPANY-ID = 'CID'
  7354        IF (CP-STATE-STD-ABBRV = 'MN')
  7355           AND (CM-CERT-EFF-DT > X'A4FF')
  7356           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7357           MOVE '5'              TO CP-EARNING-METHOD
  7358           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7359        END-IF
  7360     END-IF
  7361     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7362                                     CP-REMAINING-BENEFIT
  7363                                     CP-RATING-BENEFIT-AMT.
  7364     IF CP-STATE-STD-ABBRV = 'OR'
  7365         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7366                                         CM-LF-ALT-BENEFIT-AMT.
  7367     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7368     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7369
  7370     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7371
  7372     IF CP-ERROR-RATE-IS-ZERO
  7373       OR CP-ERROR-RATE-NOT-FOUND
  7374         MOVE ER-2740            TO  EMI-ERROR
  7375         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7376
  7377     IF CP-ERROR-RATE-FILE-NOTOPEN
  7378         MOVE ER-2617            TO  EMI-ERROR
  7379         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7380
  7381     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7382
  7383     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7384                                     WS-TOT-LF-RFND
  7385                                     PI-LF-REFUND-AMT.
  7386
  7387     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7388
  7389 0640-AH-BENEFIT.
  7390     IF CM-AH-BENEFIT-CD = '00'
  7391         GO TO 0680-CONTINUE.
  7392
  7393 0650-GET-AH-BENEFIT.
  7394     IF ACCT-FOUND
  7395         MOVE +1                 TO SUB3
  7396         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7397     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7398     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7399     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7400     MOVE WS-AH-KIND             TO  HAEDESCO.
  7401     EVALUATE TRUE
  7402        WHEN ((OPEN-LF-CLAIM)
  7403           OR (CLOSED-LF-CLAIM))
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 134
* EL1278.cbl
  7404           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7405           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7406                                    WS-TOT-AH-RFND
  7407                                    PI-AH-REFUND-AMT
  7408           MOVE SPACES           TO PI-AH-REFUND-METH
  7409           MOVE ER-2965          TO EMI-ERROR
  7410           PERFORM 9700-ERROR-FORMAT
  7411                                 THRU  9799-EXIT
  7412           GO TO 0680-CONTINUE
  7413        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7414           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7415           AND (EMI-ERROR = ER-2965)
  7416           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7417           MOVE ZEROS            TO HAREFNDO
  7418                                    WS-TOT-AH-RFND
  7419                                    PI-AH-REFUND-AMT
  7420           MOVE SPACES           TO PI-AH-REFUND-METH
  7421           GO TO 0680-CONTINUE
  7422        WHEN (OPEN-AH-CLAIM)
  7423           AND (WS-ST-REF-IND = '1')
  7424           MOVE ZEROS            TO HAREFNDO
  7425                                    WS-TOT-AH-RFND
  7426                                    PI-AH-REFUND-AMT
  7427           MOVE ER-3039          TO EMI-ERROR
  7428           PERFORM 9700-ERROR-FORMAT
  7429                                 THRU  9799-EXIT
  7430           GO TO 0680-CONTINUE
  7431        WHEN (OPEN-AH-CLAIM)
  7432           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7433           MOVE ER-3037          TO EMI-ERROR
  7434           PERFORM 9700-ERROR-FORMAT
  7435                                 THRU  9799-EXIT
  7436*          CONTINUE
  7437        WHEN (OPEN-AH-CLAIM)
  7438           AND (WS-ST-REF-IND = '5')
  7439           MOVE ER-3038          TO EMI-ERROR
  7440           PERFORM 9700-ERROR-FORMAT
  7441                                 THRU  9799-EXIT
  7442*          CONTINUE
  7443        WHEN (OPEN-AH-CLAIM)
  7444           AND (WS-ST-REF-IND = ' ')
  7445           MOVE ER-2768          TO EMI-ERROR
  7446           PERFORM 9700-ERROR-FORMAT
  7447                                 THRU  9799-EXIT
  7448        WHEN (CLOSED-AH-CLAIM)
  7449           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7450           MOVE ZEROS            TO HAREFNDO
  7451                                    WS-TOT-AH-RFND
  7452                                    PI-AH-REFUND-AMT
  7453           MOVE ER-2756          TO EMI-ERROR
  7454           PERFORM 9700-ERROR-FORMAT
  7455                                 THRU  9799-EXIT
  7456           IF WS-TOT-LF-RFND > 0
  7457              MOVE ZEROS         TO HLREFNDO
  7458                                    WS-TOT-LF-RFND
  7459                                    PI-LF-REFUND-AMT
  7460              MOVE SPACES        TO PI-LF-REFUND-METH
  7461           END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 135
* EL1278.cbl
  7462           GO TO 0680-CONTINUE
  7463*       WHEN OTHER
  7464*          CONTINUE
  7465     END-EVALUATE
  7466     .
  7467 0660-GET-REM-TERM.
  7468     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  7469     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7470     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7471     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7472     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7473*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7474     MOVE WS-AH-KIND             TO  HAEDESCO.
  7475     MOVE CM-STATE               TO  CP-STATE.
  7476     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7477     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7478     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7479     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7480     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7481     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7482     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7483     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7484     MOVE WS-CF-CR-REM-TERM-CALC
  7485                                 TO  CP-REM-TERM-METHOD.
  7486
  7487     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7488         MOVE WS-AH-CO-REM-TERM-CALC
  7489                                 TO  CP-REM-TERM-METHOD.
  7490
  7491     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7492         MOVE WS-AH-ST-REM-TERM-CALC
  7493                                 TO  CP-REM-TERM-METHOD.
  7494
  7495     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7496         MOVE WS-AH-AM-REM-TERM-CALC
  7497                                 TO  CP-REM-TERM-METHOD.
  7498     IF (PI-COMPANY-ID = 'CID')
  7499        AND (CP-STATE-STD-ABBRV = 'WI')
  7500        MOVE '7'                 TO CP-REM-TERM-METHOD
  7501        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7502     END-IF
  7503     IF (PI-COMPANY-ID = 'CID')
  7504        AND (CP-STATE-STD-ABBRV = 'MO')
  7505        AND (CM-CERT-EFF-DT >= X'9B41')
  7506        AND (CM-CERT-EFF-DT <= X'A2FB')
  7507        MOVE '7'                 TO CP-REM-TERM-METHOD
  7508        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7509     END-IF
  7510
  7511     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7512                                     CP-ORIGINAL-TERM
  7513                                     CP-LOAN-TERM.
  7514
  7515     IF  NOT  CP-TERM-IS-DAYS
  7516         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7517             MOVE CM-PMT-EXTENSION-DAYS
  7518                                 TO  CP-TERM-OR-EXT-DAYS
  7519         ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 136
* EL1278.cbl
  7520             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7521
  7522*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7523     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7524     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7525     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7526     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7527
  7528
  7529* EXEC CICS READ
  7530*        DATASET  (ELCNTL-ID)
  7531*        SET      (ADDRESS OF CONTROL-FILE)
  7532*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7533*        RESP     (WS-RESPONSE)
  7534*    END-EXEC.
  7535*    MOVE '&"S        E          (  N#00007369' TO DFHEIV0
  7536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7538     MOVE X'204E233030303037333639' TO DFHEIV0(25:11)
  7539     CALL 'kxdfhei1' USING DFHEIV0,
  7540           ELCNTL-ID,
  7541           DFHEIV20,
  7542           DFHEIV99,
  7543           WS-CF-CONTROL-PRIMARY,
  7544           DFHEIV99,
  7545           DFHEIV99,
  7546           DFHEIV99
  7547     SET ADDRESS OF CONTROL-FILE TO
  7548         DFHEIV20
  7549     MOVE EIBRESP  TO WS-RESPONSE
  7550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7551
  7552
  7553     IF WS-RESP-NOTOPEN
  7554         MOVE ER-2617            TO  EMI-ERROR
  7555         GO TO 0320-INPUT-ERROR.
  7556
  7557     IF WS-RESP-NOTFND
  7558         MOVE ZERO               TO CP-FREE-LOOK
  7559     ELSE
  7560         MOVE CF-ST-FREE-LOOK-PERIOD
  7561                                 TO CP-FREE-LOOK.
  7562
  7563     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7564
  7565     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7566
  7567     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7568         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7569             MOVE ER-0683        TO  EMI-ERROR
  7570             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7571
  7572     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7573         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7574             MOVE ER-0684        TO  EMI-ERROR
  7575             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7576
  7577 0670-CONTINUE-AH.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 137
* EL1278.cbl
  7578     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7579                                     WS-TOT-AH-PREM.
  7580     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7581
  7582     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7583         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7584
  7585     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7586        GO TO 0680-CONTINUE.
  7587     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7588     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7589     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7590
  7591     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7592         MOVE WS-AH-ST-REFUND-CALC
  7593                                 TO  CP-EARNING-METHOD.
  7594
  7595     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7596         MOVE WS-AH-FO-REFUND-CALC
  7597                                 TO  CP-EARNING-METHOD.
  7598
  7599*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7600*        MOVE WS-AM-EARN-METHOD-A
  7601*                                TO  CP-EARNING-METHOD.
  7602
  7603     if pi-company-id = 'AHL'
  7604        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7605        if cp-class-code = spaces
  7606           move zeros            to cp-class-code
  7607        end-if
  7608     ELSE
  7609        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7610     END-IF
  7611     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7612     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7613                                     CP-RATING-BENEFIT-AMT.
  7614     IF CP-STATE-STD-ABBRV = 'OR'
  7615         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  7616                                         CM-AH-ORIG-TERM.
  7617     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7618     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7619     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7620     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7621     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7622     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7623
  7624     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7625     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7626     MOVE ' '                    TO  DC-OPTION-CODE.
  7627
  7628     PERFORM 9600-DATE-LINK.
  7629
  7630     IF CP-STATE-STD-ABBRV = 'OH'
  7631        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7632         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7633           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  7634           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7635             MOVE '6'            TO  CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 138
* EL1278.cbl
  7636         END-IF
  7637        END-IF
  7638        IF PI-COMPANY-ID = 'CID'
  7639           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7640                           LOW-VALUES)
  7641              IF CP-CRITICAL-PERIOD
  7642                 MOVE '2'       TO CP-EARNING-METHOD
  7643              ELSE
  7644                 MOVE '6'       TO CP-EARNING-METHOD
  7645              END-IF
  7646           ELSE
  7647              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7648                 MOVE '2'       TO CP-EARNING-METHOD
  7649              ELSE
  7650                 IF ((CM-LF-ORIG-TERM > 60) AND
  7651                    (CM-RATE-CLASS NOT = 'L '))
  7652                               OR
  7653                    (WS-LF-CO-EARNINGS-CALC = '5')
  7654                    IF CP-CRITICAL-PERIOD
  7655                       MOVE '2'  TO CP-EARNING-METHOD
  7656                    ELSE
  7657                       MOVE '6'  TO CP-EARNING-METHOD
  7658                    END-IF
  7659                 ELSE
  7660                    MOVE '1'     TO CP-EARNING-METHOD
  7661                 END-IF
  7662              END-IF
  7663           END-IF
  7664        END-IF
  7665     END-IF
  7666
  7667     IF CP-STATE-STD-ABBRV = 'VA'
  7668       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7669         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7670            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7671                MOVE '6'            TO  CP-EARNING-METHOD
  7672            ELSE
  7673                MOVE '1'            TO  CP-EARNING-METHOD.
  7674
  7675     IF CP-EARN-AS-NET-PAY
  7676         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7677            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7678                MOVE WS-CF-DEFAULT-APR
  7679                                 TO  CP-LOAN-APR
  7680                MOVE ER-3780     TO  EMI-ERROR
  7681                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7682            ELSE
  7683                MOVE ER-3781     TO  EMI-ERROR
  7684                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7685     IF PI-COMPANY-ID = 'DCC'
  7686        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7687           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7688           MOVE 'S'              TO CP-EARNING-METHOD
  7689        END-IF
  7690     END-IF
  7691     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7692     IF (PI-COMPANY-ID = 'DCC')
  7693        AND (CP-EARNING-METHOD = 'D')
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 139
* EL1278.cbl
  7694        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7695                                    WS-DDF-CSO-ADMIN-FEE
  7696                                    WS-DDF-1ST-YR-TOT-EXP
  7697                                    WS-DDF-COMM-AND-MFEE
  7698        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7699           S1 > +10
  7700           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7701              IF (AM-A-COM (S1) NUMERIC)
  7702                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7703                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7704              ELSE
  7705                 MOVE +0         TO WS-COMM-PCT C0
  7706                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7707                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7708              END-IF
  7709              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7710                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7711                    + WS-COMM-PCT
  7712              END-IF
  7713              IF AM-COM-TYP (S1) = 'N'
  7714                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7715                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7716              END-IF
  7717              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7718                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7719                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7720              END-IF
  7721              IF AM-COM-TYP (S1) = 'I'
  7722                 COMPUTE WS-DDF-COMM-AND-MFEE
  7723                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7724              END-IF
  7725           END-IF
  7726        END-PERFORM
  7727        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7728        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7729        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7730           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7731     END-IF
  7732     IF (PI-COMPANY-ID = 'DCC')
  7733        AND (CP-EARNING-METHOD = 'D')
  7734        AND (PI-CANCEL-REASON NOT = 'R')
  7735        PERFORM 0730-GET-DDF-FACTORS
  7736                                 THRU 0730-EXIT
  7737        IF NOT PDEF-FOUND
  7738           MOVE ER-9999          TO EMI-ERROR
  7739           PERFORM 9700-ERROR-FORMAT
  7740                                 THRU 9799-EXIT
  7741           GO TO 8200-SEND-DATAONLY
  7742        END-IF
  7743        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7744                                 TO CP-DDF-LO-FACT
  7745        MOVE PD-UEP-FACTOR (P1 P2)
  7746                                 TO CP-DDF-HI-FACT
  7747        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7748        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7749        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  7750        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7751           + PD-1ST-YR-ADMIN-ALLOW
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 140
* EL1278.cbl
  7752        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7753        IF PI-CLP-YN = 'Y'
  7754           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7755           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7756                                    CP-DDF-CLP
  7757           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7758        END-IF
  7759        IF DD-IU-PRESENT
  7760           MOVE 'I'              TO CP-EARNING-METHOD
  7761        END-IF
  7762        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7763                                    CP-CLP-RATE-UP
  7764        IF (CP-CALC-GROSS-FEE)
  7765           AND (CP-IU-RATE-UP NOT = ZEROS)
  7766           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7767              / CP-ORIGINAL-PREMIUM)
  7768           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7769              / (1 - TEX-FACT-8)
  7770        END-IF
  7771     END-IF
  7772     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7773
  7774     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7775
  7776     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7777
  7778     IF CP-ERROR-RATE-IS-ZERO
  7779       OR CP-ERROR-RATE-NOT-FOUND
  7780         MOVE ER-2740            TO  EMI-ERROR
  7781         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7782
  7783     IF CP-ERROR-RATE-FILE-NOTOPEN
  7784         MOVE ER-2617            TO  EMI-ERROR
  7785         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7786
  7787     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7788     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7789                                     WS-TOT-AH-RFND
  7790                                     PI-AH-REFUND-AMT.
  7791
  7792     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7793
  7794     MOVE AL-UANON               TO  HACANCA.
  7795
  7796 0680-CONTINUE.
  7797     IF BROWSE-STARTED
  7798         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7799         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  7800
  7801     IF CM-LF-BENEFIT-CD = '00'
  7802         MOVE -1                 TO  HACANCL
  7803     ELSE
  7804         MOVE -1                 TO  HLCANCL.
  7805
  7806     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  7807                           WS-TOT-PREM.
  7808     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  7809                           WS-TOT-RFND.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 141
* EL1278.cbl
  7810
  7811     MOVE WS-TOT-PREM            TO  TOPREMO.
  7812     MOVE WS-TOT-RFND            TO  TORFNDO.
  7813
  7814 0680-EXIT.
  7815     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 142
* EL1278.cbl
  7817 0700-LINK-REM-TERM SECTION.
  7818
  7819* EXEC CICS LINK
  7820*        PROGRAM   (ELRTRM-ID)
  7821*        COMMAREA  (CALCULATION-PASS-AREA)
  7822*        LENGTH    (CP-COMM-LENGTH)
  7823*    END-EXEC.
  7824*    MOVE '."C                   (   #00007641' TO DFHEIV0
  7825     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7826     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7827     MOVE X'2020233030303037363431' TO DFHEIV0(25:11)
  7828     CALL 'kxdfhei1' USING DFHEIV0,
  7829           ELRTRM-ID,
  7830           CALCULATION-PASS-AREA,
  7831           CP-COMM-LENGTH,
  7832           DFHEIV99,
  7833           DFHEIV99,
  7834           DFHEIV99,
  7835           DFHEIV99
  7836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7837
  7838
  7839 0700-EXIT.
  7840     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 143
* EL1278.cbl
  7842 0710-LINK-REM-AMOUNT SECTION.
  7843
  7844* EXEC CICS LINK
  7845*        PROGRAM   (ELRAMT-ID)
  7846*        COMMAREA  (CALCULATION-PASS-AREA)
  7847*        LENGTH    (CP-COMM-LENGTH)
  7848*    END-EXEC.
  7849*    MOVE '."C                   (   #00007651' TO DFHEIV0
  7850     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7851     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7852     MOVE X'2020233030303037363531' TO DFHEIV0(25:11)
  7853     CALL 'kxdfhei1' USING DFHEIV0,
  7854           ELRAMT-ID,
  7855           CALCULATION-PASS-AREA,
  7856           CP-COMM-LENGTH,
  7857           DFHEIV99,
  7858           DFHEIV99,
  7859           DFHEIV99,
  7860           DFHEIV99
  7861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7862
  7863
  7864 0710-EXIT.
  7865     EXIT.
  7866 0730-GET-DDF-FACTORS.
  7867     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7868     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  7869     MOVE CM-STATE               TO ERPDEF-STATE
  7870     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7871     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7872     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7873     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7874     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7875
  7876* EXEC CICS STARTBR
  7877*        DATASET  ('ERPDEF')
  7878*        RIDFLD   (ERPDEF-KEY)
  7879*        GTEQ
  7880*        RESP     (WS-RESPONSE)
  7881*    END-EXEC
  7882     MOVE 'ERPDEF' TO DFHEIV1
  7883     MOVE 0
  7884       TO DFHEIV11
  7885*    MOVE '&,         G          &  N#00007668' TO DFHEIV0
  7886     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7887     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7888     MOVE X'204E233030303037363638' TO DFHEIV0(25:11)
  7889     CALL 'kxdfhei1' USING DFHEIV0,
  7890           DFHEIV1,
  7891           ERPDEF-KEY,
  7892           DFHEIV99,
  7893           DFHEIV11,
  7894           DFHEIV99
  7895     MOVE EIBRESP  TO WS-RESPONSE
  7896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7897     IF NOT WS-RESP-NORMAL
  7898        GO TO 0730-EXIT
  7899     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 144
* EL1278.cbl
  7900     .
  7901 0730-READNEXT.
  7902
  7903* EXEC CICS READNEXT
  7904*       DATASET  ('ERPDEF')
  7905*       SET      (ADDRESS OF PRODUCT-MASTER)
  7906*       RIDFLD   (ERPDEF-KEY)
  7907*       RESP     (WS-RESPONSE)
  7908*    END-EXEC
  7909     MOVE 'ERPDEF' TO DFHEIV1
  7910     MOVE 0
  7911       TO DFHEIV11
  7912*    MOVE '&.S                   )  N#00007679' TO DFHEIV0
  7913     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7914     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7915     MOVE X'204E233030303037363739' TO DFHEIV0(25:11)
  7916     CALL 'kxdfhei1' USING DFHEIV0,
  7917           DFHEIV1,
  7918           DFHEIV20,
  7919           DFHEIV99,
  7920           ERPDEF-KEY,
  7921           DFHEIV99,
  7922           DFHEIV11,
  7923           DFHEIV99,
  7924           DFHEIV99
  7925     SET ADDRESS OF PRODUCT-MASTER TO
  7926         DFHEIV20
  7927     MOVE EIBRESP  TO WS-RESPONSE
  7928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7929     IF NOT WS-RESP-NORMAL
  7930        GO TO 0730-ENDBR
  7931     END-IF
  7932     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7933        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7934           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7935        ELSE
  7936           GO TO 0730-READNEXT
  7937        END-IF
  7938     ELSE
  7939        GO TO 0730-ENDBR
  7940     END-IF
  7941     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7942        (P1 > +8)
  7943        OR (PD-PROD-CODE (P1) = 'I')
  7944     END-PERFORM
  7945     IF P1 < +9
  7946        SET DD-IU-PRESENT        TO TRUE
  7947     END-IF
  7948     IF CM-LOAN-TERM = ZEROS
  7949        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7950     END-IF
  7951     IF PD-TRUNCATED = 'Y'
  7952        MOVE CM-LOAN-TERM        TO WS-TERM
  7953     ELSE
  7954        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7955     END-IF
  7956     EVALUATE TRUE
  7957        WHEN WS-TERM > +168
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 145
* EL1278.cbl
  7958           MOVE 15               TO P1
  7959        WHEN WS-TERM > +156
  7960           MOVE 14               TO P1
  7961        WHEN WS-TERM > +144
  7962           MOVE 13               TO P1
  7963        WHEN WS-TERM > +132
  7964           MOVE 12               TO P1
  7965        WHEN WS-TERM > +120
  7966           MOVE 11               TO P1
  7967        WHEN WS-TERM > +108
  7968           MOVE 10               TO P1
  7969        WHEN WS-TERM > +96
  7970           MOVE 9                TO P1
  7971        WHEN WS-TERM > +84
  7972           MOVE 8                TO P1
  7973        WHEN WS-TERM > +72
  7974           MOVE 7                TO P1
  7975        WHEN WS-TERM > +60
  7976           MOVE 6                TO P1
  7977        WHEN WS-TERM > +48
  7978           MOVE 5                TO P1
  7979        WHEN WS-TERM > +36
  7980           MOVE 4                TO P1
  7981        WHEN WS-TERM > +24
  7982           MOVE 3                TO P1
  7983        WHEN WS-TERM > +12
  7984           MOVE 2                TO P1
  7985        WHEN OTHER
  7986           MOVE 1                TO P1
  7987     END-EVALUATE
  7988     EVALUATE TRUE
  7989*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7990*          AND (DD-IU-PRESENT)
  7991*          MOVE 2                TO P2
  7992*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7993*          MOVE 1                TO P2
  7994        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7995           MOVE 2                TO P2
  7996        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7997           MOVE 3                TO P2
  7998        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7999           MOVE 4                TO P2
  8000        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  8001           MOVE 5                TO P2
  8002        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  8003           MOVE 6                TO P2
  8004        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  8005           MOVE 7                TO P2
  8006        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  8007           MOVE 8                TO P2
  8008        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  8009           MOVE 9                TO P2
  8010        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  8011           MOVE 10               TO P2
  8012        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  8013           MOVE 11               TO P2
  8014        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  8015           MOVE 12               TO P2
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 146
* EL1278.cbl
  8016        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  8017           MOVE 13               TO P2
  8018        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  8019           MOVE 14               TO P2
  8020        WHEN OTHER
  8021           MOVE 15               TO P2
  8022     END-EVALUATE
  8023     .
  8024 0730-ENDBR.
  8025
  8026* EXEC CICS ENDBR
  8027*       DATASET  ('ERPDEF')
  8028*    END-EXEC
  8029     MOVE 'ERPDEF' TO DFHEIV1
  8030     MOVE 0
  8031       TO DFHEIV11
  8032*    MOVE '&2                    $   #00007781' TO DFHEIV0
  8033     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8034     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8035     MOVE X'2020233030303037373831' TO DFHEIV0(25:11)
  8036     CALL 'kxdfhei1' USING DFHEIV0,
  8037           DFHEIV1,
  8038           DFHEIV11,
  8039           DFHEIV99
  8040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8041     .
  8042 0730-EXIT.
  8043     EXIT.
  8044 0740-GET-ERCTBL.
  8045     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8046     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8047     MOVE 'A'                    TO CTBL-BEN-TYPE
  8048     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  8049     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8050     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8051     IF WS-RESP-NORMAL
  8052        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8053     ELSE
  8054        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8055        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8056        MOVE 'A'                    TO CTBL-BEN-TYPE
  8057        MOVE 'AA'                   TO CTBL-BEN-CODE
  8058        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8059        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8060        IF WS-RESP-NORMAL
  8061           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8062        END-IF
  8063     END-IF
  8064     .
  8065 0740-EXIT.
  8066     EXIT.
  8067 0750-READ-ERCTBL.
  8068
  8069* EXEC CICS READ
  8070*         INTO    (COMM-TABLE-RECORD)
  8071*         DATASET ('ERCTBL')
  8072*         RIDFLD  (CTBL-KEY)
  8073*         RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 147
* EL1278.cbl
  8074*    END-EXEC
  8075     MOVE LENGTH OF
  8076      COMM-TABLE-RECORD
  8077       TO DFHEIV11
  8078     MOVE 'ERCTBL' TO DFHEIV1
  8079*    MOVE '&"IL       E          (  N#00007811' TO DFHEIV0
  8080     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8081     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8082     MOVE X'204E233030303037383131' TO DFHEIV0(25:11)
  8083     CALL 'kxdfhei1' USING DFHEIV0,
  8084           DFHEIV1,
  8085           COMM-TABLE-RECORD,
  8086           DFHEIV11,
  8087           CTBL-KEY,
  8088           DFHEIV99,
  8089           DFHEIV99,
  8090           DFHEIV99
  8091     MOVE EIBRESP  TO WS-RESPONSE
  8092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8093     .
  8094 0750-EXIT.
  8095     EXIT.
  8096 0760-FIND-COMM.
  8097     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  8098        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  8099        OR (C1 > +3)
  8100     END-PERFORM
  8101     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  8102        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  8103        OR (C2 > +3)
  8104     END-PERFORM
  8105     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  8106        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  8107        OR (C3 > +3)
  8108     END-PERFORM
  8109     IF C1 > +3
  8110        MOVE +1                  TO C1
  8111     END-IF
  8112     IF C2 > +3
  8113        MOVE +1                  TO C2
  8114     END-IF
  8115     IF C3 > +3
  8116        MOVE +1                  TO C3
  8117     END-IF
  8118     IF C1 = +3
  8119        MOVE +18                 TO C0
  8120     ELSE
  8121        IF C1 = +2
  8122           MOVE +9               TO C0
  8123        END-IF
  8124     END-IF
  8125     IF C2 = +3
  8126        ADD +6                   TO C0
  8127     ELSE
  8128        IF C2 = +2
  8129           ADD +3                TO C0
  8130        END-IF
  8131     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 148
* EL1278.cbl
  8132     ADD C3                      TO C0
  8133     MOVE CT-RT (C0)             TO WS-COMM-PCT
  8134     .
  8135 0760-EXIT.
  8136     EXIT.
  8137 0800-LINK-REFUND SECTION.
  8138     IF CP-AH
  8139       IF PI-EARNING-METHOD-AH NOT = SPACES
  8140         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8141        ELSE
  8142         NEXT SENTENCE
  8143      ELSE
  8144       IF PI-EARNING-METHOD-LF NOT = SPACES
  8145         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8146
  8147
  8148* EXEC CICS LINK
  8149*        PROGRAM   (ELRFND-ID)
  8150*        COMMAREA  (CALCULATION-PASS-AREA)
  8151*        LENGTH    (CP-COMM-LENGTH)
  8152*    END-EXEC.
  8153*    MOVE '."C                   (   #00007871' TO DFHEIV0
  8154     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8156     MOVE X'2020233030303037383731' TO DFHEIV0(25:11)
  8157     CALL 'kxdfhei1' USING DFHEIV0,
  8158           ELRFND-ID,
  8159           CALCULATION-PASS-AREA,
  8160           CP-COMM-LENGTH,
  8161           DFHEIV99,
  8162           DFHEIV99,
  8163           DFHEIV99,
  8164           DFHEIV99
  8165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8166
  8167
  8168 0899-EXIT.
  8169     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 149
* EL1278.cbl
  8171 0900-READ-CERT-FILE  SECTION.
  8172
  8173* EXEC CICS HANDLE CONDITION
  8174*        NOTFND  (0910-NOT-FOUND)
  8175*    END-EXEC.
  8176*    MOVE '"$I                   ! # #00007881' TO DFHEIV0
  8177     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8178     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8179     MOVE X'2320233030303037383831' TO DFHEIV0(25:11)
  8180     CALL 'kxdfhei1' USING DFHEIV0
  8181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8182
  8183
  8184
  8185* EXEC CICS READ
  8186*        DATASET  (ELCERT-ID)
  8187*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8188*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8189*    END-EXEC.
  8190*    MOVE '&"S        E          (   #00007885' TO DFHEIV0
  8191     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8192     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8193     MOVE X'2020233030303037383835' TO DFHEIV0(25:11)
  8194     CALL 'kxdfhei1' USING DFHEIV0,
  8195           ELCERT-ID,
  8196           DFHEIV20,
  8197           DFHEIV99,
  8198           WS-CM-CONTROL-PRIMARY,
  8199           DFHEIV99,
  8200           DFHEIV99,
  8201           DFHEIV99
  8202     SET ADDRESS OF CERTIFICATE-MASTER TO
  8203         DFHEIV20
  8204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8205
  8206
  8207*    SERVICE RELOAD CERTIFICATE-MASTER.
  8208
  8209     GO TO 0999-EXIT.
  8210
  8211 0910-NOT-FOUND.
  8212     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8213
  8214 0999-EXIT.
  8215     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 150
* EL1278.cbl
  8217 1000-READ-CONTROL  SECTION.
  8218
  8219* EXEC CICS HANDLE CONDITION
  8220*        NOTFND   (1010-NOTFND)
  8221*        NOTOPEN  (1020-NOTOPEN)
  8222*    END-EXEC.
  8223*    MOVE '"$IJ                  ! $ #00007902' TO DFHEIV0
  8224     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8225     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8226     MOVE X'2420233030303037393032' TO DFHEIV0(25:11)
  8227     CALL 'kxdfhei1' USING DFHEIV0
  8228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8229
  8230
  8231
  8232* EXEC CICS READ
  8233*        DATASET  (ELCNTL-ID)
  8234*        SET      (ADDRESS OF CONTROL-FILE)
  8235*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8236*        GTEQ
  8237*    END-EXEC.
  8238*    MOVE '&"S        G          (   #00007907' TO DFHEIV0
  8239     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8240     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8241     MOVE X'2020233030303037393037' TO DFHEIV0(25:11)
  8242     CALL 'kxdfhei1' USING DFHEIV0,
  8243           ELCNTL-ID,
  8244           DFHEIV20,
  8245           DFHEIV99,
  8246           WS-CF-CONTROL-PRIMARY,
  8247           DFHEIV99,
  8248           DFHEIV99,
  8249           DFHEIV99
  8250     SET ADDRESS OF CONTROL-FILE TO
  8251         DFHEIV20
  8252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8253
  8254
  8255*    SERVICE RELOAD CONTROL-FILE.
  8256
  8257     GO TO 1099-EXIT.
  8258
  8259 1010-NOTFND.
  8260     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8261
  8262     GO TO 1099-EXIT.
  8263
  8264 1020-NOTOPEN.
  8265     MOVE ER-2617                TO  EMI-ERROR.
  8266
  8267     GO TO 0320-INPUT-ERROR.
  8268
  8269 1099-EXIT.
  8270     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 151
* EL1278.cbl
  8272 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8273     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8274
  8275     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8276         VARYING  SUB3  FROM  1  BY  1
  8277             UNTIL  ((SUB3  IS GREATER THAN  50)
  8278               OR ((CF-ST-BENEFIT-CD (SUB3)
  8279                      IS EQUAL TO  WS-BEN-CD)
  8280               AND (WS-LOOKUP-TYPE
  8281                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8282
  8283     IF SUB3  IS NOT EQUAL TO  51
  8284         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8285
  8286     GO TO 1199-EXIT.
  8287
  8288 1110-BENEFIT-DUMMY.
  8289
  8290 1119-EXIT.
  8291     EXIT.
  8292
  8293 1199-EXIT.
  8294     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 152
* EL1278.cbl
  8296 1200-START-ACCOUNT-MASTER  SECTION.
  8297
  8298* EXEC CICS HANDLE CONDITION
  8299*        NOTFND   (1290-ACCT-NOT-FOUND)
  8300*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8301*    END-EXEC.
  8302*    MOVE '"$I''                  ! % #00007956' TO DFHEIV0
  8303     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8305     MOVE X'2520233030303037393536' TO DFHEIV0(25:11)
  8306     CALL 'kxdfhei1' USING DFHEIV0
  8307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8308
  8309
  8310     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8311
  8312
  8313* EXEC CICS STARTBR
  8314*        DATASET  (ERACCT-ID)
  8315*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8316*        GTEQ
  8317*    END-EXEC.
  8318     MOVE 0
  8319       TO DFHEIV11
  8320*    MOVE '&,         G          &   #00007963' TO DFHEIV0
  8321     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8322     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8323     MOVE X'2020233030303037393633' TO DFHEIV0(25:11)
  8324     CALL 'kxdfhei1' USING DFHEIV0,
  8325           ERACCT-ID,
  8326           WS-AM-CONTROL-PRIMARY,
  8327           DFHEIV99,
  8328           DFHEIV11,
  8329           DFHEIV99
  8330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8331
  8332
  8333     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8334     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8335
  8336     GO TO 1299-EXIT.
  8337
  8338 1290-ACCT-NOT-FOUND.
  8339     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8340
  8341 1299-EXIT.
  8342     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 153
* EL1278.cbl
  8344 1300-READ-ACCOUNT-MASTER  SECTION.
  8345
  8346* EXEC CICS HANDLE CONDITION
  8347*        NOTFND   (0580-ACCT-NOT-FOUND)
  8348*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8349*    END-EXEC.
  8350*    MOVE '"$I''                  ! & #00007981' TO DFHEIV0
  8351     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8353     MOVE X'2620233030303037393831' TO DFHEIV0(25:11)
  8354     CALL 'kxdfhei1' USING DFHEIV0
  8355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8356
  8357
  8358
  8359* EXEC CICS READNEXT
  8360*        DATASET  (ERACCT-ID)
  8361*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8362*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8363*    END-EXEC.
  8364     MOVE 0
  8365       TO DFHEIV11
  8366*    MOVE '&.S                   )   #00007986' TO DFHEIV0
  8367     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8368     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8369     MOVE X'2020233030303037393836' TO DFHEIV0(25:11)
  8370     CALL 'kxdfhei1' USING DFHEIV0,
  8371           ERACCT-ID,
  8372           DFHEIV20,
  8373           DFHEIV99,
  8374           WS-AM-CONTROL-PRIMARY,
  8375           DFHEIV99,
  8376           DFHEIV11,
  8377           DFHEIV99,
  8378           DFHEIV99
  8379     SET ADDRESS OF ACCOUNT-MASTER TO
  8380         DFHEIV20
  8381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8382
  8383
  8384*    SERVICE RELOAD ACCOUNT-MASTER.
  8385
  8386 1399-EXIT.
  8387     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 154
* EL1278.cbl
  8389 1400-GET-REFUND-TYPE  SECTION.
  8390     IF LIFE-REFUND-SEARCH
  8391         NEXT SENTENCE
  8392     ELSE
  8393         GO TO 1410-AH-REFUND-TYPE.
  8394
  8395     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8396         MOVE SPACES             TO  HLCALCO
  8397                                     HLCAL1O
  8398         GO TO 1499-EXIT.
  8399
  8400     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8401
  8402     EVALUATE TRUE
  8403        WHEN CP-R-AS-REPOSSESSION
  8404           MOVE 'REPOSSESSION'     TO  HLCALCO
  8405        WHEN CP-R-AS-R78
  8406           MOVE 'RULE 78'          TO  HLCALCO
  8407        WHEN  CP-R-AS-PRORATA
  8408           MOVE 'PRO RATA'         TO  HLCALCO
  8409        WHEN CP-R-AS-CALIF
  8410           MOVE 'CALIF'            TO  HLCALCO
  8411        WHEN CP-R-AS-TEXAS
  8412           MOVE 'IRREG'            TO  HLCALCO
  8413        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8414           MOVE 'UTAH'             TO  HLCALCO
  8415        WHEN CP-R-AS-FARM-PLAN
  8416           MOVE 'FARM PLAN'        TO  HLCALCO
  8417        WHEN CP-R-AS-NET-PAY
  8418           MOVE 'NET PAY'          TO  HLCALCO
  8419        WHEN CP-R-AS-ANTICIPATION
  8420           MOVE 'ANTICIPATION'     TO  HLCALCO
  8421        WHEN CP-R-AS-MEAN
  8422           MOVE 'MEAN'             TO  HLCALCO
  8423        WHEN CP-R-AS-SUM-OF-DIGITS
  8424           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8425        WHEN OTHER
  8426           MOVE 'UNDEFINED'        TO  HLCALCO
  8427     END-EVALUATE.
  8428
  8429     GO TO 1499-EXIT.
  8430
  8431 1410-AH-REFUND-TYPE.
  8432     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8433         MOVE SPACES             TO  HACALCO
  8434                                     HACAL1O
  8435         GO TO 1499-EXIT.
  8436
  8437     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8438
  8439     EVALUATE TRUE
  8440        WHEN CP-R-AS-REPOSSESSION
  8441           MOVE 'REPOSSESSION'     TO HACALCO
  8442        WHEN CP-R-AS-R78
  8443           MOVE 'RULE 78'          TO HACALCO
  8444        WHEN CP-R-AS-PRORATA
  8445           MOVE 'PRO RATA'         TO HACALCO
  8446        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 155
* EL1278.cbl
  8447           MOVE 'CALIF'            TO HACALCO
  8448        WHEN CP-R-AS-TEXAS
  8449           MOVE 'IRREG'            TO HACALCO
  8450        WHEN CP-R-AS-FARM-PLAN
  8451           MOVE 'FARM PLAN'        TO HACALCO
  8452        WHEN CP-R-AS-NET-PAY
  8453           MOVE 'NET PAY'          TO HACALCO
  8454        WHEN CP-R-AS-ANTICIPATION
  8455           MOVE 'ANTICIPATION'     TO HACALCO
  8456        WHEN CP-R-AS-MEAN
  8457           MOVE 'MEAN'             TO HACALCO
  8458        WHEN CP-R-AS-SUM-OF-DIGITS
  8459           MOVE 'SUM OF DIGIT'     TO HACALCO
  8460        WHEN CP-GAP-ACTUARIAL
  8461           MOVE 'SP ACTUARIAL'     TO HACALCO
  8462        WHEN CP-R-AS-SPP-DDF
  8463           MOVE 'SPEC DDF'         TO HACALCO
  8464        WHEN CP-R-AS-SPP-DDF-IU
  8465           MOVE 'SPEC DDF IU'      TO HACALCO
  8466        WHEN OTHER
  8467           MOVE 'UNKNOWN'          TO HLCALCO
  8468     END-EVALUATE
  8469     .
  8470 1499-EXIT.
  8471     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 156
* EL1278.cbl
  8473 1500-END-BROWSE  SECTION.
  8474     IF BROWSE-STARTED
  8475
  8476* EXEC CICS ENDBR
  8477*            DATASET  (ERACCT-ID)
  8478*        END-EXEC.
  8479     MOVE 0
  8480       TO DFHEIV11
  8481*    MOVE '&2                    $   #00008083' TO DFHEIV0
  8482     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8483     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8484     MOVE X'2020233030303038303833' TO DFHEIV0(25:11)
  8485     CALL 'kxdfhei1' USING DFHEIV0,
  8486           ERACCT-ID,
  8487           DFHEIV11,
  8488           DFHEIV99
  8489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8490
  8491
  8492 1599-EXIT.
  8493     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 157
* EL1278.cbl
  8495 1600-LOCATE-BENEFIT  SECTION.
  8496
  8497* EXEC CICS HANDLE CONDITION
  8498*        NOTFND  (1699-EXIT)
  8499*    END-EXEC.
  8500*    MOVE '"$I                   ! '' #00008091' TO DFHEIV0
  8501     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8502     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8503     MOVE X'2720233030303038303931' TO DFHEIV0(25:11)
  8504     CALL 'kxdfhei1' USING DFHEIV0
  8505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8506
  8507
  8508     MOVE SPACES                 TO  WS-KIND.
  8509     MOVE ZERO                   TO  WS-NOT-FOUND.
  8510     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8511     MOVE SPACES                 TO  WS-CF-STATE.
  8512     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8513
  8514
  8515* EXEC CICS READ
  8516*        DATASET  (ELCNTL-ID)
  8517*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8518*        SET      (ADDRESS OF CONTROL-FILE)
  8519*        GTEQ
  8520*    END-EXEC.
  8521*    MOVE '&"S        G          (   #00008101' TO DFHEIV0
  8522     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8524     MOVE X'2020233030303038313031' TO DFHEIV0(25:11)
  8525     CALL 'kxdfhei1' USING DFHEIV0,
  8526           ELCNTL-ID,
  8527           DFHEIV20,
  8528           DFHEIV99,
  8529           WS-CF-CONTROL-PRIMARY,
  8530           DFHEIV99,
  8531           DFHEIV99,
  8532           DFHEIV99
  8533     SET ADDRESS OF CONTROL-FILE TO
  8534         DFHEIV20
  8535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8536
  8537
  8538*    SERVICE RELOAD CONTROL-FILE.
  8539
  8540     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8541       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8542         GO TO 1699-EXIT.
  8543
  8544     MOVE +1                     TO  WS-INDEX.
  8545
  8546 1610-LOOKUP-BENEFIT.
  8547     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8548         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8549                                 TO  WS-KIND
  8550         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8551                                 TO  WS-CALC-CD
  8552         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 158
* EL1278.cbl
  8553                                 TO  WS-BENEFIT-DESCRIP
  8554         MOVE +1                 TO  WS-NOT-FOUND
  8555         GO TO 1699-EXIT.
  8556
  8557     IF CF-BENEFIT-CODE (WS-INDEX)
  8558             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8559         GO TO 1699-EXIT.
  8560
  8561     IF WS-INDEX  IS LESS THAN  +8
  8562         ADD +1                  TO  WS-INDEX
  8563         GO TO 1610-LOOKUP-BENEFIT.
  8564
  8565 1699-EXIT.
  8566     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 159
* EL1278.cbl
  8568 1700-WRITE-CERT-NOTE      SECTION.
  8569     IF NOT MODIFY-CERT-CAP
  8570         MOVE 'UPDATE'           TO  SM-READ
  8571         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8572         MOVE ER-0070            TO  EMI-ERROR
  8573         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8574         GO TO 8200-SEND-DATAONLY.
  8575
  8576**MOVE CANCEL QUOTE NOTE INFO
  8577     IF PI-LF-REFUND-AMT NUMERIC
  8578        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8579        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8580     ELSE
  8581        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8582                                    PI-LF-REFUND-AMT
  8583        MOVE SPACE               TO WS-CN-LF-REF-METH
  8584                                    PI-LF-REFUND-METH.
  8585
  8586     IF PI-AH-REFUND-AMT NUMERIC
  8587        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8588        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8589     ELSE
  8590        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8591                                    PI-AH-REFUND-AMT
  8592        MOVE SPACE               TO WS-CN-AH-REF-METH
  8593                                    PI-AH-REFUND-METH.
  8594
  8595     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8596                                   PI-AH-REFUND-AMT.
  8597
  8598     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8599
  8600     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8601     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8602     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8603        MOVE PI-LF-CANCEL-DATE-ED
  8604                                 TO WS-CN-CANCEL-DT
  8605     ELSE
  8606        MOVE PI-AH-CANCEL-DATE-ED
  8607                                 TO WS-CN-CANCEL-DT
  8608     END-IF
  8609     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8610     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8611     MOVE PI-CARRIER             TO CZ-CARRIER
  8612     MOVE PI-GROUPING            TO CZ-GROUPING
  8613     MOVE PI-STATE               TO CZ-STATE
  8614     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8615     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8616     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8617     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8618     MOVE '1'                    TO CZ-RECORD-TYPE
  8619     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8620     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8621     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8622     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8623     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8624     MOVE ' '                    TO WS-STOP-SW
  8625     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 160
* EL1278.cbl
  8626
  8627* EXEC CICS WRITE
  8628*           FROM      (CERT-NOTE-FILE)
  8629*           DATASET   (ERNOTE-ID)
  8630*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8631*           RESP      (WS-RESPONSE)
  8632*       END-EXEC
  8633     MOVE LENGTH OF
  8634      CERT-NOTE-FILE
  8635       TO DFHEIV11
  8636*    MOVE '&$ L                  ''  N#00008196' TO DFHEIV0
  8637     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8638     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8639     MOVE X'204E233030303038313936' TO DFHEIV0(25:11)
  8640     CALL 'kxdfhei1' USING DFHEIV0,
  8641           ERNOTE-ID,
  8642           CERT-NOTE-FILE,
  8643           DFHEIV11,
  8644           CZ-CONTROL-PRIMARY,
  8645           DFHEIV99,
  8646           DFHEIV99
  8647     MOVE EIBRESP  TO WS-RESPONSE
  8648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8649        IF WS-RESP-DUPREC
  8650           ADD +1                TO CZ-NOTE-SEQUENCE
  8651        ELSE
  8652           SET I-SAY-TO-STOP     TO TRUE
  8653        END-IF
  8654     END-PERFORM
  8655     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8656     IF WS-RESP-NORMAL
  8657        EVALUATE CM-NOTE-SW
  8658           WHEN '1'
  8659           WHEN '3'
  8660           WHEN '5'
  8661           WHEN '7'
  8662              SET NO-CERT-RW     TO TRUE
  8663           WHEN ' '
  8664              MOVE '1'           TO CM-NOTE-SW
  8665           WHEN '2'
  8666              MOVE '3'           TO CM-NOTE-SW
  8667           WHEN '4'
  8668              MOVE '5'           TO CM-NOTE-SW
  8669           WHEN '6'
  8670              MOVE '7'           TO CM-NOTE-SW
  8671        END-EVALUATE
  8672     END-IF
  8673     IF NOT NO-CERT-RW
  8674        PERFORM 1810-REWRITE-ELCERT
  8675                                 THRU 1810-EXIT
  8676     ELSE
  8677
  8678* EXEC CICS UNLOCK
  8679*          DATASET    (ELCERT-ID)
  8680*       END-EXEC
  8681*    MOVE '&*                    #   #00008230' TO DFHEIV0
  8682     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8683     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 161
* EL1278.cbl
  8684     MOVE X'2020233030303038323330' TO DFHEIV0(25:11)
  8685     CALL 'kxdfhei1' USING DFHEIV0,
  8686           ELCERT-ID,
  8687           DFHEIV99
  8688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8689     END-IF
  8690     MOVE ER-8160                TO EMI-ERROR.
  8691     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8692     GO TO 8200-SEND-DATAONLY.
  8693
  8694 1799-EXIT.
  8695     EXIT.
  8696 1800-READ-ELCERT-UPDATE.
  8697     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8698     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8699     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8700     MOVE PI-STATE               TO  WS-CM-STATE.
  8701     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8702     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8703     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8704     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8705
  8706* EXEC CICS READ
  8707*        UPDATE
  8708*        DATASET  (ELCERT-ID)
  8709*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8710*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8711*        RESP     (WS-RESPONSE)
  8712*    END-EXEC
  8713*    MOVE '&"S        EU         (  N#00008249' TO DFHEIV0
  8714     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8715     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8716     MOVE X'204E233030303038323439' TO DFHEIV0(25:11)
  8717     CALL 'kxdfhei1' USING DFHEIV0,
  8718           ELCERT-ID,
  8719           DFHEIV20,
  8720           DFHEIV99,
  8721           WS-CM-CONTROL-PRIMARY,
  8722           DFHEIV99,
  8723           DFHEIV99,
  8724           DFHEIV99
  8725     SET ADDRESS OF CERTIFICATE-MASTER TO
  8726         DFHEIV20
  8727     MOVE EIBRESP  TO WS-RESPONSE
  8728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8729     .
  8730 1800-EXIT.
  8731     EXIT.
  8732 1810-REWRITE-ELCERT.
  8733
  8734* EXEC CICS REWRITE
  8735*        FROM      (CERTIFICATE-MASTER)
  8736*        DATASET   (ELCERT-ID)
  8737*        RESP     (WS-RESPONSE)
  8738*    END-EXEC.
  8739     MOVE LENGTH OF
  8740      CERTIFICATE-MASTER
  8741       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 162
* EL1278.cbl
  8742*    MOVE '&& L                  %  N#00008260' TO DFHEIV0
  8743     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8744     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8745     MOVE X'204E233030303038323630' TO DFHEIV0(25:11)
  8746     CALL 'kxdfhei1' USING DFHEIV0,
  8747           ELCERT-ID,
  8748           CERTIFICATE-MASTER,
  8749           DFHEIV11,
  8750           DFHEIV99
  8751     MOVE EIBRESP  TO WS-RESPONSE
  8752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8753
  8754     .
  8755 1810-EXIT.
  8756     EXIT.
  8757 4000-GEN-CANCEL-TRANS.
  8758     IF PI-LF-REFUND-AMT NOT NUMERIC
  8759         MOVE +0 TO PI-LF-REFUND-AMT
  8760     END-IF
  8761     IF PI-AH-REFUND-AMT NOT NUMERIC
  8762         MOVE +0 TO PI-AH-REFUND-AMT
  8763     END-IF
  8764
  8765     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  8766
  8767     MOVE '2'                    TO CG-OPTION-CODE
  8768     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  8769     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  8770     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  8771     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  8772     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  8773     MOVE PI-GROUPING            TO CG-CERT-GROUP
  8774     MOVE PI-STATE               TO CG-CERT-STATE
  8775     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  8776     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  8777     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  8778     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  8779     MOVE ZEROS                  TO CG-LF-BENCD
  8780                                    CG-AH-BENCD
  8781                                    CG-LF-CAN-AMT
  8782                                    CG-AH-CAN-AMT
  8783     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  8784                                    CG-AH-CAN-DT
  8785     MOVE SPACES                 TO CG-BATCH-NO
  8786     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  8787       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  8788        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8789           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  8790           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  8791           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  8792        END-IF
  8793     END-IF
  8794     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8795       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  8796        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8797           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  8798           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  8799           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 163
* EL1278.cbl
  8800        END-IF
  8801     END-IF
  8802
  8803* EXEC CICS LINK
  8804*        PROGRAM  ('ELCANC')
  8805*        COMMAREA (CANCEL-GEN-PASS-AREA)
  8806*    END-EXEC
  8807     MOVE LENGTH OF
  8808      CANCEL-GEN-PASS-AREA
  8809       TO DFHEIV11
  8810     MOVE 'ELCANC' TO DFHEIV1
  8811*    MOVE '."C                   (   #00008313' TO DFHEIV0
  8812     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8813     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8814     MOVE X'2020233030303038333133' TO DFHEIV0(25:11)
  8815     CALL 'kxdfhei1' USING DFHEIV0,
  8816           DFHEIV1,
  8817           CANCEL-GEN-PASS-AREA,
  8818           DFHEIV11,
  8819           DFHEIV99,
  8820           DFHEIV99,
  8821           DFHEIV99,
  8822           DFHEIV99
  8823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8824     IF CG-SUCCESS
  8825        CONTINUE
  8826     ELSE
  8827        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  8828        move '3'                 to emi-switch1
  8829        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  8830        EVALUATE TRUE
  8831           WHEN CG-DATE-ERROR
  8832             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8833           WHEN CG-CERT-NOT-FOUND
  8834             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8835           WHEN CG-AMOUNT-ERROR
  8836             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8837           WHEN CG-OPTION-ERROR
  8838             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8839           WHEN CG-PREV-CAN
  8840             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8841           WHEN CG-INVALID-DATA
  8842             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8843           WHEN CG-NO-ACCT-MSTR
  8844             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8845           WHEN CG-SFX-A-EXIST
  8846             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8847           WHEN CG-MISC-ERROR
  8848             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8849           WHEN OTHER
  8850             move ' error - elcanc - return '
  8851                                 to emi-error-text (1) (12:25)
  8852        END-EVALUATE
  8853        go to 8200-send-dataonly
  8854     end-if
  8855     .
  8856 4000-exit.
  8857     exit.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 164
* EL1278.cbl
  8858
  8859 4400-ADD-ORIG-REC.
  8860
  8861     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8862     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8863     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8864     MOVE PI-STATE               TO  WS-CM-STATE.
  8865     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8866     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8867     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8868     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8869
  8870
  8871* EXEC CICS READ
  8872*        DATASET  (ELCERT-ID)
  8873*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8874*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8875*        RESP     (WS-RESPONSE)
  8876*    END-EXEC
  8877*    MOVE '&"S        E          (  N#00008363' TO DFHEIV0
  8878     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8879     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8880     MOVE X'204E233030303038333633' TO DFHEIV0(25:11)
  8881     CALL 'kxdfhei1' USING DFHEIV0,
  8882           ELCERT-ID,
  8883           DFHEIV20,
  8884           DFHEIV99,
  8885           WS-CM-CONTROL-PRIMARY,
  8886           DFHEIV99,
  8887           DFHEIV99,
  8888           DFHEIV99
  8889     SET ADDRESS OF CERTIFICATE-MASTER TO
  8890         DFHEIV20
  8891     MOVE EIBRESP  TO WS-RESPONSE
  8892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8893     IF WS-RESP-NORMAL
  8894         CONTINUE
  8895     ELSE
  8896        MOVE ER-0142                TO EMI-ERROR
  8897        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  8898        GO TO 8100-SEND-INITIAL-MAP
  8899     END-IF
  8900
  8901******************************************************************
  8902*            A D D   O R I G   C E R T   I N F O                 *
  8903******************************************************************
  8904
  8905     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  8906
  8907     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  8908     MOVE ' '                    TO WS-ERMAIL-SW
  8909
  8910
  8911* EXEC CICS READ
  8912*       DATASET   ('ERMAIL')
  8913*       SET       (ADDRESS OF MAILING-DATA)
  8914*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  8915*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 165
* EL1278.cbl
  8916*    END-EXEC
  8917     MOVE 'ERMAIL' TO DFHEIV1
  8918*    MOVE '&"S        E          (  N#00008386' TO DFHEIV0
  8919     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8920     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8921     MOVE X'204E233030303038333836' TO DFHEIV0(25:11)
  8922     CALL 'kxdfhei1' USING DFHEIV0,
  8923           DFHEIV1,
  8924           DFHEIV20,
  8925           DFHEIV99,
  8926           WS-MA-CONTROL-PRIMARY,
  8927           DFHEIV99,
  8928           DFHEIV99,
  8929           DFHEIV99
  8930     SET ADDRESS OF MAILING-DATA TO
  8931         DFHEIV20
  8932     MOVE EIBRESP  TO WS-RESPONSE
  8933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8934
  8935     IF WS-RESP-NORMAL
  8936        SET ERMAIL-FOUND TO TRUE
  8937     END-IF
  8938
  8939     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTT-PRIMARY
  8940     MOVE 'C'                   TO ELCRTT-REC-TYPE
  8941     MOVE +0                    TO WS-CERT-TRL-REC-NOT-FOUND
  8942
  8943
  8944* EXEC CICS READ
  8945*         DATASET  (ELCRTT-ID)
  8946*         RIDFLD   (ELCRTT-KEY)
  8947*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  8948*         RESP     (WS-RESPONSE)
  8949*    END-EXEC
  8950*    MOVE '&"S        E          (  N#00008401' TO DFHEIV0
  8951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8953     MOVE X'204E233030303038343031' TO DFHEIV0(25:11)
  8954     CALL 'kxdfhei1' USING DFHEIV0,
  8955           ELCRTT-ID,
  8956           DFHEIV20,
  8957           DFHEIV99,
  8958           ELCRTT-KEY,
  8959           DFHEIV99,
  8960           DFHEIV99,
  8961           DFHEIV99
  8962     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8963         DFHEIV20
  8964     MOVE EIBRESP  TO WS-RESPONSE
  8965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8966
  8967     IF NOT WS-RESP-NORMAL
  8968        MOVE +1               TO WS-CERT-TRL-REC-NOT-FOUND
  8969     END-IF
  8970
  8971     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  8972     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  8973     MOVE +0                  TO ELCRTO-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 166
* EL1278.cbl
  8974
  8975
  8976* EXEC CICS READ
  8977*       DATASET   ('ELCRTO')
  8978*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8979*       RIDFLD    (ELCRTO-KEY)
  8980*       GTEQ
  8981*       RESP      (WS-RESPONSE)
  8982*    END-EXEC
  8983     MOVE 'ELCRTO' TO DFHEIV1
  8984*    MOVE '&"S        G          (  N#00008416' TO DFHEIV0
  8985     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8986     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8987     MOVE X'204E233030303038343136' TO DFHEIV0(25:11)
  8988     CALL 'kxdfhei1' USING DFHEIV0,
  8989           DFHEIV1,
  8990           DFHEIV20,
  8991           DFHEIV99,
  8992           ELCRTO-KEY,
  8993           DFHEIV99,
  8994           DFHEIV99,
  8995           DFHEIV99
  8996     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  8997         DFHEIV20
  8998     MOVE EIBRESP  TO WS-RESPONSE
  8999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9000
  9001     IF WS-RESP-NORMAL
  9002        AND (OC-CONTROL-PRIMARY (1:33) =
  9003                 WS-CM-CONTROL-PRIMARY)
  9004        AND (OC-RECORD-TYPE = 'I')
  9005        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  9006
  9007* EXEC CICS READ
  9008*             DATASET   ('ELCRTO')
  9009*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9010*             RIDFLD    (OC-CONTROL-PRIMARY)
  9011*             UPDATE
  9012*             RESP      (WS-RESPONSE)
  9013*          END-EXEC
  9014     MOVE 'ELCRTO' TO DFHEIV1
  9015*    MOVE '&"S        EU         (  N#00008429' TO DFHEIV0
  9016     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9017     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9018     MOVE X'204E233030303038343239' TO DFHEIV0(25:11)
  9019     CALL 'kxdfhei1' USING DFHEIV0,
  9020           DFHEIV1,
  9021           DFHEIV20,
  9022           DFHEIV99,
  9023           OC-CONTROL-PRIMARY,
  9024           DFHEIV99,
  9025           DFHEIV99,
  9026           DFHEIV99
  9027     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9028         DFHEIV20
  9029     MOVE EIBRESP  TO WS-RESPONSE
  9030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9031           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 167
* EL1278.cbl
  9032           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9033           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9034           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9035           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9036           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9037           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9038           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9039           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9040            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9041               MOVE SPACES             TO OC-LF-BENCD
  9042               MOVE ZEROS              TO OC-LF-TERM
  9043                                          OC-LF-BEN-AMT
  9044                                          OC-LF-PRM-AMT
  9045                                          OC-LF-ALT-BEN-AMT
  9046                                          OC-LF-ALT-PRM-AMT
  9047                                          OC-LF-COMM-PCT
  9048                                          OC-LF-CANCEL-AMT
  9049               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9050               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9051           ELSE
  9052               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  9053               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  9054               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  9055               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  9056               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  9057               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  9058               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  9059               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  9060               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
  9061               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  9062           END-IF
  9063           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9064           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9065            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9066               MOVE SPACES             TO OC-AH-BENCD
  9067               MOVE ZEROS              TO OC-AH-TERM
  9068                                          OC-AH-BEN-AMT
  9069                                          OC-AH-PRM-AMT
  9070                                          OC-AH-COMM-PCT
  9071                                          OC-AH-CANCEL-AMT
  9072                                          OC-AH-CP
  9073               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9074               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9075           ELSE
  9076               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9077               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9078               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9079               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9080               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9081               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9082               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9083               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9084               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9085           END-IF
  9086           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9087           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9088           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9089           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 168
* EL1278.cbl
  9090           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9091           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9092           MOVE '5'                    TO DC-OPTION-CODE
  9093           PERFORM 9600-DATE-LINK
  9094           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9095           IF ERMAIL-FOUND
  9096               MOVE MA-CRED-BENE-NAME
  9097                           TO OC-CRED-BENE-NAME
  9098           END-IF
  9099           IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9100               MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9101                                  OC-INS-AGE-DEFAULT-FLAG
  9102               MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9103                                  OC-JNT-AGE-DEFAULT-FLAG
  9104           END-IF
  9105
  9106
  9107* EXEC CICS REWRITE
  9108*             DATASET   ('ELCRTO')
  9109*             FROM      (ORIGINAL-CERTIFICATE)
  9110*             RESP      (WS-RESPONSE)
  9111*          END-EXEC
  9112     MOVE LENGTH OF
  9113      ORIGINAL-CERTIFICATE
  9114       TO DFHEIV11
  9115     MOVE 'ELCRTO' TO DFHEIV1
  9116*    MOVE '&& L                  %  N#00008511' TO DFHEIV0
  9117     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9118     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9119     MOVE X'204E233030303038353131' TO DFHEIV0(25:11)
  9120     CALL 'kxdfhei1' USING DFHEIV0,
  9121           DFHEIV1,
  9122           ORIGINAL-CERTIFICATE,
  9123           DFHEIV11,
  9124           DFHEIV99
  9125     MOVE EIBRESP  TO WS-RESPONSE
  9126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9127           IF NOT WS-RESP-NORMAL
  9128              MOVE ER-3830          TO EMI-ERROR
  9129              PERFORM 9700-ERROR-FORMAT
  9130                                 THRU 9799-EXIT
  9131              GO TO 8200-SEND-DATAONLY
  9132           END-IF
  9133
  9134           GO TO 4400-EXIT
  9135
  9136        ELSE
  9137           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  9138        END-IF
  9139     ELSE
  9140        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  9141        MOVE 'OC'                TO OC-RECORD-ID
  9142        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  9143        MOVE 'I'                 TO OC-RECORD-TYPE
  9144        MOVE +4096               TO OC-KEY-SEQ-NO
  9145     END-IF
  9146
  9147     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 169
* EL1278.cbl
  9148     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9149     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9150     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9151     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9152     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9153     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9154     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9155     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9156      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9157         MOVE SPACES             TO OC-LF-BENCD
  9158         MOVE ZEROS              TO OC-LF-TERM
  9159                                    OC-LF-BEN-AMT
  9160                                    OC-LF-PRM-AMT
  9161                                    OC-LF-ALT-BEN-AMT
  9162                                    OC-LF-ALT-PRM-AMT
  9163                                    OC-LF-COMM-PCT
  9164                                    OC-LF-CANCEL-AMT
  9165         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9166         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9167     ELSE
  9168         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  9169         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  9170         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  9171         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  9172         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  9173         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  9174         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  9175         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  9176         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  9177         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  9178     END-IF
  9179     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9180     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9181      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9182         MOVE SPACES             TO OC-AH-BENCD
  9183         MOVE ZEROS              TO OC-AH-TERM
  9184                                    OC-AH-BEN-AMT
  9185                                    OC-AH-PRM-AMT
  9186                                    OC-AH-COMM-PCT
  9187                                    OC-AH-CANCEL-AMT
  9188                                    OC-AH-CP
  9189         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9190         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9191     ELSE
  9192         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9193         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9194         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9195         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9196         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9197         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9198         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9199         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9200         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9201         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9202     END-IF
  9203     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9204     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9205     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 170
* EL1278.cbl
  9206     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9207     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9208     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9209     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9210     MOVE '5'                    TO DC-OPTION-CODE
  9211     PERFORM 9600-DATE-LINK
  9212     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9213     IF ERMAIL-FOUND
  9214         MOVE MA-CRED-BENE-NAME
  9215                     TO OC-CRED-BENE-NAME
  9216     END-IF
  9217     IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9218         MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9219                            OC-INS-AGE-DEFAULT-FLAG
  9220         MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9221                            OC-JNT-AGE-DEFAULT-FLAG
  9222     END-IF
  9223
  9224     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9225     .
  9226 4400-WRITE-ELCRTO.
  9227
  9228
  9229* EXEC CICS WRITE
  9230*       DATASET   ('ELCRTO')
  9231*       FROM      (ORIGINAL-CERTIFICATE)
  9232*       RIDFLD    (OC-CONTROL-PRIMARY)
  9233*       RESP      (WS-RESPONSE)
  9234*    END-EXEC
  9235     MOVE LENGTH OF
  9236      ORIGINAL-CERTIFICATE
  9237       TO DFHEIV11
  9238     MOVE 'ELCRTO' TO DFHEIV1
  9239*    MOVE '&$ L                  ''  N#00008617' TO DFHEIV0
  9240     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9241     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9242     MOVE X'204E233030303038363137' TO DFHEIV0(25:11)
  9243     CALL 'kxdfhei1' USING DFHEIV0,
  9244           DFHEIV1,
  9245           ORIGINAL-CERTIFICATE,
  9246           DFHEIV11,
  9247           OC-CONTROL-PRIMARY,
  9248           DFHEIV99,
  9249           DFHEIV99
  9250     MOVE EIBRESP  TO WS-RESPONSE
  9251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9252
  9253    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9254        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9255        GO TO 4400-WRITE-ELCRTO
  9256    ELSE
  9257        IF NOT WS-RESP-NORMAL
  9258           MOVE ER-3830          TO EMI-ERROR
  9259           PERFORM 9700-ERROR-FORMAT
  9260                                 THRU 9799-EXIT
  9261           GO TO 8200-SEND-DATAONLY
  9262        END-IF
  9263    END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 171
* EL1278.cbl
  9264
  9265     .
  9266 4400-EXIT.
  9267    EXIT.
  9268
  9269
  9270 5000-GET-LF-AM-REM-TERM.
  9271     MOVE +1                     TO SUB3.
  9272
  9273 5100-GET-LF-AM-REM-TERM.
  9274     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9275        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9276           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9277                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9278           GO TO 5300-MOVE-LF-REM-TERM.
  9279
  9280     IF SUB3 LESS THAN +20
  9281        ADD +1                   TO SUB3
  9282        GO TO 5100-GET-LF-AM-REM-TERM.
  9283
  9284     MOVE +1                     TO SUB3.
  9285
  9286     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9287         GO TO 5200-EDIT-FOR-NINETY-LF.
  9288
  9289 5100-GET-LF-DMD-AM-REM-TERM.
  9290
  9291     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9292        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9293           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9294                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9295           GO TO 5300-MOVE-LF-REM-TERM.
  9296
  9297     IF SUB3 LESS THAN +30
  9298        ADD +1                   TO SUB3
  9299        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9300
  9301     MOVE +1                     TO SUB3.
  9302
  9303 5200-EDIT-FOR-NINETY-LF.
  9304
  9305***************************************************************
  9306*                                                             *
  9307*    NINETY BENEFIT PLAN TYPES:                               *
  9308*                                                             *
  9309*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9310*      92 = ALL GROUP REDUCING BENEFITS                       *
  9311*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9312*      94 = ALL GROUP LEVEL BENEFITS                          *
  9313*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9314*           BENEFIT CONTROLS.                                 *
  9315*      99 = ALL BENEFITS                                      *
  9316*                                                             *
  9317***************************************************************
  9318
  9319     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9320                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9321
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 172
* EL1278.cbl
  9322     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9323       AND
  9324        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9325           GO TO 5300-MOVE-LF-REM-TERM.
  9326
  9327     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9328       AND
  9329        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9330        IF CF-REDUCING (WS-INDEX)
  9331           IF CM-INDIVIDUAL
  9332               GO TO 5300-MOVE-LF-REM-TERM.
  9333
  9334     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9335       AND
  9336        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9337        IF CF-REDUCING (WS-INDEX)
  9338           IF CM-GROUP
  9339               GO TO 5300-MOVE-LF-REM-TERM.
  9340
  9341     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9342       AND
  9343        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9344        IF CF-LEVEL (WS-INDEX)
  9345           IF CM-INDIVIDUAL
  9346               GO TO 5300-MOVE-LF-REM-TERM.
  9347
  9348     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9349       AND
  9350        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9351        IF CF-LEVEL (WS-INDEX)
  9352           IF CM-GROUP
  9353               GO TO 5300-MOVE-LF-REM-TERM.
  9354
  9355     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9356       AND
  9357        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9358            GO TO 5300-MOVE-LF-REM-TERM.
  9359
  9360     IF SUB3 LESS THAN +20
  9361        ADD +1           TO SUB3
  9362          GO TO 5200-EDIT-FOR-NINETY-LF.
  9363
  9364     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9365
  9366     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9367         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9368         GO TO 5900-EXIT.
  9369
  9370     MOVE 1                       TO SUB3.
  9371
  9372 5200-EDIT-FOR-DMD-NINETY-LF.
  9373
  9374     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9375                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9376
  9377     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9378       AND
  9379        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 173
* EL1278.cbl
  9380           GO TO 5300-MOVE-LF-REM-TERM.
  9381
  9382     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  9383       AND
  9384        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9385        IF CF-REDUCING (WS-INDEX)
  9386           IF CM-INDIVIDUAL
  9387               GO TO 5300-MOVE-LF-REM-TERM.
  9388
  9389     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9390       AND
  9391        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9392        IF CF-REDUCING (WS-INDEX)
  9393           IF CM-GROUP
  9394               GO TO 5300-MOVE-LF-REM-TERM.
  9395
  9396     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9397       AND
  9398        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9399        IF CF-LEVEL (WS-INDEX)
  9400           IF CM-INDIVIDUAL
  9401               GO TO 5300-MOVE-LF-REM-TERM.
  9402
  9403     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9404       AND
  9405        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9406        IF CF-LEVEL (WS-INDEX)
  9407           IF CM-GROUP
  9408               GO TO 5300-MOVE-LF-REM-TERM.
  9409
  9410     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9411       AND
  9412        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9413            GO TO 5300-MOVE-LF-REM-TERM.
  9414
  9415     IF SUB3 LESS THAN +30
  9416        ADD +1                   TO SUB3
  9417          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9418
  9419     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9420
  9421     GO TO 5900-EXIT.
  9422
  9423 5300-MOVE-LF-REM-TERM.
  9424     MOVE WS-SAVE-BENEFIT-REM-TERM
  9425                                 TO WS-LF-AM-REM-TERM-CALC.
  9426
  9427 5900-EXIT.
  9428      EXIT.
  9429
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 174
* EL1278.cbl
  9431
  9432 6000-GET-AH-AM-REM-TERM.
  9433     MOVE +1                     TO SUB3.
  9434
  9435 6100-GET-AH-AM-REM-TERM.
  9436
  9437     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9438        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9439           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9440                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9441           GO TO 6300-MOVE-AH-REM-TERM.
  9442
  9443     IF SUB3 LESS THAN +20
  9444        ADD +1                   TO SUB3
  9445        GO TO 6100-GET-AH-AM-REM-TERM.
  9446
  9447     MOVE +1                     TO SUB3.
  9448
  9449     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9450         GO TO 6200-EDIT-FOR-NINETY-AH.
  9451
  9452 6100-GET-AH-AM-DMD-REM-TERM.
  9453     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9454        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9455           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9456                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9457           GO TO 6300-MOVE-AH-REM-TERM.
  9458
  9459     IF SUB3 LESS THAN +30
  9460        ADD +1                   TO SUB3
  9461        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9462
  9463     MOVE +1                     TO SUB3.
  9464
  9465 6200-EDIT-FOR-NINETY-AH.
  9466
  9467***************************************************************
  9468*                                                             *
  9469*    NINETY BENEFIT PLAN TYPES:                               *
  9470*                                                             *
  9471*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9472*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9473*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9474*           BENEFIT CONTROLS.                                 *
  9475*      99 = ALL BENEFITS.                                     *
  9476*                                                             *
  9477***************************************************************
  9478
  9479     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9480                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9481
  9482     IF AM-BENEFIT-CODE (SUB3) = '99'
  9483       AND
  9484        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9485           GO TO 6300-MOVE-AH-REM-TERM.
  9486
  9487     IF AM-BENEFIT-CODE (SUB3) = '91'
  9488       AND
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 175
* EL1278.cbl
  9489        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9490           IF CM-INDIVIDUAL
  9491               GO TO 6300-MOVE-AH-REM-TERM.
  9492
  9493     IF AM-BENEFIT-CODE (SUB3) = '92'
  9494       AND
  9495        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9496           IF CM-GROUP
  9497               GO TO 6300-MOVE-AH-REM-TERM.
  9498
  9499     IF AM-BENEFIT-CODE (SUB3) = '98'
  9500       AND
  9501        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9502           GO TO 6300-MOVE-AH-REM-TERM.
  9503
  9504     IF SUB3 LESS THAN +20
  9505        ADD +1                    TO SUB3
  9506        GO TO 6200-EDIT-FOR-NINETY-AH.
  9507
  9508     MOVE +1                      TO SUB3.
  9509
  9510     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9511         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9512         GO TO 6900-EXIT.
  9513
  9514 6200-EDIT-FOR-DMD-NINETY-AH.
  9515
  9516     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9517                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9518
  9519     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9520       AND
  9521        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9522           GO TO 6300-MOVE-AH-REM-TERM.
  9523
  9524     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9525       AND
  9526        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9527           IF CM-INDIVIDUAL
  9528               GO TO 6300-MOVE-AH-REM-TERM.
  9529
  9530     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9531       AND
  9532        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9533           IF CM-GROUP
  9534               GO TO 6300-MOVE-AH-REM-TERM.
  9535
  9536     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9537       AND
  9538        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9539           GO TO 6300-MOVE-AH-REM-TERM.
  9540
  9541     IF SUB3 LESS THAN +30
  9542        ADD +1                   TO SUB3
  9543        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9544
  9545     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9546
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 176
* EL1278.cbl
  9547     GO TO 6900-EXIT.
  9548
  9549 6300-MOVE-AH-REM-TERM.
  9550
  9551     MOVE WS-SAVE-BENEFIT-REM-TERM
  9552                                 TO WS-AH-AM-REM-TERM-CALC.
  9553
  9554 6900-EXIT.
  9555      EXIT.
  9556
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 177
* EL1278.cbl
  9558 7000-GET-ERFORM     SECTION.
  9559
  9560* EXEC CICS HANDLE CONDITION
  9561*        NOTFND  (7000-EXIT)
  9562*    END-EXEC.
  9563*    MOVE '"$I                   ! ( #00008930' TO DFHEIV0
  9564     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9566     MOVE X'2820233030303038393330' TO DFHEIV0(25:11)
  9567     CALL 'kxdfhei1' USING DFHEIV0
  9568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9569
  9570
  9571     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9572     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9573     MOVE PI-STATE               TO  WS-FO-STATE.
  9574     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9575     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9576
  9577
  9578* EXEC CICS READ
  9579*        DATASET  (ERFORM-ID)
  9580*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9581*        SET      (ADDRESS OF FORM-MASTER)
  9582*        GTEQ
  9583*    END-EXEC.
  9584*    MOVE '&"S        G          (   #00008940' TO DFHEIV0
  9585     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9587     MOVE X'2020233030303038393430' TO DFHEIV0(25:11)
  9588     CALL 'kxdfhei1' USING DFHEIV0,
  9589           ERFORM-ID,
  9590           DFHEIV20,
  9591           DFHEIV99,
  9592           WS-FO-CONTROL-PRIMARY,
  9593           DFHEIV99,
  9594           DFHEIV99,
  9595           DFHEIV99
  9596     SET ADDRESS OF FORM-MASTER TO
  9597         DFHEIV20
  9598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9599
  9600
  9601     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9602        PI-STATE          EQUAL FO-STATE      AND
  9603        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9604         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9605         GO TO 7000-EXIT.
  9606 7000-EXIT.
  9607     EXIT.
  9608 7100-BENEFIT-SEARCH SECTION.
  9609
  9610     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9611        MOVE +1                  TO  SUB4
  9612        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9613
  9614     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9615        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 178
* EL1278.cbl
  9616        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9617 7100-EXIT.
  9618     EXIT.
  9619 7150-BENEFIT-LIFE-SEARCH.
  9620     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9621       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9622         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9623          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9624            IF FO-PLAN-REFUND-METHOD (SUB4)
  9625                    IS GREATER THAN SPACES
  9626               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9627                                    WS-LF-FO-REFUND-CALC
  9628               GO TO 7150-EXIT.
  9629
  9630     IF SUB4 LESS THAN +40
  9631         ADD +1              TO SUB4
  9632         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9633
  9634 7150-EXIT.
  9635     EXIT.
  9636 7250-BENEFIT-AH-SEARCH.
  9637     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9638       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9639         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9640          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9641            IF FO-PLAN-REFUND-METHOD (SUB4)
  9642                    IS GREATER THAN SPACES
  9643               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9644                                    WS-AH-FO-REFUND-CALC
  9645               GO TO 7250-EXIT.
  9646
  9647     IF SUB4 LESS THAN +40
  9648         ADD +1              TO SUB4
  9649         GO TO 7250-BENEFIT-AH-SEARCH.
  9650
  9651 7250-EXIT.
  9652     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 179
* EL1278.cbl
  9654
  9655 8100-SEND-INITIAL-MAP  SECTION.
  9656     MOVE SAVE-DATE              TO  HDATEO.
  9657     MOVE EIBTIME                TO  TIME-IN.
  9658     MOVE TIME-OUT               TO  HTIMEO.
  9659     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9660     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9661     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9662     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9663
  9664     IF CM-LF-BENEFIT-CD = '00'
  9665         MOVE -1                 TO  HACANCL
  9666     ELSE
  9667         MOVE -1                 TO  HLCANCL.
  9668
  9669     IF PI-COMPANY-ID NOT = 'DCC'
  9670        MOVE AL-SADOF            TO CANREAHA
  9671                                    CLPYNHA
  9672                                    CANREAA
  9673                                    CLPYNA
  9674     END-IF
  9675
  9676
  9677* EXEC CICS SEND
  9678*        FROM    (EL127HO)
  9679*        MAPSET  (MAPSET-NAME)
  9680*        MAP     (MAP-NAME)
  9681*        CURSOR
  9682*        ERASE
  9683*    END-EXEC.
  9684     MOVE LENGTH OF
  9685      EL127HO
  9686       TO DFHEIV12
  9687     MOVE -1
  9688       TO DFHEIV11
  9689*    MOVE '8$     CT  E    H L F ,   #00009022' TO DFHEIV0
  9690     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9691     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9692     MOVE X'2020233030303039303232' TO DFHEIV0(25:11)
  9693     CALL 'kxdfhei1' USING DFHEIV0,
  9694           MAP-NAME,
  9695           EL127HO,
  9696           DFHEIV12,
  9697           MAPSET-NAME,
  9698           DFHEIV99,
  9699           DFHEIV99,
  9700           DFHEIV99,
  9701           DFHEIV11,
  9702           DFHEIV99,
  9703           DFHEIV99,
  9704           DFHEIV99
  9705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9706
  9707
  9708     GO TO 9000-RETURN-TRAN.
  9709
  9710 8200-SEND-DATAONLY  SECTION.
  9711     IF FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 180
* EL1278.cbl
  9712         GO TO 8100-SEND-INITIAL-MAP.
  9713
  9714     MOVE SAVE-DATE              TO  HDATEO.
  9715     MOVE EIBTIME                TO  TIME-IN.
  9716     MOVE TIME-OUT               TO  HTIMEO.
  9717     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9718     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9719     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9720     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9721     MOVE -1                     TO  HLCANCL.
  9722
  9723
  9724* EXEC CICS SEND DATAONLY
  9725*        FROM    (EL127HO)
  9726*        MAPSET  (MAPSET-NAME)
  9727*        MAP     (MAP-NAME)
  9728*        CURSOR
  9729*    END-EXEC.
  9730     MOVE LENGTH OF
  9731      EL127HO
  9732       TO DFHEIV12
  9733     MOVE -1
  9734       TO DFHEIV11
  9735*    MOVE '8$D    CT       H L F ,   #00009045' TO DFHEIV0
  9736     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9737     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9738     MOVE X'2020233030303039303435' TO DFHEIV0(25:11)
  9739     CALL 'kxdfhei1' USING DFHEIV0,
  9740           MAP-NAME,
  9741           EL127HO,
  9742           DFHEIV12,
  9743           MAPSET-NAME,
  9744           DFHEIV99,
  9745           DFHEIV99,
  9746           DFHEIV99,
  9747           DFHEIV11,
  9748           DFHEIV99,
  9749           DFHEIV99,
  9750           DFHEIV99
  9751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9752
  9753
  9754     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 181
* EL1278.cbl
  9756 8300-SEND-TEXT  SECTION.
  9757
  9758* EXEC CICS SEND TEXT
  9759*        FROM    (LOGOFF-TEXT)
  9760*        LENGTH  (LOGOFF-LENGTH)
  9761*        ERASE
  9762*        FREEKB
  9763*    END-EXEC.
  9764*    MOVE '8&      T  E F  H   F -   #00009055' TO DFHEIV0
  9765     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9766     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9767     MOVE X'2020233030303039303535' TO DFHEIV0(25:11)
  9768     CALL 'kxdfhei1' USING DFHEIV0,
  9769           LOGOFF-TEXT,
  9770           LOGOFF-LENGTH,
  9771           DFHEIV99,
  9772           DFHEIV99,
  9773           DFHEIV99,
  9774           DFHEIV99,
  9775           DFHEIV99,
  9776           DFHEIV99,
  9777           DFHEIV99,
  9778           DFHEIV99,
  9779           DFHEIV99,
  9780           DFHEIV99
  9781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9782
  9783
  9784
  9785* EXEC CICS RETURN
  9786*    END-EXEC.
  9787*    MOVE '.(                    ''   #00009062' TO DFHEIV0
  9788     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9790     MOVE X'2020233030303039303632' TO DFHEIV0(25:11)
  9791     CALL 'kxdfhei1' USING DFHEIV0,
  9792           DFHEIV99,
  9793           DFHEIV99,
  9794           DFHEIV99,
  9795           DFHEIV99,
  9796           DFHEIV99,
  9797           DFHEIV99
  9798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9799
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 182
* EL1278.cbl
  9801 8600-DEEDIT  SECTION.
  9802
  9803* EXEC CICS BIF DEEDIT
  9804*        FIELD   (DEEDIT-FIELD)
  9805*        LENGTH  (15)
  9806*    END-EXEC.
  9807     MOVE 15
  9808       TO DFHEIV11
  9809*    MOVE '@"L                   #   #00009066' TO DFHEIV0
  9810     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9811     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9812     MOVE X'2020233030303039303636' TO DFHEIV0(25:11)
  9813     CALL 'kxdfhei1' USING DFHEIV0,
  9814           DEEDIT-FIELD,
  9815           DFHEIV11
  9816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9817
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 183
* EL1278.cbl
  9819 8700-UNAUTHORIZED-ACCESS  SECTION.
  9820     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9821
  9822     GO TO 8300-SEND-TEXT.
  9823
  9824 8800-PF23  SECTION.
  9825     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9826     MOVE XCTL-005               TO  PGM-NAME.
  9827
  9828     GO TO 9200-XCTL.
  9829
  9830 8900-RETURN-CICS  SECTION.
  9831
  9832* EXEC CICS RETURN
  9833*    END-EXEC.
  9834*    MOVE '.(                    ''   #00009083' TO DFHEIV0
  9835     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9836     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9837     MOVE X'2020233030303039303833' TO DFHEIV0(25:11)
  9838     CALL 'kxdfhei1' USING DFHEIV0,
  9839           DFHEIV99,
  9840           DFHEIV99,
  9841           DFHEIV99,
  9842           DFHEIV99,
  9843           DFHEIV99,
  9844           DFHEIV99
  9845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9846
  9847
  9848 9000-RETURN-TRAN  SECTION.
  9849     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  9850     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  9851
  9852
  9853* EXEC CICS RETURN
  9854*        TRANSID   (TRANS-ID)
  9855*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9856*        LENGTH    (PI-COMM-LENGTH)
  9857*    END-EXEC.
  9858*    MOVE '.(CT                  ''   #00009090' TO DFHEIV0
  9859     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9860     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9861     MOVE X'2020233030303039303930' TO DFHEIV0(25:11)
  9862     CALL 'kxdfhei1' USING DFHEIV0,
  9863           TRANS-ID,
  9864           PROGRAM-INTERFACE-BLOCK,
  9865           PI-COMM-LENGTH,
  9866           DFHEIV99,
  9867           DFHEIV99,
  9868           DFHEIV99
  9869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9870
  9871
  9872 9100-RETURN-MAIN-MENU  SECTION.
  9873     MOVE XCTL-126               TO  PGM-NAME.
  9874
  9875     GO TO 9200-XCTL.
  9876
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 184
* EL1278.cbl
  9877 9200-XCTL  SECTION.
  9878
  9879* EXEC CICS XCTL
  9880*        PROGRAM   (PGM-NAME)
  9881*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9882*        LENGTH    (PI-COMM-LENGTH)
  9883*    END-EXEC.
  9884*    MOVE '.$C                   %   #00009102' TO DFHEIV0
  9885     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9886     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9887     MOVE X'2020233030303039313032' TO DFHEIV0(25:11)
  9888     CALL 'kxdfhei1' USING DFHEIV0,
  9889           PGM-NAME,
  9890           PROGRAM-INTERFACE-BLOCK,
  9891           PI-COMM-LENGTH,
  9892           DFHEIV99
  9893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9894
  9895
  9896 9300-CLEAR  SECTION.
  9897     MOVE ' '                    TO  PI-PEND-SW.
  9898     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  9899
  9900     GO TO 9200-XCTL.
  9901
  9902 9400-PF12  SECTION.
  9903     MOVE XCTL-010               TO  PGM-NAME.
  9904
  9905     GO TO 9200-XCTL.
  9906
  9907 9500-PGMID-ERROR  SECTION.
  9908
  9909* EXEC CICS HANDLE CONDITION
  9910*        PGMIDERR  (8300-SEND-TEXT)
  9911*    END-EXEC.
  9912*    MOVE '"$L                   ! ) #00009120' TO DFHEIV0
  9913     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9914     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9915     MOVE X'2920233030303039313230' TO DFHEIV0(25:11)
  9916     CALL 'kxdfhei1' USING DFHEIV0
  9917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9918
  9919
  9920     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  9921     MOVE ' '                    TO  PI-ENTRY-CD-1.
  9922     MOVE XCTL-005               TO  PGM-NAME.
  9923     MOVE PGM-NAME               TO  LOGOFF-PGM.
  9924     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  9925
  9926     GO TO 9200-XCTL.
  9927
  9928 9600-DATE-LINK  SECTION.
  9929     MOVE LINK-ELDATCV           TO  PGM-NAME
  9930
  9931
  9932* EXEC CICS LINK
  9933*        PROGRAM   (PGM-NAME)
  9934*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 185
* EL1278.cbl
  9935*        LENGTH    (DC-COMM-LENGTH)
  9936*    END-EXEC.
  9937*    MOVE '."C                   (   #00009135' TO DFHEIV0
  9938     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9940     MOVE X'2020233030303039313335' TO DFHEIV0(25:11)
  9941     CALL 'kxdfhei1' USING DFHEIV0,
  9942           PGM-NAME,
  9943           DATE-CONVERSION-DATA,
  9944           DC-COMM-LENGTH,
  9945           DFHEIV99,
  9946           DFHEIV99,
  9947           DFHEIV99,
  9948           DFHEIV99
  9949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9950
  9951
  9952
  9953 9700-ERROR-FORMAT  SECTION.
  9954     IF NOT EMI-ERRORS-COMPLETE
  9955         MOVE LINK-001               TO  PGM-NAME
  9956
  9957* EXEC CICS LINK
  9958*            PROGRAM   (PGM-NAME)
  9959*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  9960*            LENGTH    (EMI-COMM-LENGTH)
  9961*        END-EXEC.
  9962*    MOVE '."C                   (   #00009145' TO DFHEIV0
  9963     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9964     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9965     MOVE X'2020233030303039313435' TO DFHEIV0(25:11)
  9966     CALL 'kxdfhei1' USING DFHEIV0,
  9967           PGM-NAME,
  9968           ERROR-MESSAGE-INTERFACE-BLOCK,
  9969           EMI-COMM-LENGTH,
  9970           DFHEIV99,
  9971           DFHEIV99,
  9972           DFHEIV99,
  9973           DFHEIV99
  9974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9975
  9976
  9977 9799-EXIT.
  9978     EXIT.
  9979
  9980 9800-SECURITY-VIOLATION  SECTION.
  9981*                            COPY ELCSCTP.
  9982******************************************************************
  9983*                                                                *
  9984*                            ELCSCTP                             *
  9985*                            VMOD=2.001                          *
  9986*                                                                *
  9987*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9988******************************************************************
  9989
  9990
  9991     MOVE EIBDATE          TO SM-JUL-DATE.
  9992     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 186
* EL1278.cbl
  9993     MOVE THIS-PGM         TO SM-PGM.
  9994     MOVE EIBTIME          TO TIME-IN.
  9995     MOVE TIME-OUT         TO SM-TIME.
  9996     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9997
  9998
  9999* EXEC CICS LINK
 10000*         PROGRAM  ('EL003')
 10001*         COMMAREA (SECURITY-MESSAGE)
 10002*         LENGTH   (80)
 10003*    END-EXEC.
 10004     MOVE 'EL003' TO DFHEIV1
 10005     MOVE 80
 10006       TO DFHEIV11
 10007*    MOVE '."C                   (   #00009172' TO DFHEIV0
 10008     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10010     MOVE X'2020233030303039313732' TO DFHEIV0(25:11)
 10011     CALL 'kxdfhei1' USING DFHEIV0,
 10012           DFHEIV1,
 10013           SECURITY-MESSAGE,
 10014           DFHEIV11,
 10015           DFHEIV99,
 10016           DFHEIV99,
 10017           DFHEIV99,
 10018           DFHEIV99
 10019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10020
 10021
 10022******************************************************************
 10023
 10024
 10025 9899-EXIT.
 10026     EXIT.
 10027
 10028 9900-ABEND  SECTION.
 10029     MOVE LINK-004               TO  PGM-NAME.
 10030     MOVE DFHEIBLK               TO  EMI-LINE1.
 10031
 10032
 10033* EXEC CICS LINK
 10034*        PROGRAM   (PGM-NAME)
 10035*        COMMAREA  (EMI-LINE1)
 10036*        LENGTH    (72)
 10037*    END-EXEC.
 10038     MOVE 72
 10039       TO DFHEIV11
 10040*    MOVE '."C                   (   #00009188' TO DFHEIV0
 10041     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10043     MOVE X'2020233030303039313838' TO DFHEIV0(25:11)
 10044     CALL 'kxdfhei1' USING DFHEIV0,
 10045           PGM-NAME,
 10046           EMI-LINE1,
 10047           DFHEIV11,
 10048           DFHEIV99,
 10049           DFHEIV99,
 10050           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 187
* EL1278.cbl
 10051           DFHEIV99
 10052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10053
 10054
 10055     MOVE -1                     TO  HLCANCL.
 10056
 10057     GO TO 8200-SEND-DATAONLY.
 10058
 10059 9999-LAST-PARAGRAPH.
 10060
 10061* GOBACK.
 10062     MOVE '9%                    "   ' TO DFHEIV0
 10063     MOVE 'EL1278' TO DFHEIV1
 10064     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10065     GOBACK.
 10066
 10067 9999-DFHBACK SECTION.
 10068     MOVE '9%                    "   ' TO DFHEIV0
 10069     MOVE 'EL1278' TO DFHEIV1
 10070     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10071     GOBACK.
 10072 9999-DFHEXIT.
 10073     IF DFHEIGDJ EQUAL 0001
 10074         NEXT SENTENCE
 10075     ELSE IF DFHEIGDJ EQUAL 2
 10076         GO TO 9500-PGMID-ERROR,
 10077               9900-ABEND
 10078         DEPENDING ON DFHEIGDI
 10079     ELSE IF DFHEIGDJ EQUAL 3
 10080         GO TO 0910-NOT-FOUND
 10081         DEPENDING ON DFHEIGDI
 10082     ELSE IF DFHEIGDJ EQUAL 4
 10083         GO TO 1010-NOTFND,
 10084               1020-NOTOPEN
 10085         DEPENDING ON DFHEIGDI
 10086     ELSE IF DFHEIGDJ EQUAL 5
 10087         GO TO 1290-ACCT-NOT-FOUND,
 10088               1290-ACCT-NOT-FOUND
 10089         DEPENDING ON DFHEIGDI
 10090     ELSE IF DFHEIGDJ EQUAL 6
 10091         GO TO 0580-ACCT-NOT-FOUND,
 10092               0580-ACCT-NOT-FOUND
 10093         DEPENDING ON DFHEIGDI
 10094     ELSE IF DFHEIGDJ EQUAL 7
 10095         GO TO 1699-EXIT
 10096         DEPENDING ON DFHEIGDI
 10097     ELSE IF DFHEIGDJ EQUAL 8
 10098         GO TO 7000-EXIT
 10099         DEPENDING ON DFHEIGDI
 10100     ELSE IF DFHEIGDJ EQUAL 9
 10101         GO TO 8300-SEND-TEXT
 10102         DEPENDING ON DFHEIGDI.
 10103     MOVE '9%                    "   ' TO DFHEIV0
 10104     MOVE 'EL1278' TO DFHEIV1
 10105     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10106     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:14 Page 188
* EL1278.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8608     Code:       26299
