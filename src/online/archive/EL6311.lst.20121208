* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62******************************************************************
    63
    64 ENVIRONMENT DIVISION.
    65
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6311.cbl
    67 DATA DIVISION.
    68 WORKING-STORAGE SECTION.
    69 01  DFH-START PIC X(04).
    70 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    71 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    72 77  FILLER  PIC X(32)  VALUE '********************************'.
    73 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    74 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    75 77  A1                          PIC S999 COMP-3 VALUE +0.
    76 77  N1                          PIC S999 COMP-3 VALUE +0.
    77 77  N2                          PIC S999 COMP-3 VALUE +0.
    78 77  N3                          PIC S999 COMP-3 VALUE +0.
    79 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    80 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    81 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    82     88  REVERSAL                    VALUE 'Y'.
    83 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    84 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    85 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    86 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    87 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    88     88  ERMAIL-FOUND                 VALUE 'Y'.
    89 77  A2                          PIC S9(5) COMP-3 VALUE +0.
    90 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    91 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    92
    93*    COPY ELCSCTM.
    94******************************************************************
    95*                                                                *
    96*                                                                *
    97*                            ELCSCTM                             *
    98*                            VMOD=2.001                          *
    99*                                                                *
   100*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   101*                                                                *
   102******************************************************************
   103 01  SECURITY-MESSAGE.
   104     12  FILLER                          PIC X(30)
   105            VALUE '** LOGIC SECURITY VIOLATION -'.
   106     12  SM-READ                         PIC X(6).
   107     12  FILLER                          PIC X(5)
   108            VALUE ' PGM='.
   109     12  SM-PGM                          PIC X(6).
   110     12  FILLER                          PIC X(5)
   111            VALUE ' OPR='.
   112     12  SM-PROCESSOR-ID                 PIC X(4).
   113     12  FILLER                          PIC X(6)
   114            VALUE ' TERM='.
   115     12  SM-TERMID                       PIC X(4).
   116     12  FILLER                          PIC XX   VALUE SPACE.
   117     12  SM-JUL-DATE                     PIC 9(5).
   118     12  FILLER                          PIC X    VALUE SPACE.
   119     12  SM-TIME                         PIC 99.99.
   120
   121
   122*    COPY ELCSCRTY.
   123******************************************************************
   124*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6311.cbl
   125*                                                                *
   126*                            ELCSCRTY                            *
   127*                            VMOD=2.001                          *
   128*                                                                *
   129*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   130*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   131*        SAVED IN PI-SECURITY-ADDRESS.                           *
   132*                                                                *
   133******************************************************************
   134 01  SECURITY-CONTROL.
   135     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   136     12  FILLER                       PIC XX    VALUE 'SC'.
   137     12  SC-CREDIT-CODES.
   138         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   139             20  SC-CREDIT-DISPLAY    PIC X.
   140             20  SC-CREDIT-UPDATE     PIC X.
   141     12  SC-CLAIMS-CODES.
   142         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   143             20  SC-CLAIMS-DISPLAY    PIC X.
   144             20  SC-CLAIMS-UPDATE     PIC X.
   145
   146 01  WS-VA-NO-COMM-MESS.
   147     12  FILLER                  PIC X(41) VALUE
   148        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   149 01  WS-OC-MESSAGE.
   150     12  FILLER                  PIC X(43) VALUE
   151        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   152     12  WS-OC-DIS-AMT           PIC -----9.99.
   153     12  FILLER                  PIC X(4) VALUE ' ON '.
   154     12  WS-OC-DATE              PIC X(10).
   155 01  WS-DATE-AREA.
   156     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   157     12  WS-CURRENT-DT.
   158         16  FILLER              PIC X(6)    VALUE SPACES.
   159         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   160     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   161     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   162     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   163
   164 01  STANDARD-AREAS.
   165     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   166     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   167     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   168     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   169     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   170     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   171     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   172     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   173     12  PGM-NAME                PIC X(8).
   174     12  TIME-IN                 PIC S9(7).
   175     12  TIME-OUT-R  REDEFINES TIME-IN.
   176         16  FILLER              PIC X.
   177         16  TIME-OUT            PIC 99V99.
   178         16  FILLER              PIC XX.
   179     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   180     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   181     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   182     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6311.cbl
   183     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   184     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   185     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   186     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   187     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   188     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   189     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   190     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   191     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   192     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   193     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   194     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   195     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   196     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   197     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   198     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   199     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   200     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   201     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   202     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   203     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   204     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   205     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   206     12  FILE-ID                 PIC X(8).
   207     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   208     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   209     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   210     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   211     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   212     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   213     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   214     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   215     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   216     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   217     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   218     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   219     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   220     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   221
   222 01  WS-PASS-AREA.
   223     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   224     05  WS-PASS-VADS-REC    PIC X(350).
   225*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   226*                                COPY ELCZREC.
   227******************************************************************
   228*                                                                *
   229*                                                                *
   230*                            ELCZREC.                            *
   231*                                                                *
   232*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   233*                                                                *
   234******************************************************************
   235*-----------------------------------------------------------------
   236*                   C H A N G E   L O G
   237*
   238* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   239*-----------------------------------------------------------------
   240*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6311.cbl
   241* EFFECTIVE    NUMBER
   242*-----------------------------------------------------------------
   243* 122011    2011022800001  AJRA  NEW FILE
   244* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   245*-----------------------------------------------------------------
   246 01  W-Z-CONTROL-DATA.
   247     05  W-NUMBER-OF-COPIES      PIC  9.
   248     05  FILLER                  PIC  X.
   249     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   250     05  FILLER                  PIC  X.
   251     05  W-DAYS-TO-RESEND        PIC  999.
   252     05  FILLER                  PIC  X.
   253     05  W-FORM-TO-RESEND        PIC  X(4).
   254     05  FILLER                  PIC  X.
   255     05  W-PROMPT-LETTER         PIC  X.
   256     05  FILLER                  PIC  X.
   257     05  W-ENCLOSURE-CD          PIC  XXX.
   258     05  FILLER                  PIC  X.
   259     05  W-AUTO-CLOSE-IND        PIC  X.
   260     05  FILLER                  PIC  X.
   261     05  W-LETTER-TO-BENE        PIC  X.
   262     05  FILLER                  PIC  X.
   263     05  W-LETTER-TO-ACCT        PIC  X.
   264     05  FILLER                  PIC  X.
   265     05  W-LETTER-TYPE           PIC  X.
   266     05  FILLER                  PIC  X.
   267     05  W-PRINT-CERTIFICATE     PIC  X.
   268     05  FILLER                  PIC  X.
   269     05  W-REFUND-REQUIRED       PIC  X.
   270     05  FILLER                  PIC  X.
   271     05  W-ONBASE-CODE           PIC  XX.
   272     05  FILLER                  PIC  X.
   273     05  W-ACCT-SUMM             PIC  X.
   274     05  FILLER                  PIC  X.
   275     05  W-CSO-SUMM              PIC  X.
   276     05  FILLER                  PIC  X(31).
   277******************************************************************
   278*                                                                *
   279*              A C C E S S   K E Y S                             *
   280*                                                                *
   281******************************************************************
   282
   283 01  ACCESS-KEYS.
   284     12  ERPYAJ-KEY.
   285         16  ERPYAJ-COMPANY-CD       PIC X.
   286         16  ERPYAJ-CARRIER          PIC X.
   287         16  ERPYAJ-GROUPING         PIC X(6).
   288         16  ERPYAJ-FIN-RESP         PIC X(10).
   289         16  ERPYAJ-ACCOUNT          PIC X(10).
   290         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   291         16  ERPYAJ-TYPE             PIC X.
   292     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   293     12  ELCERT-KEY.
   294         16  ELCERT-COMPANY-CD       PIC X.
   295         16  ELCERT-CARRIER          PIC X.
   296         16  ELCERT-GROUPING         PIC X(6).
   297         16  ELCERT-STATE            PIC XX.
   298         16  ELCERT-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6311.cbl
   299         16  ELCERT-CERT-EFF-DT      PIC XX.
   300         16  ELCERT-CERT-NO.
   301             20  ELCERT-CERT-PRIME   PIC X(10).
   302             20  ELCERT-CERT-SFX     PIC X.
   303
   304     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   305     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   306     12  ELCRTO-KEY.
   307         16  ELCRTO-COMPANY-CD       PIC X.
   308         16  ELCRTO-CARRIER          PIC X.
   309         16  ELCRTO-GROUPING         PIC X(6).
   310         16  ELCRTO-STATE            PIC XX.
   311         16  ELCRTO-ACCOUNT          PIC X(10).
   312         16  ELCRTO-CERT-EFF-DT      PIC XX.
   313         16  ELCRTO-CERT-NO.
   314             20  ELCRTO-CERT-PRIME   PIC X(10).
   315             20  ELCRTO-CERT-SFX     PIC X.
   316         16  ELCRTO-RECORD-TYPE      PIC X.
   317         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   318     12  ERPNDB-KEY.
   319         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   320         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   321         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   322         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   323             ERPNDB-BATCH-SEQ-NO     PIC XX.
   324         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   325
   326     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   327     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   328     12  ELLETR-KEY.
   329         16  LETR-COMPANY-CD     PIC X.
   330         16  LETR-LETTER-ID      PIC X(4).
   331         16  LETR-FILLER         PIC X(8).
   332         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   333     12  ERPNDM-KEY.
   334         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   335         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   336         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   337         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   338
   339*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   340     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   341*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   342     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   343
   344     12  ERPNDB-ALT-KEY.
   345         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   346         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   347         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   348         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   349         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   350         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   351         16  ERPNDB-CERT-NO.
   352             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   353             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   354         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   355         16  ERPNDB-RECORD-TYPE      PIC X.
   356
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6311.cbl
   357      12  ERPNDB-CSR-KEY.
   358          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   359          20  ERPNDB-CSR-ID                PIC X(4).
   360          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   361          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   362          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   363
   364     12  ERNOTE-KEY.
   365         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   366         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   367         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   368         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   369         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   370         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   371         16  ERNOTE-CERT-NO.
   372             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   373             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   374
   375     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   376     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   377
   378     12  ERCNOT-KEY.
   379         16  ERCNOT-PART-KEY.
   380             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   381             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   382             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   383             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   384             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   385             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   386             20  ERCNOT-CERT-NO.
   387                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   388                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   389         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   390         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   391
   392     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   393     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   394
   395     12  ERMAIL-KEY.
   396         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   397         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   398         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   399         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   400         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   401         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   402         16  ERMAIL-CERT-NO.
   403             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   404             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   405
   406     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   407     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   408
   409     12  ERRQST-KEY.
   410         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   411         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   412
   413     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   414     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6311.cbl
   415
   416     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   417
   418     12  ERLOFC-KEY.
   419         16  ERLOFC-COMPANY-CD          PIC  X.
   420         16  ERLOFC-CARRIER             PIC  X.
   421         16  ERLOFC-GROUPING            PIC  X(6).
   422         16  ERLOFC-STATE               PIC  XX.
   423         16  ERLOFC-ACCOUNT             PIC  X(10).
   424         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   425*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   426
   427     12  ERACCT-KEY.
   428         16  ERACCT-COMPANY-CD          PIC  X.
   429         16  ERACCT-CARRIER             PIC  X.
   430         16  ERACCT-GROUPING            PIC  X(6).
   431         16  ERACCT-STATE               PIC  XX.
   432         16  ERACCT-ACCOUNT             PIC  X(10).
   433         16  ERACCT-EXP-DT.
   434             20  ERACCT-DT              PIC  XX.
   435             20  ERACCT-FILL            PIC  X(4).
   436
   437     12  ERENDT-KEY.
   438         16  ENDT-COMPANY-CD       PIC X.
   439         16  ENDT-CARRIER          PIC X.
   440         16  ENDT-GROUPING         PIC X(6).
   441         16  ENDT-STATE            PIC XX.
   442         16  ENDT-ACCOUNT          PIC X(10).
   443         16  ENDT-CERT-EFF-DT      PIC XX.
   444         16  ENDT-CERT-PRIME       PIC X(10).
   445         16  ENDT-CERT-SFX         PIC X.
   446         16  ENDT-RECORD-TYPE      PIC X.
   447         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   448
   449 01  WS-ELMSTR-WORK.
   450     12  ELMSTR-KEY.
   451         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   452         16  MSTR-CERT-NO.
   453             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   454             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   455     12  W-CLAIM-KEY.
   456         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   457         16  W-CL-CERT-NO.
   458             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   459             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   460      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   461
   462 01 SRCH-COMMAREA.
   463*                                COPY ELCADLTRSPI.
   464******************************************************************
   465*                   C H A N G E   L O G
   466*
   467* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   468*-----------------------------------------------------------------
   469*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   470* EFFECTIVE    NUMBER
   471*-----------------------------------------------------------------
   472* 060611    2011022800001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6311.cbl
   473******************************************************************
   474****************************************
   475*  commarea for NaperSoft On Demand Admin services letters
   476*  (business logic input & output)
   477****************************************
   478     03  BL-INPUT.
   479         05  BL-DATA-SRCE        PIC X.
   480         05  BL-LETTER-ID        PIC XXXX.
   481         05  BL-CARRIER          PIC X.
   482         05  BL-GROUP            PIC X(6).
   483         05  BL-STATE            PIC XX.
   484         05  BL-ACCOUNT          PIC X(10).
   485         05  BL-EFF-DT           PIC X(10).
   486         05  BL-CERT-NO          PIC X(11).
   487         05  BL-BATCH-NO         PIC X(6).
   488         05  BL-BATCH-SEQ        PIC 9(8).
   489         05  BL-RESP-NO          PIC X(10).
   490         05  BL-NO-OF-COPIES     PIC 99.
   491         05  BL-PROC-ID          PIC XXXX.
   492         05  BL-COMP-ID          PIC XXX.
   493         05  BL-PRINT-NOW-SW     PIC X.
   494         05  BL-ENC-CD           PIC XXX.
   495         05  BL-RESEND-DT        PIC X(10).
   496         05  BL-FOLLOW-UP-DT     PIC X(10).
   497         05  BL-ARCHIVE-NO       PIC 9(8).
   498         05  BL-FUNC             PIC X(8).
   499         05  BL-COMMENTS         PIC X(70).
   500         05  FILLER REDEFINES BL-COMMENTS.
   501             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   502             10  BL-LETTER-TO-ACCT PIC X.
   503             10  BL-LETTER-TO-BENE PIC X.
   504             10  BL-WRITE-ERARCH   PIC X.
   505                 88  ERARCH-QWS      VALUE 'Q'.
   506                 88  ERARCH-BATCH    VALUE 'B'.
   507                 88  ERARCH-TEMP     VALUE 'T'.
   508             10  BL-PROCESS-TYPE PIC X(07).
   509             10  BL-CERT-FORM-ID PIC X(05).
   510             10  FILLER          PIC X(07).
   511     03  BL-OUTPUT.
   512         05  BL-STATUS                   PIC X.
   513             88  BL-OK                      VALUE "P".
   514             88  BL-FAIL                  VALUE "F".
   515         05  BL-MESSAGE          PIC X(50).
   516     03  BL-RECORD-PASSED-DATA   PIC X(4754).
   517
   518 01  WS-RESCISSION-INFO.
   519     05  WS-ARCHIVE-NO           PIC 9(8)  VALUE ZEROS.
   520     05  WS-LETTER-ID            PIC X(4)  VALUE SPACES.
   521
   522 01  CANCEL-GEN-PASS-AREA.
   523     05  CG-OPTION-CODE          PIC X.
   524         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   525         88  CG-FLAT-CANCEL        VALUE '1'.
   526         88  CG-CANCEL             VALUE '2'.
   527         88  CG-CANCEL-REISSUE     VALUE '3'.
   528     05  CG-ERROR-CODE           PIC 99.
   529         88  CG-SUCCESS            VALUE 00.
   530         88  CG-DATE-ERROR         VALUE 01.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6311.cbl
   531         88  CG-CERT-NOT-FOUND     VALUE 02.
   532         88  CG-AMOUNT-ERROR       VALUE 04.
   533         88  CG-OPTION-ERROR       VALUE 05.
   534         88  CG-PREV-CAN           VALUE 06.
   535         88  CG-INVALID-DATA       VALUE 07.
   536         88  CG-NO-ACCT-MSTR       VALUE 08.
   537         88  CG-SFX-A-EXIST        VALUE 09.
   538         88  CG-MISC-ERROR         VALUE 99.
   539     05  CG-COMPANY-ID           PIC XXX.
   540     05  CG-PROC-ID              PIC XXXX.
   541     05  CG-CURRENT-DT           PIC XX.
   542     05  CG-MONTH-END-DT         PIC XX.
   543     05  CG-CERT-KEY.
   544         10  CG-CERT-COMPANY-CD  PIC X.
   545         10  CG-CERT-CARRIER     PIC X.
   546         10  CG-CERT-GROUP       PIC X(6).
   547         10  CG-CERT-STATE       PIC XX.
   548         10  CG-CERT-ACCOUNT     PIC X(10).
   549         10  CG-CERT-EFF-DT      PIC XX.
   550         10  CG-CERT-CERT-NO     PIC X(11).
   551     05  CG-LF-CAN-DATA.
   552         10  CG-LF-CAN-DT        PIC XX.
   553         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   554     05  CG-AH-CAN-DATA.
   555         10  CG-AH-CAN-DT        PIC XX.
   556         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   557     05  CG-CERT-PROFILE-DATA.
   558         10  CG-INS-LNAME        PIC X(15).
   559         10  CG-INS-FNAME        PIC X(10).
   560         10  CG-INS-MID-INIT     PIC X.
   561         10  CG-INS-AGE          PIC 99.
   562         10  CG-JNT-LNAME        PIC X(15).
   563         10  CG-JNT-FNAME        PIC X(10).
   564         10  CG-JNT-MID-INIT     PIC X.
   565         10  CG-JNT-AGE          PIC 99.
   566     05  CG-LF-ISS-DATA.
   567         10  CG-LF-BENCD         PIC XX.
   568         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   569         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   570     05  CG-AH-ISS-DATA.
   571         10  CG-AH-BENCD         PIC XX.
   572         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   573     05  CG-BATCH-NO             PIC X(6).
   574     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   575     05  FILLER                  PIC X(306).
   576******************************************************************
   577*                                                                *
   578*            G E N E R A L   W O R K   A R E A                   *
   579*                                                                *
   580******************************************************************
   581
   582 01  WORK-AREA.
   583     12  WS-RESPONSE             PIC S9(8)   COMP.
   584         88  RESP-NORMAL                  VALUE +00.
   585         88  RESP-NOTFND                  VALUE +13.
   586         88  RESP-DUPREC                  VALUE +14.
   587         88  RESP-DUPKEY                  VALUE +15.
   588         88  RESP-NOTOPEN                 VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6311.cbl
   589         88  RESP-ENDFILE                 VALUE +20.
   590     12  DEEDIT-FIELD            PIC X(15).
   591     12  FILLER          REDEFINES DEEDIT-FIELD.
   592         16  FILLER              PIC X(4).
   593         16  DEEDIT-FIELD-X11    PIC X(11).
   594     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   595                                 PIC S9(15).
   596     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   597                                 PIC S9(13)V99.
   598     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   599                                 PIC S9(11)V9999.
   600     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   601     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   602     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   603         16  WS-CALC-TERM-WHOLE  PIC S999.
   604         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   605
   606     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   607     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   608         16  WS-HR-MINS          PIC 99V99.
   609         16  FILLER              PIC XX.
   610
   611     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   612     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   613
   614     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   615     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   616
   617     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   618     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   619     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   620     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   621     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   622     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   623     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   624
   625     12  QID.
   626         16  QID-TERM            PIC X(4).
   627         16  FILLER              PIC X(4)    VALUE '607B'.
   628
   629     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   630         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   631
   632     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   633         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   634
   635     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   636         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'.
   637
   638     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   639
   640     12  WS-NUMERIC-SW           PIC X.
   641        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   642
   643     12  WS-EDIT-CSO-FIELD.
   644         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   645                                 PIC X.
   646
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6311.cbl
   647     12  WS-SAVE-INPUT-FIELDS.
   648         16  WS-BAGE             PIC 99       VALUE ZERO.
   649*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   650         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   651         16  FILLER REDEFINES WS-BAPR.
   652             20  WS-APR-WHOLE-NUM    PIC 99.
   653             20  WS-APR-DEC          PIC 9999.
   654         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   655         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   656
   657         16  WS-B-COVERAGE OCCURS 2 TIMES.
   658             20  WS-TERM-IN-DAYS-SW  PIC X.
   659                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   660             20  WS-BTERM        PIC 999       COMP-3.
   661             20  WS-BALT-TERM    PIC 999       COMP-3.
   662             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   663             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   664             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   665             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   666             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   667             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   668
   669         16  WS-C-FIELDS COMP-3.
   670             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   671             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   672             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   673
   674         16  WS-D-FIELDS COMP-3.
   675             20  WS-DRISS        PIC S9(5)    VALUE +0.
   676             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   677             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   678             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   679             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   680             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   681
   682     12  WS-SAVE-BIRTH-DATE.
   683         16  FILLER              PIC X(4)   VALUE SPACES.
   684         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   685
   686     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   687     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   688     12  FILLER REDEFINES WS-WORK-BIN-RED.
   689         16  FILLER              PIC X(02).
   690         16  WS-WORK-BIN-DT      PIC X(02).
   691     12  WS-SW-1                 PIC X     VALUE SPACE.
   692     12  WS-SW-2                 PIC X     VALUE SPACE.
   693     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   694         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   695     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   696         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   697
   698     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   699     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   700     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   701     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   702     12  WS-CONVERTED-CANCEL-DATES.
   703         16  WS-CONVERTED-CANDT1                  PIC XX.
   704         16  WS-CONVERTED-CANDT2                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6311.cbl
   705
   706     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   707
   708     12  WS-REC-FOUND-SW         PIC X.
   709         88  RECORD-NOT-FOUND    VALUE 'N'.
   710
   711     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   712         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   713         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   714
   715     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   716         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   717         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   718
   719     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   720         88  BROWSE-STARTED      VALUE 'Y'.
   721
   722     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   723         88  FIRST-TIME          VALUE 'Y'.
   724
   725     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   726         88  FIRST-ENTRY         VALUE 'Y'.
   727
   728     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   729         88  REC-BILLED          VALUE 'Y'.
   730
   731     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   732         88  NO-CURSOR-SET       VALUE +0.
   733         88  CURSOR-SET          VALUE +1.
   734
   735     12  WS-ERR-SW               PIC X.
   736         88  STD-ERRORS          VALUE 'S'.
   737         88  TRN-ERRORS          VALUE 'T'.
   738
   739     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   740         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   741
   742     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   743         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   744
   745     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   746         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   747
   748     12  WS-ERR-CODE.
   749         16  FILLER              PIC 99.
   750         16  WS-ERROR-SUB        PIC 99.
   751
   752     12  WS-DATE-WORK.
   753         16  WS-WORK-MM          PIC XX.
   754         16  WS-WORK-DD          PIC XX.
   755         16  WS-WORK-YY          PIC XX.
   756
   757     12  WS-MM-YY.
   758         16  WS-MM               PIC XX.
   759         16  FILLER              PIC X     VALUE '/'.
   760         16  WS-YY               PIC XX.
   761
   762     12  WS-CERT-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6311.cbl
   763
   764     12  WS-MEMBER-NO            PIC X(12).
   765     12  FILLER  REDEFINES  WS-MEMBER-NO.
   766         16  WS-MEMBER-NO-1-8    PIC 9(8).
   767         16  FILLER              PIC X(4).
   768
   769     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   770
   771     12  WS-ERPNDB-ALT-KEY.
   772         16  WS-PB-COMPANY-CD-A1         PIC X.
   773         16  WS-PB-CARRIER               PIC X.
   774         16  WS-PB-GROUPING              PIC X(6).
   775         16  WS-PB-STATE                 PIC XX.
   776         16  WS-PB-ACCOUNT               PIC X(10).
   777         16  WS-PB-CERT-EFF-DT           PIC XX.
   778         16  WS-PB-CERT-NO.
   779             20  WS-PB-CERT-PRIME        PIC X(10).
   780             20  WS-PB-CERT-SFX          PIC X.
   781         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   782         16  WS-PB-RECORD-TYPE           PIC X.
   783
   784     12  WS-SHOW-SAVE-AREAS.
   785         16  WS-NEW-CERT-NO.
   786             20  WS-NEW-PRIME    PIC X(10).
   787             20  WS-NEW-SUFFIX   PIC X.
   788         16  WS-NEW-CERT-EFF-DT  PIC XX.
   789         16  WS-NEW-RECORD-TYPE  PIC X.
   790         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   791             88   SHOW-RECORD            VALUE 'Y'.
   792
   793     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   794
   795     12  WS-BATCH-NO.
   796         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   797         16  FILLER              PIC X(5) VALUE SPACES.
   798
   799     12  WS-FIRST-NAME.
   800         16  WS-1ST-INIT         PIC X.
   801         16  FILLER              PIC X(9).
   802
   803     12  WS-INITIALS.
   804         16  WS-INITIAL-1        PIC X.
   805         16  WS-INITIAL-2        PIC X.
   806
   807     12  WS-C-HDG.
   808         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   809         16  FILLER              PIC X(4) VALUE '-REF'.
   810
   811     12  WS-D-PREM-HDG.
   812         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   813         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   814
   815     12  WS-D-REFUND-HDG.
   816         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   817         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   818
   819     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   820
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6311.cbl
   821     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   822     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   823     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   824     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   825     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   826     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   827     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   828
   829     12  WS-01-CANCEL-ERR        PIC X(25)
   830         VALUE 'CANCEL DATE ERROR'.
   831     12  WS-02-CANCEL-ERR        PIC X(25)
   832         VALUE 'CERT NOT FOUND'.
   833     12  WS-04-CANCEL-ERR        PIC X(25)
   834         VALUE 'CANCEL AMOUNT ERROR'.
   835     12  WS-05-CANCEL-ERR        PIC X(25)
   836         VALUE 'CANCEL OPTION ERROR'.
   837     12  WS-06-CANCEL-ERR        PIC X(25)
   838         VALUE 'PREVIOUSLY CANCELLED'.
   839     12  WS-07-CANCEL-ERR        PIC X(25)
   840         VALUE 'INVALID DATA'.
   841     12  WS-08-CANCEL-ERR        PIC X(25)
   842         VALUE 'NO ACCOUNT MASTER'.
   843     12  WS-09-CANCEL-ERR        PIC X(25)
   844         VALUE 'SUFFIX ALREADY EXISTS'.
   845     12  WS-99-CANCEL-ERR        PIC X(25)
   846         VALUE 'MISC CANCEL ERROR'.
   847
   848     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   849     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   850
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6311.cbl
   852
   853******************************************************************
   854*                                                                *
   855*                 B A T C H   T O T A L S                        *
   856*                                                                *
   857******************************************************************
   858
   859     12  WS-BATCH-RECORD.
   860         16  FILLER                       PIC X(10).
   861         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   862         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   863         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   864         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   865         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   866         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   867         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   868         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   869         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   870         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   871         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   872         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   873         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   874         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   875         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   876         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   877         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   878         16  WS-ACCOUNT-NAME              PIC X(30).
   879         16  FILLER                       PIC X.
   880         16  WS-REFERENCE                 PIC X(12).
   881         16  FILLER                       PIC X(197).
   882
   883     12  WS-BATCH-TOTALS.
   884         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   885         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   886         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   887         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   888         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   889         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   890         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   891         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   892         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   893         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   894         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   895         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   896         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   897         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   898         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   899         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   900         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   901         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   902         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   903
   904     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   905
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6311.cbl
   907
   908******************************************************************
   909*                                                                *
   910*                E R R O R   M E S S A G E S                     *
   911*                                                                *
   912******************************************************************
   913
   914 01  ERROR-MESSAGES.
   915     12  ER-0004                 PIC  9(4) VALUE 0004.
   916     12  ER-0008                 PIC  9(4) VALUE 0008.
   917     12  ER-0023                 PIC  9(4) VALUE 0023.
   918     12  ER-0029                 PIC  9(4) VALUE 0029.
   919     12  ER-0033                 PIC  9(4) VALUE 0033.
   920     12  ER-0070                 PIC  9(4) VALUE 0070.
   921     12  ER-0220                 PIC  9(4) VALUE 0220.
   922     12  ER-0248                 PIC  9(4) VALUE 0248.
   923     12  ER-0280                 PIC  9(4) VALUE 0280.
   924     12  ER-0348                 PIC  9(4) VALUE 0348.
   925     12  ER-0582                 PIC  9(4) VALUE 0582.
   926     12  ER-0877                 PIC  9(4) VALUE 0877.
   927     12  ER-1236                 PIC  9(4) VALUE 1236.
   928     12  ER-1570                 PIC  9(4) VALUE 1570.
   929     12  ER-1575                 PIC  9(4) VALUE 1575.
   930     12  ER-1609                 PIC  9(4) VALUE 1609.
   931     12  ER-1819                 PIC  9(4) VALUE 1819.
   932     12  ER-2129                 PIC  9(4) VALUE 2129.
   933     12  ER-2188                 PIC  9(4) VALUE 2188.
   934     12  ER-2192                 PIC  9(4) VALUE 2192.
   935     12  ER-2196                 PIC  9(4) VALUE 2196.
   936     12  ER-2197                 PIC  9(4) VALUE 2197.
   937     12  ER-2198                 PIC  9(4) VALUE 2198.
   938     12  ER-2200                 PIC  9(4) VALUE 2200.
   939     12  ER-2212                 PIC  9(4) VALUE 2212.
   940     12  ER-2218                 PIC  9(4) VALUE 2218.
   941     12  ER-2220                 PIC  9(4) VALUE 2220.
   942     12  ER-2222                 PIC  9(4) VALUE 2222.
   943     12  ER-2223                 PIC  9(4) VALUE 2223.
   944     12  ER-2224                 PIC  9(4) VALUE 2224.
   945     12  ER-2225                 PIC  9(4) VALUE 2225.
   946     12  ER-2226                 PIC  9(4) VALUE 2226.
   947     12  ER-2227                 PIC  9(4) VALUE 2227.
   948     12  ER-2228                 PIC  9(4) VALUE 2228.
   949     12  ER-2240                 PIC  9(4) VALUE 2240.
   950     12  ER-2241                 PIC  9(4) VALUE 2241.
   951     12  ER-2242                 PIC  9(4) VALUE 2242.
   952     12  ER-2243                 PIC  9(4) VALUE 2243.
   953     12  ER-2244                 PIC  9(4) VALUE 2244.
   954     12  ER-2245                 PIC  9(4) VALUE 2245.
   955     12  ER-2246                 PIC  9(4) VALUE 2246.
   956     12  ER-2247                 PIC  9(4) VALUE 2247.
   957     12  ER-2251                 PIC  9(4) VALUE 2251.
   958     12  ER-2252                 PIC  9(4) VALUE 2252.
   959     12  ER-2253                 PIC  9(4) VALUE 2253.
   960     12  ER-2254                 PIC  9(4) VALUE 2254.
   961     12  ER-2255                 PIC  9(4) VALUE 2255.
   962     12  ER-2256                 PIC  9(4) VALUE 2256.
   963     12  ER-2257                 PIC  9(4) VALUE 2257.
   964     12  ER-2258                 PIC  9(4) VALUE 2258.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6311.cbl
   965     12  ER-2259                 PIC  9(4) VALUE 2259.
   966     12  ER-2260                 PIC  9(4) VALUE 2260.
   967     12  ER-2261                 PIC  9(4) VALUE 2261.
   968     12  ER-2287                 PIC  9(4) VALUE 2287.
   969     12  ER-2336                 PIC  9(4) VALUE 2336.
   970     12  ER-2337                 PIC  9(4) VALUE 2337.
   971     12  ER-2437                 PIC  9(4) VALUE 2437.
   972     12  ER-2471                 PIC  9(4) VALUE 2471.
   973     12  ER-2530                 PIC  9(4) VALUE 2530.
   974     12  ER-2531                 PIC  9(4) VALUE 2531.
   975     12  ER-2532                 PIC  9(4) VALUE 2532.
   976     12  ER-2533                 PIC  9(4) VALUE 2533.
   977     12  ER-2547                 PIC  9(4) VALUE 2547.
   978     12  ER-2591                 PIC  9(4) VALUE 2591.
   979     12  ER-2592                 PIC  9(4) VALUE 2592.
   980     12  ER-2593                 PIC  9(4) VALUE 2593.
   981     12  ER-2600                 PIC  9(4) VALUE 2600.
   982     12  ER-2601                 PIC  9(4) VALUE 2601.
   983     12  ER-2604                 PIC  9(4) VALUE 2604.
   984     12  ER-2605                 PIC  9(4) VALUE 2605.
   985     12  ER-2606                 PIC  9(4) VALUE 2606.
   986     12  ER-2607                 PIC  9(4) VALUE 2607.
   987     12  ER-2622                 PIC  9(4) VALUE 2622.
   988     12  ER-2625                 PIC  9(4) VALUE 2625.
   989     12  ER-2626                 PIC  9(4) VALUE 2626.
   990     12  ER-2627                 PIC  9(4) VALUE 2627.
   991     12  ER-2628                 PIC  9(4) VALUE 2628.
   992     12  ER-2629                 PIC  9(4) VALUE 2629.
   993     12  ER-2630                 PIC  9(4) VALUE 2630.
   994     12  ER-2631                 PIC  9(4) VALUE 2631.
   995     12  ER-2632                 PIC  9(4) VALUE 2632.
   996     12  ER-2633                 PIC  9(4) VALUE 2633.
   997     12  ER-2634                 PIC  9(4) VALUE 2634.
   998     12  ER-2635                 PIC  9(4) VALUE 2635.
   999     12  ER-2636                 PIC  9(4) VALUE 2636.
  1000     12  ER-2639                 PIC  9(4) VALUE 2639.
  1001     12  ER-2640                 PIC  9(4) VALUE 2640.
  1002     12  ER-2647                 PIC  9(4) VALUE 2647.
  1003     12  ER-2648                 PIC  9(4) VALUE 2648.
  1004     12  ER-2649                 PIC  9(4) VALUE 2649.
  1005     12  ER-2650                 PIC  9(4) VALUE 2650.
  1006     12  ER-2653                 PIC  9(4) VALUE 2653.
  1007     12  ER-2654                 PIC  9(4) VALUE 2654.
  1008     12  ER-2655                 PIC  9(4) VALUE 2655.
  1009     12  ER-2656                 PIC  9(4) VALUE 2656.
  1010     12  ER-2657                 PIC  9(4) VALUE 2657.
  1011     12  ER-2660                 PIC  9(4) VALUE 2660.
  1012     12  ER-2662                 PIC  9(4) VALUE 2662.
  1013     12  ER-2663                 PIC  9(4) VALUE 2663.
  1014     12  ER-2664                 PIC  9(4) VALUE 2664.
  1015     12  ER-2667                 PIC  9(4) VALUE 2667.
  1016     12  ER-2668                 PIC  9(4) VALUE 2668.
  1017     12  ER-2669                 PIC  9(4) VALUE 2669.
  1018     12  ER-2670                 PIC  9(4) VALUE 2670.
  1019     12  ER-2671                 PIC  9(4) VALUE 2671.
  1020     12  ER-2672                 PIC  9(4) VALUE 2672.
  1021     12  ER-2673                 PIC  9(4) VALUE 2673.
  1022     12  ER-2677                 PIC  9(4) VALUE 2677.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6311.cbl
  1023     12  ER-2678                 PIC  9(4) VALUE 2678.
  1024     12  ER-2679                 PIC  9(4) VALUE 2679.
  1025     12  ER-2680                 PIC  9(4) VALUE 2680.
  1026     12  ER-2681                 PIC  9(4) VALUE 2681.
  1027     12  ER-2682                 PIC  9(4) VALUE 2682.
  1028     12  ER-2683                 PIC  9(4) VALUE 2683.
  1029     12  ER-2684                 PIC  9(4) VALUE 2684.
  1030     12  ER-2686                 PIC  9(4) VALUE 2686.
  1031     12  ER-2689                 PIC  9(4) VALUE 2689.
  1032     12  ER-2690                 PIC  9(4) VALUE 2690.
  1033     12  ER-2693                 PIC  9(4) VALUE 2693.
  1034     12  ER-2695                 PIC  9(4) VALUE 2695.
  1035     12  ER-2701                 PIC  9(4) VALUE 2701.
  1036     12  ER-2720                 PIC  9(4) VALUE 2720.
  1037     12  ER-2709                 PIC  9(4) VALUE 2709.
  1038     12  ER-2704                 PIC  9(4) VALUE 2704.
  1039     12  ER-2725                 PIC  9(4) VALUE 2725.
  1040     12  ER-2726                 PIC  9(4) VALUE 2726.
  1041     12  ER-2728                 PIC  9(4) VALUE 2728.
  1042     12  ER-2729                 PIC  9(4) VALUE 2729.
  1043     12  ER-2731                 PIC  9(4) VALUE 2731.
  1044     12  ER-2732                 PIC  9(4) VALUE 2732.
  1045     12  ER-2733                 PIC  9(4) VALUE 2733.
  1046     12  ER-2735                 PIC  9(4) VALUE 2735.
  1047     12  ER-2738                 PIC  9(4) VALUE 2738.
  1048     12  ER-2742                 PIC  9(4) VALUE 2742.
  1049     12  ER-2743                 PIC  9(4) VALUE 2743.
  1050     12  ER-2744                 PIC  9(4) VALUE 2744.
  1051     12  ER-2747                 PIC  9(4) VALUE 2747.
  1052     12  ER-2749                 PIC  9(4) VALUE 2749.
  1053     12  ER-2753                 PIC  9(4) VALUE 2753.
  1054     12  ER-2755                 PIC  9(4) VALUE 2755.
  1055     12  ER-2757                 PIC  9(4) VALUE 2757.
  1056     12  ER-2771                 PIC  9(4) VALUE 2771.
  1057     12  ER-2774                 PIC  9(4) VALUE 2774.
  1058     12  ER-2775                 PIC  9(4) VALUE 2775.
  1059     12  ER-2776                 PIC  9(4) VALUE 2776.
  1060     12  ER-2777                 PIC  9(4) VALUE 2777.
  1061     12  ER-2794                 PIC  9(4) VALUE 2794.
  1062     12  ER-2799                 PIC  9(4) VALUE 2799.
  1063     12  ER-2900                 PIC  9(4) VALUE 2900.
  1064     12  ER-2902                 PIC  9(4) VALUE 2902.
  1065     12  ER-2945                 PIC  9(4) VALUE 2945.
  1066     12  ER-3000                 PIC  9(4) VALUE 3000.
  1067     12  ER-3006                 PIC  9(4) VALUE 3006.
  1068     12  ER-3224                 PIC  9(4) VALUE 3224.
  1069     12  ER-3831                 PIC  9(4) VALUE 3831.
  1070     12  ER-3834                 PIC  9(4) VALUE 3834.
  1071     12  ER-3835                 PIC  9(4) VALUE 3835.
  1072     12  ER-4005                 PIC  9(4) VALUE 4005.
  1073     12  ER-7401                 PIC  9(4) VALUE 7401.
  1074     12  ER-7402                 PIC  9(4) VALUE 7402.
  1075     12  ER-7403                 PIC  9(4) VALUE 7403.
  1076     12  ER-7404                 PIC  9(4) VALUE 7404.
  1077     12  ER-7423                 PIC  9(4) VALUE 7423.
  1078     12  ER-7424                 PIC  9(4) VALUE 7424.
  1079     12  ER-7433                 PIC  9(4) VALUE 7433.
  1080     12  ER-7450                 PIC  9(4) VALUE 7450.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6311.cbl
  1081     12  ER-7451                 PIC  9(4) VALUE 7451.
  1082     12  ER-7530                 PIC  9(4) VALUE 7530.
  1083     12  ER-7573                 PIC  9(4) VALUE 7573.
  1084     12  ER-7631                 PIC  9(4) VALUE 7631.
  1085     12  ER-7632                 PIC  9(4) VALUE 7632.
  1086     12  ER-7633                 PIC  9(4) VALUE 7633.
  1087     12  ER-7537                 PIC  9(4) VALUE 7537.
  1088     12  ER-7538                 PIC  9(4) VALUE 7538.
  1089     12  ER-7574                 PIC  9(4) VALUE 7574.
  1090     12  ER-7997                 PIC  9(4) VALUE 7997.
  1091     12  ER-7998                 PIC  9(4) VALUE 7998.
  1092     12  ER-8148                 PIC  9(4) VALUE 8148.
  1093     12  ER-9841                 PIC  9(4) VALUE 9841.
  1094
  1095*                                COPY ELCTEXT.
  1096******************************************************************
  1097*                                                                *
  1098*                                                                *
  1099*                            ELCTEXT.                            *
  1100*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1101*                            VMOD=2.008                          *
  1102*                                                                *
  1103*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1104*                                     FORM LETTERS,              *
  1105*                                     CERT FORM DISPLAY.
  1106*                                                                *
  1107*   FILE TYPE = VSAM,KSDS                                        *
  1108*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1109*                                                                *
  1110*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1111*       ALTERNATE INDEX = NONE                                   *
  1112*                                                                *
  1113*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1114*       ALTERNATE INDEX = NONE                                   *
  1115*                                                                *
  1116*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1117*       ALTERNATE INDEX = NONE                                   *
  1118*                                                                *
  1119*   LOG = NO                                                     *
  1120*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1121******************************************************************
  1122 01  TEXT-FILES.
  1123     12  TEXT-FILE-ID                PIC XX.
  1124         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1125         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1126         88  HELP-FILE-TEXT             VALUE 'TH'.
  1127
  1128     12  TX-CONTROL-PRIMARY.
  1129         16  TX-COMPANY-CD           PIC X.
  1130             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1131         16  TX-ACCESS-CD-GENL       PIC X(12).
  1132
  1133         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1134             20  TX-LETTER-NO        PIC X(4).
  1135             20  FILLER              PIC X(8).
  1136
  1137         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1138             20  TX-FORM-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6311.cbl
  1139
  1140         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1141             20  TX-HELP-TYPE        PIC X.
  1142                 88  HELP-FOR-GENERAL   VALUE ' '.
  1143                 88  HELP-BY-SCREEN     VALUE 'S'.
  1144                 88  HELP-BY-ERROR      VALUE 'E'.
  1145             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1146                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1147             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1148                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1149             20  FILLER              PIC X(4).
  1150
  1151         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1152
  1153     12  TX-PROCESS-CONTROL          PIC XX.
  1154         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1155
  1156     12  TX-TEXT-LINE                PIC X(70).
  1157
  1158     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1159         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1160         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1161         88  TX-VALID-FORM-SQUEEZE-VALUE
  1162                                        VALUE 'Y' ' '.
  1163
  1164     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1165         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1166         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1167         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1168         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1169         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1170         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1171         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1172                                              'K' 'N' ' '
  1173                                              'Z'.
  1174
  1175     12  TX-ARCHIVE-SW               PIC X.
  1176         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1177         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1178         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1179
  1180     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1181     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1182
  1183     12  TX-BSR-CODE                 PIC X.
  1184         88  TX-BSR-LETTER              VALUE 'B'.
  1185         88  TX-NON-BSR-LETTER          VALUE ' '.
  1186
  1187     12  FILLER                      PIC X.
  1188*****************************************************************
  1189*                                COPY ELCCRTO.
  1190******************************************************************
  1191*                                                                *
  1192*                            ELCCRTO.                            *
  1193*                                                                *
  1194*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1195*                                                                *
  1196*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6311.cbl
  1197*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1198*                                                                *
  1199*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1200*                                                                *
  1201*   LOG = YES                                                    *
  1202*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1203******************************************************************
  1204*                   C H A N G E   L O G
  1205*
  1206* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1207*-----------------------------------------------------------------
  1208*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1209* EFFECTIVE    NUMBER
  1210*-----------------------------------------------------------------
  1211* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1212* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1213* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1214******************************************************************
  1215 01  ORIGINAL-CERTIFICATE.
  1216     12  OC-RECORD-ID                      PIC XX.
  1217         88  VALID-OC-ID                      VALUE 'OC'.
  1218     12  OC-CONTROL-PRIMARY.
  1219         16  OC-COMPANY-CD                 PIC X.
  1220         16  OC-CARRIER                    PIC X.
  1221         16  OC-GROUPING                   PIC X(6).
  1222         16  OC-STATE                      PIC XX.
  1223         16  OC-ACCOUNT                    PIC X(10).
  1224         16  OC-CERT-EFF-DT                PIC XX.
  1225         16  OC-CERT-NO.
  1226             20  OC-CERT-PRIME             PIC X(10).
  1227             20  OC-CERT-SFX               PIC X.
  1228         16  OC-RECORD-TYPE                PIC X.
  1229         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1230     12  OC-LAST-MAINT-DT                  PIC XX.
  1231     12  OC-LAST-MAINT-BY                  PIC X(4).
  1232     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1233     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1234     12  FILLER                            PIC X(49).
  1235     12  OC-ORIG-REC.
  1236         16  OC-INS-LAST-NAME              PIC X(15).
  1237         16  OC-INS-FIRST-NAME             PIC X(10).
  1238         16  OC-INS-MIDDLE-INIT            PIC X.
  1239         16  OC-INS-AGE                    PIC S999     COMP-3.
  1240         16  OC-JNT-LAST-NAME              PIC X(15).
  1241         16  OC-JNT-FIRST-NAME             PIC X(10).
  1242         16  OC-JNT-MIDDLE-INIT            PIC X.
  1243         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1244         16  OC-LF-BENCD                   PIC XX.
  1245         16  OC-LF-TERM                    PIC S999      COMP-3.
  1246         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1247         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1248         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1249         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1250         16  OC-LF-EXP-DT                  PIC XX.
  1251         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1252         16  OC-LF-CANCEL-DT               PIC XX.
  1253         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1254         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6311.cbl
  1255         16  OC-AH-BENCD                   PIC XX.
  1256         16  OC-AH-TERM                    PIC S999      COMP-3.
  1257         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1258         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1259         16  OC-AH-EXP-DT                  PIC XX.
  1260         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1261         16  OC-AH-CP                      PIC 99.
  1262         16  OC-AH-CANCEL-DT               PIC XX.
  1263         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1264         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1265         16  OC-CRED-BENE-NAME             PIC X(25).
  1266         16  OC-1ST-PMT-DT                 PIC XX.
  1267         16  FILLER                        PIC X(215).
  1268
  1269     12  FILLER                            PIC X(50).
  1270******************************************************************
  1271*                                COPY ERCACCT.
  1272******************************************************************
  1273*                                                                *
  1274*                                                                *
  1275*                            ERCACCT                             *
  1276*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1277*                            VMOD=2.031                          *
  1278*                                                                *
  1279*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1280*                                                                *
  1281*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1282*   VSAM ACCOUNT MASTER FILES.                                   *
  1283*                                                                *
  1284*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1285*                                                                *
  1286*   FILE TYPE = VSAM,KSDS                                        *
  1287*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1288*                                                                *
  1289*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1290*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1291*                                                                *
  1292*   LOG = NO                                                     *
  1293*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1294*                                                                *
  1295*                                                                *
  1296******************************************************************
  1297*                   C H A N G E   L O G
  1298*
  1299* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1300*-----------------------------------------------------------------
  1301*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1302* EFFECTIVE    NUMBER
  1303*-----------------------------------------------------------------
  1304* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1305* 092705    2005050300006  PEMA  ADD SPP LEASES
  1306* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1307* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1308* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1309* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1310* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1311******************************************************************
  1312
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6311.cbl
  1313 01  ACCOUNT-MASTER.
  1314     12  AM-RECORD-ID                      PIC XX.
  1315         88  VALID-AM-ID                      VALUE 'AM'.
  1316
  1317     12  AM-CONTROL-PRIMARY.
  1318         16  AM-COMPANY-CD                 PIC X.
  1319         16  AM-MSTR-CNTRL.
  1320             20  AM-CONTROL-A.
  1321                 24  AM-CARRIER            PIC X.
  1322                 24  AM-GROUPING.
  1323                     28 AM-GROUPING-PREFIX PIC XXX.
  1324                     28 AM-GROUPING-PRIME  PIC XXX.
  1325                 24  AM-STATE              PIC XX.
  1326                 24  AM-ACCOUNT.
  1327                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1328                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1329             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1330                                           PIC X(19).
  1331             20  AM-CNTRL-B.
  1332                 24  AM-EXPIRATION-DT      PIC XX.
  1333                 24  FILLER                PIC X(4).
  1334             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1335                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1336
  1337     12  AM-CONTROL-BY-VAR-GRP.
  1338         16  AM-COMPANY-CD-A1              PIC X.
  1339         16  AM-VG-CARRIER                 PIC X.
  1340         16  AM-VG-GROUPING                PIC X(6).
  1341         16  AM-VG-STATE                   PIC XX.
  1342         16  AM-VG-ACCOUNT                 PIC X(10).
  1343         16  AM-VG-DATE.
  1344             20  AM-VG-EXPIRATION-DT       PIC XX.
  1345             20  FILLER                    PIC X(4).
  1346         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1347                                           PIC 9(11)      COMP-3.
  1348     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1349         16  FILLER                        PIC X(10).
  1350         16  AM-VG-KEY3.
  1351             20  AM-VG3-ACCOUNT            PIC X(10).
  1352             20  AM-VG3-EXP-DT             PIC XX.
  1353         16  FILLER                        PIC X(4).
  1354     12  AM-MAINT-INFORMATION.
  1355         16  AM-LAST-MAINT-DT              PIC XX.
  1356         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1357         16  AM-LAST-MAINT-USER            PIC X(4).
  1358         16  FILLER                        PIC XX.
  1359
  1360     12  AM-EFFECTIVE-DT                   PIC XX.
  1361     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1362
  1363     12  AM-PREV-DATES  COMP-3.
  1364         16  AM-PREV-EXP-DT                PIC 9(11).
  1365         16  AM-PREV-EFF-DT                PIC 9(11).
  1366
  1367     12  AM-REPORT-CODE-1                  PIC X(10).
  1368     12  AM-REPORT-CODE-2                  PIC X(10).
  1369
  1370     12  AM-CITY-CODE                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6311.cbl
  1371     12  AM-COUNTY-PARISH                  PIC X(6).
  1372
  1373     12  AM-NAME                           PIC X(30).
  1374     12  AM-PERSON                         PIC X(30).
  1375     12  AM-ADDRS                          PIC X(30).
  1376     12  AM-CITY.
  1377         16  AM-ADDR-CITY                  PIC X(28).
  1378         16  AM-ADDR-STATE                 PIC XX.
  1379     12  AM-ZIP.
  1380         16  AM-ZIP-PRIME.
  1381             20  AM-ZIP-PRI-1ST            PIC X.
  1382                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1383             20  FILLER                    PIC X(4).
  1384         16  AM-ZIP-PLUS4                  PIC X(4).
  1385     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1386         16  AM-CAN-POSTAL-1               PIC XXX.
  1387         16  AM-CAN-POSTAL-2               PIC XXX.
  1388         16  FILLER                        PIC XXX.
  1389     12  AM-TEL-NO.
  1390         16  AM-AREA-CODE                  PIC 999.
  1391         16  AM-TEL-PRE                    PIC 999.
  1392         16  AM-TEL-NBR                    PIC 9(4).
  1393     12  AM-TEL-LOC                        PIC X.
  1394         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1395         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1396
  1397     12  AM-COMM-STRUCTURE.
  1398         16  AM-DEFN-1.
  1399             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1400                 24  AM-AGT.
  1401                     28  AM-AGT-PREFIX     PIC X(4).
  1402                     28  AM-AGT-PRIME      PIC X(6).
  1403                 24  AM-COM-TYP            PIC X.
  1404                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1405                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1406                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1407                 24  AM-RECALC-LV-INDIC    PIC X.
  1408                 24  AM-RETRO-LV-INDIC     PIC X.
  1409                 24  AM-GL-CODES           PIC X.
  1410                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1411                 24  FILLER                PIC X(01).
  1412         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1413             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1414                 24  FILLER                PIC X(11).
  1415                 24  AM-L-COMA             PIC XXX.
  1416                 24  AM-J-COMA             PIC XXX.
  1417                 24  AM-A-COMA             PIC XXX.
  1418                 24  FILLER                PIC X(6).
  1419
  1420     12  AM-COMM-CHANGE-STATUS             PIC X.
  1421         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1422
  1423     12  AM-CSR-CODE                       PIC X(4).
  1424
  1425     12  AM-BILLING-STATUS                 PIC X.
  1426         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1427         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1428     12  AM-AUTO-REFUND-SW                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6311.cbl
  1429         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1430         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1431     12  AM-GPCD                           PIC 99.
  1432     12  AM-IG                             PIC X.
  1433         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1434         88  AM-HAS-GROUP                     VALUE '2'.
  1435     12  AM-STATUS                         PIC X.
  1436         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1437         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1438         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1439         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1440         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1441         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1442     12  AM-REMIT-TO                       PIC 99.
  1443     12  AM-ID-NO                          PIC X(11).
  1444
  1445     12  AM-CAL-TABLE                      PIC XX.
  1446     12  AM-LF-DEVIATION                   PIC XXX.
  1447     12  AM-AH-DEVIATION                   PIC XXX.
  1448     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1449     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1450     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1451     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1452     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1453     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1454
  1455     12  AM-USER-FIELDS.
  1456         16  AM-FLD-1                      PIC XX.
  1457         16  AM-FLD-2                      PIC XX.
  1458         16  AM-FLD-3                      PIC XX.
  1459         16  AM-FLD-4                      PIC XX.
  1460         16  AM-FLD-5                      PIC XX.
  1461
  1462     12  AM-1ST-PROD-DATE.
  1463         16  AM-1ST-PROD-YR                PIC XX.
  1464         16  AM-1ST-PROD-MO                PIC XX.
  1465         16  AM-1ST-PROD-DA                PIC XX.
  1466     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1467     12  AM-CERTS-PURGED-DATE.
  1468         16  AM-PUR-YR                     PIC XX.
  1469         16  AM-PUR-MO                     PIC XX.
  1470         16  AM-PUR-DA                     PIC XX.
  1471     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1472     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1473     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1474     12  AM-INACTIVE-DATE.
  1475         16  AM-INA-MO                     PIC 99.
  1476         16  AM-INA-DA                     PIC 99.
  1477         16  AM-INA-YR                     PIC 99.
  1478     12  AM-AR-HI-CERT-DATE                PIC XX.
  1479
  1480     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1481     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1482
  1483     12  AM-OB-PAYMENT-MODE                PIC X.
  1484         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1485         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1486         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6311.cbl
  1487         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1488
  1489     12  AM-AH-ONLY-INDICATOR              PIC X.
  1490         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1491         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1492
  1493     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1494
  1495     12  AM-OVER-SHORT.
  1496         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1497         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1498
  1499     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1500     12  AM-DCC-CLP-STATE                  PIC XX.
  1501
  1502     12  AM-RECALC-COMM                    PIC X.
  1503     12  AM-RECALC-REIN                    PIC X.
  1504
  1505     12  AM-REI-TABLE                      PIC XXX.
  1506     12  AM-REI-ET-LF                      PIC X.
  1507     12  AM-REI-ET-AH                      PIC X.
  1508     12  AM-REI-PE-LF                      PIC X.
  1509     12  AM-REI-PE-AH                      PIC X.
  1510     12  AM-REI-PRT-ST                     PIC X.
  1511     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1512     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1513     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1514     12  AM-REI-GROUP-A                    PIC X(6).
  1515     12  AM-REI-MORT                       PIC X(4).
  1516     12  AM-REI-PRT-OW                     PIC X.
  1517     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1518     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1519     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1520     12  AM-REI-GROUP-B                    PIC X(6).
  1521
  1522     12  AM-TRUST-TYPE                     PIC X(2).
  1523
  1524     12  AM-EMPLOYER-STMT-USED             PIC X.
  1525     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1526
  1527     12  AM-STD-AH-TYPE                    PIC XX.
  1528     12  AM-EARN-METHODS.
  1529         16  AM-EARN-METHOD-R              PIC X.
  1530             88 AM-REF-RL-R78                 VALUE 'R'.
  1531             88 AM-REF-RL-PR                  VALUE 'P'.
  1532             88 AM-REF-RL-MEAN                VALUE 'M'.
  1533             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1534         16  AM-EARN-METHOD-L              PIC X.
  1535             88 AM-REF-LL-R78                 VALUE 'R'.
  1536             88 AM-REF-LL-PR                  VALUE 'P'.
  1537             88 AM-REF-LL-MEAN                VALUE 'M'.
  1538             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1539         16  AM-EARN-METHOD-A              PIC X.
  1540             88 AM-REF-AH-R78                 VALUE 'R'.
  1541             88 AM-REF-AH-PR                  VALUE 'P'.
  1542             88 AM-REF-AH-MEAN                VALUE 'M'.
  1543             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1544             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6311.cbl
  1545             88 AM-REF-AH-NET                 VALUE 'N'.
  1546
  1547     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1548     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1549     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1550
  1551     12  AM-RET-Y-N                        PIC X.
  1552     12  AM-RET-P-E                        PIC X.
  1553     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1554     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1555     12  AM-RET-GRP                        PIC X(6).
  1556     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1557         16  AM-POOL-PRIME                 PIC XXX.
  1558         16  AM-POOL-SUB                   PIC XXX.
  1559     12  AM-RETRO-EARNINGS.
  1560         16  AM-RET-EARN-R                 PIC X.
  1561         16  AM-RET-EARN-L                 PIC X.
  1562         16  AM-RET-EARN-A                 PIC X.
  1563     12  AM-RET-ST-TAX-USE                 PIC X.
  1564         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1565         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1566     12  AM-RETRO-BEG-EARNINGS.
  1567         16  AM-RET-BEG-EARN-R             PIC X.
  1568         16  AM-RET-BEG-EARN-L             PIC X.
  1569         16  AM-RET-BEG-EARN-A             PIC X.
  1570     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1571     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1572
  1573     12  AM-USER-SELECT-OPTIONS.
  1574         16  AM-USER-SELECT-1              PIC X(10).
  1575         16  AM-USER-SELECT-2              PIC X(10).
  1576         16  AM-USER-SELECT-3              PIC X(10).
  1577         16  AM-USER-SELECT-4              PIC X(10).
  1578         16  AM-USER-SELECT-5              PIC X(10).
  1579
  1580     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1581
  1582     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1583
  1584     12  AM-RPT045A-SWITCH                 PIC X.
  1585         88  RPT045A-OFF                   VALUE 'N'.
  1586
  1587     12  AM-INSURANCE-LIMITS.
  1588         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1589         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1590
  1591     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1592         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1593
  1594     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1595         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1596         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1597
  1598     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1599
  1600     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1601     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1602     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6311.cbl
  1603     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1604     12  AM-DCC-UEF-STATE                  PIC XX.
  1605     12  FILLER                            PIC XXX.
  1606     12  AM-REPORT-CODE-3                  PIC X(10).
  1607*    12  FILLER                            PIC X(22).
  1608
  1609     12  AM-RESERVE-DATE.
  1610         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1611         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1612         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1613
  1614     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1615     12  AM-NOTIFICATION-TYPES.
  1616         16  AM-NOTIF-OF-LETTERS           PIC X.
  1617         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1618         16  AM-NOTIF-OF-REPORTS           PIC X.
  1619         16  AM-NOTIF-OF-STATUS            PIC X.
  1620
  1621     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1622         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1623         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1624         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1625         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1626
  1627     12  AM-BENEFIT-CONTROLS.
  1628         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1629             20  AM-BENEFIT-CODE           PIC XX.
  1630             20  AM-BENEFIT-TYPE           PIC X.
  1631             20  AM-BENEFIT-REVISION       PIC XXX.
  1632             20  AM-BENEFIT-REM-TERM       PIC X.
  1633             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1634             20  FILLER                    PIC XX.
  1635         16  FILLER                        PIC X(80).
  1636
  1637     12  AM-TRANSFER-DATA.
  1638         16  AM-TRANSFERRED-FROM.
  1639             20  AM-TRNFROM-CARRIER        PIC X.
  1640             20  AM-TRNFROM-GROUPING.
  1641                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1642                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1643             20  AM-TRNFROM-STATE          PIC XX.
  1644             20  AM-TRNFROM-ACCOUNT.
  1645                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1646                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1647             20  AM-TRNFROM-DTE            PIC XX.
  1648         16  AM-TRANSFERRED-TO.
  1649             20  AM-TRNTO-CARRIER          PIC X.
  1650             20  AM-TRNTO-GROUPING.
  1651                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1652                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1653             20  AM-TRNTO-STATE            PIC XX.
  1654             20  AM-TRNTO-ACCOUNT.
  1655                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1656                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1657             20  AM-TRNTO-DTE              PIC XX.
  1658         16  FILLER                        PIC X(10).
  1659
  1660     12  AM-SAVED-REMIT-TO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6311.cbl
  1661
  1662     12  AM-COMM-STRUCTURE-SAVED.
  1663         16  AM-DEFN-1-SAVED.
  1664             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1665                 24  AM-AGT-SV             PIC X(10).
  1666                 24  AM-COM-TYP-SV         PIC X.
  1667                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1668                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1669                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1670                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1671                 24  FILLER                PIC X.
  1672                 24  AM-GL-CODES-SV        PIC X.
  1673                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1674                 24  FILLER                PIC X.
  1675         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1676             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1677                 24  FILLER                PIC X(11).
  1678                 24  AM-L-COMA-SV          PIC XXX.
  1679                 24  AM-J-COMA-SV          PIC XXX.
  1680                 24  AM-A-COMA-SV          PIC XXX.
  1681                 24  FILLER                PIC X(6).
  1682
  1683     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1684         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1685            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1686            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1687            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1688
  1689     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1690     12  FILLER                            PIC X(120).
  1691
  1692     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1693         16  AM-CONTROL-NAME               PIC X(30).
  1694         16  AM-EXECUTIVE-ONE.
  1695             20  AM-EXEC1-NAME             PIC X(15).
  1696             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1697                                                          COMP-3.
  1698             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1699                                                          COMP-3.
  1700         16  AM-EXECUTIVE-TWO.
  1701             20  AM-EXEC2-NAME             PIC X(15).
  1702             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1703                                                          COMP-3.
  1704             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1705                                                          COMP-3.
  1706
  1707     12  AM-RETRO-ADDITIONAL-DATA.
  1708         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1709         16  AM-RETRO-PREM-P-E             PIC X.
  1710         16  AM-RETRO-CLMS-P-I             PIC X.
  1711         16  AM-RETRO-RET-BRACKET-LF.
  1712             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1713                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1714                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1715             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1716                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1717                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1718             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6311.cbl
  1719                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1720                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1721         16  AM-RETRO-RET-BRACKET-AH.
  1722             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1723                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1724                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1725                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1726             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1727                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1728                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1729             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1730                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1731                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1732
  1733     12  AM-COMMENTS.
  1734         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1735
  1736     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1737         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1738         16  AM-FLI-BILLING-CODE           PIC X.
  1739         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1740         16  AM-FLI-UNITED-IDENT           PIC X.
  1741         16  AM-FLI-INTEREST-LOST-DATA.
  1742             20  AM-FLI-BANK-NO            PIC X(5).
  1743             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1744             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1745             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1746         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1747             20  AM-FLI-AGT                PIC X(9).
  1748             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1749             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1750         16  FILLER                        PIC X(102).
  1751
  1752     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1753         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1754             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1755             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1756             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1757             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1758             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1759         16  FILLER                          PIC X(10).
  1760******************************************************************
  1761*                                COPY ELCVADS.
  1762******************************************************************
  1763*                                                                *
  1764*                                                                *
  1765*                            ELCVADS.                            *
  1766*                                                                *
  1767*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1768*   ELVADS                  LENGTH = 350                         *
  1769******************************************************************
  1770******************************************************************
  1771*                   C H A N G E   L O G
  1772*
  1773* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1774*-----------------------------------------------------------------
  1775*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1776* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6311.cbl
  1777*-----------------------------------------------------------------
  1778* 100111    2011022800001  AJRA  NAPERSOFT
  1779******************************************************************
  1780
  1781 01  VIRGINIA-DISCLOSURE.
  1782     12  VD-COMPANY-CD              PIC X.
  1783     12  VD-CARRIER                 PIC X.
  1784     12  VD-GROUPING.
  1785         20  VD-GROUPING-PREFIX     PIC XXX.
  1786         20  VD-GROUPING-PRIME      PIC XXX.
  1787     12  VD-STATE                   PIC XX.
  1788     12  VD-ACCOUNT.
  1789         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1790         20  VD-ACCOUNT-PRIME       PIC X(6).
  1791     12  VD-CERT-EFF-DT             PIC XX.
  1792     12  VD-CERT-NO.
  1793         20  VD-CERT-PRIME          PIC X(10).
  1794         20  VD-CERT-SFX            PIC X.
  1795     12  VD-ENTRY-BATCH             PIC X(6).
  1796     12  VD-CSR-ID                  PIC X(4).
  1797     12  VD-NAME.
  1798         20  VD-INSURED-LAST-NAME   PIC X(15).
  1799         20  VD-INSURED-FIRST-NAME.
  1800             24  VD-INSURED-1ST-INIT PIC X.
  1801             24  FILLER             PIC X(9).
  1802         20  VD-INSURED-MIDDLE-INIT PIC X.
  1803     12  VD-JOINT-INSURED.
  1804         20 VD-JOINT-LAST-NAME      PIC X(15).
  1805         20 VD-JOINT-FIRST-NAME.
  1806            24  VD-JOINT-FIRST-INIT PIC X.
  1807            24  FILLER              PIC X(9).
  1808         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1809     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1810     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1811     12  VD-INSURED-CITY-STATE.
  1812         20  VD-INSURED-CITY        PIC X(28).
  1813         20  VD-INSURED-STATE       PIC XX.
  1814     12  VD-INSURED-ZIP-CODE.
  1815         20  VD-INSURED-ZIP-PRIME.
  1816             24  VD-INSURED-ZIP-1   PIC X.
  1817                 88  VD-CANADIAN-POST-CODE
  1818                                       VALUE 'A' THRU 'Z'.
  1819             24  FILLER             PIC X(4).
  1820         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1821     12  VD-BENEFICIARY-NAME        PIC X(30).
  1822     12  VD-ACCOUNT-NAME            PIC X(30).
  1823     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1824     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1825     12  VD-1ST-PMT-DT              PIC XX.
  1826     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1827         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1828         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1829                                             '90' THRU '99'.
  1830     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1831                                    PIC XX.
  1832     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1833     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1834     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6311.cbl
  1835     12  VD-LF-TERM                 PIC S999   COMP-3.
  1836     12  VD-AH-BENEFIT-CD           PIC XX.
  1837         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1838         88  VD-INVALID-AH             VALUE '  ' '00'
  1839                                             '90' THRU '99'.
  1840     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1841     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1842     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1843     12  VD-AH-TERM                 PIC S999   COMP-3.
  1844     12  VD-LETTER-ID               PIC X(4).
  1845     12  VD-PROC-ID                 PIC X(4).
  1846     12  VD-COMP-ID                 PIC X(3).
  1847     12  VD-CURRENT-DATE            PIC XX.
  1848     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1849     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1850     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6311.cbl
  1852*    COPY ELCDATE.
  1853******************************************************************
  1854*                                                                *
  1855*                                                                *
  1856*                            ELCDATE.                            *
  1857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1858*                            VMOD=2.003
  1859*                                                                *
  1860*                                                                *
  1861*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1862*                 LENGTH = 200                                   *
  1863******************************************************************
  1864
  1865 01  DATE-CONVERSION-DATA.
  1866     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1867     12  DC-OPTION-CODE                PIC X.
  1868         88  BIN-TO-GREG                VALUE ' '.
  1869         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1870         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1871         88  YMD-GREG-TO-BIN            VALUE '3'.
  1872         88  MDY-GREG-TO-BIN            VALUE '4'.
  1873         88  JULIAN-TO-BIN              VALUE '5'.
  1874         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1875         88  FIND-CENTURY               VALUE '7'.
  1876         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1877         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1878         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1879         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1880         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1881         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1882         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1883         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1884         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1885         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1886         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1887         88  BIN-3-TO-GREG              VALUE 'I'.
  1888         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1889         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1890         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1891         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1892         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1893         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1894         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1895         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1896         88  THREE-CHARACTER-BIN
  1897                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1898         88  GREGORIAN-TO-BIN
  1899                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1900         88  BIN-TO-GREGORIAN
  1901                  VALUES ' ' '1' 'I' '8' 'G'.
  1902         88  JULIAN-TO-BINARY
  1903                  VALUES '5' 'C' 'E' 'F'.
  1904     12  DC-ERROR-CODE                 PIC X.
  1905         88  NO-CONVERSION-ERROR        VALUE ' '.
  1906         88  DATE-CONVERSION-ERROR
  1907                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1908         88  DATE-IS-ZERO               VALUE '1'.
  1909         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6311.cbl
  1910         88  DATE-IS-INVALID            VALUE '3'.
  1911         88  DATE1-GREATER-DATE2        VALUE '4'.
  1912         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1913         88  DATE-INVALID-OPTION        VALUE '9'.
  1914         88  INVALID-CENTURY            VALUE 'A'.
  1915         88  ONLY-CENTURY               VALUE 'B'.
  1916         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1917         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1918     12  DC-END-OF-MONTH               PIC X.
  1919         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1920     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1921         88  USE-NORMAL-PROCESS         VALUE ' '.
  1922         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1923         88  ADJUST-UP-100-YRS          VALUE '2'.
  1924     12  FILLER                        PIC X.
  1925     12  DC-CONVERSION-DATES.
  1926         16  DC-BIN-DATE-1             PIC XX.
  1927         16  DC-BIN-DATE-2             PIC XX.
  1928         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1929         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1930                       DC-GREG-DATE-1-EDIT.
  1931             20  DC-EDIT1-MONTH        PIC 99.
  1932             20  SLASH1-1              PIC X.
  1933             20  DC-EDIT1-DAY          PIC 99.
  1934             20  SLASH1-2              PIC X.
  1935             20  DC-EDIT1-YEAR         PIC 99.
  1936         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1937         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1938                     DC-GREG-DATE-2-EDIT.
  1939             20  DC-EDIT2-MONTH        PIC 99.
  1940             20  SLASH2-1              PIC X.
  1941             20  DC-EDIT2-DAY          PIC 99.
  1942             20  SLASH2-2              PIC X.
  1943             20  DC-EDIT2-YEAR         PIC 99.
  1944         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1945         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1946                     DC-GREG-DATE-1-YMD.
  1947             20  DC-YMD-YEAR           PIC 99.
  1948             20  DC-YMD-MONTH          PIC 99.
  1949             20  DC-YMD-DAY            PIC 99.
  1950         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1951         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1952                      DC-GREG-DATE-1-MDY.
  1953             20  DC-MDY-MONTH          PIC 99.
  1954             20  DC-MDY-DAY            PIC 99.
  1955             20  DC-MDY-YEAR           PIC 99.
  1956         16  DC-GREG-DATE-1-ALPHA.
  1957             20  DC-ALPHA-MONTH        PIC X(10).
  1958             20  DC-ALPHA-DAY          PIC 99.
  1959             20  FILLER                PIC XX.
  1960             20  DC-ALPHA-CENTURY.
  1961                 24 DC-ALPHA-CEN-N     PIC 99.
  1962             20  DC-ALPHA-YEAR         PIC 99.
  1963         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1964         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1965         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1966         16  DC-JULIAN-DATE            PIC 9(05).
  1967         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6311.cbl
  1968                                       PIC 9(05).
  1969         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1970             20  DC-JULIAN-YEAR        PIC 99.
  1971             20  DC-JULIAN-DAYS        PIC 999.
  1972         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1973         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1974         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1975     12  DATE-CONVERSION-VARIBLES.
  1976         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1977         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1978             20  FILLER                PIC 9(3).
  1979             20  HOLD-CEN-1-CCYY.
  1980                 24  HOLD-CEN-1-CC     PIC 99.
  1981                 24  HOLD-CEN-1-YY     PIC 99.
  1982             20  HOLD-CEN-1-MO         PIC 99.
  1983             20  HOLD-CEN-1-DA         PIC 99.
  1984         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1985             20  HOLD-CEN-1-R-MO       PIC 99.
  1986             20  HOLD-CEN-1-R-DA       PIC 99.
  1987             20  HOLD-CEN-1-R-CCYY.
  1988                 24  HOLD-CEN-1-R-CC   PIC 99.
  1989                 24  HOLD-CEN-1-R-YY   PIC 99.
  1990             20  FILLER                PIC 9(3).
  1991         16  HOLD-CENTURY-1-X.
  1992             20  FILLER                PIC X(3)  VALUE SPACES.
  1993             20  HOLD-CEN-1-X-CCYY.
  1994                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1995                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1996             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1997             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1998         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1999             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2000             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2001             20  HOLD-CEN-1-R-X-CCYY.
  2002                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2003                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2004             20  FILLER                PIC XXX.
  2005         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2006         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2007         16  DC-JULIAN-DATE-1          PIC 9(07).
  2008         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2009             20  DC-JULIAN-1-CCYY.
  2010                 24  DC-JULIAN-1-CC    PIC 99.
  2011                 24  DC-JULIAN-1-YR    PIC 99.
  2012             20  DC-JULIAN-DA-1        PIC 999.
  2013         16  DC-JULIAN-DATE-2          PIC 9(07).
  2014         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2015             20  DC-JULIAN-2-CCYY.
  2016                 24  DC-JULIAN-2-CC    PIC 99.
  2017                 24  DC-JULIAN-2-YR    PIC 99.
  2018             20  DC-JULIAN-DA-2        PIC 999.
  2019         16  DC-GREG-DATE-A-EDIT.
  2020             20  DC-EDITA-MONTH        PIC 99.
  2021             20  SLASHA-1              PIC X VALUE '/'.
  2022             20  DC-EDITA-DAY          PIC 99.
  2023             20  SLASHA-2              PIC X VALUE '/'.
  2024             20  DC-EDITA-CCYY.
  2025                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6311.cbl
  2026                 24  DC-EDITA-YEAR     PIC 99.
  2027         16  DC-GREG-DATE-B-EDIT.
  2028             20  DC-EDITB-MONTH        PIC 99.
  2029             20  SLASHB-1              PIC X VALUE '/'.
  2030             20  DC-EDITB-DAY          PIC 99.
  2031             20  SLASHB-2              PIC X VALUE '/'.
  2032             20  DC-EDITB-CCYY.
  2033                 24  DC-EDITB-CENT     PIC 99.
  2034                 24  DC-EDITB-YEAR     PIC 99.
  2035         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2036         16  DC-GREG-DATE-CYMD-R REDEFINES
  2037                              DC-GREG-DATE-CYMD.
  2038             20  DC-CYMD-CEN           PIC 99.
  2039             20  DC-CYMD-YEAR          PIC 99.
  2040             20  DC-CYMD-MONTH         PIC 99.
  2041             20  DC-CYMD-DAY           PIC 99.
  2042         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2043         16  DC-GREG-DATE-MDCY-R REDEFINES
  2044                              DC-GREG-DATE-MDCY.
  2045             20  DC-MDCY-MONTH         PIC 99.
  2046             20  DC-MDCY-DAY           PIC 99.
  2047             20  DC-MDCY-CEN           PIC 99.
  2048             20  DC-MDCY-YEAR          PIC 99.
  2049    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2050        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2051    12  DC-EL310-DATE                  PIC X(21).
  2052    12  FILLER                         PIC X(28).
  2053
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6311.cbl
  2055*    COPY ELCLOGOF.
  2056******************************************************************
  2057*                                                                *
  2058*                                                                *
  2059*                            ELCLOGOF.                           *
  2060*                            VMOD=2.001                          *
  2061*                                                                *
  2062*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2063*                                                                *
  2064******************************************************************
  2065 01  CLASIC-LOGOFF.
  2066     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2067     12  LOGOFF-TEXT.
  2068         16  FILLER          PIC X(5)    VALUE SPACES.
  2069         16  LOGOFF-MSG.
  2070             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2071             20  FILLER      PIC X       VALUE SPACES.
  2072             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2073         16  FILLER          PIC X(80)
  2074           VALUE '* YOU ARE NOW LOGGED OFF'.
  2075         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2076         16  FILLER          PIC X       VALUE QUOTE.
  2077         16  LOGOFF-SYS-MSG  PIC X(17)
  2078           VALUE 'S CLAS-IC SYSTEM '.
  2079     12  TEXT-MESSAGES.
  2080         16  UNACCESS-MSG    PIC X(29)
  2081             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2082         16  PGMIDERR-MSG    PIC X(17)
  2083             VALUE 'PROGRAM NOT FOUND'.
  2084
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6311.cbl
  2086*    COPY ELCATTR.
  2087******************************************************************
  2088*                                                                *
  2089*                            ELCATTR.                            *
  2090*                            VMOD=2.001                          *
  2091*                                                                *
  2092*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2093*                                                                *
  2094*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2095*                                                                *
  2096*                   POS 1   P=PROTECTED                          *
  2097*                           U=UNPROTECTED                        *
  2098*                           S=ASKIP                              *
  2099*                   POS 2   A=ALPHA/NUMERIC                      *
  2100*                           N=NUMERIC                            *
  2101*                   POS 3   N=NORMAL                             *
  2102*                           B=BRIGHT                             *
  2103*                           D=DARK                               *
  2104*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2105*                           OF=MODIFIED DATA TAG OFF             *
  2106*                                                                *
  2107*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2108******************************************************************
  2109 01  ATTRIBUTE-LIST.
  2110     12  AL-PABOF            PIC X       VALUE 'Y'.
  2111     12  AL-PABON            PIC X       VALUE 'Z'.
  2112     12  AL-PADOF            PIC X       VALUE '%'.
  2113     12  AL-PADON            PIC X       VALUE '_'.
  2114     12  AL-PANOF            PIC X       VALUE '-'.
  2115     12  AL-PANON            PIC X       VALUE '/'.
  2116     12  AL-SABOF            PIC X       VALUE '8'.
  2117     12  AL-SABON            PIC X       VALUE '9'.
  2118     12  AL-SADOF            PIC X       VALUE '@'.
  2119     12  AL-SADON            PIC X       VALUE QUOTE.
  2120     12  AL-SANOF            PIC X       VALUE '0'.
  2121     12  AL-SANON            PIC X       VALUE '1'.
  2122     12  AL-UABOF            PIC X       VALUE 'H'.
  2123     12  AL-UABON            PIC X       VALUE 'I'.
  2124     12  AL-UADOF            PIC X       VALUE '<'.
  2125     12  AL-UADON            PIC X       VALUE '('.
  2126     12  AL-UANOF            PIC X       VALUE ' '.
  2127     12  AL-UANON            PIC X       VALUE 'A'.
  2128     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2129     12  AL-UNBON            PIC X       VALUE 'R'.
  2130     12  AL-UNDOF            PIC X       VALUE '*'.
  2131     12  AL-UNDON            PIC X       VALUE ')'.
  2132     12  AL-UNNOF            PIC X       VALUE '&'.
  2133     12  AL-UNNON            PIC X       VALUE 'J'.
  2134
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6311.cbl
  2136*    COPY ELCEMIB.
  2137******************************************************************
  2138*                                                                *
  2139*                                                                *
  2140*                            ELCEMIB.                            *
  2141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2142*                            VMOD=2.005                          *
  2143*                                                                *
  2144*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2145*                                                                *
  2146******************************************************************
  2147 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2148     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2149     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2150     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2151     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2152     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2153     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2154     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2155     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2156     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2157         88  EMI-NO-ERRORS                    VALUE '1'.
  2158         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2159         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2160     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2161         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2162     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2163         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2164         88  EMI-AREA1-FULL                   VALUE '2'.
  2165     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2166         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2167         88  EMI-AREA2-FULL                   VALUE '2'.
  2168     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2169         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2170         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2171         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2172         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2173         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2174     12  EMI-ERROR-LINES.
  2175         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2176         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2177         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2178         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2179             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2180                 24  EMI-ERR-NUM         PIC X(4).
  2181                 24  EMI-FILLER          PIC X.
  2182                 24  EMI-SEV             PIC X.
  2183                 24  FILLER              PIC X.
  2184             20  FILLER                  PIC X(02).
  2185     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2186         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2187             20  EMI-ERROR-NUMBER    PIC X(4).
  2188             20  EMI-FILL            PIC X.
  2189             20  EMI-SEVERITY        PIC X.
  2190             20  FILLER              PIC X.
  2191             20  EMI-ERROR-TEXT.
  2192                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2193                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6311.cbl
  2194     12  EMI-SEVERITY-SAVE           PIC X.
  2195         88  EMI-NOTE                    VALUE 'N'.
  2196         88  EMI-WARNING                 VALUE 'W'.
  2197         88  EMI-FORCABLE                VALUE 'F'.
  2198         88  EMI-FATAL                   VALUE 'X'.
  2199     12  EMI-MESSAGE-FLAG            PIC X.
  2200         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2201         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2202     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2203     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2204         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2205         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2206         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2207     12  FILLER                      PIC X(137)  VALUE SPACES.
  2208     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2209     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2210     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2211     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2212
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6311.cbl
  2214*    COPY ELCINTF.
  2215******************************************************************
  2216*                                                                *
  2217*                                                                *
  2218*                            ELCINTF.                            *
  2219*                            VMOD=2.017                          *
  2220*                                                                *
  2221*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2222*                                                                *
  2223*       LENGTH = 1024                                            *
  2224*                                                                *
  2225******************************************************************
  2226*                   C H A N G E   L O G
  2227*
  2228* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2229*-----------------------------------------------------------------
  2230*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2231* EFFECTIVE    NUMBER
  2232*-----------------------------------------------------------------
  2233* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2234******************************************************************
  2235 01  PROGRAM-INTERFACE-BLOCK.
  2236     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2237     12  PI-CALLING-PROGRAM              PIC X(8).
  2238     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2239     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2240     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2241     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2242     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2243     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2244     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2245     12  PI-COMPANY-ID                   PIC XXX.
  2246     12  PI-COMPANY-CD                   PIC X.
  2247
  2248     12  PI-COMPANY-PASSWORD             PIC X(8).
  2249
  2250     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2251
  2252     12  PI-CONTROL-IN-PROGRESS.
  2253         16  PI-CARRIER                  PIC X.
  2254         16  PI-GROUPING                 PIC X(6).
  2255         16  PI-STATE                    PIC XX.
  2256         16  PI-ACCOUNT                  PIC X(10).
  2257         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2258                                         PIC X(10).
  2259         16  PI-CLAIM-CERT-GRP.
  2260             20  PI-CLAIM-NO             PIC X(7).
  2261             20  PI-CERT-NO.
  2262                 25  PI-CERT-PRIME       PIC X(10).
  2263                 25  PI-CERT-SFX         PIC X.
  2264             20  PI-CERT-EFF-DT          PIC XX.
  2265         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2266             20  PI-PLAN-CODE            PIC X(2).
  2267             20  PI-REVISION-NUMBER      PIC X(3).
  2268             20  PI-PLAN-EFF-DT          PIC X(2).
  2269             20  PI-PLAN-EXP-DT          PIC X(2).
  2270             20  FILLER                  PIC X(11).
  2271         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6311.cbl
  2272             20  PI-OE-REFERENCE-1.
  2273                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2274                 25  PI-OE-REF-1-SUFF    PIC XX.
  2275
  2276     12  PI-SESSION-IN-PROGRESS          PIC X.
  2277         88  CLAIM-SESSION                   VALUE '1'.
  2278         88  CREDIT-SESSION                  VALUE '2'.
  2279         88  WARRANTY-SESSION                VALUE '3'.
  2280         88  MORTGAGE-SESSION                VALUE '4'.
  2281         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2282
  2283
  2284*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2285
  2286     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2287     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2288
  2289     12  PI-CREDIT-USER                  PIC X.
  2290         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2291         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2292
  2293     12  PI-CLAIM-USER                   PIC X.
  2294         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2295         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2296
  2297     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2298         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2299         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2300         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2301         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2302         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2303
  2304     12  PI-PROCESSOR-ID                 PIC X(4).
  2305
  2306     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2307
  2308     12  PI-MEMBER-CAPTION               PIC X(10).
  2309
  2310     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2311         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2312
  2313     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2314     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2315     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2316     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2317
  2318     12  PI-AH-OVERRIDE-L1               PIC X.
  2319     12  PI-AH-OVERRIDE-L2               PIC XX.
  2320     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2321     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2322
  2323     12  PI-NEW-SYSTEM                   PIC X(2).
  2324
  2325     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2326     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2327         88  PI-USES-PAID-TO                 VALUE '1'.
  2328     12  PI-CRDTCRD-SYSTEM.
  2329         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6311.cbl
  2330             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2331             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2332         16  PI-CC-MONTH-END-DT          PIC XX.
  2333     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2334
  2335     12  PI-OE-REFERENCE-2.
  2336         16  PI-OE-REF-2-PRIME           PIC X(10).
  2337         16  PI-OE-REF-2-SUFF            PIC X.
  2338
  2339     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2340
  2341     12  PI-LANGUAGE-TYPE                PIC X.
  2342             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2343             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2344             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2345
  2346     12  PI-POLICY-LINKAGE-IND           PIC X.
  2347         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2348         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2349                                                   LOW-VALUES.
  2350
  2351     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2352     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2353         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2354         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2355
  2356     12  PI-PROCESSOR-CSR-IND            PIC X.
  2357         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2358         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2359
  2360     12  FILLER                          PIC X(3).
  2361
  2362     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2363
  2364     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2365         PI-SYSTEM-LEVEL.
  2366
  2367         16  PI-ENTRY-CODES.
  2368             20  PI-ENTRY-CD-1           PIC X.
  2369             20  PI-ENTRY-CD-2           PIC X.
  2370
  2371         16  PI-RETURN-CODES.
  2372             20  PI-RETURN-CD-1          PIC X.
  2373             20  PI-RETURN-CD-2          PIC X.
  2374
  2375         16  PI-UPDATE-STATUS-SAVE.
  2376             20  PI-UPDATE-BY            PIC X(4).
  2377             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2378
  2379         16  PI-LOWER-CASE-LETTERS       PIC X.
  2380             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2381
  2382*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2383*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2384*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2385
  2386         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2387             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6311.cbl
  2388             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2389             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2390             88  ACCNT-CNTL                  VALUE '3'.
  2391             88  CARR-ACCNT-CNTL             VALUE '4'.
  2392
  2393         16  PI-PROCESSOR-CAP-LIST.
  2394             20  PI-SYSTEM-CONTROLS.
  2395                24 PI-SYSTEM-DISPLAY     PIC X.
  2396                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2397                24 PI-SYSTEM-MODIFY      PIC X.
  2398                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2399             20  FILLER                  PIC XX.
  2400             20  PI-DISPLAY-CAP          PIC X.
  2401                 88  DISPLAY-CAP             VALUE 'Y'.
  2402             20  PI-MODIFY-CAP           PIC X.
  2403                 88  MODIFY-CAP              VALUE 'Y'.
  2404             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2405                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2406             20  PI-FORCE-CAP            PIC X.
  2407                 88  FORCE-CAP               VALUE 'Y'.
  2408
  2409         16  PI-PROGRAM-CONTROLS.
  2410             20  PI-PGM-PRINT-OPT        PIC X.
  2411             20  PI-PGM-FORMAT-OPT       PIC X.
  2412             20  PI-PGM-PROCESS-OPT      PIC X.
  2413             20  PI-PGM-TOTALS-OPT       PIC X.
  2414
  2415         16  PI-HELP-INTERFACE.
  2416             20  PI-LAST-ERROR-NO        PIC X(4).
  2417             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2418
  2419         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2420             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2421
  2422         16  PI-CR-CONTROL-IN-PROGRESS.
  2423             20  PI-CR-CARRIER           PIC X.
  2424             20  PI-CR-GROUPING          PIC X(6).
  2425             20  PI-CR-STATE             PIC XX.
  2426             20  PI-CR-ACCOUNT           PIC X(10).
  2427             20  PI-CR-FIN-RESP          PIC X(10).
  2428             20  PI-CR-TYPE              PIC X.
  2429
  2430         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2431
  2432         16  PI-CR-MONTH-END-DT          PIC XX.
  2433
  2434         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2435             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2436             88  PI-ZERO-CARRIER             VALUE '1'.
  2437             88  PI-ZERO-GROUPING            VALUE '2'.
  2438             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2439
  2440         16  PI-CARRIER-SECURITY         PIC X.
  2441             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2442
  2443         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2444             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2445             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6311.cbl
  2446
  2447         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2448             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2449                                         INDEXED BY PI-ACCESS-NDX
  2450                                         PIC X.
  2451
  2452         16  PI-GA-BILLING-CONTROL       PIC X.
  2453             88  PI-GA-BILLING               VALUE '1'.
  2454
  2455         16  PI-MAIL-PROCESSING          PIC X.
  2456             88  PI-MAIL-YES                 VALUE 'Y'.
  2457
  2458         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2459
  2460         16  PI-AR-SYSTEM.
  2461             20  PI-AR-PROCESSING-CNTL   PIC X.
  2462                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2463             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2464             20  PI-AR-MONTH-END-DT      PIC XX.
  2465
  2466         16  PI-MP-SYSTEM.
  2467             20  PI-MORTGAGE-USER            PIC X.
  2468                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2469                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2470             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2471                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2472                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2473                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2474                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2475                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2476             20  PI-MP-MONTH-END-DT          PIC XX.
  2477             20  PI-MP-REFERENCE-NO.
  2478                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2479                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2480
  2481         16  PI-LABEL-CONTROL            PIC X(01).
  2482             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2483             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2484
  2485         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2486             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2487
  2488         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2489             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2490             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2491
  2492         16  FILLER                      PIC X(14).
  2493
  2494     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2495******************************************************************
  2496
  2497     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2498*    COPY ELC631PI.
  2499******************************************************************
  2500*                                                                *
  2501*                                                                *
  2502*                            ELC631PI                            *
  2503*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6311.cbl
  2504*                                                                *
  2505*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2506*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2507*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2508*                                                                *
  2509*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2510*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2511*    BETWEEN PROGRAMS.                                           *
  2512*                                                                *
  2513*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2514*                                                                *
  2515*               EL631 - EL6311 - EL6312 - EL6313                 *
  2516*                                                                *
  2517******************************************************************
  2518
  2519         16  PI-631-DATA.
  2520             20  PI-ERPNDB-KEY.
  2521                 24  PI-PB-COMPANY-CD     PIC X.
  2522                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2523                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2524                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2525
  2526             20  PI-ERPNDB-ALT-KEY.
  2527                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2528                 24  PI-PB-CARRIER        PIC X.
  2529                 24  PI-PB-GROUPING       PIC X(6).
  2530                 24  PI-PB-STATE          PIC XX.
  2531                 24  PI-PB-ACCOUNT        PIC X(10).
  2532                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2533                 24  PI-PB-CERT-NO.
  2534                     28  PI-PB-CERT-PRIME PIC X(10).
  2535                     28  PI-PB-CERT-SFX   PIC X.
  2536                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2537                 24  PI-PB-RECORD-TYPE    PIC X.
  2538
  2539             20  PI-ERPNDB-CSR-KEY.
  2540                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2541                 24  PI-PB-CSR-ID             PIC X(4).
  2542                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2543                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2544                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2545
  2546             20  PI-BROWSE-TYPE               PIC X.
  2547                 88  PI-FILE-BROWSE             VALUE ' '.
  2548                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2549                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2550                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2551                 88  PI-CSR-BROWSE              VALUE '4'.
  2552
  2553             20  PI-MAINT-FUNCTION            PIC X.
  2554                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2555                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2556                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2557                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2558                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2559                 88  PI-PF5-FUNCTION            VALUE '5'.
  2560                 88  PI-PF6-FUNCTION            VALUE '6'.
  2561
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6311.cbl
  2562             20  PI-FILE-SWITCHES.
  2563                 24  PI-ALL-ISSUES-SW         PIC X.
  2564                     88  ALL-ISSUES             VALUE 'Y'.
  2565                 24  PI-ALL-CANCELS-SW        PIC X.
  2566                     88  ALL-CANCELS            VALUE 'Y'.
  2567                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2568                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2569                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2570                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2571                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2572                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2573                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2574                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2575                 24  PI-HOLD-REC-SW           PIC X.
  2576                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2577                 24  PI-CHANGE-REC-SW         PIC X.
  2578                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2579                 24  PI-CHK-REQ-REC-SW        PIC X.
  2580                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2581                 24  PI-ISSUE-WARNING-SW      PIC X.
  2582                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2583                 24  PI-CANCEL-WARNING-SW     PIC X.
  2584                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2585             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2586                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2587             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2588                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2589
  2590             20  PI-MAP-NAME                  PIC X(8).
  2591
  2592             20  PI-CURSOR                    PIC S9(4) COMP.
  2593
  2594             20  PI-PREV-ALT-KEY              PIC X(36).
  2595             20  PI-PREV-CSR-KEY              PIC X(15).
  2596             20  PI-PREV-KEY.
  2597                 24  PI-PREV-COMPANY-CD       PIC X.
  2598                 24  PI-PREV-BATCH            PIC X(6).
  2599                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2600                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2601             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2602             20  PI-BROWSE-SW                 PIC X.
  2603                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2604                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2605             20  PI-SV-CARRIER                PIC X.
  2606             20  PI-SV-GROUPING               PIC X(6).
  2607             20  PI-SV-STATE                  PIC XX.
  2608             20  PI-EDIT-SW                   PIC X.
  2609             20  PI-DISPLAY-SW                PIC XX.
  2610                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  2611                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2612             20  PI-CRITERIA-DATA             PIC X(350).
  2613             20  PI-BMODE                     PIC X.
  2614             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2615             20  PI-BPMTS                     PIC S999     COMP-3.
  2616             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2617             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2618             20  PI-CSR-SESSION-SW            PIC X.
  2619                 88  CSR-EDIT-SESSION           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6311.cbl
  2620             20  PI-ERRORS-SW                 PIC X.
  2621                 88  FATAL-ERRORS               VALUE 'X'.
  2622*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2623             20  FILLER                       PIC X(5).
  2624
  2625        16  FILLER             PIC X(94).
  2626
  2627 01  W-LETTER-COMMUNICATION-AREAS.
  2628*    COPY ELC1042.
  2629******************************************************************
  2630*                                                                *
  2631*                                                                *
  2632*                           ELC1042                              *
  2633*                            VMOD=2.002                          *
  2634*                                                                *
  2635*    NOTE                                                        *
  2636*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2637*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2638*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2639*        TO THESE PROGRAMS.                                      *
  2640*                                                                *
  2641*    NOTE                                                        *
  2642*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2643*        USE ONLY!                                               *
  2644*                                                                *
  2645******************************************************************
  2646
  2647         16  PI-1042-WA.
  2648             20  PI-ACTION       PIC  X(01).
  2649                 88 PI-SHOW-MODE           VALUE '1'.
  2650                 88 PI-CLEAR-MODE          VALUE '2'.
  2651                 88 PI-CREATE-MODE         VALUE '3'.
  2652             20  PI-COMM-CONTROL PIC  X(12).
  2653             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2654             20  PI-EOF-SW       PIC  X(01).
  2655                 88  PI-FILE-EOF           VALUE 'Y'.
  2656             20  PI-FILETYP      PIC  X(01).
  2657             20  PI-FORM-SQUEEZE-CONTROL
  2658                                 PIC  X(01).
  2659                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2660                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2661             20  PI-LAST-CONTROL PIC  X(12).
  2662             20  PI-TEMP-STOR-ITEMS
  2663                                 PIC S9(04) COMP.
  2664             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2665             20  PI-UPDATE-SW    PIC  9(01).
  2666                 88 ANY-UPDATES            VALUE 1.
  2667             20  PI-104-SCREEN-SENT-IND
  2668                                 PIC  X(01).
  2669                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2670                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2671             20  PI-1042-SCREEN-SENT-IND
  2672                                 PIC  X(01).
  2673                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2674                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2675             20  PI-1042-ARCHIVE-IND
  2676                                 PIC  X(01).
  2677                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6311.cbl
  2678             20  FILLER          PIC  X(29).
  2679*    COPY ELC689PI.
  2680******************************************************************
  2681*                                                                *
  2682*                            ELC689PI                            *
  2683*                            VMOD=2.003                          *
  2684*                                                                *
  2685*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2686*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2687*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2688*                                                                *
  2689*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2690*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2691*    BETWEEN PROGRAMS.                                           *
  2692*                                                                *
  2693*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2694*                                                                *
  2695*               EL631 - EL689  - EL6891 - EL6892                 *
  2696*                                                                *
  2697******************************************************************
  2698*                   C H A N G E   L O G
  2699*
  2700* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2701*-----------------------------------------------------------------
  2702*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2703* EFFECTIVE    NUMBER
  2704*-----------------------------------------------------------------
  2705* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2706* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2707* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2708******************************************************************
  2709
  2710
  2711         16  PI-689-WORK-AREA.
  2712             20  PI-689-ALT-PRINTER-ID
  2713                                 PIC  X(04).
  2714             20  PI-689-ARCHIVE-NUMBER
  2715                                 PIC  9(08).
  2716             20  PI-689-ARCHIVE-SW
  2717                                 PIC  X(01).
  2718                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2719             20  PI-689-DATA-SOURCE
  2720                                 PIC  X(01).
  2721                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2722                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2723                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2724                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2725                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2726             20  PI-689-ERROR-IND
  2727                                 PIC  X(01).
  2728                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2729             20  PI-689-ERROR    PIC  9(04).
  2730                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2731                 88  PI-689-FATAL-ERROR
  2732                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2733                            0042 0047 0051 0066 0067 0070
  2734                            0168 0169 0174 0175 0176 0177 0179
  2735                            0180 0181 0182 0184 0185 0189 0190
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6311.cbl
  2736                            0191
  2737                            0215 0279 0280
  2738                            0412 0413 0454
  2739                            0533 0537
  2740                            2055 2114 2208 2209 2216 2232 2369
  2741                            2398 2433 2908 2999
  2742                            3000 3770 3771 3775
  2743                            7250 7365 7367 7368 7369 7370 7371
  2744                            7272 7373 7374 7376 7377 7378 7379
  2745                            7381 7388 7390 7393 7395 7396 7398
  2746                            9095 9096 9281 9298 9299 9320 9327
  2747                            9426 9427.
  2748                 88  PI-689-STOP-ERROR
  2749                     VALUES 0004 0008 0013 0023 0029 0033
  2750                            0042 0047 0066 0067 0070
  2751                            0168 0169 0174 0175 0176 0177
  2752                            0181 0182 0184 0185 0189 0190
  2753                            0279 0280
  2754                            0412 0413 0454
  2755                            2055 2208 2209 2216 2232
  2756                            2398 2999
  2757                            3000 3770 3771 3775
  2758                            7250 7365 7369 7370 7371
  2759                            7272 7373 7374 7376 7377 7378 7379
  2760                            7381 7388 7390 7393 7396 7398
  2761                            9095 9096 9299 9320 9426.
  2762             20  PI-689-FOLLOW-UP-DATE
  2763                                 PIC  X(02).
  2764             20  PI-689-FORM-NUMBER
  2765                                 PIC  X(04).
  2766             20  PI-689-LABEL-SOURCE
  2767                                 PIC X(01).
  2768                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2769                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2770                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2771                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2772                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2773                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2774                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2775             20  PI-689-NUMBER-COPIES
  2776                                 PIC  9(01).
  2777             20  PI-689-NUMBER-LABEL-LINES
  2778                                 PIC  9(01).
  2779             20  PI-689-NUMBER-TEXT-RECORDS
  2780                                 PIC  9(03).
  2781             20  PI-689-PRINT-ORDER-SW
  2782                                 PIC  X(01).
  2783                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2784                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2785                 88  PI-689-PRINT-LATER     VALUE '3'.
  2786                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2787             20  PI-689-PRINT-RESTRICTION
  2788                                 PIC  X(01).
  2789                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2790                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2791                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2792             20  PI-689-PRINT-SW PIC  X(01).
  2793                 88  PI-689-PRINT-PERFORMED VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6311.cbl
  2794             20  PI-689-RESEND-DATE-1
  2795                                 PIC  X(02).
  2796             20  PI-689-RESEND-LETR-1
  2797                                 PIC X(4).
  2798             20  PI-689-TEMP-STOR-ID
  2799                                 PIC  X(08).
  2800             20  PI-689-USE-SCREEN-IND
  2801                                 PIC  X(01).
  2802                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2803             20  PI-689-ARCH-POINTER
  2804                                 PIC S9(08) COMP.
  2805                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2806             20  PI-689-ARCT-POINTER
  2807                                 PIC S9(08) COMP.
  2808                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2809             20  PI-689-VARIABLE-DATA-GRP.
  2810                 24  PI-689-VARIABLE-DATA-1
  2811                                 PIC  X(30).
  2812                 24  PI-689-VARIABLE-DATA-2
  2813                                 PIC  X(30).
  2814                 24  PI-689-VARIABLE-DATA-3
  2815                                 PIC  X(30).
  2816                 24  PI-689-VARIABLE-DATA-4
  2817                                 PIC  X(30).
  2818
  2819         16  PI-689-KEY-DATA-FIELDS.
  2820             20  PI-689-ACCOUNT  PIC  X(10).
  2821             20  PI-689-CARRIER  PIC  X(01).
  2822             20  PI-689-CERT-NO.
  2823                 24  PI-689-CERT-PRIME
  2824                                 PIC  X(10).
  2825                 24  PI-689-CERT-SFX
  2826                                 PIC  X(01).
  2827             20  PI-689-CHG-SEQ-NO
  2828                                 PIC S9(04)    COMP.
  2829             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2830                                 PIC  X(02).
  2831             20  PI-689-ENTRY-BATCH
  2832                                 PIC  X(06).
  2833             20  PI-689-EFF-DATE PIC  X(02).
  2834             20  PI-689-EXP-DATE PIC  X(02).
  2835             20  PI-689-GROUPING PIC  X(06).
  2836             20  PI-689-RESP-PERSON
  2837                                 PIC  X(10).
  2838             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2839             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2840                                 PIC  X(04).
  2841             20  PI-689-STATE    PIC  X(02).
  2842             20  PI-689-TYPE     PIC  X(01).
  2843             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2844             20  PI-689-ALT-SEQ-NO
  2845                                 PIC S9(04)    COMP.
  2846         16  PI-689-DATE-EDIT    PIC  X(08).
  2847         16  PI-689-FOLLOW-UP-EDIT
  2848                                 PIC  X(08).
  2849         16  PI-689-RESEND1-EDIT PIC  X(08).
  2850         16  PI-689-SEQ-EDIT     PIC  X(08).
  2851         16  PI-689-BCSEQ-EDIT   PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6311.cbl
  2852         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2853             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2854         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2855         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6311.cbl
  2857
  2858 01  WS-EL6315-PASS-AREA.
  2859        16  PI-6315-ISS-CAN-SW      PIC X.
  2860        16  FILLER                  PIC X(120).
  2861        16  PI-RES-REF-CLM-TYPE     PIC X.
  2862        16  FILLER                  PIC X.
  2863        16  PI-6315-PASS-AREA.
  2864            20 FILLER               PIC X(236).
  2865            20 PI-6315-FINALIZED    PIC X.
  2866            20 FILLER               PIC X(280).
  2867
  2868 01  WS-EL6316-PASS-AREA.
  2869        16  PI-ISS-CAN-SW           PIC X.
  2870        16  FILLER                  PIC X(121).
  2871        16  PI-CLM-RESC-IND         PIC X.
  2872        16  PI-6316-PASS-AREA.
  2873            20 FILLER               PIC X(236).
  2874            20 PI-6316-FINALIZED    PIC X.
  2875            20 FILLER               PIC X(280).
  2876
  2877******************************************************************
  2878*                                                                *
  2879*         P A S S   A R E A   F O R   E D I T                    *
  2880*                                                                *
  2881******************************************************************
  2882
  2883 01  PASSED-RECORD.
  2884     12  RECORD-SAVE                  PIC X(585).
  2885* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2886*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2887*                    BY  WK-CURRENT-DATE.
  2888******************************************************************
  2889*                                                                *
  2890*                                                                *
  2891*                             ELC50W1                            *
  2892*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2893*                            VMOD=2.004                          *
  2894*                                                                *
  2895*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2896*                                                                *
  2897*                                                                *
  2898******************************************************************
  2899
  2900     12  WK-WORK-AREA.
  2901         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2902         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2903         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2904         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2905         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2906         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2907         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2908         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2909         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2910         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2911         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2912         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2913         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2914         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6311.cbl
  2915         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2916         16  WK-CREDIT-EDIT-CONTROLS.
  2917             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2918             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2919             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2920             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2921             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2922             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2923         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2924         16  WK-SAVE-REIN-DATA.
  2925             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2926             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2927             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2928         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2929             88  ENTRY-FROM-EL6311       VALUE '6'.
  2930         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2931         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2932     12  WK-RECORD-ADDRESSES.
  2933         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2934         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2935         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2936         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2937         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2938         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2939         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2940         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2941     12  WK-OVER-SHORT-AREA.
  2942         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2943         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2944         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2945             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2946         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6311.cbl
  2948
  2949*    COPY ELCEDITC.
  2950******************************************************************
  2951*                                                                *
  2952*                                                                *
  2953*                            ELCEDITC                            *
  2954*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2955*                            VMOD=2.012                          *
  2956*                                                                *
  2957*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2958*                     EL6313, EL050 AND EL517.                   *
  2959*                                                                *
  2960******************************************************************
  2961******************************************************************
  2962*                   C H A N G E   L O G
  2963*
  2964* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2965*-----------------------------------------------------------------
  2966*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2967* EFFECTIVE    NUMBER
  2968*-----------------------------------------------------------------
  2969* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2970******************************************************************
  2971
  2972     12  EDIT-CRITERIA-DATA.
  2973         16  EC-CO-MONTH-END-DT       PIC XX.
  2974         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  2975         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  2976         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  2977         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  2978         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  2979         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  2980         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  2981         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  2982         16  EC-CO-REM-TERM-CALC      PIC X.
  2983               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  2984               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  2985               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  2986               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  2987
  2988         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  2989               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  2990               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  2991               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  2992               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  2993               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  2994               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  2995               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  2996               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  2997               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  2998               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  2999
  3000         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3001               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3002               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3003               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3004               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3005               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6311.cbl
  3006               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3007               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3008               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3009
  3010         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3011                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3012                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3013
  3014         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3015                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3016                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3017                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3018                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3019                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3020                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3021                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3022                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3023
  3024         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3025               88  EC-BR-REDUCING                   VALUE 'R'.
  3026               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3027
  3028         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3029         16  EC-BR-LF-DESC             PIC X(10).
  3030         16  EC-BR-AH-DESC             PIC X(10).
  3031         16  EC-BR-LF-COMMENT          PIC X(10).
  3032         16  EC-BR-AH-COMMENT          PIC X(10).
  3033
  3034         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3035               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3036               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3037               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3038               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3039
  3040         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3041               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3042               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3043               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3044               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3045
  3046         16  EC-BR-LF-REFUND-CALC      PIC X.
  3047                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3048                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3049                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3050                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3051                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3052                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3053                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3054
  3055         16  EC-BR-AH-REFUND-CALC      PIC X.
  3056                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3057                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3058                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3059                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3060                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3061                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3062                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3063                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6311.cbl
  3064
  3065         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3066                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3067                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3068                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3069
  3070         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3071                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3072                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3073                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3074
  3075         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3076         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3077         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3078         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3079
  3080         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3081         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3082                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3083                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3084                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3085                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3086
  3087         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3088               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3089               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3090               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3091               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3092               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3093
  3094         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3095               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3096               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3097               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3098               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3099               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3100
  3101         16  EC-ST-LF-REFUND-CALC      PIC X.
  3102                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3103                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3104                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3105                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3106                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3107                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3108                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3109                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3110
  3111         16  EC-ST-AH-REFUND-CALC      PIC X.
  3112                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3113                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3114                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3115                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3116                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3117                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3118                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3119                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3120
  3121         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6311.cbl
  3122         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3123         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3124         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3125         16  EC-AM-EXPIRATION-DT       PIC XX.
  3126         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3127         16  EC-AM-CLASS-CD            PIC XX.
  3128         16  EC-AM-LF-DEVIATION        PIC XXX.
  3129         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3130         16  EC-AM-AH-DEVIATION        PIC XXX.
  3131         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3132         16  EC-AM-PHONE-NO            PIC X(10).
  3133
  3134         16  EC-AM-LF-REFUND-CALC      PIC X.
  3135                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3136                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3137                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3138                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3139                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3140                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3141                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3142
  3143         16  EC-AM-AH-REFUND-CALC      PIC X.
  3144                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3145                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3146                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3147                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3148                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3149                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3150                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3151
  3152         16  EC-AM-BEN-I-G-CD          PIC X.
  3153                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3154                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3155                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3156
  3157         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3158         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3159         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3160         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3161         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3162         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3163         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3164         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3165         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3166
  3167         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3168         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3169         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3170         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3171         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3172         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3173         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3174         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3175         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3176         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3177         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3178         16  EC-RT-LF-NSP-ST           PIC XX.
  3179         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6311.cbl
  3180         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3181         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3182
  3183         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3184             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3185                                             'M' '5' '9' '2'.
  3186             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3187             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3188             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3189             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3190             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3191             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3192             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3193             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3194             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3195             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3196
  3197         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3198             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3199                                             'M' '5' '9' '2'.
  3200             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3201             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3202             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3203             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3204             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3205             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3206             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3207             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3208             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3209             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3210
  3211         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3212         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3213         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3214         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3215         16  EC-CM-DEATH-DT            PIC XX.
  3216
  3217*DMD CUSTOM CODING FIELDS BELOW
  3218*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3219         16  EC-BR-DMD-RATING-SW       PIC X.
  3220                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3221                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3222                 88  NO-DMD-RATING               VALUE 'N'.
  3223
  3224         16  EC-NEW-CERT               PIC X(11).
  3225         16  EC-NEW-STATE              PIC XX.
  3226         16  FILLER                    PIC X.
  3227*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3228         16  OVER-SHORT-EDIT-FIELDS.
  3229             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3230             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3231             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3232             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3233             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3234             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3235             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3236             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3237             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6311.cbl
  3238         16  FILLER                    PIC X(71).
  3239
  3240******************************************************************
  3241
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6311.cbl
  3243
  3244*    COPY ELCJPFX.
  3245******************************************************************
  3246*                                                                *
  3247*                                                                *
  3248*                            ELCJPFX.                            *
  3249*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3250*                            VMOD=2.002                          *
  3251*                                                                *
  3252*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3253*                                                                *
  3254*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3255*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3256*        ELCNTL - CONTROL FILE                                   *
  3257*        ELMSTR - CLAIM MASTERS                                  *
  3258*        ELTRLR - ACTIVITY TRAILERS                              *
  3259*        ELCHKQ - CHECK QUE                                      *
  3260******************************************************************
  3261 01  JOURNAL-RECORD.
  3262     12  JP-USER-ID                  PIC X(4).
  3263     12  JP-FILE-ID                  PIC X(8).
  3264     12  JP-PROGRAM-ID               PIC X(8).
  3265     12  JP-RECORD-TYPE              PIC X.
  3266         88 JP-ADD              VALUE 'A'.
  3267         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3268         88 JP-AFTER-CHANGE     VALUE 'C'.
  3269         88 JP-DELETE           VALUE 'D'.
  3270         88 JP-GENERIC-DELETE   VALUE 'G'.
  3271         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3272         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3273     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3274     12  JP-RECORD-AREA
  3275
  3276
  3277                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6311.cbl
  3279*    COPY ELCAID.
  3280******************************************************************
  3281*                                                                *
  3282*                            ELCAID.                             *
  3283*                            VMOD=2.001                          *
  3284*                                                                *
  3285*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3286*                                                                *
  3287*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3288*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3289******************************************************************
  3290
  3291 01  DFHAID.
  3292   02  DFHNULL   PIC  X  VALUE  ' '.
  3293   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3294   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3295   02  DFHPEN    PIC  X  VALUE  '='.
  3296   02  DFHOPID   PIC  X  VALUE  'W'.
  3297   02  DFHPA1    PIC  X  VALUE  '%'.
  3298   02  DFHPA2    PIC  X  VALUE  '>'.
  3299   02  DFHPA3    PIC  X  VALUE  ','.
  3300   02  DFHPF1    PIC  X  VALUE  '1'.
  3301   02  DFHPF2    PIC  X  VALUE  '2'.
  3302   02  DFHPF3    PIC  X  VALUE  '3'.
  3303   02  DFHPF4    PIC  X  VALUE  '4'.
  3304   02  DFHPF5    PIC  X  VALUE  '5'.
  3305   02  DFHPF6    PIC  X  VALUE  '6'.
  3306   02  DFHPF7    PIC  X  VALUE  '7'.
  3307   02  DFHPF8    PIC  X  VALUE  '8'.
  3308   02  DFHPF9    PIC  X  VALUE  '9'.
  3309   02  DFHPF10   PIC  X  VALUE  ':'.
  3310   02  DFHPF11   PIC  X  VALUE  '#'.
  3311   02  DFHPF12   PIC  X  VALUE  '@'.
  3312   02  DFHPF13   PIC  X  VALUE  'A'.
  3313   02  DFHPF14   PIC  X  VALUE  'B'.
  3314   02  DFHPF15   PIC  X  VALUE  'C'.
  3315   02  DFHPF16   PIC  X  VALUE  'D'.
  3316   02  DFHPF17   PIC  X  VALUE  'E'.
  3317   02  DFHPF18   PIC  X  VALUE  'F'.
  3318   02  DFHPF19   PIC  X  VALUE  'G'.
  3319   02  DFHPF20   PIC  X  VALUE  'H'.
  3320   02  DFHPF21   PIC  X  VALUE  'I'.
  3321*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3322   02  DFHPF22   PIC  X  VALUE  '['.
  3323   02  DFHPF23   PIC  X  VALUE  '.'.
  3324   02  DFHPF24   PIC  X  VALUE  '<'.
  3325   02  DFHMSRE   PIC  X  VALUE  'X'.
  3326   02  DFHSTRF   PIC  X  VALUE  'h'.
  3327   02  DFHTRIG   PIC  X  VALUE  '"'.
  3328
  3329 01  FILLER    REDEFINES DFHAID.
  3330     12  FILLER              PIC X(8).
  3331     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3332
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6311.cbl
  3334*    COPY EL6311S.
  3335 01  EL631BI.
  3336     05  FILLER            PIC  X(0012).
  3337*    -------------------------------
  3338     05  BDATEL PIC S9(0004) COMP.
  3339     05  BDATEF PIC  X(0001).
  3340     05  FILLER REDEFINES BDATEF.
  3341         10  BDATEA PIC  X(0001).
  3342     05  BDATEI PIC  X(0008).
  3343*    -------------------------------
  3344     05  BTIMEL PIC S9(0004) COMP.
  3345     05  BTIMEF PIC  X(0001).
  3346     05  FILLER REDEFINES BTIMEF.
  3347         10  BTIMEA PIC  X(0001).
  3348     05  BTIMEI PIC  X(0005).
  3349*    -------------------------------
  3350     05  BHEADL PIC S9(0004) COMP.
  3351     05  BHEADF PIC  X(0001).
  3352     05  FILLER REDEFINES BHEADF.
  3353         10  BHEADA PIC  X(0001).
  3354     05  BHEADI PIC  X(0038).
  3355*    -------------------------------
  3356     05  BNCERTLL PIC S9(0004) COMP.
  3357     05  BNCERTLF PIC  X(0001).
  3358     05  FILLER REDEFINES BNCERTLF.
  3359         10  BNCERTLA PIC  X(0001).
  3360     05  BNCERTLI PIC  X(0008).
  3361*    -------------------------------
  3362     05  BNCERTL PIC S9(0004) COMP.
  3363     05  BNCERTF PIC  X(0001).
  3364     05  FILLER REDEFINES BNCERTF.
  3365         10  BNCERTA PIC  X(0001).
  3366     05  BNCERTI PIC  X(0011).
  3367*    -------------------------------
  3368     05  BNSTATLL PIC S9(0004) COMP.
  3369     05  BNSTATLF PIC  X(0001).
  3370     05  FILLER REDEFINES BNSTATLF.
  3371         10  BNSTATLA PIC  X(0001).
  3372     05  BNSTATLI PIC  X(0009).
  3373*    -------------------------------
  3374     05  BNSTATL PIC S9(0004) COMP.
  3375     05  BNSTATF PIC  X(0001).
  3376     05  FILLER REDEFINES BNSTATF.
  3377         10  BNSTATA PIC  X(0001).
  3378     05  BNSTATI PIC  X(0002).
  3379*    -------------------------------
  3380     05  BCHGTL PIC S9(0004) COMP.
  3381     05  BCHGTF PIC  X(0001).
  3382     05  FILLER REDEFINES BCHGTF.
  3383         10  BCHGTA PIC  X(0001).
  3384     05  BCHGTI PIC  X(0004).
  3385*    -------------------------------
  3386     05  BCHGL PIC S9(0004) COMP.
  3387     05  BCHGF PIC  X(0001).
  3388     05  FILLER REDEFINES BCHGF.
  3389         10  BCHGA PIC  X(0001).
  3390     05  BCHGI PIC  X(0004).
  3391*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6311.cbl
  3392     05  BMAINTL PIC S9(0004) COMP.
  3393     05  BMAINTF PIC  X(0001).
  3394     05  FILLER REDEFINES BMAINTF.
  3395         10  BMAINTA PIC  X(0001).
  3396     05  BMAINTI PIC  X(0001).
  3397*    -------------------------------
  3398     05  BMANTBYL PIC S9(0004) COMP.
  3399     05  BMANTBYF PIC  X(0001).
  3400     05  FILLER REDEFINES BMANTBYF.
  3401         10  BMANTBYA PIC  X(0001).
  3402     05  BMANTBYI PIC  X(0004).
  3403*    -------------------------------
  3404     05  BCHGHDGL PIC S9(0004) COMP.
  3405     05  BCHGHDGF PIC  X(0001).
  3406     05  FILLER REDEFINES BCHGHDGF.
  3407         10  BCHGHDGA PIC  X(0001).
  3408     05  BCHGHDGI PIC  X(0003).
  3409*    -------------------------------
  3410     05  BMANTDTL PIC S9(0004) COMP.
  3411     05  BMANTDTF PIC  X(0001).
  3412     05  FILLER REDEFINES BMANTDTF.
  3413         10  BMANTDTA PIC  X(0001).
  3414     05  BMANTDTI PIC  X(0008).
  3415*    -------------------------------
  3416     05  BMANTATL PIC S9(0004) COMP.
  3417     05  BMANTATF PIC  X(0001).
  3418     05  FILLER REDEFINES BMANTATF.
  3419         10  BMANTATA PIC  X(0001).
  3420     05  BMANTATI PIC  X(0005).
  3421*    -------------------------------
  3422     05  BCSRL PIC S9(0004) COMP.
  3423     05  BCSRF PIC  X(0001).
  3424     05  FILLER REDEFINES BCSRF.
  3425         10  BCSRA PIC  X(0001).
  3426     05  BCSRI PIC  X(0004).
  3427*    -------------------------------
  3428     05  BBATCHL PIC S9(0004) COMP.
  3429     05  BBATCHF PIC  X(0001).
  3430     05  FILLER REDEFINES BBATCHF.
  3431         10  BBATCHA PIC  X(0001).
  3432     05  BBATCHI PIC  X(0006).
  3433*    -------------------------------
  3434     05  BSEQL PIC S9(0004) COMP.
  3435     05  BSEQF PIC  X(0001).
  3436     05  FILLER REDEFINES BSEQF.
  3437         10  BSEQA PIC  X(0001).
  3438     05  BSEQI PIC  X(0004).
  3439*    -------------------------------
  3440     05  BMOENDTL PIC S9(0004) COMP.
  3441     05  BMOENDTF PIC  X(0001).
  3442     05  FILLER REDEFINES BMOENDTF.
  3443         10  BMOENDTA PIC  X(0001).
  3444     05  BMOENDTI PIC  X(0008).
  3445*    -------------------------------
  3446     05  BCARRL PIC S9(0004) COMP.
  3447     05  BCARRF PIC  X(0001).
  3448     05  FILLER REDEFINES BCARRF.
  3449         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6311.cbl
  3450     05  BCARRI PIC  X(0001).
  3451*    -------------------------------
  3452     05  BGROUPL PIC S9(0004) COMP.
  3453     05  BGROUPF PIC  X(0001).
  3454     05  FILLER REDEFINES BGROUPF.
  3455         10  BGROUPA PIC  X(0001).
  3456     05  BGROUPI PIC  X(0006).
  3457*    -------------------------------
  3458     05  BSTATEL PIC S9(0004) COMP.
  3459     05  BSTATEF PIC  X(0001).
  3460     05  FILLER REDEFINES BSTATEF.
  3461         10  BSTATEA PIC  X(0001).
  3462     05  BSTATEI PIC  X(0002).
  3463*    -------------------------------
  3464     05  BACCTL PIC S9(0004) COMP.
  3465     05  BACCTF PIC  X(0001).
  3466     05  FILLER REDEFINES BACCTF.
  3467         10  BACCTA PIC  X(0001).
  3468     05  BACCTI PIC  X(0010).
  3469*    -------------------------------
  3470     05  BVINHL PIC S9(0004) COMP.
  3471     05  BVINHF PIC  X(0001).
  3472     05  FILLER REDEFINES BVINHF.
  3473         10  BVINHA PIC  X(0001).
  3474     05  BVINHI PIC  X(0004).
  3475*    -------------------------------
  3476     05  BVINL PIC S9(0004) COMP.
  3477     05  BVINF PIC  X(0001).
  3478     05  FILLER REDEFINES BVINF.
  3479         10  BVINA PIC  X(0001).
  3480     05  BVINI PIC  X(0017).
  3481*    -------------------------------
  3482     05  BREFHDGL PIC S9(0004) COMP.
  3483     05  BREFHDGF PIC  X(0001).
  3484     05  FILLER REDEFINES BREFHDGF.
  3485         10  BREFHDGA PIC  X(0001).
  3486     05  BREFHDGI PIC  X(0004).
  3487*    -------------------------------
  3488     05  BREFL PIC S9(0004) COMP.
  3489     05  BREFF PIC  X(0001).
  3490     05  FILLER REDEFINES BREFF.
  3491         10  BREFA PIC  X(0001).
  3492     05  BREFI PIC  X(0012).
  3493*    -------------------------------
  3494     05  BCERTNOL PIC S9(0004) COMP.
  3495     05  BCERTNOF PIC  X(0001).
  3496     05  FILLER REDEFINES BCERTNOF.
  3497         10  BCERTNOA PIC  X(0001).
  3498     05  BCERTNOI PIC  X(0010).
  3499*    -------------------------------
  3500     05  BSUFIXL PIC S9(0004) COMP.
  3501     05  BSUFIXF PIC  X(0001).
  3502     05  FILLER REDEFINES BSUFIXF.
  3503         10  BSUFIXA PIC  X(0001).
  3504     05  BSUFIXI PIC  X(0001).
  3505*    -------------------------------
  3506     05  BEFFDTL PIC S9(0004) COMP.
  3507     05  BEFFDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6311.cbl
  3508     05  FILLER REDEFINES BEFFDTF.
  3509         10  BEFFDTA PIC  X(0001).
  3510     05  BEFFDTI PIC  X(0008).
  3511*    -------------------------------
  3512     05  BLSTNML PIC S9(0004) COMP.
  3513     05  BLSTNMF PIC  X(0001).
  3514     05  FILLER REDEFINES BLSTNMF.
  3515         10  BLSTNMA PIC  X(0001).
  3516     05  BLSTNMI PIC  X(0015).
  3517*    -------------------------------
  3518     05  B1STNML PIC S9(0004) COMP.
  3519     05  B1STNMF PIC  X(0001).
  3520     05  FILLER REDEFINES B1STNMF.
  3521         10  B1STNMA PIC  X(0001).
  3522     05  B1STNMI PIC  X(0010).
  3523*    -------------------------------
  3524     05  BINITL PIC S9(0004) COMP.
  3525     05  BINITF PIC  X(0001).
  3526     05  FILLER REDEFINES BINITF.
  3527         10  BINITA PIC  X(0001).
  3528     05  BINITI PIC  X(0001).
  3529*    -------------------------------
  3530     05  BSEXL PIC S9(0004) COMP.
  3531     05  BSEXF PIC  X(0001).
  3532     05  FILLER REDEFINES BSEXF.
  3533         10  BSEXA PIC  X(0001).
  3534     05  BSEXI PIC  X(0001).
  3535*    -------------------------------
  3536     05  BAGEL PIC S9(0004) COMP.
  3537     05  BAGEF PIC  X(0001).
  3538     05  FILLER REDEFINES BAGEF.
  3539         10  BAGEA PIC  X(0001).
  3540     05  BAGEI PIC  X(0002).
  3541*    -------------------------------
  3542     05  BBIRTHL PIC S9(0004) COMP.
  3543     05  BBIRTHF PIC  X(0001).
  3544     05  FILLER REDEFINES BBIRTHF.
  3545         10  BBIRTHA PIC  X(0001).
  3546     05  BBIRTHI PIC  X(0008).
  3547*    -------------------------------
  3548     05  B1STPMTL PIC S9(0004) COMP.
  3549     05  B1STPMTF PIC  X(0001).
  3550     05  FILLER REDEFINES B1STPMTF.
  3551         10  B1STPMTA PIC  X(0001).
  3552     05  B1STPMTI PIC  X(0008).
  3553*    -------------------------------
  3554     05  BDAYSL PIC S9(0004) COMP.
  3555     05  BDAYSF PIC  X(0001).
  3556     05  FILLER REDEFINES BDAYSF.
  3557         10  BDAYSA PIC  X(0001).
  3558     05  BDAYSI PIC  X(0003).
  3559*    -------------------------------
  3560     05  BLNTRML PIC S9(0004) COMP.
  3561     05  BLNTRMF PIC  X(0001).
  3562     05  FILLER REDEFINES BLNTRMF.
  3563         10  BLNTRMA PIC  X(0001).
  3564     05  BLNTRMI PIC  X(0003).
  3565*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6311.cbl
  3566     05  BLNOFCRL PIC S9(0004) COMP.
  3567     05  BLNOFCRF PIC  X(0001).
  3568     05  FILLER REDEFINES BLNOFCRF.
  3569         10  BLNOFCRA PIC  X(0001).
  3570     05  BLNOFCRI PIC  X(0005).
  3571*    -------------------------------
  3572     05  BMODEL PIC S9(0004) COMP.
  3573     05  BMODEF PIC  X(0001).
  3574     05  FILLER REDEFINES BMODEF.
  3575         10  BMODEA PIC  X(0001).
  3576     05  BMODEI PIC  X(0001).
  3577*    -------------------------------
  3578     05  BFREQL PIC S9(0004) COMP.
  3579     05  BFREQF PIC  X(0001).
  3580     05  FILLER REDEFINES BFREQF.
  3581         10  BFREQA PIC  X(0001).
  3582     05  BFREQI PIC  X(0002).
  3583*    -------------------------------
  3584     05  BPMTSL PIC S9(0004) COMP.
  3585     05  BPMTSF PIC  X(0001).
  3586     05  FILLER REDEFINES BPMTSF.
  3587         10  BPMTSA PIC  X(0001).
  3588     05  BPMTSI PIC  999.
  3589*    -------------------------------
  3590     05  BPMTAMTL PIC S9(0004) COMP.
  3591     05  BPMTAMTF PIC  X(0001).
  3592     05  FILLER REDEFINES BPMTAMTF.
  3593         10  BPMTAMTA PIC  X(0001).
  3594     05  BPMTAMTI PIC  9(7)V99.
  3595*    -------------------------------
  3596     05  BAPRL PIC S9(0004) COMP.
  3597     05  BAPRF PIC  X(0001).
  3598     05  FILLER REDEFINES BAPRF.
  3599         10  BAPRA PIC  X(0001).
  3600     05  BAPRI PIC  X(7).
  3601*    -------------------------------
  3602     05  BLIVESL PIC S9(0004) COMP.
  3603     05  BLIVESF PIC  X(0001).
  3604     05  FILLER REDEFINES BLIVESF.
  3605         10  BLIVESA PIC  X(0001).
  3606     05  BLIVESI PIC  X(0009).
  3607*    -------------------------------
  3608     05  BMEMCAPL PIC S9(0004) COMP.
  3609     05  BMEMCAPF PIC  X(0001).
  3610     05  FILLER REDEFINES BMEMCAPF.
  3611         10  BMEMCAPA PIC  X(0001).
  3612     05  BMEMCAPI PIC  X(0011).
  3613*    -------------------------------
  3614     05  BORIGHDL PIC S9(0004) COMP.
  3615     05  BORIGHDF PIC  X(0001).
  3616     05  FILLER REDEFINES BORIGHDF.
  3617         10  BORIGHDA PIC  X(0001).
  3618     05  BORIGHDI PIC  X(0009).
  3619*    -------------------------------
  3620     05  DMDBILL PIC S9(0004) COMP.
  3621     05  DMDBILF PIC  X(0001).
  3622     05  FILLER REDEFINES DMDBILF.
  3623         10  DMDBILA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6311.cbl
  3624     05  DMDBILI PIC  X(0006).
  3625*    -------------------------------
  3626     05  BFORCEL PIC S9(0004) COMP.
  3627     05  BFORCEF PIC  X(0001).
  3628     05  FILLER REDEFINES BFORCEF.
  3629         10  BFORCEA PIC  X(0001).
  3630     05  BFORCEI PIC  X(0001).
  3631*    -------------------------------
  3632     05  BENTRYL PIC S9(0004) COMP.
  3633     05  BENTRYF PIC  X(0001).
  3634     05  FILLER REDEFINES BENTRYF.
  3635         10  BENTRYA PIC  X(0001).
  3636     05  BENTRYI PIC  X(0001).
  3637*    -------------------------------
  3638     05  BREINL PIC S9(0004) COMP.
  3639     05  BREINF PIC  X(0001).
  3640     05  FILLER REDEFINES BREINF.
  3641         10  BREINA PIC  X(0001).
  3642     05  BREINI PIC  X(0001).
  3643*    -------------------------------
  3644     05  BBILCDL PIC S9(0004) COMP.
  3645     05  BBILCDF PIC  X(0001).
  3646     05  FILLER REDEFINES BBILCDF.
  3647         10  BBILCDA PIC  X(0001).
  3648     05  BBILCDI PIC  X(0001).
  3649*    -------------------------------
  3650     05  BUNWRITL PIC S9(0004) COMP.
  3651     05  BUNWRITF PIC  X(0001).
  3652     05  FILLER REDEFINES BUNWRITF.
  3653         10  BUNWRITA PIC  X(0001).
  3654     05  BUNWRITI PIC  X(0001).
  3655*    -------------------------------
  3656     05  BSKPCDL PIC S9(0004) COMP.
  3657     05  BSKPCDF PIC  X(0001).
  3658     05  FILLER REDEFINES BSKPCDF.
  3659         10  BSKPCDA PIC  X(0001).
  3660     05  BSKPCDI PIC  X(0001).
  3661*    -------------------------------
  3662     05  BINDGRPL PIC S9(0004) COMP.
  3663     05  BINDGRPF PIC  X(0001).
  3664     05  FILLER REDEFINES BINDGRPF.
  3665         10  BINDGRPA PIC  X(0001).
  3666     05  BINDGRPI PIC  X(0001).
  3667*    -------------------------------
  3668     05  BSIGL PIC S9(0004) COMP.
  3669     05  BSIGF PIC  X(0001).
  3670     05  FILLER REDEFINES BSIGF.
  3671         10  BSIGA PIC  X(0001).
  3672     05  BSIGI PIC  X(0001).
  3673*    -------------------------------
  3674     05  BRTCLSL PIC S9(0004) COMP.
  3675     05  BRTCLSF PIC  X(0001).
  3676     05  FILLER REDEFINES BRTCLSF.
  3677         10  BRTCLSA PIC  X(0001).
  3678     05  BRTCLSI PIC  X(0002).
  3679*    -------------------------------
  3680     05  BCHGCNTL PIC S9(0004) COMP.
  3681     05  BCHGCNTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6311.cbl
  3682     05  FILLER REDEFINES BCHGCNTF.
  3683         10  BCHGCNTA PIC  X(0001).
  3684     05  BCHGCNTI PIC  X(0003).
  3685*    -------------------------------
  3686     05  BMEMBERL PIC S9(0004) COMP.
  3687     05  BMEMBERF PIC  X(0001).
  3688     05  FILLER REDEFINES BMEMBERF.
  3689         10  BMEMBERA PIC  X(0001).
  3690     05  BMEMBERI PIC  X(0012).
  3691*    -------------------------------
  3692     05  BORGNOL PIC S9(0004) COMP.
  3693     05  BORGNOF PIC  X(0001).
  3694     05  FILLER REDEFINES BORGNOF.
  3695         10  BORGNOA PIC  X(0001).
  3696     05  BORGNOI PIC  X(0006).
  3697*    -------------------------------
  3698     05  BORGSEQL PIC S9(0004) COMP.
  3699     05  BORGSEQF PIC  X(0001).
  3700     05  FILLER REDEFINES BORGSEQF.
  3701         10  BORGSEQA PIC  X(0001).
  3702     05  BORGSEQI PIC  X(0004).
  3703*    -------------------------------
  3704     05  BBILLEDL PIC S9(0004) COMP.
  3705     05  BBILLEDF PIC  X(0001).
  3706     05  FILLER REDEFINES BBILLEDF.
  3707         10  BBILLEDA PIC  X(0001).
  3708     05  BBILLEDI PIC  9(9).
  3709*    -------------------------------
  3710     05  BKIND1L PIC S9(0004) COMP.
  3711     05  BKIND1F PIC  X(0001).
  3712     05  FILLER REDEFINES BKIND1F.
  3713         10  BKIND1A PIC  X(0001).
  3714     05  BKIND1I PIC  X(0002).
  3715*    -------------------------------
  3716     05  BTYPE1L PIC S9(0004) COMP.
  3717     05  BTYPE1F PIC  X(0001).
  3718     05  FILLER REDEFINES BTYPE1F.
  3719         10  BTYPE1A PIC  X(0001).
  3720     05  BTYPE1I PIC  X(0003).
  3721*    -------------------------------
  3722     05  BTERM1L PIC S9(0004) COMP.
  3723     05  BTERM1F PIC  X(0001).
  3724     05  FILLER REDEFINES BTERM1F.
  3725         10  BTERM1A PIC  X(0001).
  3726     05  BTERM1I PIC  X(0003).
  3727*    -------------------------------
  3728     05  BBEN1L PIC S9(0004) COMP.
  3729     05  BBEN1F PIC  X(0001).
  3730     05  FILLER REDEFINES BBEN1F.
  3731         10  BBEN1A PIC  X(0001).
  3732     05  BBEN1I PIC  X(0012).
  3733*    -------------------------------
  3734     05  BPREM1L PIC S9(0004) COMP.
  3735     05  BPREM1F PIC  X(0001).
  3736     05  FILLER REDEFINES BPREM1F.
  3737         10  BPREM1A PIC  X(0001).
  3738     05  BPREM1I PIC  X(0011).
  3739*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6311.cbl
  3740     05  BEXPIR1L PIC S9(0004) COMP.
  3741     05  BEXPIR1F PIC  X(0001).
  3742     05  FILLER REDEFINES BEXPIR1F.
  3743         10  BEXPIR1A PIC  X(0001).
  3744     05  BEXPIR1I PIC  X(0008).
  3745*    -------------------------------
  3746     05  BCP1L PIC S9(0004) COMP.
  3747     05  BCP1F PIC  X(0001).
  3748     05  FILLER REDEFINES BCP1F.
  3749         10  BCP1A PIC  X(0001).
  3750     05  BCP1I PIC  X(0002).
  3751*    -------------------------------
  3752     05  BALTBN1L PIC S9(0004) COMP.
  3753     05  BALTBN1F PIC  X(0001).
  3754     05  FILLER REDEFINES BALTBN1F.
  3755         10  BALTBN1A PIC  X(0001).
  3756     05  BALTBN1I PIC  X(0012).
  3757*    -------------------------------
  3758     05  BALTPR1L PIC S9(0004) COMP.
  3759     05  BALTPR1F PIC  X(0001).
  3760     05  FILLER REDEFINES BALTPR1F.
  3761         10  BALTPR1A PIC  X(0001).
  3762     05  BALTPR1I PIC  X(0011).
  3763*    -------------------------------
  3764     05  BBNCD1L PIC S9(0004) COMP.
  3765     05  BBNCD1F PIC  X(0001).
  3766     05  FILLER REDEFINES BBNCD1F.
  3767         10  BBNCD1A PIC  X(0001).
  3768     05  BBNCD1I PIC  X(0003).
  3769*    -------------------------------
  3770     05  BCPRM1L PIC S9(0004) COMP.
  3771     05  BCPRM1F PIC  X(0001).
  3772     05  FILLER REDEFINES BCPRM1F.
  3773         10  BCPRM1A PIC  X(0001).
  3774     05  BCPRM1I PIC  X(0011).
  3775*    -------------------------------
  3776     05  BCAPRM1L PIC S9(0004) COMP.
  3777     05  BCAPRM1F PIC  X(0001).
  3778     05  FILLER REDEFINES BCAPRM1F.
  3779         10  BCAPRM1A PIC  X(0001).
  3780     05  BCAPRM1I PIC  X(0011).
  3781*    -------------------------------
  3782     05  BENABR1L PIC S9(0004) COMP.
  3783     05  BENABR1F PIC  X(0001).
  3784     05  FILLER REDEFINES BENABR1F.
  3785         10  BENABR1A PIC  X(0001).
  3786     05  BENABR1I PIC  X(0005).
  3787*    -------------------------------
  3788     05  BDIFF1L PIC S9(0004) COMP.
  3789     05  BDIFF1F PIC  X(0001).
  3790     05  FILLER REDEFINES BDIFF1F.
  3791         10  BDIFF1A PIC  X(0001).
  3792     05  BDIFF1I PIC  X(0011).
  3793*    -------------------------------
  3794     05  BBILIT1L PIC S9(0004) COMP.
  3795     05  BBILIT1F PIC  X(0001).
  3796     05  FILLER REDEFINES BBILIT1F.
  3797         10  BBILIT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6311.cbl
  3798     05  BBILIT1I PIC  X(0008).
  3799*    -------------------------------
  3800     05  BADIFF1L PIC S9(0004) COMP.
  3801     05  BADIFF1F PIC  X(0001).
  3802     05  FILLER REDEFINES BADIFF1F.
  3803         10  BADIFF1A PIC  X(0001).
  3804     05  BADIFF1I PIC  X(0011).
  3805*    -------------------------------
  3806     05  BKIND2L PIC S9(0004) COMP.
  3807     05  BKIND2F PIC  X(0001).
  3808     05  FILLER REDEFINES BKIND2F.
  3809         10  BKIND2A PIC  X(0001).
  3810     05  BKIND2I PIC  X(0002).
  3811*    -------------------------------
  3812     05  BTYPE2L PIC S9(0004) COMP.
  3813     05  BTYPE2F PIC  X(0001).
  3814     05  FILLER REDEFINES BTYPE2F.
  3815         10  BTYPE2A PIC  X(0001).
  3816     05  BTYPE2I PIC  X(0003).
  3817*    -------------------------------
  3818     05  BTERM2L PIC S9(0004) COMP.
  3819     05  BTERM2F PIC  X(0001).
  3820     05  FILLER REDEFINES BTERM2F.
  3821         10  BTERM2A PIC  X(0001).
  3822     05  BTERM2I PIC  X(0003).
  3823*    -------------------------------
  3824     05  BBEN2L PIC S9(0004) COMP.
  3825     05  BBEN2F PIC  X(0001).
  3826     05  FILLER REDEFINES BBEN2F.
  3827         10  BBEN2A PIC  X(0001).
  3828     05  BBEN2I PIC  X(0012).
  3829*    -------------------------------
  3830     05  BPREM2L PIC S9(0004) COMP.
  3831     05  BPREM2F PIC  X(0001).
  3832     05  FILLER REDEFINES BPREM2F.
  3833         10  BPREM2A PIC  X(0001).
  3834     05  BPREM2I PIC  X(0011).
  3835*    -------------------------------
  3836     05  BEXPIR2L PIC S9(0004) COMP.
  3837     05  BEXPIR2F PIC  X(0001).
  3838     05  FILLER REDEFINES BEXPIR2F.
  3839         10  BEXPIR2A PIC  X(0001).
  3840     05  BEXPIR2I PIC  X(0008).
  3841*    -------------------------------
  3842     05  BCP2L PIC S9(0004) COMP.
  3843     05  BCP2F PIC  X(0001).
  3844     05  FILLER REDEFINES BCP2F.
  3845         10  BCP2A PIC  X(0001).
  3846     05  BCP2I PIC  X(0002).
  3847*    -------------------------------
  3848     05  BALTBN2L PIC S9(0004) COMP.
  3849     05  BALTBN2F PIC  X(0001).
  3850     05  FILLER REDEFINES BALTBN2F.
  3851         10  BALTBN2A PIC  X(0001).
  3852     05  BALTBN2I PIC  X(0012).
  3853*    -------------------------------
  3854     05  BALTPR2L PIC S9(0004) COMP.
  3855     05  BALTPR2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6311.cbl
  3856     05  FILLER REDEFINES BALTPR2F.
  3857         10  BALTPR2A PIC  X(0001).
  3858     05  BALTPR2I PIC  X(0011).
  3859*    -------------------------------
  3860     05  BBNCD2L PIC S9(0004) COMP.
  3861     05  BBNCD2F PIC  X(0001).
  3862     05  FILLER REDEFINES BBNCD2F.
  3863         10  BBNCD2A PIC  X(0001).
  3864     05  BBNCD2I PIC  X(0003).
  3865*    -------------------------------
  3866     05  BCPRM2L PIC S9(0004) COMP.
  3867     05  BCPRM2F PIC  X(0001).
  3868     05  FILLER REDEFINES BCPRM2F.
  3869         10  BCPRM2A PIC  X(0001).
  3870     05  BCPRM2I PIC  X(0011).
  3871*    -------------------------------
  3872     05  BCAPRM2L PIC S9(0004) COMP.
  3873     05  BCAPRM2F PIC  X(0001).
  3874     05  FILLER REDEFINES BCAPRM2F.
  3875         10  BCAPRM2A PIC  X(0001).
  3876     05  BCAPRM2I PIC  X(0011).
  3877*    -------------------------------
  3878     05  BENABR2L PIC S9(0004) COMP.
  3879     05  BENABR2F PIC  X(0001).
  3880     05  FILLER REDEFINES BENABR2F.
  3881         10  BENABR2A PIC  X(0001).
  3882     05  BENABR2I PIC  X(0005).
  3883*    -------------------------------
  3884     05  BDIFF2L PIC S9(0004) COMP.
  3885     05  BDIFF2F PIC  X(0001).
  3886     05  FILLER REDEFINES BDIFF2F.
  3887         10  BDIFF2A PIC  X(0001).
  3888     05  BDIFF2I PIC  X(0011).
  3889*    -------------------------------
  3890     05  BBILIT2L PIC S9(0004) COMP.
  3891     05  BBILIT2F PIC  X(0001).
  3892     05  FILLER REDEFINES BBILIT2F.
  3893         10  BBILIT2A PIC  X(0001).
  3894     05  BBILIT2I PIC  X(0008).
  3895*    -------------------------------
  3896     05  BADIFF2L PIC S9(0004) COMP.
  3897     05  BADIFF2F PIC  X(0001).
  3898     05  FILLER REDEFINES BADIFF2F.
  3899         10  BADIFF2A PIC  X(0001).
  3900     05  BADIFF2I PIC  X(0011).
  3901*    -------------------------------
  3902     05  BERMSG1L PIC S9(0004) COMP.
  3903     05  BERMSG1F PIC  X(0001).
  3904     05  FILLER REDEFINES BERMSG1F.
  3905         10  BERMSG1A PIC  X(0001).
  3906     05  BERMSG1I PIC  X(0078).
  3907*    -------------------------------
  3908     05  BERMSG2L PIC S9(0004) COMP.
  3909     05  BERMSG2F PIC  X(0001).
  3910     05  FILLER REDEFINES BERMSG2F.
  3911         10  BERMSG2A PIC  X(0001).
  3912     05  BERMSG2I PIC  X(0078).
  3913*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6311.cbl
  3914     05  BERMSG3L PIC S9(0004) COMP.
  3915     05  BERMSG3F PIC  X(0001).
  3916     05  FILLER REDEFINES BERMSG3F.
  3917         10  BERMSG3A PIC  X(0001).
  3918     05  BERMSG3I PIC  X(0078).
  3919*    -------------------------------
  3920     05  BPFENTRL PIC S9(0004) COMP.
  3921     05  BPFENTRF PIC  X(0001).
  3922     05  FILLER REDEFINES BPFENTRF.
  3923         10  BPFENTRA PIC  X(0001).
  3924     05  BPFENTRI PIC  9(2).
  3925*    -------------------------------
  3926     05  BPF5HDRL PIC S9(0004) COMP.
  3927     05  BPF5HDRF PIC  X(0001).
  3928     05  FILLER REDEFINES BPF5HDRF.
  3929         10  BPF5HDRA PIC  X(0001).
  3930     05  BPF5HDRI PIC  X(0005).
  3931*    -------------------------------
  3932     05  BPF4HDRL PIC S9(0004) COMP.
  3933     05  BPF4HDRF PIC  X(0001).
  3934     05  FILLER REDEFINES BPF4HDRF.
  3935         10  BPF4HDRA PIC  X(0001).
  3936     05  BPF4HDRI PIC  X(0013).
  3937*    -------------------------------
  3938     05  BF15HDRL PIC S9(0004) COMP.
  3939     05  BF15HDRF PIC  X(0001).
  3940     05  FILLER REDEFINES BF15HDRF.
  3941         10  BF15HDRA PIC  X(0001).
  3942     05  BF15HDRI PIC  X(0010).
  3943 01  EL631BO REDEFINES EL631BI.
  3944     05  FILLER            PIC  X(0012).
  3945*    -------------------------------
  3946     05  FILLER            PIC  X(0003).
  3947     05  BDATEO PIC  X(0008).
  3948*    -------------------------------
  3949     05  FILLER            PIC  X(0003).
  3950     05  BTIMEO PIC  99.99.
  3951*    -------------------------------
  3952     05  FILLER            PIC  X(0003).
  3953     05  BHEADO PIC  X(0038).
  3954*    -------------------------------
  3955     05  FILLER            PIC  X(0003).
  3956     05  BNCERTLO PIC  X(0008).
  3957*    -------------------------------
  3958     05  FILLER            PIC  X(0003).
  3959     05  BNCERTO PIC  X(0011).
  3960*    -------------------------------
  3961     05  FILLER            PIC  X(0003).
  3962     05  BNSTATLO PIC  X(0009).
  3963*    -------------------------------
  3964     05  FILLER            PIC  X(0003).
  3965     05  BNSTATO PIC  X(0002).
  3966*    -------------------------------
  3967     05  FILLER            PIC  X(0003).
  3968     05  BCHGTO PIC  X(0004).
  3969*    -------------------------------
  3970     05  FILLER            PIC  X(0003).
  3971     05  BCHGO PIC  ZZZ9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6311.cbl
  3972*    -------------------------------
  3973     05  FILLER            PIC  X(0003).
  3974     05  BMAINTO PIC  X(0001).
  3975*    -------------------------------
  3976     05  FILLER            PIC  X(0003).
  3977     05  BMANTBYO PIC  X(0004).
  3978*    -------------------------------
  3979     05  FILLER            PIC  X(0003).
  3980     05  BCHGHDGO PIC  X(0003).
  3981*    -------------------------------
  3982     05  FILLER            PIC  X(0003).
  3983     05  BMANTDTO PIC  X(0008).
  3984*    -------------------------------
  3985     05  FILLER            PIC  X(0003).
  3986     05  BMANTATO PIC  99.99.
  3987*    -------------------------------
  3988     05  FILLER            PIC  X(0003).
  3989     05  BCSRO PIC  X(0004).
  3990*    -------------------------------
  3991     05  FILLER            PIC  X(0003).
  3992     05  BBATCHO PIC  X(0006).
  3993*    -------------------------------
  3994     05  FILLER            PIC  X(0003).
  3995     05  BSEQO PIC  X(0004).
  3996*    -------------------------------
  3997     05  FILLER            PIC  X(0003).
  3998     05  BMOENDTO PIC  X(0008).
  3999*    -------------------------------
  4000     05  FILLER            PIC  X(0003).
  4001     05  BCARRO PIC  X(0001).
  4002*    -------------------------------
  4003     05  FILLER            PIC  X(0003).
  4004     05  BGROUPO PIC  X(0006).
  4005*    -------------------------------
  4006     05  FILLER            PIC  X(0003).
  4007     05  BSTATEO PIC  X(0002).
  4008*    -------------------------------
  4009     05  FILLER            PIC  X(0003).
  4010     05  BACCTO PIC  X(0010).
  4011*    -------------------------------
  4012     05  FILLER            PIC  X(0003).
  4013     05  BVINHO PIC  X(0004).
  4014*    -------------------------------
  4015     05  FILLER            PIC  X(0003).
  4016     05  BVINO PIC  X(0017).
  4017*    -------------------------------
  4018     05  FILLER            PIC  X(0003).
  4019     05  BREFHDGO PIC  X(0004).
  4020*    -------------------------------
  4021     05  FILLER            PIC  X(0003).
  4022     05  BREFO PIC  X(0012).
  4023*    -------------------------------
  4024     05  FILLER            PIC  X(0003).
  4025     05  BCERTNOO PIC  X(0010).
  4026*    -------------------------------
  4027     05  FILLER            PIC  X(0003).
  4028     05  BSUFIXO PIC  X(0001).
  4029*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6311.cbl
  4030     05  FILLER            PIC  X(0003).
  4031     05  BEFFDTO PIC  X(0008).
  4032*    -------------------------------
  4033     05  FILLER            PIC  X(0003).
  4034     05  BLSTNMO PIC  X(0015).
  4035*    -------------------------------
  4036     05  FILLER            PIC  X(0003).
  4037     05  B1STNMO PIC  X(0010).
  4038*    -------------------------------
  4039     05  FILLER            PIC  X(0003).
  4040     05  BINITO PIC  X(0001).
  4041*    -------------------------------
  4042     05  FILLER            PIC  X(0003).
  4043     05  BSEXO PIC  X(0001).
  4044*    -------------------------------
  4045     05  FILLER            PIC  X(0003).
  4046     05  BAGEO PIC  X(0002).
  4047*    -------------------------------
  4048     05  FILLER            PIC  X(0003).
  4049     05  BBIRTHO PIC  X(0008).
  4050*    -------------------------------
  4051     05  FILLER            PIC  X(0003).
  4052     05  B1STPMTO PIC  X(0008).
  4053*    -------------------------------
  4054     05  FILLER            PIC  X(0003).
  4055     05  BDAYSO PIC  X(0003).
  4056*    -------------------------------
  4057     05  FILLER            PIC  X(0003).
  4058     05  BLNTRMO PIC  X(0003).
  4059*    -------------------------------
  4060     05  FILLER            PIC  X(0003).
  4061     05  BLNOFCRO PIC  X(0005).
  4062*    -------------------------------
  4063     05  FILLER            PIC  X(0003).
  4064     05  BMODEO PIC  X(0001).
  4065*    -------------------------------
  4066     05  FILLER            PIC  X(0003).
  4067     05  BFREQO PIC  X(0002).
  4068*    -------------------------------
  4069     05  FILLER            PIC  X(0003).
  4070     05  BPMTSO PIC  X(0003).
  4071*    -------------------------------
  4072     05  FILLER            PIC  X(0003).
  4073     05  BPMTAMTO PIC  ZZZZZ9.99.
  4074*    -------------------------------
  4075     05  FILLER            PIC  X(0003).
  4076     05  BAPRO PIC  99.9999.
  4077*    -------------------------------
  4078     05  FILLER            PIC  X(0003).
  4079     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4080*    -------------------------------
  4081     05  FILLER            PIC  X(0003).
  4082     05  BMEMCAPO PIC  X(0011).
  4083*    -------------------------------
  4084     05  FILLER            PIC  X(0003).
  4085     05  BORIGHDO PIC  X(0009).
  4086*    -------------------------------
  4087     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6311.cbl
  4088     05  DMDBILO PIC  X(0006).
  4089*    -------------------------------
  4090     05  FILLER            PIC  X(0003).
  4091     05  BFORCEO PIC  X(0001).
  4092*    -------------------------------
  4093     05  FILLER            PIC  X(0003).
  4094     05  BENTRYO PIC  X(0001).
  4095*    -------------------------------
  4096     05  FILLER            PIC  X(0003).
  4097     05  BREINO PIC  X(0001).
  4098*    -------------------------------
  4099     05  FILLER            PIC  X(0003).
  4100     05  BBILCDO PIC  X(0001).
  4101*    -------------------------------
  4102     05  FILLER            PIC  X(0003).
  4103     05  BUNWRITO PIC  X(0001).
  4104*    -------------------------------
  4105     05  FILLER            PIC  X(0003).
  4106     05  BSKPCDO PIC  X(0001).
  4107*    -------------------------------
  4108     05  FILLER            PIC  X(0003).
  4109     05  BINDGRPO PIC  X(0001).
  4110*    -------------------------------
  4111     05  FILLER            PIC  X(0003).
  4112     05  BSIGO PIC  X(0001).
  4113*    -------------------------------
  4114     05  FILLER            PIC  X(0003).
  4115     05  BRTCLSO PIC  X(0002).
  4116*    -------------------------------
  4117     05  FILLER            PIC  X(0003).
  4118     05  BCHGCNTO PIC  X(0003).
  4119*    -------------------------------
  4120     05  FILLER            PIC  X(0003).
  4121     05  BMEMBERO PIC  X(0012).
  4122*    -------------------------------
  4123     05  FILLER            PIC  X(0003).
  4124     05  BORGNOO PIC  X(0006).
  4125*    -------------------------------
  4126     05  FILLER            PIC  X(0003).
  4127     05  BORGSEQO PIC  X(0004).
  4128*    -------------------------------
  4129     05  FILLER            PIC  X(0003).
  4130     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4131*    -------------------------------
  4132     05  FILLER            PIC  X(0003).
  4133     05  BKIND1O PIC  X(0002).
  4134*    -------------------------------
  4135     05  FILLER            PIC  X(0003).
  4136     05  BTYPE1O PIC  X(0003).
  4137*    -------------------------------
  4138     05  FILLER            PIC  X(0003).
  4139     05  BTERM1O PIC  X(0003).
  4140*    -------------------------------
  4141     05  FILLER            PIC  X(0003).
  4142     05  BBEN1O PIC  X(0012).
  4143*    -------------------------------
  4144     05  FILLER            PIC  X(0003).
  4145     05  BPREM1O PIC  X(0011).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6311.cbl
  4146*    -------------------------------
  4147     05  FILLER            PIC  X(0003).
  4148     05  BEXPIR1O PIC  X(0008).
  4149*    -------------------------------
  4150     05  FILLER            PIC  X(0003).
  4151     05  BCP1O PIC  X(0002).
  4152*    -------------------------------
  4153     05  FILLER            PIC  X(0003).
  4154     05  BALTBN1O PIC  X(0012).
  4155*    -------------------------------
  4156     05  FILLER            PIC  X(0003).
  4157     05  BALTPR1O PIC  X(0011).
  4158*    -------------------------------
  4159     05  FILLER            PIC  X(0003).
  4160     05  BBNCD1O PIC  X(0003).
  4161*    -------------------------------
  4162     05  FILLER            PIC  X(0003).
  4163     05  BCPRM1O PIC  X(0011).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BCAPRM1O PIC  X(0011).
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  BENABR1O PIC  X(0005).
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BDIFF1O PIC  X(0011).
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BBILIT1O PIC  X(0008).
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BADIFF1O PIC  X(0011).
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BKIND2O PIC  X(0002).
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BTYPE2O PIC  X(0003).
  4185*    -------------------------------
  4186     05  FILLER            PIC  X(0003).
  4187     05  BTERM2O PIC  X(0003).
  4188*    -------------------------------
  4189     05  FILLER            PIC  X(0003).
  4190     05  BBEN2O PIC  X(0012).
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BPREM2O PIC  X(0011).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BEXPIR2O PIC  X(0008).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BCP2O PIC  X(0002).
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BALTBN2O PIC  X(0012).
  4203*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6311.cbl
  4204     05  FILLER            PIC  X(0003).
  4205     05  BALTPR2O PIC  X(0011).
  4206*    -------------------------------
  4207     05  FILLER            PIC  X(0003).
  4208     05  BBNCD2O PIC  X(0003).
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BCPRM2O PIC  X(0011).
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BCAPRM2O PIC  X(0011).
  4215*    -------------------------------
  4216     05  FILLER            PIC  X(0003).
  4217     05  BENABR2O PIC  X(0005).
  4218*    -------------------------------
  4219     05  FILLER            PIC  X(0003).
  4220     05  BDIFF2O PIC  X(0011).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BBILIT2O PIC  X(0008).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BADIFF2O PIC  X(0011).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BERMSG1O PIC  X(0078).
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BERMSG2O PIC  X(0078).
  4233*    -------------------------------
  4234     05  FILLER            PIC  X(0003).
  4235     05  BERMSG3O PIC  X(0078).
  4236*    -------------------------------
  4237     05  FILLER            PIC  X(0003).
  4238     05  BPFENTRO PIC  X(0002).
  4239*    -------------------------------
  4240     05  FILLER            PIC  X(0003).
  4241     05  BPF5HDRO PIC  X(0005).
  4242*    -------------------------------
  4243     05  FILLER            PIC  X(0003).
  4244     05  BPF4HDRO PIC  X(0013).
  4245*    -------------------------------
  4246     05  FILLER            PIC  X(0003).
  4247     05  BF15HDRO PIC  X(0010).
  4248*    -------------------------------
  4249 01  EL631CI REDEFINES EL631BI.
  4250     05  FILLER            PIC  X(0012).
  4251*    -------------------------------
  4252     05  CDATEL PIC S9(0004) COMP.
  4253     05  CDATEF PIC  X(0001).
  4254     05  FILLER REDEFINES CDATEF.
  4255         10  CDATEA PIC  X(0001).
  4256     05  CDATEI PIC  X(0008).
  4257*    -------------------------------
  4258     05  CTIMEL PIC S9(0004) COMP.
  4259     05  CTIMEF PIC  X(0001).
  4260     05  FILLER REDEFINES CTIMEF.
  4261         10  CTIMEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6311.cbl
  4262     05  CTIMEI PIC  X(0005).
  4263*    -------------------------------
  4264     05  CHEADL PIC S9(0004) COMP.
  4265     05  CHEADF PIC  X(0001).
  4266     05  FILLER REDEFINES CHEADF.
  4267         10  CHEADA PIC  X(0001).
  4268     05  CHEADI PIC  X(0038).
  4269*    -------------------------------
  4270     05  CCHGTL PIC S9(0004) COMP.
  4271     05  CCHGTF PIC  X(0001).
  4272     05  FILLER REDEFINES CCHGTF.
  4273         10  CCHGTA PIC  X(0001).
  4274     05  CCHGTI PIC  X(0004).
  4275*    -------------------------------
  4276     05  CCHGL PIC S9(0004) COMP.
  4277     05  CCHGF PIC  X(0001).
  4278     05  FILLER REDEFINES CCHGF.
  4279         10  CCHGA PIC  X(0001).
  4280     05  CCHGI PIC  X(0004).
  4281*    -------------------------------
  4282     05  CMAINTL PIC S9(0004) COMP.
  4283     05  CMAINTF PIC  X(0001).
  4284     05  FILLER REDEFINES CMAINTF.
  4285         10  CMAINTA PIC  X(0001).
  4286     05  CMAINTI PIC  X(0001).
  4287*    -------------------------------
  4288     05  CMANTBYL PIC S9(0004) COMP.
  4289     05  CMANTBYF PIC  X(0001).
  4290     05  FILLER REDEFINES CMANTBYF.
  4291         10  CMANTBYA PIC  X(0001).
  4292     05  CMANTBYI PIC  X(0004).
  4293*    -------------------------------
  4294     05  CCHGHDGL PIC S9(0004) COMP.
  4295     05  CCHGHDGF PIC  X(0001).
  4296     05  FILLER REDEFINES CCHGHDGF.
  4297         10  CCHGHDGA PIC  X(0001).
  4298     05  CCHGHDGI PIC  X(0003).
  4299*    -------------------------------
  4300     05  CMANTDTL PIC S9(0004) COMP.
  4301     05  CMANTDTF PIC  X(0001).
  4302     05  FILLER REDEFINES CMANTDTF.
  4303         10  CMANTDTA PIC  X(0001).
  4304     05  CMANTDTI PIC  X(0008).
  4305*    -------------------------------
  4306     05  CMANTATL PIC S9(0004) COMP.
  4307     05  CMANTATF PIC  X(0001).
  4308     05  FILLER REDEFINES CMANTATF.
  4309         10  CMANTATA PIC  X(0001).
  4310     05  CMANTATI PIC  X(0005).
  4311*    -------------------------------
  4312     05  CCSRL PIC S9(0004) COMP.
  4313     05  CCSRF PIC  X(0001).
  4314     05  FILLER REDEFINES CCSRF.
  4315         10  CCSRA PIC  X(0001).
  4316     05  CCSRI PIC  X(0004).
  4317*    -------------------------------
  4318     05  CBATCHL PIC S9(0004) COMP.
  4319     05  CBATCHF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6311.cbl
  4320     05  FILLER REDEFINES CBATCHF.
  4321         10  CBATCHA PIC  X(0001).
  4322     05  CBATCHI PIC  X(0006).
  4323*    -------------------------------
  4324     05  CSEQL PIC S9(0004) COMP.
  4325     05  CSEQF PIC  X(0001).
  4326     05  FILLER REDEFINES CSEQF.
  4327         10  CSEQA PIC  X(0001).
  4328     05  CSEQI PIC  X(0004).
  4329*    -------------------------------
  4330     05  CMOENDTL PIC S9(0004) COMP.
  4331     05  CMOENDTF PIC  X(0001).
  4332     05  FILLER REDEFINES CMOENDTF.
  4333         10  CMOENDTA PIC  X(0001).
  4334     05  CMOENDTI PIC  X(0008).
  4335*    -------------------------------
  4336     05  CCARRL PIC S9(0004) COMP.
  4337     05  CCARRF PIC  X(0001).
  4338     05  FILLER REDEFINES CCARRF.
  4339         10  CCARRA PIC  X(0001).
  4340     05  CCARRI PIC  X(0001).
  4341*    -------------------------------
  4342     05  CGROUPL PIC S9(0004) COMP.
  4343     05  CGROUPF PIC  X(0001).
  4344     05  FILLER REDEFINES CGROUPF.
  4345         10  CGROUPA PIC  X(0001).
  4346     05  CGROUPI PIC  X(0006).
  4347*    -------------------------------
  4348     05  CSTATEL PIC S9(0004) COMP.
  4349     05  CSTATEF PIC  X(0001).
  4350     05  FILLER REDEFINES CSTATEF.
  4351         10  CSTATEA PIC  X(0001).
  4352     05  CSTATEI PIC  X(0002).
  4353*    -------------------------------
  4354     05  CACCTL PIC S9(0004) COMP.
  4355     05  CACCTF PIC  X(0001).
  4356     05  FILLER REDEFINES CACCTF.
  4357         10  CACCTA PIC  X(0001).
  4358     05  CACCTI PIC  X(0010).
  4359*    -------------------------------
  4360     05  CORIGHDL PIC S9(0004) COMP.
  4361     05  CORIGHDF PIC  X(0001).
  4362     05  FILLER REDEFINES CORIGHDF.
  4363         10  CORIGHDA PIC  X(0001).
  4364     05  CORIGHDI PIC  X(0011).
  4365*    -------------------------------
  4366     05  CORGNOL PIC S9(0004) COMP.
  4367     05  CORGNOF PIC  X(0001).
  4368     05  FILLER REDEFINES CORGNOF.
  4369         10  CORGNOA PIC  X(0001).
  4370     05  CORGNOI PIC  X(0006).
  4371*    -------------------------------
  4372     05  CORGSEQL PIC S9(0004) COMP.
  4373     05  CORGSEQF PIC  X(0001).
  4374     05  FILLER REDEFINES CORGSEQF.
  4375         10  CORGSEQA PIC  X(0001).
  4376     05  CORGSEQI PIC  X(0004).
  4377*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6311.cbl
  4378     05  CREFHDGL PIC S9(0004) COMP.
  4379     05  CREFHDGF PIC  X(0001).
  4380     05  FILLER REDEFINES CREFHDGF.
  4381         10  CREFHDGA PIC  X(0001).
  4382     05  CREFHDGI PIC  X(0010).
  4383*    -------------------------------
  4384     05  CREFL PIC S9(0004) COMP.
  4385     05  CREFF PIC  X(0001).
  4386     05  FILLER REDEFINES CREFF.
  4387         10  CREFA PIC  X(0001).
  4388     05  CREFI PIC  X(0012).
  4389*    -------------------------------
  4390     05  CNHINTL PIC S9(0004) COMP.
  4391     05  CNHINTF PIC  X(0001).
  4392     05  FILLER REDEFINES CNHINTF.
  4393         10  CNHINTA PIC  X(0001).
  4394     05  CNHINTI PIC  9(7)V99.
  4395*    -------------------------------
  4396     05  CCERTNOL PIC S9(0004) COMP.
  4397     05  CCERTNOF PIC  X(0001).
  4398     05  FILLER REDEFINES CCERTNOF.
  4399         10  CCERTNOA PIC  X(0001).
  4400     05  CCERTNOI PIC  X(0010).
  4401*    -------------------------------
  4402     05  CSUFIXL PIC S9(0004) COMP.
  4403     05  CSUFIXF PIC  X(0001).
  4404     05  FILLER REDEFINES CSUFIXF.
  4405         10  CSUFIXA PIC  X(0001).
  4406     05  CSUFIXI PIC  X(0001).
  4407*    -------------------------------
  4408     05  CEFFDTL PIC S9(0004) COMP.
  4409     05  CEFFDTF PIC  X(0001).
  4410     05  FILLER REDEFINES CEFFDTF.
  4411         10  CEFFDTA PIC  X(0001).
  4412     05  CEFFDTI PIC  X(0008).
  4413*    -------------------------------
  4414     05  CLSTNML PIC S9(0004) COMP.
  4415     05  CLSTNMF PIC  X(0001).
  4416     05  FILLER REDEFINES CLSTNMF.
  4417         10  CLSTNMA PIC  X(0001).
  4418     05  CLSTNMI PIC  X(0015).
  4419*    -------------------------------
  4420     05  CPCYNL PIC S9(0004) COMP.
  4421     05  CPCYNF PIC  X(0001).
  4422     05  FILLER REDEFINES CPCYNF.
  4423         10  CPCYNA PIC  X(0001).
  4424     05  CPCYNI PIC  X(0001).
  4425*    -------------------------------
  4426     05  CINAMEL PIC S9(0004) COMP.
  4427     05  CINAMEF PIC  X(0001).
  4428     05  FILLER REDEFINES CINAMEF.
  4429         10  CINAMEA PIC  X(0001).
  4430     05  CINAMEI PIC  X(0015).
  4431*    -------------------------------
  4432     05  CINITSL PIC S9(0004) COMP.
  4433     05  CINITSF PIC  X(0001).
  4434     05  FILLER REDEFINES CINITSF.
  4435         10  CINITSA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6311.cbl
  4436     05  CINITSI PIC  X(0010).
  4437*    -------------------------------
  4438     05  CCANREAL PIC S9(0004) COMP.
  4439     05  CCANREAF PIC  X(0001).
  4440     05  FILLER REDEFINES CCANREAF.
  4441         10  CCANREAA PIC  X(0001).
  4442     05  CCANREAI PIC  X(0001).
  4443*    -------------------------------
  4444     05  CKIND1L PIC S9(0004) COMP.
  4445     05  CKIND1F PIC  X(0001).
  4446     05  FILLER REDEFINES CKIND1F.
  4447         10  CKIND1A PIC  X(0001).
  4448     05  CKIND1I PIC  X(0002).
  4449*    -------------------------------
  4450     05  CCANDT1L PIC S9(0004) COMP.
  4451     05  CCANDT1F PIC  X(0001).
  4452     05  FILLER REDEFINES CCANDT1F.
  4453         10  CCANDT1A PIC  X(0001).
  4454     05  CCANDT1I PIC  X(0008).
  4455*    -------------------------------
  4456     05  CREFND1L PIC S9(0004) COMP.
  4457     05  CREFND1F PIC  X(0001).
  4458     05  FILLER REDEFINES CREFND1F.
  4459         10  CREFND1A PIC  X(0001).
  4460     05  CREFND1I PIC  S9(9)V99.
  4461*    -------------------------------
  4462     05  CMTHD1L PIC S9(0004) COMP.
  4463     05  CMTHD1F PIC  X(0001).
  4464     05  FILLER REDEFINES CMTHD1F.
  4465         10  CMTHD1A PIC  X(0001).
  4466     05  CMTHD1I PIC  X(0001).
  4467*    -------------------------------
  4468     05  CKIND2L PIC S9(0004) COMP.
  4469     05  CKIND2F PIC  X(0001).
  4470     05  FILLER REDEFINES CKIND2F.
  4471         10  CKIND2A PIC  X(0001).
  4472     05  CKIND2I PIC  X(0002).
  4473*    -------------------------------
  4474     05  CCANDT2L PIC S9(0004) COMP.
  4475     05  CCANDT2F PIC  X(0001).
  4476     05  FILLER REDEFINES CCANDT2F.
  4477         10  CCANDT2A PIC  X(0001).
  4478     05  CCANDT2I PIC  X(0008).
  4479*    -------------------------------
  4480     05  CREFND2L PIC S9(0004) COMP.
  4481     05  CREFND2F PIC  X(0001).
  4482     05  FILLER REDEFINES CREFND2F.
  4483         10  CREFND2A PIC  X(0001).
  4484     05  CREFND2I PIC  S9(9)V99.
  4485*    -------------------------------
  4486     05  CMTHD2L PIC S9(0004) COMP.
  4487     05  CMTHD2F PIC  X(0001).
  4488     05  FILLER REDEFINES CMTHD2F.
  4489         10  CMTHD2A PIC  X(0001).
  4490     05  CMTHD2I PIC  X(0001).
  4491*    -------------------------------
  4492     05  CLIVESL PIC S9(0004) COMP.
  4493     05  CLIVESF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6311.cbl
  4494     05  FILLER REDEFINES CLIVESF.
  4495         10  CLIVESA PIC  X(0001).
  4496     05  CLIVESI PIC  X(0003).
  4497*    -------------------------------
  4498     05  CFORCEL PIC S9(0004) COMP.
  4499     05  CFORCEF PIC  X(0001).
  4500     05  FILLER REDEFINES CFORCEF.
  4501         10  CFORCEA PIC  X(0001).
  4502     05  CFORCEI PIC  X(0001).
  4503*    -------------------------------
  4504     05  CBILCDL PIC S9(0004) COMP.
  4505     05  CBILCDF PIC  X(0001).
  4506     05  FILLER REDEFINES CBILCDF.
  4507         10  CBILCDA PIC  X(0001).
  4508     05  CBILCDI PIC  X(0001).
  4509*    -------------------------------
  4510     05  CCRFND1L PIC S9(0004) COMP.
  4511     05  CCRFND1F PIC  X(0001).
  4512     05  FILLER REDEFINES CCRFND1F.
  4513         10  CCRFND1A PIC  X(0001).
  4514     05  CCRFND1I PIC  X(0011).
  4515*    -------------------------------
  4516     05  CCRFND2L PIC S9(0004) COMP.
  4517     05  CCRFND2F PIC  X(0001).
  4518     05  FILLER REDEFINES CCRFND2F.
  4519         10  CCRFND2A PIC  X(0001).
  4520     05  CCRFND2I PIC  X(0011).
  4521*    -------------------------------
  4522     05  CBILIT1L PIC S9(0004) COMP.
  4523     05  CBILIT1F PIC  X(0001).
  4524     05  FILLER REDEFINES CBILIT1F.
  4525         10  CBILIT1A PIC  X(0001).
  4526     05  CBILIT1I PIC  X(0008).
  4527*    -------------------------------
  4528     05  CDRFND1L PIC S9(0004) COMP.
  4529     05  CDRFND1F PIC  X(0001).
  4530     05  FILLER REDEFINES CDRFND1F.
  4531         10  CDRFND1A PIC  X(0001).
  4532     05  CDRFND1I PIC  X(0011).
  4533*    -------------------------------
  4534     05  CBILIT2L PIC S9(0004) COMP.
  4535     05  CBILIT2F PIC  X(0001).
  4536     05  FILLER REDEFINES CBILIT2F.
  4537         10  CBILIT2A PIC  X(0001).
  4538     05  CBILIT2I PIC  X(0008).
  4539*    -------------------------------
  4540     05  CDRFND2L PIC S9(0004) COMP.
  4541     05  CDRFND2F PIC  X(0001).
  4542     05  FILLER REDEFINES CDRFND2F.
  4543         10  CDRFND2A PIC  X(0001).
  4544     05  CDRFND2I PIC  X(0011).
  4545*    -------------------------------
  4546     05  CCANTXTL PIC S9(0004) COMP.
  4547     05  CCANTXTF PIC  X(0001).
  4548     05  FILLER REDEFINES CCANTXTF.
  4549         10  CCANTXTA PIC  X(0001).
  4550     05  CCANTXTI PIC  X(0005).
  4551*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6311.cbl
  4552     05  CCANFEEL PIC S9(0004) COMP.
  4553     05  CCANFEEF PIC  X(0001).
  4554     05  FILLER REDEFINES CCANFEEF.
  4555         10  CCANFEEA PIC  X(0001).
  4556     05  CCANFEEI PIC  X(0002).
  4557*    -------------------------------
  4558     05  CTERM1L PIC S9(0004) COMP.
  4559     05  CTERM1F PIC  X(0001).
  4560     05  FILLER REDEFINES CTERM1F.
  4561         10  CTERM1A PIC  X(0001).
  4562     05  CTERM1I PIC  X(0003).
  4563*    -------------------------------
  4564     05  CRTERM1L PIC S9(0004) COMP.
  4565     05  CRTERM1F PIC  X(0001).
  4566     05  FILLER REDEFINES CRTERM1F.
  4567         10  CRTERM1A PIC  X(0001).
  4568     05  CRTERM1I PIC  X(0003).
  4569*    -------------------------------
  4570     05  CPREM1L PIC S9(0004) COMP.
  4571     05  CPREM1F PIC  X(0001).
  4572     05  FILLER REDEFINES CPREM1F.
  4573         10  CPREM1A PIC  X(0001).
  4574     05  CPREM1I PIC  X(0011).
  4575*    -------------------------------
  4576     05  CTERM2L PIC S9(0004) COMP.
  4577     05  CTERM2F PIC  X(0001).
  4578     05  FILLER REDEFINES CTERM2F.
  4579         10  CTERM2A PIC  X(0001).
  4580     05  CTERM2I PIC  X(0003).
  4581*    -------------------------------
  4582     05  CRTERM2L PIC S9(0004) COMP.
  4583     05  CRTERM2F PIC  X(0001).
  4584     05  FILLER REDEFINES CRTERM2F.
  4585         10  CRTERM2A PIC  X(0001).
  4586     05  CRTERM2I PIC  X(0003).
  4587*    -------------------------------
  4588     05  CPREM2L PIC S9(0004) COMP.
  4589     05  CPREM2F PIC  X(0001).
  4590     05  FILLER REDEFINES CPREM2F.
  4591         10  CPREM2A PIC  X(0001).
  4592     05  CPREM2I PIC  X(0011).
  4593*    -------------------------------
  4594     05  CENTRDTL PIC S9(0004) COMP.
  4595     05  CENTRDTF PIC  X(0001).
  4596     05  FILLER REDEFINES CENTRDTF.
  4597         10  CENTRDTA PIC  X(0001).
  4598     05  CENTRDTI PIC  X(0008).
  4599*    -------------------------------
  4600     05  CPAYEEL PIC S9(0004) COMP.
  4601     05  CPAYEEF PIC  X(0001).
  4602     05  FILLER REDEFINES CPAYEEF.
  4603         10  CPAYEEA PIC  X(0001).
  4604     05  CPAYEEI PIC  X(0006).
  4605*    -------------------------------
  4606     05  CRFNDSWL PIC S9(0004) COMP.
  4607     05  CRFNDSWF PIC  X(0001).
  4608     05  FILLER REDEFINES CRFNDSWF.
  4609         10  CRFNDSWA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6311.cbl
  4610     05  CRFNDSWI PIC  X(0003).
  4611*    -------------------------------
  4612     05  CLFHDGL PIC S9(0004) COMP.
  4613     05  CLFHDGF PIC  X(0001).
  4614     05  FILLER REDEFINES CLFHDGF.
  4615         10  CLFHDGA PIC  X(0001).
  4616     05  CLFHDGI PIC  X(0006).
  4617*    -------------------------------
  4618     05  CAHHDGL PIC S9(0004) COMP.
  4619     05  CAHHDGF PIC  X(0001).
  4620     05  FILLER REDEFINES CAHHDGF.
  4621         10  CAHHDGA PIC  X(0001).
  4622     05  CAHHDGI PIC  X(0006).
  4623*    -------------------------------
  4624     05  CENTDTL PIC S9(0004) COMP.
  4625     05  CENTDTF PIC  X(0001).
  4626     05  FILLER REDEFINES CENTDTF.
  4627         10  CENTDTA PIC  X(0001).
  4628     05  CENTDTI PIC  X(0008).
  4629*    -------------------------------
  4630     05  CENTBYL PIC S9(0004) COMP.
  4631     05  CENTBYF PIC  X(0001).
  4632     05  FILLER REDEFINES CENTBYF.
  4633         10  CENTBYA PIC  X(0001).
  4634     05  CENTBYI PIC  X(0004).
  4635*    -------------------------------
  4636     05  CCHGCNTL PIC S9(0004) COMP.
  4637     05  CCHGCNTF PIC  X(0001).
  4638     05  FILLER REDEFINES CCHGCNTF.
  4639         10  CCHGCNTA PIC  X(0001).
  4640     05  CCHGCNTI PIC  X(0003).
  4641*    -------------------------------
  4642     05  CLFREFNL PIC S9(0004) COMP.
  4643     05  CLFREFNF PIC  X(0001).
  4644     05  FILLER REDEFINES CLFREFNF.
  4645         10  CLFREFNA PIC  X(0001).
  4646     05  CLFREFNI PIC  X(0006).
  4647*    -------------------------------
  4648     05  CAHREFNL PIC S9(0004) COMP.
  4649     05  CAHREFNF PIC  X(0001).
  4650     05  FILLER REDEFINES CAHREFNF.
  4651         10  CAHREFNA PIC  X(0001).
  4652     05  CAHREFNI PIC  X(0006).
  4653*    -------------------------------
  4654     05  CREINCDL PIC S9(0004) COMP.
  4655     05  CREINCDF PIC  X(0001).
  4656     05  FILLER REDEFINES CREINCDF.
  4657         10  CREINCDA PIC  X(0001).
  4658     05  CREINCDI PIC  X(0003).
  4659*    -------------------------------
  4660     05  CAEFFDTL PIC S9(0004) COMP.
  4661     05  CAEFFDTF PIC  X(0001).
  4662     05  FILLER REDEFINES CAEFFDTF.
  4663         10  CAEFFDTA PIC  X(0001).
  4664     05  CAEFFDTI PIC  X(0008).
  4665*    -------------------------------
  4666     05  CAEXPDTL PIC S9(0004) COMP.
  4667     05  CAEXPDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6311.cbl
  4668     05  FILLER REDEFINES CAEXPDTF.
  4669         10  CAEXPDTA PIC  X(0001).
  4670     05  CAEXPDTI PIC  X(0008).
  4671*    -------------------------------
  4672     05  COMMLFL PIC S9(0004) COMP.
  4673     05  COMMLFF PIC  X(0001).
  4674     05  FILLER REDEFINES COMMLFF.
  4675         10  COMMLFA PIC  X(0001).
  4676     05  COMMLFI PIC  X(0006).
  4677*    -------------------------------
  4678     05  COMMAHL PIC S9(0004) COMP.
  4679     05  COMMAHF PIC  X(0001).
  4680     05  FILLER REDEFINES COMMAHF.
  4681         10  COMMAHA PIC  X(0001).
  4682     05  COMMAHI PIC  X(0006).
  4683*    -------------------------------
  4684     05  CERMSG1L PIC S9(0004) COMP.
  4685     05  CERMSG1F PIC  X(0001).
  4686     05  FILLER REDEFINES CERMSG1F.
  4687         10  CERMSG1A PIC  X(0001).
  4688     05  CERMSG1I PIC  X(0078).
  4689*    -------------------------------
  4690     05  CERMSG2L PIC S9(0004) COMP.
  4691     05  CERMSG2F PIC  X(0001).
  4692     05  FILLER REDEFINES CERMSG2F.
  4693         10  CERMSG2A PIC  X(0001).
  4694     05  CERMSG2I PIC  X(0078).
  4695*    -------------------------------
  4696     05  CERMSG3L PIC S9(0004) COMP.
  4697     05  CERMSG3F PIC  X(0001).
  4698     05  FILLER REDEFINES CERMSG3F.
  4699         10  CERMSG3A PIC  X(0001).
  4700     05  CERMSG3I PIC  X(0078).
  4701*    -------------------------------
  4702     05  CPFENTRL PIC S9(0004) COMP.
  4703     05  CPFENTRF PIC  X(0001).
  4704     05  FILLER REDEFINES CPFENTRF.
  4705         10  CPFENTRA PIC  X(0001).
  4706     05  CPFENTRI PIC  9(2).
  4707*    -------------------------------
  4708     05  CPF5HDRL PIC S9(0004) COMP.
  4709     05  CPF5HDRF PIC  X(0001).
  4710     05  FILLER REDEFINES CPF5HDRF.
  4711         10  CPF5HDRA PIC  X(0001).
  4712     05  CPF5HDRI PIC  X(0005).
  4713*    -------------------------------
  4714     05  CPF4HDRL PIC S9(0004) COMP.
  4715     05  CPF4HDRF PIC  X(0001).
  4716     05  FILLER REDEFINES CPF4HDRF.
  4717         10  CPF4HDRA PIC  X(0001).
  4718     05  CPF4HDRI PIC  X(0013).
  4719*    -------------------------------
  4720     05  CF15HDRL PIC S9(0004) COMP.
  4721     05  CF15HDRF PIC  X(0001).
  4722     05  FILLER REDEFINES CF15HDRF.
  4723         10  CF15HDRA PIC  X(0001).
  4724     05  CF15HDRI PIC  X(0022).
  4725 01  EL631CO REDEFINES EL631BI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6311.cbl
  4726     05  FILLER            PIC  X(0012).
  4727*    -------------------------------
  4728     05  FILLER            PIC  X(0003).
  4729     05  CDATEO PIC  X(0008).
  4730*    -------------------------------
  4731     05  FILLER            PIC  X(0003).
  4732     05  CTIMEO PIC  99.99.
  4733*    -------------------------------
  4734     05  FILLER            PIC  X(0003).
  4735     05  CHEADO PIC  X(0038).
  4736*    -------------------------------
  4737     05  FILLER            PIC  X(0003).
  4738     05  CCHGTO PIC  X(0004).
  4739*    -------------------------------
  4740     05  FILLER            PIC  X(0003).
  4741     05  CCHGO PIC  ZZZ9.
  4742*    -------------------------------
  4743     05  FILLER            PIC  X(0003).
  4744     05  CMAINTO PIC  X(0001).
  4745*    -------------------------------
  4746     05  FILLER            PIC  X(0003).
  4747     05  CMANTBYO PIC  X(0004).
  4748*    -------------------------------
  4749     05  FILLER            PIC  X(0003).
  4750     05  CCHGHDGO PIC  X(0003).
  4751*    -------------------------------
  4752     05  FILLER            PIC  X(0003).
  4753     05  CMANTDTO PIC  X(0008).
  4754*    -------------------------------
  4755     05  FILLER            PIC  X(0003).
  4756     05  CMANTATO PIC  99.99.
  4757*    -------------------------------
  4758     05  FILLER            PIC  X(0003).
  4759     05  CCSRO PIC  X(0004).
  4760*    -------------------------------
  4761     05  FILLER            PIC  X(0003).
  4762     05  CBATCHO PIC  X(0006).
  4763*    -------------------------------
  4764     05  FILLER            PIC  X(0003).
  4765     05  CSEQO PIC  X(0004).
  4766*    -------------------------------
  4767     05  FILLER            PIC  X(0003).
  4768     05  CMOENDTO PIC  X(0008).
  4769*    -------------------------------
  4770     05  FILLER            PIC  X(0003).
  4771     05  CCARRO PIC  X(0001).
  4772*    -------------------------------
  4773     05  FILLER            PIC  X(0003).
  4774     05  CGROUPO PIC  X(0006).
  4775*    -------------------------------
  4776     05  FILLER            PIC  X(0003).
  4777     05  CSTATEO PIC  X(0002).
  4778*    -------------------------------
  4779     05  FILLER            PIC  X(0003).
  4780     05  CACCTO PIC  X(0010).
  4781*    -------------------------------
  4782     05  FILLER            PIC  X(0003).
  4783     05  CORIGHDO PIC  X(0011).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6311.cbl
  4784*    -------------------------------
  4785     05  FILLER            PIC  X(0003).
  4786     05  CORGNOO PIC  X(0006).
  4787*    -------------------------------
  4788     05  FILLER            PIC  X(0003).
  4789     05  CORGSEQO PIC  X(0004).
  4790*    -------------------------------
  4791     05  FILLER            PIC  X(0003).
  4792     05  CREFHDGO PIC  X(0010).
  4793*    -------------------------------
  4794     05  FILLER            PIC  X(0003).
  4795     05  CREFO PIC  X(0012).
  4796*    -------------------------------
  4797     05  FILLER            PIC  X(0003).
  4798     05  CNHINTO PIC  999999.99.
  4799*    -------------------------------
  4800     05  FILLER            PIC  X(0003).
  4801     05  CCERTNOO PIC  X(0010).
  4802*    -------------------------------
  4803     05  FILLER            PIC  X(0003).
  4804     05  CSUFIXO PIC  X(0001).
  4805*    -------------------------------
  4806     05  FILLER            PIC  X(0003).
  4807     05  CEFFDTO PIC  X(0008).
  4808*    -------------------------------
  4809     05  FILLER            PIC  X(0003).
  4810     05  CLSTNMO PIC  X(0015).
  4811*    -------------------------------
  4812     05  FILLER            PIC  X(0003).
  4813     05  CPCYNO PIC  X(0001).
  4814*    -------------------------------
  4815     05  FILLER            PIC  X(0003).
  4816     05  CINAMEO PIC  X(0015).
  4817*    -------------------------------
  4818     05  FILLER            PIC  X(0003).
  4819     05  CINITSO PIC  X(0010).
  4820*    -------------------------------
  4821     05  FILLER            PIC  X(0003).
  4822     05  CCANREAO PIC  X(0001).
  4823*    -------------------------------
  4824     05  FILLER            PIC  X(0003).
  4825     05  CKIND1O PIC  X(0002).
  4826*    -------------------------------
  4827     05  FILLER            PIC  X(0003).
  4828     05  CCANDT1O PIC  X(0008).
  4829*    -------------------------------
  4830     05  FILLER            PIC  X(0003).
  4831     05  CREFND1O PIC  Z(7).99-.
  4832*    -------------------------------
  4833     05  FILLER            PIC  X(0003).
  4834     05  CMTHD1O PIC  X(0001).
  4835*    -------------------------------
  4836     05  FILLER            PIC  X(0003).
  4837     05  CKIND2O PIC  X(0002).
  4838*    -------------------------------
  4839     05  FILLER            PIC  X(0003).
  4840     05  CCANDT2O PIC  X(0008).
  4841*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6311.cbl
  4842     05  FILLER            PIC  X(0003).
  4843     05  CREFND2O PIC  Z(7).99-.
  4844*    -------------------------------
  4845     05  FILLER            PIC  X(0003).
  4846     05  CMTHD2O PIC  X(0001).
  4847*    -------------------------------
  4848     05  FILLER            PIC  X(0003).
  4849     05  CLIVESO PIC  X(0003).
  4850*    -------------------------------
  4851     05  FILLER            PIC  X(0003).
  4852     05  CFORCEO PIC  X(0001).
  4853*    -------------------------------
  4854     05  FILLER            PIC  X(0003).
  4855     05  CBILCDO PIC  X(0001).
  4856*    -------------------------------
  4857     05  FILLER            PIC  X(0003).
  4858     05  CCRFND1O PIC  Z(7).99-.
  4859*    -------------------------------
  4860     05  FILLER            PIC  X(0003).
  4861     05  CCRFND2O PIC  Z(7).99-.
  4862*    -------------------------------
  4863     05  FILLER            PIC  X(0003).
  4864     05  CBILIT1O PIC  X(0008).
  4865*    -------------------------------
  4866     05  FILLER            PIC  X(0003).
  4867     05  CDRFND1O PIC  Z(7).99-.
  4868*    -------------------------------
  4869     05  FILLER            PIC  X(0003).
  4870     05  CBILIT2O PIC  X(0008).
  4871*    -------------------------------
  4872     05  FILLER            PIC  X(0003).
  4873     05  CDRFND2O PIC  Z(7).99-.
  4874*    -------------------------------
  4875     05  FILLER            PIC  X(0003).
  4876     05  CCANTXTO PIC  X(0005).
  4877*    -------------------------------
  4878     05  FILLER            PIC  X(0003).
  4879     05  CCANFEEO PIC  Z9.
  4880*    -------------------------------
  4881     05  FILLER            PIC  X(0003).
  4882     05  CTERM1O PIC  ZZ9.
  4883*    -------------------------------
  4884     05  FILLER            PIC  X(0003).
  4885     05  CRTERM1O PIC  ZZ9.
  4886*    -------------------------------
  4887     05  FILLER            PIC  X(0003).
  4888     05  CPREM1O PIC  ZZZZZZ9.99-.
  4889*    -------------------------------
  4890     05  FILLER            PIC  X(0003).
  4891     05  CTERM2O PIC  ZZ9.
  4892*    -------------------------------
  4893     05  FILLER            PIC  X(0003).
  4894     05  CRTERM2O PIC  ZZ9.
  4895*    -------------------------------
  4896     05  FILLER            PIC  X(0003).
  4897     05  CPREM2O PIC  ZZZZZZ9.99-.
  4898*    -------------------------------
  4899     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6311.cbl
  4900     05  CENTRDTO PIC  X(0008).
  4901*    -------------------------------
  4902     05  FILLER            PIC  X(0003).
  4903     05  CPAYEEO PIC  X(0006).
  4904*    -------------------------------
  4905     05  FILLER            PIC  X(0003).
  4906     05  CRFNDSWO PIC  X(0003).
  4907*    -------------------------------
  4908     05  FILLER            PIC  X(0003).
  4909     05  CLFHDGO PIC  X(0006).
  4910*    -------------------------------
  4911     05  FILLER            PIC  X(0003).
  4912     05  CAHHDGO PIC  X(0006).
  4913*    -------------------------------
  4914     05  FILLER            PIC  X(0003).
  4915     05  CENTDTO PIC  X(0008).
  4916*    -------------------------------
  4917     05  FILLER            PIC  X(0003).
  4918     05  CENTBYO PIC  X(0004).
  4919*    -------------------------------
  4920     05  FILLER            PIC  X(0003).
  4921     05  CCHGCNTO PIC  X(0003).
  4922*    -------------------------------
  4923     05  FILLER            PIC  X(0003).
  4924     05  CLFREFNO PIC  X(0006).
  4925*    -------------------------------
  4926     05  FILLER            PIC  X(0003).
  4927     05  CAHREFNO PIC  X(0006).
  4928*    -------------------------------
  4929     05  FILLER            PIC  X(0003).
  4930     05  CREINCDO PIC  X(0003).
  4931*    -------------------------------
  4932     05  FILLER            PIC  X(0003).
  4933     05  CAEFFDTO PIC  X(0008).
  4934*    -------------------------------
  4935     05  FILLER            PIC  X(0003).
  4936     05  CAEXPDTO PIC  X(0008).
  4937*    -------------------------------
  4938     05  FILLER            PIC  X(0003).
  4939     05  COMMLFO PIC  .99999.
  4940*    -------------------------------
  4941     05  FILLER            PIC  X(0003).
  4942     05  COMMAHO PIC  .99999.
  4943*    -------------------------------
  4944     05  FILLER            PIC  X(0003).
  4945     05  CERMSG1O PIC  X(0078).
  4946*    -------------------------------
  4947     05  FILLER            PIC  X(0003).
  4948     05  CERMSG2O PIC  X(0078).
  4949*    -------------------------------
  4950     05  FILLER            PIC  X(0003).
  4951     05  CERMSG3O PIC  X(0078).
  4952*    -------------------------------
  4953     05  FILLER            PIC  X(0003).
  4954     05  CPFENTRO PIC  X(0002).
  4955*    -------------------------------
  4956     05  FILLER            PIC  X(0003).
  4957     05  CPF5HDRO PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6311.cbl
  4958*    -------------------------------
  4959     05  FILLER            PIC  X(0003).
  4960     05  CPF4HDRO PIC  X(0013).
  4961*    -------------------------------
  4962     05  FILLER            PIC  X(0003).
  4963     05  CF15HDRO PIC  X(0022).
  4964*    -------------------------------
  4965 01  EL631DI REDEFINES EL631BI.
  4966     05  FILLER            PIC  X(0012).
  4967*    -------------------------------
  4968     05  DDATEL PIC S9(0004) COMP.
  4969     05  DDATEF PIC  X(0001).
  4970     05  FILLER REDEFINES DDATEF.
  4971         10  DDATEA PIC  X(0001).
  4972     05  DDATEI PIC  X(0008).
  4973*    -------------------------------
  4974     05  DTIMEL PIC S9(0004) COMP.
  4975     05  DTIMEF PIC  X(0001).
  4976     05  FILLER REDEFINES DTIMEF.
  4977         10  DTIMEA PIC  X(0001).
  4978     05  DTIMEI PIC  X(0005).
  4979*    -------------------------------
  4980     05  DHEADL PIC S9(0004) COMP.
  4981     05  DHEADF PIC  X(0001).
  4982     05  FILLER REDEFINES DHEADF.
  4983         10  DHEADA PIC  X(0001).
  4984     05  DHEADI PIC  X(0038).
  4985*    -------------------------------
  4986     05  DLDATEL PIC S9(0004) COMP.
  4987     05  DLDATEF PIC  X(0001).
  4988     05  FILLER REDEFINES DLDATEF.
  4989         10  DLDATEA PIC  X(0001).
  4990     05  DLDATEI PIC  X(0010).
  4991*    -------------------------------
  4992     05  DBATCHL PIC S9(0004) COMP.
  4993     05  DBATCHF PIC  X(0001).
  4994     05  FILLER REDEFINES DBATCHF.
  4995         10  DBATCHA PIC  X(0001).
  4996     05  DBATCHI PIC  X(0011).
  4997*    -------------------------------
  4998     05  DACCTNML PIC S9(0004) COMP.
  4999     05  DACCTNMF PIC  X(0001).
  5000     05  FILLER REDEFINES DACCTNMF.
  5001         10  DACCTNMA PIC  X(0001).
  5002     05  DACCTNMI PIC  X(0030).
  5003*    -------------------------------
  5004     05  DPROCDTL PIC S9(0004) COMP.
  5005     05  DPROCDTF PIC  X(0001).
  5006     05  FILLER REDEFINES DPROCDTF.
  5007         10  DPROCDTA PIC  X(0001).
  5008     05  DPROCDTI PIC  X(0008).
  5009*    -------------------------------
  5010     05  DINPUTL PIC S9(0004) COMP.
  5011     05  DINPUTF PIC  X(0001).
  5012     05  FILLER REDEFINES DINPUTF.
  5013         10  DINPUTA PIC  X(0001).
  5014     05  DINPUTI PIC  X(0008).
  5015*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6311.cbl
  5016     05  DMAINDTL PIC S9(0004) COMP.
  5017     05  DMAINDTF PIC  X(0001).
  5018     05  FILLER REDEFINES DMAINDTF.
  5019         10  DMAINDTA PIC  X(0001).
  5020     05  DMAINDTI PIC  X(0008).
  5021*    -------------------------------
  5022     05  DCARRL PIC S9(0004) COMP.
  5023     05  DCARRF PIC  X(0001).
  5024     05  FILLER REDEFINES DCARRF.
  5025         10  DCARRA PIC  X(0001).
  5026     05  DCARRI PIC  X(0001).
  5027*    -------------------------------
  5028     05  DGROUPL PIC S9(0004) COMP.
  5029     05  DGROUPF PIC  X(0001).
  5030     05  FILLER REDEFINES DGROUPF.
  5031         10  DGROUPA PIC  X(0001).
  5032     05  DGROUPI PIC  X(0006).
  5033*    -------------------------------
  5034     05  DSTATEL PIC S9(0004) COMP.
  5035     05  DSTATEF PIC  X(0001).
  5036     05  FILLER REDEFINES DSTATEF.
  5037         10  DSTATEA PIC  X(0001).
  5038     05  DSTATEI PIC  X(0002).
  5039*    -------------------------------
  5040     05  DACCTL PIC S9(0004) COMP.
  5041     05  DACCTF PIC  X(0001).
  5042     05  FILLER REDEFINES DACCTF.
  5043         10  DACCTA PIC  X(0001).
  5044     05  DACCTI PIC  X(0010).
  5045*    -------------------------------
  5046     05  DRECVDTL PIC S9(0004) COMP.
  5047     05  DRECVDTF PIC  X(0001).
  5048     05  FILLER REDEFINES DRECVDTF.
  5049         10  DRECVDTA PIC  X(0001).
  5050     05  DRECVDTI PIC  X(0008).
  5051*    -------------------------------
  5052     05  DCSRL PIC S9(0004) COMP.
  5053     05  DCSRF PIC  X(0001).
  5054     05  FILLER REDEFINES DCSRF.
  5055         10  DCSRA PIC  X(0001).
  5056     05  DCSRI PIC  X(0004).
  5057*    -------------------------------
  5058     05  DREFHDGL PIC S9(0004) COMP.
  5059     05  DREFHDGF PIC  X(0001).
  5060     05  FILLER REDEFINES DREFHDGF.
  5061         10  DREFHDGA PIC  X(0001).
  5062     05  DREFHDGI PIC  X(0010).
  5063*    -------------------------------
  5064     05  DREFL PIC S9(0004) COMP.
  5065     05  DREFF PIC  X(0001).
  5066     05  FILLER REDEFINES DREFF.
  5067         10  DREFA PIC  X(0001).
  5068     05  DREFI PIC  X(0012).
  5069*    -------------------------------
  5070     05  DLFPHDGL PIC S9(0004) COMP.
  5071     05  DLFPHDGF PIC  X(0001).
  5072     05  FILLER REDEFINES DLFPHDGF.
  5073         10  DLFPHDGA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6311.cbl
  5074     05  DLFPHDGI PIC  X(0010).
  5075*    -------------------------------
  5076     05  DAHPHDGL PIC S9(0004) COMP.
  5077     05  DAHPHDGF PIC  X(0001).
  5078     05  FILLER REDEFINES DAHPHDGF.
  5079         10  DAHPHDGA PIC  X(0001).
  5080     05  DAHPHDGI PIC  X(0010).
  5081*    -------------------------------
  5082     05  DLFRHDGL PIC S9(0004) COMP.
  5083     05  DLFRHDGF PIC  X(0001).
  5084     05  FILLER REDEFINES DLFRHDGF.
  5085         10  DLFRHDGA PIC  X(0001).
  5086     05  DLFRHDGI PIC  X(0009).
  5087*    -------------------------------
  5088     05  DAHRHDGL PIC S9(0004) COMP.
  5089     05  DAHRHDGF PIC  X(0001).
  5090     05  FILLER REDEFINES DAHRHDGF.
  5091         10  DAHRHDGA PIC  X(0001).
  5092     05  DAHRHDGI PIC  X(0009).
  5093*    -------------------------------
  5094     05  DRISSL PIC S9(0004) COMP.
  5095     05  DRISSF PIC  X(0001).
  5096     05  FILLER REDEFINES DRISSF.
  5097         10  DRISSA PIC  X(0001).
  5098     05  DRISSI PIC  X(0005).
  5099*    -------------------------------
  5100     05  DRLFPRML PIC S9(0004) COMP.
  5101     05  DRLFPRMF PIC  X(0001).
  5102     05  FILLER REDEFINES DRLFPRMF.
  5103         10  DRLFPRMA PIC  X(0001).
  5104     05  DRLFPRMI PIC  S9(9)V99.
  5105*    -------------------------------
  5106     05  DRAHPRML PIC S9(0004) COMP.
  5107     05  DRAHPRMF PIC  X(0001).
  5108     05  FILLER REDEFINES DRAHPRMF.
  5109         10  DRAHPRMA PIC  X(0001).
  5110     05  DRAHPRMI PIC  S9(9)V99.
  5111*    -------------------------------
  5112     05  DRCANCL PIC S9(0004) COMP.
  5113     05  DRCANCF PIC  X(0001).
  5114     05  FILLER REDEFINES DRCANCF.
  5115         10  DRCANCA PIC  X(0001).
  5116     05  DRCANCI PIC  X(0005).
  5117*    -------------------------------
  5118     05  DRLFRFDL PIC S9(0004) COMP.
  5119     05  DRLFRFDF PIC  X(0001).
  5120     05  FILLER REDEFINES DRLFRFDF.
  5121         10  DRLFRFDA PIC  X(0001).
  5122     05  DRLFRFDI PIC  S9(9)V99.
  5123*    -------------------------------
  5124     05  DRAHRFDL PIC S9(0004) COMP.
  5125     05  DRAHRFDF PIC  X(0001).
  5126     05  FILLER REDEFINES DRAHRFDF.
  5127         10  DRAHRFDA PIC  X(0001).
  5128     05  DRAHRFDI PIC  S9(9)V99.
  5129*    -------------------------------
  5130     05  DEISSL PIC S9(0004) COMP.
  5131     05  DEISSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6311.cbl
  5132     05  FILLER REDEFINES DEISSF.
  5133         10  DEISSA PIC  X(0001).
  5134     05  DEISSI PIC  X(0005).
  5135*    -------------------------------
  5136     05  DELFPRML PIC S9(0004) COMP.
  5137     05  DELFPRMF PIC  X(0001).
  5138     05  FILLER REDEFINES DELFPRMF.
  5139         10  DELFPRMA PIC  X(0001).
  5140     05  DELFPRMI PIC  X(0011).
  5141*    -------------------------------
  5142     05  DEAHPRML PIC S9(0004) COMP.
  5143     05  DEAHPRMF PIC  X(0001).
  5144     05  FILLER REDEFINES DEAHPRMF.
  5145         10  DEAHPRMA PIC  X(0001).
  5146     05  DEAHPRMI PIC  X(0011).
  5147*    -------------------------------
  5148     05  DECANCL PIC S9(0004) COMP.
  5149     05  DECANCF PIC  X(0001).
  5150     05  FILLER REDEFINES DECANCF.
  5151         10  DECANCA PIC  X(0001).
  5152     05  DECANCI PIC  X(0005).
  5153*    -------------------------------
  5154     05  DELFRFDL PIC S9(0004) COMP.
  5155     05  DELFRFDF PIC  X(0001).
  5156     05  FILLER REDEFINES DELFRFDF.
  5157         10  DELFRFDA PIC  X(0001).
  5158     05  DELFRFDI PIC  X(0011).
  5159*    -------------------------------
  5160     05  DEAHRFDL PIC S9(0004) COMP.
  5161     05  DEAHRFDF PIC  X(0001).
  5162     05  FILLER REDEFINES DEAHRFDF.
  5163         10  DEAHRFDA PIC  X(0001).
  5164     05  DEAHRFDI PIC  X(0011).
  5165*    -------------------------------
  5166     05  DCISSL PIC S9(0004) COMP.
  5167     05  DCISSF PIC  X(0001).
  5168     05  FILLER REDEFINES DCISSF.
  5169         10  DCISSA PIC  X(0001).
  5170     05  DCISSI PIC  X(0005).
  5171*    -------------------------------
  5172     05  DCLFPRML PIC S9(0004) COMP.
  5173     05  DCLFPRMF PIC  X(0001).
  5174     05  FILLER REDEFINES DCLFPRMF.
  5175         10  DCLFPRMA PIC  X(0001).
  5176     05  DCLFPRMI PIC  X(0011).
  5177*    -------------------------------
  5178     05  DCAHPRML PIC S9(0004) COMP.
  5179     05  DCAHPRMF PIC  X(0001).
  5180     05  FILLER REDEFINES DCAHPRMF.
  5181         10  DCAHPRMA PIC  X(0001).
  5182     05  DCAHPRMI PIC  X(0011).
  5183*    -------------------------------
  5184     05  DCCANCL PIC S9(0004) COMP.
  5185     05  DCCANCF PIC  X(0001).
  5186     05  FILLER REDEFINES DCCANCF.
  5187         10  DCCANCA PIC  X(0001).
  5188     05  DCCANCI PIC  X(0005).
  5189*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6311.cbl
  5190     05  DCLFRFDL PIC S9(0004) COMP.
  5191     05  DCLFRFDF PIC  X(0001).
  5192     05  FILLER REDEFINES DCLFRFDF.
  5193         10  DCLFRFDA PIC  X(0001).
  5194     05  DCLFRFDI PIC  X(0011).
  5195*    -------------------------------
  5196     05  DCAHRFDL PIC S9(0004) COMP.
  5197     05  DCAHRFDF PIC  X(0001).
  5198     05  FILLER REDEFINES DCAHRFDF.
  5199         10  DCAHRFDA PIC  X(0001).
  5200     05  DCAHRFDI PIC  X(0011).
  5201*    -------------------------------
  5202     05  DOISSL PIC S9(0004) COMP.
  5203     05  DOISSF PIC  X(0001).
  5204     05  FILLER REDEFINES DOISSF.
  5205         10  DOISSA PIC  X(0001).
  5206     05  DOISSI PIC  X(0005).
  5207*    -------------------------------
  5208     05  DOLFPRML PIC S9(0004) COMP.
  5209     05  DOLFPRMF PIC  X(0001).
  5210     05  FILLER REDEFINES DOLFPRMF.
  5211         10  DOLFPRMA PIC  X(0001).
  5212     05  DOLFPRMI PIC  X(0011).
  5213*    -------------------------------
  5214     05  DOAHPRML PIC S9(0004) COMP.
  5215     05  DOAHPRMF PIC  X(0001).
  5216     05  FILLER REDEFINES DOAHPRMF.
  5217         10  DOAHPRMA PIC  X(0001).
  5218     05  DOAHPRMI PIC  X(0011).
  5219*    -------------------------------
  5220     05  DOCANCL PIC S9(0004) COMP.
  5221     05  DOCANCF PIC  X(0001).
  5222     05  FILLER REDEFINES DOCANCF.
  5223         10  DOCANCA PIC  X(0001).
  5224     05  DOCANCI PIC  X(0005).
  5225*    -------------------------------
  5226     05  DOLFRFDL PIC S9(0004) COMP.
  5227     05  DOLFRFDF PIC  X(0001).
  5228     05  FILLER REDEFINES DOLFRFDF.
  5229         10  DOLFRFDA PIC  X(0001).
  5230     05  DOLFRFDI PIC  X(0011).
  5231*    -------------------------------
  5232     05  DOAHRFDL PIC S9(0004) COMP.
  5233     05  DOAHRFDF PIC  X(0001).
  5234     05  FILLER REDEFINES DOAHRFDF.
  5235         10  DOAHRFDA PIC  X(0001).
  5236     05  DOAHRFDI PIC  X(0011).
  5237*    -------------------------------
  5238     05  DITOTALL PIC S9(0004) COMP.
  5239     05  DITOTALF PIC  X(0001).
  5240     05  FILLER REDEFINES DITOTALF.
  5241         10  DITOTALA PIC  X(0001).
  5242     05  DITOTALI PIC  X(0005).
  5243*    -------------------------------
  5244     05  DIFATALL PIC S9(0004) COMP.
  5245     05  DIFATALF PIC  X(0001).
  5246     05  FILLER REDEFINES DIFATALF.
  5247         10  DIFATALA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6311.cbl
  5248     05  DIFATALI PIC  X(0005).
  5249*    -------------------------------
  5250     05  DIFORCEL PIC S9(0004) COMP.
  5251     05  DIFORCEF PIC  X(0001).
  5252     05  FILLER REDEFINES DIFORCEF.
  5253         10  DIFORCEA PIC  X(0001).
  5254     05  DIFORCEI PIC  X(0005).
  5255*    -------------------------------
  5256     05  DIHOLDL PIC S9(0004) COMP.
  5257     05  DIHOLDF PIC  X(0001).
  5258     05  FILLER REDEFINES DIHOLDF.
  5259         10  DIHOLDA PIC  X(0001).
  5260     05  DIHOLDI PIC  X(0005).
  5261*    -------------------------------
  5262     05  DIAVAILL PIC S9(0004) COMP.
  5263     05  DIAVAILF PIC  X(0001).
  5264     05  FILLER REDEFINES DIAVAILF.
  5265         10  DIAVAILA PIC  X(0001).
  5266     05  DIAVAILI PIC  X(0005).
  5267*    -------------------------------
  5268     05  DIGPREML PIC S9(0004) COMP.
  5269     05  DIGPREMF PIC  X(0001).
  5270     05  FILLER REDEFINES DIGPREMF.
  5271         10  DIGPREMA PIC  X(0001).
  5272     05  DIGPREMI PIC  X(0011).
  5273*    -------------------------------
  5274     05  DIBPREML PIC S9(0004) COMP.
  5275     05  DIBPREMF PIC  X(0001).
  5276     05  FILLER REDEFINES DIBPREMF.
  5277         10  DIBPREMA PIC  X(0001).
  5278     05  DIBPREMI PIC  X(0011).
  5279*    -------------------------------
  5280     05  DCTOTALL PIC S9(0004) COMP.
  5281     05  DCTOTALF PIC  X(0001).
  5282     05  FILLER REDEFINES DCTOTALF.
  5283         10  DCTOTALA PIC  X(0001).
  5284     05  DCTOTALI PIC  X(0005).
  5285*    -------------------------------
  5286     05  DCFATALL PIC S9(0004) COMP.
  5287     05  DCFATALF PIC  X(0001).
  5288     05  FILLER REDEFINES DCFATALF.
  5289         10  DCFATALA PIC  X(0001).
  5290     05  DCFATALI PIC  X(0005).
  5291*    -------------------------------
  5292     05  DCFORCEL PIC S9(0004) COMP.
  5293     05  DCFORCEF PIC  X(0001).
  5294     05  FILLER REDEFINES DCFORCEF.
  5295         10  DCFORCEA PIC  X(0001).
  5296     05  DCFORCEI PIC  X(0005).
  5297*    -------------------------------
  5298     05  DCHOLDL PIC S9(0004) COMP.
  5299     05  DCHOLDF PIC  X(0001).
  5300     05  FILLER REDEFINES DCHOLDF.
  5301         10  DCHOLDA PIC  X(0001).
  5302     05  DCHOLDI PIC  X(0005).
  5303*    -------------------------------
  5304     05  DCAVAILL PIC S9(0004) COMP.
  5305     05  DCAVAILF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6311.cbl
  5306     05  FILLER REDEFINES DCAVAILF.
  5307         10  DCAVAILA PIC  X(0001).
  5308     05  DCAVAILI PIC  X(0005).
  5309*    -------------------------------
  5310     05  DCGPREML PIC S9(0004) COMP.
  5311     05  DCGPREMF PIC  X(0001).
  5312     05  FILLER REDEFINES DCGPREMF.
  5313         10  DCGPREMA PIC  X(0001).
  5314     05  DCGPREMI PIC  X(0011).
  5315*    -------------------------------
  5316     05  DCBPREML PIC S9(0004) COMP.
  5317     05  DCBPREMF PIC  X(0001).
  5318     05  FILLER REDEFINES DCBPREMF.
  5319         10  DCBPREMA PIC  X(0001).
  5320     05  DCBPREMI PIC  X(0011).
  5321*    -------------------------------
  5322     05  DNTOTALL PIC S9(0004) COMP.
  5323     05  DNTOTALF PIC  X(0001).
  5324     05  FILLER REDEFINES DNTOTALF.
  5325         10  DNTOTALA PIC  X(0001).
  5326     05  DNTOTALI PIC  X(0005).
  5327*    -------------------------------
  5328     05  DNFATALL PIC S9(0004) COMP.
  5329     05  DNFATALF PIC  X(0001).
  5330     05  FILLER REDEFINES DNFATALF.
  5331         10  DNFATALA PIC  X(0001).
  5332     05  DNFATALI PIC  X(0005).
  5333*    -------------------------------
  5334     05  DNFORCEL PIC S9(0004) COMP.
  5335     05  DNFORCEF PIC  X(0001).
  5336     05  FILLER REDEFINES DNFORCEF.
  5337         10  DNFORCEA PIC  X(0001).
  5338     05  DNFORCEI PIC  X(0005).
  5339*    -------------------------------
  5340     05  DNHOLDL PIC S9(0004) COMP.
  5341     05  DNHOLDF PIC  X(0001).
  5342     05  FILLER REDEFINES DNHOLDF.
  5343         10  DNHOLDA PIC  X(0001).
  5344     05  DNHOLDI PIC  X(0005).
  5345*    -------------------------------
  5346     05  DNAVAILL PIC S9(0004) COMP.
  5347     05  DNAVAILF PIC  X(0001).
  5348     05  FILLER REDEFINES DNAVAILF.
  5349         10  DNAVAILA PIC  X(0001).
  5350     05  DNAVAILI PIC  X(0005).
  5351*    -------------------------------
  5352     05  DNGPREML PIC S9(0004) COMP.
  5353     05  DNGPREMF PIC  X(0001).
  5354     05  FILLER REDEFINES DNGPREMF.
  5355         10  DNGPREMA PIC  X(0001).
  5356     05  DNGPREMI PIC  X(0011).
  5357*    -------------------------------
  5358     05  DNBPREML PIC S9(0004) COMP.
  5359     05  DNBPREMF PIC  X(0001).
  5360     05  FILLER REDEFINES DNBPREMF.
  5361         10  DNBPREMA PIC  X(0001).
  5362     05  DNBPREMI PIC  X(0011).
  5363*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6311.cbl
  5364     05  DERMSGL PIC S9(0004) COMP.
  5365     05  DERMSGF PIC  X(0001).
  5366     05  FILLER REDEFINES DERMSGF.
  5367         10  DERMSGA PIC  X(0001).
  5368     05  DERMSGI PIC  X(0075).
  5369*    -------------------------------
  5370     05  DPFENTRL PIC S9(0004) COMP.
  5371     05  DPFENTRF PIC  X(0001).
  5372     05  FILLER REDEFINES DPFENTRF.
  5373         10  DPFENTRA PIC  X(0001).
  5374     05  DPFENTRI PIC  9(2).
  5375 01  EL631DO REDEFINES EL631BI.
  5376     05  FILLER            PIC  X(0012).
  5377*    -------------------------------
  5378     05  FILLER            PIC  X(0003).
  5379     05  DDATEO PIC  X(0008).
  5380*    -------------------------------
  5381     05  FILLER            PIC  X(0003).
  5382     05  DTIMEO PIC  99.99.
  5383*    -------------------------------
  5384     05  FILLER            PIC  X(0003).
  5385     05  DHEADO PIC  X(0038).
  5386*    -------------------------------
  5387     05  FILLER            PIC  X(0003).
  5388     05  DLDATEO PIC  X(0010).
  5389*    -------------------------------
  5390     05  FILLER            PIC  X(0003).
  5391     05  DBATCHO PIC  X(0011).
  5392*    -------------------------------
  5393     05  FILLER            PIC  X(0003).
  5394     05  DACCTNMO PIC  X(0030).
  5395*    -------------------------------
  5396     05  FILLER            PIC  X(0003).
  5397     05  DPROCDTO PIC  X(0008).
  5398*    -------------------------------
  5399     05  FILLER            PIC  X(0003).
  5400     05  DINPUTO PIC  X(0008).
  5401*    -------------------------------
  5402     05  FILLER            PIC  X(0003).
  5403     05  DMAINDTO PIC  X(0008).
  5404*    -------------------------------
  5405     05  FILLER            PIC  X(0003).
  5406     05  DCARRO PIC  X(0001).
  5407*    -------------------------------
  5408     05  FILLER            PIC  X(0003).
  5409     05  DGROUPO PIC  X(0006).
  5410*    -------------------------------
  5411     05  FILLER            PIC  X(0003).
  5412     05  DSTATEO PIC  X(0002).
  5413*    -------------------------------
  5414     05  FILLER            PIC  X(0003).
  5415     05  DACCTO PIC  X(0010).
  5416*    -------------------------------
  5417     05  FILLER            PIC  X(0003).
  5418     05  DRECVDTO PIC  X(0008).
  5419*    -------------------------------
  5420     05  FILLER            PIC  X(0003).
  5421     05  DCSRO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL6311.cbl
  5422*    -------------------------------
  5423     05  FILLER            PIC  X(0003).
  5424     05  DREFHDGO PIC  X(0010).
  5425*    -------------------------------
  5426     05  FILLER            PIC  X(0003).
  5427     05  DREFO PIC  X(0012).
  5428*    -------------------------------
  5429     05  FILLER            PIC  X(0003).
  5430     05  DLFPHDGO PIC  X(0010).
  5431*    -------------------------------
  5432     05  FILLER            PIC  X(0003).
  5433     05  DAHPHDGO PIC  X(0010).
  5434*    -------------------------------
  5435     05  FILLER            PIC  X(0003).
  5436     05  DLFRHDGO PIC  X(0009).
  5437*    -------------------------------
  5438     05  FILLER            PIC  X(0003).
  5439     05  DAHRHDGO PIC  X(0009).
  5440*    -------------------------------
  5441     05  FILLER            PIC  X(0003).
  5442     05  DRISSO PIC  ZZ99-.
  5443*    -------------------------------
  5444     05  FILLER            PIC  X(0003).
  5445     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5446*    -------------------------------
  5447     05  FILLER            PIC  X(0003).
  5448     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5449*    -------------------------------
  5450     05  FILLER            PIC  X(0003).
  5451     05  DRCANCO PIC  ZZ99-.
  5452*    -------------------------------
  5453     05  FILLER            PIC  X(0003).
  5454     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5455*    -------------------------------
  5456     05  FILLER            PIC  X(0003).
  5457     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5458*    -------------------------------
  5459     05  FILLER            PIC  X(0003).
  5460     05  DEISSO PIC  ZZ99-.
  5461*    -------------------------------
  5462     05  FILLER            PIC  X(0003).
  5463     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5464*    -------------------------------
  5465     05  FILLER            PIC  X(0003).
  5466     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5467*    -------------------------------
  5468     05  FILLER            PIC  X(0003).
  5469     05  DECANCO PIC  ZZ99-.
  5470*    -------------------------------
  5471     05  FILLER            PIC  X(0003).
  5472     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5473*    -------------------------------
  5474     05  FILLER            PIC  X(0003).
  5475     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5476*    -------------------------------
  5477     05  FILLER            PIC  X(0003).
  5478     05  DCISSO PIC  ZZ99-.
  5479*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL6311.cbl
  5480     05  FILLER            PIC  X(0003).
  5481     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5482*    -------------------------------
  5483     05  FILLER            PIC  X(0003).
  5484     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5485*    -------------------------------
  5486     05  FILLER            PIC  X(0003).
  5487     05  DCCANCO PIC  ZZ99-.
  5488*    -------------------------------
  5489     05  FILLER            PIC  X(0003).
  5490     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5491*    -------------------------------
  5492     05  FILLER            PIC  X(0003).
  5493     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5494*    -------------------------------
  5495     05  FILLER            PIC  X(0003).
  5496     05  DOISSO PIC  ZZ99-.
  5497*    -------------------------------
  5498     05  FILLER            PIC  X(0003).
  5499     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5500*    -------------------------------
  5501     05  FILLER            PIC  X(0003).
  5502     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5503*    -------------------------------
  5504     05  FILLER            PIC  X(0003).
  5505     05  DOCANCO PIC  ZZ99-.
  5506*    -------------------------------
  5507     05  FILLER            PIC  X(0003).
  5508     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5509*    -------------------------------
  5510     05  FILLER            PIC  X(0003).
  5511     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5512*    -------------------------------
  5513     05  FILLER            PIC  X(0003).
  5514     05  DITOTALO PIC  ZZZ99.
  5515*    -------------------------------
  5516     05  FILLER            PIC  X(0003).
  5517     05  DIFATALO PIC  ZZZ99.
  5518*    -------------------------------
  5519     05  FILLER            PIC  X(0003).
  5520     05  DIFORCEO PIC  ZZZ99.
  5521*    -------------------------------
  5522     05  FILLER            PIC  X(0003).
  5523     05  DIHOLDO PIC  ZZZ99.
  5524*    -------------------------------
  5525     05  FILLER            PIC  X(0003).
  5526     05  DIAVAILO PIC  ZZZ99.
  5527*    -------------------------------
  5528     05  FILLER            PIC  X(0003).
  5529     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5530*    -------------------------------
  5531     05  FILLER            PIC  X(0003).
  5532     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5533*    -------------------------------
  5534     05  FILLER            PIC  X(0003).
  5535     05  DCTOTALO PIC  ZZZ99.
  5536*    -------------------------------
  5537     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL6311.cbl
  5538     05  DCFATALO PIC  ZZZ99.
  5539*    -------------------------------
  5540     05  FILLER            PIC  X(0003).
  5541     05  DCFORCEO PIC  ZZZ99.
  5542*    -------------------------------
  5543     05  FILLER            PIC  X(0003).
  5544     05  DCHOLDO PIC  ZZZ99.
  5545*    -------------------------------
  5546     05  FILLER            PIC  X(0003).
  5547     05  DCAVAILO PIC  ZZZ99.
  5548*    -------------------------------
  5549     05  FILLER            PIC  X(0003).
  5550     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5551*    -------------------------------
  5552     05  FILLER            PIC  X(0003).
  5553     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5554*    -------------------------------
  5555     05  FILLER            PIC  X(0003).
  5556     05  DNTOTALO PIC  ---99.
  5557*    -------------------------------
  5558     05  FILLER            PIC  X(0003).
  5559     05  DNFATALO PIC  ---99.
  5560*    -------------------------------
  5561     05  FILLER            PIC  X(0003).
  5562     05  DNFORCEO PIC  ---99.
  5563*    -------------------------------
  5564     05  FILLER            PIC  X(0003).
  5565     05  DNHOLDO PIC  ---99.
  5566*    -------------------------------
  5567     05  FILLER            PIC  X(0003).
  5568     05  DNAVAILO PIC  ---99.
  5569*    -------------------------------
  5570     05  FILLER            PIC  X(0003).
  5571     05  DNGPREMO PIC  -------9.99.
  5572*    -------------------------------
  5573     05  FILLER            PIC  X(0003).
  5574     05  DNBPREMO PIC  -------9.99.
  5575*    -------------------------------
  5576     05  FILLER            PIC  X(0003).
  5577     05  DERMSGO PIC  X(0075).
  5578*    -------------------------------
  5579     05  FILLER            PIC  X(0003).
  5580     05  DPFENTRO PIC  X(0002).
  5581*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL6311.cbl
  5583 01  MAP-B REDEFINES EL631BI.
  5584     12  FILLER                  PIC X(562).
  5585*    12  FILLER                  PIC X(512).
  5586*    12  FILLER                  PIC X(510).
  5587     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5588         16  BKIND-LEN               PIC S9(4)  COMP.
  5589         16  BKIND-ATTRB             PIC X.
  5590         16  BKIND                   PIC XX.
  5591         16  BTYPE-LEN               PIC S9(4)  COMP.
  5592         16  BTYPE-ATTRB             PIC X.
  5593         16  BTYPE                   PIC X(3).
  5594         16  BTERM-LEN               PIC S9(4)  COMP.
  5595         16  BTERM-ATTRB             PIC X.
  5596         16  BTERMI                  PIC 999.
  5597         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5598         16  BBEN-LEN                PIC S9(4)  COMP.
  5599         16  BBEN-ATTRB              PIC X.
  5600         16  BBENI                   PIC 9(10)V99.
  5601*        16  BBENI                   PIC 9(12).
  5602         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5603         16  BPREM-LEN               PIC S9(4)  COMP.
  5604         16  BPREM-ATTRB             PIC X.
  5605         16  BPREMI                  PIC S9(9)V99.
  5606*        16  BPREMI                  PIC 9(11).
  5607         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5608         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5609         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5610         16  BEXPIRE-ATTRB           PIC X.
  5611         16  BEXPIRE                 PIC X(8).
  5612         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5613         16  BCRIT-PERD-ATTRB        PIC X.
  5614         16  BCRIT-PERDI             PIC 99.
  5615         16  BCRIT-PERDO REDEFINES
  5616                         BCRIT-PERDI PIC ZZ.
  5617         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5618         16  BALT-BEN-ATTRB          PIC X.
  5619         16  BALT-BENI               PIC 9(10)V99.
  5620*        16  BALT-BENI               PIC 9(12).
  5621         16  BALT-BENO REDEFINES
  5622                           BALT-BENI PIC Z(9).ZZ.
  5623         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5624         16  BALT-PREM-ATTRB         PIC X.
  5625         16  BALT-PREMI              PIC 9(9)V99.
  5626*        16  BALT-PREMI              PIC 9(11).
  5627         16  BALT-PREMO REDEFINES
  5628                          BALT-PREMI PIC Z(7).ZZ-.
  5629         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5630         16  BBEN-CD-ATTRB           PIC X.
  5631         16  BBEN-CD                 PIC XXX.
  5632         16  BCPREM-LEN              PIC S9(4)  COMP.
  5633         16  BCPREM-ATTRB            PIC X.
  5634         16  BCPREMI                 PIC S9(9)V99.
  5635*        16  BCPREMI                 PIC X(11).
  5636         16  BCPREMO REDEFINES BCPREMI
  5637                                     PIC Z(7).99-.
  5638         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5639         16  BCALT-PREM-ATTRB        PIC X.
  5640         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL6311.cbl
  5641         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5642         16  BBEN-ABBR-ATTRB         PIC X.
  5643         16  BBEN-ABBR               PIC X(5).
  5644         16  BDIFF-LEN               PIC S9(4)  COMP.
  5645         16  BDIFF-ATTRB             PIC X.
  5646         16  BDIFFO                  PIC Z(7).99-.
  5647         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5648         16  BBILL-LIT-ATTRB         PIC X.
  5649         16  BBILL-LIT               PIC X(8).
  5650         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5651         16  BDALT-PREM-ATTRB        PIC X.
  5652         16  BDALT-PREM              PIC Z(7).99-.
  5653
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL6311.cbl
  5655
  5656****************************************************************
  5657*
  5658* Copyright (c) 2007 by Clerity Solutions, Inc.
  5659* All rights reserved.
  5660*
  5661****************************************************************
  5662 01  DFHEIV.
  5663   02  DFHEIV0               PIC X(35).
  5664   02  DFHEIV1               PIC X(08).
  5665   02  DFHEIV2               PIC X(08).
  5666   02  DFHEIV3               PIC X(08).
  5667   02  DFHEIV4               PIC X(06).
  5668   02  DFHEIV5               PIC X(04).
  5669   02  DFHEIV6               PIC X(04).
  5670   02  DFHEIV7               PIC X(02).
  5671   02  DFHEIV8               PIC X(02).
  5672   02  DFHEIV9               PIC X(01).
  5673   02  DFHEIV10              PIC S9(7) COMP-3.
  5674   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5675   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5676   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5677   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5678   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5679   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5680   02  DFHEIV17              PIC X(04).
  5681   02  DFHEIV18              PIC X(04).
  5682   02  DFHEIV19              PIC X(04).
  5683   02  DFHEIV20              USAGE IS POINTER.
  5684   02  DFHEIV21              USAGE IS POINTER.
  5685   02  DFHEIV22              USAGE IS POINTER.
  5686   02  DFHEIV23              USAGE IS POINTER.
  5687   02  DFHEIV24              USAGE IS POINTER.
  5688   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5689   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5690   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5691   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5692   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5693   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5694   02  FILLER                PIC X(02).
  5695   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5696   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5697   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5698   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5699   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5700 LINKAGE  SECTION.
  5701*****************************************************************
  5702*                                                               *
  5703* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5704* All rights reserved.                                          *
  5705*                                                               *
  5706*****************************************************************
  5707 01  dfheiblk.
  5708     02  eibtime          pic s9(7) comp-3.
  5709     02  eibdate          pic s9(7) comp-3.
  5710     02  eibtrnid         pic x(4).
  5711     02  eibtaskn         pic s9(7) comp-3.
  5712     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL6311.cbl
  5713     02  dfheigdi         pic s9(4) comp.
  5714     02  eibcposn         pic s9(4) comp.
  5715     02  eibcalen         pic s9(4) comp.
  5716     02  eibaid           pic x(1).
  5717     02  eibfiller1       pic x(1).
  5718     02  eibfn            pic x(2).
  5719     02  eibfiller2       pic x(2).
  5720     02  eibrcode         pic x(6).
  5721     02  eibfiller3       pic x(2).
  5722     02  eibds            pic x(8).
  5723     02  eibreqid         pic x(8).
  5724     02  eibrsrce         pic x(8).
  5725     02  eibsync          pic x(1).
  5726     02  eibfree          pic x(1).
  5727     02  eibrecv          pic x(1).
  5728     02  eibsend          pic x(1).
  5729     02  eibatt           pic x(1).
  5730     02  eibeoc           pic x(1).
  5731     02  eibfmh           pic x(1).
  5732     02  eibcompl         pic x(1).
  5733     02  eibsig           pic x(1).
  5734     02  eibconf          pic x(1).
  5735     02  eiberr           pic x(1).
  5736     02  eibrldbk         pic x(1).
  5737     02  eiberrcd         pic x(4).
  5738     02  eibsynrb         pic x(1).
  5739     02  eibnodat         pic x(1).
  5740     02  eibfiller5       pic x(2).
  5741     02  eibresp          pic 9(09) comp.
  5742     02  eibresp2         pic 9(09) comp.
  5743     02  dfheigdj         pic s9(4) comp.
  5744     02  dfheigdk         pic s9(4) comp.
  5745 01  DFHCOMMAREA                 PIC X(1300).
  5746
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL6311.cbl
  5748*    COPY ERCPNDB.
  5749******************************************************************
  5750*                                                                *
  5751*                                                                *
  5752*                            ERCPNDB.                            *
  5753*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5754*                            VMOD=2.025                          *
  5755*                                                                *
  5756*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5757*                                                                *
  5758******************************************************************
  5759*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5760*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5761******************************************************************
  5762*                                                                *
  5763*                                                                *
  5764*   FILE TYPE = VSAM,KSDS                                        *
  5765*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5766*                                                                *
  5767*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5768*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5769*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5770*                                                 RKP=13,LEN=36  *
  5771*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5772*                                      AND CHG-SEQ.)             *
  5773*                                                RKP=49,LEN=11   *
  5774*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5775*                                      AND CHG-SEQ.)             *
  5776*                                                RKP=60,LEN=15   *
  5777*                                                                *
  5778*   LOG = NO                                                     *
  5779*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5780******************************************************************
  5781******************************************************************
  5782*                   C H A N G E   L O G
  5783*
  5784* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5785*-----------------------------------------------------------------
  5786*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5787* EFFECTIVE    NUMBER
  5788*-----------------------------------------------------------------
  5789* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5790* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5791* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5792* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5793* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5794* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5795* 032306                   PEMA  ADD BOW LOAN NUMBER
  5796* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5797* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5798* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5799* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5800* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5801* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5802* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5803* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5804******************************************************************
  5805
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL6311.cbl
  5806 01  PENDING-BUSINESS.
  5807     12  PB-RECORD-ID                     PIC XX.
  5808         88  VALID-PB-ID                        VALUE 'PB'.
  5809
  5810     12  PB-CONTROL-PRIMARY.
  5811         16  PB-COMPANY-CD                PIC X.
  5812         16  PB-ENTRY-BATCH               PIC X(6).
  5813         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5814         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5815
  5816     12  PB-CONTROL-BY-ACCOUNT.
  5817         16  PB-COMPANY-CD-A1             PIC X.
  5818         16  PB-CARRIER                   PIC X.
  5819         16  PB-GROUPING.
  5820             20  PB-GROUPING-PREFIX       PIC XXX.
  5821             20  PB-GROUPING-PRIME        PIC XXX.
  5822         16  PB-STATE                     PIC XX.
  5823         16  PB-ACCOUNT.
  5824             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5825             20  PB-ACCOUNT-PRIME         PIC X(6).
  5826         16  PB-CERT-EFF-DT               PIC XX.
  5827         16  PB-CERT-NO.
  5828             20  PB-CERT-PRIME            PIC X(10).
  5829             20  PB-CERT-SFX              PIC X.
  5830         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5831
  5832         16  PB-RECORD-TYPE               PIC X.
  5833             88  PB-MAILING-DATA                VALUE '0'.
  5834             88  PB-ISSUE                       VALUE '1'.
  5835             88  PB-CANCELLATION                VALUE '2'.
  5836             88  PB-BATCH-TRAILER               VALUE '9'.
  5837
  5838     12  PB-CONTROL-BY-ORIG-BATCH.
  5839         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5840         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5841         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5842         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5843
  5844     12  PB-CONTROL-BY-CSR.
  5845         16  PB-CSR-COMPANY-CD            PIC X.
  5846         16  PB-CSR-ID                    PIC X(4).
  5847         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5848         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5849         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5850******************************************************************
  5851*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5852******************************************************************
  5853
  5854     12  PB-LAST-MAINT-DT                 PIC XX.
  5855     12  PB-LAST-MAINT-BY                 PIC X(4).
  5856     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5857
  5858     12  PB-RECORD-BODY                   PIC X(375).
  5859
  5860     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5861         16  PB-CERT-ORIGIN               PIC X.
  5862             88  CLASIC-CREATED-CERT         VALUE '1'.
  5863         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL6311.cbl
  5864             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5865             20  PB-I-INSURED-FIRST-NAME.
  5866                 24  PB-I-INSURED-1ST-INIT PIC X.
  5867                 24  FILLER                PIC X(9).
  5868             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5869         16  PB-I-AGE                     PIC S99   COMP-3.
  5870         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5871         16  PB-I-BIRTHDAY                PIC XX.
  5872         16  PB-I-INSURED-SEX             PIC X.
  5873             88  PB-SEX-MALE     VALUE 'M'.
  5874             88  PB-SEX-FEMALE   VALUE 'F'.
  5875
  5876         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5877         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5878         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5879         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5880         16  PB-I-SKIP-CODE               PIC X.
  5881             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5882             88  PB-SKIP-JULY              VALUE '1'.
  5883             88  PB-SKIP-AUGUST            VALUE '2'.
  5884             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5885             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5886             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5887             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5888             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5889             88  PB-SKIP-JUNE              VALUE '8'.
  5890             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5891             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5892             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5893         16  PB-I-TERM-TYPE               PIC X.
  5894             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5895             88  PB-PAID-WEEKLY            VALUE 'W'.
  5896             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5897             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5898             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5899         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5900         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5901         16  PB-I-DATA-ENTRY-SW           PIC X.
  5902             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5903             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5904             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5905             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5906         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5907         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5908*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5909         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5910         16  FILLER                       PIC X.
  5911
  5912         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5913             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5914             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5915                                                   '90' THRU '99'.
  5916         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5917                                          PIC XX.
  5918         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5919         16  PB-I-AMOUNT-FINANCED REDEFINES
  5920                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5921         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL6311.cbl
  5922         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5923                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5924         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5925         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5926         16  PB-I-CLP-AMOUNT REDEFINES
  5927                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5928         16  PB-I-LF-CALC-FLAG            PIC X.
  5929             88 PB-COMP-LF-PREM               VALUE '?'.
  5930         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5931         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5932         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5933         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5934         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5935         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5936         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5937         16  PB-I-LF-ABBR                 PIC XXX.
  5938         16  PB-I-LF-INPUT-CD             PIC XX.
  5939
  5940         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5941             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5942             88  PB-INVALID-AH               VALUE '  ' '00'
  5943                                                   '90' THRU '99'.
  5944         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5945         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5946         16  PB-I-AH-CALC-FLAG            PIC X.
  5947             88 PB-COMP-AH-PREM                  VALUE '?'.
  5948         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5949         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5950         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5951         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5952         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5953         16  PB-I-AH-ABBR                 PIC XXX.
  5954         16  PB-I-AH-INPUT-CD             PIC XXX.
  5955
  5956         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5957         16  PB-I-REIN-TABLE              PIC XXX.
  5958         16  PB-I-BUSINESS-TYPE           PIC 99.
  5959         16  PB-I-INDV-GRP-CD             PIC X.
  5960         16  PB-I-MORT-CODE.
  5961             20  PB-I-TABLE               PIC X.
  5962             20  PB-I-INTEREST            PIC XX.
  5963             20  PB-I-MORT-TYP            PIC X.
  5964         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5965         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5966         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5967         16  PB-I-INDV-GRP-OVRD           PIC X.
  5968         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5969         16  PB-I-SIG-SW                  PIC X.
  5970             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5971         16  PB-I-RATE-CLASS              PIC XX.
  5972         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5973         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5974         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5975         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5976         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5977         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5978         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5979         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL6311.cbl
  5980         16  PB-I-OB-FLAG                 PIC X.
  5981             88  PB-I-OB                      VALUE 'B'.
  5982             88  PB-I-SUMMARY                 VALUE 'Z'.
  5983         16  PB-I-ENTRY-STATUS            PIC X.
  5984             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5985                                              'M' '5' '9' '2'.
  5986             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5987             88  PB-I-POLICY-PENDING          VALUE '2'.
  5988             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5989             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5990             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5991             88  PB-I-REIN-ONLY               VALUE '9'.
  5992             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5993             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5994             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5995             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5996         16  PB-I-INT-CODE                PIC X.
  5997             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5998             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5999         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6000         16  PB-I-SOC-SEC-NO              PIC X(11).
  6001         16  PB-I-MEMBER-NO               PIC X(12).
  6002         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6003*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6004         16  PB-I-OLD-LOF                 PIC XXX.
  6005         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6006         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6007         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6008         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6009         16  PB-I-LIFE-INDICATOR          PIC X.
  6010             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6011         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6012         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6013                                          PIC S9(5)V99    COMP-3.
  6014         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6015             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6016             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6017         16  PB-I-1ST-PMT-DT              PIC XX.
  6018         16  PB-I-JOINT-INSURED.
  6019             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6020             20 PB-I-JOINT-FIRST-NAME.
  6021                24  PB-I-JOINT-FIRST-INIT PIC X.
  6022                24  FILLER                PIC X(9).
  6023             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6024*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6025         16  PB-I-BENEFICIARY-NAME.
  6026             20  PB-I-BANK-NUMBER         PIC X(10).
  6027             20  FILLER                   PIC X(15).
  6028         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6029         16  PB-I-REFERENCE               PIC X(12).
  6030         16  FILLER REDEFINES PB-I-REFERENCE.
  6031             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6032             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6033             20  PB-I-CLP-STATE           PIC XX.
  6034         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6035             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6036             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6037             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL6311.cbl
  6038         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6039         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6040         16  PB-I-RESIDENT-STATE          PIC XX.
  6041         16  PB-I-RATE-CODE               PIC X(4).
  6042         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6043         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6044         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6045         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6046         16  PB-I-BANK-NOCHRGB            PIC 99.
  6047         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6048         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6049
  6050     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6051         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6052             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6053         16  PB-C-CANCEL-ORIGIN           PIC X.
  6054             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6055         16  PB-C-LF-CANCEL-DT            PIC XX.
  6056         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6057         16  PB-C-LF-CALC-REQ             PIC X.
  6058             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6059         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6060         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6061         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6062             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6063         16  PB-C-AH-CANCEL-DT            PIC XX.
  6064         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6065         16  PB-C-AH-CALC-REQ             PIC X.
  6066             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6067         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6068         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6069         16  PB-C-LAST-NAME               PIC X(15).
  6070         16  PB-C-REFUND-SW               PIC X.
  6071             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6072             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6073         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6074         16  PB-C-PAYEE-CODE              PIC X(6).
  6075         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6076         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6077         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6078         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6079         16  PB-C-REFERENCE               PIC X(12).
  6080         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6081         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6082         16  PB-C-POST-CARD-IND           PIC X.
  6083         16  PB-C-CANCEL-REASON           PIC X.
  6084         16  PB-C-REF-INTERFACE-SW        PIC X.
  6085         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6086         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6087         16  FILLER                       PIC X(01).
  6088*        16  FILLER                       PIC X(18).
  6089         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6090*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6091         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6092         16  PB-CANCELED-CERT-DATA.
  6093             20  PB-CI-INSURED-NAME.
  6094                 24  PB-CI-LAST-NAME      PIC X(15).
  6095                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL6311.cbl
  6096             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6097             20  PB-CI-INSURED-SEX        PIC X.
  6098             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6099             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6100             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6101             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6102             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6103             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6104             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6105             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6106             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6107             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6108             20  PB-CI-RATE-CLASS         PIC XX.
  6109             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6110             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6111             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6112             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6113             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6114             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6115             20  PB-CI-LF-ABBR            PIC X(3).
  6116             20  PB-CI-AH-ABBR            PIC X(3).
  6117             20  PB-CI-OB-FLAG            PIC X.
  6118                 88  PB-CI-OB                VALUE 'B'.
  6119             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6120                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6121                                           'M' '4' '5' '9' '2'.
  6122                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6123                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6124                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6125                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6126                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6127                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6128                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6129                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6130                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6131                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6132                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6133                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6134             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6135                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6136                                           'M' '4' '5' '9' '2'.
  6137                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6138                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6139                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6140                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6141                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6142                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6143                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6144                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6145                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6146                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6147                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6148                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6149             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6150             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6151             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6152             20  PB-CI-MEMBER-NO          PIC X(12).
  6153             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL6311.cbl
  6154                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6155                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6156             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6157             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6158             20  PB-CI-COMP-EXCP-SW       PIC X.
  6159                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6160                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6161             20  PB-CI-ENTRY-STATUS       PIC X.
  6162             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6163             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6164             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6165             20  PB-CI-DEATH-DT           PIC XX.
  6166             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6167             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6168             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6169             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6170             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6171             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6172             20  PB-CI-ENTRY-DT              PIC XX.
  6173             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6174             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6175             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6176             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6177             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6178             20  PB-CI-OLD-LOF               PIC XXX.
  6179*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6180             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6181             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6182             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6183             20  PB-CI-INDV-GRP-CD           PIC X.
  6184             20  PB-CI-BENEFICIARY-NAME.
  6185                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6186                 24  FILLER                  PIC X(15).
  6187             20  PB-CI-NOTE-SW               PIC X.
  6188             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6189             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6190             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6191             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6192             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6193             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6194             20  PB-CI-FIRST-NAME            PIC X(10).
  6195             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6196
  6197         16  FILLER                       PIC X(13).
  6198*032306  16  FILLER                       PIC X(27).
  6199*        16  FILLER                       PIC X(46).
  6200
  6201     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6202         16  FILLER                       PIC X(10).
  6203         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6204         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6205         16  PB-M-INSURED-MID-INIT        PIC X.
  6206         16  PB-M-INSURED-AGE             PIC 99.
  6207         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6208         16  PB-M-INSURED-SEX             PIC X.
  6209         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6210         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6211         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL6311.cbl
  6212         16  PB-M-INSURED-CITY-STATE.
  6213             20  PB-M-INSURED-CITY        PIC X(28).
  6214             20  PB-M-INSURED-STATE       PIC XX.
  6215         16  PB-M-INSURED-ZIP-CODE.
  6216             20  PB-M-INSURED-ZIP-PRIME.
  6217                 24  PB-M-INSURED-ZIP-1   PIC X.
  6218                     88  PB-M-CANADIAN-POST-CODE
  6219                                             VALUE 'A' THRU 'Z'.
  6220                 24  FILLER               PIC X(4).
  6221             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6222         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6223                                        PB-M-INSURED-ZIP-CODE.
  6224             20  PM-M-INS-CAN-POST1       PIC XXX.
  6225             20  PM-M-INS-CAN-POST2       PIC XXX.
  6226             20  FILLER                   PIC XXX.
  6227         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6228         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6229         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6230         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6231         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6232         16  PB-M-CRED-BENE-CITYST.
  6233             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6234             20  PB-M-CRED-BENE-STATE     PIC XX.
  6235         16  FILLER                       PIC X(92).
  6236
  6237     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6238         16  FILLER                       PIC X(10).
  6239         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6240         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6241         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6242         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6243         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6244         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6245         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6246         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6247         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6248         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6249         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6250         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6251         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6252         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6253         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6254         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6255         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6256         16  PB-ACCOUNT-NAME              PIC X(30).
  6257         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6258         16  PB-REFERENCE                 PIC X(12).
  6259         16  PB-B-RECEIVED-DT             PIC XX.
  6260         16  FILLER                       PIC X(234).
  6261
  6262     12  PB-RECORD-STATUS.
  6263         16  PB-CREDIT-SELECT-DT          PIC XX.
  6264         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6265         16  PB-BILLED-DT                 PIC XX.
  6266         16  PB-BILLING-STATUS            PIC X.
  6267             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6268             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6269             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL6311.cbl
  6270         16  PB-RECORD-BILL               PIC X.
  6271             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6272             88  PB-RECORD-RETURNED           VALUE 'R'.
  6273             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6274             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6275             88  PB-OVERRIDE-AH               VALUE 'A'.
  6276             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6277         16  PB-BATCH-ENTRY               PIC X.
  6278             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6279             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6280             88  PB-REISSUED-CERT             VALUE 'E'.
  6281             88  PB-MONTHLY-CERT              VALUE 'M'.
  6282             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6283             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6284             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6285         16  PB-FORCE-CODE                PIC X.
  6286             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6287             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6288             88  PB-CANCEL-FORCE              VALUE '8'.
  6289             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6290             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6291             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6292             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6293             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6294             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6295             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6296         16  PB-FATAL-FLAG                PIC X.
  6297             88  PB-FATAL-ERRORS              VALUE 'X'.
  6298         16  PB-FORCE-ER-CD               PIC X.
  6299             88  PB-FORCE-ERRORS              VALUE 'F'.
  6300             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6301         16  PB-WARN-ER-CD                PIC X.
  6302             88  PB-WARNING-ERRORS            VALUE 'W'.
  6303         16  FILLER                       PIC X.
  6304         16  PB-OUT-BAL-CD                PIC X.
  6305             88  PB-OUT-OF-BAL                VALUE 'O'.
  6306         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6307         16  PB-AH-OVERRIDE-L1            PIC X.
  6308         16  PB-INPUT-DT                  PIC XX.
  6309         16  PB-INPUT-BY                  PIC X(4).
  6310         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6311         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6312         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6313         16  PB-LF-EARNING-METHOD         PIC X.
  6314         16  PB-AH-EARNING-METHOD         PIC X.
  6315         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6316         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6317         16  PB-REIN-CD                   PIC XXX.
  6318         16  PB-LF-REFUND-TYPE            PIC X.
  6319         16  PB-AH-REFUND-TYPE            PIC X.
  6320         16  PB-ACCT-EFF-DT               PIC XX.
  6321         16  PB-ACCT-EXP-DT               PIC XX.
  6322         16  PB-COMPANY-ID                PIC X(3).
  6323         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6324         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6325         16  PB-SV-CARRIER                PIC X.
  6326         16  PB-SV-GROUPING               PIC X(6).
  6327         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL6311.cbl
  6328         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6329         16  PB-GA-BILLING-INFO.
  6330             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6331                                          PIC XX.
  6332         16  PB-SV-REMIT-TO  REDEFINES
  6333             PB-GA-BILLING-INFO           PIC X(10).
  6334         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6335         16  PB-I-LOAN-OFFICER            PIC X(5).
  6336         16  PB-I-VIN                     PIC X(17).
  6337
  6338         16  FILLER                       PIC X(04).
  6339         16  IMNET-BYPASS-SW              PIC X.
  6340
  6341******************************************************************
  6342*                COMMON EDIT ERRORS                              *
  6343******************************************************************
  6344
  6345     12  PB-COMMON-ERRORS.
  6346         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6347                                           PIC S9(4)     COMP.
  6348
  6349******************************************************************
  6350
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL6311.cbl
  6352*    COPY ELCCERT.
  6353******************************************************************
  6354*                                                                *
  6355*                            ELCCERT.                            *
  6356*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6357*                            VMOD=2.013                          *
  6358*                                                                *
  6359*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6360*                                                                *
  6361*   FILE TYPE = VSAM,KSDS                                        *
  6362*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6363*                                                                *
  6364*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6365*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6366*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6367*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6368*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6369*                                                                *
  6370*   LOG = YES                                                    *
  6371*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6372******************************************************************
  6373*                   C H A N G E   L O G
  6374*
  6375* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6376*-----------------------------------------------------------------
  6377*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6378* EFFECTIVE    NUMBER
  6379*-----------------------------------------------------------------
  6380* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6381* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6382* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6383* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6384* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6385* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6386* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6387* 032612  CR2011110200001  PEMA  AHL CHANGES
  6388******************************************************************
  6389
  6390 01  CERTIFICATE-MASTER.
  6391     12  CM-RECORD-ID                      PIC XX.
  6392         88  VALID-CM-ID                      VALUE 'CM'.
  6393
  6394     12  CM-CONTROL-PRIMARY.
  6395         16  CM-COMPANY-CD                 PIC X.
  6396         16  CM-CARRIER                    PIC X.
  6397         16  CM-GROUPING.
  6398             20  CM-GROUPING-PREFIX        PIC X(3).
  6399             20  CM-GROUPING-PRIME         PIC X(3).
  6400         16  CM-STATE                      PIC XX.
  6401         16  CM-ACCOUNT.
  6402             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6403             20  CM-ACCOUNT-PRIME          PIC X(6).
  6404         16  CM-CERT-EFF-DT                PIC XX.
  6405         16  CM-CERT-NO.
  6406             20  CM-CERT-PRIME             PIC X(10).
  6407             20  CM-CERT-SFX               PIC X.
  6408
  6409     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL6311.cbl
  6410         16  CM-COMPANY-CD-A1              PIC X.
  6411         16  CM-INSURED-LAST-NAME          PIC X(15).
  6412         16  CM-INSURED-INITIALS.
  6413             20  CM-INSURED-INITIAL1       PIC X.
  6414             20  CM-INSURED-INITIAL2       PIC X.
  6415
  6416     12  CM-CONTROL-BY-SSN.
  6417         16  CM-COMPANY-CD-A2              PIC X.
  6418         16  CM-SOC-SEC-NO.
  6419             20  CM-SSN-STATE              PIC XX.
  6420             20  CM-SSN-ACCOUNT            PIC X(6).
  6421             20  CM-SSN-LN3.
  6422                 25  CM-INSURED-INITIALS-A2.
  6423                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6424                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6425                 25 CM-PART-LAST-NAME-A2         PIC X.
  6426
  6427     12  CM-CONTROL-BY-CERT-NO.
  6428         16  CM-COMPANY-CD-A4              PIC X.
  6429         16  CM-CERT-NO-A4                 PIC X(11).
  6430
  6431     12  CM-CONTROL-BY-MEMB.
  6432         16  CM-COMPANY-CD-A5              PIC X.
  6433         16  CM-MEMBER-NO.
  6434             20  CM-MEMB-STATE             PIC XX.
  6435             20  CM-MEMB-ACCOUNT           PIC X(6).
  6436             20  CM-MEMB-LN4.
  6437                 25  CM-INSURED-INITIALS-A5.
  6438                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6439                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6440                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6441
  6442     12  CM-INSURED-PROFILE-DATA.
  6443         16  CM-INSURED-FIRST-NAME.
  6444             20  CM-INSURED-1ST-INIT       PIC X.
  6445             20  FILLER                    PIC X(9).
  6446         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6447         16  CM-INSURED-SEX                PIC X.
  6448             88  CM-SEX-MALE                  VALUE 'M'.
  6449             88  CM-SEX-FEMAL                 VALUE 'F'.
  6450         16  CM-INSURED-JOINT-AGE          PIC 99.
  6451         16  CM-JOINT-INSURED-NAME.
  6452             20  CM-JT-LAST-NAME           PIC X(15).
  6453             20  CM-JT-FIRST-NAME.
  6454                 24  CM-JT-1ST-INIT        PIC X.
  6455                 24  FILLER                PIC X(9).
  6456             20  CM-JT-INITIAL             PIC X.
  6457
  6458     12  CM-LIFE-DATA.
  6459         16  CM-LF-BENEFIT-CD              PIC XX.
  6460         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6461         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6462         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6463         16  CM-LF-DEV-CODE                PIC XXX.
  6464         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6465         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6466         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6467         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL6311.cbl
  6468         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6469         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6470         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6471         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6472         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6473         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6474         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6475         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6476         16  FILLER                        PIC XX.
  6477
  6478     12  CM-AH-DATA.
  6479         16  CM-AH-BENEFIT-CD              PIC XX.
  6480         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6481         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6482         16  CM-AH-DEV-CODE                PIC XXX.
  6483         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6484         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6485         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6486         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6487         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6488         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6489         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6490         16  CM-AH-PAID-THRU-DT            PIC XX.
  6491             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6492         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6493         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6494         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6495         16  FILLER                        PIC X.
  6496
  6497     12  CM-LOAN-INFORMATION.
  6498         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6499         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6500                                           PIC S9(5)V99  COMP-3.
  6501         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6502         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6503         16  CM-PAY-FREQUENCY              PIC S99.
  6504         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6505         16  CM-RATE-CLASS                 PIC XX.
  6506         16  CM-BENEFICIARY                PIC X(25).
  6507         16  CM-POLICY-FORM-NO             PIC X(12).
  6508         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6509         16  CM-LAST-ADD-ON-DT             PIC XX.
  6510         16  CM-DEDUCTIBLE-AMOUNTS.
  6511             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6512             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6513         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6514             20  CM-RESIDENT-STATE         PIC XX.
  6515             20  CM-RATE-CODE              PIC X(4).
  6516             20  FILLER                    PIC XX.
  6517         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6518             20  CM-LOAN-OFFICER           PIC X(5).
  6519             20  FILLER                    PIC XXX.
  6520         16  CM-CSR-CODE                   PIC XXX.
  6521         16  CM-UNDERWRITING-CODE          PIC X.
  6522             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6523         16  CM-POST-CARD-IND              PIC X.
  6524         16  CM-NH-INTERFACE-SW            PIC X.
  6525         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL6311.cbl
  6526             88  CM-SING-PRM                  VALUE '1'.
  6527             88  CM-O-B-COVERAGE              VALUE '2'.
  6528             88  CM-OPEN-END                  VALUE '3'.
  6529         16  CM-IND-GRP-TYPE               PIC X.
  6530             88  CM-INDIVIDUAL                VALUE 'I'.
  6531             88  CM-GROUP                     VALUE 'G'.
  6532         16  CM-SKIP-CODE                  PIC X.
  6533             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6534             88  SKIP-JULY                    VALUE '1'.
  6535             88  SKIP-AUGUST                  VALUE '2'.
  6536             88  SKIP-SEPTEMBER               VALUE '3'.
  6537             88  SKIP-JULY-AUG                VALUE '4'.
  6538             88  SKIP-AUG-SEPT                VALUE '5'.
  6539             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6540             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6541             88  SKIP-JUNE                    VALUE '8'.
  6542             88  SKIP-JUNE-JULY               VALUE '9'.
  6543             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6544             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6545         16  CM-PAYMENT-MODE               PIC X.
  6546             88  PAY-MONTHLY                  VALUE SPACE.
  6547             88  PAY-WEEKLY                   VALUE '1'.
  6548             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6549             88  PAY-BI-WEEKLY                VALUE '3'.
  6550             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6551         16  CM-LOAN-NUMBER                PIC X(8).
  6552         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6553         16  CM-OLD-LOF                    PIC XXX.
  6554*        16  CM-LOAN-OFFICER               PIC XXX.
  6555         16  CM-REIN-TABLE                 PIC XXX.
  6556         16  CM-SPECIAL-REIN-CODE          PIC X.
  6557         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6558         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6559         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6560
  6561     12  CM-STATUS-DATA.
  6562         16  CM-ENTRY-STATUS               PIC X.
  6563         16  CM-ENTRY-DT                   PIC XX.
  6564
  6565         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6566         16  CM-LF-CANCEL-DT               PIC XX.
  6567         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6568
  6569         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6570         16  CM-LF-DEATH-DT                PIC XX.
  6571         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6572
  6573         16  CM-LF-CURRENT-STATUS          PIC X.
  6574             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6575                                                'M' '4' '5' '9'.
  6576             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6577             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6578             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6579             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6580             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6581             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6582             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6583             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL6311.cbl
  6584             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6585             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6586             88  CM-LF-DECLINED               VALUE 'D'.
  6587             88  CM-LF-VOIDED                 VALUE 'V'.
  6588
  6589         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6590         16  CM-AH-CANCEL-DT               PIC XX.
  6591         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6592
  6593         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6594         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6595         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6596
  6597         16  CM-AH-CURRENT-STATUS          PIC X.
  6598             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6599                                                'M' '4' '5' '9'.
  6600             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6601             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6602             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6603             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6604             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6605             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6606             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6607             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6608             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6609             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6610             88  CM-AH-DECLINED               VALUE 'D'.
  6611             88  CM-AH-VOIDED                 VALUE 'V'.
  6612
  6613         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6614             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6615             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6616             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6617         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6618
  6619         16  CM-ENTRY-BATCH                PIC X(6).
  6620         16  CM-LF-EXIT-BATCH              PIC X(6).
  6621         16  CM-AH-EXIT-BATCH              PIC X(6).
  6622         16  CM-LAST-MONTH-END             PIC XX.
  6623
  6624     12  CM-NOTE-SW                        PIC X.
  6625         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6626         88  CERT-NOTES-PRESENT               VALUE '1'.
  6627         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6628         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6629         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6630         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6631         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6632         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6633     12  CM-COMP-EXCP-SW                   PIC X.
  6634         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6635         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6636     12  CM-INSURED-ADDRESS-SW             PIC X.
  6637         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6638         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6639
  6640*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6641     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL6311.cbl
  6642     12  FILLER                            PIC X.
  6643
  6644*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6645     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6646     12  FILLER                            PIC X.
  6647*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6648     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6649
  6650     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6651         88  CERT-ADDED-BATCH                 VALUE ' '.
  6652         88  CERT-ADDED-ONLINE                VALUE '1'.
  6653         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6654         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6655         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6656     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6657         88  CERT-AS-LOADED                   VALUE ' '.
  6658         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6659         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6660         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6661         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6662         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6663         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6664         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6665
  6666     12  CM-ACCOUNT-COMM-PCTS.
  6667         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6668         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6669
  6670     12  CM-USER-FIELD                     PIC X.
  6671     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6672     12  CM-CLP-STATE                      PIC XX.
  6673     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6674     12  CM-USER-RESERVED                  PIC XXX.
  6675     12  FILLER REDEFINES CM-USER-RESERVED.
  6676         16  CM-AH-CLASS-CD                PIC XX.
  6677         16  F                             PIC X.
  6678******************************************************************
  6679
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL6311.cbl
  6681*    COPY ERCNOTE.
  6682******************************************************************
  6683*                                                                *
  6684*                                                                *
  6685*                            ERCNOTE                             *
  6686*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6687*                            VMOD=2.003                          *
  6688*                                                                *
  6689*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6690*                                                                *
  6691*        FILE TYPE= VSAM,KSDS                                    *
  6692*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6693*                                                                *
  6694*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6695*                                                                *
  6696*        LOG = YES                                               *
  6697*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6698*                                                                *
  6699******************************************************************
  6700*                   C H A N G E   L O G
  6701*
  6702* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6703*-----------------------------------------------------------------
  6704*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6705* EFFECTIVE    NUMBER
  6706*-----------------------------------------------------------------
  6707* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6708*                                FILE WILL CONTAIN BILLING NOTES O
  6709******************************************************************
  6710
  6711 01  CERTIFICATE-NOTE.
  6712     12  CN-RECORD-ID                PIC  XX.
  6713         88  VALID-CN-ID                  VALUE 'CN'.
  6714
  6715     12  CN-CONTROL-PRIMARY.
  6716         16  CN-COMPANY-CD           PIC X.
  6717         16  CN-CARRIER              PIC X.
  6718         16  CN-GROUPING.
  6719             20 CN-GROUPING-PREFIX   PIC XXX.
  6720             20 CN-GROUPING-PRIME    PIC XXX.
  6721         16  CN-STATE                PIC XX.
  6722         16  CN-ACCOUNT.
  6723             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6724             20 CN-ACCOUNT-PRIME     PIC X(6).
  6725         16  CN-CERT-EFF-DT          PIC XX.
  6726         16  CN-CERT-NO.
  6727             20  CN-CERT-PRIME       PIC X(10).
  6728             20  CN-CERT-SFX         PIC X.
  6729
  6730     12  CN-BILLING-START-LINE-NO    PIC 99.
  6731     12  CN-BILLING-END-LINE-NO      PIC 99.
  6732
  6733     12  CN-LINES.
  6734         16  CN-LINE OCCURS 10       PIC X(77).
  6735
  6736     12  CN-LAST-MAINT-DT            PIC XX.
  6737     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6738     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL6311.cbl
  6739     12  FILLER                      PIC X(6).
  6740******************************************************************
  6741
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL6311.cbl
  6743*    COPY ERCPNDM.
  6744******************************************************************
  6745*                                                                *
  6746*                                                                *
  6747*                            ERCPNDM                             *
  6748*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6749*                            VMOD=2.003                          *
  6750*                                                                *
  6751*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6752*                                                                *
  6753*   FILE TYPE = VSAM,KSDS                                        *
  6754*   RECORD SIZE = 374   RECFORM = FIX                            *
  6755*                                                                *
  6756*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6757*   ALTERNATE PATH    = NOT USED                                 *
  6758*                                                                *
  6759*   LOG = YES                                                    *
  6760*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6761******************************************************************
  6762*                   C H A N G E   L O G
  6763*
  6764* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6765*-----------------------------------------------------------------
  6766*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6767* EFFECTIVE    NUMBER
  6768*-----------------------------------------------------------------
  6769* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6770* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6771* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6772******************************************************************
  6773
  6774 01  PENDING-MAILING-DATA.
  6775     12  PM-RECORD-ID                      PIC XX.
  6776         88  VALID-MA-ID                       VALUE 'PM'.
  6777
  6778     12  PM-CONTROL-PRIMARY.
  6779         16  PM-COMPANY-CD                 PIC X.
  6780         16  PM-ENTRY-BATCH                PIC X(6).
  6781         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6782         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6783
  6784     12  FILLER                            PIC X(14).
  6785
  6786     12  PM-ACCESS-CONTROL.
  6787         16  PM-SOURCE-SYSTEM              PIC XX.
  6788             88  PM-FROM-CREDIT                VALUE 'CR'.
  6789             88  PM-FROM-VSI                   VALUE 'VS'.
  6790             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6791             88  PM-FROM-OTHER                 VALUE 'OT'.
  6792         16  PM-RECORD-ADD-DT              PIC XX.
  6793         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6794         16  PM-LAST-MAINT-DT              PIC XX.
  6795         16  PM-LAST-MAINT-BY              PIC XXXX.
  6796         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6797
  6798     12  PM-PROFILE-INFO.
  6799         16  PM-QUALIFY-CODE-1             PIC XX.
  6800         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL6311.cbl
  6801         16  PM-QUALIFY-CODE-3             PIC XX.
  6802         16  PM-QUALIFY-CODE-4             PIC XX.
  6803         16  PM-QUALIFY-CODE-5             PIC XX.
  6804
  6805         16  PM-INSURED-LAST-NAME          PIC X(15).
  6806         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6807         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6808         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6809         16  PM-INSURED-BIRTH-DT           PIC XX.
  6810         16  PM-INSURED-SEX                PIC X.
  6811             88  PM-SEX-MALE                   VALUE 'M'.
  6812             88  PM-SEX-FEMALE                 VALUE 'F'.
  6813         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6814
  6815         16  PM-ADDRESS-CORRECTED          PIC X.
  6816         16  PM-JOINT-BIRTH-DT             PIC XX.
  6817*        16  FILLER                        PIC X(12).
  6818
  6819         16  PM-ADDRESS-LINE-1             PIC X(30).
  6820         16  PM-ADDRESS-LINE-2             PIC X(30).
  6821         16  PM-CITY-STATE.
  6822             20  PM-CITY                   PIC X(28).
  6823             20  PM-STATE                  PIC XX.
  6824         16  PM-ZIP.
  6825             20  PM-ZIP-CODE.
  6826                 24  PM-ZIP-1              PIC X.
  6827                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6828                 24  FILLER                PIC X(4).
  6829             20  PM-ZIP-PLUS4              PIC X(4).
  6830         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6831             20  PM-CAN-POST1              PIC XXX.
  6832             20  PM-CAN-POST2              PIC XXX.
  6833             20  FILLER                    PIC XXX.
  6834
  6835         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6836
  6837         16  FILLER                        PIC X(03).
  6838
  6839     12  PM-CRED-BENE-INFO.
  6840         16  PM-CRED-BENE-NAME             PIC X(25).
  6841         16  PM-CRED-BENE-ADDR             PIC X(30).
  6842         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6843         16  PM-CRED-BENE-CTYST.
  6844             20  PM-CRED-BENE-CITY         PIC X(28).
  6845             20  PM-CRED-BENE-STATE        PIC XX.
  6846         16  PM-CRED-BENE-ZIP.
  6847             20  PM-CB-ZIP-CODE.
  6848                 24  PM-CB-ZIP-1           PIC X.
  6849                     88  PM-CB-CANADIAN-POST-CODE
  6850                                  VALUE 'A' THRU 'Z'.
  6851                 24  FILLER                PIC X(4).
  6852             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6853         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6854             20  PM-CB-CAN-POST1           PIC XXX.
  6855             20  PM-CB-CAN-POST2           PIC XXX.
  6856             20  FILLER                    PIC XXX.
  6857     12  PM-POST-CARD-MAIL-DATA.
  6858         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL6311.cbl
  6859             20  PM-MAIL-TYPE              PIC X.
  6860                 88  PM-12MO-MAILING           VALUE '1'.
  6861                 88  PM-EXP-MAILING            VALUE '2'.
  6862             20  PM-MAIL-STATUS            PIC X.
  6863                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6864                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6865                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6866             20  PM-MAIL-DATE              PIC XX.
  6867     12  FILLER                            PIC XX.
  6868     12  FILLER                            PIC X(12).
  6869*    12  FILLER                            PIC X(30).
  6870
  6871******************************************************************
  6872
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL6311.cbl
  6874*    COPY ERCMAIL.
  6875******************************************************************
  6876*                                                                *
  6877*                                                                *
  6878*                            ERCMAIL                             *
  6879*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6880*                            VMOD=2.003                          *
  6881*                                                                *
  6882*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6883*                                                                *
  6884*   FILE TYPE = VSAM,KSDS                                        *
  6885*   RECORD SIZE = 374   RECFORM = FIX                            *
  6886*                                                                *
  6887*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6888*   ALTERNATE PATH    = NOT USED                                 *
  6889*                                                                *
  6890*   LOG = YES                                                    *
  6891*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6892******************************************************************
  6893*                   C H A N G E   L O G
  6894*
  6895* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6896*-----------------------------------------------------------------
  6897*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6898* EFFECTIVE    NUMBER
  6899*-----------------------------------------------------------------
  6900* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6901* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6902* 111108                   PEMA  ADD CRED BENE ADDR2
  6903******************************************************************
  6904
  6905 01  MAILING-DATA.
  6906     12  MA-RECORD-ID                      PIC XX.
  6907         88  VALID-MA-ID                       VALUE 'MA'.
  6908
  6909     12  MA-CONTROL-PRIMARY.
  6910         16  MA-COMPANY-CD                 PIC X.
  6911         16  MA-CARRIER                    PIC X.
  6912         16  MA-GROUPING.
  6913             20  MA-GROUPING-PREFIX        PIC XXX.
  6914             20  MA-GROUPING-PRIME         PIC XXX.
  6915         16  MA-STATE                      PIC XX.
  6916         16  MA-ACCOUNT.
  6917             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6918             20  MA-ACCOUNT-PRIME          PIC X(6).
  6919         16  MA-CERT-EFF-DT                PIC XX.
  6920         16  MA-CERT-NO.
  6921             20  MA-CERT-PRIME             PIC X(10).
  6922             20  MA-CERT-SFX               PIC X.
  6923
  6924     12  FILLER                            PIC XX.
  6925
  6926     12  MA-ACCESS-CONTROL.
  6927         16  MA-SOURCE-SYSTEM              PIC XX.
  6928             88  MA-FROM-CREDIT                VALUE 'CR'.
  6929             88  MA-FROM-VSI                   VALUE 'VS'.
  6930             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6931             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL6311.cbl
  6932         16  MA-RECORD-ADD-DT              PIC XX.
  6933         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6934         16  MA-LAST-MAINT-DT              PIC XX.
  6935         16  MA-LAST-MAINT-BY              PIC XXXX.
  6936         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6937
  6938     12  MA-PROFILE-INFO.
  6939         16  MA-QUALIFY-CODE-1             PIC XX.
  6940         16  MA-QUALIFY-CODE-2             PIC XX.
  6941         16  MA-QUALIFY-CODE-3             PIC XX.
  6942         16  MA-QUALIFY-CODE-4             PIC XX.
  6943         16  MA-QUALIFY-CODE-5             PIC XX.
  6944
  6945         16  MA-INSURED-LAST-NAME          PIC X(15).
  6946         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6947         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6948         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6949         16  MA-INSURED-BIRTH-DT           PIC XX.
  6950         16  MA-INSURED-SEX                PIC X.
  6951             88  MA-SEX-MALE                   VALUE 'M'.
  6952             88  MA-SEX-FEMALE                 VALUE 'F'.
  6953         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6954
  6955         16  MA-ADDRESS-CORRECTED          PIC X.
  6956         16  MA-JOINT-BIRTH-DT             PIC XX.
  6957*        16  FILLER                        PIC X(12).
  6958
  6959         16  MA-ADDRESS-LINE-1             PIC X(30).
  6960         16  MA-ADDRESS-LINE-2             PIC X(30).
  6961         16  MA-CITY-STATE.
  6962             20  MA-CITY                   PIC X(28).
  6963             20  MA-ADDR-STATE             PIC XX.
  6964         16  MA-ZIP.
  6965             20  MA-ZIP-CODE.
  6966                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6967                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6968                 24  FILLER                PIC X(4).
  6969             20  MA-ZIP-PLUS4              PIC X(4).
  6970         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6971             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6972             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6973             20  FILLER                    PIC X(3).
  6974
  6975         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6976
  6977         16  FILLER                        PIC XXX.
  6978*        16  FILLER                        PIC X(10).
  6979
  6980     12  MA-CRED-BENE-INFO.
  6981         16  MA-CRED-BENE-NAME                 PIC X(25).
  6982         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6983         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6984         16  MA-CRED-BENE-CTYST.
  6985             20  MA-CRED-BENE-CITY             PIC X(28).
  6986             20  MA-CRED-BENE-STATE            PIC XX.
  6987         16  MA-CRED-BENE-ZIP.
  6988             20  MA-CB-ZIP-CODE.
  6989                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL6311.cbl
  6990                     88  MA-CB-CANADIAN-POST-CODE
  6991                                           VALUE 'A' THRU 'Z'.
  6992                 24  FILLER                    PIC X(4).
  6993             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6994         16  MA-CB-CANADIAN-POSTAL-CODE
  6995                            REDEFINES MA-CRED-BENE-ZIP.
  6996             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6997             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6998             20  FILLER                        PIC X(3).
  6999     12  MA-POST-CARD-MAIL-DATA.
  7000         16  MA-MAIL-DATA OCCURS 7.
  7001             20  MA-MAIL-TYPE              PIC X.
  7002                 88  MA-12MO-MAILING           VALUE '1'.
  7003                 88  MA-EXP-MAILING            VALUE '2'.
  7004             20  MA-MAIL-STATUS            PIC X.
  7005                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7006                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7007                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7008             20  MA-MAIL-DATE              PIC XX.
  7009     12  FILLER                            PIC XX.
  7010     12  FILLER                            PIC XX.
  7011*    12  FILLER                            PIC X(30).
  7012******************************************************************
  7013
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL6311.cbl
  7015*    COPY ERCRQST.
  7016******************************************************************
  7017*                                                                *
  7018*                                                                *
  7019*                            ERCRQST.                            *
  7020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7021*                            VMOD=2.002                          *
  7022*                                                                *
  7023*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7024*                                                                *
  7025*   FILE TYPE = VSAM,KSDS                                        *
  7026*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7027*                                                                *
  7028*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7029*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7030*                                   ACCOUNT, REF, BATCH)         *
  7031*                                                RKP=9, LEN=38   *
  7032*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7033*                                   ACCOUNT, REF, BATCH)         *
  7034*                                                RKP=47, LEN=46  *
  7035*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7036*                                   BATCH)                       *
  7037*                                                RKP=93, LEN=24  *
  7038*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7039*                                   REF, BATCH)                  *
  7040*                                                RKP=117, LEN=35 *
  7041*   LOG = NO                                                     *
  7042*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7043******************************************************************
  7044
  7045 01  AR-REQUEST-RECORD.
  7046     12  RQ-RECORD-ID                     PIC XX.
  7047         88  VALID-RQ-ID                        VALUE 'RQ'.
  7048
  7049     12  RQ-CONTROL-PRIMARY.
  7050         16  RQ-COMPANY-CD                PIC X.
  7051         16  RQ-ENTRY-BATCH               PIC X(6).
  7052
  7053     12  RQ-CONTROL-BY-ACCT-REF.
  7054         16  RQ-COMPANY-CD-A1             PIC X.
  7055         16  RQ-CARRIER-A1                PIC X.
  7056         16  RQ-GROUPING-A1               PIC X(6).
  7057         16  RQ-STATE-A1                  PIC XX.
  7058         16  RQ-ACCOUNT-A1                PIC X(10).
  7059         16  RQ-REFERENCE-A1              PIC X(12).
  7060         16  RQ-BATCH-A1                  PIC X(6).
  7061
  7062     12  RQ-CONTROL-BY-FIN-RESP.
  7063         16  RQ-COMPANY-CD-A2             PIC X.
  7064         16  RQ-CARRIER-A2                PIC X.
  7065         16  RQ-GROUPING-A2               PIC X(6).
  7066         16  RQ-FIN-RESP-A2               PIC X(10).
  7067         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7068         16  RQ-REFERENCE-A2              PIC X(12).
  7069         16  RQ-BATCH-A2                  PIC X(6).
  7070
  7071     12  RQ-CONTROL-BY-ACCT-AGENT.
  7072         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL6311.cbl
  7073         16  RQ-CARRIER-A3                PIC X.
  7074         16  RQ-GROUPING-A3               PIC X(6).
  7075         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7076         16  RQ-BATCH-A3                  PIC X(6).
  7077
  7078     12  RQ-CONTROL-BY-SUMMARY.
  7079         16  RQ-COMPANY-CD-A4             PIC X.
  7080         16  RQ-SUMMARY-CODE              PIC X(6).
  7081         16  RQ-ACCOUNT-A4                PIC X(10).
  7082         16  RQ-REFERENCE-A4              PIC X(12).
  7083         16  RQ-BATCH-A4                  PIC X(6).
  7084
  7085     12  RQ-REQUEST-METHOD                PIC X.
  7086         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7087         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7088         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7089         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7090     12  FILLER                           PIC X.
  7091     12  RQ-STATUS                        PIC X.
  7092         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7093         88  RQ-RESUBMIT                      VALUE 'R'.
  7094     12  RQ-PROCESSOR-ID                  PIC X(4).
  7095     12  RQ-ENTRY-DT                      PIC XX.
  7096     12  RQ-MO-END-DT                     PIC XX.
  7097     12  RQ-REQUEST-DT                    PIC XX.
  7098     12  RQ-STMT-DT                       PIC XX.
  7099     12  RQ-REVERSAL-DT                   PIC XX.
  7100     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7101     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7102
  7103     12  FILLER                           PIC X(27).
  7104
  7105******************************************************************
  7106
  7107
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL6311.cbl
  7109*    COPY ERCLOFC.
  7110******************************************************************
  7111*                                                                *
  7112*                                                                *
  7113*                            ERCLOFC                             *
  7114*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7115*                            VMOD=2.003                          *
  7116*                                                                *
  7117*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7118*                                                                *
  7119*   FILE TYPE = VSAM,KSDS                                        *
  7120*   RECORD SIZE = 670   RECFORM = FIX                            *
  7121*                                                                *
  7122*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7123*                                                                *
  7124*   LOG = YES                                                    *
  7125*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7126*                                                                *
  7127******************************************************************
  7128
  7129 01  LOAN-OFFICER-MASTER.
  7130     12  LO-RECORD-ID                PIC XX.
  7131         88  VALID-LO-ID                VALUE 'LO'.
  7132
  7133     12  LO-CONTROL-PRIMARY.
  7134         16  LO-COMPANY-CD           PIC X.
  7135         16  LO-CARRIER              PIC X.
  7136         16  LO-GROUPING.
  7137             20  LO-GROUPING-PREFIX  PIC XXX.
  7138             20  LO-GROUPING-PRIME   PIC XXX.
  7139         16  LO-STATE                PIC XX.
  7140         16  LO-ACCOUNT.
  7141             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7142             20  LO-ACCOUNT-PRIME    PIC X(6).
  7143         16  LO-OFFICER-CODE         PIC X(5).
  7144
  7145     12  LO-OFFICER-NAME             PIC X(30).
  7146
  7147     12  LO-LAST-MAINT-DT            PIC XX.
  7148     12  LO-LAST-USER                PIC X(4).
  7149     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7150
  7151     12  LO-COMP-CONTROL             PIC X.
  7152             88  LO-SHOW-COMP           VALUE 'Y'.
  7153             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7154     12  LO-DETAIL-CONTROL           PIC X.
  7155             88  LO-PRINT-DETAIL        VALUE 'D'.
  7156             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7157
  7158     12  LO-SV-CARRIER               PIC X.
  7159     12  LO-SV-GROUPING              PIC X(6).
  7160     12  LO-SV-STATE                 PIC XX.
  7161
  7162     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7163     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7164
  7165     12  LO-OFFICER-INFO.
  7166         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL6311.cbl
  7167             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7168             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7169             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7170             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7171             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7172             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7173             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7174             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7175     12  FILLER                      PIC X(198).
  7176******************************************************************
  7177
  7178*    COPY ERCPYAJ.
  7179******************************************************************
  7180*                                                                *
  7181*                            ERCPYAJ                             *
  7182*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7183*                            VMOD=2.015                          *
  7184*                                                                *
  7185*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7186*                                                                *
  7187*                                                                *
  7188*   FILE TYPE = VSAM,KSDS                                        *
  7189*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7190*                                                                *
  7191*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7192*       ALTERNATE PATHS = NONE                                   *
  7193*                                                                *
  7194*   LOG = YES                                                    *
  7195*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7196******************************************************************
  7197******************************************************************
  7198*                   C H A N G E   L O G
  7199*
  7200* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7201*-----------------------------------------------------------------
  7202*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7203* EFFECTIVE    NUMBER
  7204*-----------------------------------------------------------------
  7205* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7206* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7207******************************************************************
  7208
  7209 01  PENDING-PAY-ADJ.
  7210     12  PY-RECORD-ID                     PIC XX.
  7211         88  VALID-PY-ID                        VALUE 'PY'.
  7212
  7213     12  PY-CONTROL-PRIMARY.
  7214         16  PY-COMPANY-CD                PIC X.
  7215         16  PY-CARRIER                   PIC X.
  7216         16  PY-GROUPING                  PIC X(6).
  7217         16  PY-FIN-RESP                  PIC X(10).
  7218         16  PY-ACCOUNT                   PIC X(10).
  7219         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7220                                          PIC X(10).
  7221         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7222         16  PY-RECORD-TYPE               PIC X.
  7223             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7224             88  PY-DEPOSIT                   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL6311.cbl
  7225             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7226             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7227             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7228             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7229             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7230             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7231             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7232             88  PY-FICA-ENTRY                VALUE 'F'.
  7233             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7234             88  PY-POLICY-FEE                VALUE 'W'.
  7235             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7236
  7237     12  PY-PYMT-TYPE                     PIC X.
  7238             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7239             88  PY-REINS-PYMT                VALUE 'R'.
  7240             88  PY-EXP-PYMT                  VALUE 'E'.
  7241
  7242     12  PY-BIL-INV                       PIC X(6).
  7243     12  PY-REF-NO                        PIC X(12).
  7244
  7245     12  PY-LAST-MAINT-DT                 PIC XX.
  7246     12  PY-LAST-MAINT-BY                 PIC X(4).
  7247     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7248
  7249     12  PY-PYADJ-RECORD.
  7250         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7251         16  PY-ENTRY-COMMENT             PIC X(30).
  7252         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7253             20  PY-GL-ACCOUNT            PIC X(10).
  7254             20  PY-GL-STATE              PIC X(02).
  7255             20  PY-GL-CANC-SW            PIC X(01).
  7256                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7257                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7258             20  PY-GL-COMMENT            PIC X(10).
  7259             20  FILLER      REDEFINES PY-GL-COMMENT.
  7260                 24  PY-GL-CHECK-NO       PIC 9(06).
  7261                 24  FILLER               PIC X(04).
  7262             20  FILLER                   PIC X(07).
  7263         16  PY-SAVE-ACCOUNT              PIC X(10).
  7264         16  PY-SAVE-TYPE                 PIC X(01).
  7265
  7266         16  PY-LETTERS.
  7267             20  PY-LETTER OCCURS 3 TIMES
  7268                           INDEXED BY PY-LET-NDX
  7269                                          PIC X(04).
  7270
  7271         16  PY-ERCOMP-TYPE               PIC X.
  7272             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7273             88  PY-GA-TYPE                   VALUE 'G'.
  7274             88  PY-BANK-TYPE                 VALUE 'B'.
  7275         16  FILLER                       PIC X(05).
  7276
  7277     12  PY-RECORD-STATUS.
  7278         16  PY-CREDIT-SELECT-DT          PIC XX.
  7279         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7280         16  PY-BILLED-DATE               PIC XX.
  7281         16  PY-REPORTED-DT               PIC XX.
  7282         16  PY-PMT-APPLIED               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL6311.cbl
  7283             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7284             88  PY-GA-PMT                    VALUE 'G'.
  7285             88  PY-OVWRITE-PMT               VALUE 'O'.
  7286             88  PY-NON-AR-PMT                VALUE 'N'.
  7287         16  FILLER                       PIC X(5).
  7288         16  PY-INPUT-DT                  PIC XX.
  7289         16  PY-CHECK-NUMBER              PIC X(6).
  7290         16  PY-VOID-SW                   PIC X.
  7291             88  PY-CHECK-VOIDED              VALUE 'V'.
  7292         16  PY-CHECK-ORIGIN-SW           PIC X.
  7293             88  PY-BILLING-CHECK             VALUE 'B'.
  7294             88  PY-REFUND-CHECK              VALUE 'R'.
  7295             88  PY-GA-CHECK                  VALUE 'G'.
  7296             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7297             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7298         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7299         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7300         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7301         16  PY-BILL-FLAG                 PIC X.
  7302             88  PY-BILLED                    VALUE 'B'.
  7303         16  PY-AR-FLAG                   PIC X.
  7304             88  PY-AR-CYCLE                  VALUE 'C'.
  7305             88  PY-AR-MONTH-END              VALUE 'M'.
  7306         16  PY-AR-DATE                   PIC XX.
  7307
  7308     12  PY-GL-CODES.
  7309         16  PY-GL-DB                     PIC X(14).
  7310         16  PY-GL-CR                     PIC X(14).
  7311         16  PY-GL-FLAG                   PIC X.
  7312         16  PY-GL-DATE                   PIC XX.
  7313
  7314     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7315     12  FILLER                           PIC X(3).
  7316******************************************************************
  7317
  7318*    COPY ERCCNOT.
  7319******************************************************************
  7320*                                                                *
  7321*                            ERCCNOT                             *
  7322*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7323*                            VMOD=2.003                          *
  7324*                                                                *
  7325*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7326*                                                                *
  7327*        FILE TYPE= VSAM,KSDS                                    *
  7328*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7329*                                                                *
  7330*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7331*                                                                *
  7332*        LOG = YES                                               *
  7333*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7334*                                                                *
  7335******************************************************************
  7336*                   C H A N G E   L O G
  7337*
  7338* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7339*-----------------------------------------------------------------
  7340*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL6311.cbl
  7341* EFFECTIVE    NUMBER
  7342*-----------------------------------------------------------------
  7343* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7344******************************************************************
  7345
  7346 01  CERT-NOTE-FILE.
  7347     12  CZ-RECORD-ID                PIC  XX.
  7348         88  VALID-CZ-ID                  VALUE 'CZ'.
  7349
  7350     12  CZ-CONTROL-PRIMARY.
  7351         16  CZ-COMPANY-CD           PIC X.
  7352         16  CZ-CARRIER              PIC X.
  7353         16  CZ-GROUPING.
  7354             20 CZ-GROUPING-PREFIX   PIC XXX.
  7355             20 CZ-GROUPING-PRIME    PIC XXX.
  7356         16  CZ-STATE                PIC XX.
  7357         16  CZ-ACCOUNT.
  7358             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7359             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7360         16  CZ-CERT-EFF-DT          PIC XX.
  7361         16  CZ-CERT-NO.
  7362             20  CZ-CERT-PRIME       PIC X(10).
  7363             20  CZ-CERT-SFX         PIC X.
  7364         16  CZ-RECORD-TYPE          PIC X.
  7365             88  CERT-NOTE           VALUE '1'.
  7366             88  CLAIM-CERT-NOTE     VALUE '2'.
  7367         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7368
  7369     12  CZ-LAST-MAINT-DT            PIC XX.
  7370     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7371     12  CZ-LAST-MAINT-USER          PIC X(4).
  7372
  7373     12  CZ-NOTE-INFORMATION.
  7374         16  CZ-NOTE                 PIC X(63).
  7375         16  FILLER                  PIC X(39).
  7376******************************************************************
  7377
  7378*    COPY ELCMSTR.
  7379******************************************************************
  7380*                                                                *
  7381*                            ELCMSTR.                            *
  7382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7383*                            VMOD=2.012                          *
  7384*                                                                *
  7385*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7386*                                                                *
  7387*   FILE TYPE = VSAM,KSDS                                        *
  7388*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7389*                                                                *
  7390*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7391*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7392*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7393*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7394*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7395*                                                 RKP=75,LEN=21  *
  7396*                                                                *
  7397*   **** NOTE ****                                               *
  7398*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL6311.cbl
  7399*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7400*                                                                *
  7401*   LOG = YES                                                    *
  7402*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7403******************************************************************
  7404*                   C H A N G E   L O G
  7405*
  7406* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7407*-----------------------------------------------------------------
  7408*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7409* EFFECTIVE    NUMBER
  7410*-----------------------------------------------------------------
  7411* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7412* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7413******************************************************************
  7414 01  CLAIM-MASTER.
  7415     12  CL-RECORD-ID                PIC XX.
  7416         88  VALID-CL-ID         VALUE 'CL'.
  7417
  7418     12  CL-CONTROL-PRIMARY.
  7419         16  CL-COMPANY-CD           PIC X.
  7420         16  CL-CARRIER              PIC X.
  7421         16  CL-CLAIM-NO             PIC X(7).
  7422         16  CL-CERT-NO.
  7423             20  CL-CERT-PRIME       PIC X(10).
  7424             20  CL-CERT-SFX         PIC X.
  7425
  7426     12  CL-CONTROL-BY-NAME.
  7427         16  CL-COMPANY-CD-A1        PIC X.
  7428         16  CL-INSURED-LAST-NAME    PIC X(15).
  7429         16  CL-INSURED-NAME.
  7430             20  CL-INSURED-1ST-NAME PIC X(12).
  7431             20  CL-INSURED-MID-INIT PIC X.
  7432
  7433     12  CL-CONTROL-BY-SSN.
  7434         16  CL-COMPANY-CD-A2        PIC X.
  7435         16  CL-SOC-SEC-NO.
  7436             20  CL-SSN-STATE        PIC XX.
  7437             20  CL-SSN-ACCOUNT      PIC X(6).
  7438             20  CL-SSN-LN3          PIC X(3).
  7439
  7440     12  CL-CONTROL-BY-CERT-NO.
  7441         16  CL-COMPANY-CD-A4        PIC X.
  7442         16  CL-CERT-NO-A4.
  7443             20  CL-CERT-A4-PRIME    PIC X(10).
  7444             20  CL-CERT-A4-SFX      PIC X.
  7445
  7446     12  CL-CONTROL-BY-CCN.
  7447         16  CL-COMPANY-CD-A5        PIC X.
  7448         16  CL-CCN-A5.
  7449             20  CL-CCN.
  7450                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7451                 24  CL-CCN-PRIME-A5 PIC X(12).
  7452             20  CL-CCN-FILLER-A5    PIC X(4).
  7453
  7454     12  CL-INSURED-PROFILE-DATA.
  7455         16  CL-INSURED-BIRTH-DT     PIC XX.
  7456         16  CL-INSURED-SEX-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL6311.cbl
  7457             88  INSURED-IS-MALE        VALUE 'M'.
  7458             88  INSURED-IS-FEMALE      VALUE 'F'.
  7459             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7460         16  CL-INSURED-OCC-CD       PIC X(6).
  7461         16  FILLER                  PIC X(5).
  7462
  7463     12  CL-PROCESSING-INFO.
  7464         16  CL-PROCESSOR-ID         PIC X(4).
  7465         16  CL-CLAIM-STATUS         PIC X.
  7466             88  CLAIM-IS-OPEN          VALUE 'O'.
  7467             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7468         16  CL-CLAIM-TYPE           PIC X.
  7469*            88  AH-CLAIM               VALUE 'A'.
  7470*            88  LIFE-CLAIM             VALUE 'L'.
  7471*            88  PROPERTY-CLAIM         VALUE 'P'.
  7472*            88  IUI-CLAIM              VALUE 'I'.
  7473*            88  GAP-CLAIM              VALUE 'G'.
  7474         16  CL-CLAIM-PREM-TYPE      PIC X.
  7475             88  SINGLE-PREMIUM         VALUE '1'.
  7476             88  O-B-COVERAGE           VALUE '2'.
  7477             88  OPEN-END-COVERAGE      VALUE '3'.
  7478         16  CL-INCURRED-DT          PIC XX.
  7479         16  CL-REPORTED-DT          PIC XX.
  7480         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7481         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7482         16  CL-LAST-PMT-DT          PIC XX.
  7483         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7484         16  CL-PAID-THRU-DT         PIC XX.
  7485         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7486         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7487         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7488         16  CL-PMT-CALC-METHOD      PIC X.
  7489             88  CL-360-DAY-YR          VALUE '1'.
  7490             88  CL-365-DAY-YR          VALUE '2'.
  7491             88  CL-FULL-MONTHS         VALUE '3'.
  7492         16  CL-CAUSE-CD             PIC X(6).
  7493
  7494         16  CL-PRIME-CERT-NO.
  7495             20  CL-PRIME-CERT-PRIME PIC X(10).
  7496             20  CL-PRIME-CERT-SFX   PIC X.
  7497
  7498         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7499             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7500             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7501
  7502         16  CL-MICROFILM-NO         PIC X(10).
  7503         16  CL-PROG-FORM-TYPE       PIC X.
  7504         16  CL-LAST-ADD-ON-DT       PIC XX.
  7505
  7506         16  CL-LAST-REOPEN-DT       PIC XX.
  7507         16  CL-LAST-CLOSE-DT        PIC XX.
  7508         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7509             88  FINAL-PAID             VALUE '1'.
  7510             88  CLAIM-DENIED           VALUE '2'.
  7511             88  AUTO-CLOSE             VALUE '3'.
  7512             88  MANUAL-CLOSE           VALUE '4'.
  7513             88  BENEFITS-CHANGED       VALUE 'C'.
  7514             88  SETUP-ERRORS           VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL6311.cbl
  7515         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7516         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7517         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7518             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7519         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7520         16  FILLER                  PIC X.
  7521
  7522     12  CL-CERTIFICATE-DATA.
  7523         16  CL-CERT-ORIGIN          PIC X.
  7524             88  CERT-WAS-ONLINE        VALUE '1'.
  7525             88  CERT-WAS-CREATED       VALUE '2'.
  7526             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7527         16  CL-CERT-KEY-DATA.
  7528             20  CL-CERT-CARRIER     PIC X.
  7529             20  CL-CERT-GROUPING    PIC X(6).
  7530             20  CL-CERT-STATE       PIC XX.
  7531             20  CL-CERT-ACCOUNT.
  7532                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7533                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7534             20  CL-CERT-EFF-DT      PIC XX.
  7535
  7536     12  CL-STATUS-CONTROLS.
  7537         16  CL-PRIORITY-CD          PIC X.
  7538             88  CONFIDENTIAL-DATA      VALUE '8'.
  7539             88  HIGHEST-PRIORITY       VALUE '9'.
  7540         16  CL-SUPV-ATTN-CD         PIC X.
  7541             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7542             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7543         16  CL-PURGED-DT            PIC XX.
  7544         16  CL-RESTORED-DT          PIC XX.
  7545         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7546         16  CL-NEXT-RESEND-DT       PIC XX.
  7547         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7548         16  FILLER                  PIC XX.
  7549         16  CL-LAST-MAINT-DT        PIC XX.
  7550         16  CL-LAST-MAINT-USER      PIC X(4).
  7551         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7552         16  CL-LAST-MAINT-TYPE      PIC X.
  7553             88  CLAIM-SET-UP           VALUE ' '.
  7554             88  PAYMENT-MADE           VALUE '1'.
  7555             88  LETTER-SENT            VALUE '2'.
  7556             88  MASTER-WAS-ALTERED     VALUE '3'.
  7557             88  MASTER-WAS-RESTORED    VALUE '4'.
  7558             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7559             88  FILE-CONVERTED         VALUE '6'.
  7560             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7561             88  ERROR-CORRECTION       VALUE 'E'.
  7562         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7563         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7564         16  CL-BENEFICIARY          PIC X(10).
  7565         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7566         16  CL-DENIAL-TYPE          PIC X.
  7567             88  CL-TYPE-DENIAL          VALUE '1'.
  7568             88  CL-TYPE-RESCISSION      VALUE '2'.
  7569             88  CL-TYPE-REFORMATION     VALUE '3'.
  7570             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7571             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7572         16  FILLER                  PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL6311.cbl
  7573
  7574     12  CL-TRAILER-CONTROLS.
  7575         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7576             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7577             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7578             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7579         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7580         16  FILLER                  PIC XX.
  7581         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7582         16  CL-ADDRESS-TRAILER-CNT.
  7583             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7584                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7585             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7586                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7587             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7588                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7589             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7590                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7591             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7592                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7593             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7594                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7595             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7596                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7597
  7598     12  CL-CV-REFERENCE-NO.
  7599         16  CL-CV-REFNO-PRIME       PIC X(18).
  7600         16  CL-CV-REFNO-SFX         PIC XX.
  7601
  7602     12  CL-FILE-LOCATION            PIC X(4).
  7603
  7604     12  CL-PROCESS-ERRORS.
  7605         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7606             88  NO-FATAL-ERRORS        VALUE ZERO.
  7607         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7608             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7609
  7610     12  CL-PRODUCT-CD               PIC X.
  7611
  7612     12  CL-CURRENT-KEY-DATA.
  7613         16  CL-CURRENT-CARRIER      PIC X.
  7614         16  CL-CURRENT-GROUPING     PIC X(6).
  7615         16  CL-CURRENT-STATE        PIC XX.
  7616         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7617
  7618     12  CL-ASSOCIATES               PIC X.
  7619         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7620         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7621         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7622         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7623
  7624     12  CL-ACTIVITY-CODE            PIC 99.
  7625     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7626     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7627
  7628     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7629     12  CL-LAG-REPORT-CODE          PIC 9.
  7630     12  CL-LOAN-TYPE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL6311.cbl
  7631     12  CL-LEGAL-STATE              PIC XX.
  7632
  7633*    12  FILLER                      PIC X(5).
  7634     12  CL-YESNOSW                  PIC X.
  7635     12  FILLER                      PIC X(4).
  7636
  7637*    COPY ERCENDT.
  7638******************************************************************
  7639*                                                                *
  7640*                                                                *
  7641*                            ERCENDT.                            *
  7642*                            VMOD=2.001                          *
  7643*                                                                *
  7644*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7645*                                                                *
  7646*   FILE TYPE = VSAM,KSDS                                        *
  7647*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7648*                                                                *
  7649*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7650*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7651*                                                                *
  7652*   LOG = NO                                                     *
  7653*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7654******************************************************************
  7655*-----------------------------------------------------------------
  7656*                   C H A N G E   L O G
  7657*
  7658* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7659*-----------------------------------------------------------------
  7660*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7661* EFFECTIVE    NUMBER
  7662*-----------------------------------------------------------------
  7663* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7664*                                WITH OPEN CLAIMS
  7665* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7666*-----------------------------------------------------------------
  7667 01  ENDORSEMENT-RECORD.
  7668     12  EN-RECORD-ID                PIC XX.
  7669         88  VALID-EN-ID                VALUE 'EN'.
  7670     12  EN-CONTROL-PRIMARY.
  7671         16  EN-COMPANY-CD           PIC X.
  7672         16  EN-CARRIER              PIC X.
  7673         16  EN-GROUPING             PIC X(6).
  7674         16  EN-STATE                PIC XX.
  7675         16  EN-ACCOUNT              PIC X(10).
  7676         16  EN-CERT-EFF-DT          PIC XX.
  7677         16  EN-CERT-NO.
  7678             20  EN-CERT-PRIME       PIC X(10).
  7679             20  EN-CERT-SFX         PIC X.
  7680         16  EN-REC-TYPE             PIC X.
  7681             88  EN-ISSUE               VALUE 'I'.
  7682             88  EN-CANCELLATION        VALUE 'C'.
  7683         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7684     12  EN-CONTROL-BY-ARCH-NO.
  7685         16  EN-COMPANY-CD-A1              PIC X.
  7686         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7687     12  EN-LAST-MAINT-DT            PIC XX.
  7688     12  EN-LAST-MAINT-BY            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL6311.cbl
  7689     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7690     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7691     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7692         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7693         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7694         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7695         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7696         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7697         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7698         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7699         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7700         16  EN-LF-ORIG-BENCD        PIC XX.
  7701         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7702         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7703         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7704         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7705         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7706         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7707*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7708         16  EN-ORIG-CRED-BENE       PIC X(25).
  7709         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7710         16  FILLER                  PIC X.
  7711         16  EN-AH-ORIG-BENCD        PIC XX.
  7712         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7713         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7714         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7715         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7716*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7717*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7718         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7719         16  F                       PIC X(09).
  7720         16  EN-AH-ORIG-CP           PIC 99.
  7721         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7722         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7723         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7724         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7725         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7726         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7727         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7728         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7729         16  EN-LF-NEW-BENCD         PIC XX.
  7730         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7731         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7732         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7733         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7734         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7735         16  EN-LF-NEW-EXP-DT        PIC XX.
  7736         16  EN-NEW-CRED-BENE        PIC X(25).
  7737         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7738         16  FILLER                  PIC X.
  7739         16  EN-AH-NEW-BENCD         PIC XX.
  7740         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7741         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7742         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7743         16  EN-AH-NEW-EXP-DT        PIC XX.
  7744*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7745*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7746*        16  F                       PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL6311.cbl
  7747         16  EN-AH-NEW-CP            PIC 99.
  7748         16  EN-SIG-SW               PIC X.
  7749         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7750         16  FILLER                  PIC X(37).
  7751     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7752         16  EN-LF-ORIG-REF-DT       PIC XX.
  7753         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7754         16  EN-AH-ORIG-REF-DT       PIC XX.
  7755         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7756         16  EN-LF-NEW-REF-DT        PIC XX.
  7757         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7758         16  EN-AH-NEW-REF-DT        PIC XX.
  7759         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7760         16  EN-FLAG-CERT            PIC X.
  7761         16  EN-INS-LAST-NAME        PIC X(15).
  7762         16  EN-INS-FIRST-NAME       PIC X(10).
  7763         16  EN-INS-MIDDLE-INIT      PIC X.
  7764         16  FILLER                  PIC X(274).
  7765     12  EN-MONEY-SW             PIC X.
  7766     12  EN-HEALTH-APP           PIC X.
  7767     12  EN-VOUCHER-SW           PIC X.
  7768     12  EN-PAYEE                PIC X(14).
  7769     12  EN-INPUT-DT             PIC XX.
  7770     12  EN-PROCESS-DT           PIC XX.
  7771     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7772     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7773     12  EN-REASON-CODES.
  7774         16  F OCCURS 12.
  7775             20  EN-REASON-CODE  PIC X(4).
  7776     12  EN-TEMPLATE-USED        PIC X(8).
  7777     12  EN-DOCU-TYPE            PIC X.
  7778         88  EN-VERI-DOCU          VALUE 'V'.
  7779         88  EN-GCE-DOCU           VALUE 'G'.
  7780         88  EN-CANC-DOCU          VALUE 'C'.
  7781     12  EN-COMMENTS1            PIC X(13).
  7782     12  EN-COMMENTS2            PIC X(70).
  7783     12  EN-COMM-CHGBK           PIC X.
  7784         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7785         88  EN-CHG-ACCT           VALUE 'Y'.
  7786     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7787     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7788     12  EN-BATCH-NUMBER         PIC X(6).
  7789     12  EN-ACCT-SUMM            PIC X.
  7790     12  EN-CSO-SUMM             PIC X.
  7791     12  FILLER                  PIC X(13).
  7792******************************************************************
  7793
  7794 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  7795                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  7796                          PENDING-MAILING-DATA MAILING-DATA
  7797                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  7798                          PENDING-PAY-ADJ CERT-NOTE-FILE
  7799                          CLAIM-MASTER ENDORSEMENT-RECORD.
  7800 0000-DFHEXIT SECTION.
  7801     MOVE '9#                    $   ' TO DFHEIV0.
  7802     MOVE 'EL6311' TO DFHEIV1.
  7803     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7804
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL6311.cbl
  7805     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7806     MOVE EIBTRMID               TO QID-TERM.
  7807     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  7808     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7809     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7810     MOVE 2                      TO EMI-SWITCH2.
  7811
  7812     IF EIBCALEN = 0
  7813         GO TO 8800-UNAUTHORIZED-ACCESS.
  7814
  7815     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  7816     MOVE '5'                   TO DC-OPTION-CODE.
  7817     PERFORM 9700-DATE-LINK.
  7818     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  7819     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  7820
  7821     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  7822     MOVE SPACE                  TO DC-OPTION-CODE.
  7823     PERFORM 9700-DATE-LINK.
  7824     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  7825     MOVE LOW-VALUES             TO EL631BI.
  7826
  7827
  7828* EXEC CICS HANDLE CONDITION
  7829*        PGMIDERR  (9600-PGMID-ERROR)
  7830*        ERROR     (9990-ABEND)
  7831*        INVREQ    (9990-ABEND)
  7832*        QIDERR    (0010-MAIN-LOGIC)
  7833*    END-EXEC.
  7834*    MOVE '"$L.8N                ! " #00007823' TO DFHEIV0
  7835     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  7836     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7837     MOVE X'2220233030303037383233' TO DFHEIV0(25:11)
  7838     CALL 'kxdfhei1' USING DFHEIV0
  7839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7840
  7841
  7842     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7843         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7844             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7845             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7846             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7847             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7848             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7849             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7850             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7851             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7852
  7853             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  7854                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  7855
  7856             ELSE
  7857                 NEXT SENTENCE
  7858
  7859         ELSE
  7860             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  7861             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7862             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL6311.cbl
  7863             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7864             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7865             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7866             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7867             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7868             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7869             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  7870             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  7871             GO TO 3900-RE-DISPLAY-RECORD
  7872     ELSE
  7873         GO TO 0020-MAIN-LOGIC.
  7874
  7875 0010-MAIN-LOGIC.
  7876     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  7877                                    WS-FIRST-ENTRY-SW.
  7878
  7879     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  7880
  7881     MOVE LOW-VALUES             TO EC-NEW-CERT
  7882                                    EC-NEW-STATE.
  7883
  7884     IF PI-DISPLAY-ORIGINAL-BATCH
  7885         NEXT SENTENCE
  7886     ELSE
  7887         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  7888             GO TO 5000-BROWSE-BATCH-HEADERS.
  7889
  7890     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  7891         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  7892
  7893     IF PI-CSR-BROWSE
  7894        GO TO 4200-BROWSE-CSR-FORWARD.
  7895
  7896     IF PI-FILE-BROWSE
  7897         GO TO 4300-BROWSE-FILE-FORWARD.
  7898
  7899     GO TO 4000-BROWSE-DETAIL-FORWARD.
  7900
  7901 0020-MAIN-LOGIC.
  7902     IF EIBAID = DFHCLEAR
  7903         GO TO 9400-CLEAR.
  7904
  7905     MOVE LOW-VALUES             TO EC-NEW-CERT
  7906                                    EC-NEW-STATE.
  7907
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL6311.cbl
  7909
  7910******************************************************************
  7911*                                                                *
  7912*              R E C E I V E   M A P                             *
  7913*                                                                *
  7914******************************************************************
  7915
  7916 0200-RECEIVE.
  7917     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7918         MOVE ER-0008            TO EMI-ERROR
  7919         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7920         IF PI-MAP-NAME = EL631B
  7921             MOVE -1                 TO BMAINTL
  7922             GO TO 8200-SEND-DATAONLY
  7923         ELSE
  7924             IF PI-MAP-NAME = EL631C
  7925                 MOVE -1                 TO CMAINTL
  7926                 GO TO 8200-SEND-DATAONLY
  7927             ELSE
  7928                 IF PI-MAP-NAME = EL631D
  7929                     MOVE -1                 TO DPFENTRL
  7930                     GO TO 8200-SEND-DATAONLY.
  7931
  7932
  7933* EXEC CICS RECEIVE
  7934*        MAP      (PI-MAP-NAME)
  7935*        MAPSET   (MAPSET-EL6311S)
  7936*        INTO     (EL631BI)
  7937*    END-EXEC.
  7938     MOVE LENGTH OF
  7939      EL631BI
  7940       TO DFHEIV11
  7941*    MOVE '8"T I  L              ''   #00007920' TO DFHEIV0
  7942     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7943     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7944     MOVE X'2020233030303037393230' TO DFHEIV0(25:11)
  7945     CALL 'kxdfhei1' USING DFHEIV0,
  7946           PI-MAP-NAME,
  7947           EL631BI,
  7948           DFHEIV11,
  7949           MAPSET-EL6311S,
  7950           DFHEIV99,
  7951           DFHEIV99
  7952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7953
  7954
  7955******************************************************************
  7956*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  7957******************************************************************
  7958
  7959     IF BTYPE-LEN (1) EQUAL +3
  7960        IF BTYPE (1) EQUAL ALL ' '
  7961            MOVE 'Y' TO WS-REMOVE-LF-SW.
  7962
  7963     IF BTYPE-LEN (2) EQUAL +3
  7964        IF BTYPE (2) EQUAL ALL ' '
  7965            MOVE 'Y' TO WS-REMOVE-AH-SW.
  7966
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL6311.cbl
  7967     INSPECT EL631BI CONVERTING '_' TO ' '.
  7968
  7969     IF PI-MAP-NAME = EL631B
  7970         IF BPFENTRL GREATER THAN ZEROS
  7971             IF EIBAID NOT = DFHENTER
  7972                 MOVE ER-0004       TO EMI-ERROR
  7973                 MOVE -1            TO BPFENTRL
  7974                 MOVE AL-UNBOF      TO BPFENTRA
  7975                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7976                 GO TO 8200-SEND-DATAONLY
  7977             ELSE
  7978                 IF BPFENTRI NUMERIC AND
  7979                   (BPFENTRI GREATER 0 AND LESS 25)
  7980                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  7981                 ELSE
  7982                     MOVE ER-0029  TO EMI-ERROR
  7983                     MOVE AL-UNBON TO BPFENTRA
  7984                     MOVE -1       TO BPFENTRL
  7985                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7986                     GO TO 8200-SEND-DATAONLY
  7987         ELSE
  7988             NEXT SENTENCE
  7989     ELSE
  7990         IF PI-MAP-NAME = EL631C
  7991            IF CPFENTRL GREATER THAN ZEROS
  7992                IF EIBAID NOT = DFHENTER
  7993                 MOVE ER-0004         TO EMI-ERROR
  7994                 MOVE -1              TO CPFENTRL
  7995                 MOVE AL-UNBOF        TO CPFENTRA
  7996                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7997                 GO TO 8200-SEND-DATAONLY
  7998             ELSE
  7999                 IF CPFENTRI NUMERIC AND
  8000                   (CPFENTRI GREATER 0 AND LESS 25)
  8001                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8002                 ELSE
  8003                     MOVE ER-0029      TO EMI-ERROR
  8004                     MOVE AL-UNBON     TO CPFENTRA
  8005                     MOVE -1           TO CPFENTRL
  8006                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8007                     GO TO 8200-SEND-DATAONLY
  8008         ELSE
  8009             NEXT SENTENCE
  8010     ELSE
  8011     IF PI-MAP-NAME = EL631D
  8012         IF DPFENTRL GREATER THAN ZEROS
  8013             IF EIBAID NOT = DFHENTER
  8014                 MOVE ER-0004         TO EMI-ERROR
  8015                 MOVE -1              TO DPFENTRL
  8016                 MOVE AL-UNBOF        TO DPFENTRA
  8017                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8018                 GO TO 8200-SEND-DATAONLY
  8019             ELSE
  8020                 IF DPFENTRI NUMERIC AND
  8021                   (DPFENTRI GREATER 0 AND LESS 25)
  8022                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8023                 ELSE
  8024                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL6311.cbl
  8025                     MOVE AL-UNBON     TO DPFENTRA
  8026                     MOVE -1           TO DPFENTRL
  8027                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8028                     GO TO 8200-SEND-DATAONLY.
  8029
  8030     IF EIBAID = DFHPF23
  8031         GO TO 8810-PF23.
  8032
  8033     IF EIBAID = DFHPF24
  8034         GO TO 9200-RETURN-MAIN-MENU.
  8035
  8036     IF EIBAID = DFHPF12
  8037         GO TO 9500-PF12.
  8038
  8039     IF PI-MAP-NAME = EL631B
  8040        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8041
  8042     IF PI-MAP-NAME = EL631C
  8043        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8044
  8045     IF PI-MAP-NAME = EL631D
  8046        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8047
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL6311.cbl
  8049
  8050******************************************************************
  8051*                                                                *
  8052*      ISSUE SCREEN PF KEY CHECKING                              *
  8053*                                                                *
  8054******************************************************************
  8055
  8056******************************************************************
  8057*                                                                *
  8058*      PF KEY FUNCTIONS:                                         *
  8059*                                                                *
  8060*      PF1  = BROWSE FORWARD                                     *
  8061*      PF2  = BROWSE BACKWARD                                    *
  8062*      PF3  = CERTIFICATE LOOKUP                                 *
  8063*      PF4  = DISPLAY BATCH HEADER                               *
  8064*      PF5  = ADD ISSUE  SCREEN                                  *
  8065*      PF6  = ADD CANCEL SCREEN                                  *
  8066*      PF7  = CERTIFICATE DISPLAY                                *
  8067*      PF8  = CERTIFICATE NOTES                                  *
  8068*      PF9  = EDIT CONTROL                                       *
  8069*      PF10 = DISPLAY LETTER SCREEN                              *
  8070*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8071*      PF12 = HELP SCREEN                                        *
  8072*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8073*      PF14 = ACCOUNT MASTER                                     *
  8074*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8075*      PF16 = DISPLAY LETTER REVIEW                              *
  8076*                                                                *
  8077******************************************************************
  8078
  8079 0300-CHECK-ISSUE-PF-KEYS.
  8080     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8081        MOVE ER-2337            TO EMI-ERROR
  8082        MOVE -1                  TO BMAINTL
  8083        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8084        GO TO 8200-SEND-DATAONLY.
  8085
  8086     IF EIBAID = DFHPF1
  8087        MOVE '0'                TO PI-EDIT-SW
  8088        IF PI-PRIMARY-BROWSE
  8089           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8090        ELSE
  8091           IF PI-PRIMARY-WITH-SELECT
  8092              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8093           ELSE
  8094              IF PI-FILE-BROWSE
  8095                 GO TO 4300-BROWSE-FILE-FORWARD
  8096              ELSE
  8097                 IF PI-CSR-BROWSE
  8098                    GO TO 4200-BROWSE-CSR-FORWARD
  8099                 ELSE
  8100                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8101
  8102     IF EIBAID = DFHPF2
  8103        MOVE '0'                TO PI-EDIT-SW
  8104        IF PI-PRIMARY-BROWSE
  8105           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8106        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL6311.cbl
  8107           IF PI-PRIMARY-WITH-SELECT
  8108              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8109           ELSE
  8110              IF PI-FILE-BROWSE
  8111                 GO TO 4800-BROWSE-FILE-BACKWARD
  8112              ELSE
  8113                 IF PI-CSR-BROWSE
  8114                    GO TO 4900-BROWSE-CSR-BACKWARD
  8115                 ELSE
  8116                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8117
  8118     IF EIBAID = DFHPF3
  8119        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8120        MOVE XCTL-EL127         TO PGM-NAME
  8121        GO TO 9300-XCTL.
  8122
  8123     IF (EIBAID = DFHPF15 OR DFHPF6)
  8124        AND (CSR-EDIT-SESSION)
  8125*       AND (FATAL-OR-UNFORCED)
  8126        AND (FATAL-ERRORS)
  8127        MOVE ER-1819             TO EMI-ERROR
  8128        MOVE -1                  TO BMAINTL
  8129        MOVE AL-UANON            TO BMAINTA
  8130        PERFORM 9900-ERROR-FORMAT
  8131                                 THRU 9900-EXIT
  8132        GO TO 8200-SEND-DATAONLY
  8133     END-IF
  8134     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8135      OR (EIBAID = DFHPF10)
  8136        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8137        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8138        IF (RESP-NORMAL)
  8139           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8140              AM-CONTROL-PRIMARY (1:20))
  8141            IF AM-NAME NOT GREATER THAN SPACES OR
  8142               AM-ADDRS NOT GREATER THAN SPACES  OR
  8143               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8144               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8145               AM-ZIP NOT GREATER THAN SPACES
  8146               MOVE ER-3834             TO EMI-ERROR
  8147               MOVE -1                  TO BMAINTL
  8148               MOVE AL-UANON            TO BMAINTA
  8149               PERFORM 9900-ERROR-FORMAT
  8150                                 THRU 9900-EXIT
  8151               GO TO 8200-SEND-DATAONLY
  8152            END-IF
  8153        ELSE
  8154           MOVE ER-1609             TO EMI-ERROR
  8155           MOVE -1                  TO BMAINTL
  8156           MOVE AL-UANON            TO BMAINTA
  8157           PERFORM 9900-ERROR-FORMAT
  8158                                THRU 9900-EXIT
  8159           GO TO 8200-SEND-DATAONLY
  8160        END-IF
  8161
  8162        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8163        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8164        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL6311.cbl
  8165            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8166               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8167               MA-CITY NOT GREATER THAN SPACES OR
  8168               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8169               MA-ZIP-CODE NOT GREATER THAN SPACES
  8170               MOVE ER-3835             TO EMI-ERROR
  8171               MOVE -1                  TO BMAINTL
  8172               MOVE AL-UANON            TO BMAINTA
  8173               PERFORM 9900-ERROR-FORMAT
  8174                                 THRU 9900-EXIT
  8175               GO TO 8200-SEND-DATAONLY
  8176            END-IF
  8177        ELSE
  8178           MOVE ER-3000             TO EMI-ERROR
  8179           MOVE -1                  TO BMAINTL
  8180           MOVE AL-UANON            TO BMAINTA
  8181           PERFORM 9900-ERROR-FORMAT
  8182                                THRU 9900-EXIT
  8183           GO TO 8200-SEND-DATAONLY
  8184        END-IF
  8185
  8186     END-IF
  8187     IF (EIBAID = DFHPF15)
  8188        AND (CSR-EDIT-SESSION)
  8189        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8190        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8191        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8192        MOVE PI-SV-STATE         TO PI-STATE
  8193        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8194        MOVE BCERTNOI            TO PI-CERT-PRIME
  8195        MOVE BSUFIXI             TO PI-CERT-SFX
  8196        MOVE BEFFDTI             TO DEEDIT-FIELD
  8197        PERFORM 8600-DEEDIT
  8198        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8199        MOVE '4'                 TO DC-OPTION-CODE
  8200        PERFORM 9700-DATE-LINK
  8201        IF DATE-CONVERSION-ERROR
  8202           MOVE ER-0348          TO EMI-ERROR
  8203           MOVE -1               TO BEFFDTL
  8204           MOVE AL-UABON         TO BEFFDTA
  8205           PERFORM 9900-ERROR-FORMAT
  8206                                 THRU 9900-EXIT
  8207           GO TO 8200-SEND-DATAONLY
  8208        ELSE
  8209           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8210           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8211           MOVE XCTL-EL6315      TO PGM-NAME
  8212           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8213           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8214           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8215           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8216           GO TO 9300-XCTL
  8217        END-IF
  8218     END-IF
  8219
  8220     IF EIBAID = DFHPF4
  8221        MOVE '0'                TO PI-EDIT-SW
  8222        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL6311.cbl
  8223           NEXT SENTENCE
  8224        ELSE
  8225           GO TO 7200-DISPLAY-BATCHES.
  8226
  8227     IF EIBAID = DFHPF5
  8228        MOVE ER-0029                TO EMI-ERROR
  8229        MOVE -1                     TO BPFENTRL
  8230        MOVE AL-UNBON               TO BPFENTRA
  8231        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8232        GO TO 8200-SEND-DATAONLY.
  8233*        MOVE '0'                TO PI-EDIT-SW
  8234*        IF PI-DISPLAY-ORIGINAL-BATCH
  8235*           NEXT SENTENCE
  8236*        ELSE
  8237*           MOVE EL631B              TO PI-MAP-NAME
  8238*           MOVE LOW-VALUES          TO EL631BI
  8239*           MOVE 'A'                 TO BMAINTO
  8240*           MOVE AL-UANON            TO BMAINTA
  8241*           MOVE -1                  TO BMAINTL
  8242*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8243*           GO TO 8100-SEND-INITIAL-MAP.
  8244
  8245     IF EIBAID = DFHPF6
  8246        IF NOT CSR-EDIT-SESSION
  8247           MOVE ER-0029                TO EMI-ERROR
  8248           MOVE -1                     TO BPFENTRL
  8249           MOVE AL-UNBON               TO BPFENTRA
  8250           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8251           GO TO 8200-SEND-DATAONLY
  8252*           MOVE '0'              TO PI-EDIT-SW
  8253*           IF PI-DISPLAY-ORIGINAL-BATCH
  8254*              NEXT SENTENCE
  8255*           ELSE
  8256*              MOVE EL631C        TO PI-MAP-NAME
  8257*              MOVE LOW-VALUES    TO EL631CI
  8258*              MOVE 'A'           TO CMAINTO
  8259*              MOVE AL-UANON      TO CMAINTA
  8260*              MOVE -1            TO CMAINTL
  8261*              MOVE '6'           TO PI-MAINT-FUNCTION
  8262*              GO TO 8100-SEND-INITIAL-MAP
  8263*           END-IF
  8264        ELSE
  8265           PERFORM 5100-PROCESS-POL-RESC
  8266                                 THRU 5100-EXIT
  8267           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8268           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8269                                    PI-PREV-SEQ-NO
  8270           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8271*                                    WS-CANCEL-LETTER-SW
  8272                                    PI-ALL-ISSUES-SW
  8273                                    PI-ALL-CANCELS-SW
  8274           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8275        END-IF
  8276     END-IF
  8277     IF EIBAID = DFHPF7
  8278        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8279        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8280        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL6311.cbl
  8281        MOVE PI-SV-STATE            TO PI-STATE
  8282        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8283        MOVE BCERTNOI               TO PI-CERT-PRIME
  8284        MOVE BSUFIXI                TO PI-CERT-SFX
  8285        MOVE BEFFDTI                TO DEEDIT-FIELD
  8286        PERFORM 8600-DEEDIT
  8287        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8288        MOVE '4'                    TO DC-OPTION-CODE
  8289        PERFORM 9700-DATE-LINK
  8290        IF DATE-CONVERSION-ERROR
  8291           MOVE ER-0348            TO EMI-ERROR
  8292           MOVE -1                  TO BEFFDTL
  8293           MOVE AL-UABON            TO BEFFDTA
  8294           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8295           GO TO 8200-SEND-DATAONLY
  8296        ELSE
  8297           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8298           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8299           MOVE XCTL-EL1273        TO PGM-NAME
  8300           GO TO 9300-XCTL.
  8301
  8302     IF EIBAID = DFHPF8
  8303        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8304        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8305        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8306        MOVE PI-SV-STATE            TO PI-STATE
  8307        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8308        MOVE BCERTNOI               TO PI-CERT-PRIME
  8309        MOVE BSUFIXI                TO PI-CERT-SFX
  8310        MOVE BEFFDTI                TO DEEDIT-FIELD
  8311        PERFORM 8600-DEEDIT
  8312        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8313        MOVE '4'                    TO DC-OPTION-CODE
  8314        PERFORM 9700-DATE-LINK
  8315        IF DATE-CONVERSION-ERROR
  8316           MOVE ER-0348            TO EMI-ERROR
  8317           MOVE -1                  TO BEFFDTL
  8318           MOVE AL-UABON            TO BEFFDTA
  8319           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8320           GO TO 8200-SEND-DATAONLY
  8321        ELSE
  8322           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8323           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8324           IF PI-COMPANY-ID = 'DMD'
  8325               MOVE XCTL-EL401DMD      TO PGM-NAME
  8326             ELSE
  8327               MOVE XCTL-EL1279        TO PGM-NAME
  8328           END-IF
  8329           GO TO 9300-XCTL.
  8330
  8331     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8332        MOVE XCTL-EL6312         TO PGM-NAME
  8333
  8334* EXEC CICS XCTL
  8335*           PROGRAM   (PGM-NAME)
  8336*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8337*           LENGTH    (WS-COMM-LENGTH)
  8338*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL6311.cbl
  8339*    MOVE '.$C                   $   #00008304' TO DFHEIV0
  8340     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8341     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8342     MOVE X'2020233030303038333034' TO DFHEIV0(25:11)
  8343     CALL 'kxdfhei1' USING DFHEIV0,
  8344           PGM-NAME,
  8345           PROGRAM-INTERFACE-BLOCK,
  8346           WS-COMM-LENGTH
  8347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8348     ELSE
  8349        MOVE '0'                 TO  PI-EDIT-SW.
  8350
  8351     IF  EIBAID = DFHPF10
  8352         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8353         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8354         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8355                                    PI-1042-WA
  8356         MOVE 4                  TO PI-689-DATA-SOURCE
  8357         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8358         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8359         MOVE PI-SV-STATE        TO PI-689-STATE
  8360         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8361         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8362         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8363         MOVE PI-PB-ALT-CHG-SEQ-NO
  8364                                 TO PI-689-ALT-SEQ-NO
  8365         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8366         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8367         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8368         MOVE +0                 TO PI-689-CONTROL
  8369         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8370                                    PI-689-EXP-DATE
  8371                                    PI-689-RESP-PERSON
  8372                                    PI-689-TYPE
  8373                                    PI-689-FOLLOW-UP-EDIT
  8374                                    PI-689-RESEND1-EDIT
  8375                                    PI-689-SEQ-EDIT
  8376                                    PI-689-BCSEQ-EDIT
  8377                                    PI-689-LBL-OVERRIDE
  8378         MOVE W-LETTER-COMMUNICATION-AREAS
  8379                                 TO PI-PROGRAM-WORK-AREA
  8380         MOVE XCTL-EL689         TO PGM-NAME
  8381         GO TO 9300-XCTL.
  8382
  8383     IF  EIBAID = DFHPF16
  8384         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8385         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8386         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8387                                    PI-1042-WA
  8388         MOVE 4                  TO PI-689-DATA-SOURCE
  8389         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8390         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8391         MOVE PI-SV-STATE        TO PI-689-STATE
  8392         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8393         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8394         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8395         MOVE PI-PB-ALT-CHG-SEQ-NO
  8396                                 TO PI-689-ALT-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL6311.cbl
  8397         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8398         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8399         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8400         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8401         MOVE W-LETTER-COMMUNICATION-AREAS
  8402                                 TO PI-PROGRAM-WORK-AREA
  8403         MOVE XCTL-EL690         TO PGM-NAME
  8404         GO TO 9300-XCTL.
  8405
  8406     IF EIBAID = DFHPF13
  8407         MOVE XCTL-EL6313        TO PGM-NAME
  8408         GO TO 9300-XCTL.
  8409
  8410     IF EIBAID = DFHPF17
  8411        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8412        IF (PB-I-LOAN-APR > ZEROS)
  8413           AND (PB-I-BENEFICIARY-NAME NOT
  8414              = SPACES AND LOW-VALUES)
  8415
  8416           MOVE LINK-ELVADS          TO PGM-NAME
  8417
  8418* EXEC CICS LINK
  8419*              PROGRAM    (PGM-NAME)
  8420*              COMMAREA   (WS-PASS-AREA)
  8421*              LENGTH     (WS-PASS-AREA-LENGTH)
  8422*          END-EXEC
  8423*    MOVE '."C                   ''   #00008378' TO DFHEIV0
  8424     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8425     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8426     MOVE X'2020233030303038333738' TO DFHEIV0(25:11)
  8427     CALL 'kxdfhei1' USING DFHEIV0,
  8428           PGM-NAME,
  8429           WS-PASS-AREA,
  8430           WS-PASS-AREA-LENGTH,
  8431           DFHEIV99,
  8432           DFHEIV99,
  8433           DFHEIV99
  8434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8435
  8436           MOVE 0000             TO EMI-ERROR
  8437           MOVE -1               TO BMAINTL
  8438           PERFORM 9900-ERROR-FORMAT
  8439                                 THRU 9900-EXIT
  8440           GO TO 8200-SEND-DATAONLY
  8441        ELSE
  8442           MOVE ER-0877            TO EMI-ERROR
  8443           MOVE -1                  TO BEFFDTL
  8444           MOVE AL-UABON            TO BEFFDTA
  8445           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8446           GO TO 8200-SEND-DATAONLY
  8447        END-IF
  8448     END-IF
  8449     IF EIBAID = DFHPF14
  8450        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8451        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8452        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8453        MOVE PI-SV-STATE            TO PI-CR-STATE
  8454        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL6311.cbl
  8455        MOVE SPACE                  TO PI-EDIT-SW
  8456        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8457        MOVE XCTL-EL650             TO PGM-NAME
  8458        GO TO 9300-XCTL.
  8459
  8460     IF EIBAID = DFHPF15
  8461        IF PI-COMPANY-ID  =  'HER'
  8462            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8463            MOVE XCTL-EL680         TO PGM-NAME
  8464            GO TO 9300-XCTL.
  8465
  8466     IF EIBAID = DFHENTER OR DFHPF11
  8467        GO TO 1000-ISSUE-MAINLINE.
  8468
  8469     MOVE ER-0029                TO EMI-ERROR
  8470     MOVE -1                     TO BPFENTRL
  8471     MOVE AL-UNBON               TO BPFENTRA
  8472     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8473     GO TO 8200-SEND-DATAONLY.
  8474
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL6311.cbl
  8476
  8477******************************************************************
  8478*                                                                *
  8479*      CANCEL SCREEN PF KEY CHECKING                             *
  8480*                                                                *
  8481******************************************************************
  8482
  8483******************************************************************
  8484*                                                                *
  8485*      PF KEY FUNCTIONS:                                         *
  8486*                                                                *
  8487*      PF1  = BROWSE FORWARD                                     *
  8488*      PF2  = BROWSE BACKWARD                                    *
  8489*      PF3  = CERTIFICATE LOOKUP                                 *
  8490*      PF4  = DISPLAY BATCH HEADER                               *
  8491*      PF5  = ADD ISSUE SCREEN                                   *
  8492*      PF6  = ADD CANCEL SCREEN                                  *
  8493*      PF7  = CERTIFICATE DISPLAY                                *
  8494*      PF8  = CERTIFICATE NOTES                                  *
  8495*      PF9  = EDIT CONTROL                                       *
  8496*      PF10 = DISPLAY LETTER SCREEN                              *
  8497*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8498*      PF12 = DISPLAY HELP SCREEN                                *
  8499*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8500*      PF14 = ACCOUNT MASTER                                     *
  8501*      PF16 = LETTER REVIEW                                      *
  8502*                                                                *
  8503******************************************************************
  8504
  8505 0400-CHECK-CANCEL-PF-KEYS.
  8506     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8507        MOVE ER-2337             TO EMI-ERROR
  8508        MOVE -1                  TO CMAINTL
  8509        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8510        GO TO 8200-SEND-DATAONLY.
  8511
  8512     IF EIBAID = DFHPF1
  8513        MOVE '0'                TO PI-EDIT-SW
  8514        IF PI-PRIMARY-BROWSE
  8515           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8516        ELSE
  8517           IF PI-PRIMARY-WITH-SELECT
  8518              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8519           ELSE
  8520              IF PI-FILE-BROWSE
  8521                 GO TO 4300-BROWSE-FILE-FORWARD
  8522              ELSE
  8523                 IF PI-CSR-BROWSE
  8524                    GO TO 4200-BROWSE-CSR-FORWARD
  8525                 ELSE
  8526                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8527
  8528     IF EIBAID = DFHPF2
  8529        MOVE '0'                TO PI-EDIT-SW
  8530        IF PI-PRIMARY-BROWSE
  8531           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8532        ELSE
  8533           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL6311.cbl
  8534              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8535           ELSE
  8536              IF PI-FILE-BROWSE
  8537                 GO TO 4800-BROWSE-FILE-BACKWARD
  8538              ELSE
  8539                 IF PI-CSR-BROWSE
  8540                    GO TO 4900-BROWSE-CSR-BACKWARD
  8541                 ELSE
  8542                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8543
  8544     IF EIBAID = DFHPF3
  8545        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8546        MOVE XCTL-EL127         TO PGM-NAME
  8547        GO TO 9300-XCTL.
  8548
  8549     IF (EIBAID = DFHPF15 OR DFHPF17)
  8550        AND (CSR-EDIT-SESSION)
  8551*       AND (FATAL-OR-UNFORCED)
  8552        AND (FATAL-ERRORS)
  8553        MOVE ER-1819             TO EMI-ERROR
  8554        MOVE -1                  TO CMAINTL
  8555        MOVE AL-UANON            TO CMAINTA
  8556        PERFORM 9900-ERROR-FORMAT
  8557                                 THRU 9900-EXIT
  8558        GO TO 8200-SEND-DATAONLY
  8559     END-IF
  8560     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8561       AND (CSR-EDIT-SESSION)
  8562        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8563        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8564        IF (RESP-NORMAL)
  8565           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8566              AM-CONTROL-PRIMARY (1:20))
  8567            IF AM-NAME NOT GREATER THAN SPACES OR
  8568               AM-ADDRS NOT GREATER THAN SPACES  OR
  8569               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8570               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8571               AM-ZIP NOT GREATER THAN SPACES
  8572               MOVE ER-3834             TO EMI-ERROR
  8573               MOVE -1                  TO BMAINTL
  8574               MOVE AL-UANON            TO BMAINTA
  8575               PERFORM 9900-ERROR-FORMAT
  8576                                 THRU 9900-EXIT
  8577               GO TO 8200-SEND-DATAONLY
  8578            END-IF
  8579        ELSE
  8580           MOVE ER-1609             TO EMI-ERROR
  8581           MOVE -1                  TO BMAINTL
  8582           MOVE AL-UANON            TO BMAINTA
  8583           PERFORM 9900-ERROR-FORMAT
  8584                                THRU 9900-EXIT
  8585           GO TO 8200-SEND-DATAONLY
  8586        END-IF
  8587
  8588        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8589        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8590        IF (ERMAIL-FOUND)
  8591            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL6311.cbl
  8592               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8593               MA-CITY NOT GREATER THAN SPACES OR
  8594               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8595               MA-ZIP-CODE NOT GREATER THAN SPACES
  8596               MOVE ER-3835             TO EMI-ERROR
  8597               MOVE -1                  TO BMAINTL
  8598               MOVE AL-UANON            TO BMAINTA
  8599               PERFORM 9900-ERROR-FORMAT
  8600                                 THRU 9900-EXIT
  8601               GO TO 8200-SEND-DATAONLY
  8602            END-IF
  8603        ELSE
  8604           MOVE ER-3000             TO EMI-ERROR
  8605           MOVE -1                  TO BMAINTL
  8606           MOVE AL-UANON            TO BMAINTA
  8607           PERFORM 9900-ERROR-FORMAT
  8608                                THRU 9900-EXIT
  8609           GO TO 8200-SEND-DATAONLY
  8610        END-IF
  8611
  8612     END-IF
  8613     IF (EIBAID = DFHPF15 OR DFHPF17)
  8614        AND (CSR-EDIT-SESSION)
  8615        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8616        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8617        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8618        MOVE PI-SV-STATE         TO PI-STATE
  8619        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8620        MOVE CCERTNOI            TO PI-CERT-PRIME
  8621        MOVE CSUFIXI             TO PI-CERT-SFX
  8622        MOVE CEFFDTI             TO DEEDIT-FIELD
  8623        PERFORM 8600-DEEDIT
  8624        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8625        MOVE '4'                 TO DC-OPTION-CODE
  8626        PERFORM 9700-DATE-LINK
  8627        IF DATE-CONVERSION-ERROR
  8628           MOVE ER-0348          TO EMI-ERROR
  8629           MOVE -1               TO CEFFDTL
  8630           MOVE AL-UABON         TO CEFFDTA
  8631           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8632           GO TO 8200-SEND-DATAONLY
  8633        ELSE
  8634           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8635           PERFORM 6000-CREATE-TEMP-STORAGE
  8636                                 THRU 6000-EXIT
  8637           IF EIBAID = DFHPF17
  8638               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8639                                  THRU 6400-EXIT
  8640               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8641                                 '2' AND '3' AND '4'
  8642                  MOVE ER-3831     TO  EMI-ERROR
  8643                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8644                  GO TO 8200-SEND-DATAONLY
  8645               END-IF
  8646               MOVE 'Y'          TO PI-CLM-RESC-IND
  8647           ELSE
  8648               MOVE 'N'          TO PI-CLM-RESC-IND
  8649           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL6311.cbl
  8650           MOVE XCTL-EL6316      TO PGM-NAME
  8651           MOVE '2'              TO PI-ISS-CAN-SW
  8652           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8653           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8654           GO TO 9300-XCTL
  8655        END-IF
  8656     END-IF
  8657
  8658     IF EIBAID = DFHPF4
  8659        MOVE '0'                TO PI-EDIT-SW
  8660        IF PI-DISPLAY-ORIGINAL-BATCH
  8661           NEXT SENTENCE
  8662        ELSE
  8663           GO TO 7200-DISPLAY-BATCHES.
  8664
  8665     IF EIBAID = DFHPF5
  8666        MOVE ER-0029                TO EMI-ERROR
  8667        MOVE -1                     TO BPFENTRL
  8668        MOVE AL-UNBON               TO BPFENTRA
  8669        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8670        GO TO 8200-SEND-DATAONLY.
  8671*        MOVE '0'                TO PI-EDIT-SW
  8672*        IF PI-DISPLAY-ORIGINAL-BATCH
  8673*           NEXT SENTENCE
  8674*        ELSE
  8675*           MOVE EL631B              TO PI-MAP-NAME
  8676*           MOVE LOW-VALUES          TO EL631BI
  8677*           MOVE 'A'                 TO BMAINTO
  8678*           MOVE AL-UANON            TO BMAINTA
  8679*           MOVE -1                  TO BMAINTL
  8680*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8681*           GO TO 8100-SEND-INITIAL-MAP.
  8682
  8683     IF EIBAID = DFHPF6
  8684        MOVE ER-0029                TO EMI-ERROR
  8685        MOVE -1                     TO BPFENTRL
  8686        MOVE AL-UNBON               TO BPFENTRA
  8687        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8688        GO TO 8200-SEND-DATAONLY.
  8689*        MOVE '0'                TO PI-EDIT-SW
  8690*        IF PI-DISPLAY-ORIGINAL-BATCH
  8691*           NEXT SENTENCE
  8692*        ELSE
  8693*           MOVE EL631C              TO PI-MAP-NAME
  8694*           MOVE LOW-VALUES          TO EL631CI
  8695*           MOVE 'A'                 TO CMAINTO
  8696*           MOVE AL-UANON            TO CMAINTA
  8697*           MOVE -1                  TO CMAINTL
  8698*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8699*           GO TO 8100-SEND-INITIAL-MAP.
  8700
  8701     IF EIBAID = DFHPF7
  8702        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8703        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8704        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8705        MOVE PI-SV-STATE            TO PI-STATE
  8706        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8707        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL6311.cbl
  8708        MOVE CSUFIXI                TO PI-CERT-SFX
  8709        MOVE CEFFDTI                TO DEEDIT-FIELD
  8710        PERFORM 8600-DEEDIT
  8711        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8712        MOVE '4'                    TO DC-OPTION-CODE
  8713        PERFORM 9700-DATE-LINK
  8714        IF DATE-CONVERSION-ERROR
  8715           MOVE ER-0348            TO EMI-ERROR
  8716           MOVE -1                  TO BEFFDTL
  8717           MOVE AL-UABON            TO BEFFDTA
  8718           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8719           GO TO 8200-SEND-DATAONLY
  8720        ELSE
  8721           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8722           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8723           MOVE XCTL-EL1273        TO PGM-NAME
  8724           GO TO 9300-XCTL.
  8725
  8726     IF EIBAID = DFHPF8
  8727        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8728        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8729        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8730        MOVE PI-SV-STATE            TO PI-STATE
  8731        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8732        MOVE CCERTNOI               TO PI-CERT-PRIME
  8733        MOVE CSUFIXI                TO PI-CERT-SFX
  8734        MOVE CEFFDTI                TO DEEDIT-FIELD
  8735        PERFORM 8600-DEEDIT
  8736        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8737        MOVE '4'                    TO DC-OPTION-CODE
  8738        PERFORM 9700-DATE-LINK
  8739        IF DATE-CONVERSION-ERROR
  8740           MOVE ER-0348             TO EMI-ERROR
  8741           MOVE -1                  TO BEFFDTL
  8742           MOVE AL-UABON            TO BEFFDTA
  8743           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8744           GO TO 8200-SEND-DATAONLY
  8745        ELSE
  8746           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8747           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8748           IF PI-COMPANY-ID = 'DMD'
  8749               MOVE XCTL-EL401DMD      TO PGM-NAME
  8750             ELSE
  8751               MOVE XCTL-EL1279        TO PGM-NAME
  8752           END-IF
  8753           GO TO 9300-XCTL.
  8754
  8755     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8756        MOVE XCTL-EL6312     TO PGM-NAME
  8757
  8758* EXEC CICS XCTL
  8759*           PROGRAM  (PGM-NAME)
  8760*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  8761*           LENGTH   (WS-COMM-LENGTH)
  8762*       END-EXEC
  8763*    MOVE '.$C                   $   #00008705' TO DFHEIV0
  8764     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8765     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL6311.cbl
  8766     MOVE X'2020233030303038373035' TO DFHEIV0(25:11)
  8767     CALL 'kxdfhei1' USING DFHEIV0,
  8768           PGM-NAME,
  8769           PROGRAM-INTERFACE-BLOCK,
  8770           WS-COMM-LENGTH
  8771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8772     ELSE
  8773        MOVE '0'                 TO  PI-EDIT-SW.
  8774
  8775     IF EIBAID = DFHPF10
  8776         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8777         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  8778         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8779         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8780                                    PI-1042-WA
  8781         MOVE 4                  TO PI-689-DATA-SOURCE
  8782         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8783         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8784         MOVE PI-SV-STATE        TO PI-689-STATE
  8785         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8786         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8787         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8788         MOVE PI-PB-ALT-CHG-SEQ-NO
  8789                                 TO PI-689-ALT-SEQ-NO
  8790         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8791         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8792         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8793         MOVE +0                 TO PI-689-CONTROL
  8794         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8795                                    PI-689-EXP-DATE
  8796                                    PI-689-RESP-PERSON
  8797                                    PI-689-TYPE
  8798                                    PI-689-FOLLOW-UP-EDIT
  8799                                    PI-689-RESEND1-EDIT
  8800                                    PI-689-SEQ-EDIT
  8801                                    PI-689-BCSEQ-EDIT
  8802                                    PI-689-LBL-OVERRIDE
  8803         MOVE W-LETTER-COMMUNICATION-AREAS
  8804                                 TO PI-PROGRAM-WORK-AREA
  8805         MOVE XCTL-EL689         TO PGM-NAME
  8806         GO TO 9300-XCTL.
  8807
  8808     IF  EIBAID = DFHPF16
  8809         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8810         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8811         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8812                                    PI-1042-WA
  8813         MOVE 4                  TO PI-689-DATA-SOURCE
  8814         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8815         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8816         MOVE PI-SV-STATE        TO PI-689-STATE
  8817         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8818         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8819         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8820         MOVE PI-PB-ALT-CHG-SEQ-NO
  8821                                 TO PI-689-ALT-SEQ-NO
  8822         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8823         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL6311.cbl
  8824         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8825         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8826         MOVE W-LETTER-COMMUNICATION-AREAS
  8827                                 TO PI-PROGRAM-WORK-AREA
  8828         MOVE XCTL-EL690         TO PGM-NAME
  8829         GO TO 9300-XCTL.
  8830
  8831     IF EIBAID = DFHPF13
  8832        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8833        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8834        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8835        MOVE PI-SV-STATE            TO PI-STATE
  8836        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8837        MOVE CCERTNOI               TO PI-CERT-PRIME
  8838        MOVE CSUFIXI                TO PI-CERT-SFX
  8839        MOVE CEFFDTI                TO DEEDIT-FIELD
  8840        PERFORM 8600-DEEDIT
  8841        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8842        MOVE '4'                    TO DC-OPTION-CODE
  8843        PERFORM 9700-DATE-LINK
  8844        IF DATE-CONVERSION-ERROR
  8845           MOVE ER-0348            TO EMI-ERROR
  8846           MOVE -1                  TO CEFFDTL
  8847           MOVE AL-UABON            TO CEFFDTA
  8848           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8849           GO TO 8200-SEND-DATAONLY
  8850        ELSE
  8851           MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  8852           MOVE AL-UANON            TO CEFFDTA
  8853           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8854           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8855           MOVE XCTL-EL677         TO PGM-NAME
  8856           GO TO 9300-XCTL.
  8857
  8858     IF EIBAID = DFHPF14
  8859        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8860        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8861        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8862        MOVE PI-SV-STATE            TO PI-CR-STATE
  8863        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8864        MOVE SPACE                  TO PI-EDIT-SW
  8865        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8866        MOVE XCTL-EL650             TO PGM-NAME
  8867        GO TO 9300-XCTL.
  8868
  8869     IF EIBAID = DFHENTER OR DFHPF11
  8870        GO TO 2000-CANCEL-MAINLINE.
  8871
  8872     MOVE ER-0029                TO EMI-ERROR.
  8873     MOVE -1                     TO CPFENTRL.
  8874     MOVE AL-UNBON               TO CPFENTRA.
  8875     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8876     GO TO 8200-SEND-DATAONLY.
  8877
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL6311.cbl
  8879
  8880******************************************************************
  8881*                                                                *
  8882*      BATCH SCREEN PF KEY CHECKING                              *
  8883*                                                                *
  8884******************************************************************
  8885
  8886******************************************************************
  8887*                                                                *
  8888*      PF KEY FUNCTIONS:                                         *
  8889*                                                                *
  8890*      PF1 = BROWSE FORWARD                                      *
  8891*      PF2 = BROWSE BACKWARD                                     *
  8892*      PF3 = DISPLAY PREMIUM TOTALS                              *
  8893*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  8894*                                                                *
  8895*                                                                *
  8896******************************************************************
  8897
  8898 0500-CHECK-BATCH-PF-KEYS.
  8899     IF EIBAID = DFHPF1
  8900        MOVE '0'                TO PI-EDIT-SW
  8901        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  8902           GO TO 5000-BROWSE-BATCH-HEADERS
  8903        ELSE
  8904           IF PI-GOOD-BROWSE
  8905              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8906                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  8907              ELSE
  8908                 IF PI-FILE-BROWSE
  8909                    GO TO 4300-BROWSE-FILE-FORWARD
  8910                 ELSE
  8911                    IF PI-CSR-BROWSE
  8912                       GO TO 4200-BROWSE-CSR-FORWARD
  8913                    ELSE
  8914                       GO TO 4000-BROWSE-DETAIL-FORWARD
  8915           ELSE
  8916              GO TO 0800-BROWSE-ERROR.
  8917
  8918     IF EIBAID = DFHPF2
  8919        MOVE '0'                TO PI-EDIT-SW
  8920        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  8921           GO TO 5500-BROWSE-BATCH-BACKWARD
  8922        ELSE
  8923           IF PI-GOOD-BROWSE
  8924              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8925                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8926              ELSE
  8927                 IF PI-FILE-BROWSE
  8928                    GO TO 4800-BROWSE-FILE-BACKWARD
  8929                 ELSE
  8930                    IF PI-CSR-BROWSE
  8931                       GO TO 4900-BROWSE-CSR-BACKWARD
  8932                    ELSE
  8933                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  8934           ELSE
  8935              GO TO 0800-BROWSE-ERROR.
  8936
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL6311.cbl
  8937     IF EIBAID = DFHPF3
  8938        GO TO 3000-BATCH-MAINLINE.
  8939
  8940     IF  EIBAID = DFHPF4
  8941        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8942        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8943        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8944        MOVE PI-SV-STATE            TO PI-CR-STATE
  8945        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8946                                       PI-CR-FIN-RESP
  8947        MOVE 'A'                    TO PI-CR-TYPE
  8948        MOVE SPACE                  TO PI-EDIT-SW
  8949        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8950        MOVE XCTL-EL640             TO PGM-NAME
  8951        GO TO 9300-XCTL.
  8952
  8953     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  8954       AND
  8955        (EIBAID = DFHENTER)
  8956           GO TO 3500-EDIT-BATCH-DATA.
  8957
  8958     IF EIBAID = DFHENTER
  8959        GO TO 3500-EDIT-BATCH-DATA.
  8960
  8961     MOVE ER-0029             TO EMI-ERROR.
  8962     MOVE -1                  TO DPFENTRL.
  8963     MOVE AL-UNBON            TO DPFENTRA.
  8964     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8965     GO TO 8200-SEND-DATAONLY.
  8966
  8967 0800-BROWSE-ERROR.
  8968     MOVE ER-2258                TO EMI-ERROR.
  8969     MOVE -1                     TO DPFENTRL.
  8970     MOVE AL-UNBON               TO DPFENTRA.
  8971     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8972     GO TO 8200-SEND-DATAONLY.
  8973
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL6311.cbl
  8975
  8976******************************************************************
  8977*                                                                *
  8978*                I S S U E   M A I N L I N E                     *
  8979*                                                                *
  8980******************************************************************
  8981
  8982 1000-ISSUE-MAINLINE.
  8983     IF PI-DISPLAY-ORIGINAL-BATCH
  8984        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  8985           MOVE ER-0023             TO EMI-ERROR
  8986           MOVE -1                  TO BMAINTL
  8987           MOVE AL-UABON            TO BMAINTA
  8988           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8989           GO TO 8200-SEND-DATAONLY
  8990        ELSE
  8991           NEXT SENTENCE
  8992     ELSE
  8993        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  8994           MOVE ER-0023             TO EMI-ERROR
  8995           MOVE -1                  TO BMAINTL
  8996           MOVE AL-UABON            TO BMAINTA
  8997           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8998           GO TO 8200-SEND-DATAONLY.
  8999
  9000     IF BMAINTI = 'S'
  9001        GO TO 1100-SHOW-REQUEST.
  9002
  9003     IF NOT MODIFY-CAP
  9004         MOVE 'UPDATE'       TO SM-READ
  9005         PERFORM 9995-SECURITY-VIOLATION
  9006         MOVE ER-0070        TO EMI-ERROR
  9007         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9008         GO TO 8100-SEND-INITIAL-MAP.
  9009
  9010     IF BMAINTL GREATER THAN ZEROS
  9011        IF PI-PF5-FUNCTION
  9012           IF BMAINTI NOT = 'A'
  9013              MOVE AL-UABON  TO BMAINTA
  9014              MOVE -1        TO BMAINTL
  9015              MOVE ER-2260   TO EMI-ERROR
  9016              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9017              GO TO 8200-SEND-DATAONLY.
  9018
  9019     IF BCERTNOL = ZEROS
  9020       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9021         NEXT SENTENCE
  9022     ELSE
  9023         IF BCERTNOL NOT = ZEROS
  9024             MOVE AL-UANON       TO BCERTNOA
  9025         ELSE
  9026             MOVE -1             TO BCERTNOL
  9027             MOVE  1             TO SET-CURSOR-SW
  9028             MOVE ER-2218        TO EMI-ERROR
  9029             MOVE AL-UABON       TO BCERTNOA
  9030             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9031
  9032     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL6311.cbl
  9033         MOVE AL-UANON       TO BSUFIXA
  9034     ELSE
  9035         MOVE AL-SANOF       TO BSUFIXA.
  9036
  9037     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9038        NEXT SENTENCE
  9039     ELSE
  9040        IF BEFFDTL NOT = ZEROS
  9041           MOVE AL-UNNON             TO BEFFDTA
  9042           MOVE BEFFDTI              TO DEEDIT-FIELD
  9043           PERFORM 8600-DEEDIT
  9044           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9045           MOVE 4                    TO DC-OPTION-CODE
  9046           PERFORM 9700-DATE-LINK
  9047           IF NO-CONVERSION-ERROR
  9048              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9049              ELSE
  9050              MOVE -1                TO BEFFDTL
  9051              MOVE  1                TO SET-CURSOR-SW
  9052              MOVE ER-2226           TO EMI-ERROR
  9053              MOVE AL-UNBON          TO BEFFDTA
  9054              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9055           ELSE
  9056              MOVE -1                TO BEFFDTL
  9057              MOVE  1                TO SET-CURSOR-SW
  9058              MOVE ER-2220           TO EMI-ERROR
  9059              MOVE AL-UNBON          TO BEFFDTA
  9060              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9061
  9062     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9063
  9064     IF BCERTNOL NOT = ZEROS
  9065        MOVE BCERTNOI                TO WS-NEW-PRIME
  9066     ELSE
  9067        MOVE SPACES                  TO WS-NEW-PRIME.
  9068
  9069     IF BSUFIXL NOT = ZEROS
  9070        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9071     ELSE
  9072        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9073
  9074     IF BEFFDTL NOT = ZEROS
  9075        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9076     ELSE
  9077        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9078
  9079     IF BMAINTI = 'A' OR 'K' OR 'S'
  9080        NEXT SENTENCE
  9081     ELSE
  9082        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9083        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9084           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9085           WS-PB-RECORD-TYPE NOT = '1'
  9086           IF BMAINTI = 'C'
  9087               MOVE ER-2287          TO EMI-ERROR
  9088               MOVE -1               TO BCERTNOL
  9089               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9090               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL6311.cbl
  9091               GO TO 8200-SEND-DATAONLY
  9092             ELSE
  9093               MOVE ER-2260          TO EMI-ERROR
  9094               MOVE -1               TO BCERTNOL
  9095               MOVE AL-UABON         TO BCERTNOA
  9096               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9097               GO TO 8200-SEND-DATAONLY.
  9098
  9099     IF BMAINTI = 'D'
  9100         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9101
  9102*    IF BMICRNOL  NOT =  ZEROS
  9103*        IF BMICRNOI  NUMERIC
  9104*            MOVE AL-UNNON       TO  BMICRNOA
  9105*        ELSE
  9106*            MOVE -1             TO  BMICRNOL
  9107*            MOVE 1              TO  SET-CURSOR-SW
  9108*            MOVE AL-UNBON       TO  BMICRNOA
  9109*            MOVE ER-2701        TO  EMI-ERROR
  9110*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9111     IF BVINL NOT = ZEROS
  9112        MOVE AL-UANON            TO BVINA
  9113     END-IF
  9114     IF B1STNML NOT = ZEROS
  9115         MOVE AL-UANON                TO B1STNMA.
  9116
  9117     IF BINITL  NOT = ZEROS
  9118        MOVE AL-UANON                TO BINITA.
  9119
  9120     IF BSEXL NOT = ZEROS
  9121        IF BSEXI = 'M' OR 'F'
  9122           MOVE AL-UANON             TO BSEXA
  9123        ELSE
  9124           MOVE -1               TO BSEXL
  9125           MOVE ER-2629          TO EMI-ERROR
  9126           MOVE AL-UABON         TO BSEXA
  9127           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9128
  9129     IF BAGEL NOT = ZEROS
  9130         IF BAGEI NUMERIC
  9131             MOVE BAGEI              TO WS-BAGE
  9132             MOVE AL-UNNON           TO BAGEA
  9133         ELSE
  9134             MOVE -1                 TO BAGEL
  9135             MOVE  1                 TO SET-CURSOR-SW
  9136             MOVE ER-2223            TO EMI-ERROR
  9137             MOVE AL-UNBON           TO BAGEA
  9138             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9139
  9140     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9141
  9142     IF (BBIRTHL GREATER THAN +0) AND
  9143        (BBIRTHI NOT EQUAL SPACES)
  9144        NEXT SENTENCE
  9145     ELSE
  9146        GO TO 1010-CHECK-AGE.
  9147
  9148     MOVE BBIRTHI                TO DEEDIT-FIELD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL6311.cbl
  9149     PERFORM 8600-DEEDIT.
  9150     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9151     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9152     MOVE AL-UNNON               TO BBIRTHA.
  9153     MOVE '4'                    TO DC-OPTION-CODE.
  9154     PERFORM 9700-DATE-LINK.
  9155     IF DATE-CONVERSION-ERROR
  9156        MOVE -1                  TO BBIRTHL
  9157        MOVE  1                  TO SET-CURSOR-SW
  9158        MOVE ER-2228             TO EMI-ERROR
  9159        MOVE AL-UNBON            TO BBIRTHA
  9160        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9161        GO TO 1010-CHECK-AGE.
  9162
  9163     IF (NO-CONVERSION-ERROR) AND
  9164        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9165        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9166        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9167        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9168                                    WS-CONVERTED-BIRTH
  9169        MOVE AL-UANON            TO BBIRTHA
  9170     ELSE
  9171        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9172        MOVE AL-UANON            TO BBIRTHA.
  9173
  9174 1010-CHECK-AGE.
  9175
  9176*    IF BAGEL = ZERO
  9177*       IF BBIRTHL GREATER THAN ZERO
  9178*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9179
  9180     IF B1STPMTL NOT = ZEROS
  9181        IF B1STPMTI = SPACES
  9182           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9183        ELSE
  9184           MOVE B1STPMTI             TO DEEDIT-FIELD
  9185           PERFORM 8600-DEEDIT
  9186           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9187           MOVE AL-UNNON             TO B1STPMTA
  9188           MOVE 4                    TO DC-OPTION-CODE
  9189           PERFORM 9700-DATE-LINK
  9190           IF NO-CONVERSION-ERROR
  9191              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9192              MOVE AL-UANON          TO B1STPMTA
  9193           ELSE
  9194              MOVE -1                TO B1STPMTL
  9195              MOVE  1                TO SET-CURSOR-SW
  9196              MOVE ER-2200           TO EMI-ERROR
  9197              MOVE AL-UNBON          TO B1STPMTA
  9198              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9199
  9200     IF BDAYSL NOT = ZEROS
  9201         IF BDAYSI NUMERIC
  9202             MOVE AL-UNNON           TO BDAYSA
  9203         ELSE
  9204             MOVE -1                 TO BDAYSL
  9205             MOVE ER-2530            TO EMI-ERROR
  9206             MOVE AL-UNBON           TO BDAYSA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL6311.cbl
  9207             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9208
  9209     IF BLNTRML NOT = ZEROS
  9210         IF BLNTRMI NUMERIC
  9211             MOVE AL-UNNON       TO BLNTRMA
  9212         ELSE
  9213             MOVE -1             TO BLNTRML
  9214             MOVE ER-2533        TO EMI-ERROR
  9215             MOVE AL-UNBON       TO BLNTRMA
  9216             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9217
  9218**   IF PI-COMPANY-ID = 'DMD'
  9219     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9220        NEXT SENTENCE
  9221     ELSE
  9222         IF BLNOFCRL NOT = ZEROS
  9223            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9224            IF LOAN-OFFICER-FOUND
  9225                MOVE AL-UANON        TO BLNOFCRA
  9226             ELSE
  9227                 MOVE SPACE          TO WS-LOAN-OFFICER
  9228                 MOVE -1             TO BLNOFCRL
  9229                 MOVE  1             TO SET-CURSOR-SW
  9230                 MOVE ER-3006        TO EMI-ERROR
  9231                 MOVE AL-UNBON       TO BLNOFCRA
  9232                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9233
  9234     IF BFREQL NOT = ZEROS
  9235         IF BFREQI NUMERIC
  9236             MOVE AL-UNNON       TO BFREQA
  9237         ELSE
  9238             MOVE -1             TO BFREQL
  9239             MOVE  1             TO SET-CURSOR-SW
  9240             MOVE ER-2223        TO EMI-ERROR
  9241             MOVE AL-UNBON       TO BFREQA
  9242             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9243
  9244     IF BMODEL NOT = ZEROS
  9245         MOVE BMODEI             TO WS-MODE-CODE
  9246                                    PI-BMODE
  9247         IF WS-MODE-CODE-VALID
  9248             MOVE AL-UANON       TO BMODEA
  9249         ELSE
  9250             MOVE -1             TO BMODEL
  9251             MOVE ER-2591        TO EMI-ERROR
  9252             MOVE AL-UABON       TO BMODEA
  9253             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9254
  9255     IF BPMTSL NOT = ZEROS
  9256         IF BPMTSI NUMERIC
  9257             MOVE AL-UNNON           TO BPMTSA
  9258             MOVE BPMTSI             TO PI-BPMTS
  9259         ELSE
  9260             MOVE -1                 TO BPMTSL
  9261             MOVE ER-2592            TO EMI-ERROR
  9262             MOVE AL-UNBON           TO BPMTSA
  9263             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9264
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL6311.cbl
  9265     IF BPMTAMTL NOT = ZEROS
  9266
  9267* EXEC CICS BIF DEEDIT
  9268*            FIELD  (BPMTAMTI)
  9269*            LENGTH (9)
  9270*       END-EXEC
  9271     MOVE 9
  9272       TO DFHEIV11
  9273*    MOVE '@"L                   #   #00009204' TO DFHEIV0
  9274     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9275     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9276     MOVE X'2020233030303039323034' TO DFHEIV0(25:11)
  9277     CALL 'kxdfhei1' USING DFHEIV0,
  9278           BPMTAMTI,
  9279           DFHEIV11
  9280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9281        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9282*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9283*        PERFORM 8600-DEEDIT
  9284*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9285
  9286*    IF BAPRL NOT = ZEROS
  9287*        EXEC CICS BIF DEEDIT
  9288*            FIELD  (BAPRI)
  9289*            LENGTH (7)
  9290*        END-EXEC
  9291*        MOVE BAPRI              TO WS-BAPR.
  9292
  9293     IF BAPRL > 0
  9294        MOVE +0                  TO  WS-BAPR
  9295        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9296           (WS-SUB > 7)
  9297           OR (BAPRI (WS-SUB:1) NUMERIC)
  9298           OR (BAPRI (WS-SUB:1) = '.')
  9299        END-PERFORM
  9300        IF WS-SUB > 7
  9301           MOVE ER-2471       TO EMI-ERROR
  9302           MOVE -1            TO BAPRL
  9303           MOVE AL-UNBON      TO BAPRA
  9304           PERFORM 9900-ERROR-FORMAT
  9305                                 THRU 9900-EXIT
  9306        ELSE
  9307           IF BAPRI (WS-SUB:1) NUMERIC
  9308              MOVE WS-SUB           TO WS-BEG
  9309              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9310                 (WS-SUB > 7)
  9311                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9312              END-PERFORM
  9313              COMPUTE WS-END = WS-SUB - WS-BEG
  9314              MOVE BAPRI (WS-BEG:WS-END)
  9315                                 TO WS-APR-WHOLE-NUM
  9316           END-IF
  9317           IF BAPRI (WS-SUB:1) = '.'
  9318              COMPUTE WS-BEG = WS-SUB + 1
  9319              IF (WS-BEG < 8)
  9320                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9321                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9322                    (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL6311.cbl
  9323                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9324                 END-PERFORM
  9325                 COMPUTE WS-END = WS-SUB - WS-BEG
  9326                 MOVE BAPRI (WS-BEG:WS-END)
  9327                                 TO WS-APR-DEC (1:WS-END)
  9328              END-IF
  9329           END-IF
  9330           MOVE AL-UNNON      TO BAPRA
  9331           MOVE WS-BAPR       TO BAPRO
  9332        END-IF
  9333     END-IF
  9334*     IF BAPRL NOT = ZEROS
  9335*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9336*        PERFORM 8600-DEEDIT
  9337*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9338
  9339     IF BLIVESL NOT = ZEROS
  9340        MOVE BLIVESI             TO DEEDIT-FIELD
  9341        PERFORM 8600-DEEDIT
  9342        IF DEEDIT-FIELD-V0 NUMERIC
  9343           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9344           MOVE AL-UNNON         TO BLIVESA
  9345        ELSE
  9346           MOVE -1               TO BLIVESL
  9347           MOVE AL-UNBON         TO BLIVESA
  9348           MOVE ER-2223          TO EMI-ERROR
  9349           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9350
  9351*DMD CUSTOM CODING*************START
  9352*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9353     IF PI-COMPANY-ID NOT = 'DMD'
  9354         MOVE ZEROS               TO BBILLEDL
  9355         GO TO 1010-EDIT-CONT.
  9356
  9357     IF BBILLEDL NOT = ZEROS
  9358        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9359        MOVE 'Y'                 TO WS-NUMERIC-SW
  9360        MOVE +1                  TO WS-CSO-SUB
  9361        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9362        IF CSO-NUMERIC-FIELD
  9363
  9364* EXEC CICS BIF DEEDIT
  9365*              FIELD  (BBILLEDI)
  9366*              LENGTH (9)
  9367*          END-EXEC
  9368     MOVE 9
  9369       TO DFHEIV11
  9370*    MOVE '@"L                   #   #00009290' TO DFHEIV0
  9371     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9372     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9373     MOVE X'2020233030303039323930' TO DFHEIV0(25:11)
  9374     CALL 'kxdfhei1' USING DFHEIV0,
  9375           BBILLEDI,
  9376           DFHEIV11
  9377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9378           MOVE BBILLEDI         TO WS-BILLED
  9379           MOVE AL-UNNON         TO BBILLEDA
  9380        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL6311.cbl
  9381           MOVE -1               TO BBILLEDL
  9382           MOVE AL-UNBON         TO BBILLEDA
  9383           MOVE ER-2547          TO EMI-ERROR
  9384           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9385     ELSE
  9386        IF BMAINTI EQUAL 'A'
  9387           MOVE -1               TO BBILLEDL
  9388           MOVE AL-UNBON         TO BBILLEDA
  9389           MOVE ER-8148          TO EMI-ERROR
  9390           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9391
  9392 1010-EDIT-CONT.
  9393
  9394     IF BFORCEL  NOT = ZEROS
  9395         IF FORCE-CAP
  9396            MOVE AL-UANON            TO BFORCEA
  9397         ELSE
  9398            MOVE ER-2945             TO EMI-ERROR
  9399            MOVE AL-UABON            TO BFORCEA
  9400            MOVE -1                  TO BFORCEL
  9401            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9402
  9403     IF BENTRYL NOT = ZEROS
  9404        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9405                         'D' AND 'V' AND 'U' AND 'M'
  9406           MOVE ER-2224              TO EMI-ERROR
  9407           MOVE AL-UABON             TO BENTRYA
  9408           MOVE -1                   TO BENTRYL
  9409           MOVE  1                   TO SET-CURSOR-SW
  9410           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9411        ELSE
  9412           MOVE AL-UANON             TO BENTRYA.
  9413
  9414     IF BUNWRITL NOT = ZEROS
  9415        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9416           MOVE ER-7574              TO EMI-ERROR
  9417           MOVE AL-UABON             TO BUNWRITA
  9418           MOVE -1                   TO BUNWRITL
  9419           MOVE  1                   TO SET-CURSOR-SW
  9420           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9421        ELSE
  9422           MOVE AL-UANON             TO BUNWRITA.
  9423
  9424     IF BREINL  NOT = ZEROS
  9425         MOVE AL-UANON               TO BREINA.
  9426
  9427     IF BBILCDL NOT = ZEROS
  9428        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9429                             AND 'A' AND 'B' AND 'E'
  9430           MOVE ER-2225              TO EMI-ERROR
  9431           MOVE AL-UABON             TO BBILCDA
  9432           MOVE -1                   TO BBILCDL
  9433           MOVE  1                   TO SET-CURSOR-SW
  9434           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9435        ELSE
  9436           MOVE AL-UANON             TO BBILCDA.
  9437
  9438     IF BSKPCDL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL6311.cbl
  9439         MOVE AL-UANON               TO BSKPCDA.
  9440
  9441     IF BINDGRPL NOT = ZEROS
  9442         MOVE AL-UANON               TO BINDGRPA.
  9443
  9444     IF BSIGL   NOT = ZEROS
  9445         MOVE AL-UANON               TO BSIGA.
  9446
  9447     IF BRTCLSL NOT = ZEROS
  9448         MOVE AL-UANON               TO BRTCLSA.
  9449
  9450     IF BMEMBERL NOT = ZEROS
  9451         MOVE AL-UANON               TO BMEMBERA.
  9452
  9453     MOVE +0                         TO WS-SUB1.
  9454
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL6311.cbl
  9456
  9457******************************************************************
  9458*                                                                *
  9459*           E D I T   I S S U E   C O V E R A G E S              *
  9460*                                                                *
  9461******************************************************************
  9462
  9463 1020-EDIT-COVERAGES.
  9464     ADD +1                      TO WS-SUB1.
  9465
  9466     IF WS-SUB1 GREATER +2
  9467        GO TO 1025-EDIT-COMPLETE.
  9468
  9469     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9470       IF (BMODEL   GREATER ZERO  OR
  9471            BPMTSL   GREATER ZERO  OR
  9472            BPMTAMTL GREATER ZERO)
  9473          AND
  9474            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9475               GO TO 1021-CONT-EDIT.
  9476
  9477     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9478        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9479        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9480        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9481        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9482        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9483        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9484        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9485        NEXT SENTENCE
  9486         ELSE
  9487            GO TO 1020-EDIT-COVERAGES.
  9488
  9489 1021-CONT-EDIT.
  9490
  9491     IF BMAINTI = 'A'
  9492        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9493           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9494        ELSE
  9495           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9496           MOVE ER-7404          TO EMI-ERROR
  9497           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9498           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9499     ELSE
  9500        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9501           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9502
  9503     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9504        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9505        PERFORM 8600-DEEDIT
  9506        IF DEEDIT-FIELD-V0 NUMERIC
  9507           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9508        ELSE
  9509           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9510
  9511     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9512*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9513        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL6311.cbl
  9514           BPMTSL  GREATER THAN ZEROS
  9515           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9516
  9517     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9518         IF BMODEL   GREATER THAN ZEROS  OR
  9519            BPMTSL   GREATER THAN ZEROS  OR
  9520            BPMTAMTL GREATER THAN ZEROS
  9521             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9522
  9523     IF BMAINTI = ('C' OR 'K')
  9524        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9525           NEXT SENTENCE
  9526        ELSE
  9527           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9528           PERFORM 8600-DEEDIT
  9529           IF DEEDIT-FIELD-V0 NUMERIC
  9530              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9531              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9532                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9533              ELSE
  9534                    MOVE ER-2241      TO EMI-ERROR
  9535                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9536                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9537                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9538           ELSE
  9539              MOVE ER-2223          TO EMI-ERROR
  9540              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9541              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9542              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9543     ELSE
  9544        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9545            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9546            PERFORM 8600-DEEDIT
  9547            IF DEEDIT-FIELD-V0      NUMERIC
  9548               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9549                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9550                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9551               ELSE
  9552                  MOVE ER-2241         TO EMI-ERROR
  9553                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9554                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9555                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9556            ELSE
  9557              MOVE ER-2223             TO EMI-ERROR
  9558              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9559              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9560              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9561        ELSE
  9562            MOVE ER-2240               TO EMI-ERROR
  9563            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9564            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9565*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9566*        IF BMODEL  GREATER THAN ZEROS  AND
  9567*           BPMTSL  GREATER THAN ZEROS
  9568*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9569
  9570     IF BBEN-LEN (WS-SUB1) = ZEROS
  9571        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL6311.cbl
  9572           NEXT SENTENCE
  9573     ELSE
  9574        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9575           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9576
  9577* EXEC CICS BIF DEEDIT
  9578*              FIELD  (BBENI (WS-SUB1))
  9579*              LENGTH (12)
  9580*          END-EXEC
  9581     MOVE 12
  9582       TO DFHEIV11
  9583*    MOVE '@"L                   #   #00009492' TO DFHEIV0
  9584     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9585     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9586     MOVE X'2020233030303039343932' TO DFHEIV0(25:11)
  9587     CALL 'kxdfhei1' USING DFHEIV0,
  9588           BBENI(WS-SUB1),
  9589           DFHEIV11
  9590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9591           IF BBENI (WS-SUB1)  NUMERIC
  9592              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9593                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9594*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9595*          PERFORM 8600-DEEDIT
  9596*          IF DEEDIT-FIELD-V2  NUMERIC
  9597*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9598*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9599              ELSE
  9600                 MOVE ER-7632    TO EMI-ERROR
  9601                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9602                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9603                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9604           ELSE
  9605              MOVE ER-2223         TO EMI-ERROR
  9606              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9607              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9608              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9609        ELSE
  9610           MOVE ER-7632    TO EMI-ERROR
  9611           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9612           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9613           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9614
  9615     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9616        AND (BMAINTI = ('C' OR 'K'))
  9617        CONTINUE
  9618     ELSE
  9619        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9620           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9621           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9622              FOR ALL '.'
  9623           IF WS-TALLY > 1
  9624              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9625                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9626              END-PERFORM
  9627              IF A1 < 9
  9628                 ADD 3 TO A1
  9629                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL6311.cbl
  9630              END-IF
  9631           ELSE
  9632              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9633                (A1 > 11)
  9634                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9635                  LOW-VALUES OR SPACES)
  9636              END-PERFORM
  9637              IF A1 > 1 AND < 12
  9638                 MOVE SPACES
  9639                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9640              END-IF
  9641           END-IF
  9642
  9643* EXEC CICS BIF DEEDIT
  9644*              FIELD  (BPREMI (WS-SUB1))
  9645*              LENGTH (11)
  9646*          END-EXEC
  9647     MOVE 11
  9648       TO DFHEIV11
  9649*    MOVE '@"L                   #   #00009547' TO DFHEIV0
  9650     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9651     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9652     MOVE X'2020233030303039353437' TO DFHEIV0(25:11)
  9653     CALL 'kxdfhei1' USING DFHEIV0,
  9654           BPREMI(WS-SUB1),
  9655           DFHEIV11
  9656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9657           IF BPREMI (WS-SUB1) NUMERIC
  9658              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9659                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9660*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9661*          PERFORM 8600-DEEDIT
  9662*          IF DEEDIT-FIELD-V2  NUMERIC
  9663*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9664*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9665              ELSE
  9666                 IF PI-COMPANY-ID NOT = 'DCC'
  9667                    MOVE ER-7633    TO EMI-ERROR
  9668                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9669                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9670                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9671                 END-IF
  9672              END-IF
  9673           ELSE
  9674              MOVE ER-2223         TO EMI-ERROR
  9675              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9676              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9677              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9678           END-IF
  9679        ELSE
  9680           IF PI-COMPANY-ID NOT = 'DCC'
  9681              MOVE ER-7633         TO EMI-ERROR
  9682              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9683              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9685           END-IF
  9686        END-IF
  9687     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL6311.cbl
  9688
  9689     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9690        NEXT SENTENCE
  9691     ELSE
  9692        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9693
  9694* EXEC CICS BIF DEEDIT
  9695*           FIELD  (BCPREMI (WS-SUB1))
  9696*           LENGTH (11)
  9697*       END-EXEC
  9698     MOVE 11
  9699       TO DFHEIV11
  9700*    MOVE '@"L                   #   #00009587' TO DFHEIV0
  9701     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9702     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9703     MOVE X'2020233030303039353837' TO DFHEIV0(25:11)
  9704     CALL 'kxdfhei1' USING DFHEIV0,
  9705           BCPREMI(WS-SUB1),
  9706           DFHEIV11
  9707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9708        IF BCPREMI (WS-SUB1) NUMERIC
  9709           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9710*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9711*       PERFORM 8600-DEEDIT
  9712*       IF DEEDIT-FIELD-V2  NUMERIC
  9713*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9714        ELSE
  9715           MOVE ER-2223         TO EMI-ERROR
  9716           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9717           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9718           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9719
  9720     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9721        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9722        PERFORM 8600-DEEDIT
  9723        IF DEEDIT-FIELD-V0 NUMERIC
  9724           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9725           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9726         ELSE
  9727           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9728           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9729           MOVE ER-2223              TO EMI-ERROR
  9730           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9731
  9732     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9733        IF BEXPIRE   (WS-SUB1) = SPACES
  9734           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9735        ELSE
  9736           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9737           PERFORM 8600-DEEDIT
  9738           IF DEEDIT-FIELD-V0        NUMERIC
  9739              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9740              MOVE 4                TO DC-OPTION-CODE
  9741              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9742              PERFORM 9700-DATE-LINK
  9743              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9744                                                        (WS-SUB1)
  9745              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL6311.cbl
  9746                 NEXT SENTENCE
  9747              ELSE
  9748                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9749                 MOVE ER-2531    TO EMI-ERROR
  9750                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9751                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9752           ELSE
  9753             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9754             MOVE ER-2532        TO EMI-ERROR
  9755             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9756             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9757
  9758     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9759        NEXT SENTENCE
  9760     ELSE
  9761
  9762* EXEC CICS BIF DEEDIT
  9763*           FIELD  (BALT-BENI (WS-SUB1))
  9764*           LENGTH (12)
  9765*       END-EXEC
  9766     MOVE 12
  9767       TO DFHEIV11
  9768*    MOVE '@"L                   #   #00009644' TO DFHEIV0
  9769     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9770     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9771     MOVE X'2020233030303039363434' TO DFHEIV0(25:11)
  9772     CALL 'kxdfhei1' USING DFHEIV0,
  9773           BALT-BENI(WS-SUB1),
  9774           DFHEIV11
  9775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9776        IF BALT-BENI (WS-SUB1) NUMERIC
  9777           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9778*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9779*       PERFORM 8600-DEEDIT
  9780*       IF DEEDIT-FIELD-V0 NUMERIC
  9781*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9782        ELSE
  9783           MOVE ER-2223         TO EMI-ERROR
  9784           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9785           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9786           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9787
  9788     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9789        NEXT SENTENCE
  9790     ELSE
  9791
  9792* EXEC CICS BIF DEEDIT
  9793*           FIELD  (BALT-PREMI (WS-SUB1))
  9794*           LENGTH (11)
  9795*       END-EXEC
  9796     MOVE 11
  9797       TO DFHEIV11
  9798*    MOVE '@"L                   #   #00009663' TO DFHEIV0
  9799     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9800     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9801     MOVE X'2020233030303039363633' TO DFHEIV0(25:11)
  9802     CALL 'kxdfhei1' USING DFHEIV0,
  9803           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL6311.cbl
  9804           DFHEIV11
  9805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9806        IF BALT-PREMI (WS-SUB1) NUMERIC
  9807           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9808*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9809*       PERFORM 8600-DEEDIT
  9810*       IF DEEDIT-FIELD-V0 NUMERIC
  9811*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9812        ELSE
  9813           MOVE ER-2223         TO EMI-ERROR
  9814           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9815           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9816           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9817
  9818      GO TO 1020-EDIT-COVERAGES.
  9819
  9820 1025-EDIT-COMPLETE.
  9821     IF PI-COMPANY-ID  =  'DMD'
  9822        MOVE LOW-VALUES             TO BNCERTI
  9823                                       BNSTATI.
  9824
  9825     IF EMI-ERROR = ZEROS
  9826         NEXT SENTENCE
  9827     ELSE
  9828         GO TO 8200-SEND-DATAONLY.
  9829
  9830     IF BMAINTI = 'A'
  9831         GO TO 1200-ADD-ISSUE-ROUTINE.
  9832
  9833     IF BMAINTI = 'C'
  9834         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9835
  9836     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9837
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL6311.cbl
  9839
  9840 1030-EDIT-FOR-NUMERICS.
  9841     IF WS-CSO-SUB EQUAL 10
  9842        GO TO 1030-EDIT-EXIT.
  9843
  9844     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9845        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9846        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9847           ADD +1               TO WS-CSO-SUB
  9848           GO TO 1030-EDIT-FOR-NUMERICS.
  9849
  9850     MOVE 'N'                   TO WS-NUMERIC-SW.
  9851
  9852 1030-EDIT-EXIT.
  9853******************************************************************
  9854*                                                                *
  9855*                 C A L C U L A T E   A G E                      *
  9856*                                                                *
  9857******************************************************************
  9858
  9859
  9860 1095-CALC-AGE.
  9861
  9862     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  9863     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  9864     MOVE 1                  TO DC-OPTION-CODE.
  9865     PERFORM 9700-DATE-LINK
  9866     IF NO-CONVERSION-ERROR
  9867         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  9868         MOVE WS-BAGE            TO BAGEI
  9869         MOVE +2                 TO BAGEL
  9870         MOVE AL-UNNON TO BAGEA.
  9871
  9872 1099-EXIT.
  9873     EXIT.
  9874
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL6311.cbl
  9876
  9877******************************************************************
  9878*                                                                *
  9879*                   S H O W   I S S U E                          *
  9880*                                                                *
  9881******************************************************************
  9882
  9883 1100-SHOW-REQUEST.
  9884     MOVE 'S'                    TO PI-MAINT-FUNCTION.
  9885
  9886     IF BCERTNOL = ZEROS AND
  9887        BEFFDTL  = ZEROS
  9888        MOVE -1                  TO BMAINTL
  9889        GO TO 8200-SEND-DATAONLY.
  9890
  9891     MOVE BCERTNOI               TO WS-NEW-PRIME.
  9892
  9893     IF BSUFIXL NOT = ZEROS
  9894        MOVE BSUFIXI             TO WS-NEW-SUFFIX
  9895     ELSE
  9896        MOVE SPACE               TO WS-NEW-SUFFIX.
  9897
  9898     MOVE BEFFDTI                TO DEEDIT-FIELD.
  9899     PERFORM 8600-DEEDIT.
  9900     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9901     MOVE '4'                    TO DC-OPTION-CODE.
  9902     PERFORM 9700-DATE-LINK.
  9903     IF DATE-CONVERSION-ERROR
  9904        MOVE ER-0348             TO EMI-ERROR
  9905        MOVE -1                  TO BEFFDTL
  9906        MOVE AL-UABON            TO BEFFDTA
  9907        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9908        GO TO 8200-SEND-DATAONLY
  9909     ELSE
  9910        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
  9911        MOVE AL-UANON            TO BEFFDTA
  9912        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
  9913
  9914     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9915
  9916     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
  9917        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
  9918          MOVE 'Y'                    TO WS-SHOW-SW
  9919          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9920             GO TO 4100-BROWSE-PRIMARY-FORWARD
  9921           ELSE
  9922             IF PI-FILE-BROWSE
  9923                GO TO 4300-BROWSE-FILE-FORWARD
  9924              ELSE
  9925                IF PI-CSR-BROWSE
  9926                   GO TO 4200-BROWSE-CSR-FORWARD
  9927                ELSE
  9928                   GO TO 4000-BROWSE-DETAIL-FORWARD
  9929        ELSE
  9930           GO TO 3900-RE-DISPLAY-RECORD.
  9931
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL6311.cbl
  9933
  9934******************************************************************
  9935*                                                                *
  9936*            A D D   I S S U E   R O U T I N E                   *
  9937*                                                                *
  9938******************************************************************
  9939
  9940***************************************************************
  9941*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
  9942*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
  9943*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
  9944*     4. LINK TO THE EDIT ROUTINE.                            *
  9945*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
  9946*     6. WRITE THE NEW ISSUE RECORD.                          *
  9947*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
  9948*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
  9949*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
  9950*        ELSE                                                 *
  9951*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
  9952***************************************************************
  9953
  9954 1200-ADD-ISSUE-ROUTINE.
  9955     MOVE 'A'                    TO PI-MAINT-FUNCTION.
  9956
  9957
  9958* EXEC CICS GETMAIN
  9959*        SET     (ADDRESS OF PENDING-BUSINESS)
  9960*        LENGTH  (ERPNDB-RECORD-LENGTH)
  9961*    END-EXEC.
  9962*    MOVE '," L                  $   #00009818' TO DFHEIV0
  9963     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9964     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9965     MOVE X'2020233030303039383138' TO DFHEIV0(25:11)
  9966     CALL 'kxdfhei1' USING DFHEIV0,
  9967           DFHEIV20,
  9968           ERPNDB-RECORD-LENGTH,
  9969           DFHEIV99
  9970     SET ADDRESS OF PENDING-BUSINESS TO
  9971         DFHEIV20
  9972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9973
  9974
  9975
  9976* EXEC CICS HANDLE CONDITION
  9977*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
  9978*    END-EXEC.
  9979*    MOVE '"$I                   ! # #00009823' TO DFHEIV0
  9980     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9982     MOVE X'2320233030303039383233' TO DFHEIV0(25:11)
  9983     CALL 'kxdfhei1' USING DFHEIV0
  9984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9985
  9986
  9987     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
  9988     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
  9989     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
  9990
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL6311.cbl
  9991
  9992* EXEC CICS READ
  9993*        INTO    (PENDING-BUSINESS)
  9994*        DATASET (FILE-ID-ERPNDB)
  9995*        RIDFLD  (ERPNDB-KEY)
  9996*    END-EXEC.
  9997     MOVE LENGTH OF
  9998      PENDING-BUSINESS
  9999       TO DFHEIV11
 10000*    MOVE '&"IL       E          (   #00009831' TO DFHEIV0
 10001     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10003     MOVE X'2020233030303039383331' TO DFHEIV0(25:11)
 10004     CALL 'kxdfhei1' USING DFHEIV0,
 10005           FILE-ID-ERPNDB,
 10006           PENDING-BUSINESS,
 10007           DFHEIV11,
 10008           ERPNDB-KEY,
 10009           DFHEIV99,
 10010           DFHEIV99,
 10011           DFHEIV99
 10012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10013
 10014
 10015     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10016
 10017     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10018     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10019     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10020     MOVE SPACES                 TO PENDING-BUSINESS.
 10021     MOVE 'PB'                   TO PB-RECORD-ID.
 10022     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10023     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10024     MOVE SPACES                 TO PB-CERT-SFX.
 10025     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10026     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10027                                    PB-ALT-CHG-SEQ-NO.
 10028
 10029     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10030     MOVE '1'                    TO PB-RECORD-TYPE.
 10031
 10032     IF BSUFIXL NOT = ZEROS
 10033        MOVE BSUFIXI             TO PB-CERT-SFX.
 10034
 10035     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10036
 10037     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10038     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10039
 10040     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10041                                    PB-I-LF-PREM-CALC
 10042                                    PB-I-LF-ALT-PREM-CALC
 10043                                    PB-I-LF-RATE
 10044                                    PB-I-LF-ALT-RATE
 10045                                    PB-I-LF-REI-RATE
 10046                                    PB-I-LF-ALT-REI-RATE
 10047                                    PB-I-RATE-DEV-PCT-LF
 10048                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL6311.cbl
 10049                                    PB-I-AH-RATE
 10050                                    PB-I-AH-REI-RATE
 10051                                    PB-I-AH-RATE-TRM
 10052                                    PB-I-RATE-DEV-PCT-AH
 10053                                    PB-I-BUSINESS-TYPE
 10054                                    PB-I-LIFE-COMMISSION
 10055                                    PB-I-JOINT-COMMISSION
 10056                                    PB-I-JOINT-AGE
 10057                                    PB-I-AH-COMMISSION
 10058                                    PB-I-CURR-SEQ
 10059                                    PB-CHG-COUNT
 10060                                    PB-LF-BILLED-AMTS
 10061                                    PB-AH-BILLED-AMTS
 10062                                    PB-CALC-TOLERANCE
 10063                                    PB-I-EXTENTION-DAYS
 10064*                                   PB-I-MICROFILM-NO
 10065                                    PB-I-TERM-IN-DAYS.
 10066
 10067     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10068                                    PB-I-LF-EXPIRE-DT
 10069                                    PB-I-AH-EXPIRE-DT
 10070                                    PB-BILLED-DT
 10071                                    PB-ACCT-EFF-DT
 10072                                    PB-ACCT-EXP-DT
 10073                                    PB-I-1ST-PMT-DT.
 10074
 10075     MOVE 'X'                    TO PB-FATAL-FLAG.
 10076
 10077     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10078
 10079     IF BLSTNML GREATER THAN ZEROS
 10080         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10081
 10082*    IF BMICRNOL  GREATER  ZEROS
 10083*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10084*    ELSE
 10085*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10086     IF BVINL > ZEROS
 10087        MOVE BVINI               TO PB-I-VIN
 10088     END-IF
 10089     IF B1STNML GREATER THAN ZEROS
 10090         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10091
 10092     IF BINITL  GREATER THAN ZEROS
 10093         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10094
 10095     IF BBIRTHL GREATER THAN ZERO
 10096         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10097     ELSE
 10098         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10099
 10100     IF B1STPMTL GREATER THAN ZERO
 10101         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10102     ELSE
 10103         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10104
 10105     IF BAGEL    GREATER THAN ZEROS
 10106         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL6311.cbl
 10107        ELSE
 10108         MOVE ZEROS              TO PB-I-AGE.
 10109
 10110     IF BSEXL    GREATER THAN ZEROS
 10111         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10112
 10113     IF BTERM-LEN (1) GREATER THAN ZEROS
 10114        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10115     ELSE
 10116        MOVE ZEROS               TO PB-I-LF-TERM.
 10117
 10118     IF BTERM-LEN (2) GREATER THAN ZEROS
 10119        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10120     ELSE
 10121        MOVE ZEROS               TO PB-I-AH-TERM.
 10122
 10123     IF BLNTRML       GREATER THAN ZEROS
 10124         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10125        ELSE
 10126         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10127
 10128     IF BFREQL        GREATER THAN ZEROS
 10129         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10130        ELSE
 10131         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10132
 10133     IF BSKPCDL       GREATER THAN ZEROS
 10134         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10135
 10136     IF BMODEL        GREATER THAN ZEROS
 10137         MOVE BMODEI             TO PB-I-TERM-TYPE
 10138                                    PI-BMODE.
 10139
 10140     IF BPMTSL        GREATER THAN ZEROS
 10141         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10142                                    PI-BPMTS
 10143        ELSE
 10144         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10145                                    PI-BPMTS.
 10146
 10147     IF BPMTAMTL      GREATER THAN ZEROS
 10148         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10149        ELSE
 10150         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10151
 10152     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10153        IF BTYPE  (1)   NOT = ZEROS
 10154           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10155                                    PI-BTYPE (1)
 10156           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10157           MOVE SPACES           TO PB-I-LF-ABBR
 10158        ELSE
 10159           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10160                                    PB-I-LF-ABBR
 10161           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10162     ELSE
 10163        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10164                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL6311.cbl
 10165        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10166
 10167     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10168         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10169     ELSE
 10170         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10171
 10172     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10173         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10174     ELSE
 10175         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10176
 10177     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10178         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10179            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10180            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10181         ELSE
 10182            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10183            MOVE '?'             TO PB-I-LF-CALC-FLAG
 10184     ELSE
 10185         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10186
 10187     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10188         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10189
 10190     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10191         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10192         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10193     ELSE
 10194         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10195
 10196     IF  BALT-PREM-LEN     (2) > ZEROS
 10197         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10198     ELSE
 10199         MOVE ZEROS            TO PB-I-TOT-FEES.
 10200
 10201     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10202        IF BTYPE      (2)   NOT = ZEROS
 10203           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10204                                  PI-BTYPE (2)
 10205           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10206           MOVE SPACES         TO PB-I-AH-ABBR
 10207        ELSE
 10208           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10209                                  PB-I-AH-ABBR
 10210           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10211     ELSE
 10212        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10213                                  PB-I-AH-ABBR
 10214        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10215
 10216     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10217         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10218     ELSE
 10219         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10220
 10221     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10222         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL6311.cbl
 10223            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10224            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10225         ELSE
 10226            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10227            MOVE '?'             TO PB-I-AH-CALC-FLAG
 10228     ELSE
 10229         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10230
 10231     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10232         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10233
 10234     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10235        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10236     ELSE
 10237        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10238
 10239     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10240        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10241     ELSE
 10242        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10243
 10244     IF BINDGRPL  GREATER THAN ZEROS
 10245         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10246
 10247     IF BRTCLSL   GREATER THAN ZEROS
 10248         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10249
 10250     IF BSIGL     GREATER THAN ZEROS
 10251         MOVE BSIGI              TO PB-I-SIG-SW.
 10252
 10253     IF BAPRL     GREATER THAN ZEROS
 10254         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10255     ELSE
 10256         MOVE ZEROS              TO PB-I-LOAN-APR.
 10257
 10258     IF BMEMBERL  GREATER THAN ZEROS
 10259         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10260
 10261     IF BLNOFCRL  GREATER THAN ZEROS
 10262         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10263
 10264     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10265        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10266     ELSE
 10267        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10268
 10269     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10270        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10271     ELSE
 10272        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10273
 10274     IF BDAYSL   GREATER THAN ZEROS
 10275        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10276                                    PB-I-EXTENTION-DAYS
 10277     ELSE
 10278        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10279                                    PB-I-EXTENTION-DAYS.
 10280
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL6311.cbl
 10281     IF BDAYSL GREATER THAN ZEROS
 10282        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10283
 10284     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10285        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10286           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10287
 10288     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10289        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10290           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10291
 10292     IF B1STPMTL GREATER THAN ZEROS
 10293        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10294
 10295     IF PB-EXT-DAYS-PROCESSING
 10296        IF PB-I-EXTENTION-DAYS = ZEROS
 10297           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10298
 10299     IF PB-EXPIRE-DT-PROCESSING
 10300        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10301           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10302             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10303
 10304     IF PB-1ST-PMT-DT-PROCESSING
 10305        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10306           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10307
 10308     IF BREINL GREATER THAN ZEROS
 10309        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10310
 10311     IF BENTRYL NOT = ZEROS
 10312        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10313        IF PI-COMPANY-ID = 'CID'
 10314           AND (PB-BATCH-ENTRY = 'P')
 10315           AND (PB-STATE = 'VA')
 10316           PERFORM 1500-UPDATE-ERNOTE
 10317                                 THRU 1500-EXIT
 10318        END-IF
 10319     END-IF
 10320     IF BUNWRITL NOT = ZEROS
 10321        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10322
 10323     IF BFORCEL NOT = ZEROS
 10324        MOVE BFORCEI             TO PB-FORCE-CODE.
 10325
 10326     IF BBILCDL NOT = ZEROS
 10327        MOVE BBILCDI             TO PB-RECORD-BILL.
 10328
 10329     IF BLIVESL GREATER THAN ZEROS
 10330        MOVE WS-BLIVES           TO PB-I-LIVES
 10331     ELSE
 10332        MOVE ZEROS               TO PB-I-LIVES.
 10333
 10334     IF BBILLEDL GREATER THAN ZEROS
 10335        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10336     ELSE
 10337        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10338
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL6311.cbl
 10339*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10340
 10341 1260-WRITE-PB-RECORD.
 10342     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10343                                    PB-INPUT-BY.
 10344     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10345     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10346                                    PB-INPUT-DT.
 10347
 10348     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10349     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10350                                    PB-CONTROL-BY-ORIG-BATCH.
 10351
 10352
 10353     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10354     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10355     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10356     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10357     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10358
 10359     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10360
 10361     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10362
 10363     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10364     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10365     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10366
 10367     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10368     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10369
 10370 1275-WRITE-PENDING-BUSINESS.
 10371     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10372     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10373     MOVE 'A'                    TO JP-RECORD-TYPE.
 10374     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10375
 10376
 10377* EXEC CICS HANDLE CONDITION
 10378*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10379*    END-EXEC.
 10380*    MOVE '"$%                   ! $ #00010198' TO DFHEIV0
 10381     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10383     MOVE X'2420233030303130313938' TO DFHEIV0(25:11)
 10384     CALL 'kxdfhei1' USING DFHEIV0
 10385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10386
 10387
 10388
 10389* EXEC CICS WRITE
 10390*        DATASET (FILE-ID-ERPNDB)
 10391*        FROM    (PENDING-BUSINESS)
 10392*        RIDFLD  (PB-CONTROL-PRIMARY)
 10393*    END-EXEC.
 10394     MOVE LENGTH OF
 10395      PENDING-BUSINESS
 10396       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL6311.cbl
 10397*    MOVE '&$ L                  ''   #00010202' TO DFHEIV0
 10398     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10399     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10400     MOVE X'2020233030303130323032' TO DFHEIV0(25:11)
 10401     CALL 'kxdfhei1' USING DFHEIV0,
 10402           FILE-ID-ERPNDB,
 10403           PENDING-BUSINESS,
 10404           DFHEIV11,
 10405           PB-CONTROL-PRIMARY,
 10406           DFHEIV99,
 10407           DFHEIV99
 10408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10409
 10410
 10411     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10412
 10413     PERFORM 8400-LOG-JOURNAL-RECORD.
 10414
 10415******************************************************************
 10416*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10417******************************************************************
 10418     display ' made it to add orig cert '
 10419     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10420     MOVE ' '                    TO WS-ERMAIL-SW
 10421
 10422* EXEC CICS READ
 10423*       DATASET   (FILE-ID-ERMAIL)
 10424*       SET       (ADDRESS OF MAILING-DATA)
 10425*       RIDFLD    (ERMAIL-KEY)
 10426*       RESP      (WS-RESPONSE)
 10427*    END-EXEC
 10428*    MOVE '&"S        E          (  N#00010218' TO DFHEIV0
 10429     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10431     MOVE X'204E233030303130323138' TO DFHEIV0(25:11)
 10432     CALL 'kxdfhei1' USING DFHEIV0,
 10433           FILE-ID-ERMAIL,
 10434           DFHEIV20,
 10435           DFHEIV99,
 10436           ERMAIL-KEY,
 10437           DFHEIV99,
 10438           DFHEIV99,
 10439           DFHEIV99
 10440     SET ADDRESS OF MAILING-DATA TO
 10441         DFHEIV20
 10442     MOVE EIBRESP  TO WS-RESPONSE
 10443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10444     IF RESP-NORMAL
 10445        SET ERMAIL-FOUND TO TRUE
 10446     END-IF
 10447     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10448     MOVE 'OC'                   TO OC-RECORD-ID
 10449     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10450                                 TO OC-CONTROL-PRIMARY (1:33)
 10451     MOVE 'I'                    TO OC-RECORD-TYPE
 10452     MOVE +4096                  TO OC-KEY-SEQ-NO
 10453     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10454     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL6311.cbl
 10455     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10456     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10457     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10458     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10459     MOVE PB-I-AGE               TO OC-INS-AGE
 10460     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10461     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10462     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10463     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10464     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10465     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10466     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10467     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10468     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10469     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10470     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10471     IF PB-I-JOINT-COMMISSION > +0
 10472         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10473     ELSE
 10474         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10475     END-IF
 10476     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10477     MOVE +0                     TO OC-LF-CANCEL-AMT
 10478                                    OC-LF-ITD-CANCEL-AMT
 10479     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10480     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10481     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10482     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10483     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10484     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10485     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10486     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10487     MOVE +0                     TO OC-AH-CANCEL-AMT
 10488                                    OC-AH-ITD-CANCEL-AMT
 10489     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10490     IF ERMAIL-FOUND
 10491        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10492     END-IF
 10493     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10494     .
 10495 1275-WRITE-ELCRTO.
 10496
 10497* EXEC CICS WRITE
 10498*       DATASET   ('ELCRTO')
 10499*       FROM      (ORIGINAL-CERTIFICATE)
 10500*       RIDFLD    (OC-CONTROL-PRIMARY)
 10501*       RESP      (WS-RESPONSE)
 10502*    END-EXEC
 10503     MOVE LENGTH OF
 10504      ORIGINAL-CERTIFICATE
 10505       TO DFHEIV11
 10506     MOVE 'ELCRTO' TO DFHEIV1
 10507*    MOVE '&$ L                  ''  N#00010276' TO DFHEIV0
 10508     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10509     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10510     MOVE X'204E233030303130323736' TO DFHEIV0(25:11)
 10511     CALL 'kxdfhei1' USING DFHEIV0,
 10512           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL6311.cbl
 10513           ORIGINAL-CERTIFICATE,
 10514           DFHEIV11,
 10515           OC-CONTROL-PRIMARY,
 10516           DFHEIV99,
 10517           DFHEIV99
 10518     MOVE EIBRESP  TO WS-RESPONSE
 10519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10520     display ' just wrote 1275 ' ws-response
 10521     IF RESP-DUPKEY
 10522        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10523        GO TO 1275-WRITE-ELCRTO
 10524     ELSE
 10525        IF NOT RESP-NORMAL
 10526           MOVE -1               TO BMAINTL
 10527           MOVE ER-7450          TO EMI-ERROR
 10528           PERFORM 9900-ERROR-FORMAT
 10529                                 THRU 9900-EXIT
 10530           GO TO 8200-SEND-DATAONLY
 10531        END-IF
 10532     END-IF
 10533******************************************************************
 10534*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10535******************************************************************
 10536
 10537
 10538* EXEC CICS READ
 10539*        INTO    (PENDING-BUSINESS)
 10540*        DATASET (FILE-ID-ERPNDB)
 10541*        RIDFLD  (ERPNDB-KEY)
 10542*        UPDATE
 10543*    END-EXEC.
 10544     MOVE LENGTH OF
 10545      PENDING-BUSINESS
 10546       TO DFHEIV11
 10547*    MOVE '&"IL       EU         (   #00010299' TO DFHEIV0
 10548     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10549     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10550     MOVE X'2020233030303130323939' TO DFHEIV0(25:11)
 10551     CALL 'kxdfhei1' USING DFHEIV0,
 10552           FILE-ID-ERPNDB,
 10553           PENDING-BUSINESS,
 10554           DFHEIV11,
 10555           ERPNDB-KEY,
 10556           DFHEIV99,
 10557           DFHEIV99,
 10558           DFHEIV99
 10559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10560
 10561
 10562     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10563     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10564     MOVE 'B'                    TO JP-RECORD-TYPE.
 10565     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10566
 10567     PERFORM 8400-LOG-JOURNAL-RECORD.
 10568
 10569     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10570
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL6311.cbl
 10571
 10572* EXEC CICS REWRITE
 10573*        DATASET (FILE-ID-ERPNDB)
 10574*        FROM    (PENDING-BUSINESS)
 10575*    END-EXEC.
 10576     MOVE LENGTH OF
 10577      PENDING-BUSINESS
 10578       TO DFHEIV11
 10579*    MOVE '&& L                  %   #00010315' TO DFHEIV0
 10580     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10581     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10582     MOVE X'2020233030303130333135' TO DFHEIV0(25:11)
 10583     CALL 'kxdfhei1' USING DFHEIV0,
 10584           FILE-ID-ERPNDB,
 10585           PENDING-BUSINESS,
 10586           DFHEIV11,
 10587           DFHEIV99
 10588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10589
 10590
 10591     MOVE 'C'                    TO JP-RECORD-TYPE.
 10592     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10593
 10594     PERFORM 8400-LOG-JOURNAL-RECORD.
 10595
 10596     IF WS-ERRORS-PRESENT
 10597         GO TO 3900-RE-DISPLAY-RECORD.
 10598
 10599     MOVE ZEROS                  TO EMI-ERROR.
 10600     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10601     MOVE LOW-VALUES             TO EL631BI.
 10602     MOVE  -1                    TO BMAINTL.
 10603     GO TO 8100-SEND-INITIAL-MAP.
 10604
 10605 1280-BATCH-HDR-NOT-FOUND.
 10606     MOVE -1                     TO BMAINTL.
 10607     MOVE ER-7450                TO EMI-ERROR.
 10608     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10609     GO TO 8200-SEND-DATAONLY.
 10610
 10611 1290-DUPLICATE-ALT-INDEX.
 10612
 10613******************************************************************
 10614*                                                                *
 10615*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10616*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10617*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10618*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10619*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10620*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10621*                                                                *
 10622******************************************************************
 10623
 10624     IF LCP-ONCTR-01 =  0
 10625         ADD 1 TO LCP-ONCTR-01
 10626        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10627
 10628     ADD +1                      TO WS-SEQ-NO-COUNTER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL6311.cbl
 10629
 10630     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10631         NEXT SENTENCE
 10632     ELSE
 10633         ADD +1 TO PB-BATCH-SEQ-NO
 10634                   PB-CSR-BATCH-SEQ-NO
 10635         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10636         GO TO 1275-WRITE-PENDING-BUSINESS.
 10637
 10638     MOVE -1                     TO BCERTNOL.
 10639     MOVE AL-UABON               TO BCERTNOA.
 10640     MOVE AL-UNBON               TO BEFFDTA.
 10641
 10642     MOVE 1                      TO EMI-SUB
 10643                                    EMI-SWITCH1
 10644                                    EMI-SWITCH-AREA-1
 10645                                    EMI-SWITCH-AREA-2.
 10646
 10647     MOVE SPACES                 TO EMI-ERROR-LINES.
 10648
 10649
 10650* EXEC CICS SYNCPOINT ROLLBACK
 10651*    END-EXEC.
 10652*    MOVE '6"R                   !   #00010378' TO DFHEIV0
 10653     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10655     MOVE X'2020233030303130333738' TO DFHEIV0(25:11)
 10656     CALL 'kxdfhei1' USING DFHEIV0
 10657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10658
 10659
 10660     MOVE ER-2247                TO EMI-ERROR.
 10661     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10662     GO TO 8200-SEND-DATAONLY.
 10663
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL6311.cbl
 10665
 10666******************************************************************
 10667*                                                                *
 10668*          C H A N G E   I S S U E   R O U T I N E               *
 10669*                                                                *
 10670******************************************************************
 10671
 10672***************************************************************
 10673*                                                             *
 10674*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10675*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10676*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10677*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10678*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10679*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10680*     5. LINK TO THE EDIT ROUTINE.                            *
 10681*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10682*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10683*              THE EDIT ROUTINE.                              *
 10684*     7. REWRITE THE NEW ISSUE                                *
 10685*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10686*                                                             *
 10687***************************************************************
 10688
 10689 1300-CHANGE-ISSUE-ROUTINE.
 10690     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10691
 10692     IF BCHGL NOT = ZEROS
 10693        MOVE ER-2196             TO EMI-ERROR
 10694        MOVE AL-UABON            TO BMAINTA
 10695        MOVE -1                  TO BMAINTL
 10696        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10697        GO TO 8200-SEND-DATAONLY.
 10698
 10699     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10700
 10701     IF BSUFIXL NOT = ZEROS
 10702        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10703     ELSE
 10704        MOVE SPACE               TO WS-NEW-SUFFIX.
 10705
 10706     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10707     PERFORM 8600-DEEDIT.
 10708     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10709     MOVE '4'                    TO DC-OPTION-CODE.
 10710     PERFORM 9700-DATE-LINK.
 10711     IF DATE-CONVERSION-ERROR
 10712        MOVE ER-0348             TO EMI-ERROR
 10713        MOVE -1                  TO BEFFDTL
 10714        MOVE AL-UABON            TO BEFFDTA
 10715        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10716        GO TO 8200-SEND-DATAONLY
 10717     ELSE
 10718        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10719        MOVE AL-UANON            TO BEFFDTA
 10720        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10721
 10722 1325-PROCESS-ISSUE-CHANGES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL6311.cbl
 10723
 10724* EXEC CICS HANDLE CONDITION
 10725*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10726*    END-EXEC.
 10727*    MOVE '"$I                   ! % #00010444' TO DFHEIV0
 10728     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10730     MOVE X'2520233030303130343434' TO DFHEIV0(25:11)
 10731     CALL 'kxdfhei1' USING DFHEIV0
 10732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10733
 10734
 10735     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10736     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10737     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10738
 10739
 10740* EXEC CICS GETMAIN
 10741*        SET      (ADDRESS OF PENDING-BUSINESS)
 10742*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10743*        INITIMG  (GETMAIN-SPACE)
 10744*     END-EXEC.
 10745*    MOVE ',"IL                  $   #00010452' TO DFHEIV0
 10746     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10747     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10748     MOVE X'2020233030303130343532' TO DFHEIV0(25:11)
 10749     CALL 'kxdfhei1' USING DFHEIV0,
 10750           DFHEIV20,
 10751           ERPNDB-RECORD-LENGTH,
 10752           GETMAIN-SPACE
 10753     SET ADDRESS OF PENDING-BUSINESS TO
 10754         DFHEIV20
 10755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10756
 10757
 10758
 10759* EXEC CICS READ
 10760*        INTO    (PENDING-BUSINESS)
 10761*        DATASET (FILE-ID-ERPNDB)
 10762*        RIDFLD  (ERPNDB-KEY)
 10763*    END-EXEC.
 10764     MOVE LENGTH OF
 10765      PENDING-BUSINESS
 10766       TO DFHEIV11
 10767*    MOVE '&"IL       E          (   #00010458' TO DFHEIV0
 10768     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10769     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10770     MOVE X'2020233030303130343538' TO DFHEIV0(25:11)
 10771     CALL 'kxdfhei1' USING DFHEIV0,
 10772           FILE-ID-ERPNDB,
 10773           PENDING-BUSINESS,
 10774           DFHEIV11,
 10775           ERPNDB-KEY,
 10776           DFHEIV99,
 10777           DFHEIV99,
 10778           DFHEIV99
 10779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10780
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL6311.cbl
 10781
 10782     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10783
 10784
 10785* EXEC CICS HANDLE CONDITION
 10786*         NOTFND     (1385-REC-NOT-FOUND)
 10787*    END-EXEC.
 10788*    MOVE '"$I                   ! & #00010466' TO DFHEIV0
 10789     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10791     MOVE X'2620233030303130343636' TO DFHEIV0(25:11)
 10792     CALL 'kxdfhei1' USING DFHEIV0
 10793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10794
 10795
 10796**********************************************************
 10797*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10798*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10799**********************************************************
 10800
 10801
 10802* EXEC CICS READ
 10803*        DATASET (FILE-ID-ERPNDB)
 10804*        INTO    (PENDING-BUSINESS)
 10805*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10806*    END-EXEC.
 10807     MOVE LENGTH OF
 10808      PENDING-BUSINESS
 10809       TO DFHEIV11
 10810*    MOVE '&"IL       E          (   #00010475' TO DFHEIV0
 10811     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10812     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10813     MOVE X'2020233030303130343735' TO DFHEIV0(25:11)
 10814     CALL 'kxdfhei1' USING DFHEIV0,
 10815           FILE-ID-ERPNDB,
 10816           PENDING-BUSINESS,
 10817           DFHEIV11,
 10818           PI-PREV-CONTROL-PRIMARY,
 10819           DFHEIV99,
 10820           DFHEIV99,
 10821           DFHEIV99
 10822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10823
 10824
 10825********** DO NOT ALLOW CHANGES IF THRU A/R
 10826     IF BMAINTI = 'C'
 10827         IF PB-EL860-INTERNAL-PROCESS
 10828             MOVE ER-4005          TO EMI-ERROR
 10829             MOVE -1               TO BMAINTL
 10830             MOVE AL-UABON         TO BMAINTA
 10831             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10832             GO TO 8200-SEND-DATAONLY.
 10833**********
 10834
 10835     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 10836        MOVE -1                 TO BMAINTL
 10837        MOVE ER-2197            TO EMI-ERROR
 10838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL6311.cbl
 10839        GO TO 8200-SEND-DATAONLY.
 10840
 10841     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 10842        MOVE ER-2196             TO EMI-ERROR
 10843        MOVE AL-UABON            TO BMAINTA
 10844        MOVE -1                  TO BMAINTL
 10845        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10846        GO TO 8200-SEND-DATAONLY.
 10847
 10848     MOVE ZEROS                  TO WS-SEQ-SAVE.
 10849
 10850     IF PB-BILLED-DT = LOW-VALUES AND
 10851        PB-CHG-COUNT = ZEROS
 10852        NEXT SENTENCE
 10853     ELSE
 10854        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 10855            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 10856           OR
 10857           (BPREM-LEN (2) GREATER THAN ZEROS AND
 10858            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 10859           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 10860
 10861
 10862* EXEC CICS READ
 10863*        DATASET (FILE-ID-ERPNDB)
 10864*        INTO    (PENDING-BUSINESS)
 10865*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10866*        UPDATE
 10867*    END-EXEC.
 10868     MOVE LENGTH OF
 10869      PENDING-BUSINESS
 10870       TO DFHEIV11
 10871*    MOVE '&"IL       EU         (   #00010517' TO DFHEIV0
 10872     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10873     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10874     MOVE X'2020233030303130353137' TO DFHEIV0(25:11)
 10875     CALL 'kxdfhei1' USING DFHEIV0,
 10876           FILE-ID-ERPNDB,
 10877           PENDING-BUSINESS,
 10878           DFHEIV11,
 10879           PI-PREV-CONTROL-PRIMARY,
 10880           DFHEIV99,
 10881           DFHEIV99,
 10882           DFHEIV99
 10883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10884
 10885
 10886     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10887     MOVE 'B'                    TO JP-RECORD-TYPE
 10888     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10889     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10890
 10891     PERFORM 8400-LOG-JOURNAL-RECORD.
 10892
 10893     IF PB-BILLED-DT NOT = LOW-VALUES OR
 10894        PB-CHG-COUNT NOT = ZEROS
 10895        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 10896            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL6311.cbl
 10897           OR
 10898           (BPREM-LEN (2) GREATER THAN ZEROS AND
 10899            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 10900            MOVE LOW-VALUES             TO PB-BILLED-DT
 10901            ADD +1                      TO PB-CHG-COUNT.
 10902
 10903     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 10904     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10905     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 10906     MOVE '5'                    TO DC-OPTION-CODE.
 10907     PERFORM 9700-DATE-LINK
 10908     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 10909
 10910*    IF BMICRNOL  GREATER  ZEROS
 10911*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 10912
 10913     IF BVINL > ZEROS
 10914        MOVE BVINI               TO PB-I-VIN
 10915     END-IF
 10916     IF (BFORCEL NOT = ZEROS)
 10917        AND (PB-COMPANY-ID = 'DCC')
 10918        AND (BFORCEI = ' ')
 10919        AND (PB-FORCE-CODE = 'O')
 10920        COMPUTE PB-I-AH-PREMIUM-AMT =
 10921           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 10922        PERFORM 1800-REMOVE-CERT-NOTES
 10923                                 THRU 1800-EXIT
 10924        PERFORM 1900-DELETE-ERPYAJ
 10925                                 THRU 1900-EXIT
 10926        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 10927     END-IF
 10928     IF (BFORCEL NOT = ZEROS)
 10929        AND (PB-COMPANY-ID = 'DCC')
 10930        AND (BFORCEI = 'O')
 10931        AND (PB-FORCE-CODE NOT = 'O')
 10932        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 10933           PB-I-AH-PREM-CALC
 10934        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 10935        MOVE SPACE               TO DC-OPTION-CODE
 10936        PERFORM 9700-DATE-LINK
 10937        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 10938        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 10939        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 10940        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 10941        PERFORM 1500-UPDATE-ERNOTE
 10942                                 THRU 1500-EXIT
 10943        PERFORM 1600-UPDATE-ERPYAJ
 10944                                 THRU 1600-EXIT
 10945     END-IF
 10946     IF BLSTNML  GREATER THAN ZEROS
 10947         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10948
 10949     IF B1STNML  GREATER THAN ZEROS
 10950         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10951
 10952     IF BINITL   GREATER THAN ZEROS
 10953         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10954
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL6311.cbl
 10955     IF BBIRTHL  GREATER THAN ZERO
 10956         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 10957
 10958     IF B1STPMTL GREATER THAN ZERO
 10959         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 10960
 10961     IF BAGEL    GREATER THAN ZEROS
 10962         MOVE BAGEI              TO PB-I-AGE.
 10963
 10964     IF BSEXL    GREATER THAN ZEROS
 10965         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10966
 10967     IF BTERM-LEN (1)   GREATER THAN ZEROS
 10968        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 10969
 10970     IF BTERM-LEN (2)   GREATER THAN ZEROS
 10971        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 10972
 10973     IF BLNTRML  GREATER THAN ZEROS
 10974         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 10975
 10976     IF BFREQL   GREATER THAN ZEROS
 10977         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 10978
 10979     IF BSKPCDL  GREATER THAN ZEROS
 10980         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10981
 10982     IF BMODEL   GREATER THAN ZEROS
 10983         MOVE BMODEI             TO PB-I-TERM-TYPE
 10984                                    PI-BMODE.
 10985
 10986     IF BPMTSL   GREATER THAN ZEROS
 10987         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10988                                    PI-BPMTS.
 10989
 10990     IF BPMTAMTL GREATER THAN ZEROS
 10991         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 10992
 10993     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10994         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 10995
 10996     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10997         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 10998
 10999     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11000
 11001     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11002         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11003            SUBTRACT PB-I-LF-PREMIUM-AMT
 11004                     FROM WS-B-LF-ISS-PRM-ENTERED
 11005            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11006            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11007            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11008         ELSE
 11009            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11010            MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11011
 11012     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL6311.cbl
 11013            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11014                     FROM WS-B-LF-ISS-PRM-ENTERED
 11015         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11016         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11017
 11018     IF  BALT-PREM-LEN     (2)  > ZEROS
 11019         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11020
 11021     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11022         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11023
 11024     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11025         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11026            SUBTRACT PB-I-AH-PREMIUM-AMT
 11027                     FROM WS-B-AH-ISS-PRM-ENTERED
 11028            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11029            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11030            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11031         ELSE
 11032            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11033            MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11034
 11035     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11036        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11037
 11038     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11039        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11040
 11041     IF BINDGRPL            GREATER THAN ZEROS
 11042         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11043
 11044     IF BRTCLSL             GREATER THAN ZEROS
 11045         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11046
 11047     IF BSIGL               GREATER THAN ZEROS
 11048         MOVE BSIGI              TO PB-I-SIG-SW.
 11049
 11050     IF BAPRL               GREATER THAN ZEROS
 11051         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11052
 11053     IF BMEMBERL            GREATER THAN ZEROS
 11054         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11055
 11056     IF BLNOFCRL            GREATER THAN ZEROS
 11057         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11058
 11059     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11060        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11061
 11062     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11063        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11064
 11065     IF BDAYSL              GREATER THAN ZEROS
 11066        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11067                                    PB-I-EXTENTION-DAYS.
 11068
 11069     IF BDAYSL GREATER THAN ZEROS
 11070        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL6311.cbl
 11071
 11072     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11073        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11074           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11075
 11076     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11077        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11078           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11079
 11080     IF B1STPMTL GREATER THAN ZEROS
 11081        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11082
 11083     IF PB-EXT-DAYS-PROCESSING
 11084        IF PB-I-EXTENTION-DAYS = ZEROS
 11085           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11086
 11087     IF PB-EXPIRE-DT-PROCESSING
 11088        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11089           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11090             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11091
 11092     IF PB-1ST-PMT-DT-PROCESSING
 11093        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11094           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11095
 11096     IF BREINL GREATER THAN ZEROS
 11097        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11098
 11099     IF BFORCEL NOT = ZEROS
 11100        MOVE BFORCEI             TO PB-FORCE-CODE.
 11101     IF (BENTRYL NOT = ZEROS)
 11102        AND (PB-COMPANY-ID = 'CID')
 11103        AND (PB-STATE = 'VA')
 11104        AND (BENTRYI NOT = 'P')
 11105        AND (PB-BATCH-ENTRY = 'P')
 11106        PERFORM 1800-REMOVE-CERT-NOTES
 11107                                 THRU 1800-EXIT
 11108     END-IF
 11109     IF BENTRYL NOT = ZEROS
 11110        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11111        IF PI-COMPANY-ID = 'CID'
 11112           AND (PB-BATCH-ENTRY = 'P')
 11113           AND (PB-STATE = 'VA')
 11114           PERFORM 1500-UPDATE-ERNOTE
 11115                                 THRU 1500-EXIT
 11116        END-IF
 11117     END-IF
 11118
 11119     IF BUNWRITL NOT = ZEROS
 11120        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11121
 11122     IF BBILCDL NOT = ZEROS
 11123        MOVE BBILCDI             TO PB-RECORD-BILL.
 11124
 11125     IF BLIVESL GREATER THAN ZEROS
 11126        MOVE WS-BLIVES           TO PB-I-LIVES.
 11127
 11128
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL6311.cbl
 11129*DMD CUSTOM CODING*************START
 11130     IF PI-COMPANY-ID NOT = 'DMD'
 11131         MOVE ZEROS               TO BBILLEDL.
 11132*DMD CUSTOM CODING*************END
 11133
 11134     IF BBILLEDL GREATER THAN ZEROS
 11135        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11136
 11137
 11138*****************************************************************
 11139*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11140*****************************************************************
 11141
 11142     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11143        IF BTYPE  (1)   = ZEROS OR SPACES
 11144           IF REMOVE-LF-COVERAGE
 11145               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11146                                        PI-BTYPE (1)
 11147               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11148                                        WS-B-LF-ISS-PRM-ENTERED
 11149               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11150                                        WS-B-LF-ISS-PRM-ENTERED
 11151               SUBTRACT PB-I-LF-PREM-CALC FROM
 11152                                        WS-B-LF-ISS-PRM-COMPUTED
 11153               MOVE ZEROS            TO PB-I-LF-TERM
 11154                                        PB-I-LF-BENEFIT-AMT
 11155                                        PB-I-LF-PREMIUM-AMT
 11156                                        PB-I-LF-BENEFIT-CD
 11157                                        PB-I-LF-PREM-CALC
 11158                                        PB-I-LF-CRIT-PER
 11159                                        PB-I-LF-ALT-BENEFIT-AMT
 11160                                        PB-I-LF-ALT-PREMIUM-AMT
 11161               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11162           ELSE
 11163               NEXT SENTENCE
 11164        ELSE
 11165           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11166                                    PI-BTYPE (1).
 11167     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11168        IF BTYPE  (2)   = ZEROS OR SPACES
 11169           IF  REMOVE-AH-COVERAGE
 11170               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11171                                        PI-BTYPE (2)
 11172               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11173                                        WS-B-AH-ISS-PRM-ENTERED
 11174               SUBTRACT PB-I-AH-PREM-CALC FROM
 11175                                        WS-B-AH-ISS-PRM-COMPUTED
 11176               MOVE ZEROS            TO PB-I-AH-TERM
 11177                                        PB-I-AH-BENEFIT-AMT
 11178                                        PB-I-AH-PREMIUM-AMT
 11179                                        PB-I-AH-BENEFIT-CD
 11180                                        PB-I-AH-PREM-CALC
 11181                                        PB-I-AH-CRIT-PER
 11182               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11183           ELSE
 11184               NEXT SENTENCE
 11185        ELSE
 11186           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL6311.cbl
 11187                                    PI-BTYPE (2).
 11188 1360-REWRITE-PB-RECORD.
 11189     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11190
 11191     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11192     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11193
 11194     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11195
 11196     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11197     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11198
 11199     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11200         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11201
 11202     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11203         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11204
 11205     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11206
 11207     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11208
 11209     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11210
 11211     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11212     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11213     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11214
 11215     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11216     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11217
 11218 1375-REWRITE-PB-RECORD.
 11219     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11220     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11221     MOVE 'C'                    TO JP-RECORD-TYPE.
 11222     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11223
 11224
 11225* EXEC CICS REWRITE
 11226*        DATASET (FILE-ID-ERPNDB)
 11227*        FROM    (PENDING-BUSINESS)
 11228*    END-EXEC.
 11229     MOVE LENGTH OF
 11230      PENDING-BUSINESS
 11231       TO DFHEIV11
 11232*    MOVE '&& L                  %   #00010862' TO DFHEIV0
 11233     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11234     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11235     MOVE X'2020233030303130383632' TO DFHEIV0(25:11)
 11236     CALL 'kxdfhei1' USING DFHEIV0,
 11237           FILE-ID-ERPNDB,
 11238           PENDING-BUSINESS,
 11239           DFHEIV11,
 11240           DFHEIV99
 11241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11242
 11243
 11244     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL6311.cbl
 11245******************************************************************
 11246*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11247******************************************************************
 11248     display ' made it to update orig cert '
 11249     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11250     MOVE ' '                    TO WS-ERMAIL-SW
 11251
 11252* EXEC CICS READ
 11253*       DATASET   (FILE-ID-ERMAIL)
 11254*       SET       (ADDRESS OF MAILING-DATA)
 11255*       RIDFLD    (ERMAIL-KEY)
 11256*       RESP      (WS-RESPONSE)
 11257*    END-EXEC
 11258*    MOVE '&"S        E          (  N#00010874' TO DFHEIV0
 11259     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11260     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11261     MOVE X'204E233030303130383734' TO DFHEIV0(25:11)
 11262     CALL 'kxdfhei1' USING DFHEIV0,
 11263           FILE-ID-ERMAIL,
 11264           DFHEIV20,
 11265           DFHEIV99,
 11266           ERMAIL-KEY,
 11267           DFHEIV99,
 11268           DFHEIV99,
 11269           DFHEIV99
 11270     SET ADDRESS OF MAILING-DATA TO
 11271         DFHEIV20
 11272     MOVE EIBRESP  TO WS-RESPONSE
 11273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11274     IF RESP-NORMAL
 11275        SET ERMAIL-FOUND TO TRUE
 11276     END-IF
 11277     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11278                                 TO ELCRTO-KEY
 11279     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11280     MOVE +0                     TO ELCRTO-SEQ-NO
 11281
 11282* EXEC CICS READ
 11283*       DATASET   ('ELCRTO')
 11284*       INTO      (ORIGINAL-CERTIFICATE)
 11285*       RIDFLD    (ELCRTO-KEY)
 11286*       GTEQ
 11287*       RESP      (WS-RESPONSE)
 11288*    END-EXEC
 11289     MOVE LENGTH OF
 11290      ORIGINAL-CERTIFICATE
 11291       TO DFHEIV11
 11292     MOVE 'ELCRTO' TO DFHEIV1
 11293*    MOVE '&"IL       G          (  N#00010887' TO DFHEIV0
 11294     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11295     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11296     MOVE X'204E233030303130383837' TO DFHEIV0(25:11)
 11297     CALL 'kxdfhei1' USING DFHEIV0,
 11298           DFHEIV1,
 11299           ORIGINAL-CERTIFICATE,
 11300           DFHEIV11,
 11301           ELCRTO-KEY,
 11302           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL6311.cbl
 11303           DFHEIV99,
 11304           DFHEIV99
 11305     MOVE EIBRESP  TO WS-RESPONSE
 11306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11307     display ' just read gteq ' ws-response
 11308     IF RESP-NORMAL
 11309        AND (OC-CONTROL-PRIMARY (1:33) =
 11310                 PB-CONTROL-BY-ACCOUNT (1:33))
 11311        AND (OC-RECORD-TYPE = 'I')
 11312        display ' resp norm, key =, type i '
 11313        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11314           display ' end proc blank '
 11315           display ' csr edit session ' PI-CSR-SESSION-SW
 11316           IF NOT CSR-EDIT-SESSION
 11317
 11318* EXEC CICS READ
 11319*                DATASET   ('ELCRTO')
 11320*                INTO      (ORIGINAL-CERTIFICATE)
 11321*                RIDFLD    (OC-CONTROL-PRIMARY)
 11322*                UPDATE
 11323*                RESP      (WS-RESPONSE)
 11324*             END-EXEC
 11325     MOVE LENGTH OF
 11326      ORIGINAL-CERTIFICATE
 11327       TO DFHEIV11
 11328     MOVE 'ELCRTO' TO DFHEIV1
 11329*    MOVE '&"IL       EU         (  N#00010904' TO DFHEIV0
 11330     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11331     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11332     MOVE X'204E233030303130393034' TO DFHEIV0(25:11)
 11333     CALL 'kxdfhei1' USING DFHEIV0,
 11334           DFHEIV1,
 11335           ORIGINAL-CERTIFICATE,
 11336           DFHEIV11,
 11337           OC-CONTROL-PRIMARY,
 11338           DFHEIV99,
 11339           DFHEIV99,
 11340           DFHEIV99
 11341     MOVE EIBRESP  TO WS-RESPONSE
 11342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11343              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11344              IF RESP-NORMAL
 11345                 display ' good read upd '
 11346                 MOVE PB-I-INSURED-LAST-NAME TO
 11347                         OC-INS-LAST-NAME
 11348                 MOVE PB-I-INSURED-FIRST-NAME TO
 11349                         OC-INS-FIRST-NAME
 11350                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11351                         OC-INS-MIDDLE-INIT
 11352                 MOVE PB-I-AGE         TO OC-INS-AGE
 11353                 MOVE PB-I-JOINT-LAST-NAME   TO
 11354                         OC-JNT-LAST-NAME
 11355                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11356                         OC-JNT-FIRST-NAME
 11357                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11358                         OC-JNT-MIDDLE-INIT
 11359                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11360                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL6311.cbl
 11361                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11362                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11363                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11364                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11365                         OC-LF-ALT-BEN-AMT
 11366                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11367                         OC-LF-ALT-PRM-AMT
 11368                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11369                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11370                 MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11371                 MOVE +0               TO OC-LF-CANCEL-AMT
 11372                                          OC-LF-ITD-CANCEL-AMT
 11373                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11374                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11375                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11376                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11377                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11378                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11379                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11380                 MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11381                 MOVE +0               TO OC-AH-CANCEL-AMT
 11382                                          OC-AH-ITD-CANCEL-AMT
 11383                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11384                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11385                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11386                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11387                 IF ERMAIL-FOUND
 11388                    MOVE MA-CRED-BENE-NAME
 11389                                 TO OC-CRED-BENE-NAME
 11390                 END-IF
 11391
 11392* EXEC CICS REWRITE
 11393*                   DATASET   ('ELCRTO')
 11394*                   FROM      (ORIGINAL-CERTIFICATE)
 11395*                   RESP      (WS-RESPONSE)
 11396*                END-EXEC
 11397     MOVE LENGTH OF
 11398      ORIGINAL-CERTIFICATE
 11399       TO DFHEIV11
 11400     MOVE 'ELCRTO' TO DFHEIV1
 11401*    MOVE '&& L                  %  N#00010959' TO DFHEIV0
 11402     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11403     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11404     MOVE X'204E233030303130393539' TO DFHEIV0(25:11)
 11405     CALL 'kxdfhei1' USING DFHEIV0,
 11406           DFHEIV1,
 11407           ORIGINAL-CERTIFICATE,
 11408           DFHEIV11,
 11409           DFHEIV99
 11410     MOVE EIBRESP  TO WS-RESPONSE
 11411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11412                 display ' just rewrote ' ws-response
 11413              END-IF
 11414           END-IF
 11415        ELSE
 11416           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11417           MOVE 'OC'             TO OC-RECORD-ID
 11418           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL6311.cbl
 11419           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11420           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11421           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11422           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11423           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11424           MOVE PB-I-AGE         TO OC-INS-AGE
 11425           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11426           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11427           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11428           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11429           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11430           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11431           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11432           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11433           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11434           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11435           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11436           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11437           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11438           MOVE +0               TO OC-LF-CANCEL-AMT
 11439                                    OC-LF-ITD-CANCEL-AMT
 11440           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11441           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11442           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11443           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11444           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11445           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11446           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11447           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11448           MOVE +0               TO OC-AH-CANCEL-AMT
 11449                                    OC-AH-ITD-CANCEL-AMT
 11450           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11451           IF ERMAIL-FOUND
 11452              MOVE MA-CRED-BENE-NAME
 11453                                 TO OC-CRED-BENE-NAME
 11454           END-IF
 11455           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11456
 11457* EXEC CICS WRITE
 11458*             DATASET   ('ELCRTO')
 11459*             FROM      (ORIGINAL-CERTIFICATE)
 11460*             RIDFLD    (OC-CONTROL-PRIMARY)
 11461*             RESP      (WS-RESPONSE)
 11462*          END-EXEC
 11463     MOVE LENGTH OF
 11464      ORIGINAL-CERTIFICATE
 11465       TO DFHEIV11
 11466     MOVE 'ELCRTO' TO DFHEIV1
 11467*    MOVE '&$ L                  ''  N#00011008' TO DFHEIV0
 11468     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11469     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11470     MOVE X'204E233030303131303038' TO DFHEIV0(25:11)
 11471     CALL 'kxdfhei1' USING DFHEIV0,
 11472           DFHEIV1,
 11473           ORIGINAL-CERTIFICATE,
 11474           DFHEIV11,
 11475           OC-CONTROL-PRIMARY,
 11476           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 214
* EL6311.cbl
 11477           DFHEIV99
 11478     MOVE EIBRESP  TO WS-RESPONSE
 11479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11480        END-IF
 11481     ELSE
 11482        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11483        MOVE 'OC'                TO OC-RECORD-ID
 11484        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11485                                 TO OC-CONTROL-PRIMARY (1:33)
 11486        MOVE 'I'                 TO OC-RECORD-TYPE
 11487        MOVE +4096               TO OC-KEY-SEQ-NO
 11488        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11489        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11490        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11491        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11492        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11493        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11494        MOVE PB-I-AGE            TO OC-INS-AGE
 11495        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11496        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11497        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11498        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11499        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11500        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11501        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11502        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11503        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11504        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11505        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11506        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11507        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11508        MOVE +0                  TO OC-LF-CANCEL-AMT
 11509                                    OC-LF-ITD-CANCEL-AMT
 11510        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11511        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11512        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11513        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11514        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11515        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11516        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11517        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11518        MOVE +0                  TO OC-AH-CANCEL-AMT
 11519                                    OC-AH-ITD-CANCEL-AMT
 11520        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11521        IF ERMAIL-FOUND
 11522           MOVE MA-CRED-BENE-NAME
 11523                                 TO OC-CRED-BENE-NAME
 11524        END-IF
 11525        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11526
 11527* EXEC CICS WRITE
 11528*          DATASET   ('ELCRTO')
 11529*          FROM      (ORIGINAL-CERTIFICATE)
 11530*          RIDFLD    (OC-CONTROL-PRIMARY)
 11531*          RESP      (WS-RESPONSE)
 11532*       END-EXEC
 11533     MOVE LENGTH OF
 11534      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 215
* EL6311.cbl
 11535       TO DFHEIV11
 11536     MOVE 'ELCRTO' TO DFHEIV1
 11537*    MOVE '&$ L                  ''  N#00011060' TO DFHEIV0
 11538     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11539     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11540     MOVE X'204E233030303131303630' TO DFHEIV0(25:11)
 11541     CALL 'kxdfhei1' USING DFHEIV0,
 11542           DFHEIV1,
 11543           ORIGINAL-CERTIFICATE,
 11544           DFHEIV11,
 11545           OC-CONTROL-PRIMARY,
 11546           DFHEIV99,
 11547           DFHEIV99
 11548     MOVE EIBRESP  TO WS-RESPONSE
 11549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11550     END-IF
 11551******************************************************************
 11552*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11553******************************************************************
 11554
 11555     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11556     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11557
 11558
 11559* EXEC CICS READ
 11560*        INTO    (PENDING-BUSINESS)
 11561*        DATASET (FILE-ID-ERPNDB)
 11562*        RIDFLD  (ERPNDB-KEY)
 11563*        UPDATE
 11564*    END-EXEC.
 11565     MOVE LENGTH OF
 11566      PENDING-BUSINESS
 11567       TO DFHEIV11
 11568*    MOVE '&"IL       EU         (   #00011074' TO DFHEIV0
 11569     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11570     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11571     MOVE X'2020233030303131303734' TO DFHEIV0(25:11)
 11572     CALL 'kxdfhei1' USING DFHEIV0,
 11573           FILE-ID-ERPNDB,
 11574           PENDING-BUSINESS,
 11575           DFHEIV11,
 11576           ERPNDB-KEY,
 11577           DFHEIV99,
 11578           DFHEIV99,
 11579           DFHEIV99
 11580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11581
 11582
 11583     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11584     MOVE 'B'                    TO JP-RECORD-TYPE.
 11585     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11586
 11587     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11588
 11589     PERFORM 8400-LOG-JOURNAL-RECORD.
 11590
 11591     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11592
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 216
* EL6311.cbl
 11593     MOVE 'C'                    TO JP-RECORD-TYPE.
 11594     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11595
 11596
 11597* EXEC CICS REWRITE
 11598*        DATASET    (FILE-ID-ERPNDB)
 11599*        FROM       (PENDING-BUSINESS)
 11600*    END-EXEC.
 11601     MOVE LENGTH OF
 11602      PENDING-BUSINESS
 11603       TO DFHEIV11
 11604*    MOVE '&& L                  %   #00011094' TO DFHEIV0
 11605     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11606     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11607     MOVE X'2020233030303131303934' TO DFHEIV0(25:11)
 11608     CALL 'kxdfhei1' USING DFHEIV0,
 11609           FILE-ID-ERPNDB,
 11610           PENDING-BUSINESS,
 11611           DFHEIV11,
 11612           DFHEIV99
 11613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11614
 11615
 11616     PERFORM 8400-LOG-JOURNAL-RECORD.
 11617
 11618     IF WS-ERRORS-PRESENT
 11619        GO TO 3900-RE-DISPLAY-RECORD.
 11620
 11621     MOVE ZEROS                  TO EMI-ERROR.
 11622     MOVE -1                     TO BMAINTL.
 11623     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11624     GO TO 3900-RE-DISPLAY-RECORD.
 11625
 11626 1380-BATCH-HDR-NOT-FOUND.
 11627     MOVE -1                     TO BMAINTL.
 11628     MOVE ER-7450                TO EMI-ERROR.
 11629     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11630     GO TO 8200-SEND-DATAONLY.
 11631
 11632 1385-REC-NOT-FOUND.
 11633     MOVE -1                     TO BMAINTL.
 11634     MOVE ER-7451                TO EMI-ERROR.
 11635     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11636     GO TO 8200-SEND-DATAONLY.
 11637
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 217
* EL6311.cbl
 11639
 11640 1390-UPDATE-ERPNDM.
 11641
 11642
 11643* EXEC CICS HANDLE CONDITION
 11644*        NOTFND (1399-EXIT)
 11645*    END-EXEC.
 11646*    MOVE '"$I                   ! '' #00011125' TO DFHEIV0
 11647     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11649     MOVE X'2720233030303131313235' TO DFHEIV0(25:11)
 11650     CALL 'kxdfhei1' USING DFHEIV0
 11651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11652
 11653
 11654     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 11655
 11656
 11657* EXEC CICS READ
 11658*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 11659*        DATASET (FILE-ID-ERPNDM)
 11660*        RIDFLD  (ERPNDM-KEY)
 11661*        UPDATE
 11662*    END-EXEC.
 11663*    MOVE '&"S        EU         (   #00011131' TO DFHEIV0
 11664     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11665     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11666     MOVE X'2020233030303131313331' TO DFHEIV0(25:11)
 11667     CALL 'kxdfhei1' USING DFHEIV0,
 11668           FILE-ID-ERPNDM,
 11669           DFHEIV20,
 11670           DFHEIV99,
 11671           ERPNDM-KEY,
 11672           DFHEIV99,
 11673           DFHEIV99,
 11674           DFHEIV99
 11675     SET ADDRESS OF PENDING-MAILING-DATA TO
 11676         DFHEIV20
 11677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11678
 11679
 11680     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 11681     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 11682     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 11683
 11684     IF BLSTNML GREATER THAN ZEROS
 11685         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 11686
 11687     IF B1STNML GREATER  THAN ZEROS
 11688         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
 11689
 11690     IF BINITL GREATER THAN ZEROS
 11691         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 11692
 11693     IF BAGEL GREATER THAN ZEROS
 11694         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 11695
 11696     IF BBIRTHL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 218
* EL6311.cbl
 11697         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 11698
 11699     IF BSEXL GREATER THAN ZEROS
 11700         MOVE  BSEXI             TO PM-INSURED-SEX.
 11701
 11702
 11703* EXEC CICS REWRITE
 11704*        DATASET (FILE-ID-ERPNDM)
 11705*        FROM    (PENDING-MAILING-DATA)
 11706*    END-EXEC.
 11707     MOVE LENGTH OF
 11708      PENDING-MAILING-DATA
 11709       TO DFHEIV11
 11710*    MOVE '&& L                  %   #00011160' TO DFHEIV0
 11711     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11712     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11713     MOVE X'2020233030303131313630' TO DFHEIV0(25:11)
 11714     CALL 'kxdfhei1' USING DFHEIV0,
 11715           FILE-ID-ERPNDM,
 11716           PENDING-MAILING-DATA,
 11717           DFHEIV11,
 11718           DFHEIV99
 11719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11720
 11721
 11722 1399-EXIT.
 11723     EXIT.
 11724
 11725******************************************************************
 11726*                                                                *
 11727*          D E L E T E   I S S U E   R O U T I N E               *
 11728*                                                                *
 11729******************************************************************
 11730
 11731 1400-DELETE-ISSUE-ROUTINE.
 11732     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 11733
 11734     IF BCHGL NOT = ZEROS
 11735        MOVE ER-2196             TO EMI-ERROR
 11736        MOVE AL-UABON            TO BMAINTA
 11737        MOVE -1                  TO BMAINTL
 11738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11739        GO TO 8200-SEND-DATAONLY.
 11740
 11741
 11742* EXEC CICS HANDLE CONDITION
 11743*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 11744*    END-EXEC.
 11745*    MOVE '"$I                   ! ( #00011184' TO DFHEIV0
 11746     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11747     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11748     MOVE X'2820233030303131313834' TO DFHEIV0(25:11)
 11749     CALL 'kxdfhei1' USING DFHEIV0
 11750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11751
 11752
 11753     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11754     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 219
* EL6311.cbl
 11755     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11756
 11757
 11758* EXEC CICS READ
 11759*        SET     (ADDRESS OF PENDING-BUSINESS)
 11760*        DATASET (FILE-ID-ERPNDB)
 11761*        RIDFLD  (ERPNDB-KEY)
 11762*    END-EXEC.
 11763*    MOVE '&"S        E          (   #00011192' TO DFHEIV0
 11764     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11765     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11766     MOVE X'2020233030303131313932' TO DFHEIV0(25:11)
 11767     CALL 'kxdfhei1' USING DFHEIV0,
 11768           FILE-ID-ERPNDB,
 11769           DFHEIV20,
 11770           DFHEIV99,
 11771           ERPNDB-KEY,
 11772           DFHEIV99,
 11773           DFHEIV99,
 11774           DFHEIV99
 11775     SET ADDRESS OF PENDING-BUSINESS TO
 11776         DFHEIV20
 11777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11778
 11779
 11780     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11781
 11782     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11783
 11784     IF BSUFIXL NOT = ZEROS
 11785        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11786     ELSE
 11787        MOVE SPACE               TO WS-NEW-SUFFIX.
 11788
 11789     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11790     PERFORM 8600-DEEDIT.
 11791     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11792     MOVE '4'                    TO DC-OPTION-CODE.
 11793     PERFORM 9700-DATE-LINK.
 11794     IF DATE-CONVERSION-ERROR
 11795        MOVE ER-0348             TO EMI-ERROR
 11796        MOVE -1                  TO BEFFDTL
 11797        MOVE AL-UABON            TO BEFFDTA
 11798        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11799        GO TO 8200-SEND-DATAONLY
 11800     ELSE
 11801        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11802        MOVE AL-UANON            TO BEFFDTA
 11803        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11804
 11805
 11806* EXEC CICS HANDLE CONDITION
 11807*         NOTFND    (1490-RECORD-NOT-FOUND)
 11808*    END-EXEC.
 11809*    MOVE '"$I                   ! ) #00011223' TO DFHEIV0
 11810     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11811     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11812     MOVE X'2920233030303131323233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 220
* EL6311.cbl
 11813     CALL 'kxdfhei1' USING DFHEIV0
 11814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11815
 11816
 11817
 11818* EXEC CICS READ
 11819*        SET     (ADDRESS OF PENDING-BUSINESS)
 11820*        DATASET (FILE-ID-ERPNDB)
 11821*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11822*        UPDATE
 11823*    END-EXEC.
 11824*    MOVE '&"S        EU         (   #00011227' TO DFHEIV0
 11825     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11826     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11827     MOVE X'2020233030303131323237' TO DFHEIV0(25:11)
 11828     CALL 'kxdfhei1' USING DFHEIV0,
 11829           FILE-ID-ERPNDB,
 11830           DFHEIV20,
 11831           DFHEIV99,
 11832           PI-PREV-CONTROL-PRIMARY,
 11833           DFHEIV99,
 11834           DFHEIV99,
 11835           DFHEIV99
 11836     SET ADDRESS OF PENDING-BUSINESS TO
 11837         DFHEIV20
 11838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11839
 11840
 11841     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11842        MOVE -1                 TO BMAINTL
 11843        MOVE ER-2197            TO EMI-ERROR
 11844        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11845        GO TO 8200-SEND-DATAONLY.
 11846
 11847     IF PB-BILLED-DT NOT = LOW-VALUES
 11848        MOVE -1                 TO BMAINTL
 11849        MOVE ER-2129            TO EMI-ERROR
 11850        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11851        GO TO 8200-SEND-DATAONLY.
 11852
 11853     IF PB-CHG-COUNT NOT = ZEROS
 11854        MOVE ER-2336            TO EMI-ERROR
 11855        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11856        MOVE AL-UABON            TO BMAINTA
 11857        MOVE -1                  TO BMAINTL
 11858        GO TO 8200-SEND-DATAONLY.
 11859
 11860     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 11861        PB-CHG-COUNT NOT = ZEROS
 11862        MOVE ER-2196             TO EMI-ERROR
 11863        MOVE AL-UABON            TO BMAINTA
 11864        MOVE -1                  TO BMAINTL
 11865        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11866        GO TO 8200-SEND-DATAONLY.
 11867******************************************************************
 11868*                                                                *
 11869*       DELETE ORIGINAL CERTIFICATE INFO                         *
 11870*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 221
* EL6311.cbl
 11871******************************************************************
 11872     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 11873     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11874     MOVE +0                     TO ELCRTO-SEQ-NO
 11875
 11876* EXEC CICS READ
 11877*       DATASET   ('ELCRTO')
 11878*       INTO      (ORIGINAL-CERTIFICATE)
 11879*       RIDFLD    (ELCRTO-KEY)
 11880*       GTEQ
 11881*       RESP      (WS-RESPONSE)
 11882*    END-EXEC
 11883     MOVE LENGTH OF
 11884      ORIGINAL-CERTIFICATE
 11885       TO DFHEIV11
 11886     MOVE 'ELCRTO' TO DFHEIV1
 11887*    MOVE '&"IL       G          (  N#00011268' TO DFHEIV0
 11888     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11889     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11890     MOVE X'204E233030303131323638' TO DFHEIV0(25:11)
 11891     CALL 'kxdfhei1' USING DFHEIV0,
 11892           DFHEIV1,
 11893           ORIGINAL-CERTIFICATE,
 11894           DFHEIV11,
 11895           ELCRTO-KEY,
 11896           DFHEIV99,
 11897           DFHEIV99,
 11898           DFHEIV99
 11899     MOVE EIBRESP  TO WS-RESPONSE
 11900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11901     IF RESP-NORMAL
 11902        AND (OC-CONTROL-PRIMARY (1:33) =
 11903                 PB-CONTROL-BY-ACCOUNT (1:33))
 11904        AND (OC-RECORD-TYPE = 'I')
 11905
 11906* EXEC CICS READ
 11907*          DATASET   ('ELCRTO')
 11908*          INTO      (ORIGINAL-CERTIFICATE)
 11909*          RIDFLD    (ELCRTO-KEY)
 11910*          UPDATE
 11911*          RESP      (WS-RESPONSE)
 11912*       END-EXEC
 11913     MOVE LENGTH OF
 11914      ORIGINAL-CERTIFICATE
 11915       TO DFHEIV11
 11916     MOVE 'ELCRTO' TO DFHEIV1
 11917*    MOVE '&"IL       EU         (  N#00011279' TO DFHEIV0
 11918     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11919     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11920     MOVE X'204E233030303131323739' TO DFHEIV0(25:11)
 11921     CALL 'kxdfhei1' USING DFHEIV0,
 11922           DFHEIV1,
 11923           ORIGINAL-CERTIFICATE,
 11924           DFHEIV11,
 11925           ELCRTO-KEY,
 11926           DFHEIV99,
 11927           DFHEIV99,
 11928           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 222
* EL6311.cbl
 11929     MOVE EIBRESP  TO WS-RESPONSE
 11930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11931        IF RESP-NORMAL
 11932
 11933* EXEC CICS DELETE
 11934*             DATASET   ('ELCRTO')
 11935*          END-EXEC
 11936     MOVE 'ELCRTO' TO DFHEIV1
 11937*    MOVE '&(                    &   #00011287' TO DFHEIV0
 11938     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11939     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11940     MOVE X'2020233030303131323837' TO DFHEIV0(25:11)
 11941     CALL 'kxdfhei1' USING DFHEIV0,
 11942           DFHEIV1,
 11943           DFHEIV99,
 11944           DFHEIV99,
 11945           DFHEIV99,
 11946           DFHEIV99
 11947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11948        END-IF
 11949     END-IF
 11950******************************************************************
 11951*                                                                *
 11952*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 11953*                                                                *
 11954******************************************************************
 11955
 11956* EXEC CICS HANDLE CONDITION
 11957*        NOTFND    (1405-DELETE-CERTIFICATE)
 11958*    END-EXEC.
 11959*    MOVE '"$I                   ! * #00011297' TO DFHEIV0
 11960     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11961     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11962     MOVE X'2A20233030303131323937' TO DFHEIV0(25:11)
 11963     CALL 'kxdfhei1' USING DFHEIV0
 11964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11965
 11966
 11967
 11968* EXEC CICS READ
 11969*        EQUAL
 11970*        DATASET   (FILE-ID-ERPNDM)
 11971*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 11972*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 11973*        UPDATE
 11974*    END-EXEC.
 11975*    MOVE '&"S        EU         (   #00011301' TO DFHEIV0
 11976     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11977     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11978     MOVE X'2020233030303131333031' TO DFHEIV0(25:11)
 11979     CALL 'kxdfhei1' USING DFHEIV0,
 11980           FILE-ID-ERPNDM,
 11981           DFHEIV20,
 11982           DFHEIV99,
 11983           PI-PREV-CONTROL-PRIMARY,
 11984           DFHEIV99,
 11985           DFHEIV99,
 11986           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 223
* EL6311.cbl
 11987     SET ADDRESS OF PENDING-MAILING-DATA TO
 11988         DFHEIV20
 11989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11990
 11991
 11992     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 11993     MOVE 'D'                    TO  JP-RECORD-TYPE.
 11994     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 11995
 11996     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11997
 11998
 11999* EXEC CICS DELETE
 12000*        DATASET   (FILE-ID-ERPNDM)
 12001*    END-EXEC.
 12002*    MOVE '&(                    &   #00011315' TO DFHEIV0
 12003     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12004     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12005     MOVE X'2020233030303131333135' TO DFHEIV0(25:11)
 12006     CALL 'kxdfhei1' USING DFHEIV0,
 12007           FILE-ID-ERPNDM,
 12008           DFHEIV99,
 12009           DFHEIV99,
 12010           DFHEIV99,
 12011           DFHEIV99
 12012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12013
 12014
 12015******************************************************************
 12016*                PROCESS   CERTIFICATE                           *
 12017******************************************************************
 12018
 12019 1405-DELETE-CERTIFICATE.
 12020
 12021* EXEC CICS HANDLE CONDITION
 12022*         NOTFND  (1420-CONTINUE-DELETE)
 12023*    END-EXEC.
 12024*    MOVE '"$I                   ! + #00011324' TO DFHEIV0
 12025     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12026     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12027     MOVE X'2B20233030303131333234' TO DFHEIV0(25:11)
 12028     CALL 'kxdfhei1' USING DFHEIV0
 12029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12030
 12031
 12032     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12033     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12034     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12035     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12036
 12037
 12038* EXEC CICS READ
 12039*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12040*        DATASET (FILE-ID-ELCERT)
 12041*        RIDFLD  (ELCERT-KEY)
 12042*        UPDATE
 12043*    END-EXEC.
 12044*    MOVE '&"S        EU         (   #00011333' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 224
* EL6311.cbl
 12045     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12046     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12047     MOVE X'2020233030303131333333' TO DFHEIV0(25:11)
 12048     CALL 'kxdfhei1' USING DFHEIV0,
 12049           FILE-ID-ELCERT,
 12050           DFHEIV20,
 12051           DFHEIV99,
 12052           ELCERT-KEY,
 12053           DFHEIV99,
 12054           DFHEIV99,
 12055           DFHEIV99
 12056     SET ADDRESS OF CERTIFICATE-MASTER TO
 12057         DFHEIV20
 12058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12059
 12060
 12061     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12062
 12063     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12064     MOVE 'B'                    TO JP-RECORD-TYPE
 12065     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12066
 12067     PERFORM 8400-LOG-JOURNAL-RECORD.
 12068
 12069     IF CERT-NOTES-ARE-NOT-PRESENT
 12070        MOVE ' '                 TO WS-CERT-NOTE-SW
 12071     ELSE
 12072        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12073
 12074     IF INSURED-ADDR-PRESENT
 12075        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12076
 12077******************************************************************
 12078******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12079******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12080******************************************************************
 12081******************************************************************
 12082
 12083     IF CERT-ADDED-BATCH AND
 12084        (NOT NO-CLAIM-ATTACHED
 12085         OR
 12086         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12087        GO TO 1410-REWRITE-CERT.
 12088
 12089******************************************************************
 12090******************************************************************
 12091
 12092     IF CERT-ADDED-BATCH  AND
 12093        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12094        GO TO 1410-REWRITE-CERT.
 12095
 12096     IF NO-CLAIM-ATTACHED
 12097        NEXT SENTENCE
 12098     ELSE
 12099        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12100        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12101        GO TO 1410-REWRITE-CERT.
 12102
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 225
* EL6311.cbl
 12103     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12104     MOVE 'D'                      TO JP-RECORD-TYPE.
 12105     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12106
 12107
 12108* EXEC CICS DELETE
 12109*         DATASET    (FILE-ID-ELCERT)
 12110*    END-EXEC.
 12111*    MOVE '&(                    &   #00011386' TO DFHEIV0
 12112     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12113     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12114     MOVE X'2020233030303131333836' TO DFHEIV0(25:11)
 12115     CALL 'kxdfhei1' USING DFHEIV0,
 12116           FILE-ID-ELCERT,
 12117           DFHEIV99,
 12118           DFHEIV99,
 12119           DFHEIV99,
 12120           DFHEIV99
 12121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12122
 12123
 12124     PERFORM 8400-LOG-JOURNAL-RECORD.
 12125
 12126******************************************************************
 12127*                                                                *
 12128*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12129*                                                                *
 12130******************************************************************
 12131
 12132     IF  CERT-NOTES-ARE-PRESENT
 12133         NEXT SENTENCE
 12134     ELSE
 12135         GO TO 1407-DELETE-MAILING.
 12136
 12137
 12138* EXEC CICS HANDLE CONDITION
 12139*         NOTFND  (1406-DELETE-ERNOTE)
 12140*    END-EXEC.
 12141*    MOVE '"$I                   ! , #00011403' TO DFHEIV0
 12142     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12144     MOVE X'2C20233030303131343033' TO DFHEIV0(25:11)
 12145     CALL 'kxdfhei1' USING DFHEIV0
 12146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12147
 12148
 12149     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12150     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12151     MOVE 0                     TO ERCNOT-SEQUENCE.
 12152
 12153 1406-DELETE-ERCNOT-LOOP.
 12154
 12155
 12156* EXEC CICS READ
 12157*        GTEQ
 12158*        DATASET   (FILE-ID-ERCNOT)
 12159*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12160*        RIDFLD    (ERCNOT-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 226
* EL6311.cbl
 12161*    END-EXEC.
 12162*    MOVE '&"S        G          (   #00011413' TO DFHEIV0
 12163     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12165     MOVE X'2020233030303131343133' TO DFHEIV0(25:11)
 12166     CALL 'kxdfhei1' USING DFHEIV0,
 12167           FILE-ID-ERCNOT,
 12168           DFHEIV20,
 12169           DFHEIV99,
 12170           ERCNOT-KEY,
 12171           DFHEIV99,
 12172           DFHEIV99,
 12173           DFHEIV99
 12174     SET ADDRESS OF CERT-NOTE-FILE TO
 12175         DFHEIV20
 12176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12177
 12178
 12179     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12180     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12181         GO TO 1406-DELETE-ERNOTE
 12182     END-IF.
 12183
 12184     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12185     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12186     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12187
 12188     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12189
 12190
 12191* EXEC CICS DELETE
 12192*        DATASET   (FILE-ID-ERCNOT)
 12193*        RIDFLD    (ERCNOT-KEY)
 12194*        END-EXEC.
 12195*    MOVE '&(  R                 &   #00011431' TO DFHEIV0
 12196     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12197     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12198     MOVE X'2020233030303131343331' TO DFHEIV0(25:11)
 12199     CALL 'kxdfhei1' USING DFHEIV0,
 12200           FILE-ID-ERCNOT,
 12201           ERCNOT-KEY,
 12202           DFHEIV99,
 12203           DFHEIV99,
 12204           DFHEIV99
 12205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12206
 12207
 12208     PERFORM 8400-LOG-JOURNAL-RECORD.
 12209
 12210     GO TO 1406-DELETE-ERCNOT-LOOP.
 12211
 12212 1406-DELETE-ERNOTE.
 12213
 12214
 12215* EXEC CICS HANDLE CONDITION
 12216*         NOTFND  (1407-DELETE-MAILING)
 12217*    END-EXEC.
 12218*    MOVE '"$I                   ! - #00011442' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 227
* EL6311.cbl
 12219     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12220     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12221     MOVE X'2D20233030303131343432' TO DFHEIV0(25:11)
 12222     CALL 'kxdfhei1' USING DFHEIV0
 12223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12224
 12225
 12226
 12227* EXEC CICS READ
 12228*        EQUAL
 12229*        DATASET   (FILE-ID-ERNOTE)
 12230*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12231*        RIDFLD    (ELCERT-KEY)
 12232*        UPDATE
 12233*    END-EXEC.
 12234*    MOVE '&"S        EU         (   #00011446' TO DFHEIV0
 12235     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12236     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12237     MOVE X'2020233030303131343436' TO DFHEIV0(25:11)
 12238     CALL 'kxdfhei1' USING DFHEIV0,
 12239           FILE-ID-ERNOTE,
 12240           DFHEIV20,
 12241           DFHEIV99,
 12242           ELCERT-KEY,
 12243           DFHEIV99,
 12244           DFHEIV99,
 12245           DFHEIV99
 12246     SET ADDRESS OF CERTIFICATE-NOTE TO
 12247         DFHEIV20
 12248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12249
 12250
 12251     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12252     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12253     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12254
 12255     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12256
 12257
 12258* EXEC CICS DELETE
 12259*        DATASET   (FILE-ID-ERNOTE)
 12260*        END-EXEC.
 12261*    MOVE '&(                    &   #00011460' TO DFHEIV0
 12262     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12263     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12264     MOVE X'2020233030303131343630' TO DFHEIV0(25:11)
 12265     CALL 'kxdfhei1' USING DFHEIV0,
 12266           FILE-ID-ERNOTE,
 12267           DFHEIV99,
 12268           DFHEIV99,
 12269           DFHEIV99,
 12270           DFHEIV99
 12271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12272
 12273
 12274     PERFORM 8400-LOG-JOURNAL-RECORD.
 12275
 12276******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 228
* EL6311.cbl
 12277*                                                                *
 12278*                DELETE MAILING ADDRESS RECORDS                  *
 12279*                                                                *
 12280******************************************************************
 12281
 12282 1407-DELETE-MAILING.
 12283     IF CERT-ADDRESS-PRESENT
 12284        NEXT SENTENCE
 12285     ELSE
 12286        GO TO 1420-CONTINUE-DELETE.
 12287
 12288
 12289* EXEC CICS HANDLE CONDITION
 12290*         NOTFND  (1420-CONTINUE-DELETE)
 12291*    END-EXEC.
 12292*    MOVE '"$I                   ! . #00011478' TO DFHEIV0
 12293     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12294     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12295     MOVE X'2E20233030303131343738' TO DFHEIV0(25:11)
 12296     CALL 'kxdfhei1' USING DFHEIV0
 12297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12298
 12299
 12300
 12301* EXEC CICS READ
 12302*        EQUAL
 12303*        DATASET   (FILE-ID-ERMAIL)
 12304*        SET       (ADDRESS OF MAILING-DATA)
 12305*        RIDFLD    (ELCERT-KEY)
 12306*        UPDATE
 12307*    END-EXEC.
 12308*    MOVE '&"S        EU         (   #00011482' TO DFHEIV0
 12309     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12310     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12311     MOVE X'2020233030303131343832' TO DFHEIV0(25:11)
 12312     CALL 'kxdfhei1' USING DFHEIV0,
 12313           FILE-ID-ERMAIL,
 12314           DFHEIV20,
 12315           DFHEIV99,
 12316           ELCERT-KEY,
 12317           DFHEIV99,
 12318           DFHEIV99,
 12319           DFHEIV99
 12320     SET ADDRESS OF MAILING-DATA TO
 12321         DFHEIV20
 12322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12323
 12324
 12325     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12326     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12327     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12328
 12329     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12330
 12331
 12332* EXEC CICS DELETE
 12333*        DATASET   (FILE-ID-ERMAIL)
 12334*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 229
* EL6311.cbl
 12335*    MOVE '&(                    &   #00011496' TO DFHEIV0
 12336     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12337     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12338     MOVE X'2020233030303131343936' TO DFHEIV0(25:11)
 12339     CALL 'kxdfhei1' USING DFHEIV0,
 12340           FILE-ID-ERMAIL,
 12341           DFHEIV99,
 12342           DFHEIV99,
 12343           DFHEIV99,
 12344           DFHEIV99
 12345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12346
 12347
 12348     GO TO 1420-CONTINUE-DELETE.
 12349
 12350 1410-REWRITE-CERT.
 12351     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12352     MOVE 'C'                      TO JP-RECORD-TYPE.
 12353     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12354     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12355
 12356
 12357* EXEC CICS REWRITE
 12358*         DATASET    (FILE-ID-ELCERT)
 12359*         FROM       (CERTIFICATE-MASTER)
 12360*         END-EXEC.
 12361     MOVE LENGTH OF
 12362      CERTIFICATE-MASTER
 12363       TO DFHEIV11
 12364*    MOVE '&& L                  %   #00011508' TO DFHEIV0
 12365     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12366     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12367     MOVE X'2020233030303131353038' TO DFHEIV0(25:11)
 12368     CALL 'kxdfhei1' USING DFHEIV0,
 12369           FILE-ID-ELCERT,
 12370           CERTIFICATE-MASTER,
 12371           DFHEIV11,
 12372           DFHEIV99
 12373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12374
 12375
 12376     PERFORM 8400-LOG-JOURNAL-RECORD.
 12377
 12378 1420-CONTINUE-DELETE.
 12379     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12380     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12381
 12382     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12383     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12384
 12385     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12386
 12387 1450-DELETE-PB-RECORD.
 12388     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12389     MOVE 'D'                      TO JP-RECORD-TYPE
 12390     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12391
 12392
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 230
* EL6311.cbl
 12393* EXEC CICS DELETE
 12394*        DATASET    (FILE-ID-ERPNDB)
 12395*    END-EXEC.
 12396*    MOVE '&(                    &   #00011529' TO DFHEIV0
 12397     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12398     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12399     MOVE X'2020233030303131353239' TO DFHEIV0(25:11)
 12400     CALL 'kxdfhei1' USING DFHEIV0,
 12401           FILE-ID-ERPNDB,
 12402           DFHEIV99,
 12403           DFHEIV99,
 12404           DFHEIV99,
 12405           DFHEIV99
 12406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12407
 12408
 12409     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12410
 12411     PERFORM 8400-LOG-JOURNAL-RECORD.
 12412
 12413     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12414     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12415     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12416
 12417
 12418* EXEC CICS HANDLE CONDITION
 12419*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12420*    END-EXEC.
 12421*    MOVE '"$I                   ! / #00011541' TO DFHEIV0
 12422     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12424     MOVE X'2F20233030303131353431' TO DFHEIV0(25:11)
 12425     CALL 'kxdfhei1' USING DFHEIV0
 12426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12427
 12428
 12429
 12430* EXEC CICS READ
 12431*        SET     (ADDRESS OF PENDING-BUSINESS)
 12432*        DATASET (FILE-ID-ERPNDB)
 12433*        RIDFLD  (ERPNDB-KEY)
 12434*        UPDATE
 12435*    END-EXEC.
 12436*    MOVE '&"S        EU         (   #00011545' TO DFHEIV0
 12437     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12438     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12439     MOVE X'2020233030303131353435' TO DFHEIV0(25:11)
 12440     CALL 'kxdfhei1' USING DFHEIV0,
 12441           FILE-ID-ERPNDB,
 12442           DFHEIV20,
 12443           DFHEIV99,
 12444           ERPNDB-KEY,
 12445           DFHEIV99,
 12446           DFHEIV99,
 12447           DFHEIV99
 12448     SET ADDRESS OF PENDING-BUSINESS TO
 12449         DFHEIV20
 12450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 231
* EL6311.cbl
 12451
 12452
 12453     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12454
 12455     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12456
 12457     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12458        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12459        MOVE 'D'                   TO JP-RECORD-TYPE
 12460        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12461
 12462* EXEC CICS DELETE
 12463*            DATASET    (FILE-ID-ERPNDB)
 12464*       END-EXEC
 12465*    MOVE '&(                    &   #00011560' TO DFHEIV0
 12466     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12467     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12468     MOVE X'2020233030303131353630' TO DFHEIV0(25:11)
 12469     CALL 'kxdfhei1' USING DFHEIV0,
 12470           FILE-ID-ERPNDB,
 12471           DFHEIV99,
 12472           DFHEIV99,
 12473           DFHEIV99,
 12474           DFHEIV99
 12475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12476        PERFORM 8400-LOG-JOURNAL-RECORD
 12477     ELSE
 12478        MOVE 'B'                 TO JP-RECORD-TYPE
 12479        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12480        PERFORM 8400-LOG-JOURNAL-RECORD
 12481        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 12482        MOVE 'C'                 TO JP-RECORD-TYPE
 12483        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12484
 12485* EXEC CICS REWRITE
 12486*            DATASET    (FILE-ID-ERPNDB)
 12487*            FROM       (PENDING-BUSINESS)
 12488*       END-EXEC
 12489     MOVE LENGTH OF
 12490      PENDING-BUSINESS
 12491       TO DFHEIV11
 12492*    MOVE '&& L                  %   #00011571' TO DFHEIV0
 12493     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12494     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12495     MOVE X'2020233030303131353731' TO DFHEIV0(25:11)
 12496     CALL 'kxdfhei1' USING DFHEIV0,
 12497           FILE-ID-ERPNDB,
 12498           PENDING-BUSINESS,
 12499           DFHEIV11,
 12500           DFHEIV99
 12501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12502        PERFORM 8400-LOG-JOURNAL-RECORD.
 12503
 12504******************************************************************
 12505*                                                                *
 12506*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 12507*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 12508*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 232
* EL6311.cbl
 12509******************************************************************
 12510
 12511     IF NOT PI-AR-PROCESSING
 12512        GO TO 1475-DELETE-FINISHED.
 12513
 12514     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12515        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12516        NEXT SENTENCE
 12517     ELSE
 12518        GO TO 1475-DELETE-FINISHED.
 12519
 12520
 12521* EXEC CICS HANDLE CONDITION
 12522*         NOTFND    (1475-DELETE-FINISHED)
 12523*         END-EXEC.
 12524*    MOVE '"$I                   ! 0 #00011593' TO DFHEIV0
 12525     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12527     MOVE X'3020233030303131353933' TO DFHEIV0(25:11)
 12528     CALL 'kxdfhei1' USING DFHEIV0
 12529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12530
 12531
 12532     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 12533     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 12534
 12535
 12536* EXEC CICS READ
 12537*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 12538*        DATASET (FILE-ID-ERRQST)
 12539*        RIDFLD  (ERRQST-KEY)
 12540*        UPDATE
 12541*    END-EXEC.
 12542*    MOVE '&"S        EU         (   #00011600' TO DFHEIV0
 12543     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12544     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12545     MOVE X'2020233030303131363030' TO DFHEIV0(25:11)
 12546     CALL 'kxdfhei1' USING DFHEIV0,
 12547           FILE-ID-ERRQST,
 12548           DFHEIV20,
 12549           DFHEIV99,
 12550           ERRQST-KEY,
 12551           DFHEIV99,
 12552           DFHEIV99,
 12553           DFHEIV99
 12554     SET ADDRESS OF AR-REQUEST-RECORD TO
 12555         DFHEIV20
 12556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12557
 12558
 12559     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12560
 12561     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 12562
 12563     MOVE 'D'                      TO JP-RECORD-TYPE.
 12564     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 12565
 12566
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 233
* EL6311.cbl
 12567* EXEC CICS DELETE
 12568*         DATASET    (FILE-ID-ERRQST)
 12569*    END-EXEC.
 12570*    MOVE '&(                    &   #00011614' TO DFHEIV0
 12571     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12572     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12573     MOVE X'2020233030303131363134' TO DFHEIV0(25:11)
 12574     CALL 'kxdfhei1' USING DFHEIV0,
 12575           FILE-ID-ERRQST,
 12576           DFHEIV99,
 12577           DFHEIV99,
 12578           DFHEIV99,
 12579           DFHEIV99
 12580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12581
 12582
 12583     PERFORM 8400-LOG-JOURNAL-RECORD.
 12584
 12585 1475-DELETE-FINISHED.
 12586     MOVE ZEROS                  TO EMI-ERROR.
 12587     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12588     MOVE LOW-VALUES             TO EL631BI.
 12589     MOVE -1                     TO BMAINTL.
 12590     GO TO 8100-SEND-INITIAL-MAP.
 12591
 12592 1480-BATCH-HDR-NOT-FOUND.
 12593     MOVE -1                     TO BMAINTL.
 12594     MOVE ER-7450                TO EMI-ERROR.
 12595     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12596     GO TO 8200-SEND-DATAONLY.
 12597
 12598 1490-RECORD-NOT-FOUND.
 12599     MOVE -1                     TO BMAINTL.
 12600     MOVE ER-7451                TO EMI-ERROR.
 12601     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12602     GO TO 8200-SEND-DATAONLY.
 12603
 12604******************************************************************
 12605*            O V E R   C H A R G E   P R O C E S S I N G         *
 12606******************************************************************
 12607 1500-UPDATE-ERNOTE.
 12608     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 12609     MOVE 'A'                    TO WS-NOTE-SW
 12610     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 12611     .
 12612 1500-EXIT.
 12613     EXIT.
 12614 1510-ADD-ERNOTE-REC.
 12615
 12616* EXEC CICS GETMAIN
 12617*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 12618*        LENGTH  (ERNOTE-RECORD-LENGTH)
 12619*        INITIMG (GETMAIN-SPACE)
 12620*    END-EXEC
 12621*    MOVE ',"IL                  $   #00011650' TO DFHEIV0
 12622     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12623     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12624     MOVE X'2020233030303131363530' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 234
* EL6311.cbl
 12625     CALL 'kxdfhei1' USING DFHEIV0,
 12626           DFHEIV20,
 12627           ERNOTE-RECORD-LENGTH,
 12628           GETMAIN-SPACE
 12629     SET ADDRESS OF CERTIFICATE-NOTE TO
 12630         DFHEIV20
 12631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12632     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12633                                 TO ERNOTE-KEY
 12634
 12635* EXEC CICS READ
 12636*       DATASET    (FILE-ID-ERNOTE)
 12637*       RIDFLD     (ERNOTE-KEY)
 12638*       INTO       (CERTIFICATE-NOTE)
 12639*       RESP       (WS-RESPONSE)
 12640*       UPDATE
 12641*    END-EXEC
 12642     MOVE LENGTH OF
 12643      CERTIFICATE-NOTE
 12644       TO DFHEIV11
 12645*    MOVE '&"IL       EU         (  N#00011657' TO DFHEIV0
 12646     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12647     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12648     MOVE X'204E233030303131363537' TO DFHEIV0(25:11)
 12649     CALL 'kxdfhei1' USING DFHEIV0,
 12650           FILE-ID-ERNOTE,
 12651           CERTIFICATE-NOTE,
 12652           DFHEIV11,
 12653           ERNOTE-KEY,
 12654           DFHEIV99,
 12655           DFHEIV99,
 12656           DFHEIV99
 12657     MOVE EIBRESP  TO WS-RESPONSE
 12658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12659     IF RESP-NORMAL
 12660        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 12661           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 12662        END-IF
 12663        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 12664           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 12665        END-IF
 12666        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 12667           (N1 > +10)
 12668           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 12669           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 12670        END-PERFORM
 12671        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 12672          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 12673
 12674* EXEC CICS UNLOCK
 12675*            DATASET    (FILE-ID-ERNOTE)
 12676*          END-EXEC
 12677*    MOVE '&*                    #   #00011678' TO DFHEIV0
 12678     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12679     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12680     MOVE X'2020233030303131363738' TO DFHEIV0(25:11)
 12681     CALL 'kxdfhei1' USING DFHEIV0,
 12682           FILE-ID-ERNOTE,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 235
* EL6311.cbl
 12683           DFHEIV99
 12684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12685        ELSE
 12686          PERFORM VARYING N1 FROM +1 BY +1
 12687           UNTIL (N1 > +10)
 12688           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 12689          END-PERFORM
 12690          IF (N1 < +11)
 12691            IF N1 >= CN-BILLING-START-LINE-NO AND
 12692              N1 <= CN-BILLING-END-LINE-NO
 12693              IF PI-COMPANY-ID = 'DCC'
 12694                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 12695              ELSE
 12696                 MOVE WS-VA-NO-COMM-MESS
 12697                                    TO CN-LINE (N1)
 12698              END-IF
 12699            ELSE
 12700              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 12701               (N1 = (CN-BILLING-END-LINE-NO + +1))
 12702                IF PI-COMPANY-ID = 'DCC'
 12703                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 12704                ELSE
 12705                  MOVE WS-VA-NO-COMM-MESS
 12706                                    TO CN-LINE (N1)
 12707                END-IF
 12708                MOVE N1             TO CN-BILLING-END-LINE-NO
 12709              ELSE
 12710                IF (CN-BILLING-END-LINE-NO = ZEROS)
 12711                  IF PI-COMPANY-ID = 'DCC'
 12712                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 12713                  ELSE
 12714                     MOVE WS-VA-NO-COMM-MESS
 12715                                    TO CN-LINE (N1)
 12716                  END-IF
 12717                  MOVE N1            TO CN-BILLING-END-LINE-NO
 12718                                      CN-BILLING-START-LINE-NO
 12719                ELSE
 12720                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 12721                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 12722                     IF PI-COMPANY-ID = 'DCC'
 12723                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 12724                     ELSE
 12725                       MOVE WS-VA-NO-COMM-MESS
 12726                                    TO CN-LINE (N1)
 12727                     END-IF
 12728                     MOVE N1         TO CN-BILLING-START-LINE-NO
 12729                  ELSE
 12730                     PERFORM 1700-SQUEEZE-IT-IN
 12731                                 THRU 1700-EXIT
 12732                  END-IF
 12733                END-IF
 12734              END-IF
 12735            END-IF
 12736            MOVE 'E631'              TO CN-LAST-MAINT-USER
 12737            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 12738            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12739
 12740* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 236
* EL6311.cbl
 12741*              DATASET    (FILE-ID-ERNOTE)
 12742*              FROM       (CERTIFICATE-NOTE)
 12743*              RESP       (WS-RESPONSE)
 12744*           END-EXEC
 12745     MOVE LENGTH OF
 12746      CERTIFICATE-NOTE
 12747       TO DFHEIV11
 12748*    MOVE '&& L                  %  N#00011735' TO DFHEIV0
 12749     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12750     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12751     MOVE X'204E233030303131373335' TO DFHEIV0(25:11)
 12752     CALL 'kxdfhei1' USING DFHEIV0,
 12753           FILE-ID-ERNOTE,
 12754           CERTIFICATE-NOTE,
 12755           DFHEIV11,
 12756           DFHEIV99
 12757     MOVE EIBRESP  TO WS-RESPONSE
 12758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12759          END-IF
 12760        END-IF
 12761     ELSE
 12762        MOVE SPACES              TO CERTIFICATE-NOTE
 12763        MOVE 'CN'                TO CN-RECORD-ID
 12764        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12765                                 TO CN-CONTROL-PRIMARY
 12766                                    ERNOTE-KEY
 12767        MOVE 01                  TO CN-BILLING-START-LINE-NO
 12768                                    CN-BILLING-END-LINE-NO
 12769        IF PI-COMPANY-ID = 'DCC'
 12770           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 12771        ELSE
 12772           MOVE WS-VA-NO-COMM-MESS
 12773                                 TO CN-LINE (1)
 12774        END-IF
 12775        MOVE 'E631'              TO CN-LAST-MAINT-USER
 12776        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 12777        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12778
 12779* EXEC CICS WRITE
 12780*          DATASET    (FILE-ID-ERNOTE)
 12781*          FROM       (CERTIFICATE-NOTE)
 12782*          RIDFLD     (ERNOTE-KEY)
 12783*          RESP       (WS-RESPONSE)
 12784*       END-EXEC
 12785     MOVE LENGTH OF
 12786      CERTIFICATE-NOTE
 12787       TO DFHEIV11
 12788*    MOVE '&$ L                  ''  N#00011759' TO DFHEIV0
 12789     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12790     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12791     MOVE X'204E233030303131373539' TO DFHEIV0(25:11)
 12792     CALL 'kxdfhei1' USING DFHEIV0,
 12793           FILE-ID-ERNOTE,
 12794           CERTIFICATE-NOTE,
 12795           DFHEIV11,
 12796           ERNOTE-KEY,
 12797           DFHEIV99,
 12798           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 237
* EL6311.cbl
 12799     MOVE EIBRESP  TO WS-RESPONSE
 12800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12801     END-IF
 12802     .
 12803 1510-EXIT.
 12804     EXIT.
 12805 1520-UPDATE-ELCERT.
 12806     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12807                                 TO ELCERT-KEY
 12808
 12809* EXEC CICS READ
 12810*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12811*        DATASET (FILE-ID-ELCERT)
 12812*        RIDFLD  (ELCERT-KEY)
 12813*        UPDATE
 12814*        RESP    (WS-RESPONSE)
 12815*    END-EXEC
 12816*    MOVE '&"S        EU         (  N#00011772' TO DFHEIV0
 12817     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12818     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12819     MOVE X'204E233030303131373732' TO DFHEIV0(25:11)
 12820     CALL 'kxdfhei1' USING DFHEIV0,
 12821           FILE-ID-ELCERT,
 12822           DFHEIV20,
 12823           DFHEIV99,
 12824           ELCERT-KEY,
 12825           DFHEIV99,
 12826           DFHEIV99,
 12827           DFHEIV99
 12828     SET ADDRESS OF CERTIFICATE-MASTER TO
 12829         DFHEIV20
 12830     MOVE EIBRESP  TO WS-RESPONSE
 12831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12832     IF RESP-NORMAL
 12833        IF WS-NOTE-SW = 'A'
 12834           IF CM-NOTE-SW = ' '
 12835              MOVE '2'             TO CM-NOTE-SW
 12836           ELSE
 12837             IF CM-NOTE-SW = '1'
 12838                MOVE '3'           TO CM-NOTE-SW
 12839             ELSE
 12840               IF CM-NOTE-SW = '4'
 12841                  MOVE '6'         TO CM-NOTE-SW
 12842               ELSE
 12843                 IF CM-NOTE-SW = '5'
 12844                    MOVE '7'       TO CM-NOTE-SW
 12845                 END-IF
 12846               END-IF
 12847             END-IF
 12848           END-IF
 12849        ELSE
 12850           IF CM-NOTE-SW = '2'
 12851              MOVE ' '             TO CM-NOTE-SW
 12852           ELSE
 12853             IF CM-NOTE-SW = '3'
 12854                MOVE '1'           TO CM-NOTE-SW
 12855             ELSE
 12856               IF CM-NOTE-SW = '6'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 238
* EL6311.cbl
 12857                  MOVE '4'         TO CM-NOTE-SW
 12858               ELSE
 12859                 IF CM-NOTE-SW = '7'
 12860                    MOVE '5'       TO CM-NOTE-SW
 12861                 END-IF
 12862               END-IF
 12863             END-IF
 12864           END-IF
 12865        END-IF
 12866
 12867* EXEC CICS REWRITE
 12868*          DATASET    (FILE-ID-ELCERT)
 12869*          FROM       (CERTIFICATE-MASTER)
 12870*          RESP       (WS-RESPONSE)
 12871*       END-EXEC
 12872     MOVE LENGTH OF
 12873      CERTIFICATE-MASTER
 12874       TO DFHEIV11
 12875*    MOVE '&& L                  %  N#00011813' TO DFHEIV0
 12876     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12877     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12878     MOVE X'204E233030303131383133' TO DFHEIV0(25:11)
 12879     CALL 'kxdfhei1' USING DFHEIV0,
 12880           FILE-ID-ELCERT,
 12881           CERTIFICATE-MASTER,
 12882           DFHEIV11,
 12883           DFHEIV99
 12884     MOVE EIBRESP  TO WS-RESPONSE
 12885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12886        IF RESP-NORMAL
 12887           CONTINUE
 12888        ELSE
 12889           MOVE WS-RESPONSE TO EMI-ERROR
 12890           PERFORM 9900-ERROR-FORMAT
 12891                                 THRU 9900-EXIT
 12892           GO TO 8200-SEND-DATAONLY
 12893        END-IF
 12894     ELSE
 12895        MOVE -1                  TO BMAINTL
 12896        MOVE 0249                TO EMI-ERROR
 12897        PERFORM 9900-ERROR-FORMAT
 12898                                 THRU 9900-EXIT
 12899        GO TO 8200-SEND-DATAONLY
 12900     END-IF
 12901     .
 12902 1520-EXIT.
 12903     EXIT.
 12904 1600-UPDATE-ERPYAJ.
 12905     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 12906                                 THRU 1610-EXIT
 12907     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 12908                                 THRU 1620-EXIT
 12909     .
 12910 1600-EXIT.
 12911     EXIT.
 12912 1610-ADD-ERPYAJ-BANK-REC.
 12913
 12914* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 239
* EL6311.cbl
 12915*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 12916*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 12917*        INITIMG (GETMAIN-SPACE)
 12918*    END-EXEC
 12919*    MOVE ',"IL                  $   #00011845' TO DFHEIV0
 12920     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12921     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12922     MOVE X'2020233030303131383435' TO DFHEIV0(25:11)
 12923     CALL 'kxdfhei1' USING DFHEIV0,
 12924           DFHEIV20,
 12925           ERPYAJ-RECORD-LENGTH,
 12926           GETMAIN-SPACE
 12927     SET ADDRESS OF PENDING-PAY-ADJ TO
 12928         DFHEIV20
 12929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12930     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 12931     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 12932     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 12933     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 12934     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 12935     MOVE +10                    TO ERPYAJ-SEQ-NO
 12936     MOVE 'R'                    TO ERPYAJ-TYPE
 12937     IF REVERSAL
 12938        MOVE 'C'                 TO ERPYAJ-TYPE
 12939     END-IF
 12940     MOVE SPACES                 TO PENDING-PAY-ADJ
 12941     MOVE 'PY'                   TO PY-RECORD-ID
 12942     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 12943     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 12944     IF REVERSAL
 12945        MOVE PB-I-DCC-OVER-CHG-AMT
 12946                                 TO PY-ENTRY-AMT
 12947     END-IF
 12948     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 12949                                    PY-INPUT-DT
 12950*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 12951*                                   PY-INPUT-DT
 12952     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 12953     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 12954     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 12955     MOVE 'B'                    TO PY-ERCOMP-TYPE
 12956     IF PB-CARRIER = '2'
 12957        MOVE '2725040330'        TO PY-GL-ACCOUNT
 12958     ELSE
 12959        MOVE '2725040130'        TO PY-GL-ACCOUNT
 12960     END-IF
 12961     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 12962                                    PY-BILLED-DATE
 12963                                    PY-AR-DATE
 12964                                    PY-REPORTED-DT
 12965                                    PY-CHECK-WRITTEN-DT
 12966     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 12967                                    PY-CHECK-QUE-SEQUENCE
 12968     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 12969     PERFORM WITH TEST AFTER
 12970        UNTIL (NOT RESP-DUPKEY)
 12971           AND (NOT RESP-DUPREC)
 12972
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 240
* EL6311.cbl
 12973* EXEC CICS WRITE
 12974*          DATASET    (FILE-ID-ERPYAJ)
 12975*          FROM       (PENDING-PAY-ADJ)
 12976*          RIDFLD     (ERPYAJ-KEY)
 12977*          RESP       (WS-RESPONSE)
 12978*       END-EXEC
 12979     MOVE LENGTH OF
 12980      PENDING-PAY-ADJ
 12981       TO DFHEIV11
 12982*    MOVE '&$ L                  ''  N#00011892' TO DFHEIV0
 12983     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12985     MOVE X'204E233030303131383932' TO DFHEIV0(25:11)
 12986     CALL 'kxdfhei1' USING DFHEIV0,
 12987           FILE-ID-ERPYAJ,
 12988           PENDING-PAY-ADJ,
 12989           DFHEIV11,
 12990           ERPYAJ-KEY,
 12991           DFHEIV99,
 12992           DFHEIV99
 12993     MOVE EIBRESP  TO WS-RESPONSE
 12994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12995        IF RESP-DUPKEY OR RESP-DUPREC
 12996           ADD +1                TO ERPYAJ-SEQ-NO
 12997           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 12998        END-IF
 12999     END-PERFORM
 13000     .
 13001 1610-EXIT.
 13002     EXIT.
 13003 1620-ADD-ERPYAJ-DLR-REC.
 13004     MOVE 'C'                    TO ERPYAJ-TYPE
 13005     IF REVERSAL
 13006        MOVE 'R'                 TO ERPYAJ-TYPE
 13007     END-IF
 13008     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13009                                    ERPYAJ-ACCOUNT
 13010     ADD +1                      TO ERPYAJ-SEQ-NO
 13011     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13012     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13013     IF PB-CARRIER = '2'
 13014        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13015     ELSE
 13016        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13017     END-IF
 13018     PERFORM WITH TEST AFTER
 13019        UNTIL (NOT RESP-DUPKEY)
 13020           AND (NOT RESP-DUPREC)
 13021
 13022* EXEC CICS WRITE
 13023*          DATASET    (FILE-ID-ERPYAJ)
 13024*          FROM       (PENDING-PAY-ADJ)
 13025*          RIDFLD     (ERPYAJ-KEY)
 13026*          RESP       (WS-RESPONSE)
 13027*       END-EXEC
 13028     MOVE LENGTH OF
 13029      PENDING-PAY-ADJ
 13030       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 241
* EL6311.cbl
 13031*    MOVE '&$ L                  ''  N#00011924' TO DFHEIV0
 13032     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13033     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13034     MOVE X'204E233030303131393234' TO DFHEIV0(25:11)
 13035     CALL 'kxdfhei1' USING DFHEIV0,
 13036           FILE-ID-ERPYAJ,
 13037           PENDING-PAY-ADJ,
 13038           DFHEIV11,
 13039           ERPYAJ-KEY,
 13040           DFHEIV99,
 13041           DFHEIV99
 13042     MOVE EIBRESP  TO WS-RESPONSE
 13043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13044        IF RESP-DUPKEY OR RESP-DUPREC
 13045           ADD +1                TO ERPYAJ-SEQ-NO
 13046           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13047        END-IF
 13048     END-PERFORM
 13049     .
 13050 1620-EXIT.
 13051     EXIT.
 13052 1700-SQUEEZE-IT-IN.
 13053     IF (N1 > CN-BILLING-END-LINE-NO)
 13054        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13055           N1 = +1
 13056           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13057           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13058              IF PI-COMPANY-ID = 'DCC'
 13059                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13060              ELSE
 13061                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13062              END-IF
 13063              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13064              MOVE +2 TO N1
 13065           END-IF
 13066        END-PERFORM
 13067     ELSE
 13068        IF (N1 < CN-BILLING-START-LINE-NO)
 13069           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13070              N1 = +10
 13071              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13072              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13073                 IF PI-COMPANY-ID = 'DCC'
 13074                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13075                 ELSE
 13076                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13077                 END-IF
 13078                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13079                 MOVE +9 TO N1
 13080              END-IF
 13081           END-PERFORM
 13082        END-IF
 13083     END-IF
 13084     .
 13085 1700-EXIT.
 13086     EXIT.
 13087 1800-REMOVE-CERT-NOTES.
 13088     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 242
* EL6311.cbl
 13089                                 TO ERNOTE-KEY
 13090
 13091* EXEC CICS READ
 13092*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13093*       DATASET    (FILE-ID-ERNOTE)
 13094*       RIDFLD     (ERNOTE-KEY)
 13095*       RESP       (WS-RESPONSE)
 13096*       UPDATE
 13097*    END-EXEC
 13098*    MOVE '&"S        EU         (  N#00011976' TO DFHEIV0
 13099     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13100     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13101     MOVE X'204E233030303131393736' TO DFHEIV0(25:11)
 13102     CALL 'kxdfhei1' USING DFHEIV0,
 13103           FILE-ID-ERNOTE,
 13104           DFHEIV20,
 13105           DFHEIV99,
 13106           ERNOTE-KEY,
 13107           DFHEIV99,
 13108           DFHEIV99,
 13109           DFHEIV99
 13110     SET ADDRESS OF CERTIFICATE-NOTE TO
 13111         DFHEIV20
 13112     MOVE EIBRESP  TO WS-RESPONSE
 13113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13114     IF RESP-NORMAL
 13115        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13116           (N1 > +10)
 13117           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13118           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13119        END-PERFORM
 13120        IF N1 < +11
 13121           MOVE SPACES              TO CN-LINE (N1)
 13122           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13123              N1 <= CN-BILLING-END-LINE-NO
 13124              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13125              IF CN-BILLING-END-LINE-NO <
 13126                               CN-BILLING-START-LINE-NO
 13127                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13128                                     CN-BILLING-START-LINE-NO
 13129              END-IF
 13130              PERFORM 1820-SQUEEZE-ERNOTE
 13131                                  THRU 1820-EXIT
 13132           END-IF
 13133           IF CN-LINES = SPACES
 13134
 13135* EXEC CICS DELETE
 13136*                DATASET    (FILE-ID-ERNOTE)
 13137*                RESP       (WS-RESPONSE)
 13138*             END-EXEC
 13139*    MOVE '&(                    &  N#00012003' TO DFHEIV0
 13140     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13141     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13142     MOVE X'204E233030303132303033' TO DFHEIV0(25:11)
 13143     CALL 'kxdfhei1' USING DFHEIV0,
 13144           FILE-ID-ERNOTE,
 13145           DFHEIV99,
 13146           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 243
* EL6311.cbl
 13147           DFHEIV99,
 13148           DFHEIV99
 13149     MOVE EIBRESP  TO WS-RESPONSE
 13150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13151              IF RESP-NORMAL
 13152                 MOVE 'D'        TO WS-NOTE-SW
 13153                 PERFORM 1520-UPDATE-ELCERT
 13154                                 THRU 1520-EXIT
 13155              END-IF
 13156           ELSE
 13157
 13158* EXEC CICS REWRITE
 13159*                DATASET    (FILE-ID-ERNOTE)
 13160*                FROM       (CERTIFICATE-NOTE)
 13161*                RESP       (WS-RESPONSE)
 13162*             END-EXEC
 13163     MOVE LENGTH OF
 13164      CERTIFICATE-NOTE
 13165       TO DFHEIV11
 13166*    MOVE '&& L                  %  N#00012013' TO DFHEIV0
 13167     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13168     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13169     MOVE X'204E233030303132303133' TO DFHEIV0(25:11)
 13170     CALL 'kxdfhei1' USING DFHEIV0,
 13171           FILE-ID-ERNOTE,
 13172           CERTIFICATE-NOTE,
 13173           DFHEIV11,
 13174           DFHEIV99
 13175     MOVE EIBRESP  TO WS-RESPONSE
 13176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13177           END-IF
 13178        END-IF
 13179     END-IF
 13180     .
 13181 1800-EXIT.
 13182     EXIT.
 13183 1820-SQUEEZE-ERNOTE.
 13184     MOVE CN-BILLING-START-LINE-NO TO N2
 13185     IF N2 = 0
 13186         MOVE +1                 TO N2
 13187     END-IF
 13188     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13189        (N1 > +9)
 13190        IF CN-LINE (N1) = SPACES
 13191           MOVE CN-LINE (N1 + +1)
 13192                                 TO CN-LINE (N1)
 13193           MOVE SPACES           TO CN-LINE (N1 + +1)
 13194        END-IF
 13195     END-PERFORM
 13196     .
 13197 1820-EXIT.
 13198     EXIT.
 13199 1900-DELETE-ERPYAJ.
 13200     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13201     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13202     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13203     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13204     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 244
* EL6311.cbl
 13205     MOVE +10                    TO ERPYAJ-SEQ-NO
 13206     MOVE 'R'                    TO ERPYAJ-TYPE
 13207     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13208
 13209* EXEC CICS STARTBR
 13210*       DATASET    (FILE-ID-ERPYAJ)
 13211*       RIDFLD     (ERPYAJ-KEY)
 13212*       RESP       (WS-RESPONSE)
 13213*    END-EXEC
 13214     MOVE 0
 13215       TO DFHEIV11
 13216*    MOVE '&,         G          &  N#00012049' TO DFHEIV0
 13217     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13218     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13219     MOVE X'204E233030303132303439' TO DFHEIV0(25:11)
 13220     CALL 'kxdfhei1' USING DFHEIV0,
 13221           FILE-ID-ERPYAJ,
 13222           ERPYAJ-KEY,
 13223           DFHEIV99,
 13224           DFHEIV11,
 13225           DFHEIV99
 13226     MOVE EIBRESP  TO WS-RESPONSE
 13227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13228     IF RESP-NORMAL
 13229        CONTINUE
 13230     ELSE
 13231        GO TO 1900-GET-DEALER
 13232     END-IF
 13233     .
 13234 1900-READNEXT-ERPYAJ-B.
 13235*  GET THE BANK ERPYAJ RECORD
 13236
 13237* EXEC CICS READNEXT
 13238*       DATASET    (FILE-ID-ERPYAJ)
 13239*       RIDFLD     (ERPYAJ-KEY)
 13240*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13241*       RESP       (WS-RESPONSE)
 13242*    END-EXEC
 13243     MOVE 0
 13244       TO DFHEIV11
 13245*    MOVE '&.S                   )  N#00012062' TO DFHEIV0
 13246     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13247     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13248     MOVE X'204E233030303132303632' TO DFHEIV0(25:11)
 13249     CALL 'kxdfhei1' USING DFHEIV0,
 13250           FILE-ID-ERPYAJ,
 13251           DFHEIV20,
 13252           DFHEIV99,
 13253           ERPYAJ-KEY,
 13254           DFHEIV99,
 13255           DFHEIV11,
 13256           DFHEIV99,
 13257           DFHEIV99
 13258     SET ADDRESS OF PENDING-PAY-ADJ TO
 13259         DFHEIV20
 13260     MOVE EIBRESP  TO WS-RESPONSE
 13261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13262     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 245
* EL6311.cbl
 13263        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13264           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13265              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13266                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13267
 13268* EXEC CICS READ
 13269*                   DATASET    (FILE-ID-ERPYAJ)
 13270*                   RIDFLD     (ERPYAJ-KEY)
 13271*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13272*                   RESP       (WS-RESPONSE)
 13273*                   UPDATE
 13274*                END-EXEC
 13275*    MOVE '&"S        EU         (  N#00012073' TO DFHEIV0
 13276     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13277     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13278     MOVE X'204E233030303132303733' TO DFHEIV0(25:11)
 13279     CALL 'kxdfhei1' USING DFHEIV0,
 13280           FILE-ID-ERPYAJ,
 13281           DFHEIV20,
 13282           DFHEIV99,
 13283           ERPYAJ-KEY,
 13284           DFHEIV99,
 13285           DFHEIV99,
 13286           DFHEIV99
 13287     SET ADDRESS OF PENDING-PAY-ADJ TO
 13288         DFHEIV20
 13289     MOVE EIBRESP  TO WS-RESPONSE
 13290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13291                 IF RESP-NORMAL
 13292
 13293* EXEC CICS DELETE
 13294*                      DATASET   (FILE-ID-ERPYAJ)
 13295*                      RESP      (WS-RESPONSE)
 13296*                   END-EXEC
 13297*    MOVE '&(                    &  N#00012081' TO DFHEIV0
 13298     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13299     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13300     MOVE X'204E233030303132303831' TO DFHEIV0(25:11)
 13301     CALL 'kxdfhei1' USING DFHEIV0,
 13302           FILE-ID-ERPYAJ,
 13303           DFHEIV99,
 13304           DFHEIV99,
 13305           DFHEIV99,
 13306           DFHEIV99
 13307     MOVE EIBRESP  TO WS-RESPONSE
 13308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13309                 END-IF
 13310              ELSE
 13311                 SET REVERSAL    TO TRUE
 13312                 PERFORM 1600-UPDATE-ERPYAJ
 13313                                 THRU 1600-EXIT
 13314                 GO TO 1900-EXIT
 13315              END-IF
 13316           ELSE
 13317              GO TO 1900-READNEXT-ERPYAJ-B
 13318           END-IF
 13319        END-IF
 13320
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 246
* EL6311.cbl
 13321* EXEC CICS ENDBR
 13322*          DATASET   (FILE-ID-ERPYAJ)
 13323*       END-EXEC
 13324     MOVE 0
 13325       TO DFHEIV11
 13326*    MOVE '&2                    $   #00012096' TO DFHEIV0
 13327     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13328     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13329     MOVE X'2020233030303132303936' TO DFHEIV0(25:11)
 13330     CALL 'kxdfhei1' USING DFHEIV0,
 13331           FILE-ID-ERPYAJ,
 13332           DFHEIV11,
 13333           DFHEIV99
 13334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13335     END-IF
 13336     .
 13337 1900-GET-DEALER.
 13338     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13339     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13340     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13341     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13342     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13343     MOVE +10                    TO ERPYAJ-SEQ-NO
 13344     MOVE 'C'                    TO ERPYAJ-TYPE
 13345     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13346
 13347* EXEC CICS STARTBR
 13348*       DATASET    (FILE-ID-ERPYAJ)
 13349*       RIDFLD     (ERPYAJ-KEY)
 13350*       RESP       (WS-RESPONSE)
 13351*    END-EXEC
 13352     MOVE 0
 13353       TO DFHEIV11
 13354*    MOVE '&,         G          &  N#00012110' TO DFHEIV0
 13355     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13356     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13357     MOVE X'204E233030303132313130' TO DFHEIV0(25:11)
 13358     CALL 'kxdfhei1' USING DFHEIV0,
 13359           FILE-ID-ERPYAJ,
 13360           ERPYAJ-KEY,
 13361           DFHEIV99,
 13362           DFHEIV11,
 13363           DFHEIV99
 13364     MOVE EIBRESP  TO WS-RESPONSE
 13365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13366     IF RESP-NORMAL
 13367        CONTINUE
 13368     ELSE
 13369        GO TO 1900-EXIT
 13370     END-IF
 13371     .
 13372 1900-READNEXT-ERPYAJ-D.
 13373*  GET THE DEALER ERPYAJ RECORD
 13374
 13375* EXEC CICS READNEXT
 13376*       DATASET    (FILE-ID-ERPYAJ)
 13377*       RIDFLD     (ERPYAJ-KEY)
 13378*       SET        (ADDRESS OF PENDING-PAY-ADJ)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 247
* EL6311.cbl
 13379*       RESP       (WS-RESPONSE)
 13380*    END-EXEC
 13381     MOVE 0
 13382       TO DFHEIV11
 13383*    MOVE '&.S                   )  N#00012123' TO DFHEIV0
 13384     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13385     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13386     MOVE X'204E233030303132313233' TO DFHEIV0(25:11)
 13387     CALL 'kxdfhei1' USING DFHEIV0,
 13388           FILE-ID-ERPYAJ,
 13389           DFHEIV20,
 13390           DFHEIV99,
 13391           ERPYAJ-KEY,
 13392           DFHEIV99,
 13393           DFHEIV11,
 13394           DFHEIV99,
 13395           DFHEIV99
 13396     SET ADDRESS OF PENDING-PAY-ADJ TO
 13397         DFHEIV20
 13398     MOVE EIBRESP  TO WS-RESPONSE
 13399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13400     IF RESP-NORMAL
 13401        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13402           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13403              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13404                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13405
 13406* EXEC CICS READ
 13407*                   DATASET    (FILE-ID-ERPYAJ)
 13408*                   RIDFLD     (ERPYAJ-KEY)
 13409*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13410*                   RESP       (WS-RESPONSE)
 13411*                   UPDATE
 13412*                END-EXEC
 13413*    MOVE '&"S        EU         (  N#00012134' TO DFHEIV0
 13414     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13415     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13416     MOVE X'204E233030303132313334' TO DFHEIV0(25:11)
 13417     CALL 'kxdfhei1' USING DFHEIV0,
 13418           FILE-ID-ERPYAJ,
 13419           DFHEIV20,
 13420           DFHEIV99,
 13421           ERPYAJ-KEY,
 13422           DFHEIV99,
 13423           DFHEIV99,
 13424           DFHEIV99
 13425     SET ADDRESS OF PENDING-PAY-ADJ TO
 13426         DFHEIV20
 13427     MOVE EIBRESP  TO WS-RESPONSE
 13428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13429                 IF RESP-NORMAL
 13430
 13431* EXEC CICS DELETE
 13432*                      DATASET   (FILE-ID-ERPYAJ)
 13433*                      RESP      (WS-RESPONSE)
 13434*                   END-EXEC
 13435*    MOVE '&(                    &  N#00012142' TO DFHEIV0
 13436     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 248
* EL6311.cbl
 13437     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13438     MOVE X'204E233030303132313432' TO DFHEIV0(25:11)
 13439     CALL 'kxdfhei1' USING DFHEIV0,
 13440           FILE-ID-ERPYAJ,
 13441           DFHEIV99,
 13442           DFHEIV99,
 13443           DFHEIV99,
 13444           DFHEIV99
 13445     MOVE EIBRESP  TO WS-RESPONSE
 13446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13447                 END-IF
 13448              ELSE
 13449                 SET REVERSAL    TO TRUE
 13450              END-IF
 13451           ELSE
 13452              GO TO 1900-READNEXT-ERPYAJ-D
 13453           END-IF
 13454        END-IF
 13455
 13456* EXEC CICS ENDBR
 13457*          DATASET   (FILE-ID-ERPYAJ)
 13458*       END-EXEC
 13459     MOVE 0
 13460       TO DFHEIV11
 13461*    MOVE '&2                    $   #00012154' TO DFHEIV0
 13462     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13463     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13464     MOVE X'2020233030303132313534' TO DFHEIV0(25:11)
 13465     CALL 'kxdfhei1' USING DFHEIV0,
 13466           FILE-ID-ERPYAJ,
 13467           DFHEIV11,
 13468           DFHEIV99
 13469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13470     END-IF
 13471     .
 13472 1900-EXIT.
 13473     EXIT.
 13474******************************************************************
 13475*            C A N C E L   M A I N L I N E                       *
 13476******************************************************************
 13477
 13478 2000-CANCEL-MAINLINE.
 13479     IF PI-DISPLAY-ORIGINAL-BATCH
 13480        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 13481           MOVE ER-0023             TO EMI-ERROR
 13482           MOVE -1                  TO CMAINTL
 13483           MOVE AL-UABON            TO CMAINTA
 13484           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13485           GO TO 8200-SEND-DATAONLY
 13486        ELSE
 13487           NEXT SENTENCE
 13488     ELSE
 13489        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 13490           MOVE ER-0023             TO EMI-ERROR
 13491           MOVE -1                  TO CMAINTL
 13492           MOVE AL-UABON            TO CMAINTA
 13493           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13494           GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 249
* EL6311.cbl
 13495
 13496     IF CMAINTI = 'S'
 13497        GO TO 2100-SHOW-REQUEST.
 13498
 13499     IF NOT MODIFY-CAP
 13500         MOVE 'UPDATE'       TO SM-READ
 13501         PERFORM 9995-SECURITY-VIOLATION
 13502         MOVE ER-0070        TO EMI-ERROR
 13503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13504         GO TO 8100-SEND-INITIAL-MAP.
 13505
 13506     IF CMAINTL GREATER THAN ZEROS
 13507        IF PI-PF6-FUNCTION
 13508           IF CMAINTI NOT = 'A'
 13509              MOVE AL-UABON  TO CMAINTA
 13510              MOVE -1        TO CMAINTL
 13511              MOVE ER-2260   TO EMI-ERROR
 13512              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13513              GO TO 8200-SEND-DATAONLY.
 13514
 13515     IF CCERTNOL = ZEROS
 13516       AND (CMAINTI = 'C' OR 'K' OR 'D')
 13517         NEXT SENTENCE
 13518     ELSE
 13519         IF CCERTNOL NOT = ZEROS
 13520             MOVE AL-UANON       TO CCERTNOA
 13521         ELSE
 13522             MOVE -1             TO CCERTNOL
 13523             MOVE  1             TO SET-CURSOR-SW
 13524             MOVE ER-2218       TO EMI-ERROR
 13525             MOVE AL-UABON       TO CCERTNOA
 13526             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13527
 13528     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 13529        NEXT SENTENCE
 13530     ELSE
 13531        IF CEFFDTL NOT = ZEROS
 13532           MOVE AL-UNNON         TO CEFFDTA
 13533           MOVE CEFFDTI TO DEEDIT-FIELD
 13534           PERFORM 8600-DEEDIT
 13535           MOVE 4                TO DC-OPTION-CODE
 13536           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13537           PERFORM 9700-DATE-LINK
 13538           IF NO-CONVERSION-ERROR
 13539              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 13540              ELSE
 13541              MOVE -1            TO CEFFDTL
 13542              MOVE  1            TO SET-CURSOR-SW
 13543              MOVE ER-2226      TO EMI-ERROR
 13544              MOVE AL-UNBON      TO CEFFDTA
 13545              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13546          ELSE
 13547          MOVE -1                 TO CEFFDTL
 13548          MOVE  1                 TO SET-CURSOR-SW
 13549          MOVE ER-2220            TO EMI-ERROR
 13550          MOVE AL-UNBON           TO CEFFDTA
 13551          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13552
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 250
* EL6311.cbl
 13553     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 13554
 13555     IF CCERTNOL NOT = ZEROS
 13556        MOVE CCERTNOI                TO WS-NEW-PRIME
 13557     ELSE
 13558        MOVE SPACES                  TO WS-NEW-PRIME.
 13559
 13560     IF CSUFIXL NOT = ZEROS
 13561        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 13562     ELSE
 13563        MOVE SPACE                   TO WS-NEW-SUFFIX.
 13564
 13565     IF CEFFDTL NOT = ZEROS
 13566        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 13567     ELSE
 13568        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 13569
 13570     IF CMAINTI = 'A' OR 'K' OR 'S'
 13571        NEXT SENTENCE
 13572     ELSE
 13573        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 13574        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 13575           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 13576           WS-PB-RECORD-TYPE NOT = '2'
 13577           IF CMAINTI = 'C'
 13578              MOVE ER-2287          TO EMI-ERROR
 13579              MOVE -1               TO CCERTNOL
 13580              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 13581              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13582              GO TO 8200-SEND-DATAONLY
 13583             ELSE
 13584              MOVE ER-2260          TO EMI-ERROR
 13585              MOVE -1               TO CCERTNOL
 13586              MOVE AL-UABON         TO CCERTNOA
 13587              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13588              GO TO 8200-SEND-DATAONLY.
 13589
 13590     IF CMAINTI = 'D'
 13591        GO TO 2400-DELETE-CANCEL-ROUTINE.
 13592
 13593     IF CLSTNML GREATER THAN ZEROS
 13594         MOVE AL-UANON           TO CLSTNMA.
 13595
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 251
* EL6311.cbl
 13597
 13598******************************************************************
 13599*                                                                *
 13600*           E D I T   C A N C E L   C O V E R A G E S            *
 13601*                                                                *
 13602******************************************************************
 13603
 13604 2015-EDIT-COVERAGES.
 13605     IF CCANDT1L      GREATER THAN ZEROS OR
 13606        CREFND1L      GREATER THAN ZEROS OR
 13607        CCANDT2L      GREATER THAN ZEROS OR
 13608        CREFND2L      GREATER THAN ZEROS OR
 13609        CMTHD1L       GREATER THAN ZEROS OR
 13610        CMTHD2L       GREATER THAN ZEROS OR
 13611        CLIVESL       GREATER THAN ZEROS OR
 13612        CPAYEEL       GREATER THAN ZEROS OR
 13613        CFORCEL       GREATER THAN ZEROS OR
 13614        CBILCDL       GREATER THAN ZEROS OR
 13615        CCANREAL      GREATER THAN ZEROS
 13616            NEXT SENTENCE
 13617         ELSE
 13618            GO TO 2030-EDIT-COMPLETE.
 13619
 13620     IF CCANDT1L = ZEROS
 13621        AND (CMAINTI = 'C' OR 'K')
 13622        NEXT SENTENCE
 13623     ELSE
 13624        IF CCANDT1L      GREATER THAN ZEROS
 13625            MOVE AL-UNNON            TO CCANDT1A
 13626            IF CCANDT1I = SPACES
 13627               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 13628            ELSE
 13629               MOVE CCANDT1I            TO DEEDIT-FIELD
 13630               PERFORM 8600-DEEDIT
 13631               IF DEEDIT-FIELD-V0   NUMERIC
 13632                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13633                  MOVE 4                TO DC-OPTION-CODE
 13634                  PERFORM 9700-DATE-LINK
 13635                  IF NO-CONVERSION-ERROR
 13636                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 13637                  ELSE
 13638                      MOVE -1        TO CCANDT1L
 13639                      MOVE ER-2227   TO EMI-ERROR
 13640                      MOVE AL-UNBON  TO CCANDT1A
 13641                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13642               ELSE
 13643                  MOVE -1         TO CCANDT1L
 13644                  MOVE ER-2223    TO EMI-ERROR
 13645                  MOVE AL-UNBON   TO CCANDT1A
 13646                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13647        ELSE
 13648            IF CREFND1L GREATER THAN ZEROS
 13649               MOVE -1             TO CCANDT1L
 13650               MOVE ER-2222        TO EMI-ERROR
 13651               MOVE AL-UNBOF       TO CCANDT1A
 13652               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13653
 13654     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 252
* EL6311.cbl
 13655        AND (CMAINTI = 'C' OR 'K')
 13656         NEXT SENTENCE
 13657     ELSE
 13658         IF CREFND1L NOT = ZEROS
 13659            MOVE AL-UNNON        TO CREFND1A
 13660
 13661* EXEC CICS BIF DEEDIT
 13662*               FIELD  (CREFND1I)
 13663*               LENGTH (11)
 13664*           END-EXEC
 13665     MOVE 11
 13666       TO DFHEIV11
 13667*    MOVE '@"L                   #   #00012347' TO DFHEIV0
 13668     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13669     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13670     MOVE X'2020233030303132333437' TO DFHEIV0(25:11)
 13671     CALL 'kxdfhei1' USING DFHEIV0,
 13672           CREFND1I,
 13673           DFHEIV11
 13674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13675            MOVE CREFND1I        TO WS-CREFND1
 13676*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 13677*           PERFORM 8600-DEEDIT
 13678*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 13679            IF WS-CREFND1  = ZEROS
 13680               AND CMAINTI = 'A'
 13681             MOVE ER-2437        TO EMI-ERROR
 13682             MOVE -1             TO CREFND1L
 13683             MOVE AL-UNBON       TO CREFND1A
 13684             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13685
 13686     IF CCANREAL > +0
 13687        MOVE AL-UANON            TO CCANREAA
 13688        IF CCANREAI = 'R' OR ' '
 13689           CONTINUE
 13690        ELSE
 13691           MOVE ER-9841        TO EMI-ERROR
 13692           MOVE -1             TO CCANREAL
 13693           MOVE AL-UABON       TO CCANREAA
 13694           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13695        END-IF
 13696     END-IF
 13697     IF CMTHD1L EQUAL +0
 13698        NEXT SENTENCE
 13699     ELSE
 13700        IF CMTHD1L NOT = +0
 13701           MOVE AL-UNNON        TO CMTHD1A
 13702           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 13703                         OR '5' OR '6' OR '8' OR '9'
 13704                         OR 'R' OR ' '
 13705              NEXT SENTENCE
 13706           ELSE
 13707              MOVE ER-0582        TO EMI-ERROR
 13708              MOVE -1             TO CMTHD1L
 13709              MOVE AL-UNBON       TO CMTHD1A
 13710              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13711
 13712     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 253
* EL6311.cbl
 13713        AND (CMAINTI = 'C' OR 'K')
 13714         NEXT SENTENCE
 13715     ELSE
 13716         IF CCANDT2L  GREATER THAN ZEROS
 13717             MOVE AL-UNNON       TO CCANDT2A
 13718             IF CCANDT2I = SPACES
 13719                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 13720             ELSE
 13721                MOVE CCANDT2I       TO DEEDIT-FIELD
 13722                PERFORM 8600-DEEDIT
 13723                IF DEEDIT-FIELD-V0   NUMERIC
 13724                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13725                   MOVE 4                TO DC-OPTION-CODE
 13726                   PERFORM 9700-DATE-LINK
 13727                   IF NO-CONVERSION-ERROR
 13728                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 13729                   ELSE
 13730                      MOVE -1       TO CCANDT2L
 13731                      MOVE ER-2227  TO EMI-ERROR
 13732                      MOVE AL-UNBON TO CCANDT2A
 13733                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13734                ELSE
 13735                   MOVE -1         TO CCANDT2L
 13736                   MOVE ER-2223    TO EMI-ERROR
 13737                   MOVE AL-UNBON   TO CCANDT2A
 13738                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13739         ELSE
 13740            IF CREFND2L GREATER THAN ZEROS
 13741               MOVE -1             TO CCANDT2L
 13742               MOVE ER-2222        TO EMI-ERROR
 13743               MOVE AL-UNBOF       TO CCANDT2A
 13744               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13745
 13746     IF CREFND2L = ZEROS
 13747        AND (CMAINTI = 'C' OR 'K')
 13748         NEXT SENTENCE
 13749     ELSE
 13750         IF CREFND2L NOT = ZEROS
 13751            MOVE AL-UNNON        TO CREFND2A
 13752
 13753* EXEC CICS BIF DEEDIT
 13754*               FIELD  (CREFND2I)
 13755*               LENGTH (11)
 13756*           END-EXEC
 13757     MOVE 11
 13758       TO DFHEIV11
 13759*    MOVE '@"L                   #   #00012428' TO DFHEIV0
 13760     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13761     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13762     MOVE X'2020233030303132343238' TO DFHEIV0(25:11)
 13763     CALL 'kxdfhei1' USING DFHEIV0,
 13764           CREFND2I,
 13765           DFHEIV11
 13766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13767            MOVE CREFND2I        TO WS-CREFND2
 13768*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 13769*           PERFORM 8600-DEEDIT
 13770*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 254
* EL6311.cbl
 13771            IF WS-CREFND2  = ZEROS
 13772               AND CMAINTI = 'A'
 13773             MOVE ER-2437        TO EMI-ERROR
 13774             MOVE -1             TO CREFND2L
 13775             MOVE AL-UNBON       TO CREFND2A
 13776             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13777
 13778     IF CMTHD2L EQUAL +0
 13779        NEXT SENTENCE
 13780     ELSE
 13781        IF CMTHD2L NOT = +0
 13782           MOVE AL-UNNON        TO CMTHD2A
 13783           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 13784                         OR '5' OR '6' OR '8' OR '9'
 13785                         OR ' ' OR 'R'
 13786              NEXT SENTENCE
 13787           ELSE
 13788              MOVE ER-0582        TO EMI-ERROR
 13789              MOVE -1             TO CMTHD2L
 13790              MOVE AL-UNBON       TO CMTHD2A
 13791              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13792
 13793     IF CLIVESL GREATER THAN ZEROS
 13794         MOVE CLIVESI            TO DEEDIT-FIELD
 13795         PERFORM 8600-DEEDIT
 13796         IF DEEDIT-FIELD-V0 NUMERIC
 13797             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 13798             MOVE AL-UNNON       TO CLIVESA
 13799         ELSE
 13800             MOVE -1             TO CLIVESL
 13801             MOVE AL-UNBON       TO CLIVESA
 13802             MOVE ER-2223        TO EMI-ERROR
 13803             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13804
 13805     IF CFORCEL  NOT = ZEROS
 13806         IF FORCE-CAP
 13807            MOVE AL-UANON            TO CFORCEA
 13808         ELSE
 13809            MOVE ER-2945             TO EMI-ERROR
 13810            MOVE AL-UABON            TO CFORCEA
 13811            MOVE -1                  TO CFORCEL
 13812            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13813
 13814     IF CPAYEEL GREATER THAN ZEROS
 13815        MOVE AL-UANON            TO CPAYEEA.
 13816
 13817     IF CBILCDL NOT = ZEROS
 13818        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 13819                             AND 'A' AND 'B' AND 'E'
 13820           MOVE ER-2225              TO EMI-ERROR
 13821           MOVE AL-UABON             TO CBILCDA
 13822           MOVE -1                   TO CBILCDL
 13823           MOVE  1                   TO SET-CURSOR-SW
 13824           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13825        ELSE
 13826           MOVE AL-UANON             TO CBILCDA.
 13827
 13828 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 255
* EL6311.cbl
 13829     IF EMI-ERROR = ZEROS
 13830         NEXT SENTENCE
 13831     ELSE
 13832         GO TO 8200-SEND-DATAONLY.
 13833
 13834     IF CMAINTI = 'A'
 13835        GO TO 2200-ADD-CANCEL-ROUTINE.
 13836
 13837     IF CMAINTI = 'C'
 13838        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 13839
 13840     GO TO 2900-REWRITE-CAN-CERT-KEY.
 13841
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 256
* EL6311.cbl
 13843
 13844******************************************************************
 13845*                                                                *
 13846*                   S H O W   C A N C E L                        *
 13847*                                                                *
 13848******************************************************************
 13849
 13850 2100-SHOW-REQUEST.
 13851     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 13852
 13853     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 13854        MOVE -1                  TO CMAINTL
 13855        GO TO 8200-SEND-DATAONLY.
 13856
 13857     MOVE CCERTNOI            TO WS-NEW-PRIME.
 13858
 13859     IF CSUFIXL NOT = ZEROS
 13860        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 13861       ELSE
 13862        MOVE SPACE            TO WS-NEW-SUFFIX.
 13863
 13864     MOVE CEFFDTI                TO DEEDIT-FIELD.
 13865     PERFORM 8600-DEEDIT.
 13866     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 13867     MOVE '4'                    TO DC-OPTION-CODE.
 13868     PERFORM 9700-DATE-LINK.
 13869     IF DATE-CONVERSION-ERROR
 13870        MOVE ER-0348             TO EMI-ERROR
 13871        MOVE -1                  TO CEFFDTL
 13872        MOVE AL-UABON            TO CEFFDTA
 13873        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13874        GO TO 8200-SEND-DATAONLY
 13875     ELSE
 13876        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 13877        MOVE AL-UANON            TO CEFFDTA
 13878        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 13879
 13880     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 13881
 13882     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 13883        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 13884        MOVE 'Y'                    TO WS-SHOW-SW
 13885        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 13886           GO TO 4100-BROWSE-PRIMARY-FORWARD
 13887        ELSE
 13888           IF PI-FILE-BROWSE
 13889              GO TO 4300-BROWSE-FILE-FORWARD
 13890           ELSE
 13891              IF PI-CSR-BROWSE
 13892                 GO TO 4200-BROWSE-CSR-FORWARD
 13893              ELSE
 13894                 GO TO 4000-BROWSE-DETAIL-FORWARD
 13895     ELSE
 13896        GO TO 3900-RE-DISPLAY-RECORD.
 13897
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 257
* EL6311.cbl
 13899
 13900
 13901******************************************************************
 13902*                                                                *
 13903*            A D D   C A N C E L   R O U T I N E                 *
 13904*                                                                *
 13905******************************************************************
 13906
 13907 2200-ADD-CANCEL-ROUTINE.
 13908     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 13909
 13910
 13911* EXEC CICS GETMAIN
 13912*        SET     (ADDRESS OF PENDING-BUSINESS)
 13913*        LENGTH  (ERPNDB-RECORD-LENGTH)
 13914*    END-EXEC.
 13915*    MOVE '," L                  $   #00012575' TO DFHEIV0
 13916     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 13917     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13918     MOVE X'2020233030303132353735' TO DFHEIV0(25:11)
 13919     CALL 'kxdfhei1' USING DFHEIV0,
 13920           DFHEIV20,
 13921           ERPNDB-RECORD-LENGTH,
 13922           DFHEIV99
 13923     SET ADDRESS OF PENDING-BUSINESS TO
 13924         DFHEIV20
 13925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13926
 13927
 13928
 13929* EXEC CICS HANDLE CONDITION
 13930*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 13931*    END-EXEC.
 13932*    MOVE '"$I                   ! 1 #00012580' TO DFHEIV0
 13933     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13935     MOVE X'3120233030303132353830' TO DFHEIV0(25:11)
 13936     CALL 'kxdfhei1' USING DFHEIV0
 13937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13938
 13939
 13940     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 13941     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13942     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13943
 13944
 13945* EXEC CICS READ
 13946*        INTO    (PENDING-BUSINESS)
 13947*        DATASET (FILE-ID-ERPNDB)
 13948*        RIDFLD  (ERPNDB-KEY)
 13949*    END-EXEC.
 13950     MOVE LENGTH OF
 13951      PENDING-BUSINESS
 13952       TO DFHEIV11
 13953*    MOVE '&"IL       E          (   #00012588' TO DFHEIV0
 13954     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13955     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13956     MOVE X'2020233030303132353838' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 258
* EL6311.cbl
 13957     CALL 'kxdfhei1' USING DFHEIV0,
 13958           FILE-ID-ERPNDB,
 13959           PENDING-BUSINESS,
 13960           DFHEIV11,
 13961           ERPNDB-KEY,
 13962           DFHEIV99,
 13963           DFHEIV99,
 13964           DFHEIV99
 13965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13966
 13967
 13968     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 13969
 13970     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 13971     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 13972     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 13973     MOVE SPACES                 TO PENDING-BUSINESS.
 13974     MOVE 'PB'                   TO PB-RECORD-ID.
 13975     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 13976     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 13977     MOVE SPACES                 TO PB-CERT-SFX.
 13978     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 13979     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 13980                                    PB-ALT-CHG-SEQ-NO.
 13981
 13982     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 13983     MOVE CCERTNOI               TO PB-CERT-PRIME.
 13984     MOVE '2'                    TO PB-RECORD-TYPE.
 13985
 13986     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 13987     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 13988
 13989
 13990     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 13991                                    PB-ALT-CHG-SEQ-NO
 13992                                    PB-C-LF-REF-CALC
 13993                                    PB-C-AH-REF-CALC
 13994                                    PB-C-LF-RFND-CLP
 13995                                    PB-C-AH-RFND-CLP
 13996                                    PB-CI-INSURED-AGE
 13997                                    PB-CI-LF-TERM
 13998                                    PB-CI-AH-TERM
 13999                                    PB-CI-LF-BENEFIT-CD
 14000                                    PB-CI-LF-BENEFIT-AMT
 14001                                    PB-CI-LF-ALT-BENEFIT-AMT
 14002                                    PB-CI-LF-PREMIUM-AMT
 14003                                    PB-CI-LF-ALT-PREMIUM-AMT
 14004                                    PB-CI-AH-BENEFIT-CD
 14005                                    PB-CI-AH-BENEFIT-AMT
 14006                                    PB-CI-AH-PREMIUM-AMT
 14007                                    PB-CI-PAY-FREQUENCY
 14008                                    PB-CI-LOAN-APR
 14009                                    PB-CI-LOAN-TERM
 14010                                    PB-CI-LIFE-COMMISSION
 14011                                    PB-CI-AH-COMMISSION
 14012                                    PB-CI-CURR-SEQ
 14013                                    PB-CI-AH-CANCEL-AMT
 14014                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 259
* EL6311.cbl
 14015                                    PB-CI-RATE-DEV-PCT-LF
 14016                                    PB-CI-RATE-DEV-PCT-AH
 14017                                    PB-CI-EXTENTION-DAYS
 14018                                    PB-CI-TERM-IN-DAYS
 14019                                    PB-CI-LIVES
 14020                                    PB-CI-LF-CRIT-PER
 14021                                    PB-CI-AH-CRIT-PER
 14022                                    PB-C-LF-REM-TERM
 14023                                    PB-C-AH-REM-TERM
 14024                                    PB-CHG-COUNT
 14025                                    PB-LF-BILLED-AMTS
 14026                                    PB-AH-BILLED-AMTS
 14027                                    PB-C-NH-INT-ON-REFS
 14028*                                   PB-C-MICROFILM-NO
 14029                                    PB-CALC-TOLERANCE.
 14030
 14031     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14032                                    PB-CI-AH-SETTLEMENT-DT
 14033                                    PB-CI-DEATH-DT
 14034                                    PB-CI-LF-PRIOR-CANCEL-DT
 14035                                    PB-CI-AH-PRIOR-CANCEL-DT
 14036                                    PB-CI-ENTRY-DT
 14037                                    PB-CI-LF-EXPIRE-DT
 14038                                    PB-CI-AH-EXPIRE-DT
 14039                                    PB-CI-LOAN-1ST-PMT-DT
 14040                                    PB-C-LF-CANCEL-DT
 14041                                    PB-C-AH-CANCEL-DT
 14042                                    PB-CREDIT-ACCEPT-DT
 14043                                    PB-BILLED-DT
 14044                                    PB-ACCT-EFF-DT
 14045                                    PB-ACCT-EXP-DT.
 14046
 14047     MOVE 'X'                    TO PB-FATAL-FLAG.
 14048
 14049     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14050
 14051     IF CSUFIXL     GREATER THAN ZEROS
 14052        MOVE CSUFIXI             TO PB-CERT-SFX.
 14053
 14054*    IF CMICRNOL  GREATER  ZEROS
 14055*        IF CMICRNOI  NUMERIC
 14056*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14057*            MOVE AL-UNNON       TO  CMICRNOA
 14058*        ELSE
 14059*            MOVE -1             TO  CMICRNOL
 14060*            MOVE AL-UNBON       TO  CMICRNOA
 14061*            MOVE ER-2701        TO  EMI-ERROR
 14062*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14063
 14064     IF CLSTNML     GREATER THAN ZEROS
 14065        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14066
 14067     IF CCANREAL > ZEROS
 14068        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14069     END-IF
 14070     IF CPCYNL > ZEROS
 14071        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14072     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 260
* EL6311.cbl
 14073     IF CCANDT1L    GREATER THAN ZEROS
 14074        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14075
 14076     IF CCANDT2L    GREATER THAN ZEROS
 14077        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14078
 14079     IF CMTHD1L    GREATER THAN +0
 14080        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14081
 14082     IF CMTHD2L    GREATER THAN +0
 14083        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14084
 14085     IF CREFND1L    GREATER THAN ZEROS
 14086        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14087        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14088     ELSE
 14089        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14090
 14091     IF CREFND2L    GREATER THAN ZEROS
 14092        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14093        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14094     ELSE
 14095        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14096
 14097     IF CLIVESL     GREATER THAN ZEROS
 14098        MOVE WS-CLIVES           TO PB-C-LIVES
 14099     ELSE
 14100        MOVE ZEROS               TO PB-C-LIVES.
 14101
 14102     IF CPAYEEL     GREATER THAN ZEROS
 14103        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14104
 14105     IF CFORCEL     GREATER THAN ZEROS
 14106        MOVE CFORCEI             TO PB-FORCE-CODE.
 14107
 14108     IF CBILCDL     GREATER THAN ZEROS
 14109        MOVE CBILCDI             TO PB-RECORD-BILL.
 14110
 14111*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14112
 14113 2260-WRITE-PB-RECORD.
 14114     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14115                                    PB-INPUT-BY.
 14116     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14117     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14118                                    PB-INPUT-DT.
 14119
 14120     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14121     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14122                                    PB-CONTROL-BY-ORIG-BATCH.
 14123
 14124     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14125     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14126     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14127     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14128     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14129
 14130     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 261
* EL6311.cbl
 14131
 14132     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14133
 14134     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14135     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14136     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14137
 14138     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14139     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14140
 14141 2275-WRITE-PENDING-BUSINESS.
 14142     MOVE 'A'                    TO JP-RECORD-TYPE.
 14143     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14144     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14145     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14146
 14147
 14148* EXEC CICS HANDLE CONDITION
 14149*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14150*    END-EXEC.
 14151*    MOVE '"$%                   ! 2 #00012773' TO DFHEIV0
 14152     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14154     MOVE X'3220233030303132373733' TO DFHEIV0(25:11)
 14155     CALL 'kxdfhei1' USING DFHEIV0
 14156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14157
 14158
 14159
 14160* EXEC CICS WRITE
 14161*        DATASET (FILE-ID-ERPNDB)
 14162*        FROM    (PENDING-BUSINESS)
 14163*        RIDFLD  (PB-CONTROL-PRIMARY)
 14164*    END-EXEC.
 14165     MOVE LENGTH OF
 14166      PENDING-BUSINESS
 14167       TO DFHEIV11
 14168*    MOVE '&$ L                  ''   #00012777' TO DFHEIV0
 14169     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14170     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14171     MOVE X'2020233030303132373737' TO DFHEIV0(25:11)
 14172     CALL 'kxdfhei1' USING DFHEIV0,
 14173           FILE-ID-ERPNDB,
 14174           PENDING-BUSINESS,
 14175           DFHEIV11,
 14176           PB-CONTROL-PRIMARY,
 14177           DFHEIV99,
 14178           DFHEIV99
 14179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14180
 14181
 14182     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14183
 14184     PERFORM 8400-LOG-JOURNAL-RECORD.
 14185
 14186******************************************************************
 14187*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14188******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 262
* EL6311.cbl
 14189
 14190     display ' made it to add orig CANCEL cert '
 14191     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14192     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14193     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14194     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14195
 14196
 14197* EXEC CICS READ
 14198*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14199*        DATASET (FILE-ID-ELCERT)
 14200*        RIDFLD  (ELCERT-KEY)
 14201*        RESP    (WS-RESPONSE)
 14202*    END-EXEC.
 14203*    MOVE '&"S        E          (  N#00012797' TO DFHEIV0
 14204     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14206     MOVE X'204E233030303132373937' TO DFHEIV0(25:11)
 14207     CALL 'kxdfhei1' USING DFHEIV0,
 14208           FILE-ID-ELCERT,
 14209           DFHEIV20,
 14210           DFHEIV99,
 14211           ELCERT-KEY,
 14212           DFHEIV99,
 14213           DFHEIV99,
 14214           DFHEIV99
 14215     SET ADDRESS OF CERTIFICATE-MASTER TO
 14216         DFHEIV20
 14217     MOVE EIBRESP  TO WS-RESPONSE
 14218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14219
 14220
 14221     IF NOT RESP-NORMAL
 14222        GO TO 2276-BYPASS-CRTO
 14223     END-IF
 14224
 14225     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14226     MOVE ' '                    TO WS-ERMAIL-SW
 14227
 14228
 14229* EXEC CICS READ
 14230*       DATASET   (FILE-ID-ERMAIL)
 14231*       SET       (ADDRESS OF MAILING-DATA)
 14232*       RIDFLD    (ERMAIL-KEY)
 14233*       RESP      (WS-RESPONSE)
 14234*    END-EXEC
 14235*    MOVE '&"S        E          (  N#00012811' TO DFHEIV0
 14236     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14237     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14238     MOVE X'204E233030303132383131' TO DFHEIV0(25:11)
 14239     CALL 'kxdfhei1' USING DFHEIV0,
 14240           FILE-ID-ERMAIL,
 14241           DFHEIV20,
 14242           DFHEIV99,
 14243           ERMAIL-KEY,
 14244           DFHEIV99,
 14245           DFHEIV99,
 14246           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 263
* EL6311.cbl
 14247     SET ADDRESS OF MAILING-DATA TO
 14248         DFHEIV20
 14249     MOVE EIBRESP  TO WS-RESPONSE
 14250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14251
 14252     IF RESP-NORMAL
 14253        SET ERMAIL-FOUND TO TRUE
 14254     END-IF
 14255
 14256     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14257     MOVE 'OC'                   TO OC-RECORD-ID
 14258     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14259                                 TO OC-CONTROL-PRIMARY (1:33)
 14260     MOVE 'I'                    TO OC-RECORD-TYPE
 14261     MOVE +4096                  TO OC-KEY-SEQ-NO
 14262     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14263     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14264     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14265
 14266     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14267     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14268     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14269     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14270     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14271     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14272     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14273     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14274     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14275     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14276     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14277     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14278     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14279     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14280     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14281     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14282     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14283     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14284     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14285     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14286     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14287     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14288     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14289     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14290     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14291     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14292     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14293     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14294     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14295     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14296
 14297     IF ERMAIL-FOUND
 14298        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14299     END-IF
 14300     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14301     .
 14302 2275-WRITE-ELCRTO.
 14303
 14304
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 264
* EL6311.cbl
 14305* EXEC CICS WRITE
 14306*       DATASET   ('ELCRTO')
 14307*       FROM      (ORIGINAL-CERTIFICATE)
 14308*       RIDFLD    (OC-CONTROL-PRIMARY)
 14309*       RESP      (WS-RESPONSE)
 14310*    END-EXEC
 14311     MOVE LENGTH OF
 14312      ORIGINAL-CERTIFICATE
 14313       TO DFHEIV11
 14314     MOVE 'ELCRTO' TO DFHEIV1
 14315*    MOVE '&$ L                  ''  N#00012870' TO DFHEIV0
 14316     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14317     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14318     MOVE X'204E233030303132383730' TO DFHEIV0(25:11)
 14319     CALL 'kxdfhei1' USING DFHEIV0,
 14320           DFHEIV1,
 14321           ORIGINAL-CERTIFICATE,
 14322           DFHEIV11,
 14323           OC-CONTROL-PRIMARY,
 14324           DFHEIV99,
 14325           DFHEIV99
 14326     MOVE EIBRESP  TO WS-RESPONSE
 14327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14328
 14329     display ' just wrote 2275 ' ws-response
 14330     IF RESP-DUPKEY
 14331        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14332        GO TO 2275-WRITE-ELCRTO
 14333     ELSE
 14334        IF NOT RESP-NORMAL
 14335           MOVE -1               TO BMAINTL
 14336           MOVE ER-7450          TO EMI-ERROR
 14337           PERFORM 9900-ERROR-FORMAT
 14338                                 THRU 9900-EXIT
 14339           GO TO 8200-SEND-DATAONLY
 14340        END-IF
 14341     END-IF.
 14342
 14343 2276-BYPASS-CRTO.
 14344******************************************************************
 14345*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14346******************************************************************
 14347
 14348
 14349* EXEC CICS READ
 14350*        INTO    (PENDING-BUSINESS)
 14351*        DATASET (FILE-ID-ERPNDB)
 14352*        RIDFLD  (ERPNDB-KEY)
 14353*        UPDATE
 14354*    END-EXEC.
 14355     MOVE LENGTH OF
 14356      PENDING-BUSINESS
 14357       TO DFHEIV11
 14358*    MOVE '&"IL       EU         (   #00012896' TO DFHEIV0
 14359     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14360     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14361     MOVE X'2020233030303132383936' TO DFHEIV0(25:11)
 14362     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 265
* EL6311.cbl
 14363           FILE-ID-ERPNDB,
 14364           PENDING-BUSINESS,
 14365           DFHEIV11,
 14366           ERPNDB-KEY,
 14367           DFHEIV99,
 14368           DFHEIV99,
 14369           DFHEIV99
 14370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14371
 14372
 14373     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14374     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14375     MOVE 'B'                    TO JP-RECORD-TYPE.
 14376     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14377
 14378     PERFORM 8400-LOG-JOURNAL-RECORD.
 14379
 14380     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14381
 14382
 14383* EXEC CICS REWRITE
 14384*        DATASET (FILE-ID-ERPNDB)
 14385*        FROM    (PENDING-BUSINESS)
 14386*    END-EXEC.
 14387     MOVE LENGTH OF
 14388      PENDING-BUSINESS
 14389       TO DFHEIV11
 14390*    MOVE '&& L                  %   #00012912' TO DFHEIV0
 14391     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14392     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14393     MOVE X'2020233030303132393132' TO DFHEIV0(25:11)
 14394     CALL 'kxdfhei1' USING DFHEIV0,
 14395           FILE-ID-ERPNDB,
 14396           PENDING-BUSINESS,
 14397           DFHEIV11,
 14398           DFHEIV99
 14399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14400
 14401
 14402     MOVE 'C'                    TO JP-RECORD-TYPE.
 14403     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14404
 14405     PERFORM 8400-LOG-JOURNAL-RECORD.
 14406
 14407     IF WS-ERRORS-PRESENT
 14408        GO TO 3900-RE-DISPLAY-RECORD.
 14409
 14410     MOVE ZEROS                  TO EMI-ERROR.
 14411     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14412     MOVE LOW-VALUES             TO EL631CI.
 14413     MOVE  -1                    TO CMAINTL.
 14414     GO TO 8100-SEND-INITIAL-MAP.
 14415
 14416 2280-BATCH-HDR-NOT-FOUND.
 14417     MOVE -1                     TO BMAINTL.
 14418     MOVE ER-7450                TO EMI-ERROR.
 14419     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14420     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 266
* EL6311.cbl
 14421
 14422 2290-DUPLICATE-ALT-INDEX.
 14423
 14424******************************************************************
 14425*                                                                *
 14426*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14427*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14428*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14429*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14430*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14431*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14432*                                                                *
 14433******************************************************************
 14434
 14435     IF LCP-ONCTR-02 =  0
 14436         ADD 1 TO LCP-ONCTR-02
 14437        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14438
 14439     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14440
 14441     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14442         NEXT SENTENCE
 14443     ELSE
 14444         ADD +1 TO PB-BATCH-SEQ-NO
 14445                   PB-CSR-BATCH-SEQ-NO
 14446         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14447         GO TO 2275-WRITE-PENDING-BUSINESS.
 14448
 14449     MOVE -1                     TO CCERTNOL.
 14450     MOVE AL-UABON               TO CCERTNOA.
 14451     MOVE AL-UNBON               TO CEFFDTA.
 14452
 14453     MOVE 1                      TO EMI-SUB
 14454                                    EMI-SWITCH1
 14455                                    EMI-SWITCH-AREA-1
 14456                                    EMI-SWITCH-AREA-2.
 14457
 14458     MOVE SPACES                 TO EMI-ERROR-LINES.
 14459
 14460
 14461* EXEC CICS SYNCPOINT ROLLBACK
 14462*    END-EXEC.
 14463*    MOVE '6"R                   !   #00012975' TO DFHEIV0
 14464     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14466     MOVE X'2020233030303132393735' TO DFHEIV0(25:11)
 14467     CALL 'kxdfhei1' USING DFHEIV0
 14468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14469
 14470
 14471     MOVE ER-2247                TO EMI-ERROR.
 14472     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14473     GO TO 8200-SEND-DATAONLY.
 14474
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 267
* EL6311.cbl
 14476
 14477******************************************************************
 14478*                                                                *
 14479*          C H A N G E   C A N C E L   R O U T I N E             *
 14480*                                                                *
 14481******************************************************************
 14482
 14483***************************************************************
 14484*                                                             *
 14485*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 14486*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 14487*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 14488*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 14489*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 14490*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 14491*     5. LINK TO THE EDIT ROUTINE.                            *
 14492*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 14493*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 14494*              THE EDIT ROUTINE.                              *
 14495*     7. REWRITE THE NEW ISSUE                                *
 14496*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 14497*                                                             *
 14498***************************************************************
 14499 2300-CHANGE-CANCEL-ROUTINE.
 14500     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 14501
 14502     IF CCHGL NOT = ZEROS
 14503        MOVE ER-2196             TO EMI-ERROR
 14504        MOVE AL-UABON            TO CMAINTA
 14505        MOVE -1                  TO CMAINTL
 14506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14507        GO TO 8200-SEND-DATAONLY.
 14508
 14509     MOVE CCERTNOI               TO WS-NEW-PRIME.
 14510
 14511     IF CSUFIXL NOT = ZEROS
 14512        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 14513     ELSE
 14514        MOVE SPACE               TO WS-NEW-SUFFIX.
 14515
 14516     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14517     PERFORM 8600-DEEDIT.
 14518     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14519     MOVE '4'                    TO DC-OPTION-CODE.
 14520
 14521     PERFORM 9700-DATE-LINK.
 14522
 14523     IF DATE-CONVERSION-ERROR
 14524        MOVE ER-0348             TO EMI-ERROR
 14525        MOVE -1                  TO CEFFDTL
 14526        MOVE AL-UABON            TO CEFFDTA
 14527        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14528        GO TO 8200-SEND-DATAONLY
 14529     ELSE
 14530        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14531        MOVE AL-UANON            TO CEFFDTA
 14532        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14533
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 268
* EL6311.cbl
 14534 2325-PROCESS-CANCEL-CHANGES.
 14535
 14536* EXEC CICS HANDLE CONDITION
 14537*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 14538*    END-EXEC.
 14539*    MOVE '"$I                   ! 3 #00013042' TO DFHEIV0
 14540     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14542     MOVE X'3320233030303133303432' TO DFHEIV0(25:11)
 14543     CALL 'kxdfhei1' USING DFHEIV0
 14544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14545
 14546
 14547     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 14548     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14549     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14550
 14551
 14552* EXEC CICS GETMAIN
 14553*        SET      (ADDRESS OF PENDING-BUSINESS)
 14554*        LENGTH   (ERPNDB-RECORD-LENGTH)
 14555*        INITIMG  (GETMAIN-SPACE)
 14556*     END-EXEC.
 14557*    MOVE ',"IL                  $   #00013050' TO DFHEIV0
 14558     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14559     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14560     MOVE X'2020233030303133303530' TO DFHEIV0(25:11)
 14561     CALL 'kxdfhei1' USING DFHEIV0,
 14562           DFHEIV20,
 14563           ERPNDB-RECORD-LENGTH,
 14564           GETMAIN-SPACE
 14565     SET ADDRESS OF PENDING-BUSINESS TO
 14566         DFHEIV20
 14567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14568
 14569
 14570
 14571* EXEC CICS READ
 14572*        INTO    (PENDING-BUSINESS)
 14573*        DATASET (FILE-ID-ERPNDB)
 14574*        RIDFLD  (ERPNDB-KEY)
 14575*    END-EXEC.
 14576     MOVE LENGTH OF
 14577      PENDING-BUSINESS
 14578       TO DFHEIV11
 14579*    MOVE '&"IL       E          (   #00013056' TO DFHEIV0
 14580     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14582     MOVE X'2020233030303133303536' TO DFHEIV0(25:11)
 14583     CALL 'kxdfhei1' USING DFHEIV0,
 14584           FILE-ID-ERPNDB,
 14585           PENDING-BUSINESS,
 14586           DFHEIV11,
 14587           ERPNDB-KEY,
 14588           DFHEIV99,
 14589           DFHEIV99,
 14590           DFHEIV99
 14591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 269
* EL6311.cbl
 14592
 14593
 14594     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14595
 14596
 14597* EXEC CICS HANDLE CONDITION
 14598*         NOTFND     (2385-REC-NOT-FOUND)
 14599*    END-EXEC.
 14600*    MOVE '"$I                   ! 4 #00013064' TO DFHEIV0
 14601     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14603     MOVE X'3420233030303133303634' TO DFHEIV0(25:11)
 14604     CALL 'kxdfhei1' USING DFHEIV0
 14605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14606
 14607
 14608**********************************************************
 14609*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 14610*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 14611**********************************************************
 14612
 14613
 14614* EXEC CICS READ
 14615*        DATASET (FILE-ID-ERPNDB)
 14616*        INTO    (PENDING-BUSINESS)
 14617*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14618*    END-EXEC.
 14619     MOVE LENGTH OF
 14620      PENDING-BUSINESS
 14621       TO DFHEIV11
 14622*    MOVE '&"IL       E          (   #00013073' TO DFHEIV0
 14623     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14625     MOVE X'2020233030303133303733' TO DFHEIV0(25:11)
 14626     CALL 'kxdfhei1' USING DFHEIV0,
 14627           FILE-ID-ERPNDB,
 14628           PENDING-BUSINESS,
 14629           DFHEIV11,
 14630           PI-PREV-CONTROL-PRIMARY,
 14631           DFHEIV99,
 14632           DFHEIV99,
 14633           DFHEIV99
 14634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14635
 14636
 14637********** DO NOT ALLOW CHANGES IF THRU A/R
 14638     IF BMAINTI = 'C'
 14639         IF PB-EL860-INTERNAL-PROCESS
 14640             MOVE ER-4005          TO EMI-ERROR
 14641             MOVE -1               TO BMAINTL
 14642             MOVE AL-UABON         TO BMAINTA
 14643             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14644             GO TO 8200-SEND-DATAONLY.
 14645**********
 14646
 14647     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 14648        MOVE -1                 TO CMAINTL
 14649        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 270
* EL6311.cbl
 14650        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14651        GO TO 8200-SEND-DATAONLY.
 14652
 14653     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 14654        MOVE ER-2196             TO EMI-ERROR
 14655        MOVE AL-UABON            TO CMAINTA
 14656        MOVE -1                  TO CMAINTL
 14657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14658        GO TO 8200-SEND-DATAONLY.
 14659     MOVE ZEROS                  TO WS-SEQ-SAVE.
 14660
 14661     IF PB-BILLED-DT = LOW-VALUES AND
 14662        PB-CHG-COUNT = ZEROS
 14663        NEXT SENTENCE
 14664     ELSE
 14665        IF (CREFND1L GREATER THAN ZEROS AND
 14666            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 14667           OR
 14668           (CREFND2L GREATER THAN ZEROS AND
 14669            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 14670           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 14671
 14672
 14673* EXEC CICS READ
 14674*        DATASET (FILE-ID-ERPNDB)
 14675*        INTO    (PENDING-BUSINESS)
 14676*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14677*        UPDATE
 14678*    END-EXEC.
 14679     MOVE LENGTH OF
 14680      PENDING-BUSINESS
 14681       TO DFHEIV11
 14682*    MOVE '&"IL       EU         (   #00013114' TO DFHEIV0
 14683     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14684     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14685     MOVE X'2020233030303133313134' TO DFHEIV0(25:11)
 14686     CALL 'kxdfhei1' USING DFHEIV0,
 14687           FILE-ID-ERPNDB,
 14688           PENDING-BUSINESS,
 14689           DFHEIV11,
 14690           PI-PREV-CONTROL-PRIMARY,
 14691           DFHEIV99,
 14692           DFHEIV99,
 14693           DFHEIV99
 14694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14695
 14696
 14697     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14698     MOVE 'B'                    TO JP-RECORD-TYPE
 14699     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14700     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14701
 14702     PERFORM 8400-LOG-JOURNAL-RECORD.
 14703
 14704     IF PB-BILLED-DT NOT = LOW-VALUES OR
 14705          PB-CHG-COUNT NOT = ZEROS
 14706        IF (CREFND1L GREATER THAN ZEROS AND
 14707            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 271
* EL6311.cbl
 14708           OR
 14709           (CREFND2L GREATER THAN ZEROS AND
 14710            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 14711            ADD +1                      TO PB-CHG-COUNT
 14712            MOVE LOW-VALUES             TO PB-BILLED-DT.
 14713
 14714*    IF CMICRNOL  GREATER  ZEROS
 14715*        IF CMICRNOI  NUMERIC
 14716*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14717*            MOVE AL-UNNON       TO  CMICRNOA
 14718*        ELSE
 14719*            MOVE -1             TO  CMICRNOL
 14720*            MOVE AL-UNBON       TO  CMICRNOA
 14721*            MOVE ER-2701        TO  EMI-ERROR
 14722*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14723
 14724     IF CSUFIXL GREATER THAN ZEROS
 14725        MOVE CSUFIXI             TO PB-CERT-SFX.
 14726
 14727     IF CLSTNML GREATER THAN ZEROS
 14728         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 14729
 14730     IF CCANREAL > ZEROS
 14731        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14732     END-IF
 14733     IF CPCYNL > ZEROS
 14734        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14735     END-IF
 14736     IF CCANDT1L    GREATER THAN ZEROS
 14737        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14738
 14739     IF CCANDT2L    GREATER THAN ZEROS
 14740        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14741
 14742     IF CMTHD1L    GREATER THAN +0
 14743        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14744
 14745     IF CMTHD2L    GREATER THAN +0
 14746        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14747
 14748     IF CREFND1L    GREATER THAN ZEROS
 14749        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 14750        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14751        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14752        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 14753
 14754     IF CREFND2L    GREATER THAN ZEROS
 14755        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 14756        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14757        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14758        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 14759
 14760     IF CLIVESL     GREATER THAN ZEROS
 14761        MOVE WS-CLIVES           TO PB-C-LIVES.
 14762
 14763     IF CPAYEEL     GREATER THAN ZEROS
 14764        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14765
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 272
* EL6311.cbl
 14766     IF CFORCEL     GREATER THAN ZEROS
 14767        MOVE CFORCEI             TO PB-FORCE-CODE.
 14768
 14769     IF CBILCDL     GREATER THAN ZEROS
 14770        MOVE CBILCDI             TO PB-RECORD-BILL.
 14771
 14772 2360-REWRITE-PB-RECORD.
 14773     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 14774     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14775     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 14776     MOVE 'C'                    TO JP-RECORD-TYPE.
 14777     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14778     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14779     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14780
 14781     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14782
 14783     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 14784     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 14785
 14786     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 14787
 14788     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14789
 14790     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14791     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14792     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14793
 14794     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14795     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14796
 14797 2375-REWRITE-PENDING-BUSINESS.
 14798     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14799     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14800     MOVE 'C'                    TO JP-RECORD-TYPE.
 14801     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14802
 14803
 14804* EXEC CICS REWRITE
 14805*        DATASET (FILE-ID-ERPNDB)
 14806*        FROM    (PENDING-BUSINESS)
 14807*    END-EXEC.
 14808     MOVE LENGTH OF
 14809      PENDING-BUSINESS
 14810       TO DFHEIV11
 14811*    MOVE '&& L                  %   #00013227' TO DFHEIV0
 14812     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14813     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14814     MOVE X'2020233030303133323237' TO DFHEIV0(25:11)
 14815     CALL 'kxdfhei1' USING DFHEIV0,
 14816           FILE-ID-ERPNDB,
 14817           PENDING-BUSINESS,
 14818           DFHEIV11,
 14819           DFHEIV99
 14820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14821
 14822
 14823     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 273
* EL6311.cbl
 14824
 14825******************************************************************
 14826*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 14827******************************************************************
 14828
 14829     display ' made it to update orig cancel cert '
 14830
 14831     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14832     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14833     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14834     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14835
 14836
 14837* EXEC CICS READ
 14838*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14839*        DATASET (FILE-ID-ELCERT)
 14840*        RIDFLD  (ELCERT-KEY)
 14841*        RESP    (WS-RESPONSE)
 14842*    END-EXEC.
 14843*    MOVE '&"S        E          (  N#00013245' TO DFHEIV0
 14844     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14846     MOVE X'204E233030303133323435' TO DFHEIV0(25:11)
 14847     CALL 'kxdfhei1' USING DFHEIV0,
 14848           FILE-ID-ELCERT,
 14849           DFHEIV20,
 14850           DFHEIV99,
 14851           ELCERT-KEY,
 14852           DFHEIV99,
 14853           DFHEIV99,
 14854           DFHEIV99
 14855     SET ADDRESS OF CERTIFICATE-MASTER TO
 14856         DFHEIV20
 14857     MOVE EIBRESP  TO WS-RESPONSE
 14858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14859
 14860
 14861     IF NOT RESP-NORMAL
 14862        GO TO 2376-BYPASS-CRTO
 14863     END-IF
 14864
 14865
 14866     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14867     MOVE ' '                    TO WS-ERMAIL-SW
 14868
 14869
 14870* EXEC CICS READ
 14871*       DATASET   (FILE-ID-ERMAIL)
 14872*       SET       (ADDRESS OF MAILING-DATA)
 14873*       RIDFLD    (ERMAIL-KEY)
 14874*       RESP      (WS-RESPONSE)
 14875*    END-EXEC
 14876*    MOVE '&"S        E          (  N#00013260' TO DFHEIV0
 14877     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14879     MOVE X'204E233030303133323630' TO DFHEIV0(25:11)
 14880     CALL 'kxdfhei1' USING DFHEIV0,
 14881           FILE-ID-ERMAIL,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 274
* EL6311.cbl
 14882           DFHEIV20,
 14883           DFHEIV99,
 14884           ERMAIL-KEY,
 14885           DFHEIV99,
 14886           DFHEIV99,
 14887           DFHEIV99
 14888     SET ADDRESS OF MAILING-DATA TO
 14889         DFHEIV20
 14890     MOVE EIBRESP  TO WS-RESPONSE
 14891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14892
 14893     IF RESP-NORMAL
 14894        SET ERMAIL-FOUND TO TRUE
 14895     END-IF
 14896
 14897     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14898                                 TO ELCRTO-KEY
 14899     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 14900     MOVE +0                     TO ELCRTO-SEQ-NO
 14901
 14902
 14903* EXEC CICS READ
 14904*       DATASET   ('ELCRTO')
 14905*       INTO      (ORIGINAL-CERTIFICATE)
 14906*       RIDFLD    (ELCRTO-KEY)
 14907*       GTEQ
 14908*       RESP      (WS-RESPONSE)
 14909*    END-EXEC
 14910     MOVE LENGTH OF
 14911      ORIGINAL-CERTIFICATE
 14912       TO DFHEIV11
 14913     MOVE 'ELCRTO' TO DFHEIV1
 14914*    MOVE '&"IL       G          (  N#00013276' TO DFHEIV0
 14915     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 14916     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14917     MOVE X'204E233030303133323736' TO DFHEIV0(25:11)
 14918     CALL 'kxdfhei1' USING DFHEIV0,
 14919           DFHEIV1,
 14920           ORIGINAL-CERTIFICATE,
 14921           DFHEIV11,
 14922           ELCRTO-KEY,
 14923           DFHEIV99,
 14924           DFHEIV99,
 14925           DFHEIV99
 14926     MOVE EIBRESP  TO WS-RESPONSE
 14927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14928
 14929     display ' just read gteq ' ws-response
 14930     IF RESP-NORMAL
 14931        AND (OC-CONTROL-PRIMARY (1:33) =
 14932                 PB-CONTROL-BY-ACCOUNT (1:33))
 14933        AND (OC-RECORD-TYPE = 'I')
 14934        display ' resp norm, key =, type i '
 14935        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 14936           display ' end proc blank '
 14937           display ' csr edit session ' PI-CSR-SESSION-SW
 14938           IF NOT CSR-EDIT-SESSION
 14939
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 275
* EL6311.cbl
 14940* EXEC CICS READ
 14941*                DATASET   ('ELCRTO')
 14942*                INTO      (ORIGINAL-CERTIFICATE)
 14943*                RIDFLD    (OC-CONTROL-PRIMARY)
 14944*                UPDATE
 14945*                RESP      (WS-RESPONSE)
 14946*             END-EXEC
 14947     MOVE LENGTH OF
 14948      ORIGINAL-CERTIFICATE
 14949       TO DFHEIV11
 14950     MOVE 'ELCRTO' TO DFHEIV1
 14951*    MOVE '&"IL       EU         (  N#00013294' TO DFHEIV0
 14952     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14953     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14954     MOVE X'204E233030303133323934' TO DFHEIV0(25:11)
 14955     CALL 'kxdfhei1' USING DFHEIV0,
 14956           DFHEIV1,
 14957           ORIGINAL-CERTIFICATE,
 14958           DFHEIV11,
 14959           OC-CONTROL-PRIMARY,
 14960           DFHEIV99,
 14961           DFHEIV99,
 14962           DFHEIV99
 14963     MOVE EIBRESP  TO WS-RESPONSE
 14964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14965              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 14966              IF RESP-NORMAL
 14967                 display ' good read upd '
 14968                 MOVE CM-INSURED-LAST-NAME   TO
 14969                         OC-INS-LAST-NAME
 14970                 MOVE CM-INSURED-FIRST-NAME  TO
 14971                         OC-INS-FIRST-NAME
 14972                 MOVE CM-INSURED-INITIAL2    TO
 14973                         OC-INS-MIDDLE-INIT
 14974                 MOVE CM-INSURED-ISSUE-AGE   TO
 14975                         OC-INS-AGE
 14976                 MOVE CM-JT-LAST-NAME        TO
 14977                         OC-JNT-LAST-NAME
 14978                 MOVE CM-JT-FIRST-NAME       TO
 14979                         OC-JNT-FIRST-NAME
 14980                 MOVE CM-JT-INITIAL          TO
 14981                         OC-JNT-MIDDLE-INIT
 14982                 MOVE CM-INSURED-JOINT-AGE   TO
 14983                         OC-JNT-AGE
 14984                 MOVE CM-LF-BENEFIT-CD       TO
 14985                         OC-LF-BENCD
 14986                 MOVE CM-LF-ORIG-TERM        TO
 14987                         OC-LF-TERM
 14988                 MOVE CM-LF-BENEFIT-AMT      TO
 14989                         OC-LF-BEN-AMT
 14990                 MOVE CM-LF-PREMIUM-AMT      TO
 14991                         OC-LF-PRM-AMT
 14992                 MOVE CM-LF-ALT-BENEFIT-AMT  TO
 14993                         OC-LF-ALT-BEN-AMT
 14994                 MOVE CM-LF-ALT-PREMIUM-AMT  TO
 14995                         OC-LF-ALT-PRM-AMT
 14996                 MOVE CM-LF-LOAN-EXPIRE-DT   TO
 14997                         OC-LF-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 276
* EL6311.cbl
 14998                 MOVE CM-LIFE-COMM-PCT       TO
 14999                         OC-LF-COMM-PCT
 15000                 MOVE PB-C-LF-CANCEL-DT      TO
 15001                         OC-LF-CANCEL-DT
 15002                 MOVE PB-C-LF-CANCEL-AMT     TO
 15003                         OC-LF-CANCEL-AMT
 15004                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15005                         OC-LF-ITD-CANCEL-AMT
 15006                 MOVE CM-AH-BENEFIT-CD       TO
 15007                         OC-AH-BENCD
 15008                 MOVE CM-AH-ORIG-TERM        TO
 15009                         OC-AH-TERM
 15010                 MOVE CM-AH-BENEFIT-AMT      TO
 15011                         OC-AH-BEN-AMT
 15012                 MOVE CM-AH-PREMIUM-AMT      TO
 15013                         OC-AH-PRM-AMT
 15014                 MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15015                         OC-AH-EXP-DT
 15016                 MOVE CM-AH-COMM-PCT         TO
 15017                         OC-AH-COMM-PCT
 15018                 MOVE CM-AH-CRITICAL-PERIOD  TO
 15019                         OC-AH-CP
 15020                 MOVE PB-C-AH-CANCEL-DT      TO
 15021                         OC-AH-CANCEL-DT
 15022                 MOVE PB-C-AH-CANCEL-AMT     TO
 15023                         OC-AH-CANCEL-AMT
 15024                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15025                         OC-AH-ITD-CANCEL-AMT
 15026                 MOVE CM-LOAN-1ST-PMT-DT     TO
 15027                         OC-1ST-PMT-DT
 15028                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15029                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15030                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15031                 IF ERMAIL-FOUND
 15032                    MOVE MA-CRED-BENE-NAME
 15033                                 TO OC-CRED-BENE-NAME
 15034                 END-IF
 15035
 15036* EXEC CICS REWRITE
 15037*                   DATASET   ('ELCRTO')
 15038*                   FROM      (ORIGINAL-CERTIFICATE)
 15039*                   RESP      (WS-RESPONSE)
 15040*                END-EXEC
 15041     MOVE LENGTH OF
 15042      ORIGINAL-CERTIFICATE
 15043       TO DFHEIV11
 15044     MOVE 'ELCRTO' TO DFHEIV1
 15045*    MOVE '&& L                  %  N#00013371' TO DFHEIV0
 15046     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15047     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15048     MOVE X'204E233030303133333731' TO DFHEIV0(25:11)
 15049     CALL 'kxdfhei1' USING DFHEIV0,
 15050           DFHEIV1,
 15051           ORIGINAL-CERTIFICATE,
 15052           DFHEIV11,
 15053           DFHEIV99
 15054     MOVE EIBRESP  TO WS-RESPONSE
 15055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 277
* EL6311.cbl
 15056                 display ' just rewrote ' ws-response
 15057              END-IF
 15058           END-IF
 15059        ELSE
 15060           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15061           MOVE 'OC'             TO OC-RECORD-ID
 15062           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15063           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15064           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15065           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15066           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15067           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15068           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15069           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15070           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15071           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15072           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15073           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15074           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15075           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15076           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15077           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15078           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15079           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15080           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15081           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15082           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15083           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15084           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15085           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15086           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15087           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15088           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15089           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15090           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15091           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15092           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15093           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15094           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15095           IF ERMAIL-FOUND
 15096              MOVE MA-CRED-BENE-NAME
 15097                                 TO OC-CRED-BENE-NAME
 15098           END-IF
 15099           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15100
 15101* EXEC CICS WRITE
 15102*             DATASET   ('ELCRTO')
 15103*             FROM      (ORIGINAL-CERTIFICATE)
 15104*             RIDFLD    (OC-CONTROL-PRIMARY)
 15105*             RESP      (WS-RESPONSE)
 15106*          END-EXEC
 15107     MOVE LENGTH OF
 15108      ORIGINAL-CERTIFICATE
 15109       TO DFHEIV11
 15110     MOVE 'ELCRTO' TO DFHEIV1
 15111*    MOVE '&$ L                  ''  N#00013420' TO DFHEIV0
 15112     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 278
* EL6311.cbl
 15114     MOVE X'204E233030303133343230' TO DFHEIV0(25:11)
 15115     CALL 'kxdfhei1' USING DFHEIV0,
 15116           DFHEIV1,
 15117           ORIGINAL-CERTIFICATE,
 15118           DFHEIV11,
 15119           OC-CONTROL-PRIMARY,
 15120           DFHEIV99,
 15121           DFHEIV99
 15122     MOVE EIBRESP  TO WS-RESPONSE
 15123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15124        END-IF
 15125     ELSE
 15126        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15127        MOVE 'OC'                TO OC-RECORD-ID
 15128        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15129                                 TO OC-CONTROL-PRIMARY (1:33)
 15130        MOVE 'I'                 TO OC-RECORD-TYPE
 15131        MOVE +4096               TO OC-KEY-SEQ-NO
 15132        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15133        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15134        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15135        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15136        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15137        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15138        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15139        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15140        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15141        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15142        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15143        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15144        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15145        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15146        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15147        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15148        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15149        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15150        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15151        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15152        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15153        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15154        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15155        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15156        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15157        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15158        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15159        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15160        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15161        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15162        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15163        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15164        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15165        IF ERMAIL-FOUND
 15166           MOVE MA-CRED-BENE-NAME
 15167                                 TO OC-CRED-BENE-NAME
 15168        END-IF
 15169        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15170
 15171
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 279
* EL6311.cbl
 15172* EXEC CICS WRITE
 15173*          DATASET   ('ELCRTO')
 15174*          FROM      (ORIGINAL-CERTIFICATE)
 15175*          RIDFLD    (OC-CONTROL-PRIMARY)
 15176*          RESP      (WS-RESPONSE)
 15177*       END-EXEC
 15178     MOVE LENGTH OF
 15179      ORIGINAL-CERTIFICATE
 15180       TO DFHEIV11
 15181     MOVE 'ELCRTO' TO DFHEIV1
 15182*    MOVE '&$ L                  ''  N#00013473' TO DFHEIV0
 15183     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15184     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15185     MOVE X'204E233030303133343733' TO DFHEIV0(25:11)
 15186     CALL 'kxdfhei1' USING DFHEIV0,
 15187           DFHEIV1,
 15188           ORIGINAL-CERTIFICATE,
 15189           DFHEIV11,
 15190           OC-CONTROL-PRIMARY,
 15191           DFHEIV99,
 15192           DFHEIV99
 15193     MOVE EIBRESP  TO WS-RESPONSE
 15194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15195     END-IF.
 15196
 15197 2376-BYPASS-CRTO.
 15198******************************************************************
 15199*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15200******************************************************************
 15201
 15202
 15203* EXEC CICS HANDLE CONDITION
 15204*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15205*    END-EXEC.
 15206*    MOVE '"$I                   ! 5 #00013486' TO DFHEIV0
 15207     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15209     MOVE X'3520233030303133343836' TO DFHEIV0(25:11)
 15210     CALL 'kxdfhei1' USING DFHEIV0
 15211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15212
 15213
 15214
 15215* EXEC CICS READ
 15216*        INTO    (PENDING-BUSINESS)
 15217*        DATASET (FILE-ID-ERPNDB)
 15218*        RIDFLD  (ERPNDB-KEY)
 15219*        UPDATE
 15220*    END-EXEC.
 15221     MOVE LENGTH OF
 15222      PENDING-BUSINESS
 15223       TO DFHEIV11
 15224*    MOVE '&"IL       EU         (   #00013490' TO DFHEIV0
 15225     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15226     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15227     MOVE X'2020233030303133343930' TO DFHEIV0(25:11)
 15228     CALL 'kxdfhei1' USING DFHEIV0,
 15229           FILE-ID-ERPNDB,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 280
* EL6311.cbl
 15230           PENDING-BUSINESS,
 15231           DFHEIV11,
 15232           ERPNDB-KEY,
 15233           DFHEIV99,
 15234           DFHEIV99,
 15235           DFHEIV99
 15236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15237
 15238
 15239     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15240     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15241     MOVE 'B'                    TO JP-RECORD-TYPE.
 15242     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15243
 15244     PERFORM 8400-LOG-JOURNAL-RECORD.
 15245
 15246     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15247
 15248
 15249* EXEC CICS REWRITE
 15250*        DATASET (FILE-ID-ERPNDB)
 15251*        FROM    (PENDING-BUSINESS)
 15252*    END-EXEC.
 15253     MOVE LENGTH OF
 15254      PENDING-BUSINESS
 15255       TO DFHEIV11
 15256*    MOVE '&& L                  %   #00013506' TO DFHEIV0
 15257     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15258     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15259     MOVE X'2020233030303133353036' TO DFHEIV0(25:11)
 15260     CALL 'kxdfhei1' USING DFHEIV0,
 15261           FILE-ID-ERPNDB,
 15262           PENDING-BUSINESS,
 15263           DFHEIV11,
 15264           DFHEIV99
 15265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15266
 15267
 15268     MOVE 'C'                    TO JP-RECORD-TYPE.
 15269     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15270
 15271     PERFORM 8400-LOG-JOURNAL-RECORD.
 15272
 15273     IF WS-ERRORS-PRESENT
 15274         GO TO 3900-RE-DISPLAY-RECORD.
 15275
 15276     MOVE ZEROS                  TO EMI-ERROR
 15277     MOVE -1                     TO CMAINTL
 15278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15279     GO TO 3900-RE-DISPLAY-RECORD.
 15280
 15281 2380-BATCH-HDR-NOT-FOUND.
 15282     MOVE -1                     TO BMAINTL.
 15283     MOVE ER-7450                TO EMI-ERROR.
 15284     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15285     GO TO 8200-SEND-DATAONLY.
 15286
 15287 2385-REC-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 281
* EL6311.cbl
 15288     MOVE -1                     TO BMAINTL.
 15289     MOVE ER-7451                TO EMI-ERROR.
 15290     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15291     GO TO 8200-SEND-DATAONLY.
 15292
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 282
* EL6311.cbl
 15294
 15295******************************************************************
 15296*                                                                *
 15297*          D E L E T E   C A N C E L   R O U T I N E             *
 15298*                                                                *
 15299******************************************************************
 15300
 15301 2400-DELETE-CANCEL-ROUTINE.
 15302     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15303
 15304     IF CCHGL NOT = ZEROS
 15305        MOVE ER-2196             TO EMI-ERROR
 15306        MOVE AL-UABON            TO CMAINTA
 15307        MOVE -1                  TO CMAINTL
 15308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15309        GO TO 8200-SEND-DATAONLY.
 15310
 15311
 15312* EXEC CICS HANDLE CONDITION
 15313*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15314*    END-EXEC.
 15315*    MOVE '"$I                   ! 6 #00013554' TO DFHEIV0
 15316     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15318     MOVE X'3620233030303133353534' TO DFHEIV0(25:11)
 15319     CALL 'kxdfhei1' USING DFHEIV0
 15320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15321
 15322
 15323     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15324     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15325     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15326
 15327
 15328* EXEC CICS READ
 15329*        SET     (ADDRESS OF PENDING-BUSINESS)
 15330*        DATASET (FILE-ID-ERPNDB)
 15331*        RIDFLD  (ERPNDB-KEY)
 15332*    END-EXEC.
 15333*    MOVE '&"S        E          (   #00013562' TO DFHEIV0
 15334     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15335     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15336     MOVE X'2020233030303133353632' TO DFHEIV0(25:11)
 15337     CALL 'kxdfhei1' USING DFHEIV0,
 15338           FILE-ID-ERPNDB,
 15339           DFHEIV20,
 15340           DFHEIV99,
 15341           ERPNDB-KEY,
 15342           DFHEIV99,
 15343           DFHEIV99,
 15344           DFHEIV99
 15345     SET ADDRESS OF PENDING-BUSINESS TO
 15346         DFHEIV20
 15347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15348
 15349
 15350     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15351
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 283
* EL6311.cbl
 15352     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15353
 15354     IF CSUFIXL NOT = ZEROS
 15355        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15356     ELSE
 15357        MOVE SPACE               TO WS-NEW-SUFFIX.
 15358
 15359     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15360
 15361     PERFORM 8600-DEEDIT.
 15362     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15363     MOVE '4'                    TO DC-OPTION-CODE.
 15364     PERFORM 9700-DATE-LINK.
 15365
 15366     IF DATE-CONVERSION-ERROR
 15367        MOVE ER-0348             TO EMI-ERROR
 15368        MOVE -1                  TO CEFFDTL
 15369        MOVE AL-UABON            TO CEFFDTA
 15370        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15371        GO TO 8200-SEND-DATAONLY
 15372     ELSE
 15373        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15374        MOVE AL-UANON            TO CEFFDTA
 15375        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15376
 15377
 15378* EXEC CICS HANDLE CONDITION
 15379*         NOTFND    (2490-RECORD-NOT-FOUND)
 15380*    END-EXEC.
 15381*    MOVE '"$I                   ! 7 #00013595' TO DFHEIV0
 15382     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15384     MOVE X'3720233030303133353935' TO DFHEIV0(25:11)
 15385     CALL 'kxdfhei1' USING DFHEIV0
 15386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15387
 15388
 15389
 15390* EXEC CICS READ
 15391*        SET     (ADDRESS OF PENDING-BUSINESS)
 15392*        DATASET (FILE-ID-ERPNDB)
 15393*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15394*        UPDATE
 15395*    END-EXEC.
 15396*    MOVE '&"S        EU         (   #00013599' TO DFHEIV0
 15397     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15398     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15399     MOVE X'2020233030303133353939' TO DFHEIV0(25:11)
 15400     CALL 'kxdfhei1' USING DFHEIV0,
 15401           FILE-ID-ERPNDB,
 15402           DFHEIV20,
 15403           DFHEIV99,
 15404           PI-PREV-CONTROL-PRIMARY,
 15405           DFHEIV99,
 15406           DFHEIV99,
 15407           DFHEIV99
 15408     SET ADDRESS OF PENDING-BUSINESS TO
 15409         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 284
* EL6311.cbl
 15410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15411
 15412
 15413     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15414        MOVE -1                 TO CMAINTL
 15415        MOVE ER-2197            TO EMI-ERROR
 15416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15417        GO TO 8200-SEND-DATAONLY.
 15418
 15419     IF PB-BILLED-DT NOT = LOW-VALUES
 15420        MOVE -1                 TO CMAINTL
 15421        MOVE ER-2129            TO EMI-ERROR
 15422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15423        GO TO 8200-SEND-DATAONLY.
 15424
 15425     IF PB-CHG-COUNT NOT = ZEROS
 15426        MOVE ER-2336            TO EMI-ERROR
 15427        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15428        MOVE AL-UABON            TO CMAINTA
 15429        MOVE -1                  TO CMAINTL
 15430        GO TO 8200-SEND-DATAONLY.
 15431
 15432     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 15433        PB-CHG-COUNT NOT = ZEROS
 15434        MOVE ER-2196             TO EMI-ERROR
 15435        MOVE AL-UABON            TO CMAINTA
 15436        MOVE -1                  TO CMAINTL
 15437        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15438        GO TO 8200-SEND-DATAONLY.
 15439
 15440     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 15441        MOVE ER-2900 TO EMI-ERROR
 15442        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15443        MOVE AL-UABON         TO CMAINTA
 15444        MOVE -1               TO CMAINTL
 15445        GO TO 8200-SEND-DATAONLY.
 15446
 15447
 15448* EXEC CICS HANDLE CONDITION
 15449*         NOTFND  (2475-CONTINUE-DELETE)
 15450*    END-EXEC
 15451*    MOVE '"$I                   ! 8 #00013640' TO DFHEIV0
 15452     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15453     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15454     MOVE X'3820233030303133363430' TO DFHEIV0(25:11)
 15455     CALL 'kxdfhei1' USING DFHEIV0
 15456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15457
 15458     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15459     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15460     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15461     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15462
 15463
 15464* EXEC CICS READ
 15465*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15466*        DATASET (FILE-ID-ELCERT)
 15467*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 285
* EL6311.cbl
 15468*        UPDATE
 15469*    END-EXEC.
 15470*    MOVE '&"S        EU         (   #00013649' TO DFHEIV0
 15471     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15472     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15473     MOVE X'2020233030303133363439' TO DFHEIV0(25:11)
 15474     CALL 'kxdfhei1' USING DFHEIV0,
 15475           FILE-ID-ELCERT,
 15476           DFHEIV20,
 15477           DFHEIV99,
 15478           ELCERT-KEY,
 15479           DFHEIV99,
 15480           DFHEIV99,
 15481           DFHEIV99
 15482     SET ADDRESS OF CERTIFICATE-MASTER TO
 15483         DFHEIV20
 15484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15485
 15486
 15487     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15488
 15489     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 15490     MOVE 'B'                    TO JP-RECORD-TYPE.
 15491     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 15492     PERFORM 8400-LOG-JOURNAL-RECORD.
 15493
 15494     IF PB-CI-LIVES NOT NUMERIC
 15495         MOVE ZERO                    TO PB-CI-LIVES.
 15496
 15497     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15498        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15499           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15500           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 15501           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 15502                                            CM-LF-CANCEL-DT
 15503           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 15504        ELSE
 15505           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15506           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 15507           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 15508           MOVE PB-CI-LIVES              TO CM-LIVES.
 15509
 15510     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15511        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15512           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15513               MOVE CM-LF-STATUS-AT-CANCEL
 15514                                        TO CM-LF-CURRENT-STATUS
 15515               MOVE SPACE
 15516                                        TO CM-LF-STATUS-AT-CANCEL
 15517           ELSE
 15518               MOVE PB-CI-LF-POLICY-STATUS
 15519                                        TO CM-LF-CURRENT-STATUS
 15520        ELSE
 15521           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 15522
 15523
 15524     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15525        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 286
* EL6311.cbl
 15526           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15527           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 15528           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 15529                                            CM-AH-CANCEL-DT
 15530           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 15531        ELSE
 15532           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15533           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 15534           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 15535           MOVE PB-CI-LIVES              TO CM-LIVES.
 15536
 15537     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15538        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 15539           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15540               MOVE CM-AH-STATUS-AT-CANCEL
 15541                                        TO CM-AH-CURRENT-STATUS
 15542               MOVE SPACE
 15543                                        TO CM-AH-STATUS-AT-CANCEL
 15544           ELSE
 15545               MOVE PB-CI-AH-POLICY-STATUS
 15546                                        TO CM-AH-CURRENT-STATUS
 15547        ELSE
 15548           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 15549
 15550 2450-REWRITE-CERT.
 15551     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 15552     MOVE 'C'                      TO JP-RECORD-TYPE.
 15553     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 15554
 15555
 15556* EXEC CICS REWRITE
 15557*        DATASET  (FILE-ID-ELCERT)
 15558*        FROM     (CERTIFICATE-MASTER)
 15559*    END-EXEC.
 15560     MOVE LENGTH OF
 15561      CERTIFICATE-MASTER
 15562       TO DFHEIV11
 15563*    MOVE '&& L                  %   #00013724' TO DFHEIV0
 15564     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15565     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15566     MOVE X'2020233030303133373234' TO DFHEIV0(25:11)
 15567     CALL 'kxdfhei1' USING DFHEIV0,
 15568           FILE-ID-ELCERT,
 15569           CERTIFICATE-MASTER,
 15570           DFHEIV11,
 15571           DFHEIV99
 15572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15573
 15574
 15575     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15576
 15577     PERFORM 8400-LOG-JOURNAL-RECORD.
 15578
 15579 2475-CONTINUE-DELETE.
 15580     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 15581     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 15582
 15583     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 287
* EL6311.cbl
 15584     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 15585
 15586     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 15587
 15588     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 15589     MOVE 'D'                    TO JP-RECORD-TYPE
 15590     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15591
 15592
 15593* EXEC CICS DELETE
 15594*        DATASET    (FILE-ID-ERPNDB)
 15595*    END-EXEC.
 15596*    MOVE '&(                    &   #00013746' TO DFHEIV0
 15597     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15598     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15599     MOVE X'2020233030303133373436' TO DFHEIV0(25:11)
 15600     CALL 'kxdfhei1' USING DFHEIV0,
 15601           FILE-ID-ERPNDB,
 15602           DFHEIV99,
 15603           DFHEIV99,
 15604           DFHEIV99,
 15605           DFHEIV99
 15606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15607
 15608
 15609     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15610
 15611     PERFORM 8400-LOG-JOURNAL-RECORD.
 15612
 15613     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15614     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15615
 15616
 15617* EXEC CICS HANDLE CONDITION
 15618*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15619*    END-EXEC.
 15620*    MOVE '"$I                   ! 9 #00013757' TO DFHEIV0
 15621     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15623     MOVE X'3920233030303133373537' TO DFHEIV0(25:11)
 15624     CALL 'kxdfhei1' USING DFHEIV0
 15625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15626
 15627
 15628
 15629* EXEC CICS READ
 15630*        SET     (ADDRESS OF PENDING-BUSINESS)
 15631*        DATASET (FILE-ID-ERPNDB)
 15632*        RIDFLD  (ERPNDB-KEY)
 15633*        UPDATE
 15634*    END-EXEC.
 15635*    MOVE '&"S        EU         (   #00013761' TO DFHEIV0
 15636     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15637     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15638     MOVE X'2020233030303133373631' TO DFHEIV0(25:11)
 15639     CALL 'kxdfhei1' USING DFHEIV0,
 15640           FILE-ID-ERPNDB,
 15641           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 288
* EL6311.cbl
 15642           DFHEIV99,
 15643           ERPNDB-KEY,
 15644           DFHEIV99,
 15645           DFHEIV99,
 15646           DFHEIV99
 15647     SET ADDRESS OF PENDING-BUSINESS TO
 15648         DFHEIV20
 15649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15650
 15651
 15652     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 15653     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15654
 15655     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 15656        WS-B-CANCEL-CNT-ENTERED = ZEROS
 15657        MOVE 'D'                 TO JP-RECORD-TYPE
 15658        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 15659
 15660* EXEC CICS DELETE
 15661*            DATASET    (FILE-ID-ERPNDB)
 15662*       END-EXEC
 15663*    MOVE '&(                    &   #00013775' TO DFHEIV0
 15664     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15665     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15666     MOVE X'2020233030303133373735' TO DFHEIV0(25:11)
 15667     CALL 'kxdfhei1' USING DFHEIV0,
 15668           FILE-ID-ERPNDB,
 15669           DFHEIV99,
 15670           DFHEIV99,
 15671           DFHEIV99,
 15672           DFHEIV99
 15673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15674        PERFORM 8400-LOG-JOURNAL-RECORD
 15675     ELSE
 15676        MOVE 'B'                 TO JP-RECORD-TYPE
 15677        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 15678        PERFORM 8400-LOG-JOURNAL-RECORD
 15679        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 15680        MOVE 'C'                 TO JP-RECORD-TYPE
 15681        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 15682
 15683* EXEC CICS REWRITE
 15684*            DATASET    (FILE-ID-ERPNDB)
 15685*            FROM       (PENDING-BUSINESS)
 15686*       END-EXEC
 15687     MOVE LENGTH OF
 15688      PENDING-BUSINESS
 15689       TO DFHEIV11
 15690*    MOVE '&& L                  %   #00013786' TO DFHEIV0
 15691     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15692     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15693     MOVE X'2020233030303133373836' TO DFHEIV0(25:11)
 15694     CALL 'kxdfhei1' USING DFHEIV0,
 15695           FILE-ID-ERPNDB,
 15696           PENDING-BUSINESS,
 15697           DFHEIV11,
 15698           DFHEIV99
 15699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 289
* EL6311.cbl
 15700        PERFORM 8400-LOG-JOURNAL-RECORD.
 15701
 15702******************************************************************
 15703*                                                                *
 15704*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 15705*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 15706*                                                                *
 15707******************************************************************
 15708
 15709     IF NOT PI-AR-PROCESSING
 15710        GO TO 2480-DELETE-FINISHED.
 15711
 15712     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 15713        WS-B-CANCEL-CNT-ENTERED = ZEROS
 15714        NEXT SENTENCE
 15715     ELSE
 15716        GO TO 2480-DELETE-FINISHED.
 15717
 15718
 15719* EXEC CICS HANDLE CONDITION
 15720*         NOTFND    (2480-DELETE-FINISHED)
 15721*    END-EXEC.
 15722*    MOVE '"$I                   ! : #00013808' TO DFHEIV0
 15723     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15724     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15725     MOVE X'3A20233030303133383038' TO DFHEIV0(25:11)
 15726     CALL 'kxdfhei1' USING DFHEIV0
 15727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15728
 15729
 15730     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 15731     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 15732
 15733
 15734* EXEC CICS READ
 15735*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 15736*        DATASET (FILE-ID-ERRQST)
 15737*        RIDFLD  (ERRQST-KEY)
 15738*        UPDATE
 15739*    END-EXEC.
 15740*    MOVE '&"S        EU         (   #00013815' TO DFHEIV0
 15741     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15742     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15743     MOVE X'2020233030303133383135' TO DFHEIV0(25:11)
 15744     CALL 'kxdfhei1' USING DFHEIV0,
 15745           FILE-ID-ERRQST,
 15746           DFHEIV20,
 15747           DFHEIV99,
 15748           ERRQST-KEY,
 15749           DFHEIV99,
 15750           DFHEIV99,
 15751           DFHEIV99
 15752     SET ADDRESS OF AR-REQUEST-RECORD TO
 15753         DFHEIV20
 15754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15755
 15756
 15757     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 290
* EL6311.cbl
 15758
 15759     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 15760
 15761     MOVE 'D'                      TO JP-RECORD-TYPE.
 15762     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 15763
 15764
 15765* EXEC CICS DELETE
 15766*         DATASET    (FILE-ID-ERRQST)
 15767*    END-EXEC.
 15768*    MOVE '&(                    &   #00013829' TO DFHEIV0
 15769     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15770     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15771     MOVE X'2020233030303133383239' TO DFHEIV0(25:11)
 15772     CALL 'kxdfhei1' USING DFHEIV0,
 15773           FILE-ID-ERRQST,
 15774           DFHEIV99,
 15775           DFHEIV99,
 15776           DFHEIV99,
 15777           DFHEIV99
 15778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15779
 15780
 15781     PERFORM 8400-LOG-JOURNAL-RECORD.
 15782
 15783 2480-DELETE-FINISHED.
 15784     MOVE ZEROS                  TO EMI-ERROR.
 15785     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15786     MOVE LOW-VALUES             TO EL631CI.
 15787     MOVE -1                     TO CMAINTL.
 15788     GO TO 8100-SEND-INITIAL-MAP.
 15789
 15790 2485-BATCH-HDR-NOT-FOUND.
 15791     MOVE -1                     TO CMAINTL
 15792     MOVE AL-UABON               TO CMAINTA.
 15793     MOVE ER-7450                TO EMI-ERROR.
 15794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15795     GO TO 8200-SEND-DATAONLY.
 15796
 15797 2490-RECORD-NOT-FOUND.
 15798     MOVE -1                     TO CMAINTL
 15799     MOVE AL-UABON               TO CMAINTA.
 15800     MOVE ER-7451                TO EMI-ERROR.
 15801     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15802     GO TO 8200-SEND-DATAONLY.
 15803
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 291
* EL6311.cbl
 15805
 15806***************************************************************
 15807*                                                             *
 15808*       B U I L D   C O R R E C T I O N   R E C O R D         *
 15809*                                                             *
 15810***************************************************************
 15811
 15812***************************************************************
 15813*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 15814*     AN ALREADY BILLED RECORD.                               *
 15815***************************************************************
 15816
 15817 2700-BUILD-CORRECTION-RECORD.
 15818     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15819     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15820     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 15821     MOVE '5'                    TO DC-OPTION-CODE.
 15822     PERFORM 9700-DATE-LINK.
 15823     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 15824
 15825     IF PB-CHG-COUNT = ZEROS
 15826        MOVE +1                  TO WS-SEQ-SAVE
 15827     ELSE
 15828        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 15829
 15830     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 15831     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 15832
 15833     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 15834
 15835     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 15836     MOVE 'A'                    TO JP-RECORD-TYPE.
 15837     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15838
 15839
 15840* EXEC CICS WRITE
 15841*        DATASET    (FILE-ID-ERPNDB)
 15842*        FROM       (PENDING-BUSINESS)
 15843*        RIDFLD     (PB-CONTROL-PRIMARY)
 15844*    END-EXEC.
 15845     MOVE LENGTH OF
 15846      PENDING-BUSINESS
 15847       TO DFHEIV11
 15848*    MOVE '&$ L                  ''   #00013891' TO DFHEIV0
 15849     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15850     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15851     MOVE X'2020233030303133383931' TO DFHEIV0(25:11)
 15852     CALL 'kxdfhei1' USING DFHEIV0,
 15853           FILE-ID-ERPNDB,
 15854           PENDING-BUSINESS,
 15855           DFHEIV11,
 15856           PB-CONTROL-PRIMARY,
 15857           DFHEIV99,
 15858           DFHEIV99
 15859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15860
 15861
 15862     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 292
* EL6311.cbl
 15863
 15864     PERFORM 8400-LOG-JOURNAL-RECORD.
 15865
 15866 2799-EXIT.
 15867      EXIT.
 15868
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 293
* EL6311.cbl
 15870
 15871******************************************************************
 15872*                                                                *
 15873*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 15874*                                                                *
 15875******************************************************************
 15876
 15877 2800-REWRITE-ISSUE-CERT-KEY.
 15878     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 15879
 15880     IF  BCERTNOL GREATER THAN ZEROS
 15881         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 15882
 15883     IF  BSUFIXL  GREATER THAN ZEROS
 15884         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 15885
 15886     IF  BEFFDTL  GREATER THAN ZEROS
 15887         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 15888
 15889 2810-READ-BY-ACCOUNT.
 15890
 15891* EXEC CICS HANDLE CONDITION
 15892*         NOTFND    (2820-PROCESS-REWRITE)
 15893*    END-EXEC.
 15894*    MOVE '"$I                   ! ; #00013925' TO DFHEIV0
 15895     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15897     MOVE X'3B20233030303133393235' TO DFHEIV0(25:11)
 15898     CALL 'kxdfhei1' USING DFHEIV0
 15899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15900
 15901
 15902
 15903* EXEC CICS READ
 15904*        SET     (ADDRESS OF PENDING-BUSINESS)
 15905*        DATASET (FILE-ID-ERPNDB2)
 15906*        RIDFLD  (ERPNDB-ALT-KEY)
 15907*    END-EXEC.
 15908*    MOVE '&"S        E          (   #00013929' TO DFHEIV0
 15909     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15911     MOVE X'2020233030303133393239' TO DFHEIV0(25:11)
 15912     CALL 'kxdfhei1' USING DFHEIV0,
 15913           FILE-ID-ERPNDB2,
 15914           DFHEIV20,
 15915           DFHEIV99,
 15916           ERPNDB-ALT-KEY,
 15917           DFHEIV99,
 15918           DFHEIV99,
 15919           DFHEIV99
 15920     SET ADDRESS OF PENDING-BUSINESS TO
 15921         DFHEIV20
 15922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15923
 15924
 15925     GO TO 2890-DUPLICATE-RECORD.
 15926
 15927  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 294
* EL6311.cbl
 15928
 15929* EXEC CICS HANDLE CONDITION
 15930*         NOTFND    (2885-RECORD-MISSING)
 15931*    END-EXEC.
 15932*    MOVE '"$I                   ! < #00013938' TO DFHEIV0
 15933     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15935     MOVE X'3C20233030303133393338' TO DFHEIV0(25:11)
 15936     CALL 'kxdfhei1' USING DFHEIV0
 15937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15938
 15939
 15940     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15941
 15942
 15943* EXEC CICS READ
 15944*        SET     (ADDRESS OF PENDING-BUSINESS)
 15945*        DATASET (FILE-ID-ERPNDB)
 15946*        RIDFLD  (ERPNDB-KEY)
 15947*        UPDATE
 15948*    END-EXEC.
 15949*    MOVE '&"S        EU         (   #00013944' TO DFHEIV0
 15950     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15951     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15952     MOVE X'2020233030303133393434' TO DFHEIV0(25:11)
 15953     CALL 'kxdfhei1' USING DFHEIV0,
 15954           FILE-ID-ERPNDB,
 15955           DFHEIV20,
 15956           DFHEIV99,
 15957           ERPNDB-KEY,
 15958           DFHEIV99,
 15959           DFHEIV99,
 15960           DFHEIV99
 15961     SET ADDRESS OF PENDING-BUSINESS TO
 15962         DFHEIV20
 15963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15964
 15965
 15966     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15967     MOVE 'D'                    TO JP-RECORD-TYPE.
 15968     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15969     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15970
 15971     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15972
 15973     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15974     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15975     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15976
 15977
 15978* EXEC CICS DELETE
 15979*        DATASET    (FILE-ID-ERPNDB)
 15980*    END-EXEC.
 15981*    MOVE '&(                    &   #00013962' TO DFHEIV0
 15982     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15983     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15984     MOVE X'2020233030303133393632' TO DFHEIV0(25:11)
 15985     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 295
* EL6311.cbl
 15986           FILE-ID-ERPNDB,
 15987           DFHEIV99,
 15988           DFHEIV99,
 15989           DFHEIV99,
 15990           DFHEIV99
 15991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15992
 15993
 15994     PERFORM 8400-LOG-JOURNAL-RECORD.
 15995
 15996
 15997* EXEC CICS GETMAIN
 15998*        SET      (ADDRESS OF PENDING-BUSINESS)
 15999*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16000*        INITIMG  (GETMAIN-SPACE)
 16001*    END-EXEC.
 16002*    MOVE ',"IL                  $   #00013968' TO DFHEIV0
 16003     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16004     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16005     MOVE X'2020233030303133393638' TO DFHEIV0(25:11)
 16006     CALL 'kxdfhei1' USING DFHEIV0,
 16007           DFHEIV20,
 16008           ERPNDB-RECORD-LENGTH,
 16009           GETMAIN-SPACE
 16010     SET ADDRESS OF PENDING-BUSINESS TO
 16011         DFHEIV20
 16012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16013
 16014
 16015     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16016
 16017
 16018* EXEC CICS HANDLE CONDITION
 16019*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16020*    END-EXEC.
 16021*    MOVE '"$I                   ! = #00013976' TO DFHEIV0
 16022     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16023     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16024     MOVE X'3D20233030303133393736' TO DFHEIV0(25:11)
 16025     CALL 'kxdfhei1' USING DFHEIV0
 16026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16027
 16028
 16029
 16030* EXEC CICS READ
 16031*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16032*        DATASET (FILE-ID-ELCERT)
 16033*        RIDFLD  (ELCERT-KEY)
 16034*        UPDATE
 16035*    END-EXEC.
 16036*    MOVE '&"S        EU         (   #00013980' TO DFHEIV0
 16037     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16038     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16039     MOVE X'2020233030303133393830' TO DFHEIV0(25:11)
 16040     CALL 'kxdfhei1' USING DFHEIV0,
 16041           FILE-ID-ELCERT,
 16042           DFHEIV20,
 16043           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 296
* EL6311.cbl
 16044           ELCERT-KEY,
 16045           DFHEIV99,
 16046           DFHEIV99,
 16047           DFHEIV99
 16048     SET ADDRESS OF CERTIFICATE-MASTER TO
 16049         DFHEIV20
 16050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16051
 16052
 16053     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16054     MOVE 'B'                    TO JP-RECORD-TYPE
 16055     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16056     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16057
 16058     IF INSURED-ADDR-PRESENT
 16059        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16060
 16061     IF CERT-NOTES-ARE-NOT-PRESENT
 16062        MOVE SPACE               TO WS-CERT-NOTE-SW
 16063     ELSE
 16064        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16065
 16066     IF CERT-ADDED-BATCH      OR
 16067        CERT-AND-CLAIM-ONLINE OR
 16068        CERT-WAS-CREATED-FOR-CLAIM
 16069        NEXT SENTENCE
 16070     ELSE
 16071        GO TO 2825-DELETE-CERTIFICATE.
 16072
 16073     PERFORM 8400-LOG-JOURNAL-RECORD.
 16074
 16075*********************************************************
 16076** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16077     IF CERT-ADDED-BATCH
 16078         GO TO 2822-REWRITE-ELCERT.
 16079*********************************************************
 16080
 16081     IF NO-CLAIM-ATTACHED
 16082        NEXT SENTENCE
 16083     ELSE
 16084        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16085        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16086
 16087 2822-REWRITE-ELCERT.
 16088     MOVE 'C'                    TO JP-RECORD-TYPE
 16089     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16090
 16091     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16092
 16093
 16094* EXEC CICS REWRITE
 16095*         DATASET    (FILE-ID-ELCERT)
 16096*         FROM       (CERTIFICATE-MASTER)
 16097*    END-EXEC.
 16098     MOVE LENGTH OF
 16099      CERTIFICATE-MASTER
 16100       TO DFHEIV11
 16101*    MOVE '&& L                  %   #00014027' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 297
* EL6311.cbl
 16102     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16103     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16104     MOVE X'2020233030303134303237' TO DFHEIV0(25:11)
 16105     CALL 'kxdfhei1' USING DFHEIV0,
 16106           FILE-ID-ELCERT,
 16107           CERTIFICATE-MASTER,
 16108           DFHEIV11,
 16109           DFHEIV99
 16110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16111
 16112
 16113     PERFORM 8400-LOG-JOURNAL-RECORD.
 16114
 16115     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16116
 16117 2825-DELETE-CERTIFICATE.
 16118     MOVE 'D'                      TO JP-RECORD-TYPE.
 16119     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16120
 16121     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16122
 16123
 16124* EXEC CICS DELETE
 16125*         DATASET    (FILE-ID-ELCERT)
 16126*    END-EXEC.
 16127*    MOVE '&(                    &   #00014042' TO DFHEIV0
 16128     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16129     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16130     MOVE X'2020233030303134303432' TO DFHEIV0(25:11)
 16131     CALL 'kxdfhei1' USING DFHEIV0,
 16132           FILE-ID-ELCERT,
 16133           DFHEIV99,
 16134           DFHEIV99,
 16135           DFHEIV99,
 16136           DFHEIV99
 16137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16138
 16139
 16140     PERFORM 8400-LOG-JOURNAL-RECORD.
 16141
 16142******************************************************************
 16143*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 16144******************************************************************
 16145
 16146     IF CERT-NOTES-ARE-PRESENT
 16147        NEXT SENTENCE
 16148     ELSE
 16149        GO TO 2827-DELETE-MAILING.
 16150
 16151
 16152* EXEC CICS HANDLE CONDITION
 16153*         NOTFND  (2827-DELETE-MAILING)
 16154*    END-EXEC.
 16155*    MOVE '"$I                   ! > #00014057' TO DFHEIV0
 16156     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16158     MOVE X'3E20233030303134303537' TO DFHEIV0(25:11)
 16159     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 298
* EL6311.cbl
 16160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16161
 16162
 16163
 16164* EXEC CICS READ
 16165*        EQUAL
 16166*        DATASET   (FILE-ID-ERNOTE)
 16167*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 16168*        RIDFLD    (ELCERT-KEY)
 16169*        UPDATE
 16170*    END-EXEC.
 16171*    MOVE '&"S        EU         (   #00014061' TO DFHEIV0
 16172     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16173     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16174     MOVE X'2020233030303134303631' TO DFHEIV0(25:11)
 16175     CALL 'kxdfhei1' USING DFHEIV0,
 16176           FILE-ID-ERNOTE,
 16177           DFHEIV20,
 16178           DFHEIV99,
 16179           ELCERT-KEY,
 16180           DFHEIV99,
 16181           DFHEIV99,
 16182           DFHEIV99
 16183     SET ADDRESS OF CERTIFICATE-NOTE TO
 16184         DFHEIV20
 16185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16186
 16187
 16188     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 16189     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16190     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 16191
 16192     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16193
 16194
 16195* EXEC CICS DELETE
 16196*        DATASET   (FILE-ID-ERNOTE)
 16197*    END-EXEC.
 16198*    MOVE '&(                    &   #00014075' TO DFHEIV0
 16199     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16200     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16201     MOVE X'2020233030303134303735' TO DFHEIV0(25:11)
 16202     CALL 'kxdfhei1' USING DFHEIV0,
 16203           FILE-ID-ERNOTE,
 16204           DFHEIV99,
 16205           DFHEIV99,
 16206           DFHEIV99,
 16207           DFHEIV99
 16208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16209
 16210
 16211     PERFORM 8400-LOG-JOURNAL-RECORD.
 16212
 16213******************************************************************
 16214*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 16215******************************************************************
 16216
 16217 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 299
* EL6311.cbl
 16218     IF CERT-ADDRESS-PRESENT
 16219        NEXT SENTENCE
 16220     ELSE
 16221        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16222
 16223
 16224* EXEC CICS HANDLE CONDITION
 16225*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 16226*    END-EXEC.
 16227*    MOVE '"$I                   ! ? #00014091' TO DFHEIV0
 16228     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16229     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16230     MOVE X'3F20233030303134303931' TO DFHEIV0(25:11)
 16231     CALL 'kxdfhei1' USING DFHEIV0
 16232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16233
 16234
 16235     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 16236
 16237
 16238* EXEC CICS READ
 16239*        EQUAL
 16240*        DATASET   (FILE-ID-ERMAIL)
 16241*        SET       (ADDRESS OF MAILING-DATA)
 16242*        RIDFLD    (ERMAIL-KEY)
 16243*        UPDATE
 16244*    END-EXEC.
 16245*    MOVE '&"S        EU         (   #00014097' TO DFHEIV0
 16246     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16247     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16248     MOVE X'2020233030303134303937' TO DFHEIV0(25:11)
 16249     CALL 'kxdfhei1' USING DFHEIV0,
 16250           FILE-ID-ERMAIL,
 16251           DFHEIV20,
 16252           DFHEIV99,
 16253           ERMAIL-KEY,
 16254           DFHEIV99,
 16255           DFHEIV99,
 16256           DFHEIV99
 16257     SET ADDRESS OF MAILING-DATA TO
 16258         DFHEIV20
 16259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16260
 16261
 16262     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 16263     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16264     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 16265
 16266     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 16267
 16268
 16269* EXEC CICS DELETE
 16270*        DATASET   (FILE-ID-ERMAIL)
 16271*    END-EXEC.
 16272*    MOVE '&(                    &   #00014111' TO DFHEIV0
 16273     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16274     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16275     MOVE X'2020233030303134313131' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 300
* EL6311.cbl
 16276     CALL 'kxdfhei1' USING DFHEIV0,
 16277           FILE-ID-ERMAIL,
 16278           DFHEIV99,
 16279           DFHEIV99,
 16280           DFHEIV99,
 16281           DFHEIV99
 16282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16283
 16284
 16285     PERFORM 8400-LOG-JOURNAL-RECORD.
 16286
 16287 2830-BUILD-NEW-ISSUE-RECORD.
 16288     MOVE SPACES                 TO ELCERT-KEY.
 16289
 16290     IF  BCERTNOL GREATER THAN ZEROS
 16291         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 16292
 16293     IF  BSUFIXL  GREATER THAN ZEROS
 16294         MOVE BSUFIXI            TO  PB-CERT-SFX.
 16295
 16296     IF BEFFDTL GREATER THAN ZEROS
 16297        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 16298
 16299 2870-WRITE-PENDING-BUSINESS.
 16300     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16301     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16302     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16303     MOVE '5'                    TO DC-OPTION-CODE.
 16304     PERFORM 9700-DATE-LINK.
 16305     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16306
 16307     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16308
 16309     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16310     MOVE 'A'                    TO JP-RECORD-TYPE.
 16311     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16312
 16313
 16314* EXEC CICS WRITE
 16315*        DATASET  (FILE-ID-ERPNDB)
 16316*        FROM     (PENDING-BUSINESS)
 16317*        RIDFLD   (PB-CONTROL-PRIMARY)
 16318*    END-EXEC.
 16319     MOVE LENGTH OF
 16320      PENDING-BUSINESS
 16321       TO DFHEIV11
 16322*    MOVE '&$ L                  ''   #00014143' TO DFHEIV0
 16323     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16324     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16325     MOVE X'2020233030303134313433' TO DFHEIV0(25:11)
 16326     CALL 'kxdfhei1' USING DFHEIV0,
 16327           FILE-ID-ERPNDB,
 16328           PENDING-BUSINESS,
 16329           DFHEIV11,
 16330           PB-CONTROL-PRIMARY,
 16331           DFHEIV99,
 16332           DFHEIV99
 16333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 301
* EL6311.cbl
 16334
 16335
 16336     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 16337
 16338     PERFORM 8400-LOG-JOURNAL-RECORD.
 16339
 16340     GO TO 1325-PROCESS-ISSUE-CHANGES.
 16341
 16342 2885-RECORD-MISSING.
 16343     MOVE -1                     TO BMAINTL
 16344     MOVE AL-UABON               TO BMAINTA
 16345     MOVE ER-2902                TO EMI-ERROR.
 16346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16347     GO TO 8200-SEND-DATAONLY.
 16348
 16349 2890-DUPLICATE-RECORD.
 16350     MOVE -1                     TO BMAINTL.
 16351     MOVE AL-UABON               TO BCERTNOA.
 16352     MOVE AL-UNBON               TO BEFFDTA.
 16353     MOVE SPACE                  TO BMAINTI.
 16354
 16355     MOVE 1                      TO EMI-SUB
 16356                                    EMI-SWITCH1
 16357                                    EMI-SWITCH-AREA-1
 16358                                    EMI-SWITCH-AREA-2.
 16359
 16360     MOVE SPACES                 TO EMI-ERROR-LINES.
 16361
 16362
 16363* EXEC CICS SYNCPOINT ROLLBACK
 16364*    END-EXEC.
 16365*    MOVE '6"R                   !   #00014175' TO DFHEIV0
 16366     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16367     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16368     MOVE X'2020233030303134313735' TO DFHEIV0(25:11)
 16369     CALL 'kxdfhei1' USING DFHEIV0
 16370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16371
 16372
 16373     MOVE ER-2247                TO EMI-ERROR.
 16374     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 16375     GO TO 8200-SEND-DATAONLY.
 16376
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 302
* EL6311.cbl
 16378
 16379******************************************************************
 16380*                                                                *
 16381*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 16382*                                                                *
 16383******************************************************************
 16384
 16385 2900-REWRITE-CAN-CERT-KEY.
 16386     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16387
 16388     IF  CCERTNOL GREATER THAN ZEROS
 16389         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 16390
 16391     IF  CSUFIXL  GREATER THAN ZEROS
 16392         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 16393
 16394     IF  CEFFDTL  GREATER THAN ZEROS
 16395         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16396
 16397 2910-READ-BY-ACCOUNT.
 16398
 16399* EXEC CICS HANDLE CONDITION
 16400*         NOTFND    (2920-PROCESS-REWRITE)
 16401*    END-EXEC.
 16402*    MOVE '"$I                   ! @ #00014203' TO DFHEIV0
 16403     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16405     MOVE X'4020233030303134323033' TO DFHEIV0(25:11)
 16406     CALL 'kxdfhei1' USING DFHEIV0
 16407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16408
 16409
 16410
 16411* EXEC CICS READ
 16412*        SET     (ADDRESS OF PENDING-BUSINESS)
 16413*        DATASET (FILE-ID-ERPNDB2)
 16414*        RIDFLD  (ERPNDB-ALT-KEY)
 16415*    END-EXEC.
 16416*    MOVE '&"S        E          (   #00014207' TO DFHEIV0
 16417     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16418     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16419     MOVE X'2020233030303134323037' TO DFHEIV0(25:11)
 16420     CALL 'kxdfhei1' USING DFHEIV0,
 16421           FILE-ID-ERPNDB2,
 16422           DFHEIV20,
 16423           DFHEIV99,
 16424           ERPNDB-ALT-KEY,
 16425           DFHEIV99,
 16426           DFHEIV99,
 16427           DFHEIV99
 16428     SET ADDRESS OF PENDING-BUSINESS TO
 16429         DFHEIV20
 16430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16431
 16432
 16433     GO TO 2990-DUPLICATE-RECORD.
 16434
 16435  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 303
* EL6311.cbl
 16436
 16437* EXEC CICS HANDLE CONDITION
 16438*         NOTFND    (2985-RECORD-MISSING)
 16439*    END-EXEC.
 16440*    MOVE '"$I                   ! A #00014216' TO DFHEIV0
 16441     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16443     MOVE X'4120233030303134323136' TO DFHEIV0(25:11)
 16444     CALL 'kxdfhei1' USING DFHEIV0
 16445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16446
 16447
 16448     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16449
 16450
 16451* EXEC CICS READ
 16452*        SET     (ADDRESS OF PENDING-BUSINESS)
 16453*        DATASET (FILE-ID-ERPNDB)
 16454*        RIDFLD  (ERPNDB-KEY)
 16455*        UPDATE
 16456*    END-EXEC.
 16457*    MOVE '&"S        EU         (   #00014222' TO DFHEIV0
 16458     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16459     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16460     MOVE X'2020233030303134323232' TO DFHEIV0(25:11)
 16461     CALL 'kxdfhei1' USING DFHEIV0,
 16462           FILE-ID-ERPNDB,
 16463           DFHEIV20,
 16464           DFHEIV99,
 16465           ERPNDB-KEY,
 16466           DFHEIV99,
 16467           DFHEIV99,
 16468           DFHEIV99
 16469     SET ADDRESS OF PENDING-BUSINESS TO
 16470         DFHEIV20
 16471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16472
 16473
 16474     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16475     MOVE 'D'                    TO JP-RECORD-TYPE.
 16476     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16477     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16478
 16479     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16480
 16481     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16482     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16483     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16484
 16485
 16486* EXEC CICS DELETE
 16487*        DATASET    (FILE-ID-ERPNDB)
 16488*    END-EXEC.
 16489*    MOVE '&(                    &   #00014240' TO DFHEIV0
 16490     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16491     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16492     MOVE X'2020233030303134323430' TO DFHEIV0(25:11)
 16493     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 304
* EL6311.cbl
 16494           FILE-ID-ERPNDB,
 16495           DFHEIV99,
 16496           DFHEIV99,
 16497           DFHEIV99,
 16498           DFHEIV99
 16499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16500
 16501
 16502     PERFORM 8400-LOG-JOURNAL-RECORD.
 16503
 16504
 16505* EXEC CICS GETMAIN
 16506*        SET      (ADDRESS OF PENDING-BUSINESS)
 16507*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16508*        INITIMG  (GETMAIN-SPACE)
 16509*    END-EXEC.
 16510*    MOVE ',"IL                  $   #00014246' TO DFHEIV0
 16511     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16512     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16513     MOVE X'2020233030303134323436' TO DFHEIV0(25:11)
 16514     CALL 'kxdfhei1' USING DFHEIV0,
 16515           DFHEIV20,
 16516           ERPNDB-RECORD-LENGTH,
 16517           GETMAIN-SPACE
 16518     SET ADDRESS OF PENDING-BUSINESS TO
 16519         DFHEIV20
 16520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16521
 16522
 16523     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16524
 16525 2950-PROCESS-CANCELS.
 16526
 16527
 16528* EXEC CICS HANDLE CONDITION
 16529*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 16530*    END-EXEC.
 16531*    MOVE '"$I                   ! B #00014256' TO DFHEIV0
 16532     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16534     MOVE X'4220233030303134323536' TO DFHEIV0(25:11)
 16535     CALL 'kxdfhei1' USING DFHEIV0
 16536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16537
 16538
 16539
 16540* EXEC CICS READ
 16541*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16542*        DATASET (FILE-ID-ELCERT)
 16543*        RIDFLD  (ELCERT-KEY)
 16544*        UPDATE
 16545*    END-EXEC.
 16546*    MOVE '&"S        EU         (   #00014260' TO DFHEIV0
 16547     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16548     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16549     MOVE X'2020233030303134323630' TO DFHEIV0(25:11)
 16550     CALL 'kxdfhei1' USING DFHEIV0,
 16551           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 305
* EL6311.cbl
 16552           DFHEIV20,
 16553           DFHEIV99,
 16554           ELCERT-KEY,
 16555           DFHEIV99,
 16556           DFHEIV99,
 16557           DFHEIV99
 16558     SET ADDRESS OF CERTIFICATE-MASTER TO
 16559         DFHEIV20
 16560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16561
 16562
 16563     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16564
 16565     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16566     MOVE 'B'                      TO JP-RECORD-TYPE.
 16567     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16568     PERFORM 8400-LOG-JOURNAL-RECORD.
 16569
 16570     IF PB-CI-LIVES NOT NUMERIC
 16571         MOVE ZERO                    TO PB-CI-LIVES.
 16572
 16573     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16574        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16575        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16576        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16577                                         CM-LF-CANCEL-DT
 16578     ELSE
 16579        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16580        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16581        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16582        MOVE PB-CI-LIVES              TO CM-LIVES.
 16583
 16584     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16585        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16586            MOVE CM-LF-STATUS-AT-CANCEL
 16587                                     TO CM-LF-CURRENT-STATUS
 16588            MOVE SPACE
 16589                                     TO CM-LF-STATUS-AT-CANCEL
 16590        ELSE
 16591            MOVE PB-CI-LF-POLICY-STATUS
 16592                                     TO CM-LF-CURRENT-STATUS
 16593     ELSE
 16594        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16595
 16596     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16597        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16598        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16599        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16600                                         CM-AH-CANCEL-DT
 16601     ELSE
 16602        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16603        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16604        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16605        MOVE PB-CI-LIVES              TO CM-LIVES.
 16606
 16607     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16608        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16609            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 306
* EL6311.cbl
 16610                                     TO CM-AH-CURRENT-STATUS
 16611            MOVE SPACE
 16612                                     TO CM-AH-STATUS-AT-CANCEL
 16613        ELSE
 16614            MOVE PB-CI-AH-POLICY-STATUS
 16615                                     TO CM-AH-CURRENT-STATUS
 16616     ELSE
 16617        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16618
 16619 2975-REWRITE-CERT.
 16620     MOVE 'C'                      TO JP-RECORD-TYPE.
 16621     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16622
 16623
 16624* EXEC CICS REWRITE
 16625*        DATASET    (FILE-ID-ELCERT)
 16626*        FROM       (CERTIFICATE-MASTER)
 16627*    END-EXEC.
 16628     MOVE LENGTH OF
 16629      CERTIFICATE-MASTER
 16630       TO DFHEIV11
 16631*    MOVE '&& L                  %   #00014327' TO DFHEIV0
 16632     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16633     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16634     MOVE X'2020233030303134333237' TO DFHEIV0(25:11)
 16635     CALL 'kxdfhei1' USING DFHEIV0,
 16636           FILE-ID-ELCERT,
 16637           CERTIFICATE-MASTER,
 16638           DFHEIV11,
 16639           DFHEIV99
 16640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16641
 16642
 16643     PERFORM 8400-LOG-JOURNAL-RECORD.
 16644
 16645 2960-BUILD-NEW-CANCEL-RECORD.
 16646     IF  CCERTNOL GREATER THAN ZEROS
 16647         MOVE CCERTNOI            TO PB-CERT-PRIME.
 16648
 16649     IF  CSUFIXL  GREATER THAN ZEROS
 16650         MOVE CSUFIXI             TO PB-CERT-SFX.
 16651
 16652     IF  CEFFDTL  GREATER  THAN ZEROS
 16653         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 16654
 16655 2970-WRITE-PENDING-BUSINESS.
 16656     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16657     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16658     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16659     MOVE '5'                    TO DC-OPTION-CODE.
 16660     PERFORM 9700-DATE-LINK.
 16661     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16662
 16663     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16664
 16665     MOVE SPACES                 TO PB-CI-INSURED-NAME
 16666                                    PB-CI-INSURED-SEX
 16667                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 307
* EL6311.cbl
 16668                                    PB-CI-AH-BENEFIT-CD
 16669                                    PB-CI-RATE-CLASS
 16670                                    PB-CI-RATE-DEV-LF
 16671                                    PB-CI-RATE-DEV-AH
 16672                                    PB-CI-LF-ABBR
 16673                                    PB-CI-AH-ABBR
 16674                                    PB-CI-OB-FLAG
 16675                                    PB-CI-LF-POLICY-STATUS
 16676                                    PB-CI-AH-POLICY-STATUS
 16677                                    PB-CI-INDV-GRP-CD
 16678                                    PB-CI-BENEFICIARY-NAME
 16679                                    PB-CI-NOTE-SW
 16680                                    PB-CI-SOC-SEC-NO
 16681                                    PB-CI-MEMBER-NO
 16682                                    PB-CI-INT-CODE
 16683                                    PB-CI-COMP-EXCP-SW
 16684                                    PB-CI-ENTRY-STATUS
 16685                                    PB-CI-CREDIT-INTERFACE-SW-1
 16686                                    PB-CI-CREDIT-INTERFACE-SW-2
 16687                                    PB-CI-ENTRY-BATCH.
 16688
 16689     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 16690                                    PB-CI-AH-SETTLEMENT-DT
 16691                                    PB-CI-DEATH-DT
 16692                                    PB-CI-LF-PRIOR-CANCEL-DT
 16693                                    PB-CI-AH-PRIOR-CANCEL-DT
 16694                                    PB-CI-LOAN-1ST-PMT-DT
 16695                                    PB-CI-ENTRY-DT
 16696                                    PB-CI-LF-EXPIRE-DT
 16697                                    PB-CI-AH-EXPIRE-DT.
 16698
 16699     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 16700                                    PB-CI-LF-TERM
 16701                                    PB-CI-LF-BENEFIT-AMT
 16702                                    PB-CI-LF-ALT-BENEFIT-AMT
 16703                                    PB-CI-LF-PREMIUM-AMT
 16704                                    PB-CI-LF-ALT-PREMIUM-AMT
 16705                                    PB-CI-AH-TERM
 16706                                    PB-CI-AH-BENEFIT-AMT
 16707                                    PB-CI-AH-PREMIUM-AMT
 16708                                    PB-CI-RATE-DEV-PCT-LF
 16709                                    PB-CI-RATE-DEV-PCT-AH
 16710                                    PB-CI-LIFE-COMMISSION
 16711                                    PB-CI-AH-COMMISSION
 16712                                    PB-CI-PAY-FREQUENCY
 16713                                    PB-CI-LOAN-APR
 16714                                    PB-CI-LOAN-TERM
 16715                                    PB-CI-CURR-SEQ
 16716                                    PB-CI-AH-CANCEL-AMT
 16717                                    PB-CI-LF-CANCEL-AMT
 16718                                    PB-CI-EXTENTION-DAYS
 16719                                    PB-CI-TERM-IN-DAYS
 16720                                    PB-CI-LOAN-OFFICER
 16721                                    PB-CI-LIVES
 16722                                    PB-CI-LF-CRIT-PER
 16723                                    PB-CI-AH-CRIT-PER
 16724                                    PB-C-LF-REM-TERM
 16725                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 308
* EL6311.cbl
 16726
 16727     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16728     MOVE 'A'                    TO JP-RECORD-TYPE.
 16729     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16730
 16731
 16732* EXEC CICS HANDLE CONDITION
 16733*        DUPREC   (2990-DUPLICATE-RECORD)
 16734*    END-EXEC.
 16735*    MOVE '"$%                   ! C #00014420' TO DFHEIV0
 16736     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16737     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16738     MOVE X'4320233030303134343230' TO DFHEIV0(25:11)
 16739     CALL 'kxdfhei1' USING DFHEIV0
 16740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16741
 16742
 16743
 16744* EXEC CICS WRITE
 16745*        DATASET  (FILE-ID-ERPNDB)
 16746*        FROM     (PENDING-BUSINESS)
 16747*        RIDFLD   (PB-CONTROL-PRIMARY)
 16748*    END-EXEC.
 16749     MOVE LENGTH OF
 16750      PENDING-BUSINESS
 16751       TO DFHEIV11
 16752*    MOVE '&$ L                  ''   #00014424' TO DFHEIV0
 16753     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16754     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16755     MOVE X'2020233030303134343234' TO DFHEIV0(25:11)
 16756     CALL 'kxdfhei1' USING DFHEIV0,
 16757           FILE-ID-ERPNDB,
 16758           PENDING-BUSINESS,
 16759           DFHEIV11,
 16760           PB-CONTROL-PRIMARY,
 16761           DFHEIV99,
 16762           DFHEIV99
 16763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16764
 16765
 16766     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16767
 16768     PERFORM 8400-LOG-JOURNAL-RECORD.
 16769
 16770     GO TO 2325-PROCESS-CANCEL-CHANGES.
 16771
 16772 2985-RECORD-MISSING.
 16773     MOVE -1                     TO CMAINTL
 16774     MOVE AL-UABON               TO CMAINTA.
 16775
 16776     MOVE ER-2902                TO EMI-ERROR.
 16777     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16778     GO TO 8200-SEND-DATAONLY.
 16779
 16780 2990-DUPLICATE-RECORD.
 16781     MOVE SPACE                  TO CMAINTI.
 16782     MOVE -1                     TO CMAINTL.
 16783     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 309
* EL6311.cbl
 16784     MOVE AL-UNBON               TO CEFFDTA.
 16785
 16786     MOVE 1                      TO EMI-SUB
 16787                                    EMI-SWITCH1
 16788                                    EMI-SWITCH-AREA-1
 16789                                    EMI-SWITCH-AREA-2.
 16790     MOVE SPACES                 TO EMI-ERROR-LINES.
 16791
 16792
 16793* EXEC CICS SYNCPOINT ROLLBACK
 16794*    END-EXEC.
 16795*    MOVE '6"R                   !   #00014456' TO DFHEIV0
 16796     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16797     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16798     MOVE X'2020233030303134343536' TO DFHEIV0(25:11)
 16799     CALL 'kxdfhei1' USING DFHEIV0
 16800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16801
 16802
 16803     MOVE ER-2247                TO EMI-ERROR.
 16804     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16805     GO TO 8200-SEND-DATAONLY.
 16806
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 310
* EL6311.cbl
 16808
 16809***************************************************************
 16810*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 16811*     PREMIUM FOR A SINGLE BATCH.                             *
 16812*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 16813***************************************************************
 16814
 16815 3000-BATCH-MAINLINE.
 16816     IF PI-PREV-KEY NOT = SPACES
 16817         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 16818     ELSE
 16819         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 16820
 16821     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 16822
 16823 3010-READNEXT.
 16824
 16825* EXEC CICS READ
 16826*         DATASET    (FILE-ID-ERPNDB)
 16827*         SET        (ADDRESS OF PENDING-BUSINESS)
 16828*         RIDFLD     (ERPNDB-KEY)
 16829*         GTEQ
 16830*    END-EXEC.
 16831*    MOVE '&"S        G          (   #00014480' TO DFHEIV0
 16832     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16834     MOVE X'2020233030303134343830' TO DFHEIV0(25:11)
 16835     CALL 'kxdfhei1' USING DFHEIV0,
 16836           FILE-ID-ERPNDB,
 16837           DFHEIV20,
 16838           DFHEIV99,
 16839           ERPNDB-KEY,
 16840           DFHEIV99,
 16841           DFHEIV99,
 16842           DFHEIV99
 16843     SET ADDRESS OF PENDING-BUSINESS TO
 16844         DFHEIV20
 16845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16846
 16847
 16848     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 16849        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 16850          GO TO 3030-END-BATCH.
 16851
 16852     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 16853
 16854     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16855        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16856          GO TO 3020-BUMP-SEQ.
 16857
 16858     IF PB-ISSUE
 16859        ADD +1                   TO WS-ISS-TOTAL-CNT
 16860        IF PB-FATAL-ERRORS
 16861           ADD +1                      TO WS-ISS-FATAL-CNT
 16862           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 16863           GO TO 3020-BUMP-SEQ
 16864        ELSE
 16865           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 311
* EL6311.cbl
 16866              ADD +1                      TO WS-ISS-FORCE-CNT
 16867              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 16868              GO TO 3020-BUMP-SEQ
 16869           ELSE
 16870              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 16871                 ADD +1                      TO WS-ISS-HOLD-CNT
 16872                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 16873                 GO TO 3020-BUMP-SEQ
 16874              ELSE
 16875                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 16876                     THRU  3299-EXIT
 16877                 GO TO 3020-BUMP-SEQ.
 16878
 16879     IF PB-CANCELLATION
 16880        ADD +1                   TO WS-CAN-TOTAL-CNT
 16881        IF PB-FATAL-ERRORS
 16882           ADD +1                 TO WS-CAN-FATAL-CNT
 16883           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 16884           GO TO 3020-BUMP-SEQ
 16885        ELSE
 16886           IF PB-UNFORCED-ERRORS
 16887              ADD +1                 TO WS-CAN-FORCE-CNT
 16888              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 16889              GO TO 3020-BUMP-SEQ
 16890           ELSE
 16891              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 16892                 ADD +1                 TO WS-CAN-HOLD-CNT
 16893                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 16894                 GO TO 3020-BUMP-SEQ
 16895              ELSE
 16896                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 16897                     THRU  3499-EXIT
 16898                 GO TO 3020-BUMP-SEQ.
 16899
 16900     IF PB-BATCH-TRAILER
 16901         GO TO 3030-END-BATCH.
 16902
 16903 3020-BUMP-SEQ.
 16904     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 16905     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16906     GO TO 3010-READNEXT.
 16907
 16908 3030-END-BATCH.
 16909     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 16910     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 16911     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 16912     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 16913
 16914     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 16915                                          - WS-ISS-FORCE-CNT
 16916                                          - WS-ISS-HOLD-CNT).
 16917
 16918     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 16919     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 16920
 16921     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 16922     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 16923     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 312
* EL6311.cbl
 16924     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 16925     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 16926                                          - WS-CAN-FORCE-CNT
 16927                                          - WS-CAN-HOLD-CNT).
 16928     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 16929     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 16930
 16931     COMPUTE WS-NET-TOTAL-CNT
 16932         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 16933     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 16934     COMPUTE WS-NET-FATAL-CNT
 16935         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 16936     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 16937     COMPUTE WS-NET-FORCE-CNT
 16938         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 16939     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 16940     COMPUTE WS-NET-HOLD-CNT
 16941         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 16942     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 16943
 16944     COMPUTE WS-NET-AVAIL-CNT
 16945          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 16946                              - WS-ISS-FORCE-CNT
 16947                              - WS-ISS-HOLD-CNT)
 16948          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 16949                              - WS-CAN-FORCE-CNT
 16950                              - WS-CAN-HOLD-CNT).
 16951     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 16952
 16953     COMPUTE WS-NET-GOOD-PREM
 16954         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 16955     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 16956     COMPUTE WS-NET-BAD-PREM
 16957         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 16958     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 16959
 16960     MOVE 0000                   TO EMI-ERROR.
 16961     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16962     MOVE -1                     TO DPFENTRL.
 16963     GO TO 8200-SEND-DATAONLY.
 16964
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 313
* EL6311.cbl
 16966
 16967******************************************************************
 16968*                                                                *
 16969*           A D D    B A D   I S S U E   P R E M I U M           *
 16970*                                                                *
 16971******************************************************************
 16972
 16973 3100-ADD-BAD-ISSUE-PREM.
 16974     IF PB-OVERRIDE-LIFE
 16975       OR PB-OVERRIDE-BOTH
 16976           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 16977           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 16978       ELSE
 16979           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 16980           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 16981
 16982     IF PB-OVERRIDE-AH
 16983       OR PB-OVERRIDE-BOTH
 16984           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 16985       ELSE
 16986           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 16987
 16988 3199-EXIT.
 16989     EXIT.
 16990
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 314
* EL6311.cbl
 16992
 16993******************************************************************
 16994*                                                                *
 16995*       A D D   G O O D   I S S U E   P R E M I U M              *
 16996*                                                                *
 16997******************************************************************
 16998
 16999 3200-ADD-GOOD-ISSUE-PREM.
 17000     IF PB-OVERRIDE-LIFE
 17001       OR PB-OVERRIDE-BOTH
 17002           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17003           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17004       ELSE
 17005           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17006           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17007
 17008     IF PB-OVERRIDE-AH
 17009       OR PB-OVERRIDE-BOTH
 17010           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17011       ELSE
 17012           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17013
 17014 3299-EXIT.
 17015     EXIT.
 17016
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 315
* EL6311.cbl
 17018
 17019
 17020******************************************************************
 17021*                                                                *
 17022*        A D D   B A D   C A N C E L   P R E M I U M             *
 17023*                                                                *
 17024******************************************************************
 17025
 17026 3300-ADD-BAD-CANCEL-PREM.
 17027     IF PB-OVERRIDE-LIFE
 17028       OR PB-OVERRIDE-BOTH
 17029           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17030       ELSE
 17031           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17032
 17033     IF PB-OVERRIDE-AH
 17034       OR PB-OVERRIDE-BOTH
 17035           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17036       ELSE
 17037           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17038
 17039 3399-EXIT.
 17040     EXIT.
 17041
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 316
* EL6311.cbl
 17043
 17044******************************************************************
 17045*                                                                *
 17046*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17047*                                                                *
 17048******************************************************************
 17049
 17050 3400-ADD-GOOD-CANCEL-PREM.
 17051     IF PB-OVERRIDE-LIFE
 17052       OR PB-OVERRIDE-BOTH
 17053           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17054       ELSE
 17055           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17056
 17057     IF PB-OVERRIDE-AH
 17058       OR PB-OVERRIDE-BOTH
 17059           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17060       ELSE
 17061           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17062
 17063 3499-EXIT.
 17064     EXIT.
 17065
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 317
* EL6311.cbl
 17067
 17068******************************************************************
 17069*                                                                *
 17070*           E D I T   B A T C H   D A T A                        *
 17071*                                                                *
 17072******************************************************************
 17073
 17074 3500-EDIT-BATCH-DATA.
 17075     IF PI-PREV-KEY NOT = SPACES
 17076        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17077     ELSE
 17078        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17079
 17080     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17081     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17082
 17083
 17084* EXEC CICS HANDLE CONDITION
 17085*         NOTFND      (3590-NOT-FOUND)
 17086*    END-EXEC.
 17087*    MOVE '"$I                   ! D #00014722' TO DFHEIV0
 17088     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17089     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17090     MOVE X'4420233030303134373232' TO DFHEIV0(25:11)
 17091     CALL 'kxdfhei1' USING DFHEIV0
 17092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17093
 17094
 17095     IF DRISSL   GREATER THAN ZEROS OR
 17096        DRISSL   GREATER THAN ZEROS OR
 17097        DRLFPRML GREATER THAN ZEROS OR
 17098        DRAHPRML GREATER THAN ZEROS OR
 17099        DRCANCL  GREATER THAN ZEROS OR
 17100        DRLFRFDL GREATER THAN ZEROS OR
 17101        DRAHRFDL GREATER THAN ZEROS
 17102              NEXT SENTENCE
 17103          ELSE
 17104              MOVE ER-3224    TO EMI-ERROR
 17105              MOVE -1         TO DPFENTRL
 17106              MOVE AL-UNBON   TO DPFENTRA
 17107              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17108              GO TO 8200-SEND-DATAONLY.
 17109
 17110     IF NOT MODIFY-CAP
 17111         MOVE 'UPDATE'       TO SM-READ
 17112         PERFORM 9995-SECURITY-VIOLATION
 17113         MOVE ER-0070        TO EMI-ERROR
 17114         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17115         GO TO 8100-SEND-INITIAL-MAP.
 17116
 17117        IF DRISSL GREATER THAN ZEROS
 17118           MOVE AL-UNNON         TO DRISSA
 17119           MOVE DRISSI           TO DEEDIT-FIELD
 17120           PERFORM 8600-DEEDIT
 17121           IF DEEDIT-FIELD-V0  NUMERIC
 17122              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 17123           ELSE
 17124              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 318
* EL6311.cbl
 17125              MOVE -1         TO DRISSL
 17126              MOVE AL-UNBON   TO DRISSA
 17127              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17128
 17129        IF DRLFPRML GREATER THAN ZEROS
 17130           MOVE AL-UNNON         TO DRLFPRMA
 17131
 17132* EXEC CICS BIF DEEDIT
 17133*              FIELD  (DRLFPRMI)
 17134*              LENGTH (11)
 17135*          END-EXEC
 17136     MOVE 11
 17137       TO DFHEIV11
 17138*    MOVE '@"L                   #   #00014762' TO DFHEIV0
 17139     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17140     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17141     MOVE X'2020233030303134373632' TO DFHEIV0(25:11)
 17142     CALL 'kxdfhei1' USING DFHEIV0,
 17143           DRLFPRMI,
 17144           DFHEIV11
 17145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17146           IF DRLFPRMI NUMERIC
 17147              MOVE DRLFPRMI   TO WS-DRLFPRM
 17148*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 17149*          PERFORM 8600-DEEDIT
 17150*          IF DEEDIT-FIELD-V2  NUMERIC
 17151*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 17152           ELSE
 17153              MOVE ER-2223    TO EMI-ERROR
 17154              MOVE -1         TO DRLFPRML
 17155              MOVE AL-UNBON   TO DRLFPRMA
 17156              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17157
 17158        IF DRAHPRML GREATER THAN ZEROS
 17159           MOVE AL-UNNON         TO DRAHPRMA
 17160
 17161* EXEC CICS BIF DEEDIT
 17162*              FIELD  (DRAHPRMI)
 17163*              LENGTH (11)
 17164*          END-EXEC
 17165     MOVE 11
 17166       TO DFHEIV11
 17167*    MOVE '@"L                   #   #00014780' TO DFHEIV0
 17168     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17169     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17170     MOVE X'2020233030303134373830' TO DFHEIV0(25:11)
 17171     CALL 'kxdfhei1' USING DFHEIV0,
 17172           DRAHPRMI,
 17173           DFHEIV11
 17174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17175           IF DRAHPRMI NUMERIC
 17176              MOVE DRAHPRMI   TO WS-DRAHPRM
 17177*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 17178*          PERFORM 8600-DEEDIT
 17179*          IF DEEDIT-FIELD-V2  NUMERIC
 17180*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 17181           ELSE
 17182              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 319
* EL6311.cbl
 17183              MOVE -1         TO DRAHPRML
 17184              MOVE AL-UNBON   TO DRAHPRMA
 17185              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17186
 17187        IF DRCANCL GREATER THAN ZEROS
 17188           MOVE AL-UNNON         TO DRCANCA
 17189           MOVE DRCANCI          TO DEEDIT-FIELD
 17190           PERFORM 8600-DEEDIT
 17191           IF DEEDIT-FIELD-V0  NUMERIC
 17192              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 17193           ELSE
 17194              MOVE ER-2223    TO EMI-ERROR
 17195              MOVE -1         TO DRCANCL
 17196              MOVE AL-UNBON   TO DRCANCL
 17197              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17198
 17199        IF DRLFRFDL GREATER THAN ZEROS
 17200           MOVE AL-UNNON         TO DRLFRFDA
 17201
 17202* EXEC CICS BIF DEEDIT
 17203*              FIELD  (DRLFRFDI)
 17204*              LENGTH (11)
 17205*          END-EXEC
 17206     MOVE 11
 17207       TO DFHEIV11
 17208*    MOVE '@"L                   #   #00014810' TO DFHEIV0
 17209     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17210     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17211     MOVE X'2020233030303134383130' TO DFHEIV0(25:11)
 17212     CALL 'kxdfhei1' USING DFHEIV0,
 17213           DRLFRFDI,
 17214           DFHEIV11
 17215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17216           IF DRLFRFDI NUMERIC
 17217              MOVE DRLFRFDI   TO WS-DRLFRFD
 17218*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 17219*          PERFORM 8600-DEEDIT
 17220*          IF DEEDIT-FIELD-V2  NUMERIC
 17221*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 17222           ELSE
 17223              MOVE ER-2223    TO EMI-ERROR
 17224              MOVE -1         TO DRLFRFDL
 17225              MOVE AL-UNBON   TO DRLFRFDA
 17226              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17227
 17228        IF DRAHRFDL GREATER THAN ZEROS
 17229           MOVE AL-UNNON         TO DRAHRFDA
 17230
 17231* EXEC CICS BIF DEEDIT
 17232*              FIELD  (DRAHRFDI)
 17233*              LENGTH (11)
 17234*          END-EXEC
 17235     MOVE 11
 17236       TO DFHEIV11
 17237*    MOVE '@"L                   #   #00014828' TO DFHEIV0
 17238     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17239     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17240     MOVE X'2020233030303134383238' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 320
* EL6311.cbl
 17241     CALL 'kxdfhei1' USING DFHEIV0,
 17242           DRAHRFDI,
 17243           DFHEIV11
 17244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17245           IF DRAHRFDI NUMERIC
 17246              MOVE DRAHRFDI   TO WS-DRAHRFD
 17247*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 17248*          PERFORM 8600-DEEDIT
 17249*          IF DEEDIT-FIELD-V2  NUMERIC
 17250*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 17251           ELSE
 17252              MOVE ER-2223    TO EMI-ERROR
 17253              MOVE -1         TO DRAHRFDL
 17254              MOVE AL-UNBON   TO DRAHRFDA
 17255              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17256
 17257     IF EMI-ERROR = ZEROS
 17258        GO 3600-UPDATE-BATCH-HEADER.
 17259
 17260     GO TO 8200-SEND-DATAONLY.
 17261
 17262 3590-NOT-FOUND.
 17263     MOVE ER-2192                TO EMI-ERROR.
 17264     MOVE -1                     TO DPFENTRL.
 17265     MOVE AL-UNBON               TO DPFENTRA.
 17266     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17267     GO TO 8200-SEND-DATAONLY.
 17268
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 321
* EL6311.cbl
 17270
 17271******************************************************************
 17272*                                                                *
 17273*           U P D A T E   B A T C H   H E A D E R                *
 17274*                                                                *
 17275******************************************************************
 17276
 17277 3600-UPDATE-BATCH-HEADER.
 17278
 17279* EXEC CICS HANDLE CONDITION
 17280*         NOTFND      (3690-NOT-FOUND)
 17281*    END-EXEC.
 17282*    MOVE '"$I                   ! E #00014865' TO DFHEIV0
 17283     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17285     MOVE X'4520233030303134383635' TO DFHEIV0(25:11)
 17286     CALL 'kxdfhei1' USING DFHEIV0
 17287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17288
 17289
 17290
 17291* EXEC CICS READ
 17292*        DATASET (FILE-ID-ERPNDB)
 17293*        RIDFLD  (ERPNDB-KEY)
 17294*        SET     (ADDRESS OF PENDING-BUSINESS)
 17295*        UPDATE
 17296*    END-EXEC.
 17297*    MOVE '&"S        EU         (   #00014869' TO DFHEIV0
 17298     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17299     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17300     MOVE X'2020233030303134383639' TO DFHEIV0(25:11)
 17301     CALL 'kxdfhei1' USING DFHEIV0,
 17302           FILE-ID-ERPNDB,
 17303           DFHEIV20,
 17304           DFHEIV99,
 17305           ERPNDB-KEY,
 17306           DFHEIV99,
 17307           DFHEIV99,
 17308           DFHEIV99
 17309     SET ADDRESS OF PENDING-BUSINESS TO
 17310         DFHEIV20
 17311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17312
 17313
 17314     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17315     MOVE 'B'                    TO JP-RECORD-TYPE.
 17316     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17317
 17318     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17319
 17320     PERFORM 8400-LOG-JOURNAL-RECORD.
 17321
 17322     IF DRISSL GREATER THAN ZEROS
 17323        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 17324
 17325     IF DRCANCL GREATER THAN ZEROS
 17326        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 17327
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 322
* EL6311.cbl
 17328
 17329     IF DRLFPRML GREATER THAN ZEROS
 17330        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 17331
 17332     IF DRAHPRML GREATER THAN ZEROS
 17333        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 17334
 17335     IF DRLFRFDL GREATER THAN ZEROS
 17336        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 17337
 17338     IF DRAHRFDL GREATER THAN ZEROS
 17339        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 17340
 17341 3670-REWRITE-BATCH-HEADER.
 17342     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 17343        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 17344        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 17345        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 17346        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 17347        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 17348        MOVE SPACE               TO PB-OUT-BAL-CD
 17349     ELSE
 17350        MOVE 'O'                 TO PB-OUT-BAL-CD.
 17351
 17352     MOVE 'C'                    TO JP-RECORD-TYPE.
 17353     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17354
 17355
 17356* EXEC CICS REWRITE
 17357*         DATASET      (FILE-ID-ERPNDB)
 17358*         FROM         (PENDING-BUSINESS)
 17359*    END-EXEC.
 17360     MOVE LENGTH OF
 17361      PENDING-BUSINESS
 17362       TO DFHEIV11
 17363*    MOVE '&& L                  %   #00014917' TO DFHEIV0
 17364     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17365     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17366     MOVE X'2020233030303134393137' TO DFHEIV0(25:11)
 17367     CALL 'kxdfhei1' USING DFHEIV0,
 17368           FILE-ID-ERPNDB,
 17369           PENDING-BUSINESS,
 17370           DFHEIV11,
 17371           DFHEIV99
 17372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17373
 17374
 17375     PERFORM 8400-LOG-JOURNAL-RECORD.
 17376
 17377     GO TO 7200-DISPLAY-BATCHES.
 17378
 17379 3690-NOT-FOUND.
 17380     MOVE ER-2192                TO EMI-ERROR.
 17381     MOVE -1                     TO DPFENTRL.
 17382     MOVE AL-UNBON               TO DPFENTRA.
 17383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17384     GO TO 8200-SEND-DATAONLY.
 17385
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 323
* EL6311.cbl
 17387
 17388******************************************************************
 17389*                                                                *
 17390*           R E - D I S P L A Y   R E C O R D                    *
 17391*                                                                *
 17392******************************************************************
 17393
 17394 3900-RE-DISPLAY-RECORD.
 17395
 17396* EXEC CICS HANDLE CONDITION
 17397*         NOTFND   (3990-NOT-FOUND)
 17398*    END-EXEC.
 17399*    MOVE '"$I                   ! F #00014942' TO DFHEIV0
 17400     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17402     MOVE X'4620233030303134393432' TO DFHEIV0(25:11)
 17403     CALL 'kxdfhei1' USING DFHEIV0
 17404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17405
 17406
 17407     IF PI-DISPLAY-ORIGINAL-BATCH
 17408         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17409     ELSE
 17410         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17411
 17412
 17413* EXEC CICS READ
 17414*         DATASET   (FILE-ID)
 17415*         RIDFLD    (PI-PREV-KEY)
 17416*         SET       (ADDRESS OF PENDING-BUSINESS)
 17417*    END-EXEC.
 17418*    MOVE '&"S        E          (   #00014951' TO DFHEIV0
 17419     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17421     MOVE X'2020233030303134393531' TO DFHEIV0(25:11)
 17422     CALL 'kxdfhei1' USING DFHEIV0,
 17423           FILE-ID,
 17424           DFHEIV20,
 17425           DFHEIV99,
 17426           PI-PREV-KEY,
 17427           DFHEIV99,
 17428           DFHEIV99,
 17429           DFHEIV99
 17430     SET ADDRESS OF PENDING-BUSINESS TO
 17431         DFHEIV20
 17432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17433
 17434
 17435     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17436
 17437     IF PB-ISSUE
 17438         GO TO 7000-DISPLAY-ISSUES.
 17439
 17440     IF PB-CANCELLATION
 17441         GO TO 7100-DISPLAY-CANCELS.
 17442
 17443     IF PB-BATCH-TRAILER
 17444         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 324
* EL6311.cbl
 17445
 17446 3990-NOT-FOUND.
 17447     MOVE LOW-VALUES             TO EL631BI.
 17448
 17449     IF PI-MAP-NAME = EL631B
 17450         MOVE -1                  TO BMAINTL
 17451     ELSE
 17452         MOVE -1                  TO CMAINTL.
 17453
 17454     GO TO 8100-SEND-INITIAL-MAP.
 17455
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 325
* EL6311.cbl
 17457
 17458***************************************************************
 17459*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 17460*                                                             *
 17461*      1. START BROWSE WITH                                   *
 17462*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 17463*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 17464*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 17465*                                                             *
 17466*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 17467*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 17468*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 17469*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 17470*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 17471*               AND IS IT TO BE DISPLAYED.                    *
 17472*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 17473*               DISPLAYED.                                    *
 17474*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 17475*               DISPLAYED.                                    *
 17476*                                                             *
 17477*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 17478*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 17479***************************************************************
 17480
 17481 4000-BROWSE-DETAIL-FORWARD.
 17482     IF FIRST-TIME
 17483        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 17484     ELSE
 17485        IF SHOW-RECORD
 17486           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 17487           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 17488           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 17489           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 17490           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 17491        ELSE
 17492           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 17493
 17494
 17495* EXEC CICS HANDLE CONDITION
 17496*         NOTFND   (4050-END-RECORDS)
 17497*         ENDFILE  (4050-END-RECORDS)
 17498*    END-EXEC.
 17499*    MOVE '"$I''                  ! G #00015016' TO DFHEIV0
 17500     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17502     MOVE X'4720233030303135303136' TO DFHEIV0(25:11)
 17503     CALL 'kxdfhei1' USING DFHEIV0
 17504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17505
 17506
 17507
 17508* EXEC CICS STARTBR
 17509*         DATASET   (FILE-ID-ERPNDB2)
 17510*         RIDFLD    (ERPNDB-ALT-KEY)
 17511*    END-EXEC.
 17512     MOVE 0
 17513       TO DFHEIV11
 17514*    MOVE '&,         G          &   #00015021' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 326
* EL6311.cbl
 17515     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17516     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17517     MOVE X'2020233030303135303231' TO DFHEIV0(25:11)
 17518     CALL 'kxdfhei1' USING DFHEIV0,
 17519           FILE-ID-ERPNDB2,
 17520           ERPNDB-ALT-KEY,
 17521           DFHEIV99,
 17522           DFHEIV11,
 17523           DFHEIV99
 17524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17525
 17526
 17527     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 17528
 17529     IF FIRST-TIME OR SHOW-RECORD
 17530        MOVE SPACE               TO WS-FIRST-TIME-SW
 17531        GO TO 4005-READ-NEXT-RECORD.
 17532
 17533
 17534* EXEC CICS READNEXT
 17535*         DATASET    (FILE-ID-ERPNDB2)
 17536*         SET        (ADDRESS OF PENDING-BUSINESS)
 17537*         RIDFLD     (ERPNDB-ALT-KEY)
 17538*    END-EXEC.
 17539     MOVE 0
 17540       TO DFHEIV11
 17541*    MOVE '&.S                   )   #00015032' TO DFHEIV0
 17542     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17543     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17544     MOVE X'2020233030303135303332' TO DFHEIV0(25:11)
 17545     CALL 'kxdfhei1' USING DFHEIV0,
 17546           FILE-ID-ERPNDB2,
 17547           DFHEIV20,
 17548           DFHEIV99,
 17549           ERPNDB-ALT-KEY,
 17550           DFHEIV99,
 17551           DFHEIV11,
 17552           DFHEIV99,
 17553           DFHEIV99
 17554     SET ADDRESS OF PENDING-BUSINESS TO
 17555         DFHEIV20
 17556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17557
 17558
 17559 4005-READ-NEXT-RECORD.
 17560
 17561* EXEC CICS READNEXT
 17562*         DATASET    (FILE-ID-ERPNDB2)
 17563*         SET        (ADDRESS OF PENDING-BUSINESS)
 17564*         RIDFLD     (ERPNDB-ALT-KEY)
 17565*    END-EXEC.
 17566     MOVE 0
 17567       TO DFHEIV11
 17568*    MOVE '&.S                   )   #00015039' TO DFHEIV0
 17569     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17570     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17571     MOVE X'2020233030303135303339' TO DFHEIV0(25:11)
 17572     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 327
* EL6311.cbl
 17573           FILE-ID-ERPNDB2,
 17574           DFHEIV20,
 17575           DFHEIV99,
 17576           ERPNDB-ALT-KEY,
 17577           DFHEIV99,
 17578           DFHEIV11,
 17579           DFHEIV99,
 17580           DFHEIV99
 17581     SET ADDRESS OF PENDING-BUSINESS TO
 17582         DFHEIV20
 17583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17584
 17585
 17586     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17587
 17588     IF WS-BATCH-PREFIX = '#CL'
 17589        GO TO 4005-READ-NEXT-RECORD.
 17590
 17591     IF SHOW-RECORD
 17592        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 17593           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 17594           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 17595           PB-STATE         NOT = PI-PB-STATE          OR
 17596           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 17597           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 17598           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 17599           GO TO 4050-END-RECORDS
 17600        ELSE
 17601           GO TO 4010-CHECK-REC-TYPE.
 17602
 17603     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 17604        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 17605        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 17606        PB-STATE            NOT = PI-PB-STATE          OR
 17607        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 17608        GO TO 4050-END-RECORDS.
 17609
 17610     IF PB-BATCH-TRAILER
 17611        GO TO 4005-READ-NEXT-RECORD.
 17612
 17613     IF PI-PB-CERT-NO NOT = LOW-VALUES
 17614        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 17615           GO TO 4005-READ-NEXT-RECORD
 17616        ELSE
 17617           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 17618              GO TO 4010-CHECK-REC-TYPE
 17619           ELSE
 17620              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 17621                 GO TO 4010-CHECK-REC-TYPE
 17622              ELSE
 17623                 GO TO 4005-READ-NEXT-RECORD.
 17624
 17625     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 17626        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 17627           GO TO 4005-READ-NEXT-RECORD.
 17628
 17629 4010-CHECK-REC-TYPE.
 17630     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 328
* EL6311.cbl
 17631         IF  PB-CARRIER = PI-CARRIER-SECURITY
 17632             NEXT SENTENCE
 17633         ELSE
 17634             GO TO 4005-READ-NEXT-RECORD.
 17635
 17636     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 17637         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 17638             NEXT SENTENCE
 17639        ELSE
 17640             GO TO 4005-READ-NEXT-RECORD.
 17641
 17642     IF NOT DISPLAY-CHANGE-RECORDS AND
 17643            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 17644        GO TO 4005-READ-NEXT-RECORD.
 17645
 17646     IF DISPLAY-HOLD-RECORDS AND
 17647        NOT PB-RECORD-ON-HOLD
 17648          GO TO 4005-READ-NEXT-RECORD.
 17649
 17650     IF PB-ISSUE
 17651        IF DISPLAY-CHK-REQ-RECORDS
 17652            GO TO 4005-READ-NEXT-RECORD.
 17653
 17654     IF PB-ISSUE
 17655        IF ISSUE-WITH-WARNING
 17656           IF PB-WARNING-ERRORS
 17657              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17658                  GO TO 4005-READ-NEXT-RECORD
 17659              ELSE
 17660                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17661                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17662                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17663                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17664                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17665                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17666                 GO TO 7000-DISPLAY-ISSUES
 17667           ELSE
 17668              GO TO 4005-READ-NEXT-RECORD.
 17669
 17670     IF PB-ISSUE
 17671        IF (ISSUES-IN-ERROR AND
 17672            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17673            ALL-ISSUES
 17674            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17675            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17676            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17677            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17678            MOVE PB-SV-STATE            TO PI-SV-STATE
 17679            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17680            GO TO 7000-DISPLAY-ISSUES
 17681        ELSE
 17682            GO TO 4005-READ-NEXT-RECORD.
 17683
 17684     IF PB-CANCELLATION
 17685        IF DISPLAY-CHK-REQ-RECORDS
 17686           IF PB-C-REFUND-REQUESTED
 17687              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17688              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 329
* EL6311.cbl
 17689              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17690              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17691              MOVE PB-SV-STATE            TO PI-SV-STATE
 17692              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17693              GO TO 7100-DISPLAY-CANCELS
 17694           ELSE
 17695               GO TO 4005-READ-NEXT-RECORD.
 17696
 17697     IF PB-CANCELLATION
 17698        IF CANCEL-WITH-WARNING
 17699           IF PB-WARNING-ERRORS
 17700              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17701                  GO TO 4005-READ-NEXT-RECORD
 17702              ELSE
 17703                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17704                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17705                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17706                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17707                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17708                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17709                 GO TO 7100-DISPLAY-CANCELS
 17710           ELSE
 17711              GO TO 4005-READ-NEXT-RECORD.
 17712
 17713     IF PB-CANCELLATION
 17714        IF (CANCEL-IN-ERROR  AND
 17715            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17716            ALL-CANCELS
 17717            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17718            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17719            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17720            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17721            MOVE PB-SV-STATE            TO PI-SV-STATE
 17722            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17723            GO TO 7100-DISPLAY-CANCELS.
 17724
 17725     GO TO 4005-READ-NEXT-RECORD.
 17726
 17727 4050-END-RECORDS.
 17728******************************************************************
 17729*                                                                *
 17730*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 17731*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 17732*         PROGRAM.                                               *
 17733*                                                                *
 17734******************************************************************
 17735
 17736     IF BROWSE-STARTED
 17737        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 17738
 17739* EXEC CICS ENDBR
 17740*            DATASET  (FILE-ID-ERPNDB2)
 17741*       END-EXEC.
 17742     MOVE 0
 17743       TO DFHEIV11
 17744*    MOVE '&2                    $   #00015197' TO DFHEIV0
 17745     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17746     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 330
* EL6311.cbl
 17747     MOVE X'2020233030303135313937' TO DFHEIV0(25:11)
 17748     CALL 'kxdfhei1' USING DFHEIV0,
 17749           FILE-ID-ERPNDB2,
 17750           DFHEIV11,
 17751           DFHEIV99
 17752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17753
 17754
 17755     IF  EIBTRNID NOT = TRANS-EXB1
 17756         IF PENDING-BUS-RECS-FOUND
 17757             NEXT SENTENCE
 17758           ELSE
 17759             MOVE '9'            TO PI-BROWSE-SW
 17760             GO TO 9400-CLEAR.
 17761
 17762     IF SHOW-RECORD
 17763        MOVE ER-2253            TO EMI-ERROR
 17764       ELSE
 17765        MOVE ER-2254            TO EMI-ERROR.
 17766
 17767     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17768
 17769     IF PI-MAP-NAME = SPACES
 17770        MOVE -1                  TO DPFENTRL
 17771        MOVE EL631D               TO PI-MAP-NAME
 17772        GO TO 8100-SEND-INITIAL-MAP.
 17773
 17774     IF PI-MAP-NAME = EL631B
 17775        MOVE -1                  TO BMAINTL
 17776     ELSE
 17777        IF PI-MAP-NAME = EL631C
 17778           MOVE -1               TO CMAINTL
 17779        ELSE
 17780           MOVE -1               TO DPFENTRL.
 17781
 17782     GO TO 8200-SEND-DATAONLY.
 17783
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 331
* EL6311.cbl
 17785
 17786***************************************************************
 17787*                                                             *
 17788*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 17789*                                                             *
 17790*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 17791*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 17792*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 17793*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 17794*                                                             *
 17795*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 17796*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 17797*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 17798*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 17799*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 17800*                AND IS IT TO BE DISPLAYED.                   *
 17801*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 17802*                DISPLAYED.                                   *
 17803*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 17804*                DISPLAYED.                                   *
 17805*                                                             *
 17806*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 17807*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 17808*                                                             *
 17809*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 17810*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 17811*                THEY ARE NOT TO BE DISPLAYED.                *
 17812*                                                             *
 17813***************************************************************
 17814
 17815 4100-BROWSE-PRIMARY-FORWARD.
 17816     IF FIRST-TIME  OR SHOW-RECORD
 17817        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 17818        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 17819        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 17820     ELSE
 17821        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 17822        IF ERPNDB-BATCH-SEQ-NO = +9999
 17823           GO TO 4150-END-BATCH
 17824        ELSE
 17825           IF DISPLAY-CHANGE-RECORDS
 17826              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 17827           ELSE
 17828              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 17829              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 17830
 17831     IF FIRST-TIME
 17832         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 17833            PI-PB-BATCH-SEQ-NO NOT = ZERO
 17834              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 17835
 17836
 17837* EXEC CICS HANDLE CONDITION
 17838*         ENDFILE  (4150-END-BATCH)
 17839*    END-EXEC.
 17840*    MOVE '"$''                   ! H #00015282' TO DFHEIV0
 17841     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 17842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 332
* EL6311.cbl
 17843     MOVE X'4820233030303135323832' TO DFHEIV0(25:11)
 17844     CALL 'kxdfhei1' USING DFHEIV0
 17845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17846
 17847
 17848 4105-READ-NEXT.
 17849
 17850* EXEC CICS HANDLE CONDITION
 17851*         NOTFND    (4150-END-BATCH)
 17852*    END-EXEC.
 17853*    MOVE '"$I                   ! I #00015287' TO DFHEIV0
 17854     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17855     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17856     MOVE X'4920233030303135323837' TO DFHEIV0(25:11)
 17857     CALL 'kxdfhei1' USING DFHEIV0
 17858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17859
 17860
 17861     MOVE SPACES                 TO WS-REC-FOUND-SW.
 17862
 17863     IF PI-DISPLAY-ORIGINAL-BATCH
 17864        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17865     ELSE
 17866        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17867
 17868
 17869* EXEC CICS READ
 17870*         DATASET   (FILE-ID)
 17871*         SET       (ADDRESS OF PENDING-BUSINESS)
 17872*         RIDFLD    (ERPNDB-KEY)
 17873*         GTEQ
 17874*    END-EXEC.
 17875*    MOVE '&"S        G          (   #00015298' TO DFHEIV0
 17876     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17877     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17878     MOVE X'2020233030303135323938' TO DFHEIV0(25:11)
 17879     CALL 'kxdfhei1' USING DFHEIV0,
 17880           FILE-ID,
 17881           DFHEIV20,
 17882           DFHEIV99,
 17883           ERPNDB-KEY,
 17884           DFHEIV99,
 17885           DFHEIV99,
 17886           DFHEIV99
 17887     SET ADDRESS OF PENDING-BUSINESS TO
 17888         DFHEIV20
 17889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17890
 17891
 17892     IF PI-DISPLAY-ORIGINAL-BATCH
 17893        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 17894           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 17895           GO TO 4150-END-BATCH
 17896        ELSE
 17897           IF PB-BATCH-TRAILER
 17898              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 17899              GO TO 4105-READ-NEXT
 17900           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 333
* EL6311.cbl
 17901              NEXT SENTENCE
 17902     ELSE
 17903        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 17904           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 17905           GO TO 4150-END-BATCH.
 17906
 17907     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17908
 17909     IF WS-BATCH-PREFIX = '#CL'
 17910         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 17911         GO TO 4105-READ-NEXT.
 17912
 17913     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 17914     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 17915     MOVE PB-STATE               TO PI-PB-STATE.
 17916     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 17917
 17918     IF PB-BATCH-TRAILER
 17919        IF SHOW-RECORD
 17920           GO TO 4150-END-BATCH
 17921        ELSE
 17922           MOVE ER-2251         TO EMI-ERROR
 17923           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17924           MOVE 1               TO PI-BROWSE-TYPE
 17925           GO TO 7200-DISPLAY-BATCHES.
 17926
 17927     IF SHOW-RECORD
 17928           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 17929              GO TO 4110-BUMP-SEQ
 17930           ELSE
 17931              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 17932                 GO TO 4110-BUMP-SEQ
 17933              ELSE
 17934                 GO TO 4107-CHECK-REC-TYPE.
 17935
 17936     IF NOT  PI-PRIMARY-WITH-SELECT
 17937        GO TO 4107-CHECK-REC-TYPE.
 17938
 17939     IF PI-PB-CERT-NO NOT = LOW-VALUES
 17940        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 17941           GO TO 4110-BUMP-SEQ
 17942        ELSE
 17943           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 17944              GO TO 4107-CHECK-REC-TYPE
 17945           ELSE
 17946              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 17947                 GO TO 4107-CHECK-REC-TYPE
 17948              ELSE
 17949                 GO TO 4110-BUMP-SEQ.
 17950
 17951     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 17952        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 17953           GO TO 4110-BUMP-SEQ.
 17954
 17955 4107-CHECK-REC-TYPE.
 17956     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 17957         IF  PB-CARRIER = PI-CARRIER-SECURITY
 17958             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 334
* EL6311.cbl
 17959           ELSE
 17960             GO TO 4110-BUMP-SEQ.
 17961
 17962     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 17963         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 17964             NEXT SENTENCE
 17965           ELSE
 17966             GO TO 4110-BUMP-SEQ.
 17967
 17968     IF NOT DISPLAY-CHANGE-RECORDS AND
 17969        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 17970           GO TO 4110-BUMP-SEQ.
 17971
 17972     IF DISPLAY-HOLD-RECORDS AND
 17973        NOT PB-RECORD-ON-HOLD
 17974          GO TO 4110-BUMP-SEQ.
 17975
 17976     IF PB-ISSUE
 17977        IF DISPLAY-CHK-REQ-RECORDS
 17978            GO TO 4110-BUMP-SEQ.
 17979
 17980     IF PB-ISSUE
 17981        IF ISSUE-WITH-WARNING
 17982           IF PB-WARNING-ERRORS
 17983              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17984                  GO TO 4110-BUMP-SEQ
 17985              ELSE
 17986                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17987                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17988                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17989                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17990                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17991                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17992                 GO TO 7000-DISPLAY-ISSUES
 17993        ELSE
 17994            GO TO 4110-BUMP-SEQ.
 17995
 17996     IF PB-ISSUE
 17997        IF (ISSUES-IN-ERROR AND
 17998            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17999            ALL-ISSUES
 18000            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18001            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18002            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18003            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18004            MOVE PB-SV-STATE            TO PI-SV-STATE
 18005            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18006            GO TO 7000-DISPLAY-ISSUES
 18007        ELSE
 18008            GO TO 4110-BUMP-SEQ.
 18009
 18010     IF PB-CANCELLATION
 18011        IF DISPLAY-CHK-REQ-RECORDS
 18012           IF PB-C-REFUND-REQUESTED
 18013              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18014              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18015              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18016              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 335
* EL6311.cbl
 18017              MOVE PB-SV-STATE            TO PI-SV-STATE
 18018              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18019              GO TO 7100-DISPLAY-CANCELS
 18020           ELSE
 18021              GO TO 4110-BUMP-SEQ.
 18022
 18023     IF PB-CANCELLATION
 18024        IF CANCEL-WITH-WARNING
 18025           IF PB-WARNING-ERRORS
 18026              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18027                  GO TO 4110-BUMP-SEQ
 18028              ELSE
 18029                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18030                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18031                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18032                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18033                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18034                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18035                 GO TO 7100-DISPLAY-CANCELS
 18036           ELSE
 18037              GO TO 4110-BUMP-SEQ.
 18038
 18039     IF PB-CANCELLATION
 18040        IF (CANCEL-IN-ERROR  AND
 18041            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18042            ALL-CANCELS
 18043            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18044            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18045            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18046            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18047            MOVE PB-SV-STATE            TO PI-SV-STATE
 18048            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18049            GO TO 7100-DISPLAY-CANCELS.
 18050
 18051 4110-BUMP-SEQ.
 18052     IF NOT DISPLAY-CHANGE-RECORDS
 18053        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18054        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18055     ELSE
 18056        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18057           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18058           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18059        ELSE
 18060           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18061           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18062
 18063     GO TO 4105-READ-NEXT.
 18064
 18065 4150-END-BATCH.
 18066******************************************************************
 18067*                                                                *
 18068*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18069*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18070*         PROGRAM.                                               *
 18071*                                                                *
 18072******************************************************************
 18073
 18074     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 336
* EL6311.cbl
 18075         IF PENDING-BUS-RECS-FOUND
 18076             NEXT SENTENCE
 18077           ELSE
 18078             MOVE '9'            TO PI-BROWSE-SW
 18079             GO TO 9400-CLEAR.
 18080
 18081     IF SHOW-RECORD
 18082        MOVE ER-2253             TO EMI-ERROR
 18083     ELSE
 18084        MOVE ER-2251             TO EMI-ERROR.
 18085
 18086     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18087
 18088     IF PI-MAP-NAME = SPACES
 18089        MOVE -1                  TO BMAINTL
 18090        MOVE EL631B              TO PI-MAP-NAME
 18091        GO TO 8100-SEND-INITIAL-MAP.
 18092
 18093     IF PI-MAP-NAME = EL631B
 18094        MOVE -1                  TO BMAINTL
 18095     ELSE
 18096        IF PI-MAP-NAME = EL631C
 18097           MOVE -1               TO CMAINTL
 18098        ELSE
 18099           MOVE -1               TO DPFENTRL.
 18100
 18101     GO TO 8200-SEND-DATAONLY.
 18102
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 337
* EL6311.cbl
 18104
 18105***************************************************************
 18106*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 18107*                                                             *
 18108*      1. START BROWSE WITH                                   *
 18109*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18110*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18111*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18112*                                                             *
 18113*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18114*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18115*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18116*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18117*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18118*               AND IS IT TO BE DISPLAYED.                    *
 18119*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18120*               DISPLAYED.                                    *
 18121*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18122*               DISPLAYED.                                    *
 18123*                                                             *
 18124*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18125*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18126***************************************************************
 18127
 18128 4200-BROWSE-CSR-FORWARD.
 18129
 18130     IF FIRST-TIME
 18131        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 18132     ELSE
 18133        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 18134
 18135
 18136* EXEC CICS HANDLE CONDITION
 18137*         NOTFND   (4250-END-RECORDS)
 18138*         ENDFILE  (4250-END-RECORDS)
 18139*    END-EXEC.
 18140*    MOVE '"$I''                  ! J #00015548' TO DFHEIV0
 18141     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18142     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18143     MOVE X'4A20233030303135353438' TO DFHEIV0(25:11)
 18144     CALL 'kxdfhei1' USING DFHEIV0
 18145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18146
 18147
 18148
 18149* EXEC CICS STARTBR
 18150*         DATASET   (FILE-ID-ERPNDB4)
 18151*         RIDFLD    (ERPNDB-CSR-KEY)
 18152*    END-EXEC.
 18153     MOVE 0
 18154       TO DFHEIV11
 18155*    MOVE '&,         G          &   #00015553' TO DFHEIV0
 18156     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18157     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18158     MOVE X'2020233030303135353533' TO DFHEIV0(25:11)
 18159     CALL 'kxdfhei1' USING DFHEIV0,
 18160           FILE-ID-ERPNDB4,
 18161           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 338
* EL6311.cbl
 18162           DFHEIV99,
 18163           DFHEIV11,
 18164           DFHEIV99
 18165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18166
 18167
 18168     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18169
 18170     IF FIRST-TIME
 18171        MOVE SPACE               TO WS-FIRST-TIME-SW
 18172        GO TO 4205-READ-NEXT-RECORD.
 18173
 18174
 18175* EXEC CICS READNEXT
 18176*         DATASET    (FILE-ID-ERPNDB4)
 18177*         SET        (ADDRESS OF PENDING-BUSINESS)
 18178*         RIDFLD     (ERPNDB-CSR-KEY)
 18179*    END-EXEC.
 18180     MOVE 0
 18181       TO DFHEIV11
 18182*    MOVE '&.S                   )   #00015564' TO DFHEIV0
 18183     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18184     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18185     MOVE X'2020233030303135353634' TO DFHEIV0(25:11)
 18186     CALL 'kxdfhei1' USING DFHEIV0,
 18187           FILE-ID-ERPNDB4,
 18188           DFHEIV20,
 18189           DFHEIV99,
 18190           ERPNDB-CSR-KEY,
 18191           DFHEIV99,
 18192           DFHEIV11,
 18193           DFHEIV99,
 18194           DFHEIV99
 18195     SET ADDRESS OF PENDING-BUSINESS TO
 18196         DFHEIV20
 18197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18198
 18199
 18200 4205-READ-NEXT-RECORD.
 18201
 18202
 18203* EXEC CICS READNEXT
 18204*         DATASET    (FILE-ID-ERPNDB4)
 18205*         SET        (ADDRESS OF PENDING-BUSINESS)
 18206*         RIDFLD     (ERPNDB-CSR-KEY)
 18207*    END-EXEC.
 18208     MOVE 0
 18209       TO DFHEIV11
 18210*    MOVE '&.S                   )   #00015572' TO DFHEIV0
 18211     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18212     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18213     MOVE X'2020233030303135353732' TO DFHEIV0(25:11)
 18214     CALL 'kxdfhei1' USING DFHEIV0,
 18215           FILE-ID-ERPNDB4,
 18216           DFHEIV20,
 18217           DFHEIV99,
 18218           ERPNDB-CSR-KEY,
 18219           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 339
* EL6311.cbl
 18220           DFHEIV11,
 18221           DFHEIV99,
 18222           DFHEIV99
 18223     SET ADDRESS OF PENDING-BUSINESS TO
 18224         DFHEIV20
 18225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18226
 18227
 18228     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18229
 18230     IF WS-BATCH-PREFIX = '#CL'
 18231        GO TO 4205-READ-NEXT-RECORD.
 18232
 18233     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 18234        PB-CSR-ID           NOT = PI-PB-CSR-ID
 18235        GO TO 4250-END-RECORDS.
 18236
 18237     IF PB-BATCH-TRAILER
 18238        GO TO 4205-READ-NEXT-RECORD.
 18239
 18240     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18241        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18242           GO TO 4205-READ-NEXT-RECORD
 18243        ELSE
 18244           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18245              GO TO 4210-CHECK-REC-TYPE
 18246           ELSE
 18247              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18248                 GO TO 4210-CHECK-REC-TYPE
 18249              ELSE
 18250                 GO TO 4205-READ-NEXT-RECORD.
 18251
 18252     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18253        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18254           GO TO 4205-READ-NEXT-RECORD.
 18255
 18256 4210-CHECK-REC-TYPE.
 18257     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18258         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18259             NEXT SENTENCE
 18260         ELSE
 18261             GO TO 4205-READ-NEXT-RECORD.
 18262
 18263     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18264         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18265             NEXT SENTENCE
 18266        ELSE
 18267             GO TO 4205-READ-NEXT-RECORD.
 18268
 18269     IF NOT DISPLAY-CHANGE-RECORDS AND
 18270            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18271        GO TO 4205-READ-NEXT-RECORD.
 18272
 18273     IF DISPLAY-HOLD-RECORDS AND
 18274        NOT PB-RECORD-ON-HOLD
 18275          GO TO 4205-READ-NEXT-RECORD.
 18276
 18277     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 340
* EL6311.cbl
 18278        IF DISPLAY-CHK-REQ-RECORDS
 18279            GO TO 4205-READ-NEXT-RECORD.
 18280
 18281     IF PB-ISSUE
 18282        IF ISSUE-WITH-WARNING
 18283           IF PB-WARNING-ERRORS
 18284              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18285                  GO TO 4205-READ-NEXT-RECORD
 18286              ELSE
 18287                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18288                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18289                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18290                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18291                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18292                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18293                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18294                 GO TO 7000-DISPLAY-ISSUES
 18295           ELSE
 18296              GO TO 4205-READ-NEXT-RECORD.
 18297
 18298     IF PB-ISSUE
 18299        IF (ISSUES-IN-ERROR AND
 18300            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18301            ALL-ISSUES
 18302            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18303            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18304            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18305            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18306            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18307            MOVE PB-SV-STATE            TO PI-SV-STATE
 18308            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18309            GO TO 7000-DISPLAY-ISSUES
 18310        ELSE
 18311            GO TO 4205-READ-NEXT-RECORD.
 18312
 18313     IF PB-CANCELLATION
 18314        IF DISPLAY-CHK-REQ-RECORDS
 18315           IF PB-C-REFUND-REQUESTED
 18316              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18317              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18318              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18319              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18320              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18321              MOVE PB-SV-STATE            TO PI-SV-STATE
 18322              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18323              GO TO 7100-DISPLAY-CANCELS
 18324           ELSE
 18325               GO TO 4205-READ-NEXT-RECORD.
 18326
 18327     IF PB-CANCELLATION
 18328        IF CANCEL-WITH-WARNING
 18329           IF PB-WARNING-ERRORS
 18330              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18331                  GO TO 4205-READ-NEXT-RECORD
 18332              ELSE
 18333                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18334                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18335                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 341
* EL6311.cbl
 18336                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18337                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18338                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18339                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18340                 GO TO 7100-DISPLAY-CANCELS
 18341           ELSE
 18342              GO TO 4205-READ-NEXT-RECORD.
 18343
 18344     IF PB-CANCELLATION
 18345        IF (CANCEL-IN-ERROR  AND
 18346            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18347            ALL-CANCELS
 18348            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18349            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18350            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18351            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18352            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18353            MOVE PB-SV-STATE            TO PI-SV-STATE
 18354            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18355            GO TO 7100-DISPLAY-CANCELS.
 18356
 18357     GO TO 4205-READ-NEXT-RECORD.
 18358
 18359 4250-END-RECORDS.
 18360******************************************************************
 18361*                                                                *
 18362*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18363*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18364*         PROGRAM.                                               *
 18365*                                                                *
 18366******************************************************************
 18367
 18368     IF BROWSE-STARTED
 18369        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18370
 18371* EXEC CICS ENDBR
 18372*            DATASET  (FILE-ID-ERPNDB4)
 18373*       END-EXEC.
 18374     MOVE 0
 18375       TO DFHEIV11
 18376*    MOVE '&2                    $   #00015720' TO DFHEIV0
 18377     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18378     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18379     MOVE X'2020233030303135373230' TO DFHEIV0(25:11)
 18380     CALL 'kxdfhei1' USING DFHEIV0,
 18381           FILE-ID-ERPNDB4,
 18382           DFHEIV11,
 18383           DFHEIV99
 18384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18385
 18386
 18387     IF  EIBTRNID NOT = TRANS-EXB1
 18388         IF PENDING-BUS-RECS-FOUND
 18389             NEXT SENTENCE
 18390           ELSE
 18391             MOVE '9'            TO PI-BROWSE-SW
 18392             GO TO 9400-CLEAR.
 18393
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 342
* EL6311.cbl
 18394     IF SHOW-RECORD
 18395        MOVE ER-2253            TO EMI-ERROR
 18396       ELSE
 18397        MOVE ER-2254            TO EMI-ERROR.
 18398
 18399     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18400
 18401     IF PI-MAP-NAME = SPACES
 18402        MOVE -1                  TO DPFENTRL
 18403        MOVE EL631D               TO PI-MAP-NAME
 18404        GO TO 8100-SEND-INITIAL-MAP.
 18405
 18406     IF PI-MAP-NAME = EL631B
 18407        MOVE -1                  TO BMAINTL
 18408     ELSE
 18409        IF PI-MAP-NAME = EL631C
 18410           MOVE -1               TO CMAINTL
 18411        ELSE
 18412           MOVE -1               TO DPFENTRL.
 18413
 18414     GO TO 8200-SEND-DATAONLY.
 18415
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 343
* EL6311.cbl
 18417
 18418***************************************************************
 18419*                                                             *
 18420*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 18421*                                                             *
 18422*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 18423*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18424*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18425*                                                             *
 18426*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18427*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18428*          A. IS IT WITHIN THE SAME COMPANY                   *
 18429*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18430*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18431*                AND IS IT TO BE DISPLAYED.                   *
 18432*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18433*                DISPLAYED.                                   *
 18434*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18435*                DISPLAYED.                                   *
 18436*                                                             *
 18437*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18438*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18439*                                                             *
 18440*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18441*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18442*                THEY ARE NOT TO BE DISPLAYED.                *
 18443*                                                             *
 18444***************************************************************
 18445
 18446 4300-BROWSE-FILE-FORWARD.
 18447     IF FIRST-TIME OR SHOW-RECORD
 18448        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 18449        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 18450        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18451     ELSE
 18452        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18453        IF ERPNDB-BATCH-SEQ-NO = +9999
 18454           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 18455        ELSE
 18456           IF DISPLAY-CHANGE-RECORDS
 18457              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18458           ELSE
 18459              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18460              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18461
 18462
 18463* EXEC CICS HANDLE CONDITION
 18464*         ENDFILE  (4350-END-BATCH)
 18465*         NOTFND   (4350-END-BATCH)
 18466*    END-EXEC.
 18467*    MOVE '"$''I                  ! K #00015799' TO DFHEIV0
 18468     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18469     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18470     MOVE X'4B20233030303135373939' TO DFHEIV0(25:11)
 18471     CALL 'kxdfhei1' USING DFHEIV0
 18472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18473
 18474
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 344
* EL6311.cbl
 18475 4305-READ-NEXT.
 18476     IF PI-DISPLAY-ORIGINAL-BATCH
 18477        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18478     ELSE
 18479        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18480
 18481
 18482* EXEC CICS READ
 18483*         DATASET   (FILE-ID)
 18484*         SET       (ADDRESS OF PENDING-BUSINESS)
 18485*         RIDFLD    (ERPNDB-KEY)
 18486*         GTEQ
 18487*    END-EXEC.
 18488*    MOVE '&"S        G          (   #00015810' TO DFHEIV0
 18489     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18491     MOVE X'2020233030303135383130' TO DFHEIV0(25:11)
 18492     CALL 'kxdfhei1' USING DFHEIV0,
 18493           FILE-ID,
 18494           DFHEIV20,
 18495           DFHEIV99,
 18496           ERPNDB-KEY,
 18497           DFHEIV99,
 18498           DFHEIV99,
 18499           DFHEIV99
 18500     SET ADDRESS OF PENDING-BUSINESS TO
 18501         DFHEIV20
 18502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18503
 18504
 18505     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 18506        GO TO 4350-END-BATCH.
 18507
 18508     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 18509                                    WS-BATCH-NO.
 18510
 18511     IF  WS-BATCH-PREFIX = '#CL'
 18512         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18513         GO TO 4305-READ-NEXT.
 18514
 18515     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 18516     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18517     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18518     MOVE PB-STATE               TO PI-PB-STATE.
 18519     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18520
 18521     IF PB-BATCH-TRAILER
 18522        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 18523        GO TO 4305-READ-NEXT.
 18524
 18525     IF SHOW-RECORD
 18526           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18527              GO TO 4310-BUMP-SEQ
 18528           ELSE
 18529              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18530                 GO TO 4310-BUMP-SEQ
 18531              ELSE
 18532                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 345
* EL6311.cbl
 18533
 18534     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18535        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18536           GO TO 4310-BUMP-SEQ
 18537        ELSE
 18538           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18539              GO TO 4307-CHECK-REC-TYPE
 18540           ELSE
 18541              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18542                 GO TO 4307-CHECK-REC-TYPE
 18543              ELSE
 18544                 GO TO 4310-BUMP-SEQ.
 18545
 18546     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18547        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18548           GO TO 4310-BUMP-SEQ.
 18549
 18550 4307-CHECK-REC-TYPE.
 18551     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18552         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18553             NEXT SENTENCE
 18554         ELSE
 18555             GO TO 4310-BUMP-SEQ.
 18556
 18557     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18558         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18559             NEXT SENTENCE
 18560        ELSE
 18561             GO TO 4310-BUMP-SEQ.
 18562
 18563     IF NOT DISPLAY-CHANGE-RECORDS AND
 18564            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18565        GO TO 4310-BUMP-SEQ.
 18566
 18567     IF DISPLAY-HOLD-RECORDS AND
 18568        NOT PB-RECORD-ON-HOLD
 18569          GO TO 4310-BUMP-SEQ.
 18570
 18571     IF PB-ISSUE
 18572        IF DISPLAY-CHK-REQ-RECORDS
 18573           GO TO 4310-BUMP-SEQ.
 18574
 18575     IF PB-ISSUE
 18576        IF ISSUE-WITH-WARNING
 18577           IF PB-WARNING-ERRORS
 18578              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18579                  GO TO 4310-BUMP-SEQ
 18580              ELSE
 18581                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18582                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18583                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18584                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18585                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18586                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18587                 GO TO 7000-DISPLAY-ISSUES
 18588           ELSE
 18589              GO TO 4310-BUMP-SEQ.
 18590
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 346
* EL6311.cbl
 18591     IF PB-ISSUE
 18592        IF (ISSUES-IN-ERROR AND
 18593            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18594            ALL-ISSUES
 18595            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18596            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18597            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18598            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18599            MOVE PB-SV-STATE            TO PI-SV-STATE
 18600            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18601            GO TO 7000-DISPLAY-ISSUES
 18602        ELSE
 18603            GO TO 4310-BUMP-SEQ.
 18604
 18605     IF PB-CANCELLATION
 18606        IF DISPLAY-CHK-REQ-RECORDS
 18607           IF PB-C-REFUND-REQUESTED
 18608              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18609              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18610              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18611              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18612              MOVE PB-SV-STATE            TO PI-SV-STATE
 18613              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18614              GO TO 7100-DISPLAY-CANCELS
 18615           ELSE
 18616              GO TO 4310-BUMP-SEQ.
 18617
 18618     IF PB-CANCELLATION
 18619        IF CANCEL-WITH-WARNING
 18620           IF PB-WARNING-ERRORS
 18621              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18622                  GO TO 4310-BUMP-SEQ
 18623              ELSE
 18624                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18625                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18626                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18627                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18628                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18629                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18630                 GO TO 7100-DISPLAY-CANCELS
 18631           ELSE
 18632              GO TO 4310-BUMP-SEQ.
 18633
 18634     IF PB-CANCELLATION
 18635        IF (CANCEL-IN-ERROR  AND
 18636            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18637            ALL-CANCELS
 18638            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18639            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18640            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18641            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18642            MOVE PB-SV-STATE            TO PI-SV-STATE
 18643            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18644            GO TO 7100-DISPLAY-CANCELS.
 18645
 18646 4310-BUMP-SEQ.
 18647     IF NOT DISPLAY-CHANGE-RECORDS
 18648        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 347
* EL6311.cbl
 18649        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18650     ELSE
 18651        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18652           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18653           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18654        ELSE
 18655           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18656           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 18657
 18658     GO TO 4305-READ-NEXT.
 18659
 18660 4350-END-BATCH.
 18661
 18662******************************************************************
 18663*                                                                *
 18664*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18665*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 18666*         PROGRAM.                                               *
 18667*                                                                *
 18668******************************************************************
 18669
 18670     IF  EIBTRNID NOT = TRANS-EXB1
 18671         IF PENDING-BUS-RECS-FOUND
 18672             NEXT SENTENCE
 18673           ELSE
 18674             MOVE '9'            TO PI-BROWSE-SW
 18675             GO TO 9400-CLEAR.
 18676
 18677     IF SHOW-RECORD
 18678        MOVE ER-2253            TO EMI-ERROR
 18679     ELSE
 18680        MOVE ER-2251            TO EMI-ERROR.
 18681
 18682     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18683
 18684     IF PI-MAP-NAME = SPACES
 18685        MOVE -1                  TO BMAINTL
 18686        MOVE EL631B               TO PI-MAP-NAME
 18687        GO TO 8100-SEND-INITIAL-MAP.
 18688
 18689     IF PI-MAP-NAME = EL631B
 18690        MOVE -1                  TO BMAINTL
 18691     ELSE
 18692        IF PI-MAP-NAME = EL631C
 18693           MOVE -1               TO CMAINTL
 18694        ELSE
 18695           MOVE -1               TO DPFENTRL.
 18696
 18697     GO TO 8200-SEND-DATAONLY.
 18698
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 348
* EL6311.cbl
 18700
 18701******************************************************************
 18702*                                                                *
 18703*        B R O W S E   D E T A I L   B A C K W A R D             *
 18704*                                                                *
 18705******************************************************************
 18706
 18707 4500-BROWSE-DETAIL-BACKWARD.
 18708
 18709     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 18710
 18711
 18712* EXEC CICS HANDLE CONDITION
 18713*         NOTFND   (4570-NOT-FOUND)
 18714*         ENDFILE  (4550-END-RECORDS)
 18715*    END-EXEC
 18716*    MOVE '"$I''                  ! L #00016023' TO DFHEIV0
 18717     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18718     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18719     MOVE X'4C20233030303136303233' TO DFHEIV0(25:11)
 18720     CALL 'kxdfhei1' USING DFHEIV0
 18721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18722
 18723
 18724* EXEC CICS STARTBR
 18725*         DATASET   (FILE-ID-ERPNDB2)
 18726*         RIDFLD    (ERPNDB-ALT-KEY)
 18727*    END-EXEC.
 18728     MOVE 0
 18729       TO DFHEIV11
 18730*    MOVE '&,         G          &   #00016028' TO DFHEIV0
 18731     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18732     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18733     MOVE X'2020233030303136303238' TO DFHEIV0(25:11)
 18734     CALL 'kxdfhei1' USING DFHEIV0,
 18735           FILE-ID-ERPNDB2,
 18736           ERPNDB-ALT-KEY,
 18737           DFHEIV99,
 18738           DFHEIV11,
 18739           DFHEIV99
 18740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18741
 18742
 18743     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 18744                                    WS-FIRST-TIME-SW.
 18745
 18746 4505-READ-PREV-RECORD.
 18747
 18748* EXEC CICS READPREV
 18749*         DATASET    (FILE-ID-ERPNDB2)
 18750*         SET        (ADDRESS OF PENDING-BUSINESS)
 18751*         RIDFLD     (ERPNDB-ALT-KEY)
 18752*    END-EXEC.
 18753     MOVE 0
 18754       TO DFHEIV11
 18755*    MOVE '&0S                   )   #00016037' TO DFHEIV0
 18756     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 18757     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 349
* EL6311.cbl
 18758     MOVE X'2020233030303136303337' TO DFHEIV0(25:11)
 18759     CALL 'kxdfhei1' USING DFHEIV0,
 18760           FILE-ID-ERPNDB2,
 18761           DFHEIV20,
 18762           DFHEIV99,
 18763           ERPNDB-ALT-KEY,
 18764           DFHEIV99,
 18765           DFHEIV11,
 18766           DFHEIV99,
 18767           DFHEIV99
 18768     SET ADDRESS OF PENDING-BUSINESS TO
 18769         DFHEIV20
 18770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18771
 18772
 18773     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18774
 18775     IF WS-BATCH-PREFIX = '#CL'
 18776         GO TO 4505-READ-PREV-RECORD.
 18777
 18778     IF FIRST-TIME
 18779         MOVE SPACE               TO WS-FIRST-TIME-SW
 18780         GO TO 4505-READ-PREV-RECORD.
 18781
 18782     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 18783        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 18784        PB-GROUPING      NOT = PI-PB-GROUPING OR
 18785        PB-STATE         NOT = PI-PB-STATE    OR
 18786        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 18787          GO TO 4550-END-RECORDS.
 18788
 18789
 18790     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 18791
 18792     IF PB-BATCH-TRAILER
 18793        GO TO 4505-READ-PREV-RECORD.
 18794
 18795     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18796
 18797     IF  WS-BATCH-PREFIX = '#CL'
 18798         GO TO 4505-READ-PREV-RECORD.
 18799
 18800     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18801        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18802           GO TO 4505-READ-PREV-RECORD
 18803        ELSE
 18804           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18805              GO TO 4510-CHECK-REC-TYPE
 18806           ELSE
 18807              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18808                 GO TO 4510-CHECK-REC-TYPE
 18809              ELSE
 18810                 GO TO 4505-READ-PREV-RECORD.
 18811
 18812     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18813        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18814           GO TO 4505-READ-PREV-RECORD.
 18815
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 350
* EL6311.cbl
 18816 4510-CHECK-REC-TYPE.
 18817     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18818         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18819             NEXT SENTENCE
 18820         ELSE
 18821             GO TO 4505-READ-PREV-RECORD.
 18822
 18823     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18824         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18825             NEXT SENTENCE
 18826        ELSE
 18827             GO TO 4505-READ-PREV-RECORD.
 18828
 18829     IF NOT DISPLAY-CHANGE-RECORDS AND
 18830            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18831        GO TO 4505-READ-PREV-RECORD.
 18832
 18833     IF DISPLAY-HOLD-RECORDS AND
 18834        NOT PB-RECORD-ON-HOLD
 18835          GO TO 4505-READ-PREV-RECORD.
 18836
 18837     IF PB-ISSUE
 18838        IF DISPLAY-CHK-REQ-RECORDS
 18839           GO TO 4505-READ-PREV-RECORD.
 18840
 18841     IF PB-ISSUE
 18842        IF ISSUE-WITH-WARNING
 18843           IF PB-WARNING-ERRORS
 18844              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18845                  GO TO 4505-READ-PREV-RECORD
 18846              ELSE
 18847                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18848                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18849                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18850                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18851                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18852                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18853                 GO TO 7000-DISPLAY-ISSUES
 18854           ELSE
 18855              GO TO 4505-READ-PREV-RECORD.
 18856
 18857     IF PB-ISSUE
 18858        IF (ISSUES-IN-ERROR AND
 18859            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18860            ALL-ISSUES
 18861            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18862            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18863            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18864            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18865            MOVE PB-SV-STATE            TO PI-SV-STATE
 18866            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18867            GO TO 7000-DISPLAY-ISSUES
 18868        ELSE
 18869            GO TO 4505-READ-PREV-RECORD.
 18870
 18871     IF PB-CANCELLATION
 18872        IF DISPLAY-CHK-REQ-RECORDS
 18873           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 351
* EL6311.cbl
 18874              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18875              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18876              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18877              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18878              MOVE PB-SV-STATE            TO PI-SV-STATE
 18879              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18880              GO TO 7100-DISPLAY-CANCELS
 18881           ELSE
 18882              GO TO 4505-READ-PREV-RECORD.
 18883
 18884     IF PB-CANCELLATION
 18885        IF CANCEL-WITH-WARNING
 18886           IF PB-WARNING-ERRORS
 18887              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18888                  GO TO 4505-READ-PREV-RECORD
 18889              ELSE
 18890                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18891                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18892                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18893                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18894                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18895                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18896                 GO TO 7100-DISPLAY-CANCELS
 18897           ELSE
 18898              GO TO 4505-READ-PREV-RECORD.
 18899
 18900     IF PB-CANCELLATION
 18901        IF (CANCEL-IN-ERROR  AND
 18902            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18903            ALL-CANCELS
 18904            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18905            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18906            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18907            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18908            MOVE PB-SV-STATE            TO PI-SV-STATE
 18909            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18910            GO TO 7100-DISPLAY-CANCELS.
 18911
 18912     GO TO 4505-READ-PREV-RECORD.
 18913
 18914 4550-END-RECORDS.
 18915     IF PI-MAP-NAME = EL631B
 18916        MOVE -1                  TO BMAINTL
 18917     ELSE
 18918        IF PI-MAP-NAME = EL631C
 18919           MOVE -1               TO CMAINTL
 18920        ELSE
 18921           MOVE -1               TO DPFENTRL.
 18922
 18923     MOVE ER-2255               TO EMI-ERROR.
 18924     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18925     GO TO 8200-SEND-DATAONLY.
 18926
 18927 4570-NOT-FOUND.
 18928
 18929******************************************************************
 18930*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 18931******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 352
* EL6311.cbl
 18932
 18933
 18934* EXEC CICS RESETBR
 18935*         DATASET    (FILE-ID-ERPNDB2)
 18936*         RIDFLD     (ERPNDB-ALT-KEY)
 18937*    END-EXEC.
 18938     MOVE 0
 18939       TO DFHEIV11
 18940*    MOVE '&4         G          &   #00016203' TO DFHEIV0
 18941     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18942     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18943     MOVE X'2020233030303136323033' TO DFHEIV0(25:11)
 18944     CALL 'kxdfhei1' USING DFHEIV0,
 18945           FILE-ID-ERPNDB2,
 18946           ERPNDB-ALT-KEY,
 18947           DFHEIV99,
 18948           DFHEIV11,
 18949           DFHEIV99
 18950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18951
 18952
 18953
 18954* EXEC CICS READNEXT
 18955*         DATASET    (FILE-ID-ERPNDB2)
 18956*         SET        (ADDRESS OF PENDING-BUSINESS)
 18957*         RIDFLD     (ERPNDB-ALT-KEY)
 18958*    END-EXEC.
 18959     MOVE 0
 18960       TO DFHEIV11
 18961*    MOVE '&.S                   )   #00016208' TO DFHEIV0
 18962     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18963     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18964     MOVE X'2020233030303136323038' TO DFHEIV0(25:11)
 18965     CALL 'kxdfhei1' USING DFHEIV0,
 18966           FILE-ID-ERPNDB2,
 18967           DFHEIV20,
 18968           DFHEIV99,
 18969           ERPNDB-ALT-KEY,
 18970           DFHEIV99,
 18971           DFHEIV11,
 18972           DFHEIV99,
 18973           DFHEIV99
 18974     SET ADDRESS OF PENDING-BUSINESS TO
 18975         DFHEIV20
 18976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18977
 18978
 18979
 18980* EXEC CICS READPREV
 18981*         DATASET    (FILE-ID-ERPNDB2)
 18982*         SET        (ADDRESS OF PENDING-BUSINESS)
 18983*         RIDFLD     (ERPNDB-ALT-KEY)
 18984*    END-EXEC.
 18985     MOVE 0
 18986       TO DFHEIV11
 18987*    MOVE '&0S                   )   #00016214' TO DFHEIV0
 18988     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 18989     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 353
* EL6311.cbl
 18990     MOVE X'2020233030303136323134' TO DFHEIV0(25:11)
 18991     CALL 'kxdfhei1' USING DFHEIV0,
 18992           FILE-ID-ERPNDB2,
 18993           DFHEIV20,
 18994           DFHEIV99,
 18995           ERPNDB-ALT-KEY,
 18996           DFHEIV99,
 18997           DFHEIV11,
 18998           DFHEIV99,
 18999           DFHEIV99
 19000     SET ADDRESS OF PENDING-BUSINESS TO
 19001         DFHEIV20
 19002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19003
 19004
 19005 4580-READ-PREV-RECORD.
 19006
 19007* EXEC CICS READPREV
 19008*         DATASET    (FILE-ID-ERPNDB2)
 19009*         SET        (ADDRESS OF PENDING-BUSINESS)
 19010*         RIDFLD     (ERPNDB-ALT-KEY)
 19011*    END-EXEC.
 19012     MOVE 0
 19013       TO DFHEIV11
 19014*    MOVE '&0S                   )   #00016221' TO DFHEIV0
 19015     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19016     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19017     MOVE X'2020233030303136323231' TO DFHEIV0(25:11)
 19018     CALL 'kxdfhei1' USING DFHEIV0,
 19019           FILE-ID-ERPNDB2,
 19020           DFHEIV20,
 19021           DFHEIV99,
 19022           ERPNDB-ALT-KEY,
 19023           DFHEIV99,
 19024           DFHEIV11,
 19025           DFHEIV99,
 19026           DFHEIV99
 19027     SET ADDRESS OF PENDING-BUSINESS TO
 19028         DFHEIV20
 19029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19030
 19031
 19032     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19033
 19034     IF WS-BATCH-PREFIX = '#CL'
 19035        GO TO 4580-READ-PREV-RECORD.
 19036
 19037     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19038     GO TO 4505-READ-PREV-RECORD.
 19039
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 354
* EL6311.cbl
 19041
 19042******************************************************************
 19043*                                                                *
 19044*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19045*                                                                *
 19046******************************************************************
 19047
 19048 4600-BROWSE-PRIMARY-BACKWARD.
 19049        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19050
 19051     IF ERPNDB-BATCH-SEQ-NO = +9999
 19052        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19053
 19054        IF ERPNDB-BATCH-SEQ-NO = +0000
 19055           GO TO 4650-END-BATCH
 19056        ELSE
 19057           IF PI-MAP-NAME NOT = EL631D
 19058              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19059                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19060              ELSE
 19061                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19062                 IF DISPLAY-CHANGE-RECORDS
 19063                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19064                 ELSE
 19065                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19066
 19067
 19068* EXEC CICS HANDLE CONDITION
 19069*         NOTFND    (4680-NOT-FOUND)
 19070*         ENDFILE   (4680-NOT-FOUND)
 19071*    END-EXEC.
 19072*    MOVE '"$I''                  ! M #00016262' TO DFHEIV0
 19073     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19075     MOVE X'4D20233030303136323632' TO DFHEIV0(25:11)
 19076     CALL 'kxdfhei1' USING DFHEIV0
 19077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19078
 19079
 19080 4605-READ-NEXT.
 19081     IF ERPNDB-BATCH-SEQ-NO = +0000
 19082        GO TO 4650-END-BATCH.
 19083
 19084     IF PI-DISPLAY-ORIGINAL-BATCH
 19085        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19086     ELSE
 19087        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19088
 19089
 19090* EXEC CICS READ
 19091*         DATASET   (FILE-ID)
 19092*         SET       (ADDRESS OF PENDING-BUSINESS)
 19093*         RIDFLD    (ERPNDB-KEY)
 19094*    END-EXEC.
 19095*    MOVE '&"S        E          (   #00016276' TO DFHEIV0
 19096     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19097     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19098     MOVE X'2020233030303136323736' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 355
* EL6311.cbl
 19099     CALL 'kxdfhei1' USING DFHEIV0,
 19100           FILE-ID,
 19101           DFHEIV20,
 19102           DFHEIV99,
 19103           ERPNDB-KEY,
 19104           DFHEIV99,
 19105           DFHEIV99,
 19106           DFHEIV99
 19107     SET ADDRESS OF PENDING-BUSINESS TO
 19108         DFHEIV20
 19109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19110
 19111
 19112     IF NOT  PI-PRIMARY-WITH-SELECT
 19113        GO TO 4607-CHECK-REC-TYPE.
 19114
 19115     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19116
 19117     IF  WS-BATCH-PREFIX = '#CL'
 19118         GO TO 4610-BUMP-SEQ.
 19119
 19120     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19121        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19122           GO TO 4610-BUMP-SEQ
 19123        ELSE
 19124           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19125              GO TO 4607-CHECK-REC-TYPE
 19126           ELSE
 19127              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19128                 GO TO 4607-CHECK-REC-TYPE
 19129              ELSE
 19130                 GO TO 4610-BUMP-SEQ.
 19131
 19132     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19133        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19134           GO TO 4610-BUMP-SEQ.
 19135
 19136 4607-CHECK-REC-TYPE.
 19137     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19138         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19139             NEXT SENTENCE
 19140         ELSE
 19141             GO TO 4610-BUMP-SEQ.
 19142
 19143     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19144         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19145             NEXT SENTENCE
 19146        ELSE
 19147             GO TO 4610-BUMP-SEQ.
 19148
 19149     IF NOT DISPLAY-CHANGE-RECORDS AND
 19150            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19151        GO TO 4610-BUMP-SEQ.
 19152
 19153     IF DISPLAY-HOLD-RECORDS AND
 19154        NOT PB-RECORD-ON-HOLD
 19155          GO TO 4610-BUMP-SEQ.
 19156
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 356
* EL6311.cbl
 19157     IF PB-ISSUE
 19158        IF DISPLAY-CHK-REQ-RECORDS
 19159           GO TO 4610-BUMP-SEQ.
 19160
 19161     IF PB-ISSUE
 19162        IF ISSUE-WITH-WARNING
 19163           IF PB-WARNING-ERRORS
 19164              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19165                  GO TO 4610-BUMP-SEQ
 19166              ELSE
 19167                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19168                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19169                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19170                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19171                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19172                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19173                 GO TO 7000-DISPLAY-ISSUES
 19174           ELSE
 19175              GO TO 4610-BUMP-SEQ.
 19176
 19177     IF PB-ISSUE
 19178        IF (ISSUES-IN-ERROR AND
 19179            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19180            ALL-ISSUES
 19181            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19182            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19183            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19184            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19185            MOVE PB-SV-STATE            TO PI-SV-STATE
 19186            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19187            GO TO 7000-DISPLAY-ISSUES
 19188        ELSE
 19189            GO TO 4610-BUMP-SEQ.
 19190
 19191     IF PB-CANCELLATION
 19192        IF DISPLAY-CHK-REQ-RECORDS
 19193           IF PB-C-REFUND-REQUESTED
 19194              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19195              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19196              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19197              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19198              MOVE PB-SV-STATE            TO PI-SV-STATE
 19199              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19200              GO TO 7100-DISPLAY-CANCELS
 19201           ELSE
 19202              GO TO 4610-BUMP-SEQ.
 19203
 19204     IF PB-CANCELLATION
 19205        IF CANCEL-WITH-WARNING
 19206           IF PB-WARNING-ERRORS
 19207              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19208                  GO TO 4610-BUMP-SEQ
 19209              ELSE
 19210                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19211                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19212                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19213                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19214                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 357
* EL6311.cbl
 19215                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19216                 GO TO 7100-DISPLAY-CANCELS
 19217           ELSE
 19218              GO TO 4610-BUMP-SEQ.
 19219
 19220     IF PB-CANCELLATION
 19221        IF (CANCEL-IN-ERROR  AND
 19222            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19223            ALL-CANCELS
 19224            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19225            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19226            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19227            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19228            MOVE PB-SV-STATE            TO PI-SV-STATE
 19229            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19230            GO TO 7100-DISPLAY-CANCELS.
 19231
 19232 4610-BUMP-SEQ.
 19233     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 19234        GO TO 4650-END-BATCH.
 19235
 19236     IF DISPLAY-CHANGE-RECORDS
 19237        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19238           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 19239        ELSE
 19240           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19241           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19242        ELSE
 19243           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19244           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 19245
 19246        GO TO 4605-READ-NEXT.
 19247
 19248 4650-END-BATCH.
 19249     IF PI-MAP-NAME = EL631B
 19250        MOVE -1                  TO BMAINTL
 19251     ELSE
 19252        IF PI-MAP-NAME = EL631C
 19253           MOVE -1               TO CMAINTL
 19254        ELSE
 19255           MOVE -1               TO DPFENTRL.
 19256
 19257     MOVE ER-2252               TO EMI-ERROR.
 19258     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19259     GO TO 8200-SEND-DATAONLY.
 19260
 19261 4680-NOT-FOUND.
 19262     IF DISPLAY-CHANGE-RECORDS
 19263        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19264           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19265        ELSE
 19266           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19267           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19268     ELSE
 19269        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 19270
 19271     GO TO 4605-READ-NEXT.
 19272
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 358
* EL6311.cbl
 19274
 19275******************************************************************
 19276*                                                                *
 19277*        B R O W S E   F I L E   B A C K W A R D S               *
 19278*                                                                *
 19279******************************************************************
 19280
 19281 4800-BROWSE-FILE-BACKWARD.
 19282
 19283* EXEC CICS HANDLE CONDITION
 19284*         NOTFND   (4860-NOT-FOUND)
 19285*         ENDFILE  (4850-END-RECORDS)
 19286*    END-EXEC.
 19287*    MOVE '"$I''                  ! N #00016452' TO DFHEIV0
 19288     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19290     MOVE X'4E20233030303136343532' TO DFHEIV0(25:11)
 19291     CALL 'kxdfhei1' USING DFHEIV0
 19292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19293
 19294
 19295     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 19296
 19297     IF PI-DISPLAY-ORIGINAL-BATCH
 19298        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19299     ELSE
 19300        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19301
 19302
 19303* EXEC CICS STARTBR
 19304*         DATASET   (FILE-ID)
 19305*         RIDFLD    (ERPNDB-KEY)
 19306*    END-EXEC.
 19307     MOVE 0
 19308       TO DFHEIV11
 19309*    MOVE '&,         G          &   #00016464' TO DFHEIV0
 19310     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19311     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19312     MOVE X'2020233030303136343634' TO DFHEIV0(25:11)
 19313     CALL 'kxdfhei1' USING DFHEIV0,
 19314           FILE-ID,
 19315           ERPNDB-KEY,
 19316           DFHEIV99,
 19317           DFHEIV11,
 19318           DFHEIV99
 19319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19320
 19321
 19322     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19323
 19324
 19325* EXEC CICS READPREV
 19326*         DATASET    (FILE-ID-ERPNDB)
 19327*         SET        (ADDRESS OF PENDING-BUSINESS)
 19328*         RIDFLD     (ERPNDB-KEY)
 19329*    END-EXEC.
 19330     MOVE 0
 19331       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 359
* EL6311.cbl
 19332*    MOVE '&0S                   )   #00016471' TO DFHEIV0
 19333     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19334     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19335     MOVE X'2020233030303136343731' TO DFHEIV0(25:11)
 19336     CALL 'kxdfhei1' USING DFHEIV0,
 19337           FILE-ID-ERPNDB,
 19338           DFHEIV20,
 19339           DFHEIV99,
 19340           ERPNDB-KEY,
 19341           DFHEIV99,
 19342           DFHEIV11,
 19343           DFHEIV99,
 19344           DFHEIV99
 19345     SET ADDRESS OF PENDING-BUSINESS TO
 19346         DFHEIV20
 19347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19348
 19349
 19350 4810-READ-PREV-RECORD.
 19351
 19352* EXEC CICS READPREV
 19353*         DATASET    (FILE-ID-ERPNDB)
 19354*         SET        (ADDRESS OF PENDING-BUSINESS)
 19355*         RIDFLD     (ERPNDB-KEY)
 19356*    END-EXEC.
 19357     MOVE 0
 19358       TO DFHEIV11
 19359*    MOVE '&0S                   )   #00016478' TO DFHEIV0
 19360     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19361     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19362     MOVE X'2020233030303136343738' TO DFHEIV0(25:11)
 19363     CALL 'kxdfhei1' USING DFHEIV0,
 19364           FILE-ID-ERPNDB,
 19365           DFHEIV20,
 19366           DFHEIV99,
 19367           ERPNDB-KEY,
 19368           DFHEIV99,
 19369           DFHEIV11,
 19370           DFHEIV99,
 19371           DFHEIV99
 19372     SET ADDRESS OF PENDING-BUSINESS TO
 19373         DFHEIV20
 19374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19375
 19376
 19377     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 19378        GO TO 4850-END-RECORDS.
 19379
 19380     IF PB-BATCH-TRAILER
 19381        GO TO 4810-READ-PREV-RECORD.
 19382
 19383     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19384
 19385     IF  WS-BATCH-PREFIX = '#CL'
 19386         GO TO 4810-READ-PREV-RECORD.
 19387
 19388     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19389        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 360
* EL6311.cbl
 19390           GO TO 4810-READ-PREV-RECORD
 19391        ELSE
 19392           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19393              GO TO 4820-CHECK-REC-TYPE
 19394           ELSE
 19395              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19396                 GO TO 4820-CHECK-REC-TYPE
 19397              ELSE
 19398                 GO TO 4810-READ-PREV-RECORD.
 19399
 19400     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19401        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19402           GO TO 4810-READ-PREV-RECORD.
 19403
 19404 4820-CHECK-REC-TYPE.
 19405     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19406         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19407             NEXT SENTENCE
 19408         ELSE
 19409             GO TO 4810-READ-PREV-RECORD.
 19410
 19411     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19412         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19413             NEXT SENTENCE
 19414        ELSE
 19415             GO TO 4810-READ-PREV-RECORD.
 19416
 19417     IF NOT DISPLAY-CHANGE-RECORDS AND
 19418            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19419        GO TO 4810-READ-PREV-RECORD.
 19420
 19421     IF DISPLAY-HOLD-RECORDS AND
 19422        NOT PB-RECORD-ON-HOLD
 19423          GO TO 4810-READ-PREV-RECORD.
 19424
 19425     IF PB-ISSUE
 19426        IF DISPLAY-CHK-REQ-RECORDS
 19427           GO TO 4810-READ-PREV-RECORD.
 19428
 19429     IF PB-ISSUE
 19430        IF ISSUE-WITH-WARNING
 19431           IF PB-WARNING-ERRORS
 19432              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19433                  GO TO 4810-READ-PREV-RECORD
 19434              ELSE
 19435                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19436                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19437                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19438                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19439                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19440                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19441                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19442                 GO TO 7000-DISPLAY-ISSUES
 19443           ELSE
 19444              GO TO 4810-READ-PREV-RECORD.
 19445
 19446     IF PB-ISSUE
 19447        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 361
* EL6311.cbl
 19448            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19449            ALL-ISSUES
 19450            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19451            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19452            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19453            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19454            MOVE PB-SV-STATE            TO PI-SV-STATE
 19455            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19456            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19457            GO TO 7000-DISPLAY-ISSUES
 19458        ELSE
 19459            GO TO 4810-READ-PREV-RECORD.
 19460
 19461     IF PB-CANCELLATION
 19462        IF DISPLAY-CHK-REQ-RECORDS
 19463           IF PB-C-REFUND-REQUESTED
 19464              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19465              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19466              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19467              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19468              MOVE PB-SV-STATE            TO PI-SV-STATE
 19469              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19470              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19471              GO TO 7100-DISPLAY-CANCELS
 19472           ELSE
 19473              GO TO 4810-READ-PREV-RECORD.
 19474
 19475     IF PB-CANCELLATION
 19476        IF CANCEL-WITH-WARNING
 19477           IF PB-WARNING-ERRORS
 19478              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19479                  GO TO 4810-READ-PREV-RECORD
 19480              ELSE
 19481                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19482                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19483                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19484                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19485                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19486                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19487                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19488                 GO TO 7100-DISPLAY-CANCELS
 19489           ELSE
 19490              GO TO 4810-READ-PREV-RECORD.
 19491
 19492     IF PB-CANCELLATION
 19493        IF (CANCEL-IN-ERROR  AND
 19494            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19495            ALL-CANCELS
 19496            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19497            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19498            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19499            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19500            MOVE PB-SV-STATE            TO PI-SV-STATE
 19501            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19502            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19503            GO TO 7100-DISPLAY-CANCELS.
 19504
 19505     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 362
* EL6311.cbl
 19506
 19507 4850-END-RECORDS.
 19508     MOVE ER-2252                TO EMI-ERROR.
 19509     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19510
 19511     IF PI-MAP-NAME = EL631B
 19512        MOVE -1                  TO BPFENTRL
 19513     ELSE
 19514        MOVE -1                  TO CPFENTRL.
 19515
 19516     GO TO 8200-SEND-DATAONLY.
 19517
 19518 4860-NOT-FOUND.
 19519
 19520******************************************************************
 19521*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 19522******************************************************************
 19523
 19524
 19525* EXEC CICS RESETBR
 19526*         DATASET    (FILE-ID-ERPNDB)
 19527*         RIDFLD     (ERPNDB-KEY)
 19528*     END-EXEC.
 19529     MOVE 0
 19530       TO DFHEIV11
 19531*    MOVE '&4         G          &   #00016631' TO DFHEIV0
 19532     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19533     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19534     MOVE X'2020233030303136363331' TO DFHEIV0(25:11)
 19535     CALL 'kxdfhei1' USING DFHEIV0,
 19536           FILE-ID-ERPNDB,
 19537           ERPNDB-KEY,
 19538           DFHEIV99,
 19539           DFHEIV11,
 19540           DFHEIV99
 19541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19542
 19543
 19544
 19545* EXEC CICS READNEXT
 19546*         DATASET    (FILE-ID-ERPNDB)
 19547*         SET        (ADDRESS OF PENDING-BUSINESS)
 19548*         RIDFLD     (ERPNDB-KEY)
 19549*    END-EXEC.
 19550     MOVE 0
 19551       TO DFHEIV11
 19552*    MOVE '&.S                   )   #00016636' TO DFHEIV0
 19553     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19554     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19555     MOVE X'2020233030303136363336' TO DFHEIV0(25:11)
 19556     CALL 'kxdfhei1' USING DFHEIV0,
 19557           FILE-ID-ERPNDB,
 19558           DFHEIV20,
 19559           DFHEIV99,
 19560           ERPNDB-KEY,
 19561           DFHEIV99,
 19562           DFHEIV11,
 19563           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 363
* EL6311.cbl
 19564           DFHEIV99
 19565     SET ADDRESS OF PENDING-BUSINESS TO
 19566         DFHEIV20
 19567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19568
 19569
 19570
 19571* EXEC CICS READPREV
 19572*         DATASET    (FILE-ID-ERPNDB)
 19573*         SET        (ADDRESS OF PENDING-BUSINESS)
 19574*         RIDFLD     (ERPNDB-KEY)
 19575*    END-EXEC.
 19576     MOVE 0
 19577       TO DFHEIV11
 19578*    MOVE '&0S                   )   #00016642' TO DFHEIV0
 19579     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19580     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19581     MOVE X'2020233030303136363432' TO DFHEIV0(25:11)
 19582     CALL 'kxdfhei1' USING DFHEIV0,
 19583           FILE-ID-ERPNDB,
 19584           DFHEIV20,
 19585           DFHEIV99,
 19586           ERPNDB-KEY,
 19587           DFHEIV99,
 19588           DFHEIV11,
 19589           DFHEIV99,
 19590           DFHEIV99
 19591     SET ADDRESS OF PENDING-BUSINESS TO
 19592         DFHEIV20
 19593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19594
 19595
 19596     GO TO 4810-READ-PREV-RECORD.
 19597
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 364
* EL6311.cbl
 19599
 19600******************************************************************
 19601*                                                                *
 19602*           B R O W S E   C S R   B A C K W A R D                *
 19603*                                                                *
 19604******************************************************************
 19605
 19606 4900-BROWSE-CSR-BACKWARD.
 19607
 19608     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19609
 19610
 19611* EXEC CICS HANDLE CONDITION
 19612*         NOTFND   (4970-NOT-FOUND)
 19613*         ENDFILE  (4950-END-RECORDS)
 19614*    END-EXEC
 19615*    MOVE '"$I''                  ! O #00016662' TO DFHEIV0
 19616     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19618     MOVE X'4F20233030303136363632' TO DFHEIV0(25:11)
 19619     CALL 'kxdfhei1' USING DFHEIV0
 19620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19621
 19622
 19623* EXEC CICS STARTBR
 19624*         DATASET   (FILE-ID-ERPNDB4)
 19625*         RIDFLD    (ERPNDB-CSR-KEY)
 19626*    END-EXEC.
 19627     MOVE 0
 19628       TO DFHEIV11
 19629*    MOVE '&,         G          &   #00016667' TO DFHEIV0
 19630     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19631     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19632     MOVE X'2020233030303136363637' TO DFHEIV0(25:11)
 19633     CALL 'kxdfhei1' USING DFHEIV0,
 19634           FILE-ID-ERPNDB4,
 19635           ERPNDB-CSR-KEY,
 19636           DFHEIV99,
 19637           DFHEIV11,
 19638           DFHEIV99
 19639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19640
 19641
 19642     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19643                                    WS-FIRST-TIME-SW.
 19644
 19645 4905-READ-PREV-RECORD.
 19646
 19647* EXEC CICS READPREV
 19648*         DATASET    (FILE-ID-ERPNDB4)
 19649*         SET        (ADDRESS OF PENDING-BUSINESS)
 19650*         RIDFLD     (ERPNDB-CSR-KEY)
 19651*    END-EXEC.
 19652     MOVE 0
 19653       TO DFHEIV11
 19654*    MOVE '&0S                   )   #00016676' TO DFHEIV0
 19655     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19656     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 365
* EL6311.cbl
 19657     MOVE X'2020233030303136363736' TO DFHEIV0(25:11)
 19658     CALL 'kxdfhei1' USING DFHEIV0,
 19659           FILE-ID-ERPNDB4,
 19660           DFHEIV20,
 19661           DFHEIV99,
 19662           ERPNDB-CSR-KEY,
 19663           DFHEIV99,
 19664           DFHEIV11,
 19665           DFHEIV99,
 19666           DFHEIV99
 19667     SET ADDRESS OF PENDING-BUSINESS TO
 19668         DFHEIV20
 19669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19670
 19671
 19672     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19673
 19674     IF WS-BATCH-PREFIX = '#CL'
 19675         GO TO 4905-READ-PREV-RECORD.
 19676
 19677     IF FIRST-TIME
 19678         MOVE SPACE               TO WS-FIRST-TIME-SW
 19679         GO TO 4905-READ-PREV-RECORD.
 19680
 19681     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19682        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19683        GO TO 4950-END-RECORDS.
 19684
 19685     IF PB-BATCH-TRAILER
 19686        GO TO 4905-READ-PREV-RECORD.
 19687
 19688     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19689
 19690     IF  WS-BATCH-PREFIX = '#CL'
 19691         GO TO 4905-READ-PREV-RECORD.
 19692
 19693     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19694        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19695           GO TO 4905-READ-PREV-RECORD
 19696        ELSE
 19697           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19698              GO TO 4910-CHECK-REC-TYPE
 19699           ELSE
 19700              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19701                 GO TO 4910-CHECK-REC-TYPE
 19702              ELSE
 19703                 GO TO 4905-READ-PREV-RECORD.
 19704
 19705     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19706        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19707           GO TO 4905-READ-PREV-RECORD.
 19708
 19709 4910-CHECK-REC-TYPE.
 19710     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19711         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19712             NEXT SENTENCE
 19713         ELSE
 19714             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 366
* EL6311.cbl
 19715
 19716     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19717         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19718             NEXT SENTENCE
 19719        ELSE
 19720             GO TO 4905-READ-PREV-RECORD.
 19721
 19722     IF NOT DISPLAY-CHANGE-RECORDS AND
 19723            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19724        GO TO 4905-READ-PREV-RECORD.
 19725
 19726     IF DISPLAY-HOLD-RECORDS AND
 19727        NOT PB-RECORD-ON-HOLD
 19728          GO TO 4905-READ-PREV-RECORD.
 19729
 19730     IF PB-ISSUE
 19731        IF DISPLAY-CHK-REQ-RECORDS
 19732           GO TO 4905-READ-PREV-RECORD.
 19733
 19734     IF PB-ISSUE
 19735        IF ISSUE-WITH-WARNING
 19736           IF PB-WARNING-ERRORS
 19737              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19738                  GO TO 4505-READ-PREV-RECORD
 19739              ELSE
 19740                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19741                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19742                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19743                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19744                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19745                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19746                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19747                 GO TO 7000-DISPLAY-ISSUES
 19748           ELSE
 19749              GO TO 4905-READ-PREV-RECORD.
 19750
 19751     IF PB-ISSUE
 19752        IF (ISSUES-IN-ERROR AND
 19753            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19754            ALL-ISSUES
 19755            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19756            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19757            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19758            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19759            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19760            MOVE PB-SV-STATE            TO PI-SV-STATE
 19761            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19762            GO TO 7000-DISPLAY-ISSUES
 19763        ELSE
 19764            GO TO 4905-READ-PREV-RECORD.
 19765
 19766     IF PB-CANCELLATION
 19767        IF DISPLAY-CHK-REQ-RECORDS
 19768           IF PB-C-REFUND-REQUESTED
 19769              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19770              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19771              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19772              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 367
* EL6311.cbl
 19773              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19774              MOVE PB-SV-STATE            TO PI-SV-STATE
 19775              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19776              GO TO 7100-DISPLAY-CANCELS
 19777           ELSE
 19778              GO TO 4905-READ-PREV-RECORD.
 19779
 19780     IF PB-CANCELLATION
 19781        IF CANCEL-WITH-WARNING
 19782           IF PB-WARNING-ERRORS
 19783              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19784                  GO TO 4505-READ-PREV-RECORD
 19785              ELSE
 19786                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19787                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19788                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19789                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19790                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19791                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19792                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19793                 GO TO 7100-DISPLAY-CANCELS
 19794           ELSE
 19795              GO TO 4905-READ-PREV-RECORD.
 19796
 19797     IF PB-CANCELLATION
 19798        IF (CANCEL-IN-ERROR  AND
 19799            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19800            ALL-CANCELS
 19801            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19802            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19803            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19804            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19805            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19806            MOVE PB-SV-STATE            TO PI-SV-STATE
 19807            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19808            GO TO 7100-DISPLAY-CANCELS.
 19809
 19810     GO TO 4905-READ-PREV-RECORD.
 19811
 19812 4950-END-RECORDS.
 19813     IF PI-MAP-NAME = EL631B
 19814        MOVE -1                  TO BMAINTL
 19815     ELSE
 19816        IF PI-MAP-NAME = EL631C
 19817           MOVE -1               TO CMAINTL
 19818        ELSE
 19819           MOVE -1               TO DPFENTRL.
 19820
 19821     MOVE ER-2255               TO EMI-ERROR.
 19822     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19823     GO TO 8200-SEND-DATAONLY.
 19824
 19825 4970-NOT-FOUND.
 19826
 19827******************************************************************
 19828*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19829******************************************************************
 19830
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 368
* EL6311.cbl
 19831
 19832* EXEC CICS RESETBR
 19833*         DATASET    (FILE-ID-ERPNDB4)
 19834*         RIDFLD     (ERPNDB-CSR-KEY)
 19835*    END-EXEC.
 19836     MOVE 0
 19837       TO DFHEIV11
 19838*    MOVE '&4         G          &   #00016841' TO DFHEIV0
 19839     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19840     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19841     MOVE X'2020233030303136383431' TO DFHEIV0(25:11)
 19842     CALL 'kxdfhei1' USING DFHEIV0,
 19843           FILE-ID-ERPNDB4,
 19844           ERPNDB-CSR-KEY,
 19845           DFHEIV99,
 19846           DFHEIV11,
 19847           DFHEIV99
 19848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19849
 19850
 19851
 19852* EXEC CICS READNEXT
 19853*         DATASET    (FILE-ID-ERPNDB4)
 19854*         SET        (ADDRESS OF PENDING-BUSINESS)
 19855*         RIDFLD     (ERPNDB-CSR-KEY)
 19856*    END-EXEC.
 19857     MOVE 0
 19858       TO DFHEIV11
 19859*    MOVE '&.S                   )   #00016846' TO DFHEIV0
 19860     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19861     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19862     MOVE X'2020233030303136383436' TO DFHEIV0(25:11)
 19863     CALL 'kxdfhei1' USING DFHEIV0,
 19864           FILE-ID-ERPNDB4,
 19865           DFHEIV20,
 19866           DFHEIV99,
 19867           ERPNDB-CSR-KEY,
 19868           DFHEIV99,
 19869           DFHEIV11,
 19870           DFHEIV99,
 19871           DFHEIV99
 19872     SET ADDRESS OF PENDING-BUSINESS TO
 19873         DFHEIV20
 19874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19875
 19876
 19877
 19878* EXEC CICS READPREV
 19879*         DATASET    (FILE-ID-ERPNDB4)
 19880*         SET        (ADDRESS OF PENDING-BUSINESS)
 19881*         RIDFLD     (ERPNDB-CSR-KEY)
 19882*    END-EXEC.
 19883     MOVE 0
 19884       TO DFHEIV11
 19885*    MOVE '&0S                   )   #00016852' TO DFHEIV0
 19886     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19887     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19888     MOVE X'2020233030303136383532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 369
* EL6311.cbl
 19889     CALL 'kxdfhei1' USING DFHEIV0,
 19890           FILE-ID-ERPNDB4,
 19891           DFHEIV20,
 19892           DFHEIV99,
 19893           ERPNDB-CSR-KEY,
 19894           DFHEIV99,
 19895           DFHEIV11,
 19896           DFHEIV99,
 19897           DFHEIV99
 19898     SET ADDRESS OF PENDING-BUSINESS TO
 19899         DFHEIV20
 19900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19901
 19902
 19903 4980-READ-PREV-RECORD.
 19904
 19905* EXEC CICS READPREV
 19906*         DATASET    (FILE-ID-ERPNDB4)
 19907*         SET        (ADDRESS OF PENDING-BUSINESS)
 19908*         RIDFLD     (ERPNDB-CSR-KEY)
 19909*    END-EXEC.
 19910     MOVE 0
 19911       TO DFHEIV11
 19912*    MOVE '&0S                   )   #00016859' TO DFHEIV0
 19913     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19914     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19915     MOVE X'2020233030303136383539' TO DFHEIV0(25:11)
 19916     CALL 'kxdfhei1' USING DFHEIV0,
 19917           FILE-ID-ERPNDB4,
 19918           DFHEIV20,
 19919           DFHEIV99,
 19920           ERPNDB-CSR-KEY,
 19921           DFHEIV99,
 19922           DFHEIV11,
 19923           DFHEIV99,
 19924           DFHEIV99
 19925     SET ADDRESS OF PENDING-BUSINESS TO
 19926         DFHEIV20
 19927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19928
 19929
 19930     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19931
 19932     IF WS-BATCH-PREFIX = '#CL'
 19933        GO TO 4980-READ-PREV-RECORD.
 19934
 19935     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19936     GO TO 4905-READ-PREV-RECORD.
 19937
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 370
* EL6311.cbl
 19939
 19940
 19941******************************************************************
 19942*                                                                *
 19943*        B R O W S E   B A T C H   H E A D E R S                 *
 19944*                                                                *
 19945******************************************************************
 19946
 19947 5000-BROWSE-BATCH-HEADERS.
 19948
 19949     IF EIBTRNID NOT = TRANS-EXB1
 19950        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19951        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 19952        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19953        GO TO 5010-READ-NEXT-RECORD.
 19954
 19955     IF EIBAID = DFHPF4
 19956        MOVE '0'                TO PI-EDIT-SW
 19957        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19958        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 19959        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19960        GO TO 5010-READ-NEXT-RECORD.
 19961
 19962     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 19963     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 19964     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 19965
 19966
 19967* EXEC CICS HANDLE CONDITION
 19968*         ENDFILE  (5050-NOT-FOUND)
 19969*    END-EXEC.
 19970*    MOVE '"$''                   ! P #00016901' TO DFHEIV0
 19971     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19972     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19973     MOVE X'5020233030303136393031' TO DFHEIV0(25:11)
 19974     CALL 'kxdfhei1' USING DFHEIV0
 19975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19976
 19977
 19978 5010-READ-NEXT-RECORD.
 19979
 19980* EXEC CICS HANDLE CONDITION
 19981*         NOTFND    (5050-NOT-FOUND)
 19982*    END-EXEC.
 19983*    MOVE '"$I                   ! Q #00016906' TO DFHEIV0
 19984     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19985     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19986     MOVE X'5120233030303136393036' TO DFHEIV0(25:11)
 19987     CALL 'kxdfhei1' USING DFHEIV0
 19988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19989
 19990
 19991
 19992* EXEC CICS READ
 19993*         DATASET   (FILE-ID-ERPNDB)
 19994*         SET       (ADDRESS OF PENDING-BUSINESS)
 19995*         RIDFLD    (ERPNDB-KEY)
 19996*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 371
* EL6311.cbl
 19997*    END-EXEC.
 19998*    MOVE '&"S        G          (   #00016910' TO DFHEIV0
 19999     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20000     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20001     MOVE X'2020233030303136393130' TO DFHEIV0(25:11)
 20002     CALL 'kxdfhei1' USING DFHEIV0,
 20003           FILE-ID-ERPNDB,
 20004           DFHEIV20,
 20005           DFHEIV99,
 20006           ERPNDB-KEY,
 20007           DFHEIV99,
 20008           DFHEIV99,
 20009           DFHEIV99
 20010     SET ADDRESS OF PENDING-BUSINESS TO
 20011         DFHEIV20
 20012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20013
 20014
 20015     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20016         GO TO 5050-NOT-FOUND.
 20017
 20018     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20019
 20020     IF WS-BATCH-PREFIX = '#CL'
 20021         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20022         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20023         GO TO 5010-READ-NEXT-RECORD.
 20024
 20025     IF NOT PB-BATCH-TRAILER
 20026         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20027         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20028         GO TO 5010-READ-NEXT-RECORD.
 20029
 20030     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20031         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20032             NEXT SENTENCE
 20033         ELSE
 20034             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20035             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20036             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20037             GO TO 5010-READ-NEXT-RECORD.
 20038
 20039     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20040         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20041             NEXT SENTENCE
 20042        ELSE
 20043             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20044             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20045             GO TO 5010-READ-NEXT-RECORD.
 20046
 20047     IF EIBAID = DFHPF4
 20048        MOVE '0'                TO PI-EDIT-SW
 20049        GO TO 7200-DISPLAY-BATCHES.
 20050
 20051     IF PI-CSR-BROWSE
 20052        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20053           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20054           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 372
* EL6311.cbl
 20055           GO TO 5010-READ-NEXT-RECORD.
 20056
 20057     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20058       IF PI-PB-CARRIER    = SPACES AND
 20059          PI-PB-GROUPING   = SPACES AND
 20060          PI-PB-STATE      = SPACES AND
 20061          PI-PB-ACCOUNT    = SPACES
 20062            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20063            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20064            GO TO 7200-DISPLAY-BATCHES
 20065         ELSE
 20066           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20067              PI-PB-GROUPING   = PB-GROUPING AND
 20068              PI-PB-STATE      = PB-STATE    AND
 20069              PI-PB-ACCOUNT    = PB-ACCOUNT
 20070              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20071              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20072              GO TO 7200-DISPLAY-BATCHES.
 20073
 20074     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20075     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20076
 20077
 20078* EXEC CICS HANDLE CONDITION
 20079*         NOTFND    (5050-NOT-FOUND)
 20080*    END-EXEC.
 20081*    MOVE '"$I                   ! R #00016979' TO DFHEIV0
 20082     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20083     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20084     MOVE X'5220233030303136393739' TO DFHEIV0(25:11)
 20085     CALL 'kxdfhei1' USING DFHEIV0
 20086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20087
 20088
 20089
 20090* EXEC CICS READ
 20091*         DATASET   (FILE-ID-ERPNDB)
 20092*         SET       (ADDRESS OF PENDING-BUSINESS)
 20093*         RIDFLD    (ERPNDB-KEY)
 20094*         GTEQ
 20095*    END-EXEC.
 20096*    MOVE '&"S        G          (   #00016983' TO DFHEIV0
 20097     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20098     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20099     MOVE X'2020233030303136393833' TO DFHEIV0(25:11)
 20100     CALL 'kxdfhei1' USING DFHEIV0,
 20101           FILE-ID-ERPNDB,
 20102           DFHEIV20,
 20103           DFHEIV99,
 20104           ERPNDB-KEY,
 20105           DFHEIV99,
 20106           DFHEIV99,
 20107           DFHEIV99
 20108     SET ADDRESS OF PENDING-BUSINESS TO
 20109         DFHEIV20
 20110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20111
 20112
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 373
* EL6311.cbl
 20113     GO TO 5010-READ-NEXT-RECORD.
 20114
 20115 5050-NOT-FOUND.
 20116
 20117******************************************************************
 20118*                                                                *
 20119*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20120*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 20121*         PROGRAM.                                               *
 20122*                                                                *
 20123******************************************************************
 20124
 20125     IF EIBTRNID NOT = TRANS-EXB1
 20126        IF PENDING-BUS-RECS-FOUND
 20127            NEXT SENTENCE
 20128          ELSE
 20129            MOVE '9'            TO PI-BROWSE-SW
 20130            GO TO 9400-CLEAR.
 20131
 20132     MOVE ER-2256                TO EMI-ERROR.
 20133     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20134
 20135     IF PI-MAP-NAME = SPACES
 20136        MOVE EL631D              TO PI-MAP-NAME
 20137        MOVE -1                  TO DPFENTRL
 20138        GO TO 8100-SEND-INITIAL-MAP.
 20139
 20140     IF PI-MAP-NAME = EL631B
 20141        MOVE -1                  TO BMAINTL
 20142     ELSE
 20143        IF PI-MAP-NAME = EL631C
 20144           MOVE -1               TO CMAINTL
 20145        ELSE
 20146           MOVE -1               TO DPFENTRL
 20147           GO TO 8200-SEND-DATAONLY.
 20148
 20149     GO TO 8100-SEND-INITIAL-MAP.
 20150
 20151     .
 20152 5100-PROCESS-POL-RESC.
 20153     MOVE ZEROS                  TO CG-LF-BENCD
 20154                                    CG-AH-BENCD
 20155                                    CG-LF-CAN-AMT
 20156                                    CG-AH-CAN-AMT
 20157     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20158                                    CG-AH-CAN-DT
 20159     MOVE SPACES                 TO CG-BATCH-NO
 20160     MOVE '4'                    TO CG-OPTION-CODE
 20161     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 20162     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 20163     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 20164     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 20165     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 20166     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 20167     MOVE PI-SV-STATE            TO CG-CERT-STATE
 20168     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 20169     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 20170     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 374
* EL6311.cbl
 20171     MOVE PI-PREV-ALT-KEY (1:33)
 20172                                 TO CG-CERT-KEY
 20173     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 20174     MOVE ZEROS                  TO CG-LF-CAN-AMT
 20175                                    CG-AH-CAN-AMT
 20176     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20177                                    CG-AH-CAN-DT
 20178     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 20179     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 20180      display 'about to cancel ' cg-cert-key
 20181
 20182* EXEC CICS LINK
 20183*        PROGRAM  ('ELCANC')
 20184*        COMMAREA (CANCEL-GEN-PASS-AREA)
 20185*    END-EXEC
 20186     MOVE LENGTH OF
 20187      CANCEL-GEN-PASS-AREA
 20188       TO DFHEIV11
 20189     MOVE 'ELCANC' TO DFHEIV1
 20190*    MOVE '."C                   ''   #00017058' TO DFHEIV0
 20191     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20192     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20193     MOVE X'2020233030303137303538' TO DFHEIV0(25:11)
 20194     CALL 'kxdfhei1' USING DFHEIV0,
 20195           DFHEIV1,
 20196           CANCEL-GEN-PASS-AREA,
 20197           DFHEIV11,
 20198           DFHEIV99,
 20199           DFHEIV99,
 20200           DFHEIV99
 20201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20202     IF CG-SUCCESS
 20203        CONTINUE
 20204     ELSE
 20205        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 20206        MOVE '3'                 TO EMI-SWITCH1
 20207        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 20208        EVALUATE TRUE
 20209           WHEN CG-DATE-ERROR
 20210             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20211           WHEN CG-CERT-NOT-FOUND
 20212             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20213           WHEN CG-AMOUNT-ERROR
 20214             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20215           WHEN CG-OPTION-ERROR
 20216             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20217           WHEN CG-PREV-CAN
 20218             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20219           WHEN CG-INVALID-DATA
 20220             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20221           WHEN CG-NO-ACCT-MSTR
 20222             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20223           WHEN CG-SFX-A-EXIST
 20224             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20225           WHEN CG-MISC-ERROR
 20226             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20227           WHEN OTHER
 20228             MOVE ' ERROR - ELCANC - RETURN '
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 375
* EL6311.cbl
 20229                                 TO EMI-ERROR-TEXT (1) (12:25)
 20230        END-EVALUATE
 20231        GO TO 8200-SEND-DATAONLY
 20232     END-IF
 20233     .
 20234 5100-EXIT.
 20235     EXIT.
 20236
 20237******************************************************************
 20238*                                                                *
 20239*        B R O W S E   B A T C H   B A C K W A R D S             *
 20240*                                                                *
 20241******************************************************************
 20242
 20243 5500-BROWSE-BATCH-BACKWARD.
 20244
 20245* EXEC CICS HANDLE CONDITION
 20246*         NOTFND   (5550-END-RECORDS)
 20247*         ENDFILE  (5550-END-RECORDS)
 20248*    END-EXEC.
 20249*    MOVE '"$I''                  ! S #00017104' TO DFHEIV0
 20250     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20252     MOVE X'5320233030303137313034' TO DFHEIV0(25:11)
 20253     CALL 'kxdfhei1' USING DFHEIV0
 20254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20255
 20256
 20257 5505-START-BROWSE.
 20258     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20259     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 20260     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20261
 20262
 20263* EXEC CICS STARTBR
 20264*         DATASET   (FILE-ID-ERPNDB)
 20265*         RIDFLD    (ERPNDB-ALT-KEY)
 20266*    END-EXEC.
 20267     MOVE 0
 20268       TO DFHEIV11
 20269*    MOVE '&,         G          &   #00017114' TO DFHEIV0
 20270     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20271     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20272     MOVE X'2020233030303137313134' TO DFHEIV0(25:11)
 20273     CALL 'kxdfhei1' USING DFHEIV0,
 20274           FILE-ID-ERPNDB,
 20275           ERPNDB-ALT-KEY,
 20276           DFHEIV99,
 20277           DFHEIV11,
 20278           DFHEIV99
 20279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20280
 20281
 20282     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20283
 20284
 20285* EXEC CICS READNEXT
 20286*         DATASET    (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 376
* EL6311.cbl
 20287*         SET        (ADDRESS OF PENDING-BUSINESS)
 20288*         RIDFLD     (ERPNDB-KEY)
 20289*    END-EXEC.
 20290     MOVE 0
 20291       TO DFHEIV11
 20292*    MOVE '&.S                   )   #00017121' TO DFHEIV0
 20293     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20294     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20295     MOVE X'2020233030303137313231' TO DFHEIV0(25:11)
 20296     CALL 'kxdfhei1' USING DFHEIV0,
 20297           FILE-ID-ERPNDB,
 20298           DFHEIV20,
 20299           DFHEIV99,
 20300           ERPNDB-KEY,
 20301           DFHEIV99,
 20302           DFHEIV11,
 20303           DFHEIV99,
 20304           DFHEIV99
 20305     SET ADDRESS OF PENDING-BUSINESS TO
 20306         DFHEIV20
 20307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20308
 20309
 20310
 20311* EXEC CICS READPREV
 20312*         DATASET    (FILE-ID-ERPNDB)
 20313*         SET        (ADDRESS OF PENDING-BUSINESS)
 20314*         RIDFLD     (ERPNDB-KEY)
 20315*    END-EXEC.
 20316     MOVE 0
 20317       TO DFHEIV11
 20318*    MOVE '&0S                   )   #00017127' TO DFHEIV0
 20319     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20320     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20321     MOVE X'2020233030303137313237' TO DFHEIV0(25:11)
 20322     CALL 'kxdfhei1' USING DFHEIV0,
 20323           FILE-ID-ERPNDB,
 20324           DFHEIV20,
 20325           DFHEIV99,
 20326           ERPNDB-KEY,
 20327           DFHEIV99,
 20328           DFHEIV11,
 20329           DFHEIV99,
 20330           DFHEIV99
 20331     SET ADDRESS OF PENDING-BUSINESS TO
 20332         DFHEIV20
 20333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20334
 20335
 20336
 20337* EXEC CICS READPREV
 20338*         DATASET    (FILE-ID-ERPNDB)
 20339*         SET        (ADDRESS OF PENDING-BUSINESS)
 20340*         RIDFLD     (ERPNDB-KEY)
 20341*    END-EXEC.
 20342     MOVE 0
 20343       TO DFHEIV11
 20344*    MOVE '&0S                   )   #00017133' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 377
* EL6311.cbl
 20345     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20346     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20347     MOVE X'2020233030303137313333' TO DFHEIV0(25:11)
 20348     CALL 'kxdfhei1' USING DFHEIV0,
 20349           FILE-ID-ERPNDB,
 20350           DFHEIV20,
 20351           DFHEIV99,
 20352           ERPNDB-KEY,
 20353           DFHEIV99,
 20354           DFHEIV11,
 20355           DFHEIV99,
 20356           DFHEIV99
 20357     SET ADDRESS OF PENDING-BUSINESS TO
 20358         DFHEIV20
 20359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20360
 20361
 20362     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20363        GO TO 5550-END-RECORDS.
 20364
 20365     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20366
 20367     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20368
 20369     IF  WS-BATCH-PREFIX = '#CL'
 20370             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20371
 20372* EXEC CICS ENDBR
 20373*                 DATASET  (FILE-ID-ERPNDB)
 20374*            END-EXEC
 20375     MOVE 0
 20376       TO DFHEIV11
 20377*    MOVE '&2                    $   #00017148' TO DFHEIV0
 20378     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20379     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20380     MOVE X'2020233030303137313438' TO DFHEIV0(25:11)
 20381     CALL 'kxdfhei1' USING DFHEIV0,
 20382           FILE-ID-ERPNDB,
 20383           DFHEIV11,
 20384           DFHEIV99
 20385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20386         GO TO 5505-START-BROWSE.
 20387
 20388     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20389         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20390             NEXT SENTENCE
 20391         ELSE
 20392             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20393
 20394* EXEC CICS ENDBR
 20395*                 DATASET  (FILE-ID-ERPNDB)
 20396*            END-EXEC
 20397     MOVE 0
 20398       TO DFHEIV11
 20399*    MOVE '&2                    $   #00017158' TO DFHEIV0
 20400     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20401     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20402     MOVE X'2020233030303137313538' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 378
* EL6311.cbl
 20403     CALL 'kxdfhei1' USING DFHEIV0,
 20404           FILE-ID-ERPNDB,
 20405           DFHEIV11,
 20406           DFHEIV99
 20407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20408             GO TO 5505-START-BROWSE.
 20409
 20410
 20411     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20412         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20413             NEXT SENTENCE
 20414        ELSE
 20415             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20416
 20417* EXEC CICS ENDBR
 20418*                 DATASET  (FILE-ID-ERPNDB)
 20419*            END-EXEC
 20420     MOVE 0
 20421       TO DFHEIV11
 20422*    MOVE '&2                    $   #00017169' TO DFHEIV0
 20423     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20424     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20425     MOVE X'2020233030303137313639' TO DFHEIV0(25:11)
 20426     CALL 'kxdfhei1' USING DFHEIV0,
 20427           FILE-ID-ERPNDB,
 20428           DFHEIV11,
 20429           DFHEIV99
 20430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20431             GO TO 5505-START-BROWSE.
 20432
 20433     IF NOT PB-BATCH-TRAILER
 20434        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20435
 20436* EXEC CICS ENDBR
 20437*            DATASET  (FILE-ID-ERPNDB)
 20438*       END-EXEC
 20439     MOVE 0
 20440       TO DFHEIV11
 20441*    MOVE '&2                    $   #00017176' TO DFHEIV0
 20442     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20443     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20444     MOVE X'2020233030303137313736' TO DFHEIV0(25:11)
 20445     CALL 'kxdfhei1' USING DFHEIV0,
 20446           FILE-ID-ERPNDB,
 20447           DFHEIV11,
 20448           DFHEIV99
 20449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20450        GO TO 5505-START-BROWSE.
 20451
 20452     IF PI-CSR-BROWSE
 20453        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20454           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 20455
 20456* EXEC CICS ENDBR
 20457*               DATASET  (FILE-ID-ERPNDB)
 20458*          END-EXEC
 20459     MOVE 0
 20460       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 379
* EL6311.cbl
 20461*    MOVE '&2                    $   #00017184' TO DFHEIV0
 20462     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20463     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20464     MOVE X'2020233030303137313834' TO DFHEIV0(25:11)
 20465     CALL 'kxdfhei1' USING DFHEIV0,
 20466           FILE-ID-ERPNDB,
 20467           DFHEIV11,
 20468           DFHEIV99
 20469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20470           GO TO 5505-START-BROWSE.
 20471
 20472     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20473        IF PI-PB-CARRIER    = SPACES AND
 20474           PI-PB-GROUPING   = SPACES AND
 20475           PI-PB-STATE      = SPACES AND
 20476           PI-PB-ACCOUNT    = SPACES
 20477             GO TO 7200-DISPLAY-BATCHES
 20478          ELSE
 20479            IF PI-PB-CARRIER    = PB-CARRIER  AND
 20480               PI-PB-GROUPING   = PB-GROUPING AND
 20481               PI-PB-STATE      = PB-STATE    AND
 20482               PI-PB-ACCOUNT    = PB-ACCOUNT
 20483                 GO TO 7200-DISPLAY-BATCHES.
 20484
 20485     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 20486
 20487
 20488* EXEC CICS ENDBR
 20489*         DATASET  (FILE-ID-ERPNDB)
 20490*    END-EXEC.
 20491     MOVE 0
 20492       TO DFHEIV11
 20493*    MOVE '&2                    $   #00017204' TO DFHEIV0
 20494     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20495     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20496     MOVE X'2020233030303137323034' TO DFHEIV0(25:11)
 20497     CALL 'kxdfhei1' USING DFHEIV0,
 20498           FILE-ID-ERPNDB,
 20499           DFHEIV11,
 20500           DFHEIV99
 20501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20502
 20503
 20504     GO TO 5505-START-BROWSE.
 20505
 20506 5550-END-RECORDS.
 20507     MOVE ER-2257                TO EMI-ERROR.
 20508     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20509     MOVE -1                     TO DPFENTRL.
 20510
 20511     GO TO 8200-SEND-DATAONLY.
 20512
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 380
* EL6311.cbl
 20514
 20515******************************************************************
 20516*                                                                *
 20517*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 20518*                                                                *
 20519******************************************************************
 20520
 20521 6000-CREATE-TEMP-STORAGE.
 20522
 20523
 20524* EXEC CICS HANDLE CONDITION
 20525*        QIDERR  (6050-QID-ERROR)
 20526*    END-EXEC.
 20527*    MOVE '"$N                   ! T #00017227' TO DFHEIV0
 20528     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20530     MOVE X'5420233030303137323237' TO DFHEIV0(25:11)
 20531     CALL 'kxdfhei1' USING DFHEIV0
 20532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20533
 20534
 20535
 20536* EXEC CICS WRITEQ TS
 20537*        QUEUE    (QID)
 20538*        FROM     (PROGRAM-INTERFACE-BLOCK)
 20539*        LENGTH   (WS-COMM-LENGTH)
 20540*        ITEM     (W-ONE)
 20541*    END-EXEC.
 20542*    MOVE '*" I                  ''   #00017231' TO DFHEIV0
 20543     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 20544     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20545     MOVE X'2020233030303137323331' TO DFHEIV0(25:11)
 20546     CALL 'kxdfhei1' USING DFHEIV0,
 20547           QID,
 20548           PROGRAM-INTERFACE-BLOCK,
 20549           WS-COMM-LENGTH,
 20550           W-ONE,
 20551           DFHEIV99,
 20552           DFHEIV99
 20553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20554
 20555
 20556 6000-EXIT.
 20557      EXIT.
 20558
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 381
* EL6311.cbl
 20560
 20561******************************************************************
 20562*                                                                *
 20563*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 20564*                                                                *
 20565******************************************************************
 20566
 20567 6050-RECOVER-TEMP-STORAGE.
 20568     IF PGM-NAME = XCTL-EL6312
 20569        GO TO 6050-EXIT.
 20570
 20571     IF PGM-NAME = XCTL-EL6313
 20572        GO TO 6050-EXIT.
 20573
 20574     IF PGM-NAME = XCTL-EL6315
 20575         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 20576     END-IF
 20577
 20578     IF PGM-NAME = XCTL-EL6316
 20579         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 20580     END-IF
 20581
 20582
 20583* EXEC CICS HANDLE CONDITION
 20584*        QIDERR  (6050-QID-ERROR)
 20585*    END-EXEC.
 20586*    MOVE '"$N                   ! U #00017264' TO DFHEIV0
 20587     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20589     MOVE X'5520233030303137323634' TO DFHEIV0(25:11)
 20590     CALL 'kxdfhei1' USING DFHEIV0
 20591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20592
 20593
 20594
 20595* EXEC CICS READQ TS
 20596*         QUEUE   (QID)
 20597*         INTO    (PROGRAM-INTERFACE-BLOCK)
 20598*         LENGTH  (WS-COMM-LENGTH)
 20599*         ITEM    (W-ONE)
 20600*     END-EXEC.
 20601*    MOVE '*$II   L              ''   #00017268' TO DFHEIV0
 20602     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 20603     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20604     MOVE X'2020233030303137323638' TO DFHEIV0(25:11)
 20605     CALL 'kxdfhei1' USING DFHEIV0,
 20606           QID,
 20607           PROGRAM-INTERFACE-BLOCK,
 20608           WS-COMM-LENGTH,
 20609           W-ONE,
 20610           DFHEIV99,
 20611           DFHEIV99
 20612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20613
 20614
 20615 6050-DELETE-TEMP-STORAGE.
 20616
 20617
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 382
* EL6311.cbl
 20618* EXEC CICS DELETEQ TS
 20619*        QUEUE   (QID)
 20620*    END-EXEC.
 20621*    MOVE '*&                    #   #00017277' TO DFHEIV0
 20622     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 20623     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20624     MOVE X'2020233030303137323737' TO DFHEIV0(25:11)
 20625     CALL 'kxdfhei1' USING DFHEIV0,
 20626           QID,
 20627           DFHEIV99
 20628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20629
 20630
 20631     GO TO 6050-EXIT.
 20632
 20633 6050-QID-ERROR.
 20634     MOVE ER-0033                TO EMI-ERROR
 20635     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20636
 20637 6050-EXIT.
 20638      EXIT.
 20639
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 383
* EL6311.cbl
 20641
 20642******************************************************************
 20643*                                                                *
 20644*            T E R M   C O N V E R S I O N                       *
 20645*                                                                *
 20646******************************************************************
 20647
 20648 6100-TERM-CONVERSION.
 20649
 20650     IF PI-BPMTS = ZERO
 20651         GO TO 6199-EXIT.
 20652
 20653     IF PI-BMODE = ' ' OR 'M'
 20654         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 20655         GO TO 6105-ROUND-TERM.
 20656
 20657     IF PI-BMODE = 'S'
 20658         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 20659         GO TO 6105-ROUND-TERM.
 20660
 20661     IF PI-BMODE = 'W'
 20662         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 20663         GO TO 6105-ROUND-TERM.
 20664
 20665     IF PI-BMODE = 'B'
 20666         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 20667         GO TO 6105-ROUND-TERM.
 20668
 20669     IF PI-BMODE = 'T'
 20670         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 20671
 20672 6105-ROUND-TERM.
 20673
 20674     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 20675         ADD +1                  TO WS-CALC-TERM-WHOLE
 20676         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 20677
 20678     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 20679         GO TO 6125-COMPUTE-TERM-BENEFIT.
 20680
 20681     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 20682         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 20683                                      WS-BTERM    (WS-SUB1)
 20684         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 20685
 20686     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 20687         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 20688             MOVE -1               TO BMODEL
 20689             MOVE ER-2593          TO EMI-ERROR
 20690             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 20691             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20692
 20693 6124-CHECK-BENEFIT.
 20694
 20695     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 20696        GO TO 6126-COMPUTE-BENEFIT.
 20697
 20698     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 384
* EL6311.cbl
 20699
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 385
* EL6311.cbl
 20701******************************************************************
 20702**         COMPUTE TERM AND BENEFIT
 20703******************************************************************
 20704 6125-COMPUTE-TERM-BENEFIT.
 20705
 20706     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 20707        PI-BPMTAMT = ZERO
 20708         GO TO 6199-EXIT.
 20709
 20710     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 20711                                     WS-BTERM  (WS-SUB1).
 20712     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 20713
 20714 6126-COMPUTE-BENEFIT.
 20715
 20716     IF PI-BMODE = 'M' OR  ' '
 20717         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 20718
 20719     IF PI-BMODE = 'W'
 20720         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 20721
 20722     IF PI-BMODE = 'S'
 20723         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 20724
 20725     IF PI-BMODE = 'B'
 20726         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 20727
 20728     IF PI-BMODE = 'T'
 20729         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 20730
 20731     IF WS-SUB1 = +1
 20732        COMPUTE WS-BBEN (WS-SUB1) =
 20733                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 20734
 20735     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 20736     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 20737     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 20738
 20739 6199-EXIT.
 20740     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 386
* EL6311.cbl
 20742
 20743******************************************************************
 20744*                                                                *
 20745*             D I S P L A Y   I S S U E S                        *
 20746*                                                                *
 20747******************************************************************
 20748
 20749 6200-CREATE-VADS.
 20750     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 20751     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 20752     MOVE SPACES                 TO WS-PASS-VADS-REC
 20753
 20754* EXEC CICS GETMAIN
 20755*       SET      (ADDRESS OF PENDING-BUSINESS)
 20756*       LENGTH   (ERPNDB-RECORD-LENGTH)
 20757*       INITIMG  (GETMAIN-SPACE)
 20758*       RESP     (WS-RESPONSE)
 20759*    END-EXEC
 20760*    MOVE ',"IL                  $  N#00017403' TO DFHEIV0
 20761     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20762     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20763     MOVE X'204E233030303137343033' TO DFHEIV0(25:11)
 20764     CALL 'kxdfhei1' USING DFHEIV0,
 20765           DFHEIV20,
 20766           ERPNDB-RECORD-LENGTH,
 20767           GETMAIN-SPACE
 20768     SET ADDRESS OF PENDING-BUSINESS TO
 20769         DFHEIV20
 20770     MOVE EIBRESP  TO WS-RESPONSE
 20771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20772
 20773* EXEC CICS READ
 20774*       INTO    (PENDING-BUSINESS)
 20775*       DATASET (FILE-ID-ERPNDB)
 20776*       RIDFLD  (ERPNDB-KEY)
 20777*       RESP    (WS-RESPONSE)
 20778*    END-EXEC
 20779     MOVE LENGTH OF
 20780      PENDING-BUSINESS
 20781       TO DFHEIV11
 20782*    MOVE '&"IL       E          (  N#00017409' TO DFHEIV0
 20783     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20785     MOVE X'204E233030303137343039' TO DFHEIV0(25:11)
 20786     CALL 'kxdfhei1' USING DFHEIV0,
 20787           FILE-ID-ERPNDB,
 20788           PENDING-BUSINESS,
 20789           DFHEIV11,
 20790           ERPNDB-KEY,
 20791           DFHEIV99,
 20792           DFHEIV99,
 20793           DFHEIV99
 20794     MOVE EIBRESP  TO WS-RESPONSE
 20795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20796     IF RESP-NORMAL
 20797        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 20798        IF (RESP-NORMAL)
 20799           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 387
* EL6311.cbl
 20800              AM-CONTROL-PRIMARY (1:20))
 20801           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 20802        ELSE
 20803           MOVE 'ACCOUNT NOT FOUND'
 20804                                 TO VD-ACCOUNT-NAME
 20805        END-IF
 20806        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 20807                                    TO M1
 20808        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 20809        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 20810           (A2 > M1)
 20811           OR (WS-WORK-FIELD (A2:1) = '*')
 20812           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 20813           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 20814        END-PERFORM
 20815        IF A2 > M1
 20816           CONTINUE
 20817        ELSE
 20818           MOVE WS-WORK-FIELD (1:A2 - 1)
 20819                                    TO VD-ACCOUNT-NAME
 20820        END-IF
 20821        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 20822        MOVE PB-CARRIER          TO VD-CARRIER
 20823        MOVE PB-GROUPING         TO VD-GROUPING
 20824        MOVE PB-STATE            TO VD-STATE
 20825        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 20826        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 20827        MOVE PB-CERT-NO          TO VD-CERT-NO
 20828        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 20829        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 20830        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 20831        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 20832        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 20833        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 20834        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 20835        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 20836        MOVE PB-CSR-ID           TO VD-CSR-ID
 20837        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 20838        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 20839        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 20840        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 20841        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 20842        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 20843        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 20844        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 20845        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 20846        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 20847        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 20848        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 20849        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 20850     END-IF
 20851     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 20852
 20853
 20854* EXEC CICS GETMAIN
 20855*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 20856*       LENGTH   (ERPNDM-RECORD-LENGTH)
 20857*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 388
* EL6311.cbl
 20858*       RESP     (WS-RESPONSE)
 20859*    END-EXEC
 20860*    MOVE ',"IL                  $  N#00017472' TO DFHEIV0
 20861     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20862     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20863     MOVE X'204E233030303137343732' TO DFHEIV0(25:11)
 20864     CALL 'kxdfhei1' USING DFHEIV0,
 20865           DFHEIV20,
 20866           ERPNDM-RECORD-LENGTH,
 20867           GETMAIN-SPACE
 20868     SET ADDRESS OF PENDING-MAILING-DATA TO
 20869         DFHEIV20
 20870     MOVE EIBRESP  TO WS-RESPONSE
 20871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20872
 20873
 20874* EXEC CICS READ
 20875*       INTO    (PENDING-MAILING-DATA)
 20876*       DATASET (FILE-ID-ERPNDM)
 20877*       RIDFLD  (ERPNDM-KEY)
 20878*       RESP    (WS-RESPONSE)
 20879*    END-EXEC
 20880     MOVE LENGTH OF
 20881      PENDING-MAILING-DATA
 20882       TO DFHEIV11
 20883*    MOVE '&"IL       E          (  N#00017479' TO DFHEIV0
 20884     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20886     MOVE X'204E233030303137343739' TO DFHEIV0(25:11)
 20887     CALL 'kxdfhei1' USING DFHEIV0,
 20888           FILE-ID-ERPNDM,
 20889           PENDING-MAILING-DATA,
 20890           DFHEIV11,
 20891           ERPNDM-KEY,
 20892           DFHEIV99,
 20893           DFHEIV99,
 20894           DFHEIV99
 20895     MOVE EIBRESP  TO WS-RESPONSE
 20896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20897
 20898     IF RESP-NORMAL
 20899        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 20900        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 20901        MOVE PM-CITY              TO VD-INSURED-CITY
 20902        MOVE PM-STATE             TO VD-INSURED-STATE
 20903        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 20904     END-IF
 20905
 20906     MOVE 'VAC1'                  TO VD-LETTER-ID
 20907     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 20908     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 20909     MOVE EIBTIME                 TO VD-CURRENT-TIME
 20910     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 20911     MOVE +0                      TO VD-ARCHIVE-NO
 20912     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 20913     .
 20914 6200-EXIT.
 20915     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 389
* EL6311.cbl
 20916 6210-READ-ERACCT.
 20917     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 20918     MOVE LOW-VALUES             TO ERACCT-FILL
 20919
 20920* EXEC CICS READ
 20921*         DATASET   ('ERACCT')
 20922*         INTO      (ACCOUNT-MASTER)
 20923*         RIDFLD    (ERACCT-KEY)
 20924*         GTEQ
 20925*         RESP      (WS-RESPONSE)
 20926*    END-EXEC
 20927     MOVE LENGTH OF
 20928      ACCOUNT-MASTER
 20929       TO DFHEIV11
 20930     MOVE 'ERACCT' TO DFHEIV1
 20931*    MOVE '&"IL       G          (  N#00017507' TO DFHEIV0
 20932     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20934     MOVE X'204E233030303137353037' TO DFHEIV0(25:11)
 20935     CALL 'kxdfhei1' USING DFHEIV0,
 20936           DFHEIV1,
 20937           ACCOUNT-MASTER,
 20938           DFHEIV11,
 20939           ERACCT-KEY,
 20940           DFHEIV99,
 20941           DFHEIV99,
 20942           DFHEIV99
 20943     MOVE EIBRESP  TO WS-RESPONSE
 20944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20945     .
 20946 6210-EXIT.
 20947     EXIT.
 20948
 20949 6220-READ-ERMAIL.
 20950
 20951     MOVE ELCERT-KEY             TO ERMAIL-KEY
 20952     MOVE ' '                    TO WS-ERMAIL-SW
 20953
 20954
 20955* EXEC CICS READ
 20956*       DATASET   (FILE-ID-ERMAIL)
 20957*       SET       (ADDRESS OF MAILING-DATA)
 20958*       RIDFLD    (ERMAIL-KEY)
 20959*       RESP      (WS-RESPONSE)
 20960*    END-EXEC
 20961*    MOVE '&"S        E          (  N#00017523' TO DFHEIV0
 20962     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20964     MOVE X'204E233030303137353233' TO DFHEIV0(25:11)
 20965     CALL 'kxdfhei1' USING DFHEIV0,
 20966           FILE-ID-ERMAIL,
 20967           DFHEIV20,
 20968           DFHEIV99,
 20969           ERMAIL-KEY,
 20970           DFHEIV99,
 20971           DFHEIV99,
 20972           DFHEIV99
 20973     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 390
* EL6311.cbl
 20974         DFHEIV20
 20975     MOVE EIBRESP  TO WS-RESPONSE
 20976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20977
 20978     IF RESP-NORMAL
 20979        SET ERMAIL-FOUND TO TRUE
 20980     END-IF
 20981     .
 20982 6220-EXIT.
 20983     EXIT.
 20984
 20985 6400-CHECK-FOR-RES-REF-CLAIM.
 20986     display 'made it to 6400- for ' pi-cert-no
 20987     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 20988
 20989     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 20990                                    W-CL-COMP-CD.
 20991     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 20992                                    W-CL-CERT-NO.
 20993     MOVE SPACES                 TO MSTR-CERT-SFX.
 20994
 20995
 20996* EXEC CICS HANDLE CONDITION
 20997*        NOTFND  (6400-CONTINUE)
 20998*        ENDFILE (6400-CONTINUE)
 20999*    END-EXEC.
 21000*    MOVE '"$I''                  ! V #00017547' TO DFHEIV0
 21001     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21002     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21003     MOVE X'5620233030303137353437' TO DFHEIV0(25:11)
 21004     CALL 'kxdfhei1' USING DFHEIV0
 21005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21006
 21007
 21008
 21009* EXEC CICS IGNORE CONDITION
 21010*        DUPKEY
 21011*    END-EXEC.
 21012*    MOVE '"*$                   !   #00017552' TO DFHEIV0
 21013     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21015     MOVE X'2020233030303137353532' TO DFHEIV0(25:11)
 21016     CALL 'kxdfhei1' USING DFHEIV0
 21017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21018
 21019
 21020
 21021* EXEC CICS STARTBR
 21022*        DATASET   (CLMS-ID)
 21023*        RIDFLD    (ELMSTR-KEY)
 21024*        GENERIC   EQUAL
 21025*        KEYLENGTH (ELMSTR-LENGTH)
 21026*    END-EXEC.
 21027     MOVE 0
 21028       TO DFHEIV11
 21029*    MOVE '&,   KG    E          &   #00017556' TO DFHEIV0
 21030     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21031     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 391
* EL6311.cbl
 21032     MOVE X'2020233030303137353536' TO DFHEIV0(25:11)
 21033     CALL 'kxdfhei1' USING DFHEIV0,
 21034           CLMS-ID,
 21035           ELMSTR-KEY,
 21036           ELMSTR-LENGTH,
 21037           DFHEIV11,
 21038           DFHEIV99
 21039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21040
 21041
 21042     display 'browse started'
 21043     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21044
 21045 6400-NEXT-CLAIM.
 21046
 21047
 21048* EXEC CICS READNEXT
 21049*        DATASET   (CLMS-ID)
 21050*        RIDFLD    (ELMSTR-KEY)
 21051*        SET       (ADDRESS OF CLAIM-MASTER)
 21052*    END-EXEC.
 21053     MOVE 0
 21054       TO DFHEIV11
 21055*    MOVE '&.S                   )   #00017568' TO DFHEIV0
 21056     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21057     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21058     MOVE X'2020233030303137353638' TO DFHEIV0(25:11)
 21059     CALL 'kxdfhei1' USING DFHEIV0,
 21060           CLMS-ID,
 21061           DFHEIV20,
 21062           DFHEIV99,
 21063           ELMSTR-KEY,
 21064           DFHEIV99,
 21065           DFHEIV11,
 21066           DFHEIV99,
 21067           DFHEIV99
 21068     SET ADDRESS OF CLAIM-MASTER TO
 21069         DFHEIV20
 21070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21071
 21072
 21073     display 'read claim for ' mstr-cert-no
 21074     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21075        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21076         GO TO 6400-CONTINUE
 21077     END-IF.
 21078
 21079     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21080        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21081        PI-STATE       NOT = CL-CERT-STATE     OR
 21082        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21083        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21084         GO TO 6400-NEXT-CLAIM
 21085     END-IF.
 21086
 21087     display 'found claim ' cl-claim-no
 21088        ' with denial type ' cl-denial-type
 21089     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 392
* EL6311.cbl
 21090         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21091         GO TO 6400-CONTINUE
 21092     END-IF.
 21093
 21094     GO TO 6400-NEXT-CLAIM.
 21095
 21096 6400-CONTINUE.
 21097
 21098     IF WS-BROWSE-STARTED-SW = 'Y'
 21099
 21100* EXEC CICS ENDBR
 21101*            DATASET   (CLMS-ID)
 21102*        END-EXEC
 21103     MOVE 0
 21104       TO DFHEIV11
 21105*    MOVE '&2                    $   #00017600' TO DFHEIV0
 21106     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21107     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21108     MOVE X'2020233030303137363030' TO DFHEIV0(25:11)
 21109     CALL 'kxdfhei1' USING DFHEIV0,
 21110           CLMS-ID,
 21111           DFHEIV11,
 21112           DFHEIV99
 21113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21114         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21115     END-IF.
 21116
 21117 6400-EXIT.
 21118     EXIT.
 21119
 21120 7000-DISPLAY-ISSUES.
 21121
 21122     IF PI-DISPLAY-ORIGINAL-BATCH
 21123        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21124        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21125     ELSE
 21126        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21127
 21128     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21129
 21130     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21131     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21132
 21133     MOVE LOW-VALUES                 TO EL631BI.
 21134     MOVE ZEROS                      TO PI-BPMTAMT
 21135                                        PI-BPMTS.
 21136     MOVE SPACE                      TO PI-BMODE
 21137                                        PI-BTYPE (1)
 21138                                        PI-BTYPE (2).
 21139     MOVE EL631B                     TO PI-MAP-NAME.
 21140     MOVE 'Y'                        TO PI-BROWSE-SW.
 21141     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 21142                                        PI-HIGH-SEQ-NO.
 21143
 21144     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21145        MOVE AL-SABOF                TO BCHGTA
 21146        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 21147        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 393
* EL6311.cbl
 21148     ELSE
 21149        MOVE AL-SADOF                TO BCHGTA
 21150                                        BCHGA
 21151        MOVE PB-CHG-COUNT            TO BCHGO.
 21152
 21153     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 21154     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21155     MOVE WS-HR-MINS                 TO BMANTATO.
 21156
 21157     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21158        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21159        MOVE SPACE                   TO DC-OPTION-CODE
 21160        PERFORM 9700-DATE-LINK
 21161        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21162        MOVE 'INACTIVE'              TO BMOENDTO
 21163     ELSE
 21164        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21165        MOVE SPACE                   TO DC-OPTION-CODE
 21166        PERFORM 9700-DATE-LINK
 21167        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21168        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21169        MOVE SPACE                   TO DC-OPTION-CODE
 21170        PERFORM 9700-DATE-LINK
 21171        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 21172
 21173*    MOVE PB-I-REFERENCE             TO BREFO.
 21174
 21175*    IF PI-COMPANY-ID EQUAL 'HER'
 21176*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 21177*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 21178*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 21179*                MOVE WS-MEMBER-NO-1-8
 21180*                                TO  BMICRNOO.
 21181
 21182*    IF PB-I-MICROFILM-NO  IS NUMERIC
 21183*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 21184*            MOVE PB-I-MICROFILM-NO
 21185*                                TO  BMICRNOO.
 21186     IF PB-I-VIN NOT = SPACES
 21187        MOVE PB-I-VIN            TO BVINO
 21188     END-IF
 21189
 21190     MOVE PB-CERT-PRIME              TO BCERTNOO.
 21191     MOVE PB-CERT-SFX                TO BSUFIXO.
 21192     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21193     MOVE SPACE                      TO DC-OPTION-CODE.
 21194     PERFORM 9700-DATE-LINK.
 21195     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 21196
 21197     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 21198     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 21199     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 21200     MOVE PB-I-INSURED-SEX           TO BSEXO
 21201
 21202     IF PB-I-AGE NOT = ZEROS
 21203         MOVE PB-I-AGE               TO BAGEO.
 21204
 21205     IF PB-I-BIRTHDAY NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 394
* EL6311.cbl
 21206         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 21207         MOVE SPACE                  TO DC-OPTION-CODE
 21208         PERFORM 9700-DATE-LINK
 21209         IF NO-CONVERSION-ERROR
 21210            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 21211
 21212     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 21213         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 21214         MOVE SPACE                  TO DC-OPTION-CODE
 21215         PERFORM 9700-DATE-LINK
 21216         IF NO-CONVERSION-ERROR
 21217            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 21218
 21219     IF PB-I-EXTENTION-DAYS NUMERIC
 21220        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 21221           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 21222        ELSE
 21223           IF PB-I-TERM-IN-DAYS NUMERIC
 21224              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 21225                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 21226
 21227     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 21228        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 21229
 21230     MOVE PB-FORCE-CODE              TO BFORCEO.
 21231     MOVE PB-I-TERM-TYPE             TO BMODEO
 21232                                        PI-BMODE.
 21233
 21234     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 21235        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 21236
 21237     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 21238         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 21239                                        PI-BPMTS.
 21240
 21241     IF PB-I-PAYMENT-AMOUNT NUMERIC
 21242         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 21243           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 21244                                        PI-BPMTAMT.
 21245
 21246     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 21247     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 21248     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 21249     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 21250     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 21251     MOVE PB-I-SIG-SW                TO BSIGO.
 21252     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 21253     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 21254     MOVE PB-RECORD-BILL             TO BBILCDO.
 21255     MOVE PB-FORCE-CODE              TO BFORCEO.
 21256
 21257     IF (PB-I-LIVES NUMERIC)
 21258        AND (PB-I-LIVES > ZEROS)
 21259        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21260        IF (RESP-NORMAL)
 21261           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 21262           CONTINUE
 21263        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 395
* EL6311.cbl
 21264           MOVE PB-I-LIVES       TO BLIVESO
 21265        END-IF
 21266     END-IF
 21267
 21268     IF PB-I-NUM-BILLED NUMERIC AND
 21269        PB-I-NUM-BILLED GREATER THAN ZEROS
 21270        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 21271*    ELSE
 21272*       MOVE ZEROS                   TO BBILLEDO.
 21273
 21274     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 21275
 21276     IF PB-I-LOAN-APR NOT = ZEROS
 21277        MOVE PB-I-LOAN-APR           TO BAPRO.
 21278
 21279     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 21280        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 21281
 21282     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 21283        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 21284           MOVE AL-SANOF                TO BORIGHDA
 21285           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 21286           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 21287
 21288     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 21289
 21290     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 21291        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 21292
 21293     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 21294        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 21295                                        PI-BTYPE (1).
 21296
 21297     IF PB-I-LF-TERM     GREATER THAN ZEROS
 21298        MOVE PB-I-LF-TERM            TO BTERMO (1).
 21299
 21300     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 21301        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 21302
 21303     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 21304        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 21305
 21306     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 21307        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 21308
 21309     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21310        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 21311
 21312     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 21313         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 21314         MOVE SPACE                  TO DC-OPTION-CODE
 21315         PERFORM 9700-DATE-LINK
 21316         IF NO-CONVERSION-ERROR
 21317            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 21318
 21319     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21320        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 21321        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 396
* EL6311.cbl
 21322        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 21323        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 21324                 GIVING BDIFFO (1)
 21325     ELSE
 21326        MOVE SPACES                  TO BBEN-CD     (1)
 21327                                        BBEN-ABBR   (1).
 21328
 21329     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21330        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 21331        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 21332                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 21333
 21334     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21335       IF PB-RECORD-ON-HOLD
 21336          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 21337
 21338     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21339       IF PB-RECORD-RETURNED
 21340          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 21341
 21342     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21343        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21344             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 21345
 21346     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 21347
 21348     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 21349        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 21350
 21351     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 21352        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 21353                                        PI-BTYPE (2).
 21354
 21355     IF PB-I-AH-TERM     GREATER THAN ZEROS
 21356        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 21357
 21358     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 21359        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 21360
 21361     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 21362        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 21363
 21364     IF PB-I-TOT-FEES NOT NUMERIC
 21365        MOVE ZEROS               TO PB-I-TOT-FEES
 21366     END-IF
 21367     IF PB-I-TOT-FEES > ZEROS
 21368        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 21369
 21370     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 21371         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 21372         MOVE SPACE                  TO DC-OPTION-CODE
 21373         PERFORM 9700-DATE-LINK
 21374         IF NO-CONVERSION-ERROR
 21375            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 21376
 21377     IF PB-I-TOT-FEES > ZEROS
 21378        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 21379        SUBTRACT PB-I-TOT-FEES FROM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 397
* EL6311.cbl
 21380                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 21381
 21382     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21383        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 21384        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 21385        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 21386        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 21387                 GIVING BDIFFO (2)
 21388     ELSE
 21389        MOVE SPACES                  TO BBEN-CD     (2)
 21390                                        BBEN-ABBR   (2).
 21391
 21392     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21393       IF PB-RECORD-ON-HOLD
 21394          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 21395
 21396     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21397       IF PB-RECORD-RETURNED
 21398          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 21399
 21400     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21401        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21402             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 21403
 21404     MOVE PB-CSR-ID                  TO BCSRO.
 21405
 21406     IF PI-COMPANY-ID  =  'DMD'
 21407        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 21408            NEXT SENTENCE
 21409        ELSE
 21410            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 21411               MOVE 'NEW CERT'       TO BNCERTLI
 21412               MOVE EC-NEW-CERT      TO BNCERTO.
 21413
 21414     IF PI-COMPANY-ID  =  'DMD'
 21415        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 21416            NEXT SENTENCE
 21417        ELSE
 21418           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 21419               MOVE 'NEW STATE'      TO BNSTATLI
 21420               MOVE EC-NEW-STATE     TO BNSTATO.
 21421
 21422 7000-CONTINUE.
 21423     MOVE 'C'                        TO BMAINTI.
 21424     MOVE AL-UANON                   TO BMAINTA.
 21425
 21426     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 21427        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 21428
 21429     IF PI-6315-FINALIZED = 'Y'   AND
 21430        PB-UNFORCED-ERRORS
 21431          MOVE -1                TO BFORCEL
 21432          MOVE  1                TO SET-CURSOR-SW
 21433     END-IF
 21434
 21435     IF NO-CURSOR-SET
 21436        MOVE -1                      TO BMAINTL.
 21437
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 398
* EL6311.cbl
 21438     GO TO 8100-SEND-INITIAL-MAP.
 21439
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 399
* EL6311.cbl
 21441
 21442******************************************************************
 21443*                                                                *
 21444*             D I S P L A Y   C A N C E L S                      *
 21445*                                                                *
 21446******************************************************************
 21447
 21448 7100-DISPLAY-CANCELS.
 21449     IF PI-DISPLAY-ORIGINAL-BATCH
 21450        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21451        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21452     ELSE
 21453        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21454
 21455     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21456
 21457     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21458     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21459
 21460     MOVE LOW-VALUES                 TO EL631CI.
 21461     MOVE EL631C                     TO PI-MAP-NAME.
 21462     MOVE 'Y'                        TO PI-BROWSE-SW.
 21463     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 21464                                        PI-HIGH-SEQ-NO.
 21465
 21466     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21467        MOVE AL-SABOF                TO CCHGTA
 21468        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 21469        MOVE AL-SANON                TO CCHGA
 21470      ELSE
 21471        MOVE AL-SADOF                TO CCHGTA
 21472                                        CCHGA
 21473        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 21474
 21475*    MOVE PB-C-REFERENCE             TO CREFO.
 21476
 21477*    IF PB-C-MICROFILM-NO IS NUMERIC
 21478*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 21479*          MOVE PB-C-MICROFILM-NO
 21480*                                TO CMICRNOO
 21481*          MOVE AL-UNNON         TO CMICRNOA
 21482*       END-IF
 21483*    END-IF
 21484     IF PB-C-NH-INT-ON-REFS NUMERIC
 21485        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 21486           MOVE PB-C-NH-INT-ON-REFS
 21487                                 TO CNHINTO
 21488           MOVE AL-SANOF         TO CNHINTA
 21489        END-IF
 21490     END-IF
 21491     MOVE PB-CERT-PRIME              TO CCERTNOO.
 21492     MOVE PB-CERT-SFX                TO CSUFIXO.
 21493     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21494     MOVE SPACE                      TO DC-OPTION-CODE.
 21495     PERFORM 9700-DATE-LINK.
 21496     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 21497
 21498     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 400
* EL6311.cbl
 21499        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 21500        MOVE SPACE                   TO DC-OPTION-CODE
 21501        PERFORM 9700-DATE-LINK
 21502        IF NO-CONVERSION-ERROR
 21503           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 21504
 21505     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 21506        NEXT SENTENCE
 21507     ELSE
 21508        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 21509
 21510     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 21511        NEXT SENTENCE
 21512     ELSE
 21513        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 21514
 21515     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 21516        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 21517        MOVE SPACE                   TO DC-OPTION-CODE
 21518        PERFORM 9700-DATE-LINK
 21519        IF NO-CONVERSION-ERROR
 21520           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 21521
 21522     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21523         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 21524
 21525     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21526         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 21527
 21528     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 21529        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 21530        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 21531                 GIVING CDRFND1O.
 21532
 21533     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 21534        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 21535        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 21536                 GIVING CDRFND2O.
 21537
 21538     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21539       IF PB-RECORD-ON-HOLD
 21540          MOVE 'ON HOLD'             TO CBILIT1O.
 21541
 21542     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21543       IF PB-RECORD-RETURNED
 21544          MOVE 'RETURNED'            TO CBILIT1O.
 21545
 21546     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21547        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21548             MOVE 'OVERRIDE'         TO CBILIT1O.
 21549
 21550     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21551       IF PB-RECORD-ON-HOLD
 21552          MOVE 'ON HOLD'             TO CBILIT2O.
 21553
 21554     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21555       IF PB-RECORD-RETURNED
 21556          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 401
* EL6311.cbl
 21557
 21558     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21559        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21560             MOVE 'OVERRIDE'         TO CBILIT2O.
 21561
 21562     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 21563     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 21564     IF PB-C-POST-CARD-IND = 'Y'
 21565        MOVE 'Y'                     TO CPCYNO
 21566     ELSE
 21567        MOVE 'N'                     TO CPCYNO
 21568     END-IF
 21569     MOVE PB-FORCE-CODE              TO CFORCEO.
 21570     MOVE PB-RECORD-BILL             TO CBILCDO.
 21571     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 21572     MOVE SPACES                     TO CINITSO.
 21573     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 21574         MOVE PB-CI-FIRST-NAME       TO CINITSO
 21575     ELSE
 21576         MOVE PB-CI-INITIALS         TO CINITSO
 21577     END-IF.
 21578
 21579     IF PB-CI-CANCEL-FEE NUMERIC
 21580        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 21581        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 21582     ELSE
 21583        MOVE ZEROES                  TO W-CANCEL-FEE.
 21584
 21585     MOVE W-CANCEL-FEE               TO CCANFEEO.
 21586
 21587     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 21588        ADD PB-CI-LF-PREMIUM-AMT
 21589             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 21590
 21591     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 21592        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 21593
 21594     MOVE PB-CI-LF-TERM              TO CTERM1O.
 21595     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 21596     MOVE PB-CI-AH-TERM              TO CTERM2O.
 21597     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 21598
 21599     IF PB-C-LIVES NUMERIC
 21600        MOVE PB-C-LIVES              TO CLIVESO.
 21601
 21602     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 21603        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 21604
 21605     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 21606        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 21607        MOVE SPACE                   TO DC-OPTION-CODE
 21608        PERFORM 9700-DATE-LINK
 21609        IF NO-CONVERSION-ERROR
 21610           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 21611
 21612     IF  PB-C-REFUND-CREATED
 21613         MOVE 'YES'                  TO CRFNDSWO
 21614     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 402
* EL6311.cbl
 21615         IF PB-C-REFUND-REQUESTED
 21616            MOVE 'REQ'               TO CRFNDSWO
 21617         ELSE
 21618            MOVE 'NO'                TO CRFNDSWO.
 21619
 21620     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 21621     MOVE SPACE                      TO DC-OPTION-CODE.
 21622     PERFORM 9700-DATE-LINK.
 21623     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 21624     MOVE PB-INPUT-BY                TO CENTBYO.
 21625
 21626     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21627        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21628        MOVE SPACE                   TO DC-OPTION-CODE
 21629        PERFORM 9700-DATE-LINK
 21630        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 21631        MOVE 'INACTIVE'              TO CMOENDTO
 21632     ELSE
 21633        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21634        MOVE SPACE                   TO DC-OPTION-CODE
 21635        PERFORM 9700-DATE-LINK
 21636        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 21637        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21638        MOVE SPACE                   TO DC-OPTION-CODE
 21639        PERFORM 9700-DATE-LINK
 21640        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 21641
 21642     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 21643
 21644     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21645     MOVE WS-HR-MINS                 TO CMANTATO.
 21646
 21647     EVALUATE PB-LF-REFUND-TYPE
 21648        WHEN '1'
 21649           MOVE 'RULE78'            TO CLFREFNO
 21650        WHEN '2'
 21651           MOVE 'PRORAT'            TO CLFREFNO
 21652        WHEN '3'
 21653           MOVE 'CALIF'             TO CLFREFNO
 21654        WHEN '4'
 21655           MOVE 'IRREG'             TO CLFREFNO
 21656        WHEN '5'
 21657           MOVE 'NETPAY'            TO CLFREFNO
 21658        WHEN '6'
 21659           MOVE 'ATCP'              TO CLFREFNO
 21660        WHEN '7'
 21661           MOVE 'UTAH'              TO CLFREFNO
 21662        WHEN '8'
 21663           MOVE 'MEAN'              TO CLFREFNO
 21664        WHEN '9'
 21665           MOVE 'SUM '              TO CLFREFNO
 21666        WHEN 'B'
 21667           MOVE 'BALN'              TO CLFREFNO
 21668     END-EVALUATE.
 21669
 21670     EVALUATE TRUE
 21671        WHEN PB-AH-REFUND-TYPE =  '1'
 21672           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 403
* EL6311.cbl
 21673        WHEN PB-AH-REFUND-TYPE =  '2'
 21674           MOVE 'PRORAT'            TO CAHREFNO
 21675        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 21676           MOVE 'CALIF'             TO CAHREFNO
 21677        WHEN PB-AH-REFUND-TYPE =  '4'
 21678           MOVE 'IRREG'             TO CAHREFNO
 21679        WHEN PB-AH-REFUND-TYPE =  '5'
 21680           MOVE 'NETPAY'            TO CAHREFNO
 21681        WHEN PB-AH-REFUND-TYPE =  '6'
 21682           MOVE 'ATCP'              TO CAHREFNO
 21683        WHEN PB-AH-REFUND-TYPE =  '7'
 21684           MOVE 'UTAH'              TO CAHREFNO
 21685        WHEN PB-AH-REFUND-TYPE =  '8'
 21686           MOVE 'MEAN'              TO CAHREFNO
 21687        WHEN PB-AH-REFUND-TYPE =  '9'
 21688           MOVE 'SUM '              TO CAHREFNO
 21689        WHEN PB-AH-REFUND-TYPE =  'B'
 21690           MOVE 'BALN'              TO CAHREFNO
 21691     END-EVALUATE.
 21692
 21693     MOVE PB-REIN-CD                 TO CREINCDO.
 21694
 21695     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 21696        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 21697        MOVE SPACE                   TO DC-OPTION-CODE
 21698        PERFORM 9700-DATE-LINK
 21699        IF NO-CONVERSION-ERROR
 21700           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 21701
 21702     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 21703        MOVE 999999                  TO WS-EXP-DT-EDIT
 21704        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 21705        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 21706     ELSE
 21707        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 21708           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 21709           MOVE SPACE                   TO DC-OPTION-CODE
 21710           PERFORM 9700-DATE-LINK
 21711           IF NO-CONVERSION-ERROR
 21712              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 21713
 21714     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 21715        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 21716           MOVE AL-SANOF                TO CORIGHDA
 21717           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 21718           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 21719
 21720     MOVE PB-CSR-ID              TO CCSRO.
 21721
 21722     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 21723     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 21724
 21725     MOVE 'C'                    TO CMAINTI.
 21726     MOVE AL-UANON               TO CMAINTA.
 21727
 21728     IF PI-6316-FINALIZED = 'Y'  AND
 21729        PB-UNFORCED-ERRORS
 21730          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 404
* EL6311.cbl
 21731          MOVE  1                TO SET-CURSOR-SW
 21732     END-IF
 21733
 21734     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 21735        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 21736
 21737     IF NO-CURSOR-SET
 21738        MOVE -1                  TO CMAINTL.
 21739
 21740     GO TO 8100-SEND-INITIAL-MAP.
 21741
 21742
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 405
* EL6311.cbl
 21744***************************************************************
 21745*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 21746*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 21747***************************************************************
 21748
 21749 7200-DISPLAY-BATCHES.
 21750     MOVE EL631D                 TO PI-MAP-NAME.
 21751     MOVE LOW-VALUES             TO EL631DI.
 21752
 21753     MOVE 'Y'                    TO WS-DISPLAY-SW.
 21754
 21755
 21756* EXEC CICS HANDLE CONDITION
 21757*         NOTFND   (3690-NOT-FOUND)
 21758*    END-EXEC.
 21759*    MOVE '"$I                   ! W #00018244' TO DFHEIV0
 21760     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21761     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21762     MOVE X'5720233030303138323434' TO DFHEIV0(25:11)
 21763     CALL 'kxdfhei1' USING DFHEIV0
 21764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21765
 21766
 21767     IF PI-DISPLAY-SCREEN
 21768        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21769     ELSE
 21770        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 21771
 21772     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 21773     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 21774
 21775
 21776* EXEC CICS READ
 21777*         DATASET   (FILE-ID-ERPNDB)
 21778*         RIDFLD    (ERPNDB-KEY)
 21779*         SET       (ADDRESS OF PENDING-BUSINESS)
 21780*    END-EXEC.
 21781*    MOVE '&"S        E          (   #00018256' TO DFHEIV0
 21782     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21784     MOVE X'2020233030303138323536' TO DFHEIV0(25:11)
 21785     CALL 'kxdfhei1' USING DFHEIV0,
 21786           FILE-ID-ERPNDB,
 21787           DFHEIV20,
 21788           DFHEIV99,
 21789           ERPNDB-KEY,
 21790           DFHEIV99,
 21791           DFHEIV99,
 21792           DFHEIV99
 21793     SET ADDRESS OF PENDING-BUSINESS TO
 21794         DFHEIV20
 21795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21796
 21797
 21798     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 21799     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21800     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 21801     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 406
* EL6311.cbl
 21802     MOVE PB-SV-STATE            TO PI-SV-STATE.
 21803
 21804     MOVE EL631D                 TO PI-MAP-NAME.
 21805     MOVE LOW-VALUES             TO EL631DI.
 21806     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 21807
 21808*    IF PI-AR-PROCESSING
 21809*       MOVE PB-REFERENCE        TO DREFO.
 21810
 21811     MOVE PB-CSR-ID              TO DCSRO.
 21812
 21813     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21814        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 21815        MOVE SPACE               TO DC-OPTION-CODE
 21816        PERFORM 9700-DATE-LINK
 21817        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 21818        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 21819        MOVE 'INACTIVE'          TO DLDATEO
 21820     ELSE
 21821        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 21822        MOVE SPACE               TO DC-OPTION-CODE
 21823        PERFORM 9700-DATE-LINK
 21824        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 21825
 21826     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 21827     MOVE SPACE                  TO DC-OPTION-CODE.
 21828     PERFORM 9700-DATE-LINK.
 21829     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 21830
 21831     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 21832        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 21833     ELSE
 21834        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 21835        MOVE SPACE               TO DC-OPTION-CODE
 21836        PERFORM 9700-DATE-LINK
 21837        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 21838
 21839     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 21840     MOVE SPACE                  TO DC-OPTION-CODE.
 21841     PERFORM 9700-DATE-LINK.
 21842     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 21843
 21844     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 21845     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 21846
 21847     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 21848        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 21849                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 21850
 21851     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 21852     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 21853     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 21854
 21855     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 21856        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 21857                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 21858
 21859     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 407
* EL6311.cbl
 21860     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 21861     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 21862
 21863     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 21864        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 21865                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 21866
 21867     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 21868     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 21869
 21870     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 21871        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 21872                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 21873
 21874     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 21875     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 21876     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 21877
 21878     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 21879        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 21880                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 21881
 21882     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 21883     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 21884     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 21885
 21886     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 21887        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 21888                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 21889
 21890     MOVE -1                     TO DPFENTRL.
 21891     GO TO 8100-SEND-INITIAL-MAP.
 21892
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 408
* EL6311.cbl
 21894
 21895***************************************************************
 21896*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 21897*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 21898*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 21899*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 21900*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 21901*     ARE THEN SET ACCORDINGLY.                               *
 21902*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 21903*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 21904*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 21905***************************************************************
 21906
 21907******************************************************************
 21908*                                                                *
 21909*            E R R O R   A N A L Y S I S                         *
 21910*                                                                *
 21911******************************************************************
 21912
 21913******************************************************************
 21914*                                                                *
 21915*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 21916*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 21917*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 21918*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 21919*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 21920*                                                                *
 21921*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 21922*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 21923*                                                                *
 21924******************************************************************
 21925
 21926 7300-FORMAT-ERRORS.
 21927     MOVE ' '                    TO PI-ERRORS-SW
 21928     IF PB-COMMON-ERRORS = LOW-VALUES
 21929        IF PB-FATAL-ERRORS
 21930           MOVE ER-2695          TO EMI-ERROR
 21931           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21932           GO TO 7399-EXIT.
 21933
 21934     MOVE +0                     TO WS-SUB4.
 21935
 21936 7310-ERROR-LOOP.
 21937
 21938     ADD +1                      TO WS-SUB4.
 21939
 21940     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 21941        GO TO 7350-SET-ERROR-FLAGS.
 21942
 21943     IF PI-COMPANY-ID = 'UCL'
 21944         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 21945             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 21946             MOVE ' '                   TO DC-OPTION-CODE
 21947             PERFORM 9700-DATE-LINK
 21948             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 21949
 21950     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 21951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 409
* EL6311.cbl
 21952     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 21953
 21954     GO TO 7310-ERROR-LOOP.
 21955
 21956
 21957 7350-SET-ERROR-FLAGS.
 21958
 21959     IF EMI-FATAL-CTR NOT = ZEROS
 21960        display 'fatal error counter = ' emi-fatal-ctr
 21961        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 21962        MOVE 'X'                 TO PB-FATAL-FLAG
 21963                                    PI-ERRORS-SW
 21964        GO TO 7355-SET-ERROR-FLAGS.
 21965
 21966     IF EMI-FORCABLE-CTR NOT = ZEROS
 21967        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 21968        IF PB-ISSUE
 21969           IF PB-ISSUE-FORCE
 21970              MOVE 'F'           TO PB-FORCE-ER-CD
 21971              MOVE ER-2600       TO EMI-ERROR
 21972              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21973             ELSE
 21974              MOVE 'X'           TO PB-FORCE-ER-CD
 21975*                                   PI-ERRORS-SW
 21976          ELSE
 21977           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 21978              MOVE 'F'           TO PB-FORCE-ER-CD
 21979              MOVE ER-2600       TO EMI-ERROR
 21980              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21981             ELSE
 21982              MOVE 'X'           TO PB-FORCE-ER-CD.
 21983*                                   PI-ERRORS-SW.
 21984
 21985     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 21986     IF PB-ISSUE
 21987         MOVE 'I'                TO ENDT-RECORD-TYPE
 21988     ELSE
 21989         MOVE 'C'                TO ENDT-RECORD-TYPE
 21990     END-IF
 21991     MOVE +0                     TO ENDT-SEQ-NO
 21992
 21993
 21994* EXEC CICS READ
 21995*        DATASET   (FILE-ID-ERENDT)
 21996*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 21997*        RIDFLD    (ERENDT-KEY)
 21998*        RESP      (WS-RESPONSE)
 21999*        GTEQ
 22000*    END-EXEC
 22001*    MOVE '&"S        G          (  N#00018457' TO DFHEIV0
 22002     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22004     MOVE X'204E233030303138343537' TO DFHEIV0(25:11)
 22005     CALL 'kxdfhei1' USING DFHEIV0,
 22006           FILE-ID-ERENDT,
 22007           DFHEIV20,
 22008           DFHEIV99,
 22009           ERENDT-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 410
* EL6311.cbl
 22010           DFHEIV99,
 22011           DFHEIV99,
 22012           DFHEIV99
 22013     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22014         DFHEIV20
 22015     MOVE EIBRESP  TO WS-RESPONSE
 22016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22017
 22018     IF RESP-NORMAL
 22019        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22020        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22021            MOVE ER-0280          TO EMI-ERROR
 22022            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22023            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22024            EVALUATE TRUE
 22025              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22026                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22027              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22028                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22029              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22030                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22031            END-EVALUATE
 22032        END-IF
 22033     END-IF
 22034
 22035
 22036
 22037     IF FIRST-ENTRY OR
 22038        EIBAID = DFHPF1 OR DFHPF2
 22039        MOVE '0'                TO PI-EDIT-SW
 22040        GO TO 7399-EXIT.
 22041
 22042 7355-SET-ERROR-FLAGS.
 22043
 22044     IF EMI-WARNING-CTR NOT = ZEROS
 22045        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22046        MOVE 'W'                 TO PB-WARN-ER-CD.
 22047
 22048     IF PB-UNFORCED-ERRORS OR
 22049        PB-FATAL-ERRORS    OR
 22050        PB-RECORD-ON-HOLD  OR
 22051        PB-RECORD-RETURNED OR
 22052        PB-CANCELLATION
 22053          NEXT SENTENCE
 22054        ELSE
 22055          GO TO 7399-EXIT.
 22056
 22057
 22058* EXEC CICS  HANDLE CONDITION
 22059*           NOTFND   (7399-EXIT)
 22060*    END-EXEC.
 22061*    MOVE '"$I                   ! X #00018504' TO DFHEIV0
 22062     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22063     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22064     MOVE X'5820233030303138353034' TO DFHEIV0(25:11)
 22065     CALL 'kxdfhei1' USING DFHEIV0
 22066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22067
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 411
* EL6311.cbl
 22068
 22069     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22070     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22071     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22072     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22073
 22074
 22075* EXEC CICS READ
 22076*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22077*        DATASET (FILE-ID-ELCERT)
 22078*        RIDFLD  (ELCERT-KEY)
 22079*        UPDATE
 22080*    END-EXEC.
 22081*    MOVE '&"S        EU         (   #00018513' TO DFHEIV0
 22082     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22083     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22084     MOVE X'2020233030303138353133' TO DFHEIV0(25:11)
 22085     CALL 'kxdfhei1' USING DFHEIV0,
 22086           FILE-ID-ELCERT,
 22087           DFHEIV20,
 22088           DFHEIV99,
 22089           ELCERT-KEY,
 22090           DFHEIV99,
 22091           DFHEIV99,
 22092           DFHEIV99
 22093     SET ADDRESS OF CERTIFICATE-MASTER TO
 22094         DFHEIV20
 22095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22096
 22097
 22098
 22099     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22100     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22101
 22102     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22103        GO TO 7360-REWRITE-CERT-MASTER.
 22104
 22105     IF PB-ISSUE
 22106        IF PB-RECORD-RETURNED
 22107            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22108            GO TO 7360-REWRITE-CERT-MASTER
 22109        ELSE
 22110            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22111            GO TO 7360-REWRITE-CERT-MASTER.
 22112
 22113     IF PB-RECORD-RETURNED
 22114         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22115         GO TO 7360-REWRITE-CERT-MASTER.
 22116
 22117     IF PB-C-LF-CANCEL-VOIDED
 22118        IF (PB-UNFORCED-ERRORS OR
 22119            PB-FATAL-ERRORS    OR
 22120            PB-RECORD-ON-HOLD)
 22121            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22122            GO TO 7360-REWRITE-CERT-MASTER
 22123        ELSE
 22124            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22125            GO TO 7360-REWRITE-CERT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 412
* EL6311.cbl
 22126
 22127     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22128                            OR PB-RECORD-ON-HOLD)
 22129        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22130     ELSE
 22131        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22132
 22133 7360-REWRITE-CERT-MASTER.
 22134
 22135     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22136        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22137
 22138* EXEC CICS UNLOCK
 22139*            DATASET    (FILE-ID-ELCERT)
 22140*       END-EXEC
 22141*    MOVE '&*                    #   #00018559' TO DFHEIV0
 22142     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22143     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22144     MOVE X'2020233030303138353539' TO DFHEIV0(25:11)
 22145     CALL 'kxdfhei1' USING DFHEIV0,
 22146           FILE-ID-ELCERT,
 22147           DFHEIV99
 22148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22149        GO TO 7399-EXIT.
 22150
 22151
 22152* EXEC CICS REWRITE
 22153*         DATASET    (FILE-ID-ELCERT)
 22154*         FROM       (CERTIFICATE-MASTER)
 22155*    END-EXEC.
 22156     MOVE LENGTH OF
 22157      CERTIFICATE-MASTER
 22158       TO DFHEIV11
 22159*    MOVE '&& L                  %   #00018564' TO DFHEIV0
 22160     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22161     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22162     MOVE X'2020233030303138353634' TO DFHEIV0(25:11)
 22163     CALL 'kxdfhei1' USING DFHEIV0,
 22164           FILE-ID-ELCERT,
 22165           CERTIFICATE-MASTER,
 22166           DFHEIV11,
 22167           DFHEIV99
 22168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22169
 22170
 22171 7399-EXIT.
 22172      EXIT.
 22173
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 413
* EL6311.cbl
 22175
 22176*************************************************************
 22177*                                                           *
 22178*              S E T   A T T R I B U T E S                  *
 22179*                                                           *
 22180*************************************************************
 22181
 22182 7400-SET-ATTRIBUTES.
 22183
 22184     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22185        GO TO 7499-EXIT.
 22186
 22187**2601**
 22188
 22189     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 22190        IF PB-ISSUE
 22191           MOVE AL-UABON         TO BEFFDTA
 22192           GO TO 7499-EXIT
 22193         ELSE
 22194           MOVE AL-UABON         TO CEFFDTA
 22195           GO TO 7499-EXIT.
 22196
 22197**2604**
 22198
 22199     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 22200        IF PB-ISSUE
 22201           MOVE AL-UABON         TO BTYPE1A
 22202           MOVE -1               TO BTYPE1L
 22203           MOVE  1               TO SET-CURSOR-SW
 22204           GO TO 7499-EXIT.
 22205
 22206**2605**
 22207
 22208     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 22209        IF PB-ISSUE
 22210           MOVE AL-UABON         TO BTYPE2A
 22211           MOVE -1               TO BTYPE2L
 22212           MOVE  1               TO SET-CURSOR-SW
 22213           GO TO 7499-EXIT.
 22214
 22215**2606**
 22216
 22217     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 22218        IF PB-ISSUE
 22219           MOVE AL-UABON         TO BSIGA
 22220           MOVE -1               TO BSIGL
 22221           MOVE  1               TO SET-CURSOR-SW
 22222           GO TO 7499-EXIT.
 22223
 22224**2607**
 22225
 22226     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22227        IF PB-ISSUE
 22228           MOVE AL-UABON         TO BSIGA
 22229           MOVE -1               TO BSIGL
 22230           MOVE  1               TO SET-CURSOR-SW
 22231           GO TO 7499-EXIT.
 22232
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 414
* EL6311.cbl
 22233**2615**
 22234
 22235     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22236        IF PB-ISSUE
 22237           MOVE AL-UABOF         TO BREINA
 22238           MOVE -1               TO BREINL
 22239           GO TO 7499-EXIT.
 22240
 22241**2622**
 22242
 22243     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 22244        IF PB-ISSUE
 22245           MOVE AL-UABON         TO BEFFDTA
 22246           GO TO 7499-EXIT
 22247        ELSE
 22248           MOVE AL-UABON         TO CEFFDTA
 22249           GO TO 7499-EXIT.
 22250
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 415
* EL6311.cbl
 22252
 22253*************************************************************
 22254*                                                           *
 22255*              I S S U E   E R R O R S                      *
 22256*                                                           *
 22257*************************************************************
 22258
 22259 7420-ISSUE-ERRORS.
 22260
 22261**2626**
 22262
 22263     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 22264        MOVE AL-UABON            TO BCERTNOA
 22265        GO TO 7499-EXIT.
 22266
 22267**2627**
 22268
 22269     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 22270        MOVE AL-UNBON            TO BAGEA
 22271        MOVE -1                  TO BAGEL
 22272        MOVE  1                  TO SET-CURSOR-SW
 22273        GO TO 7499-EXIT.
 22274
 22275**2628**
 22276
 22277     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 22278        MOVE AL-UNBON            TO BAGEA
 22279        MOVE -1                  TO BAGEL
 22280        MOVE  1                  TO SET-CURSOR-SW
 22281        GO TO 7499-EXIT.
 22282
 22283**2629**
 22284
 22285     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 22286        MOVE AL-UABON            TO BSEXA
 22287        MOVE -1                  TO BSEXL
 22288        MOVE  1                  TO SET-CURSOR-SW
 22289        GO TO 7499-EXIT.
 22290
 22291**2630**
 22292
 22293     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 22294        MOVE -1                  TO BTYPE1L
 22295        MOVE  1                  TO SET-CURSOR-SW
 22296        GO TO 7499-EXIT.
 22297
 22298**2631**
 22299
 22300     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 22301        MOVE -1                  TO BTYPE1L
 22302        MOVE  1                  TO SET-CURSOR-SW
 22303        GO TO 7499-EXIT.
 22304
 22305**2632**
 22306
 22307     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 22308        MOVE AL-UNBON            TO BBEN1A
 22309        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 416
* EL6311.cbl
 22310        MOVE  1                  TO SET-CURSOR-SW
 22311        GO TO 7499-EXIT.
 22312
 22313**2633**
 22314
 22315     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 22316        MOVE AL-UNBON            TO BPREM1A
 22317        MOVE -1                  TO BPREM1L
 22318        MOVE  1                  TO SET-CURSOR-SW
 22319        GO TO 7499-EXIT.
 22320
 22321**2634**
 22322
 22323     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 22324        MOVE -1                  TO BTYPE2L
 22325        MOVE  1                  TO SET-CURSOR-SW
 22326        GO TO 7499-EXIT.
 22327
 22328**2635**
 22329
 22330     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 22331        MOVE AL-UNBON            TO BBEN2A
 22332        MOVE -1                  TO BBEN2L
 22333        MOVE  1                  TO SET-CURSOR-SW
 22334        GO TO 7499-EXIT.
 22335
 22336**2636**
 22337
 22338     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 22339        MOVE AL-UNBON            TO BPREM2A
 22340        MOVE -1                  TO BPREM2L
 22341        MOVE  1                  TO SET-CURSOR-SW
 22342        GO TO 7499-EXIT.
 22343
 22344**2639**
 22345
 22346     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 22347        MOVE AL-UNBON            TO BBEN1A
 22348        MOVE -1                  TO BBEN1L
 22349        MOVE  1                  TO SET-CURSOR-SW
 22350        GO TO 7499-EXIT.
 22351
 22352**2640**
 22353
 22354     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 22355        MOVE AL-UNBON            TO BBEN2A
 22356        MOVE -1                  TO BBEN2L
 22357        MOVE  1                  TO SET-CURSOR-SW
 22358        GO TO 7499-EXIT.
 22359
 22360**2647**
 22361
 22362     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 22363        MOVE AL-UNBON            TO BTERM1A
 22364        MOVE -1                  TO BTERM1L
 22365        MOVE  1                  TO SET-CURSOR-SW
 22366        GO TO 7499-EXIT.
 22367
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 417
* EL6311.cbl
 22368**2648**
 22369
 22370     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 22371        MOVE AL-UNBON            TO BLNTRMA
 22372        MOVE -1                  TO BLNTRML
 22373        MOVE  1                  TO SET-CURSOR-SW
 22374        GO TO 7499-EXIT.
 22375
 22376**2649**
 22377
 22378     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22379        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22380            MOVE AL-UNBON            TO BPREM1A
 22381            MOVE -1                  TO BPREM1L
 22382            MOVE  1                  TO SET-CURSOR-SW
 22383            GO TO 7499-EXIT
 22384     ELSE
 22385        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22386           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22387            MOVE AL-UNBON            TO BPREM2A
 22388            MOVE -1                  TO BPREM2L
 22389            MOVE  1                  TO SET-CURSOR-SW
 22390            GO TO 7499-EXIT.
 22391
 22392**2650**
 22393
 22394     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22395        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22396            MOVE AL-UNBON        TO BPREM1A
 22397            MOVE -1              TO BPREM1L
 22398            MOVE  1              TO SET-CURSOR-SW
 22399            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22400                MOVE AL-UNBON        TO BPREM2A
 22401                MOVE -1              TO BPREM2L
 22402                MOVE  1              TO SET-CURSOR-SW
 22403                GO TO 7499-EXIT
 22404            ELSE
 22405                GO TO 7499-EXIT
 22406        ELSE
 22407            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22408                MOVE AL-UNBON        TO BPREM2A
 22409                MOVE -1              TO BPREM2L
 22410                MOVE  1              TO SET-CURSOR-SW
 22411                GO TO 7499-EXIT
 22412            ELSE
 22413                GO TO 7499-EXIT.
 22414
 22415**2651**
 22416
 22417     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22418        MOVE AL-UABON            TO BSIGA
 22419        MOVE -1                  TO BSIGL
 22420        MOVE  1                  TO SET-CURSOR-SW
 22421        GO TO 7499-EXIT.
 22422
 22423**2653**
 22424
 22425     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 418
* EL6311.cbl
 22426        MOVE AL-UABON            TO BFREQA
 22427        MOVE -1                  TO BFREQL
 22428        MOVE  1                  TO SET-CURSOR-SW
 22429        GO TO 7499-EXIT.
 22430
 22431**2654**
 22432
 22433     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 22434        MOVE AL-UABON            TO BFREQA
 22435        MOVE -1                  TO BFREQL
 22436        MOVE  1                  TO SET-CURSOR-SW
 22437        GO TO 7499-EXIT.
 22438
 22439**2655**
 22440
 22441     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 22442        MOVE AL-UABON            TO BFREQA
 22443        MOVE -1                  TO BFREQL
 22444        MOVE  1                  TO SET-CURSOR-SW
 22445        GO TO 7499-EXIT.
 22446
 22447**2656**
 22448
 22449     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 22450        MOVE AL-UNBON            TO BAPRA
 22451        MOVE -1                  TO BAPRL
 22452        MOVE  1                  TO SET-CURSOR-SW
 22453        GO TO 7499-EXIT.
 22454
 22455**2657**
 22456
 22457     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22458        MOVE AL-UNBON            TO BAPRA
 22459        MOVE -1                  TO BAPRL
 22460        MOVE  1                  TO SET-CURSOR-SW
 22461        GO TO 7499-EXIT.
 22462
 22463**2658**
 22464
 22465     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22466        MOVE AL-UNBON            TO BTERM2A
 22467        MOVE -1                  TO BTERM2L
 22468        MOVE  1                  TO SET-CURSOR-SW
 22469        GO TO 7499-EXIT.
 22470
 22471**2660**
 22472
 22473     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 22474        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 22475        MOVE -1                  TO BLSTNML
 22476        MOVE  1                  TO SET-CURSOR-SW
 22477        GO TO 7499-EXIT.
 22478
 22479
 22480**2662**
 22481
 22482     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 22483        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 419
* EL6311.cbl
 22484        MOVE -1                  TO BAGEL
 22485        MOVE  1                  TO SET-CURSOR-SW
 22486        GO TO 7499-EXIT.
 22487
 22488**2663**
 22489
 22490     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 22491        MOVE AL-UNBON            TO BAGEA
 22492        MOVE -1                  TO BAGEL
 22493        MOVE  1                  TO SET-CURSOR-SW
 22494        GO TO 7499-EXIT.
 22495
 22496**2664**
 22497
 22498     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 22499        MOVE AL-UABON            TO BREINA
 22500        MOVE -1                  TO BREINL
 22501        MOVE  1                  TO SET-CURSOR-SW
 22502        GO TO 7499-EXIT.
 22503
 22504**2667**
 22505
 22506     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 22507        MOVE AL-UNBON            TO BBEN2A
 22508        MOVE -1                  TO BBEN2L
 22509        MOVE  1                  TO SET-CURSOR-SW
 22510        GO TO 7499-EXIT.
 22511
 22512**2668**
 22513
 22514     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 22515        MOVE AL-UABON            TO BEFFDTA
 22516        GO TO 7499-EXIT.
 22517
 22518**2669**
 22519
 22520     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 22521        MOVE AL-UNBON            TO BAGEA
 22522        MOVE -1                  TO BAGEL
 22523        MOVE  1                  TO SET-CURSOR-SW
 22524        GO TO 7499-EXIT.
 22525
 22526**2670**
 22527
 22528     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 22529        MOVE AL-UABON            TO BFORCEA
 22530        MOVE -1                  TO BFORCEL
 22531        MOVE  1                  TO SET-CURSOR-SW
 22532        GO TO 7499-EXIT.
 22533
 22534**2671**
 22535
 22536     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 22537        MOVE AL-UABON            TO BEFFDTA
 22538        GO TO 7499-EXIT.
 22539
 22540**2672**
 22541
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 420
* EL6311.cbl
 22542     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 22543        MOVE AL-UABON            TO BEFFDTA
 22544        GO TO 7499-EXIT.
 22545
 22546**2673**
 22547
 22548     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22549        MOVE AL-UABON            TO BEFFDTA
 22550        GO TO 7499-EXIT.
 22551
 22552**2674**
 22553
 22554     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22555        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 22556        MOVE -1                  TO BTYPE1L
 22557        MOVE  1                  TO SET-CURSOR-SW
 22558        GO TO 7499-EXIT.
 22559
 22560**2677**
 22561
 22562     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 22563        MOVE AL-UNBON            TO BTERM1A
 22564        MOVE -1                  TO BTERM1L
 22565        MOVE  1                  TO SET-CURSOR-SW
 22566        GO TO 7499-EXIT.
 22567
 22568**2678**
 22569
 22570     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 22571        MOVE AL-UNBON            TO BTERM2A
 22572        MOVE -1                  TO BTERM2L
 22573        MOVE  1                  TO SET-CURSOR-SW
 22574        GO TO 7499-EXIT.
 22575
 22576**2679**
 22577
 22578     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 22579        MOVE AL-UABON            TO BTYPE1A
 22580        MOVE -1                  TO BTYPE1L
 22581        MOVE  1                  TO SET-CURSOR-SW
 22582        GO TO 7499-EXIT.
 22583
 22584**2680**
 22585
 22586     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 22587        MOVE AL-UABOF            TO B1STPMTA
 22588        MOVE -1                  TO B1STPMTL
 22589        MOVE  1                  TO SET-CURSOR-SW
 22590        GO TO 7499-EXIT.
 22591
 22592**2681**
 22593
 22594     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 22595        MOVE AL-UABON            TO BDAYSA
 22596        MOVE -1                  TO BDAYSL
 22597        MOVE  1                  TO SET-CURSOR-SW
 22598        GO TO 7499-EXIT.
 22599
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 421
* EL6311.cbl
 22600**2682**
 22601
 22602     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 22603        MOVE AL-UABON            TO BTERM1A
 22604        MOVE -1                  TO BTERM1L
 22605        MOVE  1                  TO SET-CURSOR-SW
 22606        GO TO 7499-EXIT.
 22607
 22608**2683**
 22609
 22610     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 22611        MOVE AL-UABON            TO BSKPCDA
 22612        MOVE -1                  TO BSKPCDL
 22613        MOVE  1                  TO SET-CURSOR-SW
 22614        GO TO 7499-EXIT.
 22615
 22616**2684**
 22617
 22618     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 22619        MOVE AL-UABON            TO BTYPE2A
 22620        MOVE -1                  TO BTYPE2L
 22621        MOVE  1                  TO SET-CURSOR-SW
 22622        GO TO 7499-EXIT.
 22623
 22624**2686**
 22625
 22626     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 22627        MOVE AL-UABON            TO BTYPE2A
 22628        MOVE -1                  TO BTYPE2L
 22629        MOVE  1                  TO SET-CURSOR-SW
 22630        GO TO 7499-EXIT.
 22631
 22632**2689**
 22633
 22634     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 22635        MOVE AL-UABON            TO BSIGA
 22636        MOVE -1                  TO BSIGL
 22637        MOVE  1                  TO SET-CURSOR-SW
 22638        GO TO 7499-EXIT.
 22639
 22640**2690**
 22641
 22642     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 22643        MOVE AL-UABOF            TO BLNOFCRA
 22644        MOVE -1                  TO BLNOFCRL
 22645        MOVE  1                  TO SET-CURSOR-SW
 22646        GO TO 7499-EXIT.
 22647
 22648**2693**
 22649
 22650     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 22651        MOVE AL-UABOF            TO BLNOFCRA
 22652        MOVE AL-UNBON            TO BBEN1A
 22653        MOVE -1                  TO BBEN1L
 22654        MOVE  1                  TO SET-CURSOR-SW
 22655        GO TO 7499-EXIT.
 22656
 22657**2720**
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 422
* EL6311.cbl
 22658
 22659     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 22660        MOVE AL-UNBON            TO BBEN1A
 22661        MOVE -1                  TO BBEN1L
 22662        MOVE  1                  TO SET-CURSOR-SW
 22663        GO TO 7499-EXIT.
 22664
 22665**2709**
 22666
 22667*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 22668*       MOVE AL-UNBON            TO BBEN1A
 22669*       MOVE -1                  TO BBEN1L
 22670*       MOVE  1                  TO SET-CURSOR-SW
 22671*       GO TO 7499-EXIT.
 22672
 22673*************************************************************
 22674*                                                           *
 22675*            C A N C E L   E R R O R S                      *
 22676*                                                           *
 22677*************************************************************
 22678
 22679**2726**
 22680
 22681     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 22682        MOVE AL-UABON            TO CCERTNOA
 22683        GO TO 7499-EXIT.
 22684
 22685**2728**
 22686
 22687     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 22688        MOVE AL-UABON            TO CCERTNOA
 22689        GO TO 7499-EXIT.
 22690
 22691**2729**
 22692
 22693     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 22694        MOVE AL-UABON            TO CCERTNOA
 22695        GO TO 7499-EXIT.
 22696
 22697**2730**
 22698
 22699     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 22700        MOVE AL-UABON            TO CCERTNOA
 22701        GO TO 7499-EXIT.
 22702
 22703**2731**
 22704
 22705     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 22706        MOVE AL-UABON            TO CCANDT1A
 22707        MOVE -1                  TO CCANDT1L
 22708        MOVE  1                  TO SET-CURSOR-SW
 22709        GO TO 7499-EXIT.
 22710
 22711**2732**
 22712
 22713     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 22714        MOVE AL-UABON            TO CCANDT1A
 22715        MOVE -1                  TO CCANDT1L
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 423
* EL6311.cbl
 22716        MOVE  1                  TO SET-CURSOR-SW
 22717        GO TO 7499-EXIT.
 22718
 22719**2733**
 22720
 22721     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 22722        MOVE AL-UABON            TO CCANDT1A
 22723        MOVE -1                  TO CCANDT1L
 22724        MOVE  1                  TO SET-CURSOR-SW
 22725        GO TO 7499-EXIT.
 22726
 22727**2734**
 22728
 22729     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 22730        MOVE AL-UNBON            TO CREFND1A
 22731        MOVE -1                  TO CREFND1L
 22732        MOVE  1                  TO SET-CURSOR-SW
 22733        GO TO 7499-EXIT.
 22734
 22735**2735**
 22736
 22737     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 22738        MOVE AL-UABON            TO CCANDT2A
 22739        MOVE -1                  TO CCANDT2L
 22740        MOVE  1                  TO SET-CURSOR-SW
 22741        GO TO 7499-EXIT.
 22742
 22743**2736**
 22744
 22745     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 22746        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 22747            MOVE AL-UNBON        TO CREFND1A
 22748            MOVE -1              TO CREFND1L
 22749            MOVE  1              TO SET-CURSOR-SW
 22750            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 22751                MOVE AL-UNBON        TO CREFND2A
 22752                MOVE -1              TO CREFND2L
 22753                MOVE  1              TO SET-CURSOR-SW
 22754                GO TO 7499-EXIT
 22755            ELSE
 22756                GO TO 7499-EXIT
 22757        ELSE
 22758            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 22759                MOVE AL-UNBON        TO CREFND2A
 22760                MOVE -1              TO CREFND2L
 22761                MOVE  1              TO SET-CURSOR-SW
 22762                GO TO 7499-EXIT
 22763            ELSE
 22764                GO TO 7499-EXIT.
 22765
 22766**2738**
 22767
 22768     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 22769        MOVE -1                  TO CREFND2L
 22770        MOVE  1                  TO SET-CURSOR-SW
 22771        GO TO 7499-EXIT.
 22772
 22773**2739**
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 424
* EL6311.cbl
 22774
 22775     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 22776        MOVE -1                  TO CREFND1L
 22777        MOVE  1                  TO SET-CURSOR-SW
 22778        GO TO 7499-EXIT.
 22779
 22780**2741**
 22781
 22782     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 22783        MOVE -1                  TO CREFND1L
 22784        MOVE  1                  TO SET-CURSOR-SW
 22785        GO TO 7499-EXIT.
 22786
 22787**2743**
 22788
 22789     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 22790        MOVE AL-UNBON            TO CCANDT1A
 22791        MOVE -1                  TO CCANDT1L
 22792        MOVE  1                  TO SET-CURSOR-SW
 22793        GO TO 7499-EXIT.
 22794
 22795**2744**
 22796
 22797     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 22798        MOVE AL-UNBON            TO CCANDT2A
 22799        MOVE -1                  TO CCANDT2L
 22800        MOVE  1                  TO SET-CURSOR-SW
 22801        GO TO 7499-EXIT.
 22802
 22803**2747**
 22804
 22805     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 22806        MOVE AL-UABON            TO CLSTNMA
 22807        MOVE -1                  TO CLSTNML
 22808        MOVE  1                  TO SET-CURSOR-SW
 22809        GO TO 7499-EXIT.
 22810
 22811**2749**
 22812
 22813     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 22814        MOVE AL-UABON            TO CFORCEA
 22815        MOVE -1                  TO CFORCEL
 22816        MOVE  1                  TO SET-CURSOR-SW
 22817        GO TO 7499-EXIT.
 22818
 22819**2753**
 22820
 22821     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 22822        MOVE AL-UNBON            TO CCANDT1A
 22823        MOVE -1                  TO CCANDT1L
 22824        MOVE  1                  TO SET-CURSOR-SW
 22825        GO TO 7499-EXIT.
 22826
 22827**2755**
 22828
 22829     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 22830        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 22831            MOVE AL-UNBON        TO CREFND1A
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 425
* EL6311.cbl
 22832            MOVE -1              TO CREFND1L
 22833            MOVE  1              TO SET-CURSOR-SW
 22834            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 22835                MOVE AL-UNBON        TO CREFND2A
 22836                MOVE -1              TO CREFND2L
 22837                MOVE  1              TO SET-CURSOR-SW
 22838                GO TO 7499-EXIT
 22839            ELSE
 22840                GO TO 7499-EXIT
 22841        ELSE
 22842            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 22843                MOVE AL-UNBON        TO CREFND2A
 22844                MOVE -1              TO CREFND2L
 22845                MOVE  1              TO SET-CURSOR-SW
 22846            ELSE
 22847                GO TO 7499-EXIT.
 22848
 22849**2757**
 22850
 22851     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 22852        MOVE AL-UNBON            TO CLIVESA
 22853        MOVE -1                  TO CLIVESL
 22854        MOVE  1                  TO SET-CURSOR-SW
 22855        GO TO 7499-EXIT.
 22856
 22857**2771**
 22858
 22859     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 22860        MOVE AL-UABON            TO CCANDT2A
 22861        MOVE -1                  TO CCANDT2L
 22862        MOVE  1                  TO SET-CURSOR-SW
 22863        GO TO 7499-EXIT.
 22864
 22865**2774**
 22866
 22867     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 22868        MOVE AL-UABON            TO CCANDT1A
 22869        MOVE -1                  TO CCANDT1L
 22870        MOVE  1                  TO SET-CURSOR-SW
 22871        GO TO 7499-EXIT.
 22872
 22873**2775**
 22874
 22875     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 22876        MOVE AL-UABON            TO CCANDT2A
 22877        MOVE -1                  TO CCANDT2L
 22878        MOVE  1                  TO SET-CURSOR-SW
 22879        GO TO 7499-EXIT.
 22880
 22881**2776**
 22882
 22883     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 22884        MOVE AL-UABON            TO CCANDT1A
 22885        MOVE -1                  TO CCANDT1L
 22886        MOVE  1                  TO SET-CURSOR-SW
 22887        GO TO 7499-EXIT.
 22888
 22889
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 426
* EL6311.cbl
 22890**2777**
 22891
 22892     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 22893        MOVE AL-UABON            TO CCANDT2A
 22894        MOVE -1                  TO CCANDT2L
 22895        MOVE  1                  TO SET-CURSOR-SW
 22896        GO TO 7499-EXIT.
 22897
 22898**2794**
 22899
 22900     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 22901        MOVE AL-UABON            TO CFORCEA
 22902        MOVE -1                  TO CFORCEL
 22903        MOVE  1                  TO SET-CURSOR-SW
 22904        GO TO 7499-EXIT.
 22905
 22906**2799**
 22907
 22908     IF PI-COMPANY-ID = 'UCL'
 22909         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 22910             MOVE AL-UNBON            TO BEFFDTA
 22911             MOVE -1                  TO BEFFDTL
 22912             MOVE  1                  TO SET-CURSOR-SW
 22913             GO TO 7499-EXIT.
 22914
 22915 7499-EXIT.
 22916      EXIT.
 22917
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 427
* EL6311.cbl
 22919
 22920 7500-READ-ERLOFC.
 22921     MOVE SPACES                 TO  WS-LOAN-OFFICER
 22922                                     ERLOFC-KEY.
 22923
 22924     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 22925
 22926     IF ST-ACCNT-CNTL
 22927         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 22928
 22929     IF CARR-GROUP-ST-ACCNT-CNTL
 22930         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 22931         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 22932         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 22933
 22934     IF CARR-ST-ACCNT-CNTL
 22935         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 22936         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 22937
 22938     IF CARR-ACCNT-CNTL
 22939         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 22940
 22941     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 22942
 22943     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 22944
 22945
 22946* EXEC CICS HANDLE CONDITION
 22947*        NOTFND   (7550-OFFICER-NOTFND)
 22948*    END-EXEC.
 22949*    MOVE '"$I                   ! Y #00019343' TO DFHEIV0
 22950     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22952     MOVE X'5920233030303139333433' TO DFHEIV0(25:11)
 22953     CALL 'kxdfhei1' USING DFHEIV0
 22954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22955
 22956
 22957
 22958* EXEC CICS READ
 22959*        DATASET   (FILE-ID-ERLOFC)
 22960*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 22961*        RIDFLD    (ERLOFC-KEY)
 22962*        EQUAL
 22963*    END-EXEC.
 22964*    MOVE '&"S        E          (   #00019347' TO DFHEIV0
 22965     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22966     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22967     MOVE X'2020233030303139333437' TO DFHEIV0(25:11)
 22968     CALL 'kxdfhei1' USING DFHEIV0,
 22969           FILE-ID-ERLOFC,
 22970           DFHEIV20,
 22971           DFHEIV99,
 22972           ERLOFC-KEY,
 22973           DFHEIV99,
 22974           DFHEIV99,
 22975           DFHEIV99
 22976     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 428
* EL6311.cbl
 22977         DFHEIV20
 22978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22979
 22980
 22981     GO TO 7599-EXIT.
 22982
 22983 7550-OFFICER-NOTFND.
 22984     MOVE 'X'                    TO WS-LOAN-OFFICER.
 22985
 22986 7599-EXIT.
 22987      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 429
* EL6311.cbl
 22989******************************************************************
 22990*                                                                *
 22991*            S  E N D    I N I T I A L   M A P                   *
 22992*                                                                *
 22993******************************************************************
 22994
 22995 8100-SEND-INITIAL-MAP.
 22996     MOVE EIBTIME                TO TIME-IN.
 22997
 22998     IF EIBAID = DFHPF11
 22999        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23000        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23001
 23002
 23003     IF PI-COMPANY-ID = CLIENT-GIC
 23004        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23005                                       BCPREM-ATTRB (2).
 23006
 23007     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23008                         CLIENT-PEM OR
 23009                         CLIENT-CSO)
 23010        AND PI-DISPLAY-ORIGINAL-BATCH
 23011          IF PI-MAP-NAME = EL631B
 23012             MOVE AL-SADOF               TO BPF5HDRA
 23013                                            BPF4HDRA
 23014          ELSE
 23015             IF PI-MAP-NAME = EL631C
 23016                MOVE AL-SADOF            TO CPF5HDRA
 23017                                            CPF4HDRA.
 23018
 23019     IF PI-MAP-NAME = EL631B
 23020        MOVE AL-SADOF               TO BPF5HDRA
 23021     ELSE
 23022        MOVE AL-SADOF               TO CPF5HDRA
 23023     END-IF
 23024
 23025*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23026     IF PI-MAP-NAME = EL631B
 23027          IF PI-COMPANY-ID NOT = 'DMD'
 23028             MOVE AL-SANOF            TO BBILLEDA
 23029             MOVE AL-SADOF            TO DMDBILA.
 23030*DMD CUSTOM CODING*************END
 23031
 23032     IF PI-PROCESSOR-ID = 'LGXX'
 23033        IF PI-MAP-NAME = EL631B
 23034           MOVE AL-SABOF                    TO BREFHDGA
 23035           MOVE AL-SANOF                    TO BREFA
 23036        ELSE
 23037           IF PI-MAP-NAME = EL631C
 23038              MOVE AL-SABOF                 TO CREFHDGA
 23039              MOVE AL-SANOF                 TO CREFA.
 23040
 23041*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23042     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23043        NEXT SENTENCE
 23044     ELSE
 23045        IF PI-MAP-NAME = EL631C
 23046           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 430
* EL6311.cbl
 23047                                       CCANFEEA.
 23048
 23049     IF PI-MAP-NAME = EL631D
 23050        IF PI-AR-PROCESSING
 23051           MOVE AL-SANOF            TO DREFHDGA
 23052        ELSE
 23053           MOVE AL-SADOF            TO DREFHDGA.
 23054
 23055     IF (PI-COMPANY-ID NOT = 'DCC')
 23056        AND (PI-MAP-NAME = EL631B)
 23057        MOVE AL-SADOF            TO BVINHA
 23058                                    BVINA
 23059     END-IF
 23060     IF PI-MAP-NAME = EL631B
 23061        IF CSR-EDIT-SESSION
 23062           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23063                                 TO BHEADO
 23064           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23065        ELSE
 23066           MOVE AL-SADOF         TO BF15HDRA
 23067           MOVE '4=B-HDR      '  TO BPF4HDRO
 23068        END-IF
 23069        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23070        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23071        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23072        MOVE WS-CURRENT-DT          TO BDATEO
 23073        MOVE TIME-OUT               TO BTIMEO
 23074        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23075        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23076        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23077        IF   WS-DISPLAY-SCREEN
 23078             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23079             MOVE PB-SV-CARRIER     TO BCARRO
 23080             MOVE PB-SV-GROUPING    TO BGROUPO
 23081             MOVE PB-SV-STATE       TO BSTATEO
 23082             MOVE PB-ACCOUNT        TO BACCTO
 23083        ELSE
 23084             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23085     ELSE
 23086        IF PI-MAP-NAME = EL631C
 23087           MOVE '4=B-HDR      '     TO CPF4HDRO
 23088           IF CSR-EDIT-SESSION
 23089              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23090                                 TO CHEADO
 23091           ELSE
 23092              MOVE AL-SADOF      TO CF15HDRA
 23093           END-IF
 23094           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23095           MOVE WS-CURRENT-DT          TO CDATEO
 23096           MOVE TIME-OUT               TO CTIMEO
 23097           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23098           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23099           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23100           MOVE WS-C-HDG               TO CLFHDGO
 23101           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23102           MOVE WS-C-HDG               TO CAHHDGO
 23103           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23104           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 431
* EL6311.cbl
 23105           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23106           IF   WS-DISPLAY-SCREEN
 23107                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23108                MOVE PB-SV-CARRIER     TO CCARRO
 23109                MOVE PB-SV-GROUPING    TO CGROUPO
 23110                MOVE PB-SV-STATE       TO CSTATEO
 23111                MOVE PB-ACCOUNT        TO CACCTO
 23112           ELSE
 23113                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23114        ELSE
 23115           MOVE WS-CURRENT-DT          TO DDATEO
 23116           MOVE TIME-OUT               TO DTIMEO
 23117           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23118                                          WS-REFUND-HDG-OVERRIDE
 23119           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23120           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23121           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23122                                          WS-REFUND-HDG-OVERRIDE
 23123           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23124           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23125           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23126           IF CSR-EDIT-SESSION
 23127              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23128                                 TO DHEADO
 23129           END-IF
 23130           IF  WS-DISPLAY-SCREEN
 23131               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23132               MOVE PB-CARRIER         TO DCARRO
 23133               MOVE PB-GROUPING        TO DGROUPO
 23134               MOVE PB-STATE           TO DSTATEO
 23135               MOVE PB-ACCOUNT         TO DACCTO
 23136               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23137           ELSE
 23138               MOVE EL631D             TO PI-MAP-NAME
 23139               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23140               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23141
 23142     MOVE SPACE                        TO WS-DISPLAY-SW.
 23143
 23144
 23145* EXEC CICS SEND
 23146*        MAP      (PI-MAP-NAME)
 23147*        MAPSET   (MAPSET-EL6311S)
 23148*        FROM     (EL631BI)
 23149*        ERASE
 23150*        CURSOR
 23151*    END-EXEC.
 23152     MOVE LENGTH OF
 23153      EL631BI
 23154       TO DFHEIV12
 23155     MOVE -1
 23156       TO DFHEIV11
 23157*    MOVE '8$     CT  E    H L F ,   #00019517' TO DFHEIV0
 23158     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23159     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23160     MOVE X'2020233030303139353137' TO DFHEIV0(25:11)
 23161     CALL 'kxdfhei1' USING DFHEIV0,
 23162           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 432
* EL6311.cbl
 23163           EL631BI,
 23164           DFHEIV12,
 23165           MAPSET-EL6311S,
 23166           DFHEIV99,
 23167           DFHEIV99,
 23168           DFHEIV99,
 23169           DFHEIV11,
 23170           DFHEIV99,
 23171           DFHEIV99,
 23172           DFHEIV99
 23173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23174
 23175
 23176     GO TO 9100-RETURN-TRAN.
 23177
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 433
* EL6311.cbl
 23179
 23180******************************************************************
 23181*                                                                *
 23182*              S E N D    D A T A O N L Y                        *
 23183*                                                                *
 23184******************************************************************
 23185
 23186 8200-SEND-DATAONLY.
 23187     MOVE EIBTIME                TO TIME-IN.
 23188
 23189     IF PI-COMPANY-ID = CLIENT-GIC
 23190        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23191                                       BCPREM-ATTRB (2).
 23192
 23193     IF PI-MAP-NAME = EL631B
 23194        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23195        MOVE WS-CURRENT-DT          TO BDATEO
 23196        MOVE TIME-OUT               TO BTIMEO
 23197        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23198        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23199        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23200        MOVE SPACES                 TO BPFENTRO
 23201        MOVE AL-UANOF               TO BPFENTRA
 23202
 23203*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23204        IF PI-COMPANY-ID NOT = 'DMD'
 23205             MOVE AL-SANOF            TO BBILLEDA
 23206             MOVE AL-SADOF            TO DMDBILA
 23207         ELSE
 23208            NEXT SENTENCE
 23209*DMD CUSTOM CODING*************END
 23210     ELSE
 23211        IF PI-MAP-NAME = EL631C
 23212           MOVE WS-CURRENT-DT          TO CDATEO
 23213           MOVE TIME-OUT               TO CTIMEO
 23214           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23215           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23216           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23217           MOVE SPACES                 TO CPFENTRO
 23218           MOVE AL-UANOF               TO CPFENTRA
 23219        ELSE
 23220           MOVE WS-CURRENT-DT          TO DDATEO
 23221           MOVE TIME-OUT               TO DTIMEO
 23222           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 23223
 23224
 23225* EXEC CICS SEND
 23226*        MAP      (PI-MAP-NAME)
 23227*        MAPSET   (MAPSET-EL6311S)
 23228*        FROM     (EL631BI)
 23229*        DATAONLY
 23230*        CURSOR
 23231*    END-EXEC.
 23232     MOVE LENGTH OF
 23233      EL631BI
 23234       TO DFHEIV12
 23235     MOVE -1
 23236       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 434
* EL6311.cbl
 23237*    MOVE '8$D    CT       H L F ,   #00019573' TO DFHEIV0
 23238     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 23239     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23240     MOVE X'2020233030303139353733' TO DFHEIV0(25:11)
 23241     CALL 'kxdfhei1' USING DFHEIV0,
 23242           PI-MAP-NAME,
 23243           EL631BI,
 23244           DFHEIV12,
 23245           MAPSET-EL6311S,
 23246           DFHEIV99,
 23247           DFHEIV99,
 23248           DFHEIV99,
 23249           DFHEIV11,
 23250           DFHEIV99,
 23251           DFHEIV99,
 23252           DFHEIV99
 23253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23254
 23255
 23256     GO TO 9100-RETURN-TRAN.
 23257
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 435
* EL6311.cbl
 23259
 23260******************************************************************
 23261*                                                                *
 23262*           U T I L I T Y   R O U T I N E S                      *
 23263*                                                                *
 23264******************************************************************
 23265
 23266 8300-SEND-TEXT.
 23267
 23268* EXEC CICS SEND TEXT
 23269*        FROM     (LOGOFF-TEXT)
 23270*        LENGTH   (LOGOFF-LENGTH)
 23271*        ERASE
 23272*        FREEKB
 23273*    END-EXEC.
 23274*    MOVE '8&      T  E F  H   F -   #00019592' TO DFHEIV0
 23275     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 23276     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 23277     MOVE X'2020233030303139353932' TO DFHEIV0(25:11)
 23278     CALL 'kxdfhei1' USING DFHEIV0,
 23279           LOGOFF-TEXT,
 23280           LOGOFF-LENGTH,
 23281           DFHEIV99,
 23282           DFHEIV99,
 23283           DFHEIV99,
 23284           DFHEIV99,
 23285           DFHEIV99,
 23286           DFHEIV99,
 23287           DFHEIV99,
 23288           DFHEIV99,
 23289           DFHEIV99,
 23290           DFHEIV99
 23291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23292
 23293
 23294
 23295* EXEC CICS RETURN
 23296*    END-EXEC.
 23297*    MOVE '.(                    &   #00019599' TO DFHEIV0
 23298     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23299     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 23300     MOVE X'2020233030303139353939' TO DFHEIV0(25:11)
 23301     CALL 'kxdfhei1' USING DFHEIV0,
 23302           DFHEIV99,
 23303           DFHEIV99,
 23304           DFHEIV99,
 23305           DFHEIV99,
 23306           DFHEIV99
 23307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23308
 23309
 23310 8400-LOG-JOURNAL-RECORD.
 23311     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 23312     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 23313
 23314*    EXEC CICS JOURNAL
 23315*        JFILEID     (PI-JOURNAL-FILE-ID)
 23316*        JTYPEID     ('EL')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 436
* EL6311.cbl
 23317*        FROM        (JOURNAL-RECORD)
 23318*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 23319*    END-EXEC.
 23320
 23321 8600-DEEDIT.
 23322
 23323* EXEC CICS BIF DEEDIT
 23324*         FIELD   (DEEDIT-FIELD)
 23325*         LENGTH  (15)
 23326*    END-EXEC.
 23327     MOVE 15
 23328       TO DFHEIV11
 23329*    MOVE '@"L                   #   #00019614' TO DFHEIV0
 23330     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 23331     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23332     MOVE X'2020233030303139363134' TO DFHEIV0(25:11)
 23333     CALL 'kxdfhei1' USING DFHEIV0,
 23334           DEEDIT-FIELD,
 23335           DFHEIV11
 23336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23337
 23338
 23339 8800-UNAUTHORIZED-ACCESS.
 23340     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 23341     GO TO 8300-SEND-TEXT.
 23342
 23343 8810-PF23.
 23344     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 23345     MOVE XCTL-EL005             TO PGM-NAME.
 23346     GO TO 9300-XCTL.
 23347
 23348 9100-RETURN-TRAN.
 23349     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 23350
 23351     IF  PI-MAP-NAME =  EL631B
 23352         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 23353
 23354     IF  PI-MAP-NAME =  EL631C
 23355         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 23356
 23357     IF  PI-MAP-NAME =  EL631D
 23358         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 23359
 23360
 23361* EXEC CICS RETURN
 23362*        TRANSID    (TRANS-EXB1)
 23363*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23364*        LENGTH     (1300)
 23365*    END-EXEC.
 23366     MOVE 1300
 23367       TO DFHEIV11
 23368*    MOVE '.(CT                  &   #00019640' TO DFHEIV0
 23369     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 23370     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 23371     MOVE X'2020233030303139363430' TO DFHEIV0(25:11)
 23372     CALL 'kxdfhei1' USING DFHEIV0,
 23373           TRANS-EXB1,
 23374           PROGRAM-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 437
* EL6311.cbl
 23375           DFHEIV11,
 23376           DFHEIV99,
 23377           DFHEIV99
 23378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23379
 23380
 23381 9200-RETURN-MAIN-MENU.
 23382     MOVE XCTL-EL626             TO PGM-NAME.
 23383     GO TO 9300-XCTL.
 23384
 23385 9300-XCTL.
 23386
 23387* EXEC CICS XCTL
 23388*        PROGRAM    (PGM-NAME)
 23389*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23390*        LENGTH     (PI-COMM-LENGTH)
 23391*    END-EXEC.
 23392*    MOVE '.$C                   $   #00019651' TO DFHEIV0
 23393     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 23394     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 23395     MOVE X'2020233030303139363531' TO DFHEIV0(25:11)
 23396     CALL 'kxdfhei1' USING DFHEIV0,
 23397           PGM-NAME,
 23398           PROGRAM-INTERFACE-BLOCK,
 23399           PI-COMM-LENGTH
 23400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23401
 23402
 23403 9400-CLEAR.
 23404     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 23405     GO TO 9300-XCTL.
 23406
 23407 9500-PF12.
 23408     MOVE XCTL-EL010             TO PGM-NAME.
 23409     GO TO 9300-XCTL.
 23410
 23411 9600-PGMID-ERROR.
 23412
 23413* EXEC CICS HANDLE CONDITION
 23414*        PGMIDERR    (8300-SEND-TEXT)
 23415*    END-EXEC.
 23416*    MOVE '"$L                   ! Z #00019666' TO DFHEIV0
 23417     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 23418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23419     MOVE X'5A20233030303139363636' TO DFHEIV0(25:11)
 23420     CALL 'kxdfhei1' USING DFHEIV0
 23421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23422
 23423
 23424     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 23425     MOVE ' '                    TO PI-ENTRY-CD-1.
 23426     MOVE XCTL-EL005             TO PGM-NAME.
 23427     MOVE PGM-NAME               TO LOGOFF-PGM.
 23428     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 23429     GO TO 9300-XCTL.
 23430
 23431 9700-DATE-LINK.
 23432     MOVE LINK-ELDATCV           TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 438
* EL6311.cbl
 23433
 23434* EXEC CICS LINK
 23435*        PROGRAM    (PGM-NAME)
 23436*        COMMAREA   (DATE-CONVERSION-DATA)
 23437*        LENGTH     (DC-COMM-LENGTH)
 23438*    END-EXEC.
 23439*    MOVE '."C                   ''   #00019679' TO DFHEIV0
 23440     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23441     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23442     MOVE X'2020233030303139363739' TO DFHEIV0(25:11)
 23443     CALL 'kxdfhei1' USING DFHEIV0,
 23444           PGM-NAME,
 23445           DATE-CONVERSION-DATA,
 23446           DC-COMM-LENGTH,
 23447           DFHEIV99,
 23448           DFHEIV99,
 23449           DFHEIV99
 23450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23451
 23452
 23453 9800-LINK-PENDING-EDIT.
 23454     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 23455     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 23456
 23457     MOVE LINK-EL050             TO PGM-NAME
 23458     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 23459     MOVE ZEROS                  TO WK-CO-MAX-CAP
 23460                                    WK-CO-TOL-CLAIM
 23461                                    WK-CO-TOL-PREM
 23462                                    WK-CO-TOL-REFUND
 23463                                    WK-CO-TOL-PREM-PCT
 23464                                    WK-CO-TOL-REFUND-PCT
 23465                                    WK-REFUND-OVS-AMT
 23466                                    WK-REFUND-OVS-PCT
 23467                                    WK-ACCT-ADDR
 23468                                    WK-LIFE-EDIT-ADDR
 23469                                    WK-AH-EDIT-ADDR
 23470                                    WK-LIFE-BEN-ADDR
 23471                                    WK-AH-BEN-ADDR
 23472                                    WK-STATE-ADDR
 23473                                    WK-PLAN-ADDR
 23474                                    WK-FORM-ADDR
 23475     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 23476
 23477     MOVE '6'                    TO WK-ENTRY-SW.
 23478
 23479     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 23480
 23481     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 23482                                    EC-AM-EXPIRATION-DT
 23483                                    EC-AM-EFFECTIVE-DT
 23484                                    EC-CM-LF-CANCEL-DT
 23485                                    EC-CM-AH-CANCEL-DT
 23486                                    EC-CM-DEATH-DT.
 23487
 23488     MOVE ZEROS                  TO EC-CO-TOL-PREM
 23489                                    EC-CO-TOL-REFUND
 23490                                    EC-CO-MIN-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 439
* EL6311.cbl
 23491                                    EC-CO-MIN-PREMIUM
 23492                                    EC-CO-MIN-TERM
 23493                                    EC-CO-MAX-TERM
 23494                                    EC-ST-TOL-PREM
 23495                                    EC-ST-TOL-REFUND
 23496                                    EC-AM-LF-TOL-PREM
 23497                                    EC-AM-AH-TOL-PREM
 23498                                    EC-AM-LF-MAX-ATT-AGE
 23499                                    EC-AM-LF-MAX-AGE
 23500                                    EC-AM-LF-MAX-TERM
 23501                                    EC-AM-LF-MAX-TOT-BEN
 23502                                    EC-AM-AH-MAX-ATT-AGE
 23503                                    EC-AM-AH-MAX-AGE
 23504                                    EC-AM-AH-MAX-TERM
 23505                                    EC-AM-AH-MAX-TOT-BEN
 23506                                    EC-AM-AH-MAX-MON-BEN
 23507                                    EC-RT-LF-MAX-ATT-AGE
 23508                                    EC-RT-LF-MAX-AGE
 23509                                    EC-RT-LF-MAX-TERM
 23510                                    EC-RT-LF-MAX-TOT-BEN
 23511                                    EC-RT-AH-MAX-ATT-AGE
 23512                                    EC-RT-AH-MAX-AGE
 23513                                    EC-RT-AH-MAX-TERM
 23514                                    EC-RT-AH-MAX-TOT-BEN
 23515                                    EC-RT-AH-MAX-MON-BEN
 23516                                    EC-RT-AH-RATE
 23517                                    EC-RT-LF-RATE
 23518                                    EC-RT-LF-NSP-RATE
 23519                                    EC-RT-AH-NSP-RATE
 23520                                    EC-CM-LF-PRIOR-REFUND
 23521                                    EC-CM-AH-PRIOR-REFUND.
 23522
 23523     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 23524                                    EC-ST-TOL-PREM-PCT
 23525                                    EC-AM-LF-TOL-REFUND
 23526                                    EC-AM-LF-DEV-PERCENT
 23527                                    EC-CO-TOL-REFUND-PCT
 23528                                    EC-ST-TOL-REFUND-PCT
 23529                                    EC-AM-AH-TOL-REFUND
 23530                                    EC-AM-AH-DEV-PERCENT.
 23531
 23532
 23533* EXEC CICS LINK
 23534*         PROGRAM   (PGM-NAME)
 23535*         COMMAREA  (PASSED-RECORD)
 23536*         LENGTH    (WS-EDIT-PASS-LENGTH)
 23537*    END-EXEC.
 23538*    MOVE '."C                   ''   #00019764' TO DFHEIV0
 23539     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23540     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23541     MOVE X'2020233030303139373634' TO DFHEIV0(25:11)
 23542     CALL 'kxdfhei1' USING DFHEIV0,
 23543           PGM-NAME,
 23544           PASSED-RECORD,
 23545           WS-EDIT-PASS-LENGTH,
 23546           DFHEIV99,
 23547           DFHEIV99,
 23548           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 440
* EL6311.cbl
 23549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23550
 23551
 23552     MOVE '1'                    TO PI-EDIT-SW.
 23553     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 23554
 23555     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 23556
 23557     IF PI-COMPANY-ID = 'UCL'
 23558         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 23559
 23560     IF VALID-PB-ID
 23561        GO TO 9800-EXIT.
 23562
 23563     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 23564
 23565     IF PI-MAP-NAME = EL631B
 23566        MOVE -1                  TO BMAINTL
 23567       ELSE
 23568        MOVE -1                  TO CMAINTL.
 23569
 23570     GO TO 8200-SEND-DATAONLY.
 23571
 23572 9800-EXIT.
 23573      EXIT.
 23574
 23575 9900-ERROR-FORMAT.
 23576
 23577     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 23578
 23579     IF NOT EMI-ERRORS-COMPLETE
 23580         MOVE LINK-EL001         TO PGM-NAME
 23581
 23582* EXEC CICS LINK
 23583*            PROGRAM    (PGM-NAME)
 23584*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 23585*            LENGTH     (EMI-COMM-LENGTH)
 23586*        END-EXEC.
 23587*    MOVE '."C                   ''   #00019799' TO DFHEIV0
 23588     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23589     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23590     MOVE X'2020233030303139373939' TO DFHEIV0(25:11)
 23591     CALL 'kxdfhei1' USING DFHEIV0,
 23592           PGM-NAME,
 23593           ERROR-MESSAGE-INTERFACE-BLOCK,
 23594           EMI-COMM-LENGTH,
 23595           DFHEIV99,
 23596           DFHEIV99,
 23597           DFHEIV99
 23598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23599
 23600
 23601 9900-EXIT.
 23602     EXIT.
 23603
 23604 9990-ABEND.
 23605     MOVE LINK-EL004             TO PGM-NAME.
 23606     MOVE DFHEIBLK               TO EMI-LINE1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 441
* EL6311.cbl
 23607
 23608* EXEC CICS LINK
 23609*        PROGRAM   (PGM-NAME)
 23610*        COMMAREA  (EMI-LINE1)
 23611*        LENGTH    (72)
 23612*    END-EXEC.
 23613     MOVE 72
 23614       TO DFHEIV11
 23615*    MOVE '."C                   ''   #00019811' TO DFHEIV0
 23616     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23617     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23618     MOVE X'2020233030303139383131' TO DFHEIV0(25:11)
 23619     CALL 'kxdfhei1' USING DFHEIV0,
 23620           PGM-NAME,
 23621           EMI-LINE1,
 23622           DFHEIV11,
 23623           DFHEIV99,
 23624           DFHEIV99,
 23625           DFHEIV99
 23626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23627
 23628
 23629     IF PI-MAP-NAME = EL631B
 23630        MOVE -1                  TO BMAINTL
 23631       ELSE
 23632        MOVE -1                  TO CMAINTL.
 23633
 23634     IF EIBTRNID NOT = TRANS-EXB1
 23635        GO TO 8100-SEND-INITIAL-MAP
 23636       ELSE
 23637        GO TO 8200-SEND-DATAONLY.
 23638
 23639 9995-SECURITY-VIOLATION.
 23640*                            COPY ELCSCTP.
 23641******************************************************************
 23642*                                                                *
 23643*                            ELCSCTP                             *
 23644*                            VMOD=2.001                          *
 23645*                                                                *
 23646*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 23647******************************************************************
 23648
 23649
 23650     MOVE EIBDATE          TO SM-JUL-DATE.
 23651     MOVE EIBTRMID         TO SM-TERMID.
 23652     MOVE THIS-PGM         TO SM-PGM.
 23653     MOVE EIBTIME          TO TIME-IN.
 23654     MOVE TIME-OUT         TO SM-TIME.
 23655     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 23656
 23657
 23658* EXEC CICS LINK
 23659*         PROGRAM  ('EL003')
 23660*         COMMAREA (SECURITY-MESSAGE)
 23661*         LENGTH   (80)
 23662*    END-EXEC.
 23663     MOVE 'EL003' TO DFHEIV1
 23664     MOVE 80
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 442
* EL6311.cbl
 23665       TO DFHEIV11
 23666*    MOVE '."C                   ''   #00019845' TO DFHEIV0
 23667     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23668     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23669     MOVE X'2020233030303139383435' TO DFHEIV0(25:11)
 23670     CALL 'kxdfhei1' USING DFHEIV0,
 23671           DFHEIV1,
 23672           SECURITY-MESSAGE,
 23673           DFHEIV11,
 23674           DFHEIV99,
 23675           DFHEIV99,
 23676           DFHEIV99
 23677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23678
 23679
 23680******************************************************************
 23681
 23682
 23683 9999-DFHBACK SECTION.
 23684     MOVE '9%                    "   ' TO DFHEIV0
 23685     MOVE 'EL6311' TO DFHEIV1
 23686     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23687     GOBACK.
 23688 9999-DFHEXIT.
 23689     IF DFHEIGDJ EQUAL 0001
 23690         NEXT SENTENCE
 23691     ELSE IF DFHEIGDJ EQUAL 2
 23692         GO TO 9600-PGMID-ERROR,
 23693               9990-ABEND,
 23694               9990-ABEND,
 23695               0010-MAIN-LOGIC
 23696         DEPENDING ON DFHEIGDI
 23697     ELSE IF DFHEIGDJ EQUAL 3
 23698         GO TO 1280-BATCH-HDR-NOT-FOUND
 23699         DEPENDING ON DFHEIGDI
 23700     ELSE IF DFHEIGDJ EQUAL 4
 23701         GO TO 1290-DUPLICATE-ALT-INDEX
 23702         DEPENDING ON DFHEIGDI
 23703     ELSE IF DFHEIGDJ EQUAL 5
 23704         GO TO 1380-BATCH-HDR-NOT-FOUND
 23705         DEPENDING ON DFHEIGDI
 23706     ELSE IF DFHEIGDJ EQUAL 6
 23707         GO TO 1385-REC-NOT-FOUND
 23708         DEPENDING ON DFHEIGDI
 23709     ELSE IF DFHEIGDJ EQUAL 7
 23710         GO TO 1399-EXIT
 23711         DEPENDING ON DFHEIGDI
 23712     ELSE IF DFHEIGDJ EQUAL 8
 23713         GO TO 1480-BATCH-HDR-NOT-FOUND
 23714         DEPENDING ON DFHEIGDI
 23715     ELSE IF DFHEIGDJ EQUAL 9
 23716         GO TO 1490-RECORD-NOT-FOUND
 23717         DEPENDING ON DFHEIGDI
 23718     ELSE IF DFHEIGDJ EQUAL 10
 23719         GO TO 1405-DELETE-CERTIFICATE
 23720         DEPENDING ON DFHEIGDI
 23721     ELSE IF DFHEIGDJ EQUAL 11
 23722         GO TO 1420-CONTINUE-DELETE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 443
* EL6311.cbl
 23723         DEPENDING ON DFHEIGDI
 23724     ELSE IF DFHEIGDJ EQUAL 12
 23725         GO TO 1406-DELETE-ERNOTE
 23726         DEPENDING ON DFHEIGDI
 23727     ELSE IF DFHEIGDJ EQUAL 13
 23728         GO TO 1407-DELETE-MAILING
 23729         DEPENDING ON DFHEIGDI
 23730     ELSE IF DFHEIGDJ EQUAL 14
 23731         GO TO 1420-CONTINUE-DELETE
 23732         DEPENDING ON DFHEIGDI
 23733     ELSE IF DFHEIGDJ EQUAL 15
 23734         GO TO 1480-BATCH-HDR-NOT-FOUND
 23735         DEPENDING ON DFHEIGDI
 23736     ELSE IF DFHEIGDJ EQUAL 16
 23737         GO TO 1475-DELETE-FINISHED
 23738         DEPENDING ON DFHEIGDI
 23739     ELSE IF DFHEIGDJ EQUAL 17
 23740         GO TO 2280-BATCH-HDR-NOT-FOUND
 23741         DEPENDING ON DFHEIGDI
 23742     ELSE IF DFHEIGDJ EQUAL 18
 23743         GO TO 2290-DUPLICATE-ALT-INDEX
 23744         DEPENDING ON DFHEIGDI
 23745     ELSE IF DFHEIGDJ EQUAL 19
 23746         GO TO 2380-BATCH-HDR-NOT-FOUND
 23747         DEPENDING ON DFHEIGDI
 23748     ELSE IF DFHEIGDJ EQUAL 20
 23749         GO TO 2385-REC-NOT-FOUND
 23750         DEPENDING ON DFHEIGDI
 23751     ELSE IF DFHEIGDJ EQUAL 21
 23752         GO TO 2380-BATCH-HDR-NOT-FOUND
 23753         DEPENDING ON DFHEIGDI
 23754     ELSE IF DFHEIGDJ EQUAL 22
 23755         GO TO 2485-BATCH-HDR-NOT-FOUND
 23756         DEPENDING ON DFHEIGDI
 23757     ELSE IF DFHEIGDJ EQUAL 23
 23758         GO TO 2490-RECORD-NOT-FOUND
 23759         DEPENDING ON DFHEIGDI
 23760     ELSE IF DFHEIGDJ EQUAL 24
 23761         GO TO 2475-CONTINUE-DELETE
 23762         DEPENDING ON DFHEIGDI
 23763     ELSE IF DFHEIGDJ EQUAL 25
 23764         GO TO 2485-BATCH-HDR-NOT-FOUND
 23765         DEPENDING ON DFHEIGDI
 23766     ELSE IF DFHEIGDJ EQUAL 26
 23767         GO TO 2480-DELETE-FINISHED
 23768         DEPENDING ON DFHEIGDI
 23769     ELSE IF DFHEIGDJ EQUAL 27
 23770         GO TO 2820-PROCESS-REWRITE
 23771         DEPENDING ON DFHEIGDI
 23772     ELSE IF DFHEIGDJ EQUAL 28
 23773         GO TO 2885-RECORD-MISSING
 23774         DEPENDING ON DFHEIGDI
 23775     ELSE IF DFHEIGDJ EQUAL 29
 23776         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 23777         DEPENDING ON DFHEIGDI
 23778     ELSE IF DFHEIGDJ EQUAL 30
 23779         GO TO 2827-DELETE-MAILING
 23780         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 444
* EL6311.cbl
 23781     ELSE IF DFHEIGDJ EQUAL 31
 23782         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 23783         DEPENDING ON DFHEIGDI
 23784     ELSE IF DFHEIGDJ EQUAL 32
 23785         GO TO 2920-PROCESS-REWRITE
 23786         DEPENDING ON DFHEIGDI
 23787     ELSE IF DFHEIGDJ EQUAL 33
 23788         GO TO 2985-RECORD-MISSING
 23789         DEPENDING ON DFHEIGDI
 23790     ELSE IF DFHEIGDJ EQUAL 34
 23791         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 23792         DEPENDING ON DFHEIGDI
 23793     ELSE IF DFHEIGDJ EQUAL 35
 23794         GO TO 2990-DUPLICATE-RECORD
 23795         DEPENDING ON DFHEIGDI
 23796     ELSE IF DFHEIGDJ EQUAL 36
 23797         GO TO 3590-NOT-FOUND
 23798         DEPENDING ON DFHEIGDI
 23799     ELSE IF DFHEIGDJ EQUAL 37
 23800         GO TO 3690-NOT-FOUND
 23801         DEPENDING ON DFHEIGDI
 23802     ELSE IF DFHEIGDJ EQUAL 38
 23803         GO TO 3990-NOT-FOUND
 23804         DEPENDING ON DFHEIGDI
 23805     ELSE IF DFHEIGDJ EQUAL 39
 23806         GO TO 4050-END-RECORDS,
 23807               4050-END-RECORDS
 23808         DEPENDING ON DFHEIGDI
 23809     ELSE IF DFHEIGDJ EQUAL 40
 23810         GO TO 4150-END-BATCH
 23811         DEPENDING ON DFHEIGDI
 23812     ELSE IF DFHEIGDJ EQUAL 41
 23813         GO TO 4150-END-BATCH
 23814         DEPENDING ON DFHEIGDI
 23815     ELSE IF DFHEIGDJ EQUAL 42
 23816         GO TO 4250-END-RECORDS,
 23817               4250-END-RECORDS
 23818         DEPENDING ON DFHEIGDI
 23819     ELSE IF DFHEIGDJ EQUAL 43
 23820         GO TO 4350-END-BATCH,
 23821               4350-END-BATCH
 23822         DEPENDING ON DFHEIGDI
 23823     ELSE IF DFHEIGDJ EQUAL 44
 23824         GO TO 4570-NOT-FOUND,
 23825               4550-END-RECORDS
 23826         DEPENDING ON DFHEIGDI
 23827     ELSE IF DFHEIGDJ EQUAL 45
 23828         GO TO 4680-NOT-FOUND,
 23829               4680-NOT-FOUND
 23830         DEPENDING ON DFHEIGDI
 23831     ELSE IF DFHEIGDJ EQUAL 46
 23832         GO TO 4860-NOT-FOUND,
 23833               4850-END-RECORDS
 23834         DEPENDING ON DFHEIGDI
 23835     ELSE IF DFHEIGDJ EQUAL 47
 23836         GO TO 4970-NOT-FOUND,
 23837               4950-END-RECORDS
 23838         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 445
* EL6311.cbl
 23839     ELSE IF DFHEIGDJ EQUAL 48
 23840         GO TO 5050-NOT-FOUND
 23841         DEPENDING ON DFHEIGDI
 23842     ELSE IF DFHEIGDJ EQUAL 49
 23843         GO TO 5050-NOT-FOUND
 23844         DEPENDING ON DFHEIGDI
 23845     ELSE IF DFHEIGDJ EQUAL 50
 23846         GO TO 5050-NOT-FOUND
 23847         DEPENDING ON DFHEIGDI
 23848     ELSE IF DFHEIGDJ EQUAL 51
 23849         GO TO 5550-END-RECORDS,
 23850               5550-END-RECORDS
 23851         DEPENDING ON DFHEIGDI
 23852     ELSE IF DFHEIGDJ EQUAL 52
 23853         GO TO 6050-QID-ERROR
 23854         DEPENDING ON DFHEIGDI
 23855     ELSE IF DFHEIGDJ EQUAL 53
 23856         GO TO 6050-QID-ERROR
 23857         DEPENDING ON DFHEIGDI
 23858     ELSE IF DFHEIGDJ EQUAL 54
 23859         GO TO 6400-CONTINUE,
 23860               6400-CONTINUE
 23861         DEPENDING ON DFHEIGDI
 23862     ELSE IF DFHEIGDJ EQUAL 55
 23863         GO TO 3690-NOT-FOUND
 23864         DEPENDING ON DFHEIGDI
 23865     ELSE IF DFHEIGDJ EQUAL 56
 23866         GO TO 7399-EXIT
 23867         DEPENDING ON DFHEIGDI
 23868     ELSE IF DFHEIGDJ EQUAL 57
 23869         GO TO 7550-OFFICER-NOTFND
 23870         DEPENDING ON DFHEIGDI
 23871     ELSE IF DFHEIGDJ EQUAL 58
 23872         GO TO 8300-SEND-TEXT
 23873         DEPENDING ON DFHEIGDI.
 23874     MOVE '9%                    "   ' TO DFHEIV0
 23875     MOVE 'EL6311' TO DFHEIV1
 23876     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23877     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       19684     Code:       94747
