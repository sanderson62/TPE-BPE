* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    43******************************************************************
    44
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page   3
* EL130.cbl
    46 ENVIRONMENT DIVISION.
    47 DATA DIVISION.
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    53 77  A1                          PIC S999 COMP-3 VALUE +0.
    54 77  E1                          PIC S999 COMP-3 VALUE +0.
    55 77  s1                          pic s999 comp-3 value +0.
    56 77  s2                          pic s999 comp-3 value +0.
    57 77  P1                          PIC S999 COMP-3 VALUE +0.
    58 77  P2                          PIC S999 COMP-3 VALUE +0.
    59 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    60 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    61 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    62 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    63 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    64 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    65 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    66 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    67     88  ERPDEF-FOUND                 VALUE 'Y'.
    68 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    69 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    70 77  ws-dcc-product-code         pic xxx value spaces.
    71 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    72 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    73 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    74 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    75 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    76 77  ws-zero-bens-avail          pic x value ' '.
    77*    COPY ELCSCTM.
    78******************************************************************
    79*                                                                *
    80*                                                                *
    81*                            ELCSCTM                             *
    82*                            VMOD=2.001                          *
    83*                                                                *
    84*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    85*                                                                *
    86******************************************************************
    87 01  SECURITY-MESSAGE.
    88     12  FILLER                          PIC X(30)
    89            VALUE '** LOGIC SECURITY VIOLATION -'.
    90     12  SM-READ                         PIC X(6).
    91     12  FILLER                          PIC X(5)
    92            VALUE ' PGM='.
    93     12  SM-PGM                          PIC X(6).
    94     12  FILLER                          PIC X(5)
    95            VALUE ' OPR='.
    96     12  SM-PROCESSOR-ID                 PIC X(4).
    97     12  FILLER                          PIC X(6)
    98            VALUE ' TERM='.
    99     12  SM-TERMID                       PIC X(4).
   100     12  FILLER                          PIC XX   VALUE SPACE.
   101     12  SM-JUL-DATE                     PIC 9(5).
   102     12  FILLER                          PIC X    VALUE SPACE.
   103     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page   4
* EL130.cbl
   104
   105
   106*    COPY ELCSCRTY.
   107******************************************************************
   108*                                                                *
   109*                                                                *
   110*                            ELCSCRTY                            *
   111*                            VMOD=2.001                          *
   112*                                                                *
   113*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   114*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   115*        SAVED IN PI-SECURITY-ADDRESS.                           *
   116*                                                                *
   117******************************************************************
   118 01  SECURITY-CONTROL.
   119     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   120     12  FILLER                       PIC XX    VALUE 'SC'.
   121     12  SC-CREDIT-CODES.
   122         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   123             20  SC-CREDIT-DISPLAY    PIC X.
   124             20  SC-CREDIT-UPDATE     PIC X.
   125     12  SC-CLAIMS-CODES.
   126         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   127             20  SC-CLAIMS-DISPLAY    PIC X.
   128             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page   5
* EL130.cbl
   130 01  WS-DATE-AREA.
   131     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   132     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   133     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   134
   135 01  ws-dcc-error-line.
   136     05  filler occurs 15.
   137         10  ws-error-no        pic x(4).
   138 01  WS-CRI-SSN-WORK-AREA.
   139     05  WS-CRI-SOC-SEC-NO.
   140         10  WS-SS-REPT-CD       PIC X(5).
   141         10  WS-SS-LAST-NAME     PIC X(5).
   142         10  WS-SS-INITIAL       PIC X.
   143
   144     05  WS-CRI-REPORT-CODE.
   145         10  FILLER              PIC X(5).
   146         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   147
   148     05  WS-CRI-LAST-NAME.
   149         10  WS-CRI-NAME-MOVE    PIC X(5).
   150         10  FILLER              PIC X(10).
   151
   152 01  STANDARD-AREAS.
   153     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   154     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   155     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   156     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   157     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   158     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   159     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   160     12  PGM-NAME            PIC X(8).
   161     12  TIME-IN             PIC S9(7).
   162     12  TIME-OUT-R  REDEFINES TIME-IN.
   163         16  FILLER          PIC X.
   164         16  TIME-OUT        PIC 99V99.
   165         16  FILLER          PIC X(2).
   166     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   167     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   168     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   169     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   170     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   171     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   172     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   173     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   174     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   175     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   176     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   177     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   178     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   179     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   180     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   181     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   182     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   183     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   184     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   185     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   186     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   187     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page   6
* EL130.cbl
   188     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   189     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   190     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   191     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   192     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   193     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   194     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   195     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   196     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   197     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   198     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   199     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   200     12  FILE-ID             PIC X(8).
   201     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   202     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   203     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   204     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   205     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   206     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   207     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   208     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   209     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   210
   211 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   212     12  M                   PIC S9(7)V99           VALUE ZEROS.
   213     12  L                   PIC S9(7)V99           VALUE ZEROS.
   214     12  N                   PIC S9(3)              VALUE ZEROS.
   215     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   216     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   217     12  I                   PIC S99V9(5)           VALUE ZEROS.
   218     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   219     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   220     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   221     12  R                   PIC S9(3)              VALUE ZEROS.
   222     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   223     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   224     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   225     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   226     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   227     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   228     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   229     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   230     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   231
   232 01  TERM-CALC-WORK-AREA.
   233     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   234     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   235     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   236     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   237     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   238     12  V-EXPONENTS.
   239        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   240     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   241
   242 01  MISC-WORK-AREAS.
   243     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   244     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   245     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page   7
* EL130.cbl
   246     12  QID.
   247         16  QID-TERM        PIC X(4).
   248         16  FILLER          PIC X(4)    VALUE '130A'.
   249     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   250     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   251     12  WS-GROUP-NO.
   252         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   253         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   254
   255     12  WS-RESPONSE         PIC S9(8)   COMP.
   256         88  WS-RESP-NORMAL              VALUE +00.
   257         88  WS-RESP-ERROR               VALUE +01.
   258         88  WS-RESP-NOTFND              VALUE +13.
   259         88  WS-RESP-DUPKEY              VALUE +15.
   260         88  WS-RESP-NOTOPEN             VALUE +19.
   261         88  WS-RESP-ENDFILE             VALUE +20.
   262
   263***************************************************************
   264*                                                             *
   265*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   266*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   267*    CHANGES WITH IN MAP EL130A.                              *
   268*                                                             *
   269***************************************************************
   270
   271     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   272     12  WS-SAVE-CLAIM-MASTER.
   273         16  FILLER                    PIC XX.
   274         16  WS-SAVE-CLAIM-KEY.
   275             20  WS-SAVE-COMPANY-CD    PIC X.
   276             20  WS-SAVE-CARRIER       PIC X.
   277             20  WS-SAVE-CLAIM-NO      PIC X(7).
   278             20  WS-SAVE-CERT-NO       PIC X(11).
   279         16  FILLER                    PIC X(328).
   280     12  SAVE-CURRENT-DATE         PIC XX.
   281     12  SAVE-CONTROL              PIC X(39).
   282     12  SAVE-ERACCT-KEY           PIC X(26).
   283     12  SAVE-COUNTER              PIC S9(8)   COMP.
   284     12  SAVE-METHOD               PIC X.
   285     12  SAVE-COMPANY-ID           PIC XXX.
   286     12  SAVE-COMPANY-CD           PIC X.
   287     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   288     12  SAVE-CREDIT-USER          PIC X.
   289     12  SAVE-CLAIM-USER           PIC X.
   290     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   291     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   292     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   293     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   294     12  SAVE-AH-OVERRIDE-L1       PIC X.
   295     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   296     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   297     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   298     12  FILLER                    PIC X.
   299*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   300     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   301     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   302     12  SAVE-EL127-TO-EL130-CNTRL.
   303         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page   8
* EL130.cbl
   304         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   305         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   306             20  SAVE-EL127-CARRIER  PIC X.
   307             20  SAVE-EL127-GROUPING PIC X(6).
   308             20  SAVE-EL127-STATE    PIC X(2).
   309             20  SAVE-EL127-ACCOUNT  PIC X(10).
   310             20  SAVE-EL127-CERT-NO  PIC X(11).
   311             20  SAVE-EL127-EFF-DT   PIC XX.
   312     12  SAVE-EL659-TO-EL130-CNTRL.
   313         16  SAVE-EL659-CARRIER    PIC X.
   314         16  SAVE-EL659-GROUPING   PIC X(6).
   315         16  SAVE-EL659-STATE      PIC XX.
   316         16  SAVE-EL659-ACCOUNT    PIC X(10).
   317     12  DIVIDE-QUOT               PIC 999.
   318     12  DIVIDE-REM                PIC 999.
   319     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   320     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   321     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   322     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   323     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   324     12  WS-RESERVE-CONTROLS       PIC X(9).
   325     12  WS-EXPENSE-CONTROLS       PIC X(7).
   326     12  WS-REIN-TABLE.
   327         16  WS-REIN-1             PIC X            VALUE SPACE.
   328         16  WS-REIN-2             PIC X            VALUE SPACE.
   329         16  WS-REIN-3             PIC X            VALUE SPACE.
   330     12  WS-BENE-CALC-METHOD       PIC X.
   331     12  ws-lf-joint-indicator     pic x.
   332     12  ws-ah-joint-indicator     pic x.
   333     12  WS-EARNINGS-CALC          PIC X.
   334     12  WS-LF-EARNINGS-CALC       PIC X.
   335         88 TEX-REG                VALUE '4'.
   336         88 NET-PAY                VALUE '5'.
   337     12  WS-AH-EARNINGS-CALC       PIC X.
   338     12  WS-SPECIAL-CALC-CD        PIC X(01).
   339     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   340     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   341     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   342     12  WS-ICD-CODE-1             PIC X(8).
   343     12  WS-ICD-CODE-2             PIC X(8).
   344     12  WS-CLAIM-NUMBER.
   345         16  WS-CN-PREFIX.
   346             20  WS-CN-PRF-A PIC X.
   347             20  WS-CN-PRF-B PIC X.
   348         16  WS-CN-NUMBER    PIC 9(5).
   349     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   350     12  WS-CLAIM-SEQU.
   351         16  FILLER          PIC X    VALUE '('.
   352         16  WS-CURRENT-SEQU PIC Z9.
   353         16  FILLER          PIC X(4) VALUE ' OF '.
   354         16  WS-OF-SEQU      PIC Z9.
   355         16  FILLER          PIC X    VALUE ')'.
   356     12  DATE-WORK.
   357       14  FILLER                PIC XX.
   358       14  DATE-MM               PIC XX.
   359       14  DATE-DD               PIC XX.
   360       14  DATE-YY               PIC XX.
   361     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page   9
* EL130.cbl
   362         16  CURR-MM.
   363           18  CURR-M1           PIC 9.
   364           18  CURR-M2           PIC 9.
   365         16  FILLER              PIC X(5).
   366         16  CURR-YEAR           PIC 9.
   367     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   368     12  SUB                     PIC 99.
   369     12  MY-DATE.
   370         16  MY-MM               PIC XX.
   371         16  FILLER              PIC X VALUE '/'.
   372         16  MY-YY               PIC XX.
   373
   374     12  WS-EDIT-BEN-CODE        PIC XX.
   375         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   376                                          '90' THRU '99'.
   377
   378     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   379     12  WS-BEN-HOLD             PIC XX.
   380     12  WS-BEN-ALPHA-HOLD.
   381         15  WS-BEN-ALPHA-2      PIC XX.
   382         15  WS-BEN-ALPHA-1      PIC X.
   383     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   384     12  WS-REC-TYPE             PIC X.
   385     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   386     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   387     12  ARCH-NUMBER             PIC S9(8)   COMP.
   388     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   389         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   390         88  REIN-REC-FOUND                  VALUE 'Y'.
   391
   392     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   393     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   394
   395
   396 01  CSO-WORK-FIELDS.
   397     12  WS-BLANK            PIC X       VALUE ' '.
   398
   399     12  WS-MA-CONTROL-PRIMARY.
   400         16  WS-MA-COMPANY-CD        PIC  X.
   401         16  WS-MA-CARRIER           PIC  X.
   402         16  WS-MA-GROUPING          PIC  X(6).
   403         16  WS-MA-STATE             PIC  XX.
   404         16  WS-MA-ACCOUNT           PIC  X(10).
   405         16  WS-MA-CERT-EFF-DT       PIC  XX.
   406         16  WS-MA-CERT-NO.
   407             20  WS-MA-CERT-PRIME    PIC  X(10).
   408             20  WS-MA-CERT-SFX      PIC  X.
   409
   410     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   411     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   412     12  WS-SOC-SEC-NUMBER.
   413         16  WS-SOC-SEC-NO       PIC 9(9).
   414         16  WS-SOC-SEC-BLANK    PIC X(2).
   415     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   416         16  WS-SSN-1-3          PIC 9(3).
   417         16  WS-SSN-DASH1        PIC X(1).
   418         16  WS-SSN-4-5          PIC 9(2).
   419         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  10
* EL130.cbl
   420         16  WS-SSN-6-9          PIC 9(4).
   421
   422     12  WS-DIAG-VIN-MSG.
   423         16  FILLER          PIC X(11)
   424             VALUE 'VIN NUMBER '.
   425         16  WS-DIAG-VIN     PIC X(17).
   426
   427     12  WS-VERIFY-NOTE      PIC X(34)
   428         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   429
   430     12  WS-CAUSAL-NOTE      PIC X(40)
   431         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   432
   433     12  WS-VFY-SSN-NOTE     PIC X(25)
   434         VALUE 'SSN VERIFICATION REQUIRED'.
   435
   436 01  MAP-DATE-AREAS.
   437     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   438     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   439     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   440     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   441     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   442     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   443     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   444     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   445     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   446     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   447     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   448     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   449     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   450     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   451     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   452     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   453     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   454     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   455     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   456         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   457     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   458     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   459     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   460     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   461
   462 01  ACCESS-KEYS.
   463     12  ELACTQ-KEY.
   464         16  ELACTQ-COMPANY-CD       PIC X.
   465         16  ELACTQ-CARRIER          PIC X.
   466         16  ELACTQ-CLAIM-NO         PIC X(7).
   467         16  ELACTQ-CERT-NO          PIC X(11).
   468     12  ELMSTR-KEY.
   469         16  MSTR-COMP-CD            PIC X.
   470         16  MSTR-CARRIER            PIC X.
   471         16  MSTR-CLAIM-NO           PIC X(7).
   472         16  MSTR-CERT-NO.
   473             20  MSTR-CERT-NO-PRIME  PIC X(10).
   474             20  MSTR-CERT-NO-SUFX   PIC X.
   475     12  SAVE-ELMSTR-KEY.
   476         16  SAVE-COMP-CD            PIC X.
   477         16  SAVE-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  11
* EL130.cbl
   478         16  SAVE-CLAIM-NO           PIC X(7).
   479         16  SAVE-CERT-NO.
   480             20  SAVE-CERT-NO-PRIME  PIC X(10).
   481             20  SAVE-CERT-NO-SUFX   PIC X.
   482     12  ELMSTR5-KEY.
   483         16  MSTR5-COMP-CD           PIC X.
   484         16  MSTR5-CERT-NO.
   485             20  MSTR5-CERT-NO-PRIME PIC X(10).
   486             20  MSTR5-CERT-NO-SUFX  PIC X.
   487     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   488         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   489         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   490         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   491     12  ELCNTL-KEY.
   492         16  CNTL-COMP-ID    PIC X(3).
   493         16  CNTL-REC-TYPE   PIC X.
   494         16  CNTL-ACCESS.
   495             20  FILLER      PIC XX.
   496             20  CNTL-BENEFIT.
   497                 24  FILLER  PIC X.
   498                 24  CNTL-CARRIER PIC X.
   499         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   500     12  ELCERT-KEY.
   501         16  CERT-COMP-CD    PIC X.
   502         16  CERT-CARRIER    PIC X.
   503         16  CERT-GROUPING   PIC X(6).
   504         16  CERT-STATE      PIC X(2).
   505         16  CERT-ACCOUNT.
   506             20  CERT-ACCOUNT-PREFIX PIC X(4).
   507             20  CERT-ACCOUNT-PRIME  PIC X(6).
   508         16  CERT-EFF-DT     PIC XX.
   509         16  CERT-CERT-NO.
   510             20  CERT-CERT-NO-PRIME  PIC X(10).
   511             20  CERT-CERT-NO-SUFX   PIC X.
   512     12  ELCERT-KEY-5.
   513         16  CERT-COMP-CD-5      PIC X.
   514         16  CERT-CERT-5.
   515             20  CERT-CERT-5-PRIME   PIC X(10).
   516             20  CERT-CERT-5-SUFX    PIC X.
   517     12  ERACCT-KEY.
   518         16  ACCT-COMP-CD    PIC X.
   519         16  ACCT-CARRIER    PIC X.
   520         16  ACCT-GROUPING   PIC X(6).
   521         16  ACCT-STATE      PIC X(2).
   522         16  ACCT-ACCOUNT    PIC X(10).
   523         16  ACCT-EXP-DT     PIC XX.
   524     12  ELTRLR-KEY.
   525         16  TRLR-COMP-CD    PIC X.
   526         16  TRLR-CARRIER    PIC X.
   527         16  TRLR-CLAIM-NO   PIC X(7).
   528         16  TRLR-CERT-NO.
   529             20  TRLR-CERT-NO-PRIME  PIC X(10).
   530             20  TRLR-CERT-NO-SUFX   PIC X.
   531         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   532         16  TRLR-TYPE       PIC X.
   533     12  ELBENE-KEY.
   534         16  BENE-COMP-CD    PIC X.
   535         16  BENE-RCD-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  12
* EL130.cbl
   536         16  BENE-CODE       PIC X(10).
   537     12  ERREIN-KEY.
   538         16  REIN-COMP-CD        PIC X(01).
   539         16  REIN-TYPE           PIC X(01).
   540         16  REIN-TABLE-CO.
   541             20  REIN-CODE-1     PIC X(01).
   542             20  REIN-CODE-2     PIC X(01).
   543             20  REIN-CODE-3     PIC X(01).
   544         16  FILLER              PIC X(03).
   545     12  ELCRTT-KEY.
   546         16  CTRLR-COMP-CD       PIC X.
   547         16  CTRLR-CARRIER       PIC X.
   548         16  CTRLR-GROUPING      PIC X(6).
   549         16  CTRLR-STATE         PIC X(2).
   550         16  CTRLR-ACCOUNT       PIC X(10).
   551         16  CTRLR-EFF-DT        PIC XX.
   552         16  CTRLR-CERT-NO       PIC X(11).
   553         16  CTRLR-REC-TYPE      PIC X.
   554 01  ws-acct-found-sw            pic x value ' '.
   555     88  acct-found                value 'Y'.
   556 01  ERPDEF-KEY-SAVE             PIC X(18).
   557 01  ERPDEF-KEY.
   558     12  ERPDEF-COMPANY-CD       PIC X.
   559     12  ERPDEF-STATE            PIC XX.
   560     12  ERPDEF-PROD-CD          PIC XXX.
   561     12  F                       PIC X(7).
   562     12  ERPDEF-BEN-TYPE         PIC X.
   563     12  ERPDEF-BEN-CODE         PIC XX.
   564     12  ERPDEF-EXP-DT           PIC XX.
   565 01  ERROR-MESSAGES.
   566     12  ER-0000                 PIC X(4)  VALUE '0000'.
   567     12  ER-0004                 PIC X(4)  VALUE '0004'.
   568     12  ER-0019                 PIC X(4)  VALUE '0019'.
   569     12  ER-0023                 PIC X(4)  VALUE '0023'.
   570     12  ER-0029                 PIC X(4)  VALUE '0029'.
   571     12  ER-0033                 PIC X(4)  VALUE '0033'.
   572     12  ER-0068                 PIC X(4)  VALUE '0068'.
   573     12  ER-0070                 PIC X(4)  VALUE '0070'.
   574     12  ER-0194                 PIC X(4)  VALUE '0194'.
   575     12  ER-0202                 PIC X(4)  VALUE '0202'.
   576     12  ER-0203                 PIC X(4)  VALUE '0203'.
   577     12  ER-0204                 PIC X(4)  VALUE '0204'.
   578     12  ER-0205                 PIC X(4)  VALUE '0205'.
   579     12  ER-0206                 PIC X(4)  VALUE '0206'.
   580     12  ER-0207                 PIC X(4)  VALUE '0207'.
   581     12  ER-0213                 PIC X(4)  VALUE '0213'.
   582     12  ER-0214                 PIC X(4)  VALUE '0214'.
   583     12  ER-0217                 PIC X(4)  VALUE '0217'.
   584     12  ER-0219                 PIC X(4)  VALUE '0219'.
   585     12  ER-0220                 PIC X(4)  VALUE '0220'.
   586     12  ER-0221                 PIC X(4)  VALUE '0221'.
   587     12  ER-0222                 PIC X(4)  VALUE '0222'.
   588     12  ER-0223                 PIC X(4)  VALUE '0223'.
   589     12  ER-0224                 PIC X(4)  VALUE '0224'.
   590     12  ER-0225                 PIC X(4)  VALUE '0225'.
   591     12  ER-0226                 PIC X(4)  VALUE '0226'.
   592     12  ER-0227                 PIC X(4)  VALUE '0227'.
   593     12  ER-0229                 PIC X(4)  VALUE '0229'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  13
* EL130.cbl
   594     12  ER-0230                 PIC X(4)  VALUE '0230'.
   595     12  ER-0231                 PIC X(4)  VALUE '0231'.
   596     12  ER-0232                 PIC X(4)  VALUE '0232'.
   597     12  ER-0233                 PIC X(4)  VALUE '0233'.
   598     12  ER-0234                 PIC X(4)  VALUE '0234'.
   599     12  ER-0235                 PIC X(4)  VALUE '0235'.
   600     12  ER-0236                 PIC X(4)  VALUE '0236'.
   601     12  ER-0237                 PIC X(4)  VALUE '0237'.
   602     12  ER-0238                 PIC X(4)  VALUE '0238'.
   603     12  ER-0239                 PIC X(4)  VALUE '0239'.
   604     12  ER-0240                 PIC X(4)  VALUE '0240'.
   605     12  ER-0241                 PIC X(4)  VALUE '0241'.
   606     12  ER-0243                 PIC X(4)  VALUE '0243'.
   607     12  ER-0244                 PIC X(4)  VALUE '0244'.
   608     12  ER-0245                 PIC X(4)  VALUE '0245'.
   609     12  ER-0246                 PIC X(4)  VALUE '0246'.
   610     12  ER-0247                 PIC X(4)  VALUE '0247'.
   611     12  ER-0248                 PIC X(4)  VALUE '0248'.
   612     12  ER-0250                 PIC X(4)  VALUE '0250'.
   613     12  ER-0251                 PIC X(4)  VALUE '0251'.
   614     12  ER-0252                 PIC X(4)  VALUE '0252'.
   615     12  ER-0253                 PIC X(4)  VALUE '0253'.
   616     12  ER-0254                 PIC X(4)  VALUE '0254'.
   617     12  ER-0257                 PIC X(4)  VALUE '0257'.
   618     12  ER-0258                 PIC X(4)  VALUE '0258'.
   619     12  ER-0260                 PIC X(4)  VALUE '0260'.
   620     12  ER-0261                 PIC X(4)  VALUE '0261'.
   621     12  ER-0263                 PIC X(4)  VALUE '0263'.
   622     12  ER-0264                 PIC X(4)  VALUE '0264'.
   623     12  ER-0265                 PIC X(4)  VALUE '0265'.
   624     12  ER-0266                 PIC X(4)  VALUE '0266'.
   625     12  ER-0267                 PIC X(4)  VALUE '0267'.
   626     12  ER-0334                 PIC X(4)  VALUE '0334'.
   627     12  ER-0337                 PIC X(4)  VALUE '0337'.
   628     12  ER-0412                 PIC X(4)  VALUE '0412'.
   629     12  ER-0413                 PIC X(4)  VALUE '0413'.
   630     12  ER-0428                 PIC X(4)  VALUE '0428'.
   631     12  ER-0429                 PIC X(4)  VALUE '0429'.
   632     12  ER-0430                 PIC X(4)  VALUE '0430'.
   633     12  ER-0433                 PIC X(4)  VALUE '0433'.
   634     12  ER-0434                 PIC X(4)  VALUE '0434'.
   635     12  ER-0458                 PIC X(4)  VALUE '0458'.
   636     12  ER-0489                 PIC X(4)  VALUE '0489'.
   637     12  ER-0509                 PIC X(4)  VALUE '0509'.
   638     12  ER-0510                 PIC X(4)  VALUE '0510'.
   639     12  ER-0511                 PIC X(4)  VALUE '0511'.
   640     12  ER-0512                 PIC X(4)  VALUE '0512'.
   641     12  ER-0516                 PIC X(4)  VALUE '0516'.
   642     12  ER-0517                 PIC X(4)  VALUE '0517'.
   643     12  ER-0518                 PIC X(4)  VALUE '0518'.
   644     12  ER-0519                 PIC X(4)  VALUE '0519'.
   645     12  ER-0520                 PIC X(4)  VALUE '0520'.
   646     12  ER-0521                 PIC X(4)  VALUE '0521'.
   647     12  ER-0522                 PIC X(4)  VALUE '0522'.
   648     12  ER-0523                 PIC X(4)  VALUE '0523'.
   649     12  ER-0544                 PIC X(4)  VALUE '0544'.
   650     12  ER-0546                 PIC X(4)  VALUE '0546'.
   651     12  ER-0558                 PIC X(4)  VALUE '0558'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  14
* EL130.cbl
   652     12  ER-0560                 PIC X(4)  VALUE '0560'.
   653     12  ER-0562                 PIC X(4)  VALUE '0562'.
   654     12  ER-0565                 PIC X(4)  VALUE '0565'.
   655     12  ER-0569                 PIC X(4)  VALUE '0569'.
   656     12  ER-0693                 PIC X(4)  VALUE '0693'.
   657     12  ER-0715                 PIC X(4)  VALUE '0715'.
   658     12  ER-0840                 PIC X(4)  VALUE '0840'.
   659     12  ER-0841                 PIC X(4)  VALUE '0841'.
   660     12  ER-0842                 PIC X(4)  VALUE '0842'.
   661     12  ER-0843                 PIC X(4)  VALUE '0843'.
   662     12  ER-0878                 PIC X(4)  VALUE '0878'.
   663     12  ER-0887                 PIC X(4)  VALUE '0887'.
   664     12  ER-0992                 PIC X(4)  VALUE '0992'.
   665     12  ER-1651                 PIC X(4)  VALUE '1651'.
   666     12  ER-1652                 PIC X(4)  VALUE '1652'.
   667     12  ER-1653                 PIC X(4)  VALUE '1653'.
   668     12  ER-1654                 PIC X(4)  VALUE '1654'.
   669     12  ER-1655                 PIC X(4)  VALUE '1655'.
   670     12  er-1659                 pic x(4)  value '1659'.
   671     12  er-1660                 pic x(4)  value '1660'.
   672     12  er-1661                 pic x(4)  value '1661'.
   673     12  er-1671                 pic x(4)  value '1671'.
   674     12  er-1672                 pic x(4)  value '1672'.
   675     12  er-1673                 pic x(4)  value '1673'.
   676     12  er-1675                 pic x(4)  value '1675'.
   677     12  er-1676                 pic x(4)  value '1676'.
   678     12  ER-2280                 PIC X(4)  VALUE '2280'.
   679     12  ER-2370                 PIC X(4)  VALUE '2370'.
   680     12  ER-2371                 PIC X(4)  VALUE '2371'.
   681     12  ER-2378                 PIC X(4)  VALUE '2378'.
   682     12  ER-2380                 PIC X(4)  VALUE '2380'.
   683     12  ER-2566                 PIC X(4)  VALUE '2566'.
   684     12  ER-2848                 PIC X(4)  VALUE '2848'.
   685     12  ER-3548                 PIC X(4)  VALUE '3548'.
   686     12  ER-7008                 PIC X(4)  VALUE '7008'.
   687     12  ER-7319                 PIC X(4)  VALUE '7319'.
   688     12  ER-7321                 PIC X(4)  VALUE '7321'.
   689     12  ER-7352                 PIC X(4)  VALUE '7352'.
   690     12  ER-7353                 PIC X(4)  VALUE '7353'.
   691     12  ER-7575                 PIC X(4)  VALUE '7575'.
   692     12  ER-7577                 PIC X(4)  VALUE '7577'.
   693     12  ER-7582                 PIC X(4)  VALUE '7582'.
   694     12  ER-7634                 PIC X(4)  VALUE '7634'.
   695     12  ER-7635                 PIC X(4)  VALUE '7635'.
   696     12  ER-7636                 PIC X(4)  VALUE '7636'.
   697     12  ER-7637                 PIC X(4)  VALUE '7637'.
   698     12  ER-7638                 PIC X(4)  VALUE '7638'.
   699     12  ER-7639                 PIC X(4)  VALUE '7639'.
   700     12  ER-7640                 PIC X(4)  VALUE '7640'.
   701     12  ER-7641                 PIC X(4)  VALUE '7641'.
   702     12  ER-7642                 PIC X(4)  VALUE '7642'.
   703     12  ER-7643                 PIC X(4)  VALUE '7643'.
   704     12  ER-7646                 PIC X(4)  VALUE '7646'.
   705     12  ER-7647                 PIC X(4)  VALUE '7647'.
   706     12  ER-7648                 PIC X(4)  VALUE '7648'.
   707     12  ER-7649                 PIC X(4)  VALUE '7649'.
   708     12  ER-7651                 PIC X(4)  VALUE '7651'.
   709     12  ER-7670                 PIC X(4)  VALUE '7670'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  15
* EL130.cbl
   710     12  ER-7671                 PIC X(4)  VALUE '7671'.
   711     12  ER-7686                 PIC X(4)  VALUE '7686'.
   712     12  ER-7688                 PIC X(4)  VALUE '7688'.
   713     12  ER-7689                 PIC X(4)  VALUE '7689'.
   714     12  ER-7691                 PIC X(4)  VALUE '7691'.
   715*    COPY ERCPDEF.
   716******************************************************************
   717*                                                                *
   718*                                                                *
   719*                            ERCPDEF.                            *
   720*                                                                *
   721*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   722*                                                                *
   723*    FILE TYPE = VSAM,KSDS                                       *
   724*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   725*                                                                *
   726*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   727*                                                                *
   728*    LOG = YES                                                   *
   729*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   730******************************************************************
   731*                   C H A N G E   L O G
   732*
   733* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   734*-----------------------------------------------------------------
   735*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   736* EFFECTIVE    NUMBER
   737*-----------------------------------------------------------------
   738* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   739* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   740******************************************************************
   741 01  PRODUCT-MASTER.
   742    12  PD-RECORD-ID                 PIC X(02).
   743        88  VALID-PD-ID                  VALUE 'PD'.
   744    12  PD-CONTROL-PRIMARY.
   745        16  PD-COMPANY-CD            PIC X.
   746        16  PD-STATE                 PIC XX.
   747        16  PD-PRODUCT-CD            PIC XXX.
   748        16  PD-FILLER                PIC X(7).
   749        16  PD-BEN-TYPE              PIC X.
   750        16  PD-BEN-CODE              PIC XX.
   751        16  PD-PROD-EXP-DT           PIC XX.
   752    12  FILLER                       PIC X(50).
   753    12  PD-PRODUCT-DATA OCCURS 8.
   754        16  PD-PROD-CODE             PIC X.
   755            88  PD-PROD-LIFE           VALUE 'L'.
   756            88  PD-PROD-PROP           VALUE 'P'.
   757            88  PD-PROD-AH             VALUE 'A'.
   758            88  PD-PROD-IU             VALUE 'I'.
   759            88  PD-PROD-GAP            VALUE 'G'.
   760            88  PD-PROD-FAML           VALUE 'F'.
   761        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   762        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   763        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   764        16  PD-MAX-TERM              PIC S999        COMP-3.
   765        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   766        16  FILLER                   PIC X.
   767        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  16
* EL130.cbl
   768        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   769        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   770        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   771        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   772        16  PD-REC-CRIT-PERIOD       PIC 99.
   773        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   774            20  PD-RECURRING-YN      PIC X.
   775            20  FILLER               PIC X.
   776        16  PD-RTW-MOS               PIC 99.
   777        16  PD-MAX-EXTENSION         PIC 99.
   778        16  FILLER                   PIC XX.
   779    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   780    12  PD-TERM-LIMITS OCCURS 15.
   781        16  PD-LOW-TERM              PIC S999        COMP-3.
   782        16  PD-HI-TERM               PIC S999        COMP-3.
   783*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   784    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   785        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   786        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   787    12  PD-EARN-FACTORS.
   788        16  FILLER OCCURS 15.
   789            20  FILLER OCCURS 15.
   790                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   791    12  PD-PRODUCT-DESC              PIC X(80).
   792    12  PD-TRUNCATED                 PIC X.
   793    12  FILLER                       PIC X(59).
   794    12  PD-MAINT-INFORMATION.
   795        16  PD-LAST-MAINT-DT         PIC X(02).
   796        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   797        16  PD-LAST-MAINT-BY         PIC X(04).
   798*    COPY ELCLNKLT.
   799******************************************************************
   800*                                                                *
   801*                                                                *
   802*                           ELCLNKLT                             *
   803*                            VMOD=2.003                          *
   804*                                                                *
   805*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   806*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   807*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   808*                                                                *
   809*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   810*   COMPLETING THE REQUIRED FIELDS.                              *
   811*                                                                *
   812*   THE CALLING PROGRAM SHOULD CHECK:                            *
   813*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   814*                              9999 INDICATES AN UNKNOWN ABEND   *
   815*                                   WAS DETECTED.                *
   816*                              ALL OTHER VALUES ARE NORMAL ERROR *
   817*                              CODES FOUND IN THE ERROR FILE.    *
   818******************************************************************
   819 01  W-1523-LINKDATA.
   820     12  W-1523-COMMON-PI-DATA.
   821         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   822         16  FILLER              PIC  X(67).
   823         16  W-1523-COMPANY-CD   PIC  X(01).
   824         16  FILLER              PIC  X(10).
   825         16  W-1523-CONTROL-IN-PROGRESS.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  17
* EL130.cbl
   826             20  W-1523-CARRIER  PIC  X(01).
   827             20  W-1523-GROUPING PIC  X(06).
   828             20  W-1523-STATE    PIC  X(02).
   829             20  W-1523-ACCOUNT  PIC  X(10).
   830             20  W-1523-CLAIM-CERT-GRP.
   831                 24  W-1523-CLAIM-NO
   832                                 PIC  X(07).
   833                 24  W-1523-CERT-NO.
   834                     28  W-1523-CERT-PRIME
   835                                 PIC  X(10).
   836                     28  W-1523-CERT-SFX
   837                                 PIC  X(01).
   838                 24  W-1523-CERT-EFF-DT
   839                                 PIC  X(02).
   840         16  FILLER              PIC X(265).
   841
   842     12  W-1523-WORK-AREA.
   843         16  W-1523-FORM-NUMBER  PIC  X(04).
   844         16  W-1523-NUMBER-COPIES
   845                                 PIC  9(01).
   846         16  W-1523-ADDR-TYPE    PIC  X(02).
   847         16  W-1523-FOLLOW-UP-DATE
   848                                 PIC  X(02).
   849         16  W-1523-RESEND-DATE  PIC  X(02).
   850         16  W-1523-ERROR-CODE   PIC  9(04).
   851             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   852             88  W-1523-FATAL-ERROR
   853                                    VALUES  0006 0013 0042
   854                                            0154 0168 0169
   855                                            0176 9999 0172
   856                                            0179 0186 0281
   857                                            0332 2055 3697
   858                                            3698 3699 3770
   859                                            3771 3772 7675
   860                                            9106 9808 9883
   861                                            9887.
   862             88  W-1523-STOP-ERRORS
   863                                    VALUES  0013 0042 0154
   864                                            0168 0169 0172
   865                                            0281 0332 2055
   866                                            3698 3699 7675
   867                                            9106 9808 9883
   868                                            9999.
   869         16  W-1523-REASON       PIC  X(70).
   870         16  W-1523-ARCHIVE-NUMBER
   871                                 PIC  9(08).
   872     12  W-1523-POINTER-AREA.
   873         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   874         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   875         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   876         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   877         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  18
* EL130.cbl
   879*    COPY ELCINTF.
   880******************************************************************
   881*                                                                *
   882*                                                                *
   883*                            ELCINTF.                            *
   884*                            VMOD=2.017                          *
   885*                                                                *
   886*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   887*                                                                *
   888*       LENGTH = 1024                                            *
   889*                                                                *
   890******************************************************************
   891*                   C H A N G E   L O G
   892*
   893* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   894*-----------------------------------------------------------------
   895*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   896* EFFECTIVE    NUMBER
   897*-----------------------------------------------------------------
   898* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   899******************************************************************
   900 01  PROGRAM-INTERFACE-BLOCK.
   901     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   902     12  PI-CALLING-PROGRAM              PIC X(8).
   903     12  PI-SAVED-PROGRAM-1              PIC X(8).
   904     12  PI-SAVED-PROGRAM-2              PIC X(8).
   905     12  PI-SAVED-PROGRAM-3              PIC X(8).
   906     12  PI-SAVED-PROGRAM-4              PIC X(8).
   907     12  PI-SAVED-PROGRAM-5              PIC X(8).
   908     12  PI-SAVED-PROGRAM-6              PIC X(8).
   909     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   910     12  PI-COMPANY-ID                   PIC XXX.
   911     12  PI-COMPANY-CD                   PIC X.
   912
   913     12  PI-COMPANY-PASSWORD             PIC X(8).
   914
   915     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   916
   917     12  PI-CONTROL-IN-PROGRESS.
   918         16  PI-CARRIER                  PIC X.
   919         16  PI-GROUPING                 PIC X(6).
   920         16  PI-STATE                    PIC XX.
   921         16  PI-ACCOUNT                  PIC X(10).
   922         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   923                                         PIC X(10).
   924         16  PI-CLAIM-CERT-GRP.
   925             20  PI-CLAIM-NO             PIC X(7).
   926             20  PI-CERT-NO.
   927                 25  PI-CERT-PRIME       PIC X(10).
   928                 25  PI-CERT-SFX         PIC X.
   929             20  PI-CERT-EFF-DT          PIC XX.
   930         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   931             20  PI-PLAN-CODE            PIC X(2).
   932             20  PI-REVISION-NUMBER      PIC X(3).
   933             20  PI-PLAN-EFF-DT          PIC X(2).
   934             20  PI-PLAN-EXP-DT          PIC X(2).
   935             20  FILLER                  PIC X(11).
   936         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  19
* EL130.cbl
   937             20  PI-OE-REFERENCE-1.
   938                 25  PI-OE-REF-1-PRIME   PIC X(18).
   939                 25  PI-OE-REF-1-SUFF    PIC XX.
   940
   941     12  PI-SESSION-IN-PROGRESS          PIC X.
   942         88  CLAIM-SESSION                   VALUE '1'.
   943         88  CREDIT-SESSION                  VALUE '2'.
   944         88  WARRANTY-SESSION                VALUE '3'.
   945         88  MORTGAGE-SESSION                VALUE '4'.
   946         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   947
   948
   949*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   950
   951     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   952     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   953
   954     12  PI-CREDIT-USER                  PIC X.
   955         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   956         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   957
   958     12  PI-CLAIM-USER                   PIC X.
   959         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   960         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   961
   962     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   963         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   964         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   965         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   966         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   967         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   968
   969     12  PI-PROCESSOR-ID                 PIC X(4).
   970
   971     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   972
   973     12  PI-MEMBER-CAPTION               PIC X(10).
   974
   975     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   976         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   977
   978     12  PI-LIFE-OVERRIDE-L1             PIC X.
   979     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   980     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   981     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   982
   983     12  PI-AH-OVERRIDE-L1               PIC X.
   984     12  PI-AH-OVERRIDE-L2               PIC XX.
   985     12  PI-AH-OVERRIDE-L6               PIC X(6).
   986     12  PI-AH-OVERRIDE-L12              PIC X(12).
   987
   988     12  PI-NEW-SYSTEM                   PIC X(2).
   989
   990     12  PI-PRIMARY-CERT-NO              PIC X(11).
   991     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   992         88  PI-USES-PAID-TO                 VALUE '1'.
   993     12  PI-CRDTCRD-SYSTEM.
   994         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  20
* EL130.cbl
   995             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   996             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   997         16  PI-CC-MONTH-END-DT          PIC XX.
   998     12  PI-PROCESSOR-PRINTER            PIC X(4).
   999
  1000     12  PI-OE-REFERENCE-2.
  1001         16  PI-OE-REF-2-PRIME           PIC X(10).
  1002         16  PI-OE-REF-2-SUFF            PIC X.
  1003
  1004     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1005
  1006     12  PI-LANGUAGE-TYPE                PIC X.
  1007             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1008             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1009             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1010
  1011     12  PI-POLICY-LINKAGE-IND           PIC X.
  1012         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1013         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1014                                                   LOW-VALUES.
  1015
  1016     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1017     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1018         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1019         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1020
  1021     12  PI-PROCESSOR-CSR-IND            PIC X.
  1022         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1023         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1024
  1025     12  FILLER                          PIC X(3).
  1026
  1027     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1028
  1029     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1030         PI-SYSTEM-LEVEL.
  1031
  1032         16  PI-ENTRY-CODES.
  1033             20  PI-ENTRY-CD-1           PIC X.
  1034             20  PI-ENTRY-CD-2           PIC X.
  1035
  1036         16  PI-RETURN-CODES.
  1037             20  PI-RETURN-CD-1          PIC X.
  1038             20  PI-RETURN-CD-2          PIC X.
  1039
  1040         16  PI-UPDATE-STATUS-SAVE.
  1041             20  PI-UPDATE-BY            PIC X(4).
  1042             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1043
  1044         16  PI-LOWER-CASE-LETTERS       PIC X.
  1045             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1046
  1047*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1048*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1049*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1050
  1051         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1052             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  21
* EL130.cbl
  1053             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1054             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1055             88  ACCNT-CNTL                  VALUE '3'.
  1056             88  CARR-ACCNT-CNTL             VALUE '4'.
  1057
  1058         16  PI-PROCESSOR-CAP-LIST.
  1059             20  PI-SYSTEM-CONTROLS.
  1060                24 PI-SYSTEM-DISPLAY     PIC X.
  1061                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1062                24 PI-SYSTEM-MODIFY      PIC X.
  1063                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1064             20  FILLER                  PIC XX.
  1065             20  PI-DISPLAY-CAP          PIC X.
  1066                 88  DISPLAY-CAP             VALUE 'Y'.
  1067             20  PI-MODIFY-CAP           PIC X.
  1068                 88  MODIFY-CAP              VALUE 'Y'.
  1069             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1070                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1071             20  PI-FORCE-CAP            PIC X.
  1072                 88  FORCE-CAP               VALUE 'Y'.
  1073
  1074         16  PI-PROGRAM-CONTROLS.
  1075             20  PI-PGM-PRINT-OPT        PIC X.
  1076             20  PI-PGM-FORMAT-OPT       PIC X.
  1077             20  PI-PGM-PROCESS-OPT      PIC X.
  1078             20  PI-PGM-TOTALS-OPT       PIC X.
  1079
  1080         16  PI-HELP-INTERFACE.
  1081             20  PI-LAST-ERROR-NO        PIC X(4).
  1082             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1083
  1084         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1085             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1086
  1087         16  PI-CR-CONTROL-IN-PROGRESS.
  1088             20  PI-CR-CARRIER           PIC X.
  1089             20  PI-CR-GROUPING          PIC X(6).
  1090             20  PI-CR-STATE             PIC XX.
  1091             20  PI-CR-ACCOUNT           PIC X(10).
  1092             20  PI-CR-FIN-RESP          PIC X(10).
  1093             20  PI-CR-TYPE              PIC X.
  1094
  1095         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1096
  1097         16  PI-CR-MONTH-END-DT          PIC XX.
  1098
  1099         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1100             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1101             88  PI-ZERO-CARRIER             VALUE '1'.
  1102             88  PI-ZERO-GROUPING            VALUE '2'.
  1103             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1104
  1105         16  PI-CARRIER-SECURITY         PIC X.
  1106             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1107
  1108         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1109             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1110             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  22
* EL130.cbl
  1111
  1112         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1113             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1114                                         INDEXED BY PI-ACCESS-NDX
  1115                                         PIC X.
  1116
  1117         16  PI-GA-BILLING-CONTROL       PIC X.
  1118             88  PI-GA-BILLING               VALUE '1'.
  1119
  1120         16  PI-MAIL-PROCESSING          PIC X.
  1121             88  PI-MAIL-YES                 VALUE 'Y'.
  1122
  1123         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1124
  1125         16  PI-AR-SYSTEM.
  1126             20  PI-AR-PROCESSING-CNTL   PIC X.
  1127                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1128             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1129             20  PI-AR-MONTH-END-DT      PIC XX.
  1130
  1131         16  PI-MP-SYSTEM.
  1132             20  PI-MORTGAGE-USER            PIC X.
  1133                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1134                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1135             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1136                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1137                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1138                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1139                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1140                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1141             20  PI-MP-MONTH-END-DT          PIC XX.
  1142             20  PI-MP-REFERENCE-NO.
  1143                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1144                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1145
  1146         16  PI-LABEL-CONTROL            PIC X(01).
  1147             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1148             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1149
  1150         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1151             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1152
  1153         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1154             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1155             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1156
  1157         16  FILLER                      PIC X(14).
  1158
  1159     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1160******************************************************************
  1161     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1162         16  PI-MSTR-DT               PIC XX.
  1163         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1164         16  PI-TRLR-DT               PIC XX.
  1165         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1166         16  PI-LAST-CLAIM            PIC X(7).
  1167         16  PI-LAST-CARR             PIC X.
  1168         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  23
* EL130.cbl
  1169             20  PI-LAST-CERT-PRIME   PIC X(10).
  1170             20  PI-LAST-CERT-SUFX    PIC X.
  1171         16  PI-LAST-CLAIM-TYPE       PIC X.
  1172         16  PI-CURSOR                PIC S9(4)   COMP.
  1173         16  PI-SAVE-CERT.
  1174             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1175             20  PI-SAVE-CERT-SUFX    PIC X.
  1176         16  PI-SAVE-EFFDT            PIC X(2).
  1177         16  PI-SAVE-ACCOUNT          PIC X(10).
  1178         16  PI-INCURR-SW             PIC X.
  1179         16  PI-PRT-OPT               PIC X.
  1180         16  PI-ALT-PRT               PIC X(4).
  1181         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1182             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1183         16  FILLER                   PIC X(272).
  1184         16  PI-EL127-TO-EL130-CNTRL.
  1185             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1186             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1187             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1188                 24  PI-EL127-CARRIER        PIC X.
  1189                 24  PI-EL127-GROUPING       PIC X(6).
  1190                 24  PI-EL127-STATE          PIC X(2).
  1191                 24  PI-EL127-ACCOUNT        PIC X(10).
  1192                 24  PI-EL127-CERT-NO.
  1193                     28  PI-EL127-CERT-PRIME PIC X(10).
  1194                     28  PI-EL127-CERT-SUFX  PIC X.
  1195                 24  PI-EL127-EFF-DT         PIC XX.
  1196*        16  FILLER                          PIC X(50).
  1197         16  FILLER                          PIC X(31).
  1198         16  PI-EL659-TO-EL130-CNTRL.
  1199             20  PI-EL659-CARRIER            PIC X.
  1200             20  PI-EL659-GROUPING           PIC X(6).
  1201             20  PI-EL659-STATE              PIC XX.
  1202             20  PI-EL659-ACCOUNT            PIC X(10).
  1203
  1204         16  FILLER                          PIC X(19).
  1205
  1206         16  PI-SAVE-INCUR-DT                PIC X(02).
  1207         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1208*         16  FILLER                          PIC X(65).
  1209         16  PI-ST-VFY-2ND-BENE              PIC X.
  1210         16  PI-ST-CAUSAL-STATE              PIC X.
  1211         16  pi-dcc-max-benefits             pic s999 comp-3.
  1212         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1213         16  pi-emi-sub                      pic 99.
  1214         16  FILLER                          PIC X(53).
  1215
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  24
* EL130.cbl
  1217*    COPY EL130S.
  1218 01  EL130AI.
  1219     05  FILLER            PIC  X(0012).
  1220*    -------------------------------
  1221     05  RUNDTEL PIC S9(0004) COMP.
  1222     05  RUNDTEF PIC  X(0001).
  1223     05  FILLER REDEFINES RUNDTEF.
  1224         10  RUNDTEA PIC  X(0001).
  1225     05  RUNDTEI PIC  X(0008).
  1226*    -------------------------------
  1227     05  RUNTIMEL PIC S9(0004) COMP.
  1228     05  RUNTIMEF PIC  X(0001).
  1229     05  FILLER REDEFINES RUNTIMEF.
  1230         10  RUNTIMEA PIC  X(0001).
  1231     05  RUNTIMEI PIC  X(0005).
  1232*    -------------------------------
  1233     05  COMPL PIC S9(0004) COMP.
  1234     05  COMPF PIC  X(0001).
  1235     05  FILLER REDEFINES COMPF.
  1236         10  COMPA PIC  X(0001).
  1237     05  COMPI PIC  X(0003).
  1238*    -------------------------------
  1239     05  SEQUL PIC S9(0004) COMP.
  1240     05  SEQUF PIC  X(0001).
  1241     05  FILLER REDEFINES SEQUF.
  1242         10  SEQUA PIC  X(0001).
  1243     05  SEQUI PIC  X(0010).
  1244*    -------------------------------
  1245     05  MAINTL PIC S9(0004) COMP.
  1246     05  MAINTF PIC  X(0001).
  1247     05  FILLER REDEFINES MAINTF.
  1248         10  MAINTA PIC  X(0001).
  1249     05  MAINTI PIC  X(0001).
  1250*    -------------------------------
  1251     05  CLMNOL PIC S9(0004) COMP.
  1252     05  CLMNOF PIC  X(0001).
  1253     05  FILLER REDEFINES CLMNOF.
  1254         10  CLMNOA PIC  X(0001).
  1255     05  CLMNOI PIC  X(0007).
  1256*    -------------------------------
  1257     05  CLMCARRL PIC S9(0004) COMP.
  1258     05  CLMCARRF PIC  X(0001).
  1259     05  FILLER REDEFINES CLMCARRF.
  1260         10  CLMCARRA PIC  X(0001).
  1261     05  CLMCARRI PIC  X(0001).
  1262*    -------------------------------
  1263     05  CLMTYPEL PIC S9(0004) COMP.
  1264     05  CLMTYPEF PIC  X(0001).
  1265     05  FILLER REDEFINES CLMTYPEF.
  1266         10  CLMTYPEA PIC  X(0001).
  1267     05  CLMTYPEI PIC  X(0001).
  1268*    -------------------------------
  1269     05  CERTNOL PIC S9(0004) COMP.
  1270     05  CERTNOF PIC  X(0001).
  1271     05  FILLER REDEFINES CERTNOF.
  1272         10  CERTNOA PIC  X(0001).
  1273     05  CERTNOI PIC  X(0010).
  1274*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  25
* EL130.cbl
  1275     05  SUFXL PIC S9(0004) COMP.
  1276     05  SUFXF PIC  X(0001).
  1277     05  FILLER REDEFINES SUFXF.
  1278         10  SUFXA PIC  X(0001).
  1279     05  SUFXI PIC  X(0001).
  1280*    -------------------------------
  1281     05  PCERTNOL PIC S9(0004) COMP.
  1282     05  PCERTNOF PIC  X(0001).
  1283     05  FILLER REDEFINES PCERTNOF.
  1284         10  PCERTNOA PIC  X(0001).
  1285     05  PCERTNOI PIC  X(0010).
  1286*    -------------------------------
  1287     05  PSUFXL PIC S9(0004) COMP.
  1288     05  PSUFXF PIC  X(0001).
  1289     05  FILLER REDEFINES PSUFXF.
  1290         10  PSUFXA PIC  X(0001).
  1291     05  PSUFXI PIC  X(0001).
  1292*    -------------------------------
  1293     05  INCURL PIC S9(0004) COMP.
  1294     05  INCURF PIC  X(0001).
  1295     05  FILLER REDEFINES INCURF.
  1296         10  INCURA PIC  X(0001).
  1297     05  INCURI PIC  X(0008).
  1298*    -------------------------------
  1299     05  REPORTL PIC S9(0004) COMP.
  1300     05  REPORTF PIC  X(0001).
  1301     05  FILLER REDEFINES REPORTF.
  1302         10  REPORTA PIC  X(0001).
  1303     05  REPORTI PIC  X(0008).
  1304*    -------------------------------
  1305     05  ICD1L PIC S9(0004) COMP.
  1306     05  ICD1F PIC  X(0001).
  1307     05  FILLER REDEFINES ICD1F.
  1308         10  ICD1A PIC  X(0001).
  1309     05  ICD1I PIC  X(0008).
  1310*    -------------------------------
  1311     05  ICD2L PIC S9(0004) COMP.
  1312     05  ICD2F PIC  X(0001).
  1313     05  FILLER REDEFINES ICD2F.
  1314         10  ICD2A PIC  X(0001).
  1315     05  ICD2I PIC  X(0008).
  1316*    -------------------------------
  1317     05  DIAGL PIC S9(0004) COMP.
  1318     05  DIAGF PIC  X(0001).
  1319     05  FILLER REDEFINES DIAGF.
  1320         10  DIAGA PIC  X(0001).
  1321     05  DIAGI PIC  X(0060).
  1322*    -------------------------------
  1323     05  BENECDL PIC S9(0004) COMP.
  1324     05  BENECDF PIC  X(0001).
  1325     05  FILLER REDEFINES BENECDF.
  1326         10  BENECDA PIC  X(0001).
  1327     05  BENECDI PIC  X(0010).
  1328*    -------------------------------
  1329     05  BIRTHDTL PIC S9(0004) COMP.
  1330     05  BIRTHDTF PIC  X(0001).
  1331     05  FILLER REDEFINES BIRTHDTF.
  1332         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  26
* EL130.cbl
  1333     05  BIRTHDTI PIC  X(0008).
  1334*    -------------------------------
  1335     05  SSNL PIC S9(0004) COMP.
  1336     05  SSNF PIC  X(0001).
  1337     05  FILLER REDEFINES SSNF.
  1338         10  SSNA PIC  X(0001).
  1339     05  SSNI PIC  X(0011).
  1340*    -------------------------------
  1341     05  SEXL PIC S9(0004) COMP.
  1342     05  SEXF PIC  X(0001).
  1343     05  FILLER REDEFINES SEXF.
  1344         10  SEXA PIC  X(0001).
  1345     05  SEXI PIC  X(0001).
  1346*    -------------------------------
  1347     05  INSTYPEL PIC S9(0004) COMP.
  1348     05  INSTYPEF PIC  X(0001).
  1349     05  FILLER REDEFINES INSTYPEF.
  1350         10  INSTYPEA PIC  X(0001).
  1351     05  INSTYPEI PIC  X(0001).
  1352*    -------------------------------
  1353     05  LSTNMEL PIC S9(0004) COMP.
  1354     05  LSTNMEF PIC  X(0001).
  1355     05  FILLER REDEFINES LSTNMEF.
  1356         10  LSTNMEA PIC  X(0001).
  1357     05  LSTNMEI PIC  X(0015).
  1358*    -------------------------------
  1359     05  FSTNMEL PIC S9(0004) COMP.
  1360     05  FSTNMEF PIC  X(0001).
  1361     05  FILLER REDEFINES FSTNMEF.
  1362         10  FSTNMEA PIC  X(0001).
  1363     05  FSTNMEI PIC  X(0012).
  1364*    -------------------------------
  1365     05  INITL PIC S9(0004) COMP.
  1366     05  INITF PIC  X(0001).
  1367     05  FILLER REDEFINES INITF.
  1368         10  INITA PIC  X(0001).
  1369     05  INITI PIC  X(0001).
  1370*    -------------------------------
  1371     05  LOANNOL PIC S9(0004) COMP.
  1372     05  LOANNOF PIC  X(0001).
  1373     05  FILLER REDEFINES LOANNOF.
  1374         10  LOANNOA PIC  X(0001).
  1375     05  LOANNOI PIC  X(0008).
  1376*    -------------------------------
  1377     05  CRTLNMEL PIC S9(0004) COMP.
  1378     05  CRTLNMEF PIC  X(0001).
  1379     05  FILLER REDEFINES CRTLNMEF.
  1380         10  CRTLNMEA PIC  X(0001).
  1381     05  CRTLNMEI PIC  X(0015).
  1382*    -------------------------------
  1383     05  CRTFNMEL PIC S9(0004) COMP.
  1384     05  CRTFNMEF PIC  X(0001).
  1385     05  FILLER REDEFINES CRTFNMEF.
  1386         10  CRTFNMEA PIC  X(0001).
  1387     05  CRTFNMEI PIC  X(0012).
  1388*    -------------------------------
  1389     05  CRTINITL PIC S9(0004) COMP.
  1390     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  27
* EL130.cbl
  1391     05  FILLER REDEFINES CRTINITF.
  1392         10  CRTINITA PIC  X(0001).
  1393     05  CRTINITI PIC  X(0001).
  1394*    -------------------------------
  1395     05  LOANBALL PIC S9(0004) COMP.
  1396     05  LOANBALF PIC  X(0001).
  1397     05  FILLER REDEFINES LOANBALF.
  1398         10  LOANBALA PIC  X(0001).
  1399     05  LOANBALI PIC  9(7)V99.
  1400*    -------------------------------
  1401     05  MANRSVL PIC S9(0004) COMP.
  1402     05  MANRSVF PIC  X(0001).
  1403     05  FILLER REDEFINES MANRSVF.
  1404         10  MANRSVA PIC  X(0001).
  1405     05  MANRSVI PIC  9(7)V99.
  1406*    -------------------------------
  1407     05  SUPVL PIC S9(0004) COMP.
  1408     05  SUPVF PIC  X(0001).
  1409     05  FILLER REDEFINES SUPVF.
  1410         10  SUPVA PIC  X(0001).
  1411     05  SUPVI PIC  X(0001).
  1412*    -------------------------------
  1413     05  PRICDL PIC S9(0004) COMP.
  1414     05  PRICDF PIC  X(0001).
  1415     05  FILLER REDEFINES PRICDF.
  1416         10  PRICDA PIC  X(0001).
  1417     05  PRICDI PIC  X(0001).
  1418*    -------------------------------
  1419     05  PRODL PIC S9(0004) COMP.
  1420     05  PRODF PIC  X(0001).
  1421     05  FILLER REDEFINES PRODF.
  1422         10  PRODA PIC  X(0001).
  1423     05  PRODI PIC  X(0008).
  1424*    -------------------------------
  1425     05  PRODCDL PIC S9(0004) COMP.
  1426     05  PRODCDF PIC  X(0001).
  1427     05  FILLER REDEFINES PRODCDF.
  1428         10  PRODCDA PIC  X(0001).
  1429     05  PRODCDI PIC  X(0001).
  1430*    -------------------------------
  1431     05  FILETOL PIC S9(0004) COMP.
  1432     05  FILETOF PIC  X(0001).
  1433     05  FILLER REDEFINES FILETOF.
  1434         10  FILETOA PIC  X(0001).
  1435     05  FILETOI PIC  X(0004).
  1436*    -------------------------------
  1437     05  PROCCDL PIC S9(0004) COMP.
  1438     05  PROCCDF PIC  X(0001).
  1439     05  FILLER REDEFINES PROCCDF.
  1440         10  PROCCDA PIC  X(0001).
  1441     05  PROCCDI PIC  X(0004).
  1442*    -------------------------------
  1443     05  RELCLML PIC S9(0004) COMP.
  1444     05  RELCLMF PIC  X(0001).
  1445     05  FILLER REDEFINES RELCLMF.
  1446         10  RELCLMA PIC  X(0001).
  1447     05  RELCLMI PIC  X(0007).
  1448*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  28
* EL130.cbl
  1449     05  PRTOPTL PIC S9(0004) COMP.
  1450     05  PRTOPTF PIC  X(0001).
  1451     05  FILLER REDEFINES PRTOPTF.
  1452         10  PRTOPTA PIC  X(0001).
  1453     05  PRTOPTI PIC  X(0001).
  1454*    -------------------------------
  1455     05  ALTPRTL PIC S9(0004) COMP.
  1456     05  ALTPRTF PIC  X(0001).
  1457     05  FILLER REDEFINES ALTPRTF.
  1458         10  ALTPRTA PIC  X(0001).
  1459     05  ALTPRTI PIC  X(0004).
  1460*    -------------------------------
  1461     05  CERTMTL PIC S9(0004) COMP.
  1462     05  CERTMTF PIC  X(0001).
  1463     05  FILLER REDEFINES CERTMTF.
  1464         10  CERTMTA PIC  X(0001).
  1465     05  CERTMTI PIC  X(0001).
  1466*    -------------------------------
  1467     05  CRTCARRL PIC S9(0004) COMP.
  1468     05  CRTCARRF PIC  X(0001).
  1469     05  FILLER REDEFINES CRTCARRF.
  1470         10  CRTCARRA PIC  X(0001).
  1471     05  CRTCARRI PIC  X(0001).
  1472*    -------------------------------
  1473     05  GROUPL PIC S9(0004) COMP.
  1474     05  GROUPF PIC  X(0001).
  1475     05  FILLER REDEFINES GROUPF.
  1476         10  GROUPA PIC  X(0001).
  1477     05  GROUPI PIC  X(0006).
  1478*    -------------------------------
  1479     05  STATEL PIC S9(0004) COMP.
  1480     05  STATEF PIC  X(0001).
  1481     05  FILLER REDEFINES STATEF.
  1482         10  STATEA PIC  X(0001).
  1483     05  STATEI PIC  X(0002).
  1484*    -------------------------------
  1485     05  ACCOUNTL PIC S9(0004) COMP.
  1486     05  ACCOUNTF PIC  X(0001).
  1487     05  FILLER REDEFINES ACCOUNTF.
  1488         10  ACCOUNTA PIC  X(0001).
  1489     05  ACCOUNTI PIC  X(0010).
  1490*    -------------------------------
  1491     05  EFFDTL PIC S9(0004) COMP.
  1492     05  EFFDTF PIC  X(0001).
  1493     05  FILLER REDEFINES EFFDTF.
  1494         10  EFFDTA PIC  X(0001).
  1495     05  EFFDTI PIC  X(0008).
  1496*    -------------------------------
  1497     05  CRTSSNL PIC S9(0004) COMP.
  1498     05  CRTSSNF PIC  X(0001).
  1499     05  FILLER REDEFINES CRTSSNF.
  1500         10  CRTSSNA PIC  X(0001).
  1501     05  CRTSSNI PIC  X(0011).
  1502*    -------------------------------
  1503     05  MEMCAPL PIC S9(0004) COMP.
  1504     05  MEMCAPF PIC  X(0001).
  1505     05  FILLER REDEFINES MEMCAPF.
  1506         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  29
* EL130.cbl
  1507     05  MEMCAPI PIC  X(0010).
  1508*    -------------------------------
  1509     05  MEMBERL PIC S9(0004) COMP.
  1510     05  MEMBERF PIC  X(0001).
  1511     05  FILLER REDEFINES MEMBERF.
  1512         10  MEMBERA PIC  X(0001).
  1513     05  MEMBERI PIC  X(0012).
  1514*    -------------------------------
  1515     05  REINCDL PIC S9(0004) COMP.
  1516     05  REINCDF PIC  X(0001).
  1517     05  FILLER REDEFINES REINCDF.
  1518         10  REINCDA PIC  X(0001).
  1519     05  REINCDI PIC  X(0001).
  1520*    -------------------------------
  1521     05  ISSAGEL PIC S9(0004) COMP.
  1522     05  ISSAGEF PIC  X(0001).
  1523     05  FILLER REDEFINES ISSAGEF.
  1524         10  ISSAGEA PIC  X(0001).
  1525     05  ISSAGEI PIC  X(0002).
  1526*    -------------------------------
  1527     05  APRL PIC S9(0004) COMP.
  1528     05  APRF PIC  X(0001).
  1529     05  FILLER REDEFINES APRF.
  1530         10  APRA PIC  X(0001).
  1531     05  APRI PIC  9(4)V9(4).
  1532*    -------------------------------
  1533     05  PMTFREQL PIC S9(0004) COMP.
  1534     05  PMTFREQF PIC  X(0001).
  1535     05  FILLER REDEFINES PMTFREQF.
  1536         10  PMTFREQA PIC  X(0001).
  1537     05  PMTFREQI PIC  99.
  1538*    -------------------------------
  1539     05  INDGRPL PIC S9(0004) COMP.
  1540     05  INDGRPF PIC  X(0001).
  1541     05  FILLER REDEFINES INDGRPF.
  1542         10  INDGRPA PIC  X(0001).
  1543     05  INDGRPI PIC  X(0001).
  1544*    -------------------------------
  1545     05  PREMTYPL PIC S9(0004) COMP.
  1546     05  PREMTYPF PIC  X(0001).
  1547     05  FILLER REDEFINES PREMTYPF.
  1548         10  PREMTYPA PIC  X(0001).
  1549     05  PREMTYPI PIC  X(0001).
  1550*    -------------------------------
  1551     05  ADDONDTL PIC S9(0004) COMP.
  1552     05  ADDONDTF PIC  X(0001).
  1553     05  FILLER REDEFINES ADDONDTF.
  1554         10  ADDONDTA PIC  X(0001).
  1555     05  ADDONDTI PIC  X(0008).
  1556*    -------------------------------
  1557     05  JNTLNMEL PIC S9(0004) COMP.
  1558     05  JNTLNMEF PIC  X(0001).
  1559     05  FILLER REDEFINES JNTLNMEF.
  1560         10  JNTLNMEA PIC  X(0001).
  1561     05  JNTLNMEI PIC  X(0015).
  1562*    -------------------------------
  1563     05  JNTFNMEL PIC S9(0004) COMP.
  1564     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  30
* EL130.cbl
  1565     05  FILLER REDEFINES JNTFNMEF.
  1566         10  JNTFNMEA PIC  X(0001).
  1567     05  JNTFNMEI PIC  X(0002).
  1568*    -------------------------------
  1569     05  JNTINITL PIC S9(0004) COMP.
  1570     05  JNTINITF PIC  X(0001).
  1571     05  FILLER REDEFINES JNTINITF.
  1572         10  JNTINITA PIC  X(0001).
  1573     05  JNTINITI PIC  X(0001).
  1574*    -------------------------------
  1575     05  JNTAGEL PIC S9(0004) COMP.
  1576     05  JNTAGEF PIC  X(0001).
  1577     05  FILLER REDEFINES JNTAGEF.
  1578         10  JNTAGEA PIC  X(0001).
  1579     05  JNTAGEI PIC  X(0002).
  1580*    -------------------------------
  1581     05  LCVDSCRL PIC S9(0004) COMP.
  1582     05  LCVDSCRF PIC  X(0001).
  1583     05  FILLER REDEFINES LCVDSCRF.
  1584         10  LCVDSCRA PIC  X(0001).
  1585     05  LCVDSCRI PIC  X(0006).
  1586*    -------------------------------
  1587     05  LCVKINDL PIC S9(0004) COMP.
  1588     05  LCVKINDF PIC  X(0001).
  1589     05  FILLER REDEFINES LCVKINDF.
  1590         10  LCVKINDA PIC  X(0001).
  1591     05  LCVKINDI PIC  X(0003).
  1592*    -------------------------------
  1593     05  LCVCDL PIC S9(0004) COMP.
  1594     05  LCVCDF PIC  X(0001).
  1595     05  FILLER REDEFINES LCVCDF.
  1596         10  LCVCDA PIC  X(0001).
  1597     05  LCVCDI PIC  X(0002).
  1598*    -------------------------------
  1599     05  LCVOTRML PIC S9(0004) COMP.
  1600     05  LCVOTRMF PIC  X(0001).
  1601     05  FILLER REDEFINES LCVOTRMF.
  1602         10  LCVOTRMA PIC  X(0001).
  1603     05  LCVOTRMI PIC  999.
  1604*    -------------------------------
  1605     05  LCVRTRML PIC S9(0004) COMP.
  1606     05  LCVRTRMF PIC  X(0001).
  1607     05  FILLER REDEFINES LCVRTRMF.
  1608         10  LCVRTRMA PIC  X(0001).
  1609     05  LCVRTRMI PIC  X(0003).
  1610*    -------------------------------
  1611     05  LCVRATEL PIC S9(0004) COMP.
  1612     05  LCVRATEF PIC  X(0001).
  1613     05  FILLER REDEFINES LCVRATEF.
  1614         10  LCVRATEA PIC  X(0001).
  1615     05  LCVRATEI PIC  9999V99.
  1616*    -------------------------------
  1617     05  LCVBENEL PIC S9(0004) COMP.
  1618     05  LCVBENEF PIC  X(0001).
  1619     05  FILLER REDEFINES LCVBENEF.
  1620         10  LCVBENEA PIC  X(0001).
  1621     05  LCVBENEI PIC  9(9)V99.
  1622*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  31
* EL130.cbl
  1623     05  LCVFORML PIC S9(0004) COMP.
  1624     05  LCVFORMF PIC  X(0001).
  1625     05  FILLER REDEFINES LCVFORMF.
  1626         10  LCVFORMA PIC  X(0001).
  1627     05  LCVFORMI PIC  X(0012).
  1628*    -------------------------------
  1629     05  LCVCNDTL PIC S9(0004) COMP.
  1630     05  LCVCNDTF PIC  X(0001).
  1631     05  FILLER REDEFINES LCVCNDTF.
  1632         10  LCVCNDTA PIC  X(0001).
  1633     05  LCVCNDTI PIC  X(0008).
  1634*    -------------------------------
  1635     05  LCVEXITL PIC S9(0004) COMP.
  1636     05  LCVEXITF PIC  X(0001).
  1637     05  FILLER REDEFINES LCVEXITF.
  1638         10  LCVEXITA PIC  X(0001).
  1639     05  LCVEXITI PIC  X(0008).
  1640*    -------------------------------
  1641     05  LCVSTATL PIC S9(0004) COMP.
  1642     05  LCVSTATF PIC  X(0001).
  1643     05  FILLER REDEFINES LCVSTATF.
  1644         10  LCVSTATA PIC  X(0001).
  1645     05  LCVSTATI PIC  X(0006).
  1646*    -------------------------------
  1647     05  ACVDSCRL PIC S9(0004) COMP.
  1648     05  ACVDSCRF PIC  X(0001).
  1649     05  FILLER REDEFINES ACVDSCRF.
  1650         10  ACVDSCRA PIC  X(0001).
  1651     05  ACVDSCRI PIC  X(0006).
  1652*    -------------------------------
  1653     05  ACVKINDL PIC S9(0004) COMP.
  1654     05  ACVKINDF PIC  X(0001).
  1655     05  FILLER REDEFINES ACVKINDF.
  1656         10  ACVKINDA PIC  X(0001).
  1657     05  ACVKINDI PIC  X(0003).
  1658*    -------------------------------
  1659     05  ACVCDL PIC S9(0004) COMP.
  1660     05  ACVCDF PIC  X(0001).
  1661     05  FILLER REDEFINES ACVCDF.
  1662         10  ACVCDA PIC  X(0001).
  1663     05  ACVCDI PIC  X(0002).
  1664*    -------------------------------
  1665     05  ACVOTRML PIC S9(0004) COMP.
  1666     05  ACVOTRMF PIC  X(0001).
  1667     05  FILLER REDEFINES ACVOTRMF.
  1668         10  ACVOTRMA PIC  X(0001).
  1669     05  ACVOTRMI PIC  999.
  1670*    -------------------------------
  1671     05  ACVRTRML PIC S9(0004) COMP.
  1672     05  ACVRTRMF PIC  X(0001).
  1673     05  FILLER REDEFINES ACVRTRMF.
  1674         10  ACVRTRMA PIC  X(0001).
  1675     05  ACVRTRMI PIC  X(0003).
  1676*    -------------------------------
  1677     05  ACVRATEL PIC S9(0004) COMP.
  1678     05  ACVRATEF PIC  X(0001).
  1679     05  FILLER REDEFINES ACVRATEF.
  1680         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  32
* EL130.cbl
  1681     05  ACVRATEI PIC  9999V99.
  1682*    -------------------------------
  1683     05  ACVBENEL PIC S9(0004) COMP.
  1684     05  ACVBENEF PIC  X(0001).
  1685     05  FILLER REDEFINES ACVBENEF.
  1686         10  ACVBENEA PIC  X(0001).
  1687     05  ACVBENEI PIC  9(9)V99.
  1688*    -------------------------------
  1689     05  ACVFORML PIC S9(0004) COMP.
  1690     05  ACVFORMF PIC  X(0001).
  1691     05  FILLER REDEFINES ACVFORMF.
  1692         10  ACVFORMA PIC  X(0001).
  1693     05  ACVFORMI PIC  X(0012).
  1694*    -------------------------------
  1695     05  ACVCNDTL PIC S9(0004) COMP.
  1696     05  ACVCNDTF PIC  X(0001).
  1697     05  FILLER REDEFINES ACVCNDTF.
  1698         10  ACVCNDTA PIC  X(0001).
  1699     05  ACVCNDTI PIC  X(0008).
  1700*    -------------------------------
  1701     05  ACVEXITL PIC S9(0004) COMP.
  1702     05  ACVEXITF PIC  X(0001).
  1703     05  FILLER REDEFINES ACVEXITF.
  1704         10  ACVEXITA PIC  X(0001).
  1705     05  ACVEXITI PIC  X(0008).
  1706*    -------------------------------
  1707     05  ACVSTATL PIC S9(0004) COMP.
  1708     05  ACVSTATF PIC  X(0001).
  1709     05  FILLER REDEFINES ACVSTATF.
  1710         10  ACVSTATA PIC  X(0001).
  1711     05  ACVSTATI PIC  X(0006).
  1712*    -------------------------------
  1713     05  ERRMSG1L PIC S9(0004) COMP.
  1714     05  ERRMSG1F PIC  X(0001).
  1715     05  FILLER REDEFINES ERRMSG1F.
  1716         10  ERRMSG1A PIC  X(0001).
  1717     05  ERRMSG1I PIC  X(0072).
  1718*    -------------------------------
  1719     05  ERRMSG2L PIC S9(0004) COMP.
  1720     05  ERRMSG2F PIC  X(0001).
  1721     05  FILLER REDEFINES ERRMSG2F.
  1722         10  ERRMSG2A PIC  X(0001).
  1723     05  ERRMSG2I PIC  X(0072).
  1724*    -------------------------------
  1725     05  BCERT1L PIC S9(0004) COMP.
  1726     05  BCERT1F PIC  X(0001).
  1727     05  FILLER REDEFINES BCERT1F.
  1728         10  BCERT1A PIC  X(0001).
  1729     05  BCERT1I PIC  X(0010).
  1730*    -------------------------------
  1731     05  BSUFX1L PIC S9(0004) COMP.
  1732     05  BSUFX1F PIC  X(0001).
  1733     05  FILLER REDEFINES BSUFX1F.
  1734         10  BSUFX1A PIC  X(0001).
  1735     05  BSUFX1I PIC  X(0001).
  1736*    -------------------------------
  1737     05  BCERT2L PIC S9(0004) COMP.
  1738     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  33
* EL130.cbl
  1739     05  FILLER REDEFINES BCERT2F.
  1740         10  BCERT2A PIC  X(0001).
  1741     05  BCERT2I PIC  X(0010).
  1742*    -------------------------------
  1743     05  BSUFX2L PIC S9(0004) COMP.
  1744     05  BSUFX2F PIC  X(0001).
  1745     05  FILLER REDEFINES BSUFX2F.
  1746         10  BSUFX2A PIC  X(0001).
  1747     05  BSUFX2I PIC  X(0001).
  1748*    -------------------------------
  1749     05  BCERT3L PIC S9(0004) COMP.
  1750     05  BCERT3F PIC  X(0001).
  1751     05  FILLER REDEFINES BCERT3F.
  1752         10  BCERT3A PIC  X(0001).
  1753     05  BCERT3I PIC  X(0010).
  1754*    -------------------------------
  1755     05  BSUFX3L PIC S9(0004) COMP.
  1756     05  BSUFX3F PIC  X(0001).
  1757     05  FILLER REDEFINES BSUFX3F.
  1758         10  BSUFX3A PIC  X(0001).
  1759     05  BSUFX3I PIC  X(0001).
  1760*    -------------------------------
  1761     05  BCERT4L PIC S9(0004) COMP.
  1762     05  BCERT4F PIC  X(0001).
  1763     05  FILLER REDEFINES BCERT4F.
  1764         10  BCERT4A PIC  X(0001).
  1765     05  BCERT4I PIC  X(0010).
  1766*    -------------------------------
  1767     05  BSUFX4L PIC S9(0004) COMP.
  1768     05  BSUFX4F PIC  X(0001).
  1769     05  FILLER REDEFINES BSUFX4F.
  1770         10  BSUFX4A PIC  X(0001).
  1771     05  BSUFX4I PIC  X(0001).
  1772*    -------------------------------
  1773     05  BCERT5L PIC S9(0004) COMP.
  1774     05  BCERT5F PIC  X(0001).
  1775     05  FILLER REDEFINES BCERT5F.
  1776         10  BCERT5A PIC  X(0001).
  1777     05  BCERT5I PIC  X(0010).
  1778*    -------------------------------
  1779     05  BSUFX5L PIC S9(0004) COMP.
  1780     05  BSUFX5F PIC  X(0001).
  1781     05  FILLER REDEFINES BSUFX5F.
  1782         10  BSUFX5A PIC  X(0001).
  1783     05  BSUFX5I PIC  X(0001).
  1784*    -------------------------------
  1785     05  ENTERPFL PIC S9(0004) COMP.
  1786     05  ENTERPFF PIC  X(0001).
  1787     05  FILLER REDEFINES ENTERPFF.
  1788         10  ENTERPFA PIC  X(0001).
  1789     05  ENTERPFI PIC  99.
  1790*    -------------------------------
  1791     05  PF5L PIC S9(0004) COMP.
  1792     05  PF5F PIC  X(0001).
  1793     05  FILLER REDEFINES PF5F.
  1794         10  PF5A PIC  X(0001).
  1795     05  PF5I PIC  X(0013).
  1796 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  34
* EL130.cbl
  1797     05  FILLER            PIC  X(0012).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  RUNDTEO PIC  X(0008).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  RUNTIMEO PIC  99.99.
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  COMPO PIC  X(0003).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  SEQUO PIC  X(0010).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  MAINTO PIC  X(0001).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  CLMNOO PIC  X(0007).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  CLMCARRO PIC  X(0001).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  CLMTYPEO PIC  X(0001).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  CERTNOO PIC  X(0010).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  SUFXO PIC  X(0001).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  PCERTNOO PIC  X(0010).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  PSUFXO PIC  X(0001).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  INCURO PIC  X(0008).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  REPORTO PIC  X(0008).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  ICD1O PIC  X(0008).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  ICD2O PIC  X(0008).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  DIAGO PIC  X(0060).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  BENECDO PIC  X(0010).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  35
* EL130.cbl
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  SSNO PIC  X(0011).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  SEXO PIC  X(0001).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  INSTYPEO PIC  X(0001).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  LSTNMEO PIC  X(0015).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  FSTNMEO PIC  X(0012).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  INITO PIC  X(0001).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  LOANNOO PIC  X(0008).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  CRTLNMEO PIC  X(0015).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  CRTFNMEO PIC  X(0012).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  CRTINITO PIC  X(0001).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  LOANBALO PIC  ZZZZZ9.99.
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  MANRSVO PIC  Z(5)9.99.
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  SUPVO PIC  X(0001).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  PRICDO PIC  X(0001).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  PRODO PIC  X(0008).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  PRODCDO PIC  X(0001).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  FILETOO PIC  X(0004).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  PROCCDO PIC  X(0004).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  RELCLMO PIC  X(0007).
  1912*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  36
* EL130.cbl
  1913     05  FILLER            PIC  X(0003).
  1914     05  PRTOPTO PIC  X(0001).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  ALTPRTO PIC  X(0004).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  CERTMTO PIC  X(0001).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  CRTCARRO PIC  X(0001).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  GROUPO PIC  X(0006).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  STATEO PIC  X(0002).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  ACCOUNTO PIC  X(0010).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  EFFDTO PIC  X(0008).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  CRTSSNO PIC  X(0011).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  MEMCAPO PIC  X(0010).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  MEMBERO PIC  X(0012).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  REINCDO PIC  X(0001).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  ISSAGEO PIC  X(0002).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  APRO PIC  9(3).9(4).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  PMTFREQO PIC  99.
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  INDGRPO PIC  X(0001).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  PREMTYPO PIC  X(0001).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  ADDONDTO PIC  X(0008).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  JNTLNMEO PIC  X(0015).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  37
* EL130.cbl
  1971     05  JNTFNMEO PIC  X(0002).
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  JNTINITO PIC  X(0001).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  JNTAGEO PIC  X(0002).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  LCVDSCRO PIC  X(0006).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  LCVKINDO PIC  X(0003).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  LCVCDO PIC  X(0002).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  LCVOTRMO PIC  999.
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  LCVRTRMO PIC  ZZZ.
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  LCVRATEO PIC  ZZZ.ZZ.
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  LCVFORMO PIC  X(0012).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  LCVCNDTO PIC  X(0008).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  LCVEXITO PIC  X(0008).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  LCVSTATO PIC  X(0006).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  ACVDSCRO PIC  X(0006).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  ACVKINDO PIC  X(0003).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  ACVCDO PIC  X(0002).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  ACVOTRMO PIC  999.
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  ACVRTRMO PIC  ZZZ.
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  38
* EL130.cbl
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  ACVFORMO PIC  X(0012).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  ACVCNDTO PIC  X(0008).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  ACVEXITO PIC  X(0008).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  ACVSTATO PIC  X(0006).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  ERRMSG1O PIC  X(0072).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  ERRMSG2O PIC  X(0072).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  BCERT1O PIC  X(0010).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  BSUFX1O PIC  X(0001).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  BCERT2O PIC  X(0010).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  BSUFX2O PIC  X(0001).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  BCERT3O PIC  X(0010).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  BSUFX3O PIC  X(0001).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  BCERT4O PIC  X(0010).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  BSUFX4O PIC  X(0001).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  BCERT5O PIC  X(0010).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  BSUFX5O PIC  X(0001).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  ENTERPFO PIC  X(0002).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  PF5O PIC  X(0013).
  2086*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  39
* EL130.cbl
  2088*    COPY ELCDATE.
  2089******************************************************************
  2090*                                                                *
  2091*                                                                *
  2092*                            ELCDATE.                            *
  2093*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2094*                            VMOD=2.003
  2095*                                                                *
  2096*                                                                *
  2097*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2098*                 LENGTH = 200                                   *
  2099******************************************************************
  2100
  2101 01  DATE-CONVERSION-DATA.
  2102     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2103     12  DC-OPTION-CODE                PIC X.
  2104         88  BIN-TO-GREG                VALUE ' '.
  2105         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2106         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2107         88  YMD-GREG-TO-BIN            VALUE '3'.
  2108         88  MDY-GREG-TO-BIN            VALUE '4'.
  2109         88  JULIAN-TO-BIN              VALUE '5'.
  2110         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2111         88  FIND-CENTURY               VALUE '7'.
  2112         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2113         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2114         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2115         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2116         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2117         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2118         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2119         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2120         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2121         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2122         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2123         88  BIN-3-TO-GREG              VALUE 'I'.
  2124         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2125         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2126         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2127         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2128         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2129         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2130         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2131         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2132         88  THREE-CHARACTER-BIN
  2133                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2134         88  GREGORIAN-TO-BIN
  2135                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2136         88  BIN-TO-GREGORIAN
  2137                  VALUES ' ' '1' 'I' '8' 'G'.
  2138         88  JULIAN-TO-BINARY
  2139                  VALUES '5' 'C' 'E' 'F'.
  2140     12  DC-ERROR-CODE                 PIC X.
  2141         88  NO-CONVERSION-ERROR        VALUE ' '.
  2142         88  DATE-CONVERSION-ERROR
  2143                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2144         88  DATE-IS-ZERO               VALUE '1'.
  2145         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  40
* EL130.cbl
  2146         88  DATE-IS-INVALID            VALUE '3'.
  2147         88  DATE1-GREATER-DATE2        VALUE '4'.
  2148         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2149         88  DATE-INVALID-OPTION        VALUE '9'.
  2150         88  INVALID-CENTURY            VALUE 'A'.
  2151         88  ONLY-CENTURY               VALUE 'B'.
  2152         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2153         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2154     12  DC-END-OF-MONTH               PIC X.
  2155         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2156     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2157         88  USE-NORMAL-PROCESS         VALUE ' '.
  2158         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2159         88  ADJUST-UP-100-YRS          VALUE '2'.
  2160     12  FILLER                        PIC X.
  2161     12  DC-CONVERSION-DATES.
  2162         16  DC-BIN-DATE-1             PIC XX.
  2163         16  DC-BIN-DATE-2             PIC XX.
  2164         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2165         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2166                       DC-GREG-DATE-1-EDIT.
  2167             20  DC-EDIT1-MONTH        PIC 99.
  2168             20  SLASH1-1              PIC X.
  2169             20  DC-EDIT1-DAY          PIC 99.
  2170             20  SLASH1-2              PIC X.
  2171             20  DC-EDIT1-YEAR         PIC 99.
  2172         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2173         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2174                     DC-GREG-DATE-2-EDIT.
  2175             20  DC-EDIT2-MONTH        PIC 99.
  2176             20  SLASH2-1              PIC X.
  2177             20  DC-EDIT2-DAY          PIC 99.
  2178             20  SLASH2-2              PIC X.
  2179             20  DC-EDIT2-YEAR         PIC 99.
  2180         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2181         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2182                     DC-GREG-DATE-1-YMD.
  2183             20  DC-YMD-YEAR           PIC 99.
  2184             20  DC-YMD-MONTH          PIC 99.
  2185             20  DC-YMD-DAY            PIC 99.
  2186         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2187         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2188                      DC-GREG-DATE-1-MDY.
  2189             20  DC-MDY-MONTH          PIC 99.
  2190             20  DC-MDY-DAY            PIC 99.
  2191             20  DC-MDY-YEAR           PIC 99.
  2192         16  DC-GREG-DATE-1-ALPHA.
  2193             20  DC-ALPHA-MONTH        PIC X(10).
  2194             20  DC-ALPHA-DAY          PIC 99.
  2195             20  FILLER                PIC XX.
  2196             20  DC-ALPHA-CENTURY.
  2197                 24 DC-ALPHA-CEN-N     PIC 99.
  2198             20  DC-ALPHA-YEAR         PIC 99.
  2199         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2200         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2201         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2202         16  DC-JULIAN-DATE            PIC 9(05).
  2203         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  41
* EL130.cbl
  2204                                       PIC 9(05).
  2205         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2206             20  DC-JULIAN-YEAR        PIC 99.
  2207             20  DC-JULIAN-DAYS        PIC 999.
  2208         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2209         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2210         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2211     12  DATE-CONVERSION-VARIBLES.
  2212         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2213         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2214             20  FILLER                PIC 9(3).
  2215             20  HOLD-CEN-1-CCYY.
  2216                 24  HOLD-CEN-1-CC     PIC 99.
  2217                 24  HOLD-CEN-1-YY     PIC 99.
  2218             20  HOLD-CEN-1-MO         PIC 99.
  2219             20  HOLD-CEN-1-DA         PIC 99.
  2220         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2221             20  HOLD-CEN-1-R-MO       PIC 99.
  2222             20  HOLD-CEN-1-R-DA       PIC 99.
  2223             20  HOLD-CEN-1-R-CCYY.
  2224                 24  HOLD-CEN-1-R-CC   PIC 99.
  2225                 24  HOLD-CEN-1-R-YY   PIC 99.
  2226             20  FILLER                PIC 9(3).
  2227         16  HOLD-CENTURY-1-X.
  2228             20  FILLER                PIC X(3)  VALUE SPACES.
  2229             20  HOLD-CEN-1-X-CCYY.
  2230                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2231                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2232             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2233             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2234         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2235             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2236             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2237             20  HOLD-CEN-1-R-X-CCYY.
  2238                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2239                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2240             20  FILLER                PIC XXX.
  2241         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2242         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2243         16  DC-JULIAN-DATE-1          PIC 9(07).
  2244         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2245             20  DC-JULIAN-1-CCYY.
  2246                 24  DC-JULIAN-1-CC    PIC 99.
  2247                 24  DC-JULIAN-1-YR    PIC 99.
  2248             20  DC-JULIAN-DA-1        PIC 999.
  2249         16  DC-JULIAN-DATE-2          PIC 9(07).
  2250         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2251             20  DC-JULIAN-2-CCYY.
  2252                 24  DC-JULIAN-2-CC    PIC 99.
  2253                 24  DC-JULIAN-2-YR    PIC 99.
  2254             20  DC-JULIAN-DA-2        PIC 999.
  2255         16  DC-GREG-DATE-A-EDIT.
  2256             20  DC-EDITA-MONTH        PIC 99.
  2257             20  SLASHA-1              PIC X VALUE '/'.
  2258             20  DC-EDITA-DAY          PIC 99.
  2259             20  SLASHA-2              PIC X VALUE '/'.
  2260             20  DC-EDITA-CCYY.
  2261                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  42
* EL130.cbl
  2262                 24  DC-EDITA-YEAR     PIC 99.
  2263         16  DC-GREG-DATE-B-EDIT.
  2264             20  DC-EDITB-MONTH        PIC 99.
  2265             20  SLASHB-1              PIC X VALUE '/'.
  2266             20  DC-EDITB-DAY          PIC 99.
  2267             20  SLASHB-2              PIC X VALUE '/'.
  2268             20  DC-EDITB-CCYY.
  2269                 24  DC-EDITB-CENT     PIC 99.
  2270                 24  DC-EDITB-YEAR     PIC 99.
  2271         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2272         16  DC-GREG-DATE-CYMD-R REDEFINES
  2273                              DC-GREG-DATE-CYMD.
  2274             20  DC-CYMD-CEN           PIC 99.
  2275             20  DC-CYMD-YEAR          PIC 99.
  2276             20  DC-CYMD-MONTH         PIC 99.
  2277             20  DC-CYMD-DAY           PIC 99.
  2278         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2279         16  DC-GREG-DATE-MDCY-R REDEFINES
  2280                              DC-GREG-DATE-MDCY.
  2281             20  DC-MDCY-MONTH         PIC 99.
  2282             20  DC-MDCY-DAY           PIC 99.
  2283             20  DC-MDCY-CEN           PIC 99.
  2284             20  DC-MDCY-YEAR          PIC 99.
  2285    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2286        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2287    12  DC-EL310-DATE                  PIC X(21).
  2288    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  43
* EL130.cbl
  2290*    COPY ELCCALC.
  2291******************************************************************
  2292*                                                                *
  2293*                           ELCCALC.                            *
  2294*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2295*                            VMOD=2.025                          *
  2296*                                                                *
  2297*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2298*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2299*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2300*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2301*                                                                *
  2302*  PASSED TO ELRTRM                                              *
  2303*  -----------------                                             *
  2304*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2305*  ORIGINAL TERM                                                 *
  2306*  BEGINNING DATE                                                *
  2307*  ENDING DATE                                                   *
  2308*  COMPANY I.D.                                                  *
  2309*  ACCOUNT MASTER USER FIELD                                     *
  2310*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2311*  FREE LOOK DAYS                                                *
  2312*                                                                *
  2313*  RETURNED FROM ELRTRM                                          *
  2314*  ---------------------                                         *
  2315*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2316*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2317*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2318*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2319*----------------------------------------------------------------*
  2320*  PASSED TO ELRAMT                                              *
  2321*  ----------------                                              *
  2322*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2323*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2324*  ORIGINAL AMOUNT                                               *
  2325*  ALTERNATE BENEFIT (BALLON)                                    *
  2326*  A.P.R. - NET PAY ONLY                                         *
  2327*  METHOD
  2328*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2329*  COMPANY I.D.                                                  *
  2330*  BENEFIT TYPE                                                  *
  2331*                                                                *
  2332*  RETURNED FROM ELRAMT                                          *
  2333*  --------------------                                          *
  2334*  REMAINING AMOUNT 1 - CURRENT                                  *
  2335*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2336*  REMAINING AMOUNT FACTOR
  2337*----------------------------------------------------------------*
  2338*  PASSED TO ELRESV                                              *
  2339*  -----------------                                             *
  2340*  CERTIFICATE EFFECTIVE DATE                                    *
  2341*  VALUATION DATE                                                *
  2342*  PAID THRU DATE                                                *
  2343*  BENEFIT                                                       *
  2344*  INCURRED DATE                                                 *
  2345*  REPORTED DATE                                                 *
  2346*  ISSUE AGE                                                     *
  2347*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  44
* EL130.cbl
  2348*  CDT PERCENT                                                   *
  2349*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2350* *CLAIM TYPE (LIFE, A/H)                                        *
  2351* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2352* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2353*                                                                *
  2354*  RETURNED FROM ELRESV                                          *
  2355*  --------------------                                          *
  2356*  CDT TABLE USED                                                *
  2357*  CDT FACTOR USED                                               *
  2358*  PAY TO CURRENT RESERVE                                        *
  2359*  I.B.N.R. - A/H ONLY                                           *
  2360*  FUTURE (ACCRUED) AH ONLY                                      *
  2361*----------------------------------------------------------------*
  2362*  PASSED TO ELRATE                                              *
  2363*  ----------------                                              *
  2364*  CERT ISSUE DATE                                               *
  2365*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2366*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2367*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2368*  STATE CODE (CLIENT DEFINED)                                   *
  2369*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2370*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2371*  DEVIATION CODE                                                *
  2372*  ISSUE AGE                                                     *
  2373*  ORIGINAL BENEFIT AMOUNT                                       *
  2374*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2375*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2376*  BENEFIT KIND (LIFE OR A/H)                                    *
  2377*  A.P.R.                                                        *
  2378*  METHOD
  2379*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2380*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2381*  COMPANY I.D. (3 CHARACTER)                                    *
  2382*  BENEFIT CODE                                                  *
  2383*  BENEFIT OVERRIDE CODE                                         *
  2384*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2385*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2386*  JOINT INDICATOR (CSL ONLY)                                    *
  2387*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2388*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2389*                                                                *
  2390*  RETURNED FROM ELRATE                                          *
  2391*  --------------------                                          *
  2392*  CALCULATED PREMIUM                                            *
  2393*  PREMIUM RATE                                                  *
  2394*  MORTALITY CODE                                                *
  2395*  MAX ATTAINED AGE                                              *
  2396*  MAX AGE                                                       *
  2397*  MAX TERM                                                      *
  2398*  MAX MONTHLY BENEFIT                                           *
  2399*  MAX TOTAL BENIFIT                                             *
  2400*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2401*----------------------------------------------------------------*
  2402*  PASSED TO ELRFND                                              *
  2403*  ----------------                                              *
  2404*  CERT ISSUE DATE                                               *
  2405*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  45
* EL130.cbl
  2406*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2407*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2408*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2409*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2410*  STATE CODE (CLIENT DEFINED)                                   *
  2411*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2412*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2413*  DEVIATION CODE                                                *
  2414*  ISSUE AGE                                                     *
  2415*  ORIGINAL BENEFIT AMOUNT                                       *
  2416*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2417*  PROCESS TYPE (CANCEL)                                         *
  2418*  BENEFIT KIND (LIFE OR A/H)                                    *
  2419*  A.P.R.                                                        *
  2420*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2421*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2422*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2423*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2424*  COMPANY I.D. (3 CHARACTER)                                    *
  2425*  BENEFIT CODE                                                  *
  2426*  BENEFIT OVERRIDE CODE                                         *
  2427*                                                                *
  2428*  RETURNED FROM ELRFND                                          *
  2429*  --------------------                                          *
  2430*  CALCULATED REFUND                                             *
  2431*----------------------------------------------------------------*
  2432*  PASSED TO ELEARN                                              *
  2433*  ----------------                                              *
  2434*  CERT ISSUE DATE                                               *
  2435*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2436*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2437*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2438*  STATE CODE (CLIENT DEFINED)                                   *
  2439*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2440*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2441*  DEVIATION CODE                                                *
  2442*  ISSUE AGE                                                     *
  2443*  ORIGINAL BENEFIT AMOUNT                                       *
  2444*  BENEFIT KIND (LIFE OR A/H)                                    *
  2445*  A.P.R.                                                        *
  2446*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2447*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2448*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2449*  COMPANY I.D. (3 CHARACTER)                                    *
  2450*  BENEFIT CODE                                                  *
  2451*  BENEFIT OVERRIDE CODE                                         *
  2452*                                                                *
  2453*  RETURNED FROM ELEARN                                          *
  2454*  --------------------                                          *
  2455*  INDICATED  EARNINGS                                           *
  2456*----------------------------------------------------------------*
  2457*                 LENGTH = 450                                   *
  2458*                                                                *
  2459******************************************************************
  2460******************************************************************
  2461*                   C H A N G E   L O G
  2462*
  2463* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  46
* EL130.cbl
  2464*-----------------------------------------------------------------
  2465*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2466* EFFECTIVE    NUMBER
  2467*-----------------------------------------------------------------
  2468* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2469* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2470* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2471* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2472* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2473* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2474* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2475* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2476* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2477******************************************************************
  2478
  2479 01  CALCULATION-PASS-AREA.
  2480     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2481                                     COMP.
  2482
  2483     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2484       88  NO-CP-ERROR                             VALUE ZERO.
  2485       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2486                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2487       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2488       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2489       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2490       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2491       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2492       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2493       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2494       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2495       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2496       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2497       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2498       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2499       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2500       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2501       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2502       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2503       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2504
  2505     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2506       88  NO-CP-ERROR-2                           VALUE ZERO.
  2507***********************  INPUT AREAS ****************************
  2508
  2509     12  CP-CALCULATION-AREA.
  2510         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2511         16  CP-CERT-EFF-DT        PIC XX.
  2512         16  CP-VALUATION-DT       PIC XX.
  2513         16  CP-PAID-THRU-DT       PIC XX.
  2514         16  CP-BENEFIT-TYPE       PIC X.
  2515           88  CP-AH                               VALUE 'A' 'D'
  2516                                                   'I' 'U'.
  2517           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2518           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2519         16  CP-INCURRED-DT        PIC XX.
  2520         16  CP-REPORTED-DT        PIC XX.
  2521         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  47
* EL130.cbl
  2522         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2523         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2524                                     COMP-3.
  2525         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2526                                     COMP-3.
  2527         16  CP-CDT-METHOD         PIC X.
  2528           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2529           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2530           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2531         16  CP-CLAIM-TYPE         PIC X.
  2532           88  CP-AH-CLAIM                         VALUE 'A'.
  2533           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2534         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2535                                     COMP-3.
  2536         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2537                                     COMP-3.
  2538         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2539                                     COMP-3.
  2540         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2541                                     COMP-3.
  2542         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2543                                     COMP-3.
  2544         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2545                                     COMP-3.
  2546         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2547                                     COMP-3.
  2548         16  CP-REM-TERM-METHOD    PIC X.
  2549           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2550           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2551           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2552           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2553           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2554           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2555           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2556         16  CP-EARNING-METHOD     PIC X.
  2557           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2558           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2559           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2560           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2561           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2562           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2563           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2564           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2565           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2566           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2567           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2568           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2569           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2570           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2571         16  CP-PROCESS-TYPE       PIC X.
  2572           88  CP-CLAIM                            VALUE '1'.
  2573           88  CP-CANCEL                           VALUE '2'.
  2574           88  CP-ISSUE                            VALUE '3'.
  2575         16  CP-SPECIAL-CALC-CD    PIC X.
  2576           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2577           88  CP-1-MTH-INTEREST               VALUE ' '.
  2578           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2579           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  48
* EL130.cbl
  2580           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2581           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2582           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2583           88  CP-FARM-PLAN                    VALUE 'F'.
  2584           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2585           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2586           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2587           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2588           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2589           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2590           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2591           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2592           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2593           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2594                                                     'W' 'X'.
  2595           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2596           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2597           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2598           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2599           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2600           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2601           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2602           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2603           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2604           88  CP-CSL-METH-1                   VALUE '5'.
  2605           88  CP-CSL-METH-2                   VALUE '6'.
  2606           88  CP-CSL-METH-3                   VALUE '7'.
  2607           88  CP-CSL-METH-4                   VALUE '8'.
  2608
  2609         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2610                                     COMP-3.
  2611         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2612         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2613         16  CP-STATE              PIC XX          VALUE SPACE.
  2614         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2615         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2616           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2617               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2618         16  CP-R78-OPTION         PIC X.
  2619           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2620           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2621
  2622         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2623         16  CP-IBNR-RESERVE-SW    PIC X.
  2624         16  CP-CLAIM-STATUS       PIC X.
  2625         16  CP-RATE-FILE          PIC X.
  2626         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2627                                     COMP-3.
  2628
  2629         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2630         16  CP-AH-OVERRIDE-CODE   PIC X.
  2631
  2632         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2633                                     COMP-3.
  2634         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2635                                   PIC S9(5)V99 COMP-3.
  2636         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2637                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  49
* EL130.cbl
  2638         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2639                                     COMP-3.
  2640         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2641                                     COMP-3.
  2642         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2643                                  PIC S9(7)V99 COMP-3.
  2644
  2645         16  CP-PAID-FROM-DATE     PIC X(02).
  2646         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2647         16  CP-EXT-DAYS-CALC      PIC X.
  2648           88  CP-EXT-NO-CHG                   VALUE ' '.
  2649           88  CP-EXT-CHG-LF                   VALUE '1'.
  2650           88  CP-EXT-CHG-AH                   VALUE '2'.
  2651           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2652         16  CP-DOMICILE-STATE     PIC XX.
  2653         16  CP-CARRIER            PIC X.
  2654         16  CP-REIN-FLAG          PIC X.
  2655         16  CP-REM-TRM-CALC-OPTION PIC X.
  2656           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2657                      '2' '3' '4' '5'.
  2658           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2659           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2660           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2661           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2662           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2663           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2664           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2665           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2666         16  CP-SIG-SWITCH         PIC X.
  2667         16  CP-RATING-METHOD      PIC X.
  2668           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2669           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2670           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2671           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2672           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2673           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2674           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2675           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2676           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2677         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2678                                     COMP-3.
  2679         16  CP-BEN-CATEGORY       PIC X.
  2680         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2681         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2682                                   PIC S99V9(5) COMP-3.
  2683         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2684         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2685                                   PIC S99V9(5) COMP-3.
  2686         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2687         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2688         16  CP-EXPIRE-DT          PIC XX.
  2689         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2690         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2691         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2692         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2693         16  CP-DDF-SPEC-CALC      PIC X.
  2694             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2695             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  50
* EL130.cbl
  2696         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2697         16  CP-CANCEL-REASON      PIC X.
  2698         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2699         16  CP-PMT-MODE           PIC X.
  2700         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2701         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2702         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2703         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2704         16  FILLER                PIC X.
  2705
  2706***************    OUTPUT FROM ELRESV   ************************
  2707
  2708         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2709
  2710         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2711                                     COMP-3.
  2712         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2713                                     COMP-3.
  2714         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2715                                     COMP-3.
  2716         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2717                                     COMP-3.
  2718         16  FILLER                PIC X(09).
  2719***************    OUTPUT FROM ELRTRM   *************************
  2720
  2721         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2722                                     COMP-3.
  2723         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2724                                     COMP-3.
  2725         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2726                                     COMP-3.
  2727         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2728                                     COMP-3.
  2729         16  FILLER                PIC X(12).
  2730
  2731***************    OUTPUT FROM ELRAMT   *************************
  2732
  2733         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2734                                     COMP-3.
  2735         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2736                                     COMP-3.
  2737         16  FILLER                PIC X(12).
  2738
  2739***************    OUTPUT FROM ELRATE   *************************
  2740
  2741         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2742                                     COMP-3.
  2743         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2744                                     COMP-3.
  2745         16  CP-MORTALITY-CODE     PIC X(4).
  2746         16  CP-RATE-EDIT-FLAG     PIC X.
  2747             88  CP-RATES-NEED-APR                  VALUE '1'.
  2748         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2749                                     COMP-3.
  2750         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2751         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2752         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2753                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  51
* EL130.cbl
  2754         16  FILLER                PIC X(07).
  2755
  2756***************    OUTPUT FROM ELRFND   *************************
  2757
  2758         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2759                                     COMP-3.
  2760         16  CP-REFUND-TYPE-USED   PIC X.
  2761           88  CP-R-AS-R78                         VALUE '1'.
  2762           88  CP-R-AS-PRORATA                     VALUE '2'.
  2763           88  CP-R-AS-CALIF                       VALUE '3'.
  2764           88  CP-R-AS-TEXAS                       VALUE '4'.
  2765           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2766           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2767           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2768           88  CP-R-AS-MEAN                        VALUE '8'.
  2769           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2770           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2771           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2772           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2773           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2774           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2775         16  FILLER                PIC X(12).
  2776
  2777***************    OUTPUT FROM ELEARN   *************************
  2778
  2779         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2780                                     COMP-3.
  2781         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2782                                     COMP-3.
  2783         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2784                                     COMP-3.
  2785         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2786                                     COMP-3.
  2787         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2788                                     COMP-3.
  2789         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2790                                     COMP-3.
  2791         16  CP-EARNING-TYPE-USED  PIC X.
  2792           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2793           88  CP-E-AS-R78                         VALUE '1'.
  2794           88  CP-E-AS-PRORATA                     VALUE '2'.
  2795           88  CP-E-AS-TEXAS                       VALUE '4'.
  2796           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2797           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2798           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2799           88  CP-E-AS-MEAN                        VALUE '8'.
  2800           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2801         16  FILLER                PIC X(12).
  2802
  2803***************    OUTPUT FROM ELPMNT   *************************
  2804
  2805         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2806                                     COMP-3.
  2807         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2808                                     COMP-3.
  2809         16  FILLER                PIC X(12).
  2810
  2811***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  52
* EL130.cbl
  2812         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2813                                     COMP-3.
  2814         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2815                                     COMP-3.
  2816         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2817                                     COMP-3.
  2818         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2819                                     COMP-3.
  2820         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2821                                     COMP-3.
  2822         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2823                                     COMP-3.
  2824         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2825             88  OPEN-RATE-FILE                   VALUE 'O'.
  2826             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2827             88  IO-ERROR                         VALUE 'E'.
  2828
  2829         16  CP-FIRST-PAY-DATE     PIC XX.
  2830
  2831         16  CP-JOINT-INDICATOR    PIC X.
  2832
  2833         16  CP-RESERVE-REMAINING-TERM
  2834                                   PIC S9(4)V9    VALUE ZERO
  2835                                     COMP-3.
  2836
  2837         16  CP-INSURED-BIRTH-DT   PIC XX.
  2838
  2839         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2840                                     COMP-3.
  2841
  2842         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2843                                     COMP-3.
  2844
  2845         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2846                                     COMP-3.
  2847
  2848         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2849                                     COMP-3.
  2850
  2851         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2852                                     COMP-3.
  2853
  2854         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2855                                     COMP-3.
  2856
  2857         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2858                                     COMP-3.
  2859
  2860         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2861             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2862
  2863         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2864                                     COMP-3.
  2865         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2866                                     COMP-3.
  2867         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2868         16  FILLER                PIC X(15).
  2869******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  53
* EL130.cbl
  2871*    COPY ELCLOGOF.
  2872******************************************************************
  2873*                                                                *
  2874*                                                                *
  2875*                            ELCLOGOF.                           *
  2876*                            VMOD=2.001                          *
  2877*                                                                *
  2878*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2879*                                                                *
  2880******************************************************************
  2881 01  CLASIC-LOGOFF.
  2882     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2883     12  LOGOFF-TEXT.
  2884         16  FILLER          PIC X(5)    VALUE SPACES.
  2885         16  LOGOFF-MSG.
  2886             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2887             20  FILLER      PIC X       VALUE SPACES.
  2888             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2889         16  FILLER          PIC X(80)
  2890           VALUE '* YOU ARE NOW LOGGED OFF'.
  2891         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2892         16  FILLER          PIC X       VALUE QUOTE.
  2893         16  LOGOFF-SYS-MSG  PIC X(17)
  2894           VALUE 'S CLAS-IC SYSTEM '.
  2895     12  TEXT-MESSAGES.
  2896         16  UNACCESS-MSG    PIC X(29)
  2897             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2898         16  PGMIDERR-MSG    PIC X(17)
  2899             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  54
* EL130.cbl
  2901*    COPY ELCATTR.
  2902******************************************************************
  2903*                                                                *
  2904*                            ELCATTR.                            *
  2905*                            VMOD=2.001                          *
  2906*                                                                *
  2907*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2908*                                                                *
  2909*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2910*                                                                *
  2911*                   POS 1   P=PROTECTED                          *
  2912*                           U=UNPROTECTED                        *
  2913*                           S=ASKIP                              *
  2914*                   POS 2   A=ALPHA/NUMERIC                      *
  2915*                           N=NUMERIC                            *
  2916*                   POS 3   N=NORMAL                             *
  2917*                           B=BRIGHT                             *
  2918*                           D=DARK                               *
  2919*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2920*                           OF=MODIFIED DATA TAG OFF             *
  2921*                                                                *
  2922*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2923******************************************************************
  2924 01  ATTRIBUTE-LIST.
  2925     12  AL-PABOF            PIC X       VALUE 'Y'.
  2926     12  AL-PABON            PIC X       VALUE 'Z'.
  2927     12  AL-PADOF            PIC X       VALUE '%'.
  2928     12  AL-PADON            PIC X       VALUE '_'.
  2929     12  AL-PANOF            PIC X       VALUE '-'.
  2930     12  AL-PANON            PIC X       VALUE '/'.
  2931     12  AL-SABOF            PIC X       VALUE '8'.
  2932     12  AL-SABON            PIC X       VALUE '9'.
  2933     12  AL-SADOF            PIC X       VALUE '@'.
  2934     12  AL-SADON            PIC X       VALUE QUOTE.
  2935     12  AL-SANOF            PIC X       VALUE '0'.
  2936     12  AL-SANON            PIC X       VALUE '1'.
  2937     12  AL-UABOF            PIC X       VALUE 'H'.
  2938     12  AL-UABON            PIC X       VALUE 'I'.
  2939     12  AL-UADOF            PIC X       VALUE '<'.
  2940     12  AL-UADON            PIC X       VALUE '('.
  2941     12  AL-UANOF            PIC X       VALUE ' '.
  2942     12  AL-UANON            PIC X       VALUE 'A'.
  2943     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2944     12  AL-UNBON            PIC X       VALUE 'R'.
  2945     12  AL-UNDOF            PIC X       VALUE '*'.
  2946     12  AL-UNDON            PIC X       VALUE ')'.
  2947     12  AL-UNNOF            PIC X       VALUE '&'.
  2948     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  55
* EL130.cbl
  2950*    COPY ELCEMIB.
  2951******************************************************************
  2952*                                                                *
  2953*                                                                *
  2954*                            ELCEMIB.                            *
  2955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2956*                            VMOD=2.005                          *
  2957*                                                                *
  2958*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2959*                                                                *
  2960******************************************************************
  2961 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2962     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2963     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2964     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2965     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2966     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2967     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2968     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2969     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2970     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2971         88  EMI-NO-ERRORS                    VALUE '1'.
  2972         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2973         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2974     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2975         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2976     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2977         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2978         88  EMI-AREA1-FULL                   VALUE '2'.
  2979     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2980         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2981         88  EMI-AREA2-FULL                   VALUE '2'.
  2982     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2983         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2984         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2985         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2986         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2987         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2988     12  EMI-ERROR-LINES.
  2989         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2990         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2991         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2992         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2993             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2994                 24  EMI-ERR-NUM         PIC X(4).
  2995                 24  EMI-FILLER          PIC X.
  2996                 24  EMI-SEV             PIC X.
  2997                 24  FILLER              PIC X.
  2998             20  FILLER                  PIC X(02).
  2999     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3000         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3001             20  EMI-ERROR-NUMBER    PIC X(4).
  3002             20  EMI-FILL            PIC X.
  3003             20  EMI-SEVERITY        PIC X.
  3004             20  FILLER              PIC X.
  3005             20  EMI-ERROR-TEXT.
  3006                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3007                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  56
* EL130.cbl
  3008     12  EMI-SEVERITY-SAVE           PIC X.
  3009         88  EMI-NOTE                    VALUE 'N'.
  3010         88  EMI-WARNING                 VALUE 'W'.
  3011         88  EMI-FORCABLE                VALUE 'F'.
  3012         88  EMI-FATAL                   VALUE 'X'.
  3013     12  EMI-MESSAGE-FLAG            PIC X.
  3014         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3015         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3016     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3017     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3018         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3019         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3020         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3021     12  emi-claim-no                pic x(7).
  3022     12  emi-claim-type              pic x(6).
  3023     12  FILLER                      PIC X(124)  VALUE SPACES.
  3024     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3025     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3026     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3027     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  57
* EL130.cbl
  3029*    COPY ELCJPFX.
  3030******************************************************************
  3031*                                                                *
  3032*                                                                *
  3033*                            ELCJPFX.                            *
  3034*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3035*                            VMOD=2.002                          *
  3036*                                                                *
  3037*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3038*                                                                *
  3039*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3040*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3041*        ELCNTL - CONTROL FILE                                   *
  3042*        ELMSTR - CLAIM MASTERS                                  *
  3043*        ELTRLR - ACTIVITY TRAILERS                              *
  3044*        ELCHKQ - CHECK QUE                                      *
  3045******************************************************************
  3046 01  JOURNAL-RECORD.
  3047     12  jp-date                     pic s9(5) comp-3.
  3048     12  jp-time                     pic s9(7) comp-3.
  3049     12  JP-USER-ID                  PIC X(4).
  3050     12  JP-FILE-ID                  PIC X(8).
  3051     12  JP-PROGRAM-ID               PIC X(8).
  3052     12  JP-RECORD-TYPE              PIC X.
  3053         88 JP-ADD              VALUE 'A'.
  3054         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3055         88 JP-AFTER-CHANGE     VALUE 'C'.
  3056         88 JP-DELETE           VALUE 'D'.
  3057         88 JP-GENERIC-DELETE   VALUE 'G'.
  3058         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3059         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3060     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3061     12  JP-RECORD-AREA
  3062
  3063
  3064         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  58
* EL130.cbl
  3066*    COPY ELCAID.
  3067******************************************************************
  3068*                                                                *
  3069*                            ELCAID.                             *
  3070*                            VMOD=2.001                          *
  3071*                                                                *
  3072*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3073*                                                                *
  3074*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3075*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3076******************************************************************
  3077
  3078 01  DFHAID.
  3079   02  DFHNULL   PIC  X  VALUE  ' '.
  3080   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3081   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3082   02  DFHPEN    PIC  X  VALUE  '='.
  3083   02  DFHOPID   PIC  X  VALUE  'W'.
  3084   02  DFHPA1    PIC  X  VALUE  '%'.
  3085   02  DFHPA2    PIC  X  VALUE  '>'.
  3086   02  DFHPA3    PIC  X  VALUE  ','.
  3087   02  DFHPF1    PIC  X  VALUE  '1'.
  3088   02  DFHPF2    PIC  X  VALUE  '2'.
  3089   02  DFHPF3    PIC  X  VALUE  '3'.
  3090   02  DFHPF4    PIC  X  VALUE  '4'.
  3091   02  DFHPF5    PIC  X  VALUE  '5'.
  3092   02  DFHPF6    PIC  X  VALUE  '6'.
  3093   02  DFHPF7    PIC  X  VALUE  '7'.
  3094   02  DFHPF8    PIC  X  VALUE  '8'.
  3095   02  DFHPF9    PIC  X  VALUE  '9'.
  3096   02  DFHPF10   PIC  X  VALUE  ':'.
  3097   02  DFHPF11   PIC  X  VALUE  '#'.
  3098   02  DFHPF12   PIC  X  VALUE  '@'.
  3099   02  DFHPF13   PIC  X  VALUE  'A'.
  3100   02  DFHPF14   PIC  X  VALUE  'B'.
  3101   02  DFHPF15   PIC  X  VALUE  'C'.
  3102   02  DFHPF16   PIC  X  VALUE  'D'.
  3103   02  DFHPF17   PIC  X  VALUE  'E'.
  3104   02  DFHPF18   PIC  X  VALUE  'F'.
  3105   02  DFHPF19   PIC  X  VALUE  'G'.
  3106   02  DFHPF20   PIC  X  VALUE  'H'.
  3107   02  DFHPF21   PIC  X  VALUE  'I'.
  3108*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3109   02  DFHPF22   PIC  X  VALUE  '['.
  3110   02  DFHPF23   PIC  X  VALUE  '.'.
  3111   02  DFHPF24   PIC  X  VALUE  '<'.
  3112   02  DFHMSRE   PIC  X  VALUE  'X'.
  3113   02  DFHSTRF   PIC  X  VALUE  'h'.
  3114   02  DFHTRIG   PIC  X  VALUE  '"'.
  3115
  3116 01  FILLER    REDEFINES DFHAID.
  3117     12  FILLER              PIC X(8).
  3118     12  PF-VALUES           PIC X       OCCURS 12.
  3119
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  59
* EL130.cbl
  3121****************************************************************
  3122*
  3123* Copyright (c) 2007 by Clerity Solutions, Inc.
  3124* All rights reserved.
  3125*
  3126****************************************************************
  3127 01  DFHEIV.
  3128   02  DFHEIV0               PIC X(35).
  3129   02  DFHEIV1               PIC X(08).
  3130   02  DFHEIV2               PIC X(08).
  3131   02  DFHEIV3               PIC X(08).
  3132   02  DFHEIV4               PIC X(06).
  3133   02  DFHEIV5               PIC X(04).
  3134   02  DFHEIV6               PIC X(04).
  3135   02  DFHEIV7               PIC X(02).
  3136   02  DFHEIV8               PIC X(02).
  3137   02  DFHEIV9               PIC X(01).
  3138   02  DFHEIV10              PIC S9(7) COMP-3.
  3139   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3140   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3141   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3142   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3143   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3144   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3145   02  DFHEIV17              PIC X(04).
  3146   02  DFHEIV18              PIC X(04).
  3147   02  DFHEIV19              PIC X(04).
  3148   02  DFHEIV20              USAGE IS POINTER.
  3149   02  DFHEIV21              USAGE IS POINTER.
  3150   02  DFHEIV22              USAGE IS POINTER.
  3151   02  DFHEIV23              USAGE IS POINTER.
  3152   02  DFHEIV24              USAGE IS POINTER.
  3153   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3154   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3155   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3156   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3157   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3158   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3159   02  FILLER                PIC X(02).
  3160   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3161   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3162   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3163   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3164   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3165 LINKAGE  SECTION.
  3166*****************************************************************
  3167*                                                               *
  3168* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3169* All rights reserved.                                          *
  3170*                                                               *
  3171*****************************************************************
  3172 01  dfheiblk.
  3173     02  eibtime          pic s9(7) comp-3.
  3174     02  eibdate          pic s9(7) comp-3.
  3175     02  eibtrnid         pic x(4).
  3176     02  eibtaskn         pic s9(7) comp-3.
  3177     02  eibtrmid         pic x(4).
  3178     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  60
* EL130.cbl
  3179     02  eibcposn         pic s9(4) comp.
  3180     02  eibcalen         pic s9(4) comp.
  3181     02  eibaid           pic x(1).
  3182     02  eibfiller1       pic x(1).
  3183     02  eibfn            pic x(2).
  3184     02  eibfiller2       pic x(2).
  3185     02  eibrcode         pic x(6).
  3186     02  eibfiller3       pic x(2).
  3187     02  eibds            pic x(8).
  3188     02  eibreqid         pic x(8).
  3189     02  eibrsrce         pic x(8).
  3190     02  eibsync          pic x(1).
  3191     02  eibfree          pic x(1).
  3192     02  eibrecv          pic x(1).
  3193     02  eibsend          pic x(1).
  3194     02  eibatt           pic x(1).
  3195     02  eibeoc           pic x(1).
  3196     02  eibfmh           pic x(1).
  3197     02  eibcompl         pic x(1).
  3198     02  eibsig           pic x(1).
  3199     02  eibconf          pic x(1).
  3200     02  eiberr           pic x(1).
  3201     02  eibrldbk         pic x(1).
  3202     02  eiberrcd         pic x(4).
  3203     02  eibsynrb         pic x(1).
  3204     02  eibnodat         pic x(1).
  3205     02  eibfiller5       pic x(2).
  3206     02  eibresp          pic 9(09) comp.
  3207     02  eibresp2         pic 9(09) comp.
  3208     02  dfheigdj         pic s9(4) comp.
  3209     02  dfheigdk         pic s9(4) comp.
  3210
  3211 01  DFHCOMMAREA             PIC X(1024).
  3212
  3213*01 PARMLIST .
  3214*    02  FILLER              PIC S9(8)   COMP.
  3215*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3216*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3217*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3218*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3219*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3220*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3221*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3222*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3223*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  61
* EL130.cbl
  3225*    COPY ELCMSTR.
  3226******************************************************************
  3227*                                                                *
  3228*                            ELCMSTR.                            *
  3229*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3230*                            VMOD=2.012                          *
  3231*                                                                *
  3232*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3233*                                                                *
  3234*   FILE TYPE = VSAM,KSDS                                        *
  3235*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3236*                                                                *
  3237*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3238*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3239*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3240*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3241*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3242*                                                 RKP=75,LEN=21  *
  3243*                                                                *
  3244*   **** NOTE ****                                               *
  3245*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3246*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3247*                                                                *
  3248*   LOG = YES                                                    *
  3249*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3250******************************************************************
  3251*                   C H A N G E   L O G
  3252*
  3253* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3254*-----------------------------------------------------------------
  3255*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3256* EFFECTIVE    NUMBER
  3257*-----------------------------------------------------------------
  3258* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3259* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3260* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3261* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3262* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3263******************************************************************
  3264 01  CLAIM-MASTER.
  3265     12  CL-RECORD-ID                PIC XX.
  3266         88  VALID-CL-ID         VALUE 'CL'.
  3267
  3268     12  CL-CONTROL-PRIMARY.
  3269         16  CL-COMPANY-CD           PIC X.
  3270         16  CL-CARRIER              PIC X.
  3271         16  CL-CLAIM-NO             PIC X(7).
  3272         16  CL-CERT-NO.
  3273             20  CL-CERT-PRIME       PIC X(10).
  3274             20  CL-CERT-SFX         PIC X.
  3275
  3276     12  CL-CONTROL-BY-NAME.
  3277         16  CL-COMPANY-CD-A1        PIC X.
  3278         16  CL-INSURED-LAST-NAME    PIC X(15).
  3279         16  CL-INSURED-NAME.
  3280             20  CL-INSURED-1ST-NAME PIC X(12).
  3281             20  CL-INSURED-MID-INIT PIC X.
  3282
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  62
* EL130.cbl
  3283     12  CL-CONTROL-BY-SSN.
  3284         16  CL-COMPANY-CD-A2        PIC X.
  3285         16  CL-SOC-SEC-NO.
  3286             20  CL-SSN-STATE        PIC XX.
  3287             20  CL-SSN-ACCOUNT      PIC X(6).
  3288             20  CL-SSN-LN3          PIC X(3).
  3289
  3290     12  CL-CONTROL-BY-CERT-NO.
  3291         16  CL-COMPANY-CD-A4        PIC X.
  3292         16  CL-CERT-NO-A4.
  3293             20  CL-CERT-A4-PRIME    PIC X(10).
  3294             20  CL-CERT-A4-SFX      PIC X.
  3295
  3296     12  CL-CONTROL-BY-CCN.
  3297         16  CL-COMPANY-CD-A5        PIC X.
  3298         16  CL-CCN-A5.
  3299             20  CL-CCN.
  3300                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3301                 24  CL-CCN-PRIME-A5 PIC X(12).
  3302             20  CL-CCN-FILLER-A5    PIC X(4).
  3303
  3304     12  CL-INSURED-PROFILE-DATA.
  3305         16  CL-INSURED-BIRTH-DT     PIC XX.
  3306         16  CL-INSURED-SEX-CD       PIC X.
  3307             88  INSURED-IS-MALE        VALUE 'M'.
  3308             88  INSURED-IS-FEMALE      VALUE 'F'.
  3309             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3310         16  CL-INSURED-OCC-CD       PIC X(6).
  3311         16  FILLER                  PIC X(5).
  3312
  3313     12  CL-PROCESSING-INFO.
  3314         16  CL-PROCESSOR-ID         PIC X(4).
  3315         16  CL-CLAIM-STATUS         PIC X.
  3316             88  CLAIM-IS-OPEN          VALUE 'O'.
  3317             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3318         16  CL-CLAIM-TYPE           PIC X.
  3319*            88  AH-CLAIM               VALUE 'A'.
  3320*            88  LIFE-CLAIM             VALUE 'L'.
  3321*            88  PROPERTY-CLAIM         VALUE 'P'.
  3322*            88  IUI-CLAIM              VALUE 'I'.
  3323*            88  GAP-CLAIM              VALUE 'G'.
  3324*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3325         16  CL-CLAIM-PREM-TYPE      PIC X.
  3326             88  SINGLE-PREMIUM         VALUE '1'.
  3327             88  O-B-COVERAGE           VALUE '2'.
  3328             88  OPEN-END-COVERAGE      VALUE '3'.
  3329         16  CL-INCURRED-DT          PIC XX.
  3330         16  CL-REPORTED-DT          PIC XX.
  3331         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3332         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3333         16  CL-LAST-PMT-DT          PIC XX.
  3334         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3335         16  CL-PAID-THRU-DT         PIC XX.
  3336         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3337         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3338         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3339         16  CL-PMT-CALC-METHOD      PIC X.
  3340             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  63
* EL130.cbl
  3341             88  CL-365-DAY-YR          VALUE '2'.
  3342             88  CL-FULL-MONTHS         VALUE '3'.
  3343         16  CL-CAUSE-CD             PIC X(6).
  3344
  3345         16  CL-PRIME-CERT-NO.
  3346             20  CL-PRIME-CERT-PRIME PIC X(10).
  3347             20  CL-PRIME-CERT-SFX   PIC X.
  3348
  3349         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3350             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3351             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3352
  3353         16  CL-MICROFILM-NO         PIC X(10).
  3354         16  FILLER REDEFINES CL-MICROFILM-NO.
  3355             20  CL-BENEFIT-PERIOD   PIC 99.
  3356             20  FILLER              PIC X(8).
  3357         16  CL-PROG-FORM-TYPE       PIC X.
  3358         16  CL-LAST-ADD-ON-DT       PIC XX.
  3359
  3360         16  CL-LAST-REOPEN-DT       PIC XX.
  3361         16  CL-LAST-CLOSE-DT        PIC XX.
  3362         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3363             88  FINAL-PAID             VALUE '1'.
  3364             88  CLAIM-DENIED           VALUE '2'.
  3365             88  AUTO-CLOSE             VALUE '3'.
  3366             88  MANUAL-CLOSE           VALUE '4'.
  3367             88  BENEFITS-CHANGED       VALUE 'C'.
  3368             88  SETUP-ERRORS           VALUE 'E'.
  3369         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3370         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3371         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3372             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3373         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3374         16  FILLER                  PIC X.
  3375
  3376     12  CL-CERTIFICATE-DATA.
  3377         16  CL-CERT-ORIGIN          PIC X.
  3378             88  CERT-WAS-ONLINE        VALUE '1'.
  3379             88  CERT-WAS-CREATED       VALUE '2'.
  3380             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3381         16  CL-CERT-KEY-DATA.
  3382             20  CL-CERT-CARRIER     PIC X.
  3383             20  CL-CERT-GROUPING    PIC X(6).
  3384             20  CL-CERT-STATE       PIC XX.
  3385             20  CL-CERT-ACCOUNT.
  3386                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3387                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3388             20  CL-CERT-EFF-DT      PIC XX.
  3389
  3390     12  CL-STATUS-CONTROLS.
  3391         16  CL-PRIORITY-CD          PIC X.
  3392             88  CONFIDENTIAL-DATA      VALUE '8'.
  3393             88  HIGHEST-PRIORITY       VALUE '9'.
  3394         16  CL-SUPV-ATTN-CD         PIC X.
  3395             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3396             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3397         16  CL-PURGED-DT            PIC XX.
  3398         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  64
* EL130.cbl
  3399         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3400         16  CL-NEXT-RESEND-DT       PIC XX.
  3401         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3402         16  CL-CRITICAL-PERIOD      PIC 99.
  3403*        16  FILLER                  PIC XX.
  3404         16  CL-LAST-MAINT-DT        PIC XX.
  3405         16  CL-LAST-MAINT-USER      PIC X(4).
  3406         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3407         16  CL-LAST-MAINT-TYPE      PIC X.
  3408             88  CLAIM-SET-UP           VALUE ' '.
  3409             88  PAYMENT-MADE           VALUE '1'.
  3410             88  LETTER-SENT            VALUE '2'.
  3411             88  MASTER-WAS-ALTERED     VALUE '3'.
  3412             88  MASTER-WAS-RESTORED    VALUE '4'.
  3413             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3414             88  FILE-CONVERTED         VALUE '6'.
  3415             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3416             88  ERROR-CORRECTION       VALUE 'E'.
  3417         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3418         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3419         16  CL-BENEFICIARY          PIC X(10).
  3420         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3421         16  CL-DENIAL-TYPE          PIC X.
  3422             88  CL-TYPE-DENIAL          VALUE '1'.
  3423             88  CL-TYPE-RESCISSION      VALUE '2'.
  3424             88  CL-TYPE-REFORMATION     VALUE '3'.
  3425             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3426             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3427         16  filler                  pic x(5).
  3428*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3429*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3430*        16  CL-RTW-DT               PIC XX.
  3431
  3432     12  CL-TRAILER-CONTROLS.
  3433         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3434             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3435             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3436             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3437         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3438         16  FILLER                  PIC XX.
  3439         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3440         16  CL-ADDRESS-TRAILER-CNT.
  3441             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3442                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3443             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3444                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3445             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3446                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3447             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3448                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3449             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3450                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3451             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3452                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3453             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3454                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3455
  3456     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  65
* EL130.cbl
  3457         16  CL-CV-REFNO-PRIME       PIC X(18).
  3458         16  CL-CV-REFNO-SFX         PIC XX.
  3459
  3460     12  CL-FILE-LOCATION            PIC X(4).
  3461
  3462     12  CL-PROCESS-ERRORS.
  3463         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3464             88  NO-FATAL-ERRORS        VALUE ZERO.
  3465         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3466             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3467
  3468     12  CL-PRODUCT-CD               PIC X.
  3469
  3470     12  CL-CURRENT-KEY-DATA.
  3471         16  CL-CURRENT-CARRIER      PIC X.
  3472         16  CL-CURRENT-GROUPING     PIC X(6).
  3473         16  CL-CURRENT-STATE        PIC XX.
  3474         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3475
  3476     12  CL-ASSOCIATES               PIC X.
  3477         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3478         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3479         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3480         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3481
  3482     12  CL-ACTIVITY-CODE            PIC 99.
  3483     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3484     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3485
  3486     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3487     12  CL-LAG-REPORT-CODE          PIC 9.
  3488     12  CL-LOAN-TYPE                PIC XX.
  3489     12  CL-LEGAL-STATE              PIC XX.
  3490
  3491     12  CL-YESNOSW                  PIC X.
  3492     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3493         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3494         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3495         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3496     12  cl-insured-type             pic x.
  3497         88  cl-claim-on-primary         value 'P'.
  3498         88  cl-claim-on-co-borrower     value 'C'.
  3499     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  66
* EL130.cbl
  3501*    COPY ELCCNTL.
  3502******************************************************************
  3503*                                                                *
  3504*                                                                *
  3505*                            ELCCNTL.                            *
  3506*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3507*                            VMOD=2.059                          *
  3508*                                                                *
  3509*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3510*                                                                *
  3511*   FILE TYPE = VSAM,KSDS                                        *
  3512*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3513*                                                                *
  3514*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3515*       ALTERNATE INDEX = NONE                                   *
  3516*                                                                *
  3517*   LOG = YES                                                    *
  3518*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3519******************************************************************
  3520*                   C H A N G E   L O G
  3521*
  3522* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3523*-----------------------------------------------------------------
  3524*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3525* EFFECTIVE    NUMBER
  3526*-----------------------------------------------------------------
  3527* 082503                   PEMA  ADD BENEFIT GROUP
  3528* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3529* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3530* 092705    2005050300006  PEMA  ADD SPP LEASES
  3531* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3532* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3533* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3534* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3535* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3536* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3537* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3538* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3539* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3540* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3541******************************************************************
  3542*
  3543 01  CONTROL-FILE.
  3544     12  CF-RECORD-ID                       PIC XX.
  3545         88  VALID-CF-ID                        VALUE 'CF'.
  3546
  3547     12  CF-CONTROL-PRIMARY.
  3548         16  CF-COMPANY-ID                  PIC XXX.
  3549         16  CF-RECORD-TYPE                 PIC X.
  3550             88  CF-COMPANY-MASTER              VALUE '1'.
  3551             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3552             88  CF-STATE-MASTER                VALUE '3'.
  3553             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3554             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3555             88  CF-CARRIER-MASTER              VALUE '6'.
  3556             88  CF-MORTALITY-MASTER            VALUE '7'.
  3557             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3558             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  67
* EL130.cbl
  3559             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3560             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3561             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3562             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3563             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3564             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3565             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3566             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3567             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3568         16  CF-ACCESS-CD-GENL              PIC X(4).
  3569         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3570             20  CF-PROCESSOR               PIC X(4).
  3571         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3572             20  CF-STATE-CODE              PIC XX.
  3573             20  FILLER                     PIC XX.
  3574         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3575             20  FILLER                     PIC XX.
  3576             20  CF-HI-BEN-IN-REC           PIC XX.
  3577         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3578             20  FILLER                     PIC XXX.
  3579             20  CF-CARRIER-CNTL            PIC X.
  3580         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3581             20  FILLER                     PIC XX.
  3582             20  CF-HI-TYPE-IN-REC          PIC 99.
  3583         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3584             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3585                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3586             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3587             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3588         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3589             20  FILLER                     PIC X.
  3590             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3591         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3592             20  FILLER                     PIC XX.
  3593             20  CF-MORTGAGE-PLAN           PIC XX.
  3594         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3595
  3596     12  CF-LAST-MAINT-DT                   PIC XX.
  3597     12  CF-LAST-MAINT-BY                   PIC X(4).
  3598     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3599
  3600     12  CF-RECORD-BODY                     PIC X(728).
  3601
  3602
  3603****************************************************************
  3604*             COMPANY MASTER RECORD                            *
  3605****************************************************************
  3606
  3607     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3608         16  CF-COMPANY-ADDRESS.
  3609             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3610             20  CF-CL-IN-CARE-OF           PIC X(30).
  3611             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3612             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3613             20  CF-CL-CITY-STATE           PIC X(30).
  3614             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3615             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3616         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  68
* EL130.cbl
  3617         16  CF-COMPANY-PASSWORD            PIC X(8).
  3618         16  CF-SECURITY-OPTION             PIC X.
  3619             88  ALL-SECURITY                   VALUE '1'.
  3620             88  COMPANY-VERIFY                 VALUE '2'.
  3621             88  PROCESSOR-VERIFY               VALUE '3'.
  3622             88  NO-SECURITY                    VALUE '4'.
  3623             88  ALL-BUT-TERM                   VALUE '5'.
  3624         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3625             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3626         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3627             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3628         16  CF-INFORCE-LOCATION            PIC X.
  3629             88  CERTS-ARE-ONLINE               VALUE '1'.
  3630             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3631             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3632         16  CF-LOWER-CASE-LETTERS          PIC X.
  3633         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3634             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3635             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3636             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3637             88  CF-ACCNT-CNTL                  VALUE '3'.
  3638             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3639
  3640         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3641         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3642
  3643         16  CF-LGX-CREDIT-USER             PIC X.
  3644             88  CO-IS-NOT-USER                 VALUE 'N'.
  3645             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3646
  3647         16 CF-CREDIT-CALC-CODES.
  3648             20  CF-CR-REM-TERM-CALC PIC X.
  3649               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3650               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3651               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3652               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3653               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3654               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3655               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3656             20  CF-CR-R78-METHOD           PIC X.
  3657               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3658               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3659
  3660         16  CF-CLAIM-CONTROL-COUNTS.
  3661             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3662                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3663
  3664             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3665                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3666
  3667             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3668                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3669
  3670             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3671                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3672
  3673         16  CF-CURRENT-MONTH-END           PIC XX.
  3674
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  69
* EL130.cbl
  3675         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3676             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3677             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3678             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3679             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3680                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3681                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3682             20  CF-CO-PREM-REJECT-SW       PIC X.
  3683                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3684                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3685             20  CF-CO-REF-REJECT-SW        PIC X.
  3686                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3687                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3688
  3689         16  CF-CO-REPORTING-DT             PIC XX.
  3690         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3691         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3692           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3693           88  CF-CO-MONTH-END                  VALUE '1'.
  3694
  3695         16  CF-LGX-CLAIM-USER              PIC X.
  3696             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3697             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3698
  3699         16  CF-CREDIT-EDIT-CONTROLS.
  3700             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3701             20  CF-MIN-AGE                 PIC 99.
  3702             20  CF-DEFAULT-AGE             PIC 99.
  3703             20  CF-MIN-TERM                PIC S999      COMP-3.
  3704             20  CF-MAX-TERM                PIC S999      COMP-3.
  3705             20  CF-DEFAULT-SEX             PIC X.
  3706             20  CF-JOINT-AGE-INPUT         PIC X.
  3707                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3708             20  CF-BIRTH-DATE-INPUT        PIC X.
  3709                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3710             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3711                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3712                 88  CF-ZERO-CARRIER            VALUE '1'.
  3713                 88  CF-ZERO-GROUPING           VALUE '2'.
  3714                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3715             20  CF-EDIT-SW                 PIC X.
  3716                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3717             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3718             20  CF-CR-PR-METHOD            PIC X.
  3719               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3720               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3721             20  FILLER                     PIC X.
  3722
  3723         16  CF-CREDIT-MISC-CONTROLS.
  3724             20  CF-REIN-TABLE-SW           PIC X.
  3725                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3726             20  CF-COMP-TABLE-SW           PIC X.
  3727                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3728             20  CF-EXPERIENCE-RETENTION-AGE
  3729                                            PIC S9        COMP-3.
  3730             20  CF-CONVERSION-DT           PIC XX.
  3731             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3732             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  70
* EL130.cbl
  3733                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3734                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3735
  3736             20  CF-CR-CHECK-NO-CONTROL.
  3737                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3738                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3739                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3740                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3741                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3742                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3743
  3744                 24  CF-CR-CHECK-COUNT       REDEFINES
  3745                     CF-CR-CHECK-COUNTER      PIC X(4).
  3746
  3747                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3748                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3749
  3750                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3751                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3752                 24  CF-MAIL-PROCESSING       PIC X.
  3753                     88  MAIL-PROCESSING          VALUE 'Y'.
  3754
  3755         16  CF-MISC-SYSTEM-CONTROL.
  3756             20  CF-SYSTEM-C                 PIC X.
  3757                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3758             20  CF-SYSTEM-D                 PIC X.
  3759                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3760             20  CF-SOC-SEC-NO-SW            PIC X.
  3761                 88  SOC-SEC-NO-USED             VALUE '1'.
  3762             20  CF-MEMBER-NO-SW             PIC X.
  3763                 88  MEMBER-NO-USED              VALUE '1'.
  3764             20  CF-TAX-ID-NUMBER            PIC X(11).
  3765             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3766             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3767                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3768                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3769                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3770                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3771             20  CF-SYSTEM-E                 PIC X.
  3772                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3773
  3774         16  CF-LGX-LIFE-USER               PIC X.
  3775             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3776             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3777
  3778         16  CF-CR-MONTH-END-DT             PIC XX.
  3779
  3780         16  CF-FILE-MAINT-DATES.
  3781             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3782                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3783             20  CF-LAST-BATCH       REDEFINES
  3784                 CF-LAST-BATCH-NO               PIC X(4).
  3785             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3786             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3787             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3788             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3789             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3790             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  71
* EL130.cbl
  3791             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3792             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3793             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3794             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3795
  3796         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3797         16  FILLER                         PIC X.
  3798
  3799         16  CF-ALT-MORT-CODE               PIC X(4).
  3800         16  CF-MEMBER-CAPTION              PIC X(10).
  3801
  3802         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3803             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3804             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3805             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3806             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3807             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3808
  3809         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3810
  3811         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3812         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3813         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3814         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3815
  3816         16  CF-AH-OVERRIDE-L1              PIC X.
  3817         16  CF-AH-OVERRIDE-L2              PIC XX.
  3818         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3819         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3820
  3821         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3822         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3823
  3824         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3825         16  CF-AR-LAST-EL860-DT            PIC XX.
  3826         16  CF-MP-MONTH-END-DT             PIC XX.
  3827
  3828         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3829         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3830             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3831
  3832         16  CF-AR-MONTH-END-DT             PIC XX.
  3833
  3834         16  CF-CRDTCRD-USER                PIC X.
  3835             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3836             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3837
  3838         16  CF-CC-MONTH-END-DT             PIC XX.
  3839
  3840         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3841
  3842         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3843             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3844             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3845             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3846         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3847         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3848         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  72
* EL130.cbl
  3849         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3850             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3851             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3852         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3853         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3854         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3855             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3856         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3857
  3858         16  CF-CL-ZIP-CODE.
  3859             20  CF-CL-ZIP-PRIME.
  3860                 24  CF-CL-ZIP-1ST          PIC X.
  3861                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3862                 24  FILLER                 PIC X(4).
  3863             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3864         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3865             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3866             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3867             20  FILLER                     PIC XXX.
  3868
  3869         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3870         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3871         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3872         16  CF-CO-OPTION-START-DATE        PIC XX.
  3873         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3874           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3875                                                      '3' '4'.
  3876           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3877           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3878           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3879           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3880           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3881           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3882
  3883         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3884
  3885         16  CF-PAYMENT-APPROVAL-LEVELS.
  3886             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3887             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3888             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3889             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3890             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3891             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3892
  3893         16  CF-END-USER-REPORTING-USER     PIC X.
  3894             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3895             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3896
  3897         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3898             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3899             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3900
  3901         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3902
  3903         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3904         16  FILLER                         PIC X.
  3905
  3906         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  73
* EL130.cbl
  3907             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3908             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3909             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3910
  3911         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3912
  3913         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3914             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3915             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3916
  3917         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3918             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3919             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3920
  3921         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3922
  3923         16  CF-CO-ACH-ID-CODE              PIC  X.
  3924             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3925             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3926             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3927         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3928         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3929         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3930         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3931         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3932         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3933         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3934         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3935         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3936                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3937         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3938                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3939
  3940         16  CF-CO-OVER-SHORT.
  3941             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3942             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3943
  3944*         16  FILLER                         PIC X(102).
  3945         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3946             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3947             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3948
  3949         16  CF-AH-APPROVAL-DAYS.
  3950             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3951             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3952             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3953             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3954
  3955         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3956
  3957         16  CF-APPROV-LEV-5.
  3958             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3959             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3960             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3961
  3962         16  FILLER                         PIC X(68).
  3963****************************************************************
  3964*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  74
* EL130.cbl
  3965****************************************************************
  3966
  3967     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3968         16  CF-PROCESSOR-NAME              PIC X(30).
  3969         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3970         16  CF-PROCESSOR-TITLE             PIC X(26).
  3971         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3972                 88  MESSAGE-YES                VALUE 'Y'.
  3973                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3974
  3975*****************************************************
  3976****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3977****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3978****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3979****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3980*****************************************************
  3981
  3982         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3983             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3984             20  CF-APPLICATION-FORCE       PIC X.
  3985             20  CF-INDIVIDUAL-APP.
  3986                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3987                     28  CF-BROWSE-APP      PIC X.
  3988                     28  CF-UPDATE-APP      PIC X.
  3989
  3990         16  CF-CURRENT-TERM-ON             PIC X(4).
  3991         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3992             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3993             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3994             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3995             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3996             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3997             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3998             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3999         16  CF-PROCESSOR-CARRIER           PIC X.
  4000             88  NO-CARRIER-SECURITY            VALUE ' '.
  4001         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4002             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4003         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4004             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4005         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4006             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4007
  4008         16  CF-PROC-SYS-ACCESS-SW.
  4009             20  CF-PROC-CREDIT-CLAIMS-SW.
  4010                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4011                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4012                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4013                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4014             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4015                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4016                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4017             20  CF-PROC-LIFE-GNRLDGR-SW.
  4018                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4019                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4020                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4021                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4022             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  75
* EL130.cbl
  4023                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4024                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4025         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4026             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4027             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4028         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4029
  4030         16  CF-APPROVAL-LEVEL                  PIC X.
  4031             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4032             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4033             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4034             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4035             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4036
  4037         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4038
  4039         16  CF-LANGUAGE-TYPE                   PIC X.
  4040             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4041             88  CF-LANG-IS-FR                      VALUE 'F'.
  4042
  4043         16  CF-CSR-IND                         PIC X.
  4044         16  FILLER                             PIC X(239).
  4045
  4046****************************************************************
  4047*             PROCESSOR/REMINDERS RECORD                       *
  4048****************************************************************
  4049
  4050     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4051         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4052             20  CF-START-REMIND-DT         PIC XX.
  4053             20  CF-END-REMIND-DT           PIC XX.
  4054             20  CF-REMINDER-TEXT           PIC X(50).
  4055         16  FILLER                         PIC X(296).
  4056
  4057
  4058****************************************************************
  4059*             STATE MASTER RECORD                              *
  4060****************************************************************
  4061
  4062     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4063         16  CF-STATE-ABBREVIATION          PIC XX.
  4064         16  CF-STATE-NAME                  PIC X(25).
  4065         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4066         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4067             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4068             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4069             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4070             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4071                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4072                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4073             20  CF-ST-PREM-REJECT-SW       PIC X.
  4074                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4075                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4076             20  CF-ST-REF-REJECT-SW        PIC X.
  4077                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4078                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4079         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4080         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  76
* EL130.cbl
  4081         16  CF-ST-REFUND-RULES.
  4082             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4083             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4084             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4085         16  CF-ST-FST-PMT-EXTENSION.
  4086             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4087             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4088                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4089                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4090                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4091                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4092         16  CF-ST-STATE-CALL.
  4093             20  CF-ST-CALL-UNEARNED        PIC X.
  4094             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4095             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4096         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4097             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4098             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4099         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4100         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4101         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4102         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4103         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4104         16  FILLER                         PIC X.
  4105         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4106             20  CF-ST-BENEFIT-CD           PIC XX.
  4107             20  CF-ST-BENEFIT-KIND         PIC X.
  4108                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4109                 88  CF-ST-AH-KIND              VALUE 'A'.
  4110             20  CF-ST-REM-TERM-CALC        PIC X.
  4111                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4112                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4113                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4114                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4115                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4116                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4117                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4118                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4119
  4120             20  CF-ST-REFUND-CALC          PIC X.
  4121                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4122                 88  ST-REFD-BY-R78             VALUE '1'.
  4123                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4124                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4125                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4126                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4127                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4128                 88  ST-REFD-UTAH               VALUE '7'.
  4129                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4130                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4131                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4132
  4133             20  CF-ST-EARNING-CALC         PIC X.
  4134                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4135                 88  ST-EARN-BY-R78             VALUE '1'.
  4136                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4137                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4138                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  77
* EL130.cbl
  4139                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4140                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4141                 88  ST-EARN-MEAN               VALUE '8'.
  4142                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4143
  4144             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4145                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4146                 88  ST-OVRD-BY-R78             VALUE '1'.
  4147                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4148                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4149                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4150                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4151                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4152                 88  ST-OVRD-MEAN               VALUE '8'.
  4153                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4154             20  FILLER                     PIC X.
  4155
  4156         16  CF-ST-COMMISSION-CAPS.
  4157             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4158             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4159             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4160             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4161         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4162                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4163
  4164         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4165
  4166         16  CF-ST-STATUTORY-INTEREST.
  4167             20  CF-ST-STAT-DATE-FROM       PIC X.
  4168                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4169                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4170             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4171             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4172             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4173             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4174             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4175
  4176         16  CF-ST-OVER-SHORT.
  4177             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4178             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4179
  4180         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4181
  4182         16  CF-ST-RT-CALC                  PIC X.
  4183
  4184         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4185         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4186         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4187         16  CF-ST-RF-LR-CALC               PIC X.
  4188         16  CF-ST-RF-LL-CALC               PIC X.
  4189         16  CF-ST-RF-LN-CALC               PIC X.
  4190         16  CF-ST-RF-AH-CALC               PIC X.
  4191         16  CF-ST-RF-CP-CALC               PIC X.
  4192*        16  FILLER                         PIC X(206).
  4193*CIDMOD         16  FILLER                         PIC X(192).
  4194         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4195             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4196         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  78
* EL130.cbl
  4197         16  CF-ST-VFY-2ND-BENE             PIC X.
  4198         16  CF-ST-CAUSAL-STATE             PIC X.
  4199         16  FILLER                         PIC X(185).
  4200
  4201****************************************************************
  4202*             BENEFIT MASTER RECORD                            *
  4203****************************************************************
  4204
  4205     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4206         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4207             20  CF-BENEFIT-CODE            PIC XX.
  4208             20  CF-BENEFIT-NUMERIC  REDEFINES
  4209                 CF-BENEFIT-CODE            PIC XX.
  4210             20  CF-BENEFIT-ALPHA           PIC XXX.
  4211             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4212             20  CF-BENEFIT-COMMENT         PIC X(10).
  4213
  4214             20  CF-LF-COVERAGE-TYPE        PIC X.
  4215                 88  CF-REDUCING                VALUE 'R'.
  4216                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4217
  4218             20  CF-SPECIAL-CALC-CD         PIC X.
  4219                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4220                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4221                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4222                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4223                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4224                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4225                 88  CF-FARM-PLAN               VALUE 'F'.
  4226                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4227                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4228                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4229                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4230                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4231                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4232                 88  CF-PRUDENTIAL              VALUE 'P'.
  4233                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4234                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4235                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4236                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4237                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4238                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4239
  4240             20  CF-JOINT-INDICATOR         PIC X.
  4241                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4242
  4243*            20  FILLER                     PIC X(12).
  4244             20  cf-maximum-benefits        pic s999 comp-3.
  4245             20  FILLER                     PIC X(09).
  4246             20  CF-BENEFIT-CATEGORY        PIC X.
  4247             20  CF-LOAN-TYPE               PIC X(8).
  4248
  4249             20  CF-CO-REM-TERM-CALC        PIC X.
  4250                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4251                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4252                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4253                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4254                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  79
* EL130.cbl
  4255
  4256             20  CF-CO-EARNINGS-CALC        PIC X.
  4257                 88  CO-EARN-BY-R78             VALUE '1'.
  4258                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4259                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4260                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4261                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4262                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4263                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4264                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4265
  4266             20  CF-CO-REFUND-CALC          PIC X.
  4267                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4268                 88  CO-REFD-BY-R78             VALUE '1'.
  4269                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4270                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4271                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4272                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4273                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4274                 88  CO-REFD-MEAN               VALUE '8'.
  4275                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4276                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4277                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4278
  4279             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4280                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4281                 88  CO-OVRD-BY-R78             VALUE '1'.
  4282                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4283                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4284                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4285                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4286                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4287                 88  CO-OVRD-MEAN               VALUE '8'.
  4288                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4289
  4290             20  CF-CO-BEN-I-G-CD           PIC X.
  4291                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4292                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4293                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4294
  4295         16  FILLER                         PIC X(304).
  4296
  4297
  4298****************************************************************
  4299*             CARRIER MASTER RECORD                            *
  4300****************************************************************
  4301
  4302     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4303         16  CF-ADDRESS-DATA.
  4304             20  CF-MAIL-TO-NAME            PIC X(30).
  4305             20  CF-IN-CARE-OF              PIC X(30).
  4306             20  CF-ADDRESS-LINE-1          PIC X(30).
  4307             20  CF-ADDRESS-LINE-2          PIC X(30).
  4308             20  CF-CITY-STATE              PIC X(30).
  4309             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4310             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4311
  4312         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  80
* EL130.cbl
  4313             20  CF-CLAIM-NO-METHOD         PIC X.
  4314                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4315                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4316                 88  CLAIM-NO-SEQ               VALUE '3'.
  4317                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4318             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4319                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4320                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4321                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4322
  4323         16  CF-CHECK-NO-CONTROL.
  4324             20  CF-CHECK-NO-METHOD         PIC X.
  4325                 88  CHECK-NO-MANUAL            VALUE '1'.
  4326                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4327                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4328                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4329             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4330                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4331
  4332         16  CF-DOMICILE-STATE              PIC XX.
  4333
  4334         16  CF-EXPENSE-CONTROLS.
  4335             20  CF-EXPENSE-METHOD          PIC X.
  4336                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4337                 88  DOLLARS-PER-PMT            VALUE '2'.
  4338                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4339                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4340             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4341             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4342
  4343         16  CF-CORRESPONDENCE-CONTROL.
  4344             20  CF-LETTER-RESEND-OPT       PIC X.
  4345                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4346                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4347             20  FILLER                     PIC X(4).
  4348
  4349         16  CF-RESERVE-CONTROLS.
  4350             20  CF-MANUAL-SW               PIC X.
  4351                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4352             20  CF-FUTURE-SW               PIC X.
  4353                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4354             20  CF-PTC-SW                  PIC X.
  4355                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4356             20  CF-IBNR-SW                 PIC X.
  4357                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4358             20  CF-PTC-LF-SW               PIC X.
  4359                 88  CF-LF-PTC-USED             VALUE '1'.
  4360             20  CF-CDT-ACCESS-METHOD       PIC X.
  4361                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4362                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4363                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4364             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4365
  4366         16  CF-CLAIM-CALC-METHOD           PIC X.
  4367             88  360-PLUS-MONTHS                VALUE '1'.
  4368             88  365-PLUS-MONTHS                VALUE '2'.
  4369             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4370             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  81
* EL130.cbl
  4371             88  365-DAILY                      VALUE '5'.
  4372
  4373         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4374         16  FILLER                         PIC X(11).
  4375
  4376         16  CF-LIMIT-AMOUNTS.
  4377             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4378             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4379             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4380             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4381             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4382             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4383             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4384             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4385             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4386             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4387
  4388         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4389         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4390         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4391
  4392         16  CF-ZIP-CODE.
  4393             20  CF-ZIP-PRIME.
  4394                 24  CF-ZIP-1ST             PIC X.
  4395                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4396                 24  FILLER                 PIC X(4).
  4397             20  CF-ZIP-PLUS4               PIC X(4).
  4398         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4399             20  CF-CAN-POSTAL-1            PIC XXX.
  4400             20  CF-CAN-POSTAL-2            PIC XXX.
  4401             20  FILLER                     PIC XXX.
  4402
  4403         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4404         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4405         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4406
  4407         16  CF-RATING-SWITCH               PIC X.
  4408             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4409             88  CF-NO-RATING                   VALUE 'N'.
  4410
  4411         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4412
  4413         16  CF-CARRIER-OVER-SHORT.
  4414             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4415             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4416
  4417         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4418         16  CF-SECPAY-SWITCH               PIC X.
  4419             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4420             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4421         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4422         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4423         16  FILLER                         PIC X(444).
  4424*        16  FILLER                         PIC X(452).
  4425
  4426
  4427****************************************************************
  4428*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  82
* EL130.cbl
  4429****************************************************************
  4430
  4431     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4432         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4433                                INDEXED BY CF-MORT-NDX.
  4434             20  CF-MORT-TABLE              PIC X(5).
  4435             20  CF-MORT-TABLE-TYPE         PIC X.
  4436                 88  CF-MORT-JOINT              VALUE 'J'.
  4437                 88  CF-MORT-SINGLE             VALUE 'S'.
  4438                 88  CF-MORT-COMBINED           VALUE 'C'.
  4439                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4440                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4441             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4442             20  CF-MORT-AGE-METHOD         PIC XX.
  4443                 88  CF-AGE-LAST                VALUE 'AL'.
  4444                 88  CF-AGE-NEAR                VALUE 'AN'.
  4445             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4446             20  CF-MORT-ADJUSTMENT-DIRECTION
  4447                                            PIC X.
  4448                 88  CF-MINUS                   VALUE '-'.
  4449                 88  CF-PLUS                    VALUE '+'.
  4450             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4451             20  CF-MORT-JOINT-CODE         PIC X.
  4452                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4453             20  CF-MORT-PC-Q               PIC X.
  4454                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4455             20  CF-MORT-TABLE-CODE         PIC X(4).
  4456             20  CF-MORT-COMMENTS           PIC X(15).
  4457             20  FILLER                     PIC X(14).
  4458
  4459         16  FILLER                         PIC X(251).
  4460
  4461
  4462****************************************************************
  4463*             BUSSINESS TYPE MASTER RECORD                     *
  4464****************************************************************
  4465
  4466     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4467* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4468* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4469* AND RECORD 05 IS TYPES 81-99
  4470         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4471             20  CF-BUSINESS-TITLE          PIC  X(19).
  4472             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4473                                            PIC S9V9(4) COMP-3.
  4474             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4475             20  FILLER                     PIC  X.
  4476         16  FILLER                         PIC  X(248).
  4477
  4478
  4479****************************************************************
  4480*             TERMINAL MASTER RECORD                           *
  4481****************************************************************
  4482
  4483     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4484
  4485         16  CF-COMPANY-TERMINALS.
  4486             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  83
* EL130.cbl
  4487                                  PIC X(4).
  4488         16  FILLER               PIC X(248).
  4489
  4490
  4491****************************************************************
  4492*             LIFE EDIT MASTER RECORD                          *
  4493****************************************************************
  4494
  4495     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4496         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4497             20  CF-LIFE-CODE-IN            PIC XX.
  4498             20  CF-LIFE-CODE-OUT           PIC XX.
  4499         16  FILLER                         PIC X(248).
  4500
  4501
  4502****************************************************************
  4503*             AH EDIT MASTER RECORD                            *
  4504****************************************************************
  4505
  4506     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4507         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4508             20  CF-AH-CODE-IN              PIC XXX.
  4509             20  CF-AH-CODE-OUT             PIC XX.
  4510         16  FILLER                         PIC X(248).
  4511
  4512
  4513****************************************************************
  4514*             CREDIBILITY TABLES                               *
  4515****************************************************************
  4516
  4517     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4518         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4519                             INDEXED BY CF-CRDB-NDX.
  4520             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4521             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4522             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4523         16  FILLER                         PIC  X(332).
  4524
  4525
  4526****************************************************************
  4527*             REPORT CUSTOMIZATION RECORD                      *
  4528****************************************************************
  4529
  4530     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4531         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4532             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4533             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4534             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4535**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4536****       A T-TRANSFER.                                   ****
  4537             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4538
  4539         16  FILLER                         PIC XX.
  4540
  4541         16  CF-CARRIER-CNTL-OPT.
  4542             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4543                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4544                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  84
* EL130.cbl
  4545             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4546                                            PIC X.
  4547         16  CF-GROUP-CNTL-OPT.
  4548             20  CF-GROUP-OPT-SEQ           PIC 9.
  4549                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4550                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4551             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4552                                            PIC X(6).
  4553         16  CF-STATE-CNTL-OPT.
  4554             20  CF-STATE-OPT-SEQ           PIC 9.
  4555                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4556                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4557             20  CF-STATE-SELECT OCCURS 3 TIMES
  4558                                            PIC XX.
  4559         16  CF-ACCOUNT-CNTL-OPT.
  4560             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4561                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4562                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4563             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4564                                            PIC X(10).
  4565         16  CF-BUS-TYP-CNTL-OPT.
  4566             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4567                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4568                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4569             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4570                                            PIC XX.
  4571         16  CF-LF-TYP-CNTL-OPT.
  4572             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4573                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4574                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4575             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4576                                            PIC XX.
  4577         16  CF-AH-TYP-CNTL-OPT.
  4578             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4579                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4580                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4581             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4582                                            PIC XX.
  4583         16  CF-REPTCD1-CNTL-OPT.
  4584             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4585                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4586                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4587             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4588                                            PIC X(10).
  4589         16  CF-REPTCD2-CNTL-OPT.
  4590             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4591                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4592                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4593             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4594                                            PIC X(10).
  4595         16  CF-USER1-CNTL-OPT.
  4596             20  CF-USER1-OPT-SEQ           PIC 9.
  4597                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4598                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4599             20  CF-USER1-SELECT OCCURS 3 TIMES
  4600                                            PIC X(10).
  4601         16  CF-USER2-CNTL-OPT.
  4602             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  85
* EL130.cbl
  4603                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4604                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4605             20  CF-USER2-SELECT OCCURS 3 TIMES
  4606                                            PIC X(10).
  4607         16  CF-USER3-CNTL-OPT.
  4608             20  CF-USER3-OPT-SEQ           PIC 9.
  4609                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4610                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4611             20  CF-USER3-SELECT OCCURS 3 TIMES
  4612                                            PIC X(10).
  4613         16  CF-USER4-CNTL-OPT.
  4614             20  CF-USER4-OPT-SEQ           PIC 9.
  4615                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4616                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4617             20  CF-USER4-SELECT OCCURS 3 TIMES
  4618                                            PIC X(10).
  4619         16  CF-USER5-CNTL-OPT.
  4620             20  CF-USER5-OPT-SEQ           PIC 9.
  4621                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4622                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4623             20  CF-USER5-SELECT OCCURS 3 TIMES
  4624                                            PIC X(10).
  4625         16  CF-REINS-CNTL-OPT.
  4626             20  CF-REINS-OPT-SEQ           PIC 9.
  4627                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4628                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4629             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4630                 24  CF-REINS-PRIME         PIC XXX.
  4631                 24  CF-REINS-SUB           PIC XXX.
  4632
  4633         16  CF-AGENT-CNTL-OPT.
  4634             20  CF-AGENT-OPT-SEQ           PIC 9.
  4635                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4636                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4637             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4638                                            PIC X(10).
  4639
  4640         16  FILLER                         PIC X(43).
  4641
  4642         16  CF-LOSS-RATIO-SELECT.
  4643             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4644             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4645         16  CF-ENTRY-DATE-SELECT.
  4646             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4647             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4648         16  CF-EFFECTIVE-DATE-SELECT.
  4649             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4650             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4651
  4652         16  CF-EXCEPTION-LIST-IND          PIC X.
  4653             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4654
  4655         16  FILLER                         PIC X(318).
  4656
  4657****************************************************************
  4658*                  EXCEPTION REPORTING RECORD                  *
  4659****************************************************************
  4660
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  86
* EL130.cbl
  4661     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4662         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4663             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4664
  4665         16  CF-COMBINED-LIFE-AH-OPT.
  4666             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4667             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4668             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4669             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4670
  4671         16  CF-LIFE-OPT.
  4672             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4673             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4674             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4675             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4676             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4677             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4678             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4679             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4680             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4681             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4682
  4683         16  CF-AH-OPT.
  4684             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4685             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4686             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4687             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4688             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4689             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4690             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4691             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4692             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4693             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4694
  4695         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4696             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4697             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4698             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4699
  4700         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4701
  4702         16  FILLER                         PIC X(673).
  4703
  4704
  4705****************************************************************
  4706*             MORTGAGE SYSTEM PLAN RECORD                      *
  4707****************************************************************
  4708
  4709     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4710         16  CF-PLAN-TYPE                   PIC X.
  4711             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4712             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4713             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4714         16  CF-PLAN-ABBREV                 PIC XXX.
  4715         16  CF-PLAN-DESCRIPT               PIC X(10).
  4716         16  CF-PLAN-NOTES                  PIC X(20).
  4717         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4718         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  87
* EL130.cbl
  4719             20  CF-PLAN-TERM-DATA.
  4720                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4721                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4722             20  CF-PLAN-AGE-DATA.
  4723                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4724                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4725                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4726             20  CF-PLAN-BENEFIT-DATA.
  4727                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4728                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4729                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4730                                            PIC S9(7)V99  COMP-3.
  4731         16  CF-PLAN-POLICY-FORMS.
  4732             20  CF-POLICY-FORM             PIC X(12).
  4733             20  CF-MASTER-APPLICATION      PIC X(12).
  4734             20  CF-MASTER-POLICY           PIC X(12).
  4735         16  CF-PLAN-RATING.
  4736             20  CF-RATE-CODE               PIC X(5).
  4737             20  CF-SEX-RATING              PIC X.
  4738                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4739                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4740             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4741             20  CF-SUB-STD-TYPE            PIC X.
  4742                 88  CF-PCT-OF-PREM            VALUE '1'.
  4743                 88  CF-PCT-OF-BENE            VALUE '2'.
  4744         16  CF-PLAN-PREM-TOLERANCES.
  4745             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4746             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4747         16  CF-PLAN-PYMT-TOLERANCES.
  4748             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4749             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4750         16  CF-PLAN-MISC-DATA.
  4751             20  FILLER                     PIC X.
  4752             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4753             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4754         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4755         16  CF-PLAN-IND-GRP                PIC X.
  4756             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4757                                                     '1'.
  4758             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4759                                                     '2'.
  4760         16  CF-MIB-SEARCH-SW               PIC X.
  4761             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4762             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4763             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4764             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4765         16  CF-ALPHA-SEARCH-SW             PIC X.
  4766             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4767             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4768             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4769             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4770             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4771             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4772             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4773             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4774             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4775             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4776                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  88
* EL130.cbl
  4777                                                     'X' 'Y' 'Z'.
  4778         16  CF-EFF-DT-RULE-SW              PIC X.
  4779             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4780             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4781             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4782             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4783             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4784         16  FILLER                         PIC X(4).
  4785         16  CF-HEALTH-QUESTIONS            PIC X.
  4786             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4787         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4788         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4789         16  CF-PLAN-SNGL-JNT               PIC X.
  4790             88  CF-COMBINED-PLAN              VALUE 'C'.
  4791             88  CF-JNT-PLAN                   VALUE 'J'.
  4792             88  CF-SNGL-PLAN                  VALUE 'S'.
  4793         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4794         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4795         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4796         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4797         16  CF-RERATE-CNTL                 PIC  X.
  4798             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4799             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4800             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4801             88  CF-AUTO-RECALC                 VALUE '4'.
  4802         16  CF-BENEFIT-TYPE                PIC  X.
  4803             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4804             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4805         16  CF-POLICY-FEE                  PIC S999V99
  4806                                                    COMP-3.
  4807         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4808         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4809         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4810         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4811         16  FILLER                         PIC  X(32).
  4812         16  CF-TERMINATION-FORM            PIC  X(04).
  4813         16  FILLER                         PIC  X(08).
  4814         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4815                                                       COMP-3.
  4816         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4817         16  CF-ISSUE-LETTER                PIC  X(4).
  4818         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4819         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4820             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4821             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4822         16  CF-MP-REFUND-CALC              PIC X.
  4823             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4824             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4825             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4826             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4827             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4828             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4829             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4830             88  CF-MP-REFD-MEAN                VALUE '8'.
  4831         16  CF-ALT-RATE-CODE               PIC  X(5).
  4832
  4833
  4834         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  89
* EL130.cbl
  4835****************************************************************
  4836*             MORTGAGE COMPANY MASTER RECORD                   *
  4837****************************************************************
  4838
  4839     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4840         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4841         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4842             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4843             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4844             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4845             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4846             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4847
  4848         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4849         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4850         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4851         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4852         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4853
  4854         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4855             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4856         16  CF-MP-RECON-USE-IND            PIC X(1).
  4857             88  CF-MP-USE-RECON             VALUE 'Y'.
  4858         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4859             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4860         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4861             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4862             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4863         16  FILLER                         PIC X(1).
  4864         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4865             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4866         16  CF-MORTG-MIB-VERSION           PIC X.
  4867             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4868             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4869             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4870         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4871             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4872                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4873             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4874                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4875             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4876                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4877             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4878                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4879             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4880                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4881             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4882                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4883         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4884         16  FILLER                         PIC X(7).
  4885         16  CF-MORTG-DESTINATION-SYMBOL.
  4886             20  CF-MORTG-MIB-COMM          PIC X(5).
  4887             20  CF-MORTG-MIB-TERM          PIC X(5).
  4888         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4889             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4890         16  FILLER                         PIC X(03).
  4891         16  CF-MP-CHECK-NO-CONTROL.
  4892             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  90
* EL130.cbl
  4893                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4894                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4895                                                ' ' LOW-VALUES.
  4896                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4897                                               VALUE '3'.
  4898         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4899         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4900         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4901             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4902                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4903             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4904                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4905             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4906                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4907             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4908                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4909             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4910                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4911             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4912                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4913         16  CF-MORTG-BILLING-AREA.
  4914             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4915                                            PIC X.
  4916         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4917         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4918         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4919         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4920             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4921             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4922         16  FILLER                         PIC X.
  4923         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4924             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4925             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4926         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4927         16  FILLER                         PIC X(8).
  4928         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4929         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4930         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4931         16  CF-ACH-COMPANY-ID.
  4932             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4933                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4934                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4935                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4936             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4937         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4938             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4939         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4940             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4941             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4942         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4943         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4944         16  FILLER                         PIC X(536).
  4945
  4946****************************************************************
  4947*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4948****************************************************************
  4949
  4950     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  91
* EL130.cbl
  4951         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4952             20  CF-FEMALE-HEIGHT.
  4953                 24  CF-FEMALE-FT           PIC 99.
  4954                 24  CF-FEMALE-IN           PIC 99.
  4955             20  CF-FEMALE-MIN-WT           PIC 999.
  4956             20  CF-FEMALE-MAX-WT           PIC 999.
  4957         16  FILLER                         PIC X(428).
  4958
  4959     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4960         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4961             20  CF-MALE-HEIGHT.
  4962                 24  CF-MALE-FT             PIC 99.
  4963                 24  CF-MALE-IN             PIC 99.
  4964             20  CF-MALE-MIN-WT             PIC 999.
  4965             20  CF-MALE-MAX-WT             PIC 999.
  4966         16  FILLER                         PIC X(428).
  4967******************************************************************
  4968*             AUTOMATIC ACTIVITY RECORD                          *
  4969******************************************************************
  4970     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4971         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4972             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4973             20  CF-SYS-LETTER-ID           PIC X(04).
  4974             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4975             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4976             20  CF-SYS-RESET-SW            PIC X(01).
  4977             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4978             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4979
  4980         16  FILLER                         PIC X(50).
  4981
  4982         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4983             20  CF-USER-ACTIVE-SW          PIC X(01).
  4984             20  CF-USER-LETTER-ID          PIC X(04).
  4985             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4986             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4987             20  CF-USER-RESET-SW           PIC X(01).
  4988             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4989             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4990             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4991
  4992         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  92
* EL130.cbl
  4994*    COPY ELCCERT.
  4995******************************************************************
  4996*                                                                *
  4997*                            ELCCERT.                            *
  4998*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4999*                            VMOD=2.013                          *
  5000*                                                                *
  5001*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5002*                                                                *
  5003*   FILE TYPE = VSAM,KSDS                                        *
  5004*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5005*                                                                *
  5006*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5007*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5008*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5009*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5010*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5011*                                                                *
  5012*   LOG = YES                                                    *
  5013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5014******************************************************************
  5015*                   C H A N G E   L O G
  5016*
  5017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5018*-----------------------------------------------------------------
  5019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5020* EFFECTIVE    NUMBER
  5021*-----------------------------------------------------------------
  5022* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5023* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5024* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5025* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5026* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5027* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5028* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5029* 032612  CR2011110200001  PEMA  AHL CHANGES
  5030* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5031******************************************************************
  5032
  5033 01  CERTIFICATE-MASTER.
  5034     12  CM-RECORD-ID                      PIC XX.
  5035         88  VALID-CM-ID                      VALUE 'CM'.
  5036
  5037     12  CM-CONTROL-PRIMARY.
  5038         16  CM-COMPANY-CD                 PIC X.
  5039         16  CM-CARRIER                    PIC X.
  5040         16  CM-GROUPING.
  5041             20  CM-GROUPING-PREFIX        PIC X(3).
  5042             20  CM-GROUPING-PRIME         PIC X(3).
  5043         16  CM-STATE                      PIC XX.
  5044         16  CM-ACCOUNT.
  5045             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5046             20  CM-ACCOUNT-PRIME          PIC X(6).
  5047         16  CM-CERT-EFF-DT                PIC XX.
  5048         16  CM-CERT-NO.
  5049             20  CM-CERT-PRIME             PIC X(10).
  5050             20  CM-CERT-SFX               PIC X.
  5051
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  93
* EL130.cbl
  5052     12  CM-CONTROL-BY-NAME.
  5053         16  CM-COMPANY-CD-A1              PIC X.
  5054         16  CM-INSURED-LAST-NAME          PIC X(15).
  5055         16  CM-INSURED-INITIALS.
  5056             20  CM-INSURED-INITIAL1       PIC X.
  5057             20  CM-INSURED-INITIAL2       PIC X.
  5058
  5059     12  CM-CONTROL-BY-SSN.
  5060         16  CM-COMPANY-CD-A2              PIC X.
  5061         16  CM-SOC-SEC-NO.
  5062             20  CM-SSN-STATE              PIC XX.
  5063             20  CM-SSN-ACCOUNT            PIC X(6).
  5064             20  CM-SSN-LN3.
  5065                 25  CM-INSURED-INITIALS-A2.
  5066                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5067                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5068                 25 CM-PART-LAST-NAME-A2         PIC X.
  5069
  5070     12  CM-CONTROL-BY-CERT-NO.
  5071         16  CM-COMPANY-CD-A4              PIC X.
  5072         16  CM-CERT-NO-A4                 PIC X(11).
  5073
  5074     12  CM-CONTROL-BY-MEMB.
  5075         16  CM-COMPANY-CD-A5              PIC X.
  5076         16  CM-MEMBER-NO.
  5077             20  CM-MEMB-STATE             PIC XX.
  5078             20  CM-MEMB-ACCOUNT           PIC X(6).
  5079             20  CM-MEMB-LN4.
  5080                 25  CM-INSURED-INITIALS-A5.
  5081                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5082                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5083                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5084
  5085     12  CM-INSURED-PROFILE-DATA.
  5086         16  CM-INSURED-FIRST-NAME.
  5087             20  CM-INSURED-1ST-INIT       PIC X.
  5088             20  FILLER                    PIC X(9).
  5089         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5090         16  CM-INSURED-SEX                PIC X.
  5091             88  CM-SEX-MALE                  VALUE 'M'.
  5092             88  CM-SEX-FEMAL                 VALUE 'F'.
  5093         16  CM-INSURED-JOINT-AGE          PIC 99.
  5094         16  CM-JOINT-INSURED-NAME.
  5095             20  CM-JT-LAST-NAME           PIC X(15).
  5096             20  CM-JT-FIRST-NAME.
  5097                 24  CM-JT-1ST-INIT        PIC X.
  5098                 24  FILLER                PIC X(9).
  5099             20  CM-JT-INITIAL             PIC X.
  5100
  5101     12  CM-LIFE-DATA.
  5102         16  CM-LF-BENEFIT-CD              PIC XX.
  5103         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5104         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5105         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5106         16  CM-LF-DEV-CODE                PIC XXX.
  5107         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5108         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5109         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  94
* EL130.cbl
  5110         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5111         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5112         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5113         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5114         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5115         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5116         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5117         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5118         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5119         16  cm-temp-epiq                  pic xx.
  5120             88  EPIQ-CLASS                  value 'EQ'.
  5121*        16  FILLER                        PIC XX.
  5122
  5123     12  CM-AH-DATA.
  5124         16  CM-AH-BENEFIT-CD              PIC XX.
  5125         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5126         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5127         16  CM-AH-DEV-CODE                PIC XXX.
  5128         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5129         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5130         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5131         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5132         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5133         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5134         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5135         16  CM-AH-PAID-THRU-DT            PIC XX.
  5136             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5137         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5138         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5139         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5140         16  FILLER                        PIC X.
  5141
  5142     12  CM-LOAN-INFORMATION.
  5143         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5144         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5145                                           PIC S9(5)V99  COMP-3.
  5146         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5147         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5148         16  CM-PAY-FREQUENCY              PIC S99.
  5149         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5150         16  CM-RATE-CLASS                 PIC XX.
  5151         16  CM-BENEFICIARY                PIC X(25).
  5152         16  CM-POLICY-FORM-NO             PIC X(12).
  5153         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5154         16  CM-LAST-ADD-ON-DT             PIC XX.
  5155         16  CM-DEDUCTIBLE-AMOUNTS.
  5156             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5157             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5158         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5159             20  CM-RESIDENT-STATE         PIC XX.
  5160             20  CM-RATE-CODE              PIC X(4).
  5161             20  FILLER                    PIC XX.
  5162         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5163             20  CM-LOAN-OFFICER           PIC X(5).
  5164             20  FILLER                    PIC XXX.
  5165         16  CM-CSR-CODE                   PIC XXX.
  5166         16  CM-UNDERWRITING-CODE          PIC X.
  5167             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  95
* EL130.cbl
  5168         16  CM-POST-CARD-IND              PIC X.
  5169         16  CM-NH-INTERFACE-SW            PIC X.
  5170         16  CM-PREMIUM-TYPE               PIC X.
  5171             88  CM-SING-PRM                  VALUE '1'.
  5172             88  CM-O-B-COVERAGE              VALUE '2'.
  5173             88  CM-OPEN-END                  VALUE '3'.
  5174         16  CM-IND-GRP-TYPE               PIC X.
  5175             88  CM-INDIVIDUAL                VALUE 'I'.
  5176             88  CM-GROUP                     VALUE 'G'.
  5177         16  CM-SKIP-CODE                  PIC X.
  5178             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5179             88  SKIP-JULY                    VALUE '1'.
  5180             88  SKIP-AUGUST                  VALUE '2'.
  5181             88  SKIP-SEPTEMBER               VALUE '3'.
  5182             88  SKIP-JULY-AUG                VALUE '4'.
  5183             88  SKIP-AUG-SEPT                VALUE '5'.
  5184             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5185             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5186             88  SKIP-JUNE                    VALUE '8'.
  5187             88  SKIP-JUNE-JULY               VALUE '9'.
  5188             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5189             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5190         16  CM-PAYMENT-MODE               PIC X.
  5191             88  PAY-MONTHLY                  VALUE SPACE.
  5192             88  PAY-WEEKLY                   VALUE '1'.
  5193             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5194             88  PAY-BI-WEEKLY                VALUE '3'.
  5195             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5196         16  CM-LOAN-NUMBER                PIC X(8).
  5197         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5198         16  CM-OLD-LOF                    PIC XXX.
  5199*        16  CM-LOAN-OFFICER               PIC XXX.
  5200         16  CM-REIN-TABLE                 PIC XXX.
  5201         16  CM-SPECIAL-REIN-CODE          PIC X.
  5202         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5203         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5204         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5205
  5206     12  CM-STATUS-DATA.
  5207         16  CM-ENTRY-STATUS               PIC X.
  5208         16  CM-ENTRY-DT                   PIC XX.
  5209
  5210         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5211         16  CM-LF-CANCEL-DT               PIC XX.
  5212         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5213
  5214         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5215         16  CM-LF-DEATH-DT                PIC XX.
  5216         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5217
  5218         16  CM-LF-CURRENT-STATUS          PIC X.
  5219             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5220                                                'M' '4' '5' '9'.
  5221             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5222             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5223             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5224             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5225             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  96
* EL130.cbl
  5226             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5227             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5228             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5229             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5230             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5231             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5232             88  CM-LF-DECLINED               VALUE 'D'.
  5233             88  CM-LF-VOIDED                 VALUE 'V'.
  5234
  5235         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5236         16  CM-AH-CANCEL-DT               PIC XX.
  5237         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5238
  5239         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5240         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5241         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5242
  5243         16  CM-AH-CURRENT-STATUS          PIC X.
  5244             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5245                                                'M' '4' '5' '9'.
  5246             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5247             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5248             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5249             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5250             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5251             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5252             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5253             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5254             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5255             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5256             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5257             88  CM-AH-DECLINED               VALUE 'D'.
  5258             88  CM-AH-VOIDED                 VALUE 'V'.
  5259
  5260         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5261             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5262             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5263             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5264         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5265
  5266         16  CM-ENTRY-BATCH                PIC X(6).
  5267         16  CM-LF-EXIT-BATCH              PIC X(6).
  5268         16  CM-AH-EXIT-BATCH              PIC X(6).
  5269         16  CM-LAST-MONTH-END             PIC XX.
  5270
  5271     12  CM-NOTE-SW                        PIC X.
  5272         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5273         88  CERT-NOTES-PRESENT               VALUE '1'.
  5274         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5275         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5276         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5277         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5278         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5279         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5280     12  CM-COMP-EXCP-SW                   PIC X.
  5281         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5282         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5283     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  97
* EL130.cbl
  5284         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5285         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5286
  5287*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5288     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5289     12  FILLER                            PIC X.
  5290
  5291*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5292     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5293     12  FILLER                            PIC X.
  5294*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5295     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5296
  5297     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5298         88  CERT-ADDED-BATCH                 VALUE ' '.
  5299         88  CERT-ADDED-ONLINE                VALUE '1'.
  5300         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5301         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5302         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5303     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5304         88  CERT-AS-LOADED                   VALUE ' '.
  5305         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5306         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5307         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5308         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5309         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5310         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5311         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5312
  5313     12  CM-ACCOUNT-COMM-PCTS.
  5314         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5315         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5316
  5317     12  CM-USER-FIELD                     PIC X.
  5318     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5319     12  CM-CLP-STATE                      PIC XX.
  5320     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5321     12  CM-USER-RESERVED                  PIC XXX.
  5322     12  FILLER REDEFINES CM-USER-RESERVED.
  5323         16  CM-AH-CLASS-CD                PIC XX.
  5324         16  F                             PIC X.
  5325******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  98
* EL130.cbl
  5327*    COPY ERCACCT.
  5328******************************************************************
  5329*                                                                *
  5330*                                                                *
  5331*                            ERCACCT                             *
  5332*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5333*                            VMOD=2.031                          *
  5334*                                                                *
  5335*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5336*                                                                *
  5337*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5338*   VSAM ACCOUNT MASTER FILES.                                   *
  5339*                                                                *
  5340*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5341*                                                                *
  5342*   FILE TYPE = VSAM,KSDS                                        *
  5343*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5344*                                                                *
  5345*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5346*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5347*                                                                *
  5348*   LOG = NO                                                     *
  5349*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5350*                                                                *
  5351*                                                                *
  5352******************************************************************
  5353*                   C H A N G E   L O G
  5354*
  5355* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5356*-----------------------------------------------------------------
  5357*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5358* EFFECTIVE    NUMBER
  5359*-----------------------------------------------------------------
  5360* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5361* 092705    2005050300006  PEMA  ADD SPP LEASES
  5362* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5363* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5364* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5365* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5366* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5367******************************************************************
  5368
  5369 01  ACCOUNT-MASTER.
  5370     12  AM-RECORD-ID                      PIC XX.
  5371         88  VALID-AM-ID                      VALUE 'AM'.
  5372
  5373     12  AM-CONTROL-PRIMARY.
  5374         16  AM-COMPANY-CD                 PIC X.
  5375         16  AM-MSTR-CNTRL.
  5376             20  AM-CONTROL-A.
  5377                 24  AM-CARRIER            PIC X.
  5378                 24  AM-GROUPING.
  5379                     28 AM-GROUPING-PREFIX PIC XXX.
  5380                     28 AM-GROUPING-PRIME  PIC XXX.
  5381                 24  AM-STATE              PIC XX.
  5382                 24  AM-ACCOUNT.
  5383                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5384                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page  99
* EL130.cbl
  5385             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5386                                           PIC X(19).
  5387             20  AM-CNTRL-B.
  5388                 24  AM-EXPIRATION-DT      PIC XX.
  5389                 24  FILLER                PIC X(4).
  5390             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5391                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5392
  5393     12  AM-CONTROL-BY-VAR-GRP.
  5394         16  AM-COMPANY-CD-A1              PIC X.
  5395         16  AM-VG-CARRIER                 PIC X.
  5396         16  AM-VG-GROUPING                PIC X(6).
  5397         16  AM-VG-STATE                   PIC XX.
  5398         16  AM-VG-ACCOUNT                 PIC X(10).
  5399         16  AM-VG-DATE.
  5400             20  AM-VG-EXPIRATION-DT       PIC XX.
  5401             20  FILLER                    PIC X(4).
  5402         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5403                                           PIC 9(11)      COMP-3.
  5404     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5405         16  FILLER                        PIC X(10).
  5406         16  AM-VG-KEY3.
  5407             20  AM-VG3-ACCOUNT            PIC X(10).
  5408             20  AM-VG3-EXP-DT             PIC XX.
  5409         16  FILLER                        PIC X(4).
  5410     12  AM-MAINT-INFORMATION.
  5411         16  AM-LAST-MAINT-DT              PIC XX.
  5412         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5413         16  AM-LAST-MAINT-USER            PIC X(4).
  5414         16  FILLER                        PIC XX.
  5415
  5416     12  AM-EFFECTIVE-DT                   PIC XX.
  5417     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5418
  5419     12  AM-PREV-DATES  COMP-3.
  5420         16  AM-PREV-EXP-DT                PIC 9(11).
  5421         16  AM-PREV-EFF-DT                PIC 9(11).
  5422
  5423     12  AM-REPORT-CODE-1                  PIC X(10).
  5424     12  AM-REPORT-CODE-2                  PIC X(10).
  5425
  5426     12  AM-CITY-CODE                      PIC X(4).
  5427     12  AM-COUNTY-PARISH                  PIC X(6).
  5428
  5429     12  AM-NAME                           PIC X(30).
  5430     12  AM-PERSON                         PIC X(30).
  5431     12  AM-ADDRS                          PIC X(30).
  5432     12  AM-CITY.
  5433         16  AM-ADDR-CITY                  PIC X(28).
  5434         16  AM-ADDR-STATE                 PIC XX.
  5435     12  AM-ZIP.
  5436         16  AM-ZIP-PRIME.
  5437             20  AM-ZIP-PRI-1ST            PIC X.
  5438                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5439             20  FILLER                    PIC X(4).
  5440         16  AM-ZIP-PLUS4                  PIC X(4).
  5441     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5442         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 100
* EL130.cbl
  5443         16  AM-CAN-POSTAL-2               PIC XXX.
  5444         16  FILLER                        PIC XXX.
  5445     12  AM-TEL-NO.
  5446         16  AM-AREA-CODE                  PIC 999.
  5447         16  AM-TEL-PRE                    PIC 999.
  5448         16  AM-TEL-NBR                    PIC 9(4).
  5449     12  AM-TEL-LOC                        PIC X.
  5450         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5451         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5452
  5453     12  AM-COMM-STRUCTURE.
  5454         16  AM-DEFN-1.
  5455             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5456                 24  AM-AGT.
  5457                     28  AM-AGT-PREFIX     PIC X(4).
  5458                     28  AM-AGT-PRIME      PIC X(6).
  5459                 24  AM-COM-TYP            PIC X.
  5460                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5461                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5462                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5463                 24  AM-RECALC-LV-INDIC    PIC X.
  5464                 24  AM-RETRO-LV-INDIC     PIC X.
  5465                 24  AM-GL-CODES           PIC X.
  5466                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5467                 24  FILLER                PIC X(01).
  5468         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5469             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5470                 24  FILLER                PIC X(11).
  5471                 24  AM-L-COMA             PIC XXX.
  5472                 24  AM-J-COMA             PIC XXX.
  5473                 24  AM-A-COMA             PIC XXX.
  5474                 24  FILLER                PIC X(6).
  5475
  5476     12  AM-COMM-CHANGE-STATUS             PIC X.
  5477         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5478
  5479     12  AM-CSR-CODE                       PIC X(4).
  5480
  5481     12  AM-BILLING-STATUS                 PIC X.
  5482         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5483         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5484     12  AM-AUTO-REFUND-SW                 PIC X.
  5485         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5486         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5487     12  AM-GPCD                           PIC 99.
  5488     12  AM-IG                             PIC X.
  5489         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5490         88  AM-HAS-GROUP                     VALUE '2'.
  5491     12  AM-STATUS                         PIC X.
  5492         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5493         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5494         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5495         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5496         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5497         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5498     12  AM-REMIT-TO                       PIC 99.
  5499     12  AM-ID-NO                          PIC X(11).
  5500
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 101
* EL130.cbl
  5501     12  AM-CAL-TABLE                      PIC XX.
  5502     12  AM-LF-DEVIATION                   PIC XXX.
  5503     12  AM-AH-DEVIATION                   PIC XXX.
  5504     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5505     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5506     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5507     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5508     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5509     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5510
  5511     12  AM-USER-FIELDS.
  5512         16  AM-FLD-1                      PIC XX.
  5513         16  AM-FLD-2                      PIC XX.
  5514         16  AM-FLD-3                      PIC XX.
  5515         16  AM-FLD-4                      PIC XX.
  5516         16  AM-FLD-5                      PIC XX.
  5517
  5518     12  AM-1ST-PROD-DATE.
  5519         16  AM-1ST-PROD-YR                PIC XX.
  5520         16  AM-1ST-PROD-MO                PIC XX.
  5521         16  AM-1ST-PROD-DA                PIC XX.
  5522     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5523     12  AM-CERTS-PURGED-DATE.
  5524         16  AM-PUR-YR                     PIC XX.
  5525         16  AM-PUR-MO                     PIC XX.
  5526         16  AM-PUR-DA                     PIC XX.
  5527     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5528     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5529     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5530     12  AM-INACTIVE-DATE.
  5531         16  AM-INA-MO                     PIC 99.
  5532         16  AM-INA-DA                     PIC 99.
  5533         16  AM-INA-YR                     PIC 99.
  5534     12  AM-AR-HI-CERT-DATE                PIC XX.
  5535
  5536     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5537     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5538
  5539     12  AM-OB-PAYMENT-MODE                PIC X.
  5540         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5541         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5542         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5543         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5544
  5545     12  AM-AH-ONLY-INDICATOR              PIC X.
  5546         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5547         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5548
  5549     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5550
  5551     12  AM-OVER-SHORT.
  5552         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5553         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5554
  5555     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5556     12  AM-DCC-CLP-STATE                  PIC XX.
  5557
  5558     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 102
* EL130.cbl
  5559     12  AM-RECALC-REIN                    PIC X.
  5560
  5561     12  AM-REI-TABLE                      PIC XXX.
  5562     12  AM-REI-ET-LF                      PIC X.
  5563     12  AM-REI-ET-AH                      PIC X.
  5564     12  AM-REI-PE-LF                      PIC X.
  5565     12  AM-REI-PE-AH                      PIC X.
  5566     12  AM-REI-PRT-ST                     PIC X.
  5567     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5568     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5569     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5570     12  AM-REI-GROUP-A                    PIC X(6).
  5571     12  AM-REI-MORT                       PIC X(4).
  5572     12  AM-REI-PRT-OW                     PIC X.
  5573     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5574     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5575     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5576     12  AM-REI-GROUP-B                    PIC X(6).
  5577
  5578     12  AM-TRUST-TYPE                     PIC X(2).
  5579
  5580     12  AM-EMPLOYER-STMT-USED             PIC X.
  5581     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5582
  5583     12  AM-STD-AH-TYPE                    PIC XX.
  5584     12  AM-EARN-METHODS.
  5585         16  AM-EARN-METHOD-R              PIC X.
  5586             88 AM-REF-RL-R78                 VALUE 'R'.
  5587             88 AM-REF-RL-PR                  VALUE 'P'.
  5588             88 AM-REF-RL-MEAN                VALUE 'M'.
  5589             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5590         16  AM-EARN-METHOD-L              PIC X.
  5591             88 AM-REF-LL-R78                 VALUE 'R'.
  5592             88 AM-REF-LL-PR                  VALUE 'P'.
  5593             88 AM-REF-LL-MEAN                VALUE 'M'.
  5594             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5595         16  AM-EARN-METHOD-A              PIC X.
  5596             88 AM-REF-AH-R78                 VALUE 'R'.
  5597             88 AM-REF-AH-PR                  VALUE 'P'.
  5598             88 AM-REF-AH-MEAN                VALUE 'M'.
  5599             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5600             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5601             88 AM-REF-AH-NET                 VALUE 'N'.
  5602
  5603     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5604     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5605     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5606
  5607     12  AM-RET-Y-N                        PIC X.
  5608     12  AM-RET-P-E                        PIC X.
  5609     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5610     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5611     12  AM-RET-GRP                        PIC X(6).
  5612     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5613         16  AM-POOL-PRIME                 PIC XXX.
  5614         16  AM-POOL-SUB                   PIC XXX.
  5615     12  AM-RETRO-EARNINGS.
  5616         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 103
* EL130.cbl
  5617         16  AM-RET-EARN-L                 PIC X.
  5618         16  AM-RET-EARN-A                 PIC X.
  5619     12  AM-RET-ST-TAX-USE                 PIC X.
  5620         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5621         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5622     12  AM-RETRO-BEG-EARNINGS.
  5623         16  AM-RET-BEG-EARN-R             PIC X.
  5624         16  AM-RET-BEG-EARN-L             PIC X.
  5625         16  AM-RET-BEG-EARN-A             PIC X.
  5626     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5627     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5628
  5629     12  AM-USER-SELECT-OPTIONS.
  5630         16  AM-USER-SELECT-1              PIC X(10).
  5631         16  AM-USER-SELECT-2              PIC X(10).
  5632         16  AM-USER-SELECT-3              PIC X(10).
  5633         16  AM-USER-SELECT-4              PIC X(10).
  5634         16  AM-USER-SELECT-5              PIC X(10).
  5635
  5636     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5637
  5638     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5639
  5640     12  AM-RPT045A-SWITCH                 PIC X.
  5641         88  RPT045A-OFF                   VALUE 'N'.
  5642
  5643     12  AM-INSURANCE-LIMITS.
  5644         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5645         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5646
  5647     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5648         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5649
  5650     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5651         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5652         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5653
  5654     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5655
  5656     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5657     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5658     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5659     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5660     12  AM-DCC-UEF-STATE                  PIC XX.
  5661     12  FILLER                            PIC XXX.
  5662     12  AM-REPORT-CODE-3                  PIC X(10).
  5663*    12  FILLER                            PIC X(22).
  5664
  5665     12  AM-RESERVE-DATE.
  5666         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5667         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5668         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5669
  5670     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5671     12  AM-NOTIFICATION-TYPES.
  5672         16  AM-NOTIF-OF-LETTERS           PIC X.
  5673         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5674         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 104
* EL130.cbl
  5675         16  AM-NOTIF-OF-STATUS            PIC X.
  5676
  5677     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5678         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5679         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5680         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5681         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5682
  5683     12  AM-BENEFIT-CONTROLS.
  5684         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5685             20  AM-BENEFIT-CODE           PIC XX.
  5686             20  AM-BENEFIT-TYPE           PIC X.
  5687             20  AM-BENEFIT-REVISION       PIC XXX.
  5688             20  AM-BENEFIT-REM-TERM       PIC X.
  5689             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5690             20  FILLER                    PIC XX.
  5691         16  FILLER                        PIC X(80).
  5692
  5693     12  AM-TRANSFER-DATA.
  5694         16  AM-TRANSFERRED-FROM.
  5695             20  AM-TRNFROM-CARRIER        PIC X.
  5696             20  AM-TRNFROM-GROUPING.
  5697                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5698                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5699             20  AM-TRNFROM-STATE          PIC XX.
  5700             20  AM-TRNFROM-ACCOUNT.
  5701                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5702                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5703             20  AM-TRNFROM-DTE            PIC XX.
  5704         16  AM-TRANSFERRED-TO.
  5705             20  AM-TRNTO-CARRIER          PIC X.
  5706             20  AM-TRNTO-GROUPING.
  5707                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5708                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5709             20  AM-TRNTO-STATE            PIC XX.
  5710             20  AM-TRNTO-ACCOUNT.
  5711                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5712                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5713             20  AM-TRNTO-DTE              PIC XX.
  5714         16  FILLER                        PIC X(10).
  5715
  5716     12  AM-SAVED-REMIT-TO                 PIC 99.
  5717
  5718     12  AM-COMM-STRUCTURE-SAVED.
  5719         16  AM-DEFN-1-SAVED.
  5720             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5721                 24  AM-AGT-SV             PIC X(10).
  5722                 24  AM-COM-TYP-SV         PIC X.
  5723                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5724                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5725                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5726                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5727                 24  FILLER                PIC X.
  5728                 24  AM-GL-CODES-SV        PIC X.
  5729                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5730                 24  FILLER                PIC X.
  5731         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5732             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 105
* EL130.cbl
  5733                 24  FILLER                PIC X(11).
  5734                 24  AM-L-COMA-SV          PIC XXX.
  5735                 24  AM-J-COMA-SV          PIC XXX.
  5736                 24  AM-A-COMA-SV          PIC XXX.
  5737                 24  FILLER                PIC X(6).
  5738
  5739     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5740         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5741            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5742            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5743            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5744
  5745     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5746     12  FILLER                            PIC X(120).
  5747
  5748     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5749         16  AM-CONTROL-NAME               PIC X(30).
  5750         16  AM-EXECUTIVE-ONE.
  5751             20  AM-EXEC1-NAME             PIC X(15).
  5752             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5753                                                          COMP-3.
  5754             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5755                                                          COMP-3.
  5756         16  AM-EXECUTIVE-TWO.
  5757             20  AM-EXEC2-NAME             PIC X(15).
  5758             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5759                                                          COMP-3.
  5760             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5761                                                          COMP-3.
  5762
  5763     12  AM-RETRO-ADDITIONAL-DATA.
  5764         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5765         16  AM-RETRO-PREM-P-E             PIC X.
  5766         16  AM-RETRO-CLMS-P-I             PIC X.
  5767         16  AM-RETRO-RET-BRACKET-LF.
  5768             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5769                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5770                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5771             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5772                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5773                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5774             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5775                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5776                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5777         16  AM-RETRO-RET-BRACKET-AH.
  5778             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5779                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5780                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5781                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5782             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5783                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5784                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5785             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5786                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5787                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5788
  5789     12  AM-COMMENTS.
  5790         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 106
* EL130.cbl
  5791
  5792     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5793         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5794         16  AM-FLI-BILLING-CODE           PIC X.
  5795         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5796         16  AM-FLI-UNITED-IDENT           PIC X.
  5797         16  AM-FLI-INTEREST-LOST-DATA.
  5798             20  AM-FLI-BANK-NO            PIC X(5).
  5799             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5800             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5801             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5802         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5803             20  AM-FLI-AGT                PIC X(9).
  5804             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5805             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5806         16  FILLER                        PIC X(102).
  5807
  5808     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5809         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5810             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5811             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5812             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5813             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5814             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5815         16  FILLER                          PIC X(10).
  5816******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 107
* EL130.cbl
  5818*    COPY ELCTRLR.
  5819******************************************************************
  5820*                                                                *
  5821*                            ELCTRLR.                            *
  5822*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5823*                            VMOD=2.014                          *
  5824*                                                                *
  5825*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5826*                                                                *
  5827*   FILE TYPE = VSAM,KSDS                                        *
  5828*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5829*                                                                *
  5830*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5831*       ALTERNATE INDEX = NONE                                   *
  5832*                                                                *
  5833*   LOG = YES                                                    *
  5834*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5835******************************************************************
  5836*                   C H A N G E   L O G
  5837*
  5838* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5839*-----------------------------------------------------------------
  5840*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5841* EFFECTIVE    NUMBER
  5842*-----------------------------------------------------------------
  5843* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5844* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5845* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5846* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5847* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5848* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5849* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5850* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5851* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5852* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5853* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5854* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5855* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5856* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5857* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5858* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5859* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5860* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5861* 040814    2014030500002  AJRA  ADD ICD CODES
  5862* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5863******************************************************************
  5864 01  ACTIVITY-TRAILERS.
  5865     12  AT-RECORD-ID                    PIC XX.
  5866         88  VALID-AT-ID                       VALUE 'AT'.
  5867
  5868     12  AT-CONTROL-PRIMARY.
  5869         16  AT-COMPANY-CD               PIC X.
  5870         16  AT-CARRIER                  PIC X.
  5871         16  AT-CLAIM-NO                 PIC X(7).
  5872         16  AT-CERT-NO.
  5873             20  AT-CERT-PRIME           PIC X(10).
  5874             20  AT-CERT-SFX             PIC X.
  5875         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 108
* EL130.cbl
  5876             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5877             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5878             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5879             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5880             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5881             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5882             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5883             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5884             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5885             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5886             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5887             88  AT-BENEFICIARY-TRL           VALUE +91.
  5888             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5889             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5890             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5891             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5892
  5893     12  AT-TRAILER-TYPE                 PIC X.
  5894         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5895         88  PAYMENT-TR                       VALUE '2'.
  5896         88  AUTO-PAY-TR                      VALUE '3'.
  5897         88  CORRESPONDENCE-TR                VALUE '4'.
  5898         88  ADDRESS-TR                       VALUE '5'.
  5899         88  GENERAL-INFO-TR                  VALUE '6'.
  5900         88  AUTO-PROMPT-TR                   VALUE '7'.
  5901         88  DENIAL-TR                        VALUE '8'.
  5902         88  INCURRED-CHG-TR                  VALUE '9'.
  5903         88  FORM-CONTROL-TR                  VALUE 'A'.
  5904
  5905     12  AT-RECORDED-DT                  PIC XX.
  5906     12  AT-RECORDED-BY                  PIC X(4).
  5907     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5908
  5909     12  AT-TRAILER-BODY                 PIC X(165).
  5910
  5911     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5912         16  AT-RESERVE-CONTROLS.
  5913             20  AT-MANUAL-SW            PIC X.
  5914                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5915             20  AT-FUTURE-SW            PIC X.
  5916                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5917             20  AT-PTC-SW               PIC X.
  5918                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5919             20  AT-IBNR-SW              PIC X.
  5920                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5921             20  AT-PTC-LF-SW            PIC X.
  5922                 88  AT-LF-PTC-USED          VALUE '1'.
  5923             20  AT-CDT-ACCESS-METHOD    PIC X.
  5924                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5925                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5926                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5927             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5928         16  AT-LAST-COMPUTED-DT         PIC XX.
  5929         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5930         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5931         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5932         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5933         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 109
* EL130.cbl
  5934         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5935         16  AT-EXPENSE-CONTROLS.
  5936             20  AT-EXPENSE-METHOD       PIC X.
  5937                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5938                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5939                 88  PERCENT-OF-PMT           VALUE '3'.
  5940                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5941             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5942             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5943         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5944         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5945
  5946         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5947         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5948
  5949*        16  FILLER                      PIC X(53).
  5950         16  FILLER                      PIC X(47).
  5951
  5952         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5953         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5954
  5955         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5956             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5957             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5958*                    C = CLOSED
  5959*                    O = OPEN
  5960             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5961*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5962
  5963     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5964         16  AT-PAYMENT-TYPE             PIC X.
  5965             88  PARTIAL-PAYMENT                VALUE '1'.
  5966             88  FINAL-PAYMENT                  VALUE '2'.
  5967             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5968             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5969             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5970             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5971             88  VOIDED-PAYMENT                 VALUE '9'.
  5972             88  TRANSFER                       VALUE 'T'.
  5973             88  LIFE-INTEREST                  VALUE 'I'.
  5974
  5975         16  AT-CLAIM-TYPE               PIC X.
  5976             88  PAID-FOR-AH                    VALUE 'A'.
  5977             88  PAID-FOR-LIFE                  VALUE 'L'.
  5978             88  PAID-FOR-IUI                   VALUE 'I'.
  5979             88  PAID-FOR-GAP                   VALUE 'G'.
  5980             88  PAID-FOR-FAM                   VALUE 'F'.
  5981         16  AT-CLAIM-PREM-TYPE          PIC X.
  5982             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5983             88  AT-O-B-COVERAGE                VALUE '2'.
  5984             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5985         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5986         16  AT-CHECK-NO                 PIC X(7).
  5987         16  AT-PAID-FROM-DT             PIC XX.
  5988         16  AT-PAID-THRU-DT             PIC XX.
  5989         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5990         16  FILLER                      PIC X.
  5991         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 110
* EL130.cbl
  5992         16  AT-PAYMENT-ORIGIN           PIC X.
  5993             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5994             88  ONLINE-AUTO-PMT                VALUE '2'.
  5995             88  OFFLINE-PMT                    VALUE '3'.
  5996         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5997         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5998         16  AT-VOID-DATA.
  5999             20  AT-VOID-DT              PIC XX.
  6000*00144       20  AT-VOID-REASON          PIC X(30).
  6001             20  AT-VOID-REASON          PIC X(26).
  6002         16  AT-PMT-APPROVED-BY          PIC X(04).
  6003         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6004         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6005         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6006                                         PIC S99V9(5)  COMP-3.
  6007         16  AT-CREDIT-INTERFACE.
  6008             20  AT-PMT-SELECT-DT        PIC XX.
  6009                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6010             20  AT-PMT-ACCEPT-DT        PIC XX.
  6011                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6012             20  AT-VOID-SELECT-DT       PIC XX.
  6013                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6014             20  AT-VOID-ACCEPT-DT       PIC XX.
  6015                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6016
  6017         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6018                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6019                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6020         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6021
  6022         16  AT-FORCE-CONTROL            PIC X.
  6023             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6024         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6025         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6026         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6027         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6028         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6029         16  AT-BENEFIT-TYPE             PIC X.
  6030
  6031         16  AT-EXPENSE-TYPE             PIC X.
  6032         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6033
  6034         16  AT-PAYEE-TYPE-CD.
  6035             20  AT-PAYEE-TYPE           PIC X.
  6036                 88  INSURED-PAID           VALUE 'I'.
  6037                 88  BENEFICIARY-PAID       VALUE 'B'.
  6038                 88  ACCOUNT-PAID           VALUE 'A'.
  6039                 88  OTHER-1-PAID           VALUE 'O'.
  6040                 88  OTHER-2-PAID           VALUE 'Q'.
  6041                 88  DOCTOR-PAID            VALUE 'P'.
  6042                 88  EMPLOYER-PAID          VALUE 'E'.
  6043             20  AT-PAYEE-SEQ            PIC X.
  6044
  6045         16  AT-CASH-PAYMENT             PIC X.
  6046         16  AT-GROUPED-PAYMENT          PIC X.
  6047         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6048         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6049         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 111
* EL130.cbl
  6050         16  AT-VOID-TYPE                PIC X.
  6051             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6052             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6053         16  AT-AIG-UNEMP-IND            PIC X.
  6054             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6055         16  AT-ASSOCIATES               PIC X.
  6056             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6057             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6058
  6059         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6060         16  AT-CV-PMT-CODE              PIC X.
  6061             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6062             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6063             88  FULL-ADD-PAYMENT           VALUE '3'.
  6064             88  HALF-ADD-PAYMENT           VALUE '4'.
  6065             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6066             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6067             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6068             88  ADDL-PAYMENT               VALUE '8'.
  6069
  6070         16  AT-EOB-CODE1                PIC XXX.
  6071         16  AT-EOB-CODE2                PIC XXX.
  6072         16  AT-EOB-CODE3                PIC XXX.
  6073         16  FILLER REDEFINES AT-EOB-CODE3.
  6074             20  AT-PRINT-CLM-FORM       PIC X.
  6075             20  AT-PRINT-SURVEY         PIC X.
  6076             20  AT-SPECIAL-RELEASE      PIC X.
  6077         16  AT-EOB-CODE4                PIC XXX.
  6078         16  FILLER REDEFINES AT-EOB-CODE4.
  6079             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6080             20  FILLER                  PIC X.
  6081         16  AT-EOB-CODE5                PIC XXX.
  6082         16  FILLER REDEFINES AT-EOB-CODE5.
  6083             20  AT-PMT-PROOF-DT         PIC XX.
  6084             20  FILLER                  PIC X.
  6085
  6086         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6087             88  AT-PRINT-EOB            VALUE 'Y'.
  6088
  6089         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6090         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6091
  6092     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6093         16  AT-SCHEDULE-START-DT        PIC XX.
  6094         16  AT-SCHEDULE-END-DT          PIC XX.
  6095         16  AT-TERMINATED-DT            PIC XX.
  6096         16  AT-LAST-PMT-TYPE            PIC X.
  6097             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6098             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6099         16  AT-FIRST-PMT-DATA.
  6100             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6101             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6102             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6103         16  AT-REGULAR-PMT-DATA.
  6104             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6105             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6106             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6107         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 112
* EL130.cbl
  6108             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6109                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6110                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6111                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6112                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6113                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6114             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6115         16  AT-AUTO-PAY-DAY             PIC 99.
  6116         16  AT-AUTO-CASH                PIC X.
  6117             88  AT-CASH                      VALUE 'Y'.
  6118             88  AT-NON-CASH                  VALUE 'N'.
  6119*        16  FILLER                      PIC X(129).
  6120         16  AT-AUTO-END-LETTER          PIC X(4).
  6121         16  FILLER                      PIC X(125).
  6122
  6123         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6124         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6125
  6126     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6127         16  AT-LETTER-SENT-DT           PIC XX.
  6128         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6129         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6130         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6131         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6132         16  AT-LETTER-ORIGIN            PIC X.
  6133             88  ONLINE-CREATION              VALUE '1' '3'.
  6134             88  OFFLINE-CREATION             VALUE '2' '4'.
  6135             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6136             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6137         16  AT-STD-LETTER-FORM          PIC X(4).
  6138         16  AT-REASON-TEXT              PIC X(70).
  6139         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6140         16  AT-ADDRESEE-TYPE            PIC X.
  6141              88  INSURED-ADDRESEE            VALUE 'I'.
  6142              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6143              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6144              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6145              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6146              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6147              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6148         16  AT-ADDRESSEE-NAME           PIC X(30).
  6149         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6150         16  AT-RESEND-PRINT-DATE        PIC XX.
  6151         16  AT-CORR-SOL-UNSOL           PIC X.
  6152         16  AT-LETTER-PURGED-DT         PIC XX.
  6153*
  6154*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6155*
  6156         16  AT-CSO-REDEFINITION.
  6157             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6158             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6159             20  AT-LETTER-TO-BENE       PIC X(1).
  6160             20  AT-STOP-LETTER-DT       PIC X(2).
  6161             20  FILLER                  PIC X(19).
  6162*             20  FILLER                  PIC X(27).
  6163             20  AT-CSO-LETTER-STATUS    PIC X.
  6164                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6165                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 113
* EL130.cbl
  6166                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6167             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6168             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6169*
  6170*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6171*
  6172*        16  FILLER                      PIC X(26).
  6173*
  6174*        16  AT-DMD-BSR-CODE             PIC X.
  6175*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6176*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6177*
  6178*        16  AT-DMD-LETTER-STATUS        PIC X.
  6179*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6180*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6181*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6182*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6183*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6184
  6185         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6186         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6187
  6188     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6189         16  AT-ADDRESS-TYPE             PIC X.
  6190             88  INSURED-ADDRESS               VALUE 'I'.
  6191             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6192             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6193             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6194             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6195             88  OTHER-ADDRESS-1               VALUE 'O'.
  6196             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6197         16  AT-MAIL-TO-NAME             PIC X(30).
  6198         16  AT-ADDRESS-LINE-1           PIC X(30).
  6199         16  AT-ADDRESS-LINE-2           PIC X(30).
  6200         16  AT-CITY-STATE.
  6201             20  AT-CITY                 PIC X(28).
  6202             20  AT-STATE                PIC XX.
  6203         16  AT-ZIP.
  6204             20  AT-ZIP-CODE.
  6205                 24  AT-ZIP-1ST          PIC X.
  6206                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6207                 24  FILLER              PIC X(4).
  6208             20  AT-ZIP-PLUS4            PIC X(4).
  6209         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6210             20  AT-CAN-POSTAL-1         PIC XXX.
  6211             20  AT-CAN-POSTAL-2         PIC XXX.
  6212             20  FILLER                  PIC XXX.
  6213         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6214*         16  FILLER                      PIC X(23).
  6215         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6216         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6217         16  FILLER                      PIC X(13).
  6218         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6219         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6220
  6221     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6222         16  AT-INFO-LINE-1              PIC X(60).
  6223         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 114
* EL130.cbl
  6224             20  AT-NOTE-ERROR-NO OCCURS 15
  6225                                         PIC X(4).
  6226         16  AT-INFO-LINE-2              PIC X(60).
  6227         16  FILLER REDEFINES AT-INFO-LINE-2.
  6228             20  AT-ICD-CODE-1           PIC X(8).
  6229             20  AT-ICD-CODE-2           PIC X(8).
  6230             20  FILLER                  PIC X(44).
  6231         16  AT-INFO-TRAILER-TYPE        PIC X.
  6232             88  AT-ERRORS-NOTE          VALUE 'E'.
  6233             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6234             88  AT-CALL-NOTE            VALUE 'C'.
  6235             88  AT-MAINT-NOTE           VALUE 'M'.
  6236             88  AT-CERT-CHANGE          VALUE 'X'.
  6237             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6238             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6239             88  AT-CERT-CANCELLED       VALUE 'T'.
  6240         16  AT-CALL-TYPE                PIC X.
  6241             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6242             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6243         16  AT-NOTE-CONTINUATION        PIC X.
  6244             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6245         16  AT-EOB-CODES-EXIST          PIC X.
  6246             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6247         16  FILLER                      PIC X(35).
  6248         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6249         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6250
  6251     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6252         16  AT-PROMPT-LINE-1            PIC X(60).
  6253         16  AT-PROMPT-LINE-2            PIC X(60).
  6254         16  AT-PROMPT-START-DT          PIC XX.
  6255         16  AT-PROMPT-END-DT            PIC XX.
  6256         16  FILLER                      PIC X(35).
  6257         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6258         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6259
  6260     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6261         16  AT-DENIAL-INFO-1            PIC X(60).
  6262         16  AT-DENIAL-INFO-2            PIC X(60).
  6263         16  AT-DENIAL-DT                PIC XX.
  6264         16  AT-RETRACTION-DT            PIC XX.
  6265         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6266*         16  FILLER                      PIC X(31).
  6267         16  AT-DENIAL-PROOF-DT          PIC XX.
  6268         16  FILLER                      PIC X(29).
  6269         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6270         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6271
  6272     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6273         16  AT-OLD-INCURRED-DT          PIC XX.
  6274         16  AT-OLD-REPORTED-DT          PIC XX.
  6275         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6276         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6277         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6278         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6279         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6280         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6281         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 115
* EL130.cbl
  6282         16  AT-OLD-DIAG-CODE            PIC X(6).
  6283         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6284         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6285         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6286         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6287         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6288         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6289         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6290         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6291         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6292         16  FILLER                      PIC X(9).
  6293         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6294
  6295     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6296         16  AT-FORM-SEND-ON-DT          PIC XX.
  6297         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6298         16  AT-FORM-RE-SEND-DT          PIC XX.
  6299         16  AT-FORM-ANSWERED-DT         PIC XX.
  6300         16  AT-FORM-PRINTED-DT          PIC XX.
  6301         16  AT-FORM-REPRINT-DT          PIC XX.
  6302         16  AT-FORM-TYPE                PIC X.
  6303             88  INITIAL-FORM                  VALUE '1'.
  6304             88  PROGRESS-FORM                 VALUE '2'.
  6305         16  AT-INSTRUCT-LN-1            PIC X(28).
  6306         16  AT-INSTRUCT-LN-2            PIC X(28).
  6307         16  AT-INSTRUCT-LN-3            PIC X(28).
  6308         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6309         16  AT-FORM-ADDRESS             PIC X.
  6310             88  FORM-TO-INSURED              VALUE 'I'.
  6311             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6312             88  FORM-TO-OTHER-1              VALUE 'O'.
  6313             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6314         16  AT-RELATED-1.
  6315             20 AT-REL-CARR-1            PIC X.
  6316             20 AT-REL-CLAIM-1           PIC X(7).
  6317             20 AT-REL-CERT-1            PIC X(11).
  6318         16  AT-RELATED-2.
  6319             20 AT-REL-CARR-2            PIC X.
  6320             20 AT-REL-CLAIM-2           PIC X(7).
  6321             20 AT-REL-CERT-2            PIC X(11).
  6322         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6323         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6324         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6325         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6326         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6327         16  AT-STOP-FORM-DT             PIC X(2).
  6328
  6329         16  FILLER                      PIC X(09).
  6330         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6331         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6332******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 116
* EL130.cbl
  6334*    COPY ELCBENE.
  6335******************************************************************
  6336*                                                                *
  6337*                            ELCBENE.                            *
  6338*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6339*                            VMOD=2.006                          *
  6340*                                                                *
  6341*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6342*                                                                *
  6343*   FILE TYPE = VSAM,KSDS                                        *
  6344*   RECORD SIZE = 500   RECFORM = FIX                            *
  6345*                                                                *
  6346*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6347*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6348*                                                                *
  6349*   LOG = YES                                                    *
  6350*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6351*                                                                *
  6352*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6353******************************************************************
  6354
  6355 01  BENEFICIARY-MASTER.
  6356     12  BE-RECORD-ID                PIC XX.
  6357         88  VALID-BE-ID                VALUE 'BE'.
  6358
  6359     12  BE-CONTROL-PRIMARY.
  6360         16  BE-COMPANY-CD           PIC X.
  6361         16  BE-RECORD-TYPE          PIC X.
  6362             88  BENEFICIARY-RECORD  VALUE 'B'.
  6363             88  ADJUSTOR-RECORD     VALUE 'A'.
  6364         16  BE-BENEFICIARY          PIC X(10).
  6365     12  BE-CONTROL-BY-NAME.
  6366         16  BE-COMPANY-CD-A1        PIC X.
  6367         16  BE-RECORD-TYPE-A1       PIC X.
  6368         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6369         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6370
  6371     12  BE-LAST-MAINT-DT            PIC XX.
  6372     12  BE-LAST-MAINT-BY            PIC X(4).
  6373     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6374
  6375     12  BE-ADDRESS-DATA.
  6376         16  BE-MAIL-TO-NAME         PIC X(30).
  6377         16  BE-ADDRESS-LINE-1       PIC X(30).
  6378         16  BE-ADDRESS-LINE-2       PIC X(30).
  6379         16  BE-ADDRESS-LINE-3       PIC X(30).
  6380         16  BE-CITY-STATE.
  6381             20  BE-CITY             PIC X(28).
  6382             20  BE-STATE            PIC XX.
  6383         16  BE-ZIP-CODE.
  6384             20  BE-ZIP-PRIME.
  6385                 24  BE-ZIP-1ST      PIC X.
  6386                     88  BE-CANADIAN-POST-CODE
  6387                                         VALUE 'A' THRU 'Z'.
  6388                 24  FILLER          PIC X(4).
  6389             20  BE-ZIP-PLUS4        PIC X(4).
  6390         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6391             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 117
* EL130.cbl
  6392             20  BE-CAN-POSTAL-2     PIC XXX.
  6393             20  FILLER              PIC XXX.
  6394         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6395         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6396
  6397******************************************************************
  6398*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6399*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6400******************************************************************
  6401     12  BE-CARRIER                  PIC X.
  6402
  6403     12  BE-ADDRESS-DATA2.
  6404         16  BE-MAIL-TO-NAME2        PIC X(30).
  6405         16  BE-ADDRESS-LINE-12      PIC X(30).
  6406         16  BE-ADDRESS-LINE-22      PIC X(30).
  6407         16  BE-ADDRESS-LINE-32      PIC X(30).
  6408         16  BE-CITY-STATE2.
  6409             20  BE-CITY2            PIC X(28).
  6410             20  BE-STATE2           PIC XX.
  6411         16  BE-ZIP-CODE2.
  6412             20  BE-ZIP-PRIME2.
  6413                 24  BE-ZIP-1ST2     PIC X.
  6414                     88  BE-CANADIAN-POST-CODE2
  6415                                         VALUE 'A' THRU 'Z'.
  6416                 24  FILLER          PIC X(4).
  6417             20  BE-ZIP-PLUS42       PIC X(4).
  6418         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6419             20  BE-CAN-POSTAL-12    PIC XXX.
  6420             20  BE-CAN-POSTAL-22    PIC XXX.
  6421             20  FILLER              PIC XXX.
  6422         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6423         16  BE-BILLING-STMT-DATA.
  6424             20  BE-BSR              PIC X.
  6425                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6426                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6427             20  BE-BSR-FROM         PIC X(30).
  6428             20  BE-BSR-DEPT         PIC X(30).
  6429             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6430             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6431             20  BE-OUTPUT-TYPE      PIC X.
  6432                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6433                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6434
  6435     12  FILLER                      PIC X(28).
  6436******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 118
* EL130.cbl
  6438*    COPY ELCDAR.
  6439******************************************************************
  6440*                                                                *
  6441*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6442*   FILE TYPE = VSAM,KSDS                                        *
  6443*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6444*   BASE CLUSTER = DLYACTV                                       *
  6445*   LOG = YES                                                    *
  6446*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6447*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6448*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6449*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6450*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6451*               BY PROGRAM "LGINFCE".                            *
  6452*                                                                *
  6453******************************************************************
  6454 01  DAILY-ACTIVITY-RECORD.
  6455     05  DA-KEY.
  6456         10  DA-COMP-CD          PIC X.
  6457         10  DA-CARRIER          PIC X.
  6458         10  DA-CLAIM-NO         PIC X(7).
  6459         10  DA-CERT-NO.
  6460             15  DA-CERT-PRIME   PIC X(10).
  6461             15  DA-CERT-SFX     PIC X.
  6462     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6463     05  DA-RECORD-TYPE          PIC X.
  6464     05  FILLER                  PIC X(2).
  6465******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 119
* EL130.cbl
  6467*    COPY ELCACTQ.
  6468******************************************************************
  6469*                                                                *
  6470*                            ELCACTQ.                            *
  6471*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6472*                            VMOD=2.004                          *
  6473*                                                                *
  6474*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6475*                                                                *
  6476*   FILE TYPE = VSAM,KSDS                                        *
  6477*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6478*                                                                *
  6479*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6480*       ALTERNATE INDEX = NONE                                   *
  6481*                                                                *
  6482*   LOG = YES                                                    *
  6483*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6484*                                                                *
  6485*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6486******************************************************************
  6487
  6488 01  ACTIVITY-QUE.
  6489     12  AQ-RECORD-ID                PIC XX.
  6490         88  VALID-AQ-ID                VALUE 'AQ'.
  6491
  6492     12  AQ-CONTROL-PRIMARY.
  6493         16  AQ-COMPANY-CD           PIC X.
  6494         16  AQ-CARRIER              PIC X.
  6495         16  AQ-CLAIM-NO             PIC X(7).
  6496         16  AQ-CERT-NO.
  6497             20  AQ-CERT-PRIME       PIC X(10).
  6498             20  AQ-CERT-SFX         PIC X.
  6499
  6500     12  AQ-PENDING-ACTIVITY-FLAGS.
  6501         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6502         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6503             88  PENDING-PAYMENTS       VALUE '1'.
  6504         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6505             88  PENDING-FULL-PRINT     VALUE '1'.
  6506             88  PENDING-PART-PRINT     VALUE '2'.
  6507         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6508             88  PENDING-LETTERS        VALUE '1'.
  6509         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6510             88  PENDING-RESTORE        VALUE 'C'.
  6511             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6512
  6513     12  FILLER                      PIC X(20).
  6514
  6515     12  AQ-RESEND-DATE              PIC XX.
  6516     12  AQ-FOLLOWUP-DATE            PIC XX.
  6517     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6518     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6519     12  AQ-AUTO-LETTER              PIC X(4).
  6520     12  FILLER                      PIC XX.
  6521     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6522*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 120
* EL130.cbl
  6524*    COPY ELCARCH.
  6525******************************************************************
  6526*                                                                *
  6527*                            ELCARCH.                            *
  6528*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6529*                            VMOD=2.007                          *
  6530*                                                                *
  6531*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6532*                                                                *
  6533*   FILE TYPE = VSAM,KSDS                                        *
  6534*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6535*                                                                *
  6536*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6537*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6538*                                                                *
  6539*   LOG = NO                                                     *
  6540*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6541*                                                                *
  6542*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6543******************************************************************
  6544 01  LETTER-ARCHIVE.
  6545     12  LA-RECORD-ID                PIC XX.
  6546         88  VALID-LA-ID                VALUE 'LA'.
  6547
  6548     12  LA-CONTROL-PRIMARY.
  6549         16  LA-COMPANY-CD           PIC X.
  6550         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6551         16  LA-RECORD-TYPE          PIC X.
  6552             88  LA-HEADER-DATA         VALUE '1'.
  6553             88  LA-ADDRESS-DATA        VALUE '2'.
  6554             88  LA-TEXT-DATA           VALUE '3'.
  6555             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6556         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6557
  6558     12  LA-CONTROL-BY-TYPE.
  6559         16  LA-COMPANY-CD-A1        PIC X.
  6560         16  LA-RECORD-TYPE-A1       PIC X.
  6561         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6562         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6563
  6564     12  LA-TEXT-RECORD.
  6565         16  LA-SKIP-CONTROL         PIC XX.
  6566             88  NO-LINES-SKIPPED       VALUE SPACES.
  6567             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6568         16  LA-TEXT-LINE            PIC X(70).
  6569
  6570     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6571         16  FILLER                  PIC XX.
  6572         16  LA-ADDRESS-LINE         PIC X(30).
  6573         16  FILLER                  PIC X(40).
  6574
  6575     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6576         16  FILLER                  PIC XX.
  6577         16  LA-CARRIER              PIC X.
  6578         16  LA-CLAIM-NO             PIC X(7).
  6579         16  LA-CERT-NO.
  6580             20  LA-CERT-PRIME       PIC X(10).
  6581             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 121
* EL130.cbl
  6582         16  LA-NO-OF-COPIES         PIC S9.
  6583         16  LA-RESEND-DATE          PIC XX.
  6584         16  LA-PROCESSOR-CD         PIC X(4).
  6585         16  LA-CREATION-DT          PIC XX.
  6586         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6587         16  LA-RESEND-PRINT-DATE    PIC XX.
  6588         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6589         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6590*
  6591* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6592*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6593*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6594*   I        20  LA-DMD-RES-ST           PIC XX.
  6595*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6596*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6597*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6598*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6599*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6600*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6601*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6602*   I        20  LA-DMD-UND-CODE         PIC XX.
  6603*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6604*   V    16  FILLER                  PIC X(15).
  6605* -----
  6606*
  6607* REINSERTED  CSO  MODS
  6608*
  6609         16  FILLER.
  6610             20  FILLER                  PIC X(29).
  6611             20  LA-CSO-LETTER-STATUS    PIC X.
  6612                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6613                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6614                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6615             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6616             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6617*
  6618
  6619     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6620         16  FILLER                  PIC XX.
  6621         16  LA4-CARRIER             PIC X.
  6622         16  LA4-CLAIM-NO            PIC X(7).
  6623         16  LA4-CERT-NO.
  6624             20  LA4-CERT-PRIME      PIC X(10).
  6625             20  LA4-CERT-SFX        PIC X.
  6626         16  LA4-NO-OF-COPIES        PIC S9.
  6627         16  LA4-RESEND-DATE         PIC XX.
  6628         16  LA4-PROCESSOR-CD        PIC X(4).
  6629         16  LA4-CREATION-DT         PIC XX.
  6630         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6631         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6632         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6633         16  LA4-FORM-TYPE           PIC X.
  6634             88  LA4-INITIAL-FORM    VALUE '1'.
  6635             88  LA4-PROGRESS-FORM   VALUE '2'.
  6636         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6637         16  LA4-STATE               PIC X(02).
  6638         16  FILLER                  PIC X(31).
  6639******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 122
* EL130.cbl
  6641*    COPY ERCREIN.
  6642******************************************************************
  6643*                                                                *
  6644*                            ERCREIN                             *
  6645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6646*                            VMOD=2.010                          *
  6647*                                                                *
  6648*   ONLINE CREDIT SYSTEM                                         *
  6649*                                                                *
  6650*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6651*                                                                *
  6652*   FILE TYPE = VSAM,KSDS                                        *
  6653*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6654*                                                                *
  6655*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6656*       ALTERNATE PATH = NONE                                    *
  6657*                                                                *
  6658*   LOG = NO                                                     *
  6659*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6660*                                                                *
  6661******************************************************************
  6662*                   C H A N G E   L O G
  6663*
  6664* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6665*-----------------------------------------------------------------
  6666*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6667* EFFECTIVE    NUMBER
  6668*-----------------------------------------------------------------
  6669* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6670* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6671******************************************************************
  6672 01  REINSURANCE-RECORD.
  6673     12  RE-RECORD-ID                      PIC XX.
  6674         88  VALID-RE-ID                      VALUE 'RE'.
  6675
  6676     12  RE-CONTROL-PRIMARY.
  6677         16  RE-COMPANY-CD                 PIC X.
  6678         16  RE-KEY.
  6679             20  RE-CODE                   PIC X.
  6680                 88  RE-TABLE-RECORD          VALUE 'A'.
  6681                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6682             20  RE-TABLE                  PIC XXX.
  6683             20  FILLER                    PIC XXX.
  6684         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6685             20  FILLER                    PIC X.
  6686             20  RE-COMPANY.
  6687                 24  RE-COMP-PRIME         PIC XXX.
  6688                 24  RE-COMP-SUB           PIC XXX.
  6689
  6690     12  RE-MAINT-INFORMATION.
  6691         16  RE-LAST-MAINT-DT              PIC XX.
  6692         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6693         16  RE-LAST-MAINT-USER            PIC X(4).
  6694         16  FILLER                        PIC X(10).
  6695
  6696     12  RE-TABLE-DATA.
  6697         16  RE-100-COMP                   PIC 99.
  6698
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 123
* EL130.cbl
  6699         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6700             20  RE-REI-COMP-NO.
  6701                 24  RE-REI-COMP           PIC XXX.
  6702                 24  RE-REI-COMP-SUB       PIC XXX.
  6703             20  RE-LF-QC                  PIC X.
  6704             20  RE-AH-QC                  PIC X.
  6705             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6706             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6707             20  RE-LFAGE-LO               PIC 99.
  6708             20  RE-LFAGE-HI               PIC 99.
  6709             20  RE-AHAGE-LO               PIC 99.
  6710             20  RE-AHAGE-HI               PIC 99.
  6711             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6712             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6713             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6714             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6715             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6716             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6717             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6718             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6719             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6720             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6721             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6722             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6723             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6724             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6725             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6726             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6727             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6728             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6729             20  RE-LF-BEN-CODE            PIC X.
  6730             20  RE-AH-BEN-CODE            PIC X.
  6731             20  RE-INTERACTIVE            PIC X.
  6732             20  RE-REMAINING              PIC X.
  6733             20  RE-LF-RUNOFF-SW           PIC X.
  6734             20  RE-AH-RUNOFF-SW           PIC X.
  6735             20  FILLER                    PIC X(19).
  6736
  6737         16  RE-COMP-INFO-END              PIC X(6).
  6738         16  RE-NSP-ST-CD-LF               PIC XX.
  6739         16  RE-NSP-ST-CD-AH               PIC XX.
  6740         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6741             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6742
  6743         16  FILLER                        PIC X(27).
  6744
  6745     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6746         16  RE-NAME                       PIC X(30).
  6747         16  RE-LF-PE                      PIC X.
  6748         16  RE-AH-PE                      PIC X.
  6749         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6750         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6751         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6752         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6753         16  RE-PRT-ST                     PIC X.
  6754         16  RE-PRT-OW                     PIC X.
  6755         16  RE-MORT-CODE                  PIC X(4).
  6756         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 124
* EL130.cbl
  6757         16  RE-ZERO-LF-FEE                PIC X.
  6758         16  RE-ZERO-AH-FEE                PIC X.
  6759         16  RE-CEDE-NAME                  PIC X(30).
  6760         16  RE-LF-COMM                    PIC X.
  6761         16  RE-AH-COMM                    PIC X.
  6762         16  RE-LF-TAX                     PIC X.
  6763         16  RE-AH-TAX                     PIC X.
  6764         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6765         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6766         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6767
  6768         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6769             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6770
  6771         16  RE-LF-CEDING-FEE-BRACKETS.
  6772             20  RE-LF-FEE-METHOD          PIC X.
  6773                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6774                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6775                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6776                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6777             20  RE-LF-FEE-BASIS           PIC X.
  6778                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6779                 88  RE-LF-NET-CEDED               VALUE '2'.
  6780                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6781                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6782                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6783                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6784                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6785                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6786             20  FILLER                    PIC XXX.
  6787             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6788                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6789                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6790
  6791         16  RE-AH-CEDING-FEE-BRACKETS.
  6792             20  RE-AH-FEE-METHOD          PIC X.
  6793                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6794                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6795                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6796                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6797             20  RE-AH-FEE-BASIS           PIC X.
  6798                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6799                 88  RE-AH-NET-CEDED               VALUE '2'.
  6800                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6801                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6802                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6803                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6804                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6805                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6806             20  FILLER                    PIC XXX.
  6807             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6808                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6809                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6810
  6811         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6812
  6813         16  RE-OLD-CEDING-STMT            PIC X.
  6814
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 125
* EL130.cbl
  6815         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6816         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6817         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6818         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6819         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6820         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6821         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6822         16  RE-MORT-SW                    PIC X.
  6823         16  RE-CEDING-TYPE-FLAG           PIC X.
  6824             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6825             88  RE-CEDED                          VALUE 'C'.
  6826             88  RE-ASSUMED                        VALUE 'A'.
  6827             88  RE-PHANTOM                        VALUE 'P'.
  6828
  6829         16  RE-CEDING-STMT-OPT-A          PIC X.
  6830             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6831         16  RE-CEDING-STMT-OPT-B          PIC X.
  6832             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6833         16  RE-CEDING-STMT-OPT-C          PIC X.
  6834             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6835         16  RE-CEDING-STMT-OPT-D          PIC X.
  6836             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6837         16  RE-CEDING-STMT-OPT-E          PIC X.
  6838             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6839
  6840         16  RE-PRT-CRSV                   PIC X.
  6841
  6842         16  RE-GL-CENTER                  PIC X(4).
  6843
  6844         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6845
  6846         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6847
  6848         16  RE-EARN-STOP-CODE             PIC X.
  6849             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6850             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6851
  6852         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6853             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6854
  6855         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6856         16  FILLER                        PIC X(2281).
  6857
  6858         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6859
  6860******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 126
* EL130.cbl
  6862*    COPY ERCMAIL.
  6863******************************************************************
  6864*                                                                *
  6865*                                                                *
  6866*                            ERCMAIL                             *
  6867*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6868*                            VMOD=2.003                          *
  6869*                                                                *
  6870*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6871*                                                                *
  6872*   FILE TYPE = VSAM,KSDS                                        *
  6873*   RECORD SIZE = 374   RECFORM = FIX                            *
  6874*                                                                *
  6875*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6876*   ALTERNATE PATH    = NOT USED                                 *
  6877*                                                                *
  6878*   LOG = YES                                                    *
  6879*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6880******************************************************************
  6881*                   C H A N G E   L O G
  6882*
  6883* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6884*-----------------------------------------------------------------
  6885*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6886* EFFECTIVE    NUMBER
  6887*-----------------------------------------------------------------
  6888* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6889* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6890* 111108                   PEMA  ADD CRED BENE ADDR2
  6891******************************************************************
  6892
  6893 01  MAILING-DATA.
  6894     12  MA-RECORD-ID                      PIC XX.
  6895         88  VALID-MA-ID                       VALUE 'MA'.
  6896
  6897     12  MA-CONTROL-PRIMARY.
  6898         16  MA-COMPANY-CD                 PIC X.
  6899         16  MA-CARRIER                    PIC X.
  6900         16  MA-GROUPING.
  6901             20  MA-GROUPING-PREFIX        PIC XXX.
  6902             20  MA-GROUPING-PRIME         PIC XXX.
  6903         16  MA-STATE                      PIC XX.
  6904         16  MA-ACCOUNT.
  6905             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6906             20  MA-ACCOUNT-PRIME          PIC X(6).
  6907         16  MA-CERT-EFF-DT                PIC XX.
  6908         16  MA-CERT-NO.
  6909             20  MA-CERT-PRIME             PIC X(10).
  6910             20  MA-CERT-SFX               PIC X.
  6911
  6912     12  FILLER                            PIC XX.
  6913
  6914     12  MA-ACCESS-CONTROL.
  6915         16  MA-SOURCE-SYSTEM              PIC XX.
  6916             88  MA-FROM-CREDIT                VALUE 'CR'.
  6917             88  MA-FROM-VSI                   VALUE 'VS'.
  6918             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6919             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 127
* EL130.cbl
  6920         16  MA-RECORD-ADD-DT              PIC XX.
  6921         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6922         16  MA-LAST-MAINT-DT              PIC XX.
  6923         16  MA-LAST-MAINT-BY              PIC XXXX.
  6924         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6925
  6926     12  MA-PROFILE-INFO.
  6927         16  MA-QUALIFY-CODE-1             PIC XX.
  6928         16  MA-QUALIFY-CODE-2             PIC XX.
  6929         16  MA-QUALIFY-CODE-3             PIC XX.
  6930         16  MA-QUALIFY-CODE-4             PIC XX.
  6931         16  MA-QUALIFY-CODE-5             PIC XX.
  6932
  6933         16  MA-INSURED-LAST-NAME          PIC X(15).
  6934         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6935         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6936         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6937         16  MA-INSURED-BIRTH-DT           PIC XX.
  6938         16  MA-INSURED-SEX                PIC X.
  6939             88  MA-SEX-MALE                   VALUE 'M'.
  6940             88  MA-SEX-FEMALE                 VALUE 'F'.
  6941         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6942
  6943         16  MA-ADDRESS-CORRECTED          PIC X.
  6944         16  MA-JOINT-BIRTH-DT             PIC XX.
  6945*        16  FILLER                        PIC X(12).
  6946
  6947         16  MA-ADDRESS-LINE-1             PIC X(30).
  6948         16  MA-ADDRESS-LINE-2             PIC X(30).
  6949         16  MA-CITY-STATE.
  6950             20  MA-CITY                   PIC X(28).
  6951             20  MA-ADDR-STATE             PIC XX.
  6952         16  MA-ZIP.
  6953             20  MA-ZIP-CODE.
  6954                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6955                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6956                 24  FILLER                PIC X(4).
  6957             20  MA-ZIP-PLUS4              PIC X(4).
  6958         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6959             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6960             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6961             20  FILLER                    PIC X(3).
  6962
  6963         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6964
  6965         16  FILLER                        PIC XXX.
  6966*        16  FILLER                        PIC X(10).
  6967
  6968     12  MA-CRED-BENE-INFO.
  6969         16  MA-CRED-BENE-NAME                 PIC X(25).
  6970         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6971         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6972         16  MA-CRED-BENE-CTYST.
  6973             20  MA-CRED-BENE-CITY             PIC X(28).
  6974             20  MA-CRED-BENE-STATE            PIC XX.
  6975         16  MA-CRED-BENE-ZIP.
  6976             20  MA-CB-ZIP-CODE.
  6977                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 128
* EL130.cbl
  6978                     88  MA-CB-CANADIAN-POST-CODE
  6979                                           VALUE 'A' THRU 'Z'.
  6980                 24  FILLER                    PIC X(4).
  6981             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6982         16  MA-CB-CANADIAN-POSTAL-CODE
  6983                            REDEFINES MA-CRED-BENE-ZIP.
  6984             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6985             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6986             20  FILLER                        PIC X(3).
  6987     12  MA-POST-CARD-MAIL-DATA.
  6988         16  MA-MAIL-DATA OCCURS 7.
  6989             20  MA-MAIL-TYPE              PIC X.
  6990                 88  MA-12MO-MAILING           VALUE '1'.
  6991                 88  MA-EXP-MAILING            VALUE '2'.
  6992             20  MA-MAIL-STATUS            PIC X.
  6993                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6994                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6995                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6996             20  MA-MAIL-DATE              PIC XX.
  6997     12  FILLER                            PIC XX.
  6998     12  FILLER                            PIC XX.
  6999*    12  FILLER                            PIC X(30).
  7000******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 129
* EL130.cbl
  7002*    COPY ELCCRTT.
  7003******************************************************************
  7004*                                                                *
  7005*                            ELCCRTT.                            *
  7006*                                                                *
  7007*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7008*                                                                *
  7009*   FILE TYPE = VSAM,KSDS                                        *
  7010*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7011*                                                                *
  7012*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7013*                                                                *
  7014*   LOG = YES                                                    *
  7015*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7016******************************************************************
  7017*                   C H A N G E   L O G
  7018*
  7019* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7020*-----------------------------------------------------------------
  7021*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7022* EFFECTIVE    NUMBER
  7023*-----------------------------------------------------------------
  7024* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7025* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7026* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7027* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7028* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7029* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7030* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7031******************************************************************
  7032
  7033 01  CERTIFICATE-TRAILERS.
  7034     12  CS-RECORD-ID                      PIC XX.
  7035         88  VALID-CS-ID                      VALUE 'CS'.
  7036
  7037     12  CS-CONTROL-PRIMARY.
  7038         16  CS-COMPANY-CD                 PIC X.
  7039         16  CS-CARRIER                    PIC X.
  7040         16  CS-GROUPING                   PIC X(6).
  7041         16  CS-STATE                      PIC XX.
  7042         16  CS-ACCOUNT                    PIC X(10).
  7043         16  CS-CERT-EFF-DT                PIC XX.
  7044         16  CS-CERT-NO.
  7045             20  CS-CERT-PRIME             PIC X(10).
  7046             20  CS-CERT-SFX               PIC X.
  7047         16  CS-TRAILER-TYPE               PIC X.
  7048             88  COMM-TRLR           VALUE 'A'.
  7049             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7050             88  CERT-DATA-TRLR      VALUE 'C'.
  7051
  7052     12  CS-DATA-AREA                      PIC X(516).
  7053
  7054     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7055         16  CS-BANK-COMMISSION-AREA.
  7056             20  CS-BANK-COMMS       OCCURS 10.
  7057                 24  CS-AGT                PIC X(10).
  7058                 24  CS-COM-TYP            PIC X.
  7059                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 130
* EL130.cbl
  7060                 24  CS-RECALC-LV-INDIC    PIC X.
  7061                 24  FILLER                PIC X(10).
  7062         16  FILLER                        PIC X(256).
  7063
  7064     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7065****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7066         16  CS-MB-CLAIM-DATA OCCURS 24.
  7067             20  CS-CLAIM-NO               PIC X(7).
  7068             20  CS-CLAIM-TYPE             PIC X.
  7069                 88  CS-AH-CLM               VALUE 'A'.
  7070                 88  CS-IU-CLM               VALUE 'I'.
  7071                 88  CS-GP-CLM               VALUE 'G'.
  7072                 88  CS-LF-CLM               VALUE 'L'.
  7073                 88  CS-PR-CLM               VALUE 'P'.
  7074                 88  CS-FL-CLM               VALUE 'F'.
  7075             20  CS-INSURED-TYPE           PIC X.
  7076                 88  CS-PRIM-INSURED          VALUE 'P'.
  7077                 88  CS-CO-BORROWER           VALUE 'C'.
  7078             20  CS-BENEFIT-PERIOD         PIC 99.
  7079             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7080             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7081             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7082         16  FILLER                        PIC X(12).
  7083     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7084         16  CS-VIN-NUMBER                 PIC X(17).
  7085         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7086         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7087         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7088         16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 131
* EL130.cbl
  7090
  7091 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7092                          CONTROL-FILE CERTIFICATE-MASTER
  7093                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7094                          BENEFICIARY-MASTER
  7095                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7096                          LETTER-ARCHIVE REINSURANCE-RECORD
  7097                          MAILING-DATA CERTIFICATE-TRAILERS.
  7098 0000-DFHEXIT SECTION.
  7099     MOVE '9#                    $   ' TO DFHEIV0.
  7100     MOVE 'EL130' TO DFHEIV1.
  7101     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7102     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7103     MOVE '5'                    TO DC-OPTION-CODE.
  7104     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7105     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7106     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7107
  7108     IF EIBCALEN = ZERO
  7109         GO TO 8800-UNAUTHORIZED-ACCESS
  7110     END-IF.
  7111
  7112     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7113     MOVE EIBTRMID               TO QID-TERM.
  7114     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7115     move spaces                 to emi-error-lines
  7116     MOVE '2'                    TO EMI-SWITCH2.
  7117     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7118     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7119
  7120
  7121* EXEC CICS HANDLE CONDITION
  7122*        QIDERR     (0100-TEST-ENTRY)
  7123*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7124*        PGMIDERR   (9600-PGMID-ERROR)
  7125*        TERMIDERR  (8820-TERM-ERROR)
  7126*        TRANSIDERR (8830-TRAN-ERROR)
  7127*        ERROR      (9990-ABEND)
  7128*    END-EXEC.
  7129*    MOVE '"$N?L[\.              ! " #00007116' TO DFHEIV0
  7130     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7132     MOVE X'2220233030303037313136' TO DFHEIV0(25:11)
  7133     CALL 'kxdfhei1' USING DFHEIV0
  7134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7135
  7136
  7137     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7138        PI-CALLING-PROGRAM   = XCTL-6592
  7139         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7140     ELSE
  7141         MOVE SPACES             TO RETURNED-FROM
  7142     END-IF.
  7143
  7144     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7145         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7146             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7147             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 132
* EL130.cbl
  7148             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7149             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7150             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7151             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7152             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7153             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7154         ELSE
  7155             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7156             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7157             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7158             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7159             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7160             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7161             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7162             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7163         END-IF
  7164     END-IF.
  7165
  7166     IF EIBTRNID = TRANS-ID
  7167         IF EIBAID = DFHCLEAR
  7168             GO TO 9400-CLEAR
  7169         ELSE
  7170             GO TO 0200-RECEIVE
  7171         END-IF
  7172     END-IF.
  7173
  7174     IF RETURNED-FROM NOT = SPACES
  7175         GO TO 0600-RECOVER-TEMP-STORAGE
  7176     END-IF.
  7177
  7178     MOVE LOW-VALUES TO EL130AO.
  7179     move zeros to pi-dcc-max-amt
  7180                   pi-dcc-max-benefits
  7181
  7182
  7183
  7184* EXEC CICS DELETEQ TS
  7185*         QUEUE   (QID)
  7186*    END-EXEC.
  7187*    MOVE '*&                    #   #00007171' TO DFHEIV0
  7188     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7189     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7190     MOVE X'2020233030303037313731' TO DFHEIV0(25:11)
  7191     CALL 'kxdfhei1' USING DFHEIV0,
  7192           QID,
  7193           DFHEIV99
  7194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7195
  7196
  7197 0100-TEST-ENTRY.
  7198     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7199         GO TO 0650-FROM-EL127
  7200     ELSE
  7201         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7202                                    PI-CERT-PROCESSED
  7203                                    PI-LETTER-ERROR-CODE
  7204     END-IF.
  7205
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 133
* EL130.cbl
  7206     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7207         GO TO 0640-FROM-EL132
  7208     END-IF.
  7209
  7210     GO TO 8100-SEND-INITIAL-MAP.
  7211
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 134
* EL130.cbl
  7213 0200-RECEIVE.
  7214     MOVE LOW-VALUES             TO EL130AI.
  7215
  7216     IF PI-PROCESSOR-ID = 'LGXX'
  7217*        NEXT SENTENCE
  7218         CONTINUE
  7219     ELSE
  7220
  7221* EXEC CICS READQ TS
  7222*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7223*            INTO    (SECURITY-CONTROL)
  7224*            LENGTH  (SC-COMM-LENGTH)
  7225*            ITEM    (SC-ITEM)
  7226*        END-EXEC
  7227*    MOVE '*$II   L              ''   #00007198' TO DFHEIV0
  7228     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7229     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7230     MOVE X'2020233030303037313938' TO DFHEIV0(25:11)
  7231     CALL 'kxdfhei1' USING DFHEIV0,
  7232           PI-SECURITY-TEMP-STORE-ID,
  7233           SECURITY-CONTROL,
  7234           SC-COMM-LENGTH,
  7235           SC-ITEM,
  7236           DFHEIV99,
  7237           DFHEIV99
  7238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7239         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7240         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7241         IF NOT DISPLAY-CAP
  7242             MOVE 'READ'              TO  SM-READ
  7243             PERFORM 9995-SECURITY-VIOLATION
  7244             MOVE ER-0070             TO  EMI-ERROR
  7245             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7246             GO TO 8100-SEND-INITIAL-MAP
  7247         END-IF
  7248     END-IF.
  7249
  7250     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7251         MOVE ER-7008 TO EMI-ERROR
  7252         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7253         MOVE -1 TO MAINTL
  7254         GO TO 8200-SEND-DATAONLY
  7255     END-IF.
  7256
  7257
  7258
  7259* EXEC CICS RECEIVE
  7260*         MAP     (MAP-NAME)
  7261*         MAPSET  (MAPSET-NAME)
  7262*         INTO    (EL130AI)
  7263*    END-EXEC.
  7264     MOVE LENGTH OF
  7265      EL130AI
  7266       TO DFHEIV11
  7267*    MOVE '8"T I  L              ''   #00007223' TO DFHEIV0
  7268     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7269     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7270     MOVE X'2020233030303037323233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 135
* EL130.cbl
  7271     CALL 'kxdfhei1' USING DFHEIV0,
  7272           MAP-NAME,
  7273           EL130AI,
  7274           DFHEIV11,
  7275           MAPSET-NAME,
  7276           DFHEIV99,
  7277           DFHEIV99
  7278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7279
  7280
  7281     IF NOT PI-NO-CARRIER-SECURITY
  7282        MOVE +1                  TO CLMCARRL
  7283        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7284     END-IF.
  7285
  7286     IF ENTERPFL = ZERO
  7287         GO TO 0300-CHECK-PFKEYS
  7288     END-IF.
  7289
  7290     IF EIBAID NOT = DFHENTER
  7291         MOVE ER-0004            TO EMI-ERROR
  7292         GO TO 0320-INPUT-ERROR
  7293     END-IF.
  7294
  7295     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7296         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7297     ELSE
  7298         MOVE ER-0029            TO EMI-ERROR
  7299         GO TO 0320-INPUT-ERROR
  7300     END-IF.
  7301
  7302 0300-CHECK-PFKEYS.
  7303     IF EIBAID = DFHPF23
  7304         GO TO 8810-PF23
  7305     END-IF.
  7306
  7307     IF EIBAID = DFHPF24
  7308         GO TO 9200-RETURN-MAIN-MENU
  7309     END-IF.
  7310
  7311     IF EIBAID = DFHPF12
  7312         GO TO 9500-PF12
  7313     END-IF.
  7314
  7315     IF EIBAID = DFHPF3
  7316         MOVE SPACES              TO MAINTI
  7317         MOVE ZEROS               TO MAINTL
  7318         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7319         MOVE XCTL-127            TO PGM-NAME
  7320         GO TO 9300-XCTL
  7321     END-IF.
  7322
  7323     IF EIBAID = DFHPF4
  7324         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7325         MOVE XCTL-132            TO PGM-NAME
  7326         GO TO 9300-XCTL
  7327     END-IF.
  7328
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 136
* EL130.cbl
  7329     IF EIBAID = DFHPF13
  7330         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7331             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7332             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7333             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7334             MOVE PI-STATE            TO  PI-CR-STATE
  7335             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7336             MOVE XCTL-650            TO  PGM-NAME
  7337             GO TO 9300-XCTL
  7338         ELSE
  7339             MOVE -1                  TO  ENTERPFL
  7340             MOVE ER-2566             TO  EMI-ERROR
  7341             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7342             GO TO 8100-SEND-INITIAL-MAP
  7343         END-IF
  7344     END-IF.
  7345
  7346     IF EIBAID = DFHPF5
  7347         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7348             ADD +1 TO PI-CERT-PROCESSED
  7349             GO TO 0650-FROM-EL127
  7350         ELSE
  7351             MOVE ER-7686         TO EMI-ERROR
  7352             GO TO 0320-INPUT-ERROR
  7353         END-IF
  7354     END-IF.
  7355
  7356     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7357         GO TO 0800-TEST-PREVIOUS-CONTROL
  7358     END-IF.
  7359
  7360     IF PI-HAS-CLAS-IC-CRDTCRD
  7361         IF EIBAID = DFHPF10
  7362             MOVE XCTL-725          TO PGM-NAME
  7363             GO TO 9300-XCTL
  7364         END-IF
  7365     END-IF.
  7366
  7367     IF EIBAID = DFHPF14
  7368         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7369         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7370         MOVE XCTL-659            TO PGM-NAME
  7371         GO TO 9300-XCTL
  7372     END-IF.
  7373
  7374     IF EIBAID = DFHPF15
  7375         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7376         MOVE XCTL-114            TO PGM-NAME
  7377         GO TO 9300-XCTL
  7378     END-IF.
  7379
  7380*    IF EIBAID = DFHPF11
  7381*       GO TO 0600-RECOVER-TEMP-STORAGE
  7382*    END-IF
  7383     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7384         GO TO 0330-EDIT-DATA
  7385     END-IF.
  7386
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 137
* EL130.cbl
  7387     MOVE ER-0029                TO EMI-ERROR.
  7388
  7389 0320-INPUT-ERROR.
  7390     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7391
  7392     MOVE AL-UNBON               TO ENTERPFA.
  7393
  7394     IF ENTERPFL = ZERO
  7395         MOVE -1                 TO MAINTL
  7396     ELSE
  7397         MOVE -1                 TO ENTERPFL
  7398     END-IF.
  7399
  7400     GO TO 8200-SEND-DATAONLY.
  7401
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 138
* EL130.cbl
  7403 0330-EDIT-DATA.
  7404
  7405     IF MAINTI = 'S'
  7406         IF PRTOPTL GREATER THAN 0
  7407             IF PRTOPTI NOT = 'N' AND 'L'
  7408                 MOVE AL-UABON   TO  PRTOPTA
  7409                 MOVE -1         TO  PRTOPTL
  7410                 MOVE ER-0334    TO  EMI-ERROR
  7411                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7412                 GO TO 8200-SEND-DATAONLY
  7413             ELSE
  7414                 IF PRTOPTI = 'L'
  7415                     GO TO 0400-CREATE-ELACTQ
  7416                 ELSE
  7417                     GO TO 0480-PRINT-NOW
  7418                 END-IF
  7419             END-IF
  7420         ELSE
  7421             GO TO 1000-SHOW-CLAIM
  7422         END-IF
  7423     END-IF.
  7424
  7425     IF NOT MODIFY-CAP
  7426         MOVE 'UPDATE'       TO  SM-READ
  7427         PERFORM 9995-SECURITY-VIOLATION
  7428         MOVE ER-0070        TO  EMI-ERROR
  7429         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7430         GO TO 8100-SEND-INITIAL-MAP
  7431     END-IF.
  7432
  7433     IF MAINTI = 'D'
  7434         GO TO 2000-DELETE-CLAIM
  7435     END-IF.
  7436
  7437     IF MAINTI = 'A'
  7438         GO TO 3000-ADD-CLAIM
  7439     END-IF.
  7440
  7441     IF MAINTI = 'I'
  7442         GO TO 5000-INCURRED-CHANGE
  7443     END-IF.
  7444
  7445     MOVE ER-0023                TO EMI-ERROR.
  7446     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7447     MOVE -1                     TO MAINTL.
  7448     MOVE AL-UABON               TO MAINTA.
  7449
  7450     GO TO 8200-SEND-DATAONLY.
  7451
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 139
* EL130.cbl
  7453 0400-CREATE-ELACTQ.
  7454     IF CLMNOI   = PI-LAST-CLAIM      AND
  7455        CLMCARRI = PI-LAST-CARR       AND
  7456        CERTNOI  = PI-LAST-CERT-PRIME AND
  7457        SUFXI    = PI-LAST-CERT-SUFX
  7458         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7459         MOVE PI-LAST-CARR       TO PI-CARRIER
  7460         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7461     ELSE
  7462         MOVE ER-0207            TO EMI-ERROR
  7463         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7464         MOVE -1                 TO MAINTL
  7465         GO TO 8200-SEND-DATAONLY
  7466     END-IF.
  7467
  7468     IF (NOT PI-NO-CARRIER-SECURITY OR
  7469         NOT PI-NO-ACCOUNT-SECURITY)
  7470         MOVE AL-UABON      TO  PRTOPTA
  7471         MOVE -1            TO  PRTOPTL
  7472         MOVE ER-2378       TO  EMI-ERROR
  7473         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7474         GO TO 8200-SEND-DATAONLY
  7475     END-IF.
  7476
  7477     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7478     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7479     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7480     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7481
  7482
  7483
  7484* EXEC CICS HANDLE CONDITION
  7485*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7486*    END-EXEC.
  7487*    MOVE '"$I                   ! # #00007431' TO DFHEIV0
  7488     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7490     MOVE X'2320233030303037343331' TO DFHEIV0(25:11)
  7491     CALL 'kxdfhei1' USING DFHEIV0
  7492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7493
  7494
  7495
  7496
  7497* EXEC CICS READ
  7498*         UPDATE
  7499*         DATASET    (ELACTQ-DSID)
  7500*         SET        (ADDRESS OF ACTIVITY-QUE)
  7501*         RIDFLD     (ELACTQ-KEY)
  7502*    END-EXEC.
  7503*    MOVE '&"S        EU         (   #00007436' TO DFHEIV0
  7504     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7505     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7506     MOVE X'2020233030303037343336' TO DFHEIV0(25:11)
  7507     CALL 'kxdfhei1' USING DFHEIV0,
  7508           ELACTQ-DSID,
  7509           DFHEIV20,
  7510           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 140
* EL130.cbl
  7511           ELACTQ-KEY,
  7512           DFHEIV99,
  7513           DFHEIV99,
  7514           DFHEIV99
  7515     SET ADDRESS OF ACTIVITY-QUE TO
  7516         DFHEIV20
  7517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7518
  7519
  7520     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7521     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7522
  7523
  7524
  7525* EXEC CICS REWRITE
  7526*         DATASET     (ELACTQ-DSID)
  7527*         FROM        (ACTIVITY-QUE)
  7528*    END-EXEC.
  7529     MOVE LENGTH OF
  7530      ACTIVITY-QUE
  7531       TO DFHEIV11
  7532*    MOVE '&& L                  %   #00007447' TO DFHEIV0
  7533     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7534     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7535     MOVE X'2020233030303037343437' TO DFHEIV0(25:11)
  7536     CALL 'kxdfhei1' USING DFHEIV0,
  7537           ELACTQ-DSID,
  7538           ACTIVITY-QUE,
  7539           DFHEIV11,
  7540           DFHEIV99
  7541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7542
  7543
  7544     GO TO 0470-STATUS-FINISH.
  7545
  7546 0450-ADD-ELACTQ-RECORD.
  7547
  7548
  7549* EXEC CICS GETMAIN
  7550*        SET     (ADDRESS OF ACTIVITY-QUE)
  7551*        LENGTH  (ELACTQ-LENGTH)
  7552*        INITIMG (GETMAIN-SPACE)
  7553*    END-EXEC.
  7554*    MOVE ',"IL                  $   #00007456' TO DFHEIV0
  7555     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7556     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7557     MOVE X'2020233030303037343536' TO DFHEIV0(25:11)
  7558     CALL 'kxdfhei1' USING DFHEIV0,
  7559           DFHEIV20,
  7560           ELACTQ-LENGTH,
  7561           GETMAIN-SPACE
  7562     SET ADDRESS OF ACTIVITY-QUE TO
  7563         DFHEIV20
  7564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7565
  7566
  7567     MOVE 'AQ'              TO AQ-RECORD-ID.
  7568     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 141
* EL130.cbl
  7569     MOVE +0                TO AQ-PAYMENT-COUNTER
  7570                               AQ-PMT-UNAPPROVED-COUNT.
  7571     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7572                               AQ-FOLLOWUP-DATE.
  7573     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7574     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7575
  7576
  7577
  7578* EXEC CICS WRITE
  7579*         DATASET     (ELACTQ-DSID)
  7580*         FROM        (ACTIVITY-QUE)
  7581*         RIDFLD      (ELACTQ-KEY)
  7582*    END-EXEC.
  7583     MOVE LENGTH OF
  7584      ACTIVITY-QUE
  7585       TO DFHEIV11
  7586*    MOVE '&$ L                  ''   #00007472' TO DFHEIV0
  7587     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7588     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7589     MOVE X'2020233030303037343732' TO DFHEIV0(25:11)
  7590     CALL 'kxdfhei1' USING DFHEIV0,
  7591           ELACTQ-DSID,
  7592           ACTIVITY-QUE,
  7593           DFHEIV11,
  7594           ELACTQ-KEY,
  7595           DFHEIV99,
  7596           DFHEIV99
  7597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7598
  7599
  7600 0470-STATUS-FINISH.
  7601     MOVE AL-UANOF               TO  PRTOPTA
  7602                                     ALTPRTA.
  7603
  7604     MOVE SPACES                 TO  PRTOPTO
  7605                                     ALTPRTO.
  7606
  7607     MOVE ER-0000                TO EMI-ERROR.
  7608     MOVE -1                     TO MAINTL.
  7609     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7610     GO TO 8100-SEND-INITIAL-MAP.
  7611
  7612 0480-PRINT-NOW.
  7613
  7614
  7615* EXEC CICS HANDLE CONDITION
  7616*        TERMIDERR   (8820-TERM-ERROR)
  7617*        TRANSIDERR  (8830-TRAN-ERROR)
  7618*    END-EXEC.
  7619*    MOVE '"$[\                  ! $ #00007492' TO DFHEIV0
  7620     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7622     MOVE X'2420233030303037343932' TO DFHEIV0(25:11)
  7623     CALL 'kxdfhei1' USING DFHEIV0
  7624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7625
  7626
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 142
* EL130.cbl
  7627     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7628     MOVE '1'                    TO  CNTL-REC-TYPE.
  7629     MOVE SPACES                 TO  CNTL-ACCESS.
  7630     MOVE +0                     TO  CNTL-SEQ-NO.
  7631     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7632
  7633     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7634
  7635     IF CF-FORMS-PRINTER-ID = SPACES
  7636         IF ALTPRTL NOT GREATER THAN 0
  7637             MOVE ER-0337        TO  EMI-ERROR
  7638             MOVE -1             TO  ALTPRTL
  7639             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7640             GO TO 8200-SEND-DATAONLY
  7641         END-IF
  7642     END-IF.
  7643
  7644     IF ALTPRTL GREATER THAN 0
  7645         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7646     END-IF.
  7647
  7648     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7649     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7650     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7651
  7652
  7653
  7654* EXEC CICS START
  7655*        TRANSID   (START-TRANS-ID)
  7656*        TERMID    (CF-FORMS-PRINTER-ID)
  7657*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7658*        LENGTH    (PI-COMM-LENGTH)
  7659*    END-EXEC.
  7660*    MOVE '0( LFT                1   #00007523' TO DFHEIV0
  7661     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7662     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7663     MOVE X'2020233030303037353233' TO DFHEIV0(25:11)
  7664     CALL 'kxdfhei1' USING DFHEIV0,
  7665           DFHEIV99,
  7666           START-TRANS-ID,
  7667           DFHEIV99,
  7668           PROGRAM-INTERFACE-BLOCK,
  7669           PI-COMM-LENGTH,
  7670           CF-FORMS-PRINTER-ID,
  7671           DFHEIV99,
  7672           DFHEIV99,
  7673           DFHEIV99,
  7674           DFHEIV99,
  7675           DFHEIV99,
  7676           DFHEIV99,
  7677           DFHEIV99,
  7678           DFHEIV99,
  7679           DFHEIV99,
  7680           DFHEIV99
  7681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7682
  7683
  7684     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 143
* EL130.cbl
  7685                                     ALTPRTA.
  7686
  7687     MOVE SPACES                 TO  PRTOPTO
  7688                                     ALTPRTO.
  7689
  7690     MOVE ER-0000                TO  EMI-ERROR.
  7691     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7692     MOVE -1                     TO  MAINTL.
  7693     GO TO 8100-SEND-INITIAL-MAP.
  7694
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 144
* EL130.cbl
  7696 0500-CREATE-TEMP-STORAGE.
  7697     MOVE EIBCPOSN               TO PI-CURSOR.
  7698
  7699    move emi-line1               to errmsg1o
  7700    move emi-line2               to errmsg2o
  7701    move emi-sub                 to pi-emi-sub
  7702
  7703
  7704* EXEC CICS WRITEQ TS
  7705*        QUEUE   (QID)
  7706*        FROM    (EL130AI)
  7707*        LENGTH  (QID-MAP-LENGTH)
  7708*    END-EXEC.
  7709*    MOVE '*"                    ''   #00007549' TO DFHEIV0
  7710     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7711     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7712     MOVE X'2020233030303037353439' TO DFHEIV0(25:11)
  7713     CALL 'kxdfhei1' USING DFHEIV0,
  7714           QID,
  7715           EL130AI,
  7716           QID-MAP-LENGTH,
  7717           DFHEIV99,
  7718           DFHEIV99,
  7719           DFHEIV99
  7720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7721
  7722
  7723
  7724
  7725* EXEC CICS WRITEQ TS
  7726*        QUEUE    (QID)
  7727*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7728*        LENGTH   (PI-COMM-LENGTH)
  7729*    END-EXEC.
  7730*    MOVE '*"                    ''   #00007556' TO DFHEIV0
  7731     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7732     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7733     MOVE X'2020233030303037353536' TO DFHEIV0(25:11)
  7734     CALL 'kxdfhei1' USING DFHEIV0,
  7735           QID,
  7736           PROGRAM-INTERFACE-BLOCK,
  7737           PI-COMM-LENGTH,
  7738           DFHEIV99,
  7739           DFHEIV99,
  7740           DFHEIV99
  7741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7742
  7743
  7744 0599-EXIT.
  7745      EXIT.
  7746
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 145
* EL130.cbl
  7748 0600-RECOVER-TEMP-STORAGE.
  7749     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7750     MOVE PI-EL127-TO-EL130-CNTRL
  7751                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7752     MOVE PI-EL659-TO-EL130-CNTRL
  7753                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7754     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7755     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7756     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7757     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7758     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7759     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7760     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7761     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7762     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7763     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7764     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7765     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7766     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7767     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7768     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7769     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7770                                 TO SAVE-BENEFICIARY
  7771
  7772
  7773
  7774* EXEC CICS HANDLE CONDITION
  7775*        NOTFND  (0660-NOT-FOUND)
  7776*        QIDERR  (0670-QIDERR)
  7777*    END-EXEC.
  7778*    MOVE '"$IN                  ! % #00007591' TO DFHEIV0
  7779     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7780     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7781     MOVE X'2520233030303037353931' TO DFHEIV0(25:11)
  7782     CALL 'kxdfhei1' USING DFHEIV0
  7783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7784
  7785
  7786
  7787
  7788* EXEC CICS READQ TS
  7789*        QUEUE    (QID)
  7790*        INTO     (EL130AI)
  7791*        LENGTH   (QID-MAP-LENGTH)
  7792*    END-EXEC.
  7793*    MOVE '*$I    L              ''   #00007597' TO DFHEIV0
  7794     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7795     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7796     MOVE X'2020233030303037353937' TO DFHEIV0(25:11)
  7797     CALL 'kxdfhei1' USING DFHEIV0,
  7798           QID,
  7799           EL130AI,
  7800           QID-MAP-LENGTH,
  7801           DFHEIV99,
  7802           DFHEIV99,
  7803           DFHEIV99
  7804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7805
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 146
* EL130.cbl
  7806
  7807     IF RETURNED-FROM = XCTL-131
  7808        IF CLAIM-DELETED-BY-EL131
  7809            MOVE LOW-VALUES      TO CERTNOI
  7810                                    SUFXI
  7811            MOVE ZEROS           TO CERTNOL
  7812                                    SUFXL
  7813         END-IF
  7814     END-IF.
  7815
  7816     IF RETURNED-FROM = XCTL-131
  7817         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7818         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7819                                    PI-CERT-PROCESSED
  7820     ELSE
  7821
  7822
  7823* EXEC CICS READQ TS
  7824*             QUEUE   (QID)
  7825*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7826*             LENGTH  (PI-COMM-LENGTH)
  7827*        END-EXEC
  7828*    MOVE '*$I    L              ''   #00007618' TO DFHEIV0
  7829     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7830     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7831     MOVE X'2020233030303037363138' TO DFHEIV0(25:11)
  7832     CALL 'kxdfhei1' USING DFHEIV0,
  7833           QID,
  7834           PROGRAM-INTERFACE-BLOCK,
  7835           PI-COMM-LENGTH,
  7836           DFHEIV99,
  7837           DFHEIV99,
  7838           DFHEIV99
  7839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7840     END-IF.
  7841
  7842
  7843* EXEC CICS DELETEQ TS
  7844*        QUEUE   (QID)
  7845*    END-EXEC.
  7846*    MOVE '*&                    #   #00007625' TO DFHEIV0
  7847     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7848     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7849     MOVE X'2020233030303037363235' TO DFHEIV0(25:11)
  7850     CALL 'kxdfhei1' USING DFHEIV0,
  7851           QID,
  7852           DFHEIV99
  7853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7854
  7855
  7856     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7857
  7858     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7859         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7860         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7861         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7862         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7863         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 147
* EL130.cbl
  7864         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7865         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7866         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7867         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7868         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7869         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7870         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7871         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7872         MOVE SAVE-CERT-ACCESS-CONTROL
  7873                                    TO PI-CERT-ACCESS-CONTROL
  7874         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7875                                    TO PI-CARRIER-CONTROL-LEVEL
  7876     END-IF.
  7877
  7878*    IF EIBAID = DFHPF11
  7879*       move errmsg1i            to emi-line1
  7880*       move errmsg2i            to emi-line2
  7881*       move pi-emi-sub          to emi-sub
  7882*       go to 8200-SEND-DATAONLY
  7883*    end-if
  7884     IF RETURNED-FROM = XCTL-127
  7885         MOVE SAVE-EL127-TO-EL130-CNTRL
  7886                                 TO PI-EL127-TO-EL130-CNTRL
  7887     END-IF.
  7888
  7889     IF RETURNED-FROM = XCTL-6592
  7890        MOVE SAVE-EL659-TO-EL130-CNTRL
  7891                                 TO PI-EL659-TO-EL130-CNTRL
  7892     END-IF.
  7893
  7894     IF RETURNED-FROM = XCTL-114
  7895        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7896           MOVE SAVE-BENEFICIARY TO BENECDI
  7897           MOVE +10              TO BENECDL
  7898           MOVE -1               TO BIRTHDTL
  7899        END-IF
  7900     END-IF.
  7901     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7902
  7903     IF MAINTL NOT = ZERO
  7904         MOVE AL-UANON           TO MAINTA
  7905     END-IF.
  7906
  7907     IF ENTERPFL NOT = ZERO
  7908         MOVE AL-UNNON           TO ENTERPFA
  7909     END-IF.
  7910
  7911     IF RETURNED-FROM = XCTL-127
  7912         GO TO 0650-FROM-EL127
  7913     END-IF.
  7914
  7915     IF RETURNED-FROM = XCTL-132
  7916         GO TO 0640-FROM-EL132
  7917     END-IF.
  7918
  7919     IF RETURNED-FROM = XCTL-650
  7920         MOVE AL-SABON           TO PF5A
  7921         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 148
* EL130.cbl
  7922     END-IF.
  7923
  7924     IF RETURNED-FROM = XCTL-6592
  7925         GO TO 0630-FROM-EL6592
  7926     END-IF.
  7927
  7928     IF MAINTI = 'S' OR 'I'
  7929        GO TO 1000-SHOW-CLAIM
  7930     END-IF.
  7931
  7932     GO TO 8100-SEND-INITIAL-MAP.
  7933
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 149
* EL130.cbl
  7935 0630-FROM-EL6592.
  7936     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7937     MOVE PI-EL659-GROUPING      TO GROUPO.
  7938     MOVE PI-EL659-STATE         TO STATEO.
  7939     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7940
  7941     MOVE AL-UANON               TO CRTCARRA
  7942                                    GROUPA
  7943                                    STATEA
  7944                                    ACCOUNTA.
  7945     GO TO 8100-SEND-INITIAL-MAP.
  7946
  7947 0640-FROM-EL132.
  7948     IF PI-CLAIM-NO = SPACES
  7949         GO TO 0645-NO-CLAIM-SELECTED
  7950     END-IF.
  7951
  7952     MOVE LOW-VALUES             TO EL130AI.
  7953     MOVE 'MSTR'                 TO FILE-SWITCH.
  7954     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7955     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7956     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7957                                    CLMNOO.
  7958     MOVE AL-UANON               TO CLMNOA.
  7959     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7960
  7961
  7962
  7963* EXEC CICS HANDLE CONDITION
  7964*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7965*    END-EXEC.
  7966*    MOVE '"$I                   ! & #00007735' TO DFHEIV0
  7967     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7968     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7969     MOVE X'2620233030303037373335' TO DFHEIV0(25:11)
  7970     CALL 'kxdfhei1' USING DFHEIV0
  7971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7972
  7973
  7974     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7975     MOVE 'X'                    TO CLAIM-SWITCH.
  7976     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7977     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7978     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  7979     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  7980     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7981     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7982
  7983     MOVE ER-0213                TO EMI-ERROR.
  7984     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7985     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7986     GO TO 8100-SEND-INITIAL-MAP.
  7987
  7988 0645-NO-CLAIM-SELECTED.
  7989
  7990     IF MAINTI = 'S' OR 'I'
  7991        GO TO 1000-SHOW-CLAIM
  7992     END-IF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 150
* EL130.cbl
  7993
  7994     GO TO 8100-SEND-INITIAL-MAP.
  7995
  7996 0650-FROM-EL127.
  7997
  7998     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7999         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  8000                                    PI-CERT-PROCESSED
  8001     END-IF.
  8002
  8003     IF PI-RETURN-TO-PROGRAM = XCTL-727
  8004         MOVE +1                 TO PI-CERT-SELECT-CNT
  8005                                    PI-CERT-PROCESSED
  8006         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  8007         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  8008         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  8009         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  8010         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  8011         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  8012     END-IF.
  8013
  8014     IF PI-CERT-SELECT-CNT = ZERO
  8015         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8016             MOVE CERTNOI        TO PI-CERT-NO
  8017             MOVE SUFXI          TO PI-CERT-SFX
  8018             GO TO 3000-READ-CERT
  8019         ELSE
  8020             GO TO 8100-SEND-INITIAL-MAP
  8021         END-IF
  8022     END-IF.
  8023
  8024     MOVE AL-SABON               TO PF5A.
  8025
  8026     IF PI-CERT-PROCESSED = 1
  8027         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8028     END-IF.
  8029
  8030     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8031     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8032
  8033     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8034     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8035                                 TO CERT-CARRIER
  8036                                    PI-CARRIER.
  8037     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8038                                 TO CERT-GROUPING
  8039                                    PI-GROUPING.
  8040     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8041                                 TO CERT-STATE
  8042                                    PI-STATE.
  8043     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8044                                 TO CERT-ACCOUNT
  8045                                    PI-ACCOUNT.
  8046     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8047                                 TO CERT-EFF-DT
  8048                                    PI-CERT-EFF-DT.
  8049     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8050                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 151
* EL130.cbl
  8051                                    PI-CERT-NO.
  8052
  8053     MOVE 'CERT'                 TO FILE-SWITCH.
  8054     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8055
  8056     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8057     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8058     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8059
  8060     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8061         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8062         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8063         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8064         IF INCURRED-DATE-MATCH
  8065             MOVE ER-7352        TO EMI-ERROR
  8066             MOVE -1             TO CERTNOL
  8067             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8068         ELSE
  8069             IF NO-CLAIMS-FOR-CERT
  8070                 MOVE ER-7353    TO EMI-ERROR
  8071                 MOVE -1         TO CERTNOL
  8072                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8073             ELSE
  8074                 MOVE ER-0558    TO EMI-ERROR
  8075                 MOVE -1         TO CERTNOL
  8076                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8077             END-IF
  8078         END-IF
  8079     END-IF.
  8080
  8081     MOVE SPACES                 TO PI-PRT-OPT
  8082                                    PI-ALT-PRT.
  8083
  8084     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8085
  8086     if (ws-lf-joint-indicator not = 'J')
  8087        and (ws-ah-joint-indicator not = 'J')
  8088        move 'P'                 to INSTYPEO
  8089        MOVE AL-UANON            TO INSTYPEA
  8090     end-if
  8091     IF LSTNMEL NOT GREATER ZERO
  8092        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8093         MOVE CRTLNMEI           TO  LSTNMEO
  8094         MOVE CRTFNMEI           TO  FSTNMEO
  8095         MOVE CRTINITI           TO  INITO
  8096         MOVE AL-UANON           TO  LSTNMEA
  8097                                     FSTNMEA
  8098                                     INITA
  8099     END-IF.
  8100
  8101     IF SSNL GREATER ZERO
  8102         GO TO 0655-SKIP-SOCIAL-SECURITY
  8103     END-IF.
  8104
  8105     IF CRTSSNI = SPACES OR LOW-VALUES
  8106         GO TO 0655-SKIP-SOCIAL-SECURITY
  8107     END-IF.
  8108
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 152
* EL130.cbl
  8109     IF CM-SSN-STATE   = CM-STATE AND
  8110        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8111            GO TO 0655-SKIP-SOCIAL-SECURITY
  8112     END-IF.
  8113
  8114     MOVE CRTSSNI                TO SSNO
  8115     MOVE AL-UANON               TO SSNA.
  8116
  8117 0655-SKIP-SOCIAL-SECURITY.
  8118
  8119     IF CLMCARRL NOT = ZERO  AND
  8120        CLMCARRI NOT = CRTCARRI
  8121        MOVE ER-0562             TO EMI-ERROR
  8122        MOVE AL-UABON            TO CLMCARRA
  8123        MOVE -1                  TO CLMCARRL
  8124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8125     END-IF.
  8126
  8127     IF CLMCARRL = ZERO
  8128        MOVE AL-UANON            TO CLMCARRA
  8129        MOVE CRTCARRI            TO CLMCARRI
  8130     END-IF.
  8131
  8132     MOVE 'A'                    TO MAINTO.
  8133     MOVE AL-UANON               TO MAINTA.
  8134
  8135     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8136        GO TO 8100-SEND-INITIAL-MAP
  8137     ELSE
  8138        GO TO 8150-SEND-MAP-CURSOR
  8139     END-IF.
  8140
  8141 0660-NOT-FOUND.
  8142     MOVE ER-0214                TO EMI-ERROR.
  8143     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8144     GO TO 8100-SEND-INITIAL-MAP.
  8145
  8146 0670-QIDERR.
  8147     MOVE ER-0033                TO EMI-ERROR.
  8148     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8149     GO TO 8100-SEND-INITIAL-MAP.
  8150
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 153
* EL130.cbl
  8152 0680-PLUG-SELECTED-CERTS.
  8153
  8154     MOVE AL-SANON               TO BCERT1A
  8155                                    BSUFX1A
  8156                                    BCERT2A
  8157                                    BSUFX2A
  8158                                    BCERT3A
  8159                                    BSUFX3A
  8160                                    BCERT4A
  8161                                    BSUFX4A
  8162                                    BCERT5A
  8163                                    BSUFX5A.
  8164
  8165     IF PCERTNOO = SPACES OR LOW-VALUES
  8166         MOVE PI-EL127-CERT-PRIME (1)
  8167                                 TO PCERTNOO
  8168         MOVE PI-EL127-CERT-SUFX  (1)
  8169                                 TO PSUFXO
  8170     END-IF.
  8171
  8172     MOVE PI-EL127-CERT-PRIME (1)
  8173                                 TO BCERT1O.
  8174     MOVE PI-EL127-CERT-SUFX  (1)
  8175                                 TO BSUFX1O.
  8176
  8177     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8178         MOVE PI-EL127-CERT-PRIME (2)
  8179                                 TO BCERT2O
  8180         MOVE PI-EL127-CERT-SUFX  (2)
  8181                                 TO BSUFX2O
  8182     ELSE
  8183         MOVE LOW-VALUES         TO BCERT2O
  8184                                    BSUFX2O
  8185     END-IF.
  8186
  8187     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8188         MOVE PI-EL127-CERT-PRIME (3)
  8189                                 TO BCERT3O
  8190         MOVE PI-EL127-CERT-SUFX  (3)
  8191                                 TO BSUFX3O
  8192     ELSE
  8193         MOVE LOW-VALUES         TO BCERT3O
  8194                                    BSUFX3O
  8195     END-IF.
  8196
  8197     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8198         MOVE PI-EL127-CERT-PRIME (4)
  8199                                 TO BCERT4O
  8200         MOVE PI-EL127-CERT-SUFX  (4)
  8201                                 TO BSUFX4O
  8202     ELSE
  8203         MOVE LOW-VALUES         TO BCERT4O
  8204                                    BSUFX4O
  8205     END-IF.
  8206
  8207     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8208         MOVE PI-EL127-CERT-PRIME (5)
  8209                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 154
* EL130.cbl
  8210         MOVE PI-EL127-CERT-SUFX  (5)
  8211                                 TO BSUFX5O
  8212     ELSE
  8213         MOVE LOW-VALUES         TO BCERT5O
  8214                                    BSUFX5O
  8215     END-IF.
  8216
  8217 0680-EXIT.
  8218     EXIT.
  8219
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 155
* EL130.cbl
  8221 0690-HIGHLIGHT-CERTS.
  8222
  8223     MOVE AL-UANON               TO PCERTNOA
  8224                                    PSUFXA.
  8225
  8226     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8227        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8228            MOVE AL-SABON        TO BCERT1A
  8229                                    BSUFX1A
  8230     ELSE
  8231         MOVE AL-SANON           TO BCERT1A
  8232                                    BSUFX1A
  8233     END-IF.
  8234
  8235     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8236        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8237            MOVE AL-SABON        TO BCERT2A
  8238                                    BSUFX2A
  8239     ELSE
  8240         MOVE AL-SANON           TO BCERT2A
  8241                                    BSUFX2A
  8242     END-IF.
  8243
  8244     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8245        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8246            MOVE AL-SABON        TO BCERT3A
  8247                                    BSUFX3A
  8248     ELSE
  8249         MOVE AL-SANON           TO BCERT3A
  8250                                    BSUFX3A
  8251     END-IF.
  8252
  8253     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8254        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8255            MOVE AL-SABON        TO BCERT4A
  8256                                    BSUFX4A
  8257     ELSE
  8258         MOVE AL-SANON           TO BCERT4A
  8259                                    BSUFX4A
  8260     END-IF.
  8261
  8262     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8263        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8264            MOVE AL-SABON        TO BCERT5A
  8265                                    BSUFX5A
  8266     ELSE
  8267         MOVE AL-SANON           TO BCERT5A
  8268                                    BSUFX5A
  8269     END-IF.
  8270
  8271 0690-EXIT.
  8272     EXIT.
  8273
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 156
* EL130.cbl
  8275 0800-TEST-PREVIOUS-CONTROL.
  8276     IF CLMNOI   = PI-LAST-CLAIM       AND
  8277        CLMCARRI = PI-LAST-CARR        AND
  8278        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8279        SUFXI    = PI-LAST-CERT-SUFX
  8280*        NEXT SENTENCE
  8281         CONTINUE
  8282     ELSE
  8283         MOVE ER-0207            TO EMI-ERROR
  8284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8285         MOVE -1                 TO MAINTL
  8286         GO TO 8200-SEND-DATAONLY
  8287     END-IF.
  8288
  8289     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8290
  8291     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8292     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8293     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8294
  8295     IF EIBAID = DFHPF7
  8296         MOVE XCTL-157           TO PGM-NAME
  8297     END-IF.
  8298
  8299     IF EIBAID = DFHPF8
  8300         MOVE XCTL-141           TO PGM-NAME
  8301     END-IF.
  8302
  8303     IF EIBAID = DFHPF9
  8304        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8305                                    PI-SAVED-PROGRAM-2
  8306                                    PI-SAVED-PROGRAM-3
  8307                                    PI-SAVED-PROGRAM-4
  8308                                    PI-SAVED-PROGRAM-5
  8309                                    PI-SAVED-PROGRAM-6
  8310        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8311        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8312        MOVE XCTL-150            TO PGM-NAME
  8313     END-IF.
  8314
  8315     GO TO 9300-XCTL.
  8316
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 157
* EL130.cbl
  8318 1000-SHOW-CLAIM.
  8319
  8320     IF CLMNOL = ZERO
  8321         MOVE -1                 TO CLMNOL
  8322         MOVE AL-UABON           TO CLMNOA
  8323         MOVE ER-0202            TO EMI-ERROR
  8324         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8325     ELSE
  8326         MOVE AL-UANON           TO CLMNOA
  8327     END-IF.
  8328
  8329     IF PI-NO-CARRIER-SECURITY
  8330        IF CLMCARRL = ZERO
  8331             MOVE -1             TO CLMCARRL
  8332             MOVE AL-UABON       TO CLMCARRA
  8333             MOVE ER-0194        TO EMI-ERROR
  8334             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8335         ELSE
  8336             MOVE AL-UANON       TO CLMCARRA
  8337         END-IF
  8338     END-IF.
  8339
  8340     IF SUFXL = ZERO
  8341         MOVE SPACES             TO SUFXI
  8342         MOVE AL-UANON           TO SUFXA
  8343     ELSE
  8344         MOVE AL-UANON           TO SUFXA
  8345     END-IF.
  8346
  8347     IF NOT EMI-NO-ERRORS
  8348         GO TO 1050-SEND-CHECK
  8349     END-IF.
  8350
  8351
  8352
  8353* EXEC CICS HANDLE CONDITION
  8354*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8355*    END-EXEC.
  8356*    MOVE '"$I                   ! '' #00008117' TO DFHEIV0
  8357     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8359     MOVE X'2720233030303038313137' TO DFHEIV0(25:11)
  8360     CALL 'kxdfhei1' USING DFHEIV0
  8361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8362
  8363
  8364     MOVE 'MSTR'                 TO FILE-SWITCH
  8365     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8366
  8367     MOVE CLMCARRI               TO MSTR-CARRIER.
  8368     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8369
  8370     IF CERTNOL = ZERO     OR
  8371        CERTNOI = SPACES   OR
  8372        CERTNOI = LOW-VALUES
  8373         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8374         MOVE AL-SANON        TO CERTNOA
  8375                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 158
* EL130.cbl
  8376     ELSE
  8377         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8378     END-IF.
  8379
  8380     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8381     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8382
  8383
  8384
  8385* EXEC CICS HANDLE CONDITION
  8386*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8387*    END-EXEC.
  8388*    MOVE '"$I                   ! ( #00008141' TO DFHEIV0
  8389     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8391     MOVE X'2820233030303038313431' TO DFHEIV0(25:11)
  8392     CALL 'kxdfhei1' USING DFHEIV0
  8393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8394
  8395
  8396     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8397
  8398     IF NOT PI-NO-ACCOUNT-SECURITY
  8399         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8400           MOVE ER-2371          TO EMI-ERROR
  8401           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8402           MOVE -1               TO MAINTL
  8403           GO TO 8200-SEND-DATAONLY
  8404         END-IF
  8405     END-IF.
  8406
  8407
  8408
  8409* EXEC CICS HANDLE CONDITION
  8410*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8411*    END-EXEC.
  8412*    MOVE '"$I                   ! ) #00008157' TO DFHEIV0
  8413     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8414     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8415     MOVE X'2920233030303038313537' TO DFHEIV0(25:11)
  8416     CALL 'kxdfhei1' USING DFHEIV0
  8417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8418
  8419
  8420     MOVE 'Y'                    TO CLAIM-SWITCH.
  8421     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8422     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8423     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8424     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8425     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8426
  8427 1000-SHOW-END-OF-PERFORM.
  8428
  8429     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8430     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8431     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8432     MOVE CL-CERT-STATE          TO CERT-STATE.
  8433     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 159
* EL130.cbl
  8434     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8435     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8436
  8437     MOVE 'CERT'                 TO FILE-SWITCH.
  8438
  8439     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8440
  8441     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8442     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8443     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8444     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8445     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8446     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8447     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8448     MOVE CLMCARRI               TO PI-LAST-CARR.
  8449
  8450     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8451
  8452     IF MAINTI = 'I'
  8453         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8454                 BIRTHDTA  LSTNMEA   RELCLMA
  8455                 LOANNOA   LOANBALA  BENECDA
  8456         MOVE AL-SANON TO  SSNA
  8457         MOVE SPACES   TO  INCURI    REPORTI
  8458         MOVE 'Y'      TO PI-INCURR-SW
  8459         MOVE ER-0522  TO EMI-ERROR
  8460         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8461     ELSE
  8462         MOVE ' '      TO PI-INCURR-SW
  8463     END-IF.
  8464
  8465     MOVE -1                     TO MAINTL.
  8466     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8467     MOVE CERT-GROUPING          TO PI-GROUPING.
  8468     MOVE CERT-STATE             TO PI-STATE.
  8469     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8470     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8471     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8472     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8473
  8474     IF RETURNED-FROM NOT = SPACES
  8475         GO TO 8100-SEND-INITIAL-MAP
  8476     ELSE
  8477         GO TO 8200-SEND-DATAONLY
  8478     END-IF.
  8479
  8480 1025-SHOW-RECORD-NOT-FOUND.
  8481
  8482     IF FILE-SWITCH = 'MSTR'
  8483         MOVE ER-0204            TO EMI-ERROR
  8484     ELSE
  8485         IF FILE-SWITCH = 'TRLR'
  8486             MOVE ER-0205        TO EMI-ERROR
  8487         ELSE
  8488             MOVE ER-0206        TO EMI-ERROR
  8489         END-IF
  8490     END-IF.
  8491
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 160
* EL130.cbl
  8492     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8493
  8494 1050-SEND-CHECK.
  8495
  8496     IF RETURNED-FROM NOT = SPACES
  8497         GO TO 8100-SEND-INITIAL-MAP
  8498     ELSE
  8499         MOVE -1                 TO MAINTL
  8500         GO TO 8200-SEND-DATAONLY
  8501     END-IF.
  8502
  8503 2000-DELETE-CLAIM.
  8504     IF NOT MODIFY-CAP
  8505         MOVE ER-0070            TO EMI-ERROR
  8506         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8507         MOVE -1                 TO MAINTL
  8508         GO TO 8200-SEND-DATAONLY
  8509     END-IF.
  8510
  8511     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8512        CLMCARRI NOT = PI-LAST-CARR        OR
  8513        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8514        SUFXI    NOT = PI-LAST-CERT-SUFX
  8515         MOVE ER-0207            TO EMI-ERROR
  8516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8517         MOVE -1                 TO MAINTL
  8518         GO TO 8200-SEND-DATAONLY
  8519     END-IF.
  8520
  8521
  8522
  8523* EXEC CICS HANDLE CONDITION
  8524*        NOTFND   (2050-DELETE-NOT-FOUND)
  8525*    END-EXEC.
  8526*    MOVE '"$I                   ! * #00008263' TO DFHEIV0
  8527     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8529     MOVE X'2A20233030303038323633' TO DFHEIV0(25:11)
  8530     CALL 'kxdfhei1' USING DFHEIV0
  8531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8532
  8533
  8534     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8535
  8536     MOVE CLMCARRI               TO MSTR-CARRIER.
  8537     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8538     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8539     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8540
  8541     MOVE 'MSTR'                 TO FILE-SWITCH.
  8542     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8543
  8544     MOVE 'Y'                    TO CLAIM-SWITCH.
  8545
  8546     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8547        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8548         MOVE ER-0068        TO EMI-ERROR
  8549         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 161
* EL130.cbl
  8550         MOVE -1             TO MAINTL
  8551         GO TO 8200-SEND-DATAONLY
  8552     END-IF.
  8553
  8554     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8555         MOVE ER-0569            TO EMI-ERROR
  8556         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8557         MOVE -1                 TO MAINTL
  8558         GO TO 8200-SEND-DATAONLY
  8559     END-IF.
  8560
  8561     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8562         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8563     END-IF.
  8564
  8565     IF CL-PURGED-DT NOT = LOW-VALUES
  8566         MOVE ER-7691            TO EMI-ERROR
  8567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8568         MOVE -1                 TO MAINTL
  8569         GO TO 8200-SEND-DATAONLY
  8570     END-IF.
  8571
  8572     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8573     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8574     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8575     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8576     MOVE +0                     TO TRLR-SEQ-NO.
  8577     MOVE '1'                    TO TRLR-TYPE.
  8578
  8579     MOVE 'TRLR'                 TO FILE-SWITCH.
  8580
  8581
  8582
  8583* EXEC CICS READ
  8584*        UPDATE
  8585*        DATASET  (ELTRLR-DSID)
  8586*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8587*        RIDFLD   (ELTRLR-KEY)
  8588*    END-EXEC.
  8589*    MOVE '&"S        EU         (   #00008315' TO DFHEIV0
  8590     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8591     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8592     MOVE X'2020233030303038333135' TO DFHEIV0(25:11)
  8593     CALL 'kxdfhei1' USING DFHEIV0,
  8594           ELTRLR-DSID,
  8595           DFHEIV20,
  8596           DFHEIV99,
  8597           ELTRLR-KEY,
  8598           DFHEIV99,
  8599           DFHEIV99,
  8600           DFHEIV99
  8601     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8602         DFHEIV20
  8603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8604
  8605
  8606     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8607        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 162
* EL130.cbl
  8608         MOVE ER-0068        TO EMI-ERROR
  8609         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8610         MOVE -1             TO MAINTL
  8611         GO TO 8200-SEND-DATAONLY
  8612     END-IF.
  8613
  8614
  8615
  8616* EXEC CICS DELETE
  8617*        DATASET   (ELTRLR-DSID)
  8618*    END-EXEC.
  8619*    MOVE '&(                    &   #00008331' TO DFHEIV0
  8620     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8621     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8622     MOVE X'2020233030303038333331' TO DFHEIV0(25:11)
  8623     CALL 'kxdfhei1' USING DFHEIV0,
  8624           ELTRLR-DSID,
  8625           DFHEIV99,
  8626           DFHEIV99,
  8627           DFHEIV99,
  8628           DFHEIV99
  8629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8630
  8631
  8632     MOVE +90                    TO TRLR-SEQ-NO.
  8633     MOVE '6'                    TO TRLR-TYPE.
  8634
  8635
  8636
  8637* EXEC CICS READ
  8638*        UPDATE
  8639*        DATASET  (ELTRLR-DSID)
  8640*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8641*        RIDFLD   (ELTRLR-KEY)
  8642*    END-EXEC.
  8643*    MOVE '&"S        EU         (   #00008339' TO DFHEIV0
  8644     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8645     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8646     MOVE X'2020233030303038333339' TO DFHEIV0(25:11)
  8647     CALL 'kxdfhei1' USING DFHEIV0,
  8648           ELTRLR-DSID,
  8649           DFHEIV20,
  8650           DFHEIV99,
  8651           ELTRLR-KEY,
  8652           DFHEIV99,
  8653           DFHEIV99,
  8654           DFHEIV99
  8655     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8656         DFHEIV20
  8657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8658
  8659
  8660
  8661
  8662* EXEC CICS DELETE
  8663*        DATASET   (ELTRLR-DSID)
  8664*    END-EXEC.
  8665*    MOVE '&(                    &   #00008347' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 163
* EL130.cbl
  8666     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8667     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8668     MOVE X'2020233030303038333437' TO DFHEIV0(25:11)
  8669     CALL 'kxdfhei1' USING DFHEIV0,
  8670           ELTRLR-DSID,
  8671           DFHEIV99,
  8672           DFHEIV99,
  8673           DFHEIV99,
  8674           DFHEIV99
  8675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8676
  8677
  8678     MOVE +91                    TO TRLR-SEQ-NO.
  8679     MOVE '6'                    TO TRLR-TYPE.
  8680
  8681
  8682
  8683* EXEC CICS READ
  8684*        UPDATE
  8685*        DATASET  (ELTRLR-DSID)
  8686*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8687*        RIDFLD   (ELTRLR-KEY)
  8688*        RESP     (WS-RESPONSE)
  8689*    END-EXEC
  8690*    MOVE '&"S        EU         (  N#00008355' TO DFHEIV0
  8691     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8692     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8693     MOVE X'204E233030303038333535' TO DFHEIV0(25:11)
  8694     CALL 'kxdfhei1' USING DFHEIV0,
  8695           ELTRLR-DSID,
  8696           DFHEIV20,
  8697           DFHEIV99,
  8698           ELTRLR-KEY,
  8699           DFHEIV99,
  8700           DFHEIV99,
  8701           DFHEIV99
  8702     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8703         DFHEIV20
  8704     MOVE EIBRESP  TO WS-RESPONSE
  8705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8706
  8707     IF WS-RESP-NORMAL
  8708
  8709* EXEC CICS DELETE
  8710*          DATASET   (ELTRLR-DSID)
  8711*       END-EXEC
  8712*    MOVE '&(                    &   #00008364' TO DFHEIV0
  8713     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8714     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8715     MOVE X'2020233030303038333634' TO DFHEIV0(25:11)
  8716     CALL 'kxdfhei1' USING DFHEIV0,
  8717           ELTRLR-DSID,
  8718           DFHEIV99,
  8719           DFHEIV99,
  8720           DFHEIV99,
  8721           DFHEIV99
  8722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8723     END-IF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 164
* EL130.cbl
  8724
  8725     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8726     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8727     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8728     MOVE CL-CERT-STATE          TO CERT-STATE.
  8729     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8730     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8731     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8732
  8733     MOVE 'CERT'                 TO FILE-SWITCH.
  8734
  8735     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8736
  8737     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8738
  8739     IF WS-NUM-HOLD NOT = +0
  8740         GO TO 2005-REWRITE-CERT
  8741     END-IF.
  8742
  8743     IF NOT CERT-WAS-CREATED
  8744         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8745         GO TO 2005-REWRITE-CERT
  8746     END-IF.
  8747
  8748
  8749
  8750* EXEC CICS DELETE
  8751*        DATASET   (ELCERT-DSID)
  8752*    END-EXEC.
  8753*    MOVE '&(                    &   #00008393' TO DFHEIV0
  8754     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8755     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8756     MOVE X'2020233030303038333933' TO DFHEIV0(25:11)
  8757     CALL 'kxdfhei1' USING DFHEIV0,
  8758           ELCERT-DSID,
  8759           DFHEIV99,
  8760           DFHEIV99,
  8761           DFHEIV99,
  8762           DFHEIV99
  8763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8764
  8765
  8766     GO TO 2010-DELETE-CL.
  8767
  8768 2005-REWRITE-CERT.
  8769
  8770     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8771
  8772
  8773
  8774* EXEC CICS HANDLE CONDITION
  8775*         DUPKEY   (2010-DELETE-CL)
  8776*    END-EXEC.
  8777*    MOVE '"$$                   ! + #00008404' TO DFHEIV0
  8778     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8780     MOVE X'2B20233030303038343034' TO DFHEIV0(25:11)
  8781     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 165
* EL130.cbl
  8782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8783
  8784
  8785
  8786
  8787* EXEC CICS REWRITE
  8788*        DATASET  (ELCERT-DSID)
  8789*        FROM     (CERTIFICATE-MASTER)
  8790*    END-EXEC.
  8791     MOVE LENGTH OF
  8792      CERTIFICATE-MASTER
  8793       TO DFHEIV11
  8794*    MOVE '&& L                  %   #00008409' TO DFHEIV0
  8795     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8796     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8797     MOVE X'2020233030303038343039' TO DFHEIV0(25:11)
  8798     CALL 'kxdfhei1' USING DFHEIV0,
  8799           ELCERT-DSID,
  8800           CERTIFICATE-MASTER,
  8801           DFHEIV11,
  8802           DFHEIV99
  8803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8804
  8805
  8806 2010-DELETE-CL.
  8807
  8808
  8809
  8810* EXEC CICS DELETE
  8811*        DATASET  (ELMSTR-DSID)
  8812*    END-EXEC.
  8813*    MOVE '&(                    &   #00008417' TO DFHEIV0
  8814     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8815     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8816     MOVE X'2020233030303038343137' TO DFHEIV0(25:11)
  8817     CALL 'kxdfhei1' USING DFHEIV0,
  8818           ELMSTR-DSID,
  8819           DFHEIV99,
  8820           DFHEIV99,
  8821           DFHEIV99,
  8822           DFHEIV99
  8823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8824
  8825
  8826     MOVE -1                     TO ONE-OR-MIN1.
  8827     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8828
  8829     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8830         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8831                                    WS-SAVE-CLAIM-KEY
  8832         MOVE +1                 TO ONE-OR-MIN1
  8833         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8834     END-IF.
  8835
  8836     MOVE ER-0000                TO EMI-ERROR.
  8837     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8838     MOVE LOW-VALUES             TO EL130AO.
  8839     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 166
* EL130.cbl
  8840     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8841     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8842                                    PI-CERT-PROCESSED
  8843                                    PI-LETTER-ERROR-CODE.
  8844     GO TO 8100-SEND-INITIAL-MAP.
  8845
  8846 2050-DELETE-NOT-FOUND.
  8847     IF FILE-SWITCH = 'MSTR'
  8848         MOVE -1                 TO CLMNOL
  8849         MOVE ER-0204            TO EMI-ERROR
  8850     ELSE
  8851         IF FILE-SWITCH = 'TRLR'
  8852             MOVE -1             TO MAINTL
  8853             MOVE ER-0205        TO EMI-ERROR
  8854         ELSE
  8855             MOVE -1             TO CERTNOL
  8856             MOVE ER-0206        TO EMI-ERROR
  8857         END-IF
  8858     END-IF.
  8859
  8860     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8861     GO TO 8200-SEND-DATAONLY.
  8862
  8863 3000-ADD-CLAIM.
  8864     IF NOT MODIFY-CAP
  8865         MOVE ER-0070            TO EMI-ERROR
  8866         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8867         MOVE -1                 TO MAINTL
  8868         GO TO 8200-SEND-DATAONLY
  8869     END-IF.
  8870
  8871     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8872
  8873     IF CERTMTI = 'S'
  8874         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8875            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8876            WS-EFFDT = PI-SAVE-EFFDT       AND
  8877            ACCOUNTI = PI-SAVE-ACCOUNT
  8878             IF EMI-ERROR = 0
  8879                 GO TO 3010-TEST-FOR-ERRORS
  8880             ELSE
  8881                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8882                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8883                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8884                 MOVE PI-STATE         TO  CERT-STATE
  8885                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8886                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8887                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8888
  8889
  8890* EXEC CICS HANDLE CONDITION
  8891*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8892*                END-EXEC
  8893*    MOVE '"$I                   ! , #00008484' TO DFHEIV0
  8894     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8895     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8896     MOVE X'2C20233030303038343834' TO DFHEIV0(25:11)
  8897     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 167
* EL130.cbl
  8898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8899                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  8900                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8901                 GO TO 3010-TEST-FOR-ERRORS
  8902             END-IF
  8903         END-IF
  8904     END-IF.
  8905
  8906     IF CERTMTI = 'A'
  8907         IF NOT PI-NO-CARRIER-SECURITY OR
  8908             NOT PI-NO-ACCOUNT-SECURITY
  8909             MOVE ER-2370          TO EMI-ERROR
  8910             MOVE -1               TO MAINTL
  8911             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8912             GO TO 8200-SEND-DATAONLY
  8913         ELSE
  8914             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8915             GO TO 3010-TEST-FOR-ERRORS
  8916         END-IF
  8917     END-IF.
  8918
  8919     IF CERTNOL = ZEROS
  8920        GO TO 3010-TEST-FOR-ERRORS
  8921     END-IF.
  8922
  8923 3000-READ-CERT.
  8924
  8925     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8926                                    MSTR5-COMP-CD.
  8927     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8928                                    MSTR5-CERT-NO-PRIME.
  8929     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8930                                    MSTR5-CERT-NO-SUFX.
  8931
  8932
  8933
  8934* EXEC CICS HANDLE CONDITION
  8935*         DUPKEY   (3008-DUP-ERROR)
  8936*         NOTFND   (3009-NOT-FOUND)
  8937*    END-EXEC
  8938*    MOVE '"$$I                  ! - #00008521' TO DFHEIV0
  8939     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8940     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8941     MOVE X'2D20233030303038353231' TO DFHEIV0(25:11)
  8942     CALL 'kxdfhei1' USING DFHEIV0
  8943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8944
  8945     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8946
  8947     IF NOT PI-NO-ACCOUNT-SECURITY
  8948         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8949             MOVE ER-2371          TO EMI-ERROR
  8950             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8951             MOVE -1               TO MAINTL
  8952             GO TO 8200-SEND-DATAONLY
  8953         END-IF
  8954     END-IF.
  8955
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 168
* EL130.cbl
  8956     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8957     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  8958     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8959     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8960     MOVE CM-CARRIER             TO PI-CARRIER.
  8961     MOVE CM-GROUPING            TO PI-GROUPING.
  8962     MOVE CM-STATE               TO PI-STATE.
  8963     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8964     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8965     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8966     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8967
  8968     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8969         IF LSTNMEO = SPACES OR LOW-VALUES
  8970             MOVE CRTLNMEI       TO  LSTNMEO
  8971             MOVE AL-UANON       TO  LSTNMEA
  8972         END-IF
  8973     END-IF.
  8974
  8975     MOVE 'S'                    TO CERTMTO.
  8976*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8977     MOVE AL-SANON               TO CERTNOA.
  8978     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8979                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8980     IF EMI-NO-ERRORS
  8981         MOVE -1                  TO MAINTL
  8982     END-IF.
  8983
  8984     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8985         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8986         IF INCURRED-DATE-MATCH
  8987             MOVE ER-7352         TO EMI-ERROR
  8988             MOVE -1              TO CERTNOL
  8989             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8990         ELSE
  8991             IF NO-CLAIMS-FOR-CERT
  8992                 MOVE ER-7353     TO EMI-ERROR
  8993                 MOVE -1          TO CERTNOL
  8994                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8995             ELSE
  8996                 MOVE ER-0558     TO EMI-ERROR
  8997                 MOVE -1          TO CERTNOL
  8998                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8999                 GO TO 3010-TEST-FOR-ERRORS
  9000             END-IF
  9001         END-IF
  9002     END-IF.
  9003
  9004 3007-SEND-SCREEN.
  9005     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9006         GO TO 8150-SEND-MAP-CURSOR
  9007     ELSE
  9008         GO TO 8200-SEND-DATAONLY
  9009     END-IF.
  9010
  9011 3008-DUP-ERROR.
  9012     MOVE ER-0560                TO EMI-ERROR.
  9013     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 169
* EL130.cbl
  9014     MOVE -1                     TO CERTNOL.
  9015     GO TO 3007-SEND-SCREEN.
  9016
  9017 3009-NOT-FOUND.
  9018     MOVE ER-0214                TO EMI-ERROR.
  9019     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9020     MOVE -1                     TO CERTNOL.
  9021     GO TO 3007-SEND-SCREEN.
  9022
  9023 3010-TEST-FOR-ERRORS.
  9024
  9025     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9026     perform 6500-get-acct    thru 6500-exit
  9027     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9028*     perform 6500-get-acct    thru 6500-exit
  9029
  9030     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9031     move +0                     to e1
  9032     move spaces                 to ws-dcc-error-line
  9033     move ' '                    to ws-zero-bens-avail
  9034
  9035     if ws-dcc-product-code not = spaces
  9036        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9037        IF ERPDEF-FOUND
  9038           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9039           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9040           MOVE '1'              TO DC-OPTION-CODE
  9041           MOVE +0               TO DC-ELAPSED-MONTHS
  9042                                    DC-ELAPSED-DAYS
  9043           PERFORM 9700-LINK-DATE-CONVERT
  9044                                 THRU 9700-EXIT
  9045           IF NO-CONVERSION-ERROR
  9046              MOVE DC-ELAPSED-MONTHS
  9047                                 TO WS-MONTHS-BETWEEN
  9048              IF DC-ELAPSED-DAYS > 1
  9049                 ADD 1 TO WS-MONTHS-BETWEEN
  9050              END-IF
  9051           ELSE
  9052              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9053           END-IF
  9054
  9055           evaluate true
  9056              when (ws-excl-period not = zeros)
  9057                 and (ws-months-between <= ws-excl-period)
  9058                 MOVE -1         TO MAINTL
  9059                 add +1          to e1
  9060                 move 'Y'        to ws-zero-bens-avail
  9061                 MOVE ER-1651    TO EMI-ERROR
  9062                                    ws-error-no (e1)
  9063                 PERFORM 9900-ERROR-FORMAT
  9064                                 THRU 9900-EXIT
  9065              when (ws-cov-ends not = zeros)
  9066                 and (ws-months-between > ws-cov-ends)
  9067                 MOVE -1         TO MAINTL
  9068                 add +1          to e1
  9069                 move 'Y'        to ws-zero-bens-avail
  9070                 MOVE ER-1653    TO EMI-ERROR
  9071                                    ws-error-no (e1)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 170
* EL130.cbl
  9072                 evaluate true
  9073                    when clmtypei = 'L'
  9074                       move '  LF  ' to emi-claim-type
  9075                    when clmtypei = 'I'
  9076                       move '  IU  ' to emi-claim-type
  9077                    when clmtypei = 'F'
  9078                       move '  FL  ' to emi-claim-type
  9079                    when other
  9080                       move '  AH  ' to emi-claim-type
  9081                 end-evaluate
  9082                 PERFORM 9900-ERROR-FORMAT
  9083                                 THRU 9900-EXIT
  9084              when (ws-acc-period not = zeros)
  9085                 and (ws-months-between <= ws-acc-period)
  9086                 MOVE -1         TO MAINTL
  9087                 add +1          to e1
  9088                 MOVE ER-1652    TO EMI-ERROR
  9089                                    ws-error-no (e1)
  9090                 PERFORM 9900-ERROR-FORMAT
  9091                                 THRU 9900-EXIT
  9092                 add +1          to e1
  9093                 move er-1655    to emi-error
  9094                                    ws-error-no (e1)
  9095                 PERFORM 9900-ERROR-FORMAT
  9096                                 THRU 9900-EXIT
  9097              when clmtypei = 'I'
  9098                 add +1          to e1
  9099                 move er-1661    to emi-error
  9100                                    ws-error-no (e1)
  9101                 PERFORM 9900-ERROR-FORMAT
  9102                                 THRU 9900-EXIT
  9103           end-evaluate
  9104        END-IF
  9105*       perform 3996-read-cert-claim-trailer
  9106*                                thru 3996-exit
  9107     END-IF
  9108     perform 3996-read-cert-claim-trailer
  9109                                 thru 3996-exit
  9110     IF CERTMTI NOT = 'A'
  9111         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9112             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9113             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9114             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9115             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9116             IF INCURRED-DATE-MATCH
  9117                 MOVE ER-7352         TO EMI-ERROR
  9118                 MOVE -1              TO CERTNOL
  9119                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9120             ELSE
  9121                 IF NO-CLAIMS-FOR-CERT
  9122                     MOVE ER-7353     TO EMI-ERROR
  9123                     MOVE -1          TO CERTNOL
  9124                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9125                 ELSE
  9126                     MOVE ER-0558     TO EMI-ERROR
  9127                     MOVE -1          TO CERTNOL
  9128                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9129                 END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 171
* EL130.cbl
  9130             END-IF
  9131         END-IF
  9132     END-IF.
  9133
  9134     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9135         MOVE ER-0433             TO EMI-ERROR
  9136         MOVE -1                  TO MAINTL
  9137         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9138         GO TO 8200-SEND-DATAONLY
  9139     END-IF.
  9140
  9141     IF (EMI-NO-ERRORS)
  9142        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9143         GO TO 3015-TRY-TO-BUILD
  9144     END-IF.
  9145
  9146     IF EIBAID = DFHPF6
  9147         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9148             MOVE ER-0434         TO EMI-ERROR
  9149             MOVE -1              TO MAINTL
  9150             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9151             GO TO 8200-SEND-DATAONLY
  9152         ELSE
  9153             MOVE +1              TO INCURL
  9154             GO TO 3015-TRY-TO-BUILD
  9155         END-IF
  9156     END-IF.
  9157
  9158     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9159         GO TO 8150-SEND-MAP-CURSOR
  9160     ELSE
  9161         GO TO 8200-SEND-DATAONLY
  9162     END-IF.
  9163
  9164 3015-TRY-TO-BUILD.
  9165     IF CLMNOL EQUAL ZERO
  9166         GO TO 3030-BUILD-CONT
  9167     END-IF.
  9168
  9169
  9170
  9171* EXEC CICS HANDLE CONDITION
  9172*        NOTFND   (3030-BUILD-CONT)
  9173*    END-EXEC.
  9174*    MOVE '"$I                   ! . #00008751' TO DFHEIV0
  9175     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9176     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9177     MOVE X'2E20233030303038373531' TO DFHEIV0(25:11)
  9178     CALL 'kxdfhei1' USING DFHEIV0
  9179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9180
  9181
  9182     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9183
  9184     MOVE CLMCARRI               TO MSTR-CARRIER.
  9185     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9186     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9187     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 172
* EL130.cbl
  9188
  9189     MOVE 'MSTR'                 TO FILE-SWITCH.
  9190
  9191     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9192
  9193     MOVE ER-0221                TO EMI-ERROR.
  9194
  9195     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9196     MOVE -1                     TO MAINTL.
  9197     GO TO 8200-SEND-DATAONLY.
  9198
  9199 3030-BUILD-CONT.
  9200     IF (CERTMTI NOT = 'A')
  9201        and (pi-company-id not = 'DCC')
  9202         GO TO 3060-BUILD-CONT
  9203     END-IF.
  9204
  9205
  9206
  9207* EXEC CICS HANDLE CONDITION
  9208*        NOTFND   (3033-ACCT-NOT-FOUND)
  9209*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9210*    END-EXEC.
  9211*    MOVE '"$I''                  ! / #00008779' TO DFHEIV0
  9212     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9213     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9214     MOVE X'2F20233030303038373739' TO DFHEIV0(25:11)
  9215     CALL 'kxdfhei1' USING DFHEIV0
  9216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9217
  9218
  9219     MOVE SPACES                 TO ERACCT-KEY.
  9220
  9221     IF CARR-GROUP-ST-ACCNT-CNTL
  9222         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9223         MOVE CRTCARRI           TO ACCT-CARRIER
  9224         MOVE GROUPI             TO ACCT-GROUPING
  9225         MOVE STATEI             TO ACCT-STATE
  9226         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9227         GO TO 3031-MOVE-ACCT-KEY
  9228     END-IF.
  9229
  9230     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9231     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9232
  9233     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9234         MOVE STATEI             TO ACCT-STATE
  9235     END-IF.
  9236
  9237     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9238         MOVE CRTCARRI           TO ACCT-CARRIER
  9239     END-IF.
  9240
  9241 3031-MOVE-ACCT-KEY.
  9242     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9243
  9244
  9245
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 173
* EL130.cbl
  9246* EXEC CICS STARTBR
  9247*        DATASET     (ERACCT2-DSID)
  9248*        RIDFLD      (SAVE-ERACCT-KEY)
  9249*        GENERIC
  9250*        KEYLENGTH   (20)
  9251*    END-EXEC.
  9252     MOVE 20
  9253       TO DFHEIV11
  9254     MOVE 0
  9255       TO DFHEIV12
  9256*    MOVE '&,   KG    G          &   #00008810' TO DFHEIV0
  9257     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9259     MOVE X'2020233030303038383130' TO DFHEIV0(25:11)
  9260     CALL 'kxdfhei1' USING DFHEIV0,
  9261           ERACCT2-DSID,
  9262           SAVE-ERACCT-KEY,
  9263           DFHEIV11,
  9264           DFHEIV12,
  9265           DFHEIV99
  9266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9267
  9268
  9269
  9270
  9271* EXEC CICS HANDLE CONDITION
  9272*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9273*    END-EXEC.
  9274*    MOVE '"$''                   ! 0 #00008818' TO DFHEIV0
  9275     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9277     MOVE X'3020233030303038383138' TO DFHEIV0(25:11)
  9278     CALL 'kxdfhei1' USING DFHEIV0
  9279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9280
  9281
  9282 3031-READ-ACCT-LOOP.
  9283
  9284
  9285* EXEC CICS READNEXT
  9286*        DATASET   (ERACCT2-DSID)
  9287*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9288*        RIDFLD    (SAVE-ERACCT-KEY)
  9289*    END-EXEC.
  9290     MOVE 0
  9291       TO DFHEIV11
  9292*    MOVE '&.S                   )   #00008824' TO DFHEIV0
  9293     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9294     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9295     MOVE X'2020233030303038383234' TO DFHEIV0(25:11)
  9296     CALL 'kxdfhei1' USING DFHEIV0,
  9297           ERACCT2-DSID,
  9298           DFHEIV20,
  9299           DFHEIV99,
  9300           SAVE-ERACCT-KEY,
  9301           DFHEIV99,
  9302           DFHEIV11,
  9303           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 174
* EL130.cbl
  9304           DFHEIV99
  9305     SET ADDRESS OF ACCOUNT-MASTER TO
  9306         DFHEIV20
  9307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9308
  9309
  9310     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9311        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9312        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9313        ACCT-STATE    NOT = AM-VG-STATE       OR
  9314        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9315         GO TO 3033-ACCT-NOT-FOUND
  9316     END-IF.
  9317
  9318     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9319        WS-EFFDT LESS AM-EXPIRATION-DT
  9320         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9321         MOVE AM-CARRIER       TO CERT-CARRIER
  9322         MOVE AM-GROUPING      TO CERT-GROUPING
  9323         MOVE AM-STATE         TO CERT-STATE
  9324         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9325         MOVE WS-EFFDT         TO CERT-EFF-DT
  9326         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9327         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9328         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9329         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9330     END-IF.
  9331
  9332     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9333         GO TO 3031-READ-ACCT-LOOP
  9334     END-IF.
  9335
  9336 3032-NOT-IN-DT-RANGE.
  9337     MOVE ER-0226                TO EMI-ERROR.
  9338     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9339     MOVE -1                     TO EFFDTL.
  9340     GO TO 8200-SEND-DATAONLY.
  9341
  9342 3033-ACCT-NOT-FOUND.
  9343     MOVE ER-0226 TO EMI-ERROR.
  9344     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9345     MOVE -1                     TO ACCOUNTL.
  9346     GO TO 8200-SEND-DATAONLY.
  9347
  9348 3034-CHECK-EMPLOYER-STATEMENT.
  9349
  9350     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9351*        NEXT SENTENCE
  9352         CONTINUE
  9353     ELSE
  9354         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9355     END-IF.
  9356
  9357     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9358     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9359     MOVE '1'                    TO  DC-OPTION-CODE.
  9360     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9361                                     DC-ELAPSED-DAYS.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 175
* EL130.cbl
  9362     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9363
  9364     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9365         DC-ELAPSED-DAYS LESS THAN +31)
  9366                      OR
  9367        (AM-EMPLOYER-STMT-USED = '2' AND
  9368         DC-ELAPSED-DAYS LESS THAN +61)
  9369                      OR
  9370        (AM-EMPLOYER-STMT-USED = '3' AND
  9371         DC-ELAPSED-DAYS LESS THAN +91)
  9372            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9373     END-IF.
  9374
  9375 3034-CHECK-ACCOUNT-LIMITS.
  9376
  9377     IF CERTMTI NOT = 'A'
  9378         GO TO 3060-BUILD-CONT
  9379     END-IF.
  9380
  9381     IF AM-STATUS NOT = '0'
  9382         MOVE ER-0225                TO EMI-ERROR
  9383         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9384         MOVE -1                     TO ACCOUNTL
  9385     END-IF.
  9386
  9387     IF EIBAID = DFHPF6
  9388         IF EMI-FATAL-CTR NOT = ZERO
  9389             MOVE ER-0434         TO EMI-ERROR
  9390             MOVE -1              TO MAINTL
  9391             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9392             GO TO 8200-SEND-DATAONLY
  9393         END-IF
  9394     END-IF.
  9395
  9396*    IF PI-COMPANY-ID NOT = 'CRI'
  9397*        GO TO 3035-END-BROWSE
  9398*    END-IF.
  9399
  9400 3035-END-BROWSE.
  9401
  9402
  9403* EXEC CICS ENDBR
  9404*        DATASET    (ERACCT2-DSID)
  9405*    END-EXEC.
  9406     MOVE 0
  9407       TO DFHEIV11
  9408*    MOVE '&2                    $   #00008922' TO DFHEIV0
  9409     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9411     MOVE X'2020233030303038393232' TO DFHEIV0(25:11)
  9412     CALL 'kxdfhei1' USING DFHEIV0,
  9413           ERACCT2-DSID,
  9414           DFHEIV11,
  9415           DFHEIV99
  9416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9417
  9418
  9419 3040-CHECK-CERT-ALREADY-ON.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 176
* EL130.cbl
  9420
  9421
  9422* EXEC CICS HANDLE CONDITION
  9423*        NOTFND   (3070-BUILD-CONT)
  9424*    END-EXEC.
  9425*    MOVE '"$I                   ! 1 #00008928' TO DFHEIV0
  9426     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9428     MOVE X'3120233030303038393238' TO DFHEIV0(25:11)
  9429     CALL 'kxdfhei1' USING DFHEIV0
  9430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9431
  9432
  9433     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9434
  9435     MOVE ER-0229                TO EMI-ERROR.
  9436     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9437     MOVE -1                     TO MAINTL.
  9438     GO TO 8200-SEND-DATAONLY.
  9439
  9440 3060-BUILD-CONT.
  9441     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9442     MOVE CRTCARRI               TO CERT-CARRIER.
  9443     MOVE GROUPI                 TO CERT-GROUPING.
  9444     MOVE STATEI                 TO CERT-STATE.
  9445     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9446     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9447     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9448     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9449
  9450
  9451
  9452* EXEC CICS HANDLE CONDITION
  9453*        NOTFND  (3065-CERT-NOT-FOUND)
  9454*    END-EXEC.
  9455*    MOVE '"$I                   ! 2 #00008950' TO DFHEIV0
  9456     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9458     MOVE X'3220233030303038393530' TO DFHEIV0(25:11)
  9459     CALL 'kxdfhei1' USING DFHEIV0
  9460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9461
  9462
  9463     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9464
  9465     GO TO 3070-BUILD-CONT.
  9466
  9467 3065-CERT-NOT-FOUND.
  9468     MOVE ER-0244                TO EMI-ERROR.
  9469     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9470     MOVE -1                     TO CERTNOL.
  9471     GO TO 8200-SEND-DATAONLY.
  9472
  9473 3070-BUILD-CONT.
  9474     IF CLMNOL NOT = ZERO
  9475         GO TO 3200-BUILD-ZERO-TRAILER
  9476     END-IF.
  9477
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 177
* EL130.cbl
  9478     MOVE SPACES                 TO ELCNTL-KEY.
  9479
  9480     IF CONTROL-IS-ACTUAL-CARRIER
  9481         MOVE PI-CARRIER         TO CNTL-CARRIER
  9482     ELSE
  9483         MOVE PI-CARRIER-CONTROL-LEVEL
  9484                                 TO CNTL-CARRIER
  9485     END-IF.
  9486
  9487     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9488     MOVE '6'                    TO CNTL-REC-TYPE.
  9489     MOVE +0                     TO CNTL-SEQ-NO.
  9490
  9491
  9492
  9493* EXEC CICS HANDLE CONDITION
  9494*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9495*    END-EXEC.
  9496*    MOVE '"$I                   ! 3 #00008983' TO DFHEIV0
  9497     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9498     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9499     MOVE X'3320233030303038393833' TO DFHEIV0(25:11)
  9500     CALL 'kxdfhei1' USING DFHEIV0
  9501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9502
  9503
  9504
  9505
  9506* EXEC CICS READ
  9507*        UPDATE
  9508*        DATASET   (ELCNTL-DSID)
  9509*        SET       (ADDRESS OF CONTROL-FILE)
  9510*        RIDFLD    (ELCNTL-KEY)
  9511*    END-EXEC.
  9512*    MOVE '&"S        EU         (   #00008988' TO DFHEIV0
  9513     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9514     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9515     MOVE X'2020233030303038393838' TO DFHEIV0(25:11)
  9516     CALL 'kxdfhei1' USING DFHEIV0,
  9517           ELCNTL-DSID,
  9518           DFHEIV20,
  9519           DFHEIV99,
  9520           ELCNTL-KEY,
  9521           DFHEIV99,
  9522           DFHEIV99,
  9523           DFHEIV99
  9524     SET ADDRESS OF CONTROL-FILE TO
  9525         DFHEIV20
  9526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9527
  9528
  9529     IF CLAIM-NO-MANUAL
  9530         GO TO 3120-CLAIM-MUST-BE-INPUT
  9531     END-IF.
  9532
  9533     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9534     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9535
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 178
* EL130.cbl
  9536     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9537         CONTINUE
  9538     ELSE
  9539         GO TO 3080-ASSIGN-LOOP
  9540     END-IF.
  9541
  9542
  9543
  9544* EXEC CICS UNLOCK
  9545*        DATASET   (ELCNTL-DSID)
  9546*    END-EXEC.
  9547*    MOVE '&*                    #   #00009009' TO DFHEIV0
  9548     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9549     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9550     MOVE X'2020233030303039303039' TO DFHEIV0(25:11)
  9551     CALL 'kxdfhei1' USING DFHEIV0,
  9552           ELCNTL-DSID,
  9553           DFHEIV99
  9554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9555
  9556
  9557     MOVE '1'                    TO CNTL-REC-TYPE.
  9558     MOVE SPACES                 TO CNTL-ACCESS.
  9559
  9560     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9561
  9562
  9563
  9564* EXEC CICS HANDLE CONDITION
  9565*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9566*    END-EXEC.
  9567*    MOVE '"$I                   ! 4 #00009019' TO DFHEIV0
  9568     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9570     MOVE X'3420233030303039303139' TO DFHEIV0(25:11)
  9571     CALL 'kxdfhei1' USING DFHEIV0
  9572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9573
  9574
  9575     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9576
  9577     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9578
  9579 3080-ASSIGN-LOOP.
  9580     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9581        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9582         MOVE +0                 TO SAVE-COUNTER
  9583     END-IF.
  9584
  9585     ADD +1 TO SAVE-COUNTER.
  9586
  9587     IF SAVE-METHOD  = '3'
  9588         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9589         GO TO 3090-SET-COMP
  9590     END-IF.
  9591
  9592     IF SAVE-METHOD  = '4'
  9593         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 179
* EL130.cbl
  9594         MOVE CLMCARRI           TO WS-CN-PRF-A
  9595         GO TO 3090-SET-COMP
  9596     END-IF.
  9597
  9598     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9599     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9600     MOVE SAVE-DATE              TO CURR-DATE.
  9601
  9602     IF CURR-MM LESS '10'
  9603         MOVE CURR-M2             TO WS-CN-PRF-B
  9604     END-IF.
  9605
  9606     IF CURR-MM = '10'
  9607        MOVE 'A'                 TO WS-CN-PRF-B
  9608     END-IF.
  9609     IF CURR-MM = '11'
  9610        MOVE 'B'                 TO WS-CN-PRF-B
  9611     END-IF.
  9612     IF CURR-MM = '12'
  9613        MOVE 'C'                 TO WS-CN-PRF-B
  9614     END-IF.
  9615
  9616     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9617
  9618 3090-SET-COMP.
  9619
  9620     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9621     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9622                                    CLMNOO.
  9623     MOVE AL-UANON               TO CLMNOA.
  9624     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9625     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9626     MOVE CLMCARRI               TO MSTR-CARRIER.
  9627
  9628
  9629
  9630* EXEC CICS HANDLE CONDITION
  9631*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9632*    END-EXEC.
  9633*    MOVE '"$I                   ! 5 #00009077' TO DFHEIV0
  9634     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9636     MOVE X'3520233030303039303737' TO DFHEIV0(25:11)
  9637     CALL 'kxdfhei1' USING DFHEIV0
  9638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9639
  9640
  9641     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9642
  9643     GO TO 3080-ASSIGN-LOOP.
  9644
  9645 3100-CARRIER-NOT-FOUND.
  9646     MOVE ER-0252                TO EMI-ERROR.
  9647     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9648     MOVE -1                     TO CLMCARRL.
  9649     GO TO 8200-SEND-DATAONLY.
  9650
  9651 3110-COMPANY-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 180
* EL130.cbl
  9652     MOVE ER-0254                TO EMI-ERROR.
  9653     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9654     MOVE -1                     TO MAINTL.
  9655     GO TO 8200-SEND-DATAONLY.
  9656
  9657 3120-CLAIM-MUST-BE-INPUT.
  9658     MOVE ER-0264                TO EMI-ERROR.
  9659     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9660     MOVE -1                     TO CLMNOL.
  9661     GO TO 8200-SEND-DATAONLY.
  9662
  9663 3200-BUILD-ZERO-TRAILER.
  9664
  9665
  9666* EXEC CICS HANDLE CONDITION
  9667*        NOTFND
  9668*    END-EXEC.
  9669*    MOVE '"$                   ! 6 #00009105' TO DFHEIV0
  9670     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9672     MOVE X'3620233030303039313035' TO DFHEIV0(25:11)
  9673     CALL 'kxdfhei1' USING DFHEIV0
  9674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9675
  9676
  9677
  9678
  9679* EXEC CICS GETMAIN
  9680*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9681*        LENGTH  (ELTRLR-LENGTH)
  9682*    END-EXEC.
  9683*    MOVE '," L                  $   #00009110' TO DFHEIV0
  9684     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9685     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9686     MOVE X'2020233030303039313130' TO DFHEIV0(25:11)
  9687     CALL 'kxdfhei1' USING DFHEIV0,
  9688           DFHEIV20,
  9689           ELTRLR-LENGTH,
  9690           DFHEIV99
  9691     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9692         DFHEIV20
  9693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9694
  9695
  9696     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9697     MOVE 'AT'                   TO AT-RECORD-ID.
  9698
  9699     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9700     MOVE CLMCARRI               TO AT-CARRIER.
  9701     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9702     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9703     MOVE +0                     TO AT-SEQUENCE-NO.
  9704     MOVE '1'                    TO AT-TRAILER-TYPE.
  9705
  9706     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9707     MOVE '5'                    TO DC-OPTION-CODE.
  9708     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9709     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 181
* EL130.cbl
  9710                                    AT-RESERVES-LAST-MAINT-DT.
  9711
  9712     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9713                                    AT-RESERVES-LAST-UPDATED-BY.
  9714
  9715     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9716
  9717     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9718
  9719     MOVE +0                     TO AT-FUTURE-RESERVE
  9720                                    AT-IBNR-RESERVE
  9721                                    AT-PAY-CURRENT-RESERVE
  9722                                    AT-INITIAL-MANUAL-RESERVE
  9723                                    AT-CURRENT-MANUAL-RESERVE
  9724                                    AT-ITD-LIFE-REFUNDS
  9725                                    AT-ITD-AH-REFUNDS
  9726                                    AT-ITD-ADDITIONAL-RESERVE.
  9727
  9728     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9729
  9730     IF MANRSVL NOT = ZERO
  9731         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9732                                    AT-CURRENT-MANUAL-RESERVE
  9733     END-IF.
  9734
  9735     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9736
  9737     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9738                                    AT-ITD-CHARGEABLE-EXPENSE.
  9739
  9740     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9741     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9742     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9743
  9744
  9745
  9746* EXEC CICS WRITE
  9747*        DATASET   (ELTRLR-DSID)
  9748*        FROM      (ACTIVITY-TRAILERS)
  9749*        RIDFLD    (AT-CONTROL-PRIMARY)
  9750*    END-EXEC.
  9751     MOVE LENGTH OF
  9752      ACTIVITY-TRAILERS
  9753       TO DFHEIV11
  9754*    MOVE '&$ L                  ''   #00009164' TO DFHEIV0
  9755     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9756     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9757     MOVE X'2020233030303039313634' TO DFHEIV0(25:11)
  9758     CALL 'kxdfhei1' USING DFHEIV0,
  9759           ELTRLR-DSID,
  9760           ACTIVITY-TRAILERS,
  9761           DFHEIV11,
  9762           AT-CONTROL-PRIMARY,
  9763           DFHEIV99,
  9764           DFHEIV99
  9765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9766
  9767
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 182
* EL130.cbl
  9768     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9769
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 183
* EL130.cbl
  9771
  9772 3250-BUILD-I1-ADDRESS-TRAILER.
  9773
  9774     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9775     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9776     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9777     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9778     MOVE GROUPI                 TO WS-MA-GROUPING.
  9779     MOVE STATEI                 TO WS-MA-STATE.
  9780     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9781     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9782     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9783     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9784
  9785
  9786* EXEC CICS HANDLE CONDITION
  9787*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9788*    END-EXEC.
  9789*    MOVE '"$I                   ! 7 #00009187' TO DFHEIV0
  9790     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9792     MOVE X'3720233030303039313837' TO DFHEIV0(25:11)
  9793     CALL 'kxdfhei1' USING DFHEIV0
  9794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9795
  9796
  9797
  9798* EXEC CICS READ
  9799*        EQUAL
  9800*        DATASET   (ERMAIL-DSID)
  9801*        SET       (ADDRESS OF MAILING-DATA)
  9802*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9803*    END-EXEC.
  9804*    MOVE '&"S        E          (   #00009191' TO DFHEIV0
  9805     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9807     MOVE X'2020233030303039313931' TO DFHEIV0(25:11)
  9808     CALL 'kxdfhei1' USING DFHEIV0,
  9809           ERMAIL-DSID,
  9810           DFHEIV20,
  9811           DFHEIV99,
  9812           WS-MA-CONTROL-PRIMARY,
  9813           DFHEIV99,
  9814           DFHEIV99,
  9815           DFHEIV99
  9816     SET ADDRESS OF MAILING-DATA TO
  9817         DFHEIV20
  9818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9819
  9820
  9821     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9822         GO TO 3290-NO-INSURED-ADDRESS
  9823     END-IF.
  9824
  9825     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9826     MOVE 'AT'                   TO AT-RECORD-ID.
  9827
  9828     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 184
* EL130.cbl
  9829     MOVE CLMCARRI               TO AT-CARRIER.
  9830     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9831     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9832     MOVE +1                     TO AT-SEQUENCE-NO.
  9833     MOVE '5'                    TO AT-TRAILER-TYPE.
  9834
  9835     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9836     IF MA-INSURED-MIDDLE-INIT > SPACES
  9837        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9838               ' ' DELIMITED BY SIZE
  9839               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9840               ' ' DELIMITED BY SIZE
  9841               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9842        INTO AT-MAIL-TO-NAME
  9843     ELSE
  9844        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9845               ' ' DELIMITED BY SIZE
  9846               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9847        INTO AT-MAIL-TO-NAME
  9848     END-IF.
  9849     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9850     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9851*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9852     MOVE MA-CITY                TO AT-CITY
  9853     MOVE MA-ADDR-STATE          TO AT-STATE
  9854     MOVE MA-ZIP                 TO AT-ZIP
  9855     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9856
  9857     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9858                                    AT-ADDRESS-LAST-MAINT-DT.
  9859
  9860     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9861                                    AT-ADDRESS-LAST-UPDATED-BY.
  9862
  9863     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9864
  9865
  9866* EXEC CICS WRITE
  9867*        DATASET   (ELTRLR-DSID)
  9868*        FROM      (ACTIVITY-TRAILERS)
  9869*        RIDFLD    (AT-CONTROL-PRIMARY)
  9870*    END-EXEC.
  9871     MOVE LENGTH OF
  9872      ACTIVITY-TRAILERS
  9873       TO DFHEIV11
  9874*    MOVE '&$ L                  ''   #00009242' TO DFHEIV0
  9875     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9876     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9877     MOVE X'2020233030303039323432' TO DFHEIV0(25:11)
  9878     CALL 'kxdfhei1' USING DFHEIV0,
  9879           ELTRLR-DSID,
  9880           ACTIVITY-TRAILERS,
  9881           DFHEIV11,
  9882           AT-CONTROL-PRIMARY,
  9883           DFHEIV99,
  9884           DFHEIV99
  9885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9886
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 185
* EL130.cbl
  9887
  9888     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9889     GO TO 3300-BUILD-NINETY-TRAILER.
  9890
  9891 3290-NO-INSURED-ADDRESS.
  9892      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9893
  9894 3300-BUILD-NINETY-TRAILER.
  9895
  9896     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9897     MOVE 'AT'                   TO AT-RECORD-ID.
  9898
  9899     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9900     MOVE CLMCARRI               TO AT-CARRIER.
  9901
  9902     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9903     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9904     MOVE +90                    TO AT-SEQUENCE-NO.
  9905     MOVE '6'                    TO AT-TRAILER-TYPE.
  9906
  9907     IF DIAGL NOT = ZERO
  9908         MOVE DIAGI              TO AT-INFO-LINE-1
  9909     END-IF.
  9910
  9911     IF ICD1L NOT = ZERO
  9912         MOVE ICD1I              TO AT-ICD-CODE-1
  9913     END-IF.
  9914
  9915     IF ICD2L NOT = ZERO
  9916         MOVE ICD2I              TO AT-ICD-CODE-2
  9917     END-IF.
  9918
  9919     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9920                                    AT-GEN-INFO-LAST-MAINT-DT.
  9921
  9922     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9923                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9924     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9925
  9926
  9927
  9928* EXEC CICS WRITE
  9929*        DATASET   (ELTRLR-DSID)
  9930*        FROM      (ACTIVITY-TRAILERS)
  9931*        RIDFLD    (AT-CONTROL-PRIMARY)
  9932*    END-EXEC.
  9933     MOVE LENGTH OF
  9934      ACTIVITY-TRAILERS
  9935       TO DFHEIV11
  9936*    MOVE '&$ L                  ''   #00009287' TO DFHEIV0
  9937     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9938     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9939     MOVE X'2020233030303039323837' TO DFHEIV0(25:11)
  9940     CALL 'kxdfhei1' USING DFHEIV0,
  9941           ELTRLR-DSID,
  9942           ACTIVITY-TRAILERS,
  9943           DFHEIV11,
  9944           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 186
* EL130.cbl
  9945           DFHEIV99,
  9946           DFHEIV99
  9947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9948
  9949
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 187
* EL130.cbl
  9951 3400-CHECK-CERT-MAINT.
  9952
  9953     IF CERTMTI = 'A'
  9954         GO TO 3600-BUILD-NEW-CERT
  9955     END-IF.
  9956
  9957     IF NO-CLAIM-ATTACHED
  9958         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9959     END-IF.
  9960
  9961     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9962
  9963     IF CM-LF-CURRENT-STATUS = '2' OR
  9964        CM-AH-CURRENT-STATUS = '2'
  9965         GO TO 3400-REWRITE-CERT
  9966     END-IF.
  9967
  9968     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9969
  9970 3400-REWRITE-CERT.
  9971
  9972
  9973
  9974* EXEC CICS HANDLE CONDITION
  9975*        DUPKEY (3410-DUP-KEY)
  9976*    END-EXEC.
  9977*    MOVE '"$$                   ! 8 #00009316' TO DFHEIV0
  9978     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9979     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9980     MOVE X'3820233030303039333136' TO DFHEIV0(25:11)
  9981     CALL 'kxdfhei1' USING DFHEIV0
  9982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9983
  9984
  9985
  9986
  9987* EXEC CICS REWRITE
  9988*        DATASET   (ELCERT-DSID)
  9989*        FROM      (CERTIFICATE-MASTER)
  9990*    END-EXEC.
  9991     MOVE LENGTH OF
  9992      CERTIFICATE-MASTER
  9993       TO DFHEIV11
  9994*    MOVE '&& L                  %   #00009321' TO DFHEIV0
  9995     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9996     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9997     MOVE X'2020233030303039333231' TO DFHEIV0(25:11)
  9998     CALL 'kxdfhei1' USING DFHEIV0,
  9999           ELCERT-DSID,
 10000           CERTIFICATE-MASTER,
 10001           DFHEIV11,
 10002           DFHEIV99
 10003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10004
 10005
 10006 3410-DUP-KEY.
 10007     GO TO 3800-BUILD-NEW-CLAIM.
 10008
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 188
* EL130.cbl
 10009 3600-BUILD-NEW-CERT.
 10010
 10011
 10012* EXEC CICS GETMAIN
 10013*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 10014*        LENGTH   (ELCERT-LENGTH)
 10015*    END-EXEC.
 10016*    MOVE '," L                  $   #00009331' TO DFHEIV0
 10017     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10018     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10019     MOVE X'2020233030303039333331' TO DFHEIV0(25:11)
 10020     CALL 'kxdfhei1' USING DFHEIV0,
 10021           DFHEIV20,
 10022           ELCERT-LENGTH,
 10023           DFHEIV99
 10024     SET ADDRESS OF CERTIFICATE-MASTER TO
 10025         DFHEIV20
 10026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10027
 10028
 10029     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10030
 10031     MOVE 'CM'                   TO CM-RECORD-ID.
 10032
 10033     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10034                                    CM-COMPANY-CD-A1
 10035                                    CM-COMPANY-CD-A2
 10036                                    CM-COMPANY-CD-A4
 10037                                    CM-COMPANY-CD-A5.
 10038
 10039     MOVE CERT-CARRIER           TO CM-CARRIER.
 10040     MOVE CERT-GROUPING          TO CM-GROUPING.
 10041     MOVE CERT-STATE             TO CM-STATE.
 10042     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10043     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10044     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10045
 10046     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10047                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10048                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10049                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10050                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10051                       CM-LIVES              CM-LOAN-TERM
 10052                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10053                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10054                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10055                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10056                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10057                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10058                       CM-LF-ALT-PREMIUM-RATE
 10059                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10060                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10061                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10062                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10063                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10064
 10065     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10066                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 189
* EL130.cbl
 10067                                    CM-AH-SETTLEMENT-DT
 10068                                    CM-AH-CANCEL-EXIT-DT
 10069                                    CM-AH-SETTLEMENT-EXIT-DT
 10070                                    CM-LF-LOAN-EXPIRE-DT
 10071                                    CM-LF-CANCEL-DT
 10072                                    CM-LF-DEATH-DT
 10073                                    CM-LF-CANCEL-EXIT-DT
 10074                                    CM-LF-DEATH-EXIT-DT
 10075                                    CM-LAST-ADD-ON-DT
 10076                                    CM-ENTRY-DT.
 10077
 10078     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10079     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10080     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10081
 10082     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10083                                    CM-PART-LAST-NAME-A2
 10084                                    CM-PART-LAST-NAME-A5.
 10085
 10086     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10087                                    CM-INSURED-INITIAL1-A2
 10088                                    CM-INSURED-INITIAL1-A5
 10089                                    CM-INSURED-FIRST-NAME.
 10090
 10091     IF CRTINITL GREATER ZERO
 10092         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10093                                    CM-INSURED-INITIAL2-A2
 10094                                    CM-INSURED-INITIAL2-A5
 10095     ELSE
 10096         MOVE SPACES             TO CM-INSURED-INITIAL2
 10097                                    CM-INSURED-INITIAL2-A2
 10098                                    CM-INSURED-INITIAL2-A5
 10099     END-IF.
 10100
 10101     IF CM-INSURED-INITIALS = SPACES
 10102         MOVE '**'               TO CM-INSURED-INITIALS
 10103     END-IF.
 10104
 10105     IF MEMBERL GREATER ZERO
 10106         MOVE MEMBERI              TO CM-MEMBER-NO
 10107     ELSE
 10108         MOVE CERT-STATE           TO CM-MEMB-STATE
 10109         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10110         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10111         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10112     END-IF.
 10113
 10114     IF JNTLNMEL GREATER ZERO
 10115         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10116     END-IF.
 10117
 10118     IF JNTFNMEL GREATER ZERO
 10119         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10120     END-IF.
 10121
 10122     IF JNTINITL GREATER ZERO
 10123         MOVE JNTINITI           TO CM-JT-INITIAL
 10124     END-IF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 190
* EL130.cbl
 10125
 10126     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10127
 10128
 10129
 10130* EXEC CICS HANDLE CONDITION
 10131*        DUPKEY   (3690-CERT-WRITTEN)
 10132*    END-EXEC.
 10133*    MOVE '"$$                   ! 9 #00009436' TO DFHEIV0
 10134     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10135     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10136     MOVE X'3920233030303039343336' TO DFHEIV0(25:11)
 10137     CALL 'kxdfhei1' USING DFHEIV0
 10138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10139
 10140
 10141
 10142
 10143* EXEC CICS WRITE
 10144*        DATASET   (ELCERT-DSID)
 10145*        FROM      (CERTIFICATE-MASTER)
 10146*        RIDFLD    (CM-CONTROL-PRIMARY)
 10147*    END-EXEC.
 10148     MOVE LENGTH OF
 10149      CERTIFICATE-MASTER
 10150       TO DFHEIV11
 10151*    MOVE '&$ L                  ''   #00009441' TO DFHEIV0
 10152     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10153     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10154     MOVE X'2020233030303039343431' TO DFHEIV0(25:11)
 10155     CALL 'kxdfhei1' USING DFHEIV0,
 10156           ELCERT-DSID,
 10157           CERTIFICATE-MASTER,
 10158           DFHEIV11,
 10159           CM-CONTROL-PRIMARY,
 10160           DFHEIV99,
 10161           DFHEIV99
 10162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10163
 10164
 10165 3690-CERT-WRITTEN.
 10166
 10167     GO TO 3800-BUILD-NEW-CLAIM.
 10168
 10169 3690-EXIT.
 10170      EXIT.
 10171
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 191
* EL130.cbl
 10173 3700-BUILD-CERT.
 10174
 10175     IF CERTMTI NOT = 'A'
 10176         GO TO 3700-FINISH-CERT-BUILD
 10177     END-IF.
 10178
 10179     IF CERTMTI = 'A'
 10180         IF LCVCDL = ZEROS
 10181             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10182                                    CM-LF-ORIG-TERM
 10183                                    CM-LF-BENEFIT-AMT
 10184                                    CM-LF-PREMIUM-RATE
 10185             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10186         END-IF
 10187     END-IF.
 10188
 10189     IF LCVCDL GREATER ZERO
 10190         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10191     END-IF.
 10192
 10193     IF LCVOTRML GREATER ZERO
 10194         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10195     END-IF.
 10196
 10197     IF LCVBENEL GREATER ZERO
 10198         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10199     END-IF.
 10200
 10201     IF LCVRATEL GREATER ZERO
 10202         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10203     END-IF.
 10204
 10205     IF WS-EXPIRE NOT = LOW-VALUES
 10206         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10207     END-IF.
 10208
 10209     IF LCVFORML GREATER ZERO
 10210         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10211     END-IF.
 10212
 10213     IF LCVCNDTL = ZERO
 10214        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10215     END-IF.
 10216
 10217     IF WS-LCVCNDT NOT = LOW-VALUES
 10218        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10219        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10220        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10221     END-IF.
 10222
 10223     IF CM-LF-CURRENT-STATUS = '7'
 10224        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10225        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10226        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10227                                    CM-LF-DEATH-DT
 10228        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10229     END-IF.
 10230
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 192
* EL130.cbl
 10231     IF CM-LF-CURRENT-STATUS = '8'
 10232        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10233        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10234     END-IF.
 10235
 10236 3700-BUILD-AH-COVERAGE-SIDE.
 10237
 10238     IF CERTMTI = 'A'
 10239         IF ACVCDL = ZEROS
 10240             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10241                                    CM-AH-ORIG-TERM
 10242                                    CM-AH-BENEFIT-AMT
 10243                                    CM-AH-PREMIUM-RATE
 10244             GO TO 3700-COVERAGE-BUILT
 10245         END-IF
 10246     END-IF.
 10247
 10248     IF ACVCDL GREATER ZERO
 10249         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10250     END-IF.
 10251
 10252     IF ACVOTRML GREATER ZERO
 10253         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10254     END-IF.
 10255
 10256     IF ACVBENEL GREATER ZERO
 10257         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10258     END-IF.
 10259
 10260     IF ACVRATEL GREATER ZERO
 10261         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10262     END-IF.
 10263
 10264     IF WS-EXPIRE NOT = LOW-VALUES
 10265         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10266     END-IF.
 10267
 10268     IF ACVFORML GREATER ZERO
 10269         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10270     END-IF.
 10271
 10272     IF ACVCNDTL = ZERO
 10273        GO TO 3700-COVERAGE-BUILT
 10274     END-IF.
 10275
 10276     IF WS-ACVCNDT NOT = LOW-VALUES
 10277        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10278        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10279        GO TO 3700-COVERAGE-BUILT
 10280     END-IF.
 10281
 10282     IF CM-AH-CURRENT-STATUS = '6'
 10283        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10284        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10285        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10286        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10287        GO TO 3700-COVERAGE-BUILT
 10288     END-IF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 193
* EL130.cbl
 10289
 10290     IF CM-AH-CURRENT-STATUS = '8'
 10291        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10292        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10293     END-IF.
 10294
 10295 3700-COVERAGE-BUILT.
 10296     IF ISSAGEL GREATER ZERO
 10297         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10298     END-IF.
 10299
 10300     IF JNTAGEL GREATER ZERO
 10301         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10302     END-IF.
 10303
 10304     IF SEXL GREATER ZERO
 10305         MOVE SEXI               TO CM-INSURED-SEX
 10306     END-IF.
 10307
 10308     IF APRL GREATER ZERO
 10309         MOVE WS-APR             TO CM-LOAN-APR
 10310     END-IF.
 10311
 10312     IF PMTFREQL GREATER ZERO
 10313         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10314     END-IF.
 10315
 10316     IF INDGRPL GREATER ZERO
 10317         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10318     END-IF.
 10319
 10320     IF CERTMTI = 'A'
 10321         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10322     END-IF.
 10323
 10324     IF REINCDL GREATER ZERO
 10325         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10326                                    WS-REIN-1
 10327                                    WS-REIN-2
 10328                                    WS-REIN-3
 10329         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10330     END-IF.
 10331
 10332     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10333         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10334     END-IF.
 10335
 10336     IF CRTSSNL GREATER ZERO
 10337         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10338     ELSE
 10339         IF SSNL GREATER ZERO
 10340             MOVE SSNI           TO CM-SOC-SEC-NO
 10341         END-IF
 10342     END-IF.
 10343
 10344     IF CRTSSNL = ZERO AND
 10345        SSNL    = ZERO
 10346         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 194
* EL130.cbl
 10347         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10348         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10349         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10350     END-IF.
 10351
 10352     IF CM-LF-CURRENT-STATUS = SPACES
 10353         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10354     END-IF.
 10355
 10356     IF CM-AH-CURRENT-STATUS = SPACES
 10357         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10358     END-IF.
 10359
 10360     IF CERTMTI = 'A'
 10361         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10362     END-IF.
 10363
 10364 3700-FINISH-CERT-BUILD.
 10365
 10366     IF LOANNOL GREATER ZERO
 10367         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10368     END-IF.
 10369
 10370     IF LOANBALL GREATER ZERO
 10371         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10372     END-IF.
 10373
 10374     IF PREMTYPL GREATER ZERO
 10375         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10376     END-IF.
 10377
 10378 3700-EXIT.
 10379      EXIT.
 10380
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 195
* EL130.cbl
 10382 3800-BUILD-NEW-CLAIM.
 10383
 10384*************************************************************
 10385*****           START OF ACTIVITY FILE PROCESSING          **
 10386*************************************************************
 10387     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10388         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10389                 6700-EXIT
 10390     END-IF.
 10391*************************************************************
 10392*****            END OF ACTIVITY FILE PROCESSING           **
 10393*************************************************************
 10394
 10395
 10396
 10397
 10398* EXEC CICS GETMAIN
 10399*        SET     (ADDRESS OF CLAIM-MASTER)
 10400*        LENGTH  (ELMSTR-LENGTH)
 10401*    END-EXEC.
 10402*    MOVE '," L                  $   #00009679' TO DFHEIV0
 10403     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10404     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10405     MOVE X'2020233030303039363739' TO DFHEIV0(25:11)
 10406     CALL 'kxdfhei1' USING DFHEIV0,
 10407           DFHEIV20,
 10408           ELMSTR-LENGTH,
 10409           DFHEIV99
 10410     SET ADDRESS OF CLAIM-MASTER TO
 10411         DFHEIV20
 10412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10413
 10414
 10415     MOVE SPACES TO CLAIM-MASTER.
 10416
 10417     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10418         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10419         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10420         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10421         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10422         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10423         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10424         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10425
 10426     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10427             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10428             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10429             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10430             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10431             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10432             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10433             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10434             CL-FORCEABLE-ERROR-CNT.
 10435
 10436     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10437
 10438     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10439                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 196
* EL130.cbl
 10440                                    CL-LAG-REPORT-CODE
 10441                                    CL-CRITICAL-PERIOD
 10442*                                   CL-CRIT-PER-RTW-MOS
 10443     move 01                     to cl-benefit-period
 10444
 10445     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10446     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10447
 10448     IF BENECDL NOT = ZEROS
 10449        MOVE BENECDI             TO CL-BENEFICIARY
 10450     END-IF.
 10451
 10452     MOVE 'CL'                   TO CL-RECORD-ID.
 10453     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10454
 10455     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10456                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10457                             CL-COMPANY-CD-A5.
 10458
 10459     MOVE CLMCARRI               TO CL-CARRIER.
 10460
 10461     IF CLMNOL = ZERO
 10462         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10463     ELSE
 10464         MOVE CLMNOI             TO CL-CLAIM-NO
 10465     END-IF.
 10466
 10467     MOVE CERTNOI                TO CL-CERT-PRIME
 10468                                    CL-CERT-A4-PRIME.
 10469
 10470     MOVE SUFXI                  TO CL-CERT-SFX
 10471                                    CL-CERT-A4-SFX.
 10472
 10473     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10474
 10475     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10476
 10477     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10478
 10479     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10480
 10481     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10482     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10483
 10484     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10485
 10486     IF CERTMTI = 'A'
 10487         MOVE '2'                TO CL-CERT-ORIGIN
 10488     ELSE
 10489         MOVE '1'                TO CL-CERT-ORIGIN
 10490     END-IF.
 10491
 10492     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10493     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10494     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10495     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10496     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10497
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 197
* EL130.cbl
 10498 3820-REWRITE-CONTROL-FILE.
 10499
 10500     IF CLMNOL GREATER ZERO
 10501         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10502     END-IF.
 10503
 10504     IF CF-RECORD-TYPE = '6'
 10505         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10506     ELSE
 10507         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10508     END-IF.
 10509
 10510
 10511
 10512* EXEC CICS REWRITE
 10513*        DATASET   (ELCNTL-DSID)
 10514*        FROM      (CONTROL-FILE)
 10515*    END-EXEC.
 10516     MOVE LENGTH OF
 10517      CONTROL-FILE
 10518       TO DFHEIV11
 10519*    MOVE '&& L                  %   #00009780' TO DFHEIV0
 10520     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10521     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10522     MOVE X'2020233030303039373830' TO DFHEIV0(25:11)
 10523     CALL 'kxdfhei1' USING DFHEIV0,
 10524           ELCNTL-DSID,
 10525           CONTROL-FILE,
 10526           DFHEIV11,
 10527           DFHEIV99
 10528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10529
 10530
 10531 3830-SEQUENCE-CLAIM-RECORDS.
 10532
 10533     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10534     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10535     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10536
 10537     IF WS-ASSOC-CERT-TOTAL = ZERO
 10538         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10539                                    CL-ASSOC-CERT-TOTAL
 10540         GO TO 3840-WRITE-CLAIM-MASTER
 10541     END-IF.
 10542
 10543     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10544         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10545     ELSE
 10546         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10547     END-IF.
 10548
 10549     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10550     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10551     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10552
 10553 3840-WRITE-CLAIM-MASTER.
 10554
 10555     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 198
* EL130.cbl
 10556     IF WS-REC-FOUND-SW = 'Y'
 10557         MOVE 01                 TO  CL-ACTIVITY-CODE
 10558         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10559         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10560     END-IF.
 10561
 10562
 10563
 10564* EXEC CICS HANDLE CONDITION
 10565*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10566*    END-EXEC.
 10567*    MOVE '"$$                   ! : #00009817' TO DFHEIV0
 10568     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10570     MOVE X'3A20233030303039383137' TO DFHEIV0(25:11)
 10571     CALL 'kxdfhei1' USING DFHEIV0
 10572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10573
 10574
 10575** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10576     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10577
 10578
 10579*    DISPLAY ' ABOUT TO WRITE ELMSTR '
 10580*    DISPLAY ' KEY ' CL-CARRIER ' ' CL-CLAIM-NO ' '
 10581*       CL-CERT-NO
 10582*    IF CL-COMPANY-CD = X'04'
 10583*       DISPLAY ' CID COMP CD '
 10584*    ELSE
 10585*       IF CL-COMPANY-CD = X'05'
 10586*          DISPLAY ' DCC COMP CD '
 10587*       ELSE
 10588*          DISPLAY ' UNKNOWN COMP CD '
 10589*       END-IF
 10590*    END-IF
 10591
 10592* EXEC CICS WRITE
 10593*        DATASET   (ELMSTR-DSID)
 10594*        FROM      (CLAIM-MASTER)
 10595*        RIDFLD    (CL-CONTROL-PRIMARY)
 10596*    END-EXEC.
 10597     MOVE LENGTH OF
 10598      CLAIM-MASTER
 10599       TO DFHEIV11
 10600*    MOVE '&$ L                  ''   #00009837' TO DFHEIV0
 10601     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10602     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10603     MOVE X'2020233030303039383337' TO DFHEIV0(25:11)
 10604     CALL 'kxdfhei1' USING DFHEIV0,
 10605           ELMSTR-DSID,
 10606           CLAIM-MASTER,
 10607           DFHEIV11,
 10608           CL-CONTROL-PRIMARY,
 10609           DFHEIV99,
 10610           DFHEIV99
 10611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10612
 10613
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 199
* EL130.cbl
 10614 3850-CLAIM-MSTR-WRITTEN.
 10615
 10616     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10617         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10618     END-IF.
 10619
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 200
* EL130.cbl
 10621 3990-ADD-DONE.
 10622*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10623*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10624*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10625*                                  EMI-ERROR-LINES.
 10626
 10627     IF CLMNOL = ZERO
 10628         move spaces             to emi-claim-no
 10629         MOVE ER-0265            TO EMI-ERROR
 10630         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10631         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10632                                    PI-LAST-CLAIM
 10633     ELSE
 10634         MOVE CLMNOI             TO PI-LAST-CLAIM
 10635                                    MSTR-CLAIM-NO
 10636         MOVE ER-0000            TO EMI-ERROR
 10637         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10638     END-IF.
 10639
 10640     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10641       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10642         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10643         MOVE ER-7575            TO EMI-ERROR
 10644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10645     END-IF.
 10646
 10647     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 10648       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10649         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10650         MOVE ER-7582            TO EMI-ERROR
 10651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10652     END-IF.
 10653
 10654     IF WS-NO-INSURED-ADDRESS = 'Y'
 10655         MOVE ER-3548            TO EMI-ERROR
 10656         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10657     END-IF.
 10658
 10659     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10660       (PI-ST-CAUSAL-STATE = 'L' AND
 10661              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10662       (PI-ST-CAUSAL-STATE = 'A' AND
 10663              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10664         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10665         MOVE ER-7577            TO EMI-ERROR
 10666         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10667     END-IF.
 10668     if pi-company-id = 'DCC'
 10669        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10670                                 THRU 3994C-EXIT
 10671     end-if
 10672     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10673     MOVE CLMCARRI                   TO  PI-CARRIER.
 10674     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10675     MOVE SUFXI                      TO  PI-CERT-SFX.
 10676
 10677     IF WS-LETTER-SW = 'Y'
 10678         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 201
* EL130.cbl
 10679         IF W-1523-ERROR-CODE NOT = ZEROS
 10680             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10681             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10682         END-IF
 10683     END-IF.
 10684
 10685     perform 3998-update-cert-claim-trailer
 10686                                 thru 3998-exit
 10687     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10688     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10689     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10690     MOVE CLMCARRI               TO PI-LAST-CARR.
 10691
 10692     IF PRTOPTL GREATER THAN 0
 10693         MOVE PRTOPTI            TO PI-PRT-OPT
 10694     END-IF.
 10695     IF ALTPRTL GREATER THAN 0
 10696         MOVE ALTPRTI            TO PI-ALT-PRT
 10697     END-IF.
 10698
 10699     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10700         MOVE LOW-VALUES         TO EL130AI
 10701         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10702         MOVE AL-SANON           TO CERTNOA
 10703         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10704         MOVE AL-SANON           TO SUFXA
 10705         MOVE PI-LAST-CARR       TO CLMCARRO
 10706         MOVE AL-UANON           TO CLMCARRA
 10707         MOVE PI-LAST-CLAIM      TO CLMNOO
 10708         MOVE AL-UANON           TO CLMNOA
 10709         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10710         MOVE AL-UANON           TO CLMTYPEA
 10711     ELSE
 10712         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10713         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10714     END-IF.
 10715
 10716     IF PI-PRT-OPT = 'N' OR 'L'
 10717         MOVE PI-PRT-OPT         TO PRTOPTO
 10718         MOVE 1                  TO PRTOPTL
 10719     END-IF.
 10720
 10721     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10722         MOVE PI-ALT-PRT         TO ALTPRTO
 10723         MOVE 4                  TO ALTPRTL
 10724     END-IF.
 10725
 10726     IF PRTOPTL GREATER THAN 0
 10727         IF PRTOPTI = 'L'
 10728             GO TO 0400-CREATE-ELACTQ
 10729         ELSE
 10730             GO TO 0480-PRINT-NOW
 10731         END-IF
 10732     END-IF.
 10733     move 'S'                    to mainti
 10734     PERFORM 0500-CREATE-TEMP-STORAGE
 10735                                 THRU 0599-EXIT
 10736     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 202
* EL130.cbl
 10737         GO TO 8100-SEND-INITIAL-MAP
 10738     ELSE
 10739         MOVE LOW-VALUES         TO MAINTO
 10740         MOVE -1                 TO MAINTL
 10741         GO TO 8200-SEND-DATAONLY
 10742     END-IF.
 10743
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 203
* EL130.cbl
 10745 3993-MODIFY-SCREEN-ATTRB.
 10746
 10747     IF CERTMTL GREATER ZERO
 10748         MOVE AL-UANON           TO CERTMTA
 10749     END-IF.
 10750
 10751     IF EFFDTL GREATER ZERO
 10752         MOVE AL-UANON           TO EFFDTA
 10753     END-IF.
 10754
 10755     IF ACCOUNTL GREATER ZERO
 10756         MOVE AL-UANON           TO ACCOUNTA
 10757     END-IF.
 10758
 10759     IF STATEL GREATER ZERO
 10760         MOVE AL-UANON           TO STATEA
 10761     END-IF.
 10762
 10763     IF CRTCARRL GREATER ZERO
 10764         MOVE AL-UANON           TO CRTCARRA
 10765     END-IF.
 10766
 10767     IF GROUPL GREATER ZERO
 10768         MOVE AL-UANON           TO GROUPA
 10769     END-IF.
 10770
 10771     IF CRTLNMEL GREATER ZERO
 10772         MOVE AL-UANON           TO CRTLNMEA
 10773     END-IF.
 10774
 10775     IF CRTFNMEL GREATER ZERO
 10776         MOVE AL-UANON           TO CRTFNMEA
 10777     END-IF.
 10778
 10779     IF CRTINITL GREATER ZERO
 10780         MOVE AL-UANON           TO CRTINITA
 10781     END-IF.
 10782
 10783     IF ISSAGEL GREATER ZERO
 10784         MOVE AL-UNNON           TO ISSAGEA
 10785     END-IF.
 10786
 10787     IF JNTLNMEL GREATER ZERO
 10788         MOVE AL-UANON           TO JNTLNMEA
 10789     END-IF.
 10790
 10791     IF JNTFNMEL GREATER ZERO
 10792         MOVE AL-UANON           TO JNTFNMEA
 10793     END-IF.
 10794
 10795     IF JNTINITL GREATER ZERO
 10796         MOVE AL-UANON           TO JNTINITA
 10797     END-IF.
 10798
 10799     IF JNTAGEL GREATER ZERO
 10800         MOVE AL-UNNON           TO JNTAGEA
 10801     END-IF.
 10802
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 204
* EL130.cbl
 10803     IF CRTSSNL GREATER ZERO
 10804         MOVE AL-UANON           TO CRTSSNA
 10805     END-IF.
 10806
 10807     IF ACVDSCRL GREATER ZERO
 10808         MOVE AL-SANON           TO ACVDSCRA
 10809     END-IF.
 10810
 10811     IF ACVKINDL GREATER ZERO
 10812         MOVE AL-SANON           TO ACVKINDA
 10813     END-IF.
 10814
 10815     IF ACVCDL GREATER ZERO
 10816         MOVE AL-UANON           TO ACVCDA
 10817     END-IF.
 10818
 10819     IF ACVOTRML GREATER ZERO
 10820         MOVE AL-UNNON           TO ACVOTRMA
 10821     END-IF.
 10822
 10823     IF ACVRTRML GREATER ZERO
 10824         MOVE AL-UNNON           TO ACVRTRMA
 10825     END-IF.
 10826
 10827     IF ACVRATEL GREATER ZERO
 10828         MOVE AL-UNNON           TO ACVRATEA
 10829     END-IF.
 10830
 10831     IF ACVBENEL GREATER ZERO
 10832         MOVE AL-UNNON           TO ACVBENEA
 10833     END-IF.
 10834
 10835     IF ACVFORML GREATER ZERO
 10836         MOVE AL-UANON           TO ACVFORMA
 10837     END-IF.
 10838
 10839     IF ACVCNDTL GREATER ZERO
 10840         MOVE AL-UANON           TO ACVCNDTA
 10841     END-IF.
 10842
 10843     IF ACVEXITL GREATER ZERO
 10844         MOVE AL-UANON           TO ACVEXITA
 10845     END-IF.
 10846
 10847     IF ACVSTATL GREATER ZERO
 10848         MOVE AL-UANON           TO ACVSTATA
 10849     END-IF.
 10850
 10851     IF LCVDSCRL GREATER ZERO
 10852         MOVE AL-SANON           TO LCVDSCRA
 10853     END-IF.
 10854
 10855     IF LCVKINDL GREATER ZERO
 10856         MOVE AL-SANON           TO LCVKINDA
 10857     END-IF.
 10858
 10859     IF LCVCDL GREATER ZERO
 10860         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 205
* EL130.cbl
 10861     END-IF.
 10862
 10863     IF LCVOTRML GREATER ZERO
 10864         MOVE AL-UNNON           TO LCVOTRMA
 10865     END-IF.
 10866
 10867     IF LCVRTRML GREATER ZERO
 10868         MOVE AL-UNNON           TO LCVRTRMA
 10869     END-IF.
 10870
 10871     IF LCVRATEL GREATER ZERO
 10872         MOVE AL-UNNON           TO LCVRATEA
 10873     END-IF.
 10874
 10875     IF LCVBENEL GREATER ZERO
 10876         MOVE AL-UNNON           TO LCVBENEA
 10877     END-IF.
 10878
 10879     IF LCVFORML GREATER ZERO
 10880         MOVE AL-UANON           TO LCVFORMA
 10881     END-IF.
 10882
 10883     IF LCVCNDTL GREATER ZERO
 10884         MOVE AL-UANON           TO LCVCNDTA
 10885     END-IF.
 10886
 10887     IF LCVEXITL GREATER ZERO
 10888         MOVE AL-UANON           TO LCVEXITA
 10889     END-IF.
 10890
 10891     IF LCVSTATL GREATER ZERO
 10892         MOVE AL-UANON           TO LCVSTATA
 10893     END-IF.
 10894
 10895     IF MEMCAPL GREATER ZERO
 10896         MOVE AL-UANON           TO MEMCAPA
 10897     END-IF.
 10898
 10899     IF APRL GREATER ZERO
 10900         MOVE AL-UNNON           TO APRA
 10901     END-IF.
 10902
 10903     IF PMTFREQL GREATER ZERO
 10904         MOVE AL-UNNON           TO PMTFREQA
 10905     END-IF.
 10906
 10907     IF INDGRPL GREATER ZERO
 10908         MOVE AL-UANON           TO INDGRPA
 10909     END-IF.
 10910
 10911     IF PREMTYPL GREATER ZERO
 10912         MOVE AL-UANON           TO PREMTYPA
 10913     END-IF.
 10914
 10915     IF REINCDL GREATER ZERO
 10916         MOVE AL-UANON           TO REINCDA
 10917     END-IF.
 10918
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 206
* EL130.cbl
 10919     IF ADDONDTL GREATER ZERO
 10920         MOVE AL-UANON           TO ADDONDTA
 10921     END-IF.
 10922
 10923     IF MEMBERL GREATER ZERO
 10924         MOVE AL-UANON           TO MEMBERA
 10925     END-IF.
 10926
 10927     IF BCERT1L GREATER ZERO
 10928         MOVE AL-SANON           TO BCERT1A
 10929                                    BSUFX1A
 10930     END-IF.
 10931
 10932     IF BCERT2L GREATER ZERO
 10933         MOVE AL-SANON           TO BCERT2A
 10934                                    BSUFX2A
 10935     END-IF.
 10936
 10937     IF BCERT3L GREATER ZERO
 10938         MOVE AL-SANON           TO BCERT3A
 10939                                    BSUFX3A
 10940     END-IF.
 10941
 10942     IF BCERT4L GREATER ZERO
 10943         MOVE AL-SANON           TO BCERT4A
 10944                                    BSUFX4A
 10945     END-IF.
 10946
 10947     IF BCERT5L GREATER ZERO
 10948         MOVE AL-SANON           TO BCERT5A
 10949                                    BSUFX5A
 10950     END-IF.
 10951
 10952 3993-MODIFY-CLAIM-ATTRB.
 10953
 10954     IF PCERTNOL GREATER ZERO
 10955         MOVE AL-UANON           TO PCERTNOA
 10956     END-IF.
 10957
 10958     IF PSUFXL GREATER ZERO
 10959         MOVE AL-UANON           TO PSUFXA
 10960     END-IF.
 10961
 10962     IF LSTNMEL GREATER ZERO
 10963         MOVE AL-UANON           TO LSTNMEA
 10964     END-IF.
 10965
 10966     IF FSTNMEL GREATER ZERO
 10967         MOVE AL-UANON           TO FSTNMEA
 10968     END-IF.
 10969
 10970     IF INITL GREATER ZERO
 10971         MOVE AL-UANON           TO INITA
 10972     END-IF.
 10973
 10974     IF SEXL GREATER ZERO
 10975         MOVE AL-UANON           TO SEXA
 10976     END-IF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 207
* EL130.cbl
 10977
 10978     IF BIRTHDTL GREATER ZERO
 10979         MOVE AL-UANON           TO BIRTHDTA
 10980     END-IF.
 10981
 10982     IF SSNL GREATER ZERO
 10983         MOVE AL-UANON           TO SSNA
 10984     END-IF.
 10985
 10986     IF INCURL GREATER ZERO
 10987         MOVE AL-UANON           TO INCURA
 10988     END-IF.
 10989
 10990     IF REPORTL GREATER ZERO
 10991         MOVE AL-UANON           TO REPORTA
 10992     END-IF.
 10993
 10994*    IF ESTENDL GREATER ZERO
 10995*        MOVE AL-UANON           TO ESTENDA
 10996*    END-IF.
 10997
 10998     IF DIAGL GREATER ZERO
 10999         MOVE AL-UANON           TO DIAGA
 11000     END-IF.
 11001*
 11002     IF ICD1L GREATER ZERO
 11003         MOVE AL-UANON           TO ICD1A
 11004     END-IF.
 11005
 11006     IF ICD2L GREATER ZERO
 11007         MOVE AL-UANON           TO ICD2A
 11008     END-IF.
 11009
 11010*    IF CAUSEL GREATER ZERO
 11011*        MOVE AL-UANON           TO CAUSEA
 11012*    END-IF.
 11013
 11014     IF MANRSVL GREATER ZERO
 11015         MOVE AL-UNNON           TO MANRSVA
 11016     END-IF.
 11017
 11018     IF RELCLML GREATER ZERO
 11019         MOVE AL-UANON           TO RELCLMA
 11020     END-IF.
 11021
 11022     IF LOANNOL GREATER ZERO
 11023         MOVE AL-UANON           TO LOANNOA
 11024     END-IF.
 11025
 11026     IF LOANBALL GREATER ZERO
 11027         MOVE AL-UNNON           TO LOANBALA
 11028     END-IF.
 11029
 11030     IF PROCCDL GREATER ZERO
 11031         MOVE AL-UANON           TO PROCCDA
 11032     END-IF.
 11033
 11034     IF BENECDL GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 208
* EL130.cbl
 11035         MOVE AL-UANON           TO  BENECDA
 11036     END-IF.
 11037
 11038     IF PRICDL GREATER ZERO
 11039         MOVE AL-UANON           TO PRICDA
 11040     END-IF.
 11041
 11042     IF SUPVL GREATER ZERO
 11043         MOVE AL-UANON           TO SUPVA
 11044     END-IF.
 11045
 11046     IF FILETOL GREATER ZERO
 11047         MOVE AL-UANON           TO FILETOA
 11048     END-IF.
 11049
 11050
 11051 3993-MODIFY-CLAIM-KEY-ATTRB.
 11052
 11053     IF CLMNOL GREATER ZERO
 11054         MOVE AL-UANON           TO CLMNOA
 11055     END-IF.
 11056
 11057     IF CLMCARRL GREATER ZERO
 11058         MOVE AL-UANON           TO CLMCARRA
 11059     END-IF.
 11060
 11061     IF CLMTYPEL GREATER ZERO
 11062         MOVE AL-UANON           TO CLMTYPEA
 11063     END-IF.
 11064
 11065     IF CERTNOL GREATER ZERO
 11066         MOVE AL-SANON           TO CERTNOA
 11067     END-IF.
 11068
 11069     IF SUFXL GREATER ZERO
 11070         MOVE AL-SANON           TO SUFXA
 11071     END-IF.
 11072
 11073 3993-EXIT.
 11074     EXIT.
 11075
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 209
* EL130.cbl
 11077 3994-BUILD-NINETY-THREE-TRAILER.
 11078
 11079     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11080     MOVE 'AT'                   TO AT-RECORD-ID.
 11081
 11082     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11083     MOVE CLMCARRI               TO AT-CARRIER.
 11084
 11085     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11086     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11087     MOVE +93                    TO AT-SEQUENCE-NO.
 11088     MOVE '6'                    TO AT-TRAILER-TYPE.
 11089     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11090
 11091     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11092         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11093     ELSE
 11094         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11095     END-IF
 11096
 11097     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11098                                    AT-GEN-INFO-LAST-MAINT-DT.
 11099
 11100     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11101                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11102     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11103
 11104
 11105
 11106* EXEC CICS WRITE
 11107*        DATASET   (ELTRLR-DSID)
 11108*        FROM      (ACTIVITY-TRAILERS)
 11109*        RIDFLD    (AT-CONTROL-PRIMARY)
 11110*    END-EXEC.
 11111     MOVE LENGTH OF
 11112      ACTIVITY-TRAILERS
 11113       TO DFHEIV11
 11114*    MOVE '&$ L                  ''   #00010334' TO DFHEIV0
 11115     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11116     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11117     MOVE X'2020233030303130333334' TO DFHEIV0(25:11)
 11118     CALL 'kxdfhei1' USING DFHEIV0,
 11119           ELTRLR-DSID,
 11120           ACTIVITY-TRAILERS,
 11121           DFHEIV11,
 11122           AT-CONTROL-PRIMARY,
 11123           DFHEIV99,
 11124           DFHEIV99
 11125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11126
 11127
 11128 3994-EXIT.
 11129     EXIT.
 11130
 11131 3994B-BUILD-NINETY-FOUR-TRAILER.
 11132
 11133     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11134     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 210
* EL130.cbl
 11135
 11136     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11137     MOVE CLMCARRI               TO AT-CARRIER.
 11138
 11139     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11140     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11141     MOVE +94                    TO AT-SEQUENCE-NO.
 11142     MOVE '6'                    TO AT-TRAILER-TYPE.
 11143     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11144
 11145     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11146
 11147     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11148                                    AT-GEN-INFO-LAST-MAINT-DT.
 11149
 11150     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11151                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11152     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11153
 11154
 11155
 11156* EXEC CICS WRITE
 11157*        DATASET   (ELTRLR-DSID)
 11158*        FROM      (ACTIVITY-TRAILERS)
 11159*        RIDFLD    (AT-CONTROL-PRIMARY)
 11160*    END-EXEC.
 11161     MOVE LENGTH OF
 11162      ACTIVITY-TRAILERS
 11163       TO DFHEIV11
 11164*    MOVE '&$ L                  ''   #00010367' TO DFHEIV0
 11165     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11166     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11167     MOVE X'2020233030303130333637' TO DFHEIV0(25:11)
 11168     CALL 'kxdfhei1' USING DFHEIV0,
 11169           ELTRLR-DSID,
 11170           ACTIVITY-TRAILERS,
 11171           DFHEIV11,
 11172           AT-CONTROL-PRIMARY,
 11173           DFHEIV99,
 11174           DFHEIV99
 11175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11176
 11177
 11178 3994B-EXIT.
 11179     EXIT.
 11180 3994C-BUILD-NINETY-FIVE-TRAILER.
 11181
 11182     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11183     MOVE 'AT'                   TO AT-RECORD-ID
 11184
 11185     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11186     MOVE CLMCARRI               TO AT-CARRIER
 11187
 11188     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11189     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11190     MOVE +95                    TO AT-SEQUENCE-NO
 11191     MOVE '6'                    TO AT-TRAILER-TYPE
 11192     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 211
* EL130.cbl
 11193
 11194     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11195                                    AT-GEN-INFO-LAST-MAINT-DT
 11196
 11197     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11198                                    AT-GEN-INFO-LAST-UPDATED-BY
 11199     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11200
 11201     perform varying e1 from +1 by +1 until
 11202        ws-error-no (e1) = spaces
 11203        move ws-error-no (e1)    to at-note-error-no (e1)
 11204     end-perform
 11205
 11206     if at-info-line-1 not = spaces
 11207
 11208* EXEC CICS WRITE
 11209*          DATASET  (ELTRLR-DSID)
 11210*          FROM     (ACTIVITY-TRAILERS)
 11211*          RIDFLD   (AT-CONTROL-PRIMARY)
 11212*       END-EXEC
 11213     MOVE LENGTH OF
 11214      ACTIVITY-TRAILERS
 11215       TO DFHEIV11
 11216*    MOVE '&$ L                  ''   #00010402' TO DFHEIV0
 11217     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11218     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11219     MOVE X'2020233030303130343032' TO DFHEIV0(25:11)
 11220     CALL 'kxdfhei1' USING DFHEIV0,
 11221           ELTRLR-DSID,
 11222           ACTIVITY-TRAILERS,
 11223           DFHEIV11,
 11224           AT-CONTROL-PRIMARY,
 11225           DFHEIV99,
 11226           DFHEIV99
 11227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11228     end-if
 11229
 11230     .
 11231 3994C-EXIT.
 11232     EXIT.
 11233 3995-BUILD-CLAIM-RECORD.
 11234     IF PROCCDL GREATER ZERO
 11235         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11236     ELSE
 11237         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11238     END-IF.
 11239
 11240     IF FSTNMEL GREATER ZERO
 11241         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11242     END-IF.
 11243
 11244     IF INITL GREATER ZERO
 11245         MOVE INITI              TO CL-INSURED-MID-INIT
 11246     END-IF.
 11247
 11248     IF BIRTHDTL GREATER ZERO
 11249         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11250     END-IF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 212
* EL130.cbl
 11251
 11252     IF SEXL GREATER ZERO
 11253         MOVE SEXI               TO CL-INSURED-SEX-CD
 11254     END-IF.
 11255
 11256     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11257
 11258*    IF CLMTYPEL GREATER ZERO
 11259     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11260*    END-IF.
 11261
 11262     IF PREMTYPL GREATER ZERO
 11263         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11264     END-IF.
 11265
 11266     IF INCURL GREATER ZERO
 11267         MOVE WS-INCUR           TO CL-INCURRED-DT
 11268     END-IF.
 11269
 11270     IF (PI-COMPANY-ID = 'DCC')
 11271        AND (ERPDEF-FOUND)
 11272        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11273*       MOVE WS-CRIT-PER-RECURRENT
 11274*                                TO CL-CRIT-PER-RECURRENT
 11275*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11276        if ws-crit-per-recurrent > 01
 11277           move zeros            to cl-benefit-period
 11278        end-if
 11279     ELSE
 11280        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11281           MOVE CM-LF-CRITICAL-PERIOD
 11282                                 TO CL-CRITICAL-PERIOD
 11283        ELSE
 11284           MOVE CM-AH-CRITICAL-PERIOD
 11285                                 TO CL-CRITICAL-PERIOD
 11286        END-IF
 11287     END-IF
 11288
 11289     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11290        COMPUTE DC-ELAPSED-MONTHS =
 11291           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11292        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11293        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11294        MOVE '6'                 TO DC-OPTION-CODE
 11295        PERFORM 9700-LINK-DATE-CONVERT
 11296                                 THRU 9700-EXIT
 11297        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11298     END-IF
 11299
 11300     if instypel > zero
 11301        move instypei            to cl-insured-type
 11302     end-if
 11303     IF REPORTL GREATER ZERO
 11304         MOVE WS-REPORT          TO CL-REPORTED-DT
 11305     END-IF.
 11306
 11307     IF EIBAID = DFHPF6
 11308         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 213
* EL130.cbl
 11309             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11310                 IF EMI-FORCABLE-CTR = +1
 11311                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11312                 END-IF
 11313         END-IF
 11314     END-IF.
 11315
 11316*    IF ESTENDL GREATER ZERO
 11317*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11318*    END-IF.
 11319
 11320     IF ADDONDTL GREATER ZERO
 11321         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11322     END-IF.
 11323
 11324*    IF CAUSEL GREATER ZERO
 11325*        MOVE CAUSEI             TO CL-CAUSE-CD
 11326*    END-IF.
 11327
 11328     IF SSNL GREATER ZERO
 11329         MOVE SSNI               TO CL-SOC-SEC-NO
 11330     ELSE
 11331         MOVE CERT-STATE         TO CL-SSN-STATE
 11332         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11333         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11334     END-IF.
 11335
 11336     IF PRICDL GREATER ZERO
 11337         MOVE PRICDI             TO CL-PRIORITY-CD
 11338     END-IF.
 11339
 11340     IF SUPVL GREATER ZERO
 11341         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11342     END-IF.
 11343
 11344     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11345     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11346     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11347
 11348     IF RELCLML GREATER ZERO
 11349         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11350     END-IF.
 11351
 11352     IF FILETOL GREATER ZERO
 11353         MOVE FILETOI            TO CL-FILE-LOCATION
 11354     END-IF.
 11355
 11356 3995-EXIT.
 11357      EXIT.
 11358 3996-read-cert-claim-trailer.
 11359
 11360     move cm-ah-benefit-amt      to ws-monthly-benefit
 11361     if (pi-dcc-max-amt < ws-monthly-benefit)
 11362        and (pi-dcc-max-amt not = zeros)
 11363        move pi-dcc-max-amt      to ws-monthly-benefit
 11364     end-if
 11365
 11366     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 214
* EL130.cbl
 11367     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11368     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11369     MOVE CM-STATE               TO CTRLR-STATE
 11370     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11371     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11372     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11373     MOVE 'B'                    TO CTRLR-REC-TYPE
 11374
 11375* EXEC CICS READ
 11376*       DATASET  (ELCRTT-DSID)
 11377*       set     (address of CERTIFICATE-TRAILERS)
 11378*       RIDFLD   (ELCRTT-KEY)
 11379*       RESP     (WS-RESPONSE)
 11380*    END-EXEC
 11381*    MOVE '&"S        E          (  N#00010553' TO DFHEIV0
 11382     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11384     MOVE X'204E233030303130353533' TO DFHEIV0(25:11)
 11385     CALL 'kxdfhei1' USING DFHEIV0,
 11386           ELCRTT-DSID,
 11387           DFHEIV20,
 11388           DFHEIV99,
 11389           ELCRTT-KEY,
 11390           DFHEIV99,
 11391           DFHEIV99,
 11392           DFHEIV99
 11393     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11394         DFHEIV20
 11395     MOVE EIBRESP  TO WS-RESPONSE
 11396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11397***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11398***                                                            ***
 11399***  This may need some work here. I think I should accumulate ***
 11400***  all the claims with the same claim type?????????          ***
 11401***                                                            ***
 11402***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11403     IF WS-RESP-NORMAL
 11404        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11405        perform varying s1 from +1 by +1 until
 11406           (s1 > +24)
 11407           or (cs-claim-no (s1) = spaces)
 11408           if cs-claim-type (s1) = clmtypei
 11409              move er-1659       to ws-error-no (e1)
 11410              compute ws-tot-days-paid =
 11411                 ws-tot-days-paid + cs-days-paid (s1)
 11412              compute ws-tot-amt-paid =
 11413                 ws-tot-amt-paid + cs-total-paid (s1)
 11414           end-if
 11415        end-perform
 11416*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11417*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11418*           and (pi-dcc-max-benefits not = zeros)
 11419*           add +1                to e1
 11420*           MOVE ER-1660          TO EMI-ERROR
 11421*                                    ws-error-no (e1)
 11422*           PERFORM 9900-ERROR-FORMAT
 11423*                                 THRU 9900-EXIT
 11424*        end-if
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 215
* EL130.cbl
 11425     end-if
 11426**       if instypei = 'P'
 11427**          move +1 to s1
 11428**       else
 11429**          MOVE +2 to s1
 11430**       end-if
 11431*
 11432*        move +1 to s1
 11433*        evaluate clmtypei
 11434*           when 'A'
 11435*              move +1 to s2
 11436*           when 'I'
 11437*              move +2 to s2
 11438*           when 'G'
 11439*              move +3 to s2
 11440*           when 'L'
 11441*              move +4 to s2
 11442*           when 'P'
 11443*              move +5 to s2
 11444*        end-evaluate
 11445*        if cs-claim-type (s1 s2) = clmtypei
 11446*           if cs-no-of-claims (s1 s2) > zeros
 11447*              move er-1659       to ws-error-no (e1)
 11448*           end-if
 11449*           compute WS-BENEFITS-PREV-PAID =
 11450*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11451*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11452*              and (pi-dcc-max-benefits not = zeros)
 11453*              add +1             to e1
 11454*              MOVE ER-1660       TO EMI-ERROR
 11455*                                    ws-error-no (e1)
 11456*              PERFORM 9900-ERROR-FORMAT
 11457*                                 THRU 9900-EXIT
 11458*           end-if
 11459*        end-if
 11460*     end-if
 11461
 11462     .
 11463 3996-exit.
 11464     exit.
 11465
 11466 3997-GET-ERPDEF.
 11467
 11468     if cm-clp-state = spaces or low-values or zeros
 11469        move cm-state            to cm-clp-state
 11470     end-if
 11471     MOVE SPACES                 TO WS-ERPDEF-SW
 11472     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11473                                    WS-CRIT-PER-RTW-MOS
 11474                                    WS-CRIT-PER-RECURRENT
 11475
 11476     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11477     MOVE CM-clp-state        TO ERPDEF-STATE
 11478     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11479***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11480***                                                            ***
 11481***  If they set up a claim where there is no coverage on the  ***
 11482***  addendum with the intention of denying.  We need to do    ***
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 216
* EL130.cbl
 11483***  some funky stuff here.                                    ***
 11484***                                                            ***
 11485***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11486
 11487     evaluate true
 11488        when (clmtypei = 'L' or 'P')
 11489           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 11490              and 'CU')
 11491           move 'L'              to erpdef-ben-type
 11492           move cm-lf-benefit-cd to erpdef-ben-code
 11493        when (clmtypei not = 'L' and 'P')
 11494           and (cm-ah-benefit-cd not = '00' and '  ')
 11495           move 'A'              to erpdef-ben-type
 11496           move cm-ah-benefit-cd to erpdef-ben-code
 11497        when (clmtypei not = 'L' and 'P')
 11498           and (cm-ah-benefit-cd = '00' or '  ')
 11499           move 'L'              to erpdef-ben-type
 11500           move cm-lf-benefit-cd to erpdef-ben-code
 11501        when (clmtypei = 'L' or 'P')
 11502           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 11503           move 'A'              to erpdef-ben-type
 11504           move cm-ah-benefit-cd to erpdef-ben-code
 11505        when other
 11506           move 'A'              to erpdef-ben-type
 11507           move cm-ah-benefit-cd to erpdef-ben-code
 11508     end-evaluate
 11509*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11510*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11511     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11512     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11513
 11514
 11515* EXEC CICS STARTBR
 11516*        DATASET  ('ERPDEF')
 11517*        RIDFLD   (ERPDEF-KEY)
 11518*        GTEQ
 11519*        RESP     (WS-RESPONSE)
 11520*    END-EXEC
 11521     MOVE 'ERPDEF' TO DFHEIV1
 11522     MOVE 0
 11523       TO DFHEIV11
 11524*    MOVE '&,         G          &  N#00010676' TO DFHEIV0
 11525     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11526     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11527     MOVE X'204E233030303130363736' TO DFHEIV0(25:11)
 11528     CALL 'kxdfhei1' USING DFHEIV0,
 11529           DFHEIV1,
 11530           ERPDEF-KEY,
 11531           DFHEIV99,
 11532           DFHEIV11,
 11533           DFHEIV99
 11534     MOVE EIBRESP  TO WS-RESPONSE
 11535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11536
 11537     IF WS-RESP-NORMAL
 11538
 11539* EXEC CICS READNEXT
 11540*          DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 217
* EL130.cbl
 11541*          INTO     (PRODUCT-MASTER)
 11542*          RIDFLD   (ERPDEF-KEY)
 11543*          RESP     (WS-RESPONSE)
 11544*       END-EXEC
 11545     MOVE LENGTH OF
 11546      PRODUCT-MASTER
 11547       TO DFHEIV12
 11548     MOVE 'ERPDEF' TO DFHEIV1
 11549     MOVE 0
 11550       TO DFHEIV11
 11551*    MOVE '&.IL                  )  N#00010684' TO DFHEIV0
 11552     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11553     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11554     MOVE X'204E233030303130363834' TO DFHEIV0(25:11)
 11555     CALL 'kxdfhei1' USING DFHEIV0,
 11556           DFHEIV1,
 11557           PRODUCT-MASTER,
 11558           DFHEIV12,
 11559           ERPDEF-KEY,
 11560           DFHEIV99,
 11561           DFHEIV11,
 11562           DFHEIV99,
 11563           DFHEIV99
 11564     MOVE EIBRESP  TO WS-RESPONSE
 11565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11566
 11567        IF WS-RESP-NORMAL
 11568           IF (ERPDEF-KEY-SAVE (1:16) =
 11569              PD-CONTROL-PRIMARY (1:16))
 11570              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11571
 11572              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11573                 (A1 > +8)
 11574                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11575              END-PERFORM
 11576              IF A1 < +9
 11577                 SET ERPDEF-FOUND TO TRUE
 11578                 move pd-max-amt (a1)
 11579                              to pi-dcc-max-amt
 11580                 MOVE PD-CRIT-PERIOD (A1)
 11581                              TO WS-MAX-BENEFITS
 11582                                 pi-dcc-max-benefits
 11583                 if pd-rec-crit-period (a1) not numeric
 11584                    move 01      to pd-rec-crit-period (a1)
 11585                 end-if
 11586                 MOVE PD-REC-CRIT-PERIOD (A1)
 11587                              TO WS-CRIT-PER-RECURRENT
 11588                 IF PD-RTW-MOS (A1) NUMERIC
 11589                    MOVE PD-RTW-MOS (A1)
 11590                              TO WS-CRIT-PER-RTW-MOS
 11591                 ELSE
 11592                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11593                 END-IF
 11594                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11595                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11596                                 TO WS-EXCL-PERIOD
 11597                 END-IF
 11598                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 218
* EL130.cbl
 11599                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11600                                 TO WS-COV-ENDS
 11601                 END-IF
 11602                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11603                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11604                                 TO WS-ACC-PERIOD
 11605                 END-IF
 11606              else
 11607                 MOVE -1         TO MAINTL
 11608                 move er-1673    to emi-error
 11609                 PERFORM 9900-ERROR-FORMAT
 11610                                 THRU 9900-EXIT
 11611              END-IF
 11612           else
 11613              MOVE -1            TO MAINTL
 11614              move er-1671       to emi-error
 11615              PERFORM 9900-ERROR-FORMAT
 11616                                 THRU 9900-EXIT
 11617           END-IF
 11618        END-IF
 11619     END-IF
 11620
 11621     .
 11622 3997-EXIT.
 11623     EXIT.
 11624
 11625 3998-update-cert-claim-trailer.
 11626
 11627
 11628* EXEC CICS GETMAIN
 11629*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11630*       LENGTH   (ELCRTT-LENGTH)
 11631*       INITIMG  (GETMAIN-SPACE)
 11632*    END-EXEC
 11633*    MOVE ',"IL                  $   #00010751' TO DFHEIV0
 11634     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11635     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11636     MOVE X'2020233030303130373531' TO DFHEIV0(25:11)
 11637     CALL 'kxdfhei1' USING DFHEIV0,
 11638           DFHEIV20,
 11639           ELCRTT-LENGTH,
 11640           GETMAIN-SPACE
 11641     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11642         DFHEIV20
 11643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11644
 11645     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11646     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11647     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11648     MOVE CM-STATE         TO CTRLR-STATE
 11649     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11650     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11651     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11652     MOVE 'B'              TO CTRLR-REC-TYPE
 11653
 11654* EXEC CICS READ
 11655*       UPDATE
 11656*       DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 219
* EL130.cbl
 11657*       into     (CERTIFICATE-TRAILERS)
 11658*       RIDFLD   (ELCRTT-KEY)
 11659*       RESP     (WS-RESPONSE)
 11660*    END-EXEC
 11661     MOVE LENGTH OF
 11662      CERTIFICATE-TRAILERS
 11663       TO DFHEIV11
 11664*    MOVE '&"IL       EU         (  N#00010765' TO DFHEIV0
 11665     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11666     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11667     MOVE X'204E233030303130373635' TO DFHEIV0(25:11)
 11668     CALL 'kxdfhei1' USING DFHEIV0,
 11669           ELCRTT-DSID,
 11670           CERTIFICATE-TRAILERS,
 11671           DFHEIV11,
 11672           ELCRTT-KEY,
 11673           DFHEIV99,
 11674           DFHEIV99,
 11675           DFHEIV99
 11676     MOVE EIBRESP  TO WS-RESPONSE
 11677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11678     IF WS-RESP-NORMAL
 11679        perform varying s1 from +1 by +1 until
 11680           (s1 > +24)
 11681           or (cs-claim-no (s1) = spaces)
 11682        end-perform
 11683        if s1 < +25
 11684           perform 3999-upd-crt-trlr thru 3999-exit
 11685
 11686* EXEC CICS REWRITE
 11687*             DATASET  (ELCRTT-DSID)
 11688*             from     (CERTIFICATE-TRAILERS)
 11689*             RESP     (WS-RESPONSE)
 11690*          END-EXEC
 11691     MOVE LENGTH OF
 11692      CERTIFICATE-TRAILERS
 11693       TO DFHEIV11
 11694*    MOVE '&& L                  %  N#00010779' TO DFHEIV0
 11695     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11696     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11697     MOVE X'204E233030303130373739' TO DFHEIV0(25:11)
 11698     CALL 'kxdfhei1' USING DFHEIV0,
 11699           ELCRTT-DSID,
 11700           CERTIFICATE-TRAILERS,
 11701           DFHEIV11,
 11702           DFHEIV99
 11703     MOVE EIBRESP  TO WS-RESPONSE
 11704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11705        end-if
 11706     else
 11707        if ws-resp-notfnd
 11708           move 'CS'             to certificate-trailers
 11709           move cm-control-primary to cs-control-primary
 11710           move 'B'              to cs-trailer-type
 11711           perform varying s1 from +1 by +1 until s1 > +24
 11712              move zeros         to cs-days-paid (s1)
 11713                                    cs-total-paid (s1)
 11714                                    cs-benefit-period (s1)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 220
* EL130.cbl
 11715                                    cs-remaining-bens (s1)
 11716           end-perform
 11717           move +1               to s1
 11718           perform 3999-upd-crt-trlr
 11719                                 thru 3999-exit
 11720
 11721* EXEC CICS WRITE
 11722*             DATASET  (ELCRTT-DSID)
 11723*             from     (CERTIFICATE-TRAILERS)
 11724*             RIDFLD   (cs-control-primary)
 11725*             RESP     (WS-RESPONSE)
 11726*          END-EXEC
 11727     MOVE LENGTH OF
 11728      CERTIFICATE-TRAILERS
 11729       TO DFHEIV11
 11730*    MOVE '&$ L                  ''  N#00010799' TO DFHEIV0
 11731     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11732     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11733     MOVE X'204E233030303130373939' TO DFHEIV0(25:11)
 11734     CALL 'kxdfhei1' USING DFHEIV0,
 11735           ELCRTT-DSID,
 11736           CERTIFICATE-TRAILERS,
 11737           DFHEIV11,
 11738           cs-control-primary,
 11739           DFHEIV99,
 11740           DFHEIV99
 11741     MOVE EIBRESP  TO WS-RESPONSE
 11742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11743        end-if
 11744     END-IF
 11745
 11746     .
 11747 3998-exit.
 11748     exit.
 11749
 11750 3999-upd-crt-trlr.
 11751     move clmnoi                 to cs-claim-no       (s1)
 11752     move clmtypei               to cs-claim-type     (s1)
 11753     move instypei               to cs-insured-type   (s1)
 11754     move cl-benefit-period      to cs-benefit-period (s1)
 11755*    move cl-critical-period     to cs-remaining-bens (s1)
 11756     move zeros                  to cs-remaining-bens (s1)
 11757     .
 11758 3999-exit.
 11759     exit.
 11760 4000-CALCULATE-CERT-TERM.
 11761
 11762     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 11763
 11764     MOVE N                      TO WS-TERM.
 11765
 11766     IF WS-TERM GREATER 120
 11767         MOVE 120                TO WS-TERM
 11768     END-IF.
 11769
 11770 4000-CALC-TERM-EXIT.
 11771      EXIT.
 11772
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 221
* EL130.cbl
 11773 4100-CALC-GROSS-TERM.
 11774     MOVE HOLD-LOAN-BAL           TO L.
 11775     MOVE WS-ACVBENE              TO M.
 11776     COMPUTE N = L / M.
 11777     IF N LESS 1
 11778         MOVE 1  TO N
 11779     END-IF.
 11780
 11781     IF LCVCDL GREATER ZERO
 11782         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 11783     ELSE
 11784         MOVE ZEROS               TO WS-LF-RATE
 11785     END-IF.
 11786
 11787     IF ACVCDL GREATER ZERO
 11788         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 11789     ELSE
 11790         MOVE ZEROS               TO WS-AH-RATE
 11791     END-IF.
 11792
 11793     COMPUTE I = WS-APR / +1200.
 11794
 11795 4105-LOOP.
 11796     IF N GREATER 240
 11797         GO TO 4200-EXIT
 11798     END-IF.
 11799
 11800     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 11801
 11802     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 11803         ADD 1 TO N
 11804         GO TO 4105-LOOP
 11805     END-IF.
 11806
 11807 4200-EXIT.
 11808      EXIT.
 11809
 11810 4210-CALC-LEFT-RIGHTONE.
 11811      MOVE L         TO LEFT-TOT-1.
 11812      SUBTRACT 1 FROM N.
 11813      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11814      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 11815      ADD 1 TO N.
 11816
 11817 4211-CALC-TERM1.
 11818      MOVE N         TO TERM1.
 11819      MULTIPLY M BY TERM1.
 11820
 11821 4212-LOOP.
 11822      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 11823      ADD 1 TO A-N.
 11824      MULTIPLY A-N BY TERM1.
 11825      SUBTRACT 1 FROM A-N.
 11826      ADD TERM1 TO LEFT-TOT-1.
 11827
 11828 4213-CALC-TERM2.
 11829      MOVE M         TO TERM2.
 11830      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 222
* EL130.cbl
 11831      MULTIPLY IA-N BY TERM2.
 11832      SUBTRACT TERM2 FROM LEFT-TOT-1.
 11833
 11834 4215-CALC-RIGHTONE.
 11835      MOVE M         TO RIGHT-TOT-1.
 11836      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11837      MULTIPLY A-N BY RIGHT-TOT-1.
 11838
 11839 4220-EXIT.
 11840      EXIT.
 11841
 11842 4300-CALC-A-N.
 11843     IF N LESS 1
 11844         MOVE 0     TO A-N
 11845         GO TO 4300-EXIT
 11846     END-IF.
 11847
 11848     IF I = 0
 11849         MOVE .00001 TO I
 11850     END-IF.
 11851
 11852     ADD 1 TO I.
 11853     DIVIDE I INTO 1 GIVING V.
 11854     SUBTRACT 1 FROM I.
 11855     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11856     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 11857     DIVIDE I INTO TERM3 GIVING A-N.
 11858
 11859 4300-EXIT.
 11860      EXIT.
 11861
 11862 4350-CALC-IA-N.
 11863     IF N LESS 1
 11864         MOVE 0      TO IA-N
 11865         GO TO 4400-EXIT
 11866     END-IF.
 11867
 11868     ADD 1 TO N.
 11869     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11870     SUBTRACT 1 FROM N.
 11871     MULTIPLY N BY V-EX-N GIVING TERM3.
 11872     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 11873     SUBTRACT V FROM 1 GIVING TERM4.
 11874     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 11875
 11876 4400-EXIT.
 11877      EXIT.
 11878
 11879 4450-CALC-V-EX-N.
 11880     IF N LESS 1
 11881         MOVE 1    TO V-EX-N
 11882         GO TO 4490-EXIT
 11883     END-IF.
 11884
 11885     MOVE N        TO NV-STORE.
 11886
 11887     IF V-EX-ONETIME = 1  OR
 11888        V NOT = V-EXPONENT (1)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 223
* EL130.cbl
 11889          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 11890     END-IF.
 11891
 11892 4460-LOOP.
 11893     IF N GREATER 248
 11894         MOVE 248 TO N
 11895     END-IF.
 11896
 11897     IF N = 1
 11898         MOVE V               TO V-EX-N
 11899     ELSE
 11900         MOVE V-EXPONENT (N)  TO V-EX-N
 11901     END-IF.
 11902
 11903     GO TO 4490-EXIT.
 11904
 11905 4470-BUILD-V-EX-TABLE.
 11906     MOVE 2      TO N.
 11907     MOVE V      TO V-EXPONENT (1)
 11908                    V-EX-N.
 11909
 11910 4471-LOOP.
 11911     MULTIPLY V BY V-EX-N.
 11912     MOVE V-EX-N   TO V-EXPONENT (N).
 11913
 11914     ADD 1 TO N.
 11915     IF N LESS 248
 11916         GO TO 4471-LOOP
 11917     END-IF.
 11918
 11919     MOVE NV-STORE     TO N.
 11920     MOVE ZERO         TO V-EX-ONETIME.
 11921
 11922 4480-EXIT.
 11923      EXIT.
 11924
 11925 4490-EXIT.
 11926      EXIT.
 11927
 11928 4500-CALC-NET-TERM.
 11929     MOVE HOLD-LOAN-BAL           TO L.
 11930     MOVE WS-ACVBENE              TO M.
 11931     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 11932
 11933     IF WS-REMAIN GREATER ZERO
 11934         ADD 1 TO N
 11935     END-IF.
 11936
 11937     IF N = 0
 11938         MOVE 1 TO N
 11939     END-IF.
 11940
 11941 4700-EXIT.
 11942      EXIT.
 11943
 11944 4999-CALC-TERM-EXIT.
 11945     EXIT.
 11946
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 224
* EL130.cbl
 11948 5000-INCURRED-CHANGE.
 11949     IF NOT MODIFY-CAP
 11950         MOVE ER-0070            TO EMI-ERROR
 11951         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11952         MOVE -1                 TO MAINTL
 11953         GO TO 8200-SEND-DATAONLY
 11954     END-IF.
 11955
 11956     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 11957        CLMCARRI     NOT = PI-LAST-CARR        OR
 11958        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 11959        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 11960        PI-INCURR-SW NOT = 'Y'
 11961          GO TO 1000-SHOW-CLAIM
 11962     END-IF.
 11963
 11964     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 11965     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 11966     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 11967
 11968     IF EMI-NO-ERRORS
 11969         GO TO 5000-TRY-TO-BUILD
 11970     END-IF.
 11971
 11972     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 11973        MOVE ER-0433             TO EMI-ERROR
 11974        MOVE -1                  TO MAINTL
 11975        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11976        GO TO 8200-SEND-DATAONLY
 11977     END-IF.
 11978
 11979     IF EIBAID = DFHPF6
 11980         IF EMI-FATAL-CTR NOT EQUAL ZERO
 11981            MOVE ER-0434         TO EMI-ERROR
 11982            MOVE -1              TO MAINTL
 11983            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11984            GO TO 8200-SEND-DATAONLY
 11985         ELSE
 11986            MOVE +1              TO INCURL
 11987            GO TO 5000-TRY-TO-BUILD
 11988         END-IF
 11989     END-IF.
 11990
 11991     GO TO 8200-SEND-DATAONLY.
 11992
 11993 5000-TRY-TO-BUILD.
 11994
 11995     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 11996
 11997     MOVE CLMCARRI               TO MSTR-CARRIER.
 11998
 11999     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 12000     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 12001     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 12002
 12003     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 12004
 12005     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 225
* EL130.cbl
 12006         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 12007     END-IF.
 12008
 12009     IF CL-PURGED-DT NOT = LOW-VALUES
 12010
 12011
 12012* EXEC CICS UNLOCK
 12013*            DATASET   (ELMSTR-DSID)
 12014*        END-EXEC
 12015*    MOVE '&*                    #   #00011073' TO DFHEIV0
 12016     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12017     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12018     MOVE X'2020233030303131303733' TO DFHEIV0(25:11)
 12019     CALL 'kxdfhei1' USING DFHEIV0,
 12020           ELMSTR-DSID,
 12021           DFHEIV99
 12022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12023         MOVE ER-7691            TO EMI-ERROR
 12024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12025         MOVE -1                 TO MAINTL
 12026         GO TO 8200-SEND-DATAONLY
 12027     END-IF.
 12028
 12029     IF CL-AUTO-PAY-SEQ NOT = ZERO
 12030
 12031
 12032* EXEC CICS UNLOCK
 12033*            DATASET   (ELMSTR-DSID)
 12034*       END-EXEC
 12035*    MOVE '&*                    #   #00011084' TO DFHEIV0
 12036     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12037     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12038     MOVE X'2020233030303131303834' TO DFHEIV0(25:11)
 12039     CALL 'kxdfhei1' USING DFHEIV0,
 12040           ELMSTR-DSID,
 12041           DFHEIV99
 12042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12043         MOVE ER-0523             TO EMI-ERROR
 12044         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12045         MOVE -1                  TO MAINTL
 12046         GO TO 8200-SEND-DATAONLY
 12047     END-IF.
 12048
 12049     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12050
 12051     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12052     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12053     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12054     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12055     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12056
 12057     IF MANRSVL GREATER ZERO
 12058        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12059                                    AT-CURRENT-MANUAL-RESERVE
 12060     END-IF.
 12061     MOVE 1                      TO SUB.
 12062
 12063 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 226
* EL130.cbl
 12064     IF SUB = 1
 12065        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12066        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12067        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12068     ELSE
 12069        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12070        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12071                                    AT-OPEN-CLOSE-REASON (SUB)
 12072     END-IF.
 12073
 12074     IF SUB NOT = 6
 12075        ADD 1                    TO SUB
 12076        GO TO 5010-LOOP
 12077     END-IF.
 12078
 12079 5020-UPDATE.
 12080
 12081     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12082
 12083     IF DIAGL = ZERO
 12084       AND ICD1L = ZERO
 12085       AND ICD2L = ZERO
 12086         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12087         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12088         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12089         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12090         GO TO 5025-BYPASS-UPDATE
 12091     END-IF.
 12092
 12093     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12094
 12095     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12096     IF DIAGL NOT = ZERO
 12097         MOVE DIAGI              TO AT-INFO-LINE-1
 12098     END-IF.
 12099
 12100     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12101     IF ICD1L NOT = ZERO
 12102         MOVE ICD1I              TO AT-ICD-CODE-1
 12103     END-IF.
 12104
 12105     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12106     IF ICD2L NOT = ZERO
 12107         MOVE ICD2I              TO AT-ICD-CODE-2
 12108     END-IF.
 12109
 12110     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12111
 12112 5025-BYPASS-UPDATE.
 12113
 12114
 12115
 12116* EXEC CICS GETMAIN
 12117*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12118*        LENGTH   (ELTRLR-LENGTH)
 12119*    END-EXEC.
 12120*    MOVE '," L                  $   #00011159' TO DFHEIV0
 12121     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 227
* EL130.cbl
 12122     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12123     MOVE X'2020233030303131313539' TO DFHEIV0(25:11)
 12124     CALL 'kxdfhei1' USING DFHEIV0,
 12125           DFHEIV20,
 12126           ELTRLR-LENGTH,
 12127           DFHEIV99
 12128     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12129         DFHEIV20
 12130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12131
 12132
 12133     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12134     MOVE 'AT'                   TO AT-RECORD-ID.
 12135
 12136     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12137     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12138     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12139     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12140     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12141     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12142     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12143     MOVE '9'                    TO AT-TRAILER-TYPE.
 12144     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12145     MOVE '5'                    TO DC-OPTION-CODE.
 12146     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12147     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12148
 12149     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12150     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12151
 12152     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12153     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12154     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12155     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12156     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12157     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12158     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12159     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12160     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12161     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12162     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12163     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12164
 12165     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12166     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12167     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12168     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12169     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12170
 12171
 12172
 12173* EXEC CICS WRITE
 12174*        DATASET   (ELTRLR-DSID)
 12175*        FROM      (ACTIVITY-TRAILERS)
 12176*        RIDFLD    (AT-CONTROL-PRIMARY)
 12177*    END-EXEC.
 12178     MOVE LENGTH OF
 12179      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 228
* EL130.cbl
 12180       TO DFHEIV11
 12181*    MOVE '&$ L                  ''   #00011203' TO DFHEIV0
 12182     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12183     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12184     MOVE X'2020233030303131323033' TO DFHEIV0(25:11)
 12185     CALL 'kxdfhei1' USING DFHEIV0,
 12186           ELTRLR-DSID,
 12187           ACTIVITY-TRAILERS,
 12188           DFHEIV11,
 12189           AT-CONTROL-PRIMARY,
 12190           DFHEIV99,
 12191           DFHEIV99
 12192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12193
 12194
 12195     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12196     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12197     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12198     MOVE CL-CERT-STATE          TO CERT-STATE.
 12199     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12200     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12201     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12202
 12203
 12204
 12205* EXEC CICS HANDLE CONDITION
 12206*        NOTFND   (5050-CERT-NOT-FOUND)
 12207*    END-EXEC.
 12208*    MOVE '"$I                   ! ; #00011218' TO DFHEIV0
 12209     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12210     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12211     MOVE X'3B20233030303131323138' TO DFHEIV0(25:11)
 12212     CALL 'kxdfhei1' USING DFHEIV0
 12213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12214
 12215
 12216     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12217
 12218     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12219
 12220
 12221
 12222* EXEC CICS HANDLE CONDITION
 12223*         DUPKEY   (5030-CERT-WRITTEN)
 12224*    END-EXEC.
 12225*    MOVE '"$$                   ! < #00011227' TO DFHEIV0
 12226     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12227     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12228     MOVE X'3C20233030303131323237' TO DFHEIV0(25:11)
 12229     CALL 'kxdfhei1' USING DFHEIV0
 12230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12231
 12232
 12233
 12234
 12235* EXEC CICS REWRITE
 12236*        DATASET  (ELCERT-DSID)
 12237*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 229
* EL130.cbl
 12238*    END-EXEC.
 12239     MOVE LENGTH OF
 12240      CERTIFICATE-MASTER
 12241       TO DFHEIV11
 12242*    MOVE '&& L                  %   #00011232' TO DFHEIV0
 12243     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12244     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12245     MOVE X'2020233030303131323332' TO DFHEIV0(25:11)
 12246     CALL 'kxdfhei1' USING DFHEIV0,
 12247           ELCERT-DSID,
 12248           CERTIFICATE-MASTER,
 12249           DFHEIV11,
 12250           DFHEIV99
 12251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12252
 12253
 12254 5030-CERT-WRITTEN.
 12255
 12256     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12257                                    CL-INCURRED-DT
 12258                                    CL-REPORTED-DT
 12259                                    CL-EST-END-OF-DISAB-DT
 12260                                    CL-PAID-THRU-DT.
 12261
 12262     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12263                                    CL-NO-OF-PMTS-MADE
 12264                                    CL-NO-OF-DAYS-PAID.
 12265
 12266     IF CLAIM-IS-CLOSED
 12267        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12268        MOVE 'O'                 TO CL-CLAIM-STATUS
 12269     END-IF.
 12270
 12271     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12272     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12273     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12274
 12275
 12276
 12277* EXEC CICS HANDLE CONDITION
 12278*         DUPKEY   (5035-CLAIM-WRITTEN)
 12279*    END-EXEC.
 12280*    MOVE '"$$                   ! = #00011259' TO DFHEIV0
 12281     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12283     MOVE X'3D20233030303131323539' TO DFHEIV0(25:11)
 12284     CALL 'kxdfhei1' USING DFHEIV0
 12285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12286
 12287
 12288
 12289
 12290* EXEC CICS REWRITE
 12291*        DATASET   (ELMSTR-DSID)
 12292*        FROM      (CLAIM-MASTER)
 12293*    END-EXEC.
 12294     MOVE LENGTH OF
 12295      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 230
* EL130.cbl
 12296       TO DFHEIV11
 12297*    MOVE '&& L                  %   #00011264' TO DFHEIV0
 12298     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12299     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12300     MOVE X'2020233030303131323634' TO DFHEIV0(25:11)
 12301     CALL 'kxdfhei1' USING DFHEIV0,
 12302           ELMSTR-DSID,
 12303           CLAIM-MASTER,
 12304           DFHEIV11,
 12305           DFHEIV99
 12306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12307
 12308
 12309 5035-CLAIM-WRITTEN.
 12310
 12311     MOVE ER-0000                TO EMI-ERROR.
 12312     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12313
 12314     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12315     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12316     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12317     MOVE CLMCARRI               TO PI-LAST-CARR.
 12318
 12319     IF PRTOPTL GREATER ZERO
 12320         MOVE PRTOPTI            TO PI-PRT-OPT
 12321     END-IF.
 12322
 12323     IF ALTPRTL GREATER ZERO
 12324         MOVE ALTPRTI            TO PI-ALT-PRT
 12325     END-IF.
 12326
 12327     MOVE LOW-VALUES             TO EL130AI.
 12328
 12329     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12330     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12331     MOVE PI-LAST-CARR           TO CLMCARRO.
 12332     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12333
 12334     IF PI-PRT-OPT = 'N' OR 'L'
 12335         MOVE PI-PRT-OPT         TO PRTOPTO
 12336         MOVE 1                  TO PRTOPTL
 12337     END-IF.
 12338
 12339     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12340         MOVE PI-ALT-PRT         TO ALTPRTO
 12341         MOVE 4                  TO ALTPRTL
 12342     END-IF.
 12343
 12344     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12345     MOVE AL-SANON               TO CERTNOA SUFXA.
 12346
 12347     MOVE SPACES                 TO PI-INCURR-SW.
 12348
 12349     IF PRTOPTL GREATER ZERO
 12350         IF PRTOPTI = 'L'
 12351             GO TO 0400-CREATE-ELACTQ
 12352         ELSE
 12353             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 231
* EL130.cbl
 12354         END-IF
 12355     END-IF.
 12356
 12357     GO TO 8100-SEND-INITIAL-MAP.
 12358
 12359 5050-CERT-NOT-FOUND.
 12360
 12361     MOVE ER-0244                TO EMI-ERROR.
 12362     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12363     MOVE -1                     TO CERTNOL.
 12364     GO TO 8200-SEND-DATAONLY.
 12365
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 232
* EL130.cbl
 12367 5500-BUILD-FORM-TRAILER.
 12368*************************************************************
 12369*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12370*************************************************************
 12371
 12372     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12373
 12374     IF  WS-BEN-ALPHA-2 = '30'
 12375         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12376         MOVE '6'                TO DC-OPTION-CODE
 12377         IF CL-CARRIER = 'C'
 12378             MOVE +14            TO DC-ELAPSED-DAYS
 12379             MOVE +0             TO DC-ELAPSED-MONTHS
 12380             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12381             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12382         ELSE
 12383             MOVE +21            TO DC-ELAPSED-DAYS
 12384             MOVE +0             TO DC-ELAPSED-MONTHS
 12385             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12386             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12387         END-IF
 12388     END-IF.
 12389
 12390
 12391
 12392* EXEC CICS GETMAIN
 12393*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12394*         LENGTH   (ELTRLR-LENGTH)
 12395*         INITIMG  (GETMAIN-SPACE)
 12396*    END-EXEC.
 12397*    MOVE ',"IL                  $   #00011351' TO DFHEIV0
 12398     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12399     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12400     MOVE X'2020233030303131333531' TO DFHEIV0(25:11)
 12401     CALL 'kxdfhei1' USING DFHEIV0,
 12402           DFHEIV20,
 12403           ELTRLR-LENGTH,
 12404           GETMAIN-SPACE
 12405     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12406         DFHEIV20
 12407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12408
 12409
 12410     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12411     MOVE 'AT'                   TO AT-RECORD-ID.
 12412
 12413     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12414     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12415     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12416     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12417                                    AT-FORM-LAST-MAINT-DT.
 12418     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12419                                    AT-FORM-LAST-UPDATED-BY.
 12420     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12421     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12422     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12423                                    AT-FORM-RE-SEND-DT
 12424                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 233
* EL130.cbl
 12425                                    AT-EMP-FORM-ANSWERED-DT
 12426                                    AT-PHY-FORM-ANSWERED-DT
 12427                                    AT-EMP-FORM-SEND-ON-DT
 12428                                    AT-FORM-PRINTED-DT
 12429                                    AT-FORM-REPRINT-DT.
 12430     MOVE '1'                    TO AT-FORM-TYPE.
 12431
 12432     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12433                                    AT-INSTRUCT-LN-2
 12434                                    AT-INSTRUCT-LN-3.
 12435
 12436     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12437     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12438
 12439     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12440
 12441     IF AM-EMPLOYER-STMT-USED = 'Y'
 12442        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12443     END-IF.
 12444
 12445
 12446
 12447* EXEC CICS WRITE
 12448*         DATASET  (ELTRLR-DSID)
 12449*         FROM     (ACTIVITY-TRAILERS)
 12450*         RIDFLD   (AT-CONTROL-PRIMARY)
 12451*    END-EXEC.
 12452     MOVE LENGTH OF
 12453      ACTIVITY-TRAILERS
 12454       TO DFHEIV11
 12455*    MOVE '&$ L                  ''   #00011393' TO DFHEIV0
 12456     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12457     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12458     MOVE X'2020233030303131333933' TO DFHEIV0(25:11)
 12459     CALL 'kxdfhei1' USING DFHEIV0,
 12460           ELTRLR-DSID,
 12461           ACTIVITY-TRAILERS,
 12462           DFHEIV11,
 12463           AT-CONTROL-PRIMARY,
 12464           DFHEIV99,
 12465           DFHEIV99
 12466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12467
 12468
 12469 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 234
* EL130.cbl
 12471*************************************************************
 12472*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12473*************************************************************
 12474
 12475 5700-BUILD-ARCHIVE-HEADER.
 12476
 12477     MOVE '1'                    TO CNTL-REC-TYPE.
 12478     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12479     MOVE SPACES                 TO CNTL-ACCESS.
 12480
 12481
 12482
 12483* EXEC CICS READ
 12484*         DATASET  (ELCNTL-DSID)
 12485*         SET      (ADDRESS OF CONTROL-FILE)
 12486*         RIDFLD   (ELCNTL-KEY)
 12487*         UPDATE
 12488*    END-EXEC.
 12489*    MOVE '&"S        EU         (   #00011412' TO DFHEIV0
 12490     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12491     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12492     MOVE X'2020233030303131343132' TO DFHEIV0(25:11)
 12493     CALL 'kxdfhei1' USING DFHEIV0,
 12494           ELCNTL-DSID,
 12495           DFHEIV20,
 12496           DFHEIV99,
 12497           ELCNTL-KEY,
 12498           DFHEIV99,
 12499           DFHEIV99,
 12500           DFHEIV99
 12501     SET ADDRESS OF CONTROL-FILE TO
 12502         DFHEIV20
 12503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12504
 12505
 12506     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12507
 12508     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12509
 12510
 12511
 12512* EXEC CICS REWRITE
 12513*         FROM     (CONTROL-FILE)
 12514*         DATASET  (ELCNTL-DSID)
 12515*    END-EXEC.
 12516     MOVE LENGTH OF
 12517      CONTROL-FILE
 12518       TO DFHEIV11
 12519*    MOVE '&& L                  %   #00011424' TO DFHEIV0
 12520     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12521     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12522     MOVE X'2020233030303131343234' TO DFHEIV0(25:11)
 12523     CALL 'kxdfhei1' USING DFHEIV0,
 12524           ELCNTL-DSID,
 12525           CONTROL-FILE,
 12526           DFHEIV11,
 12527           DFHEIV99
 12528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 235
* EL130.cbl
 12529
 12530
 12531
 12532
 12533* EXEC CICS HANDLE CONDITION
 12534*         NOTOPEN  (9990-ABEND)
 12535*         DUPKEY   (5799-EXIT)
 12536*    END-EXEC.
 12537*    MOVE '"$J$                  ! > #00011430' TO DFHEIV0
 12538     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12540     MOVE X'3E20233030303131343330' TO DFHEIV0(25:11)
 12541     CALL 'kxdfhei1' USING DFHEIV0
 12542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12543
 12544
 12545
 12546
 12547* EXEC CICS GETMAIN
 12548*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12549*         LENGTH  (ELARCH-LENGTH)
 12550*    END-EXEC.
 12551*    MOVE '," L                  $   #00011436' TO DFHEIV0
 12552     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12553     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12554     MOVE X'2020233030303131343336' TO DFHEIV0(25:11)
 12555     CALL 'kxdfhei1' USING DFHEIV0,
 12556           DFHEIV20,
 12557           ELARCH-LENGTH,
 12558           DFHEIV99
 12559     SET ADDRESS OF LETTER-ARCHIVE TO
 12560         DFHEIV20
 12561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12562
 12563
 12564     MOVE SPACES                 TO LETTER-ARCHIVE.
 12565     MOVE 'LA'                   TO LA-RECORD-ID.
 12566     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12567                                    LA-ARCHIVE-NO-A1.
 12568     MOVE '4'                    TO LA-RECORD-TYPE
 12569                                    LA-RECORD-TYPE-A1.
 12570     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12571                                    LA-LINE-SEQ-NO-A1.
 12572     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12573                                    LA-COMPANY-CD-A1.
 12574     MOVE CL-CARRIER             TO LA4-CARRIER.
 12575     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12576     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12577     MOVE CL-CERT-STATE          TO LA4-STATE.
 12578     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12579     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12580     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12581     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12582                                    LA4-RESEND-PRINT-DATE
 12583                                    LA4-FORM-REM-PRINT-DT
 12584                                    LA4-RESEND-DATE.
 12585     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12586     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 236
* EL130.cbl
 12587
 12588
 12589
 12590* EXEC CICS WRITE
 12591*         DATASET  (ELARCH-DSID)
 12592*         FROM     (LETTER-ARCHIVE)
 12593*         RIDFLD   (LA-CONTROL-PRIMARY)
 12594*    END-EXEC.
 12595     MOVE LENGTH OF
 12596      LETTER-ARCHIVE
 12597       TO DFHEIV11
 12598*    MOVE '&$ L                  ''   #00011466' TO DFHEIV0
 12599     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12600     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12601     MOVE X'2020233030303131343636' TO DFHEIV0(25:11)
 12602     CALL 'kxdfhei1' USING DFHEIV0,
 12603           ELARCH-DSID,
 12604           LETTER-ARCHIVE,
 12605           DFHEIV11,
 12606           LA-CONTROL-PRIMARY,
 12607           DFHEIV99,
 12608           DFHEIV99
 12609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12610
 12611
 12612 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 237
* EL130.cbl
 12614 6000-EDIT-CLAIM-DATA.
 12615
 12616     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12617     MOVE '2'                    TO DC-OPTION-CODE.
 12618     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12619     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12620
 12621     IF MAINTL NOT = ZERO
 12622         MOVE AL-UANON           TO MAINTA
 12623     END-IF
 12624
 12625     IF CLMNOL GREATER ZERO
 12626         IF CLMNOI = SPACES OR LOW-VALUES
 12627             MOVE -1             TO CLMNOL
 12628             MOVE AL-UABON       TO CLMNOA
 12629             MOVE ER-7688        TO EMI-ERROR
 12630             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12631         ELSE
 12632             MOVE AL-UANON       TO CLMNOA
 12633         END-IF
 12634     END-IF.
 12635
 12636     IF CERTNOL = ZERO
 12637         MOVE -1                 TO CERTNOL
 12638         MOVE AL-SABON           TO CERTNOA
 12639         MOVE ER-0203            TO EMI-ERROR
 12640         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12641     ELSE
 12642         MOVE AL-SANON           TO CERTNOA
 12643     END-IF.
 12644
 12645     IF SUFXL = ZERO
 12646         MOVE SPACES             TO SUFXI
 12647         MOVE AL-SANON           TO SUFXA
 12648     ELSE
 12649         MOVE AL-SANON           TO SUFXA
 12650     END-IF.
 12651
 12652     IF CLMCARRL = ZERO
 12653         MOVE -1                 TO CLMCARRL
 12654         MOVE ER-0194            TO EMI-ERROR
 12655         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12656     ELSE
 12657         MOVE CLMCARRI           TO PI-CARRIER
 12658         IF PI-NO-CARRIER-SECURITY
 12659             MOVE AL-UANON       TO CLMCARRA
 12660         END-IF
 12661     END-IF.
 12662
 12663     IF CLMTYPEL > ZERO
 12664        IF ((PI-COMPANY-ID = 'DCC')
 12665           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12666              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G' AND 'F'))
 12667                        OR
 12668           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12669           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12670              AND PI-AH-OVERRIDE-L1))
 12671              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 238
* EL130.cbl
 12672              MOVE AL-UABON       TO CLMTYPEA
 12673              MOVE ER-7634        TO EMI-ERROR
 12674              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12675        ELSE
 12676           MOVE AL-UANON       TO CLMTYPEA
 12677        END-IF
 12678     ELSE
 12679        IF MAINTI = 'A'
 12680           MOVE -1             TO CLMTYPEL
 12681           MOVE AL-UABON       TO CLMTYPEA
 12682           MOVE ER-0546        TO EMI-ERROR
 12683           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12684        END-IF
 12685     END-IF
 12686     if instypel > ZERO
 12687        if instypei = 'P' OR 'C'
 12688           move al-uanon         to instypea
 12689        else
 12690           MOVE -1               TO INSTYPEL
 12691           MOVE AL-UABON         TO INSTYPEA
 12692           MOVE ER-1654          TO EMI-ERROR
 12693           PERFORM 9900-ERROR-FORMAT
 12694                                 THRU 9900-EXIT
 12695        END-IF
 12696     ELSE
 12697        IF MAINTI = 'A'
 12698           MOVE -1               TO INSTYPEL
 12699           MOVE AL-UABON         TO INSTYPEA
 12700           MOVE ER-1654          TO EMI-ERROR
 12701           PERFORM 9900-ERROR-FORMAT
 12702                                 THRU 9900-EXIT
 12703        END-IF
 12704     END-IF
 12705     if (instypel <> zeros)
 12706        and (emi-error not = er-1654)
 12707        and (instypei = 'C')
 12708        and (crtfnmei = fstnmei)
 12709        move er-1675             to emi-error
 12710        MOVE -1                  TO INSTYPEL
 12711        MOVE AL-UABON            TO INSTYPEA
 12712        PERFORM 9900-ERROR-FORMAT
 12713                                 THRU 9900-EXIT
 12714    end-if
 12715     if (instypel <> zeros)
 12716        and (emi-error not = er-1654)
 12717        and (instypei = 'P')
 12718        and (crtfnmei <> fstnmei)
 12719        move er-1676             to emi-error
 12720        MOVE -1                  TO INSTYPEL
 12721        MOVE AL-UABON            TO INSTYPEA
 12722        PERFORM 9900-ERROR-FORMAT
 12723                                 THRU 9900-EXIT
 12724    end-if
 12725     IF PCERTNOL = ZERO
 12726        MOVE CERTNOI             TO PCERTNOI
 12727        MOVE CERTNOL             TO PCERTNOL
 12728        MOVE AL-UANON            TO PCERTNOA
 12729     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 239
* EL130.cbl
 12730        MOVE AL-UANON            TO PCERTNOA
 12731     END-IF.
 12732
 12733     IF PSUFXL = ZERO
 12734        MOVE SUFXI               TO PSUFXI
 12735        MOVE SUFXL               TO PSUFXL
 12736        MOVE AL-UANON            TO PSUFXA
 12737     ELSE
 12738        MOVE AL-UANON            TO PSUFXA
 12739     END-IF.
 12740
 12741     IF MAINTI = 'I'
 12742         GO TO 6020-EDIT
 12743     END-IF.
 12744
 12745     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12746         MOVE -1                 TO LSTNMEL
 12747         MOVE ER-0236            TO EMI-ERROR
 12748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12749     ELSE
 12750         MOVE AL-UANON           TO LSTNMEA
 12751     END-IF.
 12752     if fstnmel not = zeros
 12753        move al-uanon            to fstnmea
 12754     end-if
 12755     IF SEXL > ZEROS
 12756        IF SEXI = 'M' OR 'F'
 12757           move al-uanon         to sexa
 12758           CONTINUE
 12759        ELSE
 12760           MOVE -1               TO SEXL
 12761           MOVE AL-UABON         TO SEXA
 12762           MOVE ER-0219          TO EMI-ERROR
 12763           PERFORM 9900-ERROR-FORMAT
 12764                                 THRU 9900-EXIT
 12765        END-IF
 12766     ELSE
 12767        IF MAINTI = 'A'
 12768           MOVE -1               TO SEXL
 12769           MOVE AL-UABON         TO SEXA
 12770           MOVE ER-0219          TO EMI-ERROR
 12771           PERFORM 9900-ERROR-FORMAT
 12772                                 THRU 9900-EXIT
 12773        END-IF
 12774     END-IF
 12775     IF SSNL GREATER THAN ZERO
 12776         MOVE SSNI TO WS-SOC-SEC-NUMBER
 12777         IF WS-SOC-SEC-NO NUMERIC AND
 12778           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 12779             NEXT SENTENCE
 12780         ELSE
 12781            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 12782               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 12783               WS-SSN-DASH2 = '-'
 12784                 NEXT SENTENCE
 12785            ELSE
 12786                 MOVE ER-0887        TO  EMI-ERROR
 12787                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 240
* EL130.cbl
 12788                 MOVE AL-UABON       TO  SSNA
 12789                 MOVE -1             TO  SSNL
 12790            END-IF
 12791        END-IF
 12792     END-IF.
 12793
 12794     IF BIRTHDTL = ZERO
 12795         GO TO 6020-EDIT
 12796     END-IF.
 12797
 12798     IF BIRTHDTL GREATER ZERO
 12799         MOVE BIRTHDTI           TO DATE-WORK
 12800         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12801         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12802         MOVE '4'                TO DC-OPTION-CODE
 12803         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12804         IF DATE-CONVERSION-ERROR
 12805             MOVE AL-UABON       TO BIRTHDTA
 12806             MOVE -1             TO BIRTHDTL
 12807             MOVE ER-0220        TO EMI-ERROR
 12808             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12809             GO TO 6020-EDIT
 12810         END-IF
 12811     END-IF.
 12812
 12813******************************************************************
 12814**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 12815**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 12816**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 12817******************************************************************
 12818
 12819     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 12820         MOVE BIRTHDTI           TO  DATE-WORK
 12821         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12822         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 12823         MOVE '4'                TO  DC-OPTION-CODE
 12824         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 12825         MOVE +0                 TO  DC-ELAPSED-MONTHS
 12826                                     DC-ELAPSED-DAYS
 12827         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12828         IF DATE-CONVERSION-ERROR
 12829             MOVE AL-UABON       TO  BIRTHDTA
 12830             MOVE -1             TO  BIRTHDTL
 12831             MOVE ER-0220        TO  EMI-ERROR
 12832             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12833             GO TO 6020-EDIT
 12834         END-IF
 12835     END-IF.
 12836
 12837     MOVE AL-UANON               TO  BIRTHDTA.
 12838     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 12839     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 12840     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 12841
 12842 6020-EDIT.
 12843     IF INCURL GREATER ZERO
 12844         MOVE INCURI             TO DATE-WORK
 12845         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 241
* EL130.cbl
 12846         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12847         MOVE '4'                TO DC-OPTION-CODE
 12848         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12849         IF DATE-CONVERSION-ERROR
 12850             MOVE AL-UABON       TO INCURA
 12851             MOVE -1             TO INCURL
 12852             MOVE ER-0222        TO EMI-ERROR
 12853             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12854         ELSE
 12855             MOVE AL-UANON       TO INCURA
 12856             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 12857             MOVE DC-BIN-DATE-1  TO WS-INCUR
 12858                                    PI-SAVE-INCUR-DT
 12859             IF WS-INCUR GREATER THAN WS-TODAY-DT
 12860                 MOVE ER-0511     TO EMI-ERROR
 12861                 MOVE -1          TO INCURL
 12862                 MOVE AL-UABON    TO INCURA
 12863                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12864             ELSE
 12865*                NEXT SENTENCE
 12866                 CONTINUE
 12867             END-IF
 12868         END-IF
 12869     ELSE
 12870         MOVE ER-0516         TO EMI-ERROR
 12871         MOVE AL-UABON        TO INCURA
 12872         MOVE -1              TO INCURL
 12873         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12874     END-IF.
 12875
 12876     IF REPORTL GREATER ZERO
 12877         MOVE REPORTI            TO DATE-WORK
 12878         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12879         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12880         MOVE '4'                TO DC-OPTION-CODE
 12881         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12882         IF DATE-CONVERSION-ERROR
 12883             MOVE AL-UABON       TO REPORTA
 12884             MOVE -1             TO REPORTL
 12885             MOVE ER-0223        TO EMI-ERROR
 12886             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12887         ELSE
 12888             MOVE AL-UANON       TO REPORTA
 12889             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 12890             MOVE DC-BIN-DATE-1  TO WS-REPORT
 12891             IF WS-REPORT GREATER THAN WS-TODAY-DT
 12892                 MOVE ER-0512     TO EMI-ERROR
 12893                 MOVE -1          TO REPORTL
 12894                 MOVE AL-UABON    TO REPORTA
 12895                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12896             ELSE
 12897*                NEXT SENTENCE
 12898                 CONTINUE
 12899             END-IF
 12900         END-IF
 12901     ELSE
 12902         MOVE ER-0517         TO EMI-ERROR
 12903         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 242
* EL130.cbl
 12904         MOVE AL-UABON        TO REPORTA
 12905         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12906     END-IF.
 12907
 12908     IF WS-REPORT NOT = LOW-VALUES
 12909         IF WS-INCUR GREATER THAN WS-REPORT
 12910             MOVE AL-UABON       TO REPORTA
 12911             MOVE -1             TO REPORTL
 12912             MOVE ER-0509        TO EMI-ERROR
 12913             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12914         END-IF
 12915     END-IF.
 12916
 12917     IF ICD1L GREATER THAN ZERO
 12918         IF (ICD1I GREATER THAN SPACES) AND
 12919            (ICD1I(4:1) NOT = '.')
 12920             IF ICD1I(4:1) = ' '
 12921                 MOVE '.' TO ICD1I(4:1)
 12922             ELSE
 12923                 IF ICD1I(8:1) = ' '
 12924                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 12925                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 12926                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 12927                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 12928                     MOVE '.'        TO ICD1I(4:1)
 12929                 END-IF
 12930             END-IF
 12931         END-IF
 12932         IF (ICD1I GREATER THAN SPACES) AND
 12933            (ICD1I(1:1) NOT > ' ' OR
 12934             ICD1I(2:1) NOT > ' ' OR
 12935             ICD1I(3:1) NOT > ' ' OR
 12936             ICD1I(4:1) NOT = '.')
 12937              MOVE ER-0992        TO  EMI-ERROR
 12938              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12939              MOVE AL-UABON       TO ICD1A
 12940              MOVE -1             TO ICD1L
 12941         END-IF
 12942     END-IF.
 12943
 12944     IF ICD2L GREATER THAN ZERO
 12945         IF (ICD2I GREATER THAN SPACES) AND
 12946            (ICD2I(4:1) NOT = '.')
 12947             IF ICD2I(4:1) = ' '
 12948                 MOVE '.' TO ICD2I(4:1)
 12949             ELSE
 12950                 IF ICD2I(8:1) = ' '
 12951                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 12952                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 12953                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 12954                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 12955                     MOVE '.'        TO ICD2I(4:1)
 12956                 END-IF
 12957             END-IF
 12958         END-IF
 12959         IF (ICD2I GREATER THAN SPACES) AND
 12960            (ICD2I(1:1) NOT > ' ' OR
 12961             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 243
* EL130.cbl
 12962             ICD2I(3:1) NOT > ' ' OR
 12963             ICD2I(4:1) NOT = '.')
 12964              MOVE ER-0992        TO  EMI-ERROR
 12965              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12966              MOVE AL-UABON       TO ICD2A
 12967              MOVE -1             TO ICD2L
 12968         END-IF
 12969     END-IF
 12970
 12971*    IF ESTENDL GREATER ZERO
 12972*        MOVE ESTENDI            TO DATE-WORK
 12973*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12974*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12975*        MOVE '4'                TO DC-OPTION-CODE
 12976*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12977*        IF DATE-CONVERSION-ERROR
 12978*            MOVE AL-UABON       TO ESTENDA
 12979*            MOVE -1             TO ESTENDL
 12980*            MOVE ER-0224        TO EMI-ERROR
 12981*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12982*        ELSE
 12983*            MOVE AL-UANON       TO ESTENDA
 12984*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 12985*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 12986*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 12987*               MOVE AL-UABON    TO ESTENDA
 12988*               MOVE -1          TO ESTENDL
 12989*               MOVE ER-0544     TO EMI-ERROR
 12990*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12991*            END-IF
 12992*        END-IF
 12993*    END-IF.
 12994*
 12995*    IF WS-ESTEND NOT = LOW-VALUES
 12996*        IF WS-INCUR GREATER THAN WS-ESTEND
 12997*            MOVE AL-UABON       TO ESTENDA
 12998*            MOVE -1             TO ESTENDL
 12999*            MOVE ER-0510        TO EMI-ERROR
 13000*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13001*        END-IF
 13002*    END-IF.
 13003
 13004     IF PRTOPTL GREATER ZERO
 13005         IF PRTOPTI NOT = 'N' AND 'L'
 13006             MOVE AL-UABON       TO PRTOPTA
 13007             MOVE -1             TO PRTOPTL
 13008             MOVE ER-0334        TO EMI-ERROR
 13009             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13010         END-IF
 13011     END-IF.
 13012
 13013     IF MANRSVL GREATER ZERO
 13014
 13015* EXEC CICS BIF DEEDIT
 13016*            FIELD   (MANRSVI)
 13017*            LENGTH  (9)
 13018*        END-EXEC
 13019     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 244
* EL130.cbl
 13020       TO DFHEIV11
 13021*    MOVE '@"L                   #   #00011874' TO DFHEIV0
 13022     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13023     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13024     MOVE X'2020233030303131383734' TO DFHEIV0(25:11)
 13025     CALL 'kxdfhei1' USING DFHEIV0,
 13026           MANRSVI,
 13027           DFHEIV11
 13028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13029         IF MANRSVI NOT NUMERIC
 13030             MOVE AL-UNBON       TO MANRSVA
 13031             MOVE -1             TO MANRSVL
 13032             MOVE ER-0489        TO EMI-ERROR
 13033             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13034         ELSE
 13035             MOVE AL-UNNON       TO MANRSVA
 13036             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 13037         END-IF
 13038     END-IF.
 13039
 13040     MOVE SPACES                 TO ELCNTL-KEY.
 13041
 13042     IF CONTROL-IS-ACTUAL-CARRIER
 13043         MOVE PI-CARRIER         TO CNTL-CARRIER
 13044     ELSE
 13045         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13046     END-IF.
 13047
 13048     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13049     MOVE '6'                    TO CNTL-REC-TYPE.
 13050     MOVE +0                     TO CNTL-SEQ-NO.
 13051
 13052
 13053
 13054* EXEC CICS HANDLE CONDITION
 13055*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13056*    END-EXEC.
 13057*    MOVE '"$I                   ! ? #00011902' TO DFHEIV0
 13058     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13060     MOVE X'3F20233030303131393032' TO DFHEIV0(25:11)
 13061     CALL 'kxdfhei1' USING DFHEIV0
 13062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13063
 13064
 13065     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13066
 13067     IF NOT CF-MANUAL-RESERVES-USED AND
 13068           WS-MANRSV GREATER ZERO
 13069         MOVE ER-0518             TO EMI-ERROR
 13070         MOVE -1                  TO MANRSVL
 13071         MOVE AL-UNBON            TO MANRSVA
 13072         MOVE ZEROS               TO WS-MANRSV
 13073         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13074     END-IF.
 13075
 13076     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13077     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 245
* EL130.cbl
 13078
 13079     IF SUPVL GREATER ZERO
 13080         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13081             MOVE -1             TO SUPVL
 13082             MOVE AL-UABON       TO SUPVA
 13083             MOVE ER-0230        TO EMI-ERROR
 13084             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13085         ELSE
 13086             MOVE AL-UANON       TO SUPVA
 13087         END-IF
 13088     END-IF.
 13089
 13090     IF PROCCDL = ZERO
 13091        GO TO 6050-CONTINUE-EDITS
 13092     END-IF.
 13093
 13094     MOVE SPACES                 TO ELCNTL-KEY.
 13095     MOVE PROCCDI                TO CNTL-ACCESS.
 13096
 13097     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13098     MOVE '2'                    TO CNTL-REC-TYPE.
 13099     MOVE +0                     TO CNTL-SEQ-NO.
 13100
 13101
 13102
 13103* EXEC CICS HANDLE CONDITION
 13104*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13105*    END-EXEC.
 13106*    MOVE '"$I                   ! @ #00011943' TO DFHEIV0
 13107     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13108     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13109     MOVE X'4020233030303131393433' TO DFHEIV0(25:11)
 13110     CALL 'kxdfhei1' USING DFHEIV0
 13111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13112
 13113
 13114     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13115
 13116     GO TO 6050-CONTINUE-EDITS.
 13117
 13118 6040-NO-PROCESSOR-RECORD.
 13119     MOVE ER-0019                TO EMI-ERROR.
 13120     MOVE -1                     TO PROCCDL.
 13121     MOVE AL-UABON               TO PROCCDA.
 13122     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13123
 13124 6050-CONTINUE-EDITS.
 13125     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13126           GO TO 6070-CONTINUE-EDITS
 13127     END-IF.
 13128
 13129     MOVE BENECDI                TO BENE-CODE.
 13130     MOVE 'B'                    TO BENE-RCD-TYPE.
 13131     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13132
 13133
 13134
 13135* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 246
* EL130.cbl
 13136*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13137*    END-EXEC.
 13138*    MOVE '"$I                   ! A #00011967' TO DFHEIV0
 13139     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13141     MOVE X'4120233030303131393637' TO DFHEIV0(25:11)
 13142     CALL 'kxdfhei1' USING DFHEIV0
 13143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13144
 13145
 13146
 13147* EXEC CICS READ
 13148*         DATASET   (ELBENE-DSID)
 13149*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13150*         RIDFLD    (ELBENE-KEY)
 13151*    END-EXEC.
 13152*    MOVE '&"S        E          (   #00011971' TO DFHEIV0
 13153     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13154     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13155     MOVE X'2020233030303131393731' TO DFHEIV0(25:11)
 13156     CALL 'kxdfhei1' USING DFHEIV0,
 13157           ELBENE-DSID,
 13158           DFHEIV20,
 13159           DFHEIV99,
 13160           ELBENE-KEY,
 13161           DFHEIV99,
 13162           DFHEIV99,
 13163           DFHEIV99
 13164     SET ADDRESS OF BENEFICIARY-MASTER TO
 13165         DFHEIV20
 13166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13167
 13168
 13169     GO TO 6070-CONTINUE-EDITS.
 13170
 13171 6060-NO-BENEFICIARY-RECORD.
 13172     MOVE ER-0565                TO EMI-ERROR.
 13173     MOVE -1                     TO BENECDL.
 13174     MOVE AL-UABON               TO BENECDA.
 13175     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13176
 13177
 13178 6070-CONTINUE-EDITS.
 13179     IF CERTMTL GREATER ZERO
 13180         IF CERTMTI NOT = 'A' AND 'S'
 13181             MOVE -1             TO CERTMTL
 13182             MOVE AL-UABON       TO CERTMTA
 13183             MOVE ER-0267        TO EMI-ERROR
 13184             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13185         ELSE
 13186             MOVE AL-UANON       TO CERTMTA
 13187         END-IF
 13188     ELSE
 13189         GO TO 6000-EXIT
 13190     END-IF.
 13191
 13192     IF EFFDTL GREATER ZERO
 13193         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 247
* EL130.cbl
 13194         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13195         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13196         MOVE '4'                TO DC-OPTION-CODE
 13197         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13198         IF DATE-CONVERSION-ERROR
 13199             MOVE AL-UABON       TO EFFDTA
 13200             MOVE -1             TO EFFDTL
 13201             MOVE ER-0231        TO EMI-ERROR
 13202             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13203         ELSE
 13204             MOVE AL-UANON       TO EFFDTA
 13205             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13206             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13207         END-IF
 13208     ELSE
 13209         MOVE ER-0231            TO EMI-ERROR
 13210         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13211         MOVE -1                 TO EFFDTL
 13212         MOVE AL-UABON           TO EFFDTA
 13213     END-IF.
 13214
 13215     IF ACCOUNTL = ZERO
 13216         MOVE ER-0232            TO EMI-ERROR
 13217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13218         MOVE AL-UABON           TO ACCOUNTA
 13219         MOVE -1                 TO ACCOUNTL
 13220     ELSE
 13221         MOVE AL-UANON           TO ACCOUNTA
 13222     END-IF.
 13223
 13224     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13225        (STATEL = ZERO)
 13226         MOVE ER-0233        TO EMI-ERROR
 13227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13228         MOVE AL-UABON       TO STATEA
 13229         MOVE -1             TO STATEL
 13230     ELSE
 13231         MOVE AL-UANON       TO STATEA
 13232     END-IF.
 13233
 13234     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13235        (CRTCARRL = ZERO)
 13236         MOVE ER-0234        TO EMI-ERROR
 13237         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13238         MOVE AL-UABON       TO CRTCARRA
 13239         MOVE -1             TO CRTCARRL
 13240     ELSE
 13241         MOVE AL-UANON       TO CRTCARRA
 13242     END-IF.
 13243
 13244     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13245        GROUPL = ZERO
 13246         MOVE ER-0235            TO EMI-ERROR
 13247         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13248         MOVE AL-UABON           TO GROUPA
 13249         MOVE -1                 TO GROUPL
 13250     ELSE
 13251         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 248
* EL130.cbl
 13252     END-IF.
 13253
 13254     IF CRTLNMEL = ZERO
 13255         IF LSTNMEI = SPACES OR LOW-VALUES
 13256             MOVE ER-0236            TO  EMI-ERROR
 13257             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13258             MOVE AL-UABON           TO  CRTLNMEA
 13259             MOVE -1                 TO  CRTLNMEL
 13260         ELSE
 13261             MOVE LSTNMEI            TO  CRTLNMEI
 13262             MOVE AL-UANON           TO  CRTLNMEA
 13263         END-IF
 13264     ELSE
 13265         MOVE AL-UANON               TO  CRTLNMEA
 13266     END-IF.
 13267
 13268     IF CRTFNMEL = ZERO
 13269         IF FSTNMEI = SPACES OR LOW-VALUES
 13270*            NEXT SENTENCE
 13271             CONTINUE
 13272         ELSE
 13273             MOVE FSTNMEI            TO  CRTFNMEI
 13274             MOVE AL-UANON           TO  CRTFNMEA
 13275         END-IF
 13276     END-IF.
 13277
 13278     IF CRTINITL = ZERO
 13279         IF INITI = SPACES OR LOW-VALUES
 13280*            NEXT SENTENCE
 13281             CONTINUE
 13282         ELSE
 13283             MOVE INITI              TO  CRTINITI
 13284             MOVE AL-UANON           TO  CRTINITA
 13285         END-IF
 13286     END-IF.
 13287
 13288 6000-EXIT.
 13289     EXIT.
 13290
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 249
* EL130.cbl
 13292 6200-EDIT-CERT-DATA.
 13293     IF ISSAGEL GREATER ZERO
 13294         IF ISSAGEI NOT NUMERIC
 13295             MOVE ER-0237        TO EMI-ERROR
 13296             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13297             MOVE -1             TO ISSAGEL
 13298             MOVE AL-UNBON       TO ISSAGEA
 13299         ELSE
 13300             MOVE AL-UNNON       TO ISSAGEA
 13301         END-IF
 13302     END-IF.
 13303
 13304     IF JNTAGEL GREATER ZERO
 13305         IF JNTAGEI NOT NUMERIC
 13306             MOVE ER-0238        TO EMI-ERROR
 13307             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13308             MOVE -1             TO JNTAGEL
 13309             MOVE AL-UNBON       TO JNTAGEA
 13310         ELSE
 13311             MOVE AL-UNNON       TO JNTAGEA
 13312         END-IF
 13313     END-IF.
 13314
 13315     IF LCVCDL GREATER ZERO
 13316         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13317         IF INVALID-BENEFIT-CODE
 13318             MOVE ER-7635        TO EMI-ERROR
 13319             MOVE -1             TO LCVCDL
 13320             MOVE AL-UABON       TO LCVCDA
 13321             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13322         ELSE
 13323             MOVE LCVCDI         TO WS-BEN-HOLD
 13324             MOVE '4'            TO WS-REC-TYPE
 13325             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13326             IF WS-BEN-ALPHA-HOLD = SPACES
 13327                MOVE ER-7635     TO EMI-ERROR
 13328                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13329                MOVE -1          TO LCVCDL
 13330                MOVE AL-UABON    TO LCVCDA
 13331             ELSE
 13332                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13333                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13334                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13335                MOVE AL-UANON           TO LCVCDA
 13336             END-IF
 13337         END-IF
 13338     END-IF.
 13339
 13340     IF ACVCDL GREATER ZERO
 13341         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13342         IF INVALID-BENEFIT-CODE
 13343             MOVE ER-7635        TO EMI-ERROR
 13344             MOVE -1             TO ACVCDL
 13345             MOVE AL-UABON       TO ACVCDA
 13346             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13347         ELSE
 13348             MOVE ACVCDI         TO WS-BEN-HOLD
 13349             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 250
* EL130.cbl
 13350             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13351             IF WS-BEN-ALPHA-HOLD = SPACES
 13352                MOVE ER-7635     TO EMI-ERROR
 13353                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13354                MOVE -1          TO ACVCDL
 13355                MOVE AL-UABON    TO ACVCDA
 13356             ELSE
 13357                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13358                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13359                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13360                MOVE AL-UANON           TO ACVCDA
 13361             END-IF
 13362         END-IF
 13363     END-IF.
 13364
 13365     IF LCVOTRML GREATER ZERO
 13366         IF LCVOTRMI NOT NUMERIC
 13367             MOVE ER-7636        TO EMI-ERROR
 13368             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13369             MOVE -1             TO LCVOTRML
 13370             MOVE AL-UNBON       TO LCVOTRMA
 13371         ELSE
 13372             MOVE AL-UNNON       TO LCVOTRMA
 13373         END-IF
 13374     END-IF.
 13375
 13376     IF ACVOTRML GREATER ZERO
 13377         IF ACVOTRMI NOT NUMERIC
 13378             MOVE ER-7636        TO EMI-ERROR
 13379             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13380             MOVE -1             TO ACVOTRML
 13381             MOVE AL-UNBON       TO ACVOTRMA
 13382         ELSE
 13383             MOVE AL-UNNON       TO ACVOTRMA
 13384         END-IF
 13385     END-IF.
 13386
 13387     IF LCVRATEL GREATER ZERO
 13388
 13389* EXEC CICS BIF DEEDIT
 13390*            FIELD    (LCVRATEI)
 13391*            LENGTH   (06)
 13392*        END-EXEC
 13393     MOVE 06
 13394       TO DFHEIV11
 13395*    MOVE '@"L                   #   #00012196' TO DFHEIV0
 13396     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13397     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13398     MOVE X'2020233030303132313936' TO DFHEIV0(25:11)
 13399     CALL 'kxdfhei1' USING DFHEIV0,
 13400           LCVRATEI,
 13401           DFHEIV11
 13402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13403         IF LCVRATEI NOT NUMERIC
 13404             MOVE AL-UNBON       TO LCVRATEA
 13405             MOVE -1             TO LCVRATEL
 13406             MOVE ER-2280        TO EMI-ERROR
 13407             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 251
* EL130.cbl
 13408         ELSE
 13409             MOVE AL-UNNON       TO LCVRATEA
 13410             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13411         END-IF
 13412     END-IF.
 13413
 13414     IF ACVRATEL GREATER ZERO
 13415
 13416* EXEC CICS BIF DEEDIT
 13417*            FIELD    (ACVRATEI)
 13418*            LENGTH   (06)
 13419*        END-EXEC
 13420     MOVE 06
 13421       TO DFHEIV11
 13422*    MOVE '@"L                   #   #00012212' TO DFHEIV0
 13423     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13424     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13425     MOVE X'2020233030303132323132' TO DFHEIV0(25:11)
 13426     CALL 'kxdfhei1' USING DFHEIV0,
 13427           ACVRATEI,
 13428           DFHEIV11
 13429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13430         IF ACVRATEI NOT NUMERIC
 13431             MOVE AL-UNBON       TO ACVRATEA
 13432             MOVE -1             TO ACVRATEL
 13433             MOVE ER-2280        TO EMI-ERROR
 13434             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13435         ELSE
 13436             MOVE AL-UNNON       TO ACVRATEA
 13437             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13438         END-IF
 13439     END-IF.
 13440
 13441     IF LCVBENEL GREATER ZERO
 13442
 13443* EXEC CICS BIF DEEDIT
 13444*            FIELD    (LCVBENEI)
 13445*            LENGTH   (11)
 13446*        END-EXEC
 13447     MOVE 11
 13448       TO DFHEIV11
 13449*    MOVE '@"L                   #   #00012228' TO DFHEIV0
 13450     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13451     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13452     MOVE X'2020233030303132323238' TO DFHEIV0(25:11)
 13453     CALL 'kxdfhei1' USING DFHEIV0,
 13454           LCVBENEI,
 13455           DFHEIV11
 13456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13457         IF LCVBENEI NOT NUMERIC
 13458             MOVE AL-UNBON       TO LCVBENEA
 13459             MOVE -1             TO LCVBENEL
 13460             MOVE ER-7637        TO EMI-ERROR
 13461             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13462         ELSE
 13463             MOVE AL-UNNON       TO LCVBENEA
 13464             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13465         END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 252
* EL130.cbl
 13466     END-IF.
 13467
 13468     IF ACVBENEL GREATER ZERO
 13469
 13470* EXEC CICS BIF DEEDIT
 13471*            FIELD    (ACVBENEI)
 13472*            LENGTH   (11)
 13473*        END-EXEC
 13474     MOVE 11
 13475       TO DFHEIV11
 13476*    MOVE '@"L                   #   #00012244' TO DFHEIV0
 13477     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13478     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13479     MOVE X'2020233030303132323434' TO DFHEIV0(25:11)
 13480     CALL 'kxdfhei1' USING DFHEIV0,
 13481           ACVBENEI,
 13482           DFHEIV11
 13483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13484         IF ACVBENEI NOT NUMERIC
 13485             MOVE AL-UNBON       TO ACVBENEA
 13486             MOVE -1             TO ACVBENEL
 13487             MOVE ER-7637        TO EMI-ERROR
 13488             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13489         ELSE
 13490             MOVE AL-UNNON       TO ACVBENEA
 13491             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13492         END-IF
 13493     END-IF.
 13494
 13495     IF LCVCNDTL GREATER ZERO
 13496         IF LCVCNDTI NOT = SPACES
 13497             MOVE LCVCNDTI        TO DATE-WORK
 13498             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13499             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13500             MOVE '4'             TO DC-OPTION-CODE
 13501             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13502             IF DATE-CONVERSION-ERROR
 13503                 MOVE AL-UABON    TO LCVCNDTA
 13504                 MOVE -1          TO LCVCNDTL
 13505                 MOVE ER-7638     TO EMI-ERROR
 13506                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13507             ELSE
 13508                 MOVE AL-UANON    TO LCVCNDTA
 13509                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13510                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13511             END-IF
 13512         END-IF
 13513     END-IF.
 13514
 13515     IF ACVCNDTL GREATER ZERO
 13516         IF ACVCNDTI NOT = SPACES
 13517             MOVE ACVCNDTI        TO DATE-WORK
 13518             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13519             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13520             MOVE '4'             TO DC-OPTION-CODE
 13521             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13522             IF DATE-CONVERSION-ERROR
 13523                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 253
* EL130.cbl
 13524                 MOVE -1          TO ACVCNDTL
 13525                 MOVE ER-7638     TO EMI-ERROR
 13526                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13527             ELSE
 13528                 MOVE AL-UANON    TO ACVCNDTA
 13529                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13530                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13531             END-IF
 13532         END-IF
 13533     END-IF.
 13534
 13535     IF ADDONDTL GREATER ZERO
 13536         MOVE ADDONDTI        TO DATE-WORK
 13537         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13538         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13539         MOVE '4'             TO DC-OPTION-CODE
 13540         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13541         IF DATE-CONVERSION-ERROR
 13542             MOVE AL-UABON    TO ADDONDTA
 13543             MOVE -1          TO ADDONDTL
 13544             MOVE ER-7651     TO EMI-ERROR
 13545             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13546         ELSE
 13547             MOVE AL-UANON    TO ADDONDTA
 13548             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13549             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13550         END-IF
 13551     END-IF.
 13552
 13553     IF APRL GREATER ZERO
 13554
 13555* EXEC CICS BIF DEEDIT
 13556*            FIELD    (APRI)
 13557*            LENGTH   (8)
 13558*        END-EXEC
 13559     MOVE 8
 13560       TO DFHEIV11
 13561*    MOVE '@"L                   #   #00012318' TO DFHEIV0
 13562     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13563     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13564     MOVE X'2020233030303132333138' TO DFHEIV0(25:11)
 13565     CALL 'kxdfhei1' USING DFHEIV0,
 13566           APRI,
 13567           DFHEIV11
 13568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13569         IF APRI NOT NUMERIC
 13570             MOVE AL-UNBON       TO APRA
 13571             MOVE -1             TO APRL
 13572             MOVE ER-0248        TO EMI-ERROR
 13573             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13574         ELSE
 13575             MOVE AL-UNNON       TO APRA
 13576             MOVE APRI           TO WS-APR APRO
 13577         END-IF
 13578     END-IF.
 13579
 13580     IF PMTFREQL GREATER ZERO
 13581
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 254
* EL130.cbl
 13582* EXEC CICS BIF DEEDIT
 13583*            FIELD   (PMTFREQI)
 13584*            LENGTH  (2)
 13585*        END-EXEC
 13586     MOVE 2
 13587       TO DFHEIV11
 13588*    MOVE '@"L                   #   #00012334' TO DFHEIV0
 13589     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13590     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13591     MOVE X'2020233030303132333334' TO DFHEIV0(25:11)
 13592     CALL 'kxdfhei1' USING DFHEIV0,
 13593           PMTFREQI,
 13594           DFHEIV11
 13595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13596         IF PMTFREQI NOT NUMERIC
 13597             MOVE -1             TO PMTFREQL
 13598             MOVE AL-UNBON       TO PMTFREQA
 13599             MOVE ER-0258        TO EMI-ERROR
 13600             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13601         ELSE
 13602             MOVE AL-UNNON       TO PMTFREQA
 13603             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13604         END-IF
 13605     END-IF.
 13606
 13607     IF INDGRPL GREATER ZERO
 13608         IF INDGRPI = 'I' OR 'G'
 13609             MOVE AL-UANON       TO INDGRPA
 13610         ELSE
 13611             MOVE -1 TO INDGRPL
 13612             MOVE AL-UABON       TO INDGRPA
 13613             MOVE ER-0260        TO EMI-ERROR
 13614             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13615         END-IF
 13616     END-IF.
 13617
 13618     IF LOANBALL GREATER ZERO
 13619         MOVE LOANBALI           TO DEEDIT-FIELD
 13620
 13621* EXEC CICS BIF DEEDIT
 13622*            FIELD   (DEEDIT-FIELD)
 13623*            LENGTH  (12)
 13624*        END-EXEC
 13625     MOVE 12
 13626       TO DFHEIV11
 13627*    MOVE '@"L                   #   #00012362' TO DFHEIV0
 13628     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13629     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13630     MOVE X'2020233030303132333632' TO DFHEIV0(25:11)
 13631     CALL 'kxdfhei1' USING DFHEIV0,
 13632           DEEDIT-FIELD,
 13633           DFHEIV11
 13634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13635         IF DEEDIT-FIELD NOT NUMERIC
 13636             MOVE AL-UNBON       TO LOANBALA
 13637             MOVE -1             TO LOANBALL
 13638             MOVE ER-0247        TO EMI-ERROR
 13639             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 255
* EL130.cbl
 13640         ELSE
 13641             MOVE AL-UNNON       TO LOANBALA
 13642             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13643         END-IF
 13644     END-IF.
 13645
 13646     IF PREMTYPL GREATER ZERO
 13647         IF (PREMTYPI = '1' OR '2' OR '3')
 13648             MOVE AL-UANON       TO PREMTYPA
 13649         ELSE
 13650             MOVE -1             TO PREMTYPL
 13651             MOVE AL-UABON       TO PREMTYPA
 13652             MOVE ER-0227        TO EMI-ERROR
 13653             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13654         END-IF
 13655     END-IF.
 13656
 13657     IF REINCDL GREATER ZERO
 13658         MOVE LOW-VALUES         TO  ERREIN-KEY
 13659         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13660         MOVE REINCDI            TO  REIN-CODE-1
 13661                                     REIN-CODE-2
 13662                                     REIN-CODE-3
 13663         MOVE 'A'                TO  REIN-TYPE
 13664         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13665         IF REIN-REC-NOT-FOUND
 13666             MOVE ER-0266        TO  EMI-ERROR
 13667             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13668             MOVE -1             TO  REINCDL
 13669             MOVE AL-UABON       TO  REINCDA
 13670         ELSE
 13671             MOVE AL-UANON       TO  REINCDA
 13672         END-IF
 13673     END-IF.
 13674
 13675     IF CERTMTI NOT = 'A'
 13676        GO TO 6200-EXIT
 13677     END-IF.
 13678
 13679     IF PREMTYPI = '1'
 13680         IF LCVCDL GREATER ZERO
 13681             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13682                 MOVE ER-0841        TO  EMI-ERROR
 13683                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13684                 MOVE -1             TO  PREMTYPL
 13685                 MOVE AL-UABON       TO  PREMTYPA
 13686             END-IF
 13687         END-IF
 13688     END-IF.
 13689
 13690     IF PREMTYPI = '1'
 13691         IF ACVCDL GREATER ZERO
 13692             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13693                 MOVE ER-0841        TO  EMI-ERROR
 13694                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13695                 MOVE -1             TO  PREMTYPL
 13696                 MOVE AL-UABON       TO  PREMTYPA
 13697             END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 256
* EL130.cbl
 13698         END-IF
 13699     END-IF.
 13700
 13701     IF PREMTYPI = '2'
 13702         IF LCVCDL GREATER ZERO
 13703             IF (PI-COMPANY-ID = 'HAN') AND
 13704                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13705                        OR
 13706                 WS-LF-SPECIAL-CALC-CD = 'O'
 13707*                NEXT SENTENCE
 13708                 CONTINUE
 13709             ELSE
 13710                 MOVE ER-0840        TO  EMI-ERROR
 13711                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13712                 MOVE -1             TO  PREMTYPL
 13713                 MOVE AL-UABON       TO  PREMTYPA
 13714             END-IF
 13715         END-IF
 13716     END-IF.
 13717
 13718     IF PREMTYPI = '2'
 13719         IF ACVCDL GREATER ZERO
 13720             IF (PI-COMPANY-ID = 'HAN')  AND
 13721                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13722                        OR
 13723                 WS-AH-SPECIAL-CALC-CD = 'O'
 13724*                NEXT SENTENCE
 13725                 CONTINUE
 13726             ELSE
 13727                 MOVE ER-0840        TO  EMI-ERROR
 13728                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13729                 MOVE -1             TO  PREMTYPL
 13730                 MOVE AL-UABON       TO  PREMTYPA
 13731             END-IF
 13732         END-IF
 13733     END-IF.
 13734
 13735     IF LCVCDL = ZEROS
 13736        GO TO 6200-EXIT
 13737     END-IF.
 13738
 13739     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13740         IF PMTFREQI NOT = ZEROS
 13741             MOVE ER-0428        TO EMI-ERROR
 13742             MOVE -1             TO PMTFREQL
 13743             MOVE AL-UNBON       TO PMTFREQA
 13744             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13745             GO TO 6200-CHECK-APR
 13746         END-IF
 13747     END-IF.
 13748
 13749     IF PMTFREQL = ZEROS AND TEX-REG
 13750         MOVE ER-0429            TO EMI-ERROR
 13751         MOVE -1                 TO PMTFREQL
 13752         MOVE AL-UNBON           TO PMTFREQA
 13753         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13754         GO TO 6200-CHECK-APR
 13755     END-IF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 257
* EL130.cbl
 13756
 13757     IF LCVOTRMI NOT NUMERIC
 13758         GO TO 6200-CHECK-APR
 13759     END-IF.
 13760
 13761     IF WS-PMTFREQ NOT = ZERO
 13762         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 13763         GIVING DIVIDE-QUOT
 13764         REMAINDER DIVIDE-REM
 13765         IF DIVIDE-REM GREATER ZERO
 13766             MOVE ER-0430            TO EMI-ERROR
 13767             MOVE -1                 TO PMTFREQL
 13768             MOVE AL-UNBON           TO PMTFREQA
 13769             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13770         END-IF
 13771     END-IF.
 13772
 13773 6200-CHECK-APR.
 13774     IF NET-PAY AND APRL = ZEROS
 13775        MOVE ER-0257             TO EMI-ERROR
 13776        MOVE -1                  TO APRL
 13777        MOVE AL-UABON            TO APRA
 13778        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13779     END-IF.
 13780
 13781 6200-EXIT.
 13782     EXIT.
 13783
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 258
* EL130.cbl
 13785 6300-REQUIRED-CERT-EDIT.
 13786
 13787     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 13788        GO TO 6300-REQUIRED-AH-EDIT
 13789     END-IF
 13790
 13791     IF LCVCDL = ZERO
 13792        MOVE ER-7639             TO EMI-ERROR
 13793        MOVE -1                  TO LCVCDL
 13794        MOVE AL-UABON            TO LCVCDA
 13795        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13796     END-IF.
 13797
 13798     IF LCVOTRML = ZERO
 13799        MOVE ER-7670             TO EMI-ERROR
 13800        MOVE -1                  TO LCVOTRML
 13801        MOVE AL-UNBON            TO LCVOTRMA
 13802        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13803     END-IF.
 13804
 13805     IF LCVBENEL = ZERO
 13806        MOVE ER-7671             TO EMI-ERROR
 13807        MOVE -1                  TO LCVBENEL
 13808        MOVE AL-UNBON            TO LCVBENEA
 13809        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13810     END-IF.
 13811
 13812     GO TO 6399-EXIT.
 13813
 13814 6300-REQUIRED-AH-EDIT.
 13815
 13816     IF ACVCDL = ZERO
 13817        MOVE ER-7639             TO EMI-ERROR
 13818        MOVE -1                  TO ACVCDL
 13819        MOVE AL-UABON            TO ACVCDA
 13820        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13821     END-IF.
 13822
 13823     IF ACVOTRML = ZERO
 13824         MOVE ER-7670             TO EMI-ERROR
 13825         MOVE -1                  TO ACVOTRML
 13826         MOVE AL-UNBON            TO ACVOTRMA
 13827         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13828     END-IF.
 13829
 13830     IF ACVBENEL = ZERO
 13831        MOVE ER-7671             TO EMI-ERROR
 13832        MOVE -1                  TO ACVBENEL
 13833        MOVE AL-UNBON            TO ACVBENEA
 13834        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13835     END-IF.
 13836
 13837 6399-EXIT.
 13838      EXIT.
 13839
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 259
* EL130.cbl
 13841 6400-TEST-CLAIM-REASONABILITY.
 13842
 13843     IF WS-INCUR = LOW-VALUES
 13844        GO TO 6499-EXIT
 13845     END-IF.
 13846
 13847     IF WS-EFFDT NOT = LOW-VALUES
 13848         IF WS-INCUR LESS WS-EFFDT
 13849             MOVE ER-0458          TO EMI-ERROR
 13850             MOVE -1               TO INCURL
 13851             MOVE AL-UABON         TO INCURA
 13852             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13853         END-IF
 13854     END-IF.
 13855
 13856     IF CERTMTI = 'A'
 13857        GO TO 6460-TEST-NEW-CERT
 13858     END-IF.
 13859
 13860     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 13861     MOVE CRTCARRI               TO CERT-CARRIER.
 13862     MOVE GROUPI                 TO CERT-GROUPING.
 13863     MOVE STATEI                 TO CERT-STATE.
 13864     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 13865     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 13866     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 13867
 13868
 13869
 13870* EXEC CICS HANDLE CONDITION
 13871*         DUPKEY   (6499-EXIT)
 13872*         NOTFND   (6499-EXIT)
 13873*    END-EXEC.
 13874*    MOVE '"$$I                  ! B #00012600' TO DFHEIV0
 13875     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 13876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13877     MOVE X'4220233030303132363030' TO DFHEIV0(25:11)
 13878     CALL 'kxdfhei1' USING DFHEIV0
 13879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13880
 13881
 13882     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 13883
 13884     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 13885        'I' OR 'G' OR 'F')
 13886        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13887     ELSE
 13888        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13889     END-IF.
 13890
 13891     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13892     MOVE '6'                    TO DC-OPTION-CODE.
 13893     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13894
 13895     IF (WS-INCUR GREATER THAN DC-BIN-DATE-2)
 13896        and (dc-elapsed-months > zeros)
 13897        MOVE ER-0519             TO EMI-ERROR
 13898        MOVE -1                  TO INCURL
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 260
* EL130.cbl
 13899        MOVE AL-UABON            TO INCURA
 13900        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13901     END-IF.
 13902
 13903     IF CLMCARRI NOT = CRTCARRI
 13904        MOVE ER-0562             TO EMI-ERROR
 13905        MOVE AL-UABON            TO CLMCARRA
 13906        MOVE -1                  TO CLMCARRL
 13907        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13908     END-IF.
 13909
 13910     if (pi-company-id = 'DCC')
 13911        and (ws-dcc-product-code <> spaces)
 13912        continue
 13913     else
 13914      IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F') AND
 13915        CM-AH-BENEFIT-CD = '00')
 13916                  OR
 13917        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13918        CM-LF-BENEFIT-CD = '00')
 13919         MOVE ER-0521         TO EMI-ERROR
 13920         MOVE AL-UABON        TO CLMTYPEA
 13921         MOVE -1              TO CLMTYPEL
 13922         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13923      END-IF
 13924     end-if
 13925*    IF CLMTYPEI = 'I' AND
 13926*       CM-AH-CRITICAL-PERIOD = +0
 13927*        MOVE ER-0521         TO EMI-ERROR
 13928*        MOVE AL-UABON        TO CLMTYPEA
 13929*        MOVE -1              TO CLMTYPEL
 13930*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13931*    END-IF
 13932
 13933*    IF PI-COMPANY-ID = 'CRI'
 13934*        IF MAINTI = 'A'
 13935*            IF CERT-PEND-ISSUE-ERROR  OR
 13936*               CERT-PEND-ISSUE-RETURNED
 13937*                MOVE -1                 TO CERTNOL
 13938*                MOVE AL-UABON           TO CERTNOA
 13939*                MOVE ER-7640            TO EMI-ERROR
 13940*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13941*            END-IF
 13942*        END-IF
 13943*    END-IF.
 13944
 13945     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 13946         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 13947         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 13948             GO TO 6450-DATE-ERROR
 13949         END-IF
 13950     END-IF.
 13951
 13952     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 13953         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 13954         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 13955             GO TO 6450-DATE-ERROR
 13956         END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 261
* EL130.cbl
 13957     END-IF.
 13958
 13959     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13960         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 13961             GO TO 6450-DATE-ERROR
 13962         END-IF
 13963     END-IF.
 13964
 13965     GO TO 6499-EXIT.
 13966
 13967 6450-DATE-ERROR.
 13968     MOVE ER-0520                TO EMI-ERROR.
 13969     MOVE -1                     TO INCURL.
 13970     MOVE AL-UABON               TO INCURA.
 13971     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13972
 13973*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 13974*       (EMI-SEVERITY-SAVE = 'X')
 13975*        ADD 1                TO EMI-FORCABLE-CTR
 13976*        SUBTRACT 1 FROM EMI-FATAL-CTR
 13977*    END-IF.
 13978
 13979     GO TO 6499-EXIT.
 13980
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 262
* EL130.cbl
 13982 6460-TEST-NEW-CERT.
 13983
 13984     IF NOT EMI-NO-ERRORS
 13985        GO TO 6499-EXIT
 13986     END-IF.
 13987
 13988     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 13989
 13990     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13991          OR 'F') AND
 13992         ACVOTRML GREATER ZERO)
 13993        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 13994     END-IF.
 13995
 13996     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13997         LCVOTRML GREATER ZERO
 13998        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 13999     END-IF.
 14000
 14001     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 14002
 14003*    IF PI-COMPANY-ID = 'HAN'
 14004*        IF ADDONDTL GREATER ZERO
 14005*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 14006*            IF CLMTYPEI = 'A'
 14007*                IF ACVOTRMI NOT = ZEROS
 14008*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 14009*                ELSE
 14010*                    NEXT SENTENCE
 14011*                    CONTINUE
 14012*                END-IF
 14013*            ELSE
 14014*                IF LCVOTRMI NOT = ZEROS
 14015*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 14016*                END-IF
 14017*            END-IF
 14018*        END-IF
 14019*    END-IF.
 14020
 14021     MOVE '6'                    TO DC-OPTION-CODE.
 14022     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14023
 14024     IF NO-CONVERSION-ERROR
 14025         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 14026     END-IF.
 14027
 14028     IF WS-INCUR GREATER THAN WS-EXPIRE
 14029        MOVE ER-0519             TO EMI-ERROR
 14030        MOVE -1                  TO INCURL
 14031        MOVE AL-UABON            TO INCURA
 14032        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14033     END-IF.
 14034
 14035     IF CLMCARRI NOT = CRTCARRI
 14036        MOVE ER-0562             TO EMI-ERROR
 14037        MOVE AL-UABON            TO CLMCARRA
 14038        MOVE -1                  TO CLMCARRL
 14039        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 263
* EL130.cbl
 14040     END-IF.
 14041
 14042     if (pi-company-id = 'DCC')
 14043        and (ws-dcc-product-code <> spaces)
 14044        continue
 14045     else
 14046        IF (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 14047           and (ACVCDL = ZEROS)
 14048           MOVE ER-0521          TO EMI-ERROR
 14049           MOVE AL-UABON         TO CLMTYPEA
 14050           MOVE -1               TO CLMTYPEL
 14051           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14052        END-IF
 14053     end-if
 14054
 14055     if (pi-company-id = 'DCC')
 14056        and (ws-dcc-product-code <> spaces)
 14057        continue
 14058     else
 14059        IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14060           and (LCVCDL = ZEROS)
 14061           MOVE ER-0521          TO EMI-ERROR
 14062           MOVE AL-UABON         TO CLMTYPEA
 14063           MOVE -1               TO CLMTYPEL
 14064           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14065        END-IF
 14066     end-if
 14067
 14068     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14069         IF LCVCNDTL GREATER ZERO
 14070             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14071                 GO TO 6450-DATE-ERROR
 14072             END-IF
 14073         END-IF
 14074     END-IF.
 14075
 14076     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14077         IF ACVCNDTL GREATER ZERO
 14078             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14079                 GO TO 6450-DATE-ERROR
 14080             END-IF
 14081         END-IF
 14082     END-IF.
 14083
 14084 6499-EXIT.
 14085     EXIT.
 14086 6500-get-acct.
 14087
 14088     MOVE SPACES                 TO ERACCT-KEY
 14089                                    ws-dcc-product-code
 14090                                    ws-acct-found-sw
 14091
 14092     IF CARR-GROUP-ST-ACCNT-CNTL
 14093        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14094        MOVE CRTCARRI            TO ACCT-CARRIER
 14095        MOVE GROUPI              TO ACCT-GROUPING
 14096        MOVE STATEI              TO ACCT-STATE
 14097        MOVE ACCOUNTI            TO ACCT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 264
* EL130.cbl
 14098        GO TO 6500-startbr
 14099     END-IF
 14100
 14101     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14102     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14103
 14104     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14105        MOVE STATEI             TO ACCT-STATE
 14106     END-IF
 14107
 14108     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 14109        MOVE CRTCARRI           TO ACCT-CARRIER
 14110     END-IF
 14111
 14112     .
 14113 6500-startbr.
 14114
 14115     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14116
 14117
 14118* EXEC CICS STARTBR
 14119*       DATASET     (ERACCT2-DSID)
 14120*       RIDFLD      (SAVE-ERACCT-KEY)
 14121*       GENERIC
 14122*       KEYLENGTH   (20)
 14123*       resp        (ws-response)
 14124*    END-EXEC
 14125     MOVE 20
 14126       TO DFHEIV11
 14127     MOVE 0
 14128       TO DFHEIV12
 14129*    MOVE '&,   KG    G          &  N#00012840' TO DFHEIV0
 14130     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14131     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14132     MOVE X'204E233030303132383430' TO DFHEIV0(25:11)
 14133     CALL 'kxdfhei1' USING DFHEIV0,
 14134           ERACCT2-DSID,
 14135           SAVE-ERACCT-KEY,
 14136           DFHEIV11,
 14137           DFHEIV12,
 14138           DFHEIV99
 14139     MOVE EIBRESP  TO ws-response
 14140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14141
 14142     if not ws-resp-normal
 14143        go to 6500-exit
 14144     end-if
 14145
 14146     .
 14147 6500-readnext.
 14148
 14149
 14150* EXEC CICS READNEXT
 14151*       DATASET   (ERACCT2-DSID)
 14152*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14153*       RIDFLD    (SAVE-ERACCT-KEY)
 14154*    END-EXEC
 14155     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 265
* EL130.cbl
 14156       TO DFHEIV11
 14157*    MOVE '&.S                   )   #00012855' TO DFHEIV0
 14158     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14159     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14160     MOVE X'2020233030303132383535' TO DFHEIV0(25:11)
 14161     CALL 'kxdfhei1' USING DFHEIV0,
 14162           ERACCT2-DSID,
 14163           DFHEIV20,
 14164           DFHEIV99,
 14165           SAVE-ERACCT-KEY,
 14166           DFHEIV99,
 14167           DFHEIV11,
 14168           DFHEIV99,
 14169           DFHEIV99
 14170     SET ADDRESS OF ACCOUNT-MASTER TO
 14171         DFHEIV20
 14172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14173
 14174     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14175        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14176        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14177        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14178        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14179        go to 6500-endbr
 14180     END-IF
 14181
 14182     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14183        and (WS-EFFDT < AM-EXPIRATION-DT)
 14184        set acct-found to true
 14185        MOVE AM-dcc-product-code to ws-dcc-product-code
 14186        GO TO 6500-endbr
 14187     END-IF
 14188
 14189     IF WS-EFFDT >= AM-EXPIRATION-DT
 14190         GO TO 6500-readnext
 14191     END-IF
 14192
 14193     .
 14194 6500-endbr.
 14195
 14196
 14197* EXEC CICS ENDBR
 14198*        DATASET    (ERACCT2-DSID)
 14199*    END-EXEC
 14200     MOVE 0
 14201       TO DFHEIV11
 14202*    MOVE '&2                    $   #00012883' TO DFHEIV0
 14203     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14204     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14205     MOVE X'2020233030303132383833' TO DFHEIV0(25:11)
 14206     CALL 'kxdfhei1' USING DFHEIV0,
 14207           ERACCT2-DSID,
 14208           DFHEIV11,
 14209           DFHEIV99
 14210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14211
 14212     .
 14213 6500-exit.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 266
* EL130.cbl
 14214     exit.
 14215 6600-CHECK-AUTO-ACTIVITY.
 14216
 14217
 14218* EXEC CICS HANDLE CONDITION
 14219*        NOTFND   (6600-NOT-FOUND)
 14220*    END-EXEC.
 14221*    MOVE '"$I                   ! C #00012892' TO DFHEIV0
 14222     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14224     MOVE X'4320233030303132383932' TO DFHEIV0(25:11)
 14225     CALL 'kxdfhei1' USING DFHEIV0
 14226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14227
 14228
 14229     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14230     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14231     MOVE SPACES                     TO  CNTL-ACCESS.
 14232     MOVE +0                         TO  CNTL-SEQ-NO.
 14233
 14234     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14235
 14236     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14237         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14238                                         WS-LETTER-SW
 14239         GO TO 6600-EXIT
 14240     END-IF.
 14241
 14242     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14243         MOVE 'N'                     TO  WS-LETTER-SW
 14244     ELSE
 14245         MOVE 'Y'                     TO  WS-LETTER-SW
 14246     END-IF.
 14247
 14248     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14249     GO TO 6600-EXIT.
 14250
 14251 6600-START-AUTO-LETTER-WRITER.
 14252
 14253     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14254     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14255
 14256     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14257
 14258     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14259         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14260         MOVE '6'                     TO  DC-OPTION-CODE
 14261         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14262         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14263         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14264         IF NO-CONVERSION-ERROR
 14265             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14266         ELSE
 14267             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14268         END-IF
 14269     END-IF.
 14270
 14271     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 267
* EL130.cbl
 14272         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14273         MOVE '6'                     TO  DC-OPTION-CODE
 14274         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14275         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14276         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14277         IF NO-CONVERSION-ERROR
 14278             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14279         ELSE
 14280             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14281         END-IF
 14282     END-IF.
 14283
 14284
 14285
 14286* EXEC CICS LINK
 14287*        PROGRAM    (LINK-1523)
 14288*        COMMAREA   (W-1523-LINKDATA)
 14289*        LENGTH     (W-1523-COMM-LENGTH)
 14290*    END-EXEC.
 14291*    MOVE '."C                   (   #00012952' TO DFHEIV0
 14292     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14293     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14294     MOVE X'2020233030303132393532' TO DFHEIV0(25:11)
 14295     CALL 'kxdfhei1' USING DFHEIV0,
 14296           LINK-1523,
 14297           W-1523-LINKDATA,
 14298           W-1523-COMM-LENGTH,
 14299           DFHEIV99,
 14300           DFHEIV99,
 14301           DFHEIV99,
 14302           DFHEIV99
 14303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14304
 14305
 14306     GO TO 6600-EXIT.
 14307
 14308 6600-NOT-FOUND.
 14309     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14310
 14311 6600-EXIT.
 14312     EXIT.
 14313
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 268
* EL130.cbl
 14314/
 14315*************************************************************
 14316*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14317*************************************************************
 14318
 14319 6700-OUTPUT-ACTIVITY-RECORD.
 14320
 14321
 14322
 14323* EXEC CICS GETMAIN
 14324*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14325*        LENGTH (DLYACTV-LENGTH)
 14326*        INITIMG (WS-BLANK)
 14327*    END-EXEC.
 14328*    MOVE ',"IL                  $   #00012974' TO DFHEIV0
 14329     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14330     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14331     MOVE X'2020233030303132393734' TO DFHEIV0(25:11)
 14332     CALL 'kxdfhei1' USING DFHEIV0,
 14333           DFHEIV20,
 14334           DLYACTV-LENGTH,
 14335           WS-BLANK
 14336     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14337         DFHEIV20
 14338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14339
 14340
 14341     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14342     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14343     MOVE CLMCARRI               TO DA-CARRIER.
 14344     IF CLMNOL EQUAL ZERO
 14345         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14346     ELSE
 14347         MOVE CLMNOI             TO DA-CLAIM-NO
 14348     END-IF.
 14349     MOVE CERTNOI                TO DA-CERT-PRIME.
 14350     MOVE SUFXI                  TO DA-CERT-SFX.
 14351     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14352     MOVE 'A'                    TO DA-RECORD-TYPE.
 14353
 14354
 14355* EXEC CICS HANDLE CONDITION
 14356*        NOTOPEN (6700-NOTOPEN-ERROR)
 14357*        DUPREC (6700-EXIT)
 14358*    END-EXEC.
 14359*    MOVE '"$J%                  ! D #00012993' TO DFHEIV0
 14360     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14362     MOVE X'4420233030303132393933' TO DFHEIV0(25:11)
 14363     CALL 'kxdfhei1' USING DFHEIV0
 14364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14365
 14366
 14367
 14368* EXEC CICS WRITE
 14369*        DATASET (DLYACTV-DSID)
 14370*        RIDFLD (DA-KEY)
 14371*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 269
* EL130.cbl
 14372*        LENGTH (DLYACTV-LENGTH)
 14373*    END-EXEC.
 14374*    MOVE '&$ L                  ''   #00012998' TO DFHEIV0
 14375     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14376     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14377     MOVE X'2020233030303132393938' TO DFHEIV0(25:11)
 14378     CALL 'kxdfhei1' USING DFHEIV0,
 14379           DLYACTV-DSID,
 14380           DAILY-ACTIVITY-RECORD,
 14381           DLYACTV-LENGTH,
 14382           DA-KEY,
 14383           DFHEIV99,
 14384           DFHEIV99
 14385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14386
 14387     GO TO 6700-EXIT.
 14388
 14389 6700-NOTOPEN-ERROR.
 14390     MOVE '2955'                 TO EMI-ERROR.
 14391     MOVE -1                     TO MAINTL.
 14392     MOVE AL-UANON               TO MAINTA.
 14393     PERFORM 9900-ERROR-FORMAT THRU
 14394             9900-EXIT.
 14395     GO TO 8200-SEND-DATAONLY.
 14396
 14397 6700-EXIT.
 14398     EXIT.
 14399
 14400*************************************************************
 14401*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14402*************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 270
* EL130.cbl
 14403/
 14404 6990-DEEDIT-DATE.
 14405
 14406
 14407* EXEC CICS BIF DEEDIT
 14408*        FIELD   (DATE-WORK)
 14409*        LENGTH  (8)
 14410*    END-EXEC.
 14411     MOVE 8
 14412       TO DFHEIV11
 14413*    MOVE '@"L                   #   #00013023' TO DFHEIV0
 14414     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14415     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14416     MOVE X'2020233030303133303233' TO DFHEIV0(25:11)
 14417     CALL 'kxdfhei1' USING DFHEIV0,
 14418           DATE-WORK,
 14419           DFHEIV11
 14420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14421
 14422 6990-EXIT.
 14423     EXIT.
 14424
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 271
* EL130.cbl
 14426 7000-BUILD-OUTPUT-MAP.
 14427
 14428     IF CLAIM-SWITCH = 'N'
 14429         GO TO 7050-BUILD-MAP-CERT-DATA
 14430     END-IF.
 14431
 14432     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14433         MOVE SPACES                 TO SEQUO
 14434         MOVE AL-SABOF               TO SEQUA
 14435     ELSE
 14436         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14437         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14438         MOVE WS-CLAIM-SEQU          TO SEQUO
 14439         MOVE AL-SABON               TO SEQUA
 14440     END-IF.
 14441
 14442     MOVE CL-CARRIER             TO CLMCARRO.
 14443     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14444     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14445     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14446     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14447     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14448     MOVE CL-INSURED-MID-INIT    TO INITO.
 14449     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14450     move cl-insured-type        to instypeo
 14451*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14452
 14453     MOVE AL-UANON               TO CLMCARRA
 14454                                    CLMTYPEA
 14455                                    PCERTNOA
 14456                                    PSUFXA
 14457                                    LSTNMEA
 14458                                    FSTNMEA
 14459                                    INITA
 14460                                    SEXA
 14461
 14462     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14463
 14464     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14465         MOVE ' '                 TO DC-OPTION-CODE
 14466         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14467         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14468         IF NOT DATE-CONVERSION-ERROR
 14469             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14470             MOVE AL-UANON            TO BIRTHDTA
 14471         END-IF
 14472     END-IF.
 14473
 14474     MOVE CL-SOC-SEC-NO          TO SSNO.
 14475     MOVE AL-UANON               TO SSNA.
 14476
 14477     IF CL-INCURRED-DT NOT = LOW-VALUES
 14478         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14479         MOVE ' '                TO DC-OPTION-CODE
 14480         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14481         IF NOT DATE-CONVERSION-ERROR
 14482             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14483             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 272
* EL130.cbl
 14484         END-IF
 14485     END-IF.
 14486
 14487     IF CL-REPORTED-DT NOT = LOW-VALUES
 14488         MOVE ' '                TO DC-OPTION-CODE
 14489         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14490         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14491         IF NOT DATE-CONVERSION-ERROR
 14492             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14493             MOVE AL-UANON            TO REPORTA
 14494         END-IF
 14495     END-IF.
 14496
 14497*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14498*        MOVE ' '                 TO DC-OPTION-CODE
 14499*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14500*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14501*        IF NOT DATE-CONVERSION-ERROR
 14502*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14503*            MOVE AL-UANON            TO ESTENDA
 14504*        END-IF
 14505*    END-IF.
 14506
 14507     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14508     MOVE WS-ICD-CODE-1          TO ICD1O.
 14509     MOVE WS-ICD-CODE-2          TO ICD2O.
 14510*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14511     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14512     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14513     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14514     MOVE CL-PRIORITY-CD         TO PRICDO.
 14515     MOVE AL-UANON               TO DIAGA
 14516                                    ICD1A
 14517                                    ICD2A
 14518*                                   CAUSEA
 14519                                    RELCLMA
 14520                                    PROCCDA
 14521                                    PRICDA.
 14522     MOVE AL-UNNON               TO MANRSVA.
 14523
 14524*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14525*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14526*        MOVE AL-UANON               TO PRODCDA
 14527*    END-IF.
 14528
 14529     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14530     MOVE CL-FILE-LOCATION       TO FILETOO.
 14531     MOVE CL-BENEFICIARY         TO BENECDO.
 14532     MOVE AL-UANON               TO SUPVA
 14533                                    FILETOA
 14534                                    BENECDA.
 14535
 14536     IF CLAIM-SWITCH = 'X'
 14537         GO TO 7099-EXIT
 14538     END-IF.
 14539
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 273
* EL130.cbl
 14541 7050-BUILD-MAP-CERT-DATA.
 14542     MOVE CM-CERT-PRIME          TO CERTNOO.
 14543     MOVE CM-CERT-SFX            TO SUFXO.
 14544     MOVE AL-SANON               TO CERTNOA
 14545                                    SUFXA.
 14546
 14547     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14548         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14549         MOVE ' '                TO DC-OPTION-CODE
 14550         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14551         IF NOT DATE-CONVERSION-ERROR
 14552             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14553         END-IF
 14554     END-IF.
 14555
 14556     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14557     MOVE CM-STATE               TO STATEO.
 14558     MOVE CM-CARRIER             TO CRTCARRO.
 14559     MOVE CM-GROUPING            TO GROUPO.
 14560     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14561     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14562     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14563     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14564     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14565     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14566     MOVE CM-JT-INITIAL          TO JNTINITO.
 14567     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14568     MOVE AL-UANON               TO ACCOUNTA
 14569                                    STATEA
 14570                                    CRTCARRA
 14571                                    GROUPA
 14572                                    CRTLNMEA
 14573                                    CRTFNMEA
 14574                                    CRTINITA
 14575                                    JNTLNMEA
 14576                                    JNTFNMEA
 14577                                    JNTINITA.
 14578     MOVE AL-UNNON               TO ISSAGEA
 14579                                    JNTAGEA.
 14580
 14581     IF CM-SSN-STATE   = CM-STATE AND
 14582        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14583*        NEXT SENTENCE
 14584         CONTINUE
 14585     ELSE
 14586         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14587     END-IF.
 14588
 14589     MOVE AL-UANON               TO CRTSSNA.
 14590
 14591     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14592     MOVE '2'                    TO DC-OPTION-CODE.
 14593     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14594     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14595
 14596*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14597     MOVE SPACES                 TO ELCNTL-KEY.
 14598     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 274
* EL130.cbl
 14599     MOVE '3'                    TO CNTL-REC-TYPE.
 14600     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14601     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14602
 14603
 14604
 14605* EXEC CICS READ
 14606*        DATASET  (ELCNTL-DSID)
 14607*        SET      (ADDRESS OF CONTROL-FILE)
 14608*        RIDFLD   (ELCNTL-KEY)
 14609*        RESP     (WS-RESPONSE)
 14610*    END-EXEC.
 14611*    MOVE '&"S        E          (  N#00013209' TO DFHEIV0
 14612     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14613     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14614     MOVE X'204E233030303133323039' TO DFHEIV0(25:11)
 14615     CALL 'kxdfhei1' USING DFHEIV0,
 14616           ELCNTL-DSID,
 14617           DFHEIV20,
 14618           DFHEIV99,
 14619           ELCNTL-KEY,
 14620           DFHEIV99,
 14621           DFHEIV99,
 14622           DFHEIV99
 14623     SET ADDRESS OF CONTROL-FILE TO
 14624         DFHEIV20
 14625     MOVE EIBRESP  TO WS-RESPONSE
 14626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14627
 14628
 14629     IF WS-RESP-NOTFND
 14630          MOVE ER-2848           TO EMI-ERROR
 14631          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14632          GO TO 8100-SEND-INITIAL-MAP
 14633     END-IF.
 14634
 14635     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14636     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14637     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 275
* EL130.cbl
 14639     IF CM-LF-BENEFIT-CD = '00'
 14640         MOVE ZEROS              TO LCVOTRMO
 14641                                    LCVRTRMO
 14642                                    LCVRATEO
 14643                                    LCVBENEO
 14644         MOVE SPACES             TO LCVDSCRO
 14645                                    LCVCDO
 14646                                    LCVKINDO
 14647                                    LCVFORMO
 14648                                    LCVCNDTO
 14649                                    LCVEXITO
 14650                                    LCVSTATO
 14651         IF CLMTYPEL GREATER THAN ZERO AND
 14652            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14653                MOVE ER-0521     TO EMI-ERROR
 14654                MOVE AL-UABON    TO CLMTYPEA
 14655                MOVE -1          TO CLMTYPEL
 14656                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14657                GO TO 7060-FILL-AH-COVERAGE
 14658         ELSE
 14659             GO TO 7060-FILL-AH-COVERAGE
 14660         END-IF
 14661     END-IF.
 14662
 14663     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14664     MOVE AL-UANON               TO LCVDSCRA.
 14665     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14666     MOVE '4'                    TO WS-REC-TYPE.
 14667     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14668     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14669     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14670     MOVE AL-UANON               TO LCVCDA.
 14671     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14672                                    CP-ORIGINAL-TERM.
 14673     MOVE AL-UNNON               TO LCVOTRMA.
 14674     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14675     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14676     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14677     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14678     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14679     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14680
 14681     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14682     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14683
 14684     IF CM-LF-PREMIUM-RATE NUMERIC
 14685         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14686     ELSE
 14687         MOVE ZEROS              TO LCVRATEO
 14688     END-IF.
 14689
 14690     MOVE AL-UNNON               TO LCVRATEA.
 14691
 14692     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14693         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14694     END-IF.
 14695
 14696     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 276
* EL130.cbl
 14697
 14698     MOVE AL-UNNON               TO LCVBENEA.
 14699
 14700     IF CM-POLICY-FORM-NO NOT = SPACES
 14701         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14702     ELSE
 14703         MOVE WS-FORM-HOLD       TO LCVFORMO
 14704     END-IF.
 14705
 14706     MOVE SPACES                 TO WS-FORM-HOLD.
 14707     MOVE 'L'                    TO WS-REC-TYPE.
 14708     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14709
 14710     IF WS-FORM-HOLD NOT = SPACES
 14711         MOVE WS-FORM-HOLD       TO LCVFORMO
 14712         MOVE AL-UANON           TO LCVFORMA
 14713     END-IF.
 14714
 14715     IF CM-LF-CURRENT-STATUS = '8'
 14716         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14717             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14718             MOVE ' '             TO DC-OPTION-CODE
 14719             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14720             IF NOT DATE-CONVERSION-ERROR
 14721                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14722                 MOVE AL-UANON            TO LCVCNDTA
 14723             END-IF
 14724         END-IF
 14725     END-IF.
 14726
 14727     IF CM-LF-CURRENT-STATUS = '7'
 14728         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14729             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14730             MOVE ' '            TO DC-OPTION-CODE
 14731             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14732             IF NOT DATE-CONVERSION-ERROR
 14733                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14734                 MOVE AL-UANON   TO LCVCNDTA
 14735             END-IF
 14736         END-IF
 14737     END-IF.
 14738
 14739     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14740         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14741             MOVE ' '            TO DC-OPTION-CODE
 14742             MOVE CM-LF-DEATH-EXIT-DT
 14743                                 TO DC-BIN-DATE-1
 14744             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14745             IF NOT DATE-CONVERSION-ERROR
 14746                 MOVE DC-GREG-DATE-1-EDIT
 14747                                 TO LCVEXITO
 14748             END-IF
 14749         END-IF
 14750     END-IF.
 14751
 14752     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14753         IF CP-REMAINING-TERM-3 = ZEROS
 14754             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 277
* EL130.cbl
 14755         ELSE
 14756             MOVE 'ACTIVE'       TO LCVSTATO
 14757         END-IF
 14758     END-IF.
 14759
 14760     IF CM-LF-CURRENT-STATUS = '2'
 14761        MOVE 'PEND  '            TO LCVSTATO
 14762     END-IF.
 14763     IF CM-LF-CURRENT-STATUS = '3'
 14764        MOVE 'RESTORE'           TO LCVSTATO
 14765     END-IF.
 14766     IF CM-LF-CURRENT-STATUS = '5'
 14767        MOVE 'REISSUE'           TO LCVSTATO
 14768     END-IF.
 14769     IF CM-LF-CURRENT-STATUS = '6'
 14770        MOVE 'LMP DIS'           TO LCVSTATO
 14771     END-IF.
 14772     IF CM-LF-CURRENT-STATUS = '7'
 14773        MOVE 'DEATH  '           TO LCVSTATO
 14774     END-IF.
 14775     IF CM-LF-CURRENT-STATUS = '8'
 14776        MOVE 'CANCEL '           TO LCVSTATO
 14777     END-IF.
 14778     IF CM-LF-CURRENT-STATUS = '9'
 14779        MOVE 'RE-ONLY'           TO LCVSTATO
 14780     END-IF.
 14781     IF CM-LF-CURRENT-STATUS = 'V'
 14782        MOVE 'VOID   '           TO LCVSTATO
 14783     END-IF.
 14784     IF CM-LF-CURRENT-STATUS = 'D'
 14785        MOVE 'DECLINE'           TO LCVSTATO
 14786     END-IF.
 14787
 14788     IF PI-COMPANY-ID = 'CID'
 14789         IF CM-LF-BENEFIT-CD >= '2O' AND
 14790            CM-LF-BENEFIT-CD <= '2V'
 14791             MOVE ER-0878       TO EMI-ERROR
 14792             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14793         END-IF
 14794     END-IF.
 14795
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 278
* EL130.cbl
 14797 7060-FILL-AH-COVERAGE.
 14798
 14799     IF CM-AH-BENEFIT-CD = '00'
 14800         MOVE ZEROS              TO ACVOTRMO
 14801                                    ACVRTRMO
 14802                                    ACVRATEO
 14803                                    ACVBENEO
 14804         MOVE SPACES             TO ACVDSCRO
 14805                                    ACVCDO
 14806                                    ACVKINDO
 14807                                    ACVFORMO
 14808                                    ACVCNDTO
 14809                                    ACVEXITO
 14810                                    ACVSTATO
 14811         IF (CLMTYPEL GREATER THAN ZERO AND
 14812             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14813             MOVE ER-0521     TO EMI-ERROR
 14814             MOVE AL-UABON    TO CLMTYPEA
 14815             MOVE -1          TO CLMTYPEL
 14816             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14817             GO TO 7070-BUILD-MAP-FINISH
 14818         ELSE
 14819             GO TO 7070-BUILD-MAP-FINISH
 14820         END-IF
 14821     END-IF.
 14822
 14823     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14824     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 14825     MOVE AL-UANON               TO ACVDSCRA
 14826                                    ACVCDA.
 14827     MOVE '5'                    TO WS-REC-TYPE.
 14828     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14829     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 14830
 14831     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 14832                                    CP-ORIGINAL-TERM.
 14833     MOVE AL-UNNON               TO ACVOTRMA.
 14834
 14835     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14836     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14837     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14838     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14839     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14840     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14841
 14842     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14843     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14844
 14845     IF CM-AH-PREMIUM-RATE NUMERIC
 14846         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14847     ELSE
 14848         MOVE ZEROS              TO ACVRATEO
 14849     END-IF.
 14850
 14851     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 14852     MOVE AL-UNNON               TO ACVRATEA
 14853                                    ACVBENEA.
 14854
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 279
* EL130.cbl
 14855     IF CM-POLICY-FORM-NO NOT = SPACES
 14856         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 14857     ELSE
 14858         MOVE WS-FORM-HOLD       TO ACVFORMO
 14859         MOVE SPACES TO WS-FORM-HOLD
 14860         MOVE 'A'                TO WS-REC-TYPE
 14861         PERFORM 7400-READ-STATE THRU 7499-EXIT
 14862         IF WS-FORM-HOLD NOT = SPACES
 14863             MOVE WS-FORM-HOLD   TO ACVFORMO
 14864         END-IF
 14865     END-IF.
 14866
 14867     MOVE AL-UANON               TO ACVFORMA.
 14868
 14869     IF CM-AH-CURRENT-STATUS = '8'
 14870         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 14871             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14872             MOVE ' '             TO DC-OPTION-CODE
 14873             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14874             IF NOT DATE-CONVERSION-ERROR
 14875                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14876                MOVE AL-UANON    TO ACVCNDTA
 14877             END-IF
 14878         END-IF
 14879     END-IF.
 14880
 14881     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14882         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14883             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 14884             MOVE ' '             TO DC-OPTION-CODE
 14885             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14886             IF NOT DATE-CONVERSION-ERROR
 14887                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14888                MOVE AL-UANON            TO ACVCNDTA
 14889             END-IF
 14890         END-IF
 14891     END-IF.
 14892
 14893     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14894         MOVE ' '                TO DC-OPTION-CODE
 14895         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14896         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14897         IF NOT DATE-CONVERSION-ERROR
 14898             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 14899         END-IF
 14900     END-IF.
 14901
 14902     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14903         IF CP-REMAINING-TERM-3 = ZEROS
 14904             MOVE 'EXPIRED'      TO ACVSTATO
 14905         ELSE
 14906             MOVE 'ACTIVE'       TO ACVSTATO
 14907         END-IF
 14908     END-IF.
 14909
 14910     IF CM-AH-CURRENT-STATUS = '2'
 14911         MOVE 'PEND  '           TO ACVSTATO
 14912     END-IF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 280
* EL130.cbl
 14913     IF CM-AH-CURRENT-STATUS = '3'
 14914         MOVE 'RESTORE'          TO ACVSTATO
 14915     END-IF.
 14916     IF CM-AH-CURRENT-STATUS = '5'
 14917         MOVE 'REISSUE'          TO ACVSTATO
 14918     END-IF.
 14919     IF CM-AH-CURRENT-STATUS = '6'
 14920         MOVE 'LMP DIS'          TO ACVSTATO
 14921     END-IF.
 14922     IF CM-AH-CURRENT-STATUS = '7'
 14923         MOVE 'DEATH  '          TO ACVSTATO
 14924     END-IF.
 14925     IF CM-AH-CURRENT-STATUS = '8'
 14926         MOVE 'CANCEL '          TO ACVSTATO
 14927     END-IF.
 14928     IF CM-AH-CURRENT-STATUS = '9'
 14929         MOVE 'RE-ONLY'          TO ACVSTATO
 14930     END-IF.
 14931     IF CM-AH-CURRENT-STATUS = 'V'
 14932         MOVE 'VOID   '          TO ACVSTATO
 14933     END-IF.
 14934     IF CM-AH-CURRENT-STATUS = 'D'
 14935         MOVE 'DECLINE'          TO ACVSTATO
 14936     END-IF.
 14937
 14938     IF PI-COMPANY-ID = 'DCC'
 14939        IF CM-ACCOUNT (9:2) = 'BI'
 14940           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 14941           MOVE CM-CARRIER       TO CTRLR-CARRIER
 14942           MOVE CM-GROUPING      TO CTRLR-GROUPING
 14943           MOVE CM-STATE         TO CTRLR-STATE
 14944           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 14945           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 14946           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 14947           MOVE 'C'              TO CTRLR-REC-TYPE
 14948
 14949* EXEC CICS READ
 14950*            DATASET  (ELCRTT-DSID)
 14951*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 14952*            RIDFLD   (ELCRTT-KEY)
 14953*            RESP     (WS-RESPONSE)
 14954*          END-EXEC
 14955*    MOVE '&"S        E          (  N#00013535' TO DFHEIV0
 14956     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14957     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14958     MOVE X'204E233030303133353335' TO DFHEIV0(25:11)
 14959     CALL 'kxdfhei1' USING DFHEIV0,
 14960           ELCRTT-DSID,
 14961           DFHEIV20,
 14962           DFHEIV99,
 14963           ELCRTT-KEY,
 14964           DFHEIV99,
 14965           DFHEIV99,
 14966           DFHEIV99
 14967     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 14968         DFHEIV20
 14969     MOVE EIBRESP  TO WS-RESPONSE
 14970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 281
* EL130.cbl
 14971           IF WS-RESP-NORMAL
 14972               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 14973               MOVE WS-DIAG-VIN-MSG TO DIAGO
 14974               MOVE AL-UANON        TO DIAGA
 14975           END-IF
 14976        END-IF
 14977     END-IF.
 14978
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 282
* EL130.cbl
 14980 7070-BUILD-MAP-FINISH.
 14981     MOVE CM-LOAN-APR            TO APRO.
 14982     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14983     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14984     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 14985     MOVE AL-UNNON               TO APRA
 14986                                    PMTFREQA.
 14987     MOVE AL-UANON               TO INDGRPA
 14988                                    PREMTYPA.
 14989
 14990     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 14991         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 14992         MOVE AL-UANON               TO REINCDA
 14993     END-IF.
 14994
 14995     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 14996*        NEXT SENTENCE
 14997         CONTINUE
 14998     ELSE
 14999         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15000         MOVE ' '                TO DC-OPTION-CODE
 15001         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15002         IF NOT DATE-CONVERSION-ERROR
 15003             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 15004             MOVE AL-UANON            TO ADDONDTA
 15005         END-IF
 15006     END-IF.
 15007
 15008     IF CLAIM-SWITCH = 'N'
 15009         IF SEXL = ZEROS
 15010             MOVE CM-INSURED-SEX TO SEXO
 15011*            MOVE AL-UANON       TO SEXA
 15012         END-IF
 15013     END-IF.
 15014
 15015     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 15016         MOVE CM-MEMBER-NO       TO MEMBERO
 15017         MOVE AL-UANON           TO MEMBERA
 15018     END-IF.
 15019
 15020     IF MAINTI = 'A'
 15021         IF (LOANNOL = ZEROS OR
 15022             EIBAID = DFHPF5)
 15023             MOVE CM-LOAN-NUMBER TO LOANNOO
 15024             MOVE AL-UANON       TO LOANNOA
 15025         ELSE
 15026*            NEXT SENTENCE
 15027             CONTINUE
 15028         END-IF
 15029     ELSE
 15030         MOVE CM-LOAN-NUMBER     TO LOANNOO
 15031         MOVE AL-UANON           TO LOANNOA
 15032     END-IF.
 15033
 15034     IF MAINTI = 'A'
 15035         IF (LOANBALL = ZEROS OR
 15036             EIBAID = DFHPF5)
 15037             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 283
* EL130.cbl
 15038             MOVE AL-UNNON       TO LOANBALA
 15039         ELSE
 15040*            NEXT SENTENCE
 15041             CONTINUE
 15042         END-IF
 15043     ELSE
 15044         MOVE CM-LOAN-BALANCE    TO LOANBALO
 15045         MOVE AL-UNNON           TO LOANBALA
 15046     END-IF.
 15047
 15048     IF CM-PREMIUM-TYPE NOT = '3'
 15049         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15050             PERFORM 7200-PROTECT-CERT-FIELDS
 15051         ELSE
 15052             PERFORM 7300-RESET-KEY-ATTRBS
 15053         END-IF
 15054     ELSE
 15055         PERFORM 7300-RESET-KEY-ATTRBS
 15056     END-IF.
 15057
 15058*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15059*        NEXT SENTENCE
 15060*        CONTINUE
 15061*    ELSE
 15062         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15063*    END-IF.
 15064
 15065 7099-EXIT.
 15066     EXIT.
 15067
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 284
* EL130.cbl
 15069 7100-READ-BENEFIT.
 15070
 15071
 15072* EXEC CICS HANDLE CONDITION
 15073*         NOTFND   (7120-NOT-FOUND)
 15074*    END-EXEC.
 15075*    MOVE '"$I                   ! E #00013641' TO DFHEIV0
 15076     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15078     MOVE X'4520233030303133363431' TO DFHEIV0(25:11)
 15079     CALL 'kxdfhei1' USING DFHEIV0
 15080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15081
 15082
 15083     MOVE SPACES                 TO ELCNTL-KEY.
 15084     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15085     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15086     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15087     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15088
 15089 7105-READ-FILE.
 15090     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15091
 15092     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15093        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15094          GO TO 7120-NOT-FOUND
 15095     END-IF.
 15096
 15097     MOVE 1                      TO SUB.
 15098 7110-LOOP.
 15099     IF SUB = 9
 15100         GO TO 7120-NOT-FOUND
 15101     END-IF.
 15102
 15103     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15104         ADD 1                   TO SUB
 15105         GO TO 7110-LOOP
 15106     END-IF.
 15107
 15108     if ws-rec-type = '4'
 15109        move cf-joint-indicator (sub)
 15110                                 to ws-lf-joint-indicator
 15111     else
 15112        move cf-joint-indicator (sub)
 15113                                 to ws-ah-joint-indicator
 15114     end-if
 15115     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15116     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15117     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15118
 15119     GO TO 7199-EXIT.
 15120
 15121 7120-NOT-FOUND.
 15122     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15123                                    WS-FORM-HOLD.
 15124
 15125 7199-EXIT.
 15126      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 285
* EL130.cbl
 15127
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 286
* EL130.cbl
 15129 7200-PROTECT-CERT-FIELDS.
 15130     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15131                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15132                                LCVFORMA ACVFORMA JNTLNMEA
 15133                                JNTFNMEA JNTINITA.
 15134
 15135     IF CM-LF-CURRENT-STATUS = '2' OR
 15136        CM-AH-CURRENT-STATUS = '2'
 15137         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15138     END-IF.
 15139
 15140     MOVE AL-SANOF TO
 15141            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15142            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15143            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15144            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15145            LCVRATEA   ACVRATEA.
 15146
 15147     MOVE 'S'                    TO CERTMTI.
 15148
 15149 7300-RESET-KEY-ATTRBS.
 15150     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15151                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15152                                LCVFORMA ACVFORMA JNTLNMEA
 15153                                JNTFNMEA JNTINITA.
 15154
 15155     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15156         MOVE AL-SANOF           TO REINCDA
 15157     END-IF.
 15158
 15159     MOVE 'S'                    TO CERTMTI.
 15160
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 287
* EL130.cbl
 15162 7400-READ-STATE.
 15163
 15164
 15165* EXEC CICS HANDLE CONDITION
 15166*         NOTFND   (7499-EXIT)
 15167*    END-EXEC.
 15168*    MOVE '"$I                   ! F #00013726' TO DFHEIV0
 15169     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15171     MOVE X'4620233030303133373236' TO DFHEIV0(25:11)
 15172     CALL 'kxdfhei1' USING DFHEIV0
 15173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15174
 15175
 15176     MOVE SPACES                 TO ELCNTL-KEY.
 15177     MOVE CM-STATE               TO CNTL-ACCESS.
 15178     MOVE '3'                    TO CNTL-REC-TYPE.
 15179     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15180     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15181
 15182     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15183
 15184     MOVE 1                      TO SUB.
 15185
 15186 7410-LOOP.
 15187     IF SUB = 21
 15188        GO TO 7499-EXIT
 15189     END-IF.
 15190
 15191*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15192*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15193*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15194*        GO TO 7499-EXIT.
 15195
 15196     ADD 1                       TO SUB.
 15197     GO TO 7410-LOOP.
 15198
 15199 7499-EXIT.
 15200      EXIT.
 15201
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 288
* EL130.cbl
 15203 7500-BROWSE-FOR-DUPLICATE.
 15204
 15205     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15206
 15207
 15208
 15209* EXEC CICS HANDLE CONDITION
 15210*        NOTFND   (7500-EXIT)
 15211*        DUPKEY   (7500-DUPLICATE-KEY)
 15212*        ENDFILE  (7500-EXIT)
 15213*    END-EXEC.
 15214*    MOVE '"$I$''                 ! G #00013762' TO DFHEIV0
 15215     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15216     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15217     MOVE X'4720233030303133373632' TO DFHEIV0(25:11)
 15218     CALL 'kxdfhei1' USING DFHEIV0
 15219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15220
 15221
 15222
 15223
 15224* EXEC CICS STARTBR
 15225*        DATASET    (ELMSTR5-DSID)
 15226*        RIDFLD     (ELMSTR5-KEY)
 15227*    END-EXEC.
 15228     MOVE 0
 15229       TO DFHEIV11
 15230*    MOVE '&,         G          &   #00013769' TO DFHEIV0
 15231     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15232     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15233     MOVE X'2020233030303133373639' TO DFHEIV0(25:11)
 15234     CALL 'kxdfhei1' USING DFHEIV0,
 15235           ELMSTR5-DSID,
 15236           ELMSTR5-KEY,
 15237           DFHEIV99,
 15238           DFHEIV11,
 15239           DFHEIV99
 15240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15241
 15242
 15243
 15244
 15245* EXEC CICS HANDLE CONDITION
 15246*        ENDFILE  (7500-END-BROWSE)
 15247*    END-EXEC.
 15248*    MOVE '"$''                   ! H #00013775' TO DFHEIV0
 15249     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15251     MOVE X'4820233030303133373735' TO DFHEIV0(25:11)
 15252     CALL 'kxdfhei1' USING DFHEIV0
 15253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15254
 15255
 15256 7500-READ-CLAIM-LOOP.
 15257
 15258
 15259
 15260* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 289
* EL130.cbl
 15261*        DATASET   (ELMSTR5-DSID)
 15262*        SET       (ADDRESS OF CLAIM-MASTER)
 15263*        RIDFLD    (ELMSTR5-KEY)
 15264*    END-EXEC.
 15265     MOVE 0
 15266       TO DFHEIV11
 15267*    MOVE '&.S                   )   #00013782' TO DFHEIV0
 15268     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15269     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15270     MOVE X'2020233030303133373832' TO DFHEIV0(25:11)
 15271     CALL 'kxdfhei1' USING DFHEIV0,
 15272           ELMSTR5-DSID,
 15273           DFHEIV20,
 15274           DFHEIV99,
 15275           ELMSTR5-KEY,
 15276           DFHEIV99,
 15277           DFHEIV11,
 15278           DFHEIV99,
 15279           DFHEIV99
 15280     SET ADDRESS OF CLAIM-MASTER TO
 15281         DFHEIV20
 15282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15283
 15284
 15285 7500-DUPLICATE-KEY.
 15286
 15287     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15288        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15289        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15290        CL-CERT-STATE     NOT = CM-STATE       OR
 15291        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15292        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15293        CL-CERT-NO        NOT = CM-CERT-NO
 15294           GO TO 7500-CHECK-MATCH-COUNT
 15295     END-IF.
 15296
 15297     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15298
 15299     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15300        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15301        GO TO 7500-END-BROWSE
 15302     ELSE
 15303        GO TO 7500-READ-CLAIM-LOOP
 15304     END-IF.
 15305
 15306 7500-CHECK-MATCH-COUNT.
 15307
 15308     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15309        CL-CERT-NO    = CM-CERT-NO
 15310          GO TO 7500-READ-CLAIM-LOOP
 15311     END-IF.
 15312
 15313 7500-END-BROWSE.
 15314
 15315
 15316
 15317* EXEC CICS ENDBR
 15318*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 290
* EL130.cbl
 15319*    END-EXEC.
 15320     MOVE 0
 15321       TO DFHEIV11
 15322*    MOVE '&2                    $   #00013819' TO DFHEIV0
 15323     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15324     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15325     MOVE X'2020233030303133383139' TO DFHEIV0(25:11)
 15326     CALL 'kxdfhei1' USING DFHEIV0,
 15327           ELMSTR5-DSID,
 15328           DFHEIV11,
 15329           DFHEIV99
 15330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15331
 15332
 15333 7500-EXIT.
 15334     EXIT.
 15335
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 291
* EL130.cbl
 15337 7550-FALL-THRU-PARA.
 15338
 15339
 15340
 15341* EXEC CICS DUMP
 15342*         DUMPCODE ('E130')
 15343*         TASK
 15344*    END-EXEC.
 15345     MOVE 'E130' TO DFHEIV5
 15346*    MOVE '<"   T                $   #00013830' TO DFHEIV0
 15347     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15348     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15349     MOVE X'2020233030303133383330' TO DFHEIV0(25:11)
 15350     CALL 'kxdfhei1' USING DFHEIV0,
 15351           DFHEIV5,
 15352           DFHEIV99,
 15353           DFHEIV99
 15354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15355
 15356
 15357
 15358
 15359* EXEC CICS RETURN
 15360*    END-EXEC.
 15361*    MOVE '.(                    ''   #00013836' TO DFHEIV0
 15362     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15363     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15364     MOVE X'2020233030303133383336' TO DFHEIV0(25:11)
 15365     CALL 'kxdfhei1' USING DFHEIV0,
 15366           DFHEIV99,
 15367           DFHEIV99,
 15368           DFHEIV99,
 15369           DFHEIV99,
 15370           DFHEIV99,
 15371           DFHEIV99
 15372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15373
 15374
 15375 7600-BROWSE-CLAIM.
 15376
 15377
 15378
 15379* EXEC CICS READ
 15380*        DATASET(ELMSTR-DSID)
 15381*        SET    (ADDRESS OF CLAIM-MASTER)
 15382*        RIDFLD (ELMSTR-KEY)
 15383*        GENERIC
 15384*        EQUAL
 15385*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15386*    END-EXEC.
 15387*    MOVE '&"S  KG    E          (   #00013842' TO DFHEIV0
 15388     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15389     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15390     MOVE X'2020233030303133383432' TO DFHEIV0(25:11)
 15391     CALL 'kxdfhei1' USING DFHEIV0,
 15392           ELMSTR-DSID,
 15393           DFHEIV20,
 15394           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 292
* EL130.cbl
 15395           ELMSTR-KEY,
 15396           ELMSTR-GENERIC-LENGTH,
 15397           DFHEIV99,
 15398           DFHEIV99
 15399     SET ADDRESS OF CLAIM-MASTER TO
 15400         DFHEIV20
 15401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15402
 15403
 15404     MOVE CL-CERT-PRIME          TO CERTNOI.
 15405     MOVE CL-CERT-SFX            TO SUFXI.
 15406
 15407 7610-BROWSE-CLAIM-LOOP.
 15408
 15409     MOVE LOW-VALUES             TO BCERT1O
 15410                                    BSUFX1O
 15411                                    BCERT2O
 15412                                    BSUFX2O
 15413                                    BCERT3O
 15414                                    BSUFX3O
 15415                                    BCERT4O
 15416                                    BSUFX4O
 15417                                    BCERT5O
 15418                                    BSUFX5O.
 15419
 15420     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15421
 15422
 15423
 15424* EXEC CICS HANDLE CONDITION
 15425*        ENDFILE  (7630-END-BROWSE)
 15426*    END-EXEC.
 15427*    MOVE '"$''                   ! I #00013870' TO DFHEIV0
 15428     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15430     MOVE X'4920233030303133383730' TO DFHEIV0(25:11)
 15431     CALL 'kxdfhei1' USING DFHEIV0
 15432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15433
 15434
 15435
 15436
 15437* EXEC CICS STARTBR
 15438*        DATASET    (ELMSTR-DSID)
 15439*        RIDFLD     (ELMSTR-KEY)
 15440*    END-EXEC.
 15441     MOVE 0
 15442       TO DFHEIV11
 15443*    MOVE '&,         G          &   #00013875' TO DFHEIV0
 15444     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15445     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15446     MOVE X'2020233030303133383735' TO DFHEIV0(25:11)
 15447     CALL 'kxdfhei1' USING DFHEIV0,
 15448           ELMSTR-DSID,
 15449           ELMSTR-KEY,
 15450           DFHEIV99,
 15451           DFHEIV11,
 15452           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 293
* EL130.cbl
 15453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15454
 15455
 15456     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15457
 15458 7620-READ-CLAIM-LOOP.
 15459
 15460
 15461
 15462* EXEC CICS READNEXT
 15463*        DATASET   (ELMSTR-DSID)
 15464*        SET       (ADDRESS OF CLAIM-MASTER)
 15465*        RIDFLD    (ELMSTR-KEY)
 15466*    END-EXEC.
 15467     MOVE 0
 15468       TO DFHEIV11
 15469*    MOVE '&.S                   )   #00013885' TO DFHEIV0
 15470     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15471     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15472     MOVE X'2020233030303133383835' TO DFHEIV0(25:11)
 15473     CALL 'kxdfhei1' USING DFHEIV0,
 15474           ELMSTR-DSID,
 15475           DFHEIV20,
 15476           DFHEIV99,
 15477           ELMSTR-KEY,
 15478           DFHEIV99,
 15479           DFHEIV11,
 15480           DFHEIV99,
 15481           DFHEIV99
 15482     SET ADDRESS OF CLAIM-MASTER TO
 15483         DFHEIV20
 15484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15485
 15486
 15487     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15488        CL-CARRIER     NOT = CLMCARRI       OR
 15489        CL-CLAIM-NO    NOT = CLMNOI
 15490          GO TO 7630-END-BROWSE
 15491     END-IF.
 15492
 15493     IF WS-ASSOCIATED-CERTS = 1
 15494         MOVE CL-CERT-PRIME      TO BCERT1O
 15495         MOVE CL-CERT-SFX        TO BSUFX1O
 15496     END-IF.
 15497
 15498     IF WS-ASSOCIATED-CERTS = 2
 15499         MOVE CL-CERT-PRIME      TO BCERT2O
 15500         MOVE CL-CERT-SFX        TO BSUFX2O
 15501     END-IF.
 15502
 15503     IF WS-ASSOCIATED-CERTS = 3
 15504         MOVE CL-CERT-PRIME      TO BCERT3O
 15505         MOVE CL-CERT-SFX        TO BSUFX3O
 15506     END-IF.
 15507
 15508     IF WS-ASSOCIATED-CERTS = 4
 15509         MOVE CL-CERT-PRIME      TO BCERT4O
 15510         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 294
* EL130.cbl
 15511     END-IF.
 15512
 15513     IF WS-ASSOCIATED-CERTS = 5
 15514         MOVE CL-CERT-PRIME      TO BCERT5O
 15515         MOVE CL-CERT-SFX        TO BSUFX5O
 15516     ELSE
 15517         ADD +1                  TO WS-ASSOCIATED-CERTS
 15518         GO TO 7620-READ-CLAIM-LOOP
 15519     END-IF.
 15520
 15521 7630-END-BROWSE.
 15522
 15523
 15524
 15525* EXEC CICS ENDBR
 15526*        DATASET   (ELMSTR-DSID)
 15527*    END-EXEC.
 15528     MOVE 0
 15529       TO DFHEIV11
 15530*    MOVE '&2                    $   #00013928' TO DFHEIV0
 15531     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15532     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15533     MOVE X'2020233030303133393238' TO DFHEIV0(25:11)
 15534     CALL 'kxdfhei1' USING DFHEIV0,
 15535           ELMSTR-DSID,
 15536           DFHEIV11,
 15537           DFHEIV99
 15538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15539
 15540
 15541 7640-HIGHLIGHT-CERT-DISPLAYED.
 15542
 15543     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15544     MOVE AL-SANON               TO BCERT1A
 15545                                    BSUFX1A
 15546                                    BCERT2A
 15547                                    BSUFX2A
 15548                                    BCERT3A
 15549                                    BSUFX3A
 15550                                    BCERT4A
 15551                                    BSUFX4A
 15552                                    BCERT5A
 15553                                    BSUFX5A.
 15554
 15555     IF BCERT1O = CERTNOI AND
 15556        BSUFX1O = SUFXI
 15557            MOVE AL-SABON        TO BCERT1A
 15558                                    BSUFX1A
 15559     END-IF.
 15560
 15561     IF BCERT2O = CERTNOI AND
 15562        BSUFX2O = SUFXI
 15563            MOVE AL-SABON        TO BCERT2A
 15564                                    BSUFX2A
 15565     END-IF.
 15566
 15567     IF BCERT3O = CERTNOI AND
 15568        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 295
* EL130.cbl
 15569            MOVE AL-SABON        TO BCERT3A
 15570                                    BSUFX3A
 15571     END-IF.
 15572
 15573     IF BCERT4O = CERTNOI AND
 15574        BSUFX4O = SUFXI
 15575            MOVE AL-SABON        TO BCERT4A
 15576                                    BSUFX4A
 15577     END-IF.
 15578
 15579     IF BCERT5O = CERTNOI AND
 15580        BSUFX5O = SUFXI
 15581            MOVE AL-SABON        TO BCERT5A
 15582                                    BSUFX5A
 15583     END-IF.
 15584
 15585 7699-EXIT.
 15586     EXIT.
 15587
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 296
* EL130.cbl
 15589 7700-CHECK-SEQUENCE.
 15590
 15591
 15592
 15593* EXEC CICS HANDLE CONDITION
 15594*        ENDFILE  (7799-EXIT)
 15595*        NOTFND   (7799-EXIT)
 15596*    END-EXEC.
 15597*    MOVE '"$''I                  ! J #00013983' TO DFHEIV0
 15598     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15600     MOVE X'4A20233030303133393833' TO DFHEIV0(25:11)
 15601     CALL 'kxdfhei1' USING DFHEIV0
 15602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15603
 15604
 15605
 15606
 15607* EXEC CICS READ
 15608*        DATASET(ELMSTR-DSID)
 15609*        SET    (ADDRESS OF CLAIM-MASTER)
 15610*        RIDFLD (ELMSTR-KEY)
 15611*        GENERIC
 15612*        EQUAL
 15613*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15614*    END-EXEC.
 15615*    MOVE '&"S  KG    E          (   #00013989' TO DFHEIV0
 15616     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15617     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15618     MOVE X'2020233030303133393839' TO DFHEIV0(25:11)
 15619     CALL 'kxdfhei1' USING DFHEIV0,
 15620           ELMSTR-DSID,
 15621           DFHEIV20,
 15622           DFHEIV99,
 15623           ELMSTR-KEY,
 15624           ELMSTR-GENERIC-LENGTH,
 15625           DFHEIV99,
 15626           DFHEIV99
 15627     SET ADDRESS OF CLAIM-MASTER TO
 15628         DFHEIV20
 15629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15630
 15631
 15632     COMPUTE WS-ASSOC-CERT-TOTAL =
 15633             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15634
 15635     GO TO 7799-EXIT.
 15636
 15637 7710-RESEQUENCE-CLAIMS.
 15638
 15639
 15640
 15641* EXEC CICS HANDLE CONDITION
 15642*        ENDFILE  (7790-END-BROWSE)
 15643*    END-EXEC.
 15644*    MOVE '"$''                   ! K #00014006' TO DFHEIV0
 15645     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 297
* EL130.cbl
 15647     MOVE X'4B20233030303134303036' TO DFHEIV0(25:11)
 15648     CALL 'kxdfhei1' USING DFHEIV0
 15649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15650
 15651
 15652
 15653
 15654* EXEC CICS STARTBR
 15655*        DATASET    (ELMSTR-DSID)
 15656*        RIDFLD     (ELMSTR-KEY)
 15657*    END-EXEC.
 15658     MOVE 0
 15659       TO DFHEIV11
 15660*    MOVE '&,         G          &   #00014011' TO DFHEIV0
 15661     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15662     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15663     MOVE X'2020233030303134303131' TO DFHEIV0(25:11)
 15664     CALL 'kxdfhei1' USING DFHEIV0,
 15665           ELMSTR-DSID,
 15666           ELMSTR-KEY,
 15667           DFHEIV99,
 15668           DFHEIV11,
 15669           DFHEIV99
 15670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15671
 15672
 15673     ADD +1 TO WS-ASSOC-CERT-SEQU
 15674               WS-READNEXT-SWITCH.
 15675
 15676 7720-READ-CLAIM-LOOP.
 15677
 15678
 15679
 15680* EXEC CICS READNEXT
 15681*        DATASET   (ELMSTR-DSID)
 15682*        SET       (ADDRESS OF CLAIM-MASTER)
 15683*        RIDFLD    (ELMSTR-KEY)
 15684*    END-EXEC.
 15685     MOVE 0
 15686       TO DFHEIV11
 15687*    MOVE '&.S                   )   #00014022' TO DFHEIV0
 15688     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15689     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15690     MOVE X'2020233030303134303232' TO DFHEIV0(25:11)
 15691     CALL 'kxdfhei1' USING DFHEIV0,
 15692           ELMSTR-DSID,
 15693           DFHEIV20,
 15694           DFHEIV99,
 15695           ELMSTR-KEY,
 15696           DFHEIV99,
 15697           DFHEIV11,
 15698           DFHEIV99,
 15699           DFHEIV99
 15700     SET ADDRESS OF CLAIM-MASTER TO
 15701         DFHEIV20
 15702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15703
 15704
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 298
* EL130.cbl
 15705     IF WS-READNEXT-SWITCH = 1
 15706         ADD 1 TO WS-READNEXT-SWITCH
 15707         GO TO 7720-READ-CLAIM-LOOP
 15708     END-IF.
 15709
 15710 7730-END-BROWSE.
 15711
 15712
 15713
 15714* EXEC CICS ENDBR
 15715*        DATASET   (ELMSTR-DSID)
 15716*    END-EXEC.
 15717     MOVE 0
 15718       TO DFHEIV11
 15719*    MOVE '&2                    $   #00014036' TO DFHEIV0
 15720     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15721     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15722     MOVE X'2020233030303134303336' TO DFHEIV0(25:11)
 15723     CALL 'kxdfhei1' USING DFHEIV0,
 15724           ELMSTR-DSID,
 15725           DFHEIV11,
 15726           DFHEIV99
 15727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15728
 15729
 15730 7740-READ-CLAIM-UPDATE.
 15731
 15732     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15733        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15734        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15735          GO TO 7799-EXIT
 15736     ELSE
 15737          MOVE ZERO              TO WS-READNEXT-SWITCH
 15738     END-IF.
 15739
 15740
 15741
 15742* EXEC CICS READ
 15743*        DATASET(ELMSTR-DSID)
 15744*        SET    (ADDRESS OF CLAIM-MASTER)
 15745*        RIDFLD (ELMSTR-KEY)
 15746*        UPDATE
 15747*    END-EXEC.
 15748*    MOVE '&"S        EU         (   #00014051' TO DFHEIV0
 15749     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15750     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15751     MOVE X'2020233030303134303531' TO DFHEIV0(25:11)
 15752     CALL 'kxdfhei1' USING DFHEIV0,
 15753           ELMSTR-DSID,
 15754           DFHEIV20,
 15755           DFHEIV99,
 15756           ELMSTR-KEY,
 15757           DFHEIV99,
 15758           DFHEIV99,
 15759           DFHEIV99
 15760     SET ADDRESS OF CLAIM-MASTER TO
 15761         DFHEIV20
 15762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 299
* EL130.cbl
 15763
 15764
 15765     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15766     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15767
 15768
 15769
 15770* EXEC CICS REWRITE
 15771*         DATASET     (ELMSTR-DSID)
 15772*         FROM        (CLAIM-MASTER)
 15773*    END-EXEC.
 15774     MOVE LENGTH OF
 15775      CLAIM-MASTER
 15776       TO DFHEIV11
 15777*    MOVE '&& L                  %   #00014062' TO DFHEIV0
 15778     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15779     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15780     MOVE X'2020233030303134303632' TO DFHEIV0(25:11)
 15781     CALL 'kxdfhei1' USING DFHEIV0,
 15782           ELMSTR-DSID,
 15783           CLAIM-MASTER,
 15784           DFHEIV11,
 15785           DFHEIV99
 15786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15787
 15788
 15789     GO TO 7710-RESEQUENCE-CLAIMS.
 15790
 15791 7790-END-BROWSE.
 15792
 15793
 15794
 15795* EXEC CICS ENDBR
 15796*        DATASET   (ELMSTR-DSID)
 15797*    END-EXEC.
 15798     MOVE 0
 15799       TO DFHEIV11
 15800*    MOVE '&2                    $   #00014072' TO DFHEIV0
 15801     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15802     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15803     MOVE X'2020233030303134303732' TO DFHEIV0(25:11)
 15804     CALL 'kxdfhei1' USING DFHEIV0,
 15805           ELMSTR-DSID,
 15806           DFHEIV11,
 15807           DFHEIV99
 15808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15809
 15810
 15811 7799-EXIT.
 15812     EXIT.
 15813
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 300
* EL130.cbl
 15815************************************************
 15816*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 15817************************************************
 15818
 15819 7900-READ-ACTV-UPDATE.
 15820     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15821     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15822     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15823     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15824     MOVE +0                     TO TRLR-SEQ-NO.
 15825     MOVE '1'                    TO TRLR-TYPE.
 15826     GO TO 7900-READ-TRAILER-UPDATE.
 15827
 15828 7900-READ-NINETY-UPDATE.
 15829     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15830     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15831     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15832     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15833     MOVE +90                    TO TRLR-SEQ-NO.
 15834     MOVE '6'                    TO TRLR-TYPE.
 15835
 15836 7900-READ-TRAILER-UPDATE.
 15837
 15838
 15839* EXEC CICS READ  UPDATE
 15840*        DATASET    (ELTRLR-DSID)
 15841*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 15842*        RIDFLD     (ELTRLR-KEY)
 15843*    END-EXEC.
 15844*    MOVE '&"S        EU         (   #00014103' TO DFHEIV0
 15845     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15846     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15847     MOVE X'2020233030303134313033' TO DFHEIV0(25:11)
 15848     CALL 'kxdfhei1' USING DFHEIV0,
 15849           ELTRLR-DSID,
 15850           DFHEIV20,
 15851           DFHEIV99,
 15852           ELTRLR-KEY,
 15853           DFHEIV99,
 15854           DFHEIV99,
 15855           DFHEIV99
 15856     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15857         DFHEIV20
 15858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15859
 15860
 15861 7900-EXIT.
 15862      EXIT.
 15863
 15864 7910-READ-ACTV.
 15865     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15866     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15867     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15868     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15869     MOVE +0                     TO TRLR-SEQ-NO.
 15870     MOVE '1'                    TO TRLR-TYPE.
 15871     GO TO 7910-READ-TRAILER.
 15872
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 301
* EL130.cbl
 15873 7910-READ-NINETY.
 15874     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15875     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15876     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15877     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15878     MOVE +90                    TO TRLR-SEQ-NO.
 15879     MOVE '6'                    TO TRLR-TYPE.
 15880
 15881 7910-READ-TRAILER.
 15882     MOVE 'TRLR'                 TO FILE-SWITCH.
 15883
 15884
 15885
 15886* EXEC CICS READ
 15887*        DATASET   (ELTRLR-DSID)
 15888*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15889*        RIDFLD    (ELTRLR-KEY)
 15890*    END-EXEC.
 15891*    MOVE '&"S        E          (   #00014133' TO DFHEIV0
 15892     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15894     MOVE X'2020233030303134313333' TO DFHEIV0(25:11)
 15895     CALL 'kxdfhei1' USING DFHEIV0,
 15896           ELTRLR-DSID,
 15897           DFHEIV20,
 15898           DFHEIV99,
 15899           ELTRLR-KEY,
 15900           DFHEIV99,
 15901           DFHEIV99,
 15902           DFHEIV99
 15903     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15904         DFHEIV20
 15905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15906
 15907
 15908 7910-EXIT.
 15909      EXIT.
 15910
 15911 7915-REWRITE-TRAILER.
 15912
 15913
 15914* EXEC CICS REWRITE
 15915*        DATASET   (ELTRLR-DSID)
 15916*        FROM      (ACTIVITY-TRAILERS)
 15917*    END-EXEC.
 15918     MOVE LENGTH OF
 15919      ACTIVITY-TRAILERS
 15920       TO DFHEIV11
 15921*    MOVE '&& L                  %   #00014144' TO DFHEIV0
 15922     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15923     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15924     MOVE X'2020233030303134313434' TO DFHEIV0(25:11)
 15925     CALL 'kxdfhei1' USING DFHEIV0,
 15926           ELTRLR-DSID,
 15927           ACTIVITY-TRAILERS,
 15928           DFHEIV11,
 15929           DFHEIV99
 15930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 302
* EL130.cbl
 15931
 15932
 15933 7915-EXIT.
 15934      EXIT.
 15935
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 303
* EL130.cbl
 15937********************************************
 15938*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 15939********************************************
 15940
 15941 7920-READ-CLAIM-UPDATE.
 15942
 15943
 15944
 15945* EXEC CICS READ
 15946*        UPDATE
 15947*        DATASET   (ELMSTR-DSID)
 15948*        SET       (ADDRESS OF CLAIM-MASTER)
 15949*        RIDFLD    (ELMSTR-KEY)
 15950*    END-EXEC.
 15951*    MOVE '&"S        EU         (   #00014160' TO DFHEIV0
 15952     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15953     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15954     MOVE X'2020233030303134313630' TO DFHEIV0(25:11)
 15955     CALL 'kxdfhei1' USING DFHEIV0,
 15956           ELMSTR-DSID,
 15957           DFHEIV20,
 15958           DFHEIV99,
 15959           ELMSTR-KEY,
 15960           DFHEIV99,
 15961           DFHEIV99,
 15962           DFHEIV99
 15963     SET ADDRESS OF CLAIM-MASTER TO
 15964         DFHEIV20
 15965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15966
 15967
 15968 7920-EXIT.
 15969      EXIT.
 15970
 15971 7950-READ-CLAIM.
 15972
 15973
 15974* EXEC CICS READ
 15975*        DATASET   (ELMSTR-DSID)
 15976*        SET       (ADDRESS OF CLAIM-MASTER)
 15977*        RIDFLD    (ELMSTR-KEY)
 15978*    END-EXEC.
 15979*    MOVE '&"S        E          (   #00014172' TO DFHEIV0
 15980     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15982     MOVE X'2020233030303134313732' TO DFHEIV0(25:11)
 15983     CALL 'kxdfhei1' USING DFHEIV0,
 15984           ELMSTR-DSID,
 15985           DFHEIV20,
 15986           DFHEIV99,
 15987           ELMSTR-KEY,
 15988           DFHEIV99,
 15989           DFHEIV99,
 15990           DFHEIV99
 15991     SET ADDRESS OF CLAIM-MASTER TO
 15992         DFHEIV20
 15993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15994
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 304
* EL130.cbl
 15995
 15996 7950-EXIT.
 15997      EXIT.
 15998
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 305
* EL130.cbl
 16000***************************************
 16001*  I/O REQUESTS AGAINST CONTROL FILE  *
 16002***************************************
 16003
 16004 7960-READ-CNTL-UPDATE.
 16005
 16006
 16007* EXEC CICS READ
 16008*        UPDATE
 16009*        DATASET  (ELCNTL-DSID)
 16010*        SET      (ADDRESS OF CONTROL-FILE)
 16011*        RIDFLD   (ELCNTL-KEY)
 16012*    END-EXEC.
 16013*    MOVE '&"S        EU         (   #00014188' TO DFHEIV0
 16014     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16015     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16016     MOVE X'2020233030303134313838' TO DFHEIV0(25:11)
 16017     CALL 'kxdfhei1' USING DFHEIV0,
 16018           ELCNTL-DSID,
 16019           DFHEIV20,
 16020           DFHEIV99,
 16021           ELCNTL-KEY,
 16022           DFHEIV99,
 16023           DFHEIV99,
 16024           DFHEIV99
 16025     SET ADDRESS OF CONTROL-FILE TO
 16026         DFHEIV20
 16027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16028
 16029
 16030 7960-EXIT.
 16031      EXIT.
 16032
 16033 7970-READ-CNTL.
 16034
 16035
 16036* EXEC CICS READ
 16037*        DATASET  (ELCNTL-DSID)
 16038*        SET      (ADDRESS OF CONTROL-FILE)
 16039*        RIDFLD   (ELCNTL-KEY)
 16040*    END-EXEC.
 16041*    MOVE '&"S        E          (   #00014200' TO DFHEIV0
 16042     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16043     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16044     MOVE X'2020233030303134323030' TO DFHEIV0(25:11)
 16045     CALL 'kxdfhei1' USING DFHEIV0,
 16046           ELCNTL-DSID,
 16047           DFHEIV20,
 16048           DFHEIV99,
 16049           ELCNTL-KEY,
 16050           DFHEIV99,
 16051           DFHEIV99,
 16052           DFHEIV99
 16053     SET ADDRESS OF CONTROL-FILE TO
 16054         DFHEIV20
 16055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16056
 16057
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 306
* EL130.cbl
 16058 7970-EXIT.
 16059      EXIT.
 16060
 16061 7975-READ-CNTL-GTEQ.
 16062
 16063
 16064* EXEC CICS READ
 16065*         DATASET   (ELCNTL-DSID)
 16066*         SET       (ADDRESS OF CONTROL-FILE)
 16067*         RIDFLD    (ELCNTL-KEY)
 16068*         GTEQ
 16069*     END-EXEC.
 16070*    MOVE '&"S        G          (   #00014211' TO DFHEIV0
 16071     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16073     MOVE X'2020233030303134323131' TO DFHEIV0(25:11)
 16074     CALL 'kxdfhei1' USING DFHEIV0,
 16075           ELCNTL-DSID,
 16076           DFHEIV20,
 16077           DFHEIV99,
 16078           ELCNTL-KEY,
 16079           DFHEIV99,
 16080           DFHEIV99,
 16081           DFHEIV99
 16082     SET ADDRESS OF CONTROL-FILE TO
 16083         DFHEIV20
 16084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16085
 16086
 16087 7975-EXIT.
 16088      EXIT.
 16089
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 307
* EL130.cbl
 16091**************************************************
 16092*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16093**************************************************
 16094
 16095 7980-READ-CERT5.
 16096
 16097
 16098* EXEC CICS READ
 16099*         DATASET  (ELCERT5-DSID)
 16100*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16101*         RIDFLD   (ELCERT-KEY-5)
 16102*     END-EXEC.
 16103*    MOVE '&"S        E          (   #00014228' TO DFHEIV0
 16104     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16106     MOVE X'2020233030303134323238' TO DFHEIV0(25:11)
 16107     CALL 'kxdfhei1' USING DFHEIV0,
 16108           ELCERT5-DSID,
 16109           DFHEIV20,
 16110           DFHEIV99,
 16111           ELCERT-KEY-5,
 16112           DFHEIV99,
 16113           DFHEIV99,
 16114           DFHEIV99
 16115     SET ADDRESS OF CERTIFICATE-MASTER TO
 16116         DFHEIV20
 16117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16118
 16119
 16120 7980-EXIT.
 16121      EXIT.
 16122
 16123 7930-READ-CERT-UPDATE.
 16124
 16125
 16126* EXEC CICS READ
 16127*        DATASET  (ELCERT-DSID)
 16128*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16129*        RIDFLD   (ELCERT-KEY)
 16130*        UPDATE
 16131*    END-EXEC.
 16132*    MOVE '&"S        EU         (   #00014239' TO DFHEIV0
 16133     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16134     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16135     MOVE X'2020233030303134323339' TO DFHEIV0(25:11)
 16136     CALL 'kxdfhei1' USING DFHEIV0,
 16137           ELCERT-DSID,
 16138           DFHEIV20,
 16139           DFHEIV99,
 16140           ELCERT-KEY,
 16141           DFHEIV99,
 16142           DFHEIV99,
 16143           DFHEIV99
 16144     SET ADDRESS OF CERTIFICATE-MASTER TO
 16145         DFHEIV20
 16146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16147
 16148
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 308
* EL130.cbl
 16149 7930-EXIT.
 16150      EXIT.
 16151
 16152 7940-READ-CERT.
 16153
 16154
 16155* EXEC CICS READ
 16156*        DATASET  (ELCERT-DSID)
 16157*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16158*        RIDFLD   (ELCERT-KEY)
 16159*    END-EXEC.
 16160*    MOVE '&"S        E          (   #00014251' TO DFHEIV0
 16161     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16162     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16163     MOVE X'2020233030303134323531' TO DFHEIV0(25:11)
 16164     CALL 'kxdfhei1' USING DFHEIV0,
 16165           ELCERT-DSID,
 16166           DFHEIV20,
 16167           DFHEIV99,
 16168           ELCERT-KEY,
 16169           DFHEIV99,
 16170           DFHEIV99,
 16171           DFHEIV99
 16172     SET ADDRESS OF CERTIFICATE-MASTER TO
 16173         DFHEIV20
 16174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16175
 16176
 16177 7940-EXIT.
 16178      EXIT.
 16179
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 309
* EL130.cbl
 16181**************************************************
 16182*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16183**************************************************
 16184
 16185 7991-READ-BENE.
 16186
 16187
 16188* EXEC CICS READ
 16189*         DATASET   (ELBENE-DSID)
 16190*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16191*         RIDFLD    (ELBENE-KEY)
 16192*     END-EXEC.
 16193*    MOVE '&"S        E          (   #00014267' TO DFHEIV0
 16194     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16195     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16196     MOVE X'2020233030303134323637' TO DFHEIV0(25:11)
 16197     CALL 'kxdfhei1' USING DFHEIV0,
 16198           ELBENE-DSID,
 16199           DFHEIV20,
 16200           DFHEIV99,
 16201           ELBENE-KEY,
 16202           DFHEIV99,
 16203           DFHEIV99,
 16204           DFHEIV99
 16205     SET ADDRESS OF BENEFICIARY-MASTER TO
 16206         DFHEIV20
 16207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16208
 16209
 16210 7991-EXIT.
 16211      EXIT.
 16212
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 310
* EL130.cbl
 16214**************************************************
 16215*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16216**************************************************
 16217
 16218 7992-READ-REIN.
 16219
 16220
 16221
 16222* EXEC CICS HANDLE CONDITION
 16223*        NOTFND   (7992-NOT-FOUND)
 16224*    END-EXEC.
 16225*    MOVE '"$I                   ! L #00014284' TO DFHEIV0
 16226     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16227     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16228     MOVE X'4C20233030303134323834' TO DFHEIV0(25:11)
 16229     CALL 'kxdfhei1' USING DFHEIV0
 16230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16231
 16232
 16233
 16234
 16235* EXEC CICS READ
 16236*        DATASET   (ERREIN-DSID)
 16237*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16238*        RIDFLD    (ERREIN-KEY)
 16239*    END-EXEC.
 16240*    MOVE '&"S        E          (   #00014289' TO DFHEIV0
 16241     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16243     MOVE X'2020233030303134323839' TO DFHEIV0(25:11)
 16244     CALL 'kxdfhei1' USING DFHEIV0,
 16245           ERREIN-DSID,
 16246           DFHEIV20,
 16247           DFHEIV99,
 16248           ERREIN-KEY,
 16249           DFHEIV99,
 16250           DFHEIV99,
 16251           DFHEIV99
 16252     SET ADDRESS OF REINSURANCE-RECORD TO
 16253         DFHEIV20
 16254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16255
 16256
 16257     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16258
 16259     GO TO 7992-EXIT.
 16260
 16261 7992-NOT-FOUND.
 16262     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16263
 16264 7992-EXIT.
 16265     EXIT.
 16266
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 311
* EL130.cbl
 16268 8000-LOAD-ERROR-MESSAGES.
 16269     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16270
 16271     IF EMI-NO-ERRORS
 16272         GO TO 8000-EXIT
 16273     END-IF.
 16274
 16275     perform varying e1 from +1 by +1 until e1 > +3
 16276        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16277                                or '1655' or '1660'
 16278           move 'W'              to emi-severity (e1)
 16279        end-if
 16280     end-perform
 16281     IF EMI-NUMBER-OF-LINES = 1
 16282         MOVE EMI-LINE1          TO ERRMSG1O
 16283         GO TO 8000-EXIT
 16284     END-IF.
 16285
 16286     IF EMI-NUMBER-OF-LINES = 2
 16287          MOVE EMI-LINE1         TO ERRMSG1O
 16288          MOVE EMI-LINE2         TO ERRMSG2O
 16289          GO TO 8000-EXIT
 16290     END-IF.
 16291
 16292     MOVE EMI-LINE1              TO ERRMSG1O.
 16293
 16294 8000-EXIT.
 16295     EXIT.
 16296
 16297 8100-SEND-INITIAL-MAP.
 16298     MOVE SAVE-DATE              TO RUNDTEO.
 16299     MOVE EIBTIME                TO TIME-IN.
 16300     MOVE TIME-OUT               TO RUNTIMEO.
 16301     IF EIBAID = DFHPF11
 16302        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16303        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16304     end-if
 16305     IF RETURNED-FROM = XCTL-114
 16306        CONTINUE
 16307     ELSE
 16308        MOVE -1                  TO MAINTL
 16309     END-IF.
 16310
 16311*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16312         MOVE SPACES             TO PRODO.
 16313         MOVE AL-SANOF           TO PRODCDA.
 16314*    END-IF.
 16315
 16316     MOVE PI-COMPANY-ID          TO COMPO.
 16317     MOVE AL-PABOF               TO COMPA.
 16318     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16319     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16320     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16321
 16322     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16323
 16324     IF NOT PI-NO-CARRIER-SECURITY
 16325        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 312
* EL130.cbl
 16326        MOVE AL-SABOF            TO CLMCARRA
 16327     END-IF.
 16328
 16329     IF PI-PROCESSOR-ID = 'PEMA'
 16330        MOVE AL-UANON            TO CERTNOA
 16331                                    SUFXA
 16332     END-IF.
 16333*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16334*        NEXT SENTENCE
 16335*        CONTINUE
 16336*    ELSE
 16337         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16338*    END-IF.
 16339
 16340
 16341
 16342* EXEC CICS SEND
 16343*        MAP     (MAP-NAME)
 16344*        MAPSET  (MAPSET-NAME)
 16345*        FROM    (EL130AO)
 16346*        ERASE
 16347*        CURSOR
 16348*    END-EXEC.
 16349     MOVE LENGTH OF
 16350      EL130AO
 16351       TO DFHEIV12
 16352     MOVE -1
 16353       TO DFHEIV11
 16354*    MOVE '8$     CT  E    H L F ,   #00014379' TO DFHEIV0
 16355     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16356     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16357     MOVE X'2020233030303134333739' TO DFHEIV0(25:11)
 16358     CALL 'kxdfhei1' USING DFHEIV0,
 16359           MAP-NAME,
 16360           EL130AO,
 16361           DFHEIV12,
 16362           MAPSET-NAME,
 16363           DFHEIV99,
 16364           DFHEIV99,
 16365           DFHEIV99,
 16366           DFHEIV11,
 16367           DFHEIV99,
 16368           DFHEIV99,
 16369           DFHEIV99
 16370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16371
 16372
 16373     GO TO 9100-RETURN-TRAN.
 16374
 16375 8150-SEND-MAP-CURSOR.
 16376     MOVE SAVE-DATE              TO RUNDTEO.
 16377     MOVE EIBTIME                TO TIME-IN.
 16378     MOVE TIME-OUT               TO RUNTIMEO.
 16379     IF EIBAID = DFHPF11
 16380        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16382     end-if
 16383     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 313
* EL130.cbl
 16384     MOVE AL-PABOF               TO COMPA
 16385     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16386     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16387     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16388
 16389*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16390         MOVE SPACES             TO PRODO.
 16391         MOVE AL-SANOF           TO PRODCDA.
 16392*    END-IF.
 16393
 16394     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16395
 16396     IF NOT PI-NO-CARRIER-SECURITY
 16397         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16398         MOVE AL-SABOF            TO CLMCARRA
 16399     END-IF.
 16400
 16401     IF PI-PROCESSOR-ID = 'PEMA'
 16402        MOVE AL-UANON            TO CERTNOA
 16403                                    SUFXA
 16404     END-IF.
 16405*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16406*        NEXT SENTENCE
 16407*        CONTINUE
 16408*    ELSE
 16409         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16410*    END-IF.
 16411
 16412
 16413
 16414* EXEC CICS SEND
 16415*        MAP      (MAP-NAME)
 16416*        MAPSET   (MAPSET-NAME)
 16417*        FROM     (EL130AO)
 16418*        CURSOR   (PI-CURSOR)
 16419*        ERASE
 16420*    END-EXEC.
 16421     MOVE LENGTH OF
 16422      EL130AO
 16423       TO DFHEIV11
 16424*    MOVE '8$     CT  E    H L F ,   #00014427' TO DFHEIV0
 16425     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16426     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16427     MOVE X'2020233030303134343237' TO DFHEIV0(25:11)
 16428     CALL 'kxdfhei1' USING DFHEIV0,
 16429           MAP-NAME,
 16430           EL130AO,
 16431           DFHEIV11,
 16432           MAPSET-NAME,
 16433           DFHEIV99,
 16434           DFHEIV99,
 16435           DFHEIV99,
 16436           PI-CURSOR,
 16437           DFHEIV99,
 16438           DFHEIV99,
 16439           DFHEIV99
 16440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16441
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 314
* EL130.cbl
 16442
 16443     GO TO 9100-RETURN-TRAN.
 16444
 16445 8200-SEND-DATAONLY.
 16446     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16447
 16448     IF EIBAID = DFHPF11
 16449        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16451        go to 8100-send-initial-map
 16452     end-if
 16453*    IF EIBAID = DFHPF11
 16454*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16455*       move pi-last-claim       to emi-claim-no
 16456*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16457*       go to 8100-send-initial-map
 16458*    END-IF.
 16459     .
 16460 8200-BYPASS-ERROR.
 16461     MOVE SAVE-DATE              TO RUNDTEO.
 16462     MOVE EIBTIME                TO TIME-IN.
 16463     MOVE TIME-OUT               TO RUNTIMEO.
 16464     MOVE PI-COMPANY-ID          TO COMPO.
 16465     MOVE AL-PABOF               TO COMPA
 16466     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16467
 16468*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16469         MOVE SPACES             TO PRODO.
 16470         MOVE AL-SANOF           TO PRODCDA.
 16471*    END-IF.
 16472
 16473     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16474     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16475
 16476     IF PI-PROCESSOR-ID = 'PEMA'
 16477        MOVE AL-UANON            TO CERTNOA
 16478                                    SUFXA
 16479     END-IF.
 16480     IF NOT PI-NO-CARRIER-SECURITY
 16481        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16482        MOVE AL-SABOF            TO CLMCARRA
 16483     END-IF.
 16484
 16485*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16486*        NEXT SENTENCE
 16487*        CONTINUE
 16488*    ELSE
 16489         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16490*    END-IF.
 16491
 16492*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16493         MOVE AL-SANOF           TO PRODCDA.
 16494*    END-IF.
 16495
 16496
 16497
 16498* EXEC CICS SEND
 16499*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 315
* EL130.cbl
 16500*        MAPSET   (MAPSET-NAME)
 16501*        FROM     (EL130AO)
 16502*        DATAONLY
 16503*        CURSOR
 16504*    END-EXEC.
 16505     MOVE LENGTH OF
 16506      EL130AO
 16507       TO DFHEIV12
 16508     MOVE -1
 16509       TO DFHEIV11
 16510*    MOVE '8$D    CT       H L F ,   #00014489' TO DFHEIV0
 16511     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16512     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16513     MOVE X'2020233030303134343839' TO DFHEIV0(25:11)
 16514     CALL 'kxdfhei1' USING DFHEIV0,
 16515           MAP-NAME,
 16516           EL130AO,
 16517           DFHEIV12,
 16518           MAPSET-NAME,
 16519           DFHEIV99,
 16520           DFHEIV99,
 16521           DFHEIV99,
 16522           DFHEIV11,
 16523           DFHEIV99,
 16524           DFHEIV99,
 16525           DFHEIV99
 16526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16527
 16528
 16529     GO TO 9100-RETURN-TRAN.
 16530
 16531 8300-SEND-TEXT.
 16532
 16533
 16534* EXEC CICS SEND TEXT
 16535*        FROM     (LOGOFF-TEXT)
 16536*        LENGTH   (LOGOFF-LENGTH)
 16537*        ERASE
 16538*        FREEKB
 16539*    END-EXEC.
 16540*    MOVE '8&      T  E F  H   F -   #00014501' TO DFHEIV0
 16541     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16542     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16543     MOVE X'2020233030303134353031' TO DFHEIV0(25:11)
 16544     CALL 'kxdfhei1' USING DFHEIV0,
 16545           LOGOFF-TEXT,
 16546           LOGOFF-LENGTH,
 16547           DFHEIV99,
 16548           DFHEIV99,
 16549           DFHEIV99,
 16550           DFHEIV99,
 16551           DFHEIV99,
 16552           DFHEIV99,
 16553           DFHEIV99,
 16554           DFHEIV99,
 16555           DFHEIV99,
 16556           DFHEIV99
 16557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 316
* EL130.cbl
 16558
 16559
 16560
 16561
 16562* EXEC CICS RETURN
 16563*    END-EXEC.
 16564*    MOVE '.(                    ''   #00014509' TO DFHEIV0
 16565     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16566     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16567     MOVE X'2020233030303134353039' TO DFHEIV0(25:11)
 16568     CALL 'kxdfhei1' USING DFHEIV0,
 16569           DFHEIV99,
 16570           DFHEIV99,
 16571           DFHEIV99,
 16572           DFHEIV99,
 16573           DFHEIV99,
 16574           DFHEIV99
 16575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16576
 16577
 16578 8800-UNAUTHORIZED-ACCESS.
 16579     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16580     GO TO 8300-SEND-TEXT.
 16581
 16582 8810-PF23.
 16583     MOVE EIBAID TO PI-ENTRY-CD-1.
 16584     MOVE XCTL-005               TO PGM-NAME.
 16585     GO TO 9300-XCTL.
 16586
 16587 8820-TERM-ERROR.
 16588     MOVE ER-0412                TO EMI-ERROR.
 16589     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16590     MOVE -1                     TO MAINTL.
 16591     GO TO 8200-SEND-DATAONLY.
 16592
 16593 8830-TRAN-ERROR.
 16594     MOVE ER-0413                TO EMI-ERROR.
 16595     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16596     MOVE -1                     TO MAINTL.
 16597     GO TO 8200-SEND-DATAONLY.
 16598
 16599 9000-RETURN-CICS.
 16600
 16601
 16602* EXEC CICS RETURN
 16603*    END-EXEC.
 16604*    MOVE '.(                    ''   #00014535' TO DFHEIV0
 16605     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16606     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16607     MOVE X'2020233030303134353335' TO DFHEIV0(25:11)
 16608     CALL 'kxdfhei1' USING DFHEIV0,
 16609           DFHEIV99,
 16610           DFHEIV99,
 16611           DFHEIV99,
 16612           DFHEIV99,
 16613           DFHEIV99,
 16614           DFHEIV99
 16615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 317
* EL130.cbl
 16616
 16617
 16618 9100-RETURN-TRAN.
 16619     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16620     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16621
 16622
 16623
 16624* EXEC CICS RETURN
 16625*        TRANSID   (TRANS-ID)
 16626*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16627*        LENGTH    (PI-COMM-LENGTH)
 16628*    END-EXEC.
 16629*    MOVE '.(CT                  ''   #00014543' TO DFHEIV0
 16630     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16631     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16632     MOVE X'2020233030303134353433' TO DFHEIV0(25:11)
 16633     CALL 'kxdfhei1' USING DFHEIV0,
 16634           TRANS-ID,
 16635           PROGRAM-INTERFACE-BLOCK,
 16636           PI-COMM-LENGTH,
 16637           DFHEIV99,
 16638           DFHEIV99,
 16639           DFHEIV99
 16640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16641
 16642
 16643 9200-RETURN-MAIN-MENU.
 16644     MOVE XCTL-126               TO PGM-NAME.
 16645     GO TO 9300-XCTL.
 16646
 16647 9300-XCTL.
 16648
 16649
 16650* EXEC CICS XCTL
 16651*        PROGRAM   (PGM-NAME)
 16652*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16653*        LENGTH    (PI-COMM-LENGTH)
 16654*    END-EXEC.
 16655*    MOVE '.$C                   %   #00014555' TO DFHEIV0
 16656     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16657     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16658     MOVE X'2020233030303134353535' TO DFHEIV0(25:11)
 16659     CALL 'kxdfhei1' USING DFHEIV0,
 16660           PGM-NAME,
 16661           PROGRAM-INTERFACE-BLOCK,
 16662           PI-COMM-LENGTH,
 16663           DFHEIV99
 16664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16665
 16666
 16667 9400-CLEAR.
 16668     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16669     GO TO 9300-XCTL.
 16670
 16671 9500-PF12.
 16672     MOVE XCTL-010               TO PGM-NAME.
 16673     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 318
* EL130.cbl
 16674
 16675 9600-PGMID-ERROR.
 16676
 16677
 16678* EXEC CICS HANDLE CONDITION
 16679*        PGMIDERR  (8300-SEND-TEXT)
 16680*    END-EXEC.
 16681*    MOVE '"$L                   ! M #00014571' TO DFHEIV0
 16682     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16684     MOVE X'4D20233030303134353731' TO DFHEIV0(25:11)
 16685     CALL 'kxdfhei1' USING DFHEIV0
 16686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16687
 16688
 16689     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16690     MOVE ' '                    TO PI-ENTRY-CD-1.
 16691     MOVE XCTL-005               TO PGM-NAME.
 16692     MOVE PGM-NAME               TO LOGOFF-PGM.
 16693     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16694     GO TO 9300-XCTL.
 16695
 16696 9700-LINK-DATE-CONVERT.
 16697     MOVE LINK-ELDATCV           TO PGM-NAME.
 16698
 16699
 16700* EXEC CICS LINK
 16701*        PROGRAM    (PGM-NAME)
 16702*        COMMAREA   (DATE-CONVERSION-DATA)
 16703*        LENGTH     (DC-COMM-LENGTH)
 16704*    END-EXEC.
 16705*    MOVE '."C                   (   #00014585' TO DFHEIV0
 16706     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16707     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16708     MOVE X'2020233030303134353835' TO DFHEIV0(25:11)
 16709     CALL 'kxdfhei1' USING DFHEIV0,
 16710           PGM-NAME,
 16711           DATE-CONVERSION-DATA,
 16712           DC-COMM-LENGTH,
 16713           DFHEIV99,
 16714           DFHEIV99,
 16715           DFHEIV99,
 16716           DFHEIV99
 16717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16718
 16719
 16720 9700-EXIT.
 16721     EXIT.
 16722
 16723 9800-LINK-REM-TERM.
 16724     MOVE LINK-ELRTRM            TO PGM-NAME.
 16725
 16726
 16727* EXEC CICS LINK
 16728*        PROGRAM    (PGM-NAME)
 16729*        COMMAREA   (CALCULATION-PASS-AREA)
 16730*        LENGTH     (CP-COMM-LENGTH)
 16731*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 319
* EL130.cbl
 16732*    MOVE '."C                   (   #00014597' TO DFHEIV0
 16733     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16734     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16735     MOVE X'2020233030303134353937' TO DFHEIV0(25:11)
 16736     CALL 'kxdfhei1' USING DFHEIV0,
 16737           PGM-NAME,
 16738           CALCULATION-PASS-AREA,
 16739           CP-COMM-LENGTH,
 16740           DFHEIV99,
 16741           DFHEIV99,
 16742           DFHEIV99,
 16743           DFHEIV99
 16744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16745
 16746
 16747 9800-EXIT.
 16748     EXIT.
 16749
 16750 9900-ERROR-FORMAT.
 16751*    if emi-error = 1651 or 1652 or 1653 or 1655
 16752*       display ' 9900 error ' emi-error
 16753*       display emi-message-area (1)
 16754*       display emi-message-area (2)
 16755*       display emi-message-area (3)
 16756*    end-if
 16757     IF NOT EMI-ERRORS-COMPLETE
 16758         MOVE LINK-001           TO PGM-NAME
 16759
 16760* EXEC CICS LINK
 16761*            PROGRAM   (PGM-NAME)
 16762*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 16763*            LENGTH    (EMI-COMM-LENGTH)
 16764*        END-EXEC
 16765*    MOVE '."C                   (   #00014615' TO DFHEIV0
 16766     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16767     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16768     MOVE X'2020233030303134363135' TO DFHEIV0(25:11)
 16769     CALL 'kxdfhei1' USING DFHEIV0,
 16770           PGM-NAME,
 16771           ERROR-MESSAGE-INTERFACE-BLOCK,
 16772           EMI-COMM-LENGTH,
 16773           DFHEIV99,
 16774           DFHEIV99,
 16775           DFHEIV99,
 16776           DFHEIV99
 16777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16778         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 16779            subtract 1 from emi-fatal-ctr
 16780         end-if
 16781     END-IF.
 16782
 16783     .
 16784 9900-EXIT.
 16785     EXIT.
 16786
 16787 9990-ABEND.
 16788     MOVE -1                     TO MAINTL.
 16789     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 320
* EL130.cbl
 16790     MOVE DFHEIBLK               TO EMI-LINE1.
 16791
 16792
 16793* EXEC CICS LINK
 16794*        PROGRAM   (PGM-NAME)
 16795*        COMMAREA  (EMI-LINE1)
 16796*        LENGTH    (72)
 16797*    END-EXEC.
 16798     MOVE 72
 16799       TO DFHEIV11
 16800*    MOVE '."C                   (   #00014634' TO DFHEIV0
 16801     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16803     MOVE X'2020233030303134363334' TO DFHEIV0(25:11)
 16804     CALL 'kxdfhei1' USING DFHEIV0,
 16805           PGM-NAME,
 16806           EMI-LINE1,
 16807           DFHEIV11,
 16808           DFHEIV99,
 16809           DFHEIV99,
 16810           DFHEIV99,
 16811           DFHEIV99
 16812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16813
 16814
 16815     MOVE EMI-LINE1              TO ERRMSG2O.
 16816
 16817     GO TO 8200-BYPASS-ERROR.
 16818
 16819
 16820
 16821* GOBACK.
 16822     MOVE '9%                    "   ' TO DFHEIV0
 16823     MOVE 'EL130' TO DFHEIV1
 16824     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16825     GOBACK.
 16826
 16827 9995-SECURITY-VIOLATION.
 16828*             COPY ELCSCTP.
 16829******************************************************************
 16830*                                                                *
 16831*                            ELCSCTP                             *
 16832*                            VMOD=2.001                          *
 16833*                                                                *
 16834*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16835******************************************************************
 16836
 16837
 16838     MOVE EIBDATE          TO SM-JUL-DATE.
 16839     MOVE EIBTRMID         TO SM-TERMID.
 16840     MOVE THIS-PGM         TO SM-PGM.
 16841     MOVE EIBTIME          TO TIME-IN.
 16842     MOVE TIME-OUT         TO SM-TIME.
 16843     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16844
 16845
 16846* EXEC CICS LINK
 16847*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 321
* EL130.cbl
 16848*         COMMAREA (SECURITY-MESSAGE)
 16849*         LENGTH   (80)
 16850*    END-EXEC.
 16851     MOVE 'EL003' TO DFHEIV1
 16852     MOVE 80
 16853       TO DFHEIV11
 16854*    MOVE '."C                   (   #00014665' TO DFHEIV0
 16855     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16856     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16857     MOVE X'2020233030303134363635' TO DFHEIV0(25:11)
 16858     CALL 'kxdfhei1' USING DFHEIV0,
 16859           DFHEIV1,
 16860           SECURITY-MESSAGE,
 16861           DFHEIV11,
 16862           DFHEIV99,
 16863           DFHEIV99,
 16864           DFHEIV99,
 16865           DFHEIV99
 16866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16867
 16868
 16869******************************************************************
 16870
 16871
 16872 9995-EXIT.
 16873     EXIT.
 16874
 16875
 16876 9999-DFHBACK SECTION.
 16877     MOVE '9%                    "   ' TO DFHEIV0
 16878     MOVE 'EL130' TO DFHEIV1
 16879     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16880     GOBACK.
 16881 9999-DFHEXIT.
 16882     IF DFHEIGDJ EQUAL 0001
 16883         NEXT SENTENCE
 16884     ELSE IF DFHEIGDJ EQUAL 2
 16885         GO TO 0100-TEST-ENTRY,
 16886               8100-SEND-INITIAL-MAP,
 16887               9600-PGMID-ERROR,
 16888               8820-TERM-ERROR,
 16889               8830-TRAN-ERROR,
 16890               9990-ABEND
 16891         DEPENDING ON DFHEIGDI
 16892     ELSE IF DFHEIGDJ EQUAL 3
 16893         GO TO 0450-ADD-ELACTQ-RECORD
 16894         DEPENDING ON DFHEIGDI
 16895     ELSE IF DFHEIGDJ EQUAL 4
 16896         GO TO 8820-TERM-ERROR,
 16897               8830-TRAN-ERROR
 16898         DEPENDING ON DFHEIGDI
 16899     ELSE IF DFHEIGDJ EQUAL 5
 16900         GO TO 0660-NOT-FOUND,
 16901               0670-QIDERR
 16902         DEPENDING ON DFHEIGDI
 16903     ELSE IF DFHEIGDJ EQUAL 6
 16904         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16905         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 322
* EL130.cbl
 16906     ELSE IF DFHEIGDJ EQUAL 7
 16907         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16908         DEPENDING ON DFHEIGDI
 16909     ELSE IF DFHEIGDJ EQUAL 8
 16910         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16911         DEPENDING ON DFHEIGDI
 16912     ELSE IF DFHEIGDJ EQUAL 9
 16913         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16914         DEPENDING ON DFHEIGDI
 16915     ELSE IF DFHEIGDJ EQUAL 10
 16916         GO TO 2050-DELETE-NOT-FOUND
 16917         DEPENDING ON DFHEIGDI
 16918     ELSE IF DFHEIGDJ EQUAL 11
 16919         GO TO 2010-DELETE-CL
 16920         DEPENDING ON DFHEIGDI
 16921     ELSE IF DFHEIGDJ EQUAL 12
 16922         GO TO 3010-TEST-FOR-ERRORS
 16923         DEPENDING ON DFHEIGDI
 16924     ELSE IF DFHEIGDJ EQUAL 13
 16925         GO TO 3008-DUP-ERROR,
 16926               3009-NOT-FOUND
 16927         DEPENDING ON DFHEIGDI
 16928     ELSE IF DFHEIGDJ EQUAL 14
 16929         GO TO 3030-BUILD-CONT
 16930         DEPENDING ON DFHEIGDI
 16931     ELSE IF DFHEIGDJ EQUAL 15
 16932         GO TO 3033-ACCT-NOT-FOUND,
 16933               3033-ACCT-NOT-FOUND
 16934         DEPENDING ON DFHEIGDI
 16935     ELSE IF DFHEIGDJ EQUAL 16
 16936         GO TO 3032-NOT-IN-DT-RANGE
 16937         DEPENDING ON DFHEIGDI
 16938     ELSE IF DFHEIGDJ EQUAL 17
 16939         GO TO 3070-BUILD-CONT
 16940         DEPENDING ON DFHEIGDI
 16941     ELSE IF DFHEIGDJ EQUAL 18
 16942         GO TO 3065-CERT-NOT-FOUND
 16943         DEPENDING ON DFHEIGDI
 16944     ELSE IF DFHEIGDJ EQUAL 19
 16945         GO TO 3100-CARRIER-NOT-FOUND
 16946         DEPENDING ON DFHEIGDI
 16947     ELSE IF DFHEIGDJ EQUAL 20
 16948         GO TO 3110-COMPANY-NOT-FOUND
 16949         DEPENDING ON DFHEIGDI
 16950     ELSE IF DFHEIGDJ EQUAL 21
 16951         GO TO 3200-BUILD-ZERO-TRAILER
 16952         DEPENDING ON DFHEIGDI
 16953     ELSE IF DFHEIGDJ EQUAL 22
 16954         GO TO 9999-DFHBACK
 16955         DEPENDING ON DFHEIGDI
 16956     ELSE IF DFHEIGDJ EQUAL 23
 16957         GO TO 3290-NO-INSURED-ADDRESS
 16958         DEPENDING ON DFHEIGDI
 16959     ELSE IF DFHEIGDJ EQUAL 24
 16960         GO TO 3410-DUP-KEY
 16961         DEPENDING ON DFHEIGDI
 16962     ELSE IF DFHEIGDJ EQUAL 25
 16963         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 323
* EL130.cbl
 16964         DEPENDING ON DFHEIGDI
 16965     ELSE IF DFHEIGDJ EQUAL 26
 16966         GO TO 3850-CLAIM-MSTR-WRITTEN
 16967         DEPENDING ON DFHEIGDI
 16968     ELSE IF DFHEIGDJ EQUAL 27
 16969         GO TO 5050-CERT-NOT-FOUND
 16970         DEPENDING ON DFHEIGDI
 16971     ELSE IF DFHEIGDJ EQUAL 28
 16972         GO TO 5030-CERT-WRITTEN
 16973         DEPENDING ON DFHEIGDI
 16974     ELSE IF DFHEIGDJ EQUAL 29
 16975         GO TO 5035-CLAIM-WRITTEN
 16976         DEPENDING ON DFHEIGDI
 16977     ELSE IF DFHEIGDJ EQUAL 30
 16978         GO TO 9990-ABEND,
 16979               5799-EXIT
 16980         DEPENDING ON DFHEIGDI
 16981     ELSE IF DFHEIGDJ EQUAL 31
 16982         GO TO 3100-CARRIER-NOT-FOUND
 16983         DEPENDING ON DFHEIGDI
 16984     ELSE IF DFHEIGDJ EQUAL 32
 16985         GO TO 6040-NO-PROCESSOR-RECORD
 16986         DEPENDING ON DFHEIGDI
 16987     ELSE IF DFHEIGDJ EQUAL 33
 16988         GO TO 6060-NO-BENEFICIARY-RECORD
 16989         DEPENDING ON DFHEIGDI
 16990     ELSE IF DFHEIGDJ EQUAL 34
 16991         GO TO 6499-EXIT,
 16992               6499-EXIT
 16993         DEPENDING ON DFHEIGDI
 16994     ELSE IF DFHEIGDJ EQUAL 35
 16995         GO TO 6600-NOT-FOUND
 16996         DEPENDING ON DFHEIGDI
 16997     ELSE IF DFHEIGDJ EQUAL 36
 16998         GO TO 6700-NOTOPEN-ERROR,
 16999               6700-EXIT
 17000         DEPENDING ON DFHEIGDI
 17001     ELSE IF DFHEIGDJ EQUAL 37
 17002         GO TO 7120-NOT-FOUND
 17003         DEPENDING ON DFHEIGDI
 17004     ELSE IF DFHEIGDJ EQUAL 38
 17005         GO TO 7499-EXIT
 17006         DEPENDING ON DFHEIGDI
 17007     ELSE IF DFHEIGDJ EQUAL 39
 17008         GO TO 7500-EXIT,
 17009               7500-DUPLICATE-KEY,
 17010               7500-EXIT
 17011         DEPENDING ON DFHEIGDI
 17012     ELSE IF DFHEIGDJ EQUAL 40
 17013         GO TO 7500-END-BROWSE
 17014         DEPENDING ON DFHEIGDI
 17015     ELSE IF DFHEIGDJ EQUAL 41
 17016         GO TO 7630-END-BROWSE
 17017         DEPENDING ON DFHEIGDI
 17018     ELSE IF DFHEIGDJ EQUAL 42
 17019         GO TO 7799-EXIT,
 17020               7799-EXIT
 17021         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:51 Page 324
* EL130.cbl
 17022     ELSE IF DFHEIGDJ EQUAL 43
 17023         GO TO 7790-END-BROWSE
 17024         DEPENDING ON DFHEIGDI
 17025     ELSE IF DFHEIGDJ EQUAL 44
 17026         GO TO 7992-NOT-FOUND
 17027         DEPENDING ON DFHEIGDI
 17028     ELSE IF DFHEIGDJ EQUAL 45
 17029         GO TO 8300-SEND-TEXT
 17030         DEPENDING ON DFHEIGDI.
 17031     MOVE '9%                    "   ' TO DFHEIV0
 17032     MOVE 'EL130' TO DFHEIV1
 17033     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17034     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12280     Code:       54001
