* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.   NSRASBL.
     4*AUTHOR.     PABLO
     5*            COLLEYVILLE, TEXAS.
     6*REMARKS.    EXECUTED FROM NSRASLTR
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page   2
* NSRASBL.cbl
    14*-----------------------------------------------------------------
    15* 060611    2011022800001  PEMA  NEW PROGRAM
    16* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    17* 071212    2011022800001  AJRA  ADD UNDW ID
    18* 072312    2011022800001  AJRA    ADD NEW FIELDS
    19* 090612  IR2012090600001  AJRA  NAPERSOFT
    20* 091112  IR2012091100002  AJRA  FIX AKA
    21* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    22* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    23* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    24* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    25* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    26* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    27* 110612    2012101700002  AJRA  ADD NEW FIELDS
    28* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    29* 121712    2012101700002  AJRA  ADD DEFAULT AGE FLAG
    30* 050213    2013050100001  AJRA  FIX AH REFUND ON DEATH CLAIM
    31* 091213    2013090300001  AJRA  NAPERSOFT PHASE 2
    32* 123113    2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    33* 011314  IR2014011300001  AJRA  FIX NEXT BUS DT AND ENDORSEMENT A
    34* 011514    2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    35* 021214  IR2014021200002  AJRA  ADD SQL DISCONNECT
    36* 121015  CR2015100900001  TANA  ADD VIN NUMBER
    37* 020916  CR2016010700001  TANA  CALL SQL LOOKUP NAPERSOFT TABLE
    38* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41 DATA DIVISION.
    42 working-storage section.
    43 01  DFH-START PIC X(04).
    44 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    45 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    46 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    47 77  SAVE-BIN-NEXT-BUS-DT        PIC XX      VALUE SPACES.
    48 77  SAVE-NEXT-BUS-DT-EDIT-A     PIC X(10)   VALUE SPACES.
    49 77  SAVE-CYCLE-DAY-OF-WEEK      PIC S9   COMP-3 VALUE +0.
    50 77  S1                          PIC S999 COMP-3 VALUE +0.
    51 77  E1                          PIC S999 COMP-3 VALUE +0.
    52 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    53 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    54 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    55 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    56 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    57 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    58 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    59 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    60 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    61 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    62 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    63 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    64     88  FOUND-BENE                  VALUE 'Y'.
    65 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    66 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    67 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    68 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    69     88  END-OF-ERPNDB              VALUE 'Y'.
    70 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    71     88  ACCT-FOUND                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page   3
* NSRASBL.cbl
    72 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    73     88  CERT-FOUND                 VALUE 'Y'.
    74     88  CERT-NOT-FOUND             VALUE 'N'.
    75 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    76     88  ENDT-FOUND                 VALUE 'Y'.
    77     88  ENDT-NOT-FOUND             VALUE 'N'.
    78 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    79     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    80 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    81 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    82 77  WS-LF-EARN                  PIC X     VALUE ' '.
    83 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    84 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    85 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    86 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    87 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    88 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    89 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    90 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    91 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    92 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    93 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    94 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    95 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    96 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    97 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    98 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    99 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
   100 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
   101     88  PROCESS-ISSUE               VALUE 'I'.
   102     88  PROCESS-CANCEL              VALUE 'C'.
   103 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
   104 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
   105 77  WS-DIFF                     PIC 999 VALUE ZEROS.
   106 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
   107 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
   108 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
   109 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
   110 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
*  111 EXEC SQL
*  112    INCLUDE SQLDA
*  113 END-EXEC
   114 01 SQLDA sync.
   115    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   116    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   117    05 SQLN                  PIC S9(4) COMP-5 value 0.
   118    05 SQLD                  PIC S9(4) COMP-5 value 0.
   119    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   120       10 SQLTYPE            PIC S9(4) COMP-5.
   121       10 SQLLEN             PIC S9(4) COMP-5.
   122$IF P64 SET
   123X      *> For 64-bit environments, ensure that SQLDATA is
   124X      *> aligned on an 8-byte boundary.
   125X      10 FILLER             PIC S9(9) COMP-5.
   126$END
   127       10 SQLDATA            USAGE POINTER.
   128       10 SQLIND             USAGE POINTER.
   129       10 SQLNAME.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page   4
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130          15 SQLNAMEL        PIC S9(4) COMP-5.
   131          15 SQLNAMEC        PIC X(30).
   132
   133* Values for SQLTYPE
   134
   135 78  ESQL-DATE-CHAR              VALUE 384.
   136 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   137 78  ESQL-DATE-REC               VALUE 386.
   138 78  ESQL-DATE-REC-NULL          VALUE 387.
   139 78  ESQL-TIME-CHAR              VALUE 388.
   140 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   141 78  ESQL-TIME-REC               VALUE 390.
   142 78  ESQL-TIME-REC-NULL          VALUE 391.
   143 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   144 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   145 78  ESQL-TIMESTAMP-REC          VALUE 394.
   146 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   147 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   148 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   149 78  ESQL-TS-OFFSET-REC          VALUE 398.
   150 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   151 78  ESQL-LONGVARBINARY          VALUE 404.
   152 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   153 78  ESQL-LONGVARCHAR            VALUE 408.
   154 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   155 78  ESQL-BINARY                 VALUE 444.
   156 78  ESQL-BINARY-NULL            VALUE 445.
   157 78  ESQL-VARBINARY              VALUE 446.
   158 78  ESQL-VARBINARY-NULL         VALUE 447.
   159 78  ESQL-VARCHAR                VALUE 448.
   160 78  ESQL-VARCHAR-NULL           VALUE 449.
   161
   162 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   163 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   164
   165 78  ESQL-CHAR                   VALUE 452.
   166 78  ESQL-CHAR-NULL              VALUE 453.
   167
   168 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   169 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   170
   171 78  ESQL-DOUBLE                 VALUE 480.
   172 78  ESQL-DOUBLE-NULL            VALUE 481.
   173 78  ESQL-REAL                   VALUE 482.
   174 78  ESQL-REAL-NULL              VALUE 483.
   175 78  ESQL-DECIMAL                VALUE 484.
   176 78  ESQL-DECIMAL-NULL           VALUE 485.
   177 78  ESQL-INTEGER                VALUE 496.
   178 78  ESQL-INTEGER-NULL           VALUE 497.
   179 78  ESQL-SMALLINT               VALUE 500.
   180 78  ESQL-SMALLINT-NULL          VALUE 501.
   181 78  ESQL-TINYINT                VALUE 502.
   182 78  ESQL-TINYINT-NULL           VALUE 503.
   183
*  184 EXEC SQL
*  185    INCLUDE SQLCA
*  186 END-EXEC
   187 01 SQLCA.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page   5
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   189     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   190     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   191     05  SQLERRM.
   192         49  SQLERRML    PIC S9(4) COMP-5.
   193         49  SQLERRMC    PIC X(70).
   194     05  SQLERRP         PIC X(8).
   195     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   196     05  SQLWARN.
   197         10  SQLWARN0    PIC X.
   198         10  SQLWARN1    PIC X.
   199         10  SQLWARN2    PIC X.
   200         10  SQLWARN3    PIC X.
   201         10  SQLWARN4    PIC X.
   202         10  SQLWARN5    PIC X.
   203         10  SQLWARN6    PIC X.
   204         10  SQLWARN7    PIC X.
   205     05  SQLEXT.
   206         10  SQLWARN8    PIC X.
   207         10  SQLWARN9    PIC X.
   208         10  SQLWARN10   PIC X.
   209         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   210     05  SQLSTATE    PIC X(5).
   211
   212 EXEC SQL
   213    BEGIN DECLARE SECTION
   214 END-EXEC
   215
   216 01  SQLCMD                      PIC X(1024).
   217 01  SVR                         PIC X(32).
   218 01  USR                         PIC X(32).
   219 01  PASS                        PIC X(32).
   220 01  USR-PASS                    PIC X(64).
   221
   222 01  WS-SQL-DATA.
   223     05  WS-CYCLE-DATE           PIC X(10).
   224     05  WS-NEXT-BUS-DT          PIC X(10).
   225     05  WS-LOOKUPID             PIC X(4).
   226     05  WS-LOOKUPKEY            PIC X(4).
   227     05  WS-LOOKUP-VALUE         PIC X(100).
   228
   229 EXEC SQL
   230    END DECLARE SECTION
   231 END-EXEC
   232
   233
   234 01  P pointer.
   235 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   236 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   237 01  var-ptr pointer.
   238 01  env-var-len                 pic 9(4)  binary.
   239 01  rc                          pic 9(9)  binary.
   240
   241 01  WS-KIXHOST                  PIC X(10).
   242 01  WS-KIXSYS.
   243     05  WS-KIX-FIL1             PIC X(10).
   244     05  WS-KIX-APPS             PIC X(10).
   245     05  WS-KIX-ENV              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page   6
* NSRASBL.cbl
   246     05  WS-KIX-MYENV            PIC X(10).
   247     05  WS-KIX-SYS              PIC X(10).
   248
   249 01  WS-CALC-FIELDS.
   250     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
   251     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
   252     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   253     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   254     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   255     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   256     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   257     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   258     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   259     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   260     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   261     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   262     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   263     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   264     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   265     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   266     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   267     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   268     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   269     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   270     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   271     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   272     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   273     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   274     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   275     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   276     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   277     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   278     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   279     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   280     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   281     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   282     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   283     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   284     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   285     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   286     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   287     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   288     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   289     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   290     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   291     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   292 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   293 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   294 01 response-code         pic s9(8) comp.
   295 01 display-response      pic 9(8).
   296 01 bl-index              pic 9(8) comp.
   297 01 max-last-name         pic x(18).
   298 01 first-initial         pic x.
   299 01 name-in-range-flag    pic 9.
   300 01 max-entries           pic s9(8) comp value 100.
   301 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   302 01 lower-case    pic x(26) value
   303            "abcdefghijklmnopqrstuvwxyz".
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page   7
* NSRASBL.cbl
   304 01 upper-case    pic x(26) value
   305            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   306
   307*                                COPY ELCVADS.
   308******************************************************************
   309*                                                                *
   310*                                                                *
   311*                            ELCVADS.                            *
   312*                                                                *
   313*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   314*   ELVADS                  LENGTH = 350                         *
   315******************************************************************
   316******************************************************************
   317*                   C H A N G E   L O G
   318*
   319* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   320*-----------------------------------------------------------------
   321*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   322* EFFECTIVE    NUMBER
   323*-----------------------------------------------------------------
   324* 100111    2011022800001  AJRA  NAPERSOFT
   325******************************************************************
   326
   327 01  VIRGINIA-DISCLOSURE.
   328     12  VD-COMPANY-CD              PIC X.
   329     12  VD-CARRIER                 PIC X.
   330     12  VD-GROUPING.
   331         20  VD-GROUPING-PREFIX     PIC XXX.
   332         20  VD-GROUPING-PRIME      PIC XXX.
   333     12  VD-STATE                   PIC XX.
   334     12  VD-ACCOUNT.
   335         20  VD-ACCOUNT-PREFIX      PIC X(4).
   336         20  VD-ACCOUNT-PRIME       PIC X(6).
   337     12  VD-CERT-EFF-DT             PIC XX.
   338     12  VD-CERT-NO.
   339         20  VD-CERT-PRIME          PIC X(10).
   340         20  VD-CERT-SFX            PIC X.
   341     12  VD-ENTRY-BATCH             PIC X(6).
   342     12  VD-CSR-ID                  PIC X(4).
   343     12  VD-NAME.
   344         20  VD-INSURED-LAST-NAME   PIC X(15).
   345         20  VD-INSURED-FIRST-NAME.
   346             24  VD-INSURED-1ST-INIT PIC X.
   347             24  FILLER             PIC X(9).
   348         20  VD-INSURED-MIDDLE-INIT PIC X.
   349     12  VD-JOINT-INSURED.
   350         20 VD-JOINT-LAST-NAME      PIC X(15).
   351         20 VD-JOINT-FIRST-NAME.
   352            24  VD-JOINT-FIRST-INIT PIC X.
   353            24  FILLER              PIC X(9).
   354         20 VD-JOINT-MIDDLE-INIT    PIC X.
   355     12  VD-INSURED-ADDRESS-1       PIC X(30).
   356     12  VD-INSURED-ADDRESS-2       PIC X(30).
   357     12  VD-INSURED-CITY-STATE.
   358         20  VD-INSURED-CITY        PIC X(28).
   359         20  VD-INSURED-STATE       PIC XX.
   360     12  VD-INSURED-ZIP-CODE.
   361         20  VD-INSURED-ZIP-PRIME.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page   8
* NSRASBL.cbl
   362             24  VD-INSURED-ZIP-1   PIC X.
   363                 88  VD-CANADIAN-POST-CODE
   364                                       VALUE 'A' THRU 'Z'.
   365             24  FILLER             PIC X(4).
   366         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   367     12  VD-BENEFICIARY-NAME        PIC X(30).
   368     12  VD-ACCOUNT-NAME            PIC X(30).
   369     12  VD-LOAN-TERM               PIC S999   COMP-3.
   370     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   371     12  VD-1ST-PMT-DT              PIC XX.
   372     12  VD-LIFE-BENEFIT-CD         PIC XX.
   373         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   374         88  VD-INVALID-LIFE           VALUE '  ' '00'
   375                                             '90' THRU '99'.
   376     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   377                                    PIC XX.
   378     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   379     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   380     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   381     12  VD-LF-TERM                 PIC S999   COMP-3.
   382     12  VD-AH-BENEFIT-CD           PIC XX.
   383         88  VD-VALID-AH               VALUE '01' THRU '89'.
   384         88  VD-INVALID-AH             VALUE '  ' '00'
   385                                             '90' THRU '99'.
   386     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   387     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   388     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   389     12  VD-AH-TERM                 PIC S999   COMP-3.
   390     12  VD-LETTER-ID               PIC X(4).
   391     12  VD-PROC-ID                 PIC X(4).
   392     12  VD-COMP-ID                 PIC X(3).
   393     12  VD-CURRENT-DATE            PIC XX.
   394     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   395     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   396     12  FILLER                     PIC X(32).
   397 01  WS-PASS-AREA.
   398     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   399     05  WS-PASS-VADS-REC    PIC X(350).
   400
   401*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   402*                         COPY ELCZREC.
   403******************************************************************
   404*                                                                *
   405*                                                                *
   406*                            ELCZREC.                            *
   407*                                                                *
   408*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   409*                                                                *
   410******************************************************************
   411*-----------------------------------------------------------------
   412*                   C H A N G E   L O G
   413*
   414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   415*-----------------------------------------------------------------
   416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   417* EFFECTIVE    NUMBER
   418*-----------------------------------------------------------------
   419* 122011    2011022800001  AJRA  NEW FILE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page   9
* NSRASBL.cbl
   420* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   421* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   422* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   423* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   424*-----------------------------------------------------------------
   425 01  W-Z-CONTROL-DATA.
   426     05  W-NUMBER-OF-COPIES      PIC  9.
   427     05  FILLER                  PIC  X.
   428     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   429     05  FILLER                  PIC  X.
   430     05  W-DAYS-TO-RESEND        PIC  999.
   431     05  FILLER                  PIC  X.
   432     05  W-FORM-TO-RESEND        PIC  X(4).
   433     05  W-ADD-BAR-CODE          PIC  X.
   434     05  W-PROMPT-LETTER         PIC  X.
   435     05  W-HAS-RETURN-ENV        PIC  X.
   436     05  W-ENCLOSURE-CD          PIC  XXX.
   437     05  W-SIG-FLAG-DEFAULT      PIC  X.
   438     05  W-AUTO-CLOSE-IND        PIC  X.
   439     05  FILLER                  PIC  X.
   440     05  W-LETTER-TO-BENE        PIC  X.
   441     05  FILLER                  PIC  X.
   442     05  W-LETTER-TO-ACCT        PIC  X.
   443     05  FILLER                  PIC  X.
   444     05  W-LETTER-TYPE           PIC  X.
   445     05  FILLER                  PIC  X.
   446     05  W-PRINT-CERTIFICATE     PIC  X.
   447     05  FILLER                  PIC  X.
   448     05  W-REFUND-REQUIRED       PIC  X.
   449     05  FILLER                  PIC  X.
   450     05  W-ONBASE-CODE           PIC  XX.
   451     05  FILLER                  PIC  X.
   452     05  W-ACCT-SUMM             PIC  X.
   453     05  FILLER                  PIC  X.
   454     05  W-CSO-SUMM              PIC  X.
   455     05  FILLER                  PIC  X.
   456     05  W-REASONS-REQUIRED      PIC  X.
   457     05  FILLER                  PIC  X(29).
   458 01  MISC.
   459     12  WS-RESPONSE             PIC S9(8)   COMP.
   460         88  RESP-NORMAL                  VALUE +00.
   461         88  RESP-NOTFND                  VALUE +13.
   462         88  RESP-DUPREC                  VALUE +14.
   463         88  RESP-DUPKEY                  VALUE +15.
   464         88  RESP-NOTOPEN                 VALUE +19.
   465         88  RESP-ENDFILE                 VALUE +20.
   466
   467     12  WS-EDIT-A-DATE.
   468         16  WS-EDIT-A-MM                 PIC X(2).
   469         16  FILLER                       PIC X(1).
   470         16  WS-EDIT-A-DD                 PIC X(2).
   471         16  FILLER                       PIC X(1).
   472         16  WS-EDIT-A-CCYY.
   473             20  WS-EDIT-A-CC             PIC X(2).
   474             20  WS-EDIT-A-YY             PIC X(2).
   475 01  srch-commarea.
   476*                                copy ELCADLTRSPI.
   477******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  10
* NSRASBL.cbl
   478*                   C H A N G E   L O G
   479*
   480* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   481*-----------------------------------------------------------------
   482*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   483* EFFECTIVE    NUMBER
   484*-----------------------------------------------------------------
   485* 060611    2011022800001  PEMA  NEW COPYBOOK
   486* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   487* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   488******************************************************************
   489****************************************
   490*  commarea for NaperSoft On Demand Admin services letters
   491*  (business logic input & output)
   492****************************************
   493     03  BL-INPUT.
   494         05  BL-DATA-SRCE        PIC X.
   495         05  BL-LETTER-ID        PIC XXXX.
   496         05  BL-CARRIER          PIC X.
   497         05  BL-GROUP            PIC X(6).
   498         05  BL-STATE            PIC XX.
   499         05  BL-ACCOUNT          PIC X(10).
   500         05  BL-EFF-DT           PIC X(10).
   501         05  BL-CERT-NO          PIC X(11).
   502         05  BL-BATCH-NO         PIC X(6).
   503         05  BL-BATCH-SEQ        PIC 9(8).
   504         05  BL-RESP-NO          PIC X(10).
   505         05  BL-NO-OF-COPIES     PIC 99.
   506         05  BL-PROC-ID          PIC XXXX.
   507         05  BL-COMP-ID          PIC XXX.
   508         05  BL-PRINT-NOW-SW     PIC X.
   509         05  BL-ENC-CD           PIC XXX.
   510         05  BL-RESEND-DT        PIC X(10).
   511         05  BL-FOLLOW-UP-DT     PIC X(10).
   512         05  BL-ARCHIVE-NO       PIC 9(8).
   513         05  BL-FUNC             PIC X(8).
   514         05  BL-COMMENTS         PIC X(100).
   515         05  FILLER REDEFINES BL-COMMENTS.
   516             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   517             10  BL-LETTER-TO-ACCT PIC X.
   518             10  BL-LETTER-TO-BENE PIC X.
   519             10  BL-WRITE-ERARCH   PIC X.
   520                 88  ERARCH-QWS      VALUE 'Q'.
   521                 88  ERARCH-BATCH    VALUE 'B'.
   522                 88  ERARCH-TEMP     VALUE 'T'.
   523             10  BL-PROCESS-TYPE PIC X(07).
   524             10  BL-CERT-FORM-ID PIC X(05).
   525             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   526             10  BL-SOURCE-SCREEN PIC X(8).
   527             10  FILLER          PIC X(25).
   528     03  BL-OUTPUT.
   529         05  BL-STATUS                   PIC X.
   530             88  BL-OK                      VALUE "P".
   531             88  BL-FAIL                  VALUE "F".
   532         05  BL-MESSAGE          PIC X(50).
   533     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   534     03  FILLER                  PIC X(31).
   535 01  filler                      pic x(500).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  11
* NSRASBL.cbl
   536 01  WS-SAVE-CARRIER-INFO.
   537     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   538     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   539     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   540     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   541     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   542     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   543     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   544     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   545 01  WS-SAVE-STATE-INFO.
   546     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   547     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   548 01  WS-SAVE-LFBEN-INFO.
   549     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   550     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   551     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   552 01  WS-SAVE-AHBEN-INFO.
   553     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   554     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   555     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   556     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   557 01  WS-ERPNDB-KEY.
   558     05  WS-ERPNDB-COMPANY-CD    PIC X.
   559     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   560     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   561     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   562 01  WS-ELENCC-KEY.
   563     05  WS-ELENCC-COMPANY-CD    PIC X.
   564     05  WS-ELENCC-REC-TYPE      PIC X.
   565     05  WS-ELENCC-ENC-CODE      PIC X(5).
   566     05  F                       PIC X(9).
   567 01  WS-ELCERT-KEY.
   568     05  WS-ELCERT-COMPANY-CD    PIC X.
   569     05  WS-ELCERT-CARRIER       PIC X.
   570     05  WS-ELCERT-GROUP         PIC X(6).
   571     05  WS-ELCERT-STATE         PIC XX.
   572     05  WS-ELCERT-ACCOUNT       PIC X(10).
   573     05  WS-ELCERT-EFF-DT        PIC XX.
   574     05  WS-ELCERT-CERT-NO       PIC X(11).
   575 01  WS-ELCRTT-KEY.
   576     05  WS-ELCRTT-PRIMARY       PIC X(33).
   577     05  WS-ELCRTT-REC-TYPE      PIC X(1).
   578
   579 01  WS-ERENDT-KEY.
   580     05  WS-ERENDT-COMPANY-CD    PIC X.
   581     05  WS-ERENDT-CARRIER       PIC X.
   582     05  WS-ERENDT-GROUP         PIC X(6).
   583     05  WS-ERENDT-STATE         PIC XX.
   584     05  WS-ERENDT-ACCOUNT       PIC X(10).
   585     05  WS-ERENDT-EFF-DT        PIC XX.
   586     05  WS-ERENDT-CERT-NO       PIC X(11).
   587     05  WS-ERENDT-REC-TYPE      PIC X.
   588     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   589
   590 01  WS-ERENDT-KEY-BY-ARCH.
   591     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   592     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
   593 01  WS-ERCOMP-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  12
* NSRASBL.cbl
   594     05  WS-ERCOMP-COMPANY-CD    PIC X.
   595     05  WS-ERCOMP-CARRIER       PIC X.
   596     05  WS-ERCOMP-GROUP         PIC X(6).
   597     05  WS-ERCOMP-RESP-NO       PIC X(10).
   598     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   599     05  WS-ERCOMP-REC-TYPE      PIC X.
   600 01  WS-ERMAIL-KEY.
   601     05  WS-ERMAIL-COMPANY-CD    PIC X.
   602     05  WS-ERMAIL-CARRIER       PIC X.
   603     05  WS-ERMAIL-GROUP         PIC X(6).
   604     05  WS-ERMAIL-STATE         PIC XX.
   605     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   606     05  WS-ERMAIL-EFF-DT        PIC XX.
   607     05  WS-ERMAIL-CERT-NO       PIC X(11).
   608 01  WS-ERACCT-KEY.
   609     05  WS-ERACCT-COMPANY-CD    PIC X.
   610     05  WS-ERACCT-CARRIER       PIC X.
   611     05  WS-ERACCT-GROUP         PIC X(6).
   612     05  WS-ERACCT-STATE         PIC XX.
   613     05  WS-ERACCT-ACCOUNT       PIC X(10).
   614     05  WS-ERACCT-EXP-DT        PIC XX.
   615     05  FILLER                  PIC XXXX.
   616 01  WS-ELLETR-KEY.
   617     05  WS-ELLETR-COMPANY-CD    PIC X.
   618     05  WS-ELLETR-LETTER-ID     PIC X(12).
   619     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   620 01  WS-ELCNTL-KEY.
   621     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   622     05  WS-ELCNTL-REC-TYPE      PIC X.
   623     05  WS-ELCNTL-GENL.
   624         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   625         10  WS-ELCNTL-BEN-CD.
   626             15  F               PIC X.
   627             15  WS-ELCNTL-CARR  PIC X.
   628     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   629*                                COPY ELCDATE.
   630******************************************************************
   631*                                                                *
   632*                                                                *
   633*                            ELCDATE.                            *
   634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   635*                            VMOD=2.003
   636*                                                                *
   637*                                                                *
   638*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   639*                 LENGTH = 200                                   *
   640******************************************************************
   641
   642 01  DATE-CONVERSION-DATA.
   643     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   644     12  DC-OPTION-CODE                PIC X.
   645         88  BIN-TO-GREG                VALUE ' '.
   646         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   647         88  EDIT-GREG-TO-BIN           VALUE '2'.
   648         88  YMD-GREG-TO-BIN            VALUE '3'.
   649         88  MDY-GREG-TO-BIN            VALUE '4'.
   650         88  JULIAN-TO-BIN              VALUE '5'.
   651         88  BIN-PLUS-ELAPSED           VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  13
* NSRASBL.cbl
   652         88  FIND-CENTURY               VALUE '7'.
   653         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   654         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   655         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   656         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   657         88  JULIAN-TO-BIN-3            VALUE 'C'.
   658         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   659         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   660         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   661         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   662         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   663         88  CHECK-LEAP-YEAR            VALUE 'H'.
   664         88  BIN-3-TO-GREG              VALUE 'I'.
   665         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   666         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   667         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   668         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   669         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   670         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   671         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   672         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   673         88  THREE-CHARACTER-BIN
   674                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   675         88  GREGORIAN-TO-BIN
   676                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   677         88  BIN-TO-GREGORIAN
   678                  VALUES ' ' '1' 'I' '8' 'G'.
   679         88  JULIAN-TO-BINARY
   680                  VALUES '5' 'C' 'E' 'F'.
   681     12  DC-ERROR-CODE                 PIC X.
   682         88  NO-CONVERSION-ERROR        VALUE ' '.
   683         88  DATE-CONVERSION-ERROR
   684                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   685         88  DATE-IS-ZERO               VALUE '1'.
   686         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   687         88  DATE-IS-INVALID            VALUE '3'.
   688         88  DATE1-GREATER-DATE2        VALUE '4'.
   689         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   690         88  DATE-INVALID-OPTION        VALUE '9'.
   691         88  INVALID-CENTURY            VALUE 'A'.
   692         88  ONLY-CENTURY               VALUE 'B'.
   693         88  ONLY-LEAP-YEAR             VALUE 'C'.
   694         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   695     12  DC-END-OF-MONTH               PIC X.
   696         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   697     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   698         88  USE-NORMAL-PROCESS         VALUE ' '.
   699         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   700         88  ADJUST-UP-100-YRS          VALUE '2'.
   701     12  FILLER                        PIC X.
   702     12  DC-CONVERSION-DATES.
   703         16  DC-BIN-DATE-1             PIC XX.
   704         16  DC-BIN-DATE-2             PIC XX.
   705         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   706         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   707                       DC-GREG-DATE-1-EDIT.
   708             20  DC-EDIT1-MONTH        PIC 99.
   709             20  SLASH1-1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  14
* NSRASBL.cbl
   710             20  DC-EDIT1-DAY          PIC 99.
   711             20  SLASH1-2              PIC X.
   712             20  DC-EDIT1-YEAR         PIC 99.
   713         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   714         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   715                     DC-GREG-DATE-2-EDIT.
   716             20  DC-EDIT2-MONTH        PIC 99.
   717             20  SLASH2-1              PIC X.
   718             20  DC-EDIT2-DAY          PIC 99.
   719             20  SLASH2-2              PIC X.
   720             20  DC-EDIT2-YEAR         PIC 99.
   721         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   722         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   723                     DC-GREG-DATE-1-YMD.
   724             20  DC-YMD-YEAR           PIC 99.
   725             20  DC-YMD-MONTH          PIC 99.
   726             20  DC-YMD-DAY            PIC 99.
   727         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   728         16  DC-GREG-DATE-1-MDY-R REDEFINES
   729                      DC-GREG-DATE-1-MDY.
   730             20  DC-MDY-MONTH          PIC 99.
   731             20  DC-MDY-DAY            PIC 99.
   732             20  DC-MDY-YEAR           PIC 99.
   733         16  DC-GREG-DATE-1-ALPHA.
   734             20  DC-ALPHA-MONTH        PIC X(10).
   735             20  DC-ALPHA-DAY          PIC 99.
   736             20  FILLER                PIC XX.
   737             20  DC-ALPHA-CENTURY.
   738                 24 DC-ALPHA-CEN-N     PIC 99.
   739             20  DC-ALPHA-YEAR         PIC 99.
   740         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   741         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   742         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   743         16  DC-JULIAN-DATE            PIC 9(05).
   744         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   745                                       PIC 9(05).
   746         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   747             20  DC-JULIAN-YEAR        PIC 99.
   748             20  DC-JULIAN-DAYS        PIC 999.
   749         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   750         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   751         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   752     12  DATE-CONVERSION-VARIBLES.
   753         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   754         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   755             20  FILLER                PIC 9(3).
   756             20  HOLD-CEN-1-CCYY.
   757                 24  HOLD-CEN-1-CC     PIC 99.
   758                 24  HOLD-CEN-1-YY     PIC 99.
   759             20  HOLD-CEN-1-MO         PIC 99.
   760             20  HOLD-CEN-1-DA         PIC 99.
   761         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   762             20  HOLD-CEN-1-R-MO       PIC 99.
   763             20  HOLD-CEN-1-R-DA       PIC 99.
   764             20  HOLD-CEN-1-R-CCYY.
   765                 24  HOLD-CEN-1-R-CC   PIC 99.
   766                 24  HOLD-CEN-1-R-YY   PIC 99.
   767             20  FILLER                PIC 9(3).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  15
* NSRASBL.cbl
   768         16  HOLD-CENTURY-1-X.
   769             20  FILLER                PIC X(3)  VALUE SPACES.
   770             20  HOLD-CEN-1-X-CCYY.
   771                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   772                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   773             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   774             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   775         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   776             20  HOLD-CEN-1-R-X-MO     PIC XX.
   777             20  HOLD-CEN-1-R-X-DA     PIC XX.
   778             20  HOLD-CEN-1-R-X-CCYY.
   779                 24  HOLD-CEN-1-R-X-CC PIC XX.
   780                 24  HOLD-CEN-1-R-X-YY PIC XX.
   781             20  FILLER                PIC XXX.
   782         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   783         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   784         16  DC-JULIAN-DATE-1          PIC 9(07).
   785         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   786             20  DC-JULIAN-1-CCYY.
   787                 24  DC-JULIAN-1-CC    PIC 99.
   788                 24  DC-JULIAN-1-YR    PIC 99.
   789             20  DC-JULIAN-DA-1        PIC 999.
   790         16  DC-JULIAN-DATE-2          PIC 9(07).
   791         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   792             20  DC-JULIAN-2-CCYY.
   793                 24  DC-JULIAN-2-CC    PIC 99.
   794                 24  DC-JULIAN-2-YR    PIC 99.
   795             20  DC-JULIAN-DA-2        PIC 999.
   796         16  DC-GREG-DATE-A-EDIT.
   797             20  DC-EDITA-MONTH        PIC 99.
   798             20  SLASHA-1              PIC X VALUE '/'.
   799             20  DC-EDITA-DAY          PIC 99.
   800             20  SLASHA-2              PIC X VALUE '/'.
   801             20  DC-EDITA-CCYY.
   802                 24  DC-EDITA-CENT     PIC 99.
   803                 24  DC-EDITA-YEAR     PIC 99.
   804         16  DC-GREG-DATE-B-EDIT.
   805             20  DC-EDITB-MONTH        PIC 99.
   806             20  SLASHB-1              PIC X VALUE '/'.
   807             20  DC-EDITB-DAY          PIC 99.
   808             20  SLASHB-2              PIC X VALUE '/'.
   809             20  DC-EDITB-CCYY.
   810                 24  DC-EDITB-CENT     PIC 99.
   811                 24  DC-EDITB-YEAR     PIC 99.
   812         16  DC-GREG-DATE-CYMD         PIC 9(08).
   813         16  DC-GREG-DATE-CYMD-R REDEFINES
   814                              DC-GREG-DATE-CYMD.
   815             20  DC-CYMD-CEN           PIC 99.
   816             20  DC-CYMD-YEAR          PIC 99.
   817             20  DC-CYMD-MONTH         PIC 99.
   818             20  DC-CYMD-DAY           PIC 99.
   819         16  DC-GREG-DATE-MDCY         PIC 9(08).
   820         16  DC-GREG-DATE-MDCY-R REDEFINES
   821                              DC-GREG-DATE-MDCY.
   822             20  DC-MDCY-MONTH         PIC 99.
   823             20  DC-MDCY-DAY           PIC 99.
   824             20  DC-MDCY-CEN           PIC 99.
   825             20  DC-MDCY-YEAR          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  16
* NSRASBL.cbl
   826    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   827        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   828    12  DC-EL310-DATE                  PIC X(21).
   829    12  FILLER                         PIC X(28).
   830*                                COPY NSCASEXTR.
   831******************************************************************
   832*                                                                *
   833*                                                                *
   834*                            NSCASEXTR.                          *
   835*                            VMOD=2.001                          *
   836*                                                                *
   837*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   838*                                                                *
   839*   FILE TYPE = VSAM,KSDS                                        *
   840*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   841*                                                                *
   842*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   843*                                                                *
   844*   LOG = NO                                                     *
   845*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   846******************************************************************
   847*-----------------------------------------------------------------
   848*                   C H A N G E   L O G
   849*
   850* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   851*-----------------------------------------------------------------
   852*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   853* EFFECTIVE    NUMBER
   854*-----------------------------------------------------------------
   855* 072211    2011022800001  PEMA  NEW FILE
   856*-----------------------------------------------------------------
   857 01 NSAS-EXTRACT-RECORD.
   858    05  NSAS-CONTROL-PRIMARY.
   859        10  NSAS-COMPANY-CD      PIC X.
   860        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   861        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   862    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   863    05  FILLER                   PIC X(143).
   864*                                COPY ERCPNDB.
   865******************************************************************
   866*                                                                *
   867*                                                                *
   868*                            ERCPNDB.                            *
   869*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   870*                            VMOD=2.025                          *
   871*                                                                *
   872*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   873*                                                                *
   874******************************************************************
   875*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   876*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   877******************************************************************
   878*                                                                *
   879*                                                                *
   880*   FILE TYPE = VSAM,KSDS                                        *
   881*   RECORD SIZE = 585  RECFORM = FIXED                           *
   882*                                                                *
   883*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  17
* NSRASBL.cbl
   884*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   885*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   886*                                                 RKP=13,LEN=36  *
   887*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   888*                                      AND CHG-SEQ.)             *
   889*                                                RKP=49,LEN=11   *
   890*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   891*                                      AND CHG-SEQ.)             *
   892*                                                RKP=60,LEN=15   *
   893*                                                                *
   894*   LOG = NO                                                     *
   895*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   896******************************************************************
   897******************************************************************
   898*                   C H A N G E   L O G
   899*
   900* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   901*-----------------------------------------------------------------
   902*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   903* EFFECTIVE    NUMBER
   904*-----------------------------------------------------------------
   905* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   906* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   907* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   908* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   909* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   910* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   911* 032306                   PEMA  ADD BOW LOAN NUMBER
   912* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   913* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   914* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   915* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   916* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   917* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   918* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   919* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   920* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
   921* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   922* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
   923* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   924* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
   925******************************************************************
   926
   927 01  PENDING-BUSINESS.
   928     12  PB-RECORD-ID                     PIC XX.
   929         88  VALID-PB-ID                        VALUE 'PB'.
   930
   931     12  PB-CONTROL-PRIMARY.
   932         16  PB-COMPANY-CD                PIC X.
   933         16  PB-ENTRY-BATCH               PIC X(6).
   934         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   935         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   936
   937     12  PB-CONTROL-BY-ACCOUNT.
   938         16  PB-COMPANY-CD-A1             PIC X.
   939         16  PB-CARRIER                   PIC X.
   940         16  PB-GROUPING.
   941             20  PB-GROUPING-PREFIX       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  18
* NSRASBL.cbl
   942             20  PB-GROUPING-PRIME        PIC XXX.
   943         16  PB-STATE                     PIC XX.
   944         16  PB-ACCOUNT.
   945             20  PB-ACCOUNT-PREFIX        PIC X(4).
   946             20  PB-ACCOUNT-PRIME         PIC X(6).
   947         16  PB-CERT-EFF-DT               PIC XX.
   948         16  PB-CERT-NO.
   949             20  PB-CERT-PRIME            PIC X(10).
   950             20  PB-CERT-SFX              PIC X.
   951         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   952
   953         16  PB-RECORD-TYPE               PIC X.
   954             88  PB-MAILING-DATA                VALUE '0'.
   955             88  PB-ISSUE                       VALUE '1'.
   956             88  PB-CANCELLATION                VALUE '2'.
   957             88  PB-BATCH-TRAILER               VALUE '9'.
   958
   959     12  PB-CONTROL-BY-ORIG-BATCH.
   960         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   961         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   962         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   963         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   964
   965     12  PB-CONTROL-BY-CSR.
   966         16  PB-CSR-COMPANY-CD            PIC X.
   967         16  PB-CSR-ID                    PIC X(4).
   968         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   969         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   970         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   971******************************************************************
   972*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   973******************************************************************
   974
   975     12  PB-LAST-MAINT-DT                 PIC XX.
   976     12  PB-LAST-MAINT-BY                 PIC X(4).
   977     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   978
   979     12  PB-RECORD-BODY                   PIC X(375).
   980
   981     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   982         16  PB-CERT-ORIGIN               PIC X.
   983             88  CLASIC-CREATED-CERT         VALUE '1'.
   984         16  PB-I-NAME.
   985             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   986             20  PB-I-INSURED-FIRST-NAME.
   987                 24  PB-I-INSURED-1ST-INIT PIC X.
   988                 24  FILLER                PIC X(9).
   989             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   990         16  PB-I-AGE                     PIC S99   COMP-3.
   991         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   992         16  PB-I-BIRTHDAY                PIC XX.
   993         16  PB-I-INSURED-SEX             PIC X.
   994             88  PB-SEX-MALE     VALUE 'M'.
   995             88  PB-SEX-FEMALE   VALUE 'F'.
   996
   997         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   998         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   999         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  19
* NSRASBL.cbl
  1000         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1001         16  PB-I-SKIP-CODE               PIC X.
  1002             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1003             88  PB-SKIP-JULY              VALUE '1'.
  1004             88  PB-SKIP-AUGUST            VALUE '2'.
  1005             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1006             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1007             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1008             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1009             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1010             88  PB-SKIP-JUNE              VALUE '8'.
  1011             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1012             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1013             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1014         16  PB-I-TERM-TYPE               PIC X.
  1015             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1016             88  PB-PAID-WEEKLY            VALUE 'W'.
  1017             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1018             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1019             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1020         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1021         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1022         16  PB-I-DATA-ENTRY-SW           PIC X.
  1023             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1024             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1025             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1026             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1027         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1028         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1029*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1030         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1031         16  PB-I-LETTER-REQD             PIC X.
  1032
  1033         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1034             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1035             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1036                                                   '90' THRU '99'.
  1037         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1038                                          PIC XX.
  1039         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1040         16  PB-I-AMOUNT-FINANCED REDEFINES
  1041                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  1042         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1043         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1044                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1045         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1046         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1047         16  PB-I-CLP-AMOUNT REDEFINES
  1048                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1049         16  PB-I-LF-CALC-FLAG            PIC X.
  1050             88 PB-COMP-LF-PREM               VALUE '?'.
  1051         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1052         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1053         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1054         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1055         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1056         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1057         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  20
* NSRASBL.cbl
  1058         16  PB-I-LF-ABBR                 PIC XXX.
  1059         16  PB-I-LF-INPUT-CD             PIC XX.
  1060
  1061         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1062             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1063             88  PB-INVALID-AH               VALUE '  ' '00'
  1064                                                   '90' THRU '99'.
  1065         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1066         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1067         16  PB-I-AH-CALC-FLAG            PIC X.
  1068             88 PB-COMP-AH-PREM                  VALUE '?'.
  1069         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  1070         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  1071         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  1072         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  1073         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  1074         16  PB-I-AH-ABBR                 PIC XXX.
  1075         16  PB-I-AH-INPUT-CD             PIC XXX.
  1076
  1077         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  1078         16  PB-I-REIN-TABLE              PIC XXX.
  1079         16  PB-I-BUSINESS-TYPE           PIC 99.
  1080         16  PB-I-INDV-GRP-CD             PIC X.
  1081         16  PB-I-MORT-CODE.
  1082             20  PB-I-TABLE               PIC X.
  1083             20  PB-I-INTEREST            PIC XX.
  1084             20  PB-I-MORT-TYP            PIC X.
  1085         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  1086         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  1087         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  1088         16  PB-I-INDV-GRP-OVRD           PIC X.
  1089         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  1090         16  PB-I-SIG-SW                  PIC X.
  1091             88  PB-POLICY-SIGNED             VALUE 'Y'.
  1092         16  PB-I-RATE-CLASS              PIC XX.
  1093         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  1094         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  1095         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  1096         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  1097         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  1098         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  1099         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  1100         16  PB-I-BENEFIT-TYPE            PIC XXX.
  1101         16  PB-I-OB-FLAG                 PIC X.
  1102             88  PB-I-OB                      VALUE 'B'.
  1103             88  PB-I-SUMMARY                 VALUE 'Z'.
  1104         16  PB-I-ENTRY-STATUS            PIC X.
  1105             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  1106                                              'M' '5' '9' '2'.
  1107             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  1108             88  PB-I-POLICY-PENDING          VALUE '2'.
  1109             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  1110             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  1111             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  1112             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  1113             88  PB-I-REIN-ONLY               VALUE '9'.
  1114             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  1115             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  21
* NSRASBL.cbl
  1116             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  1117             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  1118         16  PB-I-INT-CODE                PIC X.
  1119             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  1120             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  1121         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1122         16  PB-I-SOC-SEC-NO              PIC X(11).
  1123         16  PB-I-MEMBER-NO               PIC X(12).
  1124         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  1125*        16  PB-I-LOAN-OFFICER            PIC XXX.
  1126         16  PB-I-OLD-LOF                 PIC XXX.
  1127         16  PB-I-LF-EXPIRE-DT            PIC XX.
  1128         16  PB-I-AH-EXPIRE-DT            PIC XX.
  1129         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  1130         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  1131         16  PB-I-LIFE-INDICATOR          PIC X.
  1132             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  1133         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  1134         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  1135                                          PIC S9(5)V99    COMP-3.
  1136         16  PB-I-MAIL-ADDRS-SW           PIC X.
  1137             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  1138             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  1139         16  PB-I-1ST-PMT-DT              PIC XX.
  1140         16  PB-I-JOINT-INSURED.
  1141             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  1142             20 PB-I-JOINT-FIRST-NAME.
  1143                24  PB-I-JOINT-FIRST-INIT PIC X.
  1144                24  FILLER                PIC X(9).
  1145             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  1146*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  1147         16  PB-I-BENEFICIARY-NAME.
  1148             20  PB-I-BANK-NUMBER         PIC X(10).
  1149             20  FILLER                   PIC X(15).
  1150         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  1151         16  PB-I-REFERENCE               PIC X(12).
  1152         16  FILLER REDEFINES PB-I-REFERENCE.
  1153             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  1154             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  1155             20  PB-I-CLP-STATE           PIC XX.
  1156         16  PB-I-UNDERWRITING-STATUS     PIC X.
  1157             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  1158             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  1159             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  1160         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  1161         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  1162         16  PB-I-RESIDENT-STATE          PIC XX.
  1163         16  PB-I-RATE-CODE               PIC X(4).
  1164         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1165         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1166         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1167         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1168         16  PB-I-BANK-NOCHRGB            PIC 99.
  1169         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1170         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1171
  1172     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1173         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  22
* NSRASBL.cbl
  1174             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1175         16  PB-C-CANCEL-ORIGIN           PIC X.
  1176             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1177         16  PB-C-LF-CANCEL-DT            PIC XX.
  1178         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1179         16  PB-C-LF-CALC-REQ             PIC X.
  1180             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1181         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1182         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1183         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1184             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1185         16  PB-C-AH-CANCEL-DT            PIC XX.
  1186         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1187         16  PB-C-AH-CALC-REQ             PIC X.
  1188             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1189         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1190         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1191         16  PB-C-LAST-NAME               PIC X(15).
  1192         16  PB-C-REFUND-SW               PIC X.
  1193             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1194             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1195         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1196         16  PB-C-PAYEE-CODE              PIC X(6).
  1197         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1198         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1199         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1200         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1201         16  PB-C-REFERENCE               PIC X(12).
  1202         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1203         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1204         16  PB-C-POST-CARD-IND           PIC X.
  1205         16  PB-C-CANCEL-REASON           PIC X.
  1206         16  PB-C-REF-INTERFACE-SW        PIC X.
  1207         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1208         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1209         16  FILLER                       PIC X(01).
  1210*        16  FILLER                       PIC X(18).
  1211         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1212*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1213         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  1214         16  PB-CANCELED-CERT-DATA.
  1215             20  PB-CI-INSURED-NAME.
  1216                 24  PB-CI-LAST-NAME      PIC X(15).
  1217                 24  PB-CI-INITIALS       PIC XX.
  1218             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1219             20  PB-CI-INSURED-SEX        PIC X.
  1220             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1221             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1222             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1223             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1224             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1225             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1226             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1227             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1228             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1229             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1230             20  PB-CI-RATE-CLASS         PIC XX.
  1231             20  PB-CI-RATE-DEV-LF        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  23
* NSRASBL.cbl
  1232             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1233             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1234             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1235             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1236             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1237             20  PB-CI-LF-ABBR            PIC X(3).
  1238             20  PB-CI-AH-ABBR            PIC X(3).
  1239             20  PB-CI-OB-FLAG            PIC X.
  1240                 88  PB-CI-OB                VALUE 'B'.
  1241             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1242                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1243                                           'M' '4' '5' '9' '2'.
  1244                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1245                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1246                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1247                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1248                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1249                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  1250                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1251                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1252                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1253                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1254                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1255                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1256                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1257             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1258                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1259                                           'M' '4' '5' '9' '2'.
  1260                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1261                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1262                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1263                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1264                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1265                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  1266                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1267                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1268                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1269                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1270                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1271                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1272                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1273             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1274             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1275             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1276             20  PB-CI-MEMBER-NO          PIC X(12).
  1277             20  PB-CI-INT-CODE           PIC X.
  1278                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1279                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1280             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1281             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1282             20  PB-CI-COMP-EXCP-SW       PIC X.
  1283                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1284                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1285             20  PB-CI-ENTRY-STATUS       PIC X.
  1286             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1287             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1288             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1289             20  PB-CI-DEATH-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  24
* NSRASBL.cbl
  1290             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1291             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1292             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1293             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1294             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1295             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1296             20  PB-CI-ENTRY-DT              PIC XX.
  1297             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1298             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1299             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1300             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1301             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1302             20  PB-CI-OLD-LOF               PIC XXX.
  1303*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1304             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1305             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1306             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1307             20  PB-CI-INDV-GRP-CD           PIC X.
  1308             20  PB-CI-BENEFICIARY-NAME.
  1309                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1310                 24  FILLER                  PIC X(15).
  1311             20  PB-CI-NOTE-SW               PIC X.
  1312             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1313             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1314             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1315             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1316             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1317             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1318             20  PB-CI-FIRST-NAME            PIC X(10).
  1319             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1320
  1321         16  FILLER                       PIC X(13).
  1322*032306  16  FILLER                       PIC X(27).
  1323*        16  FILLER                       PIC X(46).
  1324
  1325     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1326         16  FILLER                       PIC X(10).
  1327         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1328         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1329         16  PB-M-INSURED-MID-INIT        PIC X.
  1330         16  PB-M-INSURED-AGE             PIC 99.
  1331         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1332         16  PB-M-INSURED-SEX             PIC X.
  1333         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1334         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1335         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1336         16  PB-M-INSURED-CITY-STATE.
  1337             20  PB-M-INSURED-CITY        PIC X(28).
  1338             20  PB-M-INSURED-STATE       PIC XX.
  1339         16  PB-M-INSURED-ZIP-CODE.
  1340             20  PB-M-INSURED-ZIP-PRIME.
  1341                 24  PB-M-INSURED-ZIP-1   PIC X.
  1342                     88  PB-M-CANADIAN-POST-CODE
  1343                                             VALUE 'A' THRU 'Z'.
  1344                 24  FILLER               PIC X(4).
  1345             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1346         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1347                                        PB-M-INSURED-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  25
* NSRASBL.cbl
  1348             20  PM-M-INS-CAN-POST1       PIC XXX.
  1349             20  PM-M-INS-CAN-POST2       PIC XXX.
  1350             20  FILLER                   PIC XXX.
  1351         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1352         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1353         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1354         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1355         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1356         16  PB-M-CRED-BENE-CITYST.
  1357             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1358             20  PB-M-CRED-BENE-STATE     PIC XX.
  1359         16  FILLER                       PIC X(92).
  1360
  1361     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1362         16  FILLER                       PIC X(10).
  1363         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1364         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1365         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1366         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1367         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1368         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1369         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1370         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1371         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1372         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1373         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1374         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1375         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1376         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1377         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1378         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1379         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1380         16  PB-ACCOUNT-NAME              PIC X(30).
  1381         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1382         16  PB-REFERENCE                 PIC X(12).
  1383         16  PB-B-RECEIVED-DT             PIC XX.
  1384         16  FILLER                       PIC X(234).
  1385
  1386     12  PB-RECORD-STATUS.
  1387         16  PB-CREDIT-SELECT-DT          PIC XX.
  1388         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1389         16  PB-BILLED-DT                 PIC XX.
  1390         16  PB-BILLING-STATUS            PIC X.
  1391             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1392             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1393             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1394         16  PB-RECORD-BILL               PIC X.
  1395             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1396             88  PB-RECORD-RETURNED           VALUE 'R'.
  1397             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1398             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1399             88  PB-OVERRIDE-AH               VALUE 'A'.
  1400             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1401         16  PB-BATCH-ENTRY               PIC X.
  1402             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1403             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1404             88  PB-REISSUED-CERT             VALUE 'E'.
  1405             88  PB-CASH-CERT                 VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  26
* NSRASBL.cbl
  1406             88  PB-MONTHLY-CERT              VALUE 'M'.
  1407             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1408             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1409             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1410         16  PB-FORCE-CODE                PIC X.
  1411             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1412             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1413             88  PB-CANCEL-FORCE              VALUE '8'.
  1414             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1415             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1416             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1417             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1418             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1419             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1420             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  1421             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1422         16  PB-FATAL-FLAG                PIC X.
  1423             88  PB-FATAL-ERRORS              VALUE 'X'.
  1424         16  PB-FORCE-ER-CD               PIC X.
  1425             88  PB-FORCE-ERRORS              VALUE 'F'.
  1426             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1427         16  PB-WARN-ER-CD                PIC X.
  1428             88  PB-WARNING-ERRORS            VALUE 'W'.
  1429         16  FILLER                       PIC X.
  1430         16  PB-OUT-BAL-CD                PIC X.
  1431             88  PB-OUT-OF-BAL                VALUE 'O'.
  1432         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1433         16  PB-AH-OVERRIDE-L1            PIC X.
  1434         16  PB-INPUT-DT                  PIC XX.
  1435         16  PB-INPUT-BY                  PIC X(4).
  1436         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1437         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1438         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1439         16  PB-LF-EARNING-METHOD         PIC X.
  1440         16  PB-AH-EARNING-METHOD         PIC X.
  1441         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1442         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1443         16  PB-REIN-CD                   PIC XXX.
  1444         16  PB-LF-REFUND-TYPE            PIC X.
  1445         16  PB-AH-REFUND-TYPE            PIC X.
  1446         16  PB-ACCT-EFF-DT               PIC XX.
  1447         16  PB-ACCT-EXP-DT               PIC XX.
  1448         16  PB-COMPANY-ID                PIC X(3).
  1449         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1450         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1451         16  PB-SV-CARRIER                PIC X.
  1452         16  PB-SV-GROUPING               PIC X(6).
  1453         16  PB-SV-STATE                  PIC XX.
  1454         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1455         16  PB-GA-BILLING-INFO.
  1456             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1457                                          PIC XX.
  1458         16  PB-SV-REMIT-TO  REDEFINES
  1459             PB-GA-BILLING-INFO           PIC X(10).
  1460         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1461         16  PB-I-LOAN-OFFICER            PIC X(5).
  1462         16  PB-I-VIN                     PIC X(17).
  1463
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  27
* NSRASBL.cbl
  1464         16  FILLER                       PIC X(04).
  1465         16  IMNET-BYPASS-SW              PIC X.
  1466
  1467******************************************************************
  1468*                COMMON EDIT ERRORS                              *
  1469******************************************************************
  1470
  1471     12  PB-COMMON-ERRORS.
  1472         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1473                                           PIC S9(4)     COMP.
  1474
  1475******************************************************************
  1476*                                COPY ERCENDT.
  1477******************************************************************
  1478*                                                                *
  1479*                                                                *
  1480*                            ERCENDT.                            *
  1481*                            VMOD=2.001                          *
  1482*                                                                *
  1483*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1484*                                                                *
  1485*   FILE TYPE = VSAM,KSDS                                        *
  1486*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1487*                                                                *
  1488*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1489*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1490*                                                                *
  1491*   LOG = NO                                                     *
  1492*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1493******************************************************************
  1494*-----------------------------------------------------------------
  1495*                   C H A N G E   L O G
  1496*
  1497* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1498*-----------------------------------------------------------------
  1499*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1500* EFFECTIVE    NUMBER
  1501*-----------------------------------------------------------------
  1502* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1503*                                WITH OPEN CLAIMS
  1504* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1505* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1506* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1507* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  1508*-----------------------------------------------------------------
  1509 01  ENDORSEMENT-RECORD.
  1510     12  EN-RECORD-ID                PIC XX.
  1511         88  VALID-EN-ID                VALUE 'EN'.
  1512     12  EN-CONTROL-PRIMARY.
  1513         16  EN-COMPANY-CD           PIC X.
  1514         16  EN-CARRIER              PIC X.
  1515         16  EN-GROUPING             PIC X(6).
  1516         16  EN-STATE                PIC XX.
  1517         16  EN-ACCOUNT              PIC X(10).
  1518         16  EN-CERT-EFF-DT          PIC XX.
  1519         16  EN-CERT-NO.
  1520             20  EN-CERT-PRIME       PIC X(10).
  1521             20  EN-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  28
* NSRASBL.cbl
  1522         16  EN-REC-TYPE             PIC X.
  1523             88  EN-ISSUE               VALUE 'I'.
  1524             88  EN-CANCELLATION        VALUE 'C'.
  1525         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1526     12  EN-CONTROL-BY-ARCH-NO.
  1527         16  EN-COMPANY-CD-A1              PIC X.
  1528         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1529     12  EN-LAST-MAINT-DT            PIC XX.
  1530     12  EN-LAST-MAINT-BY            PIC X(4).
  1531     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1532     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1533     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1534         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1535         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1536         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1537         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1538         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1539         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1540         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1541         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1542         16  EN-LF-ORIG-BENCD        PIC XX.
  1543         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1544         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1545         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1546         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1547         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1548         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1549*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1550         16  EN-ORIG-CRED-BENE       PIC X(25).
  1551         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1552         16  FILLER                  PIC X.
  1553         16  EN-AH-ORIG-BENCD        PIC XX.
  1554         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1555         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1556         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1557         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1558*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1559*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1560         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1561         16  F                       PIC X(09).
  1562         16  EN-AH-ORIG-CP           PIC 99.
  1563         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1564         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1565         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1566         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1567         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1568         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1569         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1570         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1571         16  EN-LF-NEW-BENCD         PIC XX.
  1572         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1573         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1574         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1575         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1576         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1577         16  EN-LF-NEW-EXP-DT        PIC XX.
  1578         16  EN-NEW-CRED-BENE        PIC X(25).
  1579         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  29
* NSRASBL.cbl
  1580         16  FILLER                  PIC X.
  1581         16  EN-AH-NEW-BENCD         PIC XX.
  1582         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1583         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1584         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1585         16  EN-AH-NEW-EXP-DT        PIC XX.
  1586*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1587*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1588*        16  F                       PIC X(12).
  1589         16  EN-AH-NEW-CP            PIC 99.
  1590         16  EN-SIG-SW               PIC X.
  1591         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1592         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1593         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1594         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1595         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1596         16  FILLER                  PIC X(33).
  1597     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1598         16  EN-LF-ORIG-REF-DT       PIC XX.
  1599         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1600         16  EN-AH-ORIG-REF-DT       PIC XX.
  1601         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1602         16  EN-LF-NEW-REF-DT        PIC XX.
  1603         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1604         16  EN-AH-NEW-REF-DT        PIC XX.
  1605         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1606         16  EN-FLAG-CERT            PIC X.
  1607         16  EN-INS-LAST-NAME        PIC X(15).
  1608         16  EN-INS-FIRST-NAME       PIC X(10).
  1609         16  EN-INS-MIDDLE-INIT      PIC X.
  1610         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1611         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1612         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1613         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1614         16  FILLER                  PIC X(262).
  1615     12  EN-MONEY-SW             PIC X.
  1616     12  EN-HEALTH-APP           PIC X.
  1617     12  EN-VOUCHER-SW           PIC X.
  1618     12  EN-PAYEE                PIC X(14).
  1619     12  EN-INPUT-DT             PIC XX.
  1620     12  EN-PROCESS-DT           PIC XX.
  1621     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1622     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1623     12  EN-REASON-CODES.
  1624         16  F OCCURS 12.
  1625             20  EN-REASON-CODE  PIC X(4).
  1626     12  EN-TEMPLATE-USED        PIC X(8).
  1627     12  EN-DOCU-TYPE            PIC X.
  1628         88  EN-VERI-DOCU          VALUE 'V'.
  1629         88  EN-GCE-DOCU           VALUE 'G'.
  1630         88  EN-CANC-DOCU          VALUE 'C'.
  1631     12  EN-COMMENTS1            PIC X(13).
  1632     12  EN-COMMENTS2            PIC X(70).
  1633     12  EN-COMM-CHGBK           PIC X.
  1634         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1635         88  EN-CHG-ACCT           VALUE 'Y'.
  1636     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1637     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  30
* NSRASBL.cbl
  1638     12  EN-BATCH-NUMBER         PIC X(6).
  1639     12  EN-ACCT-SUMM            PIC X.
  1640     12  EN-CSO-SUMM             PIC X.
  1641     12  en-check-type           pic x.
  1642     12  FILLER                  PIC X(12).
  1643******************************************************************
  1644*                                COPY ERCMAIL.
  1645******************************************************************
  1646*                                                                *
  1647*                                                                *
  1648*                            ERCMAIL                             *
  1649*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1650*                            VMOD=2.003                          *
  1651*                                                                *
  1652*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1653*                                                                *
  1654*   FILE TYPE = VSAM,KSDS                                        *
  1655*   RECORD SIZE = 374   RECFORM = FIX                            *
  1656*                                                                *
  1657*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1658*   ALTERNATE PATH    = NOT USED                                 *
  1659*                                                                *
  1660*   LOG = YES                                                    *
  1661*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1662******************************************************************
  1663*                   C H A N G E   L O G
  1664*
  1665* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1666*-----------------------------------------------------------------
  1667*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1668* EFFECTIVE    NUMBER
  1669*-----------------------------------------------------------------
  1670* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1671* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1672* 111108                   PEMA  ADD CRED BENE ADDR2
  1673******************************************************************
  1674
  1675 01  MAILING-DATA.
  1676     12  MA-RECORD-ID                      PIC XX.
  1677         88  VALID-MA-ID                       VALUE 'MA'.
  1678
  1679     12  MA-CONTROL-PRIMARY.
  1680         16  MA-COMPANY-CD                 PIC X.
  1681         16  MA-CARRIER                    PIC X.
  1682         16  MA-GROUPING.
  1683             20  MA-GROUPING-PREFIX        PIC XXX.
  1684             20  MA-GROUPING-PRIME         PIC XXX.
  1685         16  MA-STATE                      PIC XX.
  1686         16  MA-ACCOUNT.
  1687             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1688             20  MA-ACCOUNT-PRIME          PIC X(6).
  1689         16  MA-CERT-EFF-DT                PIC XX.
  1690         16  MA-CERT-NO.
  1691             20  MA-CERT-PRIME             PIC X(10).
  1692             20  MA-CERT-SFX               PIC X.
  1693
  1694     12  FILLER                            PIC XX.
  1695
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  31
* NSRASBL.cbl
  1696     12  MA-ACCESS-CONTROL.
  1697         16  MA-SOURCE-SYSTEM              PIC XX.
  1698             88  MA-FROM-CREDIT                VALUE 'CR'.
  1699             88  MA-FROM-VSI                   VALUE 'VS'.
  1700             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1701             88  MA-FROM-OTHER                 VALUE 'OT'.
  1702         16  MA-RECORD-ADD-DT              PIC XX.
  1703         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1704         16  MA-LAST-MAINT-DT              PIC XX.
  1705         16  MA-LAST-MAINT-BY              PIC XXXX.
  1706         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1707
  1708     12  MA-PROFILE-INFO.
  1709         16  MA-QUALIFY-CODE-1             PIC XX.
  1710         16  MA-QUALIFY-CODE-2             PIC XX.
  1711         16  MA-QUALIFY-CODE-3             PIC XX.
  1712         16  MA-QUALIFY-CODE-4             PIC XX.
  1713         16  MA-QUALIFY-CODE-5             PIC XX.
  1714
  1715         16  MA-INSURED-LAST-NAME          PIC X(15).
  1716         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1717         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1718         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1719         16  MA-INSURED-BIRTH-DT           PIC XX.
  1720         16  MA-INSURED-SEX                PIC X.
  1721             88  MA-SEX-MALE                   VALUE 'M'.
  1722             88  MA-SEX-FEMALE                 VALUE 'F'.
  1723         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1724
  1725         16  MA-ADDRESS-CORRECTED          PIC X.
  1726         16  MA-JOINT-BIRTH-DT             PIC XX.
  1727*        16  FILLER                        PIC X(12).
  1728
  1729         16  MA-ADDRESS-LINE-1             PIC X(30).
  1730         16  MA-ADDRESS-LINE-2             PIC X(30).
  1731         16  MA-CITY-STATE.
  1732             20  MA-CITY                   PIC X(28).
  1733             20  MA-ADDR-STATE             PIC XX.
  1734         16  MA-ZIP.
  1735             20  MA-ZIP-CODE.
  1736                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1737                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1738                 24  FILLER                PIC X(4).
  1739             20  MA-ZIP-PLUS4              PIC X(4).
  1740         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1741             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1742             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1743             20  FILLER                    PIC X(3).
  1744
  1745         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1746
  1747         16  FILLER                        PIC XXX.
  1748*        16  FILLER                        PIC X(10).
  1749
  1750     12  MA-CRED-BENE-INFO.
  1751         16  MA-CRED-BENE-NAME                 PIC X(25).
  1752         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1753         16  MA-CRED-BENE-ADDR2                PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  32
* NSRASBL.cbl
  1754         16  MA-CRED-BENE-CTYST.
  1755             20  MA-CRED-BENE-CITY             PIC X(28).
  1756             20  MA-CRED-BENE-STATE            PIC XX.
  1757         16  MA-CRED-BENE-ZIP.
  1758             20  MA-CB-ZIP-CODE.
  1759                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1760                     88  MA-CB-CANADIAN-POST-CODE
  1761                                           VALUE 'A' THRU 'Z'.
  1762                 24  FILLER                    PIC X(4).
  1763             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1764         16  MA-CB-CANADIAN-POSTAL-CODE
  1765                            REDEFINES MA-CRED-BENE-ZIP.
  1766             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1767             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1768             20  FILLER                        PIC X(3).
  1769     12  MA-POST-CARD-MAIL-DATA.
  1770         16  MA-MAIL-DATA OCCURS 7.
  1771             20  MA-MAIL-TYPE              PIC X.
  1772                 88  MA-12MO-MAILING           VALUE '1'.
  1773                 88  MA-EXP-MAILING            VALUE '2'.
  1774             20  MA-MAIL-STATUS            PIC X.
  1775                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1776                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1777                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1778             20  MA-MAIL-DATE              PIC XX.
  1779     12  FILLER                            PIC XX.
  1780     12  FILLER                            PIC XX.
  1781*    12  FILLER                            PIC X(30).
  1782******************************************************************
  1783*                                COPY ERCCOMP.
  1784******************************************************************
  1785*                                                                *
  1786*                                                                *
  1787*                            ERCCOMP                             *
  1788*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1789*                            VMOD=2.019                          *
  1790*                                                                *
  1791*   ONLINE CREDIT SYSTEM                                         *
  1792*                                                                *
  1793*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1794*                                                                *
  1795*   FILE TYPE = VSAM,KSDS                                        *
  1796*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1797*                                                                *
  1798*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1799*       ALTERNATE PATH = NONE                                    *
  1800*                                                                *
  1801*   LOG = NO                                                     *
  1802*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1803*                                                                *
  1804******************************************************************
  1805*                   C H A N G E   L O G
  1806*
  1807* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1808*-----------------------------------------------------------------
  1809*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1810* EFFECTIVE    NUMBER
  1811*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  33
* NSRASBL.cbl
  1812* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1813* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1814* 092205    2005050300006  PEMA  ADD LEASE FEE
  1815* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1816* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1817* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1818* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1819* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1820* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1821******************************************************************
  1822
  1823 01  COMPENSATION-MASTER.
  1824     12  CO-RECORD-ID                          PIC XX.
  1825         88  VALID-CO-ID                          VALUE 'CO'.
  1826
  1827     12  CO-CONTROL-PRIMARY.
  1828         16  CO-COMPANY-CD                     PIC X.
  1829         16  CO-CONTROL.
  1830             20  CO-CTL-1.
  1831                 24  CO-CARR-GROUP.
  1832                     28  CO-CARRIER            PIC X.
  1833                     28  CO-GROUPING.
  1834                         32  CO-GROUP-PREFIX   PIC XXX.
  1835                         32  CO-GROUP-PRIME    PIC XXX.
  1836                 24  CO-RESP-NO.
  1837                     28  CO-RESP-PREFIX        PIC X(4).
  1838                     28  CO-RESP-PRIME         PIC X(6).
  1839             20  CO-CTL-2.
  1840                 24  CO-ACCOUNT.
  1841                     28  CO-ACCT-PREFIX        PIC X(4).
  1842                     28  CO-ACCT-PRIME         PIC X(6).
  1843         16  CO-TYPE                           PIC X.
  1844             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1845             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1846             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1847
  1848     12  CO-MAINT-INFORMATION.
  1849         16  CO-LAST-MAINT-DT                  PIC XX.
  1850         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1851         16  CO-LAST-MAINT-USER                PIC X(4).
  1852     12  FILLER                                PIC XX.
  1853     12  CO-STMT-TYPE                          PIC XXX.
  1854     12  CO-COMP-TYPE                          PIC X.
  1855         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1856     12  CO-STMT-OWNER                         PIC X(4).
  1857     12  CO-BALANCE-CONTROL                    PIC X.
  1858         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1859         88  CO-NO-BALANCE                        VALUE 'N'.
  1860
  1861     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1862         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1863         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1864         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1865
  1866     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1867         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1868         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1869
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  34
* NSRASBL.cbl
  1870     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1871     12  CO-GA-DIRECT-DEP                      PIC X.
  1872     12  CO-FUTURE-SPACE                       PIC X.
  1873         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1874
  1875     12  CO-ACCT-NAME                          PIC X(30).
  1876     12  CO-MAIL-NAME                          PIC X(30).
  1877     12  CO-ADDR-1                             PIC X(30).
  1878     12  CO-ADDR-2                             PIC X(30).
  1879     12  CO-ADDR-3.
  1880         16  CO-ADDR-CITY                      PIC X(27).
  1881         16  CO-ADDR-STATE                     PIC XX.
  1882     12  CO-CSO-1099                           PIC X.
  1883     12  CO-ZIP.
  1884         16  CO-ZIP-PRIME.
  1885             20  CO-ZIP-PRI-1ST                PIC X.
  1886                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1887             20  FILLER                        PIC X(4).
  1888         16  CO-ZIP-PLUS4                      PIC X(4).
  1889     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1890         16  CO-CAN-POSTAL-1                   PIC XXX.
  1891         16  CO-CAN-POSTAL-2                   PIC XXX.
  1892         16  FILLER                            PIC XXX.
  1893     12  CO-SOC-SEC                            PIC X(13).
  1894     12  CO-TELEPHONE.
  1895         16  CO-AREA-CODE                      PIC XXX.
  1896         16  CO-PREFIX                         PIC XXX.
  1897         16  CO-PHONE                          PIC X(4).
  1898
  1899     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1900
  1901     12  CO-AR-BAL-LEVEL                       PIC X.
  1902         88  CO-AR-REF-LVL                        VALUE '1'.
  1903         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1904         88  CO-AR-BILL-LVL                       VALUE '2'.
  1905         88  CO-AR-AGT-LVL                        VALUE '3'.
  1906         88  CO-AR-FR-LVL                         VALUE '4'.
  1907
  1908     12  CO-AR-NORMAL-PRINT                    PIC X.
  1909         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1910         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1911
  1912     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1913
  1914     12  CO-AR-REPORTING                       PIC X.
  1915         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1916         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1917
  1918     12  CO-AR-PULL-CHECK                      PIC X.
  1919         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1920         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1921
  1922     12  CO-AR-BALANCE-PRINT                   PIC X.
  1923         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1924
  1925     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1926         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1927         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  35
* NSRASBL.cbl
  1928         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1929
  1930     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1931
  1932     12  CO-USER-CODE                          PIC X.
  1933     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1934
  1935******************************************************************
  1936*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1937*    THE LAST MONTH END RUN.
  1938******************************************************************
  1939
  1940     12  CO-LAST-ACTIVITY-DATE.
  1941         16  CO-ACT-YEAR                       PIC 99.
  1942         16  CO-ACT-MONTH                      PIC 99.
  1943         16  CO-ACT-DAY                        PIC 99.
  1944
  1945     12  CO-LAST-STMT-DT.
  1946         16  CO-LAST-STMT-YEAR                 PIC 99.
  1947         16  CO-LAST-STMT-MONTH                PIC 99.
  1948         16  CO-LAST-STMT-DAY                  PIC 99.
  1949
  1950     12  CO-MO-END-TOTALS.
  1951         16  CO-MONTHLY-TOTALS.
  1952             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1953             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1954             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1955             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1956             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1957
  1958         16  CO-AGING-TOTALS.
  1959             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1960             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1961             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1962             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1963
  1964         16  CO-YTD-TOTALS.
  1965             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1966             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1967
  1968         16  CO-OVER-UNDER-TOTALS.
  1969             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1970             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1971
  1972     12  CO-MISCELLANEOUS-TOTALS.
  1973         16  CO-FICA-TOTALS.
  1974             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1975             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1976
  1977         16  CO-CLAIM-TOTALS.
  1978             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1979             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1980
  1981******************************************************************
  1982*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1983*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1984******************************************************************
  1985
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  36
* NSRASBL.cbl
  1986     12  CO-CURRENT-TOTALS.
  1987         16  CO-CURRENT-LAST-STMT-DT.
  1988             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1989             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1990             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1991
  1992         16  CO-CURRENT-MONTHLY-TOTALS.
  1993             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1994             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1995             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1996             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1997             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1998
  1999         16  CO-CURRENT-AGING-TOTALS.
  2000             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2001             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2002             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2003             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2004
  2005         16  CO-CURRENT-YTD-TOTALS.
  2006             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2007             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2008
  2009     12  CO-PAID-COMM-TOTALS.
  2010         16  CO-YTD-PAID-COMMS.
  2011             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2012             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2013
  2014     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  2015         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2016         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2017
  2018     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2019         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2020         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2021         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2022         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2023         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2024         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2025         88  CO-FINAL-LETTER                  VALUE 'F'.
  2026         88  CO-RECONCILING                   VALUE 'R'.
  2027         88  CO-PHONE-CALL                    VALUE 'P'.
  2028         88  CO-LEGAL                         VALUE 'L'.
  2029         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2030         88  CO-WRITE-OFF                     VALUE 'W'.
  2031         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2032
  2033     12  CO-CSR-CODE                       PIC X(4).
  2034
  2035     12  CO-GA-STATUS-INFO.
  2036         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2037         16  CO-GA-TERMINATION-DT          PIC XX.
  2038         16  CO-GA-STATUS-CODE             PIC X.
  2039             88  CO-GA-ACTIVE                 VALUE 'A'.
  2040             88  CO-GA-INACTIVE               VALUE 'I'.
  2041             88  CO-GA-PENDING                VALUE 'P'.
  2042         16  CO-GA-COMMENTS.
  2043             20  CO-GA-COMMENT-1           PIC X(40).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  37
* NSRASBL.cbl
  2044             20  CO-GA-COMMENT-2           PIC X(40).
  2045             20  CO-GA-COMMENT-3           PIC X(40).
  2046             20  CO-GA-COMMENT-4           PIC X(40).
  2047
  2048     12  CO-RPTCD2                         PIC X(10).
  2049     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2050         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2051         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2052
  2053     12  CO-TYPE-AGENT                     PIC X(01).
  2054         88  CO-CORPORATION                   VALUE 'C'.
  2055         88  CO-PARTNERSHIP                   VALUE 'P'.
  2056         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2057         88  CO-TRUST                         VALUE 'T'.
  2058         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2059
  2060     12  CO-FAXNO.
  2061         16  CO-FAX-AREA-CODE                  PIC XXX.
  2062         16  CO-FAX-PREFIX                     PIC XXX.
  2063         16  CO-FAX-PHONE                      PIC X(4).
  2064
  2065     12  CO-BANK-INFORMATION.
  2066         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2067         16  CO-BANK-TRANSIT-NON REDEFINES
  2068             CO-BANK-TRANSIT-NO                PIC 9(8).
  2069
  2070         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2071     12  CO-MISC-DEDUCT-INFO REDEFINES
  2072                  CO-BANK-INFORMATION.
  2073         16  CO-MD-GL-ACCT                     PIC X(10).
  2074         16  CO-MD-DIV                         PIC XX.
  2075         16  CO-MD-CENTER                      PIC X(4).
  2076         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2077         16  CO-CREATE-AP-CHECK                PIC X.
  2078         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2079         16  FILLER                            PIC XXX.
  2080     12  CO-ACH-STATUS                         PIC X.
  2081         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2082         88  CO-ACH-PENDING                        VALUE 'P'.
  2083
  2084     12  CO-BILL-SW                            PIC X.
  2085     12  CO-CONTROL-NAME                       PIC X(30).
  2086     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2087     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2088     12  CO-CLP-STATE                          PIC XX.
  2089     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2090     12  CO-SPP-REFUND-EDIT                    PIC X.
  2091
  2092******************************************************************
  2093*                                COPY ELCCERT.
  2094******************************************************************
  2095*                                                                *
  2096*                            ELCCERT.                            *
  2097*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2098*                            VMOD=2.013                          *
  2099*                                                                *
  2100*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2101*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  38
* NSRASBL.cbl
  2102*   FILE TYPE = VSAM,KSDS                                        *
  2103*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2104*                                                                *
  2105*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2106*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2107*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2108*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2109*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2110*                                                                *
  2111*   LOG = YES                                                    *
  2112*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2113******************************************************************
  2114*                   C H A N G E   L O G
  2115*
  2116* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2117*-----------------------------------------------------------------
  2118*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2119* EFFECTIVE    NUMBER
  2120*-----------------------------------------------------------------
  2121* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2122* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2123* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2124* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2125* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2126* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2127* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2128* 032612  CR2011110200001  PEMA  AHL CHANGES
  2129* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2130* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2131* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2132******************************************************************
  2133
  2134 01  CERTIFICATE-MASTER.
  2135     12  CM-RECORD-ID                      PIC XX.
  2136         88  VALID-CM-ID                      VALUE 'CM'.
  2137
  2138     12  CM-CONTROL-PRIMARY.
  2139         16  CM-COMPANY-CD                 PIC X.
  2140         16  CM-CARRIER                    PIC X.
  2141         16  CM-GROUPING.
  2142             20  CM-GROUPING-PREFIX        PIC X(3).
  2143             20  CM-GROUPING-PRIME         PIC X(3).
  2144         16  CM-STATE                      PIC XX.
  2145         16  CM-ACCOUNT.
  2146             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2147             20  CM-ACCOUNT-PRIME          PIC X(6).
  2148         16  CM-CERT-EFF-DT                PIC XX.
  2149         16  CM-CERT-NO.
  2150             20  CM-CERT-PRIME             PIC X(10).
  2151             20  CM-CERT-SFX               PIC X.
  2152
  2153     12  CM-CONTROL-BY-NAME.
  2154         16  CM-COMPANY-CD-A1              PIC X.
  2155         16  CM-INSURED-LAST-NAME          PIC X(15).
  2156         16  CM-INSURED-INITIALS.
  2157             20  CM-INSURED-INITIAL1       PIC X.
  2158             20  CM-INSURED-INITIAL2       PIC X.
  2159
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  39
* NSRASBL.cbl
  2160     12  CM-CONTROL-BY-SSN.
  2161         16  CM-COMPANY-CD-A2              PIC X.
  2162         16  CM-SOC-SEC-NO.
  2163             20  CM-SSN-STATE              PIC XX.
  2164             20  CM-SSN-ACCOUNT            PIC X(6).
  2165             20  CM-SSN-LN3.
  2166                 25  CM-INSURED-INITIALS-A2.
  2167                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2168                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2169                 25 CM-PART-LAST-NAME-A2         PIC X.
  2170
  2171     12  CM-CONTROL-BY-CERT-NO.
  2172         16  CM-COMPANY-CD-A4              PIC X.
  2173         16  CM-CERT-NO-A4                 PIC X(11).
  2174
  2175     12  CM-CONTROL-BY-MEMB.
  2176         16  CM-COMPANY-CD-A5              PIC X.
  2177         16  CM-MEMBER-NO.
  2178             20  CM-MEMB-STATE             PIC XX.
  2179             20  CM-MEMB-ACCOUNT           PIC X(6).
  2180             20  CM-MEMB-LN4.
  2181                 25  CM-INSURED-INITIALS-A5.
  2182                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2183                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2184                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2185
  2186     12  CM-INSURED-PROFILE-DATA.
  2187         16  CM-INSURED-FIRST-NAME.
  2188             20  CM-INSURED-1ST-INIT       PIC X.
  2189             20  FILLER                    PIC X(9).
  2190         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2191         16  CM-INSURED-SEX                PIC X.
  2192             88  CM-SEX-MALE                  VALUE 'M'.
  2193             88  CM-SEX-FEMAL                 VALUE 'F'.
  2194         16  CM-INSURED-JOINT-AGE          PIC 99.
  2195         16  CM-JOINT-INSURED-NAME.
  2196             20  CM-JT-LAST-NAME           PIC X(15).
  2197             20  CM-JT-FIRST-NAME.
  2198                 24  CM-JT-1ST-INIT        PIC X.
  2199                 24  FILLER                PIC X(9).
  2200             20  CM-JT-INITIAL             PIC X.
  2201
  2202     12  CM-LIFE-DATA.
  2203         16  CM-LF-BENEFIT-CD              PIC XX.
  2204         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2205         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2206         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2207         16  CM-LF-DEV-CODE                PIC XXX.
  2208         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2209         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2210         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2211         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2212         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2213         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2214         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2215         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2216         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2217         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  40
* NSRASBL.cbl
  2218         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2219         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2220         16  cm-temp-epiq                  pic xx.
  2221             88  EPIQ-CLASS                  value 'EQ'.
  2222*        16  FILLER                        PIC XX.
  2223
  2224     12  CM-AH-DATA.
  2225         16  CM-AH-BENEFIT-CD              PIC XX.
  2226         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2227         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2228         16  CM-AH-DEV-CODE                PIC XXX.
  2229         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2230         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2231         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2232         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2233         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2234         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2235         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2236         16  CM-AH-PAID-THRU-DT            PIC XX.
  2237             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2238         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2239         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2240         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2241         16  FILLER                        PIC X.
  2242
  2243     12  CM-LOAN-INFORMATION.
  2244         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2245         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2246                                           PIC S9(5)V99  COMP-3.
  2247         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2248         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2249         16  CM-PAY-FREQUENCY              PIC S99.
  2250         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2251         16  CM-RATE-CLASS                 PIC XX.
  2252         16  CM-BENEFICIARY                PIC X(25).
  2253         16  CM-POLICY-FORM-NO             PIC X(12).
  2254         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2255         16  CM-LAST-ADD-ON-DT             PIC XX.
  2256         16  CM-DEDUCTIBLE-AMOUNTS.
  2257             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2258             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2259         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2260             20  CM-RESIDENT-STATE         PIC XX.
  2261             20  CM-RATE-CODE              PIC X(4).
  2262             20  FILLER                    PIC XX.
  2263         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2264             20  CM-LOAN-OFFICER           PIC X(5).
  2265             20  FILLER                    PIC XXX.
  2266         16  CM-CSR-CODE                   PIC XXX.
  2267         16  CM-UNDERWRITING-CODE          PIC X.
  2268             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2269         16  CM-POST-CARD-IND              PIC X.
  2270         16  CM-REF-INTERFACE-SW           PIC X.
  2271         16  CM-PREMIUM-TYPE               PIC X.
  2272             88  CM-SING-PRM                  VALUE '1'.
  2273             88  CM-O-B-COVERAGE              VALUE '2'.
  2274             88  CM-OPEN-END                  VALUE '3'.
  2275         16  CM-IND-GRP-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  41
* NSRASBL.cbl
  2276             88  CM-INDIVIDUAL                VALUE 'I'.
  2277             88  CM-GROUP                     VALUE 'G'.
  2278         16  CM-SKIP-CODE                  PIC X.
  2279             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2280             88  SKIP-JULY                    VALUE '1'.
  2281             88  SKIP-AUGUST                  VALUE '2'.
  2282             88  SKIP-SEPTEMBER               VALUE '3'.
  2283             88  SKIP-JULY-AUG                VALUE '4'.
  2284             88  SKIP-AUG-SEPT                VALUE '5'.
  2285             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2286             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2287             88  SKIP-JUNE                    VALUE '8'.
  2288             88  SKIP-JUNE-JULY               VALUE '9'.
  2289             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2290             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2291         16  CM-PAYMENT-MODE               PIC X.
  2292             88  PAY-MONTHLY                  VALUE SPACE.
  2293             88  PAY-WEEKLY                   VALUE '1'.
  2294             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2295             88  PAY-BI-WEEKLY                VALUE '3'.
  2296             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2297         16  CM-LOAN-NUMBER                PIC X(8).
  2298         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2299         16  CM-OLD-LOF                    PIC XXX.
  2300*        16  CM-LOAN-OFFICER               PIC XXX.
  2301         16  CM-REIN-TABLE                 PIC XXX.
  2302         16  CM-SPECIAL-REIN-CODE          PIC X.
  2303         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2304         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2305         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2306
  2307     12  CM-STATUS-DATA.
  2308         16  CM-ENTRY-STATUS               PIC X.
  2309         16  CM-ENTRY-DT                   PIC XX.
  2310
  2311         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2312         16  CM-LF-CANCEL-DT               PIC XX.
  2313         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2314
  2315         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2316         16  CM-LF-DEATH-DT                PIC XX.
  2317         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2318
  2319         16  CM-LF-CURRENT-STATUS          PIC X.
  2320             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2321                                                'M' '4' '5' '9'.
  2322             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2323             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2324             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2325             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2326             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2327             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2328             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2329             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2330             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2331             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2332             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2333             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  42
* NSRASBL.cbl
  2334             88  CM-LF-VOIDED                 VALUE 'V'.
  2335
  2336         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2337         16  CM-AH-CANCEL-DT               PIC XX.
  2338         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2339
  2340         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2341         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2342         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2343
  2344         16  CM-AH-CURRENT-STATUS          PIC X.
  2345             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2346                                                'M' '4' '5' '9'.
  2347             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2348             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2349             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2350             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2351             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2352             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2353             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2354             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2355             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2356             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2357             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2358             88  CM-AH-DECLINED               VALUE 'D'.
  2359             88  CM-AH-VOIDED                 VALUE 'V'.
  2360
  2361         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2362             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2363             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2364             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2365         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2366
  2367         16  CM-ENTRY-BATCH                PIC X(6).
  2368         16  CM-LF-EXIT-BATCH              PIC X(6).
  2369         16  CM-AH-EXIT-BATCH              PIC X(6).
  2370         16  CM-LAST-MONTH-END             PIC XX.
  2371
  2372     12  CM-NOTE-SW                        PIC X.
  2373         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2374         88  CERT-NOTES-PRESENT               VALUE '1'.
  2375         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2376         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2377         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2378         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2379         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2380         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2381     12  CM-COMP-EXCP-SW                   PIC X.
  2382         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2383         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2384     12  CM-INSURED-ADDRESS-SW             PIC X.
  2385         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2386         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2387
  2388*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2389     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2390     12  FILLER                            PIC X.
  2391
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  43
* NSRASBL.cbl
  2392*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2393     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2394     12  FILLER                            PIC X.
  2395*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2396     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2397
  2398     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2399         88  CERT-ADDED-BATCH                 VALUE ' '.
  2400         88  CERT-ADDED-ONLINE                VALUE '1'.
  2401         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2402         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2403         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2404     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2405         88  CERT-AS-LOADED                   VALUE ' '.
  2406         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2407         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2408         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2409         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2410         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2411         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2412         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2413
  2414     12  CM-ACCOUNT-COMM-PCTS.
  2415         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2416         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2417
  2418     12  CM-USER-FIELD                     PIC X.
  2419     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2420     12  CM-CLP-STATE                      PIC XX.
  2421     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2422     12  CM-USER-RESERVED                  PIC XXX.
  2423     12  FILLER REDEFINES CM-USER-RESERVED.
  2424         16  CM-AH-CLASS-CD                PIC XX.
  2425         16  F                             PIC X.
  2426******************************************************************
  2427*                                COPY ELCCRTO.
  2428******************************************************************
  2429*                                                                *
  2430*                            ELCCRTO.                            *
  2431*                                                                *
  2432*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2433*                                                                *
  2434*   FILE TYPE = VSAM,KSDS                                        *
  2435*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2436*                                                                *
  2437*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2438*                                                                *
  2439*   LOG = YES                                                    *
  2440*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2441******************************************************************
  2442*                   C H A N G E   L O G
  2443*
  2444* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2445*-----------------------------------------------------------------
  2446*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2447* EFFECTIVE    NUMBER
  2448*-----------------------------------------------------------------
  2449* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  44
* NSRASBL.cbl
  2450* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2451* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2452* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2453* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2454******************************************************************
  2455 01  ORIGINAL-CERTIFICATE.
  2456     12  OC-RECORD-ID                      PIC XX.
  2457         88  VALID-OC-ID                      VALUE 'OC'.
  2458     12  OC-CONTROL-PRIMARY.
  2459         16  OC-COMPANY-CD                 PIC X.
  2460         16  OC-CARRIER                    PIC X.
  2461         16  OC-GROUPING                   PIC X(6).
  2462         16  OC-STATE                      PIC XX.
  2463         16  OC-ACCOUNT                    PIC X(10).
  2464         16  OC-CERT-EFF-DT                PIC XX.
  2465         16  OC-CERT-NO.
  2466             20  OC-CERT-PRIME             PIC X(10).
  2467             20  OC-CERT-SFX               PIC X.
  2468         16  OC-RECORD-TYPE                PIC X.
  2469         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2470     12  OC-LAST-MAINT-DT                  PIC XX.
  2471     12  OC-LAST-MAINT-BY                  PIC X(4).
  2472     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2473     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2474     12  FILLER                            PIC X(49).
  2475     12  OC-ORIG-REC.
  2476         16  OC-INS-LAST-NAME              PIC X(15).
  2477         16  OC-INS-FIRST-NAME             PIC X(10).
  2478         16  OC-INS-MIDDLE-INIT            PIC X.
  2479         16  OC-INS-AGE                    PIC S999     COMP-3.
  2480         16  OC-JNT-LAST-NAME              PIC X(15).
  2481         16  OC-JNT-FIRST-NAME             PIC X(10).
  2482         16  OC-JNT-MIDDLE-INIT            PIC X.
  2483         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2484         16  OC-LF-BENCD                   PIC XX.
  2485         16  OC-LF-TERM                    PIC S999      COMP-3.
  2486         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2487         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2488         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2489         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2490         16  OC-LF-EXP-DT                  PIC XX.
  2491         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2492         16  OC-LF-CANCEL-DT               PIC XX.
  2493         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2494         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2495         16  OC-AH-BENCD                   PIC XX.
  2496         16  OC-AH-TERM                    PIC S999      COMP-3.
  2497         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2498         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2499         16  OC-AH-EXP-DT                  PIC XX.
  2500         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2501         16  OC-AH-CP                      PIC 99.
  2502         16  OC-AH-CANCEL-DT               PIC XX.
  2503         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2504         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2505         16  OC-CRED-BENE-NAME             PIC X(25).
  2506         16  OC-1ST-PMT-DT                 PIC XX.
  2507         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  45
* NSRASBL.cbl
  2508         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  2509         16  OC-ISSUE-TRAN-IND             PIC X.
  2510         16  OC-CANCEL-TRAN-IND            PIC X.
  2511         16  FILLER                        PIC X(211).
  2512
  2513     12  FILLER                            PIC X(50).
  2514******************************************************************
  2515*                                COPY ERCACCT.
  2516******************************************************************
  2517*                                                                *
  2518*                                                                *
  2519*                            ERCACCT                             *
  2520*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2521*                            VMOD=2.031                          *
  2522*                                                                *
  2523*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2524*                                                                *
  2525*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2526*   VSAM ACCOUNT MASTER FILES.                                   *
  2527*                                                                *
  2528*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2529*                                                                *
  2530*   FILE TYPE = VSAM,KSDS                                        *
  2531*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2532*                                                                *
  2533*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2534*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2535*                                                                *
  2536*   LOG = NO                                                     *
  2537*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2538*                                                                *
  2539*                                                                *
  2540******************************************************************
  2541*                   C H A N G E   L O G
  2542*
  2543* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2544*-----------------------------------------------------------------
  2545*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2546* EFFECTIVE    NUMBER
  2547*-----------------------------------------------------------------
  2548* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2549* 092705    2005050300006  PEMA  ADD SPP LEASES
  2550* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2551* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2552* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2553* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2554* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2555* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2556******************************************************************
  2557
  2558 01  ACCOUNT-MASTER.
  2559     12  AM-RECORD-ID                      PIC XX.
  2560         88  VALID-AM-ID                      VALUE 'AM'.
  2561
  2562     12  AM-CONTROL-PRIMARY.
  2563         16  AM-COMPANY-CD                 PIC X.
  2564         16  AM-MSTR-CNTRL.
  2565             20  AM-CONTROL-A.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  46
* NSRASBL.cbl
  2566                 24  AM-CARRIER            PIC X.
  2567                 24  AM-GROUPING.
  2568                     28 AM-GROUPING-PREFIX PIC XXX.
  2569                     28 AM-GROUPING-PRIME  PIC XXX.
  2570                 24  AM-STATE              PIC XX.
  2571                 24  AM-ACCOUNT.
  2572                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2573                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2574             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2575                                           PIC X(19).
  2576             20  AM-CNTRL-B.
  2577                 24  AM-EXPIRATION-DT      PIC XX.
  2578                 24  FILLER                PIC X(4).
  2579             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2580                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2581
  2582     12  AM-CONTROL-BY-VAR-GRP.
  2583         16  AM-COMPANY-CD-A1              PIC X.
  2584         16  AM-VG-CARRIER                 PIC X.
  2585         16  AM-VG-GROUPING                PIC X(6).
  2586         16  AM-VG-STATE                   PIC XX.
  2587         16  AM-VG-ACCOUNT                 PIC X(10).
  2588         16  AM-VG-DATE.
  2589             20  AM-VG-EXPIRATION-DT       PIC XX.
  2590             20  FILLER                    PIC X(4).
  2591         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2592                                           PIC 9(11)      COMP-3.
  2593     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2594         16  FILLER                        PIC X(10).
  2595         16  AM-VG-KEY3.
  2596             20  AM-VG3-ACCOUNT            PIC X(10).
  2597             20  AM-VG3-EXP-DT             PIC XX.
  2598         16  FILLER                        PIC X(4).
  2599     12  AM-MAINT-INFORMATION.
  2600         16  AM-LAST-MAINT-DT              PIC XX.
  2601         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2602         16  AM-LAST-MAINT-USER            PIC X(4).
  2603         16  FILLER                        PIC XX.
  2604
  2605     12  AM-EFFECTIVE-DT                   PIC XX.
  2606     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2607
  2608     12  AM-PREV-DATES  COMP-3.
  2609         16  AM-PREV-EXP-DT                PIC 9(11).
  2610         16  AM-PREV-EFF-DT                PIC 9(11).
  2611
  2612     12  AM-REPORT-CODE-1                  PIC X(10).
  2613     12  AM-REPORT-CODE-2                  PIC X(10).
  2614
  2615     12  AM-CITY-CODE                      PIC X(4).
  2616     12  AM-COUNTY-PARISH                  PIC X(6).
  2617
  2618     12  AM-NAME                           PIC X(30).
  2619     12  AM-PERSON                         PIC X(30).
  2620     12  AM-ADDRS                          PIC X(30).
  2621     12  AM-CITY.
  2622         16  AM-ADDR-CITY                  PIC X(28).
  2623         16  AM-ADDR-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  47
* NSRASBL.cbl
  2624     12  AM-ZIP.
  2625         16  AM-ZIP-PRIME.
  2626             20  AM-ZIP-PRI-1ST            PIC X.
  2627                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2628             20  FILLER                    PIC X(4).
  2629         16  AM-ZIP-PLUS4                  PIC X(4).
  2630     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2631         16  AM-CAN-POSTAL-1               PIC XXX.
  2632         16  AM-CAN-POSTAL-2               PIC XXX.
  2633         16  FILLER                        PIC XXX.
  2634     12  AM-TEL-NO.
  2635         16  AM-AREA-CODE                  PIC 999.
  2636         16  AM-TEL-PRE                    PIC 999.
  2637         16  AM-TEL-NBR                    PIC 9(4).
  2638     12  AM-TEL-LOC                        PIC X.
  2639         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2640         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2641
  2642     12  AM-COMM-STRUCTURE.
  2643         16  AM-DEFN-1.
  2644             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2645                 24  AM-AGT.
  2646                     28  AM-AGT-PREFIX     PIC X(4).
  2647                     28  AM-AGT-PRIME      PIC X(6).
  2648                 24  AM-COM-TYP            PIC X.
  2649                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2650                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2651                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2652                 24  AM-RECALC-LV-INDIC    PIC X.
  2653                 24  AM-RETRO-LV-INDIC     PIC X.
  2654                 24  AM-GL-CODES           PIC X.
  2655                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2656                 24  FILLER                PIC X(01).
  2657         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2658             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2659                 24  FILLER                PIC X(11).
  2660                 24  AM-L-COMA             PIC XXX.
  2661                 24  AM-J-COMA             PIC XXX.
  2662                 24  AM-A-COMA             PIC XXX.
  2663                 24  FILLER                PIC X(6).
  2664
  2665     12  AM-COMM-CHANGE-STATUS             PIC X.
  2666         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2667
  2668     12  AM-CSR-CODE                       PIC X(4).
  2669
  2670     12  AM-BILLING-STATUS                 PIC X.
  2671         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2672         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2673     12  AM-AUTO-REFUND-SW                 PIC X.
  2674         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2675         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2676     12  AM-GPCD                           PIC 99.
  2677     12  AM-IG                             PIC X.
  2678         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2679         88  AM-HAS-GROUP                     VALUE '2'.
  2680     12  AM-STATUS                         PIC X.
  2681         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  48
* NSRASBL.cbl
  2682         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2683         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2684         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2685         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2686         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2687         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2688         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2689         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2690         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2691     12  AM-REMIT-TO                       PIC 99.
  2692     12  AM-ID-NO                          PIC X(11).
  2693
  2694     12  AM-CAL-TABLE                      PIC XX.
  2695     12  AM-LF-DEVIATION                   PIC XXX.
  2696     12  AM-AH-DEVIATION                   PIC XXX.
  2697     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2698     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2699     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2700     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2701     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2702     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2703
  2704     12  AM-USER-FIELDS.
  2705         16  AM-FLD-1                      PIC XX.
  2706         16  AM-FLD-2                      PIC XX.
  2707         16  AM-FLD-3                      PIC XX.
  2708         16  AM-FLD-4                      PIC XX.
  2709         16  AM-FLD-5                      PIC XX.
  2710
  2711     12  AM-1ST-PROD-DATE.
  2712         16  AM-1ST-PROD-YR                PIC XX.
  2713         16  AM-1ST-PROD-MO                PIC XX.
  2714         16  AM-1ST-PROD-DA                PIC XX.
  2715     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2716     12  AM-CERTS-PURGED-DATE.
  2717         16  AM-PUR-YR                     PIC XX.
  2718         16  AM-PUR-MO                     PIC XX.
  2719         16  AM-PUR-DA                     PIC XX.
  2720     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2721     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2722     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2723     12  AM-INACTIVE-DATE.
  2724         16  AM-INA-MO                     PIC 99.
  2725         16  AM-INA-DA                     PIC 99.
  2726         16  AM-INA-YR                     PIC 99.
  2727     12  AM-AR-HI-CERT-DATE                PIC XX.
  2728
  2729     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2730     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2731
  2732     12  AM-OB-PAYMENT-MODE                PIC X.
  2733         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2734         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2735         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2736         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2737
  2738     12  AM-AH-ONLY-INDICATOR              PIC X.
  2739         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  49
* NSRASBL.cbl
  2740         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2741
  2742     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2743
  2744     12  AM-OVER-SHORT.
  2745         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2746         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2747
  2748     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2749     12  AM-DCC-CLP-STATE                  PIC XX.
  2750
  2751     12  AM-RECALC-COMM                    PIC X.
  2752     12  AM-RECALC-REIN                    PIC X.
  2753
  2754     12  AM-REI-TABLE                      PIC XXX.
  2755     12  AM-REI-ET-LF                      PIC X.
  2756     12  AM-REI-ET-AH                      PIC X.
  2757     12  AM-REI-PE-LF                      PIC X.
  2758     12  AM-REI-PE-AH                      PIC X.
  2759     12  AM-REI-PRT-ST                     PIC X.
  2760     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2761     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2762     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2763     12  AM-REI-GROUP-A                    PIC X(6).
  2764     12  AM-REI-MORT                       PIC X(4).
  2765     12  AM-REI-PRT-OW                     PIC X.
  2766     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2767     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2768     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2769     12  AM-REI-GROUP-B                    PIC X(6).
  2770
  2771     12  AM-TRUST-TYPE                     PIC X(2).
  2772
  2773     12  AM-EMPLOYER-STMT-USED             PIC X.
  2774     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2775
  2776     12  AM-STD-AH-TYPE                    PIC XX.
  2777     12  AM-EARN-METHODS.
  2778         16  AM-EARN-METHOD-R              PIC X.
  2779             88 AM-REF-RL-R78                 VALUE 'R'.
  2780             88 AM-REF-RL-PR                  VALUE 'P'.
  2781             88 AM-REF-RL-MEAN                VALUE 'M'.
  2782             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2783         16  AM-EARN-METHOD-L              PIC X.
  2784             88 AM-REF-LL-R78                 VALUE 'R'.
  2785             88 AM-REF-LL-PR                  VALUE 'P'.
  2786             88 AM-REF-LL-MEAN                VALUE 'M'.
  2787             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2788         16  AM-EARN-METHOD-A              PIC X.
  2789             88 AM-REF-AH-R78                 VALUE 'R'.
  2790             88 AM-REF-AH-PR                  VALUE 'P'.
  2791             88 AM-REF-AH-MEAN                VALUE 'M'.
  2792             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2793             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2794             88 AM-REF-AH-NET                 VALUE 'N'.
  2795
  2796     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2797     12  AM-TOL-REF                        PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  50
* NSRASBL.cbl
  2798     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2799
  2800     12  AM-RET-Y-N                        PIC X.
  2801     12  AM-RET-P-E                        PIC X.
  2802     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2803     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2804     12  AM-RET-GRP                        PIC X(6).
  2805     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2806         16  AM-POOL-PRIME                 PIC XXX.
  2807         16  AM-POOL-SUB                   PIC XXX.
  2808     12  AM-RETRO-EARNINGS.
  2809         16  AM-RET-EARN-R                 PIC X.
  2810         16  AM-RET-EARN-L                 PIC X.
  2811         16  AM-RET-EARN-A                 PIC X.
  2812     12  AM-RET-ST-TAX-USE                 PIC X.
  2813         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2814         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2815     12  AM-RETRO-BEG-EARNINGS.
  2816         16  AM-RET-BEG-EARN-R             PIC X.
  2817         16  AM-RET-BEG-EARN-L             PIC X.
  2818         16  AM-RET-BEG-EARN-A             PIC X.
  2819     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2820     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2821
  2822     12  AM-USER-SELECT-OPTIONS.
  2823         16  AM-USER-SELECT-1              PIC X(10).
  2824         16  AM-USER-SELECT-2              PIC X(10).
  2825         16  AM-USER-SELECT-3              PIC X(10).
  2826         16  AM-USER-SELECT-4              PIC X(10).
  2827         16  AM-USER-SELECT-5              PIC X(10).
  2828
  2829     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2830
  2831     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2832
  2833     12  AM-RPT045A-SWITCH                 PIC X.
  2834         88  RPT045A-OFF                   VALUE 'N'.
  2835
  2836     12  AM-INSURANCE-LIMITS.
  2837         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2838         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2839
  2840     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2841         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2842
  2843     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2844         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2845         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2846
  2847     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2848
  2849     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2850     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2851     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2852     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2853     12  AM-DCC-UEF-STATE                  PIC XX.
  2854     12  FILLER                            PIC XXX.
  2855     12  AM-REPORT-CODE-3                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  51
* NSRASBL.cbl
  2856*    12  FILLER                            PIC X(22).
  2857
  2858     12  AM-RESERVE-DATE.
  2859         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2860         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2861         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2862
  2863     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2864     12  AM-NOTIFICATION-TYPES.
  2865         16  AM-NOTIF-OF-LETTERS           PIC X.
  2866         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2867         16  AM-NOTIF-OF-REPORTS           PIC X.
  2868         16  AM-NOTIF-OF-STATUS            PIC X.
  2869
  2870     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2871         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2872         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2873         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2874         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2875
  2876     12  AM-BENEFIT-CONTROLS.
  2877         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2878             20  AM-BENEFIT-CODE           PIC XX.
  2879             20  AM-BENEFIT-TYPE           PIC X.
  2880             20  AM-BENEFIT-REVISION       PIC XXX.
  2881             20  AM-BENEFIT-REM-TERM       PIC X.
  2882             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2883             20  FILLER                    PIC XX.
  2884         16  FILLER                        PIC X(80).
  2885
  2886     12  AM-TRANSFER-DATA.
  2887         16  AM-TRANSFERRED-FROM.
  2888             20  AM-TRNFROM-CARRIER        PIC X.
  2889             20  AM-TRNFROM-GROUPING.
  2890                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2891                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2892             20  AM-TRNFROM-STATE          PIC XX.
  2893             20  AM-TRNFROM-ACCOUNT.
  2894                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2895                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2896             20  AM-TRNFROM-DTE            PIC XX.
  2897         16  AM-TRANSFERRED-TO.
  2898             20  AM-TRNTO-CARRIER          PIC X.
  2899             20  AM-TRNTO-GROUPING.
  2900                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2901                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2902             20  AM-TRNTO-STATE            PIC XX.
  2903             20  AM-TRNTO-ACCOUNT.
  2904                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2905                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2906             20  AM-TRNTO-DTE              PIC XX.
  2907         16  FILLER                        PIC X(10).
  2908
  2909     12  AM-SAVED-REMIT-TO                 PIC 99.
  2910
  2911     12  AM-COMM-STRUCTURE-SAVED.
  2912         16  AM-DEFN-1-SAVED.
  2913             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  52
* NSRASBL.cbl
  2914                 24  AM-AGT-SV             PIC X(10).
  2915                 24  AM-COM-TYP-SV         PIC X.
  2916                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2917                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2918                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2919                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2920                 24  FILLER                PIC X.
  2921                 24  AM-GL-CODES-SV        PIC X.
  2922                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2923                 24  FILLER                PIC X.
  2924         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2925             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2926                 24  FILLER                PIC X(11).
  2927                 24  AM-L-COMA-SV          PIC XXX.
  2928                 24  AM-J-COMA-SV          PIC XXX.
  2929                 24  AM-A-COMA-SV          PIC XXX.
  2930                 24  FILLER                PIC X(6).
  2931
  2932     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2933         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2934            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2935            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2936            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2937
  2938     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2939     12  FILLER                            PIC X(120).
  2940
  2941     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2942         16  AM-CONTROL-NAME               PIC X(30).
  2943         16  AM-EXECUTIVE-ONE.
  2944             20  AM-EXEC1-NAME             PIC X(15).
  2945             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2946                                                          COMP-3.
  2947             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2948                                                          COMP-3.
  2949         16  AM-EXECUTIVE-TWO.
  2950             20  AM-EXEC2-NAME             PIC X(15).
  2951             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2952                                                          COMP-3.
  2953             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2954                                                          COMP-3.
  2955
  2956     12  AM-RETRO-ADDITIONAL-DATA.
  2957         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2958         16  AM-RETRO-PREM-P-E             PIC X.
  2959         16  AM-RETRO-CLMS-P-I             PIC X.
  2960         16  AM-RETRO-RET-BRACKET-LF.
  2961             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2962                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2963                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2964             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2965                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2966                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2967             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2968                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2969                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2970         16  AM-RETRO-RET-BRACKET-AH.
  2971             20  AM-RETRO-RET-METHOD-AH    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  53
* NSRASBL.cbl
  2972                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2973                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2974                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2975             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2976                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2977                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2978             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2979                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2980                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2981
  2982     12  AM-COMMENTS.
  2983         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2984
  2985     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2986         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2987         16  AM-FLI-BILLING-CODE           PIC X.
  2988         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2989         16  AM-FLI-UNITED-IDENT           PIC X.
  2990         16  AM-FLI-INTEREST-LOST-DATA.
  2991             20  AM-FLI-BANK-NO            PIC X(5).
  2992             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2993             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2994             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2995         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2996             20  AM-FLI-AGT                PIC X(9).
  2997             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2998             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2999         16  FILLER                        PIC X(102).
  3000
  3001     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3002         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3003             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3004             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3005             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3006             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3007             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3008         16  FILLER                          PIC X(10).
  3009******************************************************************
  3010*                                COPY ELCTEXT.
  3011******************************************************************
  3012*                                                                *
  3013*                                                                *
  3014*                            ELCTEXT.                            *
  3015*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3016*                            VMOD=2.008                          *
  3017*                                                                *
  3018*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  3019*                                     FORM LETTERS,              *
  3020*                                     CERT FORM DISPLAY.
  3021*                                                                *
  3022*   FILE TYPE = VSAM,KSDS                                        *
  3023*   RECORD SIZE = 100   RECFORM = FIXED                          *
  3024*                                                                *
  3025*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  3026*       ALTERNATE INDEX = NONE                                   *
  3027*                                                                *
  3028*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  3029*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  54
* NSRASBL.cbl
  3030*                                                                *
  3031*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3032*       ALTERNATE INDEX = NONE                                   *
  3033*                                                                *
  3034*   LOG = NO                                                     *
  3035*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3036******************************************************************
  3037 01  TEXT-FILES.
  3038     12  TEXT-FILE-ID                PIC XX.
  3039         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3040         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3041         88  HELP-FILE-TEXT             VALUE 'TH'.
  3042
  3043     12  TX-CONTROL-PRIMARY.
  3044         16  TX-COMPANY-CD           PIC X.
  3045             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3046         16  TX-ACCESS-CD-GENL       PIC X(12).
  3047
  3048         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3049             20  TX-LETTER-NO        PIC X(4).
  3050             20  FILLER              PIC X(8).
  3051
  3052         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3053             20  TX-FORM-NO          PIC X(12).
  3054
  3055         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3056             20  TX-HELP-TYPE        PIC X.
  3057                 88  HELP-FOR-GENERAL   VALUE ' '.
  3058                 88  HELP-BY-SCREEN     VALUE 'S'.
  3059                 88  HELP-BY-ERROR      VALUE 'E'.
  3060             20  TX-SCREEN-OR-ERROR  PIC X(4).
  3061                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3062             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3063                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3064             20  FILLER              PIC X(4).
  3065
  3066         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3067
  3068     12  TX-PROCESS-CONTROL          PIC XX.
  3069         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3070
  3071     12  TX-TEXT-LINE                PIC X(70).
  3072
  3073     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3074         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3075         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3076         88  TX-VALID-FORM-SQUEEZE-VALUE
  3077                                        VALUE 'Y' ' '.
  3078
  3079     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3080         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3081         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3082         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3083         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3084         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3085         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3086         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  3087                                              'K' 'N' ' '
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  55
* NSRASBL.cbl
  3088                                              'Z'.
  3089
  3090     12  TX-ARCHIVE-SW               PIC X.
  3091         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  3092         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3093         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3094
  3095     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3096     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3097
  3098     12  TX-BSR-CODE                 PIC X.
  3099         88  TX-BSR-LETTER              VALUE 'B'.
  3100         88  TX-NON-BSR-LETTER          VALUE ' '.
  3101
  3102     12  FILLER                      PIC X.
  3103*****************************************************************
  3104*                                COPY ELCCNTL.
  3105******************************************************************
  3106*                                                                *
  3107*                                                                *
  3108*                            ELCCNTL.                            *
  3109*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3110*                            VMOD=2.059                          *
  3111*                                                                *
  3112*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3113*                                                                *
  3114*   FILE TYPE = VSAM,KSDS                                        *
  3115*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3116*                                                                *
  3117*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3118*       ALTERNATE INDEX = NONE                                   *
  3119*                                                                *
  3120*   LOG = YES                                                    *
  3121*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3122******************************************************************
  3123*                   C H A N G E   L O G
  3124*
  3125* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3126*-----------------------------------------------------------------
  3127*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3128* EFFECTIVE    NUMBER
  3129*-----------------------------------------------------------------
  3130* 082503                   PEMA  ADD BENEFIT GROUP
  3131* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3132* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3133* 092705    2005050300006  PEMA  ADD SPP LEASES
  3134* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3135* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3136* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3137* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3138* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3139* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3140* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3141* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3142* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3143* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3144* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  3145******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  56
* NSRASBL.cbl
  3146*
  3147 01  CONTROL-FILE.
  3148     12  CF-RECORD-ID                       PIC XX.
  3149         88  VALID-CF-ID                        VALUE 'CF'.
  3150
  3151     12  CF-CONTROL-PRIMARY.
  3152         16  CF-COMPANY-ID                  PIC XXX.
  3153         16  CF-RECORD-TYPE                 PIC X.
  3154             88  CF-COMPANY-MASTER              VALUE '1'.
  3155             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3156             88  CF-STATE-MASTER                VALUE '3'.
  3157             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3158             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3159             88  CF-CARRIER-MASTER              VALUE '6'.
  3160             88  CF-MORTALITY-MASTER            VALUE '7'.
  3161             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3162             88  CF-TERMINAL-MASTER             VALUE '9'.
  3163             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3164             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3165             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3166             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3167             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3168             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3169             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3170             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3171             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3172         16  CF-ACCESS-CD-GENL              PIC X(4).
  3173         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3174             20  CF-PROCESSOR               PIC X(4).
  3175         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3176             20  CF-STATE-CODE              PIC XX.
  3177             20  FILLER                     PIC XX.
  3178         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3179             20  FILLER                     PIC XX.
  3180             20  CF-HI-BEN-IN-REC           PIC XX.
  3181         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3182             20  FILLER                     PIC XXX.
  3183             20  CF-CARRIER-CNTL            PIC X.
  3184         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3185             20  FILLER                     PIC XX.
  3186             20  CF-HI-TYPE-IN-REC          PIC 99.
  3187         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3188             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3189                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3190             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3191             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3192         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3193             20  FILLER                     PIC X.
  3194             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3195         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3196             20  FILLER                     PIC XX.
  3197             20  CF-MORTGAGE-PLAN           PIC XX.
  3198         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3199
  3200     12  CF-LAST-MAINT-DT                   PIC XX.
  3201     12  CF-LAST-MAINT-BY                   PIC X(4).
  3202     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3203
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  57
* NSRASBL.cbl
  3204     12  CF-RECORD-BODY                     PIC X(728).
  3205
  3206
  3207****************************************************************
  3208*             COMPANY MASTER RECORD                            *
  3209****************************************************************
  3210
  3211     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3212         16  CF-COMPANY-ADDRESS.
  3213             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3214             20  CF-CL-IN-CARE-OF           PIC X(30).
  3215             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3216             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3217             20  CF-CL-CITY-STATE           PIC X(30).
  3218             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3219             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3220         16  CF-COMPANY-CD                  PIC X.
  3221         16  CF-COMPANY-PASSWORD            PIC X(8).
  3222         16  CF-SECURITY-OPTION             PIC X.
  3223             88  ALL-SECURITY                   VALUE '1'.
  3224             88  COMPANY-VERIFY                 VALUE '2'.
  3225             88  PROCESSOR-VERIFY               VALUE '3'.
  3226             88  NO-SECURITY                    VALUE '4'.
  3227             88  ALL-BUT-TERM                   VALUE '5'.
  3228         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3229             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3230         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3231             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3232         16  CF-INFORCE-LOCATION            PIC X.
  3233             88  CERTS-ARE-ONLINE               VALUE '1'.
  3234             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3235             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3236         16  CF-LOWER-CASE-LETTERS          PIC X.
  3237         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3238             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3239             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3240             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3241             88  CF-ACCNT-CNTL                  VALUE '3'.
  3242             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3243
  3244         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3245         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3246
  3247         16  CF-LGX-CREDIT-USER             PIC X.
  3248             88  CO-IS-NOT-USER                 VALUE 'N'.
  3249             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3250
  3251         16 CF-CREDIT-CALC-CODES.
  3252             20  CF-CR-REM-TERM-CALC PIC X.
  3253               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3254               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3255               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3256               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3257               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3258               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3259               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3260             20  CF-CR-R78-METHOD           PIC X.
  3261               88  USE-TERM-PLUS-ONE            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  58
* NSRASBL.cbl
  3262               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3263
  3264         16  CF-CLAIM-CONTROL-COUNTS.
  3265             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3266                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3267
  3268             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3269                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3270
  3271             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3272                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3273
  3274             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3275                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3276
  3277         16  CF-CURRENT-MONTH-END           PIC XX.
  3278
  3279         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3280             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3281             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3282             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3283             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3284                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3285                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3286             20  CF-CO-PREM-REJECT-SW       PIC X.
  3287                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3288                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3289             20  CF-CO-REF-REJECT-SW        PIC X.
  3290                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3291                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3292
  3293         16  CF-CO-REPORTING-DT             PIC XX.
  3294         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3295         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3296           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3297           88  CF-CO-MONTH-END                  VALUE '1'.
  3298
  3299         16  CF-LGX-CLAIM-USER              PIC X.
  3300             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3301             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3302
  3303         16  CF-CREDIT-EDIT-CONTROLS.
  3304             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3305             20  CF-MIN-AGE                 PIC 99.
  3306             20  CF-DEFAULT-AGE             PIC 99.
  3307             20  CF-MIN-TERM                PIC S999      COMP-3.
  3308             20  CF-MAX-TERM                PIC S999      COMP-3.
  3309             20  CF-DEFAULT-SEX             PIC X.
  3310             20  CF-JOINT-AGE-INPUT         PIC X.
  3311                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3312             20  CF-BIRTH-DATE-INPUT        PIC X.
  3313                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3314             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3315                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3316                 88  CF-ZERO-CARRIER            VALUE '1'.
  3317                 88  CF-ZERO-GROUPING           VALUE '2'.
  3318                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3319             20  CF-EDIT-SW                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  59
* NSRASBL.cbl
  3320                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3321             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3322             20  CF-CR-PR-METHOD            PIC X.
  3323               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3324               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3325             20  FILLER                     PIC X.
  3326
  3327         16  CF-CREDIT-MISC-CONTROLS.
  3328             20  CF-REIN-TABLE-SW           PIC X.
  3329                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3330             20  CF-COMP-TABLE-SW           PIC X.
  3331                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3332             20  CF-EXPERIENCE-RETENTION-AGE
  3333                                            PIC S9        COMP-3.
  3334             20  CF-CONVERSION-DT           PIC XX.
  3335             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3336             20  CF-RUN-FREQUENCY-SW        PIC X.
  3337                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3338                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3339
  3340             20  CF-CR-CHECK-NO-CONTROL.
  3341                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3342                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3343                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3344                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3345                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3346                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3347
  3348                 24  CF-CR-CHECK-COUNT       REDEFINES
  3349                     CF-CR-CHECK-COUNTER      PIC X(4).
  3350
  3351                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3352                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3353
  3354                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3355                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3356                 24  CF-MAIL-PROCESSING       PIC X.
  3357                     88  MAIL-PROCESSING          VALUE 'Y'.
  3358
  3359         16  CF-MISC-SYSTEM-CONTROL.
  3360             20  CF-SYSTEM-C                 PIC X.
  3361                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3362             20  CF-SYSTEM-D                 PIC X.
  3363                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3364             20  CF-SOC-SEC-NO-SW            PIC X.
  3365                 88  SOC-SEC-NO-USED             VALUE '1'.
  3366             20  CF-MEMBER-NO-SW             PIC X.
  3367                 88  MEMBER-NO-USED              VALUE '1'.
  3368             20  CF-TAX-ID-NUMBER            PIC X(11).
  3369             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3370             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3371                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3372                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3373                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3374                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3375             20  CF-SYSTEM-E                 PIC X.
  3376                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3377
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  60
* NSRASBL.cbl
  3378         16  CF-LGX-LIFE-USER               PIC X.
  3379             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3380             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3381
  3382         16  CF-CR-MONTH-END-DT             PIC XX.
  3383
  3384         16  CF-FILE-MAINT-DATES.
  3385             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3386                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3387             20  CF-LAST-BATCH       REDEFINES
  3388                 CF-LAST-BATCH-NO               PIC X(4).
  3389             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3390             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3391             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3392             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3393             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3394             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3395             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3396             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3397             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3398             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3399
  3400         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3401         16  FILLER                         PIC X.
  3402
  3403         16  CF-ALT-MORT-CODE               PIC X(4).
  3404         16  CF-MEMBER-CAPTION              PIC X(10).
  3405
  3406         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3407             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3408             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3409             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3410             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3411             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3412
  3413         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3414
  3415         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3416         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3417         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3418         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3419
  3420         16  CF-AH-OVERRIDE-L1              PIC X.
  3421         16  CF-AH-OVERRIDE-L2              PIC XX.
  3422         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3423         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3424
  3425         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3426         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3427
  3428         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3429         16  CF-AR-LAST-EL860-DT            PIC XX.
  3430         16  CF-MP-MONTH-END-DT             PIC XX.
  3431
  3432         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3433         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3434             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3435
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  61
* NSRASBL.cbl
  3436         16  CF-AR-MONTH-END-DT             PIC XX.
  3437
  3438         16  CF-CRDTCRD-USER                PIC X.
  3439             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3440             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3441
  3442         16  CF-CC-MONTH-END-DT             PIC XX.
  3443
  3444         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3445
  3446         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3447             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3448             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3449             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3450         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3451         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3452         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3453         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3454             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3455             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3456         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3457         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3458         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3459             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3460         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3461
  3462         16  CF-CL-ZIP-CODE.
  3463             20  CF-CL-ZIP-PRIME.
  3464                 24  CF-CL-ZIP-1ST          PIC X.
  3465                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3466                 24  FILLER                 PIC X(4).
  3467             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3468         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3469             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3470             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3471             20  FILLER                     PIC XXX.
  3472
  3473         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3474         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3475         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3476         16  CF-CO-OPTION-START-DATE        PIC XX.
  3477         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3478           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3479                                                      '3' '4'.
  3480           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3481           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3482           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3483           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3484           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3485           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3486
  3487         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3488
  3489         16  CF-PAYMENT-APPROVAL-LEVELS.
  3490             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3491             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3492             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3493             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  62
* NSRASBL.cbl
  3494             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3495             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3496
  3497         16  CF-END-USER-REPORTING-USER     PIC X.
  3498             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3499             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3500
  3501         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3502             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3503             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3504
  3505         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3506
  3507         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3508         16  FILLER                         PIC X.
  3509
  3510         16  CF-CREDIT-ARCHIVE-CNTL.
  3511             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3512             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3513             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3514
  3515         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3516
  3517         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3518             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3519             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3520
  3521         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3522             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3523             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3524
  3525         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3526
  3527         16  CF-CO-ACH-ID-CODE              PIC  X.
  3528             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3529             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3530             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3531         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3532         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3533         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3534         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3535         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3536         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3537         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3538         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3539         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3540                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3541         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3542                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3543
  3544         16  CF-CO-OVER-SHORT.
  3545             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3546             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3547
  3548*         16  FILLER                         PIC X(102).
  3549         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3550             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3551             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  63
* NSRASBL.cbl
  3552
  3553         16  CF-AH-APPROVAL-DAYS.
  3554             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3555             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3556             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3557             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3558
  3559         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3560
  3561         16  CF-APPROV-LEV-5.
  3562             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3563             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3564             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3565
  3566         16  FILLER                         PIC X(68).
  3567****************************************************************
  3568*             PROCESSOR/USER RECORD                            *
  3569****************************************************************
  3570
  3571     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3572         16  CF-PROCESSOR-NAME              PIC X(30).
  3573         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3574         16  CF-PROCESSOR-TITLE             PIC X(26).
  3575         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3576                 88  MESSAGE-YES                VALUE 'Y'.
  3577                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3578
  3579*****************************************************
  3580****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3581****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3582****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3583****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3584*****************************************************
  3585
  3586         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3587             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3588             20  CF-APPLICATION-FORCE       PIC X.
  3589             20  CF-INDIVIDUAL-APP.
  3590                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3591                     28  CF-BROWSE-APP      PIC X.
  3592                     28  CF-UPDATE-APP      PIC X.
  3593
  3594         16  CF-CURRENT-TERM-ON             PIC X(4).
  3595         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3596             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3597             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3598             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3599             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3600             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3601             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3602             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3603         16  CF-PROCESSOR-CARRIER           PIC X.
  3604             88  NO-CARRIER-SECURITY            VALUE ' '.
  3605         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3606             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3607         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3608             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3609         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  64
* NSRASBL.cbl
  3610             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3611
  3612         16  CF-PROC-SYS-ACCESS-SW.
  3613             20  CF-PROC-CREDIT-CLAIMS-SW.
  3614                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3615                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3616                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3617                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3618             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3619                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3620                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3621             20  CF-PROC-LIFE-GNRLDGR-SW.
  3622                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3623                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3624                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3625                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3626             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3627                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3628                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3629         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3630             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3631             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3632         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3633
  3634         16  CF-APPROVAL-LEVEL                  PIC X.
  3635             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3636             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3637             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3638             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3639             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3640
  3641         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3642
  3643         16  CF-LANGUAGE-TYPE                   PIC X.
  3644             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3645             88  CF-LANG-IS-FR                      VALUE 'F'.
  3646
  3647         16  CF-CSR-IND                         PIC X.
  3648         16  FILLER                             PIC X(239).
  3649
  3650****************************************************************
  3651*             PROCESSOR/REMINDERS RECORD                       *
  3652****************************************************************
  3653
  3654     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3655         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3656             20  CF-START-REMIND-DT         PIC XX.
  3657             20  CF-END-REMIND-DT           PIC XX.
  3658             20  CF-REMINDER-TEXT           PIC X(50).
  3659         16  FILLER                         PIC X(296).
  3660
  3661
  3662****************************************************************
  3663*             STATE MASTER RECORD                              *
  3664****************************************************************
  3665
  3666     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3667         16  CF-STATE-ABBREVIATION          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  65
* NSRASBL.cbl
  3668         16  CF-STATE-NAME                  PIC X(25).
  3669         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3670         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3671             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3672             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3673             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3674             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3675                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3676                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3677             20  CF-ST-PREM-REJECT-SW       PIC X.
  3678                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3679                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3680             20  CF-ST-REF-REJECT-SW        PIC X.
  3681                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3682                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3683         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3684         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3685         16  CF-ST-REFUND-RULES.
  3686             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3687             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3688             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3689         16  CF-ST-FST-PMT-EXTENSION.
  3690             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3691             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3692                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3693                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3694                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3695                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3696         16  CF-ST-STATE-CALL.
  3697             20  CF-ST-CALL-UNEARNED        PIC X.
  3698             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3699             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3700         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3701             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3702             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3703         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3704         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3705         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3706         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3707         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3708         16  FILLER                         PIC X.
  3709         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3710             20  CF-ST-BENEFIT-CD           PIC XX.
  3711             20  CF-ST-BENEFIT-KIND         PIC X.
  3712                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3713                 88  CF-ST-AH-KIND              VALUE 'A'.
  3714             20  CF-ST-REM-TERM-CALC        PIC X.
  3715                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3716                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3717                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3718                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3719                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3720                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3721                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3722                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3723
  3724             20  CF-ST-REFUND-CALC          PIC X.
  3725                 88  ST-REFUND-NOT-USED         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  66
* NSRASBL.cbl
  3726                 88  ST-REFD-BY-R78             VALUE '1'.
  3727                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3728                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3729                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3730                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3731                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3732                 88  ST-REFD-UTAH               VALUE '7'.
  3733                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3734                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3735                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3736
  3737             20  CF-ST-EARNING-CALC         PIC X.
  3738                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3739                 88  ST-EARN-BY-R78             VALUE '1'.
  3740                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3741                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3742                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3743                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3744                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3745                 88  ST-EARN-MEAN               VALUE '8'.
  3746                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3747
  3748             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3749                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3750                 88  ST-OVRD-BY-R78             VALUE '1'.
  3751                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3752                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3753                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3754                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3755                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3756                 88  ST-OVRD-MEAN               VALUE '8'.
  3757                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3758             20  cf-st-extra-periods        pic 9.
  3759*            20  FILLER                     PIC X.
  3760
  3761         16  CF-ST-COMMISSION-CAPS.
  3762             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3763             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3764             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3765             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3766         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3767                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3768                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  3769                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  3770
  3771         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3772
  3773         16  CF-ST-STATUTORY-INTEREST.
  3774             20  CF-ST-STAT-DATE-FROM       PIC X.
  3775                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3776                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3777             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3778             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3779             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3780             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3781             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3782
  3783         16  CF-ST-OVER-SHORT.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  67
* NSRASBL.cbl
  3784             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3785             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3786
  3787         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3788
  3789         16  CF-ST-RT-CALC                  PIC X.
  3790
  3791         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3792         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3793         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3794         16  CF-ST-RF-LR-CALC               PIC X.
  3795         16  CF-ST-RF-LL-CALC               PIC X.
  3796         16  CF-ST-RF-LN-CALC               PIC X.
  3797         16  CF-ST-RF-AH-CALC               PIC X.
  3798         16  CF-ST-RF-CP-CALC               PIC X.
  3799*        16  FILLER                         PIC X(206).
  3800*CIDMOD         16  FILLER                         PIC X(192).
  3801         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3802             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3803         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3804         16  CF-ST-VFY-2ND-BENE             PIC X.
  3805         16  CF-ST-CAUSAL-STATE             PIC X.
  3806         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3807         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3808         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3809             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3810         16  CF-ST-NET-ONLY-STATE           PIC X.
  3811             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3812         16  cf-commission-cap-required     pic x.
  3813         16  CF-ST-GA-COMMISSION-CAPS.
  3814             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  3815             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  3816             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  3817             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  3818         16  CF-ST-TOT-COMMISSION-CAPS.
  3819             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  3820             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  3821             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  3822             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  3823         16  FILLER                         PIC X(156).
  3824
  3825****************************************************************
  3826*             BENEFIT MASTER RECORD                            *
  3827****************************************************************
  3828
  3829     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3830         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3831             20  CF-BENEFIT-CODE            PIC XX.
  3832             20  CF-BENEFIT-NUMERIC  REDEFINES
  3833                 CF-BENEFIT-CODE            PIC XX.
  3834             20  CF-BENEFIT-ALPHA           PIC XXX.
  3835             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3836             20  CF-BENEFIT-COMMENT         PIC X(10).
  3837
  3838             20  CF-LF-COVERAGE-TYPE        PIC X.
  3839                 88  CF-REDUCING                VALUE 'R'.
  3840                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3841
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  68
* NSRASBL.cbl
  3842             20  CF-SPECIAL-CALC-CD         PIC X.
  3843                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3844                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3845                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3846                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3847                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3848                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3849                 88  CF-FARM-PLAN               VALUE 'F'.
  3850                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3851                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3852                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3853                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3854                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3855                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3856                 88  CF-PRUDENTIAL              VALUE 'P'.
  3857                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3858                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3859                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3860                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3861                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3862                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3863
  3864             20  CF-JOINT-INDICATOR         PIC X.
  3865                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3866
  3867*            20  FILLER                     PIC X(12).
  3868             20  cf-maximum-benefits        pic s999 comp-3.
  3869             20  FILLER                     PIC X(09).
  3870             20  CF-BENEFIT-CATEGORY        PIC X.
  3871             20  CF-LOAN-TYPE               PIC X(8).
  3872
  3873             20  CF-CO-REM-TERM-CALC        PIC X.
  3874                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3875                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3876                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3877                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3878                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3879
  3880             20  CF-CO-EARNINGS-CALC        PIC X.
  3881                 88  CO-EARN-BY-R78             VALUE '1'.
  3882                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3883                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3884                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3885                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3886                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3887                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3888                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3889
  3890             20  CF-CO-REFUND-CALC          PIC X.
  3891                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3892                 88  CO-REFD-BY-R78             VALUE '1'.
  3893                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3894                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3895                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3896                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3897                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3898                 88  CO-REFD-MEAN               VALUE '8'.
  3899                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  69
* NSRASBL.cbl
  3900                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3901                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3902
  3903             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3904                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3905                 88  CO-OVRD-BY-R78             VALUE '1'.
  3906                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3907                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3908                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3909                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3910                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3911                 88  CO-OVRD-MEAN               VALUE '8'.
  3912                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3913
  3914             20  CF-CO-BEN-I-G-CD           PIC X.
  3915                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3916                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3917                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3918
  3919         16  FILLER                         PIC X(304).
  3920
  3921
  3922****************************************************************
  3923*             CARRIER MASTER RECORD                            *
  3924****************************************************************
  3925
  3926     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3927         16  CF-ADDRESS-DATA.
  3928             20  CF-MAIL-TO-NAME            PIC X(30).
  3929             20  CF-IN-CARE-OF              PIC X(30).
  3930             20  CF-ADDRESS-LINE-1          PIC X(30).
  3931             20  CF-ADDRESS-LINE-2          PIC X(30).
  3932             20  CF-CITY-STATE              PIC X(30).
  3933             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3934             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3935
  3936         16  CF-CLAIM-NO-CONTROL.
  3937             20  CF-CLAIM-NO-METHOD         PIC X.
  3938                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3939                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3940                 88  CLAIM-NO-SEQ               VALUE '3'.
  3941                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3942             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3943                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3944                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3945                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3946
  3947         16  CF-CHECK-NO-CONTROL.
  3948             20  CF-CHECK-NO-METHOD         PIC X.
  3949                 88  CHECK-NO-MANUAL            VALUE '1'.
  3950                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3951                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3952                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3953             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3954                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3955
  3956         16  CF-DOMICILE-STATE              PIC XX.
  3957
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  70
* NSRASBL.cbl
  3958         16  CF-EXPENSE-CONTROLS.
  3959             20  CF-EXPENSE-METHOD          PIC X.
  3960                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3961                 88  DOLLARS-PER-PMT            VALUE '2'.
  3962                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3963                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3964             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3965             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3966
  3967         16  CF-CORRESPONDENCE-CONTROL.
  3968             20  CF-LETTER-RESEND-OPT       PIC X.
  3969                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3970                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3971             20  FILLER                     PIC X(4).
  3972
  3973         16  CF-RESERVE-CONTROLS.
  3974             20  CF-MANUAL-SW               PIC X.
  3975                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3976             20  CF-FUTURE-SW               PIC X.
  3977                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3978             20  CF-PTC-SW                  PIC X.
  3979                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3980             20  CF-IBNR-SW                 PIC X.
  3981                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3982             20  CF-PTC-LF-SW               PIC X.
  3983                 88  CF-LF-PTC-USED             VALUE '1'.
  3984             20  CF-CDT-ACCESS-METHOD       PIC X.
  3985                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3986                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3987                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3988             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3989
  3990         16  CF-CLAIM-CALC-METHOD           PIC X.
  3991             88  360-PLUS-MONTHS                VALUE '1'.
  3992             88  365-PLUS-MONTHS                VALUE '2'.
  3993             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3994             88  360-DAILY                      VALUE '4'.
  3995             88  365-DAILY                      VALUE '5'.
  3996
  3997         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3998         16  FILLER                         PIC X(11).
  3999
  4000         16  CF-LIMIT-AMOUNTS.
  4001             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4002             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4003             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4004             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4005             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4006             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4007             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4008             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4009             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4010             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4011
  4012         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4013         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4014         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4015
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  71
* NSRASBL.cbl
  4016         16  CF-ZIP-CODE.
  4017             20  CF-ZIP-PRIME.
  4018                 24  CF-ZIP-1ST             PIC X.
  4019                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4020                 24  FILLER                 PIC X(4).
  4021             20  CF-ZIP-PLUS4               PIC X(4).
  4022         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4023             20  CF-CAN-POSTAL-1            PIC XXX.
  4024             20  CF-CAN-POSTAL-2            PIC XXX.
  4025             20  FILLER                     PIC XXX.
  4026
  4027         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4028         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4029         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4030
  4031         16  CF-RATING-SWITCH               PIC X.
  4032             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4033             88  CF-NO-RATING                   VALUE 'N'.
  4034
  4035         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4036
  4037         16  CF-CARRIER-OVER-SHORT.
  4038             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4039             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4040
  4041         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4042         16  CF-SECPAY-SWITCH               PIC X.
  4043             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4044             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4045         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4046         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4047         16  FILLER                         PIC X(444).
  4048*        16  FILLER                         PIC X(452).
  4049
  4050
  4051****************************************************************
  4052*             MORTALITY MASTER RECORD                          *
  4053****************************************************************
  4054
  4055     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4056         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4057                                INDEXED BY CF-MORT-NDX.
  4058             20  CF-MORT-TABLE              PIC X(5).
  4059             20  CF-MORT-TABLE-TYPE         PIC X.
  4060                 88  CF-MORT-JOINT              VALUE 'J'.
  4061                 88  CF-MORT-SINGLE             VALUE 'S'.
  4062                 88  CF-MORT-COMBINED           VALUE 'C'.
  4063                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4064                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4065             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4066             20  CF-MORT-AGE-METHOD         PIC XX.
  4067                 88  CF-AGE-LAST                VALUE 'AL'.
  4068                 88  CF-AGE-NEAR                VALUE 'AN'.
  4069             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4070             20  CF-MORT-ADJUSTMENT-DIRECTION
  4071                                            PIC X.
  4072                 88  CF-MINUS                   VALUE '-'.
  4073                 88  CF-PLUS                    VALUE '+'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  72
* NSRASBL.cbl
  4074             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4075             20  CF-MORT-JOINT-CODE         PIC X.
  4076                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4077             20  CF-MORT-PC-Q               PIC X.
  4078                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4079             20  CF-MORT-TABLE-CODE         PIC X(4).
  4080             20  CF-MORT-COMMENTS           PIC X(15).
  4081             20  FILLER                     PIC X(14).
  4082
  4083         16  FILLER                         PIC X(251).
  4084
  4085
  4086****************************************************************
  4087*             BUSSINESS TYPE MASTER RECORD                     *
  4088****************************************************************
  4089
  4090     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4091* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4092* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4093* AND RECORD 05 IS TYPES 81-99
  4094         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4095             20  CF-BUSINESS-TITLE          PIC  X(19).
  4096             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4097                                            PIC S9V9(4) COMP-3.
  4098             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4099             20  FILLER                     PIC  X.
  4100         16  FILLER                         PIC  X(248).
  4101
  4102
  4103****************************************************************
  4104*             TERMINAL MASTER RECORD                           *
  4105****************************************************************
  4106
  4107     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4108
  4109         16  CF-COMPANY-TERMINALS.
  4110             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4111                                  PIC X(4).
  4112         16  FILLER               PIC X(248).
  4113
  4114
  4115****************************************************************
  4116*             LIFE EDIT MASTER RECORD                          *
  4117****************************************************************
  4118
  4119     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4120         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4121             20  CF-LIFE-CODE-IN            PIC XX.
  4122             20  CF-LIFE-CODE-OUT           PIC XX.
  4123         16  FILLER                         PIC X(248).
  4124
  4125
  4126****************************************************************
  4127*             AH EDIT MASTER RECORD                            *
  4128****************************************************************
  4129
  4130     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4131         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  73
* NSRASBL.cbl
  4132             20  CF-AH-CODE-IN              PIC XXX.
  4133             20  CF-AH-CODE-OUT             PIC XX.
  4134         16  FILLER                         PIC X(248).
  4135
  4136
  4137****************************************************************
  4138*             CREDIBILITY TABLES                               *
  4139****************************************************************
  4140
  4141     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4142         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4143                             INDEXED BY CF-CRDB-NDX.
  4144             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4145             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4146             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4147         16  FILLER                         PIC  X(332).
  4148
  4149
  4150****************************************************************
  4151*             REPORT CUSTOMIZATION RECORD                      *
  4152****************************************************************
  4153
  4154     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4155         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4156             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4157             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4158             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4159**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4160****       A T-TRANSFER.                                   ****
  4161             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4162
  4163         16  FILLER                         PIC XX.
  4164
  4165         16  CF-CARRIER-CNTL-OPT.
  4166             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4167                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4168                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4169             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4170                                            PIC X.
  4171         16  CF-GROUP-CNTL-OPT.
  4172             20  CF-GROUP-OPT-SEQ           PIC 9.
  4173                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4174                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4175             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4176                                            PIC X(6).
  4177         16  CF-STATE-CNTL-OPT.
  4178             20  CF-STATE-OPT-SEQ           PIC 9.
  4179                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4180                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4181             20  CF-STATE-SELECT OCCURS 3 TIMES
  4182                                            PIC XX.
  4183         16  CF-ACCOUNT-CNTL-OPT.
  4184             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4185                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4186                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4187             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4188                                            PIC X(10).
  4189         16  CF-BUS-TYP-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  74
* NSRASBL.cbl
  4190             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4191                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4192                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4193             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4194                                            PIC XX.
  4195         16  CF-LF-TYP-CNTL-OPT.
  4196             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4197                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4198                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4199             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4200                                            PIC XX.
  4201         16  CF-AH-TYP-CNTL-OPT.
  4202             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4203                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4204                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4205             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4206                                            PIC XX.
  4207         16  CF-REPTCD1-CNTL-OPT.
  4208             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4209                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4210                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4211             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4212                                            PIC X(10).
  4213         16  CF-REPTCD2-CNTL-OPT.
  4214             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4215                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4216                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4217             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4218                                            PIC X(10).
  4219         16  CF-USER1-CNTL-OPT.
  4220             20  CF-USER1-OPT-SEQ           PIC 9.
  4221                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4222                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4223             20  CF-USER1-SELECT OCCURS 3 TIMES
  4224                                            PIC X(10).
  4225         16  CF-USER2-CNTL-OPT.
  4226             20  CF-USER2-OPT-SEQ           PIC 9.
  4227                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4228                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4229             20  CF-USER2-SELECT OCCURS 3 TIMES
  4230                                            PIC X(10).
  4231         16  CF-USER3-CNTL-OPT.
  4232             20  CF-USER3-OPT-SEQ           PIC 9.
  4233                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4234                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4235             20  CF-USER3-SELECT OCCURS 3 TIMES
  4236                                            PIC X(10).
  4237         16  CF-USER4-CNTL-OPT.
  4238             20  CF-USER4-OPT-SEQ           PIC 9.
  4239                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4240                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4241             20  CF-USER4-SELECT OCCURS 3 TIMES
  4242                                            PIC X(10).
  4243         16  CF-USER5-CNTL-OPT.
  4244             20  CF-USER5-OPT-SEQ           PIC 9.
  4245                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4246                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4247             20  CF-USER5-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  75
* NSRASBL.cbl
  4248                                            PIC X(10).
  4249         16  CF-REINS-CNTL-OPT.
  4250             20  CF-REINS-OPT-SEQ           PIC 9.
  4251                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4252                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4253             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4254                 24  CF-REINS-PRIME         PIC XXX.
  4255                 24  CF-REINS-SUB           PIC XXX.
  4256
  4257         16  CF-AGENT-CNTL-OPT.
  4258             20  CF-AGENT-OPT-SEQ           PIC 9.
  4259                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4260                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4261             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4262                                            PIC X(10).
  4263
  4264         16  FILLER                         PIC X(43).
  4265
  4266         16  CF-LOSS-RATIO-SELECT.
  4267             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4268             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4269         16  CF-ENTRY-DATE-SELECT.
  4270             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4271             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4272         16  CF-EFFECTIVE-DATE-SELECT.
  4273             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4274             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4275
  4276         16  CF-EXCEPTION-LIST-IND          PIC X.
  4277             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4278
  4279         16  FILLER                         PIC X(318).
  4280
  4281****************************************************************
  4282*                  EXCEPTION REPORTING RECORD                  *
  4283****************************************************************
  4284
  4285     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4286         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4287             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4288
  4289         16  CF-COMBINED-LIFE-AH-OPT.
  4290             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4291             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4292             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4293             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4294
  4295         16  CF-LIFE-OPT.
  4296             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4297             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4298             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4299             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4300             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4301             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4302             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4303             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4304             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4305             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  76
* NSRASBL.cbl
  4306
  4307         16  CF-AH-OPT.
  4308             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4309             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4310             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4311             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4312             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4313             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4314             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4315             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4316             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4317             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4318
  4319         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4320             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4321             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4322             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4323
  4324         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4325
  4326         16  FILLER                         PIC X(673).
  4327
  4328
  4329****************************************************************
  4330*             MORTGAGE SYSTEM PLAN RECORD                      *
  4331****************************************************************
  4332
  4333     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4334         16  CF-PLAN-TYPE                   PIC X.
  4335             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4336             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4337             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4338         16  CF-PLAN-ABBREV                 PIC XXX.
  4339         16  CF-PLAN-DESCRIPT               PIC X(10).
  4340         16  CF-PLAN-NOTES                  PIC X(20).
  4341         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4342         16  CF-PLAN-UNDERWRITING.
  4343             20  CF-PLAN-TERM-DATA.
  4344                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4345                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4346             20  CF-PLAN-AGE-DATA.
  4347                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4348                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4349                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4350             20  CF-PLAN-BENEFIT-DATA.
  4351                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4352                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4353                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4354                                            PIC S9(7)V99  COMP-3.
  4355         16  CF-PLAN-POLICY-FORMS.
  4356             20  CF-POLICY-FORM             PIC X(12).
  4357             20  CF-MASTER-APPLICATION      PIC X(12).
  4358             20  CF-MASTER-POLICY           PIC X(12).
  4359         16  CF-PLAN-RATING.
  4360             20  CF-RATE-CODE               PIC X(5).
  4361             20  CF-SEX-RATING              PIC X.
  4362                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4363                 88  CF-PLAN-SEX-RATED         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  77
* NSRASBL.cbl
  4364             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4365             20  CF-SUB-STD-TYPE            PIC X.
  4366                 88  CF-PCT-OF-PREM            VALUE '1'.
  4367                 88  CF-PCT-OF-BENE            VALUE '2'.
  4368         16  CF-PLAN-PREM-TOLERANCES.
  4369             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4370             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4371         16  CF-PLAN-PYMT-TOLERANCES.
  4372             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4373             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4374         16  CF-PLAN-MISC-DATA.
  4375             20  FILLER                     PIC X.
  4376             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4377             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4378         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4379         16  CF-PLAN-IND-GRP                PIC X.
  4380             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4381                                                     '1'.
  4382             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4383                                                     '2'.
  4384         16  CF-MIB-SEARCH-SW               PIC X.
  4385             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4386             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4387             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4388             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4389         16  CF-ALPHA-SEARCH-SW             PIC X.
  4390             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4391             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4392             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4393             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4394             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4395             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4396             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4397             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4398             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4399             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4400                                                     'A' 'B' 'C'
  4401                                                     'X' 'Y' 'Z'.
  4402         16  CF-EFF-DT-RULE-SW              PIC X.
  4403             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4404             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4405             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4406             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4407             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4408         16  FILLER                         PIC X(4).
  4409         16  CF-HEALTH-QUESTIONS            PIC X.
  4410             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4411         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4412         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4413         16  CF-PLAN-SNGL-JNT               PIC X.
  4414             88  CF-COMBINED-PLAN              VALUE 'C'.
  4415             88  CF-JNT-PLAN                   VALUE 'J'.
  4416             88  CF-SNGL-PLAN                  VALUE 'S'.
  4417         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4418         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4419         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4420         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4421         16  CF-RERATE-CNTL                 PIC  X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  78
* NSRASBL.cbl
  4422             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4423             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4424             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4425             88  CF-AUTO-RECALC                 VALUE '4'.
  4426         16  CF-BENEFIT-TYPE                PIC  X.
  4427             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4428             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4429         16  CF-POLICY-FEE                  PIC S999V99
  4430                                                    COMP-3.
  4431         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4432         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4433         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4434         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4435         16  FILLER                         PIC  X(32).
  4436         16  CF-TERMINATION-FORM            PIC  X(04).
  4437         16  FILLER                         PIC  X(08).
  4438         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4439                                                       COMP-3.
  4440         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4441         16  CF-ISSUE-LETTER                PIC  X(4).
  4442         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4443         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4444             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4445             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4446         16  CF-MP-REFUND-CALC              PIC X.
  4447             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4448             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4449             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4450             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4451             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4452             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4453             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4454             88  CF-MP-REFD-MEAN                VALUE '8'.
  4455         16  CF-ALT-RATE-CODE               PIC  X(5).
  4456
  4457
  4458         16  FILLER                         PIC X(498).
  4459****************************************************************
  4460*             MORTGAGE COMPANY MASTER RECORD                   *
  4461****************************************************************
  4462
  4463     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4464         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4465         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4466             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4467             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4468             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4469             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4470             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4471
  4472         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4473         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4474         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4475         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4476         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4477
  4478         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4479             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  79
* NSRASBL.cbl
  4480         16  CF-MP-RECON-USE-IND            PIC X(1).
  4481             88  CF-MP-USE-RECON             VALUE 'Y'.
  4482         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4483             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4484         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4485             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4486             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4487         16  FILLER                         PIC X(1).
  4488         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4489             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4490         16  CF-MORTG-MIB-VERSION           PIC X.
  4491             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4492             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4493             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4494         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4495             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4496                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4497             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4498                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4499             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4500                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4501             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4502                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4503             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4504                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4505             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4506                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4507         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4508         16  FILLER                         PIC X(7).
  4509         16  CF-MORTG-DESTINATION-SYMBOL.
  4510             20  CF-MORTG-MIB-COMM          PIC X(5).
  4511             20  CF-MORTG-MIB-TERM          PIC X(5).
  4512         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4513             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4514         16  FILLER                         PIC X(03).
  4515         16  CF-MP-CHECK-NO-CONTROL.
  4516             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4517                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4518                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4519                                                ' ' LOW-VALUES.
  4520                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4521                                               VALUE '3'.
  4522         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4523         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4524         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4525             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4526                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4527             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4528                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4529             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4530                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4531             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4532                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4533             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4534                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4535             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4536                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4537         16  CF-MORTG-BILLING-AREA.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  80
* NSRASBL.cbl
  4538             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4539                                            PIC X.
  4540         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4541         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4542         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4543         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4544             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4545             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4546         16  FILLER                         PIC X.
  4547         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4548             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4549             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4550         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4551         16  FILLER                         PIC X(8).
  4552         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4553         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4554         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4555         16  CF-ACH-COMPANY-ID.
  4556             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4557                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4558                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4559                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4560             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4561         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4562             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4563         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4564             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4565             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4566         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4567         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4568         16  FILLER                         PIC X(536).
  4569
  4570****************************************************************
  4571*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4572****************************************************************
  4573
  4574     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4575         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4576             20  CF-FEMALE-HEIGHT.
  4577                 24  CF-FEMALE-FT           PIC 99.
  4578                 24  CF-FEMALE-IN           PIC 99.
  4579             20  CF-FEMALE-MIN-WT           PIC 999.
  4580             20  CF-FEMALE-MAX-WT           PIC 999.
  4581         16  FILLER                         PIC X(428).
  4582
  4583     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4584         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4585             20  CF-MALE-HEIGHT.
  4586                 24  CF-MALE-FT             PIC 99.
  4587                 24  CF-MALE-IN             PIC 99.
  4588             20  CF-MALE-MIN-WT             PIC 999.
  4589             20  CF-MALE-MAX-WT             PIC 999.
  4590         16  FILLER                         PIC X(428).
  4591******************************************************************
  4592*             AUTOMATIC ACTIVITY RECORD                          *
  4593******************************************************************
  4594     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4595         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  81
* NSRASBL.cbl
  4596             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4597             20  CF-SYS-LETTER-ID           PIC X(04).
  4598             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4599             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4600             20  CF-SYS-RESET-SW            PIC X(01).
  4601             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4602             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4603
  4604         16  FILLER                         PIC X(50).
  4605
  4606         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4607             20  CF-USER-ACTIVE-SW          PIC X(01).
  4608             20  CF-USER-LETTER-ID          PIC X(04).
  4609             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4610             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4611             20  CF-USER-RESET-SW           PIC X(01).
  4612             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4613             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4614             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4615
  4616         16  FILLER                         PIC X(246).
  4617*                                COPY NSCASVARS.
  4618******************************************************************
  4619*                   C H A N G E   L O G
  4620*
  4621*        CURRENT SIZE - 6180
  4622*
  4623* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4624*-----------------------------------------------------------------
  4625*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4626* EFFECTIVE    NUMBER
  4627*-----------------------------------------------------------------
  4628* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4629* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4630* 091213  CR2013090300001  AJRA  ADD NEXT BUSINESS DATE
  4631* 121015  CR2015100900001  TANA  ADD VIN NUMBER
  4632******************************************************************
  4633 01 NAPER-OUTPUT-DATA.
  4634    05  F                       PIC X(07) VALUE "LETTER=".
  4635    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4636    05  F                       PIC X(08) VALUE "~PROCID=".
  4637    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4638    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4639    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4640    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4641    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4642    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4643    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4644    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4645    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4646    05  F                       PIC X(06) VALUE "~CARR=".
  4647    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4648    05  F                       PIC X(10) VALUE "~GROUPING=".
  4649    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4650    05  F                       PIC X(08) VALUE "~CERTST=".
  4651    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4652    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4653    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  82
* NSRASBL.cbl
  4654    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4655    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4656    05  F                       PIC X(07) VALUE "~CRTNO=".
  4657    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4658    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4659    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4660    05  F                       PIC X(08) VALUE "~ILNAME=".
  4661    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4662    05  F                       PIC X(08) VALUE "~IFNAME=".
  4663    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4664    05  F                       PIC X(08) VALUE "~IFINIT=".
  4665    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4666    05  F                       PIC X(08) VALUE "~IMINIT=".
  4667    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4668    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4669    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4670    05  F                       PIC X(06) VALUE "~ISEX=".
  4671    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4672    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4673    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4674    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4675    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4676    05  F                       PIC X(09) VALUE "~INSCITY=".
  4677    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4678    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4679    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4680    05  F                       PIC X(08) VALUE "~INSZIP=".
  4681    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4682    05  F                       PIC X(05) VALUE "~SSN=".
  4683    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4684    05  F                       PIC X(07) VALUE "~MEMNO=".
  4685    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4686    05  F                       PIC X(08) VALUE "~JLNAME=".
  4687    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4688    05  F                       PIC X(08) VALUE "~JFNAME=".
  4689    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4690    05  F                       PIC X(08) VALUE "~JMINIT=".
  4691    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4692    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4693    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4694    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4695    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4696    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4697    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4698    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4699    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4700    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4701    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4702    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4703    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4704    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4705    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4706    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4707    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4708    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4709    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4710    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4711    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  83
* NSRASBL.cbl
  4712    05  F                       PIC X(10) VALUE "~BENENAME=".
  4713    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4714    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4715    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4716    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4717    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4718    05  F                       PIC X(10) VALUE "~BENECITY=".
  4719    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4720    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4721    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4722    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4723    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4724    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4725    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4726    05  F                       PIC X(08) VALUE "~RESPNO=".
  4727    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4728    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4729    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4730    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4731    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4732    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4733    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4734    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4735    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4736    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4737    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4738    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4739    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4740    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4741    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4742    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4743    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4744    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4745    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4746    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4747    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4748    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4749    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4750    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4751    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4752    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4753    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4754    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4755    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4756    05  F                       PIC X(07) VALUE "~BATCH=".
  4757    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4758    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4759    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4760    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4761    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4762    05  F                       PIC X(05) VALUE "~APR=".
  4763    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4764    05  F                       PIC X(08) VALUE "~LNTERM=".
  4765    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4766    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4767    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4768    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4769    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  84
* NSRASBL.cbl
  4770    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4771    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4772    05  F                       PIC X(07) VALUE "~UCODE=".
  4773    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4774    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4775    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4776    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4777    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4778    05  F                       PIC X(06) VALUE "~SKIP=".
  4779    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4780    05  F                       PIC X(06) VALUE "~MODE=".
  4781    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4782    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4783    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4784    05  F                       PIC X(06) VALUE "~RTBL=".
  4785    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4786    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4787    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4788    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4789    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4790    05  F                       PIC X(08) VALUE "~LFTERM=".
  4791    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4792    05  F                       PIC X(07) VALUE "~LFDEV=".
  4793    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4794    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4795    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4796    05  F                       PIC X(07) VALUE "~LFBEN=".
  4797    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4798    05  F                       PIC X(08) VALUE "~LFPREM=".
  4799    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4800    05  F                       PIC X(08) VALUE "~LFABEN=".
  4801    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4802    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4803    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4804    05  F                       PIC X(07) VALUE "~LFNSP=".
  4805    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4806    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4807    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4808    05  F                       PIC X(07) VALUE "~LFCAN=".
  4809    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4810    05  F                       PIC X(07) VALUE "~LFDTH=".
  4811    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4812    05  F                       PIC X(08) VALUE "~LFRATE=".
  4813    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4814    05  F                       PIC X(09) VALUE "~LFARATE=".
  4815    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4816    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4817    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4818    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4819    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4820    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4821    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4822    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4823    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4824    05  F                       PIC X(07) VALUE "~DTHDT=".
  4825    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4826    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4827    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  85
* NSRASBL.cbl
  4828    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4829    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4830    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4831    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4832    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4833    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4834    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4835    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4836    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4837    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4838    05  F                       PIC X(08) VALUE "~AHTERM=".
  4839    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4840    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4841    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4842    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4843    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4844    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4845    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4846    05  F                       PIC X(07) VALUE "~AHBEN=".
  4847    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4848    05  F                       PIC X(08) VALUE "~AHPREM=".
  4849    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4850    05  F                       PIC X(07) VALUE "~AHNSP=".
  4851    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4852    05  F                       PIC X(07) VALUE "~AHCAN=".
  4853    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4854    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4855    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4856    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4857    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4858    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4859    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4860    05  F                       PIC X(08) VALUE "~AHRATE=".
  4861    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4862    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4863    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4864    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4865    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4866    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4867    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4868    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4869    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4870    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4871    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4872    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4873    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4874    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4875    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4876    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4877    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4878    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4879    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4880    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4881    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4882    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4883    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4884    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4885                                PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  86
* NSRASBL.cbl
  4886    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4887    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4888    05  F                       PIC X(08) VALUE "~TOTREF=".
  4889    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4890    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4891    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4892    05  F                       PIC X(07) VALUE "~STERM=".
  4893    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4894    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4895    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4896    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4897    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4898    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4899    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4900    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4901    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4902    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4903    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4904    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4905    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4906    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4907    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4908    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4909    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4910    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4911    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4912    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4913    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4914    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4915    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4916    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4917                                PIC X(12).
  4918    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4919    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4920    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4921                                PIC X(12).
  4922    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4923    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4924    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4925    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4926    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4927    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4928    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4929    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4930    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4931                                PIC X(12).
  4932    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4933    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4934    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4935                                PIC X(10).
  4936    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4937    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4938    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4939    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4940    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4941    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4942    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4943    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  87
* NSRASBL.cbl
  4944    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4945    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4946    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4947    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4948    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4949                                PIC X(10).
  4950    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4951    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4952    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4953                                PIC X(10).
  4954    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4955    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4956    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4957    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4958    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4959    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4960    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4961    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4962    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4963    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4964    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4965    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4966    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4967    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4968    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4969    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4970    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4971    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4972    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4973                                PIC X(2).
  4974    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4975    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4976    05  F                       PIC X(08) VALUE "~OSTERM=".
  4977    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4978    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4979    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4980    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4981    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4982    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4983    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4984    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4985    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4986    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4987                                PIC X(09).
  4988    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4989    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4990    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4991    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4992    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4993    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4994    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4995    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4996    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4997                                PIC X(09).
  4998    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  4999    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  5000    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  5001    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  88
* NSRASBL.cbl
  5002    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  5003                                PIC X(09).
  5004    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  5005    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  5006    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  5007                                PIC X(12).
  5008    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  5009    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  5010    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  5011                                PIC X(10).
  5012    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  5013    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  5014    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  5015    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  5016    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  5017                                PIC X(12).
  5018    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  5019    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  5020    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  5021                                PIC X(10).
  5022    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  5023    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  5024    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  5025    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  5026    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  5027    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  5028    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  5029    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  5030    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  5031                                PIC X(09).
  5032    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  5033    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  5034    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  5035                                PIC X(09).
  5036    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  5037    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  5038    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  5039                                PIC X(10).
  5040    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  5041    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  5042    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  5043                                PIC X(10).
  5044    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  5045    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  5046    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  5047    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  5048    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  5049    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  5050    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  5051    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  5052    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  5053    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  5054    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  5055    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  5056    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  5057    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  5058    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  5059                                PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  89
* NSRASBL.cbl
  5060    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  5061    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  5062    05  F                       PIC X(08) VALUE "~NSTERM=".
  5063    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  5064    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  5065                                PIC X(09).
  5066    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  5067    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  5068    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  5069    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  5070    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  5071    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  5072    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  5073    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  5074    05  F                       PIC X(09) VALUE "~BALLOON=".
  5075    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  5076    05  F                       PIC X(10) VALUE "~LEASEIND=".
  5077    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  5078    05  F                       PIC X(09) VALUE "~RESCIND=".
  5079    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  5080    05  F                       PIC X(07) VALUE "~RCD01=".
  5081    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  5082    05  F                       PIC X(07) VALUE "~RCD02=".
  5083    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  5084    05  F                       PIC X(07) VALUE "~RCD03=".
  5085    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  5086    05  F                       PIC X(07) VALUE "~RCD04=".
  5087    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  5088    05  F                       PIC X(07) VALUE "~RCD05=".
  5089    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  5090    05  F                       PIC X(07) VALUE "~RCD06=".
  5091    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  5092    05  F                       PIC X(07) VALUE "~RCD07=".
  5093    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  5094    05  F                       PIC X(07) VALUE "~RCD08=".
  5095    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  5096    05  F                       PIC X(07) VALUE "~RCD09=".
  5097    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  5098    05  F                       PIC X(07) VALUE "~RCD10=".
  5099    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  5100    05  F                       PIC X(07) VALUE "~RCD11=".
  5101    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  5102    05  F                       PIC X(07) VALUE "~RCD12=".
  5103    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  5104    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  5105    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  5106    05  F                       PIC X(08) VALUE "~ARCHNO=".
  5107    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  5108    05  F                       PIC X(06) VALUE "~FORM=".
  5109    05  OUT-FORM                PIC X(03) VALUE SPACES.
  5110    05  F                       PIC X(09) VALUE "~ENCLINE=".
  5111    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  5112    05  F                       PIC X(08) VALUE "~ATTACH=".
  5113    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  5114    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  5115    05  OUT-STACK               PIC X(10) VALUE SPACES.
  5116    05  F                       PIC X(11) VALUE "~STATENAME=".
  5117    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  90
* NSRASBL.cbl
  5118    05  F                       PIC X(08) VALUE "~PRTNOW=".
  5119    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  5120    05  F                       PIC X(05) VALUE "~NCB=".
  5121    05  OUT-CHGBACK             PIC X     VALUE ' '.
  5122    05  F                       PIC X(8) VALUE "~CSOAMT=".
  5123    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  5124    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  5125    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  5126    05  F                       PIC X(09) VALUE "~LETRTYP=".
  5127    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  5128    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  5129    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  5130    05  F                       PIC X(08) VALUE "~INSBDT=".
  5131    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  5132    05  F                       PIC X(08) VALUE "~JNTBDT=".
  5133    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  5134    05  F                       PIC X(08) VALUE "~TOTINT=".
  5135    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  5136    05  F                       PIC X(8) VALUE "~TOPREM=".
  5137    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  5138    05  F                       PIC X(7) VALUE "~TOREF=".
  5139    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  5140    05  F                       PIC X(7) VALUE "~CANDT=".
  5141    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  5142    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  5143    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  5144    05  F                       PIC X(08) VALUE "~CERTID=".
  5145    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  5146    05  F                       PIC X(08) VALUE "~UNDWID=".
  5147    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  5148    05  F                       PIC X(8) VALUE "~TNPREM=".
  5149    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  5150    05  F                       PIC X(7) VALUE "~TNREF=".
  5151    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  5152    05  F                       PIC X(8)  VALUE "~COVIND=".
  5153    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  5154    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  5155    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  5156    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  5157    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  5158    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  5159    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  5160    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  5161    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  5162    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  5163    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  5164    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  5165                                PIC X(10).
  5166    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  5167    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5168    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  5169    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5170    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  5171    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5172    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  5173    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5174    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  5175    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  91
* NSRASBL.cbl
  5176    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  5177    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5178    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  5179    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  5180    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  5181    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5182    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  5183    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5184    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  5185    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  5186    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  5187    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  5188    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  5189    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5190    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  5191    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5192    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  5193    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  5194    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  5195    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  5196    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  5197    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5198    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  5199    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5200    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  5201    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  5202    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  5203    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  5204    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  5205    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5206    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  5207    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5208    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  5209    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5210    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  5211    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5212    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  5213    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  5214    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  5215    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5216    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  5217    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5218    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  5219    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5220    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  5221    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5222    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  5223    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  5224    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  5225    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5226    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  5227    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5228    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  5229    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5230    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  5231    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  5232    05  F                       PIC X(09) VALUE "~CSONAMT=".
  5233    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  92
* NSRASBL.cbl
  5234    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  5235    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5236    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  5237    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5238    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  5239    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5240    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  5241    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5242    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  5243    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  5244    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  5245    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5246    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5247    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5248    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5249    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5250    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5251    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5252    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5253    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5254    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5255    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5256    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5257    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5258    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5259    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5260    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5261    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5262    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5263    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5264    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5265    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5266    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5267    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5268    05  F                       PIC X(9)  VALUE "~NXTBSDT=".
  5269    05  OUT-NEXT-BUS-DT         PIC X(21) VALUE SPACES.
  5270    05  F                       PIC X(7)  VALUE "~VINNO=".
  5271    05  OUT-VIN-NUMBER          PIC X(17) VALUE SPACES.
  5272    05  F                       PIC X(11) VALUE 'EndOfString'.
  5273    05  f                       pic x(2) value spaces.
  5274*                                COPY ERCARCH.
  5275******************************************************************
  5276*                                                                *
  5277*                            ERCARCH.                            *
  5278*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5279*                            VMOD=2.002                          *
  5280*                                                                *
  5281*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5282*                                                                *
  5283*   FILE TYPE = VSAM,KSDS                                        *
  5284*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5285*                                                                *
  5286*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5287*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5288*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5289*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5290*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5291*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  93
* NSRASBL.cbl
  5292*                                                                *
  5293*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5294******************************************************************
  5295*                   C H A N G E   L O G
  5296*
  5297* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5298*-----------------------------------------------------------------
  5299*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5300* EFFECTIVE    NUMBER
  5301*-----------------------------------------------------------------
  5302* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5303* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5304* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5305* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  5306******************************************************************
  5307 01  LETTER-ARCHIVE.
  5308     12  LA-RECORD-ID                PIC  X(02).
  5309         88  LA-VALID-ID                VALUE 'LA'.
  5310
  5311     12  LA-CONTROL-PRIMARY.
  5312         16  LA-COMPANY-CD           PIC  X(01).
  5313         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5314
  5315     12  LA-CONTROL-BY-CERT-RESP.
  5316         16  LA-COMPANY-CD-A2        PIC  X(01).
  5317         16  LA-CERT-NO-A2.
  5318             20  LA-CERT-PRIME-A2    PIC  X(10).
  5319             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5320         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5321             20  LA-RESP-PERSON-A2   PIC  X(10).
  5322             20  LA-TYPE-A2          PIC  X(01).
  5323         16  LA-CARRIER-A2           PIC  X(01).
  5324         16  LA-GROUPING-A2          PIC  X(06).
  5325         16  LA-STATE-A2             PIC  X(02).
  5326         16  LA-ACCOUNT-A2           PIC  X(10).
  5327         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5328         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5329
  5330     12  LA-CONTROL-BY-FORM.
  5331         16  LA-COMPANY-CD-A3        PIC  X(01).
  5332         16  LA-FORM-A3              PIC  X(04).
  5333         16  LA-CARRIER-A3           PIC  X(01).
  5334         16  LA-GROUPING-A3          PIC  X(06).
  5335         16  LA-STATE-A3             PIC  X(02).
  5336         16  LA-ACCOUNT-A3           PIC  X(10).
  5337         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5338
  5339     12  LA-CONTROL-BY-PROCESSOR.
  5340         16  LA-COMPANY-CD-A4        PIC  X(01).
  5341         16  LA-PROCESSOR-CD         PIC  X(04).
  5342         16  LA-CARRIER-A4           PIC  X(01).
  5343         16  LA-GROUPING-A4          PIC  X(06).
  5344         16  LA-STATE-A4             PIC  X(02).
  5345         16  LA-ACCOUNT-A4           PIC  X(10).
  5346         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5347
  5348     12  LA-CONTROL-BY-KEY-FIELDS.
  5349         16  LA-COMPANY-CD-A5        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  94
* NSRASBL.cbl
  5350         16  LA-CARRIER-A5           PIC  X(01).
  5351         16  LA-GROUPING-A5          PIC  X(06).
  5352         16  LA-STATE-A5             PIC  X(02).
  5353         16  LA-ACCOUNT-A5           PIC  X(10).
  5354         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5355
  5356     12  LA-CONTROL-BY-GROUP-CODE.
  5357         16  LA-COMPANY-CD-A6        PIC  X(01).
  5358         16  LA-ENTRY-A6.
  5359             20  LA-FILLER           PIC  X(02).
  5360             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5361         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5362
  5363     12  FILLER                      PIC  X(09).
  5364
  5365     12  LA-HEADER-RECORD.
  5366         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5367         16  LA-CREATION-DATE        PIC  X(02).
  5368         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5369         16  LA-FINAL-ACT-DATE       REDEFINES
  5370               LA-FOLLOW-UP-DATE     PIC  X(02).
  5371         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5372         16  LA-NO-OF-COPIES         PIC S9(01).
  5373         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5374         16  LA-REPLY-DATE           PIC  X(02).
  5375         16  LA-RESEND-DATES.
  5376             20  LA-RESEND-DATE      PIC  X(02).
  5377             20  LA-SENT-DATE        PIC  X(02).
  5378             20  FILLER              PIC  X(08).
  5379         16  LA-SOURCE-INFORMATION.
  5380             20  LA-DATA-SOURCE      PIC  X(01).
  5381             20  LA-ADDR-SOURCE      PIC  X(01).
  5382         16  LA-STATUS               PIC  X(01).
  5383             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5384             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5385             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5386             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5387             88  LA-STATUS-PURGED         VALUE 'P'.
  5388             88  LA-STATUS-VOIDED         VALUE 'V'.
  5389         16  LA-LAST-RESENT-PRINT-DATE
  5390                                     PIC  X(02).
  5391         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5392             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5393                                          VALUE 'C'.
  5394             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5395                                          VALUE 'F'.
  5396             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5397                                          VALUE 'P'.
  5398         16  LA-PURGED-DATE          PIC  X(02).
  5399         16  LA-VOIDED-DATE          PIC  X(02).
  5400         16  LA-RESEND-LETR          PIC  X(4).
  5401         16  LA-VOID-ONBASE-YN       PIC  X.
  5402         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  5403         16  FILLER                  PIC  X(04).
  5404*        16  LA-RESEND-LETR-2        PIC  X(4).
  5405*        16  LA-RESEND-LETR-3        PIC  X(4).
  5406*        16  FILLER                  PIC  X(59).
  5407         16  LA-ARCHIVE-STATUS       PIC  X.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  95
* NSRASBL.cbl
  5408             88  LA-TEMP                VALUE 'T'.
  5409             88  LA-QWS                 VALUE 'Q'.
  5410             88  LA-BATCH               VALUE 'B'.
  5411         16  LA-FINAL-ACT-IND        PIC  X(1).
  5412         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5413         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5414         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5415                                     PIC X(4).
  5416         16  FILLER                  PIC  X(42).
  5417*        16  FILLER                  PIC  X(71).
  5418         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5419         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5420         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5421                                     PIC  X(4).
  5422         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5423
  5424******************************************************************
  5425*                                COPY ELCCRTT.
  5426******************************************************************
  5427*                                                                *
  5428*                            ELCCRTT.                            *
  5429*                                                                *
  5430*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5431*                                                                *
  5432*   FILE TYPE = VSAM,KSDS                                        *
  5433*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5434*                                                                *
  5435*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5436*                                                                *
  5437*   LOG = YES                                                    *
  5438*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5439******************************************************************
  5440*                   C H A N G E   L O G
  5441*
  5442* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5443*-----------------------------------------------------------------
  5444*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5445* EFFECTIVE    NUMBER
  5446*-----------------------------------------------------------------
  5447* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5448* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5449* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5450* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5451* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5452* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5453* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5454* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5455* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5456* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  5457* 091318  CR2018073000001  PEMA  ADD Refund methods
  5458* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5459******************************************************************
  5460
  5461 01  CERTIFICATE-TRAILERS.
  5462     12  CS-RECORD-ID                      PIC XX.
  5463         88  VALID-CS-ID                      VALUE 'CS'.
  5464
  5465     12  CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  96
* NSRASBL.cbl
  5466         16  CS-COMPANY-CD                 PIC X.
  5467         16  CS-CARRIER                    PIC X.
  5468         16  CS-GROUPING                   PIC X(6).
  5469         16  CS-STATE                      PIC XX.
  5470         16  CS-ACCOUNT                    PIC X(10).
  5471         16  CS-CERT-EFF-DT                PIC XX.
  5472         16  CS-CERT-NO.
  5473             20  CS-CERT-PRIME             PIC X(10).
  5474             20  CS-CERT-SFX               PIC X.
  5475         16  CS-TRAILER-TYPE               PIC X.
  5476             88  COMM-TRLR           VALUE 'A'.
  5477             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5478             88  CERT-DATA-TRLR      VALUE 'C'.
  5479
  5480     12  CS-DATA-AREA                      PIC X(516).
  5481
  5482     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5483         16  CS-BANK-COMMISSION-AREA.
  5484             20  CS-BANK-COMMS       OCCURS 10.
  5485                 24  CS-AGT                PIC X(10).
  5486                 24  CS-COM-TYP            PIC X.
  5487                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5488                 24  CS-RECALC-LV-INDIC    PIC X.
  5489                 24  FILLER                PIC X(10).
  5490         16  FILLER                        PIC X(256).
  5491
  5492     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5493****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5494         16  CS-MB-CLAIM-DATA OCCURS 24.
  5495             20  CS-CLAIM-NO               PIC X(7).
  5496             20  CS-CLAIM-TYPE             PIC X.
  5497                 88  CS-AH-CLM               VALUE 'A'.
  5498                 88  CS-IU-CLM               VALUE 'I'.
  5499                 88  CS-GP-CLM               VALUE 'G'.
  5500                 88  CS-LF-CLM               VALUE 'L'.
  5501                 88  CS-PR-CLM               VALUE 'P'.
  5502                 88  CS-FL-CLM               VALUE 'F'.
  5503                 88  CS-OT-CLM               VALUE 'O'.
  5504             20  CS-INSURED-TYPE           PIC X.
  5505                 88  CS-PRIM-INSURED          VALUE 'P'.
  5506                 88  CS-CO-BORROWER           VALUE 'C'.
  5507             20  CS-BENEFIT-PERIOD         PIC 99.
  5508             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5509             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5510             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5511         16  FILLER                        PIC X(12).
  5512     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5513         16  CS-VIN-NUMBER                 PIC X(17).
  5514         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5515         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5516         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5517         16  cs-agent-name.
  5518             20  cs-agent-fname            pic x(20).
  5519             20  cs-agent-mi               pic x.
  5520             20  cs-agent-lname            pic x(25).
  5521         16  cs-license-no                 pic x(15).
  5522         16  cs-npn-number                 pic x(10).
  5523         16  cs-agent-edit-status          pic x.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  97
* NSRASBL.cbl
  5524             88  cs-ae-refer-to-manager      value 'M'.
  5525             88  cs-ae-cover-sheet           value 'C'.
  5526             88  cs-ae-sig-form              value 'S'.
  5527             88  cs-ae-verified              value 'V'.
  5528             88  cs-unidentified-signature   value 'U'.
  5529             88  cs-cert-returned            value 'R'.
  5530             88  cs-accept-no-commission     value 'N'.
  5531         16  cs-year                       pic 9999.
  5532         16  cs-make                       pic x(20).
  5533         16  cs-model                      pic x(20).
  5534         16  cs-future                     pic x(20).
  5535         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5536         16  cs-claim-verification-status  pic x.
  5537             88  cs-clm-ver-eligible         value 'A'.
  5538             88  cs-clm-ver-partial-elig     value 'B'.
  5539             88  cs-clm-ver-not-eligible     value 'C'.
  5540             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  5541             88  cs-clm-ver-not-part-elig-rw value 'E'.
  5542             88  cs-clm-ver-ND-CERT          value 'F'.
  5543             88  cs-clm-ver-spec-other       value 'G'.
  5544             88  cs-clam-ver-pratial-corrected
  5545                                             value 'H'.
  5546             88  cs-clm-ver-no-matches       value 'I'.
  5547             88  cs-clm-ver-not-elig-corrected
  5548                                             value 'J'.
  5549             88  cs-clm-ver-needs-review     value 'R'.
  5550             88  cs-clm-ver-sent-to-claims   value 'W'.
  5551         16  CS-LF-REFUND-METHOD           PIC X.
  5552         16  CS-AH-REFUND-METHOD           PIC X.
  5553         16  FILLER                        PIC X(353). *> was 420
  5554*        16  FILLER                        PIC X(496).
  5555 01  FILLER                      PIC X(500)  VALUE SPACES.
  5556*                                COPY ELCENCC.
  5557******************************************************************
  5558*                                                                *
  5559*                                                                *
  5560*                            ELCENCC                             *
  5561*                            VMOD=2.001                          *
  5562*                                                                *
  5563*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5564*                                                                *
  5565*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5566*   A NAPERSOFT DOCUMENT                                         *
  5567*                                                                *
  5568*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5569*                                                                *
  5570*   FILE TYPE = VSAM,KSDS                                        *
  5571*   RECORD SIZE = 400   RECFORM = FIX                            *
  5572*                                                                *
  5573*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5574*                                                                *
  5575*   LOG = NO                                                     *
  5576*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5577*                                                                *
  5578*                                                                *
  5579******************************************************************
  5580*                   C H A N G E   L O G
  5581*
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  98
* NSRASBL.cbl
  5582* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5583*-----------------------------------------------------------------
  5584*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5585* EFFECTIVE    NUMBER
  5586*-----------------------------------------------------------------
  5587* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5588* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  5589******************************************************************
  5590 01  ENCLOSURE-CODES.
  5591     12  NC-RECORD-ID                      PIC XX.
  5592         88  VALID-NC-ID                      VALUE 'NC'.
  5593     12  NC-CONTROL-PRIMARY.
  5594         16  NC-COMPANY-CD                 PIC X.
  5595         16  NC-REC-TYPE                   PIC X.
  5596             88  NC-CLAIMS                   VALUE '1'.
  5597             88  NC-ADMIN                    VALUE '2'.
  5598         16  NC-ENC-CODE                   PIC X(5).
  5599         16  FILLER                        PIC X(09).
  5600     12  NC-MAINT-INFORMATION.
  5601         16  NC-LAST-MAINT-DT              PIC XX.
  5602         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5603         16  NC-LAST-MAINT-USER            PIC X(4).
  5604         16  FILLER                        PIC XX.
  5605     12  NC-OUTPUT-STACK                   PIC XXX.
  5606     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5607     12  NC-ATTACHMENTS                    PIC X(255).
  5608     12  NC-FUTURE                         PIC X(12).
  5609******************************************************************
  5610****************************************************************
  5611*
  5612* Copyright (c) 2007-2013 Dell Inc.
  5613* All rights reserved.
  5614*
  5615****************************************************************
  5616 01  DFHEIV.
  5617   02  DFHEIV0               PIC X(35).
  5618   02  DFHEIV1               PIC X(08).
  5619   02  DFHEIV2               PIC X(08).
  5620   02  DFHEIV3               PIC X(08).
  5621   02  DFHEIV4               PIC X(06).
  5622   02  DFHEIV5               PIC X(04).
  5623   02  DFHEIV6               PIC X(04).
  5624   02  DFHEIV7               PIC X(02).
  5625   02  DFHEIV8               PIC X(02).
  5626   02  DFHEIV9               PIC X(01).
  5627   02  DFHEIV10              PIC S9(7) COMP-3.
  5628   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5629   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5630   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5631   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5632   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5633   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5634   02  DFHEIV17              PIC X(04).
  5635   02  DFHEIV18              PIC X(04).
  5636   02  DFHEIV19              PIC X(04).
  5637   02  DFHEIV20              USAGE IS POINTER.
  5638   02  DFHEIV21              USAGE IS POINTER.
  5639   02  DFHEIV22              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page  99
* NSRASBL.cbl
  5640   02  DFHEIV23              USAGE IS POINTER.
  5641   02  DFHEIV24              USAGE IS POINTER.
  5642   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5643   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5644   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5645   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5646   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5647   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5648   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5649   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5650   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5651   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5652   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5653   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5654   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5655   02  FILLER                PIC X(02).
  5656   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5657   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5658   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5659   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5660   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5661   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5662   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5663 LINKAGE  SECTION.
  5664*****************************************************************
  5665*                                                               *
  5666* Copyright (c) 2007-2013 Dell Inc.                             *
  5667* All rights reserved.                                          *
  5668*                                                               *
  5669*****************************************************************
  5670 01  dfheiblk.
  5671     02  eibtime          pic s9(7) comp-3.
  5672     02  eibdate          pic s9(7) comp-3.
  5673     02  eibtrnid         pic x(4).
  5674     02  eibtaskn         pic s9(7) comp-3.
  5675     02  eibtrmid         pic x(4).
  5676     02  dfheigdi         pic s9(4) comp.
  5677     02  eibcposn         pic s9(4) comp.
  5678     02  eibcalen         pic s9(4) comp.
  5679     02  eibaid           pic x(1).
  5680     02  eibfiller1       pic x(1).
  5681     02  eibfn            pic x(2).
  5682     02  eibfiller2       pic x(2).
  5683     02  eibrcode         pic x(6).
  5684     02  eibfiller3       pic x(2).
  5685     02  eibds            pic x(8).
  5686     02  eibreqid         pic x(8).
  5687     02  eibrsrce         pic x(8).
  5688     02  eibsync          pic x(1).
  5689     02  eibfree          pic x(1).
  5690     02  eibrecv          pic x(1).
  5691     02  eibsend          pic x(1).
  5692     02  eibatt           pic x(1).
  5693     02  eibeoc           pic x(1).
  5694     02  eibfmh           pic x(1).
  5695     02  eibcompl         pic x(1).
  5696     02  eibsig           pic x(1).
  5697     02  eibconf          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 100
* NSRASBL.cbl
  5698     02  eiberr           pic x(1).
  5699     02  eibrldbk         pic x(1).
  5700     02  eiberrcd         pic x(4).
  5701     02  eibsynrb         pic x(1).
  5702     02  eibnodat         pic x(1).
  5703     02  eibfiller5       pic x(2).
  5704     02  eibresp          pic s9(8) comp.
  5705     02  eibresp2         pic s9(8) comp.
  5706     02  dfheigdj         pic s9(4) comp.
  5707     02  dfheigdk         pic s9(4) comp.
  5708 01 dfhcommarea                  PIC X(6500).
  5709
  5710 01  var  pic x(30).
  5711 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  5712 0000-DFHEXIT SECTION.
  5713     MOVE '9#                    $   ' TO DFHEIV0.
  5714     MOVE 'NSRASBL' TO DFHEIV1.
  5715     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5716     display ' entering pgm nsrasbl '
  5717     display ' commarea ' dfhcommarea
  5718     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5719     MOVE '5'                    TO DC-OPTION-CODE
  5720     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5721     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5722     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5723     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5724     MOVE DC-DAY-OF-WEEK         TO SAVE-CYCLE-DAY-OF-WEEK
  5725     move dfhcommarea            to srch-commarea
  5726*****************************************************
  5727* The full       key has been established and passed
  5728* to this program via NSRASLTR
  5729*****************************************************
  5730     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5731     display ' input data ' bl-carrier ' ' bl-group ' '
  5732        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5733     MOVE BL-LETTER-ID           TO OUT-LETTER
  5734     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5735     MOVE BL-CARRIER             TO OUT-CARRIER
  5736     MOVE BL-GROUP               TO OUT-GROUPING
  5737     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5738     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5739     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5740     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5741     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5742        DC-EDITA-DAY  DELIMITED BY SIZE
  5743        INTO OUT-CYCLE-DT
  5744     END-STRING
  5745
  5746     set P to address of KIXSYS
  5747     CALL "getenv" using by value P returning var-ptr
  5748     if var-ptr = null then
  5749        display ' kixsys not set '
  5750     else
  5751        set address of var to var-ptr
  5752        move 0 to env-var-len
  5753        inspect var tallying env-var-len
  5754          for characters before X'00'
  5755        unstring var (1:env-var-len) delimited by '/'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 101
* NSRASBL.cbl
  5756        into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5757              WS-KIX-SYS
  5758        end-unstring
  5759     end-if
  5760
  5761     set P to address of KIXHOST
  5762     CALL "getenv" using by value P returning var-ptr
  5763     if var-ptr = null then
  5764        display ' kixhost not set '
  5765     else
  5766        set address of var to var-ptr
  5767        move 0 to env-var-len
  5768        inspect var tallying env-var-len
  5769          for characters before X'00'
  5770        MOVE var(1:env-var-len)  to ws-kixhost
  5771        DISPLAY ' WS KIX HOST ' WS-KIXHOST
  5772     end-if
  5773
  5774     MOVE SPACES TO SVR
  5775
  5776**** This routine will connect to the Logic Database on SQL Server
  5777**** and call a stored procedure to determine the next business da
  5778
  5779     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
  5780     IF SQLCODE = 0
  5781        PERFORM 4200-GET-NEXT-BUS-DT  THRU 4200-EXIT
  5782        IF SQLCODE = 0
  5783            MOVE WS-NEXT-BUS-DT TO SAVE-NEXT-BUS-DT-EDIT-A
  5784                                   WS-EDIT-A-DATE
  5785            MOVE WS-EDIT-A-YY   TO DC-YMD-YEAR
  5786            MOVE WS-EDIT-A-MM   TO DC-YMD-MONTH
  5787            MOVE WS-EDIT-A-DD   TO DC-YMD-DAY
  5788            MOVE '3'            TO DC-OPTION-CODE
  5789            PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5790            IF NO-CONVERSION-ERROR
  5791               MOVE DC-BIN-DATE-1 TO SAVE-BIN-NEXT-BUS-DT
  5792            ELSE
  5793               MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5794               MOVE '6'         TO DC-OPTION-CODE
  5795               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5796               IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5797                  MOVE 3        TO DC-ELAPSED-DAYS
  5798               ELSE
  5799                 IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5800                    MOVE 2     TO DC-ELAPSED-DAYS
  5801                 ELSE
  5802                    MOVE 1     TO DC-ELAPSED-DAYS
  5803                 END-IF
  5804               END-IF
  5805               PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5806               IF NO-CONVERSION-ERROR
  5807                   MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5808                   MOVE DC-GREG-DATE-A-EDIT TO
  5809                                SAVE-NEXT-BUS-DT-EDIT-A
  5810               ELSE
  5811                   MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5812                   MOVE WS-SAVE-EDIT-A-DATE TO
  5813                                SAVE-NEXT-BUS-DT-EDIT-A
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 102
* NSRASBL.cbl
  5814               END-IF
  5815            END-IF
  5816        ELSE
  5817            MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5818            MOVE '6'         TO DC-OPTION-CODE
  5819            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5820            IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5821               MOVE 3        TO DC-ELAPSED-DAYS
  5822            ELSE
  5823              IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5824                 MOVE 2     TO DC-ELAPSED-DAYS
  5825              ELSE
  5826                 MOVE 1     TO DC-ELAPSED-DAYS
  5827              END-IF
  5828            END-IF
  5829            PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5830            IF NO-CONVERSION-ERROR
  5831                MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5832                MOVE DC-GREG-DATE-A-EDIT TO
  5833                                SAVE-NEXT-BUS-DT-EDIT-A
  5834            ELSE
  5835                MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5836                MOVE WS-SAVE-EDIT-A-DATE TO
  5837                                SAVE-NEXT-BUS-DT-EDIT-A
  5838            END-IF
  5839        END-IF
  5840     ELSE
  5841        MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5842        MOVE '6'         TO DC-OPTION-CODE
  5843        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5844        IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5845           MOVE 3        TO DC-ELAPSED-DAYS
  5846        ELSE
  5847          IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5848             MOVE 2     TO DC-ELAPSED-DAYS
  5849          ELSE
  5850             MOVE 1     TO DC-ELAPSED-DAYS
  5851          END-IF
  5852        END-IF
  5853        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5854        IF NO-CONVERSION-ERROR
  5855            MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5856            MOVE DC-GREG-DATE-A-EDIT TO
  5857                                SAVE-NEXT-BUS-DT-EDIT-A
  5858        ELSE
  5859            MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5860            MOVE WS-SAVE-EDIT-A-DATE TO
  5861                                SAVE-NEXT-BUS-DT-EDIT-A
  5862        END-IF
  5863     END-IF
  5864     PERFORM 4300-DISCONNECT THRU 4300-EXIT
  5865
  5866     MOVE SAVE-NEXT-BUS-DT-EDIT-A  TO WS-EDIT-A-DATE
  5867     STRING WS-EDIT-A-CCYY '-' WS-EDIT-A-MM '-'
  5868           WS-EDIT-A-DD ' 00:00:00.0' DELIMITED BY SIZE
  5869              INTO OUT-NEXT-BUS-DT
  5870     END-STRING
  5871     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 103
* NSRASBL.cbl
  5872        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5873     ELSE
  5874        IF BL-EFF-DT = SPACES
  5875           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5876        ELSE
  5877           IF BL-EFF-DT (9:2) = SPACES
  5878              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5879                     BL-EFF-DT (4:2)
  5880                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5881              END-STRING
  5882           ELSE
  5883              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5884                     BL-EFF-DT (4:2)
  5885                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5886              END-STRING
  5887           END-IF
  5888           MOVE '3'              TO DC-OPTION-CODE
  5889           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5890           IF NO-CONVERSION-ERROR
  5891              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5892           ELSE
  5893              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5894              SET BL-FAIL TO TRUE
  5895              GO TO 0000-RETURN
  5896           END-IF
  5897        END-IF
  5898     END-IF
  5899     perform 0800-init-out-data  thru 0800-exit
  5900     SET BL-FAIL TO TRUE
  5901******************************************************************
  5902* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5903*    1) FROM ACCT MAINT
  5904*    2) FROM CERT UPDATE
  5905*    3) FROM COMP MAINT
  5906*    4) FROM REVIEW AND CORRECTIONS
  5907******************************************************************
  5908     EVALUATE BL-DATA-SRCE
  5909        WHEN '1'
  5910           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5911        WHEN '2'
  5912           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5913        WHEN '3'
  5914           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5915        WHEN '4'
  5916           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5917        WHEN OTHER
  5918           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5919     END-EVALUATE
  5920     IF BL-OK
  5921        display ' bl write erarch ' bl-write-erarch
  5922        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5923        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5924        IF BL-ARCHIVE-NO = ZEROS
  5925           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5926           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5927           display ' arch zeros, new arch ' bl-archive-no
  5928        END-IF
  5929        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 104
* NSRASBL.cbl
  5930        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5931        display ' bl write erarch ' bl-write-erarch
  5932        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5933           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5934           IF BL-FAIL
  5935              GO TO 0000-RETURN
  5936           END-IF
  5937        END-IF
  5938        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5939        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5940     END-IF
  5941     .
  5942 0000-RETURN.
  5943     move srch-commarea          to dfhcommarea
  5944
  5945* exec cics
  5946*       return
  5947*    end-exec
  5948*    MOVE '.(                    ''   #00005847' TO DFHEIV0
  5949     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5950     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5951     MOVE X'2020233030303035383437' TO DFHEIV0(25:11)
  5952     CALL 'kxdfhei1' USING DFHEIV0,
  5953           DFHEIV99,
  5954           DFHEIV99,
  5955           DFHEIV99,
  5956           DFHEIV99,
  5957           DFHEIV99,
  5958           DFHEIV99
  5959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5960     .
  5961 0100-DATA-SRCE-1.
  5962     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5963     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5964     MOVE ' '                    TO WS-ERACCT-SW
  5965     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5966     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5967     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5968     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5969     MOVE BL-STATE               TO WS-ERACCT-STATE
  5970     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5971     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5972                                    WS-CERT-EFF-DT
  5973     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5974     IF ACCT-FOUND
  5975        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5976        PERFORM 1025-GET-CSR-INFO
  5977                                 THRU 1025-EXIT
  5978        PERFORM 1300-DETERMINE-COMM
  5979                                 THRU 1300-EXIT
  5980        SET BL-OK TO TRUE
  5981     ELSE
  5982        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5983        SET BL-FAIL TO TRUE
  5984     END-IF
  5985     .
  5986 0100-EXIT.
  5987     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 105
* NSRASBL.cbl
  5988 0200-DATA-SRCE-2.
  5989     display ' made it to data srce 2 '
  5990     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5991     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5992     MOVE ' '                    TO WS-ELCERT-SW
  5993     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5994     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5995     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5996     MOVE BL-STATE               TO WS-ELCERT-STATE
  5997     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5998     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5999                                    WS-CERT-EFF-DT
  6000     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  6001
  6002     MOVE ' '                 TO WS-ERACCT-SW
  6003     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  6004     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  6005     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  6006     IF ACCT-FOUND
  6007        MOVE AM-CSR-CODE      TO WS-CSR-ID
  6008        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  6009     END-IF
  6010     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  6011     IF CERT-FOUND
  6012        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  6013        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  6014        MOVE WS-LF-DESC          TO OUT-LF-DESC
  6015        IF WS-LF-EARN = 'B'
  6016           MOVE 'B'              TO OUT-BALLOON-IND
  6017        END-IF
  6018        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  6019        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  6020        MOVE WS-AH-DESC          TO OUT-AH-DESC
  6021        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  6022
  6023        IF BL-ENDT-ARCH-NO > ZERO
  6024           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  6025           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  6026           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6027        ELSE
  6028           IF BL-ARCHIVE-NO > ZERO
  6029              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  6030              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  6031              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6032           END-IF
  6033        END-IF
  6034
  6035        PERFORM 4500-CHECK-BALLOON-STATE THRU 4500-EXIT
  6036*072312 IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  6037        IF WS-LOOKUP-VALUE > SPACES
  6038          AND (OUT-BALLOON-IND = 'B')
  6039           MOVE 'B'              TO OUT-FORM (3:1)
  6040        END-IF
  6041        SET BL-OK TO TRUE
  6042     ELSE
  6043        display ' cert not found ' ws-elcert-cert-no
  6044        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  6045        SET BL-FAIL TO TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 106
* NSRASBL.cbl
  6046     END-IF
  6047     .
  6048 0200-EXIT.
  6049     EXIT.
  6050 0300-DATA-SRCE-3.
  6051     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  6052     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  6053     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  6054     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  6055     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  6056     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  6057     IF WS-ERCOMP-ACCOUNT = SPACES
  6058        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  6059        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  6060     ELSE
  6061        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  6062     END-IF
  6063     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  6064     IF RESP-NORMAL
  6065        MOVE CO-CSR-CODE         TO WS-CSR-ID
  6066        PERFORM 1025-GET-CSR-INFO
  6067                                 THRU 1025-EXIT
  6068        SET BL-OK TO TRUE
  6069     ELSE
  6070        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  6071        SET BL-FAIL TO TRUE
  6072     END-IF
  6073     .
  6074 0300-EXIT.
  6075     EXIT.
  6076 0400-DATA-SRCE-4.
  6077     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  6078     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  6079     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  6080     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  6081     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  6082                                    WS-ELCERT-SW WS-ERENDT-SW
  6083
  6084* EXEC CICS READ
  6085*         DATASET    ('ERPNDB')
  6086*         INTO       (PENDING-BUSINESS)
  6087*         RIDFLD     (WS-ERPNDB-KEY)
  6088*         RESP       (WS-RESPONSE)
  6089*    END-EXEC
  6090     MOVE LENGTH OF
  6091      PENDING-BUSINESS
  6092       TO DFHEIV11
  6093     MOVE 'ERPNDB' TO DFHEIV1
  6094*    MOVE '&"IL       E          (  N#00005973' TO DFHEIV0
  6095     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6097     MOVE X'204E233030303035393733' TO DFHEIV0(25:11)
  6098     CALL 'kxdfhei1' USING DFHEIV0,
  6099           DFHEIV1,
  6100           PENDING-BUSINESS,
  6101           DFHEIV11,
  6102           WS-ERPNDB-KEY,
  6103           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 107
* NSRASBL.cbl
  6104           DFHEIV99,
  6105           DFHEIV99
  6106     MOVE EIBRESP  TO WS-RESPONSE
  6107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6108     IF RESP-NORMAL
  6109        IF PB-RECORD-TYPE = '1' OR '2'
  6110           MOVE PB-CARRIER       TO BL-CARRIER
  6111           MOVE PB-GROUPING      TO BL-GROUP
  6112           MOVE PB-STATE         TO BL-STATE
  6113           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  6114           MOVE PB-CERT-NO       TO BL-CERT-NO
  6115           MOVE PB-CSR-ID        TO WS-CSR-ID
  6116           IF PB-ISSUE
  6117              SET PROCESS-ISSUE TO TRUE
  6118              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  6119              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  6120              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  6121              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  6122           ELSE
  6123              SET PROCESS-CANCEL TO TRUE
  6124              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  6125              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  6126              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  6127              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  6128           END-IF
  6129           PERFORM 1120-MATCH-CARRIER
  6130                                 THRU 1120-EXIT
  6131           PERFORM 1125-MATCH-STATE
  6132                                 THRU 1125-EXIT
  6133           PERFORM 1130-MATCH-BENCDS
  6134                                 THRU 1130-EXIT
  6135           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  6136           MOVE WS-LF-DESC       TO OUT-LF-DESC
  6137                                    OUT-ORIG-LF-DESC
  6138           IF WS-LF-EARN = 'B'
  6139              MOVE 'B'           TO OUT-BALLOON-IND
  6140           END-IF
  6141           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  6142                                    OUT-ORIG-WAIT-PER
  6143           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  6144                                    OUT-ORIG-RET-ELIM
  6145           MOVE WS-AH-DESC       TO OUT-AH-DESC
  6146                                    OUT-ORIG-AH-DESC
  6147           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  6148                                    OUT-ORIG-BEN-DAYS
  6149           PERFORM 1025-GET-CSR-INFO
  6150                                 THRU 1025-EXIT
  6151
  6152           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  6153           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  6154                                 TO WS-ERACCT-KEY (1:22)
  6155           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  6156           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  6157           IF ACCT-FOUND
  6158              MOVE AM-CSR-CODE      TO WS-CSR-ID
  6159              PERFORM 1025-GET-CSR-INFO
  6160                                    THRU 1025-EXIT
  6161              PERFORM 1300-DETERMINE-COMM
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 108
* NSRASBL.cbl
  6162                                    THRU 1300-EXIT
  6163           END-IF
  6164
  6165           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  6166                                 TO WS-ELCERT-KEY
  6167           PERFORM 1100-GET-ELCERT
  6168                                 THRU 1100-EXIT
  6169
  6170           IF BL-ENDT-ARCH-NO > ZERO
  6171              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  6172              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  6173              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6174           ELSE
  6175              IF BL-ARCHIVE-NO > ZERO
  6176                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  6177                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  6178                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6179              END-IF
  6180           END-IF
  6181
  6182           SET BL-OK TO TRUE
  6183           PERFORM 4500-CHECK-BALLOON-STATE THRU 4500-EXIT
  6184*072312     IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  6185           IF WS-LOOKUP-VALUE > SPACES
  6186             AND (OUT-BALLOON-IND = 'B')
  6187              MOVE 'B'           TO OUT-FORM (3:1)
  6188           END-IF
  6189        END-IF
  6190     END-IF
  6191     .
  6192 0400-EXIT.
  6193     EXIT.
  6194 0500-SCRUB-DATA.
  6195*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  6196*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  6197*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  6198*   TO A HEX 26 TO GET BY THE DECODER
  6199     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  6200                                 TO M1
  6201     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  6202     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6203        (A1 > M1)
  6204        OR (WS-WORK-FIELD (A1:1) = '*')
  6205        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6206        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6207     END-PERFORM
  6208     IF A1 > M1
  6209        CONTINUE
  6210     ELSE
  6211        MOVE WS-WORK-FIELD (1:A1 - 1)
  6212                                 TO OUT-ACCT-NAME
  6213     END-IF
  6214     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  6215                                 TO M1
  6216     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  6217     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6218        (A1 > M1)
  6219        OR (WS-WORK-FIELD (A1:1) = '*')
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 109
* NSRASBL.cbl
  6220        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6221        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6222     END-PERFORM
  6223     IF A1 > M1
  6224        CONTINUE
  6225     ELSE
  6226        MOVE WS-WORK-FIELD (1:A1 - 1)
  6227                                 TO OUT-BENE-NAME
  6228     END-IF
  6229     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  6230         MOVE '0000000000 '  TO OUT-CERT-NO
  6231     END-IF
  6232     MOVE +1 TO M1
  6233     MOVE SPACES TO BL-RECORD-PASSED-DATA
  6234     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  6235                                 TO NS-LEN
  6236     display ' naper output data length ' ns-len
  6237     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6238        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  6239        OR (A1 > NS-LEN)
  6240        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  6241           CONTINUE
  6242        ELSE
  6243           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  6244              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  6245              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  6246              ADD +1 TO M1
  6247           ELSE
  6248              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  6249                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  6250                 ADD +3 TO M1
  6251              ELSE
  6252                 MOVE NAPER-OUTPUT-DATA (A1:1)
  6253                                 TO BL-RECORD-PASSED-DATA (M1:1)
  6254                 ADD +1 TO M1
  6255              END-IF
  6256           END-IF
  6257        END-IF
  6258     END-PERFORM
  6259     .
  6260 0500-EXIT.
  6261     EXIT.
  6262 0600-GET-ERENDT.
  6263
  6264* EXEC CICS READ
  6265*         DATASET    ('ERENDT2')
  6266*         INTO       (ENDORSEMENT-RECORD)
  6267*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  6268*         RESP       (WS-RESPONSE)
  6269*    END-EXEC
  6270     MOVE LENGTH OF
  6271      ENDORSEMENT-RECORD
  6272       TO DFHEIV11
  6273     MOVE 'ERENDT2' TO DFHEIV1
  6274*    MOVE '&"IL       E          (  N#00006134' TO DFHEIV0
  6275     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6277     MOVE X'204E233030303036313334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 110
* NSRASBL.cbl
  6278     CALL 'kxdfhei1' USING DFHEIV0,
  6279           DFHEIV1,
  6280           ENDORSEMENT-RECORD,
  6281           DFHEIV11,
  6282           WS-ERENDT-KEY-BY-ARCH,
  6283           DFHEIV99,
  6284           DFHEIV99,
  6285           DFHEIV99
  6286     MOVE EIBRESP  TO WS-RESPONSE
  6287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6288     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  6289         WS-ERENDT-ARCHIVE
  6290     IF (RESP-NORMAL)
  6291        SET ENDT-FOUND TO TRUE
  6292        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  6293        PERFORM 0650-PROCESS-NO-Change
  6294                                 THRU 0650-EXIT
  6295     END-IF
  6296     .
  6297 0600-EXIT.
  6298     EXIT.
  6299 0620-BUILD-ENDT.
  6300     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  6301                                    OUT-NEW-LF-CAN-DT
  6302                                    OUT-ORIG-AH-CAN-DT
  6303                                    OUT-NEW-AH-CAN-DT
  6304                                    OUT-ORIG-CAN-DT
  6305                                    OUT-NEW-CAN-DT
  6306     IF EN-REC-TYPE = 'C'
  6307        GO TO 0620-PROCESS-CANCEL
  6308     END-IF
  6309     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  6310     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  6311     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6312     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  6313     IF WS-LF-EARN = 'B'
  6314        MOVE 'B'                 TO OUT-BALLOON-IND
  6315     END-IF
  6316     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  6317     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  6318     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  6319     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  6320     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  6321     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  6322     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  6323     IF EN-INS-ORIG-AGE-DEF-FLAG = 'Y'
  6324         MOVE ZERO                 TO OUT-ORIG-IAGE
  6325     ELSE
  6326         MOVE EN-INS-ORIG-AGE      TO OUT-ORIG-IAGE
  6327     END-IF
  6328     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  6329     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  6330     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  6331     IF EN-JNT-ORIG-AGE-DEF-FLAG = 'Y'
  6332         MOVE ZERO                 TO OUT-ORIG-JAGE
  6333     ELSE
  6334         MOVE EN-JNT-ORIG-AGE      TO OUT-ORIG-JAGE
  6335     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 111
* NSRASBL.cbl
  6336     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  6337     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  6338     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  6339     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  6340     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  6341     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  6342     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6343                             EN-LF-ORIG-ALT-PRM-AMT
  6344     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  6345     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  6346         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  6347                                    OUT-ORIG-LF-PRM-A
  6348                                    OUT-ORIG-LF-ALT-BEN-A
  6349                                    OUT-ORIG-LF-ALT-PRM-A
  6350                                    OUT-ORIG-COVERAGE-IND
  6351     ELSE
  6352         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  6353         IF EN-LF-ORIG-PRM-AMT = .01
  6354             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  6355         END-IF
  6356         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  6357             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  6358         END-IF
  6359         IF EN-LF-ORIG-ALT-PRM-AMT = .01
  6360             MOVE SPACES         TO OUT-ORIG-LF-ALT-PRM-A
  6361         END-IF
  6362         IF EN-LF-ORIG-ALT-BEN-AMT = 999999999.99
  6363             MOVE SPACES         TO OUT-ORIG-LF-ALT-BEN-A
  6364         END-IF
  6365     END-IF
  6366     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6367     MOVE ' '                    TO DC-OPTION-CODE
  6368     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6369     IF NO-CONVERSION-ERROR
  6370        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6371           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6372              INTO OUT-ORIG-LF-EXP-DT
  6373        END-STRING
  6374     END-IF
  6375     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  6376     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  6377     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  6378     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  6379     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6380         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  6381                                    OUT-ORIG-AH-PRM-A
  6382     ELSE
  6383        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  6384            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  6385        ELSE
  6386            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  6387        END-IF
  6388        IF EN-AH-ORIG-PRM-AMT = .01
  6389            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  6390        END-IF
  6391        IF EN-AH-ORIG-BEN-AMT = 9999999.99
  6392            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
  6393        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 112
* NSRASBL.cbl
  6394     END-IF
  6395     COMPUTE WS-WORK-PREM =
  6396        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  6397           + EN-AH-ORIG-PRM-AMT
  6398     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  6399     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6400     MOVE ' '                    TO DC-OPTION-CODE
  6401     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6402     IF NO-CONVERSION-ERROR
  6403        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6404           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6405              INTO OUT-ORIG-AH-EXP-DT
  6406        END-STRING
  6407     END-IF
  6408     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  6409                                    OUT-ORIG-MAX-PMTS
  6410     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6411         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  6412     END-IF
  6413     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  6414     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  6415     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  6416     IF EN-INS-NEW-AGE-DEF-FLAG = 'Y'
  6417         MOVE ZERO                TO OUT-NEW-IAGE
  6418     ELSE
  6419         MOVE EN-INS-NEW-AGE      TO OUT-NEW-IAGE
  6420     END-IF
  6421     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  6422     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  6423     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  6424     IF EN-JNT-NEW-AGE-DEF-FLAG = 'Y'
  6425         MOVE ZERO                TO OUT-NEW-JAGE
  6426     ELSE
  6427         MOVE EN-JNT-NEW-AGE      TO OUT-NEW-JAGE
  6428     END-IF
  6429     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  6430     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  6431     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6432     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  6433     IF WS-LF-EARN = 'B'
  6434        MOVE 'B'                 TO OUT-BALLOON-IND
  6435     END-IF
  6436     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  6437     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  6438     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  6439     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  6440     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  6441     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  6442     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  6443     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  6444     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  6445     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  6446     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  6447                             EN-LF-NEW-ALT-PRM-AMT
  6448     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  6449     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  6450         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  6451                                    OUT-NEW-LF-PRM-A
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 113
* NSRASBL.cbl
  6452                                    OUT-NEW-LF-ALT-BEN-A
  6453                                    OUT-NEW-LF-ALT-PRM-A
  6454                                    OUT-NEW-LF-CMB-PREM-A
  6455                                    OUT-NEW-COVERAGE-IND
  6456     ELSE
  6457         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  6458     END-IF
  6459    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  6460     MOVE ' '                     TO DC-OPTION-CODE
  6461     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6462     IF NO-CONVERSION-ERROR
  6463        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6464           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6465              INTO OUT-NEW-LF-EXP-DT
  6466        END-STRING
  6467     END-IF
  6468     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  6469     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  6470     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  6471     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  6472     COMPUTE WS-WORK-PREM =
  6473        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  6474           + EN-AH-NEW-PRM-AMT
  6475     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  6476     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6477         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  6478                                    OUT-NEW-AH-PRM-A
  6479     ELSE
  6480        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  6481            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  6482        ELSE
  6483            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  6484        END-IF
  6485     END-IF
  6486     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  6487     MOVE ' '                     TO DC-OPTION-CODE
  6488     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6489     IF NO-CONVERSION-ERROR
  6490        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6491           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6492              INTO OUT-NEW-AH-EXP-DT
  6493        END-STRING
  6494     END-IF
  6495     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  6496                                     OUT-NEW-MAX-PMTS
  6497     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6498         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  6499     END-IF
  6500     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  6501        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6502     ELSE
  6503        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6504     END-IF
  6505     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  6506        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6507     ELSE
  6508        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6509     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 114
* NSRASBL.cbl
  6510     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  6511        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6512     ELSE
  6513        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6514     END-IF
  6515     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  6516        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6517     ELSE
  6518        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6519     END-IF
  6520     COMPUTE WS-WORK-PREM =
  6521        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6522        EN-AH-NEW-PRM-AMT) -
  6523        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  6524        EN-AH-ORIG-PRM-AMT)
  6525     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  6526     IF EN-CSO-PORTION NOT NUMERIC
  6527        MOVE ZEROS               TO EN-CSO-PORTION
  6528     END-IF
  6529     IF EN-ACCT-PORTION NOT NUMERIC
  6530        MOVE ZERO                TO EN-ACCT-PORTION
  6531     END-IF
  6532*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6533*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6534     IF WS-WORK-PREM > +0
  6535        MOVE 'CSO'               TO OUT-PAYEE
  6536     ELSE
  6537      IF WS-WORK-PREM = +0
  6538         MOVE 'ZERO'             TO OUT-PAYEE
  6539      ELSE
  6540         MOVE 'ACCT'             TO OUT-PAYEE
  6541      END-IF
  6542     END-IF
  6543     COMPUTE WS-ACCT-ORIG-LF-PORT =
  6544        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6545     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  6546     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  6547        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6548     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6549     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6550        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6551        * EN-LF-ORIG-COMM-PCT
  6552     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6553     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6554        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6555     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6556     COMPUTE WS-ACCT-ORIG-PORTION =
  6557        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6558     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6559
  6560     COMPUTE WS-CSO-ORIG-LF-PORT =
  6561       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6562     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6563     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6564       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6565     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6566     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6567       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 115
* NSRASBL.cbl
  6568        WS-ACCT-ORIG-CMB-LF-PORT
  6569     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6570     COMPUTE WS-CSO-ORIG-AH-PORT =
  6571        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6572     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6573     COMPUTE WS-CSO-ORIG-PORTION =
  6574        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6575     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6576     COMPUTE WS-ACCT-NEW-LF-PORT =
  6577        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6578     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6579     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6580        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6581     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6582     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6583        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6584        * EN-LF-NEW-COMM-PCT
  6585     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6586     COMPUTE WS-ACCT-NEW-AH-PORT =
  6587        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6588     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6589     COMPUTE WS-ACCT-NEW-PORTION =
  6590        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6591     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6592
  6593     COMPUTE WS-CSO-NEW-LF-PORT =
  6594       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6595     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6596     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6597       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6598     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6599     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6600       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6601        WS-ACCT-NEW-CMB-LF-PORT
  6602     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6603     COMPUTE WS-CSO-NEW-AH-PORT =
  6604        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6605     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6606     COMPUTE WS-CSO-NEW-PORTION =
  6607        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6608     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6609
  6610     COMPUTE WS-ACCT-LF-PORT-CHG =
  6611        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6612     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6613     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6614        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6615     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6616     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6617        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6618     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6619     COMPUTE WS-ACCT-AH-PORT-CHG =
  6620        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6621     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6622     COMPUTE WS-ACCT-PORTION-CHG =
  6623        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6624     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6625
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 116
* NSRASBL.cbl
  6626     COMPUTE WS-CSO-LF-PORT-CHG =
  6627        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6628     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6629     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6630        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6631     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6632     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6633        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6634     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6635     COMPUTE WS-CSO-AH-PORT-CHG =
  6636        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6637     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6638     COMPUTE WS-CSO-PORTION-CHG =
  6639        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6640     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6641
  6642     COMPUTE WS-WORK-PREM =
  6643         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6644     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6645     COMPUTE WS-WORK-PREM =
  6646         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6647     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6648     COMPUTE WS-WORK-PREM =
  6649        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6650        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6651     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6652     COMPUTE WS-WORK-PREM =
  6653        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6654     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6655
  6656     move en-sig-sw              to out-sig-sw
  6657     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6658     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6659     GO TO 0620-CONTINUE
  6660     .
  6661 0620-PROCESS-CANCEL.
  6662     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6663        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6664        MOVE ' '                 TO DC-OPTION-CODE
  6665        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6666        IF NO-CONVERSION-ERROR
  6667           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6668              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6669                 INTO OUT-ORIG-LF-CAN-DT
  6670           END-STRING
  6671        END-IF
  6672        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6673     END-IF
  6674
  6675     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6676        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6677        MOVE ' '                 TO DC-OPTION-CODE
  6678        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6679        IF NO-CONVERSION-ERROR
  6680           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6681              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6682                 INTO OUT-NEW-LF-CAN-DT
  6683           END-STRING
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 117
* NSRASBL.cbl
  6684        END-IF
  6685        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6686     END-IF
  6687
  6688     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6689        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6690        MOVE ' '                    TO DC-OPTION-CODE
  6691        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6692        IF NO-CONVERSION-ERROR
  6693           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6694              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6695                 INTO OUT-ORIG-AH-CAN-DT
  6696           END-STRING
  6697        END-IF
  6698        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6699           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6700        END-IF
  6701     END-IF
  6702
  6703     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6704        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6705        MOVE ' '                    TO DC-OPTION-CODE
  6706        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6707        IF NO-CONVERSION-ERROR
  6708           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6709              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6710                 INTO OUT-NEW-AH-CAN-DT
  6711           END-STRING
  6712        END-IF
  6713        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6714           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6715        END-IF
  6716     END-IF
  6717     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6718     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6719     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6720     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6721     COMPUTE WS-WORK-PREM =
  6722        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6723     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6724     COMPUTE WS-WORK-PREM =
  6725        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6726     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6727     COMPUTE WS-WORK-PREM =
  6728        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6729        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6730     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6731
  6732     COMPUTE WS-WORK-PREM =
  6733        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6734     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6735     COMPUTE WS-WORK-PREM =
  6736        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6737     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6738
  6739*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6740*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6741     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 118
* NSRASBL.cbl
  6742
  6743     IF EN-COMM-CHGBK = 'N'
  6744         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6745                                   OUT-CSO-ORIG-ALT-LF-PORT
  6746         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6747         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6748         COMPUTE WS-CSO-ORIG-PORTION =
  6749             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6750         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6751         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6752                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6753                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6754                                   OUT-ACCT-ORIG-AH-PORT
  6755                                   OUT-ACCT-ORIG-PORTION
  6756
  6757         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6758                                   OUT-CSO-NEW-ALT-LF-PORT
  6759         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6760         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6761         COMPUTE WS-CSO-NEW-PORTION =
  6762             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6763         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6764         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6765                                   OUT-ACCT-NEW-ALT-LF-PORT
  6766                                   OUT-ACCT-NEW-CMB-LF-PORT
  6767                                   OUT-ACCT-NEW-AH-PORT
  6768                                   OUT-ACCT-NEW-PORTION
  6769
  6770         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6771                                   OUT-CSO-ALT-LF-PORT-CHG
  6772         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6773           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6774         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6775         COMPUTE WS-CSO-AH-PORT-CHG =
  6776           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6777         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6778         COMPUTE WS-CSO-PORTION-CHG =
  6779           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6780           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6781         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6782         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6783                                   OUT-ACCT-ALT-LF-PORT-CHG
  6784                                   OUT-ACCT-CMB-LF-PORT-CHG
  6785                                   OUT-ACCT-AH-PORT-CHG
  6786                                   OUT-ACCT-PORTION-CHG
  6787     ELSE
  6788         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6789                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6790         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6791           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6792         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6793                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6794         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6795           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6796         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6797         COMPUTE WS-ACCT-ORIG-PORTION =
  6798            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6799         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 119
* NSRASBL.cbl
  6800
  6801         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6802                                   OUT-CSO-ORIG-ALT-LF-PORT
  6803         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6804           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6805         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6806         COMPUTE WS-CSO-ORIG-AH-PORT =
  6807           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
  6808         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6809         COMPUTE WS-CSO-ORIG-PORTION =
  6810            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6811         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6812
  6813         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6814                                   OUT-ACCT-NEW-ALT-LF-PORT
  6815         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6816           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6817         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6818         COMPUTE WS-ACCT-NEW-AH-PORT =
  6819           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6820         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6821         COMPUTE WS-ACCT-NEW-PORTION =
  6822            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6823         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6824
  6825         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6826                                   OUT-CSO-NEW-ALT-LF-PORT
  6827         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6828           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6829         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6830         COMPUTE WS-CSO-NEW-AH-PORT =
  6831           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6832         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6833         COMPUTE WS-CSO-NEW-PORTION =
  6834            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6835         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6836
  6837         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6838                                    OUT-ACCT-ALT-LF-PORT-CHG
  6839         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6840            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6841         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6842         COMPUTE WS-ACCT-AH-PORT-CHG =
  6843            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6844         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6845         COMPUTE WS-ACCT-PORTION-CHG =
  6846            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6847         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6848
  6849         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6850                                    OUT-CSO-ALT-LF-PORT-CHG
  6851         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6852            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6853         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6854         COMPUTE WS-CSO-AH-PORT-CHG =
  6855            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6856         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6857         COMPUTE WS-CSO-PORTION-CHG =
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 120
* NSRASBL.cbl
  6858            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6859         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6860
  6861     END-IF
  6862     .
  6863 0620-CONTINUE.
  6864     display ' about to bld reason codes ' en-reason-code (1)
  6865     move en-reason-code (1)     to out-rea-cd1
  6866     move en-reason-code (2)     to out-rea-cd2
  6867     move en-reason-code (3)     to out-rea-cd3
  6868     move en-reason-code (4)     to out-rea-cd4
  6869     move en-reason-code (5)     to out-rea-cd5
  6870     move en-reason-code (6)     to out-rea-cd6
  6871     move en-reason-code (7)     to out-rea-cd7
  6872     move en-reason-code (8)     to out-rea-cd8
  6873     move en-reason-code (9)     to out-rea-cd9
  6874     move en-reason-code (10)    to out-rea-cd10
  6875     move en-reason-code (11)    to out-rea-cd11
  6876     move en-reason-code (12)    to out-rea-cd12
  6877*    PERFORM 1300-DETERMINE-COMM
  6878*                                THRU 1300-EXIT
  6879     .
  6880 0620-EXIT.
  6881     EXIT.
  6882 0650-PROCESS-NO-Change.
  6883     IF EN-REC-TYPE = 'C'
  6884        GO TO 0650-PROCESS-CANCEL
  6885     END-IF
  6886     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6887        AND (OUT-NEW-ILNAME NOT = SPACES))
  6888                      AND
  6889        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6890        AND (OUT-NEW-IFNAME NOT = SPACES))
  6891                      AND
  6892        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6893        AND (OUT-NEW-IFNAME NOT = SPACES))
  6894        move 'No Change'         to out-new-Ifname
  6895        MOVE SPACES              TO OUT-NEW-IMINIT
  6896        move spaces              to out-new-Ilname
  6897     ELSE
  6898         IF OUT-NEW-ILNAME = SPACES
  6899           AND OUT-NEW-IFNAME = SPACES
  6900           AND OUT-NEW-IMINIT = SPACES
  6901           AND OUT-ORIG-ILNAME NOT = SPACES
  6902            MOVE 'None'          TO OUT-NEW-IFNAME
  6903            MOVE SPACES          TO OUT-NEW-IMINIT
  6904            MOVE SPACES          TO OUT-NEW-ILNAME
  6905         END-IF
  6906     END-IF
  6907     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6908        AND (OUT-NEW-JLNAME NOT = SPACES))
  6909                    AND
  6910        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6911        AND (OUT-NEW-JFNAME NOT = SPACES))
  6912                    AND
  6913        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6914        AND (OUT-NEW-JFNAME NOT = SPACES))
  6915        MOVE 'No Change'         TO OUT-NEW-JFNAME
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 121
* NSRASBL.cbl
  6916        MOVE SPACES              TO OUT-NEW-JMINIT
  6917        MOVE SPACES              TO OUT-NEW-JLNAME
  6918     ELSE
  6919         IF OUT-NEW-JLNAME = SPACES
  6920           AND OUT-NEW-JFNAME = SPACES
  6921           AND OUT-NEW-JMINIT = SPACES
  6922           AND OUT-ORIG-JLNAME NOT = SPACES
  6923            MOVE 'None'          TO OUT-NEW-JFNAME
  6924            MOVE SPACES          TO OUT-NEW-JMINIT
  6925            MOVE SPACES          TO OUT-NEW-JLNAME
  6926         END-IF
  6927     END-IF
  6928     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6929        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6930        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6931     ELSE
  6932         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6933           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6934             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6935         END-IF
  6936     END-IF
  6937     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6938        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6939        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6940     ELSE
  6941         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6942           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6943             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6944         END-IF
  6945     END-IF
  6946     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6947        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6948        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6949     ELSE
  6950         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6951           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6952             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6953         END-IF
  6954     END-IF
  6955     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6956        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6957        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  6958     ELSE
  6959         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6960           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6961             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6962         END-IF
  6963     END-IF
  6964
  6965     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6966                              EN-LF-ORIG-ALT-PRM-AMT
  6967     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6968                               EN-LF-NEW-ALT-PRM-AMT
  6969     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6970        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6971        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6972     ELSE
  6973         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 122
* NSRASBL.cbl
  6974           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6975            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6976         END-IF
  6977     END-IF
  6978     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6979        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6980     END-IF
  6981     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  6982        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6983        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6984     END-IF
  6985     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6986        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6987        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6988     ELSE
  6989        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6990          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6991            MOVE 'None'          TO OUT-NEW-LF-DESC
  6992        END-IF
  6993     end-if
  6994     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6995       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6996        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6997     END-IF
  6998     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6999        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  7000        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  7001     ELSE
  7002         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7003           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7004             MOVE ZEROS          TO OUT-NEW-AH-BEN
  7005         END-IF
  7006     END-IF
  7007     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  7008        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  7009        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  7010     ELSE
  7011         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7012           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7013             MOVE ZEROS          TO OUT-NEW-AH-PRM
  7014         END-IF
  7015     END-IF
  7016     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  7017        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  7018        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  7019     ELSE
  7020         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7021           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7022             MOVE 'None'         TO OUT-NEW-AH-DESC
  7023         END-IF
  7024     END-IF
  7025     IF EN-INS-ORIG-AGE-DEF-FLAG <> 'Y'
  7026         MOVE 'N' TO EN-INS-ORIG-AGE-DEF-FLAG
  7027     END-IF
  7028     IF EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  7029         MOVE 'N' TO EN-INS-NEW-AGE-DEF-FLAG
  7030     END-IF
  7031     IF EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 123
* NSRASBL.cbl
  7032         MOVE 'N' TO EN-JNT-ORIG-AGE-DEF-FLAG
  7033     END-IF
  7034     IF EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  7035         MOVE 'N' TO EN-JNT-NEW-AGE-DEF-FLAG
  7036     END-IF
  7037
  7038     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  7039       AND EN-INS-NEW-AGE-DEF-FLAG = EN-INS-ORIG-AGE-DEF-FLAG
  7040       AND EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  7041       AND EN-INS-NEW-LAST-NAME = EN-INS-ORIG-LAST-NAME
  7042       AND EN-INS-NEW-FIRST-NAME = EN-INS-ORIG-FIRST-NAME
  7043       AND EN-INS-NEW-MIDDLE-INIT = EN-INS-ORIG-MIDDLE-INIT
  7044        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  7045     END-IF
  7046     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  7047        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  7048        AND EN-JNT-NEW-AGE-DEF-FLAG = EN-JNT-ORIG-AGE-DEF-FLAG
  7049        AND EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  7050        AND EN-JNT-NEW-LAST-NAME = EN-JNT-ORIG-LAST-NAME
  7051        AND EN-JNT-NEW-FIRST-NAME = EN-JNT-ORIG-FIRST-NAME
  7052        AND EN-JNT-NEW-MIDDLE-INIT = EN-JNT-ORIG-MIDDLE-INIT
  7053        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  7054     ELSE
  7055         IF (EN-JNT-ORIG-AGE > ZEROS)
  7056           AND (EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y')
  7057           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  7058             MOVE 'None'         TO OUT-NEW-JAGE-A
  7059         END-IF
  7060     END-IF
  7061     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  7062        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  7063        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  7064     ELSE
  7065         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  7066           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  7067             MOVE ZEROS          TO OUT-NEW-LF-TERM
  7068         END-IF
  7069     END-IF
  7070     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  7071        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  7072        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  7073     ELSE
  7074         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7075           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7076             MOVE ZEROS          TO OUT-NEW-AH-TERM
  7077         END-IF
  7078     END-IF
  7079     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  7080        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  7081        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  7082                                    OUT-NEW-MAX-PMTS-A
  7083     ELSE
  7084         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7085           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7086             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  7087                                    OUT-NEW-MAX-PMTS-A
  7088         END-IF
  7089     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 124
* NSRASBL.cbl
  7090     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  7091        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  7092     END-IF
  7093     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  7094       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  7095         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  7096     ELSE
  7097         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7098           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7099             MOVE 'None'         TO OUT-NEW-WAIT-PER
  7100         END-IF
  7101     END-IF
  7102     .
  7103 0650-PROCESS-CANCEL.
  7104     .
  7105 0650-EXIT.
  7106     EXIT.
  7107 0700-WRITE-EXTR.
  7108     display ' made it to 0700 '
  7109     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  7110     IF BL-FAIL
  7111        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  7112        GO TO 0700-EXIT
  7113     END-IF
  7114     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  7115     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  7116     MOVE +0                     TO NSAS-SEQ-NO
  7117     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  7118     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  7119     IF BL-FAIL
  7120        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  7121        GO TO 0700-EXIT
  7122     END-IF
  7123     IF W-LETTER-TO-ACCT NOT = SPACES
  7124        display ' acct ne spaces ' bl-archive-no
  7125        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  7126        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7127        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7128        MOVE +1                  TO NSAS-SEQ-NO
  7129        PERFORM 0720-WRITE-NSASEXTR
  7130                                 THRU 0720-EXIT
  7131        IF BL-FAIL
  7132           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  7133           GO TO 0700-EXIT
  7134        END-IF
  7135     END-IF
  7136     IF W-LETTER-TO-BENE NOT = SPACES
  7137        display ' bene ne spaces ' bl-archive-no
  7138        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  7139        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7140        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7141        MOVE +2                  TO NSAS-SEQ-NO
  7142        PERFORM 0720-WRITE-NSASEXTR
  7143                                 THRU 0720-EXIT
  7144        IF BL-FAIL
  7145           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  7146        END-IF
  7147     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 125
* NSRASBL.cbl
  7148     IF W-PRINT-CERTIFICATE = 'Y' AND
  7149        BL-STATE = 'VA'
  7150           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  7151           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  7152           MOVE BL-CARRIER          TO VD-CARRIER
  7153           MOVE BL-GROUP            TO VD-GROUPING
  7154           MOVE BL-STATE            TO VD-STATE
  7155           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  7156           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  7157           MOVE BL-CERT-NO          TO VD-CERT-NO
  7158           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  7159           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  7160           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  7161           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  7162           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  7163           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  7164           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  7165           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  7166           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  7167           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  7168           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  7169           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  7170           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  7171           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  7172           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  7173           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  7174           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  7175           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  7176           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  7177           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  7178           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  7179           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  7180           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  7181           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  7182           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  7183           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  7184           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  7185           MOVE 'VADS'              TO VD-LETTER-ID
  7186           MOVE OUT-PROC-ID         TO VD-PROC-ID
  7187           MOVE BL-COMP-ID          TO VD-COMP-ID
  7188           MOVE EIBTIME             TO VD-CURRENT-TIME
  7189           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  7190           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  7191           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  7192
  7193* EXEC CICS LINK
  7194*              PROGRAM    (LINK-ELVADS)
  7195*              COMMAREA   (WS-PASS-AREA)
  7196*              LENGTH     (WS-PASS-AREA-LENGTH)
  7197*          END-EXEC
  7198*    MOVE '."C                   (   #00007044' TO DFHEIV0
  7199     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7200     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7201     MOVE X'2020233030303037303434' TO DFHEIV0(25:11)
  7202     CALL 'kxdfhei1' USING DFHEIV0,
  7203           LINK-ELVADS,
  7204           WS-PASS-AREA,
  7205           WS-PASS-AREA-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 126
* NSRASBL.cbl
  7206           DFHEIV99,
  7207           DFHEIV99,
  7208           DFHEIV99,
  7209           DFHEIV99
  7210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7211     END-IF
  7212     .
  7213 0700-EXIT.
  7214     EXIT.
  7215  0710-BUILD-NSASEXTR.
  7216***  i added the extra space in front of the 1st ~
  7217***  only because there may be a letter to acct or bene
  7218     STRING
  7219         OUT-LETTER             ' ~'
  7220         OUT-PROC-ID            '~'
  7221         OUT-PROC-NAME          '~'
  7222         OUT-PROC-TITLE         '~'
  7223         OUT-CSR-NAME           '~'
  7224         OUT-CSR-TITLE          '~'
  7225         OUT-CARRIER            '~'
  7226         OUT-GROUPING           '~'
  7227         OUT-STATE              '~'
  7228         OUT-ACCOUNT            '~'
  7229         OUT-CERT-EFF-DT        '~'
  7230         OUT-CERT-NO            '~'
  7231         OUT-CERT-SFX           '~'
  7232         OUT-ILNAME             '~'
  7233         OUT-IFNAME             '~'
  7234         OUT-IFINIT             '~'
  7235         OUT-IMINIT             '~'
  7236         OUT-IAGE               '~'
  7237         OUT-ISEX               '~'
  7238         OUT-INS-ADDR1          '~'
  7239         OUT-INS-ADDR2          '~'
  7240         OUT-INS-CITY           '~'
  7241         OUT-INS-STATE          '~'
  7242         OUT-INS-ZIP            '~'
  7243         OUT-SOC-SEC-NO         '~'
  7244         OUT-MEMBER-NO          '~'
  7245         OUT-JLNAME             '~'
  7246         OUT-JFNAME             '~'
  7247         OUT-JMINIT             '~'
  7248         OUT-JAGE               '~'
  7249         OUT-ACCT-NAME          '~'
  7250         OUT-ACCT-ADDR1         '~'
  7251         OUT-ACCT-ADDR2         '~'
  7252         OUT-ACCT-CITY          '~'
  7253         OUT-ACCT-STATE         '~'
  7254         OUT-ACCT-ZIP           '~'
  7255         OUT-ACCT-PHONE         '~'
  7256         OUT-ACCT-CNTRL-NAME    '~'
  7257         OUT-ACCT-BUS-TYPE      '~'
  7258         OUT-BENE-NAME          '~'
  7259         OUT-BENE-ADDR1         '~'
  7260         OUT-BENE-ADDR2         '~'
  7261         OUT-BENE-CITY          '~'
  7262         OUT-BENE-STATE         '~'
  7263         OUT-BENE-ZIP           '~'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 127
* NSRASBL.cbl
  7264         OUT-CARR-NAME          '~'
  7265         OUT-RESP-NO            '~'
  7266         OUT-COMP-NAME          '~'
  7267         OUT-COMP-MAIL-TO       '~'
  7268         OUT-COMP-ADDR1         '~'
  7269         OUT-COMP-ADDR2         '~'
  7270         OUT-COMP-CITY          '~'
  7271         OUT-COMP-STATE         '~'
  7272         OUT-COMP-ZIP           '~'
  7273         OUT-COMP-PHONE         '~'
  7274         OUT-COMP-FAX           '~'
  7275         OUT-COMP-STATUS        '~'
  7276         OUT-BILL-SW            '~'
  7277         OUT-RPT-CD1            '~'
  7278         OUT-RPT-CD2            '~'
  7279         OUT-ENTRY-DT           '~'
  7280         OUT-ENTRY-BATCH        '~'
  7281         OUT-ENTRY-STATUS       '~'
  7282         OUT-1ST-PMT-DT         '~'
  7283         OUT-LOAN-APR           '~'
  7284         OUT-LOAN-TERM          '~'
  7285         OUT-RATE-CLASS         '~'
  7286         OUT-EXT-DAYS           '~'
  7287         OUT-CSR-CODE           '~'
  7288         OUT-UCODE              '~'
  7289         OUT-PREM-TYPE          '~'
  7290         OUT-IND-GRP            '~'
  7291         OUT-SKIP-CD            '~'
  7292         OUT-PMT-MODE           '~'
  7293         OUT-LOAN-OFF           '~'
  7294         OUT-REIN-TABLE         '~'
  7295         OUT-SPEC-REIN          '~'
  7296         OUT-LF-BENCD           '~'
  7297         OUT-LF-TERM            '~'
  7298         OUT-LF-DEV-CD          '~'
  7299         OUT-LF-DEV-PCT         '~'
  7300         OUT-LF-BEN             '~'
  7301         OUT-LF-PRM             '~'
  7302         OUT-LF-ALT-BEN         '~'
  7303         OUT-LF-ALT-PRM         '~'
  7304         OUT-LF-NSP             '~'
  7305         OUT-LF-REM-BEN         '~'
  7306         OUT-LF-REF             '~'
  7307         OUT-LF-DTH             '~'
  7308         OUT-LF-RATE            '~'
  7309         OUT-LF-ALT-RATE        '~'
  7310         OUT-LF-EXP-DT          '~'
  7311         OUT-LF-CUR-STATUS      '~'
  7312         OUT-LF-CAN-DT          '~'
  7313         OUT-LF-CAN-EXIT-DT     '~'
  7314         OUT-LF-DTH-DT          '~'
  7315         OUT-LF-DTH-EXIT-DT     '~'
  7316         OUT-LF-EXIT-BATCH      '~'
  7317         OUT-LF-COMM-PCT        '~'
  7318         OUT-LF-DESC            '~'
  7319         OUT-LF-ABBRV           '~'
  7320         OUT-AH-BENCD           '~'
  7321         OUT-AH-TERM            '~'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 128
* NSRASBL.cbl
  7322         OUT-CRIT-PER           '~'
  7323         OUT-AH-DEV-CD          '~'
  7324         OUT-AH-DEV-PCT         '~'
  7325         OUT-AH-BEN             '~'
  7326         OUT-AH-PRM             '~'
  7327         OUT-AH-NSP             '~'
  7328         OUT-AH-REF             '~'
  7329         OUT-AH-CLM             '~'
  7330         OUT-AH-TOT-BEN         '~'
  7331         OUT-AH-PDTHRU-DT       '~'
  7332         OUT-AH-RATE            '~'
  7333         OUT-AH-EXP-DT          '~'
  7334         OUT-AH-CUR-STATUS      '~'
  7335         OUT-AH-CAN-DT          '~'
  7336         OUT-AH-CAN-EXIT-DT     '~'
  7337         OUT-AH-EXIT-BATCH      '~'
  7338         OUT-AH-COMM-PCT        '~'
  7339         OUT-AH-DESC            '~'
  7340         OUT-RET-ELIM           '~'
  7341         OUT-BEN-DAYS           '~'
  7342         OUT-WAIT-PER           '~'
  7343         OUT-MAX-PMTS           '~'
  7344         OUT-TOT-PRM            '~'
  7345         OUT-TOT-REF            '~'
  7346         OUT-SCHED-EXP-DT       '~'
  7347         OUT-SCHED-TERM         '~'
  7348         OUT-ORIG-ILNAME        '~'
  7349         OUT-ORIG-IFNAME        '~'
  7350         OUT-ORIG-MINIT         '~'
  7351         OUT-ORIG-IAGE          '~'
  7352         OUT-ORIG-JLNAME        '~'
  7353         OUT-ORIG-JFNAME        '~'
  7354         OUT-ORIG-JMINIT        '~'
  7355         OUT-ORIG-JAGE          '~'
  7356         OUT-ORIG-LF-BENCD      '~'
  7357         OUT-ORIG-LF-TERM       '~'
  7358         OUT-ORIG-LF-BEN        '~'
  7359         OUT-ORIG-LF-PRM        '~'
  7360         OUT-LF-CALC-PRM        '~'
  7361         OUT-ORIG-LF-REF        '~'
  7362         OUT-LF-CALC-REF        '~'
  7363         OUT-ORIG-LF-ALT-BEN    '~'
  7364         OUT-ORIG-LF-ALT-PRM    '~'
  7365         OUT-ORIG-LF-EXP-DT     '~'
  7366         OUT-ORIG-LF-DESC       '~'
  7367         OUT-ORIG-AH-BENCD      '~'
  7368         OUT-ORIG-AH-TERM       '~'
  7369         OUT-ORIG-CRIT-PER      '~'
  7370         OUT-ORIG-AH-BEN        '~'
  7371         OUT-ORIG-AH-PRM        '~'
  7372         OUT-AH-CALC-PRM        '~'
  7373         OUT-ORIG-AH-REF        '~'
  7374         OUT-AH-CALC-REF        '~'
  7375         OUT-ORIG-AH-EXP-DT     '~'
  7376         OUT-ORIG-AH-DESC       '~'
  7377         OUT-ORIG-RET-ELIM      '~'
  7378         OUT-ORIG-BEN-DAYS      '~'
  7379         OUT-ORIG-WAIT-PER      '~'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 129
* NSRASBL.cbl
  7380         OUT-ORIG-MAX-PMTS      '~'
  7381         OUT-ORIG-SCHED-EXP-DT  '~'
  7382         OUT-ORIG-SCHED-TERM    '~'
  7383         OUT-NEW-ILNAME         '~'
  7384         OUT-NEW-IFNAME         '~'
  7385         OUT-NEW-IMINIT         '~'
  7386         OUT-NEW-IAGE           '~'
  7387         OUT-NEW-JLNAME         '~'
  7388         OUT-NEW-JFNAME         '~'
  7389         OUT-NEW-JMINIT         '~'
  7390         OUT-NEW-JAGE           '~'
  7391         OUT-NEW-LF-BENCD       '~'
  7392         OUT-NEW-LF-TERM        '~'
  7393         OUT-NEW-LF-BEN         '~'
  7394         OUT-NEW-LF-PRM         '~'
  7395         OUT-NEW-LF-REF         '~'
  7396         OUT-NEW-LF-ALT-BEN     '~'
  7397         OUT-NEW-LF-ALT-PRM     '~'
  7398         OUT-NEW-LF-EXP-DT      '~'
  7399         OUT-NEW-LF-DESC        '~'
  7400         OUT-NEW-AH-BENCD       '~'
  7401         OUT-NEW-AH-TERM        '~'
  7402         OUT-NEW-CRIT-PER       '~'
  7403         OUT-NEW-AH-BEN         '~'
  7404         OUT-NEW-AH-PRM         '~'
  7405         OUT-NEW-AH-REF         '~'
  7406         OUT-NEW-AH-EXP-DT      '~'
  7407         OUT-NEW-AH-DESC        '~'
  7408         OUT-NEW-RET-ELIM       '~'
  7409         OUT-NEW-BEN-DAYS       '~'
  7410         OUT-NEW-WAIT-PER       '~'
  7411         OUT-NEW-MAX-PMTS       '~'
  7412         OUT-NEW-SCHED-EXP-DT   '~'
  7413         OUT-NEW-SCHED-TERM     '~'
  7414         OUT-TOT-PRM-CHG        '~'
  7415         OUT-TOT-REF-CHG        '~'
  7416         OUT-PAYEE              '~'
  7417         OUT-SIG-SW             '~'
  7418         OUT-BALLOON-IND        '~'
  7419         OUT-LEASE-IND          '~'
  7420         OUT-RESCIND            '~'
  7421         OUT-REA-CD1            '~'
  7422         OUT-REA-CD2            '~'
  7423         OUT-REA-CD3            '~'
  7424         OUT-REA-CD4            '~'
  7425         OUT-REA-CD5            '~'
  7426         OUT-REA-CD6            '~'
  7427         OUT-REA-CD7            '~'
  7428         OUT-REA-CD8            '~'
  7429         OUT-REA-CD9            '~'
  7430         OUT-REA-CD10           '~'
  7431         OUT-REA-CD11           '~'
  7432         OUT-REA-CD12           '~'
  7433         OUT-CYCLE-DT           '~'
  7434         OUT-ARCH-NO            '~'
  7435         OUT-FORM               '~'
  7436         OUT-ENC-LINE           '~'
  7437         OUT-ATTACH             '~'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 130
* NSRASBL.cbl
  7438         OUT-STACK              '~'
  7439         OUT-STATE-NAME         '~'
  7440         OUT-PRINT-NOW          '~'
  7441         OUT-CHGBACK            '~'
  7442         OUT-CSO-PORTION        '~'
  7443         OUT-ACCT-PORTION       '~'
  7444         OUT-LETTER-TYPE        '~'
  7445         OUT-PRINT-CERTIFICATE  '~'
  7446         OUT-INS-BIRTHDATE      '~'
  7447         OUT-JNT-BIRTHDATE      '~'
  7448         OUT-TOT-INTEREST       '~'
  7449         OUT-ORIG-TOT-PREM      '~'
  7450         OUT-ORIG-TOT-REF       '~'
  7451         OUT-CANCEL-DT          '~'
  7452         OUT-HEALTH-APP         '~'
  7453         OUT-CERTIFICATE-ID     '~'
  7454         OUT-UNDW-ID            '~'
  7455         OUT-NEW-TOT-PREM       '~'
  7456         OUT-NEW-TOT-REF        '~'
  7457         OUT-COVERAGE-IND       '~'
  7458         OUT-ORIG-COVERAGE-IND  '~'
  7459         OUT-NEW-COVERAGE-IND   '~'
  7460         OUT-LF-CMB-PREM        '~'
  7461         OUT-ORIG-LF-CMB-PREM   '~'
  7462         OUT-NEW-LF-CMB-PREM    '~'
  7463         OUT-LF-PREM-CHG        '~'
  7464         OUT-LF-ALT-PREM-CHG    '~'
  7465         OUT-LF-CMB-PREM-CHG    '~'
  7466         OUT-AH-PREM-CHG        '~'
  7467         OUT-LF-REF-CHG         '~'
  7468         OUT-AH-REF-CHG         '~'
  7469         OUT-ACCT-LF-PORTION    '~'
  7470         OUT-ACCT-ALT-LF-PORT   '~'
  7471         OUT-ACCT-CMB-LF-PORT   '~'
  7472         OUT-ACCT-AH-PORTION    '~'
  7473         OUT-CSO-LF-PORTION     '~'
  7474         OUT-CSO-ALT-LF-PORT    '~'
  7475         OUT-CSO-CMB-LF-PORT    '~'
  7476         OUT-CSO-AH-PORTION     '~'
  7477         OUT-ACCT-ORIG-LF-PORT  '~'
  7478         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  7479         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  7480         OUT-ACCT-ORIG-AH-PORT  '~'
  7481         OUT-ACCT-ORIG-PORTION  '~'
  7482         OUT-CSO-ORIG-LF-PORT   '~'
  7483         OUT-CSO-ORIG-ALT-LF-PORT '~'
  7484         OUT-CSO-ORIG-CMB-LF-PORT '~'
  7485         OUT-CSO-ORIG-AH-PORT   '~'
  7486         OUT-CSO-ORIG-PORTION   '~'
  7487         OUT-ACCT-NEW-LF-PORT   '~'
  7488         OUT-ACCT-NEW-ALT-LF-PORT '~'
  7489         OUT-ACCT-NEW-CMB-LF-PORT '~'
  7490         OUT-ACCT-NEW-AH-PORT   '~'
  7491         OUT-ACCT-NEW-PORTION   '~'
  7492         OUT-CSO-NEW-LF-PORT    '~'
  7493         OUT-CSO-NEW-ALT-LF-PORT '~'
  7494         OUT-CSO-NEW-CMB-LF-PORT '~'
  7495         OUT-CSO-NEW-AH-PORT    '~'
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 131
* NSRASBL.cbl
  7496         OUT-CSO-NEW-PORTION    '~'
  7497         OUT-ACCT-LF-PORT-CHG   '~'
  7498         OUT-ACCT-ALT-LF-PORT-CHG '~'
  7499         OUT-ACCT-CMB-LF-PORT-CHG '~'
  7500         OUT-ACCT-AH-PORT-CHG   '~'
  7501         OUT-ACCT-PORTION-CHG   '~'
  7502         OUT-CSO-LF-PORT-CHG    '~'
  7503         OUT-CSO-ALT-LF-PORT-CHG '~'
  7504         OUT-CSO-CMB-LF-PORT-CHG '~'
  7505         OUT-CSO-AH-PORT-CHG    '~'
  7506         OUT-CSO-PORTION-CHG    '~'
  7507         OUT-ORIG-LF-CAN-DT     '~'
  7508         OUT-NEW-LF-CAN-DT      '~'
  7509         OUT-ORIG-AH-CAN-DT     '~'
  7510         OUT-NEW-AH-CAN-DT      '~'
  7511         OUT-ORIG-CAN-DT        '~'
  7512         OUT-NEW-CAN-DT         '~'
  7513         OUT-SCREEN-ID          '~'
  7514         OUT-NEXT-BUS-DT        '~'
  7515         OUT-VIN-NUMBER         '~'
  7516            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  7517     END-STRING
  7518     .
  7519 0710-exit.
  7520     EXIT.
  7521 0720-WRITE-NSASEXTR.
  7522
  7523* EXEC CICS WRITE
  7524*       DATASET    ('NSASEXTR')
  7525*       FROM       (NSAS-EXTRACT-RECORD)
  7526*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  7527*       RESP       (WS-RESPONSE)
  7528*    END-EXEC
  7529     MOVE LENGTH OF
  7530      NSAS-EXTRACT-RECORD
  7531       TO DFHEIV11
  7532     MOVE 'NSASEXTR' TO DFHEIV1
  7533*    MOVE '&$ L                  ''  N#00007360' TO DFHEIV0
  7534     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7535     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7536     MOVE X'204E233030303037333630' TO DFHEIV0(25:11)
  7537     CALL 'kxdfhei1' USING DFHEIV0,
  7538           DFHEIV1,
  7539           NSAS-EXTRACT-RECORD,
  7540           DFHEIV11,
  7541           NSAS-CONTROL-PRIMARY,
  7542           DFHEIV99,
  7543           DFHEIV99
  7544     MOVE EIBRESP  TO WS-RESPONSE
  7545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7546     IF NOT RESP-NORMAL
  7547        display ' bad write nsasextr ' ws-response
  7548        SET BL-FAIL TO TRUE
  7549     END-IF
  7550     .
  7551 0720-EXIT.
  7552     EXIT.
  7553 0800-init-out-data.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 132
* NSRASBL.cbl
  7554     MOVE ZEROS                  TO OUT-IAGE
  7555                                    OUT-JAGE
  7556                                    OUT-LOAN-APR
  7557                                    OUT-LOAN-TERM
  7558                                    OUT-EXT-DAYS
  7559                                    OUT-LF-TERM
  7560                                    OUT-AH-TERM
  7561                                    OUT-LF-DEV-PCT
  7562                                    OUT-AH-DEV-PCT
  7563                                    OUT-LF-BEN
  7564                                    OUT-AH-BEN
  7565                                    OUT-CRIT-PER
  7566                                    OUT-MAX-PMTS
  7567                                    OUT-SCHED-TERM
  7568                                    OUT-ORIG-IAGE
  7569                                    OUT-ORIG-JAGE
  7570                                    OUT-NEW-IAGE
  7571                                    OUT-NEW-JAGE
  7572                                    OUT-ORIG-LF-TERM
  7573                                    OUT-ORIG-AH-TERM
  7574                                    OUT-NEW-LF-TERM
  7575                                    OUT-NEW-AH-TERM
  7576                                    OUT-ORIG-CRIT-PER
  7577                                    OUT-ORIG-MAX-PMTS
  7578                                    OUT-ORIG-SCHED-TERM
  7579                                    OUT-NEW-SCHED-TERM
  7580                                    OUT-NEW-CRIT-PER
  7581                                    OUT-NEW-MAX-PMTS
  7582                                    OUT-CSO-PORTION
  7583                                    OUT-CSO-LF-PORTION
  7584                                    OUT-CSO-ALT-LF-PORT
  7585                                    OUT-CSO-CMB-LF-PORT
  7586                                    OUT-CSO-AH-PORTION
  7587                                    OUT-ACCT-PORTION
  7588                                    OUT-ACCT-LF-PORTION
  7589                                    OUT-ACCT-ALT-LF-PORT
  7590                                    OUT-ACCT-CMB-LF-PORT
  7591                                    OUT-ACCT-AH-PORTION
  7592                                    OUT-LF-PREM-CHG
  7593                                    OUT-LF-ALT-PREM-CHG
  7594                                    OUT-LF-CMB-PREM-CHG
  7595                                    OUT-AH-PREM-CHG
  7596                                    OUT-LF-REF-CHG
  7597                                    OUT-AH-REF-CHG
  7598     .
  7599 0800-exit.
  7600     exit.
  7601 1000-BUILD-ERARCH.
  7602* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7603*    1) FROM ACCT MAINT
  7604*    2) FROM CERT UPDATE
  7605*    3) FROM COMP MAINT
  7606*    4) FROM REVIEW AND CORRECTIONS
  7607******************************************************************
  7608     MOVE 'LA'                   TO LETTER-ARCHIVE
  7609     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7610                                    LA-ARCHIVE-NO-A2
  7611                                    LA-ARCHIVE-NO-A3
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 133
* NSRASBL.cbl
  7612                                    LA-ARCHIVE-NO-A4
  7613                                    LA-ARCHIVE-NO-A5
  7614                                    LA-ARCHIVE-NO-A6
  7615     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7616                                    LA-COMPANY-CD-A2
  7617                                    LA-COMPANY-CD-A3
  7618                                    LA-COMPANY-CD-A4
  7619                                    LA-COMPANY-CD-A5
  7620                                    LA-COMPANY-CD-A6
  7621     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7622                                    LA-CARRIER-A3
  7623                                    LA-CARRIER-A4
  7624                                    LA-CARRIER-A5
  7625     MOVE BL-GROUP               TO LA-GROUPING-A2
  7626                                    LA-GROUPING-A3
  7627                                    LA-GROUPING-A4
  7628                                    LA-GROUPING-A5
  7629     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7630                                    LA-ACCOUNT-A3
  7631                                    LA-ACCOUNT-A4
  7632                                    LA-ACCOUNT-A5
  7633     MOVE BL-STATE               TO LA-STATE-A2
  7634                                    LA-STATE-A3
  7635                                    LA-STATE-A4
  7636                                    LA-STATE-A5
  7637     IF BL-DATA-SRCE = '2' OR '4'
  7638        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7639        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7640     ELSE
  7641        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7642     END-IF
  7643     IF BL-DATA-SRCE = '4'
  7644        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7645     END-IF
  7646     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7647                                    LA-LAST-UPDATED-BY
  7648     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7649                                    LA-INITIAL-PRINT-DATE
  7650                                    LA-SENT-DATE
  7651                                    LA-REPLY-DATE
  7652                                    LA-RESEND-DATE
  7653                                    LA-FOLLOW-UP-DATE
  7654     MOVE 'A'                    TO LA-STATUS
  7655     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7656     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7657     IF W-DAYS-TO-RESEND NOT NUMERIC
  7658        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7659     END-IF
  7660     IF W-DAYS-TO-RESEND > ZEROS
  7661        MOVE SAVE-BIN-NEXT-BUS-DT TO DC-BIN-DATE-1
  7662        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7663        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7664        MOVE '6'                 TO DC-OPTION-CODE
  7665        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7666        IF NO-CONVERSION-ERROR
  7667           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7668        END-IF
  7669     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 134
* NSRASBL.cbl
  7670     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7671        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7672        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7673        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7674        MOVE '6'                 TO DC-OPTION-CODE
  7675        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7676        IF NO-CONVERSION-ERROR
  7677           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
  7678        END-IF
  7679     END-IF
  7680
  7681     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7682     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7683     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7684     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7685     IF BL-ENDT-ARCH-NO > ZEROS
  7686        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7687     ELSE
  7688        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7689     END-IF
  7690     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7691                                    LA-LAST-MAINT-DATE
  7692     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7693                                    LA-NO-OF-TEXT-RECORDS
  7694     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7695
  7696* EXEC CICS WRITE
  7697*         DATASET   ('ERARCH')
  7698*         FROM      (LETTER-ARCHIVE)
  7699*         RIDFLD    (LA-CONTROL-PRIMARY)
  7700*         RESP      (WS-RESPONSE)
  7701*    END-EXEC
  7702     MOVE LENGTH OF
  7703      LETTER-ARCHIVE
  7704       TO DFHEIV11
  7705     MOVE 'ERARCH' TO DFHEIV1
  7706*    MOVE '&$ L                  ''  N#00007515' TO DFHEIV0
  7707     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7708     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7709     MOVE X'204E233030303037353135' TO DFHEIV0(25:11)
  7710     CALL 'kxdfhei1' USING DFHEIV0,
  7711           DFHEIV1,
  7712           LETTER-ARCHIVE,
  7713           DFHEIV11,
  7714           LA-CONTROL-PRIMARY,
  7715           DFHEIV99,
  7716           DFHEIV99
  7717     MOVE EIBRESP  TO WS-RESPONSE
  7718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7719     IF NOT RESP-NORMAL
  7720        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7721        la-archive-no
  7722        SET BL-FAIL TO TRUE
  7723     END-IF
  7724     .
  7725 1000-EXIT.
  7726     EXIT.
  7727 1025-GET-CSR-INFO.
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 135
* NSRASBL.cbl
  7728     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7729                                    OUT-CSR-TITLE
  7730                                    OUT-PROC-TITLE
  7731                                    OUT-UNDW-ID
  7732     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7733     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7734     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7735     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7736
  7737* EXEC CICS READ
  7738*       INTO    (CONTROL-FILE)
  7739*       DATASET ('ELCNTL')
  7740*       RIDFLD  (WS-ELCNTL-KEY)
  7741*       RESP    (WS-RESPONSE)
  7742*    END-EXEC
  7743     MOVE LENGTH OF
  7744      CONTROL-FILE
  7745       TO DFHEIV11
  7746     MOVE 'ELCNTL' TO DFHEIV1
  7747*    MOVE '&"IL       E          (  N#00007538' TO DFHEIV0
  7748     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7750     MOVE X'204E233030303037353338' TO DFHEIV0(25:11)
  7751     CALL 'kxdfhei1' USING DFHEIV0,
  7752           DFHEIV1,
  7753           CONTROL-FILE,
  7754           DFHEIV11,
  7755           WS-ELCNTL-KEY,
  7756           DFHEIV99,
  7757           DFHEIV99,
  7758           DFHEIV99
  7759     MOVE EIBRESP  TO WS-RESPONSE
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7761     IF RESP-NORMAL
  7762        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7763                                    OUT-PROC-NAME
  7764*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7765*                                   OUT-PROC-TITLE
  7766     END-IF
  7767     IF BL-PROC-ID NOT = PB-CSR-ID
  7768        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7769        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7770        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7771                                    OUT-PROC-TITLE
  7772        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7773
  7774* EXEC CICS READ
  7775*          INTO    (CONTROL-FILE)
  7776*          DATASET ('ELCNTL')
  7777*          RIDFLD  (WS-ELCNTL-KEY)
  7778*          RESP    (WS-RESPONSE)
  7779*       END-EXEC
  7780     MOVE LENGTH OF
  7781      CONTROL-FILE
  7782       TO DFHEIV11
  7783     MOVE 'ELCNTL' TO DFHEIV1
  7784*    MOVE '&"IL       E          (  N#00007556' TO DFHEIV0
  7785     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 136
* NSRASBL.cbl
  7786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7787     MOVE X'204E233030303037353536' TO DFHEIV0(25:11)
  7788     CALL 'kxdfhei1' USING DFHEIV0,
  7789           DFHEIV1,
  7790           CONTROL-FILE,
  7791           DFHEIV11,
  7792           WS-ELCNTL-KEY,
  7793           DFHEIV99,
  7794           DFHEIV99,
  7795           DFHEIV99
  7796     MOVE EIBRESP  TO WS-RESPONSE
  7797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7798        IF RESP-NORMAL
  7799           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7800*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7801        END-IF
  7802     END-IF
  7803     .
  7804 1025-EXIT.
  7805     EXIT.
  7806 1050-GET-ERMAIL.
  7807     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7808
  7809* EXEC CICS READ
  7810*         DATASET    ('ERMAIL')
  7811*         INTO       (MAILING-DATA)
  7812*         RIDFLD     (WS-ERMAIL-KEY)
  7813*         RESP       (WS-RESPONSE)
  7814*    END-EXEC
  7815     MOVE LENGTH OF
  7816      MAILING-DATA
  7817       TO DFHEIV11
  7818     MOVE 'ERMAIL' TO DFHEIV1
  7819*    MOVE '&"IL       E          (  N#00007572' TO DFHEIV0
  7820     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7821     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7822     MOVE X'204E233030303037353732' TO DFHEIV0(25:11)
  7823     CALL 'kxdfhei1' USING DFHEIV0,
  7824           DFHEIV1,
  7825           MAILING-DATA,
  7826           DFHEIV11,
  7827           WS-ERMAIL-KEY,
  7828           DFHEIV99,
  7829           DFHEIV99,
  7830           DFHEIV99
  7831     MOVE EIBRESP  TO WS-RESPONSE
  7832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7833     IF RESP-NORMAL
  7834        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7835        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7836        MOVE MA-CITY             TO OUT-INS-CITY
  7837        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7838        MOVE MA-ZIP              TO OUT-INS-ZIP
  7839        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7840        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7841        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7842        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7843        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 137
* NSRASBL.cbl
  7844        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7845        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7846           MOVE MA-INSURED-BIRTH-DT
  7847                                 TO DC-BIN-DATE-1
  7848           MOVE ' '              TO DC-OPTION-CODE
  7849           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7850           IF NO-CONVERSION-ERROR
  7851              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7852                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7853                INTO OUT-INS-BIRTHDATE
  7854              END-STRING
  7855           END-IF
  7856        END-IF
  7857        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7858           MOVE MA-JOINT-BIRTH-DT
  7859                                 TO DC-BIN-DATE-1
  7860           MOVE ' '              TO DC-OPTION-CODE
  7861           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7862           IF NO-CONVERSION-ERROR
  7863              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7864                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7865                INTO OUT-JNT-BIRTHDATE
  7866              END-STRING
  7867           END-IF
  7868        END-IF
  7869     END-IF
  7870     .
  7871 1050-EXIT.
  7872     EXIT.
  7873 1100-GET-ELCERT.
  7874
  7875* EXEC CICS READ
  7876*         DATASET    ('ELCERT')
  7877*         INTO       (CERTIFICATE-MASTER)
  7878*         RIDFLD     (WS-ELCERT-KEY)
  7879*         RESP       (WS-RESPONSE)
  7880*    END-EXEC.
  7881     MOVE LENGTH OF
  7882      CERTIFICATE-MASTER
  7883       TO DFHEIV11
  7884     MOVE 'ELCERT' TO DFHEIV1
  7885*    MOVE '&"IL       E          (  N#00007619' TO DFHEIV0
  7886     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7887     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7888     MOVE X'204E233030303037363139' TO DFHEIV0(25:11)
  7889     CALL 'kxdfhei1' USING DFHEIV0,
  7890           DFHEIV1,
  7891           CERTIFICATE-MASTER,
  7892           DFHEIV11,
  7893           WS-ELCERT-KEY,
  7894           DFHEIV99,
  7895           DFHEIV99,
  7896           DFHEIV99
  7897     MOVE EIBRESP  TO WS-RESPONSE
  7898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7899
  7900     IF RESP-NORMAL
  7901        SET CERT-FOUND TO TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 138
* NSRASBL.cbl
  7902        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7903        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7904     END-IF
  7905     .
  7906 1100-EXIT.
  7907     EXIT.
  7908 1110-BUILD-CERT.
  7909     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
  7910     MOVE SPACES                 TO OUT-COVERAGE-IND
  7911     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7912     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7913     MOVE CM-CARRIER             TO OUT-CARRIER
  7914     MOVE CM-GROUPING            TO OUT-GROUPING
  7915     MOVE CM-STATE               TO OUT-STATE
  7916     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7917     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7918     MOVE ' '                    TO DC-OPTION-CODE
  7919     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7920     IF NO-CONVERSION-ERROR
  7921        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7922           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7923              INTO OUT-CERT-EFF-DT
  7924        END-STRING
  7925     END-IF
  7926     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7927     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7928                                    OUT-ORIG-ILNAME
  7929     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7930     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7931                                    OUT-ORIG-MINIT
  7932     IF (CM-SSN-STATE = CM-STATE)
  7933        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7934        MOVE SPACES              TO OUT-SOC-SEC-NO
  7935     ELSE
  7936        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7937     END-IF
  7938     IF (CM-MEMB-STATE = CM-STATE)
  7939        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7940        MOVE SPACES              TO OUT-MEMBER-NO
  7941     ELSE
  7942        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7943     END-IF
  7944     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7945                                    OUT-ORIG-IFNAME
  7946     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7947                                    OUT-ORIG-IAGE
  7948     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7949     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7950                                    OUT-ORIG-JAGE
  7951     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7952                                    OUT-ORIG-JLNAME
  7953     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7954                                    OUT-ORIG-JFNAME
  7955     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7956                                    OUT-ORIG-JMINIT
  7957     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7958                                    OUT-ORIG-LF-BENCD
  7959     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 139
* NSRASBL.cbl
  7960                                    OUT-ORIG-LF-TERM
  7961     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7962     IF CM-LF-DEV-PCT NOT NUMERIC
  7963        MOVE ZEROS               TO CM-LF-DEV-PCT
  7964     END-IF
  7965     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7966     PERFORM 1160-READ-CERT-TRAILER THRU 1160-EXIT
  7967     IF NOT CERT-TRL-REC-NOT-FOUND
  7968         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
  7969             MOVE ZERO           TO OUT-IAGE
  7970                                    OUT-ORIG-IAGE
  7971         END-IF
  7972         IF CS-JNT-AGE-DEFAULT-FLAG = 'Y'
  7973             MOVE ZERO           TO OUT-JAGE
  7974                                    OUT-ORIG-JAGE
  7975         END-IF
  7976         MOVE CS-VIN-NUMBER      TO OUT-VIN-NUMBER
  7977     END-IF
  7978
  7979     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7980        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7981          ((CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES) OR
  7982           (CM-LF-DEATH-DT NOT = LOW-VALUES AND SPACES))
  7983             MOVE SPACES          TO OUT-LF-BENCD
  7984                                     WS-LF-BENCD
  7985                                     OUT-LF-CAN-DT
  7986             MOVE ZEROS           TO OUT-LF-TERM
  7987                                     OUT-LF-BEN
  7988                                     OUT-LF-PRM
  7989                                     OUT-LF-ALT-BEN
  7990                                     OUT-LF-ALT-PRM
  7991                                     OUT-LF-COMM-PCT
  7992                                     OUT-LF-NSP
  7993                                     OUT-LF-REM-BEN
  7994                                     WS-WORK-LF-PREM
  7995                                     WS-WORK-ALT-LF-PREM
  7996                                     WS-WORK-CMB-LF-PREM
  7997                                     OUT-LF-REF
  7998                                     OUT-ORIG-LF-REF
  7999                                     WS-WORK-LF-REF
  8000             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  8001             GO TO 1100-LF-CONT
  8002        END-IF
  8003     END-IF
  8004
  8005     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  8006        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8007             MOVE SPACES          TO OUT-LF-BENCD
  8008                                     WS-LF-BENCD
  8009                                     OUT-LF-CAN-DT
  8010             MOVE ZEROS           TO OUT-LF-TERM
  8011                                     OUT-LF-BEN
  8012                                     OUT-LF-PRM
  8013                                     OUT-LF-ALT-BEN
  8014                                     OUT-LF-ALT-PRM
  8015                                     OUT-LF-COMM-PCT
  8016                                     OUT-LF-NSP
  8017                                     OUT-LF-REM-BEN
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 140
* NSRASBL.cbl
  8018                                     WS-WORK-LF-PREM
  8019                                     WS-WORK-ALT-LF-PREM
  8020                                     WS-WORK-CMB-LF-PREM
  8021                                     OUT-LF-REF
  8022                                     OUT-ORIG-LF-REF
  8023                                     WS-WORK-LF-REF
  8024             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  8025             GO TO 1100-LF-CONT
  8026        END-IF
  8027     END-IF
  8028     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  8029         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  8030                                    OUT-ORIG-COVERAGE-IND
  8031     END-IF
  8032
  8033     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  8034     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  8035                                    OUT-ORIG-LF-BEN
  8036     IF CM-LF-BENEFIT-AMT = 999999999.99
  8037        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
  8038     END-IF
  8039     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  8040                                    OUT-ORIG-LF-PRM
  8041                                    WS-WORK-LF-PREM
  8042     IF CM-LF-PREMIUM-AMT = .01
  8043         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
  8044     END-IF
  8045     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  8046        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  8047     END-IF
  8048     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  8049                                    OUT-ORIG-LF-ALT-BEN
  8050     IF CM-LF-ALT-BENEFIT-AMT = 999999999.99
  8051        MOVE SPACES              TO OUT-ORIG-LF-ALT-BEN-A
  8052     END-IF
  8053     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  8054        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  8055     END-IF
  8056     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  8057                                    OUT-ORIG-LF-ALT-PRM
  8058                                    WS-WORK-ALT-LF-PREM
  8059     IF CM-LF-ALT-PREMIUM-AMT = .01
  8060         MOVE SPACES             TO OUT-ORIG-LF-ALT-PRM-A
  8061     END-IF
  8062     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  8063                             CM-LF-ALT-PREMIUM-AMT
  8064     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  8065                                 OUT-ORIG-LF-CMB-PREM
  8066                                 WS-WORK-CMB-LF-PREM
  8067     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  8068        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  8069     END-IF
  8070     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  8071     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  8072     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  8073                                    OUT-ORIG-LF-REF
  8074                                    WS-WORK-LF-REF
  8075     IF CM-LF-DEATH-CLAIM-APPLIED
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 141
* NSRASBL.cbl
  8076        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  8077            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  8078                                    OUT-ORIG-LF-REF
  8079                                    WS-WORK-LF-REF
  8080     END-IF
  8081     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  8082     MOVE ' '                    TO DC-OPTION-CODE
  8083     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8084     IF NO-CONVERSION-ERROR
  8085        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8086           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8087              INTO OUT-LF-CAN-DT
  8088        END-STRING
  8089     END-IF
  8090
  8091     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8092         MOVE ZEROS          TO WS-WORK-LF-PREM
  8093                                WS-WORK-ALT-LF-PREM
  8094                                WS-WORK-CMB-LF-PREM
  8095     END-IF
  8096
  8097      .
  8098 1100-LF-CONT.
  8099
  8100     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  8101     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  8102        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  8103     END-IF
  8104     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  8105     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  8106        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  8107     END-IF
  8108     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  8109     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8110        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  8111          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8112              MOVE SPACES              TO OUT-AH-BENCD
  8113                                          WS-AH-BENCD
  8114                                          OUT-AH-CAN-DT
  8115              MOVE ZEROS               TO OUT-AH-TERM
  8116                                          OUT-AH-BEN
  8117                                          OUT-AH-PRM
  8118                                          OUT-AH-NSP
  8119                                          OUT-AH-COMM-PCT
  8120                                          OUT-CRIT-PER
  8121                                          WS-WORK-AH-PREM
  8122                                          OUT-AH-REF
  8123                                          OUT-ORIG-AH-REF
  8124                                          WS-WORK-AH-REF
  8125              MOVE SPACES              TO OUT-MAX-PMTS-A
  8126                                          OUT-WAIT-PER
  8127                                          OUT-RET-ELIM
  8128                                          OUT-AH-DESC
  8129                                          OUT-BEN-DAYS
  8130              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8131             GO TO 1100-AH-CONT
  8132        END-IF
  8133     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 142
* NSRASBL.cbl
  8134
  8135     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  8136        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8137              MOVE SPACES              TO OUT-AH-BENCD
  8138                                          WS-AH-BENCD
  8139                                          OUT-AH-CAN-DT
  8140              MOVE ZEROS               TO OUT-AH-TERM
  8141                                          OUT-AH-BEN
  8142                                          OUT-AH-PRM
  8143                                          OUT-AH-NSP
  8144                                          OUT-AH-COMM-PCT
  8145                                          OUT-CRIT-PER
  8146                                          WS-WORK-AH-PREM
  8147                                          OUT-AH-REF
  8148                                          OUT-ORIG-AH-REF
  8149                                          WS-WORK-AH-REF
  8150              MOVE SPACES              TO OUT-MAX-PMTS-A
  8151                                          OUT-WAIT-PER
  8152                                          OUT-RET-ELIM
  8153                                          OUT-AH-DESC
  8154                                          OUT-BEN-DAYS
  8155              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8156             GO TO 1100-AH-CONT
  8157        END-IF
  8158     END-IF
  8159     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  8160     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  8161                                    OUT-ORIG-AH-BENCD
  8162     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  8163        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  8164           CM-AH-BENEFIT-AMT
  8165        IF OUT-COVERAGE-IND = 'LIFE'
  8166            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  8167                                    OUT-ORIG-COVERAGE-IND
  8168        ELSE
  8169            MOVE 'AH  '          TO OUT-COVERAGE-IND
  8170                                    OUT-ORIG-COVERAGE-IND
  8171        END-IF
  8172     ELSE
  8173        MOVE ZEROS               TO OUT-AH-TOT-BEN
  8174     END-IF
  8175     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  8176                                    OUT-ORIG-AH-TERM
  8177     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  8178                                    OUT-ORIG-CRIT-PER
  8179                                    OUT-MAX-PMTS
  8180                                    OUT-ORIG-MAX-PMTS
  8181     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  8182         MOVE SPACES             TO OUT-MAX-PMTS-A
  8183     END-IF
  8184     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  8185     IF CM-AH-DEV-PCT NOT NUMERIC
  8186        MOVE ZEROS               TO CM-AH-DEV-PCT
  8187     END-IF
  8188     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  8189     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  8190                                    OUT-ORIG-AH-BEN
  8191     IF CM-AH-BENEFIT-AMT = 9999999.99
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 143
* NSRASBL.cbl
  8192        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  8193     END-IF
  8194     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  8195                                    OUT-ORIG-AH-PRM
  8196                                    WS-WORK-AH-PREM
  8197     IF CM-AH-PREMIUM-AMT = .01
  8198         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
  8199     END-IF
  8200     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  8201     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  8202                                    OUT-ORIG-AH-REF
  8203                                    WS-WORK-AH-REF
  8204     IF CM-AH-DEATH-CLAIM-APPLIED
  8205        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  8206            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  8207                                    OUT-ORIG-AH-REF
  8208                                    WS-WORK-AH-REF
  8209     END-IF
  8210     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  8211     MOVE ' '                    TO DC-OPTION-CODE
  8212     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8213     IF NO-CONVERSION-ERROR
  8214        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8215           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8216              INTO OUT-AH-CAN-DT
  8217        END-STRING
  8218     END-IF
  8219
  8220     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8221         MOVE ZEROS          TO WS-WORK-AH-PREM
  8222     END-IF
  8223
  8224      .
  8225 1100-AH-CONT.
  8226
  8227     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  8228     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  8229     MOVE ' '                    TO DC-OPTION-CODE
  8230     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8231     IF NO-CONVERSION-ERROR
  8232        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8233           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8234              INTO OUT-AH-PDTHRU-DT
  8235        END-STRING
  8236     END-IF
  8237     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  8238        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  8239     END-IF
  8240     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  8241     IF CM-LOAN-APR NOT NUMERIC
  8242        MOVE ZEROS               TO CM-LOAN-APR
  8243     END-IF
  8244     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  8245     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  8246     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  8247     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  8248     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  8249     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 144
* NSRASBL.cbl
  8250     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  8251     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  8252     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  8253     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  8254     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8255     MOVE ' '                    TO DC-OPTION-CODE
  8256     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8257     IF NO-CONVERSION-ERROR
  8258        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8259           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8260              INTO OUT-LF-EXP-DT
  8261        END-STRING
  8262     END-IF
  8263     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  8264     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8265     MOVE ' '                    TO DC-OPTION-CODE
  8266     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8267     IF NO-CONVERSION-ERROR
  8268        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8269           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8270              INTO OUT-AH-EXP-DT
  8271        END-STRING
  8272     END-IF
  8273     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  8274     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  8275     MOVE ' '                    TO DC-OPTION-CODE
  8276     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8277     IF NO-CONVERSION-ERROR
  8278        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8279           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8280              INTO OUT-1ST-PMT-DT
  8281        END-STRING
  8282     END-IF
  8283     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  8284     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  8285     MOVE ' '                    TO DC-OPTION-CODE
  8286     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8287     IF NO-CONVERSION-ERROR
  8288        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8289           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8290              INTO OUT-ENTRY-DT
  8291        END-STRING
  8292     END-IF
  8293     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8294     MOVE ' '                    TO DC-OPTION-CODE
  8295     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8296     IF NO-CONVERSION-ERROR
  8297        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8298           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8299              INTO OUT-LF-CAN-EXIT-DT
  8300        END-STRING
  8301     END-IF
  8302     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  8303     MOVE ' '                    TO DC-OPTION-CODE
  8304     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8305     IF NO-CONVERSION-ERROR
  8306        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8307           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 145
* NSRASBL.cbl
  8308              INTO OUT-LF-DTH-DT
  8309        END-STRING
  8310     END-IF
  8311     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  8312     MOVE ' '                    TO DC-OPTION-CODE
  8313     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8314     IF NO-CONVERSION-ERROR
  8315        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8316           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8317              INTO OUT-LF-DTH-EXIT-DT
  8318        END-STRING
  8319     END-IF
  8320     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  8321     IF OUT-AH-CAN-DT NOT = SPACES
  8322        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  8323     ELSE
  8324        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  8325     END-IF
  8326     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8327     MOVE ' '                    TO DC-OPTION-CODE
  8328     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8329     IF NO-CONVERSION-ERROR
  8330        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8331           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8332              INTO OUT-AH-CAN-EXIT-DT
  8333        END-STRING
  8334     END-IF
  8335     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  8336     IF CM-ENTRY-BATCH = LOW-VALUES
  8337        MOVE SPACES              TO CM-ENTRY-BATCH
  8338     END-IF
  8339     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  8340     IF CM-LF-EXIT-BATCH = LOW-VALUES
  8341        MOVE SPACES              TO CM-LF-EXIT-BATCH
  8342     END-IF
  8343     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  8344     IF CM-AH-EXIT-BATCH = LOW-VALUES
  8345        MOVE SPACES              TO CM-AH-EXIT-BATCH
  8346     END-IF
  8347     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  8348     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  8349     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  8350     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  8351     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  8352     COMPUTE WS-WORK-PREM =
  8353        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  8354           + CM-AH-PREMIUM-AMT)
  8355     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  8356                                    OUT-ORIG-TOT-PREM
  8357     COMPUTE WS-WORK-REF =
  8358        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  8359     MOVE WS-WORK-REF            TO OUT-TOT-REF
  8360                                    OUT-ORIG-TOT-REF
  8361     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  8362        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  8363     ELSE
  8364        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  8365     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 146
* NSRASBL.cbl
  8366     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  8367     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  8368        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  8369     ELSE
  8370        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  8371     END-IF
  8372     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  8373     IF CM-INT-ON-REFS NUMERIC
  8374        IF CM-INT-ON-REFS NOT = ZEROS
  8375           MOVE CM-INT-ON-REFS   TO OUT-TOT-INTEREST
  8376        END-IF
  8377     END-IF
  8378
  8379     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8380        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8381            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8382        END-IF
  8383        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8384            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8385        END-IF
  8386     END-IF
  8387*
  8388*     IF BL-DATA-SRCE = '2'
  8389*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8390*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8391*        END-IF
  8392*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8393*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8394*        END-IF
  8395*     END-IF
  8396
  8397     COMPUTE WS-ACCT-LF-PORTION =
  8398        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  8399     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  8400                                OUT-ACCT-ORIG-LF-PORT
  8401     COMPUTE WS-ACCT-ALT-LF-PORTION =
  8402        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  8403     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  8404                                OUT-ACCT-ORIG-ALT-LF-PORT
  8405     COMPUTE WS-ACCT-CMB-LF-PORTION =
  8406        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  8407     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  8408                                OUT-ACCT-ORIG-CMB-LF-PORT
  8409     COMPUTE WS-ACCT-AH-PORTION =
  8410        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  8411     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  8412                                OUT-ACCT-ORIG-AH-PORT
  8413     COMPUTE WS-ACCT-PORTION =
  8414        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  8415     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  8416                                OUT-ACCT-ORIG-PORTION
  8417
  8418     COMPUTE WS-CSO-LF-PORTION =
  8419       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  8420     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  8421                               OUT-CSO-ORIG-LF-PORT
  8422     COMPUTE WS-CSO-ALT-LF-PORTION =
  8423       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 147
* NSRASBL.cbl
  8424     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  8425                                   OUT-CSO-ORIG-ALT-LF-PORT
  8426     COMPUTE WS-CSO-CMB-LF-PORTION =
  8427       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  8428     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  8429                                   OUT-CSO-ORIG-CMB-LF-PORT
  8430     COMPUTE WS-CSO-AH-PORTION =
  8431        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  8432     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  8433                               OUT-CSO-ORIG-AH-PORT
  8434     COMPUTE WS-CSO-PORTION =
  8435        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  8436     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  8437                            OUT-CSO-ORIG-PORTION
  8438     .
  8439 1110-EXIT.
  8440     EXIT.
  8441 1115-MATCH-COMPANY.
  8442     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8443     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8444     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8445
  8446* EXEC CICS READ
  8447*       INTO    (CONTROL-FILE)
  8448*       DATASET ('ELCNTL')
  8449*       RIDFLD  (WS-ELCNTL-KEY)
  8450*       RESP    (WS-RESPONSE)
  8451*    END-EXEC
  8452     MOVE LENGTH OF
  8453      CONTROL-FILE
  8454       TO DFHEIV11
  8455     MOVE 'ELCNTL' TO DFHEIV1
  8456*    MOVE '&"IL       E          (  N#00008170' TO DFHEIV0
  8457     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8459     MOVE X'204E233030303038313730' TO DFHEIV0(25:11)
  8460     CALL 'kxdfhei1' USING DFHEIV0,
  8461           DFHEIV1,
  8462           CONTROL-FILE,
  8463           DFHEIV11,
  8464           WS-ELCNTL-KEY,
  8465           DFHEIV99,
  8466           DFHEIV99,
  8467           DFHEIV99
  8468     MOVE EIBRESP  TO WS-RESPONSE
  8469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8470     IF RESP-NORMAL
  8471        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  8472     END-IF
  8473     .
  8474 1115-EXIT.
  8475     EXIT.
  8476 1120-MATCH-CARRIER.
  8477     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8478     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  8479     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  8480     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8481
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 148
* NSRASBL.cbl
  8482* EXEC CICS READ
  8483*       INTO    (CONTROL-FILE)
  8484*       DATASET ('ELCNTL')
  8485*       RIDFLD  (WS-ELCNTL-KEY)
  8486*       RESP    (WS-RESPONSE)
  8487*    END-EXEC
  8488     MOVE LENGTH OF
  8489      CONTROL-FILE
  8490       TO DFHEIV11
  8491     MOVE 'ELCNTL' TO DFHEIV1
  8492*    MOVE '&"IL       E          (  N#00008187' TO DFHEIV0
  8493     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8494     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8495     MOVE X'204E233030303038313837' TO DFHEIV0(25:11)
  8496     CALL 'kxdfhei1' USING DFHEIV0,
  8497           DFHEIV1,
  8498           CONTROL-FILE,
  8499           DFHEIV11,
  8500           WS-ELCNTL-KEY,
  8501           DFHEIV99,
  8502           DFHEIV99,
  8503           DFHEIV99
  8504     MOVE EIBRESP  TO WS-RESPONSE
  8505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8506     IF RESP-NORMAL
  8507        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  8508     ELSE
  8509        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  8510     END-IF
  8511     .
  8512 1120-EXIT.
  8513     EXIT.
  8514 1125-MATCH-STATE.
  8515     MOVE BL-STATE               TO OUT-STATE
  8516     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8517     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  8518     MOVE BL-STATE               TO WS-ELCNTL-STATE
  8519     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8520
  8521* EXEC CICS READ
  8522*       INTO    (CONTROL-FILE)
  8523*       DATASET ('ELCNTL')
  8524*       RIDFLD  (WS-ELCNTL-KEY)
  8525*       RESP    (WS-RESPONSE)
  8526*    END-EXEC
  8527     MOVE LENGTH OF
  8528      CONTROL-FILE
  8529       TO DFHEIV11
  8530     MOVE 'ELCNTL' TO DFHEIV1
  8531*    MOVE '&"IL       E          (  N#00008207' TO DFHEIV0
  8532     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8533     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8534     MOVE X'204E233030303038323037' TO DFHEIV0(25:11)
  8535     CALL 'kxdfhei1' USING DFHEIV0,
  8536           DFHEIV1,
  8537           CONTROL-FILE,
  8538           DFHEIV11,
  8539           WS-ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 149
* NSRASBL.cbl
  8540           DFHEIV99,
  8541           DFHEIV99,
  8542           DFHEIV99
  8543     MOVE EIBRESP  TO WS-RESPONSE
  8544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8545     IF RESP-NORMAL
  8546        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  8547     ELSE
  8548        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  8549     END-IF
  8550     .
  8551 1125-EXIT.
  8552     EXIT.
  8553 1130-MATCH-BENCDS.
  8554     MOVE SPACES                 TO WS-LF-ABBRV
  8555                                    WS-LF-DESC
  8556                                    WS-LF-EARN
  8557                                    WS-WAIT-PER
  8558                                    WS-RET-ELIM
  8559                                    WS-AH-DESC
  8560                                    WS-BEN-DAYS
  8561     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  8562        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  8563     END-IF
  8564     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  8565        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  8566     END-IF
  8567     .
  8568 1130-EXIT.
  8569     EXIT.
  8570 1140-MATCH-LFBEN.
  8571     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8572     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  8573     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  8574     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8575
  8576* EXEC CICS READ
  8577*       INTO    (CONTROL-FILE)
  8578*       DATASET ('ELCNTL')
  8579*       RIDFLD  (WS-ELCNTL-KEY)
  8580*       GTEQ
  8581*       RESP    (WS-RESPONSE)
  8582*    END-EXEC
  8583     MOVE LENGTH OF
  8584      CONTROL-FILE
  8585       TO DFHEIV11
  8586     MOVE 'ELCNTL' TO DFHEIV1
  8587*    MOVE '&"IL       G          (  N#00008243' TO DFHEIV0
  8588     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8590     MOVE X'204E233030303038323433' TO DFHEIV0(25:11)
  8591     CALL 'kxdfhei1' USING DFHEIV0,
  8592           DFHEIV1,
  8593           CONTROL-FILE,
  8594           DFHEIV11,
  8595           WS-ELCNTL-KEY,
  8596           DFHEIV99,
  8597           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 150
* NSRASBL.cbl
  8598           DFHEIV99
  8599     MOVE EIBRESP  TO WS-RESPONSE
  8600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8601     IF RESP-NORMAL
  8602        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8603           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8604           OR (S1 > +8)
  8605        END-PERFORM
  8606        IF S1 < + 9
  8607           MOVE CF-BENEFIT-ALPHA (S1)
  8608                                 TO WS-LF-ABBRV
  8609           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8610           MOVE CF-CO-EARNINGS-CALC (S1)
  8611                                 TO WS-LF-EARN
  8612        ELSE
  8613           MOVE 'XX'             TO WS-LF-DESC
  8614           MOVE 'XXX'            TO WS-LF-ABBRV
  8615        END-IF
  8616     ELSE
  8617        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  8618     END-IF
  8619     .
  8620 1140-EXIT.
  8621     EXIT.
  8622 1150-MATCH-AHBEN.
  8623     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8624     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8625     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8626     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8627
  8628* EXEC CICS READ
  8629*       INTO    (CONTROL-FILE)
  8630*       DATASET ('ELCNTL')
  8631*       RIDFLD  (WS-ELCNTL-KEY)
  8632*       GTEQ
  8633*       RESP    (WS-RESPONSE)
  8634*    END-EXEC
  8635     MOVE LENGTH OF
  8636      CONTROL-FILE
  8637       TO DFHEIV11
  8638     MOVE 'ELCNTL' TO DFHEIV1
  8639*    MOVE '&"IL       G          (  N#00008276' TO DFHEIV0
  8640     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8641     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8642     MOVE X'204E233030303038323736' TO DFHEIV0(25:11)
  8643     CALL 'kxdfhei1' USING DFHEIV0,
  8644           DFHEIV1,
  8645           CONTROL-FILE,
  8646           DFHEIV11,
  8647           WS-ELCNTL-KEY,
  8648           DFHEIV99,
  8649           DFHEIV99,
  8650           DFHEIV99
  8651     MOVE EIBRESP  TO WS-RESPONSE
  8652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8653     IF RESP-NORMAL
  8654        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8655           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 151
* NSRASBL.cbl
  8656           OR (S1 > +8)
  8657        END-PERFORM
  8658        IF S1 < + 9
  8659           MOVE CF-BENEFIT-ALPHA (S1)
  8660                                 TO WS-WAIT-PER
  8661           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8662                                 TO WS-RET-ELIM
  8663           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8664                                 TO WS-BEN-DAYS
  8665           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8666              IF CF-JOINT-INDICATOR (S1) = 'J'
  8667                 MOVE 'Joint Critical Period Disability'
  8668                                 TO WS-AH-DESC
  8669              ELSE
  8670                 MOVE 'Single Critical Period-Primary Only'
  8671                                 TO WS-AH-DESC
  8672              END-IF
  8673           ELSE
  8674              IF CF-JOINT-INDICATOR (S1) = 'J'
  8675                 MOVE 'Joint Disability'
  8676                                 TO WS-AH-DESC
  8677              ELSE
  8678                 MOVE 'Single Disability (Primary Only)'
  8679                                 TO WS-AH-DESC
  8680              END-IF
  8681           END-IF
  8682        ELSE
  8683           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8684        END-IF
  8685     ELSE
  8686        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8687     END-IF
  8688     .
  8689 1150-EXIT.
  8690     EXIT.
  8691
  8692 1160-READ-CERT-TRAILER.
  8693
  8694     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
  8695     MOVE WS-ELCERT-KEY          TO  WS-ELCRTT-PRIMARY.
  8696     MOVE 'C'                    TO  WS-ELCRTT-REC-TYPE.
  8697
  8698
  8699* EXEC CICS HANDLE CONDITION
  8700*        NOTFND (1160-CERT-TRL-REC-NOTFND)
  8701*    END-EXEC.
  8702*    MOVE '"$I                   ! " #00008328' TO DFHEIV0
  8703     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8704     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8705     MOVE X'2220233030303038333238' TO DFHEIV0(25:11)
  8706     CALL 'kxdfhei1' USING DFHEIV0
  8707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8708
  8709
  8710
  8711* EXEC CICS READ
  8712*        DATASET  ('ELCRTT')
  8713*        RIDFLD   (WS-ELCRTT-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 152
* NSRASBL.cbl
  8714*        INTO     (CERTIFICATE-TRAILERS)
  8715*    END-EXEC.
  8716     MOVE LENGTH OF
  8717      CERTIFICATE-TRAILERS
  8718       TO DFHEIV11
  8719     MOVE 'ELCRTT' TO DFHEIV1
  8720*    MOVE '&"IL       E          (   #00008332' TO DFHEIV0
  8721     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8722     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8723     MOVE X'2020233030303038333332' TO DFHEIV0(25:11)
  8724     CALL 'kxdfhei1' USING DFHEIV0,
  8725           DFHEIV1,
  8726           CERTIFICATE-TRAILERS,
  8727           DFHEIV11,
  8728           WS-ELCRTT-KEY,
  8729           DFHEIV99,
  8730           DFHEIV99,
  8731           DFHEIV99
  8732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8733
  8734
  8735     GO TO 1160-EXIT.
  8736
  8737 1160-CERT-TRL-REC-NOTFND.
  8738     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
  8739
  8740 1160-EXIT.
  8741     EXIT.
  8742 1200-GET-ERACCT.
  8743     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8744     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8745                                    OUT-ACCT-ADDR1
  8746                                    OUT-ACCT-ADDR2
  8747                                    OUT-ACCT-CITY
  8748     MOVE ZEROS                  TO WS-CHGBACK
  8749
  8750* EXEC CICS STARTBR
  8751*        DATASET   ('ERACCT')
  8752*        RIDFLD    (WS-ERACCT-KEY)
  8753*        GTEQ
  8754*        RESP      (WS-RESPONSE)
  8755*    END-EXEC
  8756     MOVE 'ERACCT' TO DFHEIV1
  8757     MOVE 0
  8758       TO DFHEIV11
  8759*    MOVE '&,         G          &  N#00008352' TO DFHEIV0
  8760     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8761     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8762     MOVE X'204E233030303038333532' TO DFHEIV0(25:11)
  8763     CALL 'kxdfhei1' USING DFHEIV0,
  8764           DFHEIV1,
  8765           WS-ERACCT-KEY,
  8766           DFHEIV99,
  8767           DFHEIV11,
  8768           DFHEIV99
  8769     MOVE EIBRESP  TO WS-RESPONSE
  8770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8771     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 153
* NSRASBL.cbl
  8772
  8773* EXEC CICS READNEXT
  8774*          INTO    (ACCOUNT-MASTER)
  8775*          DATASET ('ERACCT')
  8776*          RIDFLD  (WS-ERACCT-KEY)
  8777*          RESP    (WS-RESPONSE)
  8778*       END-EXEC
  8779     MOVE LENGTH OF
  8780      ACCOUNT-MASTER
  8781       TO DFHEIV12
  8782     MOVE 'ERACCT' TO DFHEIV1
  8783     MOVE 0
  8784       TO DFHEIV11
  8785*    MOVE '&.IL                  )  N#00008359' TO DFHEIV0
  8786     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8787     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8788     MOVE X'204E233030303038333539' TO DFHEIV0(25:11)
  8789     CALL 'kxdfhei1' USING DFHEIV0,
  8790           DFHEIV1,
  8791           ACCOUNT-MASTER,
  8792           DFHEIV12,
  8793           WS-ERACCT-KEY,
  8794           DFHEIV99,
  8795           DFHEIV11,
  8796           DFHEIV99,
  8797           DFHEIV99
  8798     MOVE EIBRESP  TO WS-RESPONSE
  8799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8800     END-IF
  8801     IF RESP-NORMAL
  8802        PERFORM UNTIL
  8803           NOT (RESP-NORMAL)
  8804           OR (WS-SAVE-ERACCT-KEY NOT =
  8805                        AM-CONTROL-PRIMARY (1:20))
  8806           IF BL-DATA-SRCE = '4' OR '2'
  8807              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8808                 AND >= AM-EFFECTIVE-DT)
  8809                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8810                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8811                    OR (S1 > +10)
  8812                 END-PERFORM
  8813                 IF S1 < +11
  8814                    MOVE AM-COMM-CHARGEBACK (S1)
  8815                                 TO WS-CHGBACK
  8816                 END-IF
  8817              END-IF
  8818           END-IF
  8819           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8820
  8821* EXEC CICS READNEXT
  8822*             INTO    (ACCOUNT-MASTER)
  8823*             DATASET ('ERACCT')
  8824*             RIDFLD  (WS-ERACCT-KEY)
  8825*             RESP    (WS-RESPONSE)
  8826*          END-EXEC
  8827     MOVE LENGTH OF
  8828      ACCOUNT-MASTER
  8829       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 154
* NSRASBL.cbl
  8830     MOVE 'ERACCT' TO DFHEIV1
  8831     MOVE 0
  8832       TO DFHEIV11
  8833*    MOVE '&.IL                  )  N#00008385' TO DFHEIV0
  8834     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8835     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8836     MOVE X'204E233030303038333835' TO DFHEIV0(25:11)
  8837     CALL 'kxdfhei1' USING DFHEIV0,
  8838           DFHEIV1,
  8839           ACCOUNT-MASTER,
  8840           DFHEIV12,
  8841           WS-ERACCT-KEY,
  8842           DFHEIV99,
  8843           DFHEIV11,
  8844           DFHEIV99,
  8845           DFHEIV99
  8846     MOVE EIBRESP  TO WS-RESPONSE
  8847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8848        END-PERFORM
  8849        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8850        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8851           SET ACCT-FOUND TO TRUE
  8852           MOVE AM-NAME          TO OUT-ACCT-NAME
  8853           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8854           MOVE SPACES           TO OUT-ACCT-ADDR2
  8855           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8856           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8857           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8858           MOVE AM-CONTROL-NAME  TO OUT-ACCT-CNTRL-NAME
  8859           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8860           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8861           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8862              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8863                 INTO OUT-ACCT-ZIP (6:5)
  8864              END-STRING
  8865           END-IF
  8866           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8867           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8868           MOVE AM-STATE         TO OUT-FORM
  8869           IF AM-ACCOUNT (10:1) = 'L'
  8870              MOVE 'L'           TO OUT-FORM (3:1)
  8871                                    OUT-LEASE-IND
  8872           END-IF
  8873           MOVE AM-CONTROL-PRIMARY (1:8)
  8874                                 TO WS-ERCOMP-KEY
  8875           IF AM-REMIT-TO NOT NUMERIC
  8876              MOVE 01            TO AM-REMIT-TO
  8877           END-IF
  8878           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8879           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8880              (AM-COM-TYP (S1) = 'C' OR 'D')
  8881              OR (S1 > +10)
  8882           END-PERFORM
  8883           IF S1 < +11
  8884              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8885           END-IF
  8886           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8887           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 155
* NSRASBL.cbl
  8888        END-IF
  8889     END-IF
  8890
  8891* EXEC CICS ENDBR
  8892*        DATASET   ('ERACCT')
  8893*    END-EXEC
  8894     MOVE 'ERACCT' TO DFHEIV1
  8895     MOVE 0
  8896       TO DFHEIV11
  8897*    MOVE '&2                    $   #00008433' TO DFHEIV0
  8898     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8899     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8900     MOVE X'2020233030303038343333' TO DFHEIV0(25:11)
  8901     CALL 'kxdfhei1' USING DFHEIV0,
  8902           DFHEIV1,
  8903           DFHEIV11,
  8904           DFHEIV99
  8905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8906    .
  8907 1200-EXIT.
  8908     EXIT.
  8909 1225-GET-ERCOMP.
  8910
  8911* EXEC CICS READ
  8912*       INTO    (COMPENSATION-MASTER)
  8913*       DATASET ('ERCOMP')
  8914*       RIDFLD  (WS-ERCOMP-KEY)
  8915*       RESP    (WS-RESPONSE)
  8916*    END-EXEC
  8917     MOVE LENGTH OF
  8918      COMPENSATION-MASTER
  8919       TO DFHEIV11
  8920     MOVE 'ERCOMP' TO DFHEIV1
  8921*    MOVE '&"IL       E          (  N#00008440' TO DFHEIV0
  8922     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8923     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8924     MOVE X'204E233030303038343430' TO DFHEIV0(25:11)
  8925     CALL 'kxdfhei1' USING DFHEIV0,
  8926           DFHEIV1,
  8927           COMPENSATION-MASTER,
  8928           DFHEIV11,
  8929           WS-ERCOMP-KEY,
  8930           DFHEIV99,
  8931           DFHEIV99,
  8932           DFHEIV99
  8933     MOVE EIBRESP  TO WS-RESPONSE
  8934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8935     IF RESP-NORMAL
  8936        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8937        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8938        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8939        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8940        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8941        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8942        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8943        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8944        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8945        MOVE CO-FAXNO            TO OUT-COMP-FAX
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 156
* NSRASBL.cbl
  8946        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8947        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8948     END-IF
  8949     .
  8950 1225-EXIT.
  8951     EXIT.
  8952 1250-GET-ELLETR.
  8953     display ' made it to 1250 '
  8954     move spaces                 to W-Z-CONTROL-DATA
  8955     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8956     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8957     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8958
  8959* EXEC CICS READ
  8960*         DATASET    ('ELLETR')
  8961*         INTO       (TEXT-FILES)
  8962*         RIDFLD     (WS-ELLETR-KEY)
  8963*         RESP       (WS-RESPONSE)
  8964*         GTEQ
  8965*    END-EXEC
  8966     MOVE LENGTH OF
  8967      TEXT-FILES
  8968       TO DFHEIV11
  8969     MOVE 'ELLETR' TO DFHEIV1
  8970*    MOVE '&"IL       G          (  N#00008469' TO DFHEIV0
  8971     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8973     MOVE X'204E233030303038343639' TO DFHEIV0(25:11)
  8974     CALL 'kxdfhei1' USING DFHEIV0,
  8975           DFHEIV1,
  8976           TEXT-FILES,
  8977           DFHEIV11,
  8978           WS-ELLETR-KEY,
  8979           DFHEIV99,
  8980           DFHEIV99,
  8981           DFHEIV99
  8982     MOVE EIBRESP  TO WS-RESPONSE
  8983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8984     IF RESP-NORMAL
  8985        IF (LETTER-FILE-TEXT)
  8986           AND (BL-LETTER-ID = TX-LETTER-NO)
  8987           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8988           display ' found good z record '
  8989           PERFORM 1280-PROCESS-Z-CONTROLS
  8990                                 THRU 1280-EXIT
  8991        END-IF
  8992     END-IF
  8993     .
  8994 1250-EXIT.
  8995     EXIT.
  8996 1280-PROCESS-Z-CONTROLS.
  8997     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8998*    IF W-FORM-TO-RESEND > SPACES
  8999*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  9000*    ELSE
  9001*       MOVE SPACES              TO OUT-FORM
  9002*    END-IF
  9003     IF BL-ENC-CD = SPACES OR LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 157
* NSRASBL.cbl
  9004        MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  9005     END-IF
  9006     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  9007     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  9008     .
  9009 1280-EXIT.
  9010     EXIT.
  9011 1300-DETERMINE-COMM.
  9012******************************************************************
  9013* DATA SOURCE MEANINGS  BL-DATA-SRCE
  9014*    1) FROM ACCT MAINT
  9015*    2) FROM CERT UPDATE
  9016*    3) FROM COMP MAINT
  9017*    4) FROM REVIEW AND CORRECTIONS
  9018******************************************************************
  9019     MOVE 'Y'                    TO OUT-CHGBACK
  9020     MOVE ZEROS                  TO WS-DIFF
  9021                                    WS-CHGBK-LIFE-PCT
  9022                                    WS-CHGBK-AH-PCT
  9023     IF BL-DATA-SRCE = '4'
  9024        IF PB-CANCELLATION
  9025           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  9026           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  9027           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  9028           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  9029           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  9030              MOVE PB-C-LF-CANCEL-DT
  9031                                 TO DC-BIN-DATE-2
  9032           END-IF
  9033           MOVE '1'              TO DC-OPTION-CODE
  9034           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9035           IF NO-CONVERSION-ERROR
  9036              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  9037              IF DC-ODD-DAYS-OVER > +1
  9038                 ADD +1          TO WS-DIFF
  9039              END-IF
  9040              IF (WS-CHGBACK = 99)
  9041                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  9042                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  9043                                WS-CHGBK-AH-PCT
  9044                   MOVE 'N'  TO OUT-CHGBACK
  9045              END-IF
  9046           END-IF
  9047        ELSE
  9048           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  9049           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  9050        END-IF
  9051     ELSE
  9052        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  9053        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  9054        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  9055           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  9056           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9057           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  9058           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  9059              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  9060           END-IF
  9061           MOVE '1'              TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 158
* NSRASBL.cbl
  9062           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9063           IF NO-CONVERSION-ERROR
  9064              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  9065              IF DC-ODD-DAYS-OVER > +1
  9066                 ADD +1          TO WS-DIFF
  9067              END-IF
  9068              IF (WS-CHGBACK = 99)
  9069                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  9070                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  9071                                WS-CHGBK-AH-PCT
  9072                   MOVE 'N'  TO OUT-CHGBACK
  9073              END-IF
  9074           END-IF
  9075        END-IF
  9076     END-IF
  9077     .
  9078 1300-EXIT.
  9079     EXIT.
  9080 1500-GET-ARCH-NO.
  9081     DISPLAY ' MADE IT TO 1500 '
  9082     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  9083     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  9084     MOVE SPACES                 TO WS-ELCNTL-GENL
  9085     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  9086
  9087* EXEC CICS READ
  9088*       INTO    (CONTROL-FILE)
  9089*       DATASET ('ELCNTL')
  9090*       RIDFLD  (WS-ELCNTL-KEY)
  9091*       UPDATE
  9092*       RESP    (WS-RESPONSE)
  9093*    END-EXEC
  9094     MOVE LENGTH OF
  9095      CONTROL-FILE
  9096       TO DFHEIV11
  9097     MOVE 'ELCNTL' TO DFHEIV1
  9098*    MOVE '&"IL       EU         (  N#00008578' TO DFHEIV0
  9099     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9100     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9101     MOVE X'204E233030303038353738' TO DFHEIV0(25:11)
  9102     CALL 'kxdfhei1' USING DFHEIV0,
  9103           DFHEIV1,
  9104           CONTROL-FILE,
  9105           DFHEIV11,
  9106           WS-ELCNTL-KEY,
  9107           DFHEIV99,
  9108           DFHEIV99,
  9109           DFHEIV99
  9110     MOVE EIBRESP  TO WS-RESPONSE
  9111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9112     IF RESP-NORMAL
  9113        AND (CF-COMPANY-ID  = BL-COMP-ID)
  9114        AND (CF-RECORD-TYPE = '1')
  9115        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  9116        MOVE CF-CREDIT-LAST-ARCH-NUM
  9117                                 TO WS-ARCHIVE-NO
  9118
  9119* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 159
* NSRASBL.cbl
  9120*          FROM    (CONTROL-FILE)
  9121*          DATASET ('ELCNTL')
  9122*       END-EXEC
  9123     MOVE LENGTH OF
  9124      CONTROL-FILE
  9125       TO DFHEIV11
  9126     MOVE 'ELCNTL' TO DFHEIV1
  9127*    MOVE '&& L                  %   #00008591' TO DFHEIV0
  9128     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9129     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9130     MOVE X'2020233030303038353931' TO DFHEIV0(25:11)
  9131     CALL 'kxdfhei1' USING DFHEIV0,
  9132           DFHEIV1,
  9133           CONTROL-FILE,
  9134           DFHEIV11,
  9135           DFHEIV99
  9136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9137     ELSE
  9138        MOVE +0                  TO WS-ARCHIVE-NO
  9139     END-IF
  9140    .
  9141 1500-EXIT.
  9142     EXIT.
  9143 1700-GET-ELENCC.
  9144     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  9145     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  9146     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  9147     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  9148        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  9149        OR (E1 > +5)
  9150     END-PERFORM
  9151     IF E1 < +5
  9152        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  9153     END-IF
  9154
  9155* EXEC CICS READ
  9156*        DATASET   ('ELENCC')
  9157*        INTO      (ENCLOSURE-CODES)
  9158*        RIDFLD    (WS-ELENCC-KEY)
  9159*        RESP      (WS-RESPONSE)
  9160*    END-EXEC
  9161     MOVE LENGTH OF
  9162      ENCLOSURE-CODES
  9163       TO DFHEIV11
  9164     MOVE 'ELENCC' TO DFHEIV1
  9165*    MOVE '&"IL       E          (  N#00008612' TO DFHEIV0
  9166     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9167     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9168     MOVE X'204E233030303038363132' TO DFHEIV0(25:11)
  9169     CALL 'kxdfhei1' USING DFHEIV0,
  9170           DFHEIV1,
  9171           ENCLOSURE-CODES,
  9172           DFHEIV11,
  9173           WS-ELENCC-KEY,
  9174           DFHEIV99,
  9175           DFHEIV99,
  9176           DFHEIV99
  9177     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 160
* NSRASBL.cbl
  9178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9179     IF NOT RESP-NORMAL
  9180        display ' elencc resp not normal ' ws-response
  9181        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  9182
  9183* EXEC CICS READ
  9184*           DATASET   ('ELENCC')
  9185*           INTO      (ENCLOSURE-CODES)
  9186*           RIDFLD    (WS-ELENCC-KEY)
  9187*           RESP      (WS-RESPONSE)
  9188*       END-EXEC
  9189     MOVE LENGTH OF
  9190      ENCLOSURE-CODES
  9191       TO DFHEIV11
  9192     MOVE 'ELENCC' TO DFHEIV1
  9193*    MOVE '&"IL       E          (  N#00008621' TO DFHEIV0
  9194     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9195     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9196     MOVE X'204E233030303038363231' TO DFHEIV0(25:11)
  9197     CALL 'kxdfhei1' USING DFHEIV0,
  9198           DFHEIV1,
  9199           ENCLOSURE-CODES,
  9200           DFHEIV11,
  9201           WS-ELENCC-KEY,
  9202           DFHEIV99,
  9203           DFHEIV99,
  9204           DFHEIV99
  9205     MOVE EIBRESP  TO WS-RESPONSE
  9206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9207     END-IF
  9208     IF RESP-NORMAL
  9209        display ' elencc resp normal ' ws-response
  9210        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  9211        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  9212        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  9213     END-IF
  9214     .
  9215 1700-EXIT.
  9216     EXIT.
  9217
  9218
  9219 4100-CONNECT-TO-DB.
  9220
  9221     IF SVR > SPACES
  9222        CONTINUE
  9223     ELSE
  9224        MOVE 'NTCSO2_LOGIC'         TO SVR
  9225        MOVE 'sa'                   TO USR
  9226        MOVE 'ntcso2'               TO PASS
  9227     END-IF
  9228
  9229     STRING
  9230         USR DELIMITED SPACE
  9231         "." DELIMITED SIZE
  9232         PASS DELIMITED SPACE INTO USR-PASS
  9233     END-STRING
  9234
  9235     EXEC SQL
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 161
* NSRASBL.cbl
  9236        CONNECT TO :SVR USER :USR-PASS
  9237     END-EXEC
  9238
  9239     IF SQLCODE NOT = 0
  9240        DISPLAY "ERROR: CANNOT CONNECT "
  9241        DISPLAY SQLCODE
  9242        DISPLAY SQLERRMC
  9243        GO TO 4100-EXIT
  9244     END-IF
  9245
  9246     .
  9247 4100-EXIT.
  9248     EXIT.
  9249
  9250
  9251
  9252 4200-GET-NEXT-BUS-DT.
  9253
  9254     MOVE WS-SAVE-EDIT-A-DATE    TO WS-CYCLE-DATE
  9255     MOVE SPACES                 TO WS-NEXT-BUS-DT
  9256
  9257     IF WS-KIXHOST = 'logictest'
  9258        EXEC SQL
  9259          CALL NaperTestCalcNextBusDt
  9260                        @cycledate = :WS-CYCLE-DATE,
  9261                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9262        END-EXEC
  9263     ELSE
  9264        EXEC SQL
  9265          CALL NaperProdCalcNextBusDt
  9266                        @cycledate = :WS-CYCLE-DATE,
  9267                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9268        END-EXEC
  9269     END-IF
  9270
  9271     IF SQLCODE NOT = 0
  9272        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
  9273        DISPLAY ' SQL RETURN CODE ' SQLCODE
  9274        DISPLAY ' SQL ERR MESS    ' SQLERRMC
  9275        GO TO 4200-EXIT
  9276     END-IF
  9277
  9278     .
  9279 4200-EXIT.
  9280     EXIT.
  9281
  9282
  9283
  9284 4300-DISCONNECT.
  9285
  9286     EXEC SQL
  9287        DISCONNECT
  9288     END-EXEC
  9289     .
  9290 4300-EXIT.
  9291     EXIT.
  9292
  9293
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 162
* NSRASBL.cbl
  9294 4500-CHECK-BALLOON-STATE.
  9295
  9296     MOVE 'naperadmin'           TO USR
  9297     MOVE 'cCm8naper'            TO PASS
  9298     IF WS-KIXHOST = 'logictest'
  9299        MOVE 'HOVTSTDB01_NaperRepo'
  9300                                 TO SVR
  9301        MOVE '1011'              TO WS-LOOKUPID
  9302     ELSE
  9303        MOVE 'SDVDB01_NaperRepo' TO SVR
  9304        MOVE '1020'              TO WS-LOOKUPID
  9305     END-IF
  9306
  9307     MOVE SPACES                 TO WS-LOOKUP-VALUE
  9308
  9309     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
  9310     MOVE CM-STATE TO WS-LOOKUPKEY
  9311     MOVE 'B'      TO WS-LOOKUPKEY (3:1)
  9312
  9313     EXEC SQL
  9314           SELECT LOOKUPVALUE
  9315             INTO :WS-LOOKUP-VALUE
  9316             FROM LOOKUPVALUES
  9317               WHERE LOOKUPID = :WS-LOOKUPID
  9318                 AND LOOKUPKEY = :WS-LOOKUPKEY
  9319     END-EXEC
  9320
  9321     IF SQLCODE = 0
  9322       OR SQLCODE = 100
  9323        CONTINUE
  9324     ELSE
  9325        DISPLAY "ERROR: INVALID BALLOON STATE SELECT "
  9326        DISPLAY ' SQL RETURN CODE ' SQLCODE
  9327        DISPLAY ' SQL ERR MESS    ' SQLERRMC
  9328     END-IF
  9329
  9330     PERFORM 4300-DISCONNECT THRU 4300-EXIT.
  9331
  9332 4500-EXIT.
  9333     EXIT.
  9334 9700-DATE-LINK.
  9335
  9336* EXEC CICS LINK
  9337*        PROGRAM   ('ELDATCV')
  9338*        COMMAREA  (DATE-CONVERSION-DATA)
  9339*        LENGTH    (DC-COMM-LENGTH)
  9340*    END-EXEC.
  9341     MOVE 'ELDATCV' TO DFHEIV1
  9342*    MOVE '."C                   (   #00008755' TO DFHEIV0
  9343     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9345     MOVE X'2020233030303038373535' TO DFHEIV0(25:11)
  9346     CALL 'kxdfhei1' USING DFHEIV0,
  9347           DFHEIV1,
  9348           DATE-CONVERSION-DATA,
  9349           DC-COMM-LENGTH,
  9350           DFHEIV99,
  9351           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jun-21 09:02 Page 163
* NSRASBL.cbl
  9352           DFHEIV99,
  9353           DFHEIV99
  9354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9355
  9356 9700-EXIT.
  9357      EXIT.
  9358
  9359 9999-DFHBACK SECTION.
  9360     MOVE '9%                    "   ' TO DFHEIV0
  9361     MOVE 'NSRASBL' TO DFHEIV1
  9362     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9363     GOBACK.
  9364 9999-DFHEXIT.
  9365     IF DFHEIGDJ EQUAL 0001
  9366         NEXT SENTENCE
  9367     ELSE IF DFHEIGDJ EQUAL 2
  9368         GO TO 1160-CERT-TRL-REC-NOTFND
  9369         DEPENDING ON DFHEIGDI.
  9370     MOVE '9%                    "   ' TO DFHEIV0
  9371     MOVE 'NSRASBL' TO DFHEIV1
  9372     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9373     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      169132     Code:       58502
