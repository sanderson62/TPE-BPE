* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1501.cbl
* Options: int("EL1501.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1501.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1501.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1501.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/01/95 15:33:51.
     7*                            VMOD=2.030.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EXH9 - CLAIM HISTORY
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1501.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 062602    2002030700006  PEMA  Add note type of 'S'
    22*                                  (special review)
    23* 121802    2001061800003  SMVA  REMOVE OBSOLETE CODE
    24* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    25* 071210    2009122800001  AJRA  ADD 'LETTER TO BENE' ON LETTER
    26* 071510    2010070600001  PEMA  INT PMT VOID SHOULD NOT OPEN CLM
    27* 113010    2009122800001  AJRA  DISPLAY STOP DATE
    28******************************************************************
    29
    30 ENVIRONMENT DIVISION.
    31
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1501.cbl
    33 DATA DIVISION.
    34 WORKING-STORAGE SECTION.
    35 01  DFH-START PIC X(04).
    36 77  FILLER  PIC X(32)  VALUE '********************************'.
    37 77  FILLER  PIC X(32)  VALUE '*   EL1501 WORKING STORAGE     *'.
    38 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.030 *********'.
    39
    40*                                    COPY ELCSCTM.
    41******************************************************************
    42*                                                                *
    43*                                                                *
    44*                            ELCSCTM                             *
    45*                            VMOD=2.001                          *
    46*                                                                *
    47*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    48*                                                                *
    49******************************************************************
    50 01  SECURITY-MESSAGE.
    51     12  FILLER                          PIC X(30)
    52            VALUE '** LOGIC SECURITY VIOLATION -'.
    53     12  SM-READ                         PIC X(6).
    54     12  FILLER                          PIC X(5)
    55            VALUE ' PGM='.
    56     12  SM-PGM                          PIC X(6).
    57     12  FILLER                          PIC X(5)
    58            VALUE ' OPR='.
    59     12  SM-PROCESSOR-ID                 PIC X(4).
    60     12  FILLER                          PIC X(6)
    61            VALUE ' TERM='.
    62     12  SM-TERMID                       PIC X(4).
    63     12  FILLER                          PIC XX   VALUE SPACE.
    64     12  SM-JUL-DATE                     PIC 9(5).
    65     12  FILLER                          PIC X    VALUE SPACE.
    66     12  SM-TIME                         PIC 99.99.
    67
    68
    69*                                    COPY ELCSCRTY.
    70******************************************************************
    71*                                                                *
    72*                                                                *
    73*                            ELCSCRTY                            *
    74*                            VMOD=2.001                          *
    75*                                                                *
    76*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    77*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    78*        SAVED IN PI-SECURITY-ADDRESS.                           *
    79*                                                                *
    80******************************************************************
    81 01  SECURITY-CONTROL.
    82     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    83     12  FILLER                       PIC XX    VALUE 'SC'.
    84     12  SC-CREDIT-CODES.
    85         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    86             20  SC-CREDIT-DISPLAY    PIC X.
    87             20  SC-CREDIT-UPDATE     PIC X.
    88     12  SC-CLAIMS-CODES.
    89         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    90             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1501.cbl
    91             20  SC-CLAIMS-UPDATE     PIC X.
    92
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1501.cbl
    94 01  WS-DATE-AREA.
    95     12  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    96     12  SAVE-DATE-CCYYMMDD.
    97         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
    98         16  SAVE-DATE-YMD.
    99             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   100             20  FILLER              PIC X(4)    VALUE SPACES.
   101     12  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   102
   103 01  STANDARD-AREAS.
   104     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   105     12  MAP-NAME                    PIC X(8)    VALUE 'EL150B'.
   106     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL1501S'.
   107     12  TRANS-ID                    PIC X(4)    VALUE 'EXH9'.
   108     12  THIS-PGM                    PIC X(8)    VALUE 'EL1501'.
   109     12  PGM-NAME                    PIC X(8).
   110     12  TIME-IN                     PIC S9(7).
   111     12  TIME-OUT-R  REDEFINES TIME-IN.
   112         16  FILLER                  PIC X.
   113         16  TIME-OUT                PIC 99V99.
   114         16  FILLER                  PIC XX.
   115     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   116     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   117     12  XCTL-126                    PIC X(8)    VALUE 'EL126'.
   118     12  XCTL-142                    PIC X(8)    VALUE 'EL142'.
   119     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   120     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   121     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   122     12  FILE-ID                     PIC X(8).
   123     12  SC-ITEM                     PIC S9(4)   VALUE +0001 COMP.
   124     12  WS-BLANK                    PIC X       VALUE ' '.
   125
   126 01  MISC-WORK-AREAS.
   127     12  WS-CK-Q-CONTROL             PIC S9(8) COMP.
   128     12  W-CALLED-NAME               PIC X(8).
   129     12  QID.
   130         16  QID-TERM                PIC X(4).
   131         16  FILLER                  PIC X(4)    VALUE '150B'.
   132     12  MAP-LENGTH                  PIC S9(4)   VALUE +1920 COMP.
   133     12  PASS-SWITCH                 PIC X       VALUE 'A'.
   134     12  DISPLAY-CNT                 PIC S9(4)   VALUE +1    COMP.
   135     12  FILE-SWITCH                 PIC X(4)    VALUE SPACES.
   136     12  WS-SUB                      PIC 9       VALUE 0.
   137     12  SUB                         PIC 9       VALUE 1.
   138     12  SUB-1                       PIC 9       VALUE 1.
   139     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   140     12  DIRECTION-SWITCH            PIC X       VALUE 'N'.
   141     12  WS-RECORDS-READ-SW          PIC X       VALUE 'N'.
   142         88  RECORDS-READ                        VALUE 'Y'.
   143     12  SAVE-CONTROL                PIC X(39).
   144     12  WS-RECEIVED-DATE            PIC XX      VALUE LOW-VALUES.
   145     12  WS-CHECK-WRITTEN-DT         PIC XX      VALUE LOW-VALUES.
   146     12  WS-PMT-APPROVAL-SW          PIC X       VALUE SPACE.
   147     12  WS-CF-PMT-APPROVAL-SW       PIC X       VALUE SPACE.
   148         88  WS-CF-PMT-APPROVAL-USED             VALUE 'Y' 'G'.
   149         88  WS-CF-NO-APPROVAL                   VALUE ' ' 'N'.
   150         88  WS-CF-ALL-APPROVED                  VALUE 'Y'.
   151         88  WS-CF-GRADUATED-APPROVAL            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1501.cbl
   152
   153     12  WS-CV-PMT-CODE              PIC X       VALUE SPACE.
   154     12  WS-PAY-TYPE                 PIC X       VALUE SPACE.
   155     12  WS-AMOUNT-PAID              PIC S9(7)V99 VALUE ZEROS.
   156     12  WS-PAYMENT-ORIGIN           PIC X       VALUE SPACE.
   157     12  WS-RECON-SW                 PIC X       VALUE ' '.
   158         88  RECON-RCD-REDEEMED                  VALUE 'R'.
   159         88  RECON-RCD-NOT-FOUND                 VALUE 'X'.
   160
   161     12  WS-DEEDIT-LENGTH            PIC S9(4)   VALUE +16   COMP.
   162     12  WS-DEEDIT-FIELD             PIC X(16)   VALUE ZEROS.
   163     12  WS-DEEDIT-FIELD-V0 REDEFINES WS-DEEDIT-FIELD
   164                                     PIC S9(16).
   165
   166     12  WS-LF-COVERAGE-TYPE         PIC X       VALUE SPACE.
   167     12  WS-BEN-SEARCH-SW            PIC X       VALUE 'N'.
   168         88  BENEFIT-FOUND                       VALUE 'Y'.
   169         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   170     12  WS-ACCESS.
   171         16  FILLER                  PIC XX      VALUE SPACES.
   172         16  WS-BEN-CD               PIC XX      VALUE SPACES.
   173
   174     12  WS-PRINTED-SW               PIC X       VALUE 'N'.
   175         88  PAYMENT-HAS-BEEN-PRINTED            VALUE 'Y'.
   176         88  PAYMENT-NOT-PRINTED                 VALUE 'N'.
   177
   178     12  WS-RELEASED-SW              PIC X       VALUE 'N'.
   179         88  PAYMENT-NOT-RELEASED                VALUE 'N'.
   180
   181     12  WS-UPDATE-SW                PIC X       VALUE 'N'.
   182     12  WS-VOID-CODE                PIC X       VALUE ' '.
   183
   184     12  WS-WORK-DATE.
   185         16  WS-WORK-MM              PIC 99      VALUE ZEROS.
   186         16  WS-WORK-DD              PIC 99      VALUE ZEROS.
   187         16  WS-WORK-YY              PIC 99      VALUE ZEROS.
   188
   189     12  WS-RCON-DATE.
   190         16  WS-RCON-YEAR.
   191             20  WS-RCON-YY-1        PIC 99.
   192             20  WS-RCON-YY-2        PIC 99.
   193         16  WS-RCON-MM              PIC 99.
   194         16  WS-RCON-DD              PIC 99.
   195     12  W-NAME-LAST             PIC  X(15).
   196     12  W-NAME-FIRST            PIC  X(15).
   197     12  W-NAME-MIDDLE.
   198         16  FILLER              PIC  X.
   199         16  W-NAME-MIDDLE-2     PIC  X.
   200         16  FILLER              PIC  X(13).
   201
   202     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   203     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   204 01  CSO-WORK-FIELDS.
   205     05  ERROR-ON-OUTPUT-SW          PIC X       VALUE 'N'.
   206       88  ERROR-ON-OUTPUT                       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1501.cbl
   208 01  ACCESS-KEYS.
   209     12  ELMSTR-KEY.
   210         16  MSTR-COMP-CD            PIC X.
   211         16  MSTR-CARRIER            PIC X.
   212         16  MSTR-CLAIM-NO           PIC X(7).
   213         16  MSTR-CERT-NO.
   214             20  MSTR-CERT-NO-PRIME  PIC X(10).
   215             20  MSTR-CERT-NO-SUFX   PIC X.
   216     12  ELCNTL-KEY.
   217         16  CNTL-COMP-ID            PIC X(3).
   218         16  CNTL-REC-TYPE           PIC X.
   219         16  CNTL-ACCESS             PIC X(4).
   220         16  CNTL-SEQ-NO             PIC S9(4)     COMP.
   221     12  ELCERT-KEY.
   222         16  CERT-COMP-CD            PIC X.
   223         16  CERT-CARRIER            PIC X.
   224         16  CERT-GROUPING           PIC X(6).
   225         16  CERT-STATE              PIC XX.
   226         16  CERT-ACCOUNT            PIC X(10).
   227         16  CERT-EFF-DT             PIC XX.
   228         16  CERT-CERT-NO.
   229             20  CERT-CERT-NO-PRIME  PIC X(10).
   230             20  CERT-CERT-NO-SUFX   PIC X.
   231     12  ELTRLR-KEY.
   232         16  TRLR-COMP-CD            PIC X.
   233         16  TRLR-CARRIER            PIC X.
   234         16  TRLR-CLAIM-NO           PIC X(7).
   235         16  TRLR-CERT-NO.
   236             20  TRLR-CERT-NO-PRIME  PIC X(10).
   237             20  TRLR-CERT-NO-SUFX   PIC X.
   238         16  TRLR-SEQ-NO             PIC S9(4)   COMP.
   239     12  ELACTQ-KEY.
   240         16  ACTQ-COMP-CD            PIC X.
   241         16  ACTQ-CARRIER            PIC X.
   242         16  ACTQ-CLAIM-NO           PIC X(7).
   243         16  ACTQ-CERT-NO.
   244             20  ACTQ-CERT-NO-PRIME  PIC X(10).
   245             20  ACTQ-CERT-NO-SUFX   PIC X.
   246     12  ELCHKQ-KEY.
   247         16  CHKQ-COMP-CD            PIC X.
   248         16  CHKQ-CONTROL            PIC S9(8)   COMP.
   249         16  CHKQ-SEQ-NO             PIC S9(4)   COMP.
   250     12  ELRCON-KEY.
   251         16  RCON-COMPANY-CD         PIC X.
   252         16  RCON-CHECK-NO           PIC X(7).
   253         16  RCON-CHECK-ORIGIN       PIC X.
   254         16  RCON-GL-ACCOUNT-NO      PIC X(10).
   255     12  EMPLCY-KEY.
   256         16  PLCY-COMPANY-CD         PIC X.
   257         16  PLCY-CARRIER            PIC X.
   258         16  PLCY-GROUPING           PIC X(6).
   259         16  PLCY-STATE              PIC XX.
   260         16  PLCY-PRODUCER           PIC X(10).
   261         16  PLCY-EFF-DT             PIC XX.
   262         16  PLCY-REFERENCE-NO       PIC X(20).
   263     12  W-NOTE-KEY.
   264         16  W-NOTE-COMP-CD      PIC X.
   265         16  W-NOTE-CERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1501.cbl
   266             20  W-NOTE-CARRIER  PIC X.
   267             20  W-NOTE-GROUPING PIC X(6).
   268             20  W-NOTE-STATE    PIC X(2).
   269             20  W-NOTE-ACCOUNT  PIC X(10).
   270             20  W-NOTE-EFF-DT   PIC XX.
   271             20  W-NOTE-CERT-NO  PIC X(11).
   272
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1501.cbl
   274 01  ERROR-MESSAGES.
   275     12  ER-0000                     PIC X(4)    VALUE '0000'.
   276     12  ER-0004                     PIC X(4)    VALUE '0004'.
   277     12  ER-0008                     PIC X(4)    VALUE '0008'.
   278     12  ER-0029                     PIC X(4)    VALUE '0029'.
   279     12  ER-0033                     PIC X(4)    VALUE '0033'.
   280     12  ER-0042                     PIC X(4)    VALUE '0042'.
   281     12  ER-0068                     PIC X(4)    VALUE '0068'.
   282     12  ER-0070                     PIC X(4)    VALUE '0070'.
   283     12  ER-0130                     PIC X(4)    VALUE '0130'.
   284     12  ER-0154                     PIC X(4)    VALUE '0154'.
   285     12  ER-0169                     PIC X(4)    VALUE '0169'.
   286     12  ER-0172                     PIC X(4)    VALUE '0172'.
   287     12  ER-0190                     PIC X(4)    VALUE '0190'.
   288     12  ER-0204                     PIC X(4)    VALUE '0204'.
   289     12  ER-0206                     PIC X(4)    VALUE '0206'.
   290     12  ER-0282                     PIC X(4)    VALUE '0282'.
   291     12  ER-0303                     PIC X(4)    VALUE '0303'.
   292     12  ER-0334                     PIC X(4)    VALUE '0334'.
   293     12  ER-0335                     PIC X(4)    VALUE '0335'.
   294     12  ER-0336                     PIC X(4)    VALUE '0336'.
   295     12  ER-0337                     PIC X(4)    VALUE '0337'.
   296     12  ER-0338                     PIC X(4)    VALUE '0338'.
   297     12  ER-0376                     PIC X(4)    VALUE '0376'.
   298     12  ER-0412                     PIC X(4)    VALUE '0412'.
   299     12  ER-0413                     PIC X(4)    VALUE '0413'.
   300     12  ER-0660                     PIC X(4)    VALUE '0660'.
   301     12  ER-0661                     PIC X(4)    VALUE '0661'.
   302     12  ER-0662                     PIC X(4)    VALUE '0662'.
   303     12  ER-0663                     PIC X(4)    VALUE '0663'.
   304     12  ER-0664                     PIC X(4)    VALUE '0664'.
   305     12  ER-0665                     PIC X(4)    VALUE '0665'.
   306     12  ER-0666                     PIC X(4)    VALUE '0666'.
   307     12  ER-0667                     PIC X(4)    VALUE '0667'.
   308     12  ER-0672                     PIC X(4)    VALUE '0672'.
   309     12  ER-0776                     PIC X(4)    VALUE '0776'.
   310     12  ER-0800                     PIC X(4)    VALUE '0800'.
   311     12  ER-0801                     PIC X(4)    VALUE '0801'.
   312     12  ER-0816                     PIC X(4)    VALUE '0816'.
   313     12  ER-0823                     PIC X(4)    VALUE '0823'.
   314     12  ER-0833                     PIC X(4)    VALUE '0833'.
   315     12  ER-0835                     PIC X(4)    VALUE '0835'.
   316     12  ER-0849                     PIC X(4)    VALUE '0849'.
   317     12  ER-0919                     PIC X(4)    VALUE '0919'.
   318     12  ER-0920                     PIC X(4)    VALUE '0920'.
   319     12  ER-0921                     PIC X(4)    VALUE '0921'.
   320     12  ER-0922                     PIC X(4)    VALUE '0922'.
   321     12  ER-0923                     PIC X(4)    VALUE '0923'.
   322     12  ER-0925                     PIC X(4)    VALUE '0925'.
   323     12  ER-0939                     PIC X(4)    VALUE '0939'.
   324     12  ER-0940                     PIC X(4)    VALUE '0940'.
   325     12  ER-0941                     PIC X(4)    VALUE '0941'.
   326     12  ER-0942                     PIC X(4)    VALUE '0942'.
   327     12  ER-0946                     PIC X(4)    VALUE '0946'.
   328     12  ER-0947                     PIC X(4)    VALUE '0947'.
   329     12  ER-0948                     PIC X(4)    VALUE '0948'.
   330     12  ER-0949                     PIC X(4)    VALUE '0949'.
   331     12  ER-0950                     PIC X(4)    VALUE '0950'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1501.cbl
   332     12  ER-0951                     PIC X(4)    VALUE '0951'.
   333     12  ER-0954                     PIC X(4)    VALUE '0954'.
   334     12  ER-0974                     PIC X(4)    VALUE '0974'.
   335     12  ER-0975                     PIC X(4)    VALUE '0975'.
   336     12  ER-2378                     PIC X(4)    VALUE '2378'.
   337     12  ER-2379                     PIC X(4)    VALUE '2379'.
   338     12  ER-7999                     PIC X(4)    VALUE '7999'.
   339     12  ER-8003                     PIC X(4)    VALUE '8003'.
   340     12  ER-8051                     PIC X(4)    VALUE '8051'.
   341     12  ER-8052                     PIC X(4)    VALUE '8052'.
   342     12  ER-8053                     PIC X(4)    VALUE '8053'.
   343     12  ER-8054                     PIC X(4)    VALUE '8054'.
   344     12  ER-8055                     PIC X(4)    VALUE '8055'.
   345     12  ER-8056                     PIC X(4)    VALUE '8056'.
   346     12  ER-8057                     PIC X(4)    VALUE '8057'.
   347     12  ER-8058                     PIC X(4)    VALUE '8058'.
   348     12  ER-8059                     PIC X(4)    VALUE '8059'.
   349     12  ER-8060                     PIC X(4)    VALUE '8060'.
   350     12  ER-8061                     PIC X(4)    VALUE '8061'.
   351     12  ER-8062                     PIC X(4)    VALUE '8062'.
   352     12  ER-8063                     PIC X(4)    VALUE '8063'.
   353     12  ER-8064                     PIC X(4)    VALUE '8064'.
   354     12  ER-8065                     PIC X(4)    VALUE '8065'.
   355     12  ER-8066                     PIC X(4)    VALUE '8066'.
   356     12  ER-8152                     PIC X(4)    VALUE '8152'.
   357     12  ER-8153                     PIC X(4)    VALUE '8153'.
   358     12  ER-8154                     PIC X(4)    VALUE '8154'.
   359     12  ER-8155                     PIC X(4)    VALUE '8155'.
   360     12  ER-9211                     PIC X(4)    VALUE '9211'.
   361     12  ER-9883                     PIC X(4)    VALUE '9883'.
   362
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1501.cbl
   364 01  TEXT-WORK-AREAS.
   365     12  PAYMENT-LINE-1.
   366         16  PMT-HDG1.
   367             20  PMT-LINE-NO         PIC X.
   368             20  FILLER              PIC X.
   369             20  PMT-HDG1-LIT        PIC X(8).
   370         16  PMT-TEXT-1.
   371             20  PMT-TYPE-LIT        PIC X(6).
   372             20  PMT-TYPE            PIC X(7).
   373             20  PMT-CHECK-NO-LIT    PIC X(11).
   374             20  PMT-CHECK-NO        PIC X(7).
   375             20  PMT-DT-WRITTEN-LIT  PIC X(14).
   376             20  PMT-DT-WRITTEN      PIC X(8).
   377             20  PMT-AMT-PD-LIT      PIC X(5).
   378             20  PMT-AMT-PAID        PIC Z(6).99-.
   379     12  PAYMENT-LINE-2.
   380         16  PMT-HDG2.
   381             20  FILLER              PIC X(6).
   382             20  PMT-HDG2-LIT        PIC X(4).
   383         16  PMT-TEXT-2.
   384             20  PMT-FROM-LIT        PIC X(6).
   385             20  PMT-PAID-FROM       PIC X(8).
   386             20  PMT-THRU-LIT        PIC X(10).
   387             20  PMT-PAID-THRU       PIC X(8).
   388             20  PMT-VOID-LIT        PIC X(13).
   389             20  PMT-VOID-DT         PIC X(8).
   390             20  PMT-PAYEE-LIT       PIC X(8).
   391             20  PMT-PAYEE           PIC X(7).
   392     12  AUTO-PMT-LINE-1.
   393         16  AUTO-PMT-HDG1.
   394             20  AUTO-LINE-NO        PIC X.
   395             20  FILLER              PIC X.
   396             20  AUTO-HDG1-LIT       PIC X(8).
   397         16  AUTO-PMT-TEXT1.
   398             20  AUTO-EFF-DT-LIT     PIC X(6).
   399             20  AUTO-EFF-DT         PIC X(8).
   400             20  AUTO-1ST-AMT-LIT    PIC X(10).
   401             20  AUTO-1ST-AMT        PIC Z(5).99.
   402             20  AUTO-REG-AMT-LIT    PIC X(14).
   403             20  AUTO-REG-AMT        PIC Z(5).99.
   404             20  AUTO-PMT-STATUS-LIT PIC X(8).
   405             20  AUTO-PMT-STATUS     PIC X(6).
   406     12  AUTO-PMT-LINE-2.
   407         16  AUTO-PMT-HDG2.
   408             20  FILLER              PIC X(6).
   409             20  AUTO-HDG2-LIT       PIC X(4).
   410         16  AUTO-PMT-TEXT2.
   411             20  AUTO-PAYEE-LIT      PIC X(6).
   412             20  AUTO-PAYEE          PIC X(8).
   413             20  AUTO-1ST-PMT-LIT    PIC X(10).
   414             20  AUTO-1ST-PMT-DT     PIC X(8).
   415             20  AUTO-LST-PMT-LIT    PIC X(14).
   416             20  AUTO-LST-PMT-DT     PIC X(8).
   417             20  FILLER              PIC X(4).
   418     12  CORRESPONDENCE-LINE-1.
   419         16  CORR-HDG1.
   420             20  CORR-LINE-NO        PIC X.
   421             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1501.cbl
   422             20  CORR-HDG1-LIT       PIC X(8).
   423         16  CORR-TEXT-1.
   424             20  CORR-FORM-LIT       PIC X(6).
   425             20  CORR-FORM-TYPE      PIC X(4).
   426*             20  FILLER              PIC X(4).
   427             20  CORR-DT-SENT-LIT    PIC X(10).
   428             20  CORR-DT-SENT        PIC X(8).
   429             20  CORR-INIT-PRT-LIT   PIC X(11).
   430             20  CORR-INIT-PRT-DT    PIC X(8).
   431             20  CORR-ADDR-LIT       PIC X(05).
   432             20  CORR-ADDR-TYPE      PIC XX.
   433             20  CORR-LET-TO-BEN     PIC X(14).
   434     12  CORRESPONDENCE-LINE-2.
   435         16  CORR-HDG2.
   436             20  FILLER              PIC X(6).
   437             20  CORR-HDG2-LIT       PIC X(4).
   438         16  CORR-TEXT-2.
   439             20  CORR-RESEND-LIT     PIC X(6).
   440             20  CORR-RESEND-DT      PIC X(8).
   441             20  CORR-RECVD-LIT      PIC X(10).
   442             20  CORR-RECVD-DT       PIC X(8).
   443             20  CORR-FOLLOW-UP-LIT  PIC X(14).
   444             20  CORR-FOLLOW-UP-DT   PIC X(8).
   445             20  CORR-ARCH-LIT       PIC X(6).
   446             20  CORR-ARCH-NO        PIC 9(8).
   447*            20  FILLER              PIC X(14).
   448     12  FORM-LINE-1.
   449         16  FORM-HDG1.
   450             20  FORM-LINE-NO        PIC X.
   451             20  FILLER              PIC X.
   452             20  FORM-HDG1-LIT       PIC X(8).
   453         16  FORM-TEXT-1.
   454             20  FORM-TYPE-LIT       PIC X(6).
   455             20  FORM-TYPE           PIC X(4).
   456             20  FILLER              PIC X(4).
   457             20  FORM-SEND-ON-LIT    PIC X(10).
   458             20  FORM-SEND-ON-DT     PIC X(8).
   459             20  FORM-RESEND-LIT     PIC X(14).
   460             20  FORM-RESEND-DT      PIC X(8).
   461             20  FORM-FOLLOW-UP-LIT  PIC X(6).
   462             20  FORM-FOLLOW-UP-DT   PIC X(8).
   463     12  FORM-LINE-2.
   464         16  FORM-HDG2.
   465             20  FILLER              PIC X(6).
   466             20  FORM-HDG2-LIT       PIC X(4).
   467         16  FORM-TEXT-2.
   468             20  FORM-REC-INS-LIT    PIC X(6).
   469             20  FORM-REC-INS-DT     PIC X(8).
   470             20  FORM-REC-PHY-LIT    PIC X(10).
   471             20  FORM-REC-PHY-DT     PIC X(8).
   472             20  FORM-REC-EMP-LIT    PIC X(14).
   473             20  FORM-REC-EMP-DT     PIC X(8).
   474             20  FILLER              PIC X(12).
   475     12  INCUR-CHG-LINE-1.
   476         16  INCUR-CHG-HDG1.
   477             20  INCUR-LINE-NO       PIC X.
   478             20  FILLER              PIC X.
   479             20  INCUR-HDG1-LIT      PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1501.cbl
   480         16  INCUR-TEXT-1.
   481             20  INCUR-INCUR-LIT     PIC X(6).
   482             20  INCUR-INCUR-DT      PIC X(8).
   483             20  INCUR-REPORT-LIT    PIC X(10).
   484             20  INCUR-REPORT-DT     PIC X(8).
   485             20  INCUR-ESTAB-LIT     PIC X(14).
   486             20  INCUR-ESTAB-DT      PIC X(8).
   487             20  INCUR-NO-PMTS-LIT   PIC X(11).
   488             20  INCUR-NO-PMTS       PIC ZZ9.
   489     12  INCUR-CHG-LINE-2.
   490         16  INCUR-CHG-HDG2.
   491             20  FILLER              PIC X(6).
   492             20  INCUR-HDG2-LIT      PIC X(4).
   493         16  INCUR-TEXT-2.
   494             20  INCUR-PD-THRU-LIT   PIC X(6).
   495             20  INCUR-PD-THRU-DT    PIC X(8).
   496             20  INCUR-TOT-PD-LIT    PIC X(10).
   497             20  INCUR-TOT-PD        PIC Z(5).99.
   498             20  INCUR-TOT-DAYS-LIT  PIC X(14).
   499             20  INCUR-TOT-DAYS-PD   PIC ZZ9.
   500             20  FILLER              PIC X(19).
   501     12  DENIAL-LINE-1.
   502         16  DENIAL-HDG1.
   503             20  DENIAL-LINE-NO      PIC X.
   504             20  FILLER              PIC X.
   505             20  DENIAL-HDG1-LIT     PIC X(8).
   506         16  DENIAL-TEXT-1.
   507             20  DENIAL-LN1-LIT      PIC X(6).
   508             20  DENIAL-LN1          PIC X(62).
   509     12  DENIAL-LINE-2.
   510         16  DENIAL-HDG2.
   511             20  FILLER              PIC X(10).
   512         16  DENIAL-TEXT-2.
   513             20  DENIAL-LN2-LIT      PIC X(6).
   514             20  DENIAL-LN2          PIC X(62).
   515     12  GEN-INFO-LINE-1.
   516         16  GEN-INFO-HDG1.
   517             20  GI-LINE-NO          PIC X.
   518             20  FILLER              PIC X.
   519             20  GI-HDG1-LIT         PIC X(8).
   520         16  GEN-INFO-TEXT-1.
   521             20  GEN-INFO-MSG-1-LIT  PIC X(6).
   522             20  GEN-INFO-MSG-1      PIC X(62).
   523     12  GEN-INFO-LINE-2.
   524         16  GEN-INFO-HDG2.
   525             20  FILLER              PIC XX.
   526             20  GI-HDG2-LIT         PIC X(8).
   527         16  GEN-INFO-TEXT-2.
   528             20  GEN-INFO-MSG-2-LIT  PIC X(6).
   529             20  GEN-INFO-MSG-2      PIC X(62).
   530     12  REMINDER-LINE-1.
   531         16  REMINDER-HDG1.
   532             20  REM-LINE-NO         PIC X.
   533             20  FILLER              PIC X.
   534             20  REM-HDG1-LIT        PIC X(8).
   535         16  REMINDER-TEXT-1.
   536             20  REM-LINE-1-LIT      PIC X(6).
   537             20  REM-LINE-1          PIC X(62).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1501.cbl
   538     12  REMINDER-LINE-2.
   539         16  REMINDER-HDG2.
   540             20  FILLER              PIC X(10).
   541         16  REMINDER-TEXT-2.
   542             20  REM-LINE-2-LIT      PIC X(6).
   543             20  REM-LINE-2          PIC X(62).
   544
   545 01  PAYMENT-DESCRIPTION-TABLE.
   546     12  FILLER                      PIC X(8)    VALUE 'PARTIAL '.
   547     12  FILLER                      PIC X(8)    VALUE 'FINAL   '.
   548     12  FILLER                      PIC X(8)    VALUE 'LUMP SUM'.
   549     12  FILLER                      PIC X(8)    VALUE 'ADDITION'.
   550     12  FILLER                      PIC X(8)    VALUE 'CHRG EXP'.
   551     12  FILLER                      PIC X(8)    VALUE 'NON-CHG '.
   552     12  FILLER                      PIC X(8)    VALUE 'LF PRM  '.
   553     12  FILLER                      PIC X(8)    VALUE 'A/H PRM '.
   554     12  FILLER                      PIC X(8)    VALUE 'ENT CORR'.
   555 01  PAYMENT-DESC-R   REDEFINES PAYMENT-DESCRIPTION-TABLE.
   556     12  PAY-DESC                    PIC X(8)    OCCURS 2.
   557
   558 01  CV-PAYMENT-DESCRIPTION-TABLE.
   559     12  FILLER                      PIC X(7)    VALUE 'FUL DTH'.
   560     12  FILLER                      PIC X(7)    VALUE 'HLF DTH'.
   561     12  FILLER                      PIC X(7)    VALUE 'FUL ADD'.
   562     12  FILLER                      PIC X(7)    VALUE 'HLF ADD'.
   563     12  FILLER                      PIC X(7)    VALUE 'FUL RID'.
   564     12  FILLER                      PIC X(7)    VALUE 'HLF RID'.
   565     12  FILLER                      PIC X(7)    VALUE 'NON-CHG'.
   566     12  FILLER                      PIC X(7)    VALUE 'ADDL   '.
   567 01  CV-PAYMENT-DESC-R REDEFINES CV-PAYMENT-DESCRIPTION-TABLE.
   568     12  CV-PAY-DESC                 PIC X(7)    OCCURS 2.
   569
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1501.cbl
   571*                                    COPY ELCDATE.
   572******************************************************************
   573*                                                                *
   574*                                                                *
   575*                            ELCDATE.                            *
   576*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   577*                            VMOD=2.003
   578*                                                                *
   579*                                                                *
   580*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   581*                 LENGTH = 200                                   *
   582******************************************************************
   583
   584 01  DATE-CONVERSION-DATA.
   585     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   586     12  DC-OPTION-CODE                PIC X.
   587         88  BIN-TO-GREG                VALUE ' '.
   588         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   589         88  EDIT-GREG-TO-BIN           VALUE '2'.
   590         88  YMD-GREG-TO-BIN            VALUE '3'.
   591         88  MDY-GREG-TO-BIN            VALUE '4'.
   592         88  JULIAN-TO-BIN              VALUE '5'.
   593         88  BIN-PLUS-ELAPSED           VALUE '6'.
   594         88  FIND-CENTURY               VALUE '7'.
   595         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   596         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   597         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   598         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   599         88  JULIAN-TO-BIN-3            VALUE 'C'.
   600         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   601         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   602         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   603         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   604         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   605         88  CHECK-LEAP-YEAR            VALUE 'H'.
   606         88  BIN-3-TO-GREG              VALUE 'I'.
   607         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   608         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   609         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   610         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   611         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   612         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   613         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   614         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   615         88  THREE-CHARACTER-BIN
   616                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   617         88  GREGORIAN-TO-BIN
   618                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   619         88  BIN-TO-GREGORIAN
   620                  VALUES ' ' '1' 'I' '8' 'G'.
   621         88  JULIAN-TO-BINARY
   622                  VALUES '5' 'C' 'E' 'F'.
   623     12  DC-ERROR-CODE                 PIC X.
   624         88  NO-CONVERSION-ERROR        VALUE ' '.
   625         88  DATE-CONVERSION-ERROR
   626                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   627         88  DATE-IS-ZERO               VALUE '1'.
   628         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1501.cbl
   629         88  DATE-IS-INVALID            VALUE '3'.
   630         88  DATE1-GREATER-DATE2        VALUE '4'.
   631         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   632         88  DATE-INVALID-OPTION        VALUE '9'.
   633         88  INVALID-CENTURY            VALUE 'A'.
   634         88  ONLY-CENTURY               VALUE 'B'.
   635         88  ONLY-LEAP-YEAR             VALUE 'C'.
   636         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   637     12  DC-END-OF-MONTH               PIC X.
   638         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   639     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   640         88  USE-NORMAL-PROCESS         VALUE ' '.
   641         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   642         88  ADJUST-UP-100-YRS          VALUE '2'.
   643     12  FILLER                        PIC X.
   644     12  DC-CONVERSION-DATES.
   645         16  DC-BIN-DATE-1             PIC XX.
   646         16  DC-BIN-DATE-2             PIC XX.
   647         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   648         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   649                       DC-GREG-DATE-1-EDIT.
   650             20  DC-EDIT1-MONTH        PIC 99.
   651             20  SLASH1-1              PIC X.
   652             20  DC-EDIT1-DAY          PIC 99.
   653             20  SLASH1-2              PIC X.
   654             20  DC-EDIT1-YEAR         PIC 99.
   655         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   656         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   657                     DC-GREG-DATE-2-EDIT.
   658             20  DC-EDIT2-MONTH        PIC 99.
   659             20  SLASH2-1              PIC X.
   660             20  DC-EDIT2-DAY          PIC 99.
   661             20  SLASH2-2              PIC X.
   662             20  DC-EDIT2-YEAR         PIC 99.
   663         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   664         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   665                     DC-GREG-DATE-1-YMD.
   666             20  DC-YMD-YEAR           PIC 99.
   667             20  DC-YMD-MONTH          PIC 99.
   668             20  DC-YMD-DAY            PIC 99.
   669         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   670         16  DC-GREG-DATE-1-MDY-R REDEFINES
   671                      DC-GREG-DATE-1-MDY.
   672             20  DC-MDY-MONTH          PIC 99.
   673             20  DC-MDY-DAY            PIC 99.
   674             20  DC-MDY-YEAR           PIC 99.
   675         16  DC-GREG-DATE-1-ALPHA.
   676             20  DC-ALPHA-MONTH        PIC X(10).
   677             20  DC-ALPHA-DAY          PIC 99.
   678             20  FILLER                PIC XX.
   679             20  DC-ALPHA-CENTURY.
   680                 24 DC-ALPHA-CEN-N     PIC 99.
   681             20  DC-ALPHA-YEAR         PIC 99.
   682         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   683         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   684         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   685         16  DC-JULIAN-DATE            PIC 9(05).
   686         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1501.cbl
   687                                       PIC 9(05).
   688         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   689             20  DC-JULIAN-YEAR        PIC 99.
   690             20  DC-JULIAN-DAYS        PIC 999.
   691         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   692         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   693         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   694     12  DATE-CONVERSION-VARIBLES.
   695         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   696         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   697             20  FILLER                PIC 9(3).
   698             20  HOLD-CEN-1-CCYY.
   699                 24  HOLD-CEN-1-CC     PIC 99.
   700                 24  HOLD-CEN-1-YY     PIC 99.
   701             20  HOLD-CEN-1-MO         PIC 99.
   702             20  HOLD-CEN-1-DA         PIC 99.
   703         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   704             20  HOLD-CEN-1-R-MO       PIC 99.
   705             20  HOLD-CEN-1-R-DA       PIC 99.
   706             20  HOLD-CEN-1-R-CCYY.
   707                 24  HOLD-CEN-1-R-CC   PIC 99.
   708                 24  HOLD-CEN-1-R-YY   PIC 99.
   709             20  FILLER                PIC 9(3).
   710         16  HOLD-CENTURY-1-X.
   711             20  FILLER                PIC X(3)  VALUE SPACES.
   712             20  HOLD-CEN-1-X-CCYY.
   713                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   714                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   715             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   716             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   717         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   718             20  HOLD-CEN-1-R-X-MO     PIC XX.
   719             20  HOLD-CEN-1-R-X-DA     PIC XX.
   720             20  HOLD-CEN-1-R-X-CCYY.
   721                 24  HOLD-CEN-1-R-X-CC PIC XX.
   722                 24  HOLD-CEN-1-R-X-YY PIC XX.
   723             20  FILLER                PIC XXX.
   724         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   725         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   726         16  DC-JULIAN-DATE-1          PIC 9(07).
   727         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   728             20  DC-JULIAN-1-CCYY.
   729                 24  DC-JULIAN-1-CC    PIC 99.
   730                 24  DC-JULIAN-1-YR    PIC 99.
   731             20  DC-JULIAN-DA-1        PIC 999.
   732         16  DC-JULIAN-DATE-2          PIC 9(07).
   733         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   734             20  DC-JULIAN-2-CCYY.
   735                 24  DC-JULIAN-2-CC    PIC 99.
   736                 24  DC-JULIAN-2-YR    PIC 99.
   737             20  DC-JULIAN-DA-2        PIC 999.
   738         16  DC-GREG-DATE-A-EDIT.
   739             20  DC-EDITA-MONTH        PIC 99.
   740             20  SLASHA-1              PIC X VALUE '/'.
   741             20  DC-EDITA-DAY          PIC 99.
   742             20  SLASHA-2              PIC X VALUE '/'.
   743             20  DC-EDITA-CCYY.
   744                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1501.cbl
   745                 24  DC-EDITA-YEAR     PIC 99.
   746         16  DC-GREG-DATE-B-EDIT.
   747             20  DC-EDITB-MONTH        PIC 99.
   748             20  SLASHB-1              PIC X VALUE '/'.
   749             20  DC-EDITB-DAY          PIC 99.
   750             20  SLASHB-2              PIC X VALUE '/'.
   751             20  DC-EDITB-CCYY.
   752                 24  DC-EDITB-CENT     PIC 99.
   753                 24  DC-EDITB-YEAR     PIC 99.
   754         16  DC-GREG-DATE-CYMD         PIC 9(08).
   755         16  DC-GREG-DATE-CYMD-R REDEFINES
   756                              DC-GREG-DATE-CYMD.
   757             20  DC-CYMD-CEN           PIC 99.
   758             20  DC-CYMD-YEAR          PIC 99.
   759             20  DC-CYMD-MONTH         PIC 99.
   760             20  DC-CYMD-DAY           PIC 99.
   761         16  DC-GREG-DATE-MDCY         PIC 9(08).
   762         16  DC-GREG-DATE-MDCY-R REDEFINES
   763                              DC-GREG-DATE-MDCY.
   764             20  DC-MDCY-MONTH         PIC 99.
   765             20  DC-MDCY-DAY           PIC 99.
   766             20  DC-MDCY-CEN           PIC 99.
   767             20  DC-MDCY-YEAR          PIC 99.
   768    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   769        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   770    12  DC-EL310-DATE                  PIC X(21).
   771    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1501.cbl
   773*                                    COPY ELCLOGOF.
   774******************************************************************
   775*                                                                *
   776*                                                                *
   777*                            ELCLOGOF.                           *
   778*                            VMOD=2.001                          *
   779*                                                                *
   780*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   781*                                                                *
   782******************************************************************
   783 01  CLASIC-LOGOFF.
   784     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   785     12  LOGOFF-TEXT.
   786         16  FILLER          PIC X(5)    VALUE SPACES.
   787         16  LOGOFF-MSG.
   788             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   789             20  FILLER      PIC X       VALUE SPACES.
   790             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   791         16  FILLER          PIC X(80)
   792           VALUE '* YOU ARE NOW LOGGED OFF'.
   793         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   794         16  FILLER          PIC X       VALUE QUOTE.
   795         16  LOGOFF-SYS-MSG  PIC X(17)
   796           VALUE 'S CLAS-IC SYSTEM '.
   797     12  TEXT-MESSAGES.
   798         16  UNACCESS-MSG    PIC X(29)
   799             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   800         16  PGMIDERR-MSG    PIC X(17)
   801             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1501.cbl
   803*                                    COPY ELCATTR.
   804******************************************************************
   805*                                                                *
   806*                            ELCATTR.                            *
   807*                            VMOD=2.001                          *
   808*                                                                *
   809*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   810*                                                                *
   811*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   812*                                                                *
   813*                   POS 1   P=PROTECTED                          *
   814*                           U=UNPROTECTED                        *
   815*                           S=ASKIP                              *
   816*                   POS 2   A=ALPHA/NUMERIC                      *
   817*                           N=NUMERIC                            *
   818*                   POS 3   N=NORMAL                             *
   819*                           B=BRIGHT                             *
   820*                           D=DARK                               *
   821*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   822*                           OF=MODIFIED DATA TAG OFF             *
   823*                                                                *
   824*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   825******************************************************************
   826 01  ATTRIBUTE-LIST.
   827     12  AL-PABOF            PIC X       VALUE 'Y'.
   828     12  AL-PABON            PIC X       VALUE 'Z'.
   829     12  AL-PADOF            PIC X       VALUE '%'.
   830     12  AL-PADON            PIC X       VALUE '_'.
   831     12  AL-PANOF            PIC X       VALUE '-'.
   832     12  AL-PANON            PIC X       VALUE '/'.
   833     12  AL-SABOF            PIC X       VALUE '8'.
   834     12  AL-SABON            PIC X       VALUE '9'.
   835     12  AL-SADOF            PIC X       VALUE '@'.
   836     12  AL-SADON            PIC X       VALUE QUOTE.
   837     12  AL-SANOF            PIC X       VALUE '0'.
   838     12  AL-SANON            PIC X       VALUE '1'.
   839     12  AL-UABOF            PIC X       VALUE 'H'.
   840     12  AL-UABON            PIC X       VALUE 'I'.
   841     12  AL-UADOF            PIC X       VALUE '<'.
   842     12  AL-UADON            PIC X       VALUE '('.
   843     12  AL-UANOF            PIC X       VALUE ' '.
   844     12  AL-UANON            PIC X       VALUE 'A'.
   845     12  AL-UNBOF            PIC X       VALUE 'Q'.
   846     12  AL-UNBON            PIC X       VALUE 'R'.
   847     12  AL-UNDOF            PIC X       VALUE '*'.
   848     12  AL-UNDON            PIC X       VALUE ')'.
   849     12  AL-UNNOF            PIC X       VALUE '&'.
   850     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1501.cbl
   852*                                    COPY ELCDCTB.
   853*    EJECT
   854*                                    COPY ELCDMO.
   855*    EJECT
   856*                                    COPY ELCEMIB.
   857******************************************************************
   858*                                                                *
   859*                                                                *
   860*                            ELCEMIB.                            *
   861*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   862*                            VMOD=2.005                          *
   863*                                                                *
   864*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   865*                                                                *
   866******************************************************************
   867 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   868     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   869     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   870     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   871     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   872     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   873     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   874     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   875     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   876     12  EMI-SWITCH1             PIC X        VALUE '1'.
   877         88  EMI-NO-ERRORS                    VALUE '1'.
   878         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   879         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   880     12  EMI-SWITCH2             PIC X        VALUE '1'.
   881         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   882     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   883         88  EMI-AREA1-EMPTY                  VALUE '1'.
   884         88  EMI-AREA1-FULL                   VALUE '2'.
   885     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   886         88  EMI-AREA2-EMPTY                  VALUE '1'.
   887         88  EMI-AREA2-FULL                   VALUE '2'.
   888     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   889         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   890         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   891         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   892         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   893         88  EMI-BYPASS-FATALS                VALUE 'X'.
   894     12  EMI-ERROR-LINES.
   895         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   896         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   897         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   898         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   899             20  EMI-ERR-CODES OCCURS 10 TIMES.
   900                 24  EMI-ERR-NUM         PIC X(4).
   901                 24  EMI-FILLER          PIC X.
   902                 24  EMI-SEV             PIC X.
   903                 24  FILLER              PIC X.
   904             20  FILLER                  PIC X(02).
   905     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   906         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   907             20  EMI-ERROR-NUMBER    PIC X(4).
   908             20  EMI-FILL            PIC X.
   909             20  EMI-SEVERITY        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1501.cbl
   910             20  FILLER              PIC X.
   911             20  EMI-ERROR-TEXT.
   912                 24  EMI-TEXT-VARIABLE   PIC X(10).
   913                 24  FILLER          PIC X(55).
   914     12  EMI-SEVERITY-SAVE           PIC X.
   915         88  EMI-NOTE                    VALUE 'N'.
   916         88  EMI-WARNING                 VALUE 'W'.
   917         88  EMI-FORCABLE                VALUE 'F'.
   918         88  EMI-FATAL                   VALUE 'X'.
   919     12  EMI-MESSAGE-FLAG            PIC X.
   920         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   921         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   922     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   923     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   924         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   925         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   926         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   927     12  FILLER                      PIC X(137)  VALUE SPACES.
   928     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   929     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   930     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   931     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1501.cbl
   933*                                    COPY ELCNWA.
   934*    EJECT
   935*                                    COPY MPCPOLUP.
   936*    EJECT
   937*                            COPY ELCINTF.
   938******************************************************************
   939*                                                                *
   940*                                                                *
   941*                            ELCINTF.                            *
   942*                            VMOD=2.017                          *
   943*                                                                *
   944*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   945*                                                                *
   946*       LENGTH = 1024                                            *
   947*                                                                *
   948******************************************************************
   949 01  PROGRAM-INTERFACE-BLOCK.
   950     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   951     12  PI-CALLING-PROGRAM              PIC X(8).
   952     12  PI-SAVED-PROGRAM-1              PIC X(8).
   953     12  PI-SAVED-PROGRAM-2              PIC X(8).
   954     12  PI-SAVED-PROGRAM-3              PIC X(8).
   955     12  PI-SAVED-PROGRAM-4              PIC X(8).
   956     12  PI-SAVED-PROGRAM-5              PIC X(8).
   957     12  PI-SAVED-PROGRAM-6              PIC X(8).
   958     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   959     12  PI-COMPANY-ID                   PIC XXX.
   960     12  PI-COMPANY-CD                   PIC X.
   961
   962     12  PI-COMPANY-PASSWORD             PIC X(8).
   963
   964     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   965
   966     12  PI-CONTROL-IN-PROGRESS.
   967         16  PI-CARRIER                  PIC X.
   968         16  PI-GROUPING                 PIC X(6).
   969         16  PI-STATE                    PIC XX.
   970         16  PI-ACCOUNT                  PIC X(10).
   971         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   972                                         PIC X(10).
   973         16  PI-CLAIM-CERT-GRP.
   974             20  PI-CLAIM-NO             PIC X(7).
   975             20  PI-CERT-NO.
   976                 25  PI-CERT-PRIME       PIC X(10).
   977                 25  PI-CERT-SFX         PIC X.
   978             20  PI-CERT-EFF-DT          PIC XX.
   979         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   980             20  PI-PLAN-CODE            PIC X(2).
   981             20  PI-REVISION-NUMBER      PIC X(3).
   982             20  PI-PLAN-EFF-DT          PIC X(2).
   983             20  PI-PLAN-EXP-DT          PIC X(2).
   984             20  FILLER                  PIC X(11).
   985         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   986             20  PI-OE-REFERENCE-1.
   987                 25  PI-OE-REF-1-PRIME   PIC X(18).
   988                 25  PI-OE-REF-1-SUFF    PIC XX.
   989
   990     12  PI-SESSION-IN-PROGRESS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1501.cbl
   991         88  CLAIM-SESSION                   VALUE '1'.
   992         88  CREDIT-SESSION                  VALUE '2'.
   993         88  WARRANTY-SESSION                VALUE '3'.
   994         88  MORTGAGE-SESSION                VALUE '4'.
   995         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   996
   997
   998*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   999
  1000     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1001     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1002
  1003     12  PI-CREDIT-USER                  PIC X.
  1004         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1005         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1006
  1007     12  PI-CLAIM-USER                   PIC X.
  1008         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1009         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1010
  1011     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1012         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1013         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1014         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1015         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1016         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1017
  1018     12  PI-PROCESSOR-ID                 PIC X(4).
  1019
  1020     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1021
  1022     12  PI-MEMBER-CAPTION               PIC X(10).
  1023
  1024     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1025         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1026
  1027     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1028     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1029     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1030     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1031
  1032     12  PI-AH-OVERRIDE-L1               PIC X.
  1033     12  PI-AH-OVERRIDE-L2               PIC XX.
  1034     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1035     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1036
  1037     12  PI-NEW-SYSTEM                   PIC X(2).
  1038
  1039     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1040     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1041         88  PI-USES-PAID-TO                 VALUE '1'.
  1042     12  PI-CRDTCRD-SYSTEM.
  1043         16  PI-CRDTCRD-USER             PIC X.
  1044             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1045             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1046         16  PI-CC-MONTH-END-DT          PIC XX.
  1047     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1048
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1501.cbl
  1049     12  PI-OE-REFERENCE-2.
  1050         16  PI-OE-REF-2-PRIME           PIC X(10).
  1051         16  PI-OE-REF-2-SUFF            PIC X.
  1052
  1053     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1054
  1055     12  PI-LANGUAGE-TYPE                PIC X.
  1056             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1057             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1058             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1059
  1060     12  PI-POLICY-LINKAGE-IND           PIC X.
  1061         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1062         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1063                                                   LOW-VALUES.
  1064
  1065     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1066     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1067         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1068         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1069     12  FILLER                          PIC X(4).
  1070
  1071     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1072
  1073     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1074         PI-SYSTEM-LEVEL.
  1075
  1076         16  PI-ENTRY-CODES.
  1077             20  PI-ENTRY-CD-1           PIC X.
  1078             20  PI-ENTRY-CD-2           PIC X.
  1079
  1080         16  PI-RETURN-CODES.
  1081             20  PI-RETURN-CD-1          PIC X.
  1082             20  PI-RETURN-CD-2          PIC X.
  1083
  1084         16  PI-UPDATE-STATUS-SAVE.
  1085             20  PI-UPDATE-BY            PIC X(4).
  1086             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1087
  1088         16  PI-LOWER-CASE-LETTERS       PIC X.
  1089             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1090
  1091*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1092*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1093*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1094
  1095         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1096             88  ST-ACCNT-CNTL               VALUE ' '.
  1097             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1098             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1099             88  ACCNT-CNTL                  VALUE '3'.
  1100             88  CARR-ACCNT-CNTL             VALUE '4'.
  1101
  1102         16  PI-PROCESSOR-CAP-LIST.
  1103             20  PI-SYSTEM-CONTROLS.
  1104                24 PI-SYSTEM-DISPLAY     PIC X.
  1105                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1106                24 PI-SYSTEM-MODIFY      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1501.cbl
  1107                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1108             20  FILLER                  PIC XX.
  1109             20  PI-DISPLAY-CAP          PIC X.
  1110                 88  DISPLAY-CAP             VALUE 'Y'.
  1111             20  PI-MODIFY-CAP           PIC X.
  1112                 88  MODIFY-CAP              VALUE 'Y'.
  1113             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1114                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1115             20  PI-FORCE-CAP            PIC X.
  1116                 88  FORCE-CAP               VALUE 'Y'.
  1117
  1118         16  PI-PROGRAM-CONTROLS.
  1119             20  PI-PGM-PRINT-OPT        PIC X.
  1120             20  PI-PGM-FORMAT-OPT       PIC X.
  1121             20  PI-PGM-PROCESS-OPT      PIC X.
  1122             20  PI-PGM-TOTALS-OPT       PIC X.
  1123
  1124         16  PI-HELP-INTERFACE.
  1125             20  PI-LAST-ERROR-NO        PIC X(4).
  1126             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1127
  1128         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1129             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1130
  1131         16  PI-CR-CONTROL-IN-PROGRESS.
  1132             20  PI-CR-CARRIER           PIC X.
  1133             20  PI-CR-GROUPING          PIC X(6).
  1134             20  PI-CR-STATE             PIC XX.
  1135             20  PI-CR-ACCOUNT           PIC X(10).
  1136             20  PI-CR-FIN-RESP          PIC X(10).
  1137             20  PI-CR-TYPE              PIC X.
  1138
  1139         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1140
  1141         16  PI-CR-MONTH-END-DT          PIC XX.
  1142
  1143         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1144             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1145             88  PI-ZERO-CARRIER             VALUE '1'.
  1146             88  PI-ZERO-GROUPING            VALUE '2'.
  1147             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1148
  1149         16  PI-CARRIER-SECURITY         PIC X.
  1150             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1151
  1152         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1153             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1154             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1155
  1156         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1157             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1158                                         INDEXED BY PI-ACCESS-NDX
  1159                                         PIC X.
  1160
  1161         16  PI-GA-BILLING-CONTROL       PIC X.
  1162             88  PI-GA-BILLING               VALUE '1'.
  1163
  1164         16  PI-MAIL-PROCESSING          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1501.cbl
  1165             88  PI-MAIL-YES                 VALUE 'Y'.
  1166
  1167         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1168
  1169         16  PI-AR-SYSTEM.
  1170             20  PI-AR-PROCESSING-CNTL   PIC X.
  1171                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1172             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1173             20  PI-AR-MONTH-END-DT      PIC XX.
  1174
  1175         16  PI-MP-SYSTEM.
  1176             20  PI-MORTGAGE-USER            PIC X.
  1177                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1178                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1179             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1180                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1181                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1182                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1183                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1184                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1185             20  PI-MP-MONTH-END-DT          PIC XX.
  1186             20  PI-MP-REFERENCE-NO.
  1187                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1188                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1189
  1190         16  PI-LABEL-CONTROL            PIC X(01).
  1191             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1192             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1193
  1194         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1195             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1196
  1197         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1198             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1199             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1200
  1201         16  FILLER                      PIC X(14).
  1202
  1203     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1204******************************************************************
  1205     12  PI-REDEF    REDEFINES PI-PROGRAM-WORK-AREA.
  1206         16  FILLER                  PIC x(2).
  1207         16  pi-el142-priority       pic x.
  1208         16  filler                  pic x.
  1209         16  PI-MAP-NAME             PIC X(8).
  1210         16  PI-QUALIFICATION-SWITCHES  COMP-3.
  1211             20  PI-REMINDERS-SW     PIC S9.
  1212             20  PI-LETTERS-SW       PIC S9.
  1213             20  PI-PAYMENTS-SW      PIC S9.
  1214             20  PI-AUTO-PAY-SW      PIC S9.
  1215             20  PI-NOTES-SW         PIC S9.
  1216             20  PI-RES-EXP-SW       PIC S9.
  1217             20  PI-DENIALS-SW       PIC S9.
  1218             20  PI-INCURRED-DATE-SW PIC S9.
  1219             20  PI-FORMS-SW         PIC S9.
  1220         16  FILLER                  PIC X(8).
  1221         16  PI-ACTIVITY-TRAILERS-KEY.
  1222             20  PI-ATK-COMPANY-CODE PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1501.cbl
  1223             20  PI-ATK-CARRIER      PIC X.
  1224             20  PI-ATK-CLAIM-NO     PIC X(7).
  1225             20  PI-ATK-CERT-NO      PIC X(11).
  1226             20  PI-ATK-SEQ-NO       PIC S9(4)     COMP.
  1227         16  PI-PREV-ACTIVITY-TRAILERS-KEY.
  1228             20  PI-PREV-ATK-COMPANY-CODE PIC X.
  1229             20  PI-PREV-ATK-CARRIER      PIC X.
  1230             20  PI-PREV-ATK-CLAIM-NO     PIC X(7).
  1231             20  PI-PREV-ATK-CERT-NO      PIC X(11).
  1232             20  PI-PREV-ATK-SEQ-NO       PIC S9(4)     COMP.
  1233         16  PI-SAVE-KEY.
  1234             20  PI-SAVE-ATK-COMPANY-CODE PIC X.
  1235             20  PI-SAVE-ATK-CARRIER      PIC X.
  1236             20  PI-SAVE-ATK-CLAIM-NO     PIC X(7).
  1237             20  PI-SAVE-ATK-CERT-NO      PIC X(11).
  1238             20  PI-SAVE-ATK-SEQ-NO       PIC S9(4)     COMP.
  1239         16  PI-PREV-AID                  PIC X.
  1240         16  PI-RECORD-COUNT              PIC S9        COMP-3.
  1241         16  PI-END-OF-FILE               PIC S9        COMP-3.
  1242         16  PI-SAVE-CURSOR               PIC S9(4)     COMP.
  1243         16  PI-PURGED-SW                 PIC X.
  1244             88  CLAIM-IS-PURGED                 VALUE 'Y'.
  1245         16  PI-LINE-NO                   PIC 9.
  1246         16  PI-PREV-SEQ-NO               PIC S9(4)   COMP.
  1247         16  PI-FIRST-TIME-SW             PIC X.
  1248             88  FIRST-TIME                      VALUE 'Y'.
  1249         16  PI-PREV-DIRECTION            PIC X.
  1250         16  PI-SEQ-NUMBERS.
  1251             20  PI-SEQ-NO-TABLE OCCURS 8 TIMES.
  1252                 24  PI-TRLR-LN-NO        PIC 9.
  1253                 24  PI-TRLR-SEQ-NO       PIC S9(4)   COMP.
  1254                 24  PI-TRLR-TYPE         PIC X.
  1255         16  PI-PAY-TYPE                  PIC X.
  1256         16  PI-FULL-SCREEN-IND           PIC X.
  1257             88  PI-FULL-SCREEN-SHOWN            VALUE 'Y'.
  1258         16  FILLER                       PIC X(500).
  1259
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1501.cbl
  1261*                                    COPY ELCAID.
  1262******************************************************************
  1263*                                                                *
  1264*                            ELCAID.                             *
  1265*                            VMOD=2.001                          *
  1266*                                                                *
  1267*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1268*                                                                *
  1269*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1270*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1271******************************************************************
  1272
  1273 01  DFHAID.
  1274   02  DFHNULL   PIC  X  VALUE  ' '.
  1275   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1276   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1277   02  DFHPEN    PIC  X  VALUE  '='.
  1278   02  DFHOPID   PIC  X  VALUE  'W'.
  1279   02  DFHPA1    PIC  X  VALUE  '%'.
  1280   02  DFHPA2    PIC  X  VALUE  '>'.
  1281   02  DFHPA3    PIC  X  VALUE  ','.
  1282   02  DFHPF1    PIC  X  VALUE  '1'.
  1283   02  DFHPF2    PIC  X  VALUE  '2'.
  1284   02  DFHPF3    PIC  X  VALUE  '3'.
  1285   02  DFHPF4    PIC  X  VALUE  '4'.
  1286   02  DFHPF5    PIC  X  VALUE  '5'.
  1287   02  DFHPF6    PIC  X  VALUE  '6'.
  1288   02  DFHPF7    PIC  X  VALUE  '7'.
  1289   02  DFHPF8    PIC  X  VALUE  '8'.
  1290   02  DFHPF9    PIC  X  VALUE  '9'.
  1291   02  DFHPF10   PIC  X  VALUE  ':'.
  1292   02  DFHPF11   PIC  X  VALUE  '#'.
  1293   02  DFHPF12   PIC  X  VALUE  '@'.
  1294   02  DFHPF13   PIC  X  VALUE  'A'.
  1295   02  DFHPF14   PIC  X  VALUE  'B'.
  1296   02  DFHPF15   PIC  X  VALUE  'C'.
  1297   02  DFHPF16   PIC  X  VALUE  'D'.
  1298   02  DFHPF17   PIC  X  VALUE  'E'.
  1299   02  DFHPF18   PIC  X  VALUE  'F'.
  1300   02  DFHPF19   PIC  X  VALUE  'G'.
  1301   02  DFHPF20   PIC  X  VALUE  'H'.
  1302   02  DFHPF21   PIC  X  VALUE  'I'.
  1303*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1304   02  DFHPF22   PIC  X  VALUE  '['.
  1305   02  DFHPF23   PIC  X  VALUE  '.'.
  1306   02  DFHPF24   PIC  X  VALUE  '<'.
  1307   02  DFHMSRE   PIC  X  VALUE  'X'.
  1308   02  DFHSTRF   PIC  X  VALUE  'h'.
  1309   02  DFHTRIG   PIC  X  VALUE  '"'.
  1310 01  FILLER    REDEFINES DFHAID.
  1311     12  FILLER                      PIC X(8).
  1312     12  PF-VALUES                   PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1501.cbl
  1314*                                    COPY EL1501S.
  1315 01  EL150BI.
  1316     05  FILLER            PIC  X(0012).
  1317*    -------------------------------
  1318     05  RUNDTEL PIC S9(0004) COMP.
  1319     05  RUNDTEF PIC  X(0001).
  1320     05  FILLER REDEFINES RUNDTEF.
  1321         10  RUNDTEA PIC  X(0001).
  1322     05  RUNDTEI PIC  X(0008).
  1323*    -------------------------------
  1324     05  RUNTIMEL PIC S9(0004) COMP.
  1325     05  RUNTIMEF PIC  X(0001).
  1326     05  FILLER REDEFINES RUNTIMEF.
  1327         10  RUNTIMEA PIC  X(0001).
  1328     05  RUNTIMEI PIC  X(0005).
  1329*    -------------------------------
  1330     05  CLMNOL PIC S9(0004) COMP.
  1331     05  CLMNOF PIC  X(0001).
  1332     05  FILLER REDEFINES CLMNOF.
  1333         10  CLMNOA PIC  X(0001).
  1334     05  CLMNOI PIC  X(0007).
  1335*    -------------------------------
  1336     05  CARRL PIC S9(0004) COMP.
  1337     05  CARRF PIC  X(0001).
  1338     05  FILLER REDEFINES CARRF.
  1339         10  CARRA PIC  X(0001).
  1340     05  CARRI PIC  X(0001).
  1341*    -------------------------------
  1342     05  CERTNOL PIC S9(0004) COMP.
  1343     05  CERTNOF PIC  X(0001).
  1344     05  FILLER REDEFINES CERTNOF.
  1345         10  CERTNOA PIC  X(0001).
  1346     05  CERTNOI PIC  X(0010).
  1347*    -------------------------------
  1348     05  SUFXL PIC S9(0004) COMP.
  1349     05  SUFXF PIC  X(0001).
  1350     05  FILLER REDEFINES SUFXF.
  1351         10  SUFXA PIC  X(0001).
  1352     05  SUFXI PIC  X(0001).
  1353*    -------------------------------
  1354     05  LN1HDGL PIC S9(0004) COMP.
  1355     05  LN1HDGF PIC  X(0001).
  1356     05  FILLER REDEFINES LN1HDGF.
  1357         10  LN1HDGA PIC  X(0001).
  1358     05  LN1HDGI PIC  X(0010).
  1359*    -------------------------------
  1360     05  LN1TXTL PIC S9(0004) COMP.
  1361     05  LN1TXTF PIC  X(0001).
  1362     05  FILLER REDEFINES LN1TXTF.
  1363         10  LN1TXTA PIC  X(0001).
  1364     05  LN1TXTI PIC  X(0068).
  1365*    -------------------------------
  1366     05  LN2HDGL PIC S9(0004) COMP.
  1367     05  LN2HDGF PIC  X(0001).
  1368     05  FILLER REDEFINES LN2HDGF.
  1369         10  LN2HDGA PIC  X(0001).
  1370     05  LN2HDGI PIC  X(0010).
  1371*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1501.cbl
  1372     05  LN2TXTL PIC S9(0004) COMP.
  1373     05  LN2TXTF PIC  X(0001).
  1374     05  FILLER REDEFINES LN2TXTF.
  1375         10  LN2TXTA PIC  X(0001).
  1376     05  LN2TXTI PIC  X(0068).
  1377*    -------------------------------
  1378     05  LN3HDGL PIC S9(0004) COMP.
  1379     05  LN3HDGF PIC  X(0001).
  1380     05  FILLER REDEFINES LN3HDGF.
  1381         10  LN3HDGA PIC  X(0001).
  1382     05  LN3HDGI PIC  X(0010).
  1383*    -------------------------------
  1384     05  LN3TXTL PIC S9(0004) COMP.
  1385     05  LN3TXTF PIC  X(0001).
  1386     05  FILLER REDEFINES LN3TXTF.
  1387         10  LN3TXTA PIC  X(0001).
  1388     05  LN3TXTI PIC  X(0068).
  1389*    -------------------------------
  1390     05  LN4HDGL PIC S9(0004) COMP.
  1391     05  LN4HDGF PIC  X(0001).
  1392     05  FILLER REDEFINES LN4HDGF.
  1393         10  LN4HDGA PIC  X(0001).
  1394     05  LN4HDGI PIC  X(0010).
  1395*    -------------------------------
  1396     05  LN4TXTL PIC S9(0004) COMP.
  1397     05  LN4TXTF PIC  X(0001).
  1398     05  FILLER REDEFINES LN4TXTF.
  1399         10  LN4TXTA PIC  X(0001).
  1400     05  LN4TXTI PIC  X(0068).
  1401*    -------------------------------
  1402     05  LN5HDGL PIC S9(0004) COMP.
  1403     05  LN5HDGF PIC  X(0001).
  1404     05  FILLER REDEFINES LN5HDGF.
  1405         10  LN5HDGA PIC  X(0001).
  1406     05  LN5HDGI PIC  X(0010).
  1407*    -------------------------------
  1408     05  LN5TXTL PIC S9(0004) COMP.
  1409     05  LN5TXTF PIC  X(0001).
  1410     05  FILLER REDEFINES LN5TXTF.
  1411         10  LN5TXTA PIC  X(0001).
  1412     05  LN5TXTI PIC  X(0068).
  1413*    -------------------------------
  1414     05  LN6HDGL PIC S9(0004) COMP.
  1415     05  LN6HDGF PIC  X(0001).
  1416     05  FILLER REDEFINES LN6HDGF.
  1417         10  LN6HDGA PIC  X(0001).
  1418     05  LN6HDGI PIC  X(0010).
  1419*    -------------------------------
  1420     05  LN6TXTL PIC S9(0004) COMP.
  1421     05  LN6TXTF PIC  X(0001).
  1422     05  FILLER REDEFINES LN6TXTF.
  1423         10  LN6TXTA PIC  X(0001).
  1424     05  LN6TXTI PIC  X(0068).
  1425*    -------------------------------
  1426     05  LN7HDGL PIC S9(0004) COMP.
  1427     05  LN7HDGF PIC  X(0001).
  1428     05  FILLER REDEFINES LN7HDGF.
  1429         10  LN7HDGA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1501.cbl
  1430     05  LN7HDGI PIC  X(0010).
  1431*    -------------------------------
  1432     05  LN7TXTL PIC S9(0004) COMP.
  1433     05  LN7TXTF PIC  X(0001).
  1434     05  FILLER REDEFINES LN7TXTF.
  1435         10  LN7TXTA PIC  X(0001).
  1436     05  LN7TXTI PIC  X(0068).
  1437*    -------------------------------
  1438     05  LN8HDGL PIC S9(0004) COMP.
  1439     05  LN8HDGF PIC  X(0001).
  1440     05  FILLER REDEFINES LN8HDGF.
  1441         10  LN8HDGA PIC  X(0001).
  1442     05  LN8HDGI PIC  X(0010).
  1443*    -------------------------------
  1444     05  LN8TXTL PIC S9(0004) COMP.
  1445     05  LN8TXTF PIC  X(0001).
  1446     05  FILLER REDEFINES LN8TXTF.
  1447         10  LN8TXTA PIC  X(0001).
  1448     05  LN8TXTI PIC  X(0068).
  1449*    -------------------------------
  1450     05  LN9HDGL PIC S9(0004) COMP.
  1451     05  LN9HDGF PIC  X(0001).
  1452     05  FILLER REDEFINES LN9HDGF.
  1453         10  LN9HDGA PIC  X(0001).
  1454     05  LN9HDGI PIC  X(0010).
  1455*    -------------------------------
  1456     05  LN9TXTL PIC S9(0004) COMP.
  1457     05  LN9TXTF PIC  X(0001).
  1458     05  FILLER REDEFINES LN9TXTF.
  1459         10  LN9TXTA PIC  X(0001).
  1460     05  LN9TXTI PIC  X(0068).
  1461*    -------------------------------
  1462     05  LN10HDGL PIC S9(0004) COMP.
  1463     05  LN10HDGF PIC  X(0001).
  1464     05  FILLER REDEFINES LN10HDGF.
  1465         10  LN10HDGA PIC  X(0001).
  1466     05  LN10HDGI PIC  X(0010).
  1467*    -------------------------------
  1468     05  LN10TXTL PIC S9(0004) COMP.
  1469     05  LN10TXTF PIC  X(0001).
  1470     05  FILLER REDEFINES LN10TXTF.
  1471         10  LN10TXTA PIC  X(0001).
  1472     05  LN10TXTI PIC  X(0068).
  1473*    -------------------------------
  1474     05  LN11HDGL PIC S9(0004) COMP.
  1475     05  LN11HDGF PIC  X(0001).
  1476     05  FILLER REDEFINES LN11HDGF.
  1477         10  LN11HDGA PIC  X(0001).
  1478     05  LN11HDGI PIC  X(0010).
  1479*    -------------------------------
  1480     05  LN11TXTL PIC S9(0004) COMP.
  1481     05  LN11TXTF PIC  X(0001).
  1482     05  FILLER REDEFINES LN11TXTF.
  1483         10  LN11TXTA PIC  X(0001).
  1484     05  LN11TXTI PIC  X(0068).
  1485*    -------------------------------
  1486     05  LN12HDGL PIC S9(0004) COMP.
  1487     05  LN12HDGF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1501.cbl
  1488     05  FILLER REDEFINES LN12HDGF.
  1489         10  LN12HDGA PIC  X(0001).
  1490     05  LN12HDGI PIC  X(0010).
  1491*    -------------------------------
  1492     05  LN12TXTL PIC S9(0004) COMP.
  1493     05  LN12TXTF PIC  X(0001).
  1494     05  FILLER REDEFINES LN12TXTF.
  1495         10  LN12TXTA PIC  X(0001).
  1496     05  LN12TXTI PIC  X(0068).
  1497*    -------------------------------
  1498     05  LN13HDGL PIC S9(0004) COMP.
  1499     05  LN13HDGF PIC  X(0001).
  1500     05  FILLER REDEFINES LN13HDGF.
  1501         10  LN13HDGA PIC  X(0001).
  1502     05  LN13HDGI PIC  X(0010).
  1503*    -------------------------------
  1504     05  LN13TXTL PIC S9(0004) COMP.
  1505     05  LN13TXTF PIC  X(0001).
  1506     05  FILLER REDEFINES LN13TXTF.
  1507         10  LN13TXTA PIC  X(0001).
  1508     05  LN13TXTI PIC  X(0068).
  1509*    -------------------------------
  1510     05  LN14HDGL PIC S9(0004) COMP.
  1511     05  LN14HDGF PIC  X(0001).
  1512     05  FILLER REDEFINES LN14HDGF.
  1513         10  LN14HDGA PIC  X(0001).
  1514     05  LN14HDGI PIC  X(0010).
  1515*    -------------------------------
  1516     05  LN14TXTL PIC S9(0004) COMP.
  1517     05  LN14TXTF PIC  X(0001).
  1518     05  FILLER REDEFINES LN14TXTF.
  1519         10  LN14TXTA PIC  X(0001).
  1520     05  LN14TXTI PIC  X(0068).
  1521*    -------------------------------
  1522     05  LN15HDGL PIC S9(0004) COMP.
  1523     05  LN15HDGF PIC  X(0001).
  1524     05  FILLER REDEFINES LN15HDGF.
  1525         10  LN15HDGA PIC  X(0001).
  1526     05  LN15HDGI PIC  X(0010).
  1527*    -------------------------------
  1528     05  LN15TXTL PIC S9(0004) COMP.
  1529     05  LN15TXTF PIC  X(0001).
  1530     05  FILLER REDEFINES LN15TXTF.
  1531         10  LN15TXTA PIC  X(0001).
  1532     05  LN15TXTI PIC  X(0068).
  1533*    -------------------------------
  1534     05  LN16HDGL PIC S9(0004) COMP.
  1535     05  LN16HDGF PIC  X(0001).
  1536     05  FILLER REDEFINES LN16HDGF.
  1537         10  LN16HDGA PIC  X(0001).
  1538     05  LN16HDGI PIC  X(0010).
  1539*    -------------------------------
  1540     05  TRLR8BL PIC S9(0004) COMP.
  1541     05  TRLR8BF PIC  X(0001).
  1542     05  FILLER REDEFINES TRLR8BF.
  1543         10  TRLR8BA PIC  X(0001).
  1544     05  TRLR8BI PIC  X(0068).
  1545*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1501.cbl
  1546     05  ERRMSG1L PIC S9(0004) COMP.
  1547     05  ERRMSG1F PIC  X(0001).
  1548     05  FILLER REDEFINES ERRMSG1F.
  1549         10  ERRMSG1A PIC  X(0001).
  1550     05  ERRMSG1I PIC  X(0079).
  1551*    -------------------------------
  1552     05  LINENOL PIC S9(0004) COMP.
  1553     05  LINENOF PIC  X(0001).
  1554     05  FILLER REDEFINES LINENOF.
  1555         10  LINENOA PIC  X(0001).
  1556     05  LINENOI PIC  X(0001).
  1557*    -------------------------------
  1558     05  RECVDTL PIC S9(0004) COMP.
  1559     05  RECVDTF PIC  X(0001).
  1560     05  FILLER REDEFINES RECVDTF.
  1561         10  RECVDTA PIC  X(0001).
  1562     05  RECVDTI PIC  X(0008).
  1563*    -------------------------------
  1564     05  RECVTYPL PIC S9(0004) COMP.
  1565     05  RECVTYPF PIC  X(0001).
  1566     05  FILLER REDEFINES RECVTYPF.
  1567         10  RECVTYPA PIC  X(0001).
  1568     05  RECVTYPI PIC  X(0001).
  1569*    -------------------------------
  1570     05  ENTERPFL PIC S9(0004) COMP.
  1571     05  ENTERPFF PIC  X(0001).
  1572     05  FILLER REDEFINES ENTERPFF.
  1573         10  ENTERPFA PIC  X(0001).
  1574     05  ENTERPFI PIC  99.
  1575*    -------------------------------
  1576     05  PF5L PIC S9(0004) COMP.
  1577     05  PF5F PIC  X(0001).
  1578     05  FILLER REDEFINES PF5F.
  1579         10  PF5A PIC  X(0001).
  1580     05  PF5I PIC  X(0016).
  1581*    -------------------------------
  1582     05  PF6L PIC S9(0004) COMP.
  1583     05  PF6F PIC  X(0001).
  1584     05  FILLER REDEFINES PF6F.
  1585         10  PF6A PIC  X(0001).
  1586     05  PF6I PIC  X(0016).
  1587 01  EL150BO REDEFINES EL150BI.
  1588     05  FILLER            PIC  X(0012).
  1589*    -------------------------------
  1590     05  FILLER            PIC  X(0003).
  1591     05  RUNDTEO PIC  X(0008).
  1592*    -------------------------------
  1593     05  FILLER            PIC  X(0003).
  1594     05  RUNTIMEO PIC  99.99.
  1595*    -------------------------------
  1596     05  FILLER            PIC  X(0003).
  1597     05  CLMNOO PIC  X(0007).
  1598*    -------------------------------
  1599     05  FILLER            PIC  X(0003).
  1600     05  CARRO PIC  X(0001).
  1601*    -------------------------------
  1602     05  FILLER            PIC  X(0003).
  1603     05  CERTNOO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1501.cbl
  1604*    -------------------------------
  1605     05  FILLER            PIC  X(0003).
  1606     05  SUFXO PIC  X(0001).
  1607*    -------------------------------
  1608     05  FILLER            PIC  X(0003).
  1609     05  LN1HDGO PIC  X(0010).
  1610*    -------------------------------
  1611     05  FILLER            PIC  X(0003).
  1612     05  LN1TXTO PIC  X(0068).
  1613*    -------------------------------
  1614     05  FILLER            PIC  X(0003).
  1615     05  LN2HDGO PIC  X(0010).
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
  1618     05  LN2TXTO PIC  X(0068).
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  LN3HDGO PIC  X(0010).
  1622*    -------------------------------
  1623     05  FILLER            PIC  X(0003).
  1624     05  LN3TXTO PIC  X(0068).
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  LN4HDGO PIC  X(0010).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  LN4TXTO PIC  X(0068).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  LN5HDGO PIC  X(0010).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  LN5TXTO PIC  X(0068).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  LN6HDGO PIC  X(0010).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  LN6TXTO PIC  X(0068).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  LN7HDGO PIC  X(0010).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  LN7TXTO PIC  X(0068).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  LN8HDGO PIC  X(0010).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  LN8TXTO PIC  X(0068).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  LN9HDGO PIC  X(0010).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  LN9TXTO PIC  X(0068).
  1661*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1501.cbl
  1662     05  FILLER            PIC  X(0003).
  1663     05  LN10HDGO PIC  X(0010).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  LN10TXTO PIC  X(0068).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  LN11HDGO PIC  X(0010).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  LN11TXTO PIC  X(0068).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  LN12HDGO PIC  X(0010).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  LN12TXTO PIC  X(0068).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  LN13HDGO PIC  X(0010).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  LN13TXTO PIC  X(0068).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  LN14HDGO PIC  X(0010).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  LN14TXTO PIC  X(0068).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  LN15HDGO PIC  X(0010).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  LN15TXTO PIC  X(0068).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  LN16HDGO PIC  X(0010).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  TRLR8BO PIC  X(0068).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  ERRMSG1O PIC  X(0079).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  LINENOO PIC  X(0001).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  RECVDTO PIC  X(0008).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  RECVTYPO PIC  X(0001).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  ENTERPFO PIC  X(0002).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1501.cbl
  1720     05  PF5O PIC  X(0016).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  PF6O PIC  X(0016).
  1724*    -------------------------------
  1725 01  EL150BI-R REDEFINES EL150BI.
  1726     12  FILLER                      PIC X(62).
  1727     12  EL150BI-OCCURS OCCURS 16.
  1728         16  MAP-HDG-LENGTH          PIC S9(4)   COMP.
  1729         16  MAP-HDG-ATTRB           PIC X.
  1730         16  MAP-HDG.
  1731             20  MAP-LINE-NO         PIC X.
  1732             20  FILLER              PIC X.
  1733             20  MAP-HDG-LIT         PIC X(8).
  1734         16  MAP-TEXT-LENGTH         PIC S9(4)   COMP.
  1735         16  MAP-TEXT-ATTRB          PIC X.
  1736         16  MAP-TEXT                PIC X(68).
  1737
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1501.cbl
  1739****************************************************************
  1740*
  1741* Copyright (c) 2007 by Clerity Solutions, Inc.
  1742* All rights reserved.
  1743*
  1744****************************************************************
  1745 01  DFHEIV.
  1746   02  DFHEIV0               PIC X(35).
  1747   02  DFHEIV1               PIC X(08).
  1748   02  DFHEIV2               PIC X(08).
  1749   02  DFHEIV3               PIC X(08).
  1750   02  DFHEIV4               PIC X(06).
  1751   02  DFHEIV5               PIC X(04).
  1752   02  DFHEIV6               PIC X(04).
  1753   02  DFHEIV7               PIC X(02).
  1754   02  DFHEIV8               PIC X(02).
  1755   02  DFHEIV9               PIC X(01).
  1756   02  DFHEIV10              PIC S9(7) COMP-3.
  1757   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1758   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1759   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1760   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1761   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1762   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1763   02  DFHEIV17              PIC X(04).
  1764   02  DFHEIV18              PIC X(04).
  1765   02  DFHEIV19              PIC X(04).
  1766   02  DFHEIV20              USAGE IS POINTER.
  1767   02  DFHEIV21              USAGE IS POINTER.
  1768   02  DFHEIV22              USAGE IS POINTER.
  1769   02  DFHEIV23              USAGE IS POINTER.
  1770   02  DFHEIV24              USAGE IS POINTER.
  1771   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1772   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1773   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1774   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1775   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1776   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1777   02  FILLER                PIC X(02).
  1778   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1779   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1780   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1781   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1782   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1783 LINKAGE  SECTION.
  1784*****************************************************************
  1785*                                                               *
  1786* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1787* All rights reserved.                                          *
  1788*                                                               *
  1789*****************************************************************
  1790 01  dfheiblk.
  1791     02  eibtime          pic s9(7) comp-3.
  1792     02  eibdate          pic s9(7) comp-3.
  1793     02  eibtrnid         pic x(4).
  1794     02  eibtaskn         pic s9(7) comp-3.
  1795     02  eibtrmid         pic x(4).
  1796     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1501.cbl
  1797     02  eibcposn         pic s9(4) comp.
  1798     02  eibcalen         pic s9(4) comp.
  1799     02  eibaid           pic x(1).
  1800     02  eibfiller1       pic x(1).
  1801     02  eibfn            pic x(2).
  1802     02  eibfiller2       pic x(2).
  1803     02  eibrcode         pic x(6).
  1804     02  eibfiller3       pic x(2).
  1805     02  eibds            pic x(8).
  1806     02  eibreqid         pic x(8).
  1807     02  eibrsrce         pic x(8).
  1808     02  eibsync          pic x(1).
  1809     02  eibfree          pic x(1).
  1810     02  eibrecv          pic x(1).
  1811     02  eibsend          pic x(1).
  1812     02  eibatt           pic x(1).
  1813     02  eibeoc           pic x(1).
  1814     02  eibfmh           pic x(1).
  1815     02  eibcompl         pic x(1).
  1816     02  eibsig           pic x(1).
  1817     02  eibconf          pic x(1).
  1818     02  eiberr           pic x(1).
  1819     02  eibrldbk         pic x(1).
  1820     02  eiberrcd         pic x(4).
  1821     02  eibsynrb         pic x(1).
  1822     02  eibnodat         pic x(1).
  1823     02  eibfiller5       pic x(2).
  1824     02  eibresp          pic 9(09) comp.
  1825     02  eibresp2         pic 9(09) comp.
  1826     02  dfheigdj         pic s9(4) comp.
  1827     02  dfheigdk         pic s9(4) comp.
  1828 01  DFHCOMMAREA                     PIC X(1024).
  1829
  1830*                                    COPY ELCMSTR.
  1831******************************************************************
  1832*                                                                *
  1833*                            ELCMSTR.                            *
  1834*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1835*                            VMOD=2.012                          *
  1836*                                                                *
  1837*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1838*                                                                *
  1839*   FILE TYPE = VSAM,KSDS                                        *
  1840*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1841*                                                                *
  1842*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1843*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1844*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1845*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1846*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1847*                                                 RKP=75,LEN=21  *
  1848*                                                                *
  1849*   **** NOTE ****                                               *
  1850*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1851*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1852*                                                                *
  1853*   LOG = YES                                                    *
  1854*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1501.cbl
  1855******************************************************************
  1856*                   C H A N G E   L O G
  1857*
  1858* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1859*-----------------------------------------------------------------
  1860*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1861* EFFECTIVE    NUMBER
  1862*-----------------------------------------------------------------
  1863* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1864* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1865******************************************************************
  1866 01  CLAIM-MASTER.
  1867     12  CL-RECORD-ID                PIC XX.
  1868         88  VALID-CL-ID         VALUE 'CL'.
  1869
  1870     12  CL-CONTROL-PRIMARY.
  1871         16  CL-COMPANY-CD           PIC X.
  1872         16  CL-CARRIER              PIC X.
  1873         16  CL-CLAIM-NO             PIC X(7).
  1874         16  CL-CERT-NO.
  1875             20  CL-CERT-PRIME       PIC X(10).
  1876             20  CL-CERT-SFX         PIC X.
  1877
  1878     12  CL-CONTROL-BY-NAME.
  1879         16  CL-COMPANY-CD-A1        PIC X.
  1880         16  CL-INSURED-LAST-NAME    PIC X(15).
  1881         16  CL-INSURED-NAME.
  1882             20  CL-INSURED-1ST-NAME PIC X(12).
  1883             20  CL-INSURED-MID-INIT PIC X.
  1884
  1885     12  CL-CONTROL-BY-SSN.
  1886         16  CL-COMPANY-CD-A2        PIC X.
  1887         16  CL-SOC-SEC-NO.
  1888             20  CL-SSN-STATE        PIC XX.
  1889             20  CL-SSN-ACCOUNT      PIC X(6).
  1890             20  CL-SSN-LN3          PIC X(3).
  1891
  1892     12  CL-CONTROL-BY-CERT-NO.
  1893         16  CL-COMPANY-CD-A4        PIC X.
  1894         16  CL-CERT-NO-A4.
  1895             20  CL-CERT-A4-PRIME    PIC X(10).
  1896             20  CL-CERT-A4-SFX      PIC X.
  1897
  1898     12  CL-CONTROL-BY-CCN.
  1899         16  CL-COMPANY-CD-A5        PIC X.
  1900         16  CL-CCN-A5.
  1901             20  CL-CCN.
  1902                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1903                 24  CL-CCN-PRIME-A5 PIC X(12).
  1904             20  CL-CCN-FILLER-A5    PIC X(4).
  1905
  1906     12  CL-INSURED-PROFILE-DATA.
  1907         16  CL-INSURED-BIRTH-DT     PIC XX.
  1908         16  CL-INSURED-SEX-CD       PIC X.
  1909             88  INSURED-IS-MALE        VALUE 'M'.
  1910             88  INSURED-IS-FEMALE      VALUE 'F'.
  1911             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1912         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1501.cbl
  1913         16  FILLER                  PIC X(5).
  1914
  1915     12  CL-PROCESSING-INFO.
  1916         16  CL-PROCESSOR-ID         PIC X(4).
  1917         16  CL-CLAIM-STATUS         PIC X.
  1918             88  CLAIM-IS-OPEN          VALUE 'O'.
  1919             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1920         16  CL-CLAIM-TYPE           PIC X.
  1921*            88  AH-CLAIM               VALUE 'A'.
  1922*            88  LIFE-CLAIM             VALUE 'L'.
  1923*            88  PROPERTY-CLAIM         VALUE 'P'.
  1924*            88  IUI-CLAIM              VALUE 'I'.
  1925*            88  GAP-CLAIM              VALUE 'G'.
  1926         16  CL-CLAIM-PREM-TYPE      PIC X.
  1927             88  SINGLE-PREMIUM         VALUE '1'.
  1928             88  O-B-COVERAGE           VALUE '2'.
  1929             88  OPEN-END-COVERAGE      VALUE '3'.
  1930         16  CL-INCURRED-DT          PIC XX.
  1931         16  CL-REPORTED-DT          PIC XX.
  1932         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1933         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1934         16  CL-LAST-PMT-DT          PIC XX.
  1935         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1936         16  CL-PAID-THRU-DT         PIC XX.
  1937         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1938         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1939         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1940         16  CL-PMT-CALC-METHOD      PIC X.
  1941             88  CL-360-DAY-YR          VALUE '1'.
  1942             88  CL-365-DAY-YR          VALUE '2'.
  1943             88  CL-FULL-MONTHS         VALUE '3'.
  1944         16  CL-CAUSE-CD             PIC X(6).
  1945
  1946         16  CL-PRIME-CERT-NO.
  1947             20  CL-PRIME-CERT-PRIME PIC X(10).
  1948             20  CL-PRIME-CERT-SFX   PIC X.
  1949
  1950         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1951             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1952             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1953
  1954         16  CL-MICROFILM-NO         PIC X(10).
  1955         16  CL-PROG-FORM-TYPE       PIC X.
  1956         16  CL-LAST-ADD-ON-DT       PIC XX.
  1957
  1958         16  CL-LAST-REOPEN-DT       PIC XX.
  1959         16  CL-LAST-CLOSE-DT        PIC XX.
  1960         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1961             88  FINAL-PAID             VALUE '1'.
  1962             88  CLAIM-DENIED           VALUE '2'.
  1963             88  AUTO-CLOSE             VALUE '3'.
  1964             88  MANUAL-CLOSE           VALUE '4'.
  1965             88  BENEFITS-CHANGED       VALUE 'C'.
  1966             88  SETUP-ERRORS           VALUE 'E'.
  1967         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1968         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1969         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1970             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1501.cbl
  1971         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1972         16  FILLER                  PIC X.
  1973
  1974     12  CL-CERTIFICATE-DATA.
  1975         16  CL-CERT-ORIGIN          PIC X.
  1976             88  CERT-WAS-ONLINE        VALUE '1'.
  1977             88  CERT-WAS-CREATED       VALUE '2'.
  1978             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1979         16  CL-CERT-KEY-DATA.
  1980             20  CL-CERT-CARRIER     PIC X.
  1981             20  CL-CERT-GROUPING    PIC X(6).
  1982             20  CL-CERT-STATE       PIC XX.
  1983             20  CL-CERT-ACCOUNT.
  1984                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1985                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1986             20  CL-CERT-EFF-DT      PIC XX.
  1987
  1988     12  CL-STATUS-CONTROLS.
  1989         16  CL-PRIORITY-CD          PIC X.
  1990             88  CONFIDENTIAL-DATA      VALUE '8'.
  1991             88  HIGHEST-PRIORITY       VALUE '9'.
  1992         16  CL-SUPV-ATTN-CD         PIC X.
  1993             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1994             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1995         16  CL-PURGED-DT            PIC XX.
  1996         16  CL-RESTORED-DT          PIC XX.
  1997         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1998         16  CL-NEXT-RESEND-DT       PIC XX.
  1999         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  2000         16  FILLER                  PIC XX.
  2001         16  CL-LAST-MAINT-DT        PIC XX.
  2002         16  CL-LAST-MAINT-USER      PIC X(4).
  2003         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  2004         16  CL-LAST-MAINT-TYPE      PIC X.
  2005             88  CLAIM-SET-UP           VALUE ' '.
  2006             88  PAYMENT-MADE           VALUE '1'.
  2007             88  LETTER-SENT            VALUE '2'.
  2008             88  MASTER-WAS-ALTERED     VALUE '3'.
  2009             88  MASTER-WAS-RESTORED    VALUE '4'.
  2010             88  INCURRED-DATE-CHANGED  VALUE '5'.
  2011             88  FILE-CONVERTED         VALUE '6'.
  2012             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  2013             88  ERROR-CORRECTION       VALUE 'E'.
  2014         16  CL-RELATED-CLAIM-NO     PIC X(7).
  2015         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  2016         16  CL-BENEFICIARY          PIC X(10).
  2017         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  2018         16  CL-DENIAL-TYPE          PIC X.
  2019             88  CL-TYPE-DENIAL          VALUE '1'.
  2020             88  CL-TYPE-RESCISSION      VALUE '2'.
  2021             88  CL-TYPE-REFORMATION     VALUE '3'.
  2022             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  2023             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  2024         16  FILLER                  PIC X(5).
  2025
  2026     12  CL-TRAILER-CONTROLS.
  2027         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  2028             88  CL-1ST-TRL-AVAIL       VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1501.cbl
  2029             88  CL-LAST-TRL-AVAIL      VALUE +100.
  2030             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  2031         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  2032         16  FILLER                  PIC XX.
  2033         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  2034         16  CL-ADDRESS-TRAILER-CNT.
  2035             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  2036                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  2037             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  2038                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  2039             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  2040                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  2041             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  2042                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  2043             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  2044                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  2045             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  2046                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  2047             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  2048                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  2049
  2050     12  CL-CV-REFERENCE-NO.
  2051         16  CL-CV-REFNO-PRIME       PIC X(18).
  2052         16  CL-CV-REFNO-SFX         PIC XX.
  2053
  2054     12  CL-FILE-LOCATION            PIC X(4).
  2055
  2056     12  CL-PROCESS-ERRORS.
  2057         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  2058             88  NO-FATAL-ERRORS        VALUE ZERO.
  2059         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  2060             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  2061
  2062     12  CL-PRODUCT-CD               PIC X.
  2063
  2064     12  CL-CURRENT-KEY-DATA.
  2065         16  CL-CURRENT-CARRIER      PIC X.
  2066         16  CL-CURRENT-GROUPING     PIC X(6).
  2067         16  CL-CURRENT-STATE        PIC XX.
  2068         16  CL-CURRENT-ACCOUNT      PIC X(10).
  2069
  2070     12  CL-ASSOCIATES               PIC X.
  2071         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  2072         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  2073         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  2074         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  2075
  2076     12  CL-ACTIVITY-CODE            PIC 99.
  2077     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  2078     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  2079
  2080     12  CL-LAPSE-REPORT-CODE        PIC 9.
  2081     12  CL-LAG-REPORT-CODE          PIC 9.
  2082     12  CL-LOAN-TYPE                PIC XX.
  2083     12  CL-LEGAL-STATE              PIC XX.
  2084
  2085*    12  FILLER                      PIC X(5).
  2086     12  CL-YESNOSW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1501.cbl
  2087     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1501.cbl
  2089*                                    COPY ELCCNTL.
  2090******************************************************************
  2091*                                                                *
  2092*                                                                *
  2093*                            ELCCNTL.                            *
  2094*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2095*                            VMOD=2.059                          *
  2096*                                                                *
  2097*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2098*                                                                *
  2099*   FILE TYPE = VSAM,KSDS                                        *
  2100*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2101*                                                                *
  2102*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2103*       ALTERNATE INDEX = NONE                                   *
  2104*                                                                *
  2105*   LOG = YES                                                    *
  2106*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2107******************************************************************
  2108*                   C H A N G E   L O G
  2109*
  2110* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2111*-----------------------------------------------------------------
  2112*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2113* EFFECTIVE    NUMBER
  2114*-----------------------------------------------------------------
  2115* 082503                   PEMA  ADD BENEFIT GROUP
  2116* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2117* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2118* 092705    2005050300006  PEMA  ADD SPP LEASES
  2119* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2120* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2121* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2122* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2123******************************************************************
  2124*
  2125 01  CONTROL-FILE.
  2126     12  CF-RECORD-ID                       PIC XX.
  2127         88  VALID-CF-ID                        VALUE 'CF'.
  2128
  2129     12  CF-CONTROL-PRIMARY.
  2130         16  CF-COMPANY-ID                  PIC XXX.
  2131         16  CF-RECORD-TYPE                 PIC X.
  2132             88  CF-COMPANY-MASTER              VALUE '1'.
  2133             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2134             88  CF-STATE-MASTER                VALUE '3'.
  2135             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2136             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2137             88  CF-CARRIER-MASTER              VALUE '6'.
  2138             88  CF-MORTALITY-MASTER            VALUE '7'.
  2139             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2140             88  CF-TERMINAL-MASTER             VALUE '9'.
  2141             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2142             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2143             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2144             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2145             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2146             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1501.cbl
  2147             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2148             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2149             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2150         16  CF-ACCESS-CD-GENL              PIC X(4).
  2151         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2152             20  CF-PROCESSOR               PIC X(4).
  2153         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2154             20  CF-STATE-CODE              PIC XX.
  2155             20  FILLER                     PIC XX.
  2156         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2157             20  FILLER                     PIC XX.
  2158             20  CF-HI-BEN-IN-REC           PIC XX.
  2159         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2160             20  FILLER                     PIC XXX.
  2161             20  CF-CARRIER-CNTL            PIC X.
  2162         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2163             20  FILLER                     PIC XX.
  2164             20  CF-HI-TYPE-IN-REC          PIC 99.
  2165         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2166             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2167                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2168             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2169             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2170         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2171             20  FILLER                     PIC X.
  2172             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2173         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2174             20  FILLER                     PIC XX.
  2175             20  CF-MORTGAGE-PLAN           PIC XX.
  2176         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2177
  2178     12  CF-LAST-MAINT-DT                   PIC XX.
  2179     12  CF-LAST-MAINT-BY                   PIC X(4).
  2180     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2181
  2182     12  CF-RECORD-BODY                     PIC X(728).
  2183
  2184
  2185****************************************************************
  2186*             COMPANY MASTER RECORD                            *
  2187****************************************************************
  2188
  2189     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2190         16  CF-COMPANY-ADDRESS.
  2191             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2192             20  CF-CL-IN-CARE-OF           PIC X(30).
  2193             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2194             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2195             20  CF-CL-CITY-STATE           PIC X(30).
  2196             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2197             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2198         16  CF-COMPANY-CD                  PIC X.
  2199         16  CF-COMPANY-PASSWORD            PIC X(8).
  2200         16  CF-SECURITY-OPTION             PIC X.
  2201             88  ALL-SECURITY                   VALUE '1'.
  2202             88  COMPANY-VERIFY                 VALUE '2'.
  2203             88  PROCESSOR-VERIFY               VALUE '3'.
  2204             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1501.cbl
  2205             88  ALL-BUT-TERM                   VALUE '5'.
  2206         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2207             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2208         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2209             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2210         16  CF-INFORCE-LOCATION            PIC X.
  2211             88  CERTS-ARE-ONLINE               VALUE '1'.
  2212             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2213             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2214         16  CF-LOWER-CASE-LETTERS          PIC X.
  2215         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2216             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2217             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2218             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2219             88  CF-ACCNT-CNTL                  VALUE '3'.
  2220             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2221
  2222         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2223         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2224
  2225         16  CF-LGX-CREDIT-USER             PIC X.
  2226             88  CO-IS-NOT-USER                 VALUE 'N'.
  2227             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2228
  2229         16 CF-CREDIT-CALC-CODES.
  2230             20  CF-CR-REM-TERM-CALC PIC X.
  2231               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2232               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2233               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2234               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2235               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2236               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2237               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2238             20  CF-CR-R78-METHOD           PIC X.
  2239               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2240               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2241
  2242         16  CF-CLAIM-CONTROL-COUNTS.
  2243             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2244                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2245
  2246             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2247                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2248
  2249             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2250                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2251
  2252             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2253                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2254
  2255         16  CF-CURRENT-MONTH-END           PIC XX.
  2256
  2257         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2258             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2259             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2260             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2261             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2262                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1501.cbl
  2263                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2264             20  CF-CO-PREM-REJECT-SW       PIC X.
  2265                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2266                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2267             20  CF-CO-REF-REJECT-SW        PIC X.
  2268                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2269                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2270
  2271         16  CF-CO-REPORTING-DT             PIC XX.
  2272         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2273         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2274           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2275           88  CF-CO-MONTH-END                  VALUE '1'.
  2276
  2277         16  CF-LGX-CLAIM-USER              PIC X.
  2278             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2279             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2280
  2281         16  CF-CREDIT-EDIT-CONTROLS.
  2282             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2283             20  CF-MIN-AGE                 PIC 99.
  2284             20  CF-DEFAULT-AGE             PIC 99.
  2285             20  CF-MIN-TERM                PIC S999      COMP-3.
  2286             20  CF-MAX-TERM                PIC S999      COMP-3.
  2287             20  CF-DEFAULT-SEX             PIC X.
  2288             20  CF-JOINT-AGE-INPUT         PIC X.
  2289                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2290             20  CF-BIRTH-DATE-INPUT        PIC X.
  2291                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2292             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2293                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2294                 88  CF-ZERO-CARRIER            VALUE '1'.
  2295                 88  CF-ZERO-GROUPING           VALUE '2'.
  2296                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2297             20  CF-EDIT-SW                 PIC X.
  2298                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2299             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2300             20  CF-CR-PR-METHOD            PIC X.
  2301               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2302               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2303             20  FILLER                     PIC X.
  2304
  2305         16  CF-CREDIT-MISC-CONTROLS.
  2306             20  CF-REIN-TABLE-SW           PIC X.
  2307                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2308             20  CF-COMP-TABLE-SW           PIC X.
  2309                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2310             20  CF-EXPERIENCE-RETENTION-AGE
  2311                                            PIC S9        COMP-3.
  2312             20  CF-CONVERSION-DT           PIC XX.
  2313             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2314             20  CF-RUN-FREQUENCY-SW        PIC X.
  2315                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2316                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2317
  2318             20  CF-CR-CHECK-NO-CONTROL.
  2319                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2320                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL1501.cbl
  2321                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2322                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2323                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2324                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2325
  2326                 24  CF-CR-CHECK-COUNT       REDEFINES
  2327                     CF-CR-CHECK-COUNTER      PIC X(4).
  2328
  2329                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2330                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2331
  2332                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2333                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2334                 24  CF-MAIL-PROCESSING       PIC X.
  2335                     88  MAIL-PROCESSING          VALUE 'Y'.
  2336
  2337         16  CF-MISC-SYSTEM-CONTROL.
  2338             20  CF-SYSTEM-C                 PIC X.
  2339                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2340             20  CF-SYSTEM-D                 PIC X.
  2341                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2342             20  CF-SOC-SEC-NO-SW            PIC X.
  2343                 88  SOC-SEC-NO-USED             VALUE '1'.
  2344             20  CF-MEMBER-NO-SW             PIC X.
  2345                 88  MEMBER-NO-USED              VALUE '1'.
  2346             20  CF-TAX-ID-NUMBER            PIC X(11).
  2347             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2348             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2349                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2350                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2351                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2352                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2353             20  CF-SYSTEM-E                 PIC X.
  2354                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2355
  2356         16  CF-LGX-LIFE-USER               PIC X.
  2357             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2358             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2359
  2360         16  CF-CR-MONTH-END-DT             PIC XX.
  2361
  2362         16  CF-FILE-MAINT-DATES.
  2363             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2364                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2365             20  CF-LAST-BATCH       REDEFINES
  2366                 CF-LAST-BATCH-NO               PIC X(4).
  2367             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2368             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2369             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2370             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2371             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2372             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2373             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2374             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2375             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2376             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2377
  2378         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL1501.cbl
  2379         16  FILLER                         PIC X.
  2380
  2381         16  CF-ALT-MORT-CODE               PIC X(4).
  2382         16  CF-MEMBER-CAPTION              PIC X(10).
  2383
  2384         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2385             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2386             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2387             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2388             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2389             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2390
  2391         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2392
  2393         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2394         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2395         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2396         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2397
  2398         16  CF-AH-OVERRIDE-L1              PIC X.
  2399         16  CF-AH-OVERRIDE-L2              PIC XX.
  2400         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2401         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2402
  2403         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2404         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2405
  2406         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2407         16  CF-AR-LAST-EL860-DT            PIC XX.
  2408         16  CF-MP-MONTH-END-DT             PIC XX.
  2409
  2410         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2411         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2412             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2413
  2414         16  CF-AR-MONTH-END-DT             PIC XX.
  2415
  2416         16  CF-CRDTCRD-USER                PIC X.
  2417             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2418             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2419
  2420         16  CF-CC-MONTH-END-DT             PIC XX.
  2421
  2422         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2423
  2424         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2425             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2426             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2427             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2428         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2429         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2430         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2431         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2432             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2433             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2434         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2435         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2436         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL1501.cbl
  2437             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2438         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2439
  2440         16  CF-CL-ZIP-CODE.
  2441             20  CF-CL-ZIP-PRIME.
  2442                 24  CF-CL-ZIP-1ST          PIC X.
  2443                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2444                 24  FILLER                 PIC X(4).
  2445             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2446         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2447             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2448             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2449             20  FILLER                     PIC XXX.
  2450
  2451         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2452         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2453         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2454         16  CF-CO-OPTION-START-DATE        PIC XX.
  2455         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2456           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2457                                                      '3' '4'.
  2458           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2459           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2460           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2461           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2462           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2463           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2464
  2465         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2466
  2467         16  CF-PAYMENT-APPROVAL-LEVELS.
  2468             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2469             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2470             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2471             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2472             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2473             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2474
  2475         16  CF-END-USER-REPORTING-USER     PIC X.
  2476             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2477             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2478
  2479         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2480             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2481             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2482
  2483         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2484
  2485         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2486         16  FILLER                         PIC X.
  2487
  2488         16  CF-CREDIT-ARCHIVE-CNTL.
  2489             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2490             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2491             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2492
  2493         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2494
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL1501.cbl
  2495         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2496             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2497             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2498
  2499         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2500             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2501             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2502
  2503         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2504
  2505         16  CF-CO-ACH-ID-CODE              PIC  X.
  2506             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2507             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2508             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2509         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2510         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2511         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2512         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2513         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2514         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2515         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2516         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2517         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2518                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2519         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2520                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2521
  2522         16  CF-CO-OVER-SHORT.
  2523             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2524             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2525
  2526*         16  FILLER                         PIC X(102).
  2527         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2528             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2529             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2530
  2531         16  CF-AH-APPROVAL-DAYS.
  2532             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2533             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2534             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2535             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2536
  2537         16  FILLER                         PIC X(82).
  2538****************************************************************
  2539*             PROCESSOR/USER RECORD                            *
  2540****************************************************************
  2541
  2542     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2543         16  CF-PROCESSOR-NAME              PIC X(30).
  2544         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2545         16  CF-PROCESSOR-TITLE             PIC X(26).
  2546         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2547                 88  MESSAGE-YES                VALUE 'Y'.
  2548                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2549
  2550*****************************************************
  2551****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2552****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL1501.cbl
  2553****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2554****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2555*****************************************************
  2556
  2557         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2558             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2559             20  CF-APPLICATION-FORCE       PIC X.
  2560             20  CF-INDIVIDUAL-APP.
  2561                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2562                     28  CF-BROWSE-APP      PIC X.
  2563                     28  CF-UPDATE-APP      PIC X.
  2564
  2565         16  CF-CURRENT-TERM-ON             PIC X(4).
  2566         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2567             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2568             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2569             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2570             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2571             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2572             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2573             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2574         16  CF-PROCESSOR-CARRIER           PIC X.
  2575             88  NO-CARRIER-SECURITY            VALUE ' '.
  2576         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2577             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2578         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2579             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2580         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2581             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2582
  2583         16  CF-PROC-SYS-ACCESS-SW.
  2584             20  CF-PROC-CREDIT-CLAIMS-SW.
  2585                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2586                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2587                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2588                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2589             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2590                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2591                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2592             20  CF-PROC-LIFE-GNRLDGR-SW.
  2593                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2594                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2595                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2596                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2597             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2598                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2599                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2600         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2601             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2602             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2603         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2604
  2605         16  CF-APPROVAL-LEVEL                  PIC X.
  2606             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2607             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2608             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2609             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2610
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL1501.cbl
  2611         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2612
  2613         16  CF-LANGUAGE-TYPE                   PIC X.
  2614             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2615             88  CF-LANG-IS-FR                      VALUE 'F'.
  2616         16  FILLER                             PIC  X(240).
  2617
  2618****************************************************************
  2619*             PROCESSOR/REMINDERS RECORD                       *
  2620****************************************************************
  2621
  2622     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2623         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2624             20  CF-START-REMIND-DT         PIC XX.
  2625             20  CF-END-REMIND-DT           PIC XX.
  2626             20  CF-REMINDER-TEXT           PIC X(50).
  2627         16  FILLER                         PIC X(296).
  2628
  2629
  2630****************************************************************
  2631*             STATE MASTER RECORD                              *
  2632****************************************************************
  2633
  2634     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2635         16  CF-STATE-ABBREVIATION          PIC XX.
  2636         16  CF-STATE-NAME                  PIC X(25).
  2637         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2638         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2639             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2640             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2641             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2642             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2643                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2644                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2645             20  CF-ST-PREM-REJECT-SW       PIC X.
  2646                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2647                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2648             20  CF-ST-REF-REJECT-SW        PIC X.
  2649                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2650                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2651         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2652         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2653         16  CF-ST-REFUND-RULES.
  2654             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2655             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2656             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2657         16  CF-ST-FST-PMT-EXTENSION.
  2658             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2659             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2660                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2661                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2662                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2663                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2664         16  CF-ST-STATE-CALL.
  2665             20  CF-ST-CALL-UNEARNED        PIC X.
  2666             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2667             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2668         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL1501.cbl
  2669             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2670             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2671         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2672         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2673         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2674         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2675         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2676         16  FILLER                         PIC X.
  2677         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2678             20  CF-ST-BENEFIT-CD           PIC XX.
  2679             20  CF-ST-BENEFIT-KIND         PIC X.
  2680                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2681                 88  CF-ST-AH-KIND              VALUE 'A'.
  2682             20  CF-ST-REM-TERM-CALC        PIC X.
  2683                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2684                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2685                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2686                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2687                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2688                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2689                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2690                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2691
  2692             20  CF-ST-REFUND-CALC          PIC X.
  2693                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2694                 88  ST-REFD-BY-R78             VALUE '1'.
  2695                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2696                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2697                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2698                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2699                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2700                 88  ST-REFD-UTAH               VALUE '7'.
  2701                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2702                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2703                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2704
  2705             20  CF-ST-EARNING-CALC         PIC X.
  2706                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2707                 88  ST-EARN-BY-R78             VALUE '1'.
  2708                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2709                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2710                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2711                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2712                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2713                 88  ST-EARN-MEAN               VALUE '8'.
  2714                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2715
  2716             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2717                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2718                 88  ST-OVRD-BY-R78             VALUE '1'.
  2719                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2720                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2721                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2722                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2723                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2724                 88  ST-OVRD-MEAN               VALUE '8'.
  2725                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2726             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL1501.cbl
  2727
  2728         16  CF-ST-COMMISSION-CAPS.
  2729             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2730             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2731             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2732             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2733         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2734                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2735
  2736         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2737
  2738         16  CF-ST-STATUTORY-INTEREST.
  2739             20  CF-ST-STAT-DATE-FROM       PIC X.
  2740                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2741                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2742             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2743             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2744             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2745             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2746             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2747
  2748         16  CF-ST-OVER-SHORT.
  2749             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2750             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2751
  2752         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2753
  2754         16  CF-ST-RT-CALC                  PIC X.
  2755
  2756         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2757         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2758         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2759         16  CF-ST-RF-LR-CALC               PIC X.
  2760         16  CF-ST-RF-LL-CALC               PIC X.
  2761         16  CF-ST-RF-LN-CALC               PIC X.
  2762         16  CF-ST-RF-AH-CALC               PIC X.
  2763         16  CF-ST-RF-CP-CALC               PIC X.
  2764*        16  FILLER                         PIC X(206).
  2765*CIDMOD         16  FILLER                         PIC X(192).
  2766         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2767             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2768         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2769         16  FILLER                         PIC X(187).
  2770
  2771****************************************************************
  2772*             BENEFIT MASTER RECORD                            *
  2773****************************************************************
  2774
  2775     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2776         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2777             20  CF-BENEFIT-CODE            PIC XX.
  2778             20  CF-BENEFIT-NUMERIC  REDEFINES
  2779                 CF-BENEFIT-CODE            PIC XX.
  2780             20  CF-BENEFIT-ALPHA           PIC XXX.
  2781             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2782             20  CF-BENEFIT-COMMENT         PIC X(10).
  2783
  2784             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL1501.cbl
  2785                 88  CF-REDUCING                VALUE 'R'.
  2786                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2787
  2788             20  CF-SPECIAL-CALC-CD         PIC X.
  2789                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2790                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2791                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2792                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2793                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2794                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2795                 88  CF-FARM-PLAN               VALUE 'F'.
  2796                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2797                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2798                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2799                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2800                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2801                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2802                 88  CF-PRUDENTIAL              VALUE 'P'.
  2803                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2804                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2805                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2806                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2807                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2808                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2809
  2810             20  CF-JOINT-INDICATOR         PIC X.
  2811                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2812
  2813*            20  FILLER                     PIC X(12).
  2814             20  FILLER                     PIC X(11).
  2815             20  CF-BENEFIT-CATEGORY        PIC X.
  2816             20  CF-LOAN-TYPE               PIC X(8).
  2817
  2818             20  CF-CO-REM-TERM-CALC        PIC X.
  2819                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2820                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2821                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2822                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2823                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2824
  2825             20  CF-CO-EARNINGS-CALC        PIC X.
  2826                 88  CO-EARN-BY-R78             VALUE '1'.
  2827                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2828                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2829                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2830                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2831                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2832                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2833                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2834
  2835             20  CF-CO-REFUND-CALC          PIC X.
  2836                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2837                 88  CO-REFD-BY-R78             VALUE '1'.
  2838                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2839                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2840                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2841                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2842                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL1501.cbl
  2843                 88  CO-REFD-MEAN               VALUE '8'.
  2844                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2845                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2846                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2847
  2848             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2849                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2850                 88  CO-OVRD-BY-R78             VALUE '1'.
  2851                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2852                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2853                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2854                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2855                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2856                 88  CO-OVRD-MEAN               VALUE '8'.
  2857                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2858
  2859             20  CF-CO-BEN-I-G-CD           PIC X.
  2860                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2861                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2862                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2863
  2864         16  FILLER                         PIC X(304).
  2865
  2866
  2867****************************************************************
  2868*             CARRIER MASTER RECORD                            *
  2869****************************************************************
  2870
  2871     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2872         16  CF-ADDRESS-DATA.
  2873             20  CF-MAIL-TO-NAME            PIC X(30).
  2874             20  CF-IN-CARE-OF              PIC X(30).
  2875             20  CF-ADDRESS-LINE-1          PIC X(30).
  2876             20  CF-ADDRESS-LINE-2          PIC X(30).
  2877             20  CF-CITY-STATE              PIC X(30).
  2878             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2879             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2880
  2881         16  CF-CLAIM-NO-CONTROL.
  2882             20  CF-CLAIM-NO-METHOD         PIC X.
  2883                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2884                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2885                 88  CLAIM-NO-SEQ               VALUE '3'.
  2886                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2887             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2888                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2889                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2890                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2891
  2892         16  CF-CHECK-NO-CONTROL.
  2893             20  CF-CHECK-NO-METHOD         PIC X.
  2894                 88  CHECK-NO-MANUAL            VALUE '1'.
  2895                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2896                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2897                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2898             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2899                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2900
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL1501.cbl
  2901         16  CF-DOMICILE-STATE              PIC XX.
  2902
  2903         16  CF-EXPENSE-CONTROLS.
  2904             20  CF-EXPENSE-METHOD          PIC X.
  2905                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2906                 88  DOLLARS-PER-PMT            VALUE '2'.
  2907                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2908                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2909             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2910             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2911
  2912         16  CF-CORRESPONDENCE-CONTROL.
  2913             20  CF-LETTER-RESEND-OPT       PIC X.
  2914                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2915                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2916             20  FILLER                     PIC X(4).
  2917
  2918         16  CF-RESERVE-CONTROLS.
  2919             20  CF-MANUAL-SW               PIC X.
  2920                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2921             20  CF-FUTURE-SW               PIC X.
  2922                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2923             20  CF-PTC-SW                  PIC X.
  2924                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2925             20  CF-IBNR-SW                 PIC X.
  2926                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2927             20  CF-PTC-LF-SW               PIC X.
  2928                 88  CF-LF-PTC-USED             VALUE '1'.
  2929             20  CF-CDT-ACCESS-METHOD       PIC X.
  2930                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2931                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2932                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2933             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2934
  2935         16  CF-CLAIM-CALC-METHOD           PIC X.
  2936             88  360-PLUS-MONTHS                VALUE '1'.
  2937             88  365-PLUS-MONTHS                VALUE '2'.
  2938             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2939             88  360-DAILY                      VALUE '4'.
  2940             88  365-DAILY                      VALUE '5'.
  2941
  2942         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2943         16  FILLER                         PIC X(11).
  2944
  2945         16  CF-LIMIT-AMOUNTS.
  2946             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2947             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2948             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2949             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2950             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2951             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2952             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2953             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2954             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2955             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2956
  2957         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2958         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL1501.cbl
  2959         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2960
  2961         16  CF-ZIP-CODE.
  2962             20  CF-ZIP-PRIME.
  2963                 24  CF-ZIP-1ST             PIC X.
  2964                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2965                 24  FILLER                 PIC X(4).
  2966             20  CF-ZIP-PLUS4               PIC X(4).
  2967         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2968             20  CF-CAN-POSTAL-1            PIC XXX.
  2969             20  CF-CAN-POSTAL-2            PIC XXX.
  2970             20  FILLER                     PIC XXX.
  2971
  2972         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2973         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2974         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2975
  2976         16  CF-RATING-SWITCH               PIC X.
  2977             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2978             88  CF-NO-RATING                   VALUE 'N'.
  2979
  2980         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2981
  2982         16  CF-CARRIER-OVER-SHORT.
  2983             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2984             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2985
  2986         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2987         16  CF-SECPAY-SWITCH               PIC X.
  2988             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2989             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2990         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2991         16  FILLER                         PIC X(448).
  2992*        16  FILLER                         PIC X(452).
  2993
  2994
  2995****************************************************************
  2996*             MORTALITY MASTER RECORD                          *
  2997****************************************************************
  2998
  2999     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3000         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3001                                INDEXED BY CF-MORT-NDX.
  3002             20  CF-MORT-TABLE              PIC X(5).
  3003             20  CF-MORT-TABLE-TYPE         PIC X.
  3004                 88  CF-MORT-JOINT              VALUE 'J'.
  3005                 88  CF-MORT-SINGLE             VALUE 'S'.
  3006                 88  CF-MORT-COMBINED           VALUE 'C'.
  3007                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3008                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3009             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3010             20  CF-MORT-AGE-METHOD         PIC XX.
  3011                 88  CF-AGE-LAST                VALUE 'AL'.
  3012                 88  CF-AGE-NEAR                VALUE 'AN'.
  3013             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3014             20  CF-MORT-ADJUSTMENT-DIRECTION
  3015                                            PIC X.
  3016                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL1501.cbl
  3017                 88  CF-PLUS                    VALUE '+'.
  3018             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3019             20  CF-MORT-JOINT-CODE         PIC X.
  3020                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3021             20  CF-MORT-PC-Q               PIC X.
  3022                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3023             20  CF-MORT-TABLE-CODE         PIC X(4).
  3024             20  CF-MORT-COMMENTS           PIC X(15).
  3025             20  FILLER                     PIC X(14).
  3026
  3027         16  FILLER                         PIC X(251).
  3028
  3029
  3030****************************************************************
  3031*             BUSSINESS TYPE MASTER RECORD                     *
  3032****************************************************************
  3033
  3034     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3035* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3036* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3037* AND RECORD 05 IS TYPES 81-99
  3038         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3039             20  CF-BUSINESS-TITLE          PIC  X(19).
  3040             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3041                                            PIC S9V9(4) COMP-3.
  3042             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3043             20  FILLER                     PIC  X.
  3044         16  FILLER                         PIC  X(248).
  3045
  3046
  3047****************************************************************
  3048*             TERMINAL MASTER RECORD                           *
  3049****************************************************************
  3050
  3051     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3052
  3053         16  CF-COMPANY-TERMINALS.
  3054             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3055                                  PIC X(4).
  3056         16  FILLER               PIC X(248).
  3057
  3058
  3059****************************************************************
  3060*             LIFE EDIT MASTER RECORD                          *
  3061****************************************************************
  3062
  3063     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3064         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3065             20  CF-LIFE-CODE-IN            PIC XX.
  3066             20  CF-LIFE-CODE-OUT           PIC XX.
  3067         16  FILLER                         PIC X(248).
  3068
  3069
  3070****************************************************************
  3071*             AH EDIT MASTER RECORD                            *
  3072****************************************************************
  3073
  3074     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL1501.cbl
  3075         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3076             20  CF-AH-CODE-IN              PIC XXX.
  3077             20  CF-AH-CODE-OUT             PIC XX.
  3078         16  FILLER                         PIC X(248).
  3079
  3080
  3081****************************************************************
  3082*             CREDIBILITY TABLES                               *
  3083****************************************************************
  3084
  3085     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3086         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3087                             INDEXED BY CF-CRDB-NDX.
  3088             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3089             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3090             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3091         16  FILLER                         PIC  X(332).
  3092
  3093
  3094****************************************************************
  3095*             REPORT CUSTOMIZATION RECORD                      *
  3096****************************************************************
  3097
  3098     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3099         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3100             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3101             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3102             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3103**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3104****       A T-TRANSFER.                                   ****
  3105             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3106
  3107         16  FILLER                         PIC XX.
  3108
  3109         16  CF-CARRIER-CNTL-OPT.
  3110             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3111                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3112                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3113             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3114                                            PIC X.
  3115         16  CF-GROUP-CNTL-OPT.
  3116             20  CF-GROUP-OPT-SEQ           PIC 9.
  3117                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3118                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3119             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3120                                            PIC X(6).
  3121         16  CF-STATE-CNTL-OPT.
  3122             20  CF-STATE-OPT-SEQ           PIC 9.
  3123                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3124                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3125             20  CF-STATE-SELECT OCCURS 3 TIMES
  3126                                            PIC XX.
  3127         16  CF-ACCOUNT-CNTL-OPT.
  3128             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3129                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3130                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3131             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3132                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL1501.cbl
  3133         16  CF-BUS-TYP-CNTL-OPT.
  3134             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3135                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3136                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3137             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3138                                            PIC XX.
  3139         16  CF-LF-TYP-CNTL-OPT.
  3140             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3141                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3142                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3143             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3144                                            PIC XX.
  3145         16  CF-AH-TYP-CNTL-OPT.
  3146             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3147                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3148                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3149             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3150                                            PIC XX.
  3151         16  CF-REPTCD1-CNTL-OPT.
  3152             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3153                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3154                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3155             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3156                                            PIC X(10).
  3157         16  CF-REPTCD2-CNTL-OPT.
  3158             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3159                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3160                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3161             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3162                                            PIC X(10).
  3163         16  CF-USER1-CNTL-OPT.
  3164             20  CF-USER1-OPT-SEQ           PIC 9.
  3165                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3166                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3167             20  CF-USER1-SELECT OCCURS 3 TIMES
  3168                                            PIC X(10).
  3169         16  CF-USER2-CNTL-OPT.
  3170             20  CF-USER2-OPT-SEQ           PIC 9.
  3171                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3172                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3173             20  CF-USER2-SELECT OCCURS 3 TIMES
  3174                                            PIC X(10).
  3175         16  CF-USER3-CNTL-OPT.
  3176             20  CF-USER3-OPT-SEQ           PIC 9.
  3177                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3178                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3179             20  CF-USER3-SELECT OCCURS 3 TIMES
  3180                                            PIC X(10).
  3181         16  CF-USER4-CNTL-OPT.
  3182             20  CF-USER4-OPT-SEQ           PIC 9.
  3183                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3184                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3185             20  CF-USER4-SELECT OCCURS 3 TIMES
  3186                                            PIC X(10).
  3187         16  CF-USER5-CNTL-OPT.
  3188             20  CF-USER5-OPT-SEQ           PIC 9.
  3189                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3190                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL1501.cbl
  3191             20  CF-USER5-SELECT OCCURS 3 TIMES
  3192                                            PIC X(10).
  3193         16  CF-REINS-CNTL-OPT.
  3194             20  CF-REINS-OPT-SEQ           PIC 9.
  3195                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3196                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3197             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3198                 24  CF-REINS-PRIME         PIC XXX.
  3199                 24  CF-REINS-SUB           PIC XXX.
  3200
  3201         16  CF-AGENT-CNTL-OPT.
  3202             20  CF-AGENT-OPT-SEQ           PIC 9.
  3203                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3204                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3205             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3206                                            PIC X(10).
  3207
  3208         16  FILLER                         PIC X(43).
  3209
  3210         16  CF-LOSS-RATIO-SELECT.
  3211             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3212             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3213         16  CF-ENTRY-DATE-SELECT.
  3214             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3215             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3216         16  CF-EFFECTIVE-DATE-SELECT.
  3217             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3218             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3219
  3220         16  CF-EXCEPTION-LIST-IND          PIC X.
  3221             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3222
  3223         16  FILLER                         PIC X(318).
  3224
  3225****************************************************************
  3226*                  EXCEPTION REPORTING RECORD                  *
  3227****************************************************************
  3228
  3229     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3230         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3231             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3232
  3233         16  CF-COMBINED-LIFE-AH-OPT.
  3234             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3235             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3236             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3237             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3238
  3239         16  CF-LIFE-OPT.
  3240             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3241             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3242             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3243             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3244             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3245             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3246             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3247             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3248             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL1501.cbl
  3249             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3250
  3251         16  CF-AH-OPT.
  3252             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3253             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3254             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3255             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3256             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3257             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3258             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3259             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3260             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3261             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3262
  3263         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3264             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3265             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3266             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3267
  3268         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3269
  3270         16  FILLER                         PIC X(673).
  3271
  3272
  3273****************************************************************
  3274*             MORTGAGE SYSTEM PLAN RECORD                      *
  3275****************************************************************
  3276
  3277     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3278         16  CF-PLAN-TYPE                   PIC X.
  3279             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3280             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3281             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3282         16  CF-PLAN-ABBREV                 PIC XXX.
  3283         16  CF-PLAN-DESCRIPT               PIC X(10).
  3284         16  CF-PLAN-NOTES                  PIC X(20).
  3285         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3286         16  CF-PLAN-UNDERWRITING.
  3287             20  CF-PLAN-TERM-DATA.
  3288                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3289                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3290             20  CF-PLAN-AGE-DATA.
  3291                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3292                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3293                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3294             20  CF-PLAN-BENEFIT-DATA.
  3295                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3296                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3297                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3298                                            PIC S9(7)V99  COMP-3.
  3299         16  CF-PLAN-POLICY-FORMS.
  3300             20  CF-POLICY-FORM             PIC X(12).
  3301             20  CF-MASTER-APPLICATION      PIC X(12).
  3302             20  CF-MASTER-POLICY           PIC X(12).
  3303         16  CF-PLAN-RATING.
  3304             20  CF-RATE-CODE               PIC X(5).
  3305             20  CF-SEX-RATING              PIC X.
  3306                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL1501.cbl
  3307                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3308             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3309             20  CF-SUB-STD-TYPE            PIC X.
  3310                 88  CF-PCT-OF-PREM            VALUE '1'.
  3311                 88  CF-PCT-OF-BENE            VALUE '2'.
  3312         16  CF-PLAN-PREM-TOLERANCES.
  3313             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3314             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3315         16  CF-PLAN-PYMT-TOLERANCES.
  3316             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3317             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3318         16  CF-PLAN-MISC-DATA.
  3319             20  FILLER                     PIC X.
  3320             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3321             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3322         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3323         16  CF-PLAN-IND-GRP                PIC X.
  3324             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3325                                                     '1'.
  3326             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3327                                                     '2'.
  3328         16  CF-MIB-SEARCH-SW               PIC X.
  3329             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3330             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3331             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3332             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3333         16  CF-ALPHA-SEARCH-SW             PIC X.
  3334             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3335             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3336             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3337             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3338             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3339             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3340             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3341             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3342             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3343             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3344                                                     'A' 'B' 'C'
  3345                                                     'X' 'Y' 'Z'.
  3346         16  CF-EFF-DT-RULE-SW              PIC X.
  3347             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3348             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3349             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3350             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3351             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3352         16  FILLER                         PIC X(4).
  3353         16  CF-HEALTH-QUESTIONS            PIC X.
  3354             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3355         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3356         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3357         16  CF-PLAN-SNGL-JNT               PIC X.
  3358             88  CF-COMBINED-PLAN              VALUE 'C'.
  3359             88  CF-JNT-PLAN                   VALUE 'J'.
  3360             88  CF-SNGL-PLAN                  VALUE 'S'.
  3361         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3362         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3363         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3364         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL1501.cbl
  3365         16  CF-RERATE-CNTL                 PIC  X.
  3366             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3367             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3368             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3369             88  CF-AUTO-RECALC                 VALUE '4'.
  3370         16  CF-BENEFIT-TYPE                PIC  X.
  3371             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3372             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3373         16  CF-POLICY-FEE                  PIC S999V99
  3374                                                    COMP-3.
  3375         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3376         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3377         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3378         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3379         16  FILLER                         PIC  X(32).
  3380         16  CF-TERMINATION-FORM            PIC  X(04).
  3381         16  FILLER                         PIC  X(08).
  3382         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3383                                                       COMP-3.
  3384         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3385         16  CF-ISSUE-LETTER                PIC  X(4).
  3386         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3387         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3388             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3389             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3390         16  CF-MP-REFUND-CALC              PIC X.
  3391             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3392             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3393             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3394             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3395             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3396             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3397             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3398             88  CF-MP-REFD-MEAN                VALUE '8'.
  3399         16  CF-ALT-RATE-CODE               PIC  X(5).
  3400
  3401
  3402         16  FILLER                         PIC X(498).
  3403****************************************************************
  3404*             MORTGAGE COMPANY MASTER RECORD                   *
  3405****************************************************************
  3406
  3407     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3408         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3409         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3410             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3411             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3412             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3413             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3414             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3415
  3416         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3417         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3418         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3419         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3420         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3421
  3422         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL1501.cbl
  3423             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3424         16  CF-MP-RECON-USE-IND            PIC X(1).
  3425             88  CF-MP-USE-RECON             VALUE 'Y'.
  3426         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3427             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3428         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3429             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3430             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3431         16  FILLER                         PIC X(1).
  3432         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3433             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3434         16  CF-MORTG-MIB-VERSION           PIC X.
  3435             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3436             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3437             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3438         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3439             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3440                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3441             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3442                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3443             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3444                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3445             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3446                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3447             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3448                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3449             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3450                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3451         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3452         16  FILLER                         PIC X(7).
  3453         16  CF-MORTG-DESTINATION-SYMBOL.
  3454             20  CF-MORTG-MIB-COMM          PIC X(5).
  3455             20  CF-MORTG-MIB-TERM          PIC X(5).
  3456         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3457             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3458         16  FILLER                         PIC X(03).
  3459         16  CF-MP-CHECK-NO-CONTROL.
  3460             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3461                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3462                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3463                                                ' ' LOW-VALUES.
  3464                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3465                                               VALUE '3'.
  3466         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3467         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3468         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3469             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3470                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3471             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3472                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3473             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3474                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3475             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3476                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3477             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3478                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3479             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3480                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL1501.cbl
  3481         16  CF-MORTG-BILLING-AREA.
  3482             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3483                                            PIC X.
  3484         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3485         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3486         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3487         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3488             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3489             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3490         16  FILLER                         PIC X.
  3491         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3492             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3493             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3494         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3495         16  FILLER                         PIC X(8).
  3496         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3497         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3498         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3499         16  CF-ACH-COMPANY-ID.
  3500             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3501                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3502                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3503                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3504             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3505         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3506             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3507         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3508             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3509             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3510         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3511         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3512         16  FILLER                         PIC X(536).
  3513
  3514****************************************************************
  3515*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3516****************************************************************
  3517
  3518     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3519         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3520             20  CF-FEMALE-HEIGHT.
  3521                 24  CF-FEMALE-FT           PIC 99.
  3522                 24  CF-FEMALE-IN           PIC 99.
  3523             20  CF-FEMALE-MIN-WT           PIC 999.
  3524             20  CF-FEMALE-MAX-WT           PIC 999.
  3525         16  FILLER                         PIC X(428).
  3526
  3527     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3528         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3529             20  CF-MALE-HEIGHT.
  3530                 24  CF-MALE-FT             PIC 99.
  3531                 24  CF-MALE-IN             PIC 99.
  3532             20  CF-MALE-MIN-WT             PIC 999.
  3533             20  CF-MALE-MAX-WT             PIC 999.
  3534         16  FILLER                         PIC X(428).
  3535******************************************************************
  3536*             AUTOMATIC ACTIVITY RECORD                          *
  3537******************************************************************
  3538     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL1501.cbl
  3539         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3540             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3541             20  CF-SYS-LETTER-ID           PIC X(04).
  3542             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3543             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3544             20  CF-SYS-RESET-SW            PIC X(01).
  3545             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3546             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3547
  3548         16  FILLER                         PIC X(50).
  3549
  3550         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3551             20  CF-USER-ACTIVE-SW          PIC X(01).
  3552             20  CF-USER-LETTER-ID          PIC X(04).
  3553             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3554             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3555             20  CF-USER-RESET-SW           PIC X(01).
  3556             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3557             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3558             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3559
  3560         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL1501.cbl
  3562*                                    COPY ELCCERT.
  3563******************************************************************
  3564*                                                                *
  3565*                            ELCCERT.                            *
  3566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3567*                            VMOD=2.013                          *
  3568*                                                                *
  3569*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3570*                                                                *
  3571*   FILE TYPE = VSAM,KSDS                                        *
  3572*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3573*                                                                *
  3574*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3575*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3576*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3577*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3578*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3579*                                                                *
  3580*   LOG = YES                                                    *
  3581*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3582******************************************************************
  3583*                   C H A N G E   L O G
  3584*
  3585* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3586*-----------------------------------------------------------------
  3587*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3588* EFFECTIVE    NUMBER
  3589*-----------------------------------------------------------------
  3590* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3591* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3592* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3593* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3594* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3595* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3596* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3597******************************************************************
  3598
  3599 01  CERTIFICATE-MASTER.
  3600     12  CM-RECORD-ID                      PIC XX.
  3601         88  VALID-CM-ID                      VALUE 'CM'.
  3602
  3603     12  CM-CONTROL-PRIMARY.
  3604         16  CM-COMPANY-CD                 PIC X.
  3605         16  CM-CARRIER                    PIC X.
  3606         16  CM-GROUPING.
  3607             20  CM-GROUPING-PREFIX        PIC X(3).
  3608             20  CM-GROUPING-PRIME         PIC X(3).
  3609         16  CM-STATE                      PIC XX.
  3610         16  CM-ACCOUNT.
  3611             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3612             20  CM-ACCOUNT-PRIME          PIC X(6).
  3613         16  CM-CERT-EFF-DT                PIC XX.
  3614         16  CM-CERT-NO.
  3615             20  CM-CERT-PRIME             PIC X(10).
  3616             20  CM-CERT-SFX               PIC X.
  3617
  3618     12  CM-CONTROL-BY-NAME.
  3619         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL1501.cbl
  3620         16  CM-INSURED-LAST-NAME          PIC X(15).
  3621         16  CM-INSURED-INITIALS.
  3622             20  CM-INSURED-INITIAL1       PIC X.
  3623             20  CM-INSURED-INITIAL2       PIC X.
  3624
  3625     12  CM-CONTROL-BY-SSN.
  3626         16  CM-COMPANY-CD-A2              PIC X.
  3627         16  CM-SOC-SEC-NO.
  3628             20  CM-SSN-STATE              PIC XX.
  3629             20  CM-SSN-ACCOUNT            PIC X(6).
  3630             20  CM-SSN-LN3.
  3631                 25  CM-INSURED-INITIALS-A2.
  3632                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3633                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3634                 25 CM-PART-LAST-NAME-A2         PIC X.
  3635
  3636     12  CM-CONTROL-BY-CERT-NO.
  3637         16  CM-COMPANY-CD-A4              PIC X.
  3638         16  CM-CERT-NO-A4                 PIC X(11).
  3639
  3640     12  CM-CONTROL-BY-MEMB.
  3641         16  CM-COMPANY-CD-A5              PIC X.
  3642         16  CM-MEMBER-NO.
  3643             20  CM-MEMB-STATE             PIC XX.
  3644             20  CM-MEMB-ACCOUNT           PIC X(6).
  3645             20  CM-MEMB-LN4.
  3646                 25  CM-INSURED-INITIALS-A5.
  3647                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3648                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3649                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3650
  3651     12  CM-INSURED-PROFILE-DATA.
  3652         16  CM-INSURED-FIRST-NAME.
  3653             20  CM-INSURED-1ST-INIT       PIC X.
  3654             20  FILLER                    PIC X(9).
  3655         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3656         16  CM-INSURED-SEX                PIC X.
  3657             88  CM-SEX-MALE                  VALUE 'M'.
  3658             88  CM-SEX-FEMAL                 VALUE 'F'.
  3659         16  CM-INSURED-JOINT-AGE          PIC 99.
  3660         16  CM-JOINT-INSURED-NAME.
  3661             20  CM-JT-LAST-NAME           PIC X(15).
  3662             20  CM-JT-FIRST-NAME.
  3663                 24  CM-JT-1ST-INIT        PIC X.
  3664                 24  FILLER                PIC X(9).
  3665             20  CM-JT-INITIAL             PIC X.
  3666
  3667     12  CM-LIFE-DATA.
  3668         16  CM-LF-BENEFIT-CD              PIC XX.
  3669         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3670         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3671         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3672         16  CM-LF-DEV-CODE                PIC XXX.
  3673         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3674         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3675         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3676         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3677         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL1501.cbl
  3678         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3679         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3680         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3681         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3682         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3683         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3684         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3685         16  FILLER                        PIC XX.
  3686
  3687     12  CM-AH-DATA.
  3688         16  CM-AH-BENEFIT-CD              PIC XX.
  3689         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3690         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3691         16  CM-AH-DEV-CODE                PIC XXX.
  3692         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3693         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3694         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3695         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3696         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3697         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3698         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3699         16  CM-AH-PAID-THRU-DT            PIC XX.
  3700             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3701         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3702         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3703         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3704         16  FILLER                        PIC X.
  3705
  3706     12  CM-LOAN-INFORMATION.
  3707         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3708         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3709         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3710         16  CM-PAY-FREQUENCY              PIC S99.
  3711         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3712         16  CM-RATE-CLASS                 PIC XX.
  3713         16  CM-BENEFICIARY                PIC X(25).
  3714         16  CM-POLICY-FORM-NO             PIC X(12).
  3715         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3716         16  CM-LAST-ADD-ON-DT             PIC XX.
  3717         16  CM-DEDUCTIBLE-AMOUNTS.
  3718             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3719             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3720         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3721             20  CM-RESIDENT-STATE         PIC XX.
  3722             20  CM-RATE-CODE              PIC X(4).
  3723             20  FILLER                    PIC XX.
  3724         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3725             20  CM-LOAN-OFFICER           PIC X(5).
  3726             20  FILLER                    PIC XXX.
  3727         16  CM-CSR-CODE                   PIC XXX.
  3728         16  CM-UNDERWRITING-CODE          PIC X.
  3729             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3730         16  CM-POST-CARD-IND              PIC X.
  3731         16  CM-NH-INTERFACE-SW            PIC X.
  3732         16  CM-PREMIUM-TYPE               PIC X.
  3733             88  CM-SING-PRM                  VALUE '1'.
  3734             88  CM-O-B-COVERAGE              VALUE '2'.
  3735             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL1501.cbl
  3736         16  CM-IND-GRP-TYPE               PIC X.
  3737             88  CM-INDIVIDUAL                VALUE 'I'.
  3738             88  CM-GROUP                     VALUE 'G'.
  3739         16  CM-SKIP-CODE                  PIC X.
  3740             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3741             88  SKIP-JULY                    VALUE '1'.
  3742             88  SKIP-AUGUST                  VALUE '2'.
  3743             88  SKIP-SEPTEMBER               VALUE '3'.
  3744             88  SKIP-JULY-AUG                VALUE '4'.
  3745             88  SKIP-AUG-SEPT                VALUE '5'.
  3746             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3747             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3748             88  SKIP-JUNE                    VALUE '8'.
  3749             88  SKIP-JUNE-JULY               VALUE '9'.
  3750             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3751             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3752         16  CM-PAYMENT-MODE               PIC X.
  3753             88  PAY-MONTHLY                  VALUE SPACE.
  3754             88  PAY-WEEKLY                   VALUE '1'.
  3755             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3756             88  PAY-BI-WEEKLY                VALUE '3'.
  3757             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3758         16  CM-LOAN-NUMBER                PIC X(8).
  3759         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3760         16  CM-OLD-LOF                    PIC XXX.
  3761*        16  CM-LOAN-OFFICER               PIC XXX.
  3762         16  CM-REIN-TABLE                 PIC XXX.
  3763         16  CM-SPECIAL-REIN-CODE          PIC X.
  3764         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3765         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3766         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3767
  3768     12  CM-STATUS-DATA.
  3769         16  CM-ENTRY-STATUS               PIC X.
  3770         16  CM-ENTRY-DT                   PIC XX.
  3771
  3772         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3773         16  CM-LF-CANCEL-DT               PIC XX.
  3774         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3775
  3776         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3777         16  CM-LF-DEATH-DT                PIC XX.
  3778         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3779
  3780         16  CM-LF-CURRENT-STATUS          PIC X.
  3781             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3782                                                'M' '4' '5' '9'.
  3783             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3784             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3785             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3786             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3787             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3788             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3789             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3790             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3791             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3792             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3793             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL1501.cbl
  3794             88  CM-LF-VOIDED                 VALUE 'V'.
  3795
  3796         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3797         16  CM-AH-CANCEL-DT               PIC XX.
  3798         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3799
  3800         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3801         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3802         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3803
  3804         16  CM-AH-CURRENT-STATUS          PIC X.
  3805             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3806                                                'M' '4' '5' '9'.
  3807             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3808             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3809             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3810             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3811             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3812             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3813             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3814             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3815             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3816             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  3817             88  CM-AH-DECLINED               VALUE 'D'.
  3818             88  CM-AH-VOIDED                 VALUE 'V'.
  3819
  3820         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3821             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3822             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3823             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3824         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3825
  3826         16  CM-ENTRY-BATCH                PIC X(6).
  3827         16  CM-LF-EXIT-BATCH              PIC X(6).
  3828         16  CM-AH-EXIT-BATCH              PIC X(6).
  3829         16  CM-LAST-MONTH-END             PIC XX.
  3830
  3831     12  CM-NOTE-SW                        PIC X.
  3832         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3833         88  CERT-NOTES-PRESENT               VALUE '1'.
  3834         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3835         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3836         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3837         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3838         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3839         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3840     12  CM-COMP-EXCP-SW                   PIC X.
  3841         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3842         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3843     12  CM-INSURED-ADDRESS-SW             PIC X.
  3844         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  3845         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3846
  3847*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3848     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  3849     12  FILLER                            PIC X.
  3850
  3851*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL1501.cbl
  3852     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3853     12  FILLER                            PIC X.
  3854*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3855     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3856
  3857     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3858         88  CERT-ADDED-BATCH                 VALUE ' '.
  3859         88  CERT-ADDED-ONLINE                VALUE '1'.
  3860         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3861         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3862         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3863     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3864         88  CERT-AS-LOADED                   VALUE ' '.
  3865         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3866         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3867         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3868         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3869         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3870         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3871         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3872
  3873     12  CM-ACCOUNT-COMM-PCTS.
  3874         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  3875         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3876
  3877     12  CM-USER-FIELD                     PIC X.
  3878     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  3879     12  CM-CLP-STATE                      PIC XX.
  3880     12  CM-USER-RESERVED                  PIC XXX.
  3881******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL1501.cbl
  3883*                                    COPY ELCTRLR.
  3884******************************************************************
  3885*                                                                *
  3886*                            ELCTRLR.                            *
  3887*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3888*                            VMOD=2.014                          *
  3889*                                                                *
  3890*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  3891*                                                                *
  3892*   FILE TYPE = VSAM,KSDS                                        *
  3893*   RECORD SIZE = 200    RECFORM = FIXED                         *
  3894*                                                                *
  3895*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  3896*       ALTERNATE INDEX = NONE                                   *
  3897*                                                                *
  3898*   LOG = YES                                                    *
  3899*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3900******************************************************************
  3901*                   C H A N G E   L O G
  3902*
  3903* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3904*-----------------------------------------------------------------
  3905*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3906* EFFECTIVE    NUMBER
  3907*-----------------------------------------------------------------
  3908* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3909* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  3910* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  3911* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  3912* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  3913* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  3914* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  3915* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  3916* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  3917* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  3918* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  3919* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  3920******************************************************************
  3921 01  ACTIVITY-TRAILERS.
  3922     12  AT-RECORD-ID                    PIC XX.
  3923         88  VALID-AT-ID                       VALUE 'AT'.
  3924
  3925     12  AT-CONTROL-PRIMARY.
  3926         16  AT-COMPANY-CD               PIC X.
  3927         16  AT-CARRIER                  PIC X.
  3928         16  AT-CLAIM-NO                 PIC X(7).
  3929         16  AT-CERT-NO.
  3930             20  AT-CERT-PRIME           PIC X(10).
  3931             20  AT-CERT-SFX             PIC X.
  3932         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  3933             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  3934             88  AT-LAST-TRL-AVAIL            VALUE +100.
  3935             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  3936             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  3937             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  3938             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  3939             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  3940             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL1501.cbl
  3941             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  3942             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  3943             88  AT-DIAGNOSIS-TRL             VALUE +90.
  3944             88  AT-BENEFICIARY-TRL           VALUE +91.
  3945             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  3946
  3947     12  AT-TRAILER-TYPE                 PIC X.
  3948         88  RESERVE-EXPENSE-TR               VALUE '1'.
  3949         88  PAYMENT-TR                       VALUE '2'.
  3950         88  AUTO-PAY-TR                      VALUE '3'.
  3951         88  CORRESPONDENCE-TR                VALUE '4'.
  3952         88  ADDRESS-TR                       VALUE '5'.
  3953         88  GENERAL-INFO-TR                  VALUE '6'.
  3954         88  AUTO-PROMPT-TR                   VALUE '7'.
  3955         88  DENIAL-TR                        VALUE '8'.
  3956         88  INCURRED-CHG-TR                  VALUE '9'.
  3957         88  FORM-CONTROL-TR                  VALUE 'A'.
  3958
  3959     12  AT-RECORDED-DT                  PIC XX.
  3960     12  AT-RECORDED-BY                  PIC X(4).
  3961     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  3962
  3963     12  AT-TRAILER-BODY                 PIC X(165).
  3964
  3965     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  3966         16  AT-RESERVE-CONTROLS.
  3967             20  AT-MANUAL-SW            PIC X.
  3968                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  3969             20  AT-FUTURE-SW            PIC X.
  3970                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  3971             20  AT-PTC-SW               PIC X.
  3972                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  3973             20  AT-IBNR-SW              PIC X.
  3974                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  3975             20  AT-PTC-LF-SW            PIC X.
  3976                 88  AT-LF-PTC-USED          VALUE '1'.
  3977             20  AT-CDT-ACCESS-METHOD    PIC X.
  3978                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  3979                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  3980                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  3981             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  3982         16  AT-LAST-COMPUTED-DT         PIC XX.
  3983         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  3984         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  3985         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  3986         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3987         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3988         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  3989         16  AT-EXPENSE-CONTROLS.
  3990             20  AT-EXPENSE-METHOD       PIC X.
  3991                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  3992                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  3993                 88  PERCENT-OF-PMT           VALUE '3'.
  3994                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  3995             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  3996             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  3997         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  3998         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL1501.cbl
  3999
  4000         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4001         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4002
  4003*        16  FILLER                      PIC X(53).
  4004         16  FILLER                      PIC X(47).
  4005
  4006         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4007         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4008
  4009         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4010             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4011             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4012*                    C = CLOSED
  4013*                    O = OPEN
  4014             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4015*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4016
  4017     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4018         16  AT-PAYMENT-TYPE             PIC X.
  4019             88  PARTIAL-PAYMENT                VALUE '1'.
  4020             88  FINAL-PAYMENT                  VALUE '2'.
  4021             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4022             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4023             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4024             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4025             88  VOIDED-PAYMENT                 VALUE '9'.
  4026             88  TRANSFER                       VALUE 'T'.
  4027             88  LIFE-INTEREST                  VALUE 'I'.
  4028
  4029         16  AT-CLAIM-TYPE               PIC X.
  4030             88  PAID-FOR-AH                    VALUE 'A'.
  4031             88  PAID-FOR-LIFE                  VALUE 'L'.
  4032             88  PAID-FOR-IUI                   VALUE 'I'.
  4033             88  PAID-FOR-GAP                   VALUE 'G'.
  4034         16  AT-CLAIM-PREM-TYPE          PIC X.
  4035             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4036             88  AT-O-B-COVERAGE                VALUE '2'.
  4037             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4038         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4039         16  AT-CHECK-NO                 PIC X(7).
  4040         16  AT-PAID-FROM-DT             PIC XX.
  4041         16  AT-PAID-THRU-DT             PIC XX.
  4042         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4043         16  FILLER                      PIC X.
  4044         16  AT-PAYEES-NAME              PIC X(30).
  4045         16  AT-PAYMENT-ORIGIN           PIC X.
  4046             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4047             88  ONLINE-AUTO-PMT                VALUE '2'.
  4048             88  OFFLINE-PMT                    VALUE '3'.
  4049         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4050         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4051         16  AT-VOID-DATA.
  4052             20  AT-VOID-DT              PIC XX.
  4053*00144       20  AT-VOID-REASON          PIC X(30).
  4054             20  AT-VOID-REASON          PIC X(26).
  4055         16  AT-PMT-APPROVED-BY          PIC X(04).
  4056         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL1501.cbl
  4057         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4058         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4059                                         PIC S99V9(5)  COMP-3.
  4060         16  AT-CREDIT-INTERFACE.
  4061             20  AT-PMT-SELECT-DT        PIC XX.
  4062                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4063             20  AT-PMT-ACCEPT-DT        PIC XX.
  4064                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4065             20  AT-VOID-SELECT-DT       PIC XX.
  4066                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4067             20  AT-VOID-ACCEPT-DT       PIC XX.
  4068                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4069
  4070         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4071                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4072                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4073         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4074
  4075         16  AT-FORCE-CONTROL            PIC X.
  4076             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4077         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4078         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4079         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4080         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4081         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4082         16  AT-BENEFIT-TYPE             PIC X.
  4083
  4084         16  AT-EXPENSE-TYPE             PIC X.
  4085         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4086
  4087         16  AT-PAYEE-TYPE-CD.
  4088             20  AT-PAYEE-TYPE           PIC X.
  4089                 88  INSURED-PAID           VALUE 'I'.
  4090                 88  BENEFICIARY-PAID       VALUE 'B'.
  4091                 88  ACCOUNT-PAID           VALUE 'A'.
  4092                 88  OTHER-1-PAID           VALUE 'O'.
  4093                 88  OTHER-2-PAID           VALUE 'Q'.
  4094                 88  DOCTOR-PAID            VALUE 'P'.
  4095                 88  EMPLOYER-PAID          VALUE 'E'.
  4096             20  AT-PAYEE-SEQ            PIC X.
  4097
  4098         16  AT-CASH-PAYMENT             PIC X.
  4099         16  AT-GROUPED-PAYMENT          PIC X.
  4100         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4101         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4102         16  AT-APPROVED-LEVEL           PIC X.
  4103         16  AT-VOID-TYPE                PIC X.
  4104             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4105             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4106         16  AT-AIG-UNEMP-IND            PIC X.
  4107             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4108         16  AT-ASSOCIATES               PIC X.
  4109             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4110             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4111
  4112         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4113         16  AT-CV-PMT-CODE              PIC X.
  4114             88  FULL-DEATH-PAYMENT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL1501.cbl
  4115             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4116             88  FULL-ADD-PAYMENT           VALUE '3'.
  4117             88  HALF-ADD-PAYMENT           VALUE '4'.
  4118             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4119             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4120             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4121             88  ADDL-PAYMENT               VALUE '8'.
  4122
  4123         16  AT-EOB-CODE1                PIC XXX.
  4124         16  AT-EOB-CODE2                PIC XXX.
  4125         16  AT-EOB-CODE3                PIC XXX.
  4126         16  AT-EOB-CODE4                PIC XXX.
  4127         16  FILLER REDEFINES AT-EOB-CODE4.
  4128             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4129             20  FILLER                  PIC X.
  4130         16  AT-EOB-CODE5                PIC XXX.
  4131         16  FILLER REDEFINES AT-EOB-CODE5.
  4132             20  AT-PMT-PROOF-DT         PIC XX.
  4133             20  FILLER                  PIC X.
  4134
  4135         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4136             88  AT-PRINT-EOB            VALUE 'Y'.
  4137
  4138         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4139         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4140
  4141     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4142         16  AT-SCHEDULE-START-DT        PIC XX.
  4143         16  AT-SCHEDULE-END-DT          PIC XX.
  4144         16  AT-TERMINATED-DT            PIC XX.
  4145         16  AT-LAST-PMT-TYPE            PIC X.
  4146             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4147             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4148         16  AT-FIRST-PMT-DATA.
  4149             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4150             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4151             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4152         16  AT-REGULAR-PMT-DATA.
  4153             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4154             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4155             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4156         16  AT-AUTO-PAYEE-CD.
  4157             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4158                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4159                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4160                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4161                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4162                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4163             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4164         16  AT-AUTO-PAY-DAY             PIC 99.
  4165         16  AT-AUTO-CASH                PIC X.
  4166             88  AT-CASH                      VALUE 'Y'.
  4167             88  AT-NON-CASH                  VALUE 'N'.
  4168*        16  FILLER                      PIC X(129).
  4169         16  AT-AUTO-END-LETTER          PIC X(4).
  4170         16  FILLER                      PIC X(125).
  4171
  4172         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL1501.cbl
  4173         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4174
  4175     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4176         16  AT-LETTER-SENT-DT           PIC XX.
  4177         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4178         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4179         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4180         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4181         16  AT-LETTER-ORIGIN            PIC X.
  4182             88  ONLINE-CREATION              VALUE '1' '3'.
  4183             88  OFFLINE-CREATION             VALUE '2' '4'.
  4184             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4185             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4186         16  AT-STD-LETTER-FORM          PIC X(4).
  4187         16  AT-REASON-TEXT              PIC X(70).
  4188         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4189         16  AT-ADDRESEE-TYPE            PIC X.
  4190              88  INSURED-ADDRESEE            VALUE 'I'.
  4191              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4192              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4193              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4194              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4195              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4196              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4197         16  AT-ADDRESSEE-NAME           PIC X(30).
  4198         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4199         16  AT-RESEND-PRINT-DATE        PIC XX.
  4200         16  AT-CORR-SOL-UNSOL           PIC X.
  4201         16  AT-LETTER-PURGED-DT         PIC XX.
  4202*
  4203*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4204*
  4205         16  AT-CSO-REDEFINITION.
  4206             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4207             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4208             20  AT-LETTER-TO-BENE       PIC X(1).
  4209             20  AT-STOP-LETTER-DT       PIC X(2).
  4210             20  FILLER                  PIC X(19).
  4211*             20  FILLER                  PIC X(27).
  4212             20  AT-CSO-LETTER-STATUS    PIC X.
  4213                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4214                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4215                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4216             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4217             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4218*
  4219*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4220*
  4221*        16  FILLER                      PIC X(26).
  4222*
  4223*        16  AT-DMD-BSR-CODE             PIC X.
  4224*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4225*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4226*
  4227*        16  AT-DMD-LETTER-STATUS        PIC X.
  4228*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4229*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4230*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL1501.cbl
  4231*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4232*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4233
  4234         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4235         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4236
  4237     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4238         16  AT-ADDRESS-TYPE             PIC X.
  4239             88  INSURED-ADDRESS               VALUE 'I'.
  4240             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4241             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4242             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4243             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4244             88  OTHER-ADDRESS-1               VALUE 'O'.
  4245             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4246         16  AT-MAIL-TO-NAME             PIC X(30).
  4247         16  AT-ADDRESS-LINE-1           PIC X(30).
  4248         16  AT-ADDRESS-LINE-2           PIC X(30).
  4249         16  AT-CITY-STATE.
  4250             20  AT-CITY                 PIC X(28).
  4251             20  AT-STATE                PIC XX.
  4252         16  AT-ZIP.
  4253             20  AT-ZIP-CODE.
  4254                 24  AT-ZIP-1ST          PIC X.
  4255                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4256                 24  FILLER              PIC X(4).
  4257             20  AT-ZIP-PLUS4            PIC X(4).
  4258         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4259             20  AT-CAN-POSTAL-1         PIC XXX.
  4260             20  AT-CAN-POSTAL-2         PIC XXX.
  4261             20  FILLER                  PIC XXX.
  4262         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4263         16  FILLER                      PIC X(23).
  4264         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4265         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4266
  4267     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4268         16  AT-INFO-LINE-1              PIC X(60).
  4269         16  AT-INFO-LINE-2              PIC X(60).
  4270         16  AT-INFO-TRAILER-TYPE        PIC X.
  4271             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4272             88  AT-CALL-NOTE            VALUE 'C'.
  4273             88  AT-MAINT-NOTE           VALUE 'M'.
  4274             88  AT-CERT-CHANGE          VALUE 'X'.
  4275             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4276             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4277         16  AT-CALL-TYPE                PIC X.
  4278             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4279             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4280         16  AT-NOTE-CONTINUATION        PIC X.
  4281             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4282         16  AT-EOB-CODES-EXIST          PIC X.
  4283             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4284         16  FILLER                      PIC X(35).
  4285         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4286         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4287
  4288     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL1501.cbl
  4289         16  AT-PROMPT-LINE-1            PIC X(60).
  4290         16  AT-PROMPT-LINE-2            PIC X(60).
  4291         16  AT-PROMPT-START-DT          PIC XX.
  4292         16  AT-PROMPT-END-DT            PIC XX.
  4293         16  FILLER                      PIC X(35).
  4294         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4295         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4296
  4297     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4298         16  AT-DENIAL-INFO-1            PIC X(60).
  4299         16  AT-DENIAL-INFO-2            PIC X(60).
  4300         16  AT-DENIAL-DT                PIC XX.
  4301         16  AT-RETRACTION-DT            PIC XX.
  4302         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4303*         16  FILLER                      PIC X(31).
  4304         16  AT-DENIAL-PROOF-DT          PIC XX.
  4305         16  FILLER                      PIC X(29).
  4306         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4307         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4308
  4309     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4310         16  AT-OLD-INCURRED-DT          PIC XX.
  4311         16  AT-OLD-REPORTED-DT          PIC XX.
  4312         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4313         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4314         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4315         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4316         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4317         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4318         16  FILLER                      PIC X(26).
  4319         16  AT-OLD-DIAG-CODE            PIC X(6).
  4320         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4321         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4322         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4323         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4324         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4325         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4326         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4327         16  FILLER                      PIC X(25).
  4328         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4329
  4330     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4331         16  AT-FORM-SEND-ON-DT          PIC XX.
  4332         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4333         16  AT-FORM-RE-SEND-DT          PIC XX.
  4334         16  AT-FORM-ANSWERED-DT         PIC XX.
  4335         16  AT-FORM-PRINTED-DT          PIC XX.
  4336         16  AT-FORM-REPRINT-DT          PIC XX.
  4337         16  AT-FORM-TYPE                PIC X.
  4338             88  INITIAL-FORM                  VALUE '1'.
  4339             88  PROGRESS-FORM                 VALUE '2'.
  4340         16  AT-INSTRUCT-LN-1            PIC X(28).
  4341         16  AT-INSTRUCT-LN-2            PIC X(28).
  4342         16  AT-INSTRUCT-LN-3            PIC X(28).
  4343         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4344         16  AT-FORM-ADDRESS             PIC X.
  4345             88  FORM-TO-INSURED              VALUE 'I'.
  4346             88  FORM-TO-ACCOUNT              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL1501.cbl
  4347             88  FORM-TO-OTHER-1              VALUE 'O'.
  4348             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4349         16  AT-RELATED-1.
  4350             20 AT-REL-CARR-1            PIC X.
  4351             20 AT-REL-CLAIM-1           PIC X(7).
  4352             20 AT-REL-CERT-1            PIC X(11).
  4353         16  AT-RELATED-2.
  4354             20 AT-REL-CARR-2            PIC X.
  4355             20 AT-REL-CLAIM-2           PIC X(7).
  4356             20 AT-REL-CERT-2            PIC X(11).
  4357         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4358         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4359         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4360         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4361         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4362         16  AT-STOP-FORM-DT             PIC X(2).
  4363
  4364         16  FILLER                      PIC X(09).
  4365         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4366         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4367******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL1501.cbl
  4369*                                    COPY ELCACTQ.
  4370******************************************************************
  4371*                                                                *
  4372*                            ELCACTQ.                            *
  4373*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  4374*                            VMOD=2.004                          *
  4375*                                                                *
  4376*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  4377*                                                                *
  4378*   FILE TYPE = VSAM,KSDS                                        *
  4379*   RECORD SIZE = 60     RECFORM = FIXED                         *
  4380*                                                                *
  4381*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  4382*       ALTERNATE INDEX = NONE                                   *
  4383*                                                                *
  4384*   LOG = YES                                                    *
  4385*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4386*                                                                *
  4387*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  4388******************************************************************
  4389
  4390 01  ACTIVITY-QUE.
  4391     12  AQ-RECORD-ID                PIC XX.
  4392         88  VALID-AQ-ID                VALUE 'AQ'.
  4393
  4394     12  AQ-CONTROL-PRIMARY.
  4395         16  AQ-COMPANY-CD           PIC X.
  4396         16  AQ-CARRIER              PIC X.
  4397         16  AQ-CLAIM-NO             PIC X(7).
  4398         16  AQ-CERT-NO.
  4399             20  AQ-CERT-PRIME       PIC X(10).
  4400             20  AQ-CERT-SFX         PIC X.
  4401
  4402     12  AQ-PENDING-ACTIVITY-FLAGS.
  4403         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  4404         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  4405             88  PENDING-PAYMENTS       VALUE '1'.
  4406         16  AQ-PENDING-STATUS-FLAG  PIC X.
  4407             88  PENDING-FULL-PRINT     VALUE '1'.
  4408             88  PENDING-PART-PRINT     VALUE '2'.
  4409         16  AQ-PENDING-LETTER-FLAG  PIC X.
  4410             88  PENDING-LETTERS        VALUE '1'.
  4411         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  4412             88  PENDING-RESTORE        VALUE 'C'.
  4413             88  PENDING-RESTORE-LETTER VALUE 'L'.
  4414
  4415     12  FILLER                      PIC X(20).
  4416
  4417     12  AQ-RESEND-DATE              PIC XX.
  4418     12  AQ-FOLLOWUP-DATE            PIC XX.
  4419     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  4420     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  4421     12  AQ-AUTO-LETTER              PIC X(4).
  4422     12  FILLER                      PIC XX.
  4423     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  4424*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL1501.cbl
  4426*                                    COPY ELCCHKQ.
  4427******************************************************************
  4428*                                                                *
  4429*                                                                *
  4430*                            ELCCHKQ.                            *
  4431*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4432*                            VMOD=2.007                          *
  4433*                                                                *
  4434*   FILE DESCRIPTION = CHECK QUE FILE                            *
  4435*                                                                *
  4436*   FILE TYPE = VSAM,KSDS                                        *
  4437*   RECORD SIZE = 100  RECFORM = FIXED                           *
  4438*                                                                *
  4439*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  4440*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  4441*                                                                *
  4442*   LOG = YES                                                    *
  4443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4444******************************************************************
  4445 01  CHECK-QUE.
  4446     12  CQ-RECORD-ID                PIC XX.
  4447         88  VALID-CQ-ID         VALUE 'CQ'.
  4448
  4449     12  CQ-CONTROL-PRIMARY.
  4450         16  CQ-COMPANY-CD           PIC X.
  4451         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  4452         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  4453
  4454     12  CQ-CONTROL-BY-PAYEE.
  4455         16  CQ-CONTROL-BY-NUMBER.
  4456             20  CQ-COMPANY-CD-A1     PIC X.
  4457             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  4458         16  CQ-PAYEE-CARRIER        PIC X.
  4459         16  CQ-PAYEE-GROUPING       PIC X(6).
  4460         16  CQ-PAYEE-STATE          PIC XX.
  4461         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  4462         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  4463
  4464     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  4465         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  4466         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  4467         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  4468         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  4469         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  4470         16  FILLER                  PIC X(3).
  4471
  4472     12  CQ-ENTRY-TYPE               PIC X.
  4473             88  CHECK-ON-QUE           VALUE 'Q'.
  4474             88  ALIGNMENT-CHECK        VALUE 'A'.
  4475             88  SPOILED-CHECK          VALUE 'S'.
  4476             88  PAYMENT-ABORTED        VALUE 'X'.
  4477
  4478     12  CQ-CLAIM-MAST-CNTL.
  4479         16  CQ-CARRIER              PIC X.
  4480         16  CQ-CLAIM-NO             PIC X(7).
  4481         16  CQ-CERT-NO.
  4482             20  CQ-CERT-PRIME       PIC X(10).
  4483             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL1501.cbl
  4484         16  CQ-CLAIM-TYPE           PIC X.
  4485             88  CQ-LIFE-CLAIM          VALUE 'L'.
  4486             88  CQ-AH-CLAIM            VALUE 'A'.
  4487         16  CQ-CLAIM-SUB-TYPE       PIC X.
  4488             88  CQ-FIXED-COVERAGE      VALUE '1'.
  4489             88  CQ-O-B-COVERAGE        VALUE '2'.
  4490             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  4491
  4492     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  4493     12  CQ-CHECK-NUMBER             PIC X(7).
  4494     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  4495     12  CQ-PAYMENT-TYPE             PIC X.
  4496             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  4497             88  CQ-FINAL-PAYMENT          VALUE '2'.
  4498             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  4499             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  4500             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  4501             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  4502             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  4503             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  4504     12  CQ-VOID-INDICATOR           PIC X.
  4505             88  CHECK-IS-STOPPED          VALUE 'S'.
  4506             88  CHECK-IS-VOID             VALUE 'V'.
  4507     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  4508     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  4509     12  CQ-CHECK-BY-USER            PIC X(4).
  4510     12  CQ-PRE-NUMBERING-SW         PIC X.
  4511       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  4512       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  4513
  4514     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  4515     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  4516     12  CQ-LEDGER-FLAG              PIC X(01).
  4517     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  4518     12  CQ-LAST-UPDATED-DT          PIC XX.
  4519     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  4520     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  4521
  4522     12  FILLER                      PIC X(04).
  4523
  4524******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL1501.cbl
  4526*                                    COPY ELCRCON.
  4527******************************************************************
  4528*                                                                *
  4529*
  4530*   THIS COPYBOOK IS NOT BEING USED IN LOGIC
  4531*
  4532*
  4533*                                                                *
  4534*                            ELCRCON.                            *
  4535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4536*                            VMOD=2.003                          *
  4537*                                                                *
  4538*   FILE DESCRIPTION = CHECK RECONCILIATION FILE                 *
  4539*                                                                *
  4540*   FILE TYPE = VSAM,KSDS                                        *
  4541*   RECORD SIZE = 194  RECFORM = FIXED                           *
  4542*                                                                *
  4543*   BASE CLUSTER = ELRCON                         RKP=2,LEN=19   *
  4544*                                                                *
  4545*   LOG = YES                                                    *
  4546*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4547******************************************************************
  4548
  4549 01  CHECK-RECONCILIATION.
  4550     12  RC-RECORD-ID                          PIC XX.
  4551         88  VALID-RC-ID                    VALUE 'RC'.
  4552     12  RC-CONTROL-PRIMARY.
  4553         16  RC-COMPANY-CD                     PIC X.
  4554         16  RC-CHECK-NO                       PIC X(7).
  4555         16  RC-CHECK-ORIGIN                   PIC X.
  4556         16  RC-GL-ACCOUNT-NO                  PIC X(10).
  4557
  4558     12  RC-CHECK-DATA.
  4559         16  RC-ISSUE-DATE.
  4560             20  RC-ISSUE-YYYY.
  4561               22  RC-ISSUE-CC                 PIC XX.
  4562               22  RC-ISSUE-YY                 PIC XX.
  4563             20  RC-ISSUE-MM                   PIC XX.
  4564             20  RC-ISSUE-DD                   PIC XX.
  4565         16  RC-CHECK-AMOUNT                   PIC 9(7)V99.
  4566         16  RC-CARRIER                        PIC X.
  4567         16  RC-CLAIM-NO                       PIC X(7).
  4568         16  RC-REFERENCE-NO                   PIC X(20).
  4569         16  RC-MORTGAGE-REF   REDEFINES  RC-REFERENCE-NO.
  4570             20  RC-MORT-REF-1-18              PIC X(18).
  4571             20  RC-MORT-REF-SUF-19-20         PIC XX.
  4572         16  FILLER  REDEFINES  RC-MORTGAGE-REF.
  4573             20  FILLER                        PIC X(13).
  4574             20  RC-CLAIM-REF.
  4575               22  RC-CLAIM-PREFIX             PIC X.
  4576               22  RC-CLAIM-NO-REF             PIC X(6).
  4577         16  RC-COVERAGE-TYPE                  PIC X.
  4578         16  RC-BENEFIT-CODE                   PIC XX.
  4579         16  RC-BENEFICIARY                    PIC X(10).
  4580         16  RC-PAYMENT-TYPE                   PIC X.
  4581         16  RC-STATUS                         PIC X.
  4582           88  RC-STATUS-ABANDONED                VALUE 'A'.
  4583           88  RC-STATUS-DESTROYED                VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL1501.cbl
  4584           88  RC-STATUS-OUTSTANDING              VALUE 'O'.
  4585           88  RC-STATUS-REDEEMED                 VALUE 'R'.
  4586           88  RC-STATUS-STOP-PAY                 VALUE 'S'.
  4587           88  RC-STATUS-UNREDEEMED               VALUE 'U'.
  4588           88  RC-STATUS-VOIDED                   VALUE 'V'.
  4589         16  RC-STATUS-DATE.
  4590             20  RC-STATUS-YYYY.
  4591               22  RC-STATUS-CC                PIC XX.
  4592               22  RC-STATUS-YY                PIC XX.
  4593             20  RC-STATUS-MM                  PIC XX.
  4594             20  RC-STATUS-DD                  PIC XX.
  4595
  4596     12  RC-MAINT-AREA.
  4597         16  RC-LAST-MAINT-BY                  PIC X(4).
  4598         16  RC-LAST-MAINT-DT                  PIC XX.
  4599         16  RC-LAST-MAINT-HHMMSS    COMP-3    PIC S9(7).
  4600
  4601     12  RC-CHECK-MAINT-AREA.
  4602         16  RC-LAST-CHECK-BY                  PIC X(4).
  4603         16  RC-LAST-CHECK-DT                  PIC XX.
  4604         16  RC-LAST-CHECK-HHMMSS    COMP-3    PIC S9(7).
  4605     12  RC-CASHED-AMOUNT                      PIC 9(7)V99.
  4606
  4607     12  RC-CHECK-NOTE                         PIC X(67).
  4608     12  FILLER                                PIC X(11).
  4609
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL1501.cbl
  4611*                                    COPY ERCDMDNT.
  4612*    EJECT
  4613*                                    COPY ELCDAR.
  4614******************************************************************
  4615*                                                                *
  4616*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  4617*   FILE TYPE = VSAM,KSDS                                        *
  4618*   RECORD SIZE = 25   RECFORM = FIXED                           *
  4619*   BASE CLUSTER = DLYACTV                                       *
  4620*   LOG = YES                                                    *
  4621*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  4622*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  4623*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  4624*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  4625*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  4626*               BY PROGRAM "LGINFCE".                            *
  4627*                                                                *
  4628******************************************************************
  4629 01  DAILY-ACTIVITY-RECORD.
  4630     05  DA-KEY.
  4631         10  DA-COMP-CD          PIC X.
  4632         10  DA-CARRIER          PIC X.
  4633         10  DA-CLAIM-NO         PIC X(7).
  4634         10  DA-CERT-NO.
  4635             15  DA-CERT-PRIME   PIC X(10).
  4636             15  DA-CERT-SFX     PIC X.
  4637     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  4638     05  DA-RECORD-TYPE          PIC X.
  4639     05  FILLER                  PIC X(2).
  4640******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL1501.cbl
  4642*                                    COPY MPCPLCY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL1501.cbl
  4644 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  4645                          CONTROL-FILE CERTIFICATE-MASTER
  4646                          ACTIVITY-TRAILERS ACTIVITY-QUE
  4647                          CHECK-QUE CHECK-RECONCILIATION
  4648                          DAILY-ACTIVITY-RECORD.
  4649 0000-DFHEXIT SECTION.
  4650     MOVE '9#                    $   ' TO DFHEIV0.
  4651     MOVE 'EL1501' TO DFHEIV1.
  4652     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4653
  4654     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4655     MOVE '5'                    TO  DC-OPTION-CODE.
  4656     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  4657     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4658     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  4659     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4660
  4661     IF SAVE-DATE-YY > 70
  4662         MOVE 19                 TO  SAVE-DATE-CC
  4663     ELSE
  4664         MOVE 20                 TO  SAVE-DATE-CC.
  4665
  4666     IF EIBCALEN = 0
  4667         GO TO 8800-UNAUTHORIZED-ACCESS.
  4668
  4669     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  4670
  4671     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  4672     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  4673
  4674     MOVE EIBTRMID               TO QID-TERM.
  4675
  4676
  4677* EXEC CICS HANDLE CONDITION
  4678*        QIDERR   (1000-SHOW-CLAIM-HISTORY)
  4679*        MAPFAIL  (0100-FIRST-TIME-IN)
  4680*        NOTOPEN  (8500-FILE-NOTOPEN)
  4681*        PGMIDERR (9600-PGMID-ERROR)
  4682*        ERROR    (9990-ABEND)
  4683*    END-EXEC.
  4684*    MOVE '"$N?JL.               ! " #00004672' TO DFHEIV0
  4685     MOVE X'22244E3F4A4C2E2020202020' TO DFHEIV0(1:12)
  4686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4687     MOVE X'2220233030303034363732' TO DFHEIV0(25:11)
  4688     CALL 'kxdfhei1' USING DFHEIV0
  4689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4690
  4691
  4692     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4693         MOVE PI-CALLING-PROGRAM       TO RETURNED-FROM.
  4694
  4695     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  4696         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  4697             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  4698             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  4699             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  4700             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  4701             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL1501.cbl
  4702             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  4703             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  4704             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  4705         ELSE
  4706             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  4707             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  4708             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  4709             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  4710             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  4711             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  4712             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  4713             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  4714
  4715     IF RETURNED-FROM NOT = SPACES
  4716         GO TO 0600-RECOVER-TEMP-STORAGE.
  4717
  4718     IF EIBAID = DFHCLEAR
  4719         GO TO 9400-CLEAR.
  4720
  4721     IF PI-PROCESSOR-ID = 'LGXX'
  4722         NEXT SENTENCE
  4723     ELSE
  4724
  4725* EXEC CICS READQ TS
  4726*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4727*            INTO    (SECURITY-CONTROL)
  4728*            LENGTH  (SC-COMM-LENGTH)
  4729*            ITEM    (SC-ITEM)
  4730*        END-EXEC
  4731*    MOVE '*$II   L              ''   #00004712' TO DFHEIV0
  4732     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4733     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4734     MOVE X'2020233030303034373132' TO DFHEIV0(25:11)
  4735     CALL 'kxdfhei1' USING DFHEIV0,
  4736           PI-SECURITY-TEMP-STORE-ID,
  4737           SECURITY-CONTROL,
  4738           SC-COMM-LENGTH,
  4739           SC-ITEM,
  4740           DFHEIV99,
  4741           DFHEIV99
  4742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4743             MOVE SC-CLAIMS-DISPLAY (16)  TO  PI-DISPLAY-CAP
  4744             MOVE SC-CLAIMS-UPDATE  (16)  TO  PI-MODIFY-CAP
  4745             IF NOT DISPLAY-CAP
  4746                 MOVE 'READ'              TO  SM-READ
  4747                 PERFORM 9995-SECURITY-VIOLATION
  4748                 MOVE ER-0070             TO  EMI-ERROR
  4749                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4750                 GO TO 8100-SEND-INITIAL-MAP.
  4751
  4752     IF EIBTRNID = TRANS-ID
  4753         GO TO 0200-RECEIVE.
  4754
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL1501.cbl
  4756 0100-FIRST-TIME-IN.
  4757     MOVE LOW-VALUES             TO  EL150BO
  4758                                     PI-PROGRAM-WORK-AREA.
  4759
  4760     MOVE 'Y'                    TO  PI-FIRST-TIME-SW
  4761                                     WS-RECORDS-READ-SW.
  4762     MOVE 1                      TO  PI-LINE-NO.
  4763     MOVE ZERO                   TO  PI-PREV-SEQ-NO
  4764                                     PI-REMINDERS-SW
  4765                                     PI-LETTERS-SW
  4766                                     PI-PAYMENTS-SW
  4767                                     PI-AUTO-PAY-SW
  4768                                     PI-NOTES-SW
  4769                                     PI-RES-EXP-SW
  4770                                     PI-DENIALS-SW
  4771                                     PI-INCURRED-DATE-SW
  4772                                     PI-FORMS-SW.
  4773
  4774
  4775* EXEC CICS DELETEQ TS
  4776*        QUEUE(QID)
  4777*    END-EXEC.
  4778*    MOVE '*&                    #   #00004749' TO DFHEIV0
  4779     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4780     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4781     MOVE X'2020233030303034373439' TO DFHEIV0(25:11)
  4782     CALL 'kxdfhei1' USING DFHEIV0,
  4783           QID,
  4784           DFHEIV99
  4785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4786
  4787
  4788     GO TO 1000-SHOW-CLAIM-HISTORY.
  4789
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL1501.cbl
  4791 0200-RECEIVE.
  4792     MOVE 'B'                    TO  PASS-SWITCH.
  4793     MOVE LOW-VALUES             TO  EL150BI.
  4794
  4795     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  4796         MOVE ER-0008            TO  EMI-ERROR
  4797         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4798         MOVE -1                 TO  ENTERPFL
  4799         GO TO 8200-SEND-DATAONLY.
  4800
  4801
  4802* EXEC CICS RECEIVE
  4803*        MAP      (MAP-NAME)
  4804*        MAPSET   (MAPSET-NAME)
  4805*        INTO     (EL150BI)
  4806*    END-EXEC.
  4807     MOVE LENGTH OF
  4808      EL150BI
  4809       TO DFHEIV11
  4810*    MOVE '8"T I  L              ''   #00004766' TO DFHEIV0
  4811     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4812     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4813     MOVE X'2020233030303034373636' TO DFHEIV0(25:11)
  4814     CALL 'kxdfhei1' USING DFHEIV0,
  4815           MAP-NAME,
  4816           EL150BI,
  4817           DFHEIV11,
  4818           MAPSET-NAME,
  4819           DFHEIV99,
  4820           DFHEIV99
  4821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4822
  4823
  4824     IF ENTERPFL = 0
  4825         GO TO 0300-CHECK-PFKEYS.
  4826
  4827     IF EIBAID = DFHENTER
  4828         MOVE ER-0004            TO  EMI-ERROR
  4829         GO TO 0320-INPUT-ERROR.
  4830
  4831     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  4832         MOVE PF-VALUES (ENTERPFI)   TO  EIBAID
  4833     ELSE
  4834         MOVE ER-0029                TO  EMI-ERROR
  4835         GO TO 0320-INPUT-ERROR.
  4836
  4837 0300-CHECK-PFKEYS.
  4838     IF EIBAID = DFHPF23
  4839         GO TO 8810-PF23.
  4840
  4841     IF EIBAID = DFHPF24
  4842         GO TO 9200-RETURN-MAIN-MENU.
  4843
  4844     IF EIBAID = DFHPF12
  4845         GO TO 9500-PF12.
  4846
  4847     IF EIBAID = DFHPF3
  4848        IF LINENOL > +0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL1501.cbl
  4849            GO TO 0500-CREATE-TEMP-STORAGE
  4850        ELSE
  4851            MOVE ER-0672        TO  EMI-ERROR
  4852            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4853            MOVE -1             TO  LINENOL
  4854            GO TO 8200-SEND-DATAONLY.
  4855
  4856     IF EIBAID = DFHPF4
  4857        IF LINENOL > +0
  4858           IF (PI-EL142-PRIORITY = '8')
  4859              AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  4860                   AND 'AMWA')
  4861              MOVE ER-8003        TO  EMI-ERROR
  4862              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4863              MOVE -1             TO  LINENOL
  4864              GO TO 8200-SEND-DATAONLY
  4865           ELSE
  4866              MOVE 'V'            TO  WS-VOID-CODE
  4867              GO TO 5000-VOID-PAYMENT
  4868           END-IF
  4869        ELSE
  4870           MOVE ER-0663        TO  EMI-ERROR
  4871           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4872           MOVE -1             TO  LINENOL
  4873           GO TO 8200-SEND-DATAONLY
  4874        END-IF
  4875     END-IF
  4876
  4877     IF EIBAID = DFHPF5
  4878        IF LINENOL > +0
  4879           IF (PI-EL142-PRIORITY = '8')
  4880              AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  4881                   AND 'AMWA')
  4882              MOVE ER-8003        TO  EMI-ERROR
  4883              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4884              MOVE -1             TO  LINENOL
  4885              GO TO 8200-SEND-DATAONLY
  4886           ELSE
  4887              MOVE 'S'           TO  WS-VOID-CODE
  4888              GO TO 5000-VOID-PAYMENT
  4889           END-IF
  4890        ELSE
  4891           MOVE ER-0835        TO  EMI-ERROR
  4892           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4893           MOVE -1             TO  LINENOL
  4894           GO TO 8200-SEND-DATAONLY
  4895        END-IF
  4896     END-IF
  4897
  4898*    IF EIBAID = DFHPF6
  4899*        IF PI-COMPANY-ID = 'DMD'
  4900*            IF LINENOL NOT = ZEROS
  4901*                MOVE LINENOI        TO SUB-1
  4902*                IF PI-TRLR-TYPE (SUB-1) = '2'
  4903*                    PERFORM 0500-CREATE-TEMP-STORAGE
  4904*                    MOVE 'EL402DMD' TO PGM-NAME
  4905*                    GO TO 9300-XCTL
  4906*                ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL1501.cbl
  4907*                    MOVE ER-0940    TO EMI-ERROR
  4908*                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4909*                    MOVE -1         TO LINENOL
  4910*                    GO TO 8200-SEND-DATAONLY
  4911*            ELSE
  4912*                MOVE ER-0939    TO EMI-ERROR
  4913*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4914*                MOVE -1         TO LINENOL
  4915*                GO TO 8200-SEND-DATAONLY.
  4916
  4917     MOVE SPACES                 TO  ERRMSG1O.
  4918
  4919     IF EIBAID = DFHPF1
  4920         MOVE 'F'                TO  DIRECTION-SWITCH
  4921         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  4922         GO TO 1000-SHOW-CLAIM-HISTORY.
  4923
  4924     IF EIBAID = DFHPF2
  4925         MOVE 'B'                TO  DIRECTION-SWITCH
  4926         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  4927         MOVE PI-TRLR-SEQ-NO (1) TO  PI-PREV-SEQ-NO
  4928         GO TO 1000-SHOW-CLAIM-HISTORY.
  4929
  4930     IF EIBAID = DFHENTER
  4931         GO TO 0330-EDIT-DATA.
  4932
  4933     MOVE ER-0029                TO EMI-ERROR.
  4934
  4935 0320-INPUT-ERROR.
  4936     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4937
  4938     IF ENTERPFL = 0
  4939         MOVE -1                 TO ENTERPFL
  4940     ELSE
  4941         MOVE AL-UNBON           TO ENTERPFA
  4942         MOVE -1                 TO ENTERPFL.
  4943
  4944     GO TO 8200-SEND-DATAONLY.
  4945
  4946 0330-EDIT-DATA.
  4947     IF NOT MODIFY-CAP
  4948         MOVE 'UPDATE'           TO  SM-READ
  4949         PERFORM 9995-SECURITY-VIOLATION
  4950         MOVE ER-0070            TO  EMI-ERROR
  4951         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4952         GO TO 8100-SEND-INITIAL-MAP.
  4953
  4954     IF LINENOL  > 0 AND
  4955        RECVDTL  > 0 AND
  4956        RECVTYPL > 0
  4957           GO TO 4000-RECEIVE-FORMS.
  4958
  4959     IF LINENOL > 0 AND
  4960        RECVDTL > 0
  4961           GO TO 3000-RECEIVE-LETTERS.
  4962
  4963     IF LINENOL > 0
  4964         MOVE LINENOI            TO  SUB-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL1501.cbl
  4965         IF PI-TRLR-TYPE (SUB-1) = 'A'
  4966             MOVE ER-0665        TO  EMI-ERROR
  4967             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4968             MOVE -1             TO  LINENOL
  4969             GO TO 8200-SEND-DATAONLY
  4970         ELSE
  4971             IF PI-TRLR-TYPE (SUB-1) = '4'
  4972                 MOVE ER-0666        TO  EMI-ERROR
  4973                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4974                 MOVE -1             TO  LINENOL
  4975                 GO TO 8200-SEND-DATAONLY
  4976             ELSE
  4977                 IF PI-TRLR-TYPE (SUB-1) = '2'
  4978                     MOVE ER-0667    TO  EMI-ERROR
  4979                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4980                     MOVE -1         TO  LINENOL
  4981                     GO TO 8200-SEND-DATAONLY.
  4982
  4983     MOVE 'F'                    TO  DIRECTION-SWITCH.
  4984     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  4985     GO TO 1000-SHOW-CLAIM-HISTORY.
  4986
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL1501.cbl
  4988 0500-CREATE-TEMP-STORAGE.
  4989     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  4990     MOVE SPACES                 TO PI-FULL-SCREEN-IND.
  4991
  4992
  4993* EXEC CICS WRITEQ TS
  4994*        QUEUE    (QID)
  4995*        FROM     (PROGRAM-INTERFACE-BLOCK)
  4996*        LENGTH   (PI-COMM-LENGTH)
  4997*    END-EXEC.
  4998*    MOVE '*"                    ''   #00004940' TO DFHEIV0
  4999     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  5000     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5001     MOVE X'2020233030303034393430' TO DFHEIV0(25:11)
  5002     CALL 'kxdfhei1' USING DFHEIV0,
  5003           QID,
  5004           PROGRAM-INTERFACE-BLOCK,
  5005           PI-COMM-LENGTH,
  5006           DFHEIV99,
  5007           DFHEIV99,
  5008           DFHEIV99
  5009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5010
  5011
  5012     IF LINENOL > +0
  5013         MOVE LINENOI            TO  SUB-1
  5014         IF PI-TRLR-TYPE (SUB-1) = '2'
  5015            MOVE +1                      TO  PI-PAYMENTS-SW
  5016            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5017                                             PI-SAVE-ATK-SEQ-NO
  5018         ELSE
  5019         IF PI-TRLR-TYPE (SUB-1) = '3'
  5020            MOVE +1                      TO  PI-AUTO-PAY-SW
  5021            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5022                                             PI-SAVE-ATK-SEQ-NO
  5023         ELSE
  5024         IF PI-TRLR-TYPE (SUB-1) = '4'
  5025            MOVE +1                      TO  PI-LETTERS-SW
  5026            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5027                                             PI-SAVE-ATK-SEQ-NO
  5028         ELSE
  5029         IF PI-TRLR-TYPE (SUB-1) = '6'
  5030            MOVE +1                      TO  PI-NOTES-SW
  5031            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5032                                             PI-SAVE-ATK-SEQ-NO
  5033         ELSE
  5034         IF PI-TRLR-TYPE (SUB-1) = '7'
  5035            MOVE +1                      TO  PI-REMINDERS-SW
  5036            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5037                                             PI-SAVE-ATK-SEQ-NO
  5038         ELSE
  5039         IF PI-TRLR-TYPE (SUB-1) = '8'
  5040            MOVE +1                      TO  PI-DENIALS-SW
  5041            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5042                                             PI-SAVE-ATK-SEQ-NO
  5043         ELSE
  5044         IF PI-TRLR-TYPE (SUB-1) = '9'
  5045            MOVE +1                      TO  PI-INCURRED-DATE-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL1501.cbl
  5046            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5047                                             PI-SAVE-ATK-SEQ-NO
  5048         ELSE
  5049            MOVE +1                      TO  PI-FORMS-SW
  5050            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5051                                             PI-SAVE-ATK-SEQ-NO
  5052     ELSE
  5053         MOVE +1                         TO  PI-REMINDERS-SW
  5054                                             PI-LETTERS-SW
  5055                                             PI-PAYMENTS-SW
  5056                                             PI-AUTO-PAY-SW
  5057                                             PI-NOTES-SW
  5058                                             PI-RES-EXP-SW
  5059                                             PI-DENIALS-SW
  5060                                             PI-INCURRED-DATE-SW
  5061                                             PI-FORMS-SW
  5062         MOVE +0                         TO  PI-ATK-SEQ-NO.
  5063
  5064     IF EIBAID = DFHPF6
  5065         MOVE PI-COMPANY-CD      TO  PI-SAVE-ATK-COMPANY-CODE
  5066                                     PI-ATK-COMPANY-CODE
  5067         MOVE PI-CARRIER         TO  PI-SAVE-ATK-CARRIER
  5068                                     PI-ATK-CARRIER
  5069         MOVE PI-CLAIM-NO        TO  PI-SAVE-ATK-CLAIM-NO
  5070                                     PI-ATK-CLAIM-NO
  5071         MOVE PI-CERT-NO         TO  PI-SAVE-ATK-CERT-NO
  5072                                     PI-ATK-CERT-NO
  5073         MOVE 'Y'                TO  PI-FIRST-TIME-SW.
  5074
  5075     IF EIBAID = DFHPF3
  5076         MOVE XCTL-142           TO  PGM-NAME
  5077         MOVE 'EL142A'           TO  PI-MAP-NAME
  5078         MOVE PI-COMPANY-CD      TO  PI-SAVE-ATK-COMPANY-CODE
  5079                                     PI-ATK-COMPANY-CODE
  5080         MOVE PI-CARRIER         TO  PI-SAVE-ATK-CARRIER
  5081                                     PI-ATK-CARRIER
  5082         MOVE PI-CLAIM-NO        TO  PI-SAVE-ATK-CLAIM-NO
  5083                                     PI-ATK-CLAIM-NO
  5084         MOVE PI-CERT-NO         TO  PI-SAVE-ATK-CERT-NO
  5085                                     PI-ATK-CERT-NO
  5086         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  5087         GO TO 9300-XCTL.
  5088
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL1501.cbl
  5090 0600-RECOVER-TEMP-STORAGE.
  5091     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  5092
  5093
  5094* EXEC CICS HANDLE CONDITION
  5095*        QIDERR   (0690-QIDERR)
  5096*    END-EXEC.
  5097*    MOVE '"$N                   ! # #00005027' TO DFHEIV0
  5098     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  5099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5100     MOVE X'2320233030303035303237' TO DFHEIV0(25:11)
  5101     CALL 'kxdfhei1' USING DFHEIV0
  5102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5103
  5104
  5105
  5106* EXEC CICS READQ TS
  5107*        QUEUE    (QID)
  5108*        INTO     (PROGRAM-INTERFACE-BLOCK)
  5109*        LENGTH   (PI-COMM-LENGTH)
  5110*    END-EXEC.
  5111*    MOVE '*$I    L              ''   #00005031' TO DFHEIV0
  5112     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  5113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5114     MOVE X'2020233030303035303331' TO DFHEIV0(25:11)
  5115     CALL 'kxdfhei1' USING DFHEIV0,
  5116           QID,
  5117           PROGRAM-INTERFACE-BLOCK,
  5118           PI-COMM-LENGTH,
  5119           DFHEIV99,
  5120           DFHEIV99,
  5121           DFHEIV99
  5122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5123
  5124
  5125
  5126* EXEC CICS DELETEQ TS
  5127*        QUEUE   (QID)
  5128*    END-EXEC.
  5129*    MOVE '*&                    #   #00005037' TO DFHEIV0
  5130     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  5131     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5132     MOVE X'2020233030303035303337' TO DFHEIV0(25:11)
  5133     CALL 'kxdfhei1' USING DFHEIV0,
  5134           QID,
  5135           DFHEIV99
  5136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5137
  5138
  5139     MOVE SAVE-CONTROL           TO  PI-CONTROL-IN-PROGRESS.
  5140     MOVE LOW-VALUES             TO  EL150BO.
  5141     MOVE ZEROS                  TO  PI-PREV-SEQ-NO.
  5142     MOVE 'F'                    TO  DIRECTION-SWITCH.
  5143     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  5144
  5145     GO TO 1000-SHOW-CLAIM-HISTORY.
  5146
  5147 0690-QIDERR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL1501.cbl
  5148     MOVE ER-0033                TO  EMI-ERROR.
  5149     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5150     MOVE LOW-VALUES             TO  EL150BO.
  5151     MOVE -1                     TO  ENTERPFL.
  5152     GO TO 8100-SEND-INITIAL-MAP.
  5153
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL1501.cbl
  5155 1000-SHOW-CLAIM-HISTORY.
  5156
  5157     PERFORM 2000-BUILD-TRAILER-DISPLAY THRU 2999-EXIT.
  5158
  5159     MOVE PI-CARRIER             TO  CARRO.
  5160     MOVE PI-CLAIM-NO            TO  CLMNOO.
  5161     MOVE PI-CERT-PRIME          TO  CERTNOO.
  5162     MOVE PI-CERT-SFX            TO  SUFXO.
  5163
  5164     MOVE -1                     TO  LINENOL.
  5165
  5166     IF RECORDS-READ
  5167         MOVE 'N'                TO  WS-RECORDS-READ-SW
  5168         GO TO 8100-SEND-INITIAL-MAP
  5169     ELSE
  5170         GO TO 8200-SEND-DATAONLY.
  5171
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL1501.cbl
  5173 2000-BUILD-TRAILER-DISPLAY.
  5174
  5175     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
  5176     MOVE PI-CARRIER             TO  TRLR-CARRIER.
  5177     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
  5178     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
  5179     MOVE 'TRLR'                 TO  FILE-SWITCH.
  5180     MOVE PI-PREV-SEQ-NO         TO  TRLR-SEQ-NO.
  5181
  5182     IF PI-PREV-DIRECTION = 'B'
  5183         IF DIRECTION-SWITCH = 'F'
  5184             MOVE PI-TRLR-SEQ-NO (8) TO  TRLR-SEQ-NO
  5185                                         PI-PREV-SEQ-NO.
  5186
  5187     IF DIRECTION-SWITCH = 'B'
  5188        MOVE 'B'                 TO  PI-PREV-DIRECTION
  5189        MOVE +15                 TO  DISPLAY-CNT
  5190        GO TO 2050-START-BROWSE.
  5191
  5192     MOVE +1                     TO  DISPLAY-CNT.
  5193     MOVE 'F'                    TO  DIRECTION-SWITCH
  5194                                     PI-PREV-DIRECTION.
  5195 2010-START-BROWSE.
  5196
  5197* EXEC CICS HANDLE CONDITION
  5198*        ENDFILE   (2950-NO-MORE-TRAILERS)
  5199*        NOTFND    (2950-NO-MORE-TRAILERS)
  5200*    END-EXEC.
  5201*    MOVE '"$''I                  ! $ #00005098' TO DFHEIV0
  5202     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5204     MOVE X'2420233030303035303938' TO DFHEIV0(25:11)
  5205     CALL 'kxdfhei1' USING DFHEIV0
  5206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5207
  5208
  5209
  5210* EXEC CICS STARTBR
  5211*        DATASET   ('ELTRLR')
  5212*        RIDFLD    (ELTRLR-KEY)
  5213*        GTEQ
  5214*    END-EXEC.
  5215     MOVE 'ELTRLR' TO DFHEIV1
  5216     MOVE 0
  5217       TO DFHEIV11
  5218*    MOVE '&,         G          &   #00005103' TO DFHEIV0
  5219     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5220     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5221     MOVE X'2020233030303035313033' TO DFHEIV0(25:11)
  5222     CALL 'kxdfhei1' USING DFHEIV0,
  5223           DFHEIV1,
  5224           ELTRLR-KEY,
  5225           DFHEIV99,
  5226           DFHEIV11,
  5227           DFHEIV99
  5228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5229
  5230
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL1501.cbl
  5231     MOVE 1                      TO  PI-LINE-NO
  5232                                     SUB-1.
  5233
  5234 2020-BROWSE-FORWARD.
  5235
  5236
  5237* EXEC CICS HANDLE CONDITION
  5238*        NOTFND    (2020-BROWSE-FORWARD)
  5239*    END-EXEC.
  5240*    MOVE '"$I                   ! % #00005114' TO DFHEIV0
  5241     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5243     MOVE X'2520233030303035313134' TO DFHEIV0(25:11)
  5244     CALL 'kxdfhei1' USING DFHEIV0
  5245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5246
  5247
  5248
  5249* EXEC CICS READNEXT
  5250*        DATASET   ('ELTRLR')
  5251*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5252*        RIDFLD    (ELTRLR-KEY)
  5253*    END-EXEC.
  5254     MOVE 'ELTRLR' TO DFHEIV1
  5255     MOVE 0
  5256       TO DFHEIV11
  5257*    MOVE '&.S                   )   #00005118' TO DFHEIV0
  5258     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5259     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5260     MOVE X'2020233030303035313138' TO DFHEIV0(25:11)
  5261     CALL 'kxdfhei1' USING DFHEIV0,
  5262           DFHEIV1,
  5263           DFHEIV20,
  5264           DFHEIV99,
  5265           ELTRLR-KEY,
  5266           DFHEIV99,
  5267           DFHEIV11,
  5268           DFHEIV99,
  5269           DFHEIV99
  5270     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5271         DFHEIV20
  5272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5273
  5274
  5275     IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)  OR
  5276        (PI-CARRIER    NOT = TRLR-CARRIER)  OR
  5277        (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO) OR
  5278        (PI-CERT-NO    NOT = TRLR-CERT-NO)
  5279            GO TO 2950-NO-MORE-TRAILERS.
  5280
  5281     IF TRLR-SEQ-NO = 90
  5282         GO TO 2020-BROWSE-FORWARD.
  5283
  5284     IF RESERVE-EXPENSE-TR OR ADDRESS-TR
  5285         GO TO 2020-BROWSE-FORWARD.
  5286
  5287     IF TRLR-SEQ-NO = PI-PREV-SEQ-NO
  5288         MOVE 'N'                TO  WS-RECORDS-READ-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL1501.cbl
  5289         GO TO 2020-BROWSE-FORWARD
  5290     ELSE
  5291         IF FIRST-TIME
  5292             PERFORM 2070-INITIALIZE-SCREEN-AREA THRU 2070-EXIT
  5293             MOVE 'N'            TO  PI-FIRST-TIME-SW
  5294             MOVE 'Y'            TO  WS-RECORDS-READ-SW
  5295         ELSE
  5296             MOVE 'Y'            TO  WS-RECORDS-READ-SW.
  5297
  5298     MOVE TRLR-SEQ-NO            TO  PI-PREV-SEQ-NO.
  5299     GO TO 2090-DISPLAY-TRAILER.
  5300
  5301 2050-START-BROWSE.
  5302
  5303* EXEC CICS HANDLE CONDITION
  5304*        ENDFILE   (2950-NO-MORE-TRAILERS)
  5305*        NOTFND    (2950-NO-MORE-TRAILERS)
  5306*    END-EXEC.
  5307*    MOVE '"$''I                  ! & #00005151' TO DFHEIV0
  5308     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5310     MOVE X'2620233030303035313531' TO DFHEIV0(25:11)
  5311     CALL 'kxdfhei1' USING DFHEIV0
  5312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5313
  5314
  5315
  5316* EXEC CICS STARTBR
  5317*        DATASET   ('ELTRLR')
  5318*        RIDFLD    (ELTRLR-KEY)
  5319*        GTEQ
  5320*    END-EXEC.
  5321     MOVE 'ELTRLR' TO DFHEIV1
  5322     MOVE 0
  5323       TO DFHEIV11
  5324*    MOVE '&,         G          &   #00005156' TO DFHEIV0
  5325     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5326     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5327     MOVE X'2020233030303035313536' TO DFHEIV0(25:11)
  5328     CALL 'kxdfhei1' USING DFHEIV0,
  5329           DFHEIV1,
  5330           ELTRLR-KEY,
  5331           DFHEIV99,
  5332           DFHEIV11,
  5333           DFHEIV99
  5334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5335
  5336
  5337     MOVE 8                      TO  PI-LINE-NO
  5338                                     SUB-1.
  5339
  5340 2060-BROWSE-BACKWARD.
  5341
  5342
  5343* EXEC CICS READPREV
  5344*        DATASET   ('ELTRLR')
  5345*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5346*        RIDFLD    (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL1501.cbl
  5347*    END-EXEC.
  5348     MOVE 'ELTRLR' TO DFHEIV1
  5349     MOVE 0
  5350       TO DFHEIV11
  5351*    MOVE '&0S                   )   #00005167' TO DFHEIV0
  5352     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  5353     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5354     MOVE X'2020233030303035313637' TO DFHEIV0(25:11)
  5355     CALL 'kxdfhei1' USING DFHEIV0,
  5356           DFHEIV1,
  5357           DFHEIV20,
  5358           DFHEIV99,
  5359           ELTRLR-KEY,
  5360           DFHEIV99,
  5361           DFHEIV11,
  5362           DFHEIV99,
  5363           DFHEIV99
  5364     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5365         DFHEIV20
  5366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5367
  5368
  5369     IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)  OR
  5370        (PI-CARRIER    NOT = TRLR-CARRIER)  OR
  5371        (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO) OR
  5372        (PI-CERT-NO    NOT = TRLR-CERT-NO)
  5373            GO TO 2950-NO-MORE-TRAILERS.
  5374
  5375     IF TRLR-SEQ-NO = 90
  5376         GO TO 2060-BROWSE-BACKWARD.
  5377
  5378     IF RESERVE-EXPENSE-TR OR ADDRESS-TR
  5379         GO TO 2060-BROWSE-BACKWARD.
  5380
  5381     IF TRLR-SEQ-NO = PI-PREV-SEQ-NO
  5382         MOVE 'N'                TO  WS-RECORDS-READ-SW
  5383         GO TO 2060-BROWSE-BACKWARD
  5384     ELSE
  5385         IF FIRST-TIME
  5386             PERFORM 2070-INITIALIZE-SCREEN-AREA THRU 2070-EXIT
  5387             MOVE 'N'            TO  PI-FIRST-TIME-SW
  5388             MOVE 'Y'            TO  WS-RECORDS-READ-SW
  5389         ELSE
  5390             MOVE 'Y'            TO  WS-RECORDS-READ-SW.
  5391
  5392     MOVE TRLR-SEQ-NO            TO  PI-PREV-SEQ-NO.
  5393     GO TO 2090-DISPLAY-TRAILER.
  5394
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL1501.cbl
  5396 2070-INITIALIZE-SCREEN-AREA.
  5397
  5398     MOVE SPACES                 TO  TEXT-WORK-AREAS
  5399                                     MAP-HDG (1)   MAP-TEXT (1)
  5400                                     MAP-HDG (2)   MAP-TEXT (2)
  5401                                     MAP-HDG (3)   MAP-TEXT (3)
  5402                                     MAP-HDG (4)   MAP-TEXT (4)
  5403                                     MAP-HDG (5)   MAP-TEXT (5)
  5404                                     MAP-HDG (6)   MAP-TEXT (6)
  5405                                     MAP-HDG (7)   MAP-TEXT (7)
  5406                                     MAP-HDG (8)   MAP-TEXT (8)
  5407                                     MAP-HDG (9)   MAP-TEXT (9)
  5408                                     MAP-HDG (10)  MAP-TEXT (10)
  5409                                     MAP-HDG (11)  MAP-TEXT (11)
  5410                                     MAP-HDG (12)  MAP-TEXT (12)
  5411                                     MAP-HDG (13)  MAP-TEXT (13)
  5412                                     MAP-HDG (14)  MAP-TEXT (14)
  5413                                     MAP-HDG (15)  MAP-TEXT (15)
  5414                                     MAP-HDG (16)  MAP-TEXT (16).
  5415
  5416     MOVE ZEROS                  TO  PMT-AMT-PAID
  5417                                     AUTO-1ST-AMT
  5418                                     AUTO-REG-AMT
  5419                                     INCUR-TOT-PD.
  5420
  5421 2070-EXIT.
  5422     EXIT.
  5423
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL1501.cbl
  5425 2090-DISPLAY-TRAILER.
  5426
  5427     IF PAYMENT-TR
  5428         GO TO 2100-PAYMENT-TRAILER.
  5429
  5430     IF AUTO-PAY-TR
  5431        GO TO 2200-AUTO-PAYMENT-TRAILER.
  5432
  5433     IF CORRESPONDENCE-TR
  5434         GO TO 2300-CORRESPONDENCE-TRAILER.
  5435
  5436     IF GENERAL-INFO-TR
  5437         GO TO 2400-GENERAL-INFO-TRAILER.
  5438
  5439     IF AUTO-PROMPT-TR
  5440         GO TO 2500-AUTO-PROMPT-TRAILER.
  5441
  5442     IF DENIAL-TR
  5443         GO TO 2600-DENIAL-TRAILER.
  5444
  5445     IF INCURRED-CHG-TR
  5446         GO TO 2700-INCURRED-CHANGE-TRAILER.
  5447
  5448     IF FORM-CONTROL-TR
  5449         GO TO 2710-FORM-CONTROL-TRAILER.
  5450
  5451     IF DIRECTION-SWITCH = 'B'
  5452         GO TO 2060-BROWSE-BACKWARD
  5453     ELSE
  5454         GO TO 2020-BROWSE-FORWARD.
  5455
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL1501.cbl
  5457 2100-PAYMENT-TRAILER.
  5458     MOVE ZEROS                  TO  PMT-AMT-PAID.
  5459     MOVE PI-LINE-NO             TO  PMT-LINE-NO.
  5460     MOVE 'PAYMENT '             TO  PMT-HDG1-LIT.
  5461     MOVE 'TYPE: '               TO  PMT-TYPE-LIT.
  5462
  5463     IF TRANSFER
  5464        MOVE 'TRANSFR'           TO PMT-TYPE
  5465        GO TO 2100-CONT
  5466     ELSE
  5467        IF AT-PAYMENT-TYPE = 'I'
  5468           MOVE 'INTEREST'       TO PMT-TYPE
  5469           GO TO 2100-CONT
  5470        END-IF
  5471     END-IF
  5472     IF AT-CV-PMT-CODE = ' '
  5473         MOVE AT-PAYMENT-TYPE            TO  WS-SUB
  5474         IF  WS-SUB < 1 OR > 6
  5475             MOVE 2                      TO  WS-SUB
  5476             MOVE PAY-DESC (WS-SUB)      TO  PMT-TYPE
  5477         ELSE
  5478             MOVE PAY-DESC (WS-SUB)      TO  PMT-TYPE
  5479     ELSE
  5480         MOVE AT-CV-PMT-CODE             TO  WS-SUB
  5481         IF WS-SUB < 1 OR > 8
  5482             MOVE 1                      TO  WS-SUB
  5483             MOVE CV-PAY-DESC (WS-SUB)   TO  PMT-TYPE
  5484         ELSE
  5485             MOVE CV-PAY-DESC (WS-SUB)   TO  PMT-TYPE.
  5486
  5487 2100-CONT.
  5488
  5489     MOVE ' CHECK NO: '          TO  PMT-CHECK-NO-LIT.
  5490     MOVE AT-CHECK-NO            TO  PMT-CHECK-NO.
  5491
  5492     IF AT-CHECK-WRITTEN-DT = LOW-VALUES
  5493         IF AT-TO-BE-WRITTEN-DT = LOW-VALUES
  5494             MOVE ' DT WRITTEN : '         TO  PMT-DT-WRITTEN-LIT
  5495             MOVE SPACES                   TO  PMT-DT-WRITTEN
  5496         ELSE
  5497             MOVE ' HOLD UNTIL : '         TO  PMT-DT-WRITTEN-LIT
  5498             MOVE AT-TO-BE-WRITTEN-DT      TO  DC-BIN-DATE-1
  5499             MOVE ' '                      TO  DC-OPTION-CODE
  5500             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5501             IF NO-CONVERSION-ERROR
  5502                 MOVE DC-GREG-DATE-1-EDIT  TO  PMT-DT-WRITTEN
  5503             ELSE
  5504                 MOVE SPACES               TO  PMT-DT-WRITTEN
  5505     ELSE
  5506         MOVE ' DT WRITTEN : '             TO  PMT-DT-WRITTEN-LIT
  5507         MOVE AT-CHECK-WRITTEN-DT          TO  DC-BIN-DATE-1
  5508         MOVE ' '                          TO  DC-OPTION-CODE
  5509         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5510         IF NO-CONVERSION-ERROR
  5511             MOVE DC-GREG-DATE-1-EDIT      TO  PMT-DT-WRITTEN
  5512         ELSE
  5513             MOVE SPACES                   TO  PMT-DT-WRITTEN.
  5514
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL1501.cbl
  5515     MOVE ' AMT:'                TO  PMT-AMT-PD-LIT.
  5516     MOVE AT-AMOUNT-PAID         TO  PMT-AMT-PAID.
  5517
  5518     MOVE 'PAID'                 TO  PMT-HDG2-LIT.
  5519     MOVE 'FROM: '               TO  PMT-FROM-LIT.
  5520
  5521     IF AT-PAID-FROM-DT = LOW-VALUES
  5522         MOVE SPACES                     TO  PMT-PAID-FROM
  5523     ELSE
  5524         MOVE AT-PAID-FROM-DT            TO  DC-BIN-DATE-1
  5525         MOVE ' '                        TO  DC-OPTION-CODE
  5526         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5527         IF NO-CONVERSION-ERROR
  5528             MOVE DC-GREG-DATE-1-EDIT    TO PMT-PAID-FROM
  5529         ELSE
  5530             MOVE SPACES                 TO  PMT-PAID-FROM.
  5531
  5532     IF PI-USES-PAID-TO
  5533         MOVE ' PAID TO: '               TO  PMT-THRU-LIT
  5534     ELSE
  5535         MOVE ' PD THRU: '               TO  PMT-THRU-LIT.
  5536
  5537     IF AT-PAID-THRU-DT = LOW-VALUES
  5538         MOVE SPACES                     TO  PMT-PAID-THRU
  5539     ELSE
  5540         IF PI-USES-PAID-TO
  5541             MOVE AT-PAID-THRU-DT        TO  DC-BIN-DATE-1
  5542             MOVE '6'                    TO  DC-OPTION-CODE
  5543             MOVE +1                     TO  DC-ELAPSED-DAYS
  5544             MOVE +0                     TO  DC-ELAPSED-MONTHS
  5545             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5546             IF NO-CONVERSION-ERROR
  5547                 MOVE DC-GREG-DATE-1-EDIT TO PMT-PAID-THRU
  5548             ELSE
  5549                 MOVE SPACES             TO  PMT-PAID-THRU
  5550         ELSE
  5551             MOVE AT-PAID-THRU-DT        TO  DC-BIN-DATE-1
  5552             MOVE ' '                    TO  DC-OPTION-CODE
  5553             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5554             IF NO-CONVERSION-ERROR
  5555                 MOVE DC-GREG-DATE-1-EDIT TO  PMT-PAID-THRU
  5556             ELSE
  5557                 MOVE SPACES             TO  PMT-PAID-THRU.
  5558
  5559     MOVE ' PAYEE: '             TO  PMT-PAYEE-LIT.
  5560     IF INSURED-PAID
  5561         MOVE 'INSURED'          TO  PMT-PAYEE.
  5562     IF BENEFICIARY-PAID
  5563         MOVE 'BENEF '           TO  PMT-PAYEE.
  5564     IF ACCOUNT-PAID
  5565         MOVE 'ACCOUNT'          TO  PMT-PAYEE.
  5566     IF OTHER-1-PAID
  5567         MOVE 'OTHER 1'          TO  PMT-PAYEE.
  5568     IF OTHER-2-PAID
  5569         MOVE 'OTHER 2'          TO  PMT-PAYEE.
  5570     IF DOCTOR-PAID
  5571         MOVE 'DOCTOR'           TO  PMT-PAYEE.
  5572     IF EMPLOYER-PAID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL1501.cbl
  5573         MOVE 'EMPLOY'           TO  PMT-PAYEE.
  5574
  5575     IF AT-VOID-DT = LOW-VALUES OR SPACES
  5576         MOVE SPACES                     TO  PMT-VOID-LIT
  5577     ELSE
  5578         IF AT-VOID-TYPE = 'S'
  5579             MOVE ' STOP DATE : '        TO  PMT-VOID-LIT
  5580         ELSE
  5581             MOVE ' VOID DATE : '        TO  PMT-VOID-LIT.
  5582
  5583     IF AT-VOID-DT = LOW-VALUES
  5584         MOVE SPACES                     TO  PMT-VOID-DT
  5585     ELSE
  5586         MOVE AT-VOID-DT                 TO  DC-BIN-DATE-1
  5587         MOVE ' '                        TO  DC-OPTION-CODE
  5588         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5589         IF NO-CONVERSION-ERROR
  5590             MOVE DC-GREG-DATE-1-EDIT    TO  PMT-VOID-DT
  5591         ELSE
  5592             MOVE SPACES                 TO  PMT-VOID-DT.
  5593
  5594     MOVE PMT-HDG1               TO  MAP-HDG        (DISPLAY-CNT).
  5595     MOVE PMT-TEXT-1             TO  MAP-TEXT       (DISPLAY-CNT).
  5596     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  5597     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  5598     ADD +1 TO DISPLAY-CNT.
  5599     MOVE PMT-HDG2               TO  MAP-HDG        (DISPLAY-CNT).
  5600     MOVE PMT-TEXT-2             TO  MAP-TEXT       (DISPLAY-CNT).
  5601     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  5602                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  5603     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  5604     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  5605     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  5606
  5607     GO TO 2800-INCR-DISPLAY-CNT.
  5608
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL1501.cbl
  5610 2200-AUTO-PAYMENT-TRAILER.
  5611     MOVE PI-LINE-NO             TO  AUTO-LINE-NO.
  5612     MOVE 'AUTO PMT'             TO  AUTO-HDG1-LIT.
  5613
  5614     MOVE 'EFF : '                       TO  AUTO-EFF-DT-LIT.
  5615
  5616     IF AT-SCHEDULE-START-DT = LOW-VALUES
  5617         MOVE SPACES                     TO  AUTO-EFF-DT
  5618     ELSE
  5619         MOVE AT-SCHEDULE-START-DT   TO  DC-BIN-DATE-1
  5620         MOVE ' '                    TO  DC-OPTION-CODE
  5621         MOVE +0                     TO  DC-ELAPSED-DAYS
  5622                                         DC-ELAPSED-MONTHS
  5623         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5624         IF NO-CONVERSION-ERROR
  5625             MOVE DC-GREG-DATE-1-EDIT TO AUTO-EFF-DT
  5626         ELSE
  5627             MOVE SPACES             TO  AUTO-EFF-DT.
  5628
  5629     MOVE ' 1ST AMT: '           TO  AUTO-1ST-AMT-LIT.
  5630     MOVE ' REG AMOUNT : '       TO  AUTO-REG-AMT-LIT.
  5631     MOVE AT-FIRST-PMT-AMT       TO  AUTO-1ST-AMT.
  5632     MOVE AT-REGULAR-PMT-AMT     TO  AUTO-REG-AMT.
  5633
  5634     MOVE ' STAT : '             TO  AUTO-PMT-STATUS-LIT.
  5635
  5636     IF AT-TERMINATED-DT NOT = LOW-VALUES
  5637         MOVE 'TERM'             TO  AUTO-PMT-STATUS
  5638     ELSE
  5639         MOVE 'ACTIVE'           TO  AUTO-PMT-STATUS.
  5640
  5641     MOVE 'PAYE'                 TO  AUTO-HDG2-LIT.
  5642     MOVE '    : '               TO  AUTO-PAYEE-LIT.
  5643
  5644     IF INSURED-PAID-AUTO
  5645         MOVE 'INSURED '         TO  AUTO-PAYEE.
  5646     IF BENEFICIARY-PAID-AUTO
  5647         MOVE 'BENEF   '         TO  AUTO-PAYEE.
  5648     IF ACCOUNT-PAID-AUTO
  5649         MOVE 'ACCOUNT '         TO  AUTO-PAYEE.
  5650     IF OTHER-1-PAID-AUTO
  5651         MOVE 'OTHER 1 '         TO  AUTO-PAYEE.
  5652     IF OTHER-2-PAID
  5653         MOVE 'OTHER 2 '         TO  AUTO-PAYEE.
  5654     IF DOCTOR-PAID
  5655         MOVE 'DOCTOR  '         TO  AUTO-PAYEE.
  5656
  5657     MOVE ' 1ST PMT: '                   TO  AUTO-1ST-PMT-LIT.
  5658
  5659     IF AT-1ST-PAY-THRU-DT = LOW-VALUES
  5660         MOVE SPACES                     TO  AUTO-1ST-PMT-DT
  5661     ELSE
  5662         IF PI-USES-PAID-TO
  5663             MOVE AT-1ST-PAY-THRU-DT     TO  DC-BIN-DATE-1
  5664             MOVE '6'                    TO  DC-OPTION-CODE
  5665             MOVE +1                     TO  DC-ELAPSED-DAYS
  5666             MOVE +0                     TO  DC-ELAPSED-MONTHS
  5667             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL1501.cbl
  5668             IF NO-CONVERSION-ERROR
  5669                 MOVE DC-GREG-DATE-1-EDIT TO AUTO-1ST-PMT-DT
  5670             ELSE
  5671                 MOVE SPACES             TO  AUTO-1ST-PMT-DT
  5672         ELSE
  5673             MOVE AT-1ST-PAY-THRU-DT     TO  DC-BIN-DATE-1
  5674             MOVE ' '                    TO  DC-OPTION-CODE
  5675             MOVE +0                     TO  DC-ELAPSED-DAYS
  5676                                             DC-ELAPSED-MONTHS
  5677             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5678             IF NO-CONVERSION-ERROR
  5679                 MOVE DC-GREG-DATE-1-EDIT TO AUTO-1ST-PMT-DT
  5680             ELSE
  5681                 MOVE SPACES             TO  AUTO-1ST-PMT-DT.
  5682
  5683     IF AT-TERMINATED-DT = LOW-VALUES
  5684         IF AT-SCHEDULE-END-DT = LOW-VALUES
  5685             MOVE SPACES                     TO  AUTO-LST-PMT-DT
  5686         ELSE
  5687             MOVE ' LST PMT    : '           TO  AUTO-LST-PMT-LIT
  5688             IF PI-USES-PAID-TO
  5689                 MOVE AT-SCHEDULE-END-DT     TO  DC-BIN-DATE-1
  5690                 MOVE '6'                    TO  DC-OPTION-CODE
  5691                 MOVE +1                     TO  DC-ELAPSED-DAYS
  5692                 MOVE +0                     TO  DC-ELAPSED-MONTHS
  5693                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5694                 IF NO-CONVERSION-ERROR
  5695                     MOVE DC-GREG-DATE-1-EDIT TO AUTO-LST-PMT-DT
  5696                 ELSE
  5697                     MOVE SPACES             TO  AUTO-LST-PMT-DT
  5698             ELSE
  5699                 MOVE AT-SCHEDULE-END-DT     TO  DC-BIN-DATE-1
  5700                 MOVE ' '                    TO  DC-OPTION-CODE
  5701                 MOVE +0                     TO  DC-ELAPSED-DAYS
  5702                                                 DC-ELAPSED-MONTHS
  5703                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5704                 IF NO-CONVERSION-ERROR
  5705                     MOVE DC-GREG-DATE-1-EDIT TO AUTO-LST-PMT-DT
  5706                 ELSE
  5707                     MOVE SPACES             TO  AUTO-LST-PMT-DT
  5708     ELSE
  5709         MOVE ' TERM DATE  : '               TO  AUTO-LST-PMT-LIT
  5710         MOVE AT-TERMINATED-DT               TO  DC-BIN-DATE-1
  5711         MOVE ' '                            TO  DC-OPTION-CODE
  5712         MOVE +0                             TO  DC-ELAPSED-DAYS
  5713                                                 DC-ELAPSED-MONTHS
  5714         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5715         IF NO-CONVERSION-ERROR
  5716             MOVE DC-GREG-DATE-1-EDIT        TO  AUTO-LST-PMT-DT
  5717         ELSE
  5718             MOVE SPACES                     TO  AUTO-LST-PMT-DT.
  5719
  5720     MOVE AUTO-PMT-HDG1          TO  MAP-HDG        (DISPLAY-CNT).
  5721     MOVE AUTO-PMT-TEXT1         TO  MAP-TEXT       (DISPLAY-CNT).
  5722     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  5723     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  5724     ADD +1 TO DISPLAY-CNT.
  5725     MOVE AUTO-PMT-HDG2          TO  MAP-HDG        (DISPLAY-CNT).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL1501.cbl
  5726     MOVE AUTO-PMT-TEXT2         TO  MAP-TEXT       (DISPLAY-CNT).
  5727     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  5728                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  5729     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  5730     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  5731     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  5732
  5733     GO TO 2800-INCR-DISPLAY-CNT.
  5734
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL1501.cbl
  5736 2300-CORRESPONDENCE-TRAILER.
  5737     MOVE PI-LINE-NO             TO  CORR-LINE-NO.
  5738     MOVE 'LETTER'               TO  CORR-HDG1-LIT.
  5739     MOVE 'FORM: '               TO  CORR-FORM-LIT.
  5740     MOVE AT-STD-LETTER-FORM     TO  CORR-FORM-TYPE.
  5741
  5742     MOVE ' DT SENT: '                   TO  CORR-DT-SENT-LIT.
  5743
  5744     IF AT-LETTER-SENT-DT = LOW-VALUES
  5745         MOVE SPACES                     TO  CORR-DT-SENT
  5746     ELSE
  5747         MOVE AT-LETTER-SENT-DT          TO  DC-BIN-DATE-1
  5748         MOVE ' '                        TO  DC-OPTION-CODE
  5749         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5750         IF NO-CONVERSION-ERROR
  5751             MOVE DC-GREG-DATE-1-EDIT    TO  CORR-DT-SENT
  5752         ELSE
  5753             MOVE SPACES                 TO  CORR-DT-SENT.
  5754
  5755        MOVE ' INIT PRT: '               TO  CORR-INIT-PRT-LIT.
  5756
  5757     IF AT-INITIAL-PRINT-DATE = LOW-VALUES
  5758         MOVE SPACES                     TO  CORR-INIT-PRT-DT
  5759     ELSE
  5760         MOVE AT-INITIAL-PRINT-DATE      TO  DC-BIN-DATE-1
  5761         MOVE ' '                        TO  DC-OPTION-CODE
  5762         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5763         IF NO-CONVERSION-ERROR
  5764             MOVE DC-GREG-DATE-1-EDIT    TO  CORR-INIT-PRT-DT
  5765         ELSE
  5766             MOVE SPACES                 TO  CORR-INIT-PRT-DT.
  5767
  5768     MOVE ' TO: '                TO  CORR-ADDR-LIT.
  5769     MOVE AT-ADDRESEE-TYPE       TO  CORR-ADDR-TYPE.
  5770
  5771     IF AT-LETTER-TO-BENE EQUAL 'Y'
  5772        MOVE 'LETTER TO BENE'    TO CORR-LET-TO-BEN
  5773     ELSE
  5774        MOVE SPACES              TO CORR-LET-TO-BEN
  5775     END-IF.
  5776
  5777     MOVE 'DATE: '                          TO  CORR-RESEND-LIT.
  5778
  5779     IF AT-RESEND-PRINT-DATE = LOW-VALUES
  5780         IF AT-AUTO-RE-SEND-DT = LOW-VALUES
  5781             MOVE SPACES                    TO  CORR-RESEND-DT
  5782         ELSE
  5783             MOVE 'RSND'                    TO  CORR-HDG2-LIT
  5784             MOVE AT-AUTO-RE-SEND-DT        TO  DC-BIN-DATE-1
  5785             MOVE ' '                       TO  DC-OPTION-CODE
  5786             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5787             IF NO-CONVERSION-ERROR
  5788                 MOVE DC-GREG-DATE-1-EDIT   TO  CORR-RESEND-DT
  5789             ELSE
  5790                 MOVE SPACES                TO  CORR-RESEND-DT
  5791     ELSE
  5792         MOVE 'RSNT'                        TO  CORR-HDG2-LIT
  5793         MOVE AT-RESEND-PRINT-DATE          TO  DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL1501.cbl
  5794         MOVE ' '                           TO  DC-OPTION-CODE
  5795         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5796         IF NO-CONVERSION-ERROR
  5797             MOVE DC-GREG-DATE-1-EDIT       TO  CORR-RESEND-DT
  5798         ELSE
  5799             MOVE SPACES                    TO  CORR-RESEND-DT.
  5800
  5801     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
  5802        AND (AT-LETTER-ANSWERED-DT = LOW-VALUES  OR
  5803             AT-LETTER-ANSWERED-DT > AT-STOP-LETTER-DT)
  5804           MOVE '    STOP:'             TO  CORR-RECVD-LIT
  5805           MOVE AT-STOP-LETTER-DT       TO  DC-BIN-DATE-1
  5806           MOVE ' '                     TO  DC-OPTION-CODE
  5807           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5808           IF NO-CONVERSION-ERROR
  5809             MOVE DC-GREG-DATE-1-EDIT   TO  CORR-RECVD-DT
  5810           ELSE
  5811             MOVE SPACES                TO  CORR-RECVD-DT
  5812           END-IF
  5813     ELSE
  5814        MOVE ' RECVD  : '               TO  CORR-RECVD-LIT
  5815        IF AT-LETTER-ANSWERED-DT = LOW-VALUES
  5816            MOVE SPACES                 TO  CORR-RECVD-DT
  5817        ELSE
  5818            MOVE AT-LETTER-ANSWERED-DT  TO  DC-BIN-DATE-1
  5819            MOVE ' '                    TO  DC-OPTION-CODE
  5820            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5821            IF NO-CONVERSION-ERROR
  5822                MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD-DT
  5823            ELSE
  5824                MOVE SPACES             TO  CORR-RECVD-DT
  5825            END-IF
  5826        END-IF
  5827     END-IF.
  5828
  5829     MOVE ' FOLLOW UP  : '              TO  CORR-FOLLOW-UP-LIT.
  5830
  5831     IF AT-RECEIPT-FOLLOW-UP = LOW-VALUES
  5832         MOVE SPACES                    TO  CORR-FOLLOW-UP-DT
  5833     ELSE
  5834         MOVE AT-RECEIPT-FOLLOW-UP      TO  DC-BIN-DATE-1
  5835         MOVE ' '                       TO  DC-OPTION-CODE
  5836         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5837         IF NO-CONVERSION-ERROR
  5838             MOVE DC-GREG-DATE-1-EDIT   TO  CORR-FOLLOW-UP-DT
  5839         ELSE
  5840             MOVE SPACES                TO  CORR-FOLLOW-UP-DT.
  5841
  5842     MOVE ' ARC: '               TO  CORR-ARCH-LIT.
  5843     MOVE AT-LETTER-ARCHIVE-NO   TO  CORR-ARCH-NO.
  5844
  5845     MOVE CORR-HDG1              TO  MAP-HDG        (DISPLAY-CNT).
  5846     MOVE CORR-TEXT-1            TO  MAP-TEXT       (DISPLAY-CNT).
  5847     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  5848     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  5849     ADD +1 TO DISPLAY-CNT.
  5850     MOVE CORR-HDG2              TO  MAP-HDG        (DISPLAY-CNT).
  5851     MOVE CORR-TEXT-2            TO  MAP-TEXT       (DISPLAY-CNT).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL1501.cbl
  5852     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  5853                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  5854     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  5855     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  5856     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  5857
  5858     GO TO 2800-INCR-DISPLAY-CNT.
  5859
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL1501.cbl
  5861 2400-GENERAL-INFO-TRAILER.
  5862
  5863     MOVE SPACES                 TO GEN-INFO-LINE-1
  5864                                    GEN-INFO-LINE-2.
  5865
  5866     IF AT-PAYMENT-NOTE
  5867         IF DIRECTION-SWITCH = 'B'
  5868             GO TO 2060-BROWSE-BACKWARD
  5869         ELSE
  5870             GO TO 2020-BROWSE-FORWARD.
  5871
  5872     MOVE PI-LINE-NO             TO  GI-LINE-NO.
  5873
  5874     IF AT-MAINT-NOTE
  5875         MOVE 'MAINT'            TO  GI-HDG1-LIT
  5876     ELSE
  5877         IF AT-CALL-NOTE
  5878             MOVE 'CALL'             TO  GI-HDG1-LIT
  5879             IF AT-PHONE-CALL-IN
  5880                 MOVE '     IN'      TO  GI-HDG2-LIT
  5881             ELSE
  5882                 MOVE '     OUT'     TO  GI-HDG2-LIT
  5883             END-IF
  5884         ELSE
  5885             IF AT-CERT-CHANGE
  5886                 MOVE 'CERT CHG'         TO  GI-HDG1-LIT
  5887             ELSE
  5888                 MOVE 'NOTE'             TO  GI-HDG1-LIT
  5889             END-IF
  5890         END-IF
  5891     END-IF.
  5892
  5893     MOVE 'MSG : '               TO  GEN-INFO-MSG-1-LIT
  5894                                     GEN-INFO-MSG-2-LIT.
  5895
  5896     MOVE AT-INFO-LINE-1         TO  GEN-INFO-MSG-1.
  5897     MOVE AT-INFO-LINE-2         TO  GEN-INFO-MSG-2.
  5898
  5899     MOVE GEN-INFO-HDG1          TO  MAP-HDG        (DISPLAY-CNT).
  5900     MOVE GEN-INFO-TEXT-1        TO  MAP-TEXT       (DISPLAY-CNT).
  5901     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  5902     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  5903     ADD +1 TO DISPLAY-CNT.
  5904     MOVE GEN-INFO-HDG2          TO  MAP-HDG        (DISPLAY-CNT).
  5905     MOVE GEN-INFO-TEXT-2        TO  MAP-TEXT       (DISPLAY-CNT).
  5906     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  5907                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  5908     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  5909     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  5910     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  5911
  5912     GO TO 2800-INCR-DISPLAY-CNT.
  5913
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL1501.cbl
  5915 2500-AUTO-PROMPT-TRAILER.
  5916     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5917     MOVE '5'                    TO  DC-OPTION-CODE.
  5918     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  5919
  5920     IF DC-BIN-DATE-1 > AT-PROMPT-END-DT
  5921         IF DIRECTION-SWITCH = 'B'
  5922             GO TO 2060-BROWSE-BACKWARD
  5923         ELSE
  5924             GO TO 2020-BROWSE-FORWARD.
  5925
  5926     MOVE PI-LINE-NO             TO  REM-LINE-NO.
  5927     MOVE 'REMINDER'             TO  REM-HDG1-LIT.
  5928     MOVE 'LN 1: '               TO  REM-LINE-1-LIT.
  5929     MOVE 'LN 2: '               TO  REM-LINE-2-LIT.
  5930
  5931     MOVE AT-PROMPT-LINE-1       TO  REM-LINE-1.
  5932     MOVE AT-PROMPT-LINE-2       TO  REM-LINE-2.
  5933
  5934     MOVE REMINDER-HDG1          TO  MAP-HDG        (DISPLAY-CNT).
  5935     MOVE REMINDER-TEXT-1        TO  MAP-TEXT       (DISPLAY-CNT).
  5936     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  5937     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  5938     ADD +1 TO DISPLAY-CNT.
  5939     MOVE REMINDER-HDG2          TO  MAP-HDG        (DISPLAY-CNT).
  5940     MOVE REMINDER-TEXT-2        TO  MAP-TEXT       (DISPLAY-CNT).
  5941     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  5942                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  5943     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  5944     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  5945     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  5946
  5947     GO TO 2800-INCR-DISPLAY-CNT.
  5948
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL1501.cbl
  5950 2600-DENIAL-TRAILER.
  5951     MOVE PI-LINE-NO             TO  DENIAL-LINE-NO.
  5952     MOVE 'DENIAL'               TO  DENIAL-HDG1-LIT.
  5953     MOVE 'LN 1: '               TO  DENIAL-LN1-LIT.
  5954     MOVE 'LN 2: '               TO  DENIAL-LN2-LIT.
  5955
  5956     MOVE AT-DENIAL-INFO-1       TO  DENIAL-LN1.
  5957     MOVE AT-DENIAL-INFO-2       TO  DENIAL-LN2.
  5958
  5959     MOVE DENIAL-HDG1            TO  MAP-HDG        (DISPLAY-CNT).
  5960     MOVE DENIAL-TEXT-1          TO  MAP-TEXT       (DISPLAY-CNT).
  5961     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  5962     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  5963     ADD +1 TO DISPLAY-CNT.
  5964     MOVE DENIAL-HDG2            TO  MAP-HDG        (DISPLAY-CNT).
  5965     MOVE DENIAL-TEXT-2          TO  MAP-TEXT       (DISPLAY-CNT).
  5966     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  5967                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  5968     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  5969     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  5970     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  5971
  5972     GO TO 2800-INCR-DISPLAY-CNT.
  5973
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL1501.cbl
  5975 2700-INCURRED-CHANGE-TRAILER.
  5976     MOVE PI-LINE-NO             TO  INCUR-LINE-NO.
  5977     MOVE 'INCUR CG'             TO  INCUR-HDG1-LIT.
  5978
  5979     MOVE 'INC : '                       TO  INCUR-INCUR-LIT.
  5980     IF AT-OLD-INCURRED-DT = LOW-VALUES
  5981         MOVE SPACES                     TO  INCUR-INCUR-DT
  5982     ELSE
  5983         MOVE AT-OLD-INCURRED-DT         TO  DC-BIN-DATE-1
  5984         MOVE ' '                        TO  DC-OPTION-CODE
  5985         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5986         IF NO-CONVERSION-ERROR
  5987             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-INCUR-DT
  5988         ELSE
  5989             MOVE SPACES                 TO  INCUR-INCUR-DT.
  5990
  5991     MOVE ' REPORT : '                   TO  INCUR-REPORT-LIT.
  5992     IF AT-OLD-REPORTED-DT = LOW-VALUES
  5993         MOVE SPACES                     TO  INCUR-REPORT-DT
  5994     ELSE
  5995         MOVE AT-OLD-REPORTED-DT         TO  DC-BIN-DATE-1
  5996         MOVE ' '                        TO  DC-OPTION-CODE
  5997         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5998         IF NO-CONVERSION-ERROR
  5999             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-REPORT-DT
  6000         ELSE
  6001             MOVE SPACES                 TO  INCUR-REPORT-DT.
  6002
  6003     MOVE ' ESTABLISH  : '               TO  INCUR-ESTAB-LIT.
  6004     IF AT-OLD-ESTABLISHED-DT = LOW-VALUES
  6005         MOVE SPACES                     TO  INCUR-ESTAB-DT
  6006     ELSE
  6007         MOVE AT-OLD-ESTABLISHED-DT      TO  DC-BIN-DATE-1
  6008         MOVE ' '                        TO  DC-OPTION-CODE
  6009         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6010         IF NO-CONVERSION-ERROR
  6011             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-ESTAB-DT
  6012         ELSE
  6013             MOVE SPACES                 TO  INCUR-ESTAB-DT.
  6014
  6015     MOVE 'PAID'                         TO  INCUR-HDG2-LIT.
  6016     IF PI-USES-PAID-TO
  6017         MOVE '  TO: '                   TO  INCUR-PD-THRU-LIT
  6018     ELSE
  6019         MOVE 'THRU: '                   TO  INCUR-PD-THRU-LIT.
  6020
  6021     IF AT-OLD-PAID-THRU-DT = LOW-VALUES
  6022         MOVE SPACES                     TO  INCUR-PD-THRU-DT
  6023     ELSE
  6024         MOVE AT-OLD-PAID-THRU-DT        TO  DC-BIN-DATE-1
  6025         MOVE ' '                        TO  DC-OPTION-CODE
  6026         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6027         IF NO-CONVERSION-ERROR
  6028             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-PD-THRU-DT
  6029         ELSE
  6030             MOVE SPACES                 TO  INCUR-PD-THRU-DT.
  6031
  6032     MOVE ' TOT AMT: '           TO  INCUR-TOT-PD-LIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL1501.cbl
  6033     MOVE ' TOT DAYS PD: '       TO  INCUR-TOT-DAYS-LIT.
  6034     MOVE ' NO PMTS : '          TO  INCUR-NO-PMTS-LIT.
  6035     MOVE AT-OLD-TOTAL-PAID      TO  INCUR-TOT-PD.
  6036     MOVE AT-OLD-DAYS-PAID       TO  INCUR-TOT-DAYS-PD.
  6037     MOVE AT-OLD-NO-OF-PMTS      TO  INCUR-NO-PMTS.
  6038
  6039     MOVE INCUR-CHG-HDG1         TO  MAP-HDG        (DISPLAY-CNT).
  6040     MOVE INCUR-TEXT-1           TO  MAP-TEXT       (DISPLAY-CNT).
  6041     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6042     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6043     ADD +1 TO DISPLAY-CNT.
  6044     MOVE INCUR-CHG-HDG2         TO  MAP-HDG        (DISPLAY-CNT).
  6045     MOVE INCUR-TEXT-2           TO  MAP-TEXT       (DISPLAY-CNT).
  6046     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6047                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6048     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6049     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6050     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6051
  6052     GO TO 2800-INCR-DISPLAY-CNT.
  6053
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL1501.cbl
  6055 2710-FORM-CONTROL-TRAILER.
  6056     MOVE PI-LINE-NO             TO  FORM-LINE-NO.
  6057     MOVE 'FORM    '             TO  FORM-HDG1-LIT.
  6058
  6059     MOVE 'FORM: '               TO  FORM-TYPE-LIT.
  6060
  6061     IF INITIAL-FORM
  6062        MOVE 'INIT'              TO  FORM-TYPE
  6063     ELSE
  6064        MOVE 'PROG'              TO  FORM-TYPE.
  6065
  6066     IF AT-FORM-PRINTED-DT = LOW-VALUES
  6067         MOVE ' SEND ON: '                   TO  FORM-SEND-ON-LIT
  6068         IF AT-FORM-SEND-ON-DT = LOW-VALUES
  6069             MOVE SPACES                     TO  FORM-SEND-ON-DT
  6070         ELSE
  6071             MOVE AT-FORM-SEND-ON-DT         TO  DC-BIN-DATE-1
  6072             MOVE ' '                        TO  DC-OPTION-CODE
  6073             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6074             IF NO-CONVERSION-ERROR
  6075                 MOVE DC-GREG-DATE-1-EDIT    TO  FORM-SEND-ON-DT
  6076             ELSE
  6077                 MOVE SPACES                 TO  FORM-SEND-ON-DT
  6078     ELSE
  6079         MOVE ' SENT ON: '                   TO  FORM-SEND-ON-LIT
  6080         MOVE AT-FORM-PRINTED-DT             TO  DC-BIN-DATE-1
  6081         MOVE ' '                            TO  DC-OPTION-CODE
  6082         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6083         IF NO-CONVERSION-ERROR
  6084             MOVE DC-GREG-DATE-1-EDIT        TO  FORM-SEND-ON-DT
  6085         ELSE
  6086             MOVE SPACES                     TO  FORM-SEND-ON-DT.
  6087
  6088     IF AT-FORM-REPRINT-DT = LOW-VALUES
  6089         MOVE ' RESEND     : '               TO  FORM-RESEND-LIT
  6090         IF AT-FORM-RE-SEND-DT = LOW-VALUES
  6091             MOVE SPACES                     TO  FORM-RESEND-DT
  6092         ELSE
  6093             MOVE AT-FORM-RE-SEND-DT         TO  DC-BIN-DATE-1
  6094             MOVE ' '                        TO  DC-OPTION-CODE
  6095             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6096             IF NO-CONVERSION-ERROR
  6097                 MOVE DC-GREG-DATE-1-EDIT    TO  FORM-RESEND-DT
  6098             ELSE
  6099                 MOVE SPACES                 TO  FORM-RESEND-DT
  6100     ELSE
  6101         MOVE ' RESENT     : '               TO  FORM-RESEND-LIT
  6102         MOVE AT-FORM-REPRINT-DT             TO  DC-BIN-DATE-1
  6103         MOVE ' '                            TO  DC-OPTION-CODE
  6104         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6105         IF NO-CONVERSION-ERROR
  6106             MOVE DC-GREG-DATE-1-EDIT        TO  FORM-RESEND-DT
  6107         ELSE
  6108             MOVE SPACES                     TO  FORM-RESEND-DT.
  6109
  6110     MOVE ' FOL: '                       TO  FORM-FOLLOW-UP-LIT.
  6111
  6112     IF AT-FORM-FOLLOW-UP-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL1501.cbl
  6113         MOVE SPACES                     TO  FORM-FOLLOW-UP-DT
  6114     ELSE
  6115         MOVE AT-FORM-FOLLOW-UP-DT       TO  DC-BIN-DATE-1
  6116         MOVE ' '                        TO  DC-OPTION-CODE
  6117         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6118         IF NO-CONVERSION-ERROR
  6119             MOVE DC-GREG-DATE-1-EDIT    TO  FORM-FOLLOW-UP-DT
  6120         ELSE
  6121             MOVE SPACES                 TO  FORM-FOLLOW-UP-DT.
  6122
  6123     MOVE 'REC '                      TO  FORM-HDG2-LIT.
  6124     MOVE 'INS : '                    TO  FORM-REC-INS-LIT.
  6125
  6126     IF AT-FORM-ANSWERED-DT = LOW-VALUES
  6127         MOVE SPACES                  TO  FORM-REC-INS-DT
  6128     ELSE
  6129         MOVE AT-FORM-ANSWERED-DT     TO  DC-BIN-DATE-1
  6130         MOVE ' '                     TO  DC-OPTION-CODE
  6131         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6132         IF NO-CONVERSION-ERROR
  6133             MOVE DC-GREG-DATE-1-EDIT TO  FORM-REC-INS-DT
  6134         ELSE
  6135             MOVE SPACES              TO  FORM-REC-INS-DT.
  6136
  6137     MOVE ' REC PHY: '                 TO  FORM-REC-PHY-LIT.
  6138
  6139     IF AT-PHY-FORM-ANSWERED-DT = LOW-VALUES
  6140         MOVE SPACES                   TO  FORM-REC-PHY-DT
  6141     ELSE
  6142         MOVE AT-PHY-FORM-ANSWERED-DT  TO  DC-BIN-DATE-1
  6143         MOVE ' '                      TO  DC-OPTION-CODE
  6144         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6145         IF NO-CONVERSION-ERROR
  6146             MOVE DC-GREG-DATE-1-EDIT  TO  FORM-REC-PHY-DT
  6147         ELSE
  6148             MOVE SPACES               TO  FORM-REC-PHY-DT.
  6149
  6150     MOVE ' REC EMP    : '             TO  FORM-REC-EMP-LIT.
  6151
  6152     IF AT-EMP-FORM-ANSWERED-DT = LOW-VALUES
  6153         MOVE SPACES                   TO  FORM-REC-EMP-DT
  6154     ELSE
  6155         MOVE AT-EMP-FORM-ANSWERED-DT  TO  DC-BIN-DATE-1
  6156         MOVE ' '                      TO  DC-OPTION-CODE
  6157         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6158         IF NO-CONVERSION-ERROR
  6159             MOVE DC-GREG-DATE-1-EDIT  TO  FORM-REC-EMP-DT
  6160         ELSE
  6161             MOVE SPACES               TO  FORM-REC-EMP-DT.
  6162
  6163     MOVE FORM-HDG1              TO  MAP-HDG        (DISPLAY-CNT).
  6164     MOVE FORM-TEXT-1            TO  MAP-TEXT       (DISPLAY-CNT).
  6165     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6166     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6167     ADD +1 TO DISPLAY-CNT.
  6168     MOVE FORM-HDG2              TO  MAP-HDG        (DISPLAY-CNT).
  6169     MOVE FORM-TEXT-2            TO  MAP-TEXT       (DISPLAY-CNT).
  6170     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL1501.cbl
  6171                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6172     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6173     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6174     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6175
  6176     GO TO 2800-INCR-DISPLAY-CNT.
  6177
  6178 2800-INCR-DISPLAY-CNT.
  6179
  6180     IF DIRECTION-SWITCH = 'F'
  6181         ADD +1 TO DISPLAY-CNT
  6182                   PI-LINE-NO
  6183                   SUB-1
  6184         IF DISPLAY-CNT > +16
  6185             GO TO 2999-EXIT
  6186         ELSE
  6187             NEXT SENTENCE
  6188     ELSE
  6189         SUBTRACT +3 FROM DISPLAY-CNT
  6190         SUBTRACT +1 FROM PI-LINE-NO
  6191         SUBTRACT +1 FROM SUB-1
  6192         IF DISPLAY-CNT < +1
  6193             GO TO 2999-EXIT.
  6194
  6195     IF DIRECTION-SWITCH = 'B'
  6196         GO TO 2060-BROWSE-BACKWARD
  6197     ELSE
  6198         GO TO 2020-BROWSE-FORWARD.
  6199
  6200 2950-NO-MORE-TRAILERS.
  6201     MOVE ER-0303                TO  EMI-ERROR.
  6202     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6203
  6204 2999-EXIT.
  6205     EXIT.
  6206
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL1501.cbl
  6208 3000-RECEIVE-LETTERS.
  6209
  6210     MOVE LINENOI                TO  SUB-1.
  6211
  6212     IF PI-TRLR-TYPE (SUB-1) = '4'
  6213         NEXT SENTENCE
  6214     ELSE
  6215     IF PI-TRLR-TYPE (SUB-1) = '2'
  6216         MOVE ER-0667            TO  EMI-ERROR
  6217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6218         MOVE -1                 TO  LINENOL
  6219         GO TO 8200-SEND-DATAONLY
  6220     ELSE
  6221     IF PI-TRLR-TYPE (SUB-1) = 'A'
  6222         MOVE ER-0665            TO  EMI-ERROR
  6223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6224         MOVE -1                 TO  LINENOL
  6225         GO TO 8200-SEND-DATAONLY
  6226     ELSE
  6227         MOVE ER-0660            TO  EMI-ERROR
  6228         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6229         MOVE -1                 TO  LINENOL
  6230         GO TO 8200-SEND-DATAONLY.
  6231
  6232     IF RECVDTI = SPACES
  6233         MOVE LOW-VALUES                   TO  WS-RECEIVED-DATE
  6234     ELSE
  6235         MOVE RECVDTI                      TO  WS-DEEDIT-FIELD
  6236         PERFORM 9800-DEEDIT THRU 9800-EXIT
  6237         IF WS-DEEDIT-FIELD-V0 NUMERIC
  6238             MOVE '4'                      TO  DC-OPTION-CODE
  6239             MOVE WS-DEEDIT-FIELD-V0       TO  DC-GREG-DATE-1-MDY
  6240             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6241             IF NO-CONVERSION-ERROR
  6242                 MOVE DC-BIN-DATE-1        TO  WS-RECEIVED-DATE
  6243                 MOVE DC-GREG-DATE-1-EDIT  TO  RECVDTO
  6244                 MOVE AL-UANON             TO  RECVDTA
  6245             ELSE
  6246                 MOVE LOW-VALUES           TO  WS-RECEIVED-DATE.
  6247
  6248     MOVE PI-TRLR-SEQ-NO (SUB-1) TO  TRLR-SEQ-NO.
  6249     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  6250
  6251     MOVE WS-RECEIVED-DATE       TO  AT-LETTER-ANSWERED-DT.
  6252     MOVE PI-PROCESSOR-ID        TO  AT-CORR-LAST-UPDATED-BY.
  6253     MOVE SAVE-BIN-DATE          TO  AT-CORR-LAST-MAINT-DT.
  6254
  6255     PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT.
  6256
  6257     PERFORM 7500-READ-CLAIM-MSTR-UPDATE THRU 7500-EXIT.
  6258
  6259*    IF PI-COMPANY-ID = 'DMD'
  6260*        MOVE 11                 TO CL-ACTIVITY-CODE
  6261*        MOVE SAVE-BIN-DATE      TO CL-ACTIVITY-MAINT-DT
  6262*        MOVE 'CORR'             TO CL-ACTIVITY-MAINT-TYPE
  6263*        MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID.
  6264
  6265     PERFORM 7600-REWRITE-CLAIM-MSTR THRU 7600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL1501.cbl
  6266
  6267     MOVE ER-0000                TO  EMI-ERROR.
  6268     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6269     MOVE -1                     TO  LINENOL.
  6270     MOVE AL-UANOF               TO  LINENOA  RECVDTA
  6271                                     RECVTYPA.
  6272     MOVE LOW-VALUES             TO  EL150BO.
  6273     MOVE 'F'                    TO  DIRECTION-SWITCH
  6274                                     PI-PREV-DIRECTION.
  6275     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  6276     MOVE PI-TRLR-SEQ-NO (1)     TO  PI-PREV-SEQ-NO.
  6277     SUBTRACT +1 FROM PI-PREV-SEQ-NO.
  6278     GO TO 1000-SHOW-CLAIM-HISTORY.
  6279
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL1501.cbl
  6281 4000-RECEIVE-FORMS.
  6282
  6283     MOVE LINENOI                TO  SUB-1.
  6284
  6285     IF PI-TRLR-TYPE (SUB-1) = 'A'
  6286         NEXT SENTENCE
  6287     ELSE
  6288     IF PI-TRLR-TYPE (SUB-1) = '4'
  6289         MOVE ER-0666            TO  EMI-ERROR
  6290         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6291         MOVE -1                 TO  LINENOL
  6292         GO TO 8200-SEND-DATAONLY
  6293     ELSE
  6294     IF PI-TRLR-TYPE (SUB-1) = '2'
  6295         MOVE ER-0667            TO  EMI-ERROR
  6296         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6297         MOVE -1                 TO  LINENOL
  6298         GO TO 8200-SEND-DATAONLY
  6299     ELSE
  6300         MOVE ER-0661            TO  EMI-ERROR
  6301         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6302         MOVE -1                 TO  LINENOL
  6303         GO TO 8200-SEND-DATAONLY.
  6304
  6305     IF RECVTYPI = 'I' OR 'P' OR 'E'
  6306         NEXT SENTENCE
  6307     ELSE
  6308         MOVE ER-0662            TO  EMI-ERROR
  6309         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6310         MOVE -1                 TO  RECVTYPL
  6311         GO TO 8200-SEND-DATAONLY.
  6312
  6313     IF RECVDTI = SPACES
  6314         MOVE LOW-VALUES                   TO  WS-RECEIVED-DATE
  6315     ELSE
  6316         MOVE RECVDTI                      TO  WS-DEEDIT-FIELD
  6317         PERFORM 9800-DEEDIT THRU 9800-EXIT
  6318         IF WS-DEEDIT-FIELD-V0 NUMERIC
  6319             MOVE '4'                      TO  DC-OPTION-CODE
  6320             MOVE WS-DEEDIT-FIELD-V0       TO  DC-GREG-DATE-1-MDY
  6321             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6322             IF NO-CONVERSION-ERROR
  6323                 MOVE DC-BIN-DATE-1        TO  WS-RECEIVED-DATE
  6324                 MOVE DC-GREG-DATE-1-EDIT  TO  RECVDTO
  6325                 MOVE AL-UANON             TO  RECVDTA
  6326             ELSE
  6327                 MOVE LOW-VALUES           TO  WS-RECEIVED-DATE.
  6328
  6329     MOVE PI-TRLR-SEQ-NO (SUB-1)     TO  TRLR-SEQ-NO.
  6330     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  6331
  6332     IF RECVTYPI = 'I'
  6333         MOVE WS-RECEIVED-DATE       TO  AT-FORM-ANSWERED-DT
  6334     ELSE
  6335     IF RECVTYPI = 'P'
  6336         MOVE WS-RECEIVED-DATE       TO  AT-PHY-FORM-ANSWERED-DT
  6337     ELSE
  6338         MOVE WS-RECEIVED-DATE       TO  AT-EMP-FORM-ANSWERED-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL1501.cbl
  6339
  6340     MOVE PI-PROCESSOR-ID            TO  AT-FORM-LAST-UPDATED-BY.
  6341     MOVE SAVE-BIN-DATE              TO  AT-FORM-LAST-MAINT-DT.
  6342
  6343     PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT.
  6344
  6345     MOVE ER-0000                TO  EMI-ERROR.
  6346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6347     MOVE -1                     TO  LINENOL.
  6348     MOVE AL-UANOF               TO  LINENOA  RECVDTA
  6349                                     RECVTYPA.
  6350     MOVE LOW-VALUES             TO  EL150BO.
  6351     MOVE 'F'                    TO  DIRECTION-SWITCH
  6352                                     PI-PREV-DIRECTION.
  6353     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  6354     MOVE PI-TRLR-SEQ-NO (1)     TO  PI-PREV-SEQ-NO.
  6355     SUBTRACT +1 FROM PI-PREV-SEQ-NO.
  6356     GO TO 1000-SHOW-CLAIM-HISTORY.
  6357
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL1501.cbl
  6359
  6360 5000-VOID-PAYMENT.
  6361
  6362     MOVE LINENOI                TO  SUB-1.
  6363
  6364     IF PI-TRLR-TYPE (SUB-1) = '2'
  6365         NEXT SENTENCE
  6366     ELSE
  6367     IF PI-TRLR-TYPE (SUB-1) = '4'
  6368         MOVE ER-0666            TO  EMI-ERROR
  6369         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6370         MOVE -1                 TO  LINENOL
  6371         GO TO 8200-SEND-DATAONLY
  6372     ELSE
  6373     IF PI-TRLR-TYPE (SUB-1) = 'A'
  6374         MOVE ER-0665            TO  EMI-ERROR
  6375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6376         MOVE -1                 TO  LINENOL
  6377         GO TO 8200-SEND-DATAONLY
  6378     ELSE
  6379         MOVE ER-0664            TO  EMI-ERROR
  6380         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6381         MOVE -1                 TO  LINENOL
  6382         GO TO 8200-SEND-DATAONLY.
  6383
  6384     PERFORM 7500-READ-CLAIM-MSTR-UPDATE THRU 7500-EXIT.
  6385
  6386     MOVE PI-TRLR-SEQ-NO (SUB-1) TO  TRLR-SEQ-NO.
  6387     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  6388
  6389     IF AT-VOID-DT = LOW-VALUES OR SPACES
  6390         NEXT SENTENCE
  6391     ELSE
  6392         MOVE ER-0800            TO  EMI-ERROR
  6393         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6394         MOVE -1                 TO  LINENOL
  6395         PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6396         PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6397         GO TO 8200-SEND-DATAONLY.
  6398
  6399*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6400*        IF AT-CASH-PAYMENT = 'N'
  6401*            IF AT-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES
  6402*                MOVE ER-0833    TO  EMI-ERROR
  6403*                MOVE -1         TO  LINENOL
  6404*                PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  6405*                PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6406*                PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6407*                GO TO 8200-SEND-DATAONLY.
  6408*
  6409*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6410*      IF AT-CASH-PAYMENT = 'N'
  6411*        IF AT-RECORDED-DT = SAVE-BIN-DATE
  6412*          NEXT SENTENCE
  6413*        ELSE
  6414*          IF PI-PROCESSOR-USER-ALMIGHTY = 'Y'
  6415*            NEXT SENTENCE
  6416*          ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL1501.cbl
  6417*            MOVE ER-0816        TO  EMI-ERROR
  6418*            MOVE -1             TO  LINENOL
  6419*            PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  6420*            PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6421*            PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6422*            GO TO 8200-SEND-DATAONLY.
  6423*
  6424*    IF PI-COMPANY-ID = 'DMD'
  6425*        IF CLAIM-IS-CLOSED
  6426*            IF SETUP-ERRORS
  6427*                MOVE ER-0941    TO EMI-ERROR
  6428*                MOVE -1         TO LINENOL
  6429*                PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  6430*                PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6431*                PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6432*                GO TO 8200-SEND-DATAONLY
  6433*            ELSE
  6434*                IF BENEFITS-CHANGED
  6435*                    IF SYSTEM-MODIFY-CAP
  6436*                        NEXT SENTENCE
  6437*                    ELSE
  6438*                        MOVE ER-0942    TO EMI-ERROR
  6439*                        MOVE -1         TO LINENOL
  6440*                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6441*                        PERFORM 7510-UNLOCK-CLAIM-MSTR
  6442*                                                  THRU 7510-EXIT
  6443*                        PERFORM 7010-UNLOCK-TRLR  THRU 7010-EXIT
  6444*                        GO TO 8200-SEND-DATAONLY.
  6445*
  6446*    IF PI-COMPANY-ID = 'DMD'
  6447*        IF AT-CASH-PAYMENT = 'N'
  6448*            IF SYSTEM-MODIFY-CAP
  6449*                NEXT SENTENCE
  6450*            ELSE
  6451*                IF AT-RECORDED-DT = SAVE-BIN-DATE
  6452*                    NEXT SENTENCE
  6453*                ELSE
  6454*                    MOVE ER-0920  TO EMI-ERROR
  6455*                    MOVE -1       TO LINENOL
  6456*                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6457*                    PERFORM 7510-UNLOCK-CLAIM-MSTR
  6458*                                             THRU 7510-EXIT
  6459*                    PERFORM 7010-UNLOCK-TRLR THRU 7010-EXIT
  6460*                    GO TO 8200-SEND-DATAONLY.
  6461*
  6462*    IF PI-COMPANY-ID = 'DMD'
  6463*       IF AT-PAYMENT-TYPE NOT = '4' AND '5' AND '6'
  6464*          MOVE 'O'              TO  CL-CLAIM-STATUS
  6465*       END-IF
  6466*       PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
  6467
  6468     MOVE AT-CHECK-WRITTEN-DT    TO  WS-CHECK-WRITTEN-DT.
  6469     MOVE AT-PAYMENT-APPROVAL-SW TO  WS-PMT-APPROVAL-SW.
  6470     MOVE AT-AMOUNT-PAID         TO  WS-AMOUNT-PAID.
  6471     MOVE AT-PAYMENT-ORIGIN      TO  WS-PAYMENT-ORIGIN.
  6472     MOVE AT-CV-PMT-CODE         TO  WS-CV-PMT-CODE.
  6473
  6474     IF AT-PAYMENT-TYPE NOT = '5' AND '6' AND 'I'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL1501.cbl
  6475         SUBTRACT AT-AMOUNT-PAID    FROM CL-TOTAL-PAID-AMT
  6476         SUBTRACT AT-DAYS-IN-PERIOD FROM CL-NO-OF-DAYS-PAID
  6477         IF AT-PAYMENT-TYPE NOT = '4'
  6478             SUBTRACT +1 FROM CL-NO-OF-PMTS-MADE
  6479             IF (AT-PAID-THRU-DT NOT = CL-PAID-THRU-DT) OR
  6480                (AT-RECORDED-BY = 'ZZZZ')
  6481                 NEXT SENTENCE
  6482             ELSE
  6483                 MOVE AT-PREV-LAST-PMT-DT    TO  CL-LAST-PMT-DT
  6484                 MOVE AT-PREV-PAID-THRU-DT   TO  CL-PAID-THRU-DT
  6485                 MOVE AT-PREV-LAST-PMT-AMT   TO  CL-LAST-PMT-AMT.
  6486
  6487     IF CL-NO-OF-DAYS-PAID < ZERO
  6488         MOVE +0                 TO  CL-NO-OF-DAYS-PAID.
  6489
  6490     IF CL-NO-OF-PMTS-MADE < ZERO
  6491         MOVE +0                 TO  CL-NO-OF-PMTS-MADE.
  6492
  6493     MOVE SAVE-BIN-DATE          TO  AT-VOID-DT
  6494                                     CL-LAST-REOPEN-DT.
  6495
  6496     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  6497     MOVE '1'                    TO  CNTL-REC-TYPE.
  6498     MOVE SPACES                 TO  CNTL-ACCESS.
  6499     MOVE +0                     TO  CNTL-SEQ-NO.
  6500     MOVE 'CNTL'                 TO  FILE-SWITCH.
  6501
  6502     PERFORM 7900-READ-CONTROL-FILE THRU 7900-EXIT.
  6503
  6504     MOVE CF-PAYMENT-APPROVAL-SW TO  WS-CF-PMT-APPROVAL-SW.
  6505
  6506     IF CF-PMT-APPROVAL-USED
  6507         MOVE 'V'                TO  AT-PAYMENT-APPROVAL-SW.
  6508
  6509*    IF PI-COMPANY-ID = 'CID'
  6510         PERFORM 9870-OUTPUT-ACTIVITY-RECORD THRU
  6511                 9870-EXIT.
  6512         IF ERROR-ON-OUTPUT
  6513             MOVE -1             TO ENTERPFL
  6514             MOVE AL-UANON       TO ENTERPFA
  6515             PERFORM 9900-ERROR-FORMAT THRU
  6516                     9900-EXIT
  6517             GO TO 8200-SEND-DATAONLY
  6518         END-IF.
  6519*    END-IF.
  6520
  6521******************************************************************
  6522**  1.  BYPASS READING THE RECON RECORD FOR THE FOLLOWING       **
  6523**      REASONS:                                                **
  6524**      A.  NON-CASH PAYMENT                                    **
  6525**      B.  CHECK HAS NOT BEEN PRINTED                          **
  6526**      C.  USER IS NOT A RECON USER                            **
  6527**      D.  PAYMENT IS A MANUAL (OFFLINE) PAYMENT               **
  6528******************************************************************
  6529
  6530     IF AT-CASH-PAYMENT = 'N'
  6531         GO TO 5005-CONT-VOID.
  6532
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL1501.cbl
  6533     IF AT-CHECK-NO  = SPACES OR LOW-VALUES
  6534         GO TO 5005-CONT-VOID.
  6535
  6536     IF CF-CLAIMS-CHECK-RECON-USER NOT = 'Y'
  6537         GO TO 5005-CONT-VOID.
  6538
  6539     IF OFFLINE-PMT
  6540         GO TO 5005-CONT-VOID.
  6541
  6542******************************************************************
  6543**  1.  RECON SW VALUES = :                                     **
  6544**      A.  R = CHECK HAS BEEN REDEEMED - CANNOT BE VOIDED      **
  6545**      B.  X = RECON RECORD NOT FOUND                          **
  6546******************************************************************
  6547
  6548     MOVE 'RCON'                     TO  FILE-SWITCH.
  6549     PERFORM 5700-UPDATE-RECON THRU 5700-EXIT.
  6550     IF WS-RECON-SW = 'R'
  6551          PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6552          PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6553          GO TO 8200-SEND-DATAONLY.
  6554
  6555*    IF WS-RECON-SW = 'X'
  6556*        IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CIG' OR 'CUK'
  6557*            PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6558*            PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6559*            GO TO 8200-SEND-DATAONLY.
  6560
  6561 5005-CONT-VOID.
  6562     IF AT-RECORDED-BY = 'ZZZZ'
  6563         GO TO 5010-BYPASS.
  6564
  6565     MOVE '7'                    TO  PI-PAY-TYPE.
  6566     MOVE AT-PAYMENT-TYPE        TO  WS-PAY-TYPE.
  6567
  6568*    IF PI-COMPANY-ID = 'DMD'
  6569*        MOVE 88888888           TO WS-CK-Q-CONTROL
  6570*     ELSE
  6571         MOVE 99999999           TO WS-CK-Q-CONTROL.
  6572
  6573     IF AT-CHECK-QUE-CONTROL > ZEROS AND < WS-CK-Q-CONTROL
  6574         PERFORM 5200-UPDATE-CHECK-QUE THRU 5299-EXIT
  6575     ELSE
  6576         IF AT-CHECK-WRITTEN-DT NOT = LOW-VALUES AND SPACES
  6577             MOVE 'Y'                TO  WS-PRINTED-SW
  6578                                         WS-RELEASED-SW
  6579         ELSE
  6580             MOVE 'N'                TO  WS-PRINTED-SW
  6581                                         WS-RELEASED-SW.
  6582
  6583 5010-BYPASS.
  6584
  6585     IF PAYMENT-HAS-BEEN-PRINTED OR
  6586        OFFLINE-PMT
  6587         MOVE CF-CURRENT-MONTH-END   TO  AT-VOID-SELECT-DT
  6588     ELSE
  6589         MOVE LOW-VALUES             TO  AT-PMT-SELECT-DT
  6590                                         AT-VOID-SELECT-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL1501.cbl
  6591
  6592     MOVE WS-VOID-CODE           TO  AT-VOID-TYPE.
  6593
  6594     MOVE PI-PROCESSOR-ID        TO  AT-PAYMENT-LAST-UPDATED-BY.
  6595     MOVE SAVE-BIN-DATE          TO  AT-PAYMENT-LAST-MAINT-DT.
  6596
  6597     PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT.
  6598     IF WS-PAY-TYPE NOT = 'I'
  6599        PERFORM 5400-UPDATE-ZERO-TRAILER
  6600                                 THRU 5400-EXIT
  6601     END-IF
  6602*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  6603*        PERFORM 5500-UPDATE-POLICY-MASTER THRU 5500-EXIT
  6604*    ELSE
  6605         PERFORM 5600-UPDATE-CERT THRU 5600-EXIT.
  6606
  6607     MOVE CL-CONTROL-PRIMARY     TO  ELACTQ-KEY.
  6608
  6609     IF WS-PAY-TYPE = '4' OR '5' OR '6' OR 'I'
  6610         GO TO 5020-CONTINUE-VOID.
  6611
  6612*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  6613*        IF CL-NO-OF-PMTS-MADE > +0
  6614*            GO TO 5020-CONTINUE-VOID.
  6615
  6616     MOVE 'O'                    TO  CL-CLAIM-STATUS.
  6617
  6618 5020-CONTINUE-VOID.
  6619
  6620     PERFORM 7600-REWRITE-CLAIM-MSTR THRU 7600-EXIT.
  6621
  6622     IF WS-PAYMENT-ORIGIN = '3'
  6623         GO TO 5100-CONTINUE.
  6624
  6625     IF PAYMENT-HAS-BEEN-PRINTED AND
  6626        NOT WS-CF-PMT-APPROVAL-USED
  6627         GO TO 5100-CONTINUE.
  6628
  6629     MOVE 'ACTQ'                 TO  FILE-SWITCH.
  6630     PERFORM 7700-READ-ELACTQ THRU 7799-EXIT.
  6631
  6632 5100-CONTINUE.
  6633
  6634     MOVE ER-0000                TO  EMI-ERROR.
  6635     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6636     MOVE -1                     TO  LINENOL.
  6637     MOVE AL-UANOF               TO  LINENOA  RECVDTA
  6638                                     RECVTYPA.
  6639     MOVE LOW-VALUES             TO  EL150BO.
  6640     MOVE 'F'                    TO  DIRECTION-SWITCH
  6641                                     PI-PREV-DIRECTION.
  6642     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  6643     MOVE PI-TRLR-SEQ-NO (1)     TO  PI-PREV-SEQ-NO.
  6644     SUBTRACT +1 FROM PI-PREV-SEQ-NO.
  6645     GO TO 1000-SHOW-CLAIM-HISTORY.
  6646
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL1501.cbl
  6648 5200-UPDATE-CHECK-QUE.
  6649
  6650     MOVE PI-COMPANY-CD          TO  CHKQ-COMP-CD.
  6651     MOVE AT-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL.
  6652     MOVE AT-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQ-NO.
  6653
  6654
  6655* EXEC CICS HANDLE CONDITION
  6656*        NOTFND   (5290-NOTFND)
  6657*    END-EXEC.
  6658*    MOVE '"$I                   ! '' #00006458' TO DFHEIV0
  6659     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6660     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6661     MOVE X'2720233030303036343538' TO DFHEIV0(25:11)
  6662     CALL 'kxdfhei1' USING DFHEIV0
  6663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6664
  6665
  6666
  6667* EXEC CICS READ
  6668*        DATASET   ('ELCHKQ')
  6669*        RIDFLD    (ELCHKQ-KEY)
  6670*        SET       (ADDRESS OF CHECK-QUE)
  6671*        UPDATE
  6672*    END-EXEC.
  6673     MOVE 'ELCHKQ' TO DFHEIV1
  6674*    MOVE '&"S        EU         (   #00006462' TO DFHEIV0
  6675     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6676     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6677     MOVE X'2020233030303036343632' TO DFHEIV0(25:11)
  6678     CALL 'kxdfhei1' USING DFHEIV0,
  6679           DFHEIV1,
  6680           DFHEIV20,
  6681           DFHEIV99,
  6682           ELCHKQ-KEY,
  6683           DFHEIV99,
  6684           DFHEIV99,
  6685           DFHEIV99
  6686     SET ADDRESS OF CHECK-QUE TO
  6687         DFHEIV20
  6688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6689
  6690
  6691     MOVE 'Y'                    TO  WS-RELEASED-SW
  6692
  6693     IF CQ-TIMES-PRINTED = +0
  6694         MOVE 'N'                TO  WS-PRINTED-SW
  6695         GO TO 5210-DELETE-CHECK-QUE
  6696     ELSE
  6697         MOVE 'Y'                TO  WS-PRINTED-SW.
  6698
  6699     MOVE WS-VOID-CODE           TO  CQ-VOID-INDICATOR.
  6700
  6701
  6702* EXEC CICS REWRITE
  6703*        DATASET   ('ELCHKQ')
  6704*        FROM      (CHECK-QUE)
  6705*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL1501.cbl
  6706     MOVE LENGTH OF
  6707      CHECK-QUE
  6708       TO DFHEIV11
  6709     MOVE 'ELCHKQ' TO DFHEIV1
  6710*    MOVE '&& L                  %   #00006479' TO DFHEIV0
  6711     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6712     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6713     MOVE X'2020233030303036343739' TO DFHEIV0(25:11)
  6714     CALL 'kxdfhei1' USING DFHEIV0,
  6715           DFHEIV1,
  6716           CHECK-QUE,
  6717           DFHEIV11,
  6718           DFHEIV99
  6719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6720
  6721
  6722     GO TO 5299-EXIT.
  6723
  6724 5210-DELETE-CHECK-QUE.
  6725
  6726
  6727* EXEC CICS DELETE
  6728*        DATASET  ('ELCHKQ')
  6729*    END-EXEC.
  6730     MOVE 'ELCHKQ' TO DFHEIV1
  6731*    MOVE '&(                    &   #00006488' TO DFHEIV0
  6732     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6733     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6734     MOVE X'2020233030303036343838' TO DFHEIV0(25:11)
  6735     CALL 'kxdfhei1' USING DFHEIV0,
  6736           DFHEIV1,
  6737           DFHEIV99,
  6738           DFHEIV99,
  6739           DFHEIV99,
  6740           DFHEIV99
  6741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6742
  6743
  6744     MOVE +0                     TO  AT-CHECK-QUE-CONTROL
  6745                                     AT-CHECK-QUE-SEQUENCE.
  6746
  6747     GO TO 5299-EXIT.
  6748
  6749 5290-NOTFND.
  6750     MOVE 'N'                    TO  WS-PRINTED-SW
  6751                                     WS-RELEASED-SW.
  6752 5299-EXIT.
  6753     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL1501.cbl
  6755*5300-CREATE-DMO. Remove as dead code
  6756*5300-CONT. Remove as dead code
  6757*5300-NOTE-NOT-FOUND. Remove as dead code
  6758*5300-EXIT. Remove as dead code
  6759*5350-FORMAT-LAST-NAME-1ST. Remove as dead code
  6760*5350-EXIT. Remove as dead code
  6761*5360-MOVE-NAME. Remove as dead code
  6762*5360-MOVE-NAME-CYCLE. Remove as dead code
  6763*5360-EXIT. Remove as dead code
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL1501.cbl
  6765 5400-UPDATE-ZERO-TRAILER.
  6766
  6767     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
  6768
  6769     MOVE ZEROS                  TO  TRLR-SEQ-NO.
  6770     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  6771
  6772     IF WS-PAY-TYPE = '5'
  6773         SUBTRACT WS-AMOUNT-PAID FROM AT-ITD-CHARGEABLE-EXPENSE.
  6774
  6775     IF WS-PAY-TYPE = '6'
  6776         SUBTRACT WS-AMOUNT-PAID FROM AT-ITD-PAID-EXPENSES.
  6777
  6778     IF AT-INITIAL-MANUAL-RESERVE NOT = ZEROS
  6779         ADD WS-AMOUNT-PAID      TO  AT-CURRENT-MANUAL-RESERVE.
  6780
  6781 5410-CHECK-OPEN-CLOSE.
  6782
  6783     IF PI-PAY-TYPE = '5' OR '6'
  6784         PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT.
  6785
  6786     IF PI-PAY-TYPE = '1' OR '4' OR '7'
  6787        IF CLAIM-IS-OPEN
  6788           PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT
  6789           GO TO 5400-EXIT.
  6790
  6791     IF PI-PAY-TYPE = '2' OR '3'
  6792        IF CLAIM-IS-CLOSED
  6793            PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT
  6794            GO TO 5400-EXIT.
  6795
  6796     MOVE 1                      TO  SUB.
  6797
  6798 5420-LOOP.
  6799
  6800     IF AT-OPEN-CLOSE-TYPE (SUB) = SPACES
  6801         MOVE SAVE-BIN-DATE      TO  AT-OPEN-CLOSE-DATE (SUB)
  6802         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB)
  6803         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB)
  6804         PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT
  6805         GO TO 5400-EXIT.
  6806
  6807     IF SUB = 6
  6808      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
  6809      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
  6810      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
  6811      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
  6812      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
  6813      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
  6814      GO TO 5420-LOOP.
  6815
  6816     ADD 1                       TO  SUB.
  6817     GO TO 5420-LOOP.
  6818
  6819 5400-EXIT.
  6820     EXIT.
  6821
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL1501.cbl
  6823*5500-UPDATE-POLICY-MASTER.
  6824*
  6825*    MOVE PI-COMPANY-CD          TO  PLCY-COMPANY-CD.
  6826*    MOVE CL-CERT-CARRIER        TO  PLCY-CARRIER.
  6827*    MOVE CL-CERT-GROUPING       TO  PLCY-GROUPING.
  6828*    MOVE CL-CERT-STATE          TO  PLCY-STATE.
  6829*    MOVE CL-CERT-ACCOUNT        TO  PLCY-PRODUCER.
  6830*    MOVE CL-CERT-EFF-DT         TO  PLCY-EFF-DT.
  6831*    MOVE CL-CV-REFERENCE-NO     TO  PLCY-REFERENCE-NO.
  6832*
  6833*    EXEC CICS READ
  6834*        DATASET   ('MPPLCY')
  6835*        RIDFLD    (EMPLCY-KEY)
  6836*        SET       (ADDRESS OF POLICY-MASTER)
  6837*    END-EXEC.
  6838*
  6839*    MOVE LOW-VALUES             TO WS-POLICY-UPDATE-WORKING-GRPS.
  6840*    MOVE +0                     TO  WS-CLAIM-PAYMENT-CNT.
  6841*
  6842*    MOVE PM-COMPANY-CD          TO  WS-COMPANY-CD.
  6843*    MOVE PM-CARRIER             TO  WS-CARRIER.
  6844*    MOVE PM-GROUPING            TO  WS-GROUPING.
  6845*    MOVE PM-STATE               TO  WS-STATE.
  6846*    MOVE PM-PRODUCER            TO  WS-PRODUCER.
  6847*    MOVE PM-POLICY-EFF-DT       TO  WS-POLICY-EFF-DT.
  6848*    MOVE PM-REFERENCE-NUMBER    TO  WS-REFERENCE-NUMBER.
  6849*
  6850*    MOVE 'RW'                   TO  WS-EMPLCY-FUNCTION.
  6851*    MOVE PI-PROCESSOR-ID        TO  WS-LAST-CHANGE-PROCESSOR.
  6852*    MOVE SAVE-BIN-DATE          TO  WS-LAST-CHANGE-DT.
  6853*    MOVE EIBTIME                TO  WS-LAST-CHANGE-TIME.
  6854*
  6855*    IF CL-CLAIM-TYPE = 'A'
  6856*        GO TO 5500-UPDATE-AH-POLICY-DATA.
  6857*
  6858*5500-UPDATE-LF-POLICY-DATA.
  6859*
  6860*    IF WS-PAY-TYPE = '2'
  6861*** FROM AT-PAYMENT-TYPE - TYPES 1-6 IN CONVENIENCE VALUES
  6862*      IF WS-CV-PMT-CODE = '1' OR '2' OR '3' OR '4'
  6863*** LIFE / HALF LIFE / ADD / HALF ADD - CONV VALUES
  6864*        COMPUTE WS-CLAIM-PAYMENTS-ITD = PM-CLAIM-PAYMENTS-ITD -
  6865*                                        WS-AMOUNT-PAID
  6866*        COMPUTE WS-CLAIM-LIFE-ITD = PM-CLAIM-LIFE-ITD -
  6867*                                    WS-AMOUNT-PAID
  6868*        COMPUTE WS-CLAIM-PAYMENT-CNT = PM-CLAIM-PAYMENT-CNT - 1.
  6869*
  6870*    IF WS-PAY-TYPE = '2'
  6871*      IF WS-CV-PMT-CODE = '5' OR '6'
  6872*** RIDER AND HALF RIDER - CONV VALUES
  6873*        COMPUTE WS-CLAIM-RIDER-ITD = PM-CLAIM-RIDER-ITD -
  6874*                                        WS-AMOUNT-PAID.
  6875*
  6876*    IF WS-PAY-TYPE = '4'
  6877*** ADDITIONAL PAYMENT - TYPE 8 CONV VALUES
  6878*        COMPUTE WS-CLAIM-PAYMENTS-ITD = PM-CLAIM-PAYMENTS-ITD -
  6879*                                        WS-AMOUNT-PAID
  6880*        COMPUTE WS-CLAIM-LIFE-ITD = PM-CLAIM-LIFE-ITD -
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL1501.cbl
  6881*                                    WS-AMOUNT-PAID
  6882*        COMPUTE WS-CLAIM-PAYMENT-CNT = PM-CLAIM-PAYMENT-CNT - 1.
  6883*
  6884*    IF WS-PAY-TYPE = '6'
  6885*** NON CHARGEABLE EXPENSE - TYPE 7 IN CONVENIENCE
  6886*        COMPUTE WS-CLAIM-EXPENSES-ITD = PM-CLAIM-EXPENSES-ITD -
  6887*                                        WS-AMOUNT-PAID.
  6888*
  6889*    IF PM-CLAIM-SETTLEMENT
  6890*        IF WS-CV-PMT-CODE = '1' OR '2' OR '3' OR '4'
  6891*            MOVE '6'             TO WS-CURRENT-STATUS
  6892*            IF PM-EXIT-DT > LOW-VALUES
  6893*                MOVE HIGH-VALUES TO WS-EXIT-DT.
  6894*
  6895*    GO TO 5500-UPDATE-CLAIM-HISTORY.
  6896*
  6897*5500-UPDATE-AH-POLICY-DATA.
  6898*
  6899*    IF WS-PAY-TYPE = '1' OR '4'
  6900*        COMPUTE WS-CLAIM-PAYMENTS-ITD = PM-CLAIM-PAYMENTS-ITD -
  6901*                                        WS-AMOUNT-PAID
  6902*        COMPUTE WS-CLAIM-AH-ITD = PM-CLAIM-AH-ITD -
  6903*                                  WS-AMOUNT-PAID
  6904*        COMPUTE WS-CLAIM-PAYMENT-CNT = PM-CLAIM-PAYMENT-CNT - 1.
  6905*
  6906*    IF WS-PAY-TYPE = '6'
  6907*        COMPUTE WS-CLAIM-EXPENSES-ITD = PM-CLAIM-EXPENSES-ITD -
  6908*                                        WS-AMOUNT-PAID.
  6909*
  6910*    IF PM-CLAIM-SETTLEMENT
  6911*        IF WS-CV-PMT-CODE = '2'
  6912*            MOVE '6'             TO WS-CURRENT-STATUS
  6913*            IF PM-EXIT-DT > LOW-VALUES
  6914*                MOVE HIGH-VALUES TO WS-EXIT-DT
  6915*            END-IF
  6916*        ELSE
  6917*            IF WS-CV-PMT-CODE = '1'
  6918*                    AND
  6919*               WS-CLAIM-PAYMENTS-ITD < PM-INS-TOTAL-BENEFIT
  6920*                MOVE '6'             TO WS-CURRENT-STATUS
  6921*                IF PM-EXIT-DT > LOW-VALUES
  6922*                    MOVE HIGH-VALUES TO WS-EXIT-DT.
  6923*
  6924*5500-UPDATE-CLAIM-HISTORY.
  6925*
  6926*    IF PM-CLAIM-ATTACH-CNT = +1 OR
  6927*       PM-CLAIM-INCURRED-DT = CL-INCURRED-DT
  6928*        NEXT SENTENCE
  6929*    ELSE
  6930*        GO TO 5500-FINISH-POLICY-UPDATE.
  6931*
  6932*    IF (PM-CLAIM-ATTACH-CNT = +1  AND
  6933*        CL-NO-OF-PMTS-MADE = +0)
  6934*               OR
  6935*       (PM-CLAIM-PAYMENT-CNT = +0)
  6936*           MOVE +0              TO  WS-CLAIM-LAST-PAYMENT-AMT
  6937*           MOVE '1'             TO  WS-CLAIM-INTERFACE-SW
  6938*           MOVE HIGH-VALUES     TO  WS-CLAIM-INCURRED-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL1501.cbl
  6939*                                    WS-CLAIM-PAID-TO-DT
  6940*       ELSE
  6941*           MOVE CL-PAID-THRU-DT TO  WS-CLAIM-PAID-TO-DT
  6942*           MOVE CL-LAST-PMT-AMT TO  WS-CLAIM-LAST-PAYMENT-AMT.
  6943*
  6944*5500-FINISH-POLICY-UPDATE.
  6945*
  6946*    IF WS-CLAIM-PAYMENT-CNT NEGATIVE
  6947*        MOVE +0                 TO  WS-CLAIM-PAYMENT-CNT.
  6948*
  6949*    EXEC CICS LINK
  6950*        PROGRAM     ('EMPLCY')
  6951*        COMMAREA    (WS-POLICY-MASTER-UPDATE-AREA)
  6952*        LENGTH      (WS-PM-COMM-LNGTH)
  6953*    END-EXEC.
  6954*
  6955*    IF WS-EMPLCY-RETURN-CODE = LOW-VALUES
  6956*        NEXT SENTENCE
  6957*    ELSE
  6958*        MOVE ER-9211            TO  EMI-ERROR
  6959*        MOVE -1                 TO  LINENOL
  6960*        MOVE AL-UABON           TO  LINENOA
  6961*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6962*        EXEC CICS SYNCPOINT
  6963*            ROLLBACK
  6964*        END-EXEC
  6965*        GO TO 8200-SEND-DATAONLY.
  6966*
  6967*5500-EXIT.
  6968*    EXIT.
  6969
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL1501.cbl
  6971 5600-UPDATE-CERT.
  6972
  6973     MOVE PI-COMPANY-CD          TO  CERT-COMP-CD.
  6974     MOVE CL-CERT-CARRIER        TO  CERT-CARRIER.
  6975     MOVE CL-CERT-GROUPING       TO  CERT-GROUPING.
  6976     MOVE CL-CERT-STATE          TO  CERT-STATE.
  6977     MOVE CL-CERT-ACCOUNT        TO  CERT-ACCOUNT.
  6978     MOVE CL-CERT-EFF-DT         TO  CERT-EFF-DT.
  6979     MOVE CL-CERT-NO             TO  CERT-CERT-NO.
  6980     MOVE 'CERT'                 TO  FILE-SWITCH.
  6981
  6982     PERFORM 7800-READ-CERT-UPDATE.
  6983
  6984     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
  6985         GO TO 5610-AH-VOID.
  6986
  6987     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6988     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  6989     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  6990     MOVE '4'                    TO  CNTL-REC-TYPE.
  6991     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  6992     MOVE 'BENE'                 TO  FILE-SWITCH.
  6993     MOVE +0                     TO  SUB.
  6994     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  6995
  6996     IF NO-BENEFIT-FOUND
  6997         GO TO 8400-NOT-FOUND.
  6998
  6999     MOVE CF-LF-COVERAGE-TYPE (SUB)  TO  WS-LF-COVERAGE-TYPE.
  7000
  7001     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  7002        WS-LF-COVERAGE-TYPE = 'P'
  7003         IF WS-PAY-TYPE = '4'
  7004             SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7005             IF CM-LF-CURRENT-STATUS = '1' OR '2'
  7006                 PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7007                 GO TO 5600-EXIT
  7008             ELSE
  7009                 MOVE CM-LF-STATUS-AT-DEATH  TO
  7010                                             CM-LF-CURRENT-STATUS
  7011                 MOVE SPACES                 TO
  7012                                             CM-LF-STATUS-AT-DEATH
  7013                 MOVE LOW-VALUES             TO
  7014                                             CM-LF-DEATH-EXIT-DT
  7015                                             CM-LF-DEATH-DT
  7016                 PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7017                 GO TO 5600-EXIT.
  7018
  7019     IF WS-PAY-TYPE = '4'
  7020         SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7021         PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7022         GO TO 5600-EXIT.
  7023
  7024     IF WS-PAY-TYPE = '2'
  7025         IF CM-LF-CURRENT-STATUS = '1' OR '2'
  7026             SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7027             PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7028             GO TO 5600-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL1501.cbl
  7029         ELSE
  7030             MOVE CM-LF-STATUS-AT-DEATH TO  CM-LF-CURRENT-STATUS
  7031             MOVE SPACES                TO  CM-LF-STATUS-AT-DEATH
  7032             SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7033             MOVE LOW-VALUES            TO  CM-LF-DEATH-EXIT-DT
  7034                                            CM-LF-DEATH-DT
  7035             PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7036             GO TO 5600-EXIT
  7037     ELSE
  7038         GO TO 5620-UNLOCK-CERT.
  7039
  7040 5610-AH-VOID.
  7041
  7042     IF WS-PAY-TYPE = '4'
  7043         SUBTRACT WS-AMOUNT-PAID FROM CM-AH-ITD-LUMP-PMT
  7044         PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7045         GO TO 5600-EXIT.
  7046
  7047     IF WS-PAY-TYPE = '3'
  7048         MOVE CM-AH-STATUS-AT-SETTLEMENT
  7049                                 TO  CM-AH-CURRENT-STATUS
  7050         MOVE SPACES             TO  CM-AH-STATUS-AT-SETTLEMENT
  7051         SUBTRACT WS-AMOUNT-PAID FROM CM-AH-ITD-LUMP-PMT
  7052         MOVE LOW-VALUES         TO  CM-AH-SETTLEMENT-EXIT-DT
  7053                                     CM-AH-SETTLEMENT-DT
  7054         PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7055         GO TO 5600-EXIT
  7056     ELSE
  7057         GO TO 5620-UNLOCK-CERT.
  7058
  7059 5620-UNLOCK-CERT.
  7060
  7061
  7062* EXEC CICS UNLOCK
  7063*        DATASET   ('ELCERT')
  7064*    END-EXEC.
  7065     MOVE 'ELCERT' TO DFHEIV1
  7066*    MOVE '&*                    #   #00006809' TO DFHEIV0
  7067     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7068     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7069     MOVE X'2020233030303036383039' TO DFHEIV0(25:11)
  7070     CALL 'kxdfhei1' USING DFHEIV0,
  7071           DFHEIV1,
  7072           DFHEIV99
  7073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7074
  7075
  7076 5600-EXIT.
  7077     EXIT.
  7078
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL1501.cbl
  7080 5700-UPDATE-RECON.
  7081
  7082
  7083* EXEC CICS HANDLE CONDITION
  7084*        NOTFND   (5700-NOT-FOUND)
  7085*        NOTOPEN  (8500-FILE-NOTOPEN)
  7086*    END-EXEC.
  7087*    MOVE '"$IJ                  ! ( #00006819' TO DFHEIV0
  7088     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  7089     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7090     MOVE X'2820233030303036383139' TO DFHEIV0(25:11)
  7091     CALL 'kxdfhei1' USING DFHEIV0
  7092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7093
  7094
  7095     MOVE PI-COMPANY-CD              TO  RCON-COMPANY-CD.
  7096     MOVE AT-CHECK-NO                TO  RCON-CHECK-NO.
  7097     MOVE 'C'                        TO  RCON-CHECK-ORIGIN.
  7098     MOVE SPACES                     TO  RCON-GL-ACCOUNT-NO.
  7099
  7100
  7101* EXEC CICS READ
  7102*        DATASET   ('ELRCON')
  7103*        RIDFLD    (ELRCON-KEY)
  7104*        SET       (ADDRESS OF CHECK-RECONCILIATION)
  7105*        UPDATE
  7106*    END-EXEC.
  7107     MOVE 'ELRCON' TO DFHEIV1
  7108*    MOVE '&"S        EU         (   #00006829' TO DFHEIV0
  7109     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7110     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7111     MOVE X'2020233030303036383239' TO DFHEIV0(25:11)
  7112     CALL 'kxdfhei1' USING DFHEIV0,
  7113           DFHEIV1,
  7114           DFHEIV20,
  7115           DFHEIV99,
  7116           ELRCON-KEY,
  7117           DFHEIV99,
  7118           DFHEIV99,
  7119           DFHEIV99
  7120     SET ADDRESS OF CHECK-RECONCILIATION TO
  7121         DFHEIV20
  7122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7123
  7124
  7125******************************************************************
  7126*           IF THE CHECK HAS BEEN REDEEMED - DO NOT VOID         *
  7127******************************************************************
  7128
  7129     IF RC-STATUS = 'R'
  7130         MOVE 'R'                    TO  WS-RECON-SW
  7131         MOVE ER-0823                TO  EMI-ERROR
  7132         MOVE -1                     TO  LINENOL
  7133         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7134
  7135* EXEC CICS UNLOCK
  7136*            DATASET   ('ELRCON')
  7137*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL1501.cbl
  7138     MOVE 'ELRCON' TO DFHEIV1
  7139*    MOVE '&*                    #   #00006845' TO DFHEIV0
  7140     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7141     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7142     MOVE X'2020233030303036383435' TO DFHEIV0(25:11)
  7143     CALL 'kxdfhei1' USING DFHEIV0,
  7144           DFHEIV1,
  7145           DFHEIV99
  7146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7147         GO TO 5700-EXIT
  7148     ELSE
  7149         MOVE ' '                    TO  WS-RECON-SW.
  7150
  7151     MOVE WS-VOID-CODE               TO  RC-STATUS.
  7152
  7153     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7154     MOVE '5'                        TO  DC-OPTION-CODE.
  7155     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7156     MOVE DC-GREG-DATE-1-MDY         TO  WS-WORK-DATE.
  7157     IF WS-WORK-YY > 50
  7158         MOVE '19'                   TO  WS-RCON-YY-1
  7159         MOVE WS-WORK-YY             TO  WS-RCON-YY-2
  7160         MOVE WS-WORK-MM             TO  WS-RCON-MM
  7161         MOVE WS-WORK-DD             TO  WS-RCON-DD
  7162     ELSE
  7163         MOVE '20'                   TO  WS-RCON-YY-1
  7164         MOVE WS-WORK-YY             TO  WS-RCON-YY-2
  7165         MOVE WS-WORK-MM             TO  WS-RCON-MM
  7166         MOVE WS-WORK-DD             TO  WS-RCON-DD.
  7167
  7168     MOVE WS-RCON-DATE               TO  RC-STATUS-DATE.
  7169
  7170     MOVE PI-PROCESSOR-ID            TO  RC-LAST-MAINT-BY.
  7171     MOVE SAVE-BIN-DATE              TO  RC-LAST-MAINT-DT.
  7172     MOVE EIBTIME                    TO  RC-LAST-MAINT-HHMMSS.
  7173
  7174
  7175* EXEC CICS REWRITE
  7176*        DATASET   ('ELRCON')
  7177*        FROM      (CHECK-RECONCILIATION)
  7178*    END-EXEC.
  7179     MOVE LENGTH OF
  7180      CHECK-RECONCILIATION
  7181       TO DFHEIV11
  7182     MOVE 'ELRCON' TO DFHEIV1
  7183*    MOVE '&& L                  %   #00006875' TO DFHEIV0
  7184     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7185     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7186     MOVE X'2020233030303036383735' TO DFHEIV0(25:11)
  7187     CALL 'kxdfhei1' USING DFHEIV0,
  7188           DFHEIV1,
  7189           CHECK-RECONCILIATION,
  7190           DFHEIV11,
  7191           DFHEIV99
  7192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7193
  7194
  7195     GO TO 5700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL1501.cbl
  7196
  7197 5700-NOT-FOUND.
  7198
  7199     MOVE 'X'                        TO  WS-RECON-SW.
  7200     MOVE -1                         TO  LINENOL.
  7201     MOVE ER-0801                    TO  EMI-ERROR.
  7202     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7203
  7204 5700-EXIT.
  7205     EXIT.
  7206
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL1501.cbl
  7208 7000-READ-TRLR-UPDATE.
  7209
  7210     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
  7211     MOVE PI-CARRIER             TO  TRLR-CARRIER.
  7212     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
  7213     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
  7214
  7215
  7216* EXEC CICS READ
  7217*        DATASET   ('ELTRLR')
  7218*        RIDFLD    (ELTRLR-KEY)
  7219*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  7220*        UPDATE
  7221*    END-EXEC.
  7222     MOVE 'ELTRLR' TO DFHEIV1
  7223*    MOVE '&"S        EU         (   #00006900' TO DFHEIV0
  7224     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7225     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7226     MOVE X'2020233030303036393030' TO DFHEIV0(25:11)
  7227     CALL 'kxdfhei1' USING DFHEIV0,
  7228           DFHEIV1,
  7229           DFHEIV20,
  7230           DFHEIV99,
  7231           ELTRLR-KEY,
  7232           DFHEIV99,
  7233           DFHEIV99,
  7234           DFHEIV99
  7235     SET ADDRESS OF ACTIVITY-TRAILERS TO
  7236         DFHEIV20
  7237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7238
  7239
  7240 7000-EXIT.
  7241     EXIT.
  7242
  7243 7010-UNLOCK-TRLR.
  7244
  7245
  7246* EXEC CICS UNLOCK
  7247*        DATASET   ('ELTRLR')
  7248*    END-EXEC.
  7249     MOVE 'ELTRLR' TO DFHEIV1
  7250*    MOVE '&*                    #   #00006912' TO DFHEIV0
  7251     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7252     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7253     MOVE X'2020233030303036393132' TO DFHEIV0(25:11)
  7254     CALL 'kxdfhei1' USING DFHEIV0,
  7255           DFHEIV1,
  7256           DFHEIV99
  7257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7258
  7259
  7260 7010-EXIT.
  7261     EXIT.
  7262
  7263 7100-REWRITE-TRLR.
  7264
  7265     MOVE PI-PROCESSOR-ID        TO  PI-UPDATE-BY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL1501.cbl
  7266     MOVE EIBTIME                TO  AT-LAST-MAINT-HHMMSS
  7267                                     PI-UPDATE-HHMMSS.
  7268
  7269
  7270* EXEC CICS REWRITE
  7271*        DATASET   ('ELTRLR')
  7272*        FROM      (ACTIVITY-TRAILERS)
  7273*    END-EXEC.
  7274     MOVE LENGTH OF
  7275      ACTIVITY-TRAILERS
  7276       TO DFHEIV11
  7277     MOVE 'ELTRLR' TO DFHEIV1
  7278*    MOVE '&& L                  %   #00006925' TO DFHEIV0
  7279     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7280     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7281     MOVE X'2020233030303036393235' TO DFHEIV0(25:11)
  7282     CALL 'kxdfhei1' USING DFHEIV0,
  7283           DFHEIV1,
  7284           ACTIVITY-TRAILERS,
  7285           DFHEIV11,
  7286           DFHEIV99
  7287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7288
  7289
  7290 7100-EXIT.
  7291     EXIT.
  7292
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL1501.cbl
  7294 7200-FIND-BENEFIT.
  7295
  7296     MOVE 'N'                    TO  WS-BEN-SEARCH-SW.
  7297
  7298
  7299* EXEC CICS HANDLE CONDITION
  7300*        ENDFILE   (7200-EXIT)
  7301*        NOTFND    (7200-EXIT)
  7302*    END-EXEC.
  7303*    MOVE '"$''I                  ! ) #00006938' TO DFHEIV0
  7304     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7306     MOVE X'2920233030303036393338' TO DFHEIV0(25:11)
  7307     CALL 'kxdfhei1' USING DFHEIV0
  7308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7309
  7310
  7311
  7312* EXEC CICS READ
  7313*        DATASET   ('ELCNTL')
  7314*        RIDFLD    (ELCNTL-KEY)
  7315*        SET       (ADDRESS OF CONTROL-FILE)
  7316*        GTEQ
  7317*    END-EXEC.
  7318     MOVE 'ELCNTL' TO DFHEIV1
  7319*    MOVE '&"S        G          (   #00006943' TO DFHEIV0
  7320     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7321     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7322     MOVE X'2020233030303036393433' TO DFHEIV0(25:11)
  7323     CALL 'kxdfhei1' USING DFHEIV0,
  7324           DFHEIV1,
  7325           DFHEIV20,
  7326           DFHEIV99,
  7327           ELCNTL-KEY,
  7328           DFHEIV99,
  7329           DFHEIV99,
  7330           DFHEIV99
  7331     SET ADDRESS OF CONTROL-FILE TO
  7332         DFHEIV20
  7333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7334
  7335
  7336     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID OR
  7337        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
  7338         GO TO 7200-EXIT.
  7339
  7340     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
  7341         VARYING SUB FROM 1 BY 1 UNTIL
  7342         ((SUB > 8) OR
  7343         (CF-BENEFIT-CODE (SUB) = WS-BEN-CD)).
  7344
  7345     IF SUB NOT = 9
  7346         MOVE 'Y'             TO  WS-BEN-SEARCH-SW.
  7347
  7348     GO TO 7200-EXIT.
  7349
  7350 7200-BENEFIT-DUMMY.
  7351
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL1501.cbl
  7352 7200-DUMMY-EXIT.
  7353     EXIT.
  7354
  7355 7200-EXIT.
  7356     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL1501.cbl
  7358 7500-READ-CLAIM-MSTR-UPDATE.
  7359
  7360     MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
  7361     MOVE PI-CARRIER             TO  MSTR-CARRIER.
  7362     MOVE PI-CLAIM-NO            TO  MSTR-CLAIM-NO.
  7363     MOVE PI-CERT-NO             TO  MSTR-CERT-NO.
  7364
  7365
  7366* EXEC CICS READ
  7367*        DATASET   ('ELMSTR')
  7368*        RIDFLD    (ELMSTR-KEY)
  7369*        SET       (ADDRESS OF CLAIM-MASTER)
  7370*        UPDATE
  7371*    END-EXEC.
  7372     MOVE 'ELMSTR' TO DFHEIV1
  7373*    MOVE '&"S        EU         (   #00006979' TO DFHEIV0
  7374     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7375     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7376     MOVE X'2020233030303036393739' TO DFHEIV0(25:11)
  7377     CALL 'kxdfhei1' USING DFHEIV0,
  7378           DFHEIV1,
  7379           DFHEIV20,
  7380           DFHEIV99,
  7381           ELMSTR-KEY,
  7382           DFHEIV99,
  7383           DFHEIV99,
  7384           DFHEIV99
  7385     SET ADDRESS OF CLAIM-MASTER TO
  7386         DFHEIV20
  7387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7388
  7389
  7390 7500-EXIT.
  7391     EXIT.
  7392
  7393 7510-UNLOCK-CLAIM-MSTR.
  7394
  7395
  7396* EXEC CICS UNLOCK
  7397*        DATASET   ('ELMSTR')
  7398*    END-EXEC.
  7399     MOVE 'ELMSTR' TO DFHEIV1
  7400*    MOVE '&*                    #   #00006991' TO DFHEIV0
  7401     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7402     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7403     MOVE X'2020233030303036393931' TO DFHEIV0(25:11)
  7404     CALL 'kxdfhei1' USING DFHEIV0,
  7405           DFHEIV1,
  7406           DFHEIV99
  7407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7408
  7409
  7410 7510-EXIT.
  7411     EXIT.
  7412
  7413 7600-REWRITE-CLAIM-MSTR.
  7414
  7415     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL1501.cbl
  7416     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
  7417     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  7418     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  7419
  7420
  7421* EXEC CICS REWRITE
  7422*        DATASET   ('ELMSTR')
  7423*        FROM      (CLAIM-MASTER)
  7424*    END-EXEC.
  7425     MOVE LENGTH OF
  7426      CLAIM-MASTER
  7427       TO DFHEIV11
  7428     MOVE 'ELMSTR' TO DFHEIV1
  7429*    MOVE '&& L                  %   #00007005' TO DFHEIV0
  7430     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7431     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7432     MOVE X'2020233030303037303035' TO DFHEIV0(25:11)
  7433     CALL 'kxdfhei1' USING DFHEIV0,
  7434           DFHEIV1,
  7435           CLAIM-MASTER,
  7436           DFHEIV11,
  7437           DFHEIV99
  7438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7439
  7440
  7441 7600-EXIT.
  7442     EXIT.
  7443
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL1501.cbl
  7445 7700-READ-ELACTQ.
  7446
  7447
  7448* EXEC CICS HANDLE CONDITION
  7449*        NOTFND   (7799-EXIT)
  7450*    END-EXEC.
  7451*    MOVE '"$I                   ! * #00007016' TO DFHEIV0
  7452     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7453     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7454     MOVE X'2A20233030303037303136' TO DFHEIV0(25:11)
  7455     CALL 'kxdfhei1' USING DFHEIV0
  7456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7457
  7458
  7459
  7460* EXEC CICS READ
  7461*        DATASET   ('ELACTQ')
  7462*        RIDFLD    (ELACTQ-KEY)
  7463*        SET       (ADDRESS OF ACTIVITY-QUE)
  7464*        UPDATE
  7465*    END-EXEC.
  7466     MOVE 'ELACTQ' TO DFHEIV1
  7467*    MOVE '&"S        EU         (   #00007020' TO DFHEIV0
  7468     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7469     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7470     MOVE X'2020233030303037303230' TO DFHEIV0(25:11)
  7471     CALL 'kxdfhei1' USING DFHEIV0,
  7472           DFHEIV1,
  7473           DFHEIV20,
  7474           DFHEIV99,
  7475           ELACTQ-KEY,
  7476           DFHEIV99,
  7477           DFHEIV99,
  7478           DFHEIV99
  7479     SET ADDRESS OF ACTIVITY-QUE TO
  7480         DFHEIV20
  7481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7482
  7483
  7484     IF AQ-PMT-UNAPPROVED-COUNT NOT NUMERIC
  7485         MOVE ZEROS              TO  AQ-PMT-UNAPPROVED-COUNT.
  7486
  7487     IF AQ-PAYMENT-COUNTER NOT NUMERIC
  7488         MOVE +0                 TO  AQ-PAYMENT-COUNTER.
  7489
  7490     IF WS-CF-PMT-APPROVAL-USED
  7491         IF AQ-PMT-UNAPPROVED-COUNT > +0 AND
  7492            WS-CHECK-WRITTEN-DT = LOW-VALUES AND
  7493            WS-PMT-APPROVAL-SW = 'U'
  7494             SUBTRACT +1 FROM AQ-PMT-UNAPPROVED-COUNT
  7495             MOVE 'Y'            TO  WS-UPDATE-SW.
  7496
  7497     IF PAYMENT-NOT-PRINTED OR
  7498        PAYMENT-NOT-RELEASED
  7499         IF AQ-PAYMENT-COUNTER > +0
  7500             SUBTRACT +1 FROM AQ-PAYMENT-COUNTER
  7501             MOVE 'Y'            TO  WS-UPDATE-SW.
  7502
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL1501.cbl
  7503     IF AQ-PAYMENT-COUNTER = +0
  7504         MOVE ' '                TO  AQ-PENDING-PAYMENT-FLAG.
  7505
  7506     IF WS-UPDATE-SW = 'Y'
  7507         IF AQ-PENDING-ACTIVITY-FLAGS = SPACES
  7508             MOVE 'N'            TO  WS-UPDATE-SW
  7509             GO TO 7720-DELETE-ACTIVITY-QUE
  7510         ELSE
  7511             MOVE 'N'            TO  WS-UPDATE-SW
  7512     ELSE
  7513         GO TO 7750-UNLOCK-ACTIVITY-QUE.
  7514
  7515 7710-REWRITE-ACTIVITY-QUE.
  7516
  7517
  7518* EXEC CICS REWRITE
  7519*        DATASET   ('ELACTQ')
  7520*        FROM      (ACTIVITY-QUE)
  7521*    END-EXEC.
  7522     MOVE LENGTH OF
  7523      ACTIVITY-QUE
  7524       TO DFHEIV11
  7525     MOVE 'ELACTQ' TO DFHEIV1
  7526*    MOVE '&& L                  %   #00007060' TO DFHEIV0
  7527     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7528     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7529     MOVE X'2020233030303037303630' TO DFHEIV0(25:11)
  7530     CALL 'kxdfhei1' USING DFHEIV0,
  7531           DFHEIV1,
  7532           ACTIVITY-QUE,
  7533           DFHEIV11,
  7534           DFHEIV99
  7535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7536
  7537
  7538     GO TO 7799-EXIT.
  7539
  7540 7720-DELETE-ACTIVITY-QUE.
  7541
  7542
  7543* EXEC CICS DELETE
  7544*        DATASET   ('ELACTQ')
  7545*    END-EXEC.
  7546     MOVE 'ELACTQ' TO DFHEIV1
  7547*    MOVE '&(                    &   #00007069' TO DFHEIV0
  7548     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7549     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7550     MOVE X'2020233030303037303639' TO DFHEIV0(25:11)
  7551     CALL 'kxdfhei1' USING DFHEIV0,
  7552           DFHEIV1,
  7553           DFHEIV99,
  7554           DFHEIV99,
  7555           DFHEIV99,
  7556           DFHEIV99
  7557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7558
  7559
  7560     GO TO 7799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL1501.cbl
  7561
  7562 7750-UNLOCK-ACTIVITY-QUE.
  7563
  7564
  7565* EXEC CICS UNLOCK
  7566*        DATASET   ('ELACTQ')
  7567*    END-EXEC.
  7568     MOVE 'ELACTQ' TO DFHEIV1
  7569*    MOVE '&*                    #   #00007077' TO DFHEIV0
  7570     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7571     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7572     MOVE X'2020233030303037303737' TO DFHEIV0(25:11)
  7573     CALL 'kxdfhei1' USING DFHEIV0,
  7574           DFHEIV1,
  7575           DFHEIV99
  7576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7577
  7578
  7579     MOVE 'N'                    TO  WS-UPDATE-SW.
  7580
  7581 7799-EXIT.
  7582     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL1501.cbl
  7584 7800-READ-CERT-UPDATE.
  7585
  7586
  7587* EXEC CICS READ
  7588*        DATASET   ('ELCERT')
  7589*        RIDFLD    (ELCERT-KEY)
  7590*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  7591*        UPDATE
  7592*    END-EXEC.
  7593     MOVE 'ELCERT' TO DFHEIV1
  7594*    MOVE '&"S        EU         (   #00007088' TO DFHEIV0
  7595     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7596     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7597     MOVE X'2020233030303037303838' TO DFHEIV0(25:11)
  7598     CALL 'kxdfhei1' USING DFHEIV0,
  7599           DFHEIV1,
  7600           DFHEIV20,
  7601           DFHEIV99,
  7602           ELCERT-KEY,
  7603           DFHEIV99,
  7604           DFHEIV99,
  7605           DFHEIV99
  7606     SET ADDRESS OF CERTIFICATE-MASTER TO
  7607         DFHEIV20
  7608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7609
  7610
  7611 7800-EXIT.
  7612     EXIT.
  7613
  7614 7810-REWRITE-CERT.
  7615
  7616
  7617* EXEC CICS REWRITE
  7618*        DATASET   ('ELCERT')
  7619*        FROM      (CERTIFICATE-MASTER)
  7620*    END-EXEC.
  7621     MOVE LENGTH OF
  7622      CERTIFICATE-MASTER
  7623       TO DFHEIV11
  7624     MOVE 'ELCERT' TO DFHEIV1
  7625*    MOVE '&& L                  %   #00007100' TO DFHEIV0
  7626     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7627     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7628     MOVE X'2020233030303037313030' TO DFHEIV0(25:11)
  7629     CALL 'kxdfhei1' USING DFHEIV0,
  7630           DFHEIV1,
  7631           CERTIFICATE-MASTER,
  7632           DFHEIV11,
  7633           DFHEIV99
  7634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7635
  7636
  7637 7810-EXIT.
  7638     EXIT.
  7639
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL1501.cbl
  7641 7900-READ-CONTROL-FILE.
  7642
  7643
  7644* EXEC CICS READ
  7645*        DATASET   ('ELCNTL')
  7646*        RIDFLD    (ELCNTL-KEY)
  7647*        SET       (ADDRESS OF CONTROL-FILE)
  7648*    END-EXEC.
  7649     MOVE 'ELCNTL' TO DFHEIV1
  7650*    MOVE '&"S        E          (   #00007111' TO DFHEIV0
  7651     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7652     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7653     MOVE X'2020233030303037313131' TO DFHEIV0(25:11)
  7654     CALL 'kxdfhei1' USING DFHEIV0,
  7655           DFHEIV1,
  7656           DFHEIV20,
  7657           DFHEIV99,
  7658           ELCNTL-KEY,
  7659           DFHEIV99,
  7660           DFHEIV99,
  7661           DFHEIV99
  7662     SET ADDRESS OF CONTROL-FILE TO
  7663         DFHEIV20
  7664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7665
  7666
  7667 7900-EXIT.
  7668     EXIT.
  7669
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL1501.cbl
  7671 8000-LOAD-ERROR-MESSAGES.
  7672     IF EMI-NO-ERRORS
  7673         GO TO 8000-EXIT.
  7674
  7675     IF EMI-NUMBER-OF-LINES = 1
  7676         MOVE EMI-LINE1          TO  ERRMSG1O
  7677         GO TO 8000-EXIT.
  7678
  7679     MOVE EMI-LINE1              TO  ERRMSG1O.
  7680
  7681 8000-EXIT.
  7682     EXIT.
  7683
  7684 8100-SEND-INITIAL-MAP.
  7685
  7686     IF PI-FULL-SCREEN-SHOWN
  7687         GO TO 8200-SEND-DATAONLY.
  7688
  7689     MOVE 'Y'                    TO PI-FULL-SCREEN-IND.
  7690
  7691     MOVE SAVE-DATE              TO  RUNDTEO.
  7692     MOVE EIBTIME                TO  TIME-IN.
  7693     MOVE TIME-OUT               TO  RUNTIMEO.
  7694     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
  7695
  7696*    IF PI-COMPANY-ID NOT = 'DMD'
  7697         MOVE SPACES             TO PF6O.
  7698         MOVE AL-SADOF           TO PF6A.
  7699
  7700
  7701* EXEC CICS SEND
  7702*        MAP      (MAP-NAME)
  7703*        MAPSET   (MAPSET-NAME)
  7704*        FROM     (EL150BO)
  7705*        ERASE
  7706*        CURSOR
  7707*    END-EXEC.
  7708     MOVE LENGTH OF
  7709      EL150BO
  7710       TO DFHEIV12
  7711     MOVE -1
  7712       TO DFHEIV11
  7713*    MOVE '8$     CT  E    H L F ,   #00007150' TO DFHEIV0
  7714     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7715     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7716     MOVE X'2020233030303037313530' TO DFHEIV0(25:11)
  7717     CALL 'kxdfhei1' USING DFHEIV0,
  7718           MAP-NAME,
  7719           EL150BO,
  7720           DFHEIV12,
  7721           MAPSET-NAME,
  7722           DFHEIV99,
  7723           DFHEIV99,
  7724           DFHEIV99,
  7725           DFHEIV11,
  7726           DFHEIV99,
  7727           DFHEIV99,
  7728           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL1501.cbl
  7729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7730
  7731
  7732     GO TO 9100-RETURN-TRAN.
  7733
  7734 8200-SEND-DATAONLY.
  7735
  7736     IF NOT PI-FULL-SCREEN-SHOWN
  7737         GO TO 8100-SEND-INITIAL-MAP.
  7738
  7739     MOVE SAVE-DATE              TO  RUNDTEO.
  7740     MOVE EIBTIME                TO  TIME-IN.
  7741     MOVE TIME-OUT               TO  RUNTIMEO.
  7742     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
  7743
  7744     MOVE PI-CARRIER             TO  CARRO.
  7745     MOVE PI-CLAIM-NO            TO  CLMNOO.
  7746     MOVE PI-CERT-PRIME          TO  CERTNOO.
  7747     MOVE PI-CERT-SFX            TO  SUFXO.
  7748
  7749*    IF PI-COMPANY-ID NOT = 'DMD'
  7750         MOVE SPACES             TO PF6O.
  7751         MOVE AL-SADOF           TO PF6A.
  7752
  7753
  7754* EXEC CICS SEND
  7755*        MAP      (MAP-NAME)
  7756*        MAPSET   (MAPSET-NAME)
  7757*        FROM     (EL150BO)
  7758*        DATAONLY
  7759*        CURSOR
  7760*    END-EXEC.
  7761     MOVE LENGTH OF
  7762      EL150BO
  7763       TO DFHEIV12
  7764     MOVE -1
  7765       TO DFHEIV11
  7766*    MOVE '8$D    CT       H L F ,   #00007179' TO DFHEIV0
  7767     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  7768     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7769     MOVE X'2020233030303037313739' TO DFHEIV0(25:11)
  7770     CALL 'kxdfhei1' USING DFHEIV0,
  7771           MAP-NAME,
  7772           EL150BO,
  7773           DFHEIV12,
  7774           MAPSET-NAME,
  7775           DFHEIV99,
  7776           DFHEIV99,
  7777           DFHEIV99,
  7778           DFHEIV11,
  7779           DFHEIV99,
  7780           DFHEIV99,
  7781           DFHEIV99
  7782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7783
  7784
  7785     GO TO 9100-RETURN-TRAN.
  7786
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL1501.cbl
  7787 8300-SEND-TEXT.
  7788
  7789* EXEC CICS SEND TEXT
  7790*        FROM     (LOGOFF-TEXT)
  7791*        LENGTH   (LOGOFF-LENGTH)
  7792*        ERASE
  7793*        FREEKB
  7794*    END-EXEC.
  7795*    MOVE '8&      T  E F  H   F -   #00007190' TO DFHEIV0
  7796     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  7797     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  7798     MOVE X'2020233030303037313930' TO DFHEIV0(25:11)
  7799     CALL 'kxdfhei1' USING DFHEIV0,
  7800           LOGOFF-TEXT,
  7801           LOGOFF-LENGTH,
  7802           DFHEIV99,
  7803           DFHEIV99,
  7804           DFHEIV99,
  7805           DFHEIV99,
  7806           DFHEIV99,
  7807           DFHEIV99,
  7808           DFHEIV99,
  7809           DFHEIV99,
  7810           DFHEIV99,
  7811           DFHEIV99
  7812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7813
  7814
  7815
  7816* EXEC CICS RETURN
  7817*        END-EXEC.
  7818*    MOVE '.(                    &   #00007197' TO DFHEIV0
  7819     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  7820     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7821     MOVE X'2020233030303037313937' TO DFHEIV0(25:11)
  7822     CALL 'kxdfhei1' USING DFHEIV0,
  7823           DFHEIV99,
  7824           DFHEIV99,
  7825           DFHEIV99,
  7826           DFHEIV99,
  7827           DFHEIV99
  7828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7829
  7830
  7831 8400-NOT-FOUND.
  7832     IF FILE-SWITCH = 'BENE'
  7833         MOVE ER-0282            TO  EMI-ERROR.
  7834
  7835     MOVE -1                     TO  LINENOL.
  7836     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7837
  7838     IF PASS-SWITCH = 'A'
  7839         GO TO 8100-SEND-INITIAL-MAP
  7840     ELSE
  7841         GO TO 8200-SEND-DATAONLY.
  7842
  7843 8500-FILE-NOTOPEN.
  7844
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL1501.cbl
  7845     IF FILE-SWITCH = 'TRLR'
  7846         MOVE ER-0172            TO  EMI-ERROR.
  7847
  7848     IF FILE-SWITCH = 'CERT'
  7849         MOVE ER-0169            TO  EMI-ERROR.
  7850
  7851     IF FILE-SWITCH = 'CNTL'
  7852         MOVE ER-0042            TO  EMI-ERROR.
  7853
  7854     IF FILE-SWITCH = 'ACTQ'
  7855         MOVE ER-0338            TO  EMI-ERROR.
  7856
  7857     IF FILE-SWITCH = 'MSTR'
  7858         MOVE ER-0154            TO  EMI-ERROR.
  7859
  7860     IF FILE-SWITCH = 'RCON'
  7861         MOVE ER-0776            TO  EMI-ERROR.
  7862
  7863     IF FILE-SWITCH = 'PLCY'
  7864         MOVE ER-9883            TO  EMI-ERROR.
  7865
  7866     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7867
  7868     MOVE -1                     TO  LINENOL.
  7869
  7870     IF PASS-SWITCH = 'A'
  7871         GO TO 8100-SEND-INITIAL-MAP
  7872     ELSE
  7873         GO TO 8200-SEND-DATAONLY.
  7874
  7875 8800-UNAUTHORIZED-ACCESS.
  7876     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  7877     GO TO 8300-SEND-TEXT.
  7878
  7879 8810-PF23.
  7880     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  7881     MOVE XCTL-005               TO  PGM-NAME.
  7882     GO TO 9300-XCTL.
  7883
  7884 9100-RETURN-TRAN.
  7885     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  7886     MOVE '150B'                 TO  PI-CURRENT-SCREEN-NO.
  7887
  7888
  7889* EXEC CICS RETURN
  7890*        TRANSID    (TRANS-ID)
  7891*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7892*        LENGTH     (PI-COMM-LENGTH)
  7893*    END-EXEC.
  7894*    MOVE '.(CT                  &   #00007257' TO DFHEIV0
  7895     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  7896     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7897     MOVE X'2020233030303037323537' TO DFHEIV0(25:11)
  7898     CALL 'kxdfhei1' USING DFHEIV0,
  7899           TRANS-ID,
  7900           PROGRAM-INTERFACE-BLOCK,
  7901           PI-COMM-LENGTH,
  7902           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL1501.cbl
  7903           DFHEIV99
  7904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7905
  7906
  7907 9200-RETURN-MAIN-MENU.
  7908     MOVE XCTL-126               TO PGM-NAME.
  7909     GO TO 9300-XCTL.
  7910
  7911 9300-XCTL.
  7912
  7913* EXEC CICS HANDLE CONDITION
  7914*        PGMIDERR   (9350-NOT-FOUND)
  7915*    END-EXEC.
  7916*    MOVE '"$L                   ! + #00007268' TO DFHEIV0
  7917     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  7918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7919     MOVE X'2B20233030303037323638' TO DFHEIV0(25:11)
  7920     CALL 'kxdfhei1' USING DFHEIV0
  7921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7922
  7923
  7924
  7925* EXEC CICS XCTL
  7926*        PROGRAM    (PGM-NAME)
  7927*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7928*        LENGTH     (PI-COMM-LENGTH)
  7929*    END-EXEC.
  7930*    MOVE '.$C                   $   #00007272' TO DFHEIV0
  7931     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7932     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7933     MOVE X'2020233030303037323732' TO DFHEIV0(25:11)
  7934     CALL 'kxdfhei1' USING DFHEIV0,
  7935           PGM-NAME,
  7936           PROGRAM-INTERFACE-BLOCK,
  7937           PI-COMM-LENGTH
  7938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7939
  7940
  7941 9350-NOT-FOUND.
  7942     MOVE ER-0923                TO EMI-ERROR.
  7943     MOVE -1                     TO LINENOL.
  7944     PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT.
  7945     PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT.
  7946     PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT.
  7947     GO TO 8200-SEND-DATAONLY.
  7948
  7949 9400-CLEAR.
  7950     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  7951     GO TO 9300-XCTL.
  7952
  7953 9500-PF12.
  7954     MOVE XCTL-010               TO  PGM-NAME.
  7955     GO TO 9300-XCTL.
  7956
  7957 9600-PGMID-ERROR.
  7958
  7959* EXEC CICS HANDLE CONDITION
  7960*        PGMIDERR   (8300-SEND-TEXT)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL1501.cbl
  7961*    END-EXEC.
  7962*    MOVE '"$L                   ! , #00007295' TO DFHEIV0
  7963     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  7964     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7965     MOVE X'2C20233030303037323935' TO DFHEIV0(25:11)
  7966     CALL 'kxdfhei1' USING DFHEIV0
  7967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7968
  7969
  7970     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  7971     MOVE ' '                    TO  PI-ENTRY-CD-1.
  7972     MOVE XCTL-005               TO  PGM-NAME.
  7973     MOVE PGM-NAME               TO  LOGOFF-PGM.
  7974     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  7975     GO TO 9300-XCTL.
  7976
  7977 9700-LINK-DATE-CONVERT.
  7978     MOVE LINK-ELDATCV           TO PGM-NAME.
  7979
  7980
  7981* EXEC CICS LINK
  7982*        PROGRAM    (PGM-NAME)
  7983*        COMMAREA   (DATE-CONVERSION-DATA)
  7984*        LENGTH     (DC-COMM-LENGTH)
  7985*    END-EXEC.
  7986*    MOVE '."C                   ''   #00007309' TO DFHEIV0
  7987     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7988     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7989     MOVE X'2020233030303037333039' TO DFHEIV0(25:11)
  7990     CALL 'kxdfhei1' USING DFHEIV0,
  7991           PGM-NAME,
  7992           DATE-CONVERSION-DATA,
  7993           DC-COMM-LENGTH,
  7994           DFHEIV99,
  7995           DFHEIV99,
  7996           DFHEIV99
  7997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7998
  7999
  8000 9700-EXIT.
  8001     EXIT.
  8002
  8003 9800-DEEDIT.
  8004
  8005
  8006* EXEC CICS BIF DEEDIT
  8007*        FIELD   (WS-DEEDIT-FIELD)
  8008*        LENGTH  (WS-DEEDIT-LENGTH)
  8009*    END-EXEC.
  8010*    MOVE '@"L                   #   #00007320' TO DFHEIV0
  8011     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8012     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8013     MOVE X'2020233030303037333230' TO DFHEIV0(25:11)
  8014     CALL 'kxdfhei1' USING DFHEIV0,
  8015           WS-DEEDIT-FIELD,
  8016           WS-DEEDIT-LENGTH
  8017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8018
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL1501.cbl
  8019
  8020 9800-EXIT.
  8021     EXIT.
  8022
  8023
  8024 9870-OUTPUT-ACTIVITY-RECORD.
  8025
  8026
  8027* EXEC CICS GETMAIN
  8028*        SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
  8029*        LENGTH(25)
  8030*        INITIMG(WS-BLANK)
  8031*    END-EXEC.
  8032     MOVE 25
  8033       TO DFHEIV11
  8034*    MOVE ',"IL                  $   #00007331' TO DFHEIV0
  8035     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8036     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8037     MOVE X'2020233030303037333331' TO DFHEIV0(25:11)
  8038     CALL 'kxdfhei1' USING DFHEIV0,
  8039           DFHEIV20,
  8040           DFHEIV11,
  8041           WS-BLANK
  8042     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  8043         DFHEIV20
  8044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8045
  8046
  8047     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  8048     MOVE ELMSTR-KEY             TO DA-KEY.
  8049     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
  8050
  8051     IF WS-PAY-TYPE EQUAL '7'
  8052         MOVE 'V'                TO DA-RECORD-TYPE
  8053     ELSE
  8054         MOVE 'P'                TO DA-RECORD-TYPE.
  8055
  8056
  8057* EXEC CICS HANDLE CONDITION
  8058*        NOTOPEN (9870-NOTOPEN)
  8059*        DUPREC (9870-EXIT)
  8060*    END-EXEC.
  8061*    MOVE '"$J%                  ! - #00007346' TO DFHEIV0
  8062     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  8063     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8064     MOVE X'2D20233030303037333436' TO DFHEIV0(25:11)
  8065     CALL 'kxdfhei1' USING DFHEIV0
  8066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8067
  8068
  8069
  8070* EXEC CICS WRITE
  8071*        DATASET ('DLYACTV')
  8072*        RIDFLD (DA-KEY)
  8073*        FROM (DAILY-ACTIVITY-RECORD)
  8074*        LENGTH (25)
  8075*    END-EXEC.
  8076     MOVE 'DLYACTV' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL1501.cbl
  8077     MOVE 25
  8078       TO DFHEIV11
  8079*    MOVE '&$ L                  ''   #00007351' TO DFHEIV0
  8080     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8081     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8082     MOVE X'2020233030303037333531' TO DFHEIV0(25:11)
  8083     CALL 'kxdfhei1' USING DFHEIV0,
  8084           DFHEIV1,
  8085           DAILY-ACTIVITY-RECORD,
  8086           DFHEIV11,
  8087           DA-KEY,
  8088           DFHEIV99,
  8089           DFHEIV99
  8090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8091
  8092
  8093     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
  8094     GO TO 9870-EXIT.
  8095
  8096 9870-NOTOPEN.
  8097
  8098     MOVE '2955'                 TO EMI-ERROR.
  8099     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
  8100
  8101 9870-EXIT.
  8102
  8103 9900-ERROR-FORMAT.
  8104     IF NOT EMI-ERRORS-COMPLETE
  8105         MOVE LINK-001           TO PGM-NAME
  8106
  8107* EXEC CICS LINK
  8108*            PROGRAM    (PGM-NAME)
  8109*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8110*            LENGTH     (EMI-COMM-LENGTH)
  8111*        END-EXEC.
  8112*    MOVE '."C                   ''   #00007371' TO DFHEIV0
  8113     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8114     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8115     MOVE X'2020233030303037333731' TO DFHEIV0(25:11)
  8116     CALL 'kxdfhei1' USING DFHEIV0,
  8117           PGM-NAME,
  8118           ERROR-MESSAGE-INTERFACE-BLOCK,
  8119           EMI-COMM-LENGTH,
  8120           DFHEIV99,
  8121           DFHEIV99,
  8122           DFHEIV99
  8123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8124
  8125
  8126 9900-EXIT.
  8127     EXIT.
  8128
  8129 9990-ABEND.
  8130     MOVE -1                     TO  ENTERPFL.
  8131     MOVE LINK-004               TO  PGM-NAME.
  8132
  8133     MOVE DFHEIBLK               TO  EMI-LINE1
  8134
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL1501.cbl
  8135* EXEC CICS LINK
  8136*        PROGRAM   (PGM-NAME)
  8137*        COMMAREA  (EMI-LINE1)
  8138*        LENGTH    (72)
  8139*    END-EXEC.
  8140     MOVE 72
  8141       TO DFHEIV11
  8142*    MOVE '."C                   ''   #00007385' TO DFHEIV0
  8143     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8144     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8145     MOVE X'2020233030303037333835' TO DFHEIV0(25:11)
  8146     CALL 'kxdfhei1' USING DFHEIV0,
  8147           PGM-NAME,
  8148           EMI-LINE1,
  8149           DFHEIV11,
  8150           DFHEIV99,
  8151           DFHEIV99,
  8152           DFHEIV99
  8153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8154
  8155
  8156     MOVE EMI-LINE1              TO  ERRMSG1O.
  8157     GO TO 8200-SEND-DATAONLY.
  8158
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL1501.cbl
  8160 9995-SECURITY-VIOLATION.
  8161*                            COPY ELCSCTP.
  8162******************************************************************
  8163*                                                                *
  8164*                            ELCSCTP                             *
  8165*                            VMOD=2.001                          *
  8166*                                                                *
  8167*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8168******************************************************************
  8169
  8170
  8171     MOVE EIBDATE          TO SM-JUL-DATE.
  8172     MOVE EIBTRMID         TO SM-TERMID.
  8173     MOVE THIS-PGM         TO SM-PGM.
  8174     MOVE EIBTIME          TO TIME-IN.
  8175     MOVE TIME-OUT         TO SM-TIME.
  8176     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8177
  8178
  8179* EXEC CICS LINK
  8180*         PROGRAM  ('EL003')
  8181*         COMMAREA (SECURITY-MESSAGE)
  8182*         LENGTH   (80)
  8183*    END-EXEC.
  8184     MOVE 'EL003' TO DFHEIV1
  8185     MOVE 80
  8186       TO DFHEIV11
  8187*    MOVE '."C                   ''   #00007413' TO DFHEIV0
  8188     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8189     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8190     MOVE X'2020233030303037343133' TO DFHEIV0(25:11)
  8191     CALL 'kxdfhei1' USING DFHEIV0,
  8192           DFHEIV1,
  8193           SECURITY-MESSAGE,
  8194           DFHEIV11,
  8195           DFHEIV99,
  8196           DFHEIV99,
  8197           DFHEIV99
  8198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8199
  8200
  8201******************************************************************
  8202
  8203
  8204
  8205 9999-DFHBACK SECTION.
  8206     MOVE '9%                    "   ' TO DFHEIV0
  8207     MOVE 'EL1501' TO DFHEIV1
  8208     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8209     GOBACK.
  8210 9999-DFHEXIT.
  8211     IF DFHEIGDJ EQUAL 0001
  8212         NEXT SENTENCE
  8213     ELSE IF DFHEIGDJ EQUAL 2
  8214         GO TO 1000-SHOW-CLAIM-HISTORY,
  8215               0100-FIRST-TIME-IN,
  8216               8500-FILE-NOTOPEN,
  8217               9600-PGMID-ERROR,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL1501.cbl
  8218               9990-ABEND
  8219         DEPENDING ON DFHEIGDI
  8220     ELSE IF DFHEIGDJ EQUAL 3
  8221         GO TO 0690-QIDERR
  8222         DEPENDING ON DFHEIGDI
  8223     ELSE IF DFHEIGDJ EQUAL 4
  8224         GO TO 2950-NO-MORE-TRAILERS,
  8225               2950-NO-MORE-TRAILERS
  8226         DEPENDING ON DFHEIGDI
  8227     ELSE IF DFHEIGDJ EQUAL 5
  8228         GO TO 2020-BROWSE-FORWARD
  8229         DEPENDING ON DFHEIGDI
  8230     ELSE IF DFHEIGDJ EQUAL 6
  8231         GO TO 2950-NO-MORE-TRAILERS,
  8232               2950-NO-MORE-TRAILERS
  8233         DEPENDING ON DFHEIGDI
  8234     ELSE IF DFHEIGDJ EQUAL 7
  8235         GO TO 5290-NOTFND
  8236         DEPENDING ON DFHEIGDI
  8237     ELSE IF DFHEIGDJ EQUAL 8
  8238         GO TO 5700-NOT-FOUND,
  8239               8500-FILE-NOTOPEN
  8240         DEPENDING ON DFHEIGDI
  8241     ELSE IF DFHEIGDJ EQUAL 9
  8242         GO TO 7200-EXIT,
  8243               7200-EXIT
  8244         DEPENDING ON DFHEIGDI
  8245     ELSE IF DFHEIGDJ EQUAL 10
  8246         GO TO 7799-EXIT
  8247         DEPENDING ON DFHEIGDI
  8248     ELSE IF DFHEIGDJ EQUAL 11
  8249         GO TO 9350-NOT-FOUND
  8250         DEPENDING ON DFHEIGDI
  8251     ELSE IF DFHEIGDJ EQUAL 12
  8252         GO TO 8300-SEND-TEXT
  8253         DEPENDING ON DFHEIGDI
  8254     ELSE IF DFHEIGDJ EQUAL 13
  8255         GO TO 9870-NOTOPEN,
  8256               9870-EXIT
  8257         DEPENDING ON DFHEIGDI.
  8258     MOVE '9%                    "   ' TO DFHEIV0
  8259     MOVE 'EL1501' TO DFHEIV1
  8260     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8261     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        7104     Code:       20465
