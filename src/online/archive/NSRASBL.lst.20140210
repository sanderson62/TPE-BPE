* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSRASLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page   2
* NSRASBL.cbl
    14* 060611    2011022800001  PEMA  NEW PROGRAM
    15* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    16* 071212    2011022800001  AJRA  ADD UNDW ID
    17* 072312    2011022800001  AJRA    ADD NEW FIELDS
    18* 090612  IR2012090600001  AJRA  NAPERSOFT
    19* 091112  IR2012091100002  AJRA  FIX AKA
    20* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    21* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    22* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    23* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    24* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    25* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    26* 110612    2012101700002  AJRA  ADD NEW FIELDS
    27* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    28* 121712    2012101700002  AJRA  ADD DEFAULT AGE FLAG
    29* 050213    2013050100001  AJRA  FIX AH REFUND ON DEATH CLAIM
    30* 091213    2013090300001  AJRA  NAPERSOFT PHASE 2
    31* 123113    2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    32* 011314  IR2014011300001  AJRA  FIX NEXT BUS DT AND ENDORSEMENT A
    33******************************************************************
    34 ENVIRONMENT DIVISION.
    35 DATA DIVISION.
    36 working-storage section.
    37 01  DFH-START PIC X(04).
    38 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    39 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    40 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    41 77  SAVE-BIN-NEXT-BUS-DT        PIC XX      VALUE SPACES.
    42 77  S1                          PIC S999 COMP-3 VALUE +0.
    43 77  E1                          PIC S999 COMP-3 VALUE +0.
    44 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    45 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    46 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    47 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    48 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    49 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    50 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    51 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    52 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    53 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    54 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    55 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    56     88  FOUND-BENE                  VALUE 'Y'.
    57 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    58 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    59 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    60 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    61     88  END-OF-ERPNDB              VALUE 'Y'.
    62 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    63     88  ACCT-FOUND                 VALUE 'Y'.
    64 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    65     88  CERT-FOUND                 VALUE 'Y'.
    66     88  CERT-NOT-FOUND             VALUE 'N'.
    67 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    68     88  ENDT-FOUND                 VALUE 'Y'.
    69     88  ENDT-NOT-FOUND             VALUE 'N'.
    70 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    71     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page   3
* NSRASBL.cbl
    72 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    73 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    74 77  WS-LF-EARN                  PIC X     VALUE ' '.
    75 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    76 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    77 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    78 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    79 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    80 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    81 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    82 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    83 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    84 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    85 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    86 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    87 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    88 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    89 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    90 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    91 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    92 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
    93     88  PROCESS-ISSUE               VALUE 'I'.
    94     88  PROCESS-CANCEL              VALUE 'C'.
    95 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
    96 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
    97 77  WS-DIFF                     PIC 999 VALUE ZEROS.
    98 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    99 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
   100 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
   101 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
   102 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
   103 01  WS-CALC-FIELDS.
   104     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
   105     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
   106     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   107     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   108     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   109     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   110     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   111     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   112     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   113     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   114     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   115     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   116     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   117     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   118     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   119     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   120     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   121     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   122     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   123     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   124     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   125     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   126     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   127     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   128     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   129     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page   4
* NSRASBL.cbl
   130     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   131     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   132     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   133     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   134     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   135     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   136     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   137     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   138     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   139     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   140     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   141     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   142     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   143     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   144     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   145     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   146 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   147 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   148 01 response-code         pic s9(8) comp.
   149 01 display-response      pic 9(8).
   150 01 bl-index              pic 9(8) comp.
   151 01 max-last-name         pic x(18).
   152 01 first-initial         pic x.
   153 01 name-in-range-flag    pic 9.
   154 01 max-entries           pic s9(8) comp value 100.
   155 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   156 01 lower-case    pic x(26) value
   157            "abcdefghijklmnopqrstuvwxyz".
   158 01 upper-case    pic x(26) value
   159            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   160
   161*                                COPY ELCVADS.
   162******************************************************************
   163*                                                                *
   164*                                                                *
   165*                            ELCVADS.                            *
   166*                                                                *
   167*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   168*   ELVADS                  LENGTH = 350                         *
   169******************************************************************
   170******************************************************************
   171*                   C H A N G E   L O G
   172*
   173* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   174*-----------------------------------------------------------------
   175*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   176* EFFECTIVE    NUMBER
   177*-----------------------------------------------------------------
   178* 100111    2011022800001  AJRA  NAPERSOFT
   179******************************************************************
   180
   181 01  VIRGINIA-DISCLOSURE.
   182     12  VD-COMPANY-CD              PIC X.
   183     12  VD-CARRIER                 PIC X.
   184     12  VD-GROUPING.
   185         20  VD-GROUPING-PREFIX     PIC XXX.
   186         20  VD-GROUPING-PRIME      PIC XXX.
   187     12  VD-STATE                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page   5
* NSRASBL.cbl
   188     12  VD-ACCOUNT.
   189         20  VD-ACCOUNT-PREFIX      PIC X(4).
   190         20  VD-ACCOUNT-PRIME       PIC X(6).
   191     12  VD-CERT-EFF-DT             PIC XX.
   192     12  VD-CERT-NO.
   193         20  VD-CERT-PRIME          PIC X(10).
   194         20  VD-CERT-SFX            PIC X.
   195     12  VD-ENTRY-BATCH             PIC X(6).
   196     12  VD-CSR-ID                  PIC X(4).
   197     12  VD-NAME.
   198         20  VD-INSURED-LAST-NAME   PIC X(15).
   199         20  VD-INSURED-FIRST-NAME.
   200             24  VD-INSURED-1ST-INIT PIC X.
   201             24  FILLER             PIC X(9).
   202         20  VD-INSURED-MIDDLE-INIT PIC X.
   203     12  VD-JOINT-INSURED.
   204         20 VD-JOINT-LAST-NAME      PIC X(15).
   205         20 VD-JOINT-FIRST-NAME.
   206            24  VD-JOINT-FIRST-INIT PIC X.
   207            24  FILLER              PIC X(9).
   208         20 VD-JOINT-MIDDLE-INIT    PIC X.
   209     12  VD-INSURED-ADDRESS-1       PIC X(30).
   210     12  VD-INSURED-ADDRESS-2       PIC X(30).
   211     12  VD-INSURED-CITY-STATE.
   212         20  VD-INSURED-CITY        PIC X(28).
   213         20  VD-INSURED-STATE       PIC XX.
   214     12  VD-INSURED-ZIP-CODE.
   215         20  VD-INSURED-ZIP-PRIME.
   216             24  VD-INSURED-ZIP-1   PIC X.
   217                 88  VD-CANADIAN-POST-CODE
   218                                       VALUE 'A' THRU 'Z'.
   219             24  FILLER             PIC X(4).
   220         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   221     12  VD-BENEFICIARY-NAME        PIC X(30).
   222     12  VD-ACCOUNT-NAME            PIC X(30).
   223     12  VD-LOAN-TERM               PIC S999   COMP-3.
   224     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   225     12  VD-1ST-PMT-DT              PIC XX.
   226     12  VD-LIFE-BENEFIT-CD         PIC XX.
   227         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   228         88  VD-INVALID-LIFE           VALUE '  ' '00'
   229                                             '90' THRU '99'.
   230     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   231                                    PIC XX.
   232     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   233     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   234     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   235     12  VD-LF-TERM                 PIC S999   COMP-3.
   236     12  VD-AH-BENEFIT-CD           PIC XX.
   237         88  VD-VALID-AH               VALUE '01' THRU '89'.
   238         88  VD-INVALID-AH             VALUE '  ' '00'
   239                                             '90' THRU '99'.
   240     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   241     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   242     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   243     12  VD-AH-TERM                 PIC S999   COMP-3.
   244     12  VD-LETTER-ID               PIC X(4).
   245     12  VD-PROC-ID                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page   6
* NSRASBL.cbl
   246     12  VD-COMP-ID                 PIC X(3).
   247     12  VD-CURRENT-DATE            PIC XX.
   248     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   249     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   250     12  FILLER                     PIC X(32).
   251 01  WS-PASS-AREA.
   252     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   253     05  WS-PASS-VADS-REC    PIC X(350).
   254
   255*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   256*                         COPY ELCZREC.
   257******************************************************************
   258*                                                                *
   259*                                                                *
   260*                            ELCZREC.                            *
   261*                                                                *
   262*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   263*                                                                *
   264******************************************************************
   265*-----------------------------------------------------------------
   266*                   C H A N G E   L O G
   267*
   268* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   269*-----------------------------------------------------------------
   270*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   271* EFFECTIVE    NUMBER
   272*-----------------------------------------------------------------
   273* 122011    2011022800001  AJRA  NEW FILE
   274* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   275* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   276* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   277* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   278*-----------------------------------------------------------------
   279 01  W-Z-CONTROL-DATA.
   280     05  W-NUMBER-OF-COPIES      PIC  9.
   281     05  FILLER                  PIC  X.
   282     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   283     05  FILLER                  PIC  X.
   284     05  W-DAYS-TO-RESEND        PIC  999.
   285     05  FILLER                  PIC  X.
   286     05  W-FORM-TO-RESEND        PIC  X(4).
   287     05  W-ADD-BAR-CODE          PIC  X.
   288     05  W-PROMPT-LETTER         PIC  X.
   289     05  W-HAS-RETURN-ENV        PIC  X.
   290     05  W-ENCLOSURE-CD          PIC  XXX.
   291     05  W-SIG-FLAG-DEFAULT      PIC  X.
   292     05  W-AUTO-CLOSE-IND        PIC  X.
   293     05  FILLER                  PIC  X.
   294     05  W-LETTER-TO-BENE        PIC  X.
   295     05  FILLER                  PIC  X.
   296     05  W-LETTER-TO-ACCT        PIC  X.
   297     05  FILLER                  PIC  X.
   298     05  W-LETTER-TYPE           PIC  X.
   299     05  FILLER                  PIC  X.
   300     05  W-PRINT-CERTIFICATE     PIC  X.
   301     05  FILLER                  PIC  X.
   302     05  W-REFUND-REQUIRED       PIC  X.
   303     05  FILLER                  PIC  X.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page   7
* NSRASBL.cbl
   304     05  W-ONBASE-CODE           PIC  XX.
   305     05  FILLER                  PIC  X.
   306     05  W-ACCT-SUMM             PIC  X.
   307     05  FILLER                  PIC  X.
   308     05  W-CSO-SUMM              PIC  X.
   309     05  FILLER                  PIC  X.
   310     05  W-REASONS-REQUIRED      PIC  X.
   311     05  FILLER                  PIC  X(29).
   312 01  MISC.
   313     12  WS-RESPONSE             PIC S9(8)   COMP.
   314         88  RESP-NORMAL                  VALUE +00.
   315         88  RESP-NOTFND                  VALUE +13.
   316         88  RESP-DUPREC                  VALUE +14.
   317         88  RESP-DUPKEY                  VALUE +15.
   318         88  RESP-NOTOPEN                 VALUE +19.
   319         88  RESP-ENDFILE                 VALUE +20.
   320 01  srch-commarea.
   321*                                copy ELCADLTRSPI.
   322******************************************************************
   323*                   C H A N G E   L O G
   324*
   325* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   326*-----------------------------------------------------------------
   327*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   328* EFFECTIVE    NUMBER
   329*-----------------------------------------------------------------
   330* 060611    2011022800001  PEMA  NEW COPYBOOK
   331* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   332* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   333******************************************************************
   334****************************************
   335*  commarea for NaperSoft On Demand Admin services letters
   336*  (business logic input & output)
   337****************************************
   338     03  BL-INPUT.
   339         05  BL-DATA-SRCE        PIC X.
   340         05  BL-LETTER-ID        PIC XXXX.
   341         05  BL-CARRIER          PIC X.
   342         05  BL-GROUP            PIC X(6).
   343         05  BL-STATE            PIC XX.
   344         05  BL-ACCOUNT          PIC X(10).
   345         05  BL-EFF-DT           PIC X(10).
   346         05  BL-CERT-NO          PIC X(11).
   347         05  BL-BATCH-NO         PIC X(6).
   348         05  BL-BATCH-SEQ        PIC 9(8).
   349         05  BL-RESP-NO          PIC X(10).
   350         05  BL-NO-OF-COPIES     PIC 99.
   351         05  BL-PROC-ID          PIC XXXX.
   352         05  BL-COMP-ID          PIC XXX.
   353         05  BL-PRINT-NOW-SW     PIC X.
   354         05  BL-ENC-CD           PIC XXX.
   355         05  BL-RESEND-DT        PIC X(10).
   356         05  BL-FOLLOW-UP-DT     PIC X(10).
   357         05  BL-ARCHIVE-NO       PIC 9(8).
   358         05  BL-FUNC             PIC X(8).
   359         05  BL-COMMENTS         PIC X(100).
   360         05  FILLER REDEFINES BL-COMMENTS.
   361             10  BL-REASON-CODE OCCURS 12 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page   8
* NSRASBL.cbl
   362             10  BL-LETTER-TO-ACCT PIC X.
   363             10  BL-LETTER-TO-BENE PIC X.
   364             10  BL-WRITE-ERARCH   PIC X.
   365                 88  ERARCH-QWS      VALUE 'Q'.
   366                 88  ERARCH-BATCH    VALUE 'B'.
   367                 88  ERARCH-TEMP     VALUE 'T'.
   368             10  BL-PROCESS-TYPE PIC X(07).
   369             10  BL-CERT-FORM-ID PIC X(05).
   370             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   371             10  BL-SOURCE-SCREEN PIC X(8).
   372             10  FILLER          PIC X(25).
   373     03  BL-OUTPUT.
   374         05  BL-STATUS                   PIC X.
   375             88  BL-OK                      VALUE "P".
   376             88  BL-FAIL                  VALUE "F".
   377         05  BL-MESSAGE          PIC X(50).
   378     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   379     03  FILLER                  PIC X(31).
   380 01  filler                      pic x(500).
   381 01  WS-SAVE-CARRIER-INFO.
   382     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   383     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   384     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   385     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   386     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   387     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   388     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   389     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   390 01  WS-SAVE-STATE-INFO.
   391     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   392     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   393 01  WS-SAVE-LFBEN-INFO.
   394     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   395     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   396     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   397 01  WS-SAVE-AHBEN-INFO.
   398     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   399     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   400     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   401     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   402 01  WS-ERPNDB-KEY.
   403     05  WS-ERPNDB-COMPANY-CD    PIC X.
   404     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   405     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   406     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   407 01  WS-ELENCC-KEY.
   408     05  WS-ELENCC-COMPANY-CD    PIC X.
   409     05  WS-ELENCC-REC-TYPE      PIC X.
   410     05  WS-ELENCC-ENC-CODE      PIC X(5).
   411     05  F                       PIC X(9).
   412 01  WS-ELCERT-KEY.
   413     05  WS-ELCERT-COMPANY-CD    PIC X.
   414     05  WS-ELCERT-CARRIER       PIC X.
   415     05  WS-ELCERT-GROUP         PIC X(6).
   416     05  WS-ELCERT-STATE         PIC XX.
   417     05  WS-ELCERT-ACCOUNT       PIC X(10).
   418     05  WS-ELCERT-EFF-DT        PIC XX.
   419     05  WS-ELCERT-CERT-NO       PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page   9
* NSRASBL.cbl
   420 01  WS-ELCRTT-KEY.
   421     05  WS-ELCRTT-PRIMARY       PIC X(33).
   422     05  WS-ELCRTT-REC-TYPE      PIC X(1).
   423
   424 01  WS-ERENDT-KEY.
   425     05  WS-ERENDT-COMPANY-CD    PIC X.
   426     05  WS-ERENDT-CARRIER       PIC X.
   427     05  WS-ERENDT-GROUP         PIC X(6).
   428     05  WS-ERENDT-STATE         PIC XX.
   429     05  WS-ERENDT-ACCOUNT       PIC X(10).
   430     05  WS-ERENDT-EFF-DT        PIC XX.
   431     05  WS-ERENDT-CERT-NO       PIC X(11).
   432     05  WS-ERENDT-REC-TYPE      PIC X.
   433     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   434
   435 01  WS-ERENDT-KEY-BY-ARCH.
   436     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   437     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
   438 01  WS-ERCOMP-KEY.
   439     05  WS-ERCOMP-COMPANY-CD    PIC X.
   440     05  WS-ERCOMP-CARRIER       PIC X.
   441     05  WS-ERCOMP-GROUP         PIC X(6).
   442     05  WS-ERCOMP-RESP-NO       PIC X(10).
   443     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   444     05  WS-ERCOMP-REC-TYPE      PIC X.
   445 01  WS-ERMAIL-KEY.
   446     05  WS-ERMAIL-COMPANY-CD    PIC X.
   447     05  WS-ERMAIL-CARRIER       PIC X.
   448     05  WS-ERMAIL-GROUP         PIC X(6).
   449     05  WS-ERMAIL-STATE         PIC XX.
   450     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   451     05  WS-ERMAIL-EFF-DT        PIC XX.
   452     05  WS-ERMAIL-CERT-NO       PIC X(11).
   453 01  WS-ERACCT-KEY.
   454     05  WS-ERACCT-COMPANY-CD    PIC X.
   455     05  WS-ERACCT-CARRIER       PIC X.
   456     05  WS-ERACCT-GROUP         PIC X(6).
   457     05  WS-ERACCT-STATE         PIC XX.
   458     05  WS-ERACCT-ACCOUNT       PIC X(10).
   459     05  WS-ERACCT-EXP-DT        PIC XX.
   460     05  FILLER                  PIC XXXX.
   461 01  WS-ELLETR-KEY.
   462     05  WS-ELLETR-COMPANY-CD    PIC X.
   463     05  WS-ELLETR-LETTER-ID     PIC X(12).
   464     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   465 01  WS-ELCNTL-KEY.
   466     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   467     05  WS-ELCNTL-REC-TYPE      PIC X.
   468     05  WS-ELCNTL-GENL.
   469         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   470         10  WS-ELCNTL-BEN-CD.
   471             15  F               PIC X.
   472             15  WS-ELCNTL-CARR  PIC X.
   473     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   474*                                COPY ELCDATE.
   475******************************************************************
   476*                                                                *
   477*                                                                *
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  10
* NSRASBL.cbl
   478*                            ELCDATE.                            *
   479*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   480*                            VMOD=2.003
   481*                                                                *
   482*                                                                *
   483*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   484*                 LENGTH = 200                                   *
   485******************************************************************
   486
   487 01  DATE-CONVERSION-DATA.
   488     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   489     12  DC-OPTION-CODE                PIC X.
   490         88  BIN-TO-GREG                VALUE ' '.
   491         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   492         88  EDIT-GREG-TO-BIN           VALUE '2'.
   493         88  YMD-GREG-TO-BIN            VALUE '3'.
   494         88  MDY-GREG-TO-BIN            VALUE '4'.
   495         88  JULIAN-TO-BIN              VALUE '5'.
   496         88  BIN-PLUS-ELAPSED           VALUE '6'.
   497         88  FIND-CENTURY               VALUE '7'.
   498         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   499         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   500         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   501         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   502         88  JULIAN-TO-BIN-3            VALUE 'C'.
   503         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   504         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   505         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   506         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   507         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   508         88  CHECK-LEAP-YEAR            VALUE 'H'.
   509         88  BIN-3-TO-GREG              VALUE 'I'.
   510         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   511         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   512         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   513         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   514         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   515         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   516         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   517         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   518         88  THREE-CHARACTER-BIN
   519                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   520         88  GREGORIAN-TO-BIN
   521                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   522         88  BIN-TO-GREGORIAN
   523                  VALUES ' ' '1' 'I' '8' 'G'.
   524         88  JULIAN-TO-BINARY
   525                  VALUES '5' 'C' 'E' 'F'.
   526     12  DC-ERROR-CODE                 PIC X.
   527         88  NO-CONVERSION-ERROR        VALUE ' '.
   528         88  DATE-CONVERSION-ERROR
   529                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   530         88  DATE-IS-ZERO               VALUE '1'.
   531         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   532         88  DATE-IS-INVALID            VALUE '3'.
   533         88  DATE1-GREATER-DATE2        VALUE '4'.
   534         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   535         88  DATE-INVALID-OPTION        VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  11
* NSRASBL.cbl
   536         88  INVALID-CENTURY            VALUE 'A'.
   537         88  ONLY-CENTURY               VALUE 'B'.
   538         88  ONLY-LEAP-YEAR             VALUE 'C'.
   539         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   540     12  DC-END-OF-MONTH               PIC X.
   541         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   542     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   543         88  USE-NORMAL-PROCESS         VALUE ' '.
   544         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   545         88  ADJUST-UP-100-YRS          VALUE '2'.
   546     12  FILLER                        PIC X.
   547     12  DC-CONVERSION-DATES.
   548         16  DC-BIN-DATE-1             PIC XX.
   549         16  DC-BIN-DATE-2             PIC XX.
   550         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   551         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   552                       DC-GREG-DATE-1-EDIT.
   553             20  DC-EDIT1-MONTH        PIC 99.
   554             20  SLASH1-1              PIC X.
   555             20  DC-EDIT1-DAY          PIC 99.
   556             20  SLASH1-2              PIC X.
   557             20  DC-EDIT1-YEAR         PIC 99.
   558         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   559         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   560                     DC-GREG-DATE-2-EDIT.
   561             20  DC-EDIT2-MONTH        PIC 99.
   562             20  SLASH2-1              PIC X.
   563             20  DC-EDIT2-DAY          PIC 99.
   564             20  SLASH2-2              PIC X.
   565             20  DC-EDIT2-YEAR         PIC 99.
   566         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   567         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   568                     DC-GREG-DATE-1-YMD.
   569             20  DC-YMD-YEAR           PIC 99.
   570             20  DC-YMD-MONTH          PIC 99.
   571             20  DC-YMD-DAY            PIC 99.
   572         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   573         16  DC-GREG-DATE-1-MDY-R REDEFINES
   574                      DC-GREG-DATE-1-MDY.
   575             20  DC-MDY-MONTH          PIC 99.
   576             20  DC-MDY-DAY            PIC 99.
   577             20  DC-MDY-YEAR           PIC 99.
   578         16  DC-GREG-DATE-1-ALPHA.
   579             20  DC-ALPHA-MONTH        PIC X(10).
   580             20  DC-ALPHA-DAY          PIC 99.
   581             20  FILLER                PIC XX.
   582             20  DC-ALPHA-CENTURY.
   583                 24 DC-ALPHA-CEN-N     PIC 99.
   584             20  DC-ALPHA-YEAR         PIC 99.
   585         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   586         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   587         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   588         16  DC-JULIAN-DATE            PIC 9(05).
   589         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   590                                       PIC 9(05).
   591         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   592             20  DC-JULIAN-YEAR        PIC 99.
   593             20  DC-JULIAN-DAYS        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  12
* NSRASBL.cbl
   594         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   595         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   596         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   597     12  DATE-CONVERSION-VARIBLES.
   598         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   599         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   600             20  FILLER                PIC 9(3).
   601             20  HOLD-CEN-1-CCYY.
   602                 24  HOLD-CEN-1-CC     PIC 99.
   603                 24  HOLD-CEN-1-YY     PIC 99.
   604             20  HOLD-CEN-1-MO         PIC 99.
   605             20  HOLD-CEN-1-DA         PIC 99.
   606         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   607             20  HOLD-CEN-1-R-MO       PIC 99.
   608             20  HOLD-CEN-1-R-DA       PIC 99.
   609             20  HOLD-CEN-1-R-CCYY.
   610                 24  HOLD-CEN-1-R-CC   PIC 99.
   611                 24  HOLD-CEN-1-R-YY   PIC 99.
   612             20  FILLER                PIC 9(3).
   613         16  HOLD-CENTURY-1-X.
   614             20  FILLER                PIC X(3)  VALUE SPACES.
   615             20  HOLD-CEN-1-X-CCYY.
   616                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   617                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   618             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   619             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   620         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   621             20  HOLD-CEN-1-R-X-MO     PIC XX.
   622             20  HOLD-CEN-1-R-X-DA     PIC XX.
   623             20  HOLD-CEN-1-R-X-CCYY.
   624                 24  HOLD-CEN-1-R-X-CC PIC XX.
   625                 24  HOLD-CEN-1-R-X-YY PIC XX.
   626             20  FILLER                PIC XXX.
   627         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   628         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   629         16  DC-JULIAN-DATE-1          PIC 9(07).
   630         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   631             20  DC-JULIAN-1-CCYY.
   632                 24  DC-JULIAN-1-CC    PIC 99.
   633                 24  DC-JULIAN-1-YR    PIC 99.
   634             20  DC-JULIAN-DA-1        PIC 999.
   635         16  DC-JULIAN-DATE-2          PIC 9(07).
   636         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   637             20  DC-JULIAN-2-CCYY.
   638                 24  DC-JULIAN-2-CC    PIC 99.
   639                 24  DC-JULIAN-2-YR    PIC 99.
   640             20  DC-JULIAN-DA-2        PIC 999.
   641         16  DC-GREG-DATE-A-EDIT.
   642             20  DC-EDITA-MONTH        PIC 99.
   643             20  SLASHA-1              PIC X VALUE '/'.
   644             20  DC-EDITA-DAY          PIC 99.
   645             20  SLASHA-2              PIC X VALUE '/'.
   646             20  DC-EDITA-CCYY.
   647                 24  DC-EDITA-CENT     PIC 99.
   648                 24  DC-EDITA-YEAR     PIC 99.
   649         16  DC-GREG-DATE-B-EDIT.
   650             20  DC-EDITB-MONTH        PIC 99.
   651             20  SLASHB-1              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  13
* NSRASBL.cbl
   652             20  DC-EDITB-DAY          PIC 99.
   653             20  SLASHB-2              PIC X VALUE '/'.
   654             20  DC-EDITB-CCYY.
   655                 24  DC-EDITB-CENT     PIC 99.
   656                 24  DC-EDITB-YEAR     PIC 99.
   657         16  DC-GREG-DATE-CYMD         PIC 9(08).
   658         16  DC-GREG-DATE-CYMD-R REDEFINES
   659                              DC-GREG-DATE-CYMD.
   660             20  DC-CYMD-CEN           PIC 99.
   661             20  DC-CYMD-YEAR          PIC 99.
   662             20  DC-CYMD-MONTH         PIC 99.
   663             20  DC-CYMD-DAY           PIC 99.
   664         16  DC-GREG-DATE-MDCY         PIC 9(08).
   665         16  DC-GREG-DATE-MDCY-R REDEFINES
   666                              DC-GREG-DATE-MDCY.
   667             20  DC-MDCY-MONTH         PIC 99.
   668             20  DC-MDCY-DAY           PIC 99.
   669             20  DC-MDCY-CEN           PIC 99.
   670             20  DC-MDCY-YEAR          PIC 99.
   671    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   672        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   673    12  DC-EL310-DATE                  PIC X(21).
   674    12  FILLER                         PIC X(28).
   675*                                COPY NSCASEXTR.
   676******************************************************************
   677*                                                                *
   678*                                                                *
   679*                            NSCASEXTR.                          *
   680*                            VMOD=2.001                          *
   681*                                                                *
   682*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   683*                                                                *
   684*   FILE TYPE = VSAM,KSDS                                        *
   685*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   686*                                                                *
   687*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   688*                                                                *
   689*   LOG = NO                                                     *
   690*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   691******************************************************************
   692*-----------------------------------------------------------------
   693*                   C H A N G E   L O G
   694*
   695* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   696*-----------------------------------------------------------------
   697*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   698* EFFECTIVE    NUMBER
   699*-----------------------------------------------------------------
   700* 072211    2011022800001  PEMA  NEW FILE
   701*-----------------------------------------------------------------
   702 01 NSAS-EXTRACT-RECORD.
   703    05  NSAS-CONTROL-PRIMARY.
   704        10  NSAS-COMPANY-CD      PIC X.
   705        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   706        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   707    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   708    05  FILLER                   PIC X(143).
   709*                                COPY ERCPNDB.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  14
* NSRASBL.cbl
   710******************************************************************
   711*                                                                *
   712*                                                                *
   713*                            ERCPNDB.                            *
   714*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   715*                            VMOD=2.025                          *
   716*                                                                *
   717*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   718*                                                                *
   719******************************************************************
   720*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   721*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   722******************************************************************
   723*                                                                *
   724*                                                                *
   725*   FILE TYPE = VSAM,KSDS                                        *
   726*   RECORD SIZE = 585  RECFORM = FIXED                           *
   727*                                                                *
   728*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   729*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   730*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   731*                                                 RKP=13,LEN=36  *
   732*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   733*                                      AND CHG-SEQ.)             *
   734*                                                RKP=49,LEN=11   *
   735*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   736*                                      AND CHG-SEQ.)             *
   737*                                                RKP=60,LEN=15   *
   738*                                                                *
   739*   LOG = NO                                                     *
   740*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   741******************************************************************
   742******************************************************************
   743*                   C H A N G E   L O G
   744*
   745* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   746*-----------------------------------------------------------------
   747*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   748* EFFECTIVE    NUMBER
   749*-----------------------------------------------------------------
   750* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   751* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   752* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   753* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   754* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   755* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   756* 032306                   PEMA  ADD BOW LOAN NUMBER
   757* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   758* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   759* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   760* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   761* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   762* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   763* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   764* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   765******************************************************************
   766
   767 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  15
* NSRASBL.cbl
   768     12  PB-RECORD-ID                     PIC XX.
   769         88  VALID-PB-ID                        VALUE 'PB'.
   770
   771     12  PB-CONTROL-PRIMARY.
   772         16  PB-COMPANY-CD                PIC X.
   773         16  PB-ENTRY-BATCH               PIC X(6).
   774         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   775         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   776
   777     12  PB-CONTROL-BY-ACCOUNT.
   778         16  PB-COMPANY-CD-A1             PIC X.
   779         16  PB-CARRIER                   PIC X.
   780         16  PB-GROUPING.
   781             20  PB-GROUPING-PREFIX       PIC XXX.
   782             20  PB-GROUPING-PRIME        PIC XXX.
   783         16  PB-STATE                     PIC XX.
   784         16  PB-ACCOUNT.
   785             20  PB-ACCOUNT-PREFIX        PIC X(4).
   786             20  PB-ACCOUNT-PRIME         PIC X(6).
   787         16  PB-CERT-EFF-DT               PIC XX.
   788         16  PB-CERT-NO.
   789             20  PB-CERT-PRIME            PIC X(10).
   790             20  PB-CERT-SFX              PIC X.
   791         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   792
   793         16  PB-RECORD-TYPE               PIC X.
   794             88  PB-MAILING-DATA                VALUE '0'.
   795             88  PB-ISSUE                       VALUE '1'.
   796             88  PB-CANCELLATION                VALUE '2'.
   797             88  PB-BATCH-TRAILER               VALUE '9'.
   798
   799     12  PB-CONTROL-BY-ORIG-BATCH.
   800         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   801         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   802         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   803         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   804
   805     12  PB-CONTROL-BY-CSR.
   806         16  PB-CSR-COMPANY-CD            PIC X.
   807         16  PB-CSR-ID                    PIC X(4).
   808         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   809         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   810         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   811******************************************************************
   812*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   813******************************************************************
   814
   815     12  PB-LAST-MAINT-DT                 PIC XX.
   816     12  PB-LAST-MAINT-BY                 PIC X(4).
   817     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   818
   819     12  PB-RECORD-BODY                   PIC X(375).
   820
   821     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   822         16  PB-CERT-ORIGIN               PIC X.
   823             88  CLASIC-CREATED-CERT         VALUE '1'.
   824         16  PB-I-NAME.
   825             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  16
* NSRASBL.cbl
   826             20  PB-I-INSURED-FIRST-NAME.
   827                 24  PB-I-INSURED-1ST-INIT PIC X.
   828                 24  FILLER                PIC X(9).
   829             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   830         16  PB-I-AGE                     PIC S99   COMP-3.
   831         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   832         16  PB-I-BIRTHDAY                PIC XX.
   833         16  PB-I-INSURED-SEX             PIC X.
   834             88  PB-SEX-MALE     VALUE 'M'.
   835             88  PB-SEX-FEMALE   VALUE 'F'.
   836
   837         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   838         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   839         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   840         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   841         16  PB-I-SKIP-CODE               PIC X.
   842             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   843             88  PB-SKIP-JULY              VALUE '1'.
   844             88  PB-SKIP-AUGUST            VALUE '2'.
   845             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   846             88  PB-SKIP-JULY-AUG          VALUE '4'.
   847             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   848             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   849             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   850             88  PB-SKIP-JUNE              VALUE '8'.
   851             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   852             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   853             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   854         16  PB-I-TERM-TYPE               PIC X.
   855             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   856             88  PB-PAID-WEEKLY            VALUE 'W'.
   857             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   858             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   859             88  PB-PAID-13-YEARLY         VALUE 'T'.
   860         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   861         16  PB-I-POLICY-FORM-NO          PIC X(12).
   862         16  PB-I-DATA-ENTRY-SW           PIC X.
   863             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   864             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   865             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   866             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   867         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   868         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   869*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   870         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   871         16  FILLER                       PIC X.
   872
   873         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   874             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   875             88  PB-INVALID-LIFE             VALUE '  ' '00'
   876                                                   '90' THRU '99'.
   877         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   878                                          PIC XX.
   879         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   880         16  PB-I-AMOUNT-FINANCED REDEFINES
   881                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   882         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   883         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  17
* NSRASBL.cbl
   884                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   885         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   886         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   887         16  PB-I-CLP-AMOUNT REDEFINES
   888                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   889         16  PB-I-LF-CALC-FLAG            PIC X.
   890             88 PB-COMP-LF-PREM               VALUE '?'.
   891         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   892         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   893         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   894         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   895         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   896         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   897         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   898         16  PB-I-LF-ABBR                 PIC XXX.
   899         16  PB-I-LF-INPUT-CD             PIC XX.
   900
   901         16  PB-I-AH-BENEFIT-CD           PIC XX.
   902             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   903             88  PB-INVALID-AH               VALUE '  ' '00'
   904                                                   '90' THRU '99'.
   905         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   906         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   907         16  PB-I-AH-CALC-FLAG            PIC X.
   908             88 PB-COMP-AH-PREM                  VALUE '?'.
   909         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   910         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   911         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   912         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   913         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   914         16  PB-I-AH-ABBR                 PIC XXX.
   915         16  PB-I-AH-INPUT-CD             PIC XXX.
   916
   917         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   918         16  PB-I-REIN-TABLE              PIC XXX.
   919         16  PB-I-BUSINESS-TYPE           PIC 99.
   920         16  PB-I-INDV-GRP-CD             PIC X.
   921         16  PB-I-MORT-CODE.
   922             20  PB-I-TABLE               PIC X.
   923             20  PB-I-INTEREST            PIC XX.
   924             20  PB-I-MORT-TYP            PIC X.
   925         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   926         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   927         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   928         16  PB-I-INDV-GRP-OVRD           PIC X.
   929         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   930         16  PB-I-SIG-SW                  PIC X.
   931             88  PB-POLICY-SIGNED             VALUE 'Y'.
   932         16  PB-I-RATE-CLASS              PIC XX.
   933         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   934         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   935         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   936         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   937         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   938         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   939         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   940         16  PB-I-BENEFIT-TYPE            PIC XXX.
   941         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  18
* NSRASBL.cbl
   942             88  PB-I-OB                      VALUE 'B'.
   943             88  PB-I-SUMMARY                 VALUE 'Z'.
   944         16  PB-I-ENTRY-STATUS            PIC X.
   945             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   946                                              'M' '5' '9' '2'.
   947             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   948             88  PB-I-POLICY-PENDING          VALUE '2'.
   949             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   950             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   951             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   952             88  PB-I-REIN-ONLY               VALUE '9'.
   953             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   954             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   955             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   956             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   957         16  PB-I-INT-CODE                PIC X.
   958             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   959             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   960         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   961         16  PB-I-SOC-SEC-NO              PIC X(11).
   962         16  PB-I-MEMBER-NO               PIC X(12).
   963         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   964*        16  PB-I-LOAN-OFFICER            PIC XXX.
   965         16  PB-I-OLD-LOF                 PIC XXX.
   966         16  PB-I-LF-EXPIRE-DT            PIC XX.
   967         16  PB-I-AH-EXPIRE-DT            PIC XX.
   968         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   969         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   970         16  PB-I-LIFE-INDICATOR          PIC X.
   971             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   972         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   973         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   974                                          PIC S9(5)V99    COMP-3.
   975         16  PB-I-MAIL-ADDRS-SW           PIC X.
   976             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   977             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   978         16  PB-I-1ST-PMT-DT              PIC XX.
   979         16  PB-I-JOINT-INSURED.
   980             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   981             20 PB-I-JOINT-FIRST-NAME.
   982                24  PB-I-JOINT-FIRST-INIT PIC X.
   983                24  FILLER                PIC X(9).
   984             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   985*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   986         16  PB-I-BENEFICIARY-NAME.
   987             20  PB-I-BANK-NUMBER         PIC X(10).
   988             20  FILLER                   PIC X(15).
   989         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   990         16  PB-I-REFERENCE               PIC X(12).
   991         16  FILLER REDEFINES PB-I-REFERENCE.
   992             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   993             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   994             20  PB-I-CLP-STATE           PIC XX.
   995         16  PB-I-UNDERWRITING-STATUS     PIC X.
   996             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   997             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   998             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   999         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  19
* NSRASBL.cbl
  1000         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  1001         16  PB-I-RESIDENT-STATE          PIC XX.
  1002         16  PB-I-RATE-CODE               PIC X(4).
  1003         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1004         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1005         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1006         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1007         16  PB-I-BANK-NOCHRGB            PIC 99.
  1008         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1009         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1010
  1011     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1012         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1013             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1014         16  PB-C-CANCEL-ORIGIN           PIC X.
  1015             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1016         16  PB-C-LF-CANCEL-DT            PIC XX.
  1017         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1018         16  PB-C-LF-CALC-REQ             PIC X.
  1019             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1020         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1021         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1022         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1023             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1024         16  PB-C-AH-CANCEL-DT            PIC XX.
  1025         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1026         16  PB-C-AH-CALC-REQ             PIC X.
  1027             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1028         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1029         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1030         16  PB-C-LAST-NAME               PIC X(15).
  1031         16  PB-C-REFUND-SW               PIC X.
  1032             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1033             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1034         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1035         16  PB-C-PAYEE-CODE              PIC X(6).
  1036         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1037         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1038         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1039         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1040         16  PB-C-REFERENCE               PIC X(12).
  1041         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1042         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1043         16  PB-C-POST-CARD-IND           PIC X.
  1044         16  PB-C-CANCEL-REASON           PIC X.
  1045         16  PB-C-REF-INTERFACE-SW        PIC X.
  1046         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1047         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1048         16  FILLER                       PIC X(01).
  1049*        16  FILLER                       PIC X(18).
  1050         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1051*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1052         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1053         16  PB-CANCELED-CERT-DATA.
  1054             20  PB-CI-INSURED-NAME.
  1055                 24  PB-CI-LAST-NAME      PIC X(15).
  1056                 24  PB-CI-INITIALS       PIC XX.
  1057             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  20
* NSRASBL.cbl
  1058             20  PB-CI-INSURED-SEX        PIC X.
  1059             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1060             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1061             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1062             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1063             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1064             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1065             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1066             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1067             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1068             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1069             20  PB-CI-RATE-CLASS         PIC XX.
  1070             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1071             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1072             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1073             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1074             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1075             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1076             20  PB-CI-LF-ABBR            PIC X(3).
  1077             20  PB-CI-AH-ABBR            PIC X(3).
  1078             20  PB-CI-OB-FLAG            PIC X.
  1079                 88  PB-CI-OB                VALUE 'B'.
  1080             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1081                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1082                                           'M' '4' '5' '9' '2'.
  1083                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1084                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1085                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1086                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1087                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1088                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1089                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1090                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1091                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1092                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1093                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1094                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1095             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1096                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1097                                           'M' '4' '5' '9' '2'.
  1098                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1099                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1100                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1101                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1102                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1103                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1104                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1105                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1106                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1107                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1108                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1109                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1110             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1111             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1112             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1113             20  PB-CI-MEMBER-NO          PIC X(12).
  1114             20  PB-CI-INT-CODE           PIC X.
  1115                 88  PB-CI-ADD-ON                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  21
* NSRASBL.cbl
  1116                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1117             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1118             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1119             20  PB-CI-COMP-EXCP-SW       PIC X.
  1120                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1121                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1122             20  PB-CI-ENTRY-STATUS       PIC X.
  1123             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1124             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1125             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1126             20  PB-CI-DEATH-DT           PIC XX.
  1127             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1128             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1129             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1130             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1131             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1132             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1133             20  PB-CI-ENTRY-DT              PIC XX.
  1134             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1135             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1136             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1137             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1138             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1139             20  PB-CI-OLD-LOF               PIC XXX.
  1140*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1141             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1142             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1143             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1144             20  PB-CI-INDV-GRP-CD           PIC X.
  1145             20  PB-CI-BENEFICIARY-NAME.
  1146                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1147                 24  FILLER                  PIC X(15).
  1148             20  PB-CI-NOTE-SW               PIC X.
  1149             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1150             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1151             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1152             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1153             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1154             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1155             20  PB-CI-FIRST-NAME            PIC X(10).
  1156             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1157
  1158         16  FILLER                       PIC X(13).
  1159*032306  16  FILLER                       PIC X(27).
  1160*        16  FILLER                       PIC X(46).
  1161
  1162     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1163         16  FILLER                       PIC X(10).
  1164         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1165         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1166         16  PB-M-INSURED-MID-INIT        PIC X.
  1167         16  PB-M-INSURED-AGE             PIC 99.
  1168         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1169         16  PB-M-INSURED-SEX             PIC X.
  1170         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1171         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1172         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1173         16  PB-M-INSURED-CITY-STATE.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  22
* NSRASBL.cbl
  1174             20  PB-M-INSURED-CITY        PIC X(28).
  1175             20  PB-M-INSURED-STATE       PIC XX.
  1176         16  PB-M-INSURED-ZIP-CODE.
  1177             20  PB-M-INSURED-ZIP-PRIME.
  1178                 24  PB-M-INSURED-ZIP-1   PIC X.
  1179                     88  PB-M-CANADIAN-POST-CODE
  1180                                             VALUE 'A' THRU 'Z'.
  1181                 24  FILLER               PIC X(4).
  1182             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1183         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1184                                        PB-M-INSURED-ZIP-CODE.
  1185             20  PM-M-INS-CAN-POST1       PIC XXX.
  1186             20  PM-M-INS-CAN-POST2       PIC XXX.
  1187             20  FILLER                   PIC XXX.
  1188         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1189         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1190         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1191         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1192         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1193         16  PB-M-CRED-BENE-CITYST.
  1194             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1195             20  PB-M-CRED-BENE-STATE     PIC XX.
  1196         16  FILLER                       PIC X(92).
  1197
  1198     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1199         16  FILLER                       PIC X(10).
  1200         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1201         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1202         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1203         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1204         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1205         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1206         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1207         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1208         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1209         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1210         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1211         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1212         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1213         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1214         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1215         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1216         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1217         16  PB-ACCOUNT-NAME              PIC X(30).
  1218         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1219         16  PB-REFERENCE                 PIC X(12).
  1220         16  PB-B-RECEIVED-DT             PIC XX.
  1221         16  FILLER                       PIC X(234).
  1222
  1223     12  PB-RECORD-STATUS.
  1224         16  PB-CREDIT-SELECT-DT          PIC XX.
  1225         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1226         16  PB-BILLED-DT                 PIC XX.
  1227         16  PB-BILLING-STATUS            PIC X.
  1228             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1229             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1230             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1231         16  PB-RECORD-BILL               PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  23
* NSRASBL.cbl
  1232             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1233             88  PB-RECORD-RETURNED           VALUE 'R'.
  1234             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1235             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1236             88  PB-OVERRIDE-AH               VALUE 'A'.
  1237             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1238         16  PB-BATCH-ENTRY               PIC X.
  1239             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1240             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1241             88  PB-REISSUED-CERT             VALUE 'E'.
  1242             88  PB-MONTHLY-CERT              VALUE 'M'.
  1243             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1244             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1245             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1246         16  PB-FORCE-CODE                PIC X.
  1247             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1248             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1249             88  PB-CANCEL-FORCE              VALUE '8'.
  1250             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1251             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1252             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1253             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1254             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1255             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1256             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1257         16  PB-FATAL-FLAG                PIC X.
  1258             88  PB-FATAL-ERRORS              VALUE 'X'.
  1259         16  PB-FORCE-ER-CD               PIC X.
  1260             88  PB-FORCE-ERRORS              VALUE 'F'.
  1261             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1262         16  PB-WARN-ER-CD                PIC X.
  1263             88  PB-WARNING-ERRORS            VALUE 'W'.
  1264         16  FILLER                       PIC X.
  1265         16  PB-OUT-BAL-CD                PIC X.
  1266             88  PB-OUT-OF-BAL                VALUE 'O'.
  1267         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1268         16  PB-AH-OVERRIDE-L1            PIC X.
  1269         16  PB-INPUT-DT                  PIC XX.
  1270         16  PB-INPUT-BY                  PIC X(4).
  1271         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1272         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1273         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1274         16  PB-LF-EARNING-METHOD         PIC X.
  1275         16  PB-AH-EARNING-METHOD         PIC X.
  1276         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1277         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1278         16  PB-REIN-CD                   PIC XXX.
  1279         16  PB-LF-REFUND-TYPE            PIC X.
  1280         16  PB-AH-REFUND-TYPE            PIC X.
  1281         16  PB-ACCT-EFF-DT               PIC XX.
  1282         16  PB-ACCT-EXP-DT               PIC XX.
  1283         16  PB-COMPANY-ID                PIC X(3).
  1284         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1285         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1286         16  PB-SV-CARRIER                PIC X.
  1287         16  PB-SV-GROUPING               PIC X(6).
  1288         16  PB-SV-STATE                  PIC XX.
  1289         16  PB-CONFIRMATION-REPT-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  24
* NSRASBL.cbl
  1290         16  PB-GA-BILLING-INFO.
  1291             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1292                                          PIC XX.
  1293         16  PB-SV-REMIT-TO  REDEFINES
  1294             PB-GA-BILLING-INFO           PIC X(10).
  1295         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1296         16  PB-I-LOAN-OFFICER            PIC X(5).
  1297         16  PB-I-VIN                     PIC X(17).
  1298
  1299         16  FILLER                       PIC X(04).
  1300         16  IMNET-BYPASS-SW              PIC X.
  1301
  1302******************************************************************
  1303*                COMMON EDIT ERRORS                              *
  1304******************************************************************
  1305
  1306     12  PB-COMMON-ERRORS.
  1307         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1308                                           PIC S9(4)     COMP.
  1309
  1310******************************************************************
  1311*                                COPY ERCENDT.
  1312******************************************************************
  1313*                                                                *
  1314*                                                                *
  1315*                            ERCENDT.                            *
  1316*                            VMOD=2.001                          *
  1317*                                                                *
  1318*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1319*                                                                *
  1320*   FILE TYPE = VSAM,KSDS                                        *
  1321*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1322*                                                                *
  1323*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1324*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1325*                                                                *
  1326*   LOG = NO                                                     *
  1327*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1328******************************************************************
  1329*-----------------------------------------------------------------
  1330*                   C H A N G E   L O G
  1331*
  1332* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1333*-----------------------------------------------------------------
  1334*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1335* EFFECTIVE    NUMBER
  1336*-----------------------------------------------------------------
  1337* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1338*                                WITH OPEN CLAIMS
  1339* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1340* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1341* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1342*-----------------------------------------------------------------
  1343 01  ENDORSEMENT-RECORD.
  1344     12  EN-RECORD-ID                PIC XX.
  1345         88  VALID-EN-ID                VALUE 'EN'.
  1346     12  EN-CONTROL-PRIMARY.
  1347         16  EN-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  25
* NSRASBL.cbl
  1348         16  EN-CARRIER              PIC X.
  1349         16  EN-GROUPING             PIC X(6).
  1350         16  EN-STATE                PIC XX.
  1351         16  EN-ACCOUNT              PIC X(10).
  1352         16  EN-CERT-EFF-DT          PIC XX.
  1353         16  EN-CERT-NO.
  1354             20  EN-CERT-PRIME       PIC X(10).
  1355             20  EN-CERT-SFX         PIC X.
  1356         16  EN-REC-TYPE             PIC X.
  1357             88  EN-ISSUE               VALUE 'I'.
  1358             88  EN-CANCELLATION        VALUE 'C'.
  1359         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1360     12  EN-CONTROL-BY-ARCH-NO.
  1361         16  EN-COMPANY-CD-A1              PIC X.
  1362         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1363     12  EN-LAST-MAINT-DT            PIC XX.
  1364     12  EN-LAST-MAINT-BY            PIC X(4).
  1365     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1366     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1367     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1368         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1369         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1370         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1371         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1372         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1373         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1374         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1375         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1376         16  EN-LF-ORIG-BENCD        PIC XX.
  1377         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1378         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1379         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1380         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1381         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1382         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1383*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1384         16  EN-ORIG-CRED-BENE       PIC X(25).
  1385         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1386         16  FILLER                  PIC X.
  1387         16  EN-AH-ORIG-BENCD        PIC XX.
  1388         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1389         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1390         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1391         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1392*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1393*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1394         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1395         16  F                       PIC X(09).
  1396         16  EN-AH-ORIG-CP           PIC 99.
  1397         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1398         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1399         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1400         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1401         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1402         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1403         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1404         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1405         16  EN-LF-NEW-BENCD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  26
* NSRASBL.cbl
  1406         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1407         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1408         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1409         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1410         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1411         16  EN-LF-NEW-EXP-DT        PIC XX.
  1412         16  EN-NEW-CRED-BENE        PIC X(25).
  1413         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1414         16  FILLER                  PIC X.
  1415         16  EN-AH-NEW-BENCD         PIC XX.
  1416         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1417         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1418         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1419         16  EN-AH-NEW-EXP-DT        PIC XX.
  1420*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1421*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1422*        16  F                       PIC X(12).
  1423         16  EN-AH-NEW-CP            PIC 99.
  1424         16  EN-SIG-SW               PIC X.
  1425         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1426         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1427         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1428         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1429         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1430         16  FILLER                  PIC X(33).
  1431     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1432         16  EN-LF-ORIG-REF-DT       PIC XX.
  1433         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1434         16  EN-AH-ORIG-REF-DT       PIC XX.
  1435         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1436         16  EN-LF-NEW-REF-DT        PIC XX.
  1437         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1438         16  EN-AH-NEW-REF-DT        PIC XX.
  1439         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1440         16  EN-FLAG-CERT            PIC X.
  1441         16  EN-INS-LAST-NAME        PIC X(15).
  1442         16  EN-INS-FIRST-NAME       PIC X(10).
  1443         16  EN-INS-MIDDLE-INIT      PIC X.
  1444         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1445         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1446         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1447         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1448         16  FILLER                  PIC X(262).
  1449     12  EN-MONEY-SW             PIC X.
  1450     12  EN-HEALTH-APP           PIC X.
  1451     12  EN-VOUCHER-SW           PIC X.
  1452     12  EN-PAYEE                PIC X(14).
  1453     12  EN-INPUT-DT             PIC XX.
  1454     12  EN-PROCESS-DT           PIC XX.
  1455     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1456     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1457     12  EN-REASON-CODES.
  1458         16  F OCCURS 12.
  1459             20  EN-REASON-CODE  PIC X(4).
  1460     12  EN-TEMPLATE-USED        PIC X(8).
  1461     12  EN-DOCU-TYPE            PIC X.
  1462         88  EN-VERI-DOCU          VALUE 'V'.
  1463         88  EN-GCE-DOCU           VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  27
* NSRASBL.cbl
  1464         88  EN-CANC-DOCU          VALUE 'C'.
  1465     12  EN-COMMENTS1            PIC X(13).
  1466     12  EN-COMMENTS2            PIC X(70).
  1467     12  EN-COMM-CHGBK           PIC X.
  1468         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1469         88  EN-CHG-ACCT           VALUE 'Y'.
  1470     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1471     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1472     12  EN-BATCH-NUMBER         PIC X(6).
  1473     12  EN-ACCT-SUMM            PIC X.
  1474     12  EN-CSO-SUMM             PIC X.
  1475     12  FILLER                  PIC X(13).
  1476******************************************************************
  1477*                                COPY ERCMAIL.
  1478******************************************************************
  1479*                                                                *
  1480*                                                                *
  1481*                            ERCMAIL                             *
  1482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1483*                            VMOD=2.003                          *
  1484*                                                                *
  1485*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1486*                                                                *
  1487*   FILE TYPE = VSAM,KSDS                                        *
  1488*   RECORD SIZE = 374   RECFORM = FIX                            *
  1489*                                                                *
  1490*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1491*   ALTERNATE PATH    = NOT USED                                 *
  1492*                                                                *
  1493*   LOG = YES                                                    *
  1494*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1495******************************************************************
  1496*                   C H A N G E   L O G
  1497*
  1498* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1499*-----------------------------------------------------------------
  1500*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1501* EFFECTIVE    NUMBER
  1502*-----------------------------------------------------------------
  1503* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1504* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1505* 111108                   PEMA  ADD CRED BENE ADDR2
  1506******************************************************************
  1507
  1508 01  MAILING-DATA.
  1509     12  MA-RECORD-ID                      PIC XX.
  1510         88  VALID-MA-ID                       VALUE 'MA'.
  1511
  1512     12  MA-CONTROL-PRIMARY.
  1513         16  MA-COMPANY-CD                 PIC X.
  1514         16  MA-CARRIER                    PIC X.
  1515         16  MA-GROUPING.
  1516             20  MA-GROUPING-PREFIX        PIC XXX.
  1517             20  MA-GROUPING-PRIME         PIC XXX.
  1518         16  MA-STATE                      PIC XX.
  1519         16  MA-ACCOUNT.
  1520             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1521             20  MA-ACCOUNT-PRIME          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  28
* NSRASBL.cbl
  1522         16  MA-CERT-EFF-DT                PIC XX.
  1523         16  MA-CERT-NO.
  1524             20  MA-CERT-PRIME             PIC X(10).
  1525             20  MA-CERT-SFX               PIC X.
  1526
  1527     12  FILLER                            PIC XX.
  1528
  1529     12  MA-ACCESS-CONTROL.
  1530         16  MA-SOURCE-SYSTEM              PIC XX.
  1531             88  MA-FROM-CREDIT                VALUE 'CR'.
  1532             88  MA-FROM-VSI                   VALUE 'VS'.
  1533             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1534             88  MA-FROM-OTHER                 VALUE 'OT'.
  1535         16  MA-RECORD-ADD-DT              PIC XX.
  1536         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1537         16  MA-LAST-MAINT-DT              PIC XX.
  1538         16  MA-LAST-MAINT-BY              PIC XXXX.
  1539         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1540
  1541     12  MA-PROFILE-INFO.
  1542         16  MA-QUALIFY-CODE-1             PIC XX.
  1543         16  MA-QUALIFY-CODE-2             PIC XX.
  1544         16  MA-QUALIFY-CODE-3             PIC XX.
  1545         16  MA-QUALIFY-CODE-4             PIC XX.
  1546         16  MA-QUALIFY-CODE-5             PIC XX.
  1547
  1548         16  MA-INSURED-LAST-NAME          PIC X(15).
  1549         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1550         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1551         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1552         16  MA-INSURED-BIRTH-DT           PIC XX.
  1553         16  MA-INSURED-SEX                PIC X.
  1554             88  MA-SEX-MALE                   VALUE 'M'.
  1555             88  MA-SEX-FEMALE                 VALUE 'F'.
  1556         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1557
  1558         16  MA-ADDRESS-CORRECTED          PIC X.
  1559         16  MA-JOINT-BIRTH-DT             PIC XX.
  1560*        16  FILLER                        PIC X(12).
  1561
  1562         16  MA-ADDRESS-LINE-1             PIC X(30).
  1563         16  MA-ADDRESS-LINE-2             PIC X(30).
  1564         16  MA-CITY-STATE.
  1565             20  MA-CITY                   PIC X(28).
  1566             20  MA-ADDR-STATE             PIC XX.
  1567         16  MA-ZIP.
  1568             20  MA-ZIP-CODE.
  1569                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1570                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1571                 24  FILLER                PIC X(4).
  1572             20  MA-ZIP-PLUS4              PIC X(4).
  1573         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1574             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1575             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1576             20  FILLER                    PIC X(3).
  1577
  1578         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1579
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  29
* NSRASBL.cbl
  1580         16  FILLER                        PIC XXX.
  1581*        16  FILLER                        PIC X(10).
  1582
  1583     12  MA-CRED-BENE-INFO.
  1584         16  MA-CRED-BENE-NAME                 PIC X(25).
  1585         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1586         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1587         16  MA-CRED-BENE-CTYST.
  1588             20  MA-CRED-BENE-CITY             PIC X(28).
  1589             20  MA-CRED-BENE-STATE            PIC XX.
  1590         16  MA-CRED-BENE-ZIP.
  1591             20  MA-CB-ZIP-CODE.
  1592                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1593                     88  MA-CB-CANADIAN-POST-CODE
  1594                                           VALUE 'A' THRU 'Z'.
  1595                 24  FILLER                    PIC X(4).
  1596             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1597         16  MA-CB-CANADIAN-POSTAL-CODE
  1598                            REDEFINES MA-CRED-BENE-ZIP.
  1599             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1600             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1601             20  FILLER                        PIC X(3).
  1602     12  MA-POST-CARD-MAIL-DATA.
  1603         16  MA-MAIL-DATA OCCURS 7.
  1604             20  MA-MAIL-TYPE              PIC X.
  1605                 88  MA-12MO-MAILING           VALUE '1'.
  1606                 88  MA-EXP-MAILING            VALUE '2'.
  1607             20  MA-MAIL-STATUS            PIC X.
  1608                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1609                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1610                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1611             20  MA-MAIL-DATE              PIC XX.
  1612     12  FILLER                            PIC XX.
  1613     12  FILLER                            PIC XX.
  1614*    12  FILLER                            PIC X(30).
  1615******************************************************************
  1616*                                COPY ERCCOMP.
  1617******************************************************************
  1618*                                                                *
  1619*                                                                *
  1620*                            ERCCOMP                             *
  1621*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1622*                            VMOD=2.019                          *
  1623*                                                                *
  1624*   ONLINE CREDIT SYSTEM                                         *
  1625*                                                                *
  1626*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1627*                                                                *
  1628*   FILE TYPE = VSAM,KSDS                                        *
  1629*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1630*                                                                *
  1631*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1632*       ALTERNATE PATH = NONE                                    *
  1633*                                                                *
  1634*   LOG = NO                                                     *
  1635*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1636*                                                                *
  1637******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  30
* NSRASBL.cbl
  1638*                   C H A N G E   L O G
  1639*
  1640* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1641*-----------------------------------------------------------------
  1642*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1643* EFFECTIVE    NUMBER
  1644*-----------------------------------------------------------------
  1645* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1646* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1647* 092205    2005050300006  PEMA  ADD LEASE FEE
  1648* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1649* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1650* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1651* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1652* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1653* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1654******************************************************************
  1655
  1656 01  COMPENSATION-MASTER.
  1657     12  CO-RECORD-ID                          PIC XX.
  1658         88  VALID-CO-ID                          VALUE 'CO'.
  1659
  1660     12  CO-CONTROL-PRIMARY.
  1661         16  CO-COMPANY-CD                     PIC X.
  1662         16  CO-CONTROL.
  1663             20  CO-CTL-1.
  1664                 24  CO-CARR-GROUP.
  1665                     28  CO-CARRIER            PIC X.
  1666                     28  CO-GROUPING.
  1667                         32  CO-GROUP-PREFIX   PIC XXX.
  1668                         32  CO-GROUP-PRIME    PIC XXX.
  1669                 24  CO-RESP-NO.
  1670                     28  CO-RESP-PREFIX        PIC X(4).
  1671                     28  CO-RESP-PRIME         PIC X(6).
  1672             20  CO-CTL-2.
  1673                 24  CO-ACCOUNT.
  1674                     28  CO-ACCT-PREFIX        PIC X(4).
  1675                     28  CO-ACCT-PRIME         PIC X(6).
  1676         16  CO-TYPE                           PIC X.
  1677             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1678             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1679             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1680
  1681     12  CO-MAINT-INFORMATION.
  1682         16  CO-LAST-MAINT-DT                  PIC XX.
  1683         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1684         16  CO-LAST-MAINT-USER                PIC X(4).
  1685     12  FILLER                                PIC XX.
  1686     12  CO-STMT-TYPE                          PIC XXX.
  1687     12  CO-COMP-TYPE                          PIC X.
  1688         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1689     12  CO-STMT-OWNER                         PIC X(4).
  1690     12  CO-BALANCE-CONTROL                    PIC X.
  1691         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1692         88  CO-NO-BALANCE                        VALUE 'N'.
  1693
  1694     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1695         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  31
* NSRASBL.cbl
  1696         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1697         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1698
  1699     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1700         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1701         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1702
  1703     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1704     12  CO-GA-DIRECT-DEP                      PIC X.
  1705     12  CO-FUTURE-SPACE                       PIC X.
  1706         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1707
  1708     12  CO-ACCT-NAME                          PIC X(30).
  1709     12  CO-MAIL-NAME                          PIC X(30).
  1710     12  CO-ADDR-1                             PIC X(30).
  1711     12  CO-ADDR-2                             PIC X(30).
  1712     12  CO-ADDR-3.
  1713         16  CO-ADDR-CITY                      PIC X(27).
  1714         16  CO-ADDR-STATE                     PIC XX.
  1715     12  CO-CSO-1099                           PIC X.
  1716     12  CO-ZIP.
  1717         16  CO-ZIP-PRIME.
  1718             20  CO-ZIP-PRI-1ST                PIC X.
  1719                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1720             20  FILLER                        PIC X(4).
  1721         16  CO-ZIP-PLUS4                      PIC X(4).
  1722     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1723         16  CO-CAN-POSTAL-1                   PIC XXX.
  1724         16  CO-CAN-POSTAL-2                   PIC XXX.
  1725         16  FILLER                            PIC XXX.
  1726     12  CO-SOC-SEC                            PIC X(13).
  1727     12  CO-TELEPHONE.
  1728         16  CO-AREA-CODE                      PIC XXX.
  1729         16  CO-PREFIX                         PIC XXX.
  1730         16  CO-PHONE                          PIC X(4).
  1731
  1732     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1733
  1734     12  CO-AR-BAL-LEVEL                       PIC X.
  1735         88  CO-AR-REF-LVL                        VALUE '1'.
  1736         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1737         88  CO-AR-BILL-LVL                       VALUE '2'.
  1738         88  CO-AR-AGT-LVL                        VALUE '3'.
  1739         88  CO-AR-FR-LVL                         VALUE '4'.
  1740
  1741     12  CO-AR-NORMAL-PRINT                    PIC X.
  1742         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1743         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1744
  1745     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1746
  1747     12  CO-AR-REPORTING                       PIC X.
  1748         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1749         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1750
  1751     12  CO-AR-PULL-CHECK                      PIC X.
  1752         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1753         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  32
* NSRASBL.cbl
  1754
  1755     12  CO-AR-BALANCE-PRINT                   PIC X.
  1756         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1757
  1758     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1759         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1760         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1761         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1762
  1763     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1764
  1765     12  CO-USER-CODE                          PIC X.
  1766     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1767
  1768******************************************************************
  1769*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1770*    THE LAST MONTH END RUN.
  1771******************************************************************
  1772
  1773     12  CO-LAST-ACTIVITY-DATE.
  1774         16  CO-ACT-YEAR                       PIC 99.
  1775         16  CO-ACT-MONTH                      PIC 99.
  1776         16  CO-ACT-DAY                        PIC 99.
  1777
  1778     12  CO-LAST-STMT-DT.
  1779         16  CO-LAST-STMT-YEAR                 PIC 99.
  1780         16  CO-LAST-STMT-MONTH                PIC 99.
  1781         16  CO-LAST-STMT-DAY                  PIC 99.
  1782
  1783     12  CO-MO-END-TOTALS.
  1784         16  CO-MONTHLY-TOTALS.
  1785             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1786             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1787             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1788             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1789             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1790
  1791         16  CO-AGING-TOTALS.
  1792             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1793             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1794             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1795             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1796
  1797         16  CO-YTD-TOTALS.
  1798             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1799             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1800
  1801         16  CO-OVER-UNDER-TOTALS.
  1802             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1803             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1804
  1805     12  CO-MISCELLANEOUS-TOTALS.
  1806         16  CO-FICA-TOTALS.
  1807             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1808             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1809
  1810         16  CO-CLAIM-TOTALS.
  1811             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  33
* NSRASBL.cbl
  1812             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1813
  1814******************************************************************
  1815*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1816*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1817******************************************************************
  1818
  1819     12  CO-CURRENT-TOTALS.
  1820         16  CO-CURRENT-LAST-STMT-DT.
  1821             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1822             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1823             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1824
  1825         16  CO-CURRENT-MONTHLY-TOTALS.
  1826             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1827             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1828             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1829             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1830             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1831
  1832         16  CO-CURRENT-AGING-TOTALS.
  1833             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1834             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1835             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1836             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1837
  1838         16  CO-CURRENT-YTD-TOTALS.
  1839             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1840             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1841
  1842     12  CO-PAID-COMM-TOTALS.
  1843         16  CO-YTD-PAID-COMMS.
  1844             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1845             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1846
  1847     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1848         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1849         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1850
  1851     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1852         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1853         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1854         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1855         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1856         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1857         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1858         88  CO-FINAL-LETTER                  VALUE 'F'.
  1859         88  CO-RECONCILING                   VALUE 'R'.
  1860         88  CO-PHONE-CALL                    VALUE 'P'.
  1861         88  CO-LEGAL                         VALUE 'L'.
  1862         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1863         88  CO-WRITE-OFF                     VALUE 'W'.
  1864         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1865
  1866     12  CO-CSR-CODE                       PIC X(4).
  1867
  1868     12  CO-GA-STATUS-INFO.
  1869         16  CO-GA-EFFECTIVE-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  34
* NSRASBL.cbl
  1870         16  CO-GA-TERMINATION-DT          PIC XX.
  1871         16  CO-GA-STATUS-CODE             PIC X.
  1872             88  CO-GA-ACTIVE                 VALUE 'A'.
  1873             88  CO-GA-INACTIVE               VALUE 'I'.
  1874             88  CO-GA-PENDING                VALUE 'P'.
  1875         16  CO-GA-COMMENTS.
  1876             20  CO-GA-COMMENT-1           PIC X(40).
  1877             20  CO-GA-COMMENT-2           PIC X(40).
  1878             20  CO-GA-COMMENT-3           PIC X(40).
  1879             20  CO-GA-COMMENT-4           PIC X(40).
  1880
  1881     12  CO-RPTCD2                         PIC X(10).
  1882     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1883         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1884         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1885
  1886     12  CO-TYPE-AGENT                     PIC X(01).
  1887         88  CO-CORPORATION                   VALUE 'C'.
  1888         88  CO-PARTNERSHIP                   VALUE 'P'.
  1889         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1890         88  CO-TRUST                         VALUE 'T'.
  1891         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1892
  1893     12  CO-FAXNO.
  1894         16  CO-FAX-AREA-CODE                  PIC XXX.
  1895         16  CO-FAX-PREFIX                     PIC XXX.
  1896         16  CO-FAX-PHONE                      PIC X(4).
  1897
  1898     12  CO-BANK-INFORMATION.
  1899         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1900         16  CO-BANK-TRANSIT-NON REDEFINES
  1901             CO-BANK-TRANSIT-NO                PIC 9(8).
  1902
  1903         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1904     12  CO-MISC-DEDUCT-INFO REDEFINES
  1905                  CO-BANK-INFORMATION.
  1906         16  CO-MD-GL-ACCT                     PIC X(10).
  1907         16  CO-MD-DIV                         PIC XX.
  1908         16  CO-MD-CENTER                      PIC X(4).
  1909         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1910         16  CO-CREATE-AP-CHECK                PIC X.
  1911         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1912         16  FILLER                            PIC XXX.
  1913     12  CO-ACH-STATUS                         PIC X.
  1914         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1915         88  CO-ACH-PENDING                        VALUE 'P'.
  1916
  1917     12  CO-BILL-SW                            PIC X.
  1918     12  CO-CONTROL-NAME                       PIC X(30).
  1919     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1920     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1921     12  CO-CLP-STATE                          PIC XX.
  1922     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1923     12  CO-SPP-REFUND-EDIT                    PIC X.
  1924
  1925******************************************************************
  1926*                                COPY ELCCERT.
  1927******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  35
* NSRASBL.cbl
  1928*                                                                *
  1929*                            ELCCERT.                            *
  1930*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1931*                            VMOD=2.013                          *
  1932*                                                                *
  1933*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1934*                                                                *
  1935*   FILE TYPE = VSAM,KSDS                                        *
  1936*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1937*                                                                *
  1938*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1939*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1940*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1941*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1942*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1943*                                                                *
  1944*   LOG = YES                                                    *
  1945*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1946******************************************************************
  1947*                   C H A N G E   L O G
  1948*
  1949* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1950*-----------------------------------------------------------------
  1951*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1952* EFFECTIVE    NUMBER
  1953*-----------------------------------------------------------------
  1954* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1955* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1956* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1957* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1958* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1959* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1960* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1961* 032612  CR2011110200001  PEMA  AHL CHANGES
  1962******************************************************************
  1963
  1964 01  CERTIFICATE-MASTER.
  1965     12  CM-RECORD-ID                      PIC XX.
  1966         88  VALID-CM-ID                      VALUE 'CM'.
  1967
  1968     12  CM-CONTROL-PRIMARY.
  1969         16  CM-COMPANY-CD                 PIC X.
  1970         16  CM-CARRIER                    PIC X.
  1971         16  CM-GROUPING.
  1972             20  CM-GROUPING-PREFIX        PIC X(3).
  1973             20  CM-GROUPING-PRIME         PIC X(3).
  1974         16  CM-STATE                      PIC XX.
  1975         16  CM-ACCOUNT.
  1976             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1977             20  CM-ACCOUNT-PRIME          PIC X(6).
  1978         16  CM-CERT-EFF-DT                PIC XX.
  1979         16  CM-CERT-NO.
  1980             20  CM-CERT-PRIME             PIC X(10).
  1981             20  CM-CERT-SFX               PIC X.
  1982
  1983     12  CM-CONTROL-BY-NAME.
  1984         16  CM-COMPANY-CD-A1              PIC X.
  1985         16  CM-INSURED-LAST-NAME          PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  36
* NSRASBL.cbl
  1986         16  CM-INSURED-INITIALS.
  1987             20  CM-INSURED-INITIAL1       PIC X.
  1988             20  CM-INSURED-INITIAL2       PIC X.
  1989
  1990     12  CM-CONTROL-BY-SSN.
  1991         16  CM-COMPANY-CD-A2              PIC X.
  1992         16  CM-SOC-SEC-NO.
  1993             20  CM-SSN-STATE              PIC XX.
  1994             20  CM-SSN-ACCOUNT            PIC X(6).
  1995             20  CM-SSN-LN3.
  1996                 25  CM-INSURED-INITIALS-A2.
  1997                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1998                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1999                 25 CM-PART-LAST-NAME-A2         PIC X.
  2000
  2001     12  CM-CONTROL-BY-CERT-NO.
  2002         16  CM-COMPANY-CD-A4              PIC X.
  2003         16  CM-CERT-NO-A4                 PIC X(11).
  2004
  2005     12  CM-CONTROL-BY-MEMB.
  2006         16  CM-COMPANY-CD-A5              PIC X.
  2007         16  CM-MEMBER-NO.
  2008             20  CM-MEMB-STATE             PIC XX.
  2009             20  CM-MEMB-ACCOUNT           PIC X(6).
  2010             20  CM-MEMB-LN4.
  2011                 25  CM-INSURED-INITIALS-A5.
  2012                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2013                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2014                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2015
  2016     12  CM-INSURED-PROFILE-DATA.
  2017         16  CM-INSURED-FIRST-NAME.
  2018             20  CM-INSURED-1ST-INIT       PIC X.
  2019             20  FILLER                    PIC X(9).
  2020         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2021         16  CM-INSURED-SEX                PIC X.
  2022             88  CM-SEX-MALE                  VALUE 'M'.
  2023             88  CM-SEX-FEMAL                 VALUE 'F'.
  2024         16  CM-INSURED-JOINT-AGE          PIC 99.
  2025         16  CM-JOINT-INSURED-NAME.
  2026             20  CM-JT-LAST-NAME           PIC X(15).
  2027             20  CM-JT-FIRST-NAME.
  2028                 24  CM-JT-1ST-INIT        PIC X.
  2029                 24  FILLER                PIC X(9).
  2030             20  CM-JT-INITIAL             PIC X.
  2031
  2032     12  CM-LIFE-DATA.
  2033         16  CM-LF-BENEFIT-CD              PIC XX.
  2034         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2035         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2036         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2037         16  CM-LF-DEV-CODE                PIC XXX.
  2038         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2039         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2040         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2041         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2042         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2043         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  37
* NSRASBL.cbl
  2044         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2045         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2046         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2047         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2048         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2049         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2050         16  FILLER                        PIC XX.
  2051
  2052     12  CM-AH-DATA.
  2053         16  CM-AH-BENEFIT-CD              PIC XX.
  2054         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2055         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2056         16  CM-AH-DEV-CODE                PIC XXX.
  2057         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2058         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2059         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2060         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2061         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2062         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2063         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2064         16  CM-AH-PAID-THRU-DT            PIC XX.
  2065             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2066         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2067         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2068         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2069         16  FILLER                        PIC X.
  2070
  2071     12  CM-LOAN-INFORMATION.
  2072         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2073         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2074                                           PIC S9(5)V99  COMP-3.
  2075         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2076         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2077         16  CM-PAY-FREQUENCY              PIC S99.
  2078         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2079         16  CM-RATE-CLASS                 PIC XX.
  2080         16  CM-BENEFICIARY                PIC X(25).
  2081         16  CM-POLICY-FORM-NO             PIC X(12).
  2082         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2083         16  CM-LAST-ADD-ON-DT             PIC XX.
  2084         16  CM-DEDUCTIBLE-AMOUNTS.
  2085             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2086             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2087         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2088             20  CM-RESIDENT-STATE         PIC XX.
  2089             20  CM-RATE-CODE              PIC X(4).
  2090             20  FILLER                    PIC XX.
  2091         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2092             20  CM-LOAN-OFFICER           PIC X(5).
  2093             20  FILLER                    PIC XXX.
  2094         16  CM-CSR-CODE                   PIC XXX.
  2095         16  CM-UNDERWRITING-CODE          PIC X.
  2096             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2097         16  CM-POST-CARD-IND              PIC X.
  2098         16  CM-NH-INTERFACE-SW            PIC X.
  2099         16  CM-PREMIUM-TYPE               PIC X.
  2100             88  CM-SING-PRM                  VALUE '1'.
  2101             88  CM-O-B-COVERAGE              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  38
* NSRASBL.cbl
  2102             88  CM-OPEN-END                  VALUE '3'.
  2103         16  CM-IND-GRP-TYPE               PIC X.
  2104             88  CM-INDIVIDUAL                VALUE 'I'.
  2105             88  CM-GROUP                     VALUE 'G'.
  2106         16  CM-SKIP-CODE                  PIC X.
  2107             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2108             88  SKIP-JULY                    VALUE '1'.
  2109             88  SKIP-AUGUST                  VALUE '2'.
  2110             88  SKIP-SEPTEMBER               VALUE '3'.
  2111             88  SKIP-JULY-AUG                VALUE '4'.
  2112             88  SKIP-AUG-SEPT                VALUE '5'.
  2113             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2114             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2115             88  SKIP-JUNE                    VALUE '8'.
  2116             88  SKIP-JUNE-JULY               VALUE '9'.
  2117             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2118             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2119         16  CM-PAYMENT-MODE               PIC X.
  2120             88  PAY-MONTHLY                  VALUE SPACE.
  2121             88  PAY-WEEKLY                   VALUE '1'.
  2122             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2123             88  PAY-BI-WEEKLY                VALUE '3'.
  2124             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2125         16  CM-LOAN-NUMBER                PIC X(8).
  2126         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2127         16  CM-OLD-LOF                    PIC XXX.
  2128*        16  CM-LOAN-OFFICER               PIC XXX.
  2129         16  CM-REIN-TABLE                 PIC XXX.
  2130         16  CM-SPECIAL-REIN-CODE          PIC X.
  2131         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2132         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2133         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2134
  2135     12  CM-STATUS-DATA.
  2136         16  CM-ENTRY-STATUS               PIC X.
  2137         16  CM-ENTRY-DT                   PIC XX.
  2138
  2139         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2140         16  CM-LF-CANCEL-DT               PIC XX.
  2141         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2142
  2143         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2144         16  CM-LF-DEATH-DT                PIC XX.
  2145         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2146
  2147         16  CM-LF-CURRENT-STATUS          PIC X.
  2148             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2149                                                'M' '4' '5' '9'.
  2150             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2151             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2152             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2153             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2154             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2155             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2156             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2157             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2158             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2159             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  39
* NSRASBL.cbl
  2160             88  CM-LF-DECLINED               VALUE 'D'.
  2161             88  CM-LF-VOIDED                 VALUE 'V'.
  2162
  2163         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2164         16  CM-AH-CANCEL-DT               PIC XX.
  2165         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2166
  2167         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2168         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2169         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2170
  2171         16  CM-AH-CURRENT-STATUS          PIC X.
  2172             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2173                                                'M' '4' '5' '9'.
  2174             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2175             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2176             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2177             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2178             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2179             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2180             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2181             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2182             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2183             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2184             88  CM-AH-DECLINED               VALUE 'D'.
  2185             88  CM-AH-VOIDED                 VALUE 'V'.
  2186
  2187         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2188             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2189             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2190             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2191         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2192
  2193         16  CM-ENTRY-BATCH                PIC X(6).
  2194         16  CM-LF-EXIT-BATCH              PIC X(6).
  2195         16  CM-AH-EXIT-BATCH              PIC X(6).
  2196         16  CM-LAST-MONTH-END             PIC XX.
  2197
  2198     12  CM-NOTE-SW                        PIC X.
  2199         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2200         88  CERT-NOTES-PRESENT               VALUE '1'.
  2201         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2202         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2203         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2204         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2205         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2206         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2207     12  CM-COMP-EXCP-SW                   PIC X.
  2208         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2209         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2210     12  CM-INSURED-ADDRESS-SW             PIC X.
  2211         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2212         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2213
  2214*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2215     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2216     12  FILLER                            PIC X.
  2217
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  40
* NSRASBL.cbl
  2218*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2219     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2220     12  FILLER                            PIC X.
  2221*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2222     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2223
  2224     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2225         88  CERT-ADDED-BATCH                 VALUE ' '.
  2226         88  CERT-ADDED-ONLINE                VALUE '1'.
  2227         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2228         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2229         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2230     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2231         88  CERT-AS-LOADED                   VALUE ' '.
  2232         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2233         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2234         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2235         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2236         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2237         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2238         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2239
  2240     12  CM-ACCOUNT-COMM-PCTS.
  2241         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2242         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2243
  2244     12  CM-USER-FIELD                     PIC X.
  2245     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2246     12  CM-CLP-STATE                      PIC XX.
  2247     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2248     12  CM-USER-RESERVED                  PIC XXX.
  2249     12  FILLER REDEFINES CM-USER-RESERVED.
  2250         16  CM-AH-CLASS-CD                PIC XX.
  2251         16  F                             PIC X.
  2252******************************************************************
  2253*                                COPY ELCCRTO.
  2254******************************************************************
  2255*                                                                *
  2256*                            ELCCRTO.                            *
  2257*                                                                *
  2258*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2259*                                                                *
  2260*   FILE TYPE = VSAM,KSDS                                        *
  2261*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2262*                                                                *
  2263*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2264*                                                                *
  2265*   LOG = YES                                                    *
  2266*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2267******************************************************************
  2268*                   C H A N G E   L O G
  2269*
  2270* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2271*-----------------------------------------------------------------
  2272*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2273* EFFECTIVE    NUMBER
  2274*-----------------------------------------------------------------
  2275* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  41
* NSRASBL.cbl
  2276* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2277* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2278* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2279* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2280******************************************************************
  2281 01  ORIGINAL-CERTIFICATE.
  2282     12  OC-RECORD-ID                      PIC XX.
  2283         88  VALID-OC-ID                      VALUE 'OC'.
  2284     12  OC-CONTROL-PRIMARY.
  2285         16  OC-COMPANY-CD                 PIC X.
  2286         16  OC-CARRIER                    PIC X.
  2287         16  OC-GROUPING                   PIC X(6).
  2288         16  OC-STATE                      PIC XX.
  2289         16  OC-ACCOUNT                    PIC X(10).
  2290         16  OC-CERT-EFF-DT                PIC XX.
  2291         16  OC-CERT-NO.
  2292             20  OC-CERT-PRIME             PIC X(10).
  2293             20  OC-CERT-SFX               PIC X.
  2294         16  OC-RECORD-TYPE                PIC X.
  2295         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2296     12  OC-LAST-MAINT-DT                  PIC XX.
  2297     12  OC-LAST-MAINT-BY                  PIC X(4).
  2298     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2299     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2300     12  FILLER                            PIC X(49).
  2301     12  OC-ORIG-REC.
  2302         16  OC-INS-LAST-NAME              PIC X(15).
  2303         16  OC-INS-FIRST-NAME             PIC X(10).
  2304         16  OC-INS-MIDDLE-INIT            PIC X.
  2305         16  OC-INS-AGE                    PIC S999     COMP-3.
  2306         16  OC-JNT-LAST-NAME              PIC X(15).
  2307         16  OC-JNT-FIRST-NAME             PIC X(10).
  2308         16  OC-JNT-MIDDLE-INIT            PIC X.
  2309         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2310         16  OC-LF-BENCD                   PIC XX.
  2311         16  OC-LF-TERM                    PIC S999      COMP-3.
  2312         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2313         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2314         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2315         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2316         16  OC-LF-EXP-DT                  PIC XX.
  2317         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2318         16  OC-LF-CANCEL-DT               PIC XX.
  2319         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2320         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2321         16  OC-AH-BENCD                   PIC XX.
  2322         16  OC-AH-TERM                    PIC S999      COMP-3.
  2323         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2324         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2325         16  OC-AH-EXP-DT                  PIC XX.
  2326         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2327         16  OC-AH-CP                      PIC 99.
  2328         16  OC-AH-CANCEL-DT               PIC XX.
  2329         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2330         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2331         16  OC-CRED-BENE-NAME             PIC X(25).
  2332         16  OC-1ST-PMT-DT                 PIC XX.
  2333         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  42
* NSRASBL.cbl
  2334         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  2335         16  OC-ISSUE-TRAN-IND             PIC X.
  2336         16  OC-CANCEL-TRAN-IND            PIC X.
  2337         16  FILLER                        PIC X(211).
  2338
  2339     12  FILLER                            PIC X(50).
  2340******************************************************************
  2341*                                COPY ERCACCT.
  2342******************************************************************
  2343*                                                                *
  2344*                                                                *
  2345*                            ERCACCT                             *
  2346*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2347*                            VMOD=2.031                          *
  2348*                                                                *
  2349*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2350*                                                                *
  2351*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2352*   VSAM ACCOUNT MASTER FILES.                                   *
  2353*                                                                *
  2354*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2355*                                                                *
  2356*   FILE TYPE = VSAM,KSDS                                        *
  2357*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2358*                                                                *
  2359*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2360*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2361*                                                                *
  2362*   LOG = NO                                                     *
  2363*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2364*                                                                *
  2365*                                                                *
  2366******************************************************************
  2367*                   C H A N G E   L O G
  2368*
  2369* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2370*-----------------------------------------------------------------
  2371*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2372* EFFECTIVE    NUMBER
  2373*-----------------------------------------------------------------
  2374* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2375* 092705    2005050300006  PEMA  ADD SPP LEASES
  2376* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2377* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2378* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2379* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2380* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2381******************************************************************
  2382
  2383 01  ACCOUNT-MASTER.
  2384     12  AM-RECORD-ID                      PIC XX.
  2385         88  VALID-AM-ID                      VALUE 'AM'.
  2386
  2387     12  AM-CONTROL-PRIMARY.
  2388         16  AM-COMPANY-CD                 PIC X.
  2389         16  AM-MSTR-CNTRL.
  2390             20  AM-CONTROL-A.
  2391                 24  AM-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  43
* NSRASBL.cbl
  2392                 24  AM-GROUPING.
  2393                     28 AM-GROUPING-PREFIX PIC XXX.
  2394                     28 AM-GROUPING-PRIME  PIC XXX.
  2395                 24  AM-STATE              PIC XX.
  2396                 24  AM-ACCOUNT.
  2397                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2398                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2399             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2400                                           PIC X(19).
  2401             20  AM-CNTRL-B.
  2402                 24  AM-EXPIRATION-DT      PIC XX.
  2403                 24  FILLER                PIC X(4).
  2404             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2405                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2406
  2407     12  AM-CONTROL-BY-VAR-GRP.
  2408         16  AM-COMPANY-CD-A1              PIC X.
  2409         16  AM-VG-CARRIER                 PIC X.
  2410         16  AM-VG-GROUPING                PIC X(6).
  2411         16  AM-VG-STATE                   PIC XX.
  2412         16  AM-VG-ACCOUNT                 PIC X(10).
  2413         16  AM-VG-DATE.
  2414             20  AM-VG-EXPIRATION-DT       PIC XX.
  2415             20  FILLER                    PIC X(4).
  2416         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2417                                           PIC 9(11)      COMP-3.
  2418     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2419         16  FILLER                        PIC X(10).
  2420         16  AM-VG-KEY3.
  2421             20  AM-VG3-ACCOUNT            PIC X(10).
  2422             20  AM-VG3-EXP-DT             PIC XX.
  2423         16  FILLER                        PIC X(4).
  2424     12  AM-MAINT-INFORMATION.
  2425         16  AM-LAST-MAINT-DT              PIC XX.
  2426         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2427         16  AM-LAST-MAINT-USER            PIC X(4).
  2428         16  FILLER                        PIC XX.
  2429
  2430     12  AM-EFFECTIVE-DT                   PIC XX.
  2431     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2432
  2433     12  AM-PREV-DATES  COMP-3.
  2434         16  AM-PREV-EXP-DT                PIC 9(11).
  2435         16  AM-PREV-EFF-DT                PIC 9(11).
  2436
  2437     12  AM-REPORT-CODE-1                  PIC X(10).
  2438     12  AM-REPORT-CODE-2                  PIC X(10).
  2439
  2440     12  AM-CITY-CODE                      PIC X(4).
  2441     12  AM-COUNTY-PARISH                  PIC X(6).
  2442
  2443     12  AM-NAME                           PIC X(30).
  2444     12  AM-PERSON                         PIC X(30).
  2445     12  AM-ADDRS                          PIC X(30).
  2446     12  AM-CITY.
  2447         16  AM-ADDR-CITY                  PIC X(28).
  2448         16  AM-ADDR-STATE                 PIC XX.
  2449     12  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  44
* NSRASBL.cbl
  2450         16  AM-ZIP-PRIME.
  2451             20  AM-ZIP-PRI-1ST            PIC X.
  2452                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2453             20  FILLER                    PIC X(4).
  2454         16  AM-ZIP-PLUS4                  PIC X(4).
  2455     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2456         16  AM-CAN-POSTAL-1               PIC XXX.
  2457         16  AM-CAN-POSTAL-2               PIC XXX.
  2458         16  FILLER                        PIC XXX.
  2459     12  AM-TEL-NO.
  2460         16  AM-AREA-CODE                  PIC 999.
  2461         16  AM-TEL-PRE                    PIC 999.
  2462         16  AM-TEL-NBR                    PIC 9(4).
  2463     12  AM-TEL-LOC                        PIC X.
  2464         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2465         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2466
  2467     12  AM-COMM-STRUCTURE.
  2468         16  AM-DEFN-1.
  2469             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2470                 24  AM-AGT.
  2471                     28  AM-AGT-PREFIX     PIC X(4).
  2472                     28  AM-AGT-PRIME      PIC X(6).
  2473                 24  AM-COM-TYP            PIC X.
  2474                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2475                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2476                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2477                 24  AM-RECALC-LV-INDIC    PIC X.
  2478                 24  AM-RETRO-LV-INDIC     PIC X.
  2479                 24  AM-GL-CODES           PIC X.
  2480                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2481                 24  FILLER                PIC X(01).
  2482         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2483             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2484                 24  FILLER                PIC X(11).
  2485                 24  AM-L-COMA             PIC XXX.
  2486                 24  AM-J-COMA             PIC XXX.
  2487                 24  AM-A-COMA             PIC XXX.
  2488                 24  FILLER                PIC X(6).
  2489
  2490     12  AM-COMM-CHANGE-STATUS             PIC X.
  2491         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2492
  2493     12  AM-CSR-CODE                       PIC X(4).
  2494
  2495     12  AM-BILLING-STATUS                 PIC X.
  2496         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2497         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2498     12  AM-AUTO-REFUND-SW                 PIC X.
  2499         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2500         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2501     12  AM-GPCD                           PIC 99.
  2502     12  AM-IG                             PIC X.
  2503         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2504         88  AM-HAS-GROUP                     VALUE '2'.
  2505     12  AM-STATUS                         PIC X.
  2506         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2507         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  45
* NSRASBL.cbl
  2508         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2509         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2510         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2511         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2512     12  AM-REMIT-TO                       PIC 99.
  2513     12  AM-ID-NO                          PIC X(11).
  2514
  2515     12  AM-CAL-TABLE                      PIC XX.
  2516     12  AM-LF-DEVIATION                   PIC XXX.
  2517     12  AM-AH-DEVIATION                   PIC XXX.
  2518     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2519     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2520     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2521     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2522     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2523     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2524
  2525     12  AM-USER-FIELDS.
  2526         16  AM-FLD-1                      PIC XX.
  2527         16  AM-FLD-2                      PIC XX.
  2528         16  AM-FLD-3                      PIC XX.
  2529         16  AM-FLD-4                      PIC XX.
  2530         16  AM-FLD-5                      PIC XX.
  2531
  2532     12  AM-1ST-PROD-DATE.
  2533         16  AM-1ST-PROD-YR                PIC XX.
  2534         16  AM-1ST-PROD-MO                PIC XX.
  2535         16  AM-1ST-PROD-DA                PIC XX.
  2536     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2537     12  AM-CERTS-PURGED-DATE.
  2538         16  AM-PUR-YR                     PIC XX.
  2539         16  AM-PUR-MO                     PIC XX.
  2540         16  AM-PUR-DA                     PIC XX.
  2541     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2542     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2543     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2544     12  AM-INACTIVE-DATE.
  2545         16  AM-INA-MO                     PIC 99.
  2546         16  AM-INA-DA                     PIC 99.
  2547         16  AM-INA-YR                     PIC 99.
  2548     12  AM-AR-HI-CERT-DATE                PIC XX.
  2549
  2550     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2551     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2552
  2553     12  AM-OB-PAYMENT-MODE                PIC X.
  2554         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2555         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2556         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2557         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2558
  2559     12  AM-AH-ONLY-INDICATOR              PIC X.
  2560         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2561         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2562
  2563     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2564
  2565     12  AM-OVER-SHORT.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  46
* NSRASBL.cbl
  2566         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2567         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2568
  2569     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2570     12  AM-DCC-CLP-STATE                  PIC XX.
  2571
  2572     12  AM-RECALC-COMM                    PIC X.
  2573     12  AM-RECALC-REIN                    PIC X.
  2574
  2575     12  AM-REI-TABLE                      PIC XXX.
  2576     12  AM-REI-ET-LF                      PIC X.
  2577     12  AM-REI-ET-AH                      PIC X.
  2578     12  AM-REI-PE-LF                      PIC X.
  2579     12  AM-REI-PE-AH                      PIC X.
  2580     12  AM-REI-PRT-ST                     PIC X.
  2581     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2582     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2583     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2584     12  AM-REI-GROUP-A                    PIC X(6).
  2585     12  AM-REI-MORT                       PIC X(4).
  2586     12  AM-REI-PRT-OW                     PIC X.
  2587     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2588     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2589     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2590     12  AM-REI-GROUP-B                    PIC X(6).
  2591
  2592     12  AM-TRUST-TYPE                     PIC X(2).
  2593
  2594     12  AM-EMPLOYER-STMT-USED             PIC X.
  2595     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2596
  2597     12  AM-STD-AH-TYPE                    PIC XX.
  2598     12  AM-EARN-METHODS.
  2599         16  AM-EARN-METHOD-R              PIC X.
  2600             88 AM-REF-RL-R78                 VALUE 'R'.
  2601             88 AM-REF-RL-PR                  VALUE 'P'.
  2602             88 AM-REF-RL-MEAN                VALUE 'M'.
  2603             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2604         16  AM-EARN-METHOD-L              PIC X.
  2605             88 AM-REF-LL-R78                 VALUE 'R'.
  2606             88 AM-REF-LL-PR                  VALUE 'P'.
  2607             88 AM-REF-LL-MEAN                VALUE 'M'.
  2608             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2609         16  AM-EARN-METHOD-A              PIC X.
  2610             88 AM-REF-AH-R78                 VALUE 'R'.
  2611             88 AM-REF-AH-PR                  VALUE 'P'.
  2612             88 AM-REF-AH-MEAN                VALUE 'M'.
  2613             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2614             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2615             88 AM-REF-AH-NET                 VALUE 'N'.
  2616
  2617     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2618     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2619     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2620
  2621     12  AM-RET-Y-N                        PIC X.
  2622     12  AM-RET-P-E                        PIC X.
  2623     12  AM-LF-RET                         PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  47
* NSRASBL.cbl
  2624     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2625     12  AM-RET-GRP                        PIC X(6).
  2626     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2627         16  AM-POOL-PRIME                 PIC XXX.
  2628         16  AM-POOL-SUB                   PIC XXX.
  2629     12  AM-RETRO-EARNINGS.
  2630         16  AM-RET-EARN-R                 PIC X.
  2631         16  AM-RET-EARN-L                 PIC X.
  2632         16  AM-RET-EARN-A                 PIC X.
  2633     12  AM-RET-ST-TAX-USE                 PIC X.
  2634         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2635         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2636     12  AM-RETRO-BEG-EARNINGS.
  2637         16  AM-RET-BEG-EARN-R             PIC X.
  2638         16  AM-RET-BEG-EARN-L             PIC X.
  2639         16  AM-RET-BEG-EARN-A             PIC X.
  2640     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2641     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2642
  2643     12  AM-USER-SELECT-OPTIONS.
  2644         16  AM-USER-SELECT-1              PIC X(10).
  2645         16  AM-USER-SELECT-2              PIC X(10).
  2646         16  AM-USER-SELECT-3              PIC X(10).
  2647         16  AM-USER-SELECT-4              PIC X(10).
  2648         16  AM-USER-SELECT-5              PIC X(10).
  2649
  2650     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2651
  2652     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2653
  2654     12  AM-RPT045A-SWITCH                 PIC X.
  2655         88  RPT045A-OFF                   VALUE 'N'.
  2656
  2657     12  AM-INSURANCE-LIMITS.
  2658         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2659         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2660
  2661     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2662         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2663
  2664     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2665         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2666         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2667
  2668     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2669
  2670     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2671     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2672     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2673     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2674     12  AM-DCC-UEF-STATE                  PIC XX.
  2675     12  FILLER                            PIC XXX.
  2676     12  AM-REPORT-CODE-3                  PIC X(10).
  2677*    12  FILLER                            PIC X(22).
  2678
  2679     12  AM-RESERVE-DATE.
  2680         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2681         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  48
* NSRASBL.cbl
  2682         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2683
  2684     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2685     12  AM-NOTIFICATION-TYPES.
  2686         16  AM-NOTIF-OF-LETTERS           PIC X.
  2687         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2688         16  AM-NOTIF-OF-REPORTS           PIC X.
  2689         16  AM-NOTIF-OF-STATUS            PIC X.
  2690
  2691     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2692         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2693         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2694         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2695         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2696
  2697     12  AM-BENEFIT-CONTROLS.
  2698         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2699             20  AM-BENEFIT-CODE           PIC XX.
  2700             20  AM-BENEFIT-TYPE           PIC X.
  2701             20  AM-BENEFIT-REVISION       PIC XXX.
  2702             20  AM-BENEFIT-REM-TERM       PIC X.
  2703             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2704             20  FILLER                    PIC XX.
  2705         16  FILLER                        PIC X(80).
  2706
  2707     12  AM-TRANSFER-DATA.
  2708         16  AM-TRANSFERRED-FROM.
  2709             20  AM-TRNFROM-CARRIER        PIC X.
  2710             20  AM-TRNFROM-GROUPING.
  2711                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2712                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2713             20  AM-TRNFROM-STATE          PIC XX.
  2714             20  AM-TRNFROM-ACCOUNT.
  2715                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2716                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2717             20  AM-TRNFROM-DTE            PIC XX.
  2718         16  AM-TRANSFERRED-TO.
  2719             20  AM-TRNTO-CARRIER          PIC X.
  2720             20  AM-TRNTO-GROUPING.
  2721                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2722                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2723             20  AM-TRNTO-STATE            PIC XX.
  2724             20  AM-TRNTO-ACCOUNT.
  2725                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2726                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2727             20  AM-TRNTO-DTE              PIC XX.
  2728         16  FILLER                        PIC X(10).
  2729
  2730     12  AM-SAVED-REMIT-TO                 PIC 99.
  2731
  2732     12  AM-COMM-STRUCTURE-SAVED.
  2733         16  AM-DEFN-1-SAVED.
  2734             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2735                 24  AM-AGT-SV             PIC X(10).
  2736                 24  AM-COM-TYP-SV         PIC X.
  2737                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2738                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2739                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  49
* NSRASBL.cbl
  2740                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2741                 24  FILLER                PIC X.
  2742                 24  AM-GL-CODES-SV        PIC X.
  2743                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2744                 24  FILLER                PIC X.
  2745         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2746             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2747                 24  FILLER                PIC X(11).
  2748                 24  AM-L-COMA-SV          PIC XXX.
  2749                 24  AM-J-COMA-SV          PIC XXX.
  2750                 24  AM-A-COMA-SV          PIC XXX.
  2751                 24  FILLER                PIC X(6).
  2752
  2753     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2754         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2755            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2756            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2757            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2758
  2759     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2760     12  FILLER                            PIC X(120).
  2761
  2762     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2763         16  AM-CONTROL-NAME               PIC X(30).
  2764         16  AM-EXECUTIVE-ONE.
  2765             20  AM-EXEC1-NAME             PIC X(15).
  2766             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2767                                                          COMP-3.
  2768             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2769                                                          COMP-3.
  2770         16  AM-EXECUTIVE-TWO.
  2771             20  AM-EXEC2-NAME             PIC X(15).
  2772             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2773                                                          COMP-3.
  2774             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2775                                                          COMP-3.
  2776
  2777     12  AM-RETRO-ADDITIONAL-DATA.
  2778         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2779         16  AM-RETRO-PREM-P-E             PIC X.
  2780         16  AM-RETRO-CLMS-P-I             PIC X.
  2781         16  AM-RETRO-RET-BRACKET-LF.
  2782             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2783                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2784                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2785             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2786                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2787                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2788             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2789                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2790                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2791         16  AM-RETRO-RET-BRACKET-AH.
  2792             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2793                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2794                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2795                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2796             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2797                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  50
* NSRASBL.cbl
  2798                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2799             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2800                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2801                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2802
  2803     12  AM-COMMENTS.
  2804         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2805
  2806     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2807         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2808         16  AM-FLI-BILLING-CODE           PIC X.
  2809         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2810         16  AM-FLI-UNITED-IDENT           PIC X.
  2811         16  AM-FLI-INTEREST-LOST-DATA.
  2812             20  AM-FLI-BANK-NO            PIC X(5).
  2813             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2814             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2815             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2816         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2817             20  AM-FLI-AGT                PIC X(9).
  2818             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2819             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2820         16  FILLER                        PIC X(102).
  2821
  2822     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2823         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2824             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2825             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2826             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2827             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2828             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2829         16  FILLER                          PIC X(10).
  2830******************************************************************
  2831*                                COPY ELCTEXT.
  2832******************************************************************
  2833*                                                                *
  2834*                                                                *
  2835*                            ELCTEXT.                            *
  2836*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2837*                            VMOD=2.008                          *
  2838*                                                                *
  2839*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2840*                                     FORM LETTERS,              *
  2841*                                     CERT FORM DISPLAY.
  2842*                                                                *
  2843*   FILE TYPE = VSAM,KSDS                                        *
  2844*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2845*                                                                *
  2846*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2847*       ALTERNATE INDEX = NONE                                   *
  2848*                                                                *
  2849*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2850*       ALTERNATE INDEX = NONE                                   *
  2851*                                                                *
  2852*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2853*       ALTERNATE INDEX = NONE                                   *
  2854*                                                                *
  2855*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  51
* NSRASBL.cbl
  2856*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2857******************************************************************
  2858 01  TEXT-FILES.
  2859     12  TEXT-FILE-ID                PIC XX.
  2860         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2861         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2862         88  HELP-FILE-TEXT             VALUE 'TH'.
  2863
  2864     12  TX-CONTROL-PRIMARY.
  2865         16  TX-COMPANY-CD           PIC X.
  2866             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2867         16  TX-ACCESS-CD-GENL       PIC X(12).
  2868
  2869         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2870             20  TX-LETTER-NO        PIC X(4).
  2871             20  FILLER              PIC X(8).
  2872
  2873         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2874             20  TX-FORM-NO          PIC X(12).
  2875
  2876         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2877             20  TX-HELP-TYPE        PIC X.
  2878                 88  HELP-FOR-GENERAL   VALUE ' '.
  2879                 88  HELP-BY-SCREEN     VALUE 'S'.
  2880                 88  HELP-BY-ERROR      VALUE 'E'.
  2881             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2882                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2883             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2884                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2885             20  FILLER              PIC X(4).
  2886
  2887         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2888
  2889     12  TX-PROCESS-CONTROL          PIC XX.
  2890         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2891
  2892     12  TX-TEXT-LINE                PIC X(70).
  2893
  2894     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2895         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2896         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2897         88  TX-VALID-FORM-SQUEEZE-VALUE
  2898                                        VALUE 'Y' ' '.
  2899
  2900     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2901         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2902         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2903         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2904         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2905         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2906         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2907         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2908                                              'K' 'N' ' '
  2909                                              'Z'.
  2910
  2911     12  TX-ARCHIVE-SW               PIC X.
  2912         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2913         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  52
* NSRASBL.cbl
  2914         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2915
  2916     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2917     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2918
  2919     12  TX-BSR-CODE                 PIC X.
  2920         88  TX-BSR-LETTER              VALUE 'B'.
  2921         88  TX-NON-BSR-LETTER          VALUE ' '.
  2922
  2923     12  FILLER                      PIC X.
  2924*****************************************************************
  2925*                                COPY ELCCNTL.
  2926******************************************************************
  2927*                                                                *
  2928*                                                                *
  2929*                            ELCCNTL.                            *
  2930*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2931*                            VMOD=2.059                          *
  2932*                                                                *
  2933*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2934*                                                                *
  2935*   FILE TYPE = VSAM,KSDS                                        *
  2936*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2937*                                                                *
  2938*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2939*       ALTERNATE INDEX = NONE                                   *
  2940*                                                                *
  2941*   LOG = YES                                                    *
  2942*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2943******************************************************************
  2944*                   C H A N G E   L O G
  2945*
  2946* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2947*-----------------------------------------------------------------
  2948*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2949* EFFECTIVE    NUMBER
  2950*-----------------------------------------------------------------
  2951* 082503                   PEMA  ADD BENEFIT GROUP
  2952* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2953* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2954* 092705    2005050300006  PEMA  ADD SPP LEASES
  2955* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2956* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2957* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2958* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2959* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2960* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2961* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2962* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2963* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2964******************************************************************
  2965*
  2966 01  CONTROL-FILE.
  2967     12  CF-RECORD-ID                       PIC XX.
  2968         88  VALID-CF-ID                        VALUE 'CF'.
  2969
  2970     12  CF-CONTROL-PRIMARY.
  2971         16  CF-COMPANY-ID                  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  53
* NSRASBL.cbl
  2972         16  CF-RECORD-TYPE                 PIC X.
  2973             88  CF-COMPANY-MASTER              VALUE '1'.
  2974             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2975             88  CF-STATE-MASTER                VALUE '3'.
  2976             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2977             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2978             88  CF-CARRIER-MASTER              VALUE '6'.
  2979             88  CF-MORTALITY-MASTER            VALUE '7'.
  2980             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2981             88  CF-TERMINAL-MASTER             VALUE '9'.
  2982             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2983             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2984             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2985             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2986             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2987             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2988             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2989             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2990             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2991         16  CF-ACCESS-CD-GENL              PIC X(4).
  2992         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2993             20  CF-PROCESSOR               PIC X(4).
  2994         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2995             20  CF-STATE-CODE              PIC XX.
  2996             20  FILLER                     PIC XX.
  2997         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2998             20  FILLER                     PIC XX.
  2999             20  CF-HI-BEN-IN-REC           PIC XX.
  3000         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3001             20  FILLER                     PIC XXX.
  3002             20  CF-CARRIER-CNTL            PIC X.
  3003         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3004             20  FILLER                     PIC XX.
  3005             20  CF-HI-TYPE-IN-REC          PIC 99.
  3006         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3007             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3008                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3009             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3010             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3011         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3012             20  FILLER                     PIC X.
  3013             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3014         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3015             20  FILLER                     PIC XX.
  3016             20  CF-MORTGAGE-PLAN           PIC XX.
  3017         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3018
  3019     12  CF-LAST-MAINT-DT                   PIC XX.
  3020     12  CF-LAST-MAINT-BY                   PIC X(4).
  3021     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3022
  3023     12  CF-RECORD-BODY                     PIC X(728).
  3024
  3025
  3026****************************************************************
  3027*             COMPANY MASTER RECORD                            *
  3028****************************************************************
  3029
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  54
* NSRASBL.cbl
  3030     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3031         16  CF-COMPANY-ADDRESS.
  3032             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3033             20  CF-CL-IN-CARE-OF           PIC X(30).
  3034             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3035             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3036             20  CF-CL-CITY-STATE           PIC X(30).
  3037             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3038             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3039         16  CF-COMPANY-CD                  PIC X.
  3040         16  CF-COMPANY-PASSWORD            PIC X(8).
  3041         16  CF-SECURITY-OPTION             PIC X.
  3042             88  ALL-SECURITY                   VALUE '1'.
  3043             88  COMPANY-VERIFY                 VALUE '2'.
  3044             88  PROCESSOR-VERIFY               VALUE '3'.
  3045             88  NO-SECURITY                    VALUE '4'.
  3046             88  ALL-BUT-TERM                   VALUE '5'.
  3047         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3048             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3049         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3050             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3051         16  CF-INFORCE-LOCATION            PIC X.
  3052             88  CERTS-ARE-ONLINE               VALUE '1'.
  3053             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3054             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3055         16  CF-LOWER-CASE-LETTERS          PIC X.
  3056         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3057             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3058             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3059             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3060             88  CF-ACCNT-CNTL                  VALUE '3'.
  3061             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3062
  3063         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3064         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3065
  3066         16  CF-LGX-CREDIT-USER             PIC X.
  3067             88  CO-IS-NOT-USER                 VALUE 'N'.
  3068             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3069
  3070         16 CF-CREDIT-CALC-CODES.
  3071             20  CF-CR-REM-TERM-CALC PIC X.
  3072               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3073               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3074               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3075               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3076               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3077               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3078               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3079             20  CF-CR-R78-METHOD           PIC X.
  3080               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3081               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3082
  3083         16  CF-CLAIM-CONTROL-COUNTS.
  3084             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3085                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3086
  3087             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  55
* NSRASBL.cbl
  3088                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3089
  3090             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3091                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3092
  3093             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3094                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3095
  3096         16  CF-CURRENT-MONTH-END           PIC XX.
  3097
  3098         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3099             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3100             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3101             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3102             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3103                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3104                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3105             20  CF-CO-PREM-REJECT-SW       PIC X.
  3106                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3107                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3108             20  CF-CO-REF-REJECT-SW        PIC X.
  3109                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3110                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3111
  3112         16  CF-CO-REPORTING-DT             PIC XX.
  3113         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3114         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3115           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3116           88  CF-CO-MONTH-END                  VALUE '1'.
  3117
  3118         16  CF-LGX-CLAIM-USER              PIC X.
  3119             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3120             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3121
  3122         16  CF-CREDIT-EDIT-CONTROLS.
  3123             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3124             20  CF-MIN-AGE                 PIC 99.
  3125             20  CF-DEFAULT-AGE             PIC 99.
  3126             20  CF-MIN-TERM                PIC S999      COMP-3.
  3127             20  CF-MAX-TERM                PIC S999      COMP-3.
  3128             20  CF-DEFAULT-SEX             PIC X.
  3129             20  CF-JOINT-AGE-INPUT         PIC X.
  3130                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3131             20  CF-BIRTH-DATE-INPUT        PIC X.
  3132                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3133             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3134                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3135                 88  CF-ZERO-CARRIER            VALUE '1'.
  3136                 88  CF-ZERO-GROUPING           VALUE '2'.
  3137                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3138             20  CF-EDIT-SW                 PIC X.
  3139                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3140             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3141             20  CF-CR-PR-METHOD            PIC X.
  3142               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3143               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3144             20  FILLER                     PIC X.
  3145
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  56
* NSRASBL.cbl
  3146         16  CF-CREDIT-MISC-CONTROLS.
  3147             20  CF-REIN-TABLE-SW           PIC X.
  3148                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3149             20  CF-COMP-TABLE-SW           PIC X.
  3150                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3151             20  CF-EXPERIENCE-RETENTION-AGE
  3152                                            PIC S9        COMP-3.
  3153             20  CF-CONVERSION-DT           PIC XX.
  3154             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3155             20  CF-RUN-FREQUENCY-SW        PIC X.
  3156                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3157                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3158
  3159             20  CF-CR-CHECK-NO-CONTROL.
  3160                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3161                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3162                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3163                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3164                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3165                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3166
  3167                 24  CF-CR-CHECK-COUNT       REDEFINES
  3168                     CF-CR-CHECK-COUNTER      PIC X(4).
  3169
  3170                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3171                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3172
  3173                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3174                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3175                 24  CF-MAIL-PROCESSING       PIC X.
  3176                     88  MAIL-PROCESSING          VALUE 'Y'.
  3177
  3178         16  CF-MISC-SYSTEM-CONTROL.
  3179             20  CF-SYSTEM-C                 PIC X.
  3180                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3181             20  CF-SYSTEM-D                 PIC X.
  3182                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3183             20  CF-SOC-SEC-NO-SW            PIC X.
  3184                 88  SOC-SEC-NO-USED             VALUE '1'.
  3185             20  CF-MEMBER-NO-SW             PIC X.
  3186                 88  MEMBER-NO-USED              VALUE '1'.
  3187             20  CF-TAX-ID-NUMBER            PIC X(11).
  3188             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3189             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3190                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3191                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3192                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3193                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3194             20  CF-SYSTEM-E                 PIC X.
  3195                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3196
  3197         16  CF-LGX-LIFE-USER               PIC X.
  3198             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3199             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3200
  3201         16  CF-CR-MONTH-END-DT             PIC XX.
  3202
  3203         16  CF-FILE-MAINT-DATES.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  57
* NSRASBL.cbl
  3204             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3205                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3206             20  CF-LAST-BATCH       REDEFINES
  3207                 CF-LAST-BATCH-NO               PIC X(4).
  3208             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3209             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3210             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3211             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3212             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3213             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3214             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3215             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3216             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3217             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3218
  3219         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3220         16  FILLER                         PIC X.
  3221
  3222         16  CF-ALT-MORT-CODE               PIC X(4).
  3223         16  CF-MEMBER-CAPTION              PIC X(10).
  3224
  3225         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3226             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3227             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3228             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3229             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3230             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3231
  3232         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3233
  3234         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3235         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3236         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3237         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3238
  3239         16  CF-AH-OVERRIDE-L1              PIC X.
  3240         16  CF-AH-OVERRIDE-L2              PIC XX.
  3241         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3242         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3243
  3244         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3245         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3246
  3247         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3248         16  CF-AR-LAST-EL860-DT            PIC XX.
  3249         16  CF-MP-MONTH-END-DT             PIC XX.
  3250
  3251         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3252         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3253             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3254
  3255         16  CF-AR-MONTH-END-DT             PIC XX.
  3256
  3257         16  CF-CRDTCRD-USER                PIC X.
  3258             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3259             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3260
  3261         16  CF-CC-MONTH-END-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  58
* NSRASBL.cbl
  3262
  3263         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3264
  3265         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3266             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3267             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3268             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3269         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3270         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3271         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3272         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3273             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3274             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3275         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3276         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3277         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3278             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3279         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3280
  3281         16  CF-CL-ZIP-CODE.
  3282             20  CF-CL-ZIP-PRIME.
  3283                 24  CF-CL-ZIP-1ST          PIC X.
  3284                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3285                 24  FILLER                 PIC X(4).
  3286             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3287         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3288             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3289             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3290             20  FILLER                     PIC XXX.
  3291
  3292         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3293         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3294         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3295         16  CF-CO-OPTION-START-DATE        PIC XX.
  3296         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3297           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3298                                                      '3' '4'.
  3299           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3300           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3301           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3302           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3303           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3304           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3305
  3306         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3307
  3308         16  CF-PAYMENT-APPROVAL-LEVELS.
  3309             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3310             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3311             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3312             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3313             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3314             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3315
  3316         16  CF-END-USER-REPORTING-USER     PIC X.
  3317             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3318             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3319
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  59
* NSRASBL.cbl
  3320         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3321             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3322             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3323
  3324         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3325
  3326         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3327         16  FILLER                         PIC X.
  3328
  3329         16  CF-CREDIT-ARCHIVE-CNTL.
  3330             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3331             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3332             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3333
  3334         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3335
  3336         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3337             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3338             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3339
  3340         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3341             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3342             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3343
  3344         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3345
  3346         16  CF-CO-ACH-ID-CODE              PIC  X.
  3347             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3348             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3349             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3350         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3351         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3352         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3353         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3354         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3355         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3356         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3357         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3358         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3359                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3360         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3361                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3362
  3363         16  CF-CO-OVER-SHORT.
  3364             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3365             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3366
  3367*         16  FILLER                         PIC X(102).
  3368         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3369             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3370             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3371
  3372         16  CF-AH-APPROVAL-DAYS.
  3373             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3374             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3375             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3376             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3377
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  60
* NSRASBL.cbl
  3378         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3379
  3380         16  CF-APPROV-LEV-5.
  3381             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3382             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3383             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3384
  3385         16  FILLER                         PIC X(68).
  3386****************************************************************
  3387*             PROCESSOR/USER RECORD                            *
  3388****************************************************************
  3389
  3390     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3391         16  CF-PROCESSOR-NAME              PIC X(30).
  3392         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3393         16  CF-PROCESSOR-TITLE             PIC X(26).
  3394         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3395                 88  MESSAGE-YES                VALUE 'Y'.
  3396                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3397
  3398*****************************************************
  3399****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3400****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3401****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3402****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3403*****************************************************
  3404
  3405         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3406             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3407             20  CF-APPLICATION-FORCE       PIC X.
  3408             20  CF-INDIVIDUAL-APP.
  3409                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3410                     28  CF-BROWSE-APP      PIC X.
  3411                     28  CF-UPDATE-APP      PIC X.
  3412
  3413         16  CF-CURRENT-TERM-ON             PIC X(4).
  3414         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3415             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3416             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3417             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3418             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3419             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3420             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3421             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3422         16  CF-PROCESSOR-CARRIER           PIC X.
  3423             88  NO-CARRIER-SECURITY            VALUE ' '.
  3424         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3425             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3426         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3427             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3428         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3429             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3430
  3431         16  CF-PROC-SYS-ACCESS-SW.
  3432             20  CF-PROC-CREDIT-CLAIMS-SW.
  3433                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3434                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3435                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  61
* NSRASBL.cbl
  3436                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3437             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3438                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3439                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3440             20  CF-PROC-LIFE-GNRLDGR-SW.
  3441                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3442                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3443                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3444                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3445             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3446                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3447                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3448         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3449             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3450             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3451         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3452
  3453         16  CF-APPROVAL-LEVEL                  PIC X.
  3454             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3455             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3456             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3457             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3458             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3459
  3460         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3461
  3462         16  CF-LANGUAGE-TYPE                   PIC X.
  3463             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3464             88  CF-LANG-IS-FR                      VALUE 'F'.
  3465
  3466         16  CF-CSR-IND                         PIC X.
  3467         16  FILLER                             PIC X(239).
  3468
  3469****************************************************************
  3470*             PROCESSOR/REMINDERS RECORD                       *
  3471****************************************************************
  3472
  3473     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3474         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3475             20  CF-START-REMIND-DT         PIC XX.
  3476             20  CF-END-REMIND-DT           PIC XX.
  3477             20  CF-REMINDER-TEXT           PIC X(50).
  3478         16  FILLER                         PIC X(296).
  3479
  3480
  3481****************************************************************
  3482*             STATE MASTER RECORD                              *
  3483****************************************************************
  3484
  3485     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3486         16  CF-STATE-ABBREVIATION          PIC XX.
  3487         16  CF-STATE-NAME                  PIC X(25).
  3488         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3489         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3490             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3491             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3492             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3493             20  CF-ST-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  62
* NSRASBL.cbl
  3494                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3495                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3496             20  CF-ST-PREM-REJECT-SW       PIC X.
  3497                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3498                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3499             20  CF-ST-REF-REJECT-SW        PIC X.
  3500                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3501                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3502         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3503         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3504         16  CF-ST-REFUND-RULES.
  3505             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3506             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3507             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3508         16  CF-ST-FST-PMT-EXTENSION.
  3509             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3510             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3511                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3512                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3513                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3514                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3515         16  CF-ST-STATE-CALL.
  3516             20  CF-ST-CALL-UNEARNED        PIC X.
  3517             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3518             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3519         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3520             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3521             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3522         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3523         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3524         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3525         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3526         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3527         16  FILLER                         PIC X.
  3528         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3529             20  CF-ST-BENEFIT-CD           PIC XX.
  3530             20  CF-ST-BENEFIT-KIND         PIC X.
  3531                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3532                 88  CF-ST-AH-KIND              VALUE 'A'.
  3533             20  CF-ST-REM-TERM-CALC        PIC X.
  3534                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3535                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3536                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3537                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3538                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3539                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3540                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3541                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3542
  3543             20  CF-ST-REFUND-CALC          PIC X.
  3544                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3545                 88  ST-REFD-BY-R78             VALUE '1'.
  3546                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3547                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3548                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3549                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3550                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3551                 88  ST-REFD-UTAH               VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  63
* NSRASBL.cbl
  3552                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3553                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3554                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3555
  3556             20  CF-ST-EARNING-CALC         PIC X.
  3557                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3558                 88  ST-EARN-BY-R78             VALUE '1'.
  3559                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3560                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3561                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3562                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3563                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3564                 88  ST-EARN-MEAN               VALUE '8'.
  3565                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3566
  3567             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3568                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3569                 88  ST-OVRD-BY-R78             VALUE '1'.
  3570                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3571                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3572                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3573                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3574                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3575                 88  ST-OVRD-MEAN               VALUE '8'.
  3576                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3577             20  FILLER                     PIC X.
  3578
  3579         16  CF-ST-COMMISSION-CAPS.
  3580             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3581             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3582             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3583             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3584         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3585                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3586
  3587         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3588
  3589         16  CF-ST-STATUTORY-INTEREST.
  3590             20  CF-ST-STAT-DATE-FROM       PIC X.
  3591                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3592                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3593             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3594             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3595             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3596             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3597             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3598
  3599         16  CF-ST-OVER-SHORT.
  3600             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3601             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3602
  3603         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3604
  3605         16  CF-ST-RT-CALC                  PIC X.
  3606
  3607         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3608         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3609         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  64
* NSRASBL.cbl
  3610         16  CF-ST-RF-LR-CALC               PIC X.
  3611         16  CF-ST-RF-LL-CALC               PIC X.
  3612         16  CF-ST-RF-LN-CALC               PIC X.
  3613         16  CF-ST-RF-AH-CALC               PIC X.
  3614         16  CF-ST-RF-CP-CALC               PIC X.
  3615*        16  FILLER                         PIC X(206).
  3616*CIDMOD         16  FILLER                         PIC X(192).
  3617         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3618             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3619         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3620         16  CF-ST-VFY-2ND-BENE             PIC X.
  3621         16  CF-ST-CAUSAL-STATE             PIC X.
  3622         16  FILLER                         PIC X(185).
  3623
  3624****************************************************************
  3625*             BENEFIT MASTER RECORD                            *
  3626****************************************************************
  3627
  3628     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3629         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3630             20  CF-BENEFIT-CODE            PIC XX.
  3631             20  CF-BENEFIT-NUMERIC  REDEFINES
  3632                 CF-BENEFIT-CODE            PIC XX.
  3633             20  CF-BENEFIT-ALPHA           PIC XXX.
  3634             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3635             20  CF-BENEFIT-COMMENT         PIC X(10).
  3636
  3637             20  CF-LF-COVERAGE-TYPE        PIC X.
  3638                 88  CF-REDUCING                VALUE 'R'.
  3639                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3640
  3641             20  CF-SPECIAL-CALC-CD         PIC X.
  3642                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3643                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3644                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3645                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3646                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3647                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3648                 88  CF-FARM-PLAN               VALUE 'F'.
  3649                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3650                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3651                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3652                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3653                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3654                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3655                 88  CF-PRUDENTIAL              VALUE 'P'.
  3656                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3657                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3658                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3659                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3660                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3661                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3662
  3663             20  CF-JOINT-INDICATOR         PIC X.
  3664                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3665
  3666*            20  FILLER                     PIC X(12).
  3667             20  FILLER                     PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  65
* NSRASBL.cbl
  3668             20  CF-BENEFIT-CATEGORY        PIC X.
  3669             20  CF-LOAN-TYPE               PIC X(8).
  3670
  3671             20  CF-CO-REM-TERM-CALC        PIC X.
  3672                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3673                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3674                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3675                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3676                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3677
  3678             20  CF-CO-EARNINGS-CALC        PIC X.
  3679                 88  CO-EARN-BY-R78             VALUE '1'.
  3680                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3681                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3682                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3683                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3684                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3685                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3686                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3687
  3688             20  CF-CO-REFUND-CALC          PIC X.
  3689                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3690                 88  CO-REFD-BY-R78             VALUE '1'.
  3691                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3692                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3693                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3694                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3695                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3696                 88  CO-REFD-MEAN               VALUE '8'.
  3697                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3698                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3699                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3700
  3701             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3702                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3703                 88  CO-OVRD-BY-R78             VALUE '1'.
  3704                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3705                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3706                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3707                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3708                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3709                 88  CO-OVRD-MEAN               VALUE '8'.
  3710                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3711
  3712             20  CF-CO-BEN-I-G-CD           PIC X.
  3713                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3714                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3715                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3716
  3717         16  FILLER                         PIC X(304).
  3718
  3719
  3720****************************************************************
  3721*             CARRIER MASTER RECORD                            *
  3722****************************************************************
  3723
  3724     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3725         16  CF-ADDRESS-DATA.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  66
* NSRASBL.cbl
  3726             20  CF-MAIL-TO-NAME            PIC X(30).
  3727             20  CF-IN-CARE-OF              PIC X(30).
  3728             20  CF-ADDRESS-LINE-1          PIC X(30).
  3729             20  CF-ADDRESS-LINE-2          PIC X(30).
  3730             20  CF-CITY-STATE              PIC X(30).
  3731             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3732             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3733
  3734         16  CF-CLAIM-NO-CONTROL.
  3735             20  CF-CLAIM-NO-METHOD         PIC X.
  3736                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3737                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3738                 88  CLAIM-NO-SEQ               VALUE '3'.
  3739                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3740             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3741                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3742                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3743                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3744
  3745         16  CF-CHECK-NO-CONTROL.
  3746             20  CF-CHECK-NO-METHOD         PIC X.
  3747                 88  CHECK-NO-MANUAL            VALUE '1'.
  3748                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3749                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3750                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3751             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3752                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3753
  3754         16  CF-DOMICILE-STATE              PIC XX.
  3755
  3756         16  CF-EXPENSE-CONTROLS.
  3757             20  CF-EXPENSE-METHOD          PIC X.
  3758                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3759                 88  DOLLARS-PER-PMT            VALUE '2'.
  3760                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3761                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3762             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3763             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3764
  3765         16  CF-CORRESPONDENCE-CONTROL.
  3766             20  CF-LETTER-RESEND-OPT       PIC X.
  3767                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3768                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3769             20  FILLER                     PIC X(4).
  3770
  3771         16  CF-RESERVE-CONTROLS.
  3772             20  CF-MANUAL-SW               PIC X.
  3773                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3774             20  CF-FUTURE-SW               PIC X.
  3775                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3776             20  CF-PTC-SW                  PIC X.
  3777                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3778             20  CF-IBNR-SW                 PIC X.
  3779                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3780             20  CF-PTC-LF-SW               PIC X.
  3781                 88  CF-LF-PTC-USED             VALUE '1'.
  3782             20  CF-CDT-ACCESS-METHOD       PIC X.
  3783                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  67
* NSRASBL.cbl
  3784                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3785                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3786             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3787
  3788         16  CF-CLAIM-CALC-METHOD           PIC X.
  3789             88  360-PLUS-MONTHS                VALUE '1'.
  3790             88  365-PLUS-MONTHS                VALUE '2'.
  3791             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3792             88  360-DAILY                      VALUE '4'.
  3793             88  365-DAILY                      VALUE '5'.
  3794
  3795         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3796         16  FILLER                         PIC X(11).
  3797
  3798         16  CF-LIMIT-AMOUNTS.
  3799             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3800             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3801             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3802             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3803             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3804             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3805             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3806             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3807             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3808             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3809
  3810         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3811         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3812         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3813
  3814         16  CF-ZIP-CODE.
  3815             20  CF-ZIP-PRIME.
  3816                 24  CF-ZIP-1ST             PIC X.
  3817                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3818                 24  FILLER                 PIC X(4).
  3819             20  CF-ZIP-PLUS4               PIC X(4).
  3820         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3821             20  CF-CAN-POSTAL-1            PIC XXX.
  3822             20  CF-CAN-POSTAL-2            PIC XXX.
  3823             20  FILLER                     PIC XXX.
  3824
  3825         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3826         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3827         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3828
  3829         16  CF-RATING-SWITCH               PIC X.
  3830             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3831             88  CF-NO-RATING                   VALUE 'N'.
  3832
  3833         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3834
  3835         16  CF-CARRIER-OVER-SHORT.
  3836             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3837             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3838
  3839         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3840         16  CF-SECPAY-SWITCH               PIC X.
  3841             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  68
* NSRASBL.cbl
  3842             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3843         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3844         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3845         16  FILLER                         PIC X(444).
  3846*        16  FILLER                         PIC X(452).
  3847
  3848
  3849****************************************************************
  3850*             MORTALITY MASTER RECORD                          *
  3851****************************************************************
  3852
  3853     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3854         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3855                                INDEXED BY CF-MORT-NDX.
  3856             20  CF-MORT-TABLE              PIC X(5).
  3857             20  CF-MORT-TABLE-TYPE         PIC X.
  3858                 88  CF-MORT-JOINT              VALUE 'J'.
  3859                 88  CF-MORT-SINGLE             VALUE 'S'.
  3860                 88  CF-MORT-COMBINED           VALUE 'C'.
  3861                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3862                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3863             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3864             20  CF-MORT-AGE-METHOD         PIC XX.
  3865                 88  CF-AGE-LAST                VALUE 'AL'.
  3866                 88  CF-AGE-NEAR                VALUE 'AN'.
  3867             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3868             20  CF-MORT-ADJUSTMENT-DIRECTION
  3869                                            PIC X.
  3870                 88  CF-MINUS                   VALUE '-'.
  3871                 88  CF-PLUS                    VALUE '+'.
  3872             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3873             20  CF-MORT-JOINT-CODE         PIC X.
  3874                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3875             20  CF-MORT-PC-Q               PIC X.
  3876                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3877             20  CF-MORT-TABLE-CODE         PIC X(4).
  3878             20  CF-MORT-COMMENTS           PIC X(15).
  3879             20  FILLER                     PIC X(14).
  3880
  3881         16  FILLER                         PIC X(251).
  3882
  3883
  3884****************************************************************
  3885*             BUSSINESS TYPE MASTER RECORD                     *
  3886****************************************************************
  3887
  3888     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3889* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3890* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3891* AND RECORD 05 IS TYPES 81-99
  3892         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3893             20  CF-BUSINESS-TITLE          PIC  X(19).
  3894             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3895                                            PIC S9V9(4) COMP-3.
  3896             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3897             20  FILLER                     PIC  X.
  3898         16  FILLER                         PIC  X(248).
  3899
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  69
* NSRASBL.cbl
  3900
  3901****************************************************************
  3902*             TERMINAL MASTER RECORD                           *
  3903****************************************************************
  3904
  3905     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3906
  3907         16  CF-COMPANY-TERMINALS.
  3908             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3909                                  PIC X(4).
  3910         16  FILLER               PIC X(248).
  3911
  3912
  3913****************************************************************
  3914*             LIFE EDIT MASTER RECORD                          *
  3915****************************************************************
  3916
  3917     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3918         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3919             20  CF-LIFE-CODE-IN            PIC XX.
  3920             20  CF-LIFE-CODE-OUT           PIC XX.
  3921         16  FILLER                         PIC X(248).
  3922
  3923
  3924****************************************************************
  3925*             AH EDIT MASTER RECORD                            *
  3926****************************************************************
  3927
  3928     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3929         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3930             20  CF-AH-CODE-IN              PIC XXX.
  3931             20  CF-AH-CODE-OUT             PIC XX.
  3932         16  FILLER                         PIC X(248).
  3933
  3934
  3935****************************************************************
  3936*             CREDIBILITY TABLES                               *
  3937****************************************************************
  3938
  3939     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3940         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3941                             INDEXED BY CF-CRDB-NDX.
  3942             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3943             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3944             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3945         16  FILLER                         PIC  X(332).
  3946
  3947
  3948****************************************************************
  3949*             REPORT CUSTOMIZATION RECORD                      *
  3950****************************************************************
  3951
  3952     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3953         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3954             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3955             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3956             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3957**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  70
* NSRASBL.cbl
  3958****       A T-TRANSFER.                                   ****
  3959             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3960
  3961         16  FILLER                         PIC XX.
  3962
  3963         16  CF-CARRIER-CNTL-OPT.
  3964             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3965                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3966                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3967             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3968                                            PIC X.
  3969         16  CF-GROUP-CNTL-OPT.
  3970             20  CF-GROUP-OPT-SEQ           PIC 9.
  3971                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3972                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3973             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3974                                            PIC X(6).
  3975         16  CF-STATE-CNTL-OPT.
  3976             20  CF-STATE-OPT-SEQ           PIC 9.
  3977                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3978                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3979             20  CF-STATE-SELECT OCCURS 3 TIMES
  3980                                            PIC XX.
  3981         16  CF-ACCOUNT-CNTL-OPT.
  3982             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3983                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3984                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3985             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3986                                            PIC X(10).
  3987         16  CF-BUS-TYP-CNTL-OPT.
  3988             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3989                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3990                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3991             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3992                                            PIC XX.
  3993         16  CF-LF-TYP-CNTL-OPT.
  3994             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3995                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3996                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3997             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3998                                            PIC XX.
  3999         16  CF-AH-TYP-CNTL-OPT.
  4000             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4001                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4002                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4003             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4004                                            PIC XX.
  4005         16  CF-REPTCD1-CNTL-OPT.
  4006             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4007                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4008                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4009             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4010                                            PIC X(10).
  4011         16  CF-REPTCD2-CNTL-OPT.
  4012             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4013                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4014                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4015             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  71
* NSRASBL.cbl
  4016                                            PIC X(10).
  4017         16  CF-USER1-CNTL-OPT.
  4018             20  CF-USER1-OPT-SEQ           PIC 9.
  4019                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4020                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4021             20  CF-USER1-SELECT OCCURS 3 TIMES
  4022                                            PIC X(10).
  4023         16  CF-USER2-CNTL-OPT.
  4024             20  CF-USER2-OPT-SEQ           PIC 9.
  4025                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4026                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4027             20  CF-USER2-SELECT OCCURS 3 TIMES
  4028                                            PIC X(10).
  4029         16  CF-USER3-CNTL-OPT.
  4030             20  CF-USER3-OPT-SEQ           PIC 9.
  4031                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4032                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4033             20  CF-USER3-SELECT OCCURS 3 TIMES
  4034                                            PIC X(10).
  4035         16  CF-USER4-CNTL-OPT.
  4036             20  CF-USER4-OPT-SEQ           PIC 9.
  4037                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4038                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4039             20  CF-USER4-SELECT OCCURS 3 TIMES
  4040                                            PIC X(10).
  4041         16  CF-USER5-CNTL-OPT.
  4042             20  CF-USER5-OPT-SEQ           PIC 9.
  4043                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4044                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4045             20  CF-USER5-SELECT OCCURS 3 TIMES
  4046                                            PIC X(10).
  4047         16  CF-REINS-CNTL-OPT.
  4048             20  CF-REINS-OPT-SEQ           PIC 9.
  4049                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4050                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4051             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4052                 24  CF-REINS-PRIME         PIC XXX.
  4053                 24  CF-REINS-SUB           PIC XXX.
  4054
  4055         16  CF-AGENT-CNTL-OPT.
  4056             20  CF-AGENT-OPT-SEQ           PIC 9.
  4057                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4058                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4059             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4060                                            PIC X(10).
  4061
  4062         16  FILLER                         PIC X(43).
  4063
  4064         16  CF-LOSS-RATIO-SELECT.
  4065             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4066             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4067         16  CF-ENTRY-DATE-SELECT.
  4068             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4069             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4070         16  CF-EFFECTIVE-DATE-SELECT.
  4071             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4072             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4073
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  72
* NSRASBL.cbl
  4074         16  CF-EXCEPTION-LIST-IND          PIC X.
  4075             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4076
  4077         16  FILLER                         PIC X(318).
  4078
  4079****************************************************************
  4080*                  EXCEPTION REPORTING RECORD                  *
  4081****************************************************************
  4082
  4083     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4084         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4085             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4086
  4087         16  CF-COMBINED-LIFE-AH-OPT.
  4088             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4089             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4090             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4091             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4092
  4093         16  CF-LIFE-OPT.
  4094             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4095             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4096             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4097             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4098             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4099             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4100             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4101             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4102             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4103             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4104
  4105         16  CF-AH-OPT.
  4106             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4107             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4108             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4109             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4110             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4111             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4112             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4113             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4114             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4115             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4116
  4117         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4118             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4119             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4120             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4121
  4122         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4123
  4124         16  FILLER                         PIC X(673).
  4125
  4126
  4127****************************************************************
  4128*             MORTGAGE SYSTEM PLAN RECORD                      *
  4129****************************************************************
  4130
  4131     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  73
* NSRASBL.cbl
  4132         16  CF-PLAN-TYPE                   PIC X.
  4133             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4134             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4135             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4136         16  CF-PLAN-ABBREV                 PIC XXX.
  4137         16  CF-PLAN-DESCRIPT               PIC X(10).
  4138         16  CF-PLAN-NOTES                  PIC X(20).
  4139         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4140         16  CF-PLAN-UNDERWRITING.
  4141             20  CF-PLAN-TERM-DATA.
  4142                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4143                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4144             20  CF-PLAN-AGE-DATA.
  4145                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4146                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4147                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4148             20  CF-PLAN-BENEFIT-DATA.
  4149                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4150                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4151                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4152                                            PIC S9(7)V99  COMP-3.
  4153         16  CF-PLAN-POLICY-FORMS.
  4154             20  CF-POLICY-FORM             PIC X(12).
  4155             20  CF-MASTER-APPLICATION      PIC X(12).
  4156             20  CF-MASTER-POLICY           PIC X(12).
  4157         16  CF-PLAN-RATING.
  4158             20  CF-RATE-CODE               PIC X(5).
  4159             20  CF-SEX-RATING              PIC X.
  4160                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4161                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4162             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4163             20  CF-SUB-STD-TYPE            PIC X.
  4164                 88  CF-PCT-OF-PREM            VALUE '1'.
  4165                 88  CF-PCT-OF-BENE            VALUE '2'.
  4166         16  CF-PLAN-PREM-TOLERANCES.
  4167             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4168             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4169         16  CF-PLAN-PYMT-TOLERANCES.
  4170             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4171             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4172         16  CF-PLAN-MISC-DATA.
  4173             20  FILLER                     PIC X.
  4174             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4175             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4176         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4177         16  CF-PLAN-IND-GRP                PIC X.
  4178             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4179                                                     '1'.
  4180             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4181                                                     '2'.
  4182         16  CF-MIB-SEARCH-SW               PIC X.
  4183             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4184             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4185             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4186             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4187         16  CF-ALPHA-SEARCH-SW             PIC X.
  4188             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4189             88  CF-MIB-ALPHA-NONE             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  74
* NSRASBL.cbl
  4190             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4191             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4192             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4193             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4194             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4195             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4196             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4197             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4198                                                     'A' 'B' 'C'
  4199                                                     'X' 'Y' 'Z'.
  4200         16  CF-EFF-DT-RULE-SW              PIC X.
  4201             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4202             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4203             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4204             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4205             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4206         16  FILLER                         PIC X(4).
  4207         16  CF-HEALTH-QUESTIONS            PIC X.
  4208             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4209         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4210         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4211         16  CF-PLAN-SNGL-JNT               PIC X.
  4212             88  CF-COMBINED-PLAN              VALUE 'C'.
  4213             88  CF-JNT-PLAN                   VALUE 'J'.
  4214             88  CF-SNGL-PLAN                  VALUE 'S'.
  4215         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4216         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4217         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4218         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4219         16  CF-RERATE-CNTL                 PIC  X.
  4220             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4221             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4222             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4223             88  CF-AUTO-RECALC                 VALUE '4'.
  4224         16  CF-BENEFIT-TYPE                PIC  X.
  4225             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4226             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4227         16  CF-POLICY-FEE                  PIC S999V99
  4228                                                    COMP-3.
  4229         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4230         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4231         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4232         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4233         16  FILLER                         PIC  X(32).
  4234         16  CF-TERMINATION-FORM            PIC  X(04).
  4235         16  FILLER                         PIC  X(08).
  4236         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4237                                                       COMP-3.
  4238         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4239         16  CF-ISSUE-LETTER                PIC  X(4).
  4240         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4241         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4242             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4243             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4244         16  CF-MP-REFUND-CALC              PIC X.
  4245             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4246             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4247             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  75
* NSRASBL.cbl
  4248             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4249             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4250             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4251             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4252             88  CF-MP-REFD-MEAN                VALUE '8'.
  4253         16  CF-ALT-RATE-CODE               PIC  X(5).
  4254
  4255
  4256         16  FILLER                         PIC X(498).
  4257****************************************************************
  4258*             MORTGAGE COMPANY MASTER RECORD                   *
  4259****************************************************************
  4260
  4261     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4262         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4263         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4264             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4265             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4266             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4267             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4268             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4269
  4270         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4271         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4272         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4273         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4274         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4275
  4276         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4277             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4278         16  CF-MP-RECON-USE-IND            PIC X(1).
  4279             88  CF-MP-USE-RECON             VALUE 'Y'.
  4280         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4281             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4282         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4283             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4284             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4285         16  FILLER                         PIC X(1).
  4286         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4287             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4288         16  CF-MORTG-MIB-VERSION           PIC X.
  4289             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4290             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4291             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4292         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4293             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4294                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4295             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4296                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4297             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4298                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4299             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4300                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4301             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4302                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4303             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4304                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4305         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  76
* NSRASBL.cbl
  4306         16  FILLER                         PIC X(7).
  4307         16  CF-MORTG-DESTINATION-SYMBOL.
  4308             20  CF-MORTG-MIB-COMM          PIC X(5).
  4309             20  CF-MORTG-MIB-TERM          PIC X(5).
  4310         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4311             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4312         16  FILLER                         PIC X(03).
  4313         16  CF-MP-CHECK-NO-CONTROL.
  4314             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4315                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4316                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4317                                                ' ' LOW-VALUES.
  4318                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4319                                               VALUE '3'.
  4320         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4321         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4322         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4323             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4324                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4325             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4326                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4327             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4328                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4329             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4330                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4331             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4332                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4333             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4334                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4335         16  CF-MORTG-BILLING-AREA.
  4336             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4337                                            PIC X.
  4338         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4339         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4340         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4341         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4342             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4343             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4344         16  FILLER                         PIC X.
  4345         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4346             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4347             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4348         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4349         16  FILLER                         PIC X(8).
  4350         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4351         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4352         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4353         16  CF-ACH-COMPANY-ID.
  4354             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4355                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4356                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4357                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4358             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4359         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4360             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4361         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4362             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4363             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  77
* NSRASBL.cbl
  4364         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4365         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4366         16  FILLER                         PIC X(536).
  4367
  4368****************************************************************
  4369*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4370****************************************************************
  4371
  4372     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4373         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4374             20  CF-FEMALE-HEIGHT.
  4375                 24  CF-FEMALE-FT           PIC 99.
  4376                 24  CF-FEMALE-IN           PIC 99.
  4377             20  CF-FEMALE-MIN-WT           PIC 999.
  4378             20  CF-FEMALE-MAX-WT           PIC 999.
  4379         16  FILLER                         PIC X(428).
  4380
  4381     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4382         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4383             20  CF-MALE-HEIGHT.
  4384                 24  CF-MALE-FT             PIC 99.
  4385                 24  CF-MALE-IN             PIC 99.
  4386             20  CF-MALE-MIN-WT             PIC 999.
  4387             20  CF-MALE-MAX-WT             PIC 999.
  4388         16  FILLER                         PIC X(428).
  4389******************************************************************
  4390*             AUTOMATIC ACTIVITY RECORD                          *
  4391******************************************************************
  4392     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4393         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4394             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4395             20  CF-SYS-LETTER-ID           PIC X(04).
  4396             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4397             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4398             20  CF-SYS-RESET-SW            PIC X(01).
  4399             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4400             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4401
  4402         16  FILLER                         PIC X(50).
  4403
  4404         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4405             20  CF-USER-ACTIVE-SW          PIC X(01).
  4406             20  CF-USER-LETTER-ID          PIC X(04).
  4407             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4408             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4409             20  CF-USER-RESET-SW           PIC X(01).
  4410             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4411             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4412             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4413
  4414         16  FILLER                         PIC X(246).
  4415*                                COPY NSCASVARS.
  4416******************************************************************
  4417*                   C H A N G E   L O G
  4418*
  4419*        CURRENT SIZE - 6150
  4420*
  4421* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  78
* NSRASBL.cbl
  4422*-----------------------------------------------------------------
  4423*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4424* EFFECTIVE    NUMBER
  4425*-----------------------------------------------------------------
  4426* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4427* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4428* 091213  CR2013090300001  AJRA  ADD NEXT BUSINESS DATE
  4429******************************************************************
  4430 01 NAPER-OUTPUT-DATA.
  4431    05  F                       PIC X(07) VALUE "LETTER=".
  4432    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4433    05  F                       PIC X(08) VALUE "~PROCID=".
  4434    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4435    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4436    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4437    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4438    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4439    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4440    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4441    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4442    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4443    05  F                       PIC X(06) VALUE "~CARR=".
  4444    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4445    05  F                       PIC X(10) VALUE "~GROUPING=".
  4446    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4447    05  F                       PIC X(08) VALUE "~CERTST=".
  4448    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4449    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4450    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4451    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4452    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4453    05  F                       PIC X(07) VALUE "~CRTNO=".
  4454    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4455    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4456    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4457    05  F                       PIC X(08) VALUE "~ILNAME=".
  4458    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4459    05  F                       PIC X(08) VALUE "~IFNAME=".
  4460    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4461    05  F                       PIC X(08) VALUE "~IFINIT=".
  4462    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4463    05  F                       PIC X(08) VALUE "~IMINIT=".
  4464    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4465    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4466    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4467    05  F                       PIC X(06) VALUE "~ISEX=".
  4468    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4469    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4470    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4471    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4472    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4473    05  F                       PIC X(09) VALUE "~INSCITY=".
  4474    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4475    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4476    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4477    05  F                       PIC X(08) VALUE "~INSZIP=".
  4478    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4479    05  F                       PIC X(05) VALUE "~SSN=".
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  79
* NSRASBL.cbl
  4480    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4481    05  F                       PIC X(07) VALUE "~MEMNO=".
  4482    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4483    05  F                       PIC X(08) VALUE "~JLNAME=".
  4484    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4485    05  F                       PIC X(08) VALUE "~JFNAME=".
  4486    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4487    05  F                       PIC X(08) VALUE "~JMINIT=".
  4488    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4489    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4490    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4491    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4492    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4493    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4494    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4495    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4496    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4497    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4498    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4499    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4500    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4501    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4502    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4503    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4504    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4505    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4506    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4507    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4508    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4509    05  F                       PIC X(10) VALUE "~BENENAME=".
  4510    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4511    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4512    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4513    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4514    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4515    05  F                       PIC X(10) VALUE "~BENECITY=".
  4516    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4517    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4518    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4519    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4520    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4521    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4522    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4523    05  F                       PIC X(08) VALUE "~RESPNO=".
  4524    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4525    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4526    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4527    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4528    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4529    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4530    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4531    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4532    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4533    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4534    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4535    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4536    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4537    05  F                       PIC X(09) VALUE "~COMPZIP=".
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  80
* NSRASBL.cbl
  4538    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4539    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4540    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4541    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4542    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4543    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4544    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4545    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4546    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4547    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4548    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4549    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4550    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4551    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4552    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4553    05  F                       PIC X(07) VALUE "~BATCH=".
  4554    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4555    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4556    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4557    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4558    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4559    05  F                       PIC X(05) VALUE "~APR=".
  4560    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4561    05  F                       PIC X(08) VALUE "~LNTERM=".
  4562    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4563    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4564    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4565    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4566    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4567    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4568    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4569    05  F                       PIC X(07) VALUE "~UCODE=".
  4570    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4571    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4572    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4573    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4574    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4575    05  F                       PIC X(06) VALUE "~SKIP=".
  4576    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4577    05  F                       PIC X(06) VALUE "~MODE=".
  4578    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4579    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4580    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4581    05  F                       PIC X(06) VALUE "~RTBL=".
  4582    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4583    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4584    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4585    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4586    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4587    05  F                       PIC X(08) VALUE "~LFTERM=".
  4588    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4589    05  F                       PIC X(07) VALUE "~LFDEV=".
  4590    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4591    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4592    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4593    05  F                       PIC X(07) VALUE "~LFBEN=".
  4594    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4595    05  F                       PIC X(08) VALUE "~LFPREM=".
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  81
* NSRASBL.cbl
  4596    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4597    05  F                       PIC X(08) VALUE "~LFABEN=".
  4598    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4599    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4600    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4601    05  F                       PIC X(07) VALUE "~LFNSP=".
  4602    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4603    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4604    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4605    05  F                       PIC X(07) VALUE "~LFCAN=".
  4606    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4607    05  F                       PIC X(07) VALUE "~LFDTH=".
  4608    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4609    05  F                       PIC X(08) VALUE "~LFRATE=".
  4610    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4611    05  F                       PIC X(09) VALUE "~LFARATE=".
  4612    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4613    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4614    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4615    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4616    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4617    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4618    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4619    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4620    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4621    05  F                       PIC X(07) VALUE "~DTHDT=".
  4622    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4623    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4624    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4625    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4626    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4627    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4628    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4629    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4630    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4631    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4632    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4633    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4634    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4635    05  F                       PIC X(08) VALUE "~AHTERM=".
  4636    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4637    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4638    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4639    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4640    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4641    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4642    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4643    05  F                       PIC X(07) VALUE "~AHBEN=".
  4644    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4645    05  F                       PIC X(08) VALUE "~AHPREM=".
  4646    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4647    05  F                       PIC X(07) VALUE "~AHNSP=".
  4648    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4649    05  F                       PIC X(07) VALUE "~AHCAN=".
  4650    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4651    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4652    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4653    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  82
* NSRASBL.cbl
  4654    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4655    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4656    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4657    05  F                       PIC X(08) VALUE "~AHRATE=".
  4658    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4659    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4660    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4661    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4662    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4663    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4664    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4665    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4666    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4667    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4668    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4669    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4670    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4671    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4672    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4673    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4674    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4675    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4676    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4677    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4678    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4679    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4680    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4681    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4682                                PIC X(2).
  4683    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4684    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4685    05  F                       PIC X(08) VALUE "~TOTREF=".
  4686    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4687    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4688    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4689    05  F                       PIC X(07) VALUE "~STERM=".
  4690    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4691    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4692    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4693    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4694    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4695    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4696    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4697    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4698    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4699    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4700    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4701    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4702    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4703    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4704    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4705    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4706    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4707    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4708    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4709    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4710    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4711    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  83
* NSRASBL.cbl
  4712    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4713    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4714                                PIC X(12).
  4715    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4716    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4717    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4718                                PIC X(12).
  4719    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4720    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4721    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4722    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4723    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4724    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4725    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4726    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4727    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4728                                PIC X(12).
  4729    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4730    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4731    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4732                                PIC X(10).
  4733    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4734    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4735    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4736    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4737    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4738    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4739    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4740    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4741    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4742    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4743    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4744    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4745    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4746                                PIC X(10).
  4747    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4748    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4749    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4750                                PIC X(10).
  4751    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4752    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4753    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4754    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4755    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4756    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4757    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4758    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4759    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4760    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4761    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4762    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4763    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4764    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4765    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4766    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4767    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4768    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4769    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  84
* NSRASBL.cbl
  4770                                PIC X(2).
  4771    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4772    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4773    05  F                       PIC X(08) VALUE "~OSTERM=".
  4774    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4775    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4776    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4777    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4778    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4779    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4780    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4781    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4782    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4783    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4784                                PIC X(09).
  4785    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4786    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4787    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4788    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4789    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4790    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4791    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4792    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4793    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4794                                PIC X(09).
  4795    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  4796    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4797    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4798    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4799    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4800                                PIC X(09).
  4801    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4802    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4803    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4804                                PIC X(12).
  4805    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4806    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4807    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4808                                PIC X(10).
  4809    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4810    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4811    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4812    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4813    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  4814                                PIC X(12).
  4815    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  4816    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  4817    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  4818                                PIC X(10).
  4819    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  4820    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  4821    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  4822    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  4823    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  4824    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  4825    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  4826    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  4827    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  85
* NSRASBL.cbl
  4828                                PIC X(09).
  4829    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  4830    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  4831    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  4832                                PIC X(09).
  4833    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  4834    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  4835    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  4836                                PIC X(10).
  4837    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  4838    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  4839    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  4840                                PIC X(10).
  4841    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  4842    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  4843    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  4844    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  4845    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  4846    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  4847    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  4848    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  4849    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  4850    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  4851    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  4852    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  4853    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  4854    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  4855    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  4856                                PIC X(09).
  4857    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  4858    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  4859    05  F                       PIC X(08) VALUE "~NSTERM=".
  4860    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  4861    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  4862                                PIC X(09).
  4863    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  4864    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  4865    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  4866    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  4867    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  4868    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  4869    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  4870    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  4871    05  F                       PIC X(09) VALUE "~BALLOON=".
  4872    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  4873    05  F                       PIC X(10) VALUE "~LEASEIND=".
  4874    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  4875    05  F                       PIC X(09) VALUE "~RESCIND=".
  4876    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  4877    05  F                       PIC X(07) VALUE "~RCD01=".
  4878    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  4879    05  F                       PIC X(07) VALUE "~RCD02=".
  4880    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  4881    05  F                       PIC X(07) VALUE "~RCD03=".
  4882    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  4883    05  F                       PIC X(07) VALUE "~RCD04=".
  4884    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  4885    05  F                       PIC X(07) VALUE "~RCD05=".
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  86
* NSRASBL.cbl
  4886    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  4887    05  F                       PIC X(07) VALUE "~RCD06=".
  4888    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  4889    05  F                       PIC X(07) VALUE "~RCD07=".
  4890    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  4891    05  F                       PIC X(07) VALUE "~RCD08=".
  4892    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  4893    05  F                       PIC X(07) VALUE "~RCD09=".
  4894    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  4895    05  F                       PIC X(07) VALUE "~RCD10=".
  4896    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  4897    05  F                       PIC X(07) VALUE "~RCD11=".
  4898    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  4899    05  F                       PIC X(07) VALUE "~RCD12=".
  4900    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  4901    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  4902    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  4903    05  F                       PIC X(08) VALUE "~ARCHNO=".
  4904    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  4905    05  F                       PIC X(06) VALUE "~FORM=".
  4906    05  OUT-FORM                PIC X(03) VALUE SPACES.
  4907    05  F                       PIC X(09) VALUE "~ENCLINE=".
  4908    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  4909    05  F                       PIC X(08) VALUE "~ATTACH=".
  4910    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  4911    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  4912    05  OUT-STACK               PIC X(10) VALUE SPACES.
  4913    05  F                       PIC X(11) VALUE "~STATENAME=".
  4914    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  4915    05  F                       PIC X(08) VALUE "~PRTNOW=".
  4916    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  4917    05  F                       PIC X(05) VALUE "~NCB=".
  4918    05  OUT-CHGBACK             PIC X     VALUE ' '.
  4919    05  F                       PIC X(8) VALUE "~CSOAMT=".
  4920    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  4921    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  4922    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  4923    05  F                       PIC X(09) VALUE "~LETRTYP=".
  4924    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  4925    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  4926    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  4927    05  F                       PIC X(08) VALUE "~INSBDT=".
  4928    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  4929    05  F                       PIC X(08) VALUE "~JNTBDT=".
  4930    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  4931    05  F                       PIC X(08) VALUE "~TOTINT=".
  4932    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  4933    05  F                       PIC X(8) VALUE "~TOPREM=".
  4934    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  4935    05  F                       PIC X(7) VALUE "~TOREF=".
  4936    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  4937    05  F                       PIC X(7) VALUE "~CANDT=".
  4938    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  4939    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  4940    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  4941    05  F                       PIC X(08) VALUE "~CERTID=".
  4942    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  4943    05  F                       PIC X(08) VALUE "~UNDWID=".
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  87
* NSRASBL.cbl
  4944    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  4945    05  F                       PIC X(8) VALUE "~TNPREM=".
  4946    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  4947    05  F                       PIC X(7) VALUE "~TNREF=".
  4948    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  4949    05  F                       PIC X(8)  VALUE "~COVIND=".
  4950    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  4951    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  4952    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  4953    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  4954    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  4955    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  4956    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  4957    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  4958    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  4959    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  4960    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  4961    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  4962                                PIC X(10).
  4963    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  4964    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4965    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  4966    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4967    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  4968    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4969    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  4970    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4971    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  4972    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4973    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  4974    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4975    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  4976    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  4977    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  4978    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4979    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  4980    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4981    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  4982    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  4983    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  4984    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  4985    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  4986    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4987    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  4988    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4989    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  4990    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  4991    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  4992    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  4993    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  4994    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4995    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  4996    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4997    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  4998    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  4999    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  5000    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  5001    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  88
* NSRASBL.cbl
  5002    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5003    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  5004    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5005    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  5006    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5007    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  5008    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5009    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  5010    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  5011    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  5012    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5013    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  5014    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5015    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  5016    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5017    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  5018    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5019    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  5020    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  5021    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  5022    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5023    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  5024    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5025    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  5026    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5027    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  5028    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  5029    05  F                       PIC X(09) VALUE "~CSONAMT=".
  5030    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  5031    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  5032    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5033    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  5034    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5035    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  5036    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5037    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  5038    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5039    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  5040    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  5041    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  5042    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5043    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5044    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5045    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5046    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5047    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5048    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5049    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5050    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5051    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5052    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5053    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5054    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5055    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5056    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5057    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5058    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5059    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  89
* NSRASBL.cbl
  5060    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5061    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5062    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5063    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5064    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5065    05  F                       PIC X(9)  VALUE "~NXTBSDT=".
  5066    05  OUT-NEXT-BUS-DT         PIC X(21) VALUE SPACES.
  5067    05  F                       PIC X(11) VALUE 'EndOfString'.
  5068    05  f                       pic x(2) value spaces.
  5069*                                COPY ERCARCH.
  5070******************************************************************
  5071*                                                                *
  5072*                            ERCARCH.                            *
  5073*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5074*                            VMOD=2.002                          *
  5075*                                                                *
  5076*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5077*                                                                *
  5078*   FILE TYPE = VSAM,KSDS                                        *
  5079*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5080*                                                                *
  5081*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5082*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5083*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5084*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5085*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5086*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5087*                                                                *
  5088*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5089******************************************************************
  5090*                   C H A N G E   L O G
  5091*
  5092* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5093*-----------------------------------------------------------------
  5094*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5095* EFFECTIVE    NUMBER
  5096*-----------------------------------------------------------------
  5097* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5098* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5099* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5100******************************************************************
  5101 01  LETTER-ARCHIVE.
  5102     12  LA-RECORD-ID                PIC  X(02).
  5103         88  LA-VALID-ID                VALUE 'LA'.
  5104
  5105     12  LA-CONTROL-PRIMARY.
  5106         16  LA-COMPANY-CD           PIC  X(01).
  5107         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5108
  5109     12  LA-CONTROL-BY-CERT-RESP.
  5110         16  LA-COMPANY-CD-A2        PIC  X(01).
  5111         16  LA-CERT-NO-A2.
  5112             20  LA-CERT-PRIME-A2    PIC  X(10).
  5113             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5114         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5115             20  LA-RESP-PERSON-A2   PIC  X(10).
  5116             20  LA-TYPE-A2          PIC  X(01).
  5117         16  LA-CARRIER-A2           PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  90
* NSRASBL.cbl
  5118         16  LA-GROUPING-A2          PIC  X(06).
  5119         16  LA-STATE-A2             PIC  X(02).
  5120         16  LA-ACCOUNT-A2           PIC  X(10).
  5121         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5122         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5123
  5124     12  LA-CONTROL-BY-FORM.
  5125         16  LA-COMPANY-CD-A3        PIC  X(01).
  5126         16  LA-FORM-A3              PIC  X(04).
  5127         16  LA-CARRIER-A3           PIC  X(01).
  5128         16  LA-GROUPING-A3          PIC  X(06).
  5129         16  LA-STATE-A3             PIC  X(02).
  5130         16  LA-ACCOUNT-A3           PIC  X(10).
  5131         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5132
  5133     12  LA-CONTROL-BY-PROCESSOR.
  5134         16  LA-COMPANY-CD-A4        PIC  X(01).
  5135         16  LA-PROCESSOR-CD         PIC  X(04).
  5136         16  LA-CARRIER-A4           PIC  X(01).
  5137         16  LA-GROUPING-A4          PIC  X(06).
  5138         16  LA-STATE-A4             PIC  X(02).
  5139         16  LA-ACCOUNT-A4           PIC  X(10).
  5140         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5141
  5142     12  LA-CONTROL-BY-KEY-FIELDS.
  5143         16  LA-COMPANY-CD-A5        PIC  X(01).
  5144         16  LA-CARRIER-A5           PIC  X(01).
  5145         16  LA-GROUPING-A5          PIC  X(06).
  5146         16  LA-STATE-A5             PIC  X(02).
  5147         16  LA-ACCOUNT-A5           PIC  X(10).
  5148         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5149
  5150     12  LA-CONTROL-BY-GROUP-CODE.
  5151         16  LA-COMPANY-CD-A6        PIC  X(01).
  5152         16  LA-ENTRY-A6.
  5153             20  LA-FILLER           PIC  X(02).
  5154             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5155         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5156
  5157     12  FILLER                      PIC  X(09).
  5158
  5159     12  LA-HEADER-RECORD.
  5160         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5161         16  LA-CREATION-DATE        PIC  X(02).
  5162         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5163         16  LA-FINAL-ACT-DATE       REDEFINES
  5164               LA-FOLLOW-UP-DATE     PIC  X(02).
  5165         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5166         16  LA-NO-OF-COPIES         PIC S9(01).
  5167         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5168         16  LA-REPLY-DATE           PIC  X(02).
  5169         16  LA-RESEND-DATES.
  5170             20  LA-RESEND-DATE      PIC  X(02).
  5171             20  LA-SENT-DATE        PIC  X(02).
  5172             20  FILLER              PIC  X(08).
  5173         16  LA-SOURCE-INFORMATION.
  5174             20  LA-DATA-SOURCE      PIC  X(01).
  5175             20  LA-ADDR-SOURCE      PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  91
* NSRASBL.cbl
  5176         16  LA-STATUS               PIC  X(01).
  5177             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5178             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5179             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5180             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5181             88  LA-STATUS-PURGED         VALUE 'P'.
  5182             88  LA-STATUS-VOIDED         VALUE 'V'.
  5183         16  LA-LAST-RESENT-PRINT-DATE
  5184                                     PIC  X(02).
  5185         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5186             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5187                                          VALUE 'C'.
  5188             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5189                                          VALUE 'F'.
  5190             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5191                                          VALUE 'P'.
  5192         16  LA-PURGED-DATE          PIC  X(02).
  5193         16  LA-VOIDED-DATE          PIC  X(02).
  5194         16  LA-RESEND-LETR          PIC  X(4).
  5195         16  FILLER                  PIC  X(08).
  5196*        16  LA-RESEND-LETR-2        PIC  X(4).
  5197*        16  LA-RESEND-LETR-3        PIC  X(4).
  5198*        16  FILLER                  PIC  X(59).
  5199         16  LA-ARCHIVE-STATUS       PIC  X.
  5200             88  LA-TEMP                VALUE 'T'.
  5201             88  LA-QWS                 VALUE 'Q'.
  5202             88  LA-BATCH               VALUE 'B'.
  5203         16  LA-FINAL-ACT-IND        PIC  X(1).
  5204         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5205         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5206         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5207                                     PIC X(4).
  5208         16  FILLER                  PIC  X(42).
  5209*        16  FILLER                  PIC  X(71).
  5210         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5211         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5212         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5213                                     PIC  X(4).
  5214         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5215
  5216******************************************************************
  5217*                                COPY ELCCRTT.
  5218******************************************************************
  5219*                                                                *
  5220*                            ELCCRTT.                            *
  5221*                                                                *
  5222*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5223*                                                                *
  5224*   FILE TYPE = VSAM,KSDS                                        *
  5225*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5226*                                                                *
  5227*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5228*                                                                *
  5229*   LOG = YES                                                    *
  5230*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5231******************************************************************
  5232*                   C H A N G E   L O G
  5233*
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  92
* NSRASBL.cbl
  5234* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5235*-----------------------------------------------------------------
  5236*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5237* EFFECTIVE    NUMBER
  5238*-----------------------------------------------------------------
  5239* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5240* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5241* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5242* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5243* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5244******************************************************************
  5245
  5246 01  CERTIFICATE-TRAILERS.
  5247     12  CS-RECORD-ID                      PIC XX.
  5248         88  VALID-CS-ID                      VALUE 'CS'.
  5249
  5250     12  CS-CONTROL-PRIMARY.
  5251         16  CS-COMPANY-CD                 PIC X.
  5252         16  CS-CARRIER                    PIC X.
  5253         16  CS-GROUPING                   PIC X(6).
  5254         16  CS-STATE                      PIC XX.
  5255         16  CS-ACCOUNT                    PIC X(10).
  5256         16  CS-CERT-EFF-DT                PIC XX.
  5257         16  CS-CERT-NO.
  5258             20  CS-CERT-PRIME             PIC X(10).
  5259             20  CS-CERT-SFX               PIC X.
  5260         16  CS-TRAILER-TYPE               PIC X.
  5261             88  COMM-TRLR           VALUE 'A'.
  5262             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5263             88  CERT-DATA-TRLR      VALUE 'C'.
  5264
  5265     12  CS-DATA-AREA                      PIC X(516).
  5266
  5267     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5268         16  CS-BANK-COMMISSION-AREA.
  5269             20  CS-BANK-COMMS       OCCURS 10.
  5270                 24  CS-AGT                PIC X(10).
  5271                 24  CS-COM-TYP            PIC X.
  5272                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5273                 24  CS-RECALC-LV-INDIC    PIC X.
  5274                 24  FILLER                PIC X(10).
  5275         16  FILLER                        PIC X(256).
  5276
  5277     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5278****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5279****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5280         16  CS-MB-CLAIM-DATA OCCURS 2.
  5281             20  FILLER OCCURS 10.
  5282                 24  CS-CLAIM-TYPE         PIC X.
  5283                     88  CS-AH-CLM           VALUE 'A'.
  5284                     88  CS-IU-CLM           VALUE 'I'.
  5285                     88  CS-GP-CLM           VALUE 'G'.
  5286                     88  CS-LF-CLM           VALUE 'L'.
  5287                     88  CS-PR-CLM           VALUE 'P'.
  5288                 24  CS-BANK               PIC S999 COMP-3.
  5289                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5290                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5291                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  93
* NSRASBL.cbl
  5292         16  FILLER                        PIC X(216).
  5293     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5294         16  CS-VIN-NUMBER                 PIC X(17).
  5295         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5296         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5297         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5298         16  FILLER                        PIC X(496).
  5299******************************************************************
  5300 01  FILLER                      PIC X(500)  VALUE SPACES.
  5301*                                COPY ELCENCC.
  5302******************************************************************
  5303*                                                                *
  5304*                                                                *
  5305*                            ELCENCC                             *
  5306*                            VMOD=2.001                          *
  5307*                                                                *
  5308*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5309*                                                                *
  5310*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5311*   A NAPERSOFT DOCUMENT                                         *
  5312*                                                                *
  5313*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5314*                                                                *
  5315*   FILE TYPE = VSAM,KSDS                                        *
  5316*   RECORD SIZE = 400   RECFORM = FIX                            *
  5317*                                                                *
  5318*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5319*                                                                *
  5320*   LOG = NO                                                     *
  5321*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5322*                                                                *
  5323*                                                                *
  5324******************************************************************
  5325*                   C H A N G E   L O G
  5326*
  5327* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5328*-----------------------------------------------------------------
  5329*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5330* EFFECTIVE    NUMBER
  5331*-----------------------------------------------------------------
  5332* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5333******************************************************************
  5334 01  ENCLOSURE-CODES.
  5335     12  NC-RECORD-ID                      PIC XX.
  5336         88  VALID-NC-ID                      VALUE 'NC'.
  5337     12  NC-CONTROL-PRIMARY.
  5338         16  NC-COMPANY-CD                 PIC X.
  5339         16  NC-REC-TYPE                   PIC X.
  5340             88  NC-CLAIMS                   VALUE '1'.
  5341             88  NC-ADMIN                    VALUE '2'.
  5342         16  NC-ENC-CODE                   PIC X(5).
  5343         16  FILLER                        PIC X(09).
  5344     12  NC-MAINT-INFORMATION.
  5345         16  NC-LAST-MAINT-DT              PIC XX.
  5346         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5347         16  NC-LAST-MAINT-USER            PIC X(4).
  5348         16  FILLER                        PIC XX.
  5349     12  NC-OUTPUT-STACK                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  94
* NSRASBL.cbl
  5350     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5351     12  NC-ATTACHMENTS                    PIC X(100).
  5352     12  NC-FUTURE                         PIC X(50).
  5353     12  FILLER                            PIC X(117).
  5354******************************************************************
  5355****************************************************************
  5356*
  5357* Copyright (c) 2007 by Clerity Solutions, Inc.
  5358* All rights reserved.
  5359*
  5360****************************************************************
  5361 01  DFHEIV.
  5362   02  DFHEIV0               PIC X(35).
  5363   02  DFHEIV1               PIC X(08).
  5364   02  DFHEIV2               PIC X(08).
  5365   02  DFHEIV3               PIC X(08).
  5366   02  DFHEIV4               PIC X(06).
  5367   02  DFHEIV5               PIC X(04).
  5368   02  DFHEIV6               PIC X(04).
  5369   02  DFHEIV7               PIC X(02).
  5370   02  DFHEIV8               PIC X(02).
  5371   02  DFHEIV9               PIC X(01).
  5372   02  DFHEIV10              PIC S9(7) COMP-3.
  5373   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5374   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5375   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5376   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5377   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5378   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5379   02  DFHEIV17              PIC X(04).
  5380   02  DFHEIV18              PIC X(04).
  5381   02  DFHEIV19              PIC X(04).
  5382   02  DFHEIV20              USAGE IS POINTER.
  5383   02  DFHEIV21              USAGE IS POINTER.
  5384   02  DFHEIV22              USAGE IS POINTER.
  5385   02  DFHEIV23              USAGE IS POINTER.
  5386   02  DFHEIV24              USAGE IS POINTER.
  5387   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5388   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5389   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5390   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5391   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5392   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5393   02  FILLER                PIC X(02).
  5394   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5395   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5396   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5397   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5398   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5399 LINKAGE  SECTION.
  5400*****************************************************************
  5401*                                                               *
  5402* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5403* All rights reserved.                                          *
  5404*                                                               *
  5405*****************************************************************
  5406 01  dfheiblk.
  5407     02  eibtime          pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  95
* NSRASBL.cbl
  5408     02  eibdate          pic s9(7) comp-3.
  5409     02  eibtrnid         pic x(4).
  5410     02  eibtaskn         pic s9(7) comp-3.
  5411     02  eibtrmid         pic x(4).
  5412     02  dfheigdi         pic s9(4) comp.
  5413     02  eibcposn         pic s9(4) comp.
  5414     02  eibcalen         pic s9(4) comp.
  5415     02  eibaid           pic x(1).
  5416     02  eibfiller1       pic x(1).
  5417     02  eibfn            pic x(2).
  5418     02  eibfiller2       pic x(2).
  5419     02  eibrcode         pic x(6).
  5420     02  eibfiller3       pic x(2).
  5421     02  eibds            pic x(8).
  5422     02  eibreqid         pic x(8).
  5423     02  eibrsrce         pic x(8).
  5424     02  eibsync          pic x(1).
  5425     02  eibfree          pic x(1).
  5426     02  eibrecv          pic x(1).
  5427     02  eibsend          pic x(1).
  5428     02  eibatt           pic x(1).
  5429     02  eibeoc           pic x(1).
  5430     02  eibfmh           pic x(1).
  5431     02  eibcompl         pic x(1).
  5432     02  eibsig           pic x(1).
  5433     02  eibconf          pic x(1).
  5434     02  eiberr           pic x(1).
  5435     02  eibrldbk         pic x(1).
  5436     02  eiberrcd         pic x(4).
  5437     02  eibsynrb         pic x(1).
  5438     02  eibnodat         pic x(1).
  5439     02  eibfiller5       pic x(2).
  5440     02  eibresp          pic 9(09) comp.
  5441     02  eibresp2         pic 9(09) comp.
  5442     02  dfheigdj         pic s9(4) comp.
  5443     02  dfheigdk         pic s9(4) comp.
  5444 01 dfhcommarea                  PIC X(6500).
  5445 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  5446 0000-DFHEXIT SECTION.
  5447     MOVE '9#                    $   ' TO DFHEIV0.
  5448     MOVE 'NSRASBL' TO DFHEIV1.
  5449     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5450     display ' entering pgm nsrasbl '
  5451     display ' commarea ' dfhcommarea
  5452     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5453     MOVE '5'                    TO DC-OPTION-CODE
  5454     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5455     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5456     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5457     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5458     move dfhcommarea            to srch-commarea
  5459*****************************************************
  5460* The full       key has been established and passed
  5461* to this program via NSRASLTR
  5462*****************************************************
  5463     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5464     display ' input data ' bl-carrier ' ' bl-group ' '
  5465        bl-account ' ' bl-eff-dt ' ' bl-cert-no
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  96
* NSRASBL.cbl
  5466     MOVE BL-LETTER-ID           TO OUT-LETTER
  5467     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5468     MOVE BL-CARRIER             TO OUT-CARRIER
  5469     MOVE BL-GROUP               TO OUT-GROUPING
  5470     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5471     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5472     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5473     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5474     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5475        DC-EDITA-DAY  DELIMITED BY SIZE
  5476        INTO OUT-CYCLE-DT
  5477     END-STRING
  5478
  5479     MOVE SAVE-BIN-DATE      TO SAVE-BIN-NEXT-BUS-DT
  5480     STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5481        DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5482           INTO OUT-NEXT-BUS-DT
  5483     END-STRING
  5484     MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  5485     MOVE '6'                 TO DC-OPTION-CODE
  5486     IF DC-DAY-OF-WEEK = 6
  5487        MOVE 3                TO DC-ELAPSED-DAYS
  5488     ELSE
  5489        IF DC-DAY-OF-WEEK = 7
  5490           MOVE 2             TO DC-ELAPSED-DAYS
  5491        ELSE
  5492           MOVE 1             TO DC-ELAPSED-DAYS
  5493        END-IF
  5494     END-IF
  5495     PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5496     IF NO-CONVERSION-ERROR
  5497        MOVE DC-BIN-DATE-2    TO SAVE-BIN-NEXT-BUS-DT
  5498        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5499           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5500              INTO OUT-NEXT-BUS-DT
  5501        END-STRING
  5502     END-IF
  5503     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5504        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5505     ELSE
  5506        IF BL-EFF-DT = SPACES
  5507           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5508        ELSE
  5509           IF BL-EFF-DT (9:2) = SPACES
  5510              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5511                     BL-EFF-DT (4:2)
  5512                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5513              END-STRING
  5514           ELSE
  5515              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5516                     BL-EFF-DT (4:2)
  5517                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5518              END-STRING
  5519           END-IF
  5520           MOVE '3'              TO DC-OPTION-CODE
  5521           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5522           IF NO-CONVERSION-ERROR
  5523              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  97
* NSRASBL.cbl
  5524           ELSE
  5525              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5526              SET BL-FAIL TO TRUE
  5527              GO TO 0000-RETURN
  5528           END-IF
  5529        END-IF
  5530     END-IF
  5531     perform 0800-init-out-data  thru 0800-exit
  5532     SET BL-FAIL TO TRUE
  5533******************************************************************
  5534* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5535*    1) FROM ACCT MAINT
  5536*    2) FROM CERT UPDATE
  5537*    3) FROM COMP MAINT
  5538*    4) FROM REVIEW AND CORRECTIONS
  5539******************************************************************
  5540     EVALUATE BL-DATA-SRCE
  5541        WHEN '1'
  5542           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5543        WHEN '2'
  5544           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5545        WHEN '3'
  5546           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5547        WHEN '4'
  5548           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5549        WHEN OTHER
  5550           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5551     END-EVALUATE
  5552     IF BL-OK
  5553        display ' bl write erarch ' bl-write-erarch
  5554        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5555        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5556        IF BL-ARCHIVE-NO = ZEROS
  5557           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5558           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5559           display ' arch zeros, new arch ' bl-archive-no
  5560        END-IF
  5561        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5562        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5563        display ' bl write erarch ' bl-write-erarch
  5564        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5565           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5566           IF BL-FAIL
  5567              GO TO 0000-RETURN
  5568           END-IF
  5569        END-IF
  5570        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5571        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5572     END-IF
  5573     .
  5574 0000-RETURN.
  5575     move srch-commarea          to dfhcommarea
  5576
  5577* exec cics
  5578*       return
  5579*    end-exec
  5580*    MOVE '.(                    ''   #00005572' TO DFHEIV0
  5581     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  98
* NSRASBL.cbl
  5582     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5583     MOVE X'2020233030303035353732' TO DFHEIV0(25:11)
  5584     CALL 'kxdfhei1' USING DFHEIV0,
  5585           DFHEIV99,
  5586           DFHEIV99,
  5587           DFHEIV99,
  5588           DFHEIV99,
  5589           DFHEIV99,
  5590           DFHEIV99
  5591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5592     .
  5593 0100-DATA-SRCE-1.
  5594     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5595     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5596     MOVE ' '                    TO WS-ERACCT-SW
  5597     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5598     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5599     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5600     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5601     MOVE BL-STATE               TO WS-ERACCT-STATE
  5602     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5603     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5604                                    WS-CERT-EFF-DT
  5605     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5606     IF ACCT-FOUND
  5607        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5608        PERFORM 1025-GET-CSR-INFO
  5609                                 THRU 1025-EXIT
  5610        PERFORM 1300-DETERMINE-COMM
  5611                                 THRU 1300-EXIT
  5612        SET BL-OK TO TRUE
  5613     ELSE
  5614        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5615        SET BL-FAIL TO TRUE
  5616     END-IF
  5617     .
  5618 0100-EXIT.
  5619     EXIT.
  5620 0200-DATA-SRCE-2.
  5621     display ' made it to data srce 2 '
  5622     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5623     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5624     MOVE ' '                    TO WS-ELCERT-SW
  5625     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5626     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5627     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5628     MOVE BL-STATE               TO WS-ELCERT-STATE
  5629     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5630     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5631                                    WS-CERT-EFF-DT
  5632     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5633
  5634     MOVE ' '                 TO WS-ERACCT-SW
  5635     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  5636     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5637     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5638     IF ACCT-FOUND
  5639        MOVE AM-CSR-CODE      TO WS-CSR-ID
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page  99
* NSRASBL.cbl
  5640        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  5641     END-IF
  5642     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5643     IF CERT-FOUND
  5644        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5645        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5646        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5647        IF WS-LF-EARN = 'B'
  5648           MOVE 'B'              TO OUT-BALLOON-IND
  5649        END-IF
  5650        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5651        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  5652        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5653        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5654
  5655        IF BL-ENDT-ARCH-NO > ZERO
  5656           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5657           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  5658           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5659        ELSE
  5660           IF BL-ARCHIVE-NO > ZERO
  5661              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5662              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  5663              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5664           END-IF
  5665        END-IF
  5666
  5667        IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5668           AND (OUT-BALLOON-IND = 'B')
  5669           MOVE 'B'              TO OUT-FORM (3:1)
  5670        END-IF
  5671        SET BL-OK TO TRUE
  5672     ELSE
  5673        display ' cert not found ' ws-elcert-cert-no
  5674        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  5675        SET BL-FAIL TO TRUE
  5676     END-IF
  5677     .
  5678 0200-EXIT.
  5679     EXIT.
  5680 0300-DATA-SRCE-3.
  5681     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5682     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  5683     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  5684     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  5685     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  5686     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  5687     IF WS-ERCOMP-ACCOUNT = SPACES
  5688        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  5689        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  5690     ELSE
  5691        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  5692     END-IF
  5693     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  5694     IF RESP-NORMAL
  5695        MOVE CO-CSR-CODE         TO WS-CSR-ID
  5696        PERFORM 1025-GET-CSR-INFO
  5697                                 THRU 1025-EXIT
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 100
* NSRASBL.cbl
  5698        SET BL-OK TO TRUE
  5699     ELSE
  5700        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  5701        SET BL-FAIL TO TRUE
  5702     END-IF
  5703     .
  5704 0300-EXIT.
  5705     EXIT.
  5706 0400-DATA-SRCE-4.
  5707     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  5708     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  5709     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  5710     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  5711     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  5712                                    WS-ELCERT-SW WS-ERENDT-SW
  5713
  5714* EXEC CICS READ
  5715*         DATASET    ('ERPNDB')
  5716*         INTO       (PENDING-BUSINESS)
  5717*         RIDFLD     (WS-ERPNDB-KEY)
  5718*         RESP       (WS-RESPONSE)
  5719*    END-EXEC
  5720     MOVE LENGTH OF
  5721      PENDING-BUSINESS
  5722       TO DFHEIV11
  5723     MOVE 'ERPNDB' TO DFHEIV1
  5724*    MOVE '&"IL       E          (  N#00005696' TO DFHEIV0
  5725     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5726     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5727     MOVE X'204E233030303035363936' TO DFHEIV0(25:11)
  5728     CALL 'kxdfhei1' USING DFHEIV0,
  5729           DFHEIV1,
  5730           PENDING-BUSINESS,
  5731           DFHEIV11,
  5732           WS-ERPNDB-KEY,
  5733           DFHEIV99,
  5734           DFHEIV99,
  5735           DFHEIV99
  5736     MOVE EIBRESP  TO WS-RESPONSE
  5737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5738     IF RESP-NORMAL
  5739        IF PB-RECORD-TYPE = '1' OR '2'
  5740           MOVE PB-CARRIER       TO BL-CARRIER
  5741           MOVE PB-GROUPING      TO BL-GROUP
  5742           MOVE PB-STATE         TO BL-STATE
  5743           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  5744           MOVE PB-CERT-NO       TO BL-CERT-NO
  5745           MOVE PB-CSR-ID        TO WS-CSR-ID
  5746           IF PB-ISSUE
  5747              SET PROCESS-ISSUE TO TRUE
  5748              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  5749              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  5750              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  5751              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  5752           ELSE
  5753              SET PROCESS-CANCEL TO TRUE
  5754              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  5755              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 101
* NSRASBL.cbl
  5756              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  5757              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  5758           END-IF
  5759           PERFORM 1120-MATCH-CARRIER
  5760                                 THRU 1120-EXIT
  5761           PERFORM 1125-MATCH-STATE
  5762                                 THRU 1125-EXIT
  5763           PERFORM 1130-MATCH-BENCDS
  5764                                 THRU 1130-EXIT
  5765           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  5766           MOVE WS-LF-DESC       TO OUT-LF-DESC
  5767                                    OUT-ORIG-LF-DESC
  5768           IF WS-LF-EARN = 'B'
  5769              MOVE 'B'           TO OUT-BALLOON-IND
  5770           END-IF
  5771           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  5772                                    OUT-ORIG-WAIT-PER
  5773           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  5774                                    OUT-ORIG-RET-ELIM
  5775           MOVE WS-AH-DESC       TO OUT-AH-DESC
  5776                                    OUT-ORIG-AH-DESC
  5777           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  5778                                    OUT-ORIG-BEN-DAYS
  5779           PERFORM 1025-GET-CSR-INFO
  5780                                 THRU 1025-EXIT
  5781
  5782           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  5783           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  5784                                 TO WS-ERACCT-KEY (1:22)
  5785           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  5786           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  5787           IF ACCT-FOUND
  5788              MOVE AM-CSR-CODE      TO WS-CSR-ID
  5789              PERFORM 1025-GET-CSR-INFO
  5790                                    THRU 1025-EXIT
  5791              PERFORM 1300-DETERMINE-COMM
  5792                                    THRU 1300-EXIT
  5793           END-IF
  5794
  5795           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  5796                                 TO WS-ELCERT-KEY
  5797           PERFORM 1100-GET-ELCERT
  5798                                 THRU 1100-EXIT
  5799
  5800           IF BL-ENDT-ARCH-NO > ZERO
  5801              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  5802              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  5803              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5804           ELSE
  5805              IF BL-ARCHIVE-NO > ZERO
  5806                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  5807                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  5808                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5809              END-IF
  5810           END-IF
  5811
  5812           SET BL-OK TO TRUE
  5813           IF (PB-STATE = 'KY' OR 'MD' OR 'WI')
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 102
* NSRASBL.cbl
  5814              AND (OUT-BALLOON-IND = 'B')
  5815              MOVE 'B'           TO OUT-FORM (3:1)
  5816           END-IF
  5817        END-IF
  5818     END-IF
  5819     .
  5820 0400-EXIT.
  5821     EXIT.
  5822 0500-SCRUB-DATA.
  5823*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  5824*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  5825*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  5826*   TO A HEX 26 TO GET BY THE DECODER
  5827     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  5828                                 TO M1
  5829     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  5830     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5831        (A1 > M1)
  5832        OR (WS-WORK-FIELD (A1:1) = '*')
  5833        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5834        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5835     END-PERFORM
  5836     IF A1 > M1
  5837        CONTINUE
  5838     ELSE
  5839        MOVE WS-WORK-FIELD (1:A1 - 1)
  5840                                 TO OUT-ACCT-NAME
  5841     END-IF
  5842     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  5843                                 TO M1
  5844     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  5845     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5846        (A1 > M1)
  5847        OR (WS-WORK-FIELD (A1:1) = '*')
  5848        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5849        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5850     END-PERFORM
  5851     IF A1 > M1
  5852        CONTINUE
  5853     ELSE
  5854        MOVE WS-WORK-FIELD (1:A1 - 1)
  5855                                 TO OUT-BENE-NAME
  5856     END-IF
  5857     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  5858         MOVE '0000000000 '  TO OUT-CERT-NO
  5859     END-IF
  5860     MOVE +1 TO M1
  5861     MOVE SPACES TO BL-RECORD-PASSED-DATA
  5862     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  5863                                 TO NS-LEN
  5864     display ' naper output data length ' ns-len
  5865     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5866        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  5867        OR (A1 > NS-LEN)
  5868        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  5869           CONTINUE
  5870        ELSE
  5871           IF NAPER-OUTPUT-DATA (A1:1) = '~'
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 103
* NSRASBL.cbl
  5872              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  5873              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  5874              ADD +1 TO M1
  5875           ELSE
  5876              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  5877                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  5878                 ADD +3 TO M1
  5879              ELSE
  5880                 MOVE NAPER-OUTPUT-DATA (A1:1)
  5881                                 TO BL-RECORD-PASSED-DATA (M1:1)
  5882                 ADD +1 TO M1
  5883              END-IF
  5884           END-IF
  5885        END-IF
  5886     END-PERFORM
  5887     .
  5888 0500-EXIT.
  5889     EXIT.
  5890 0600-GET-ERENDT.
  5891
  5892* EXEC CICS READ
  5893*         DATASET    ('ERENDT2')
  5894*         INTO       (ENDORSEMENT-RECORD)
  5895*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  5896*         RESP       (WS-RESPONSE)
  5897*    END-EXEC
  5898     MOVE LENGTH OF
  5899      ENDORSEMENT-RECORD
  5900       TO DFHEIV11
  5901     MOVE 'ERENDT2' TO DFHEIV1
  5902*    MOVE '&"IL       E          (  N#00005855' TO DFHEIV0
  5903     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5904     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5905     MOVE X'204E233030303035383535' TO DFHEIV0(25:11)
  5906     CALL 'kxdfhei1' USING DFHEIV0,
  5907           DFHEIV1,
  5908           ENDORSEMENT-RECORD,
  5909           DFHEIV11,
  5910           WS-ERENDT-KEY-BY-ARCH,
  5911           DFHEIV99,
  5912           DFHEIV99,
  5913           DFHEIV99
  5914     MOVE EIBRESP  TO WS-RESPONSE
  5915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5916     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  5917         WS-ERENDT-ARCHIVE
  5918     IF (RESP-NORMAL)
  5919        SET ENDT-FOUND TO TRUE
  5920        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  5921        PERFORM 0650-PROCESS-NO-Change
  5922                                 THRU 0650-EXIT
  5923     END-IF
  5924     .
  5925 0600-EXIT.
  5926     EXIT.
  5927 0620-BUILD-ENDT.
  5928     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  5929                                    OUT-NEW-LF-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 104
* NSRASBL.cbl
  5930                                    OUT-ORIG-AH-CAN-DT
  5931                                    OUT-NEW-AH-CAN-DT
  5932                                    OUT-ORIG-CAN-DT
  5933                                    OUT-NEW-CAN-DT
  5934     IF EN-REC-TYPE = 'C'
  5935        GO TO 0620-PROCESS-CANCEL
  5936     END-IF
  5937     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  5938     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  5939     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5940     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  5941     IF WS-LF-EARN = 'B'
  5942        MOVE 'B'                 TO OUT-BALLOON-IND
  5943     END-IF
  5944     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  5945     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  5946     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  5947     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  5948     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  5949     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  5950     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  5951     IF EN-INS-ORIG-AGE-DEF-FLAG = 'Y'
  5952         MOVE ZERO                 TO OUT-ORIG-IAGE
  5953     ELSE
  5954         MOVE EN-INS-ORIG-AGE      TO OUT-ORIG-IAGE
  5955     END-IF
  5956     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  5957     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  5958     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  5959     IF EN-JNT-ORIG-AGE-DEF-FLAG = 'Y'
  5960         MOVE ZERO                 TO OUT-ORIG-JAGE
  5961     ELSE
  5962         MOVE EN-JNT-ORIG-AGE      TO OUT-ORIG-JAGE
  5963     END-IF
  5964     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  5965     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  5966     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  5967     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  5968     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  5969     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  5970     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  5971                             EN-LF-ORIG-ALT-PRM-AMT
  5972     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  5973     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  5974         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  5975                                    OUT-ORIG-LF-PRM-A
  5976                                    OUT-ORIG-LF-ALT-BEN-A
  5977                                    OUT-ORIG-LF-ALT-PRM-A
  5978                                    OUT-ORIG-COVERAGE-IND
  5979     ELSE
  5980         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  5981         IF EN-LF-ORIG-PRM-AMT = .01
  5982             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  5983         END-IF
  5984         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  5985             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  5986         END-IF
  5987         IF EN-LF-ORIG-ALT-PRM-AMT = .01
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 105
* NSRASBL.cbl
  5988             MOVE SPACES         TO OUT-ORIG-LF-ALT-PRM-A
  5989         END-IF
  5990         IF EN-LF-ORIG-ALT-BEN-AMT = 999999999.99
  5991             MOVE SPACES         TO OUT-ORIG-LF-ALT-BEN-A
  5992         END-IF
  5993     END-IF
  5994     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  5995     MOVE ' '                    TO DC-OPTION-CODE
  5996     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5997     IF NO-CONVERSION-ERROR
  5998        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5999           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6000              INTO OUT-ORIG-LF-EXP-DT
  6001        END-STRING
  6002     END-IF
  6003     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  6004     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  6005     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  6006     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  6007     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6008         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  6009                                    OUT-ORIG-AH-PRM-A
  6010     ELSE
  6011        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  6012            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  6013        ELSE
  6014            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  6015        END-IF
  6016        IF EN-AH-ORIG-PRM-AMT = .01
  6017            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  6018        END-IF
  6019        IF EN-AH-ORIG-BEN-AMT = 9999999.99
  6020            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
  6021        END-IF
  6022     END-IF
  6023     COMPUTE WS-WORK-PREM =
  6024        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  6025           + EN-AH-ORIG-PRM-AMT
  6026     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  6027     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6028     MOVE ' '                    TO DC-OPTION-CODE
  6029     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6030     IF NO-CONVERSION-ERROR
  6031        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6032           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6033              INTO OUT-ORIG-AH-EXP-DT
  6034        END-STRING
  6035     END-IF
  6036     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  6037                                    OUT-ORIG-MAX-PMTS
  6038     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6039         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  6040     END-IF
  6041     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  6042     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  6043     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  6044     IF EN-INS-NEW-AGE-DEF-FLAG = 'Y'
  6045         MOVE ZERO                TO OUT-NEW-IAGE
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 106
* NSRASBL.cbl
  6046     ELSE
  6047         MOVE EN-INS-NEW-AGE      TO OUT-NEW-IAGE
  6048     END-IF
  6049     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  6050     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  6051     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  6052     IF EN-JNT-NEW-AGE-DEF-FLAG = 'Y'
  6053         MOVE ZERO                TO OUT-NEW-JAGE
  6054     ELSE
  6055         MOVE EN-JNT-NEW-AGE      TO OUT-NEW-JAGE
  6056     END-IF
  6057     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  6058     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  6059     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6060     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  6061     IF WS-LF-EARN = 'B'
  6062        MOVE 'B'                 TO OUT-BALLOON-IND
  6063     END-IF
  6064     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  6065     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  6066     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  6067     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  6068     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  6069     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  6070     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  6071     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  6072     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  6073     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  6074     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  6075                             EN-LF-NEW-ALT-PRM-AMT
  6076     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  6077     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  6078         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  6079                                    OUT-NEW-LF-PRM-A
  6080                                    OUT-NEW-LF-ALT-BEN-A
  6081                                    OUT-NEW-LF-ALT-PRM-A
  6082                                    OUT-NEW-LF-CMB-PREM-A
  6083                                    OUT-NEW-COVERAGE-IND
  6084     ELSE
  6085         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  6086     END-IF
  6087    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  6088     MOVE ' '                     TO DC-OPTION-CODE
  6089     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6090     IF NO-CONVERSION-ERROR
  6091        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6092           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6093              INTO OUT-NEW-LF-EXP-DT
  6094        END-STRING
  6095     END-IF
  6096     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  6097     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  6098     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  6099     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  6100     COMPUTE WS-WORK-PREM =
  6101        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  6102           + EN-AH-NEW-PRM-AMT
  6103     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 107
* NSRASBL.cbl
  6104     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6105         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  6106                                    OUT-NEW-AH-PRM-A
  6107     ELSE
  6108        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  6109            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  6110        ELSE
  6111            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  6112        END-IF
  6113     END-IF
  6114     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  6115     MOVE ' '                     TO DC-OPTION-CODE
  6116     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6117     IF NO-CONVERSION-ERROR
  6118        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6119           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6120              INTO OUT-NEW-AH-EXP-DT
  6121        END-STRING
  6122     END-IF
  6123     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  6124                                     OUT-NEW-MAX-PMTS
  6125     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6126         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  6127     END-IF
  6128     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  6129        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6130     ELSE
  6131        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6132     END-IF
  6133     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  6134        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6135     ELSE
  6136        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6137     END-IF
  6138     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  6139        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6140     ELSE
  6141        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6142     END-IF
  6143     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  6144        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6145     ELSE
  6146        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6147     END-IF
  6148     COMPUTE WS-WORK-PREM =
  6149        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6150        EN-AH-NEW-PRM-AMT) -
  6151        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  6152        EN-AH-ORIG-PRM-AMT)
  6153     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  6154     IF EN-CSO-PORTION NOT NUMERIC
  6155        MOVE ZEROS               TO EN-CSO-PORTION
  6156     END-IF
  6157     IF EN-ACCT-PORTION NOT NUMERIC
  6158        MOVE ZERO                TO EN-ACCT-PORTION
  6159     END-IF
  6160*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6161*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 108
* NSRASBL.cbl
  6162     IF WS-WORK-PREM > +0
  6163        MOVE 'CSO'               TO OUT-PAYEE
  6164     ELSE
  6165      IF WS-WORK-PREM = +0
  6166         MOVE 'ZERO'             TO OUT-PAYEE
  6167      ELSE
  6168         MOVE 'ACCT'             TO OUT-PAYEE
  6169      END-IF
  6170     END-IF
  6171     COMPUTE WS-ACCT-ORIG-LF-PORT =
  6172        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6173     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  6174     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  6175        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6176     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6177     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6178        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6179        * EN-LF-ORIG-COMM-PCT
  6180     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6181     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6182        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6183     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6184     COMPUTE WS-ACCT-ORIG-PORTION =
  6185        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6186     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6187
  6188     COMPUTE WS-CSO-ORIG-LF-PORT =
  6189       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6190     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6191     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6192       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6193     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6194     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6195       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6196        WS-ACCT-ORIG-CMB-LF-PORT
  6197     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6198     COMPUTE WS-CSO-ORIG-AH-PORT =
  6199        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6200     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6201     COMPUTE WS-CSO-ORIG-PORTION =
  6202        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6203     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6204     COMPUTE WS-ACCT-NEW-LF-PORT =
  6205        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6206     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6207     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6208        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6209     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6210     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6211        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6212        * EN-LF-NEW-COMM-PCT
  6213     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6214     COMPUTE WS-ACCT-NEW-AH-PORT =
  6215        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6216     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6217     COMPUTE WS-ACCT-NEW-PORTION =
  6218        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6219     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 109
* NSRASBL.cbl
  6220
  6221     COMPUTE WS-CSO-NEW-LF-PORT =
  6222       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6223     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6224     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6225       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6226     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6227     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6228       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6229        WS-ACCT-NEW-CMB-LF-PORT
  6230     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6231     COMPUTE WS-CSO-NEW-AH-PORT =
  6232        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6233     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6234     COMPUTE WS-CSO-NEW-PORTION =
  6235        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6236     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6237
  6238     COMPUTE WS-ACCT-LF-PORT-CHG =
  6239        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6240     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6241     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6242        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6243     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6244     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6245        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6246     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6247     COMPUTE WS-ACCT-AH-PORT-CHG =
  6248        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6249     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6250     COMPUTE WS-ACCT-PORTION-CHG =
  6251        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6252     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6253
  6254     COMPUTE WS-CSO-LF-PORT-CHG =
  6255        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6256     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6257     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6258        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6259     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6260     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6261        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6262     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6263     COMPUTE WS-CSO-AH-PORT-CHG =
  6264        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6265     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6266     COMPUTE WS-CSO-PORTION-CHG =
  6267        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6268     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6269
  6270     COMPUTE WS-WORK-PREM =
  6271         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6272     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6273     COMPUTE WS-WORK-PREM =
  6274         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6275     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6276     COMPUTE WS-WORK-PREM =
  6277        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 110
* NSRASBL.cbl
  6278        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6279     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6280     COMPUTE WS-WORK-PREM =
  6281        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6282     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6283
  6284     move en-sig-sw              to out-sig-sw
  6285     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6286     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6287     GO TO 0620-CONTINUE
  6288     .
  6289 0620-PROCESS-CANCEL.
  6290     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6291        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6292        MOVE ' '                 TO DC-OPTION-CODE
  6293        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6294        IF NO-CONVERSION-ERROR
  6295           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6296              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6297                 INTO OUT-ORIG-LF-CAN-DT
  6298           END-STRING
  6299        END-IF
  6300        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6301     END-IF
  6302
  6303     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6304        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6305        MOVE ' '                 TO DC-OPTION-CODE
  6306        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6307        IF NO-CONVERSION-ERROR
  6308           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6309              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6310                 INTO OUT-NEW-LF-CAN-DT
  6311           END-STRING
  6312        END-IF
  6313        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6314     END-IF
  6315
  6316     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6317        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6318        MOVE ' '                    TO DC-OPTION-CODE
  6319        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6320        IF NO-CONVERSION-ERROR
  6321           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6322              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6323                 INTO OUT-ORIG-AH-CAN-DT
  6324           END-STRING
  6325        END-IF
  6326        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6327           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6328        END-IF
  6329     END-IF
  6330
  6331     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6332        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6333        MOVE ' '                    TO DC-OPTION-CODE
  6334        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6335        IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 111
* NSRASBL.cbl
  6336           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6337              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6338                 INTO OUT-NEW-AH-CAN-DT
  6339           END-STRING
  6340        END-IF
  6341        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6342           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6343        END-IF
  6344     END-IF
  6345     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6346     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6347     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6348     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6349     COMPUTE WS-WORK-PREM =
  6350        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6351     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6352     COMPUTE WS-WORK-PREM =
  6353        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6354     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6355     COMPUTE WS-WORK-PREM =
  6356        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6357        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6358     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6359
  6360     COMPUTE WS-WORK-PREM =
  6361        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6362     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6363     COMPUTE WS-WORK-PREM =
  6364        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6365     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6366
  6367*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6368*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6369     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6370
  6371     IF EN-COMM-CHGBK = 'N'
  6372         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6373                                   OUT-CSO-ORIG-ALT-LF-PORT
  6374         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6375         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6376         COMPUTE WS-CSO-ORIG-PORTION =
  6377             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6378         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6379         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6380                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6381                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6382                                   OUT-ACCT-ORIG-AH-PORT
  6383                                   OUT-ACCT-ORIG-PORTION
  6384
  6385         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6386                                   OUT-CSO-NEW-ALT-LF-PORT
  6387         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6388         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6389         COMPUTE WS-CSO-NEW-PORTION =
  6390             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6391         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6392         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6393                                   OUT-ACCT-NEW-ALT-LF-PORT
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 112
* NSRASBL.cbl
  6394                                   OUT-ACCT-NEW-CMB-LF-PORT
  6395                                   OUT-ACCT-NEW-AH-PORT
  6396                                   OUT-ACCT-NEW-PORTION
  6397
  6398         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6399                                   OUT-CSO-ALT-LF-PORT-CHG
  6400         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6401           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6402         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6403         COMPUTE WS-CSO-AH-PORT-CHG =
  6404           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6405         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6406         COMPUTE WS-CSO-PORTION-CHG =
  6407           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6408           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6409         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6410         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6411                                   OUT-ACCT-ALT-LF-PORT-CHG
  6412                                   OUT-ACCT-CMB-LF-PORT-CHG
  6413                                   OUT-ACCT-AH-PORT-CHG
  6414                                   OUT-ACCT-PORTION-CHG
  6415     ELSE
  6416         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6417                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6418         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6419           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6420         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6421                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6422         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6423           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6424         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6425         COMPUTE WS-ACCT-ORIG-PORTION =
  6426            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6427         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6428
  6429         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6430                                   OUT-CSO-ORIG-ALT-LF-PORT
  6431         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6432           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6433         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6434         COMPUTE WS-CSO-ORIG-AH-PORT =
  6435           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
  6436         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6437         COMPUTE WS-CSO-ORIG-PORTION =
  6438            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6439         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6440
  6441         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6442                                   OUT-ACCT-NEW-ALT-LF-PORT
  6443         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6444           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6445         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6446         COMPUTE WS-ACCT-NEW-AH-PORT =
  6447           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6448         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6449         COMPUTE WS-ACCT-NEW-PORTION =
  6450            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6451         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 113
* NSRASBL.cbl
  6452
  6453         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6454                                   OUT-CSO-NEW-ALT-LF-PORT
  6455         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6456           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6457         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6458         COMPUTE WS-CSO-NEW-AH-PORT =
  6459           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6460         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6461         COMPUTE WS-CSO-NEW-PORTION =
  6462            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6463         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6464
  6465         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6466                                    OUT-ACCT-ALT-LF-PORT-CHG
  6467         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6468            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6469         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6470         COMPUTE WS-ACCT-AH-PORT-CHG =
  6471            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6472         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6473         COMPUTE WS-ACCT-PORTION-CHG =
  6474            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6475         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6476
  6477         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6478                                    OUT-CSO-ALT-LF-PORT-CHG
  6479         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6480            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6481         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6482         COMPUTE WS-CSO-AH-PORT-CHG =
  6483            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6484         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6485         COMPUTE WS-CSO-PORTION-CHG =
  6486            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6487         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6488
  6489     END-IF
  6490     .
  6491 0620-CONTINUE.
  6492     display ' about to bld reason codes ' en-reason-code (1)
  6493     move en-reason-code (1)     to out-rea-cd1
  6494     move en-reason-code (2)     to out-rea-cd2
  6495     move en-reason-code (3)     to out-rea-cd3
  6496     move en-reason-code (4)     to out-rea-cd4
  6497     move en-reason-code (5)     to out-rea-cd5
  6498     move en-reason-code (6)     to out-rea-cd6
  6499     move en-reason-code (7)     to out-rea-cd7
  6500     move en-reason-code (8)     to out-rea-cd8
  6501     move en-reason-code (9)     to out-rea-cd9
  6502     move en-reason-code (10)    to out-rea-cd10
  6503     move en-reason-code (11)    to out-rea-cd11
  6504     move en-reason-code (12)    to out-rea-cd12
  6505*    PERFORM 1300-DETERMINE-COMM
  6506*                                THRU 1300-EXIT
  6507     .
  6508 0620-EXIT.
  6509     EXIT.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 114
* NSRASBL.cbl
  6510 0650-PROCESS-NO-Change.
  6511     IF EN-REC-TYPE = 'C'
  6512        GO TO 0650-PROCESS-CANCEL
  6513     END-IF
  6514     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6515        AND (OUT-NEW-ILNAME NOT = SPACES))
  6516                      AND
  6517        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6518        AND (OUT-NEW-IFNAME NOT = SPACES))
  6519                      AND
  6520        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6521        AND (OUT-NEW-IFNAME NOT = SPACES))
  6522        move 'No Change'         to out-new-Ifname
  6523        MOVE SPACES              TO OUT-NEW-IMINIT
  6524        move spaces              to out-new-Ilname
  6525     ELSE
  6526         IF OUT-NEW-ILNAME = SPACES
  6527           AND OUT-NEW-IFNAME = SPACES
  6528           AND OUT-NEW-IMINIT = SPACES
  6529           AND OUT-ORIG-ILNAME NOT = SPACES
  6530            MOVE 'None'          TO OUT-NEW-IFNAME
  6531            MOVE SPACES          TO OUT-NEW-IMINIT
  6532            MOVE SPACES          TO OUT-NEW-ILNAME
  6533         END-IF
  6534     END-IF
  6535     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6536        AND (OUT-NEW-JLNAME NOT = SPACES))
  6537                    AND
  6538        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6539        AND (OUT-NEW-JFNAME NOT = SPACES))
  6540                    AND
  6541        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6542        AND (OUT-NEW-JFNAME NOT = SPACES))
  6543        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6544        MOVE SPACES              TO OUT-NEW-JMINIT
  6545        MOVE SPACES              TO OUT-NEW-JLNAME
  6546     ELSE
  6547         IF OUT-NEW-JLNAME = SPACES
  6548           AND OUT-NEW-JFNAME = SPACES
  6549           AND OUT-NEW-JMINIT = SPACES
  6550           AND OUT-ORIG-JLNAME NOT = SPACES
  6551            MOVE 'None'          TO OUT-NEW-JFNAME
  6552            MOVE SPACES          TO OUT-NEW-JMINIT
  6553            MOVE SPACES          TO OUT-NEW-JLNAME
  6554         END-IF
  6555     END-IF
  6556     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6557        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6558        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6559     ELSE
  6560         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6561           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6562             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6563         END-IF
  6564     END-IF
  6565     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6566        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6567        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 115
* NSRASBL.cbl
  6568     ELSE
  6569         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6570           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6571             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6572         END-IF
  6573     END-IF
  6574     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6575        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6576        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6577     ELSE
  6578         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6579           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6580             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6581         END-IF
  6582     END-IF
  6583     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6584        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6585        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  6586     ELSE
  6587         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6588           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6589             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6590         END-IF
  6591     END-IF
  6592
  6593     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6594                              EN-LF-ORIG-ALT-PRM-AMT
  6595     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6596                               EN-LF-NEW-ALT-PRM-AMT
  6597     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6598        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6599        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6600     ELSE
  6601         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6602           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6603            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6604         END-IF
  6605     END-IF
  6606     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6607        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6608     END-IF
  6609     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  6610        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6611        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6612     END-IF
  6613     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6614        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6615        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6616     ELSE
  6617        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6618          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6619            MOVE 'None'          TO OUT-NEW-LF-DESC
  6620        END-IF
  6621     end-if
  6622     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6623       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6624        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6625     END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 116
* NSRASBL.cbl
  6626     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6627        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  6628        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  6629     ELSE
  6630         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6631           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6632             MOVE ZEROS          TO OUT-NEW-AH-BEN
  6633         END-IF
  6634     END-IF
  6635     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  6636        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  6637        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  6638     ELSE
  6639         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6640           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6641             MOVE ZEROS          TO OUT-NEW-AH-PRM
  6642         END-IF
  6643     END-IF
  6644     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  6645        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  6646        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  6647     ELSE
  6648         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6649           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6650             MOVE 'None'         TO OUT-NEW-AH-DESC
  6651         END-IF
  6652     END-IF
  6653     IF EN-INS-ORIG-AGE-DEF-FLAG <> 'Y'
  6654         MOVE 'N' TO EN-INS-ORIG-AGE-DEF-FLAG
  6655     END-IF
  6656     IF EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6657         MOVE 'N' TO EN-INS-NEW-AGE-DEF-FLAG
  6658     END-IF
  6659     IF EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y'
  6660         MOVE 'N' TO EN-JNT-ORIG-AGE-DEF-FLAG
  6661     END-IF
  6662     IF EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6663         MOVE 'N' TO EN-JNT-NEW-AGE-DEF-FLAG
  6664     END-IF
  6665
  6666     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  6667       AND EN-INS-NEW-AGE-DEF-FLAG = EN-INS-ORIG-AGE-DEF-FLAG
  6668       AND EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6669       AND EN-INS-NEW-LAST-NAME = EN-INS-ORIG-LAST-NAME
  6670       AND EN-INS-NEW-FIRST-NAME = EN-INS-ORIG-FIRST-NAME
  6671       AND EN-INS-NEW-MIDDLE-INIT = EN-INS-ORIG-MIDDLE-INIT
  6672        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  6673     END-IF
  6674     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  6675        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  6676        AND EN-JNT-NEW-AGE-DEF-FLAG = EN-JNT-ORIG-AGE-DEF-FLAG
  6677        AND EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6678        AND EN-JNT-NEW-LAST-NAME = EN-JNT-ORIG-LAST-NAME
  6679        AND EN-JNT-NEW-FIRST-NAME = EN-JNT-ORIG-FIRST-NAME
  6680        AND EN-JNT-NEW-MIDDLE-INIT = EN-JNT-ORIG-MIDDLE-INIT
  6681        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  6682     ELSE
  6683         IF (EN-JNT-ORIG-AGE > ZEROS)
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 117
* NSRASBL.cbl
  6684           AND (EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y')
  6685           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  6686             MOVE 'None'         TO OUT-NEW-JAGE-A
  6687         END-IF
  6688     END-IF
  6689     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  6690        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  6691        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  6692     ELSE
  6693         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6694           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6695             MOVE ZEROS          TO OUT-NEW-LF-TERM
  6696         END-IF
  6697     END-IF
  6698     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  6699        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  6700        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  6701     ELSE
  6702         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6703           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6704             MOVE ZEROS          TO OUT-NEW-AH-TERM
  6705         END-IF
  6706     END-IF
  6707     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  6708        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6709        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  6710                                    OUT-NEW-MAX-PMTS-A
  6711     ELSE
  6712         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6713           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6714             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  6715                                    OUT-NEW-MAX-PMTS-A
  6716         END-IF
  6717     END-IF
  6718     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  6719        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  6720     END-IF
  6721     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  6722       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  6723         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  6724     ELSE
  6725         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6726           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6727             MOVE 'None'         TO OUT-NEW-WAIT-PER
  6728         END-IF
  6729     END-IF
  6730     .
  6731 0650-PROCESS-CANCEL.
  6732     .
  6733 0650-EXIT.
  6734     EXIT.
  6735 0700-WRITE-EXTR.
  6736     display ' made it to 0700 '
  6737     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  6738     IF BL-FAIL
  6739        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  6740        GO TO 0700-EXIT
  6741     END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 118
* NSRASBL.cbl
  6742     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  6743     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  6744     MOVE +0                     TO NSAS-SEQ-NO
  6745     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  6746     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  6747     IF BL-FAIL
  6748        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  6749        GO TO 0700-EXIT
  6750     END-IF
  6751     IF W-LETTER-TO-ACCT NOT = SPACES
  6752        display ' acct ne spaces ' bl-archive-no
  6753        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  6754        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6755        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6756        MOVE +1                  TO NSAS-SEQ-NO
  6757        PERFORM 0720-WRITE-NSASEXTR
  6758                                 THRU 0720-EXIT
  6759        IF BL-FAIL
  6760           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  6761           GO TO 0700-EXIT
  6762        END-IF
  6763     END-IF
  6764     IF W-LETTER-TO-BENE NOT = SPACES
  6765        display ' bene ne spaces ' bl-archive-no
  6766        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  6767        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6768        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6769        MOVE +2                  TO NSAS-SEQ-NO
  6770        PERFORM 0720-WRITE-NSASEXTR
  6771                                 THRU 0720-EXIT
  6772        IF BL-FAIL
  6773           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  6774        END-IF
  6775     END-IF
  6776     IF W-PRINT-CERTIFICATE = 'Y' AND
  6777        BL-STATE = 'VA'
  6778           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  6779           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  6780           MOVE BL-CARRIER          TO VD-CARRIER
  6781           MOVE BL-GROUP            TO VD-GROUPING
  6782           MOVE BL-STATE            TO VD-STATE
  6783           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  6784           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  6785           MOVE BL-CERT-NO          TO VD-CERT-NO
  6786           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  6787           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  6788           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  6789           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  6790           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  6791           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  6792           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  6793           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  6794           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  6795           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  6796           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  6797           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  6798           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  6799           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 119
* NSRASBL.cbl
  6800           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  6801           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  6802           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  6803           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  6804           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  6805           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  6806           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  6807           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  6808           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  6809           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  6810           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  6811           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  6812           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  6813           MOVE 'VADS'              TO VD-LETTER-ID
  6814           MOVE OUT-PROC-ID         TO VD-PROC-ID
  6815           MOVE BL-COMP-ID          TO VD-COMP-ID
  6816           MOVE EIBTIME             TO VD-CURRENT-TIME
  6817           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  6818           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  6819           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  6820
  6821* EXEC CICS LINK
  6822*              PROGRAM    (LINK-ELVADS)
  6823*              COMMAREA   (WS-PASS-AREA)
  6824*              LENGTH     (WS-PASS-AREA-LENGTH)
  6825*          END-EXEC
  6826*    MOVE '."C                   (   #00006765' TO DFHEIV0
  6827     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6828     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6829     MOVE X'2020233030303036373635' TO DFHEIV0(25:11)
  6830     CALL 'kxdfhei1' USING DFHEIV0,
  6831           LINK-ELVADS,
  6832           WS-PASS-AREA,
  6833           WS-PASS-AREA-LENGTH,
  6834           DFHEIV99,
  6835           DFHEIV99,
  6836           DFHEIV99,
  6837           DFHEIV99
  6838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6839     END-IF
  6840     .
  6841 0700-EXIT.
  6842     EXIT.
  6843  0710-BUILD-NSASEXTR.
  6844***  i added the extra space in front of the 1st ~
  6845***  only because there may be a letter to acct or bene
  6846     STRING
  6847         OUT-LETTER             ' ~'
  6848         OUT-PROC-ID            '~'
  6849         OUT-PROC-NAME          '~'
  6850         OUT-PROC-TITLE         '~'
  6851         OUT-CSR-NAME           '~'
  6852         OUT-CSR-TITLE          '~'
  6853         OUT-CARRIER            '~'
  6854         OUT-GROUPING           '~'
  6855         OUT-STATE              '~'
  6856         OUT-ACCOUNT            '~'
  6857         OUT-CERT-EFF-DT        '~'
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 120
* NSRASBL.cbl
  6858         OUT-CERT-NO            '~'
  6859         OUT-CERT-SFX           '~'
  6860         OUT-ILNAME             '~'
  6861         OUT-IFNAME             '~'
  6862         OUT-IFINIT             '~'
  6863         OUT-IMINIT             '~'
  6864         OUT-IAGE               '~'
  6865         OUT-ISEX               '~'
  6866         OUT-INS-ADDR1          '~'
  6867         OUT-INS-ADDR2          '~'
  6868         OUT-INS-CITY           '~'
  6869         OUT-INS-STATE          '~'
  6870         OUT-INS-ZIP            '~'
  6871         OUT-SOC-SEC-NO         '~'
  6872         OUT-MEMBER-NO          '~'
  6873         OUT-JLNAME             '~'
  6874         OUT-JFNAME             '~'
  6875         OUT-JMINIT             '~'
  6876         OUT-JAGE               '~'
  6877         OUT-ACCT-NAME          '~'
  6878         OUT-ACCT-ADDR1         '~'
  6879         OUT-ACCT-ADDR2         '~'
  6880         OUT-ACCT-CITY          '~'
  6881         OUT-ACCT-STATE         '~'
  6882         OUT-ACCT-ZIP           '~'
  6883         OUT-ACCT-PHONE         '~'
  6884         OUT-ACCT-CNTRL-NAME    '~'
  6885         OUT-ACCT-BUS-TYPE      '~'
  6886         OUT-BENE-NAME          '~'
  6887         OUT-BENE-ADDR1         '~'
  6888         OUT-BENE-ADDR2         '~'
  6889         OUT-BENE-CITY          '~'
  6890         OUT-BENE-STATE         '~'
  6891         OUT-BENE-ZIP           '~'
  6892         OUT-CARR-NAME          '~'
  6893         OUT-RESP-NO            '~'
  6894         OUT-COMP-NAME          '~'
  6895         OUT-COMP-MAIL-TO       '~'
  6896         OUT-COMP-ADDR1         '~'
  6897         OUT-COMP-ADDR2         '~'
  6898         OUT-COMP-CITY          '~'
  6899         OUT-COMP-STATE         '~'
  6900         OUT-COMP-ZIP           '~'
  6901         OUT-COMP-PHONE         '~'
  6902         OUT-COMP-FAX           '~'
  6903         OUT-COMP-STATUS        '~'
  6904         OUT-BILL-SW            '~'
  6905         OUT-RPT-CD1            '~'
  6906         OUT-RPT-CD2            '~'
  6907         OUT-ENTRY-DT           '~'
  6908         OUT-ENTRY-BATCH        '~'
  6909         OUT-ENTRY-STATUS       '~'
  6910         OUT-1ST-PMT-DT         '~'
  6911         OUT-LOAN-APR           '~'
  6912         OUT-LOAN-TERM          '~'
  6913         OUT-RATE-CLASS         '~'
  6914         OUT-EXT-DAYS           '~'
  6915         OUT-CSR-CODE           '~'
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 121
* NSRASBL.cbl
  6916         OUT-UCODE              '~'
  6917         OUT-PREM-TYPE          '~'
  6918         OUT-IND-GRP            '~'
  6919         OUT-SKIP-CD            '~'
  6920         OUT-PMT-MODE           '~'
  6921         OUT-LOAN-OFF           '~'
  6922         OUT-REIN-TABLE         '~'
  6923         OUT-SPEC-REIN          '~'
  6924         OUT-LF-BENCD           '~'
  6925         OUT-LF-TERM            '~'
  6926         OUT-LF-DEV-CD          '~'
  6927         OUT-LF-DEV-PCT         '~'
  6928         OUT-LF-BEN             '~'
  6929         OUT-LF-PRM             '~'
  6930         OUT-LF-ALT-BEN         '~'
  6931         OUT-LF-ALT-PRM         '~'
  6932         OUT-LF-NSP             '~'
  6933         OUT-LF-REM-BEN         '~'
  6934         OUT-LF-REF             '~'
  6935         OUT-LF-DTH             '~'
  6936         OUT-LF-RATE            '~'
  6937         OUT-LF-ALT-RATE        '~'
  6938         OUT-LF-EXP-DT          '~'
  6939         OUT-LF-CUR-STATUS      '~'
  6940         OUT-LF-CAN-DT          '~'
  6941         OUT-LF-CAN-EXIT-DT     '~'
  6942         OUT-LF-DTH-DT          '~'
  6943         OUT-LF-DTH-EXIT-DT     '~'
  6944         OUT-LF-EXIT-BATCH      '~'
  6945         OUT-LF-COMM-PCT        '~'
  6946         OUT-LF-DESC            '~'
  6947         OUT-LF-ABBRV           '~'
  6948         OUT-AH-BENCD           '~'
  6949         OUT-AH-TERM            '~'
  6950         OUT-CRIT-PER           '~'
  6951         OUT-AH-DEV-CD          '~'
  6952         OUT-AH-DEV-PCT         '~'
  6953         OUT-AH-BEN             '~'
  6954         OUT-AH-PRM             '~'
  6955         OUT-AH-NSP             '~'
  6956         OUT-AH-REF             '~'
  6957         OUT-AH-CLM             '~'
  6958         OUT-AH-TOT-BEN         '~'
  6959         OUT-AH-PDTHRU-DT       '~'
  6960         OUT-AH-RATE            '~'
  6961         OUT-AH-EXP-DT          '~'
  6962         OUT-AH-CUR-STATUS      '~'
  6963         OUT-AH-CAN-DT          '~'
  6964         OUT-AH-CAN-EXIT-DT     '~'
  6965         OUT-AH-EXIT-BATCH      '~'
  6966         OUT-AH-COMM-PCT        '~'
  6967         OUT-AH-DESC            '~'
  6968         OUT-RET-ELIM           '~'
  6969         OUT-BEN-DAYS           '~'
  6970         OUT-WAIT-PER           '~'
  6971         OUT-MAX-PMTS           '~'
  6972         OUT-TOT-PRM            '~'
  6973         OUT-TOT-REF            '~'
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 122
* NSRASBL.cbl
  6974         OUT-SCHED-EXP-DT       '~'
  6975         OUT-SCHED-TERM         '~'
  6976         OUT-ORIG-ILNAME        '~'
  6977         OUT-ORIG-IFNAME        '~'
  6978         OUT-ORIG-MINIT         '~'
  6979         OUT-ORIG-IAGE          '~'
  6980         OUT-ORIG-JLNAME        '~'
  6981         OUT-ORIG-JFNAME        '~'
  6982         OUT-ORIG-JMINIT        '~'
  6983         OUT-ORIG-JAGE          '~'
  6984         OUT-ORIG-LF-BENCD      '~'
  6985         OUT-ORIG-LF-TERM       '~'
  6986         OUT-ORIG-LF-BEN        '~'
  6987         OUT-ORIG-LF-PRM        '~'
  6988         OUT-LF-CALC-PRM        '~'
  6989         OUT-ORIG-LF-REF        '~'
  6990         OUT-LF-CALC-REF        '~'
  6991         OUT-ORIG-LF-ALT-BEN    '~'
  6992         OUT-ORIG-LF-ALT-PRM    '~'
  6993         OUT-ORIG-LF-EXP-DT     '~'
  6994         OUT-ORIG-LF-DESC       '~'
  6995         OUT-ORIG-AH-BENCD      '~'
  6996         OUT-ORIG-AH-TERM       '~'
  6997         OUT-ORIG-CRIT-PER      '~'
  6998         OUT-ORIG-AH-BEN        '~'
  6999         OUT-ORIG-AH-PRM        '~'
  7000         OUT-AH-CALC-PRM        '~'
  7001         OUT-ORIG-AH-REF        '~'
  7002         OUT-AH-CALC-REF        '~'
  7003         OUT-ORIG-AH-EXP-DT     '~'
  7004         OUT-ORIG-AH-DESC       '~'
  7005         OUT-ORIG-RET-ELIM      '~'
  7006         OUT-ORIG-BEN-DAYS      '~'
  7007         OUT-ORIG-WAIT-PER      '~'
  7008         OUT-ORIG-MAX-PMTS      '~'
  7009         OUT-ORIG-SCHED-EXP-DT  '~'
  7010         OUT-ORIG-SCHED-TERM    '~'
  7011         OUT-NEW-ILNAME         '~'
  7012         OUT-NEW-IFNAME         '~'
  7013         OUT-NEW-IMINIT         '~'
  7014         OUT-NEW-IAGE           '~'
  7015         OUT-NEW-JLNAME         '~'
  7016         OUT-NEW-JFNAME         '~'
  7017         OUT-NEW-JMINIT         '~'
  7018         OUT-NEW-JAGE           '~'
  7019         OUT-NEW-LF-BENCD       '~'
  7020         OUT-NEW-LF-TERM        '~'
  7021         OUT-NEW-LF-BEN         '~'
  7022         OUT-NEW-LF-PRM         '~'
  7023         OUT-NEW-LF-REF         '~'
  7024         OUT-NEW-LF-ALT-BEN     '~'
  7025         OUT-NEW-LF-ALT-PRM     '~'
  7026         OUT-NEW-LF-EXP-DT      '~'
  7027         OUT-NEW-LF-DESC        '~'
  7028         OUT-NEW-AH-BENCD       '~'
  7029         OUT-NEW-AH-TERM        '~'
  7030         OUT-NEW-CRIT-PER       '~'
  7031         OUT-NEW-AH-BEN         '~'
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 123
* NSRASBL.cbl
  7032         OUT-NEW-AH-PRM         '~'
  7033         OUT-NEW-AH-REF         '~'
  7034         OUT-NEW-AH-EXP-DT      '~'
  7035         OUT-NEW-AH-DESC        '~'
  7036         OUT-NEW-RET-ELIM       '~'
  7037         OUT-NEW-BEN-DAYS       '~'
  7038         OUT-NEW-WAIT-PER       '~'
  7039         OUT-NEW-MAX-PMTS       '~'
  7040         OUT-NEW-SCHED-EXP-DT   '~'
  7041         OUT-NEW-SCHED-TERM     '~'
  7042         OUT-TOT-PRM-CHG        '~'
  7043         OUT-TOT-REF-CHG        '~'
  7044         OUT-PAYEE              '~'
  7045         OUT-SIG-SW             '~'
  7046         OUT-BALLOON-IND        '~'
  7047         OUT-LEASE-IND          '~'
  7048         OUT-RESCIND            '~'
  7049         OUT-REA-CD1            '~'
  7050         OUT-REA-CD2            '~'
  7051         OUT-REA-CD3            '~'
  7052         OUT-REA-CD4            '~'
  7053         OUT-REA-CD5            '~'
  7054         OUT-REA-CD6            '~'
  7055         OUT-REA-CD7            '~'
  7056         OUT-REA-CD8            '~'
  7057         OUT-REA-CD9            '~'
  7058         OUT-REA-CD10           '~'
  7059         OUT-REA-CD11           '~'
  7060         OUT-REA-CD12           '~'
  7061         OUT-CYCLE-DT           '~'
  7062         OUT-ARCH-NO            '~'
  7063         OUT-FORM               '~'
  7064         OUT-ENC-LINE           '~'
  7065         OUT-ATTACH             '~'
  7066         OUT-STACK              '~'
  7067         OUT-STATE-NAME         '~'
  7068         OUT-PRINT-NOW          '~'
  7069         OUT-CHGBACK            '~'
  7070         OUT-CSO-PORTION        '~'
  7071         OUT-ACCT-PORTION       '~'
  7072         OUT-LETTER-TYPE        '~'
  7073         OUT-PRINT-CERTIFICATE  '~'
  7074         OUT-INS-BIRTHDATE      '~'
  7075         OUT-JNT-BIRTHDATE      '~'
  7076         OUT-TOT-INTEREST       '~'
  7077         OUT-ORIG-TOT-PREM      '~'
  7078         OUT-ORIG-TOT-REF       '~'
  7079         OUT-CANCEL-DT          '~'
  7080         OUT-HEALTH-APP         '~'
  7081         OUT-CERTIFICATE-ID     '~'
  7082         OUT-UNDW-ID            '~'
  7083         OUT-NEW-TOT-PREM       '~'
  7084         OUT-NEW-TOT-REF        '~'
  7085         OUT-COVERAGE-IND       '~'
  7086         OUT-ORIG-COVERAGE-IND  '~'
  7087         OUT-NEW-COVERAGE-IND   '~'
  7088         OUT-LF-CMB-PREM        '~'
  7089         OUT-ORIG-LF-CMB-PREM   '~'
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 124
* NSRASBL.cbl
  7090         OUT-NEW-LF-CMB-PREM    '~'
  7091         OUT-LF-PREM-CHG        '~'
  7092         OUT-LF-ALT-PREM-CHG    '~'
  7093         OUT-LF-CMB-PREM-CHG    '~'
  7094         OUT-AH-PREM-CHG        '~'
  7095         OUT-LF-REF-CHG         '~'
  7096         OUT-AH-REF-CHG         '~'
  7097         OUT-ACCT-LF-PORTION    '~'
  7098         OUT-ACCT-ALT-LF-PORT   '~'
  7099         OUT-ACCT-CMB-LF-PORT   '~'
  7100         OUT-ACCT-AH-PORTION    '~'
  7101         OUT-CSO-LF-PORTION     '~'
  7102         OUT-CSO-ALT-LF-PORT    '~'
  7103         OUT-CSO-CMB-LF-PORT    '~'
  7104         OUT-CSO-AH-PORTION     '~'
  7105         OUT-ACCT-ORIG-LF-PORT  '~'
  7106         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  7107         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  7108         OUT-ACCT-ORIG-AH-PORT  '~'
  7109         OUT-ACCT-ORIG-PORTION  '~'
  7110         OUT-CSO-ORIG-LF-PORT   '~'
  7111         OUT-CSO-ORIG-ALT-LF-PORT '~'
  7112         OUT-CSO-ORIG-CMB-LF-PORT '~'
  7113         OUT-CSO-ORIG-AH-PORT   '~'
  7114         OUT-CSO-ORIG-PORTION   '~'
  7115         OUT-ACCT-NEW-LF-PORT   '~'
  7116         OUT-ACCT-NEW-ALT-LF-PORT '~'
  7117         OUT-ACCT-NEW-CMB-LF-PORT '~'
  7118         OUT-ACCT-NEW-AH-PORT   '~'
  7119         OUT-ACCT-NEW-PORTION   '~'
  7120         OUT-CSO-NEW-LF-PORT    '~'
  7121         OUT-CSO-NEW-ALT-LF-PORT '~'
  7122         OUT-CSO-NEW-CMB-LF-PORT '~'
  7123         OUT-CSO-NEW-AH-PORT    '~'
  7124         OUT-CSO-NEW-PORTION    '~'
  7125         OUT-ACCT-LF-PORT-CHG   '~'
  7126         OUT-ACCT-ALT-LF-PORT-CHG '~'
  7127         OUT-ACCT-CMB-LF-PORT-CHG '~'
  7128         OUT-ACCT-AH-PORT-CHG   '~'
  7129         OUT-ACCT-PORTION-CHG   '~'
  7130         OUT-CSO-LF-PORT-CHG    '~'
  7131         OUT-CSO-ALT-LF-PORT-CHG '~'
  7132         OUT-CSO-CMB-LF-PORT-CHG '~'
  7133         OUT-CSO-AH-PORT-CHG    '~'
  7134         OUT-CSO-PORTION-CHG    '~'
  7135         OUT-ORIG-LF-CAN-DT     '~'
  7136         OUT-NEW-LF-CAN-DT      '~'
  7137         OUT-ORIG-AH-CAN-DT     '~'
  7138         OUT-NEW-AH-CAN-DT      '~'
  7139         OUT-ORIG-CAN-DT        '~'
  7140         OUT-NEW-CAN-DT         '~'
  7141         OUT-SCREEN-ID          '~'
  7142         OUT-NEXT-BUS-DT        '~'
  7143            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  7144     END-STRING
  7145     .
  7146 0710-exit.
  7147     EXIT.
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 125
* NSRASBL.cbl
  7148 0720-WRITE-NSASEXTR.
  7149
  7150* EXEC CICS WRITE
  7151*       DATASET    ('NSASEXTR')
  7152*       FROM       (NSAS-EXTRACT-RECORD)
  7153*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  7154*       RESP       (WS-RESPONSE)
  7155*    END-EXEC
  7156     MOVE LENGTH OF
  7157      NSAS-EXTRACT-RECORD
  7158       TO DFHEIV11
  7159     MOVE 'NSASEXTR' TO DFHEIV1
  7160*    MOVE '&$ L                  ''  N#00007080' TO DFHEIV0
  7161     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7162     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7163     MOVE X'204E233030303037303830' TO DFHEIV0(25:11)
  7164     CALL 'kxdfhei1' USING DFHEIV0,
  7165           DFHEIV1,
  7166           NSAS-EXTRACT-RECORD,
  7167           DFHEIV11,
  7168           NSAS-CONTROL-PRIMARY,
  7169           DFHEIV99,
  7170           DFHEIV99
  7171     MOVE EIBRESP  TO WS-RESPONSE
  7172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7173     IF NOT RESP-NORMAL
  7174        display ' bad write nsasextr ' ws-response
  7175        SET BL-FAIL TO TRUE
  7176     END-IF
  7177     .
  7178 0720-EXIT.
  7179     EXIT.
  7180 0800-init-out-data.
  7181     MOVE ZEROS                  TO OUT-IAGE
  7182                                    OUT-JAGE
  7183                                    OUT-LOAN-APR
  7184                                    OUT-LOAN-TERM
  7185                                    OUT-EXT-DAYS
  7186                                    OUT-LF-TERM
  7187                                    OUT-AH-TERM
  7188                                    OUT-LF-DEV-PCT
  7189                                    OUT-AH-DEV-PCT
  7190                                    OUT-LF-BEN
  7191                                    OUT-AH-BEN
  7192                                    OUT-CRIT-PER
  7193                                    OUT-MAX-PMTS
  7194                                    OUT-SCHED-TERM
  7195                                    OUT-ORIG-IAGE
  7196                                    OUT-ORIG-JAGE
  7197                                    OUT-NEW-IAGE
  7198                                    OUT-NEW-JAGE
  7199                                    OUT-ORIG-LF-TERM
  7200                                    OUT-ORIG-AH-TERM
  7201                                    OUT-NEW-LF-TERM
  7202                                    OUT-NEW-AH-TERM
  7203                                    OUT-ORIG-CRIT-PER
  7204                                    OUT-ORIG-MAX-PMTS
  7205                                    OUT-ORIG-SCHED-TERM
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 126
* NSRASBL.cbl
  7206                                    OUT-NEW-SCHED-TERM
  7207                                    OUT-NEW-CRIT-PER
  7208                                    OUT-NEW-MAX-PMTS
  7209                                    OUT-CSO-PORTION
  7210                                    OUT-CSO-LF-PORTION
  7211                                    OUT-CSO-ALT-LF-PORT
  7212                                    OUT-CSO-CMB-LF-PORT
  7213                                    OUT-CSO-AH-PORTION
  7214                                    OUT-ACCT-PORTION
  7215                                    OUT-ACCT-LF-PORTION
  7216                                    OUT-ACCT-ALT-LF-PORT
  7217                                    OUT-ACCT-CMB-LF-PORT
  7218                                    OUT-ACCT-AH-PORTION
  7219                                    OUT-LF-PREM-CHG
  7220                                    OUT-LF-ALT-PREM-CHG
  7221                                    OUT-LF-CMB-PREM-CHG
  7222                                    OUT-AH-PREM-CHG
  7223                                    OUT-LF-REF-CHG
  7224                                    OUT-AH-REF-CHG
  7225     .
  7226 0800-exit.
  7227     exit.
  7228 1000-BUILD-ERARCH.
  7229* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7230*    1) FROM ACCT MAINT
  7231*    2) FROM CERT UPDATE
  7232*    3) FROM COMP MAINT
  7233*    4) FROM REVIEW AND CORRECTIONS
  7234******************************************************************
  7235     MOVE 'LA'                   TO LETTER-ARCHIVE
  7236     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7237                                    LA-ARCHIVE-NO-A2
  7238                                    LA-ARCHIVE-NO-A3
  7239                                    LA-ARCHIVE-NO-A4
  7240                                    LA-ARCHIVE-NO-A5
  7241                                    LA-ARCHIVE-NO-A6
  7242     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7243                                    LA-COMPANY-CD-A2
  7244                                    LA-COMPANY-CD-A3
  7245                                    LA-COMPANY-CD-A4
  7246                                    LA-COMPANY-CD-A5
  7247                                    LA-COMPANY-CD-A6
  7248     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7249                                    LA-CARRIER-A3
  7250                                    LA-CARRIER-A4
  7251                                    LA-CARRIER-A5
  7252     MOVE BL-GROUP               TO LA-GROUPING-A2
  7253                                    LA-GROUPING-A3
  7254                                    LA-GROUPING-A4
  7255                                    LA-GROUPING-A5
  7256     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7257                                    LA-ACCOUNT-A3
  7258                                    LA-ACCOUNT-A4
  7259                                    LA-ACCOUNT-A5
  7260     MOVE BL-STATE               TO LA-STATE-A2
  7261                                    LA-STATE-A3
  7262                                    LA-STATE-A4
  7263                                    LA-STATE-A5
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 127
* NSRASBL.cbl
  7264     IF BL-DATA-SRCE = '2' OR '4'
  7265        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7266        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7267     ELSE
  7268        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7269     END-IF
  7270     IF BL-DATA-SRCE = '4'
  7271        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7272     END-IF
  7273     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7274                                    LA-LAST-UPDATED-BY
  7275     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7276                                    LA-INITIAL-PRINT-DATE
  7277                                    LA-SENT-DATE
  7278                                    LA-REPLY-DATE
  7279                                    LA-RESEND-DATE
  7280                                    LA-FOLLOW-UP-DATE
  7281     MOVE 'A'                    TO LA-STATUS
  7282     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7283     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7284     IF W-DAYS-TO-RESEND NOT NUMERIC
  7285        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7286     END-IF
  7287     IF W-DAYS-TO-RESEND > ZEROS
  7288        MOVE SAVE-BIN-NEXT-BUS-DT TO DC-BIN-DATE-1
  7289        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7290        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7291        MOVE '6'                 TO DC-OPTION-CODE
  7292        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7293        IF NO-CONVERSION-ERROR
  7294           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7295        END-IF
  7296     END-IF
  7297     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7298        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7299        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7300        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7301        MOVE '6'                 TO DC-OPTION-CODE
  7302        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7303        IF NO-CONVERSION-ERROR
  7304           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
  7305        END-IF
  7306     END-IF
  7307
  7308     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7309     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7310     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7311     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7312     IF BL-ENDT-ARCH-NO > ZEROS
  7313        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7314     ELSE
  7315        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7316     END-IF
  7317     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7318                                    LA-LAST-MAINT-DATE
  7319     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7320                                    LA-NO-OF-TEXT-RECORDS
  7321     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 128
* NSRASBL.cbl
  7322
  7323* EXEC CICS WRITE
  7324*         DATASET   ('ERARCH')
  7325*         FROM      (LETTER-ARCHIVE)
  7326*         RIDFLD    (LA-CONTROL-PRIMARY)
  7327*         RESP      (WS-RESPONSE)
  7328*    END-EXEC
  7329     MOVE LENGTH OF
  7330      LETTER-ARCHIVE
  7331       TO DFHEIV11
  7332     MOVE 'ERARCH' TO DFHEIV1
  7333*    MOVE '&$ L                  ''  N#00007235' TO DFHEIV0
  7334     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7335     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7336     MOVE X'204E233030303037323335' TO DFHEIV0(25:11)
  7337     CALL 'kxdfhei1' USING DFHEIV0,
  7338           DFHEIV1,
  7339           LETTER-ARCHIVE,
  7340           DFHEIV11,
  7341           LA-CONTROL-PRIMARY,
  7342           DFHEIV99,
  7343           DFHEIV99
  7344     MOVE EIBRESP  TO WS-RESPONSE
  7345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7346     IF NOT RESP-NORMAL
  7347        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7348        la-archive-no
  7349        SET BL-FAIL TO TRUE
  7350     END-IF
  7351     .
  7352 1000-EXIT.
  7353     EXIT.
  7354 1025-GET-CSR-INFO.
  7355     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7356                                    OUT-CSR-TITLE
  7357                                    OUT-PROC-TITLE
  7358                                    OUT-UNDW-ID
  7359     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7360     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7361     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7362     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7363
  7364* EXEC CICS READ
  7365*       INTO    (CONTROL-FILE)
  7366*       DATASET ('ELCNTL')
  7367*       RIDFLD  (WS-ELCNTL-KEY)
  7368*       RESP    (WS-RESPONSE)
  7369*    END-EXEC
  7370     MOVE LENGTH OF
  7371      CONTROL-FILE
  7372       TO DFHEIV11
  7373     MOVE 'ELCNTL' TO DFHEIV1
  7374*    MOVE '&"IL       E          (  N#00007258' TO DFHEIV0
  7375     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7377     MOVE X'204E233030303037323538' TO DFHEIV0(25:11)
  7378     CALL 'kxdfhei1' USING DFHEIV0,
  7379           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 129
* NSRASBL.cbl
  7380           CONTROL-FILE,
  7381           DFHEIV11,
  7382           WS-ELCNTL-KEY,
  7383           DFHEIV99,
  7384           DFHEIV99,
  7385           DFHEIV99
  7386     MOVE EIBRESP  TO WS-RESPONSE
  7387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7388     IF RESP-NORMAL
  7389        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7390                                    OUT-PROC-NAME
  7391*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7392*                                   OUT-PROC-TITLE
  7393     END-IF
  7394     IF BL-PROC-ID NOT = PB-CSR-ID
  7395        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7396        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7397        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7398                                    OUT-PROC-TITLE
  7399        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7400
  7401* EXEC CICS READ
  7402*          INTO    (CONTROL-FILE)
  7403*          DATASET ('ELCNTL')
  7404*          RIDFLD  (WS-ELCNTL-KEY)
  7405*          RESP    (WS-RESPONSE)
  7406*       END-EXEC
  7407     MOVE LENGTH OF
  7408      CONTROL-FILE
  7409       TO DFHEIV11
  7410     MOVE 'ELCNTL' TO DFHEIV1
  7411*    MOVE '&"IL       E          (  N#00007276' TO DFHEIV0
  7412     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7413     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7414     MOVE X'204E233030303037323736' TO DFHEIV0(25:11)
  7415     CALL 'kxdfhei1' USING DFHEIV0,
  7416           DFHEIV1,
  7417           CONTROL-FILE,
  7418           DFHEIV11,
  7419           WS-ELCNTL-KEY,
  7420           DFHEIV99,
  7421           DFHEIV99,
  7422           DFHEIV99
  7423     MOVE EIBRESP  TO WS-RESPONSE
  7424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7425        IF RESP-NORMAL
  7426           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7427*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7428        END-IF
  7429     END-IF
  7430     .
  7431 1025-EXIT.
  7432     EXIT.
  7433 1050-GET-ERMAIL.
  7434     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7435
  7436* EXEC CICS READ
  7437*         DATASET    ('ERMAIL')
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 130
* NSRASBL.cbl
  7438*         INTO       (MAILING-DATA)
  7439*         RIDFLD     (WS-ERMAIL-KEY)
  7440*         RESP       (WS-RESPONSE)
  7441*    END-EXEC
  7442     MOVE LENGTH OF
  7443      MAILING-DATA
  7444       TO DFHEIV11
  7445     MOVE 'ERMAIL' TO DFHEIV1
  7446*    MOVE '&"IL       E          (  N#00007292' TO DFHEIV0
  7447     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7448     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7449     MOVE X'204E233030303037323932' TO DFHEIV0(25:11)
  7450     CALL 'kxdfhei1' USING DFHEIV0,
  7451           DFHEIV1,
  7452           MAILING-DATA,
  7453           DFHEIV11,
  7454           WS-ERMAIL-KEY,
  7455           DFHEIV99,
  7456           DFHEIV99,
  7457           DFHEIV99
  7458     MOVE EIBRESP  TO WS-RESPONSE
  7459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7460     IF RESP-NORMAL
  7461        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7462        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7463        MOVE MA-CITY             TO OUT-INS-CITY
  7464        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7465        MOVE MA-ZIP              TO OUT-INS-ZIP
  7466        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7467        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7468        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7469        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7470        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7471        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7472        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7473           MOVE MA-INSURED-BIRTH-DT
  7474                                 TO DC-BIN-DATE-1
  7475           MOVE ' '              TO DC-OPTION-CODE
  7476           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7477           IF NO-CONVERSION-ERROR
  7478              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7479                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7480                INTO OUT-INS-BIRTHDATE
  7481              END-STRING
  7482           END-IF
  7483        END-IF
  7484        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7485           MOVE MA-JOINT-BIRTH-DT
  7486                                 TO DC-BIN-DATE-1
  7487           MOVE ' '              TO DC-OPTION-CODE
  7488           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7489           IF NO-CONVERSION-ERROR
  7490              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7491                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7492                INTO OUT-JNT-BIRTHDATE
  7493              END-STRING
  7494           END-IF
  7495        END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 131
* NSRASBL.cbl
  7496     END-IF
  7497     .
  7498 1050-EXIT.
  7499     EXIT.
  7500 1100-GET-ELCERT.
  7501
  7502* EXEC CICS READ
  7503*         DATASET    ('ELCERT')
  7504*         INTO       (CERTIFICATE-MASTER)
  7505*         RIDFLD     (WS-ELCERT-KEY)
  7506*         RESP       (WS-RESPONSE)
  7507*    END-EXEC.
  7508     MOVE LENGTH OF
  7509      CERTIFICATE-MASTER
  7510       TO DFHEIV11
  7511     MOVE 'ELCERT' TO DFHEIV1
  7512*    MOVE '&"IL       E          (  N#00007339' TO DFHEIV0
  7513     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7515     MOVE X'204E233030303037333339' TO DFHEIV0(25:11)
  7516     CALL 'kxdfhei1' USING DFHEIV0,
  7517           DFHEIV1,
  7518           CERTIFICATE-MASTER,
  7519           DFHEIV11,
  7520           WS-ELCERT-KEY,
  7521           DFHEIV99,
  7522           DFHEIV99,
  7523           DFHEIV99
  7524     MOVE EIBRESP  TO WS-RESPONSE
  7525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7526
  7527     IF RESP-NORMAL
  7528        SET CERT-FOUND TO TRUE
  7529        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7530        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7531     END-IF
  7532     .
  7533 1100-EXIT.
  7534     EXIT.
  7535 1110-BUILD-CERT.
  7536     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
  7537     MOVE SPACES                 TO OUT-COVERAGE-IND
  7538     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7539     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7540     MOVE CM-CARRIER             TO OUT-CARRIER
  7541     MOVE CM-GROUPING            TO OUT-GROUPING
  7542     MOVE CM-STATE               TO OUT-STATE
  7543     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7544     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7545     MOVE ' '                    TO DC-OPTION-CODE
  7546     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7547     IF NO-CONVERSION-ERROR
  7548        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7549           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7550              INTO OUT-CERT-EFF-DT
  7551        END-STRING
  7552     END-IF
  7553     MOVE CM-CERT-NO             TO OUT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 132
* NSRASBL.cbl
  7554     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7555                                    OUT-ORIG-ILNAME
  7556     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7557     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7558                                    OUT-ORIG-MINIT
  7559     IF (CM-SSN-STATE = CM-STATE)
  7560        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7561        MOVE SPACES              TO OUT-SOC-SEC-NO
  7562     ELSE
  7563        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7564     END-IF
  7565     IF (CM-MEMB-STATE = CM-STATE)
  7566        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7567        MOVE SPACES              TO OUT-MEMBER-NO
  7568     ELSE
  7569        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7570     END-IF
  7571     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7572                                    OUT-ORIG-IFNAME
  7573     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7574                                    OUT-ORIG-IAGE
  7575     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7576     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7577                                    OUT-ORIG-JAGE
  7578     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7579                                    OUT-ORIG-JLNAME
  7580     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7581                                    OUT-ORIG-JFNAME
  7582     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7583                                    OUT-ORIG-JMINIT
  7584     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7585                                    OUT-ORIG-LF-BENCD
  7586     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7587                                    OUT-ORIG-LF-TERM
  7588     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7589     IF CM-LF-DEV-PCT NOT NUMERIC
  7590        MOVE ZEROS               TO CM-LF-DEV-PCT
  7591     END-IF
  7592     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7593     PERFORM 1160-READ-CERT-TRAILER THRU 1160-EXIT
  7594     IF NOT CERT-TRL-REC-NOT-FOUND
  7595         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
  7596             MOVE ZERO           TO OUT-IAGE
  7597                                    OUT-ORIG-IAGE
  7598         END-IF
  7599         IF CS-JNT-AGE-DEFAULT-FLAG = 'Y'
  7600             MOVE ZERO           TO OUT-JAGE
  7601                                    OUT-ORIG-JAGE
  7602         END-IF
  7603     END-IF
  7604
  7605     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7606        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7607          ((CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES) OR
  7608           (CM-LF-DEATH-DT NOT = LOW-VALUES AND SPACES))
  7609             MOVE SPACES          TO OUT-LF-BENCD
  7610                                     WS-LF-BENCD
  7611                                     OUT-LF-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 133
* NSRASBL.cbl
  7612             MOVE ZEROS           TO OUT-LF-TERM
  7613                                     OUT-LF-BEN
  7614                                     OUT-LF-PRM
  7615                                     OUT-LF-ALT-BEN
  7616                                     OUT-LF-ALT-PRM
  7617                                     OUT-LF-COMM-PCT
  7618                                     OUT-LF-NSP
  7619                                     OUT-LF-REM-BEN
  7620                                     WS-WORK-LF-PREM
  7621                                     WS-WORK-ALT-LF-PREM
  7622                                     WS-WORK-CMB-LF-PREM
  7623                                     OUT-LF-REF
  7624                                     OUT-ORIG-LF-REF
  7625                                     WS-WORK-LF-REF
  7626             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7627             GO TO 1100-LF-CONT
  7628        END-IF
  7629     END-IF
  7630
  7631     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7632        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7633             MOVE SPACES          TO OUT-LF-BENCD
  7634                                     WS-LF-BENCD
  7635                                     OUT-LF-CAN-DT
  7636             MOVE ZEROS           TO OUT-LF-TERM
  7637                                     OUT-LF-BEN
  7638                                     OUT-LF-PRM
  7639                                     OUT-LF-ALT-BEN
  7640                                     OUT-LF-ALT-PRM
  7641                                     OUT-LF-COMM-PCT
  7642                                     OUT-LF-NSP
  7643                                     OUT-LF-REM-BEN
  7644                                     WS-WORK-LF-PREM
  7645                                     WS-WORK-ALT-LF-PREM
  7646                                     WS-WORK-CMB-LF-PREM
  7647                                     OUT-LF-REF
  7648                                     OUT-ORIG-LF-REF
  7649                                     WS-WORK-LF-REF
  7650             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7651             GO TO 1100-LF-CONT
  7652        END-IF
  7653     END-IF
  7654     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  7655         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  7656                                    OUT-ORIG-COVERAGE-IND
  7657     END-IF
  7658
  7659     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  7660     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  7661                                    OUT-ORIG-LF-BEN
  7662     IF CM-LF-BENEFIT-AMT = 999999999.99
  7663        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
  7664     END-IF
  7665     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  7666                                    OUT-ORIG-LF-PRM
  7667                                    WS-WORK-LF-PREM
  7668     IF CM-LF-PREMIUM-AMT = .01
  7669         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 134
* NSRASBL.cbl
  7670     END-IF
  7671     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  7672        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  7673     END-IF
  7674     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  7675                                    OUT-ORIG-LF-ALT-BEN
  7676     IF CM-LF-ALT-BENEFIT-AMT = 999999999.99
  7677        MOVE SPACES              TO OUT-ORIG-LF-ALT-BEN-A
  7678     END-IF
  7679     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  7680        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  7681     END-IF
  7682     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  7683                                    OUT-ORIG-LF-ALT-PRM
  7684                                    WS-WORK-ALT-LF-PREM
  7685     IF CM-LF-ALT-PREMIUM-AMT = .01
  7686         MOVE SPACES             TO OUT-ORIG-LF-ALT-PRM-A
  7687     END-IF
  7688     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  7689                             CM-LF-ALT-PREMIUM-AMT
  7690     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  7691                                 OUT-ORIG-LF-CMB-PREM
  7692                                 WS-WORK-CMB-LF-PREM
  7693     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  7694        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  7695     END-IF
  7696     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  7697     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  7698     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  7699                                    OUT-ORIG-LF-REF
  7700                                    WS-WORK-LF-REF
  7701     IF CM-LF-DEATH-CLAIM-APPLIED
  7702        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7703            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  7704                                    OUT-ORIG-LF-REF
  7705                                    WS-WORK-LF-REF
  7706     END-IF
  7707     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  7708     MOVE ' '                    TO DC-OPTION-CODE
  7709     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7710     IF NO-CONVERSION-ERROR
  7711        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7712           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7713              INTO OUT-LF-CAN-DT
  7714        END-STRING
  7715     END-IF
  7716
  7717     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7718         MOVE ZEROS          TO WS-WORK-LF-PREM
  7719                                WS-WORK-ALT-LF-PREM
  7720                                WS-WORK-CMB-LF-PREM
  7721     END-IF
  7722
  7723      .
  7724 1100-LF-CONT.
  7725
  7726     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  7727     IF CM-LF-PREMIUM-RATE NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 135
* NSRASBL.cbl
  7728        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  7729     END-IF
  7730     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  7731     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  7732        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  7733     END-IF
  7734     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  7735     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7736        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7737          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7738              MOVE SPACES              TO OUT-AH-BENCD
  7739                                          WS-AH-BENCD
  7740                                          OUT-AH-CAN-DT
  7741              MOVE ZEROS               TO OUT-AH-TERM
  7742                                          OUT-AH-BEN
  7743                                          OUT-AH-PRM
  7744                                          OUT-AH-NSP
  7745                                          OUT-AH-COMM-PCT
  7746                                          OUT-CRIT-PER
  7747                                          WS-WORK-AH-PREM
  7748                                          OUT-AH-REF
  7749                                          OUT-ORIG-AH-REF
  7750                                          WS-WORK-AH-REF
  7751              MOVE SPACES              TO OUT-MAX-PMTS-A
  7752                                          OUT-WAIT-PER
  7753                                          OUT-RET-ELIM
  7754                                          OUT-AH-DESC
  7755                                          OUT-BEN-DAYS
  7756              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7757             GO TO 1100-AH-CONT
  7758        END-IF
  7759     END-IF
  7760
  7761     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7762        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7763              MOVE SPACES              TO OUT-AH-BENCD
  7764                                          WS-AH-BENCD
  7765                                          OUT-AH-CAN-DT
  7766              MOVE ZEROS               TO OUT-AH-TERM
  7767                                          OUT-AH-BEN
  7768                                          OUT-AH-PRM
  7769                                          OUT-AH-NSP
  7770                                          OUT-AH-COMM-PCT
  7771                                          OUT-CRIT-PER
  7772                                          WS-WORK-AH-PREM
  7773                                          OUT-AH-REF
  7774                                          OUT-ORIG-AH-REF
  7775                                          WS-WORK-AH-REF
  7776              MOVE SPACES              TO OUT-MAX-PMTS-A
  7777                                          OUT-WAIT-PER
  7778                                          OUT-RET-ELIM
  7779                                          OUT-AH-DESC
  7780                                          OUT-BEN-DAYS
  7781              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7782             GO TO 1100-AH-CONT
  7783        END-IF
  7784     END-IF
  7785     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 136
* NSRASBL.cbl
  7786     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  7787                                    OUT-ORIG-AH-BENCD
  7788     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  7789        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  7790           CM-AH-BENEFIT-AMT
  7791        IF OUT-COVERAGE-IND = 'LIFE'
  7792            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  7793                                    OUT-ORIG-COVERAGE-IND
  7794        ELSE
  7795            MOVE 'AH  '          TO OUT-COVERAGE-IND
  7796                                    OUT-ORIG-COVERAGE-IND
  7797        END-IF
  7798     ELSE
  7799        MOVE ZEROS               TO OUT-AH-TOT-BEN
  7800     END-IF
  7801     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  7802                                    OUT-ORIG-AH-TERM
  7803     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  7804                                    OUT-ORIG-CRIT-PER
  7805                                    OUT-MAX-PMTS
  7806                                    OUT-ORIG-MAX-PMTS
  7807     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  7808         MOVE SPACES             TO OUT-MAX-PMTS-A
  7809     END-IF
  7810     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  7811     IF CM-AH-DEV-PCT NOT NUMERIC
  7812        MOVE ZEROS               TO CM-AH-DEV-PCT
  7813     END-IF
  7814     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  7815     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  7816                                    OUT-ORIG-AH-BEN
  7817     IF CM-AH-BENEFIT-AMT = 9999999.99
  7818        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  7819     END-IF
  7820     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  7821                                    OUT-ORIG-AH-PRM
  7822                                    WS-WORK-AH-PREM
  7823     IF CM-AH-PREMIUM-AMT = .01
  7824         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
  7825     END-IF
  7826     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  7827     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  7828                                    OUT-ORIG-AH-REF
  7829                                    WS-WORK-AH-REF
  7830     IF CM-AH-DEATH-CLAIM-APPLIED
  7831        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7832            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  7833                                    OUT-ORIG-AH-REF
  7834                                    WS-WORK-AH-REF
  7835     END-IF
  7836     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  7837     MOVE ' '                    TO DC-OPTION-CODE
  7838     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7839     IF NO-CONVERSION-ERROR
  7840        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7841           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7842              INTO OUT-AH-CAN-DT
  7843        END-STRING
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 137
* NSRASBL.cbl
  7844     END-IF
  7845
  7846     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7847         MOVE ZEROS          TO WS-WORK-AH-PREM
  7848     END-IF
  7849
  7850      .
  7851 1100-AH-CONT.
  7852
  7853     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  7854     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  7855     MOVE ' '                    TO DC-OPTION-CODE
  7856     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7857     IF NO-CONVERSION-ERROR
  7858        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7859           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7860              INTO OUT-AH-PDTHRU-DT
  7861        END-STRING
  7862     END-IF
  7863     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  7864        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  7865     END-IF
  7866     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  7867     IF CM-LOAN-APR NOT NUMERIC
  7868        MOVE ZEROS               TO CM-LOAN-APR
  7869     END-IF
  7870     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  7871     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  7872     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  7873     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  7874     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  7875     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  7876     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  7877     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  7878     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  7879     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  7880     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  7881     MOVE ' '                    TO DC-OPTION-CODE
  7882     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7883     IF NO-CONVERSION-ERROR
  7884        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7885           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7886              INTO OUT-LF-EXP-DT
  7887        END-STRING
  7888     END-IF
  7889     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  7890     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  7891     MOVE ' '                    TO DC-OPTION-CODE
  7892     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7893     IF NO-CONVERSION-ERROR
  7894        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7895           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7896              INTO OUT-AH-EXP-DT
  7897        END-STRING
  7898     END-IF
  7899     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  7900     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  7901     MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 138
* NSRASBL.cbl
  7902     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7903     IF NO-CONVERSION-ERROR
  7904        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7905           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7906              INTO OUT-1ST-PMT-DT
  7907        END-STRING
  7908     END-IF
  7909     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  7910     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  7911     MOVE ' '                    TO DC-OPTION-CODE
  7912     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7913     IF NO-CONVERSION-ERROR
  7914        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7915           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7916              INTO OUT-ENTRY-DT
  7917        END-STRING
  7918     END-IF
  7919     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7920     MOVE ' '                    TO DC-OPTION-CODE
  7921     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7922     IF NO-CONVERSION-ERROR
  7923        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7924           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7925              INTO OUT-LF-CAN-EXIT-DT
  7926        END-STRING
  7927     END-IF
  7928     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  7929     MOVE ' '                    TO DC-OPTION-CODE
  7930     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7931     IF NO-CONVERSION-ERROR
  7932        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7933           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7934              INTO OUT-LF-DTH-DT
  7935        END-STRING
  7936     END-IF
  7937     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  7938     MOVE ' '                    TO DC-OPTION-CODE
  7939     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7940     IF NO-CONVERSION-ERROR
  7941        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7942           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7943              INTO OUT-LF-DTH-EXIT-DT
  7944        END-STRING
  7945     END-IF
  7946     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  7947     IF OUT-AH-CAN-DT NOT = SPACES
  7948        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  7949     ELSE
  7950        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  7951     END-IF
  7952     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7953     MOVE ' '                    TO DC-OPTION-CODE
  7954     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7955     IF NO-CONVERSION-ERROR
  7956        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7957           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7958              INTO OUT-AH-CAN-EXIT-DT
  7959        END-STRING
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 139
* NSRASBL.cbl
  7960     END-IF
  7961     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  7962     IF CM-ENTRY-BATCH = LOW-VALUES
  7963        MOVE SPACES              TO CM-ENTRY-BATCH
  7964     END-IF
  7965     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  7966     IF CM-LF-EXIT-BATCH = LOW-VALUES
  7967        MOVE SPACES              TO CM-LF-EXIT-BATCH
  7968     END-IF
  7969     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  7970     IF CM-AH-EXIT-BATCH = LOW-VALUES
  7971        MOVE SPACES              TO CM-AH-EXIT-BATCH
  7972     END-IF
  7973     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  7974     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  7975     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  7976     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  7977     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  7978     COMPUTE WS-WORK-PREM =
  7979        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  7980           + CM-AH-PREMIUM-AMT)
  7981     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  7982                                    OUT-ORIG-TOT-PREM
  7983     COMPUTE WS-WORK-REF =
  7984        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  7985     MOVE WS-WORK-REF            TO OUT-TOT-REF
  7986                                    OUT-ORIG-TOT-REF
  7987     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  7988        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  7989     ELSE
  7990        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  7991     END-IF
  7992     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  7993     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  7994        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  7995     ELSE
  7996        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  7997     END-IF
  7998     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  7999     IF CM-NH-INT-ON-REFS NUMERIC
  8000        IF CM-NH-INT-ON-REFS NOT = ZEROS
  8001           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
  8002        END-IF
  8003     END-IF
  8004
  8005     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8006        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8007            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8008        END-IF
  8009        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8010            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8011        END-IF
  8012     END-IF
  8013*
  8014*     IF BL-DATA-SRCE = '2'
  8015*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8016*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8017*        END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 140
* NSRASBL.cbl
  8018*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8019*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8020*        END-IF
  8021*     END-IF
  8022
  8023     COMPUTE WS-ACCT-LF-PORTION =
  8024        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  8025     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  8026                                OUT-ACCT-ORIG-LF-PORT
  8027     COMPUTE WS-ACCT-ALT-LF-PORTION =
  8028        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  8029     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  8030                                OUT-ACCT-ORIG-ALT-LF-PORT
  8031     COMPUTE WS-ACCT-CMB-LF-PORTION =
  8032        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  8033     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  8034                                OUT-ACCT-ORIG-CMB-LF-PORT
  8035     COMPUTE WS-ACCT-AH-PORTION =
  8036        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  8037     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  8038                                OUT-ACCT-ORIG-AH-PORT
  8039     COMPUTE WS-ACCT-PORTION =
  8040        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  8041     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  8042                                OUT-ACCT-ORIG-PORTION
  8043
  8044     COMPUTE WS-CSO-LF-PORTION =
  8045       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  8046     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  8047                               OUT-CSO-ORIG-LF-PORT
  8048     COMPUTE WS-CSO-ALT-LF-PORTION =
  8049       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  8050     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  8051                                   OUT-CSO-ORIG-ALT-LF-PORT
  8052     COMPUTE WS-CSO-CMB-LF-PORTION =
  8053       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  8054     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  8055                                   OUT-CSO-ORIG-CMB-LF-PORT
  8056     COMPUTE WS-CSO-AH-PORTION =
  8057        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  8058     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  8059                               OUT-CSO-ORIG-AH-PORT
  8060     COMPUTE WS-CSO-PORTION =
  8061        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  8062     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  8063                            OUT-CSO-ORIG-PORTION
  8064     .
  8065 1110-EXIT.
  8066     EXIT.
  8067 1115-MATCH-COMPANY.
  8068     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8069     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8070     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8071
  8072* EXEC CICS READ
  8073*       INTO    (CONTROL-FILE)
  8074*       DATASET ('ELCNTL')
  8075*       RIDFLD  (WS-ELCNTL-KEY)
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 141
* NSRASBL.cbl
  8076*       RESP    (WS-RESPONSE)
  8077*    END-EXEC
  8078     MOVE LENGTH OF
  8079      CONTROL-FILE
  8080       TO DFHEIV11
  8081     MOVE 'ELCNTL' TO DFHEIV1
  8082*    MOVE '&"IL       E          (  N#00007889' TO DFHEIV0
  8083     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8084     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8085     MOVE X'204E233030303037383839' TO DFHEIV0(25:11)
  8086     CALL 'kxdfhei1' USING DFHEIV0,
  8087           DFHEIV1,
  8088           CONTROL-FILE,
  8089           DFHEIV11,
  8090           WS-ELCNTL-KEY,
  8091           DFHEIV99,
  8092           DFHEIV99,
  8093           DFHEIV99
  8094     MOVE EIBRESP  TO WS-RESPONSE
  8095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8096     IF RESP-NORMAL
  8097        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  8098     END-IF
  8099     .
  8100 1115-EXIT.
  8101     EXIT.
  8102 1120-MATCH-CARRIER.
  8103     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8104     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  8105     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  8106     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8107
  8108* EXEC CICS READ
  8109*       INTO    (CONTROL-FILE)
  8110*       DATASET ('ELCNTL')
  8111*       RIDFLD  (WS-ELCNTL-KEY)
  8112*       RESP    (WS-RESPONSE)
  8113*    END-EXEC
  8114     MOVE LENGTH OF
  8115      CONTROL-FILE
  8116       TO DFHEIV11
  8117     MOVE 'ELCNTL' TO DFHEIV1
  8118*    MOVE '&"IL       E          (  N#00007906' TO DFHEIV0
  8119     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8121     MOVE X'204E233030303037393036' TO DFHEIV0(25:11)
  8122     CALL 'kxdfhei1' USING DFHEIV0,
  8123           DFHEIV1,
  8124           CONTROL-FILE,
  8125           DFHEIV11,
  8126           WS-ELCNTL-KEY,
  8127           DFHEIV99,
  8128           DFHEIV99,
  8129           DFHEIV99
  8130     MOVE EIBRESP  TO WS-RESPONSE
  8131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8132     IF RESP-NORMAL
  8133        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 142
* NSRASBL.cbl
  8134     ELSE
  8135        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  8136     END-IF
  8137     .
  8138 1120-EXIT.
  8139     EXIT.
  8140 1125-MATCH-STATE.
  8141     MOVE BL-STATE               TO OUT-STATE
  8142     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8143     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  8144     MOVE BL-STATE               TO WS-ELCNTL-STATE
  8145     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8146
  8147* EXEC CICS READ
  8148*       INTO    (CONTROL-FILE)
  8149*       DATASET ('ELCNTL')
  8150*       RIDFLD  (WS-ELCNTL-KEY)
  8151*       RESP    (WS-RESPONSE)
  8152*    END-EXEC
  8153     MOVE LENGTH OF
  8154      CONTROL-FILE
  8155       TO DFHEIV11
  8156     MOVE 'ELCNTL' TO DFHEIV1
  8157*    MOVE '&"IL       E          (  N#00007926' TO DFHEIV0
  8158     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8160     MOVE X'204E233030303037393236' TO DFHEIV0(25:11)
  8161     CALL 'kxdfhei1' USING DFHEIV0,
  8162           DFHEIV1,
  8163           CONTROL-FILE,
  8164           DFHEIV11,
  8165           WS-ELCNTL-KEY,
  8166           DFHEIV99,
  8167           DFHEIV99,
  8168           DFHEIV99
  8169     MOVE EIBRESP  TO WS-RESPONSE
  8170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8171     IF RESP-NORMAL
  8172        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  8173     ELSE
  8174        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  8175     END-IF
  8176     .
  8177 1125-EXIT.
  8178     EXIT.
  8179 1130-MATCH-BENCDS.
  8180     MOVE SPACES                 TO WS-LF-ABBRV
  8181                                    WS-LF-DESC
  8182                                    WS-LF-EARN
  8183                                    WS-WAIT-PER
  8184                                    WS-RET-ELIM
  8185                                    WS-AH-DESC
  8186                                    WS-BEN-DAYS
  8187     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  8188        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  8189     END-IF
  8190     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  8191        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 143
* NSRASBL.cbl
  8192     END-IF
  8193     .
  8194 1130-EXIT.
  8195     EXIT.
  8196 1140-MATCH-LFBEN.
  8197     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8198     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  8199     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  8200     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8201
  8202* EXEC CICS READ
  8203*       INTO    (CONTROL-FILE)
  8204*       DATASET ('ELCNTL')
  8205*       RIDFLD  (WS-ELCNTL-KEY)
  8206*       GTEQ
  8207*       RESP    (WS-RESPONSE)
  8208*    END-EXEC
  8209     MOVE LENGTH OF
  8210      CONTROL-FILE
  8211       TO DFHEIV11
  8212     MOVE 'ELCNTL' TO DFHEIV1
  8213*    MOVE '&"IL       G          (  N#00007962' TO DFHEIV0
  8214     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8215     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8216     MOVE X'204E233030303037393632' TO DFHEIV0(25:11)
  8217     CALL 'kxdfhei1' USING DFHEIV0,
  8218           DFHEIV1,
  8219           CONTROL-FILE,
  8220           DFHEIV11,
  8221           WS-ELCNTL-KEY,
  8222           DFHEIV99,
  8223           DFHEIV99,
  8224           DFHEIV99
  8225     MOVE EIBRESP  TO WS-RESPONSE
  8226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8227     IF RESP-NORMAL
  8228        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8229           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8230           OR (S1 > +8)
  8231        END-PERFORM
  8232        IF S1 < + 9
  8233           MOVE CF-BENEFIT-ALPHA (S1)
  8234                                 TO WS-LF-ABBRV
  8235           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8236           MOVE CF-CO-EARNINGS-CALC (S1)
  8237                                 TO WS-LF-EARN
  8238        ELSE
  8239           MOVE 'XX'             TO WS-LF-DESC
  8240           MOVE 'XXX'            TO WS-LF-ABBRV
  8241        END-IF
  8242     ELSE
  8243        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  8244     END-IF
  8245     .
  8246 1140-EXIT.
  8247     EXIT.
  8248 1150-MATCH-AHBEN.
  8249     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 144
* NSRASBL.cbl
  8250     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8251     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8252     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8253
  8254* EXEC CICS READ
  8255*       INTO    (CONTROL-FILE)
  8256*       DATASET ('ELCNTL')
  8257*       RIDFLD  (WS-ELCNTL-KEY)
  8258*       GTEQ
  8259*       RESP    (WS-RESPONSE)
  8260*    END-EXEC
  8261     MOVE LENGTH OF
  8262      CONTROL-FILE
  8263       TO DFHEIV11
  8264     MOVE 'ELCNTL' TO DFHEIV1
  8265*    MOVE '&"IL       G          (  N#00007995' TO DFHEIV0
  8266     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8268     MOVE X'204E233030303037393935' TO DFHEIV0(25:11)
  8269     CALL 'kxdfhei1' USING DFHEIV0,
  8270           DFHEIV1,
  8271           CONTROL-FILE,
  8272           DFHEIV11,
  8273           WS-ELCNTL-KEY,
  8274           DFHEIV99,
  8275           DFHEIV99,
  8276           DFHEIV99
  8277     MOVE EIBRESP  TO WS-RESPONSE
  8278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8279     IF RESP-NORMAL
  8280        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8281           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8282           OR (S1 > +8)
  8283        END-PERFORM
  8284        IF S1 < + 9
  8285           MOVE CF-BENEFIT-ALPHA (S1)
  8286                                 TO WS-WAIT-PER
  8287           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8288                                 TO WS-RET-ELIM
  8289           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8290                                 TO WS-BEN-DAYS
  8291           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8292              IF CF-JOINT-INDICATOR (S1) = 'J'
  8293                 MOVE 'Joint Critical Period Disability'
  8294                                 TO WS-AH-DESC
  8295              ELSE
  8296                 MOVE 'Single Critical Period-Primary Only'
  8297                                 TO WS-AH-DESC
  8298              END-IF
  8299           ELSE
  8300              IF CF-JOINT-INDICATOR (S1) = 'J'
  8301                 MOVE 'Joint Disability'
  8302                                 TO WS-AH-DESC
  8303              ELSE
  8304                 MOVE 'Single Disability (Primary Only)'
  8305                                 TO WS-AH-DESC
  8306              END-IF
  8307           END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 145
* NSRASBL.cbl
  8308        ELSE
  8309           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8310        END-IF
  8311     ELSE
  8312        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8313     END-IF
  8314     .
  8315 1150-EXIT.
  8316     EXIT.
  8317
  8318 1160-READ-CERT-TRAILER.
  8319
  8320     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
  8321     MOVE WS-ELCERT-KEY          TO  WS-ELCRTT-PRIMARY.
  8322     MOVE 'C'                    TO  WS-ELCRTT-REC-TYPE.
  8323
  8324
  8325* EXEC CICS HANDLE CONDITION
  8326*        NOTFND (1160-CERT-TRL-REC-NOTFND)
  8327*    END-EXEC.
  8328*    MOVE '"$I                   ! " #00008047' TO DFHEIV0
  8329     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8331     MOVE X'2220233030303038303437' TO DFHEIV0(25:11)
  8332     CALL 'kxdfhei1' USING DFHEIV0
  8333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8334
  8335
  8336
  8337* EXEC CICS READ
  8338*        DATASET  ('ELCRTT')
  8339*        RIDFLD   (WS-ELCRTT-KEY)
  8340*        INTO     (CERTIFICATE-TRAILERS)
  8341*    END-EXEC.
  8342     MOVE LENGTH OF
  8343      CERTIFICATE-TRAILERS
  8344       TO DFHEIV11
  8345     MOVE 'ELCRTT' TO DFHEIV1
  8346*    MOVE '&"IL       E          (   #00008051' TO DFHEIV0
  8347     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8349     MOVE X'2020233030303038303531' TO DFHEIV0(25:11)
  8350     CALL 'kxdfhei1' USING DFHEIV0,
  8351           DFHEIV1,
  8352           CERTIFICATE-TRAILERS,
  8353           DFHEIV11,
  8354           WS-ELCRTT-KEY,
  8355           DFHEIV99,
  8356           DFHEIV99,
  8357           DFHEIV99
  8358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8359
  8360
  8361     GO TO 1160-EXIT.
  8362
  8363 1160-CERT-TRL-REC-NOTFND.
  8364     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
  8365
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 146
* NSRASBL.cbl
  8366 1160-EXIT.
  8367     EXIT.
  8368 1200-GET-ERACCT.
  8369     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8370     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8371                                    OUT-ACCT-ADDR1
  8372                                    OUT-ACCT-ADDR2
  8373                                    OUT-ACCT-CITY
  8374     MOVE ZEROS                  TO WS-CHGBACK
  8375
  8376* EXEC CICS STARTBR
  8377*        DATASET   ('ERACCT')
  8378*        RIDFLD    (WS-ERACCT-KEY)
  8379*        GTEQ
  8380*        RESP      (WS-RESPONSE)
  8381*    END-EXEC
  8382     MOVE 'ERACCT' TO DFHEIV1
  8383     MOVE 0
  8384       TO DFHEIV11
  8385*    MOVE '&,         G          &  N#00008071' TO DFHEIV0
  8386     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8387     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8388     MOVE X'204E233030303038303731' TO DFHEIV0(25:11)
  8389     CALL 'kxdfhei1' USING DFHEIV0,
  8390           DFHEIV1,
  8391           WS-ERACCT-KEY,
  8392           DFHEIV99,
  8393           DFHEIV11,
  8394           DFHEIV99
  8395     MOVE EIBRESP  TO WS-RESPONSE
  8396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8397     IF RESP-NORMAL
  8398
  8399* EXEC CICS READNEXT
  8400*          INTO    (ACCOUNT-MASTER)
  8401*          DATASET ('ERACCT')
  8402*          RIDFLD  (WS-ERACCT-KEY)
  8403*          RESP    (WS-RESPONSE)
  8404*       END-EXEC
  8405     MOVE LENGTH OF
  8406      ACCOUNT-MASTER
  8407       TO DFHEIV12
  8408     MOVE 'ERACCT' TO DFHEIV1
  8409     MOVE 0
  8410       TO DFHEIV11
  8411*    MOVE '&.IL                  )  N#00008078' TO DFHEIV0
  8412     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8413     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8414     MOVE X'204E233030303038303738' TO DFHEIV0(25:11)
  8415     CALL 'kxdfhei1' USING DFHEIV0,
  8416           DFHEIV1,
  8417           ACCOUNT-MASTER,
  8418           DFHEIV12,
  8419           WS-ERACCT-KEY,
  8420           DFHEIV99,
  8421           DFHEIV11,
  8422           DFHEIV99,
  8423           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 147
* NSRASBL.cbl
  8424     MOVE EIBRESP  TO WS-RESPONSE
  8425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8426     END-IF
  8427     IF RESP-NORMAL
  8428        PERFORM UNTIL
  8429           NOT (RESP-NORMAL)
  8430           OR (WS-SAVE-ERACCT-KEY NOT =
  8431                        AM-CONTROL-PRIMARY (1:20))
  8432           IF BL-DATA-SRCE = '4' OR '2'
  8433              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8434                 AND >= AM-EFFECTIVE-DT)
  8435                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8436                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8437                    OR (S1 > +10)
  8438                 END-PERFORM
  8439                 IF S1 < +11
  8440                    MOVE AM-COMM-CHARGEBACK (S1)
  8441                                 TO WS-CHGBACK
  8442                 END-IF
  8443              END-IF
  8444           END-IF
  8445           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8446
  8447* EXEC CICS READNEXT
  8448*             INTO    (ACCOUNT-MASTER)
  8449*             DATASET ('ERACCT')
  8450*             RIDFLD  (WS-ERACCT-KEY)
  8451*             RESP    (WS-RESPONSE)
  8452*          END-EXEC
  8453     MOVE LENGTH OF
  8454      ACCOUNT-MASTER
  8455       TO DFHEIV12
  8456     MOVE 'ERACCT' TO DFHEIV1
  8457     MOVE 0
  8458       TO DFHEIV11
  8459*    MOVE '&.IL                  )  N#00008104' TO DFHEIV0
  8460     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8461     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8462     MOVE X'204E233030303038313034' TO DFHEIV0(25:11)
  8463     CALL 'kxdfhei1' USING DFHEIV0,
  8464           DFHEIV1,
  8465           ACCOUNT-MASTER,
  8466           DFHEIV12,
  8467           WS-ERACCT-KEY,
  8468           DFHEIV99,
  8469           DFHEIV11,
  8470           DFHEIV99,
  8471           DFHEIV99
  8472     MOVE EIBRESP  TO WS-RESPONSE
  8473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8474        END-PERFORM
  8475        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8476        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8477           SET ACCT-FOUND TO TRUE
  8478           MOVE AM-NAME          TO OUT-ACCT-NAME
  8479           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8480           MOVE SPACES           TO OUT-ACCT-ADDR2
  8481           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 148
* NSRASBL.cbl
  8482           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8483           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8484           MOVE AM-CONTROL-NAME  TO OUT-ACCT-CNTRL-NAME
  8485           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8486           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8487           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8488              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8489                 INTO OUT-ACCT-ZIP (6:5)
  8490              END-STRING
  8491           END-IF
  8492           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8493           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8494           MOVE AM-STATE         TO OUT-FORM
  8495           IF AM-ACCOUNT (10:1) = 'L'
  8496              MOVE 'L'           TO OUT-FORM (3:1)
  8497                                    OUT-LEASE-IND
  8498           END-IF
  8499           MOVE AM-CONTROL-PRIMARY (1:8)
  8500                                 TO WS-ERCOMP-KEY
  8501           IF AM-REMIT-TO NOT NUMERIC
  8502              MOVE 01            TO AM-REMIT-TO
  8503           END-IF
  8504           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8505           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8506              (AM-COM-TYP (S1) = 'C' OR 'D')
  8507              OR (S1 > +10)
  8508           END-PERFORM
  8509           IF S1 < +11
  8510              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8511           END-IF
  8512           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8513           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8514        END-IF
  8515     END-IF
  8516
  8517* EXEC CICS ENDBR
  8518*        DATASET   ('ERACCT')
  8519*    END-EXEC
  8520     MOVE 'ERACCT' TO DFHEIV1
  8521     MOVE 0
  8522       TO DFHEIV11
  8523*    MOVE '&2                    $   #00008152' TO DFHEIV0
  8524     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8525     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8526     MOVE X'2020233030303038313532' TO DFHEIV0(25:11)
  8527     CALL 'kxdfhei1' USING DFHEIV0,
  8528           DFHEIV1,
  8529           DFHEIV11,
  8530           DFHEIV99
  8531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8532    .
  8533 1200-EXIT.
  8534     EXIT.
  8535 1225-GET-ERCOMP.
  8536
  8537* EXEC CICS READ
  8538*       INTO    (COMPENSATION-MASTER)
  8539*       DATASET ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 149
* NSRASBL.cbl
  8540*       RIDFLD  (WS-ERCOMP-KEY)
  8541*       RESP    (WS-RESPONSE)
  8542*    END-EXEC
  8543     MOVE LENGTH OF
  8544      COMPENSATION-MASTER
  8545       TO DFHEIV11
  8546     MOVE 'ERCOMP' TO DFHEIV1
  8547*    MOVE '&"IL       E          (  N#00008159' TO DFHEIV0
  8548     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8549     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8550     MOVE X'204E233030303038313539' TO DFHEIV0(25:11)
  8551     CALL 'kxdfhei1' USING DFHEIV0,
  8552           DFHEIV1,
  8553           COMPENSATION-MASTER,
  8554           DFHEIV11,
  8555           WS-ERCOMP-KEY,
  8556           DFHEIV99,
  8557           DFHEIV99,
  8558           DFHEIV99
  8559     MOVE EIBRESP  TO WS-RESPONSE
  8560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8561     IF RESP-NORMAL
  8562        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8563        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8564        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8565        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8566        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8567        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8568        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8569        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8570        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8571        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8572        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8573        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8574     END-IF
  8575     .
  8576 1225-EXIT.
  8577     EXIT.
  8578 1250-GET-ELLETR.
  8579     display ' made it to 1250 '
  8580     move spaces                 to W-Z-CONTROL-DATA
  8581     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8582     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8583     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8584
  8585* EXEC CICS READ
  8586*         DATASET    ('ELLETR')
  8587*         INTO       (TEXT-FILES)
  8588*         RIDFLD     (WS-ELLETR-KEY)
  8589*         RESP       (WS-RESPONSE)
  8590*         GTEQ
  8591*    END-EXEC
  8592     MOVE LENGTH OF
  8593      TEXT-FILES
  8594       TO DFHEIV11
  8595     MOVE 'ELLETR' TO DFHEIV1
  8596*    MOVE '&"IL       G          (  N#00008188' TO DFHEIV0
  8597     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 150
* NSRASBL.cbl
  8598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8599     MOVE X'204E233030303038313838' TO DFHEIV0(25:11)
  8600     CALL 'kxdfhei1' USING DFHEIV0,
  8601           DFHEIV1,
  8602           TEXT-FILES,
  8603           DFHEIV11,
  8604           WS-ELLETR-KEY,
  8605           DFHEIV99,
  8606           DFHEIV99,
  8607           DFHEIV99
  8608     MOVE EIBRESP  TO WS-RESPONSE
  8609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8610     IF RESP-NORMAL
  8611        IF (LETTER-FILE-TEXT)
  8612           AND (BL-LETTER-ID = TX-LETTER-NO)
  8613           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8614           display ' found good z record '
  8615           PERFORM 1280-PROCESS-Z-CONTROLS
  8616                                 THRU 1280-EXIT
  8617        END-IF
  8618     END-IF
  8619     .
  8620 1250-EXIT.
  8621     EXIT.
  8622 1280-PROCESS-Z-CONTROLS.
  8623     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8624*    IF W-FORM-TO-RESEND > SPACES
  8625*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  8626*    ELSE
  8627*       MOVE SPACES              TO OUT-FORM
  8628*    END-IF
  8629     IF BL-ENC-CD = SPACES OR LOW-VALUES
  8630        MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  8631     END-IF
  8632     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  8633     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  8634     .
  8635 1280-EXIT.
  8636     EXIT.
  8637 1300-DETERMINE-COMM.
  8638******************************************************************
  8639* DATA SOURCE MEANINGS  BL-DATA-SRCE
  8640*    1) FROM ACCT MAINT
  8641*    2) FROM CERT UPDATE
  8642*    3) FROM COMP MAINT
  8643*    4) FROM REVIEW AND CORRECTIONS
  8644******************************************************************
  8645     MOVE 'Y'                    TO OUT-CHGBACK
  8646     MOVE ZEROS                  TO WS-DIFF
  8647                                    WS-CHGBK-LIFE-PCT
  8648                                    WS-CHGBK-AH-PCT
  8649     IF BL-DATA-SRCE = '4'
  8650        IF PB-CANCELLATION
  8651           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8652           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8653           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  8654           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  8655           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 151
* NSRASBL.cbl
  8656              MOVE PB-C-LF-CANCEL-DT
  8657                                 TO DC-BIN-DATE-2
  8658           END-IF
  8659           MOVE '1'              TO DC-OPTION-CODE
  8660           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8661           IF NO-CONVERSION-ERROR
  8662              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8663              IF DC-ODD-DAYS-OVER > +1
  8664                 ADD +1          TO WS-DIFF
  8665              END-IF
  8666              IF (WS-CHGBACK = 99)
  8667                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8668                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8669                                WS-CHGBK-AH-PCT
  8670                   MOVE 'N'  TO OUT-CHGBACK
  8671              END-IF
  8672           END-IF
  8673        ELSE
  8674           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8675           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8676        END-IF
  8677     ELSE
  8678        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  8679        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  8680        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8681           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8682           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8683           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  8684           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  8685              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  8686           END-IF
  8687           MOVE '1'              TO DC-OPTION-CODE
  8688           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8689           IF NO-CONVERSION-ERROR
  8690              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8691              IF DC-ODD-DAYS-OVER > +1
  8692                 ADD +1          TO WS-DIFF
  8693              END-IF
  8694              IF (WS-CHGBACK = 99)
  8695                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8696                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8697                                WS-CHGBK-AH-PCT
  8698                   MOVE 'N'  TO OUT-CHGBACK
  8699              END-IF
  8700           END-IF
  8701        END-IF
  8702     END-IF
  8703     .
  8704 1300-EXIT.
  8705     EXIT.
  8706 1500-GET-ARCH-NO.
  8707     DISPLAY ' MADE IT TO 1500 '
  8708     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  8709     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8710     MOVE SPACES                 TO WS-ELCNTL-GENL
  8711     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8712
  8713* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 152
* NSRASBL.cbl
  8714*       INTO    (CONTROL-FILE)
  8715*       DATASET ('ELCNTL')
  8716*       RIDFLD  (WS-ELCNTL-KEY)
  8717*       UPDATE
  8718*       RESP    (WS-RESPONSE)
  8719*    END-EXEC
  8720     MOVE LENGTH OF
  8721      CONTROL-FILE
  8722       TO DFHEIV11
  8723     MOVE 'ELCNTL' TO DFHEIV1
  8724*    MOVE '&"IL       EU         (  N#00008297' TO DFHEIV0
  8725     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8726     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8727     MOVE X'204E233030303038323937' TO DFHEIV0(25:11)
  8728     CALL 'kxdfhei1' USING DFHEIV0,
  8729           DFHEIV1,
  8730           CONTROL-FILE,
  8731           DFHEIV11,
  8732           WS-ELCNTL-KEY,
  8733           DFHEIV99,
  8734           DFHEIV99,
  8735           DFHEIV99
  8736     MOVE EIBRESP  TO WS-RESPONSE
  8737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8738     IF RESP-NORMAL
  8739        AND (CF-COMPANY-ID  = BL-COMP-ID)
  8740        AND (CF-RECORD-TYPE = '1')
  8741        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  8742        MOVE CF-CREDIT-LAST-ARCH-NUM
  8743                                 TO WS-ARCHIVE-NO
  8744
  8745* EXEC CICS REWRITE
  8746*          FROM    (CONTROL-FILE)
  8747*          DATASET ('ELCNTL')
  8748*       END-EXEC
  8749     MOVE LENGTH OF
  8750      CONTROL-FILE
  8751       TO DFHEIV11
  8752     MOVE 'ELCNTL' TO DFHEIV1
  8753*    MOVE '&& L                  %   #00008310' TO DFHEIV0
  8754     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8755     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8756     MOVE X'2020233030303038333130' TO DFHEIV0(25:11)
  8757     CALL 'kxdfhei1' USING DFHEIV0,
  8758           DFHEIV1,
  8759           CONTROL-FILE,
  8760           DFHEIV11,
  8761           DFHEIV99
  8762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8763     ELSE
  8764        MOVE +0                  TO WS-ARCHIVE-NO
  8765     END-IF
  8766    .
  8767 1500-EXIT.
  8768     EXIT.
  8769 1700-GET-ELENCC.
  8770     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  8771     MOVE '2'                    TO WS-ELENCC-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 153
* NSRASBL.cbl
  8772     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  8773     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  8774        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  8775        OR (E1 > +5)
  8776     END-PERFORM
  8777     IF E1 < +5
  8778        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  8779     END-IF
  8780
  8781* EXEC CICS READ
  8782*        DATASET   ('ELENCC')
  8783*        INTO      (ENCLOSURE-CODES)
  8784*        RIDFLD    (WS-ELENCC-KEY)
  8785*        RESP      (WS-RESPONSE)
  8786*    END-EXEC
  8787     MOVE LENGTH OF
  8788      ENCLOSURE-CODES
  8789       TO DFHEIV11
  8790     MOVE 'ELENCC' TO DFHEIV1
  8791*    MOVE '&"IL       E          (  N#00008331' TO DFHEIV0
  8792     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8793     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8794     MOVE X'204E233030303038333331' TO DFHEIV0(25:11)
  8795     CALL 'kxdfhei1' USING DFHEIV0,
  8796           DFHEIV1,
  8797           ENCLOSURE-CODES,
  8798           DFHEIV11,
  8799           WS-ELENCC-KEY,
  8800           DFHEIV99,
  8801           DFHEIV99,
  8802           DFHEIV99
  8803     MOVE EIBRESP  TO WS-RESPONSE
  8804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8805     IF NOT RESP-NORMAL
  8806        display ' elencc resp not normal ' ws-response
  8807        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  8808
  8809* EXEC CICS READ
  8810*           DATASET   ('ELENCC')
  8811*           INTO      (ENCLOSURE-CODES)
  8812*           RIDFLD    (WS-ELENCC-KEY)
  8813*           RESP      (WS-RESPONSE)
  8814*       END-EXEC
  8815     MOVE LENGTH OF
  8816      ENCLOSURE-CODES
  8817       TO DFHEIV11
  8818     MOVE 'ELENCC' TO DFHEIV1
  8819*    MOVE '&"IL       E          (  N#00008340' TO DFHEIV0
  8820     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8821     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8822     MOVE X'204E233030303038333430' TO DFHEIV0(25:11)
  8823     CALL 'kxdfhei1' USING DFHEIV0,
  8824           DFHEIV1,
  8825           ENCLOSURE-CODES,
  8826           DFHEIV11,
  8827           WS-ELENCC-KEY,
  8828           DFHEIV99,
  8829           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 13-Jan-14 14:08 Page 154
* NSRASBL.cbl
  8830           DFHEIV99
  8831     MOVE EIBRESP  TO WS-RESPONSE
  8832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8833     END-IF
  8834     IF RESP-NORMAL
  8835        display ' elencc resp normal ' ws-response
  8836        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  8837        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  8838        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  8839     END-IF
  8840     .
  8841 1700-EXIT.
  8842     EXIT.
  8843 9700-DATE-LINK.
  8844
  8845* EXEC CICS LINK
  8846*        PROGRAM   ('ELDATCV')
  8847*        COMMAREA  (DATE-CONVERSION-DATA)
  8848*        LENGTH    (DC-COMM-LENGTH)
  8849*    END-EXEC.
  8850     MOVE 'ELDATCV' TO DFHEIV1
  8851*    MOVE '."C                   (   #00008357' TO DFHEIV0
  8852     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8853     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8854     MOVE X'2020233030303038333537' TO DFHEIV0(25:11)
  8855     CALL 'kxdfhei1' USING DFHEIV0,
  8856           DFHEIV1,
  8857           DATE-CONVERSION-DATA,
  8858           DC-COMM-LENGTH,
  8859           DFHEIV99,
  8860           DFHEIV99,
  8861           DFHEIV99,
  8862           DFHEIV99
  8863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8864
  8865 9700-EXIT.
  8866      EXIT.
  8867
  8868 9999-DFHBACK SECTION.
  8869     MOVE '9%                    "   ' TO DFHEIV0
  8870     MOVE 'NSRASBL' TO DFHEIV1
  8871     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8872     GOBACK.
  8873 9999-DFHEXIT.
  8874     IF DFHEIGDJ EQUAL 0001
  8875         NEXT SENTENCE
  8876     ELSE IF DFHEIGDJ EQUAL 2
  8877         GO TO 1160-CERT-TRL-REC-NOTFND
  8878         DEPENDING ON DFHEIGDI.
  8879     MOVE '9%                    "   ' TO DFHEIV0
  8880     MOVE 'NSRASBL' TO DFHEIV1
  8881     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8882     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       35108     Code:       54481
