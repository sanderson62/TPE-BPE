* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   1
* EL680.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL680.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL680.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL680 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:21:06.
     7*                            VMOD 2.015
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   2
* EL680.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXF6 - PAYMENT CALCULATIONS.
    25
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   3
* EL680.cbl
    27 ENVIRONMENT DIVISION.
    28
    29 DATA DIVISION.
    30
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*   EL680  WORKING STORAGE     *'.
    35 77  FILLER  PIC X(32)  VALUE '************VMOD=2.015 *********'.
    36
    37 01  WS-DATE-AREA.
    38     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    39     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    40
    41 01  ACCESS-KEYS.
    42     12  ELCNTL-KEY.
    43         16  CNTL-COMP-ID    PIC XXX.
    44         16  CNTL-REC-TYPE   PIC X.
    45         16  CNTL-ACCESS     PIC X(4).
    46         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
    47
    48 01  SPC-FLD.
    49     03  SPC-FLD-9    PIC 99.
    50
    51*********************  INPUT AREAS *******************************
    52 01  FILLER.
    53     05  WS-NAME                 PIC X(20)           VALUE SPACES.
    54     05  WS-FREQ                 PIC XX              VALUE SPACES.
    55     05  WS-BASIS-X              PIC XX              VALUE SPACES.
    56     05  WS-NPBEN                PIC X               VALUE SPACES.
    57     05  WS-BALYN                PIC X               VALUE SPACES.
    58     05  WS-OBYN                 PIC X               VALUE SPACES.
    59     05  WS-ADDCHG               PIC X               VALUE SPACES.
    60         88 NO-CHG                                   VALUE ' '.
    61         88 CHG-LF                                   VALUE '1'.
    62         88 CHG-AH                                   VALUE '2'.
    63         88 CHG-LF-AH                                VALUE '3'.
    64
    65 01  FILLER      COMP-3.
    66     05  WS-AMOUNT-REQUESTED     PIC S9(9)V99        VALUE +0.
    67     05  WS-APR                  PIC S9(6)V9(8)      VALUE +0.
    68     05  WS-NUMBER-OF-PMTS       PIC S999            VALUE +0.
    69     05  WS-ADDTL-DAYS           PIC S999            VALUE +0.
    70     05  WS-TRUNC                PIC S999            VALUE +0.
    71     05  WS-EXTRA                PIC S9              VALUE +0.
    72     05  WS-LIFE-RATE            PIC S9(6)V9(8)      VALUE +0.
    73     05  WS-LIFE-DEVIATION       PIC S9(6)V9(8)      VALUE +0.
    74     05  WS-AH-RATE              PIC S9(6)V9(8)      VALUE +0.
    75     05  WS-BL-RATE              PIC S9(6)V9(8)      VALUE +0.
    76     05  WS-AH-DEVIATION         PIC S9(6)V9(8)      VALUE +0.
    77     05  WS-PAYMENTS-COVERED     PIC S999            VALUE +0.
    78     05  WS-BALLOON-AMOUNT       PIC S9(6)V99        VALUE +0.
    79*    05  WS-REGULAR-PAYMENT      PIC S9(6)V99        VALUE +0.
    80
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   4
* EL680.cbl
    82
    83 01  FILLER         COMP-3.
    84     05  ANGLM                   PIC S9(7)V9(11) VALUE ZERO.
    85     05  ANGLN                   PIC S9(7)V9(11) VALUE ZERO.
    86
    87     05  AHN                     PIC S999        VALUE ZERO.
    88     05  ATF                     PIC S9(7)V9(11) VALUE ZERO.
    89     05  EMII                    PIC S999        VALUE ZERO.
    90     05  OTF                     PIC S9(7)V9(11) VALUE ZERO.
    91     05  PPY                     PIC S999        VALUE ZERO.
    92
    93     05  CA                      PIC S9(7)V9(11) VALUE ZERO.
    94     05  I                       PIC S9(7)V9(11) VALUE ZERO.
    95     05  K1                      PIC S9(7)V9(11) VALUE ZERO.
    96     05  L                       PIC S9(7)V9(11) VALUE ZERO.
    97     05  L1                      PIC S9(7)V9(11) VALUE ZERO.
    98     05  M                       PIC S9(7)V9(11) VALUE ZERO.
    99     05  N                       PIC S9(5)       VALUE ZERO.
   100     05  N1                      PIC S9(7)V9(11) VALUE ZERO.
   101     05  RA                      PIC S9(7)V9(11) VALUE ZERO.
   102     05  TA                      PIC S9(7)V9(11) VALUE ZERO.
   103     05  V                       PIC S9(7)V9(11) VALUE ZERO.
   104     05  VA                      PIC S9(7)V9(11) VALUE ZERO.
   105     05  VU                      PIC S9(7)V9(11) VALUE ZERO.
   106     05  VU1                     PIC S9(7)V9(11) VALUE ZERO.
   107
   108     05  NALF                    PIC S9(7)V9(11) VALUE ZERO.
   109     05  NPLF                    PIC S9(7)V9(11) VALUE ZERO.
   110     05  PADJ                    PIC S9(7)V9(11) VALUE ZERO.
   111
   112     05  TOT-PMTS                PIC S9(7)V9(11) VALUE ZERO.
   113     05  ATOT-PMTS               PIC S9(7)V9(11) VALUE ZERO.
   114     05  ADL-DAYS                PIC S999        VALUE ZERO.
   115     05  ADL-ADJ                 PIC S9(7)V9(11) VALUE ZERO.
   116     05  COV-TERM                PIC S999        VALUE ZERO.
   117
   118     05  LIFE-RATE               PIC S9(7)V9(11) VALUE ZERO.
   119     05  LIFEDEV                 PIC S9(7)V9(11) VALUE ZERO.
   120     05  LR                      PIC S9(7)V9(11) VALUE ZERO.
   121     05  LIFE-PREM               PIC S9(7)V9(11) VALUE ZERO.
   122
   123     05  AH-RATE                 PIC S9(7)V9(11) VALUE ZERO.
   124     05  AHDEV                   PIC S9(7)V9(11) VALUE ZERO.
   125     05  AH                      PIC S9(7)V9(11) VALUE ZERO.
   126     05  AH-PREM                 PIC S9(7)V9(11) VALUE ZERO.
   127
   128     05  BL-RATE                 PIC S9(7)V9(11) VALUE ZERO.
   129     05  BL                      PIC S9(7)V9(11) VALUE ZERO.
   130
   131************ OUTPUT AREAS ******
   132     05  L-PREMIUM               PIC S9(7)V99    VALUE ZERO.
   133     05  A-PREMIUM               PIC S9(7)V99    VALUE ZERO.
   134     05  PAYMENT                 PIC S9(7)V99    VALUE ZERO.
   135     05  TOT-FIN                 PIC S9(7)V99    VALUE ZERO.
   136     05  TOT-PAYMT               PIC S9(7)V99    VALUE ZERO.
   137     05  TOT-INTRS               PIC S9(7)V99    VALUE ZERO.
   138
   139 01  FILLER         COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   5
* EL680.cbl
   140     05  V-NTH                   PIC S9(7)V9(11) VALUE ZERO.
   141     05  B                       PIC S9(7)V9(11) VALUE ZERO.
   142     05  ANGLN-LESS-1            PIC S9(7)V9(11) VALUE ZERO.
   143     05  NM1                     PIC S9(7)V9(11) VALUE ZERO.
   144     05  AEQ                     PIC S9(7)V9(11) VALUE ZERO.
   145     05  MPT                     PIC S9(7)V9(11) VALUE ZERO.
   146     05  MPB                     PIC S9(7)V9(11) VALUE ZERO.
   147     05  MP                      PIC S9(7)V9(11) VALUE ZERO.
   148     05  IA                      PIC S9(7)V9(11) VALUE ZERO.
   149
   150 01  FILLER.
   151     05  XREPT                       PIC S999    COMP.
   152     05  WS-ERROR-COUNT              PIC S999        VALUE ZERO.
   153     05  WS-MESSAGE                  PIC X(79).
   154     05  WS-BASIS                    PIC S99         VALUE ZERO.
   155     05  WS-TIME-WORK                PIC S9(7)    VALUE ZERO.
   156     05  WS-TIME                     REDEFINES
   157         WS-TIME-WORK                PIC S999V9(4).
   158
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   6
* EL680.cbl
   160 01  ERROR-MESSAGES.
   161     12  ER-0004                 PIC X(4)  VALUE '0004'.
   162     12  ER-0008                 PIC X(4)  VALUE '0008'.
   163     12  ER-0029                 PIC X(4)  VALUE '0029'.
   164     12  ER-0042                 PIC X(4)  VALUE '0042'.
   165     12  ER-0190                 PIC X(4)  VALUE '0190'.
   166     12  ER-0412                 PIC X(4)  VALUE '0412'.
   167     12  ER-0413                 PIC X(4)  VALUE '0413'.
   168     12  ER-2361                 PIC X(4)  VALUE '2361'.
   169     12  ER-2363                 PIC X(4)  VALUE '2363'.
   170     12  ER-2364                 PIC X(4)  VALUE '2364'.
   171     12  ER-2365                 PIC X(4)  VALUE '2365'.
   172     12  ER-2366                 PIC X(4)  VALUE '2366'.
   173     12  ER-2367                 PIC X(4)  VALUE '2367'.
   174     12  ER-2920                 PIC X(4)  VALUE '2920'.
   175     12  ER-2921                 PIC X(4)  VALUE '2921'.
   176     12  ER-2922                 PIC X(4)  VALUE '2922'.
   177     12  ER-2923                 PIC X(4)  VALUE '2923'.
   178     12  ER-2924                 PIC X(4)  VALUE '2924'.
   179     12  ER-2925                 PIC X(4)  VALUE '2925'.
   180     12  ER-2926                 PIC X(4)  VALUE '2926'.
   181     12  ER-2927                 PIC X(4)  VALUE '2927'.
   182     12  ER-4004                 PIC X(4)  VALUE '4004'.
   183     12  ER-4007                 PIC X(4)  VALUE '4007'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   7
* EL680.cbl
   185 01  STANDARD-AREAS.
   186     12  MAPSET-NAME         PIC X(8)    VALUE 'EL680S'.
   187     12  MAP-NAME            PIC X(8)    VALUE 'EL680A'.
   188     12  SCREEN-NUMBER       PIC X(4)    VALUE '680A'.
   189     12  TRANS-ID            PIC X(4)    VALUE 'EXF6'.
   190     12  START-TRANS-ID      PIC X(4)    VALUE 'EXF7'.
   191     12  THIS-PGM            PIC X(8)    VALUE 'EL680'.
   192     12  PGM-NAME            PIC X(8).
   193     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   194     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   195     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   196     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   197     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   198
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   8
* EL680.cbl
   200*                            COPY EL680S.
   201 01  EL680AI.
   202     05  FILLER            PIC  X(0012).
   203*    -------------------------------
   204     05  ADATEL PIC S9(0004) COMP.
   205     05  ADATEF PIC  X(0001).
   206     05  FILLER REDEFINES ADATEF.
   207         10  ADATEA PIC  X(0001).
   208     05  ADATEI PIC  X(0008).
   209*    -------------------------------
   210     05  ATIMEL PIC S9(0004) COMP.
   211     05  ATIMEF PIC  X(0001).
   212     05  FILLER REDEFINES ATIMEF.
   213         10  ATIMEA PIC  X(0001).
   214     05  ATIMEI PIC  X(0005).
   215*    -------------------------------
   216     05  ACOMPIDL PIC S9(0004) COMP.
   217     05  ACOMPIDF PIC  X(0001).
   218     05  FILLER REDEFINES ACOMPIDF.
   219         10  ACOMPIDA PIC  X(0001).
   220     05  ACOMPIDI PIC  X(0003).
   221*    -------------------------------
   222     05  ANAMEL PIC S9(0004) COMP.
   223     05  ANAMEF PIC  X(0001).
   224     05  FILLER REDEFINES ANAMEF.
   225         10  ANAMEA PIC  X(0001).
   226     05  ANAMEI PIC  X(0020).
   227*    -------------------------------
   228     05  AAMOUNTL PIC S9(0004) COMP.
   229     05  AAMOUNTF PIC  X(0001).
   230     05  FILLER REDEFINES AAMOUNTF.
   231         10  AAMOUNTA PIC  X(0001).
   232     05  AAMOUNTI PIC  9(10)V99.
   233*    -------------------------------
   234     05  AINTRATL PIC S9(0004) COMP.
   235     05  AINTRATF PIC  X(0001).
   236     05  FILLER REDEFINES AINTRATF.
   237         10  AINTRATA PIC  X(0001).
   238     05  AINTRATI PIC  9(4)V9(4).
   239*    -------------------------------
   240     05  AFREQL PIC S9(0004) COMP.
   241     05  AFREQF PIC  X(0001).
   242     05  FILLER REDEFINES AFREQF.
   243         10  AFREQA PIC  X(0001).
   244     05  AFREQI PIC  X(0002).
   245*    -------------------------------
   246     05  BAMOUNTL PIC S9(0004) COMP.
   247     05  BAMOUNTF PIC  X(0001).
   248     05  FILLER REDEFINES BAMOUNTF.
   249         10  BAMOUNTA PIC  X(0001).
   250     05  BAMOUNTI PIC  X(0011).
   251*    -------------------------------
   252     05  ANOPMTSL PIC S9(0004) COMP.
   253     05  ANOPMTSF PIC  X(0001).
   254     05  FILLER REDEFINES ANOPMTSF.
   255         10  ANOPMTSA PIC  X(0001).
   256     05  ANOPMTSI PIC  999.
   257*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   9
* EL680.cbl
   258     05  BLAMTL PIC S9(0004) COMP.
   259     05  BLAMTF PIC  X(0001).
   260     05  FILLER REDEFINES BLAMTF.
   261         10  BLAMTA PIC  X(0001).
   262     05  BLAMTI PIC  X(0011).
   263*    -------------------------------
   264     05  AADDAYSL PIC S9(0004) COMP.
   265     05  AADDAYSF PIC  X(0001).
   266     05  FILLER REDEFINES AADDAYSF.
   267         10  AADDAYSA PIC  X(0001).
   268     05  AADDAYSI PIC  999.
   269*    -------------------------------
   270     05  ADDCHGL PIC S9(0004) COMP.
   271     05  ADDCHGF PIC  X(0001).
   272     05  FILLER REDEFINES ADDCHGF.
   273         10  ADDCHGA PIC  X(0001).
   274     05  ADDCHGI PIC  X(0001).
   275*    -------------------------------
   276     05  BDAMTL PIC S9(0004) COMP.
   277     05  BDAMTF PIC  X(0001).
   278     05  FILLER REDEFINES BDAMTF.
   279         10  BDAMTA PIC  X(0001).
   280     05  BDAMTI PIC  X(0011).
   281*    -------------------------------
   282     05  ABASISL PIC S9(0004) COMP.
   283     05  ABASISF PIC  X(0001).
   284     05  FILLER REDEFINES ABASISF.
   285         10  ABASISA PIC  X(0001).
   286     05  ABASISI PIC  X(0002).
   287*    -------------------------------
   288     05  BMOPMTL PIC S9(0004) COMP.
   289     05  BMOPMTF PIC  X(0001).
   290     05  FILLER REDEFINES BMOPMTF.
   291         10  BMOPMTA PIC  X(0001).
   292     05  BMOPMTI PIC  X(0011).
   293*    -------------------------------
   294     05  OBYORNL PIC S9(0004) COMP.
   295     05  OBYORNF PIC  X(0001).
   296     05  FILLER REDEFINES OBYORNF.
   297         10  OBYORNA PIC  X(0001).
   298     05  OBYORNI PIC  X(0001).
   299*    -------------------------------
   300     05  BALPMTL PIC S9(0004) COMP.
   301     05  BALPMTF PIC  X(0001).
   302     05  FILLER REDEFINES BALPMTF.
   303         10  BALPMTA PIC  X(0001).
   304     05  BALPMTI PIC  X(0011).
   305*    -------------------------------
   306     05  ANPREML PIC S9(0004) COMP.
   307     05  ANPREMF PIC  X(0001).
   308     05  FILLER REDEFINES ANPREMF.
   309         10  ANPREMA PIC  X(0001).
   310     05  ANPREMI PIC  X(0001).
   311*    -------------------------------
   312     05  BTOTPMTL PIC S9(0004) COMP.
   313     05  BTOTPMTF PIC  X(0001).
   314     05  FILLER REDEFINES BTOTPMTF.
   315         10  BTOTPMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  10
* EL680.cbl
   316     05  BTOTPMTI PIC  X(0011).
   317*    -------------------------------
   318     05  ATRUNCL PIC S9(0004) COMP.
   319     05  ATRUNCF PIC  X(0001).
   320     05  FILLER REDEFINES ATRUNCF.
   321         10  ATRUNCA PIC  X(0001).
   322     05  ATRUNCI PIC  999.
   323*    -------------------------------
   324     05  BTOTINTL PIC S9(0004) COMP.
   325     05  BTOTINTF PIC  X(0001).
   326     05  FILLER REDEFINES BTOTINTF.
   327         10  BTOTINTA PIC  X(0001).
   328     05  BTOTINTI PIC  X(0011).
   329*    -------------------------------
   330     05  AEXTRAL PIC S9(0004) COMP.
   331     05  AEXTRAF PIC  X(0001).
   332     05  FILLER REDEFINES AEXTRAF.
   333         10  AEXTRAA PIC  X(0001).
   334     05  AEXTRAI PIC  9.
   335*    -------------------------------
   336     05  ALRATEL PIC S9(0004) COMP.
   337     05  ALRATEF PIC  X(0001).
   338     05  FILLER REDEFINES ALRATEF.
   339         10  ALRATEA PIC  X(0001).
   340     05  ALRATEI PIC  9(4)V9(4).
   341*    -------------------------------
   342     05  ALFDEVL PIC S9(0004) COMP.
   343     05  ALFDEVF PIC  X(0001).
   344     05  FILLER REDEFINES ALFDEVF.
   345         10  ALFDEVA PIC  X(0001).
   346     05  ALFDEVI PIC  9(4)V999.
   347*    -------------------------------
   348     05  ADRATEL PIC S9(0004) COMP.
   349     05  ADRATEF PIC  X(0001).
   350     05  FILLER REDEFINES ADRATEF.
   351         10  ADRATEA PIC  X(0001).
   352     05  ADRATEI PIC  9(4)V9(4).
   353*    -------------------------------
   354     05  AAHDEVL PIC S9(0004) COMP.
   355     05  AAHDEVF PIC  X(0001).
   356     05  FILLER REDEFINES AAHDEVF.
   357         10  AAHDEVA PIC  X(0001).
   358     05  AAHDEVI PIC  9(4)V999.
   359*    -------------------------------
   360     05  ANOTLFL PIC S9(0004) COMP.
   361     05  ANOTLFF PIC  X(0001).
   362     05  FILLER REDEFINES ANOTLFF.
   363         10  ANOTLFA PIC  X(0001).
   364     05  ANOTLFI PIC  999.
   365*    -------------------------------
   366     05  BALAMTL PIC S9(0004) COMP.
   367     05  BALAMTF PIC  X(0001).
   368     05  FILLER REDEFINES BALAMTF.
   369         10  BALAMTA PIC  X(0001).
   370     05  BALAMTI PIC  9(10)V99.
   371*    -------------------------------
   372     05  BALRL PIC S9(0004) COMP.
   373     05  BALRF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  11
* EL680.cbl
   374     05  FILLER REDEFINES BALRF.
   375         10  BALRA PIC  X(0001).
   376     05  BALRI PIC  X(0036).
   377*    -------------------------------
   378     05  BLRATEL PIC S9(0004) COMP.
   379     05  BLRATEF PIC  X(0001).
   380     05  FILLER REDEFINES BLRATEF.
   381         10  BLRATEA PIC  X(0001).
   382     05  BLRATEI PIC  9(4)V9(4).
   383*    -------------------------------
   384     05  BALYNL PIC S9(0004) COMP.
   385     05  BALYNF PIC  X(0001).
   386     05  FILLER REDEFINES BALYNF.
   387         10  BALYNA PIC  X(0001).
   388     05  BALYNI PIC  X(0001).
   389*    -------------------------------
   390     05  ERRMSG1L PIC S9(0004) COMP.
   391     05  ERRMSG1F PIC  X(0001).
   392     05  FILLER REDEFINES ERRMSG1F.
   393         10  ERRMSG1A PIC  X(0001).
   394     05  ERRMSG1I PIC  X(0079).
   395*    -------------------------------
   396     05  PFENTERL PIC S9(0004) COMP.
   397     05  PFENTERF PIC  X(0001).
   398     05  FILLER REDEFINES PFENTERF.
   399         10  PFENTERA PIC  X(0001).
   400     05  PFENTERI PIC  99.
   401 01  EL680AO REDEFINES EL680AI.
   402     05  FILLER            PIC  X(0012).
   403*    -------------------------------
   404     05  FILLER            PIC  X(0003).
   405     05  ADATEO PIC  X(0008).
   406*    -------------------------------
   407     05  FILLER            PIC  X(0003).
   408     05  ATIMEO PIC  99.99.
   409*    -------------------------------
   410     05  FILLER            PIC  X(0003).
   411     05  ACOMPIDO PIC  X(0003).
   412*    -------------------------------
   413     05  FILLER            PIC  X(0003).
   414     05  ANAMEO PIC  X(0020).
   415*    -------------------------------
   416     05  FILLER            PIC  X(0003).
   417     05  AAMOUNTO PIC  Z,ZZZ,ZZ9.99.
   418*    -------------------------------
   419     05  FILLER            PIC  X(0003).
   420     05  AINTRATO PIC  ZZ9.9(4).
   421*    -------------------------------
   422     05  FILLER            PIC  X(0003).
   423     05  AFREQO PIC  X(0002).
   424*    -------------------------------
   425     05  FILLER            PIC  X(0003).
   426     05  BAMOUNTO PIC  ZZZ,ZZ9.99-.
   427*    -------------------------------
   428     05  FILLER            PIC  X(0003).
   429     05  ANOPMTSO PIC  ZZ9.
   430*    -------------------------------
   431     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  12
* EL680.cbl
   432     05  BLAMTO PIC  ZZZ,ZZ9.99-.
   433*    -------------------------------
   434     05  FILLER            PIC  X(0003).
   435     05  AADDAYSO PIC  ZZ9.
   436*    -------------------------------
   437     05  FILLER            PIC  X(0003).
   438     05  ADDCHGO PIC  X(0001).
   439*    -------------------------------
   440     05  FILLER            PIC  X(0003).
   441     05  BDAMTO PIC  ZZZ,ZZ9.99-.
   442*    -------------------------------
   443     05  FILLER            PIC  X(0003).
   444     05  ABASISO PIC  X(0002).
   445*    -------------------------------
   446     05  FILLER            PIC  X(0003).
   447     05  BMOPMTO PIC  ZZZ,ZZ9.99-.
   448*    -------------------------------
   449     05  FILLER            PIC  X(0003).
   450     05  OBYORNO PIC  X(0001).
   451*    -------------------------------
   452     05  FILLER            PIC  X(0003).
   453     05  BALPMTO PIC  ZZZ,ZZ9.99-.
   454*    -------------------------------
   455     05  FILLER            PIC  X(0003).
   456     05  ANPREMO PIC  X(0001).
   457*    -------------------------------
   458     05  FILLER            PIC  X(0003).
   459     05  BTOTPMTO PIC  ZZZ,ZZ9.99-.
   460*    -------------------------------
   461     05  FILLER            PIC  X(0003).
   462     05  ATRUNCO PIC  ZZ9.
   463*    -------------------------------
   464     05  FILLER            PIC  X(0003).
   465     05  BTOTINTO PIC  ZZZ,ZZ9.99-.
   466*    -------------------------------
   467     05  FILLER            PIC  X(0003).
   468     05  AEXTRAO PIC  9.
   469*    -------------------------------
   470     05  FILLER            PIC  X(0003).
   471     05  ALRATEO PIC  ZZ9.9(4).
   472*    -------------------------------
   473     05  FILLER            PIC  X(0003).
   474     05  ALFDEVO PIC  ZZ9.999.
   475*    -------------------------------
   476     05  FILLER            PIC  X(0003).
   477     05  ADRATEO PIC  ZZ9.9(4).
   478*    -------------------------------
   479     05  FILLER            PIC  X(0003).
   480     05  AAHDEVO PIC  ZZ9.999.
   481*    -------------------------------
   482     05  FILLER            PIC  X(0003).
   483     05  ANOTLFO PIC  ZZ9.
   484*    -------------------------------
   485     05  FILLER            PIC  X(0003).
   486     05  BALAMTO PIC  Z,ZZZ,ZZ9.99.
   487*    -------------------------------
   488     05  FILLER            PIC  X(0003).
   489     05  BALRO PIC  X(0036).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  13
* EL680.cbl
   490*    -------------------------------
   491     05  FILLER            PIC  X(0003).
   492     05  BLRATEO PIC  ZZ9.9(4).
   493*    -------------------------------
   494     05  FILLER            PIC  X(0003).
   495     05  BALYNO PIC  X(0001).
   496*    -------------------------------
   497     05  FILLER            PIC  X(0003).
   498     05  ERRMSG1O PIC  X(0079).
   499*    -------------------------------
   500     05  FILLER            PIC  X(0003).
   501     05  PFENTERO PIC  Z9.
   502*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  14
* EL680.cbl
   504*                            COPY ELCLOGOF.
   505******************************************************************
   506*                                                                *
   507*                                                                *
   508*                            ELCLOGOF.                           *
   509*                            VMOD=2.001                          *
   510*                                                                *
   511*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   512*                                                                *
   513******************************************************************
   514 01  CLASIC-LOGOFF.
   515     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   516     12  LOGOFF-TEXT.
   517         16  FILLER          PIC X(5)    VALUE SPACES.
   518         16  LOGOFF-MSG.
   519             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   520             20  FILLER      PIC X       VALUE SPACES.
   521             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   522         16  FILLER          PIC X(80)
   523           VALUE '* YOU ARE NOW LOGGED OFF'.
   524         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   525         16  FILLER          PIC X       VALUE QUOTE.
   526         16  LOGOFF-SYS-MSG  PIC X(17)
   527           VALUE 'S CLAS-IC SYSTEM '.
   528     12  TEXT-MESSAGES.
   529         16  UNACCESS-MSG    PIC X(29)
   530             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   531         16  PGMIDERR-MSG    PIC X(17)
   532             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  15
* EL680.cbl
   534*                            COPY ELCDATE.
   535******************************************************************
   536*                                                                *
   537*                                                                *
   538*                            ELCDATE.                            *
   539*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   540*                            VMOD=2.003
   541*                                                                *
   542*                                                                *
   543*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   544*                 LENGTH = 200                                   *
   545******************************************************************
   546
   547 01  DATE-CONVERSION-DATA.
   548     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   549     12  DC-OPTION-CODE                PIC X.
   550         88  BIN-TO-GREG                VALUE ' '.
   551         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   552         88  EDIT-GREG-TO-BIN           VALUE '2'.
   553         88  YMD-GREG-TO-BIN            VALUE '3'.
   554         88  MDY-GREG-TO-BIN            VALUE '4'.
   555         88  JULIAN-TO-BIN              VALUE '5'.
   556         88  BIN-PLUS-ELAPSED           VALUE '6'.
   557         88  FIND-CENTURY               VALUE '7'.
   558         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   559         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   560         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   561         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   562         88  JULIAN-TO-BIN-3            VALUE 'C'.
   563         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   564         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   565         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   566         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   567         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   568         88  CHECK-LEAP-YEAR            VALUE 'H'.
   569         88  BIN-3-TO-GREG              VALUE 'I'.
   570         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   571         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   572         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   573         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   574         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   575         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   576         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   577         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   578         88  THREE-CHARACTER-BIN
   579                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   580         88  GREGORIAN-TO-BIN
   581                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   582         88  BIN-TO-GREGORIAN
   583                  VALUES ' ' '1' 'I' '8' 'G'.
   584         88  JULIAN-TO-BINARY
   585                  VALUES '5' 'C' 'E' 'F'.
   586     12  DC-ERROR-CODE                 PIC X.
   587         88  NO-CONVERSION-ERROR        VALUE ' '.
   588         88  DATE-CONVERSION-ERROR
   589                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   590         88  DATE-IS-ZERO               VALUE '1'.
   591         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  16
* EL680.cbl
   592         88  DATE-IS-INVALID            VALUE '3'.
   593         88  DATE1-GREATER-DATE2        VALUE '4'.
   594         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   595         88  DATE-INVALID-OPTION        VALUE '9'.
   596         88  INVALID-CENTURY            VALUE 'A'.
   597         88  ONLY-CENTURY               VALUE 'B'.
   598         88  ONLY-LEAP-YEAR             VALUE 'C'.
   599         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   600     12  DC-END-OF-MONTH               PIC X.
   601         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   602     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   603         88  USE-NORMAL-PROCESS         VALUE ' '.
   604         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   605         88  ADJUST-UP-100-YRS          VALUE '2'.
   606     12  FILLER                        PIC X.
   607     12  DC-CONVERSION-DATES.
   608         16  DC-BIN-DATE-1             PIC XX.
   609         16  DC-BIN-DATE-2             PIC XX.
   610         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   611         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   612                       DC-GREG-DATE-1-EDIT.
   613             20  DC-EDIT1-MONTH        PIC 99.
   614             20  SLASH1-1              PIC X.
   615             20  DC-EDIT1-DAY          PIC 99.
   616             20  SLASH1-2              PIC X.
   617             20  DC-EDIT1-YEAR         PIC 99.
   618         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   619         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   620                     DC-GREG-DATE-2-EDIT.
   621             20  DC-EDIT2-MONTH        PIC 99.
   622             20  SLASH2-1              PIC X.
   623             20  DC-EDIT2-DAY          PIC 99.
   624             20  SLASH2-2              PIC X.
   625             20  DC-EDIT2-YEAR         PIC 99.
   626         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   627         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   628                     DC-GREG-DATE-1-YMD.
   629             20  DC-YMD-YEAR           PIC 99.
   630             20  DC-YMD-MONTH          PIC 99.
   631             20  DC-YMD-DAY            PIC 99.
   632         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   633         16  DC-GREG-DATE-1-MDY-R REDEFINES
   634                      DC-GREG-DATE-1-MDY.
   635             20  DC-MDY-MONTH          PIC 99.
   636             20  DC-MDY-DAY            PIC 99.
   637             20  DC-MDY-YEAR           PIC 99.
   638         16  DC-GREG-DATE-1-ALPHA.
   639             20  DC-ALPHA-MONTH        PIC X(10).
   640             20  DC-ALPHA-DAY          PIC 99.
   641             20  FILLER                PIC XX.
   642             20  DC-ALPHA-CENTURY.
   643                 24 DC-ALPHA-CEN-N     PIC 99.
   644             20  DC-ALPHA-YEAR         PIC 99.
   645         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   646         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   647         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   648         16  DC-JULIAN-DATE            PIC 9(05).
   649         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  17
* EL680.cbl
   650                                       PIC 9(05).
   651         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   652             20  DC-JULIAN-YEAR        PIC 99.
   653             20  DC-JULIAN-DAYS        PIC 999.
   654         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   655         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   656         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   657     12  DATE-CONVERSION-VARIBLES.
   658         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   659         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   660             20  FILLER                PIC 9(3).
   661             20  HOLD-CEN-1-CCYY.
   662                 24  HOLD-CEN-1-CC     PIC 99.
   663                 24  HOLD-CEN-1-YY     PIC 99.
   664             20  HOLD-CEN-1-MO         PIC 99.
   665             20  HOLD-CEN-1-DA         PIC 99.
   666         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   667             20  HOLD-CEN-1-R-MO       PIC 99.
   668             20  HOLD-CEN-1-R-DA       PIC 99.
   669             20  HOLD-CEN-1-R-CCYY.
   670                 24  HOLD-CEN-1-R-CC   PIC 99.
   671                 24  HOLD-CEN-1-R-YY   PIC 99.
   672             20  FILLER                PIC 9(3).
   673         16  HOLD-CENTURY-1-X.
   674             20  FILLER                PIC X(3)  VALUE SPACES.
   675             20  HOLD-CEN-1-X-CCYY.
   676                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   677                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   678             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   679             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   680         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   681             20  HOLD-CEN-1-R-X-MO     PIC XX.
   682             20  HOLD-CEN-1-R-X-DA     PIC XX.
   683             20  HOLD-CEN-1-R-X-CCYY.
   684                 24  HOLD-CEN-1-R-X-CC PIC XX.
   685                 24  HOLD-CEN-1-R-X-YY PIC XX.
   686             20  FILLER                PIC XXX.
   687         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   688         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   689         16  DC-JULIAN-DATE-1          PIC 9(07).
   690         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   691             20  DC-JULIAN-1-CCYY.
   692                 24  DC-JULIAN-1-CC    PIC 99.
   693                 24  DC-JULIAN-1-YR    PIC 99.
   694             20  DC-JULIAN-DA-1        PIC 999.
   695         16  DC-JULIAN-DATE-2          PIC 9(07).
   696         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   697             20  DC-JULIAN-2-CCYY.
   698                 24  DC-JULIAN-2-CC    PIC 99.
   699                 24  DC-JULIAN-2-YR    PIC 99.
   700             20  DC-JULIAN-DA-2        PIC 999.
   701         16  DC-GREG-DATE-A-EDIT.
   702             20  DC-EDITA-MONTH        PIC 99.
   703             20  SLASHA-1              PIC X VALUE '/'.
   704             20  DC-EDITA-DAY          PIC 99.
   705             20  SLASHA-2              PIC X VALUE '/'.
   706             20  DC-EDITA-CCYY.
   707                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  18
* EL680.cbl
   708                 24  DC-EDITA-YEAR     PIC 99.
   709         16  DC-GREG-DATE-B-EDIT.
   710             20  DC-EDITB-MONTH        PIC 99.
   711             20  SLASHB-1              PIC X VALUE '/'.
   712             20  DC-EDITB-DAY          PIC 99.
   713             20  SLASHB-2              PIC X VALUE '/'.
   714             20  DC-EDITB-CCYY.
   715                 24  DC-EDITB-CENT     PIC 99.
   716                 24  DC-EDITB-YEAR     PIC 99.
   717         16  DC-GREG-DATE-CYMD         PIC 9(08).
   718         16  DC-GREG-DATE-CYMD-R REDEFINES
   719                              DC-GREG-DATE-CYMD.
   720             20  DC-CYMD-CEN           PIC 99.
   721             20  DC-CYMD-YEAR          PIC 99.
   722             20  DC-CYMD-MONTH         PIC 99.
   723             20  DC-CYMD-DAY           PIC 99.
   724         16  DC-GREG-DATE-MDCY         PIC 9(08).
   725         16  DC-GREG-DATE-MDCY-R REDEFINES
   726                              DC-GREG-DATE-MDCY.
   727             20  DC-MDCY-MONTH         PIC 99.
   728             20  DC-MDCY-DAY           PIC 99.
   729             20  DC-MDCY-CEN           PIC 99.
   730             20  DC-MDCY-YEAR          PIC 99.
   731    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   732        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   733    12  DC-EL310-DATE                  PIC X(21).
   734    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  19
* EL680.cbl
   736*                            COPY ELCATTR.
   737******************************************************************
   738*                                                                *
   739*                            ELCATTR.                            *
   740*                            VMOD=2.001                          *
   741*                                                                *
   742*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   743*                                                                *
   744*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   745*                                                                *
   746*                   POS 1   P=PROTECTED                          *
   747*                           U=UNPROTECTED                        *
   748*                           S=ASKIP                              *
   749*                   POS 2   A=ALPHA/NUMERIC                      *
   750*                           N=NUMERIC                            *
   751*                   POS 3   N=NORMAL                             *
   752*                           B=BRIGHT                             *
   753*                           D=DARK                               *
   754*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   755*                           OF=MODIFIED DATA TAG OFF             *
   756*                                                                *
   757*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   758******************************************************************
   759 01  ATTRIBUTE-LIST.
   760     12  AL-PABOF            PIC X       VALUE 'Y'.
   761     12  AL-PABON            PIC X       VALUE 'Z'.
   762     12  AL-PADOF            PIC X       VALUE '%'.
   763     12  AL-PADON            PIC X       VALUE '_'.
   764     12  AL-PANOF            PIC X       VALUE '-'.
   765     12  AL-PANON            PIC X       VALUE '/'.
   766     12  AL-SABOF            PIC X       VALUE '8'.
   767     12  AL-SABON            PIC X       VALUE '9'.
   768     12  AL-SADOF            PIC X       VALUE '@'.
   769     12  AL-SADON            PIC X       VALUE QUOTE.
   770     12  AL-SANOF            PIC X       VALUE '0'.
   771     12  AL-SANON            PIC X       VALUE '1'.
   772     12  AL-UABOF            PIC X       VALUE 'H'.
   773     12  AL-UABON            PIC X       VALUE 'I'.
   774     12  AL-UADOF            PIC X       VALUE '<'.
   775     12  AL-UADON            PIC X       VALUE '('.
   776     12  AL-UANOF            PIC X       VALUE ' '.
   777     12  AL-UANON            PIC X       VALUE 'A'.
   778     12  AL-UNBOF            PIC X       VALUE 'Q'.
   779     12  AL-UNBON            PIC X       VALUE 'R'.
   780     12  AL-UNDOF            PIC X       VALUE '*'.
   781     12  AL-UNDON            PIC X       VALUE ')'.
   782     12  AL-UNNOF            PIC X       VALUE '&'.
   783     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  20
* EL680.cbl
   785*                            COPY ELCAID.
   786******************************************************************
   787*                                                                *
   788*                            ELCAID.                             *
   789*                            VMOD=2.001                          *
   790*                                                                *
   791*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   792*                                                                *
   793*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   794*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   795******************************************************************
   796
   797 01  DFHAID.
   798   02  DFHNULL   PIC  X  VALUE  ' '.
   799   02  DFHENTER  PIC  X  VALUE  QUOTE.
   800   02  DFHCLEAR  PIC  X  VALUE  '_'.
   801   02  DFHPEN    PIC  X  VALUE  '='.
   802   02  DFHOPID   PIC  X  VALUE  'W'.
   803   02  DFHPA1    PIC  X  VALUE  '%'.
   804   02  DFHPA2    PIC  X  VALUE  '>'.
   805   02  DFHPA3    PIC  X  VALUE  ','.
   806   02  DFHPF1    PIC  X  VALUE  '1'.
   807   02  DFHPF2    PIC  X  VALUE  '2'.
   808   02  DFHPF3    PIC  X  VALUE  '3'.
   809   02  DFHPF4    PIC  X  VALUE  '4'.
   810   02  DFHPF5    PIC  X  VALUE  '5'.
   811   02  DFHPF6    PIC  X  VALUE  '6'.
   812   02  DFHPF7    PIC  X  VALUE  '7'.
   813   02  DFHPF8    PIC  X  VALUE  '8'.
   814   02  DFHPF9    PIC  X  VALUE  '9'.
   815   02  DFHPF10   PIC  X  VALUE  ':'.
   816   02  DFHPF11   PIC  X  VALUE  '#'.
   817   02  DFHPF12   PIC  X  VALUE  '@'.
   818   02  DFHPF13   PIC  X  VALUE  'A'.
   819   02  DFHPF14   PIC  X  VALUE  'B'.
   820   02  DFHPF15   PIC  X  VALUE  'C'.
   821   02  DFHPF16   PIC  X  VALUE  'D'.
   822   02  DFHPF17   PIC  X  VALUE  'E'.
   823   02  DFHPF18   PIC  X  VALUE  'F'.
   824   02  DFHPF19   PIC  X  VALUE  'G'.
   825   02  DFHPF20   PIC  X  VALUE  'H'.
   826   02  DFHPF21   PIC  X  VALUE  'I'.
   827*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   828   02  DFHPF22   PIC  X  VALUE  '['.
   829   02  DFHPF23   PIC  X  VALUE  '.'.
   830   02  DFHPF24   PIC  X  VALUE  '<'.
   831   02  DFHMSRE   PIC  X  VALUE  'X'.
   832   02  DFHSTRF   PIC  X  VALUE  'h'.
   833   02  DFHTRIG   PIC  X  VALUE  '"'.
   834 01  FILLER    REDEFINES DFHAID.
   835     12  FILLER              PIC X(8).
   836     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  21
* EL680.cbl
   838*                            COPY ELCEMIB.
   839******************************************************************
   840*                                                                *
   841*                                                                *
   842*                            ELCEMIB.                            *
   843*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   844*                            VMOD=2.005                          *
   845*                                                                *
   846*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   847*                                                                *
   848******************************************************************
   849 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   850     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   851     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   852     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   853     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   854     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   855     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   856     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   857     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   858     12  EMI-SWITCH1             PIC X        VALUE '1'.
   859         88  EMI-NO-ERRORS                    VALUE '1'.
   860         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   861         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   862     12  EMI-SWITCH2             PIC X        VALUE '1'.
   863         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   864     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   865         88  EMI-AREA1-EMPTY                  VALUE '1'.
   866         88  EMI-AREA1-FULL                   VALUE '2'.
   867     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   868         88  EMI-AREA2-EMPTY                  VALUE '1'.
   869         88  EMI-AREA2-FULL                   VALUE '2'.
   870     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   871         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   872         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   873         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   874         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   875         88  EMI-BYPASS-FATALS                VALUE 'X'.
   876     12  EMI-ERROR-LINES.
   877         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   878         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   879         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   880         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   881             20  EMI-ERR-CODES OCCURS 10 TIMES.
   882                 24  EMI-ERR-NUM         PIC X(4).
   883                 24  EMI-FILLER          PIC X.
   884                 24  EMI-SEV             PIC X.
   885                 24  FILLER              PIC X.
   886             20  FILLER                  PIC X(02).
   887     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   888         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   889             20  EMI-ERROR-NUMBER    PIC X(4).
   890             20  EMI-FILL            PIC X.
   891             20  EMI-SEVERITY        PIC X.
   892             20  FILLER              PIC X.
   893             20  EMI-ERROR-TEXT.
   894                 24  EMI-TEXT-VARIABLE   PIC X(10).
   895                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  22
* EL680.cbl
   896     12  EMI-SEVERITY-SAVE           PIC X.
   897         88  EMI-NOTE                    VALUE 'N'.
   898         88  EMI-WARNING                 VALUE 'W'.
   899         88  EMI-FORCABLE                VALUE 'F'.
   900         88  EMI-FATAL                   VALUE 'X'.
   901     12  EMI-MESSAGE-FLAG            PIC X.
   902         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   903         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   904     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   905     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   906         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   907         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   908         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   909     12  FILLER                      PIC X(137)  VALUE SPACES.
   910     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   911     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   912     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   913     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  23
* EL680.cbl
   915*                            COPY ELCINTF.
   916******************************************************************
   917*                                                                *
   918*                                                                *
   919*                            ELCINTF.                            *
   920*                            VMOD=2.017                          *
   921*                                                                *
   922*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   923*                                                                *
   924*       LENGTH = 1024                                            *
   925*                                                                *
   926******************************************************************
   927 01  PROGRAM-INTERFACE-BLOCK.
   928     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   929     12  PI-CALLING-PROGRAM              PIC X(8).
   930     12  PI-SAVED-PROGRAM-1              PIC X(8).
   931     12  PI-SAVED-PROGRAM-2              PIC X(8).
   932     12  PI-SAVED-PROGRAM-3              PIC X(8).
   933     12  PI-SAVED-PROGRAM-4              PIC X(8).
   934     12  PI-SAVED-PROGRAM-5              PIC X(8).
   935     12  PI-SAVED-PROGRAM-6              PIC X(8).
   936     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   937     12  PI-COMPANY-ID                   PIC XXX.
   938     12  PI-COMPANY-CD                   PIC X.
   939
   940     12  PI-COMPANY-PASSWORD             PIC X(8).
   941
   942     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   943
   944     12  PI-CONTROL-IN-PROGRESS.
   945         16  PI-CARRIER                  PIC X.
   946         16  PI-GROUPING                 PIC X(6).
   947         16  PI-STATE                    PIC XX.
   948         16  PI-ACCOUNT                  PIC X(10).
   949         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   950                                         PIC X(10).
   951         16  PI-CLAIM-CERT-GRP.
   952             20  PI-CLAIM-NO             PIC X(7).
   953             20  PI-CERT-NO.
   954                 25  PI-CERT-PRIME       PIC X(10).
   955                 25  PI-CERT-SFX         PIC X.
   956             20  PI-CERT-EFF-DT          PIC XX.
   957         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   958             20  PI-PLAN-CODE            PIC X(2).
   959             20  PI-REVISION-NUMBER      PIC X(3).
   960             20  PI-PLAN-EFF-DT          PIC X(2).
   961             20  PI-PLAN-EXP-DT          PIC X(2).
   962             20  FILLER                  PIC X(11).
   963         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   964             20  PI-OE-REFERENCE-1.
   965                 25  PI-OE-REF-1-PRIME   PIC X(18).
   966                 25  PI-OE-REF-1-SUFF    PIC XX.
   967
   968     12  PI-SESSION-IN-PROGRESS          PIC X.
   969         88  CLAIM-SESSION                   VALUE '1'.
   970         88  CREDIT-SESSION                  VALUE '2'.
   971         88  WARRANTY-SESSION                VALUE '3'.
   972         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  24
* EL680.cbl
   973         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   974
   975
   976*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   977
   978     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   979     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   980
   981     12  PI-CREDIT-USER                  PIC X.
   982         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   983         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   984
   985     12  PI-CLAIM-USER                   PIC X.
   986         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   987         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   988
   989     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   990         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   991         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   992         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   993         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   994         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   995
   996     12  PI-PROCESSOR-ID                 PIC X(4).
   997
   998     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   999
  1000     12  PI-MEMBER-CAPTION               PIC X(10).
  1001
  1002     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1003         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1004
  1005     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1006     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1007     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1008     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1009
  1010     12  PI-AH-OVERRIDE-L1               PIC X.
  1011     12  PI-AH-OVERRIDE-L2               PIC XX.
  1012     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1013     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1014
  1015     12  PI-NEW-SYSTEM                   PIC X(2).
  1016
  1017     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1018     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1019         88  PI-USES-PAID-TO                 VALUE '1'.
  1020     12  PI-CRDTCRD-SYSTEM.
  1021         16  PI-CRDTCRD-USER             PIC X.
  1022             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1023             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1024         16  PI-CC-MONTH-END-DT          PIC XX.
  1025     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1026
  1027     12  PI-OE-REFERENCE-2.
  1028         16  PI-OE-REF-2-PRIME           PIC X(10).
  1029         16  PI-OE-REF-2-SUFF            PIC X.
  1030
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  25
* EL680.cbl
  1031     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1032
  1033     12  PI-LANGUAGE-TYPE                PIC X.
  1034             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1035             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1036             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1037
  1038     12  PI-POLICY-LINKAGE-IND           PIC X.
  1039         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1040         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1041                                                   LOW-VALUES.
  1042
  1043     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1044     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1045         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1046         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1047     12  FILLER                          PIC X(4).
  1048
  1049     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1050
  1051     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1052         PI-SYSTEM-LEVEL.
  1053
  1054         16  PI-ENTRY-CODES.
  1055             20  PI-ENTRY-CD-1           PIC X.
  1056             20  PI-ENTRY-CD-2           PIC X.
  1057
  1058         16  PI-RETURN-CODES.
  1059             20  PI-RETURN-CD-1          PIC X.
  1060             20  PI-RETURN-CD-2          PIC X.
  1061
  1062         16  PI-UPDATE-STATUS-SAVE.
  1063             20  PI-UPDATE-BY            PIC X(4).
  1064             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1065
  1066         16  PI-LOWER-CASE-LETTERS       PIC X.
  1067             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1068
  1069*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1070*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1071*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1072
  1073         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1074             88  ST-ACCNT-CNTL               VALUE ' '.
  1075             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1076             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1077             88  ACCNT-CNTL                  VALUE '3'.
  1078             88  CARR-ACCNT-CNTL             VALUE '4'.
  1079
  1080         16  PI-PROCESSOR-CAP-LIST.
  1081             20  PI-SYSTEM-CONTROLS.
  1082                24 PI-SYSTEM-DISPLAY     PIC X.
  1083                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1084                24 PI-SYSTEM-MODIFY      PIC X.
  1085                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1086             20  FILLER                  PIC XX.
  1087             20  PI-DISPLAY-CAP          PIC X.
  1088                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  26
* EL680.cbl
  1089             20  PI-MODIFY-CAP           PIC X.
  1090                 88  MODIFY-CAP              VALUE 'Y'.
  1091             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1092                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1093             20  PI-FORCE-CAP            PIC X.
  1094                 88  FORCE-CAP               VALUE 'Y'.
  1095
  1096         16  PI-PROGRAM-CONTROLS.
  1097             20  PI-PGM-PRINT-OPT        PIC X.
  1098             20  PI-PGM-FORMAT-OPT       PIC X.
  1099             20  PI-PGM-PROCESS-OPT      PIC X.
  1100             20  PI-PGM-TOTALS-OPT       PIC X.
  1101
  1102         16  PI-HELP-INTERFACE.
  1103             20  PI-LAST-ERROR-NO        PIC X(4).
  1104             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1105
  1106         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1107             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1108
  1109         16  PI-CR-CONTROL-IN-PROGRESS.
  1110             20  PI-CR-CARRIER           PIC X.
  1111             20  PI-CR-GROUPING          PIC X(6).
  1112             20  PI-CR-STATE             PIC XX.
  1113             20  PI-CR-ACCOUNT           PIC X(10).
  1114             20  PI-CR-FIN-RESP          PIC X(10).
  1115             20  PI-CR-TYPE              PIC X.
  1116
  1117         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1118
  1119         16  PI-CR-MONTH-END-DT          PIC XX.
  1120
  1121         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1122             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1123             88  PI-ZERO-CARRIER             VALUE '1'.
  1124             88  PI-ZERO-GROUPING            VALUE '2'.
  1125             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1126
  1127         16  PI-CARRIER-SECURITY         PIC X.
  1128             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1129
  1130         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1131             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1132             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1133
  1134         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1135             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1136                                         INDEXED BY PI-ACCESS-NDX
  1137                                         PIC X.
  1138
  1139         16  PI-GA-BILLING-CONTROL       PIC X.
  1140             88  PI-GA-BILLING               VALUE '1'.
  1141
  1142         16  PI-MAIL-PROCESSING          PIC X.
  1143             88  PI-MAIL-YES                 VALUE 'Y'.
  1144
  1145         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1146
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  27
* EL680.cbl
  1147         16  PI-AR-SYSTEM.
  1148             20  PI-AR-PROCESSING-CNTL   PIC X.
  1149                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1150             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1151             20  PI-AR-MONTH-END-DT      PIC XX.
  1152
  1153         16  PI-MP-SYSTEM.
  1154             20  PI-MORTGAGE-USER            PIC X.
  1155                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1156                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1157             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1158                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1159                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1160                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1161                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1162                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1163             20  PI-MP-MONTH-END-DT          PIC XX.
  1164             20  PI-MP-REFERENCE-NO.
  1165                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1166                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1167
  1168         16  PI-LABEL-CONTROL            PIC X(01).
  1169             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1170             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1171
  1172         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1173             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1174
  1175         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1176             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1177             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1178
  1179         16  FILLER                      PIC X(14).
  1180
  1181     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1182******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  28
* EL680.cbl
  1184****************************************************************
  1185*
  1186* Copyright (c) 2007 by Clerity Solutions, Inc.
  1187* All rights reserved.
  1188*
  1189****************************************************************
  1190 01  DFHEIV.
  1191   02  DFHEIV0               PIC X(35).
  1192   02  DFHEIV1               PIC X(08).
  1193   02  DFHEIV2               PIC X(08).
  1194   02  DFHEIV3               PIC X(08).
  1195   02  DFHEIV4               PIC X(06).
  1196   02  DFHEIV5               PIC X(04).
  1197   02  DFHEIV6               PIC X(04).
  1198   02  DFHEIV7               PIC X(02).
  1199   02  DFHEIV8               PIC X(02).
  1200   02  DFHEIV9               PIC X(01).
  1201   02  DFHEIV10              PIC S9(7) COMP-3.
  1202   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1203   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1204   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1205   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1206   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1207   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1208   02  DFHEIV17              PIC X(04).
  1209   02  DFHEIV18              PIC X(04).
  1210   02  DFHEIV19              PIC X(04).
  1211   02  DFHEIV20              USAGE IS POINTER.
  1212   02  DFHEIV21              USAGE IS POINTER.
  1213   02  DFHEIV22              USAGE IS POINTER.
  1214   02  DFHEIV23              USAGE IS POINTER.
  1215   02  DFHEIV24              USAGE IS POINTER.
  1216   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1217   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1218   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1219   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1220   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1221   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1222   02  FILLER                PIC X(02).
  1223   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1224   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1225   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1226   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1227   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1228 LINKAGE  SECTION.
  1229*****************************************************************
  1230*                                                               *
  1231* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1232* All rights reserved.                                          *
  1233*                                                               *
  1234*****************************************************************
  1235 01  dfheiblk.
  1236     02  eibtime          pic s9(7) comp-3.
  1237     02  eibdate          pic s9(7) comp-3.
  1238     02  eibtrnid         pic x(4).
  1239     02  eibtaskn         pic s9(7) comp-3.
  1240     02  eibtrmid         pic x(4).
  1241     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  29
* EL680.cbl
  1242     02  eibcposn         pic s9(4) comp.
  1243     02  eibcalen         pic s9(4) comp.
  1244     02  eibaid           pic x(1).
  1245     02  eibfiller1       pic x(1).
  1246     02  eibfn            pic x(2).
  1247     02  eibfiller2       pic x(2).
  1248     02  eibrcode         pic x(6).
  1249     02  eibfiller3       pic x(2).
  1250     02  eibds            pic x(8).
  1251     02  eibreqid         pic x(8).
  1252     02  eibrsrce         pic x(8).
  1253     02  eibsync          pic x(1).
  1254     02  eibfree          pic x(1).
  1255     02  eibrecv          pic x(1).
  1256     02  eibsend          pic x(1).
  1257     02  eibatt           pic x(1).
  1258     02  eibeoc           pic x(1).
  1259     02  eibfmh           pic x(1).
  1260     02  eibcompl         pic x(1).
  1261     02  eibsig           pic x(1).
  1262     02  eibconf          pic x(1).
  1263     02  eiberr           pic x(1).
  1264     02  eibrldbk         pic x(1).
  1265     02  eiberrcd         pic x(4).
  1266     02  eibsynrb         pic x(1).
  1267     02  eibnodat         pic x(1).
  1268     02  eibfiller5       pic x(2).
  1269     02  eibresp          pic 9(09) comp.
  1270     02  eibresp2         pic 9(09) comp.
  1271     02  dfheigdj         pic s9(4) comp.
  1272     02  dfheigdk         pic s9(4) comp.
  1273 01  DFHCOMMAREA         PIC X(1024).
  1274*01 PARMLIST   COMP.
  1275*    02  FILLER          PIC S9(8).
  1276*    02  ELCNTL-POINTER  PIC S9(8).
  1277
  1278*                             COPY ELCCNTL.
  1279******************************************************************
  1280*                                                                *
  1281*                                                                *
  1282*                            ELCCNTL.                            *
  1283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1284*                            VMOD=2.059                          *
  1285*                                                                *
  1286*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1287*                                                                *
  1288*   FILE TYPE = VSAM,KSDS                                        *
  1289*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1290*                                                                *
  1291*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1292*       ALTERNATE INDEX = NONE                                   *
  1293*                                                                *
  1294*   LOG = YES                                                    *
  1295*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1296******************************************************************
  1297*                   C H A N G E   L O G
  1298*
  1299* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  30
* EL680.cbl
  1300*-----------------------------------------------------------------
  1301*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1302* EFFECTIVE    NUMBER
  1303*-----------------------------------------------------------------
  1304* 082503                   PEMA  ADD BENEFIT GROUP
  1305* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1306* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1307* 092705    2005050300006  PEMA  ADD SPP LEASES
  1308* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1309* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1310* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1311* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1312******************************************************************
  1313*
  1314 01  CONTROL-FILE.
  1315     12  CF-RECORD-ID                       PIC XX.
  1316         88  VALID-CF-ID                        VALUE 'CF'.
  1317
  1318     12  CF-CONTROL-PRIMARY.
  1319         16  CF-COMPANY-ID                  PIC XXX.
  1320         16  CF-RECORD-TYPE                 PIC X.
  1321             88  CF-COMPANY-MASTER              VALUE '1'.
  1322             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1323             88  CF-STATE-MASTER                VALUE '3'.
  1324             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1325             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1326             88  CF-CARRIER-MASTER              VALUE '6'.
  1327             88  CF-MORTALITY-MASTER            VALUE '7'.
  1328             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1329             88  CF-TERMINAL-MASTER             VALUE '9'.
  1330             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1331             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1332             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1333             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1334             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1335             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1336             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1337             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1338             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1339         16  CF-ACCESS-CD-GENL              PIC X(4).
  1340         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1341             20  CF-PROCESSOR               PIC X(4).
  1342         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1343             20  CF-STATE-CODE              PIC XX.
  1344             20  FILLER                     PIC XX.
  1345         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1346             20  FILLER                     PIC XX.
  1347             20  CF-HI-BEN-IN-REC           PIC XX.
  1348         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1349             20  FILLER                     PIC XXX.
  1350             20  CF-CARRIER-CNTL            PIC X.
  1351         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1352             20  FILLER                     PIC XX.
  1353             20  CF-HI-TYPE-IN-REC          PIC 99.
  1354         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1355             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1356                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1357             20  CF-CRDB-BENEFIT-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  31
* EL680.cbl
  1358             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1359         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1360             20  FILLER                     PIC X.
  1361             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1362         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1363             20  FILLER                     PIC XX.
  1364             20  CF-MORTGAGE-PLAN           PIC XX.
  1365         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1366
  1367     12  CF-LAST-MAINT-DT                   PIC XX.
  1368     12  CF-LAST-MAINT-BY                   PIC X(4).
  1369     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1370
  1371     12  CF-RECORD-BODY                     PIC X(728).
  1372
  1373
  1374****************************************************************
  1375*             COMPANY MASTER RECORD                            *
  1376****************************************************************
  1377
  1378     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1379         16  CF-COMPANY-ADDRESS.
  1380             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1381             20  CF-CL-IN-CARE-OF           PIC X(30).
  1382             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1383             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1384             20  CF-CL-CITY-STATE           PIC X(30).
  1385             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1386             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1387         16  CF-COMPANY-CD                  PIC X.
  1388         16  CF-COMPANY-PASSWORD            PIC X(8).
  1389         16  CF-SECURITY-OPTION             PIC X.
  1390             88  ALL-SECURITY                   VALUE '1'.
  1391             88  COMPANY-VERIFY                 VALUE '2'.
  1392             88  PROCESSOR-VERIFY               VALUE '3'.
  1393             88  NO-SECURITY                    VALUE '4'.
  1394             88  ALL-BUT-TERM                   VALUE '5'.
  1395         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1396             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1397         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1398             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1399         16  CF-INFORCE-LOCATION            PIC X.
  1400             88  CERTS-ARE-ONLINE               VALUE '1'.
  1401             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1402             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1403         16  CF-LOWER-CASE-LETTERS          PIC X.
  1404         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1405             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1406             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1407             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1408             88  CF-ACCNT-CNTL                  VALUE '3'.
  1409             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1410
  1411         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1412         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1413
  1414         16  CF-LGX-CREDIT-USER             PIC X.
  1415             88  CO-IS-NOT-USER                 VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  32
* EL680.cbl
  1416             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1417
  1418         16 CF-CREDIT-CALC-CODES.
  1419             20  CF-CR-REM-TERM-CALC PIC X.
  1420               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1421               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1422               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1423               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1424               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1425               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1426               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1427             20  CF-CR-R78-METHOD           PIC X.
  1428               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1429               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1430
  1431         16  CF-CLAIM-CONTROL-COUNTS.
  1432             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1433                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1434
  1435             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1436                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1437
  1438             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1439                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1440
  1441             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1442                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1443
  1444         16  CF-CURRENT-MONTH-END           PIC XX.
  1445
  1446         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1447             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1448             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1449             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1450             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1451                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1452                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1453             20  CF-CO-PREM-REJECT-SW       PIC X.
  1454                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1455                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1456             20  CF-CO-REF-REJECT-SW        PIC X.
  1457                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1458                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1459
  1460         16  CF-CO-REPORTING-DT             PIC XX.
  1461         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1462         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1463           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1464           88  CF-CO-MONTH-END                  VALUE '1'.
  1465
  1466         16  CF-LGX-CLAIM-USER              PIC X.
  1467             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1468             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1469
  1470         16  CF-CREDIT-EDIT-CONTROLS.
  1471             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1472             20  CF-MIN-AGE                 PIC 99.
  1473             20  CF-DEFAULT-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  33
* EL680.cbl
  1474             20  CF-MIN-TERM                PIC S999      COMP-3.
  1475             20  CF-MAX-TERM                PIC S999      COMP-3.
  1476             20  CF-DEFAULT-SEX             PIC X.
  1477             20  CF-JOINT-AGE-INPUT         PIC X.
  1478                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1479             20  CF-BIRTH-DATE-INPUT        PIC X.
  1480                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1481             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1482                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1483                 88  CF-ZERO-CARRIER            VALUE '1'.
  1484                 88  CF-ZERO-GROUPING           VALUE '2'.
  1485                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1486             20  CF-EDIT-SW                 PIC X.
  1487                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1488             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1489             20  CF-CR-PR-METHOD            PIC X.
  1490               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1491               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1492             20  FILLER                     PIC X.
  1493
  1494         16  CF-CREDIT-MISC-CONTROLS.
  1495             20  CF-REIN-TABLE-SW           PIC X.
  1496                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1497             20  CF-COMP-TABLE-SW           PIC X.
  1498                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1499             20  CF-EXPERIENCE-RETENTION-AGE
  1500                                            PIC S9        COMP-3.
  1501             20  CF-CONVERSION-DT           PIC XX.
  1502             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1503             20  CF-RUN-FREQUENCY-SW        PIC X.
  1504                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1505                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1506
  1507             20  CF-CR-CHECK-NO-CONTROL.
  1508                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1509                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1510                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1511                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1512                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1513                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1514
  1515                 24  CF-CR-CHECK-COUNT       REDEFINES
  1516                     CF-CR-CHECK-COUNTER      PIC X(4).
  1517
  1518                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1519                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1520
  1521                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1522                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1523                 24  CF-MAIL-PROCESSING       PIC X.
  1524                     88  MAIL-PROCESSING          VALUE 'Y'.
  1525
  1526         16  CF-MISC-SYSTEM-CONTROL.
  1527             20  CF-SYSTEM-C                 PIC X.
  1528                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1529             20  CF-SYSTEM-D                 PIC X.
  1530                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1531             20  CF-SOC-SEC-NO-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  34
* EL680.cbl
  1532                 88  SOC-SEC-NO-USED             VALUE '1'.
  1533             20  CF-MEMBER-NO-SW             PIC X.
  1534                 88  MEMBER-NO-USED              VALUE '1'.
  1535             20  CF-TAX-ID-NUMBER            PIC X(11).
  1536             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1537             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1538                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1539                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1540                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1541                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1542             20  CF-SYSTEM-E                 PIC X.
  1543                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1544
  1545         16  CF-LGX-LIFE-USER               PIC X.
  1546             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1547             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1548
  1549         16  CF-CR-MONTH-END-DT             PIC XX.
  1550
  1551         16  CF-FILE-MAINT-DATES.
  1552             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1553                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1554             20  CF-LAST-BATCH       REDEFINES
  1555                 CF-LAST-BATCH-NO               PIC X(4).
  1556             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1557             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1558             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1559             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1560             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1561             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1562             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1563             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1564             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1565             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1566
  1567         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1568         16  FILLER                         PIC X.
  1569
  1570         16  CF-ALT-MORT-CODE               PIC X(4).
  1571         16  CF-MEMBER-CAPTION              PIC X(10).
  1572
  1573         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1574             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1575             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1576             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1577             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1578             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1579
  1580         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1581
  1582         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1583         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1584         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1585         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1586
  1587         16  CF-AH-OVERRIDE-L1              PIC X.
  1588         16  CF-AH-OVERRIDE-L2              PIC XX.
  1589         16  CF-AH-OVERRIDE-L6              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  35
* EL680.cbl
  1590         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1591
  1592         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1593         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1594
  1595         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1596         16  CF-AR-LAST-EL860-DT            PIC XX.
  1597         16  CF-MP-MONTH-END-DT             PIC XX.
  1598
  1599         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1600         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1601             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1602
  1603         16  CF-AR-MONTH-END-DT             PIC XX.
  1604
  1605         16  CF-CRDTCRD-USER                PIC X.
  1606             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1607             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1608
  1609         16  CF-CC-MONTH-END-DT             PIC XX.
  1610
  1611         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1612
  1613         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1614             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1615             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1616             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1617         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1618         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1619         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1620         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1621             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1622             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1623         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1624         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1625         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1626             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1627         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1628
  1629         16  CF-CL-ZIP-CODE.
  1630             20  CF-CL-ZIP-PRIME.
  1631                 24  CF-CL-ZIP-1ST          PIC X.
  1632                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1633                 24  FILLER                 PIC X(4).
  1634             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1635         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1636             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1637             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1638             20  FILLER                     PIC XXX.
  1639
  1640         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1641         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1642         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1643         16  CF-CO-OPTION-START-DATE        PIC XX.
  1644         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1645           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1646                                                      '3' '4'.
  1647           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  36
* EL680.cbl
  1648           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1649           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1650           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1651           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1652           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1653
  1654         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1655
  1656         16  CF-PAYMENT-APPROVAL-LEVELS.
  1657             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1658             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1659             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1660             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1661             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1662             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1663
  1664         16  CF-END-USER-REPORTING-USER     PIC X.
  1665             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1666             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1667
  1668         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1669             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1670             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1671
  1672         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1673
  1674         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1675         16  FILLER                         PIC X.
  1676
  1677         16  CF-CREDIT-ARCHIVE-CNTL.
  1678             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1679             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1680             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1681
  1682         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1683
  1684         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1685             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1686             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1687
  1688         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1689             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1690             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1691
  1692         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1693
  1694         16  CF-CO-ACH-ID-CODE              PIC  X.
  1695             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1696             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1697             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1698         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1699         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1700         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1701         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1702         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1703         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1704         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1705         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  37
* EL680.cbl
  1706         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1707                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1708         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1709                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1710
  1711         16  CF-CO-OVER-SHORT.
  1712             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1713             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1714
  1715*         16  FILLER                         PIC X(102).
  1716         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1717             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1718             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1719
  1720         16  CF-AH-APPROVAL-DAYS.
  1721             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1722             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1723             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1724             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1725
  1726         16  FILLER                         PIC X(82).
  1727****************************************************************
  1728*             PROCESSOR/USER RECORD                            *
  1729****************************************************************
  1730
  1731     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1732         16  CF-PROCESSOR-NAME              PIC X(30).
  1733         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1734         16  CF-PROCESSOR-TITLE             PIC X(26).
  1735         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1736                 88  MESSAGE-YES                VALUE 'Y'.
  1737                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1738
  1739*****************************************************
  1740****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1741****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1742****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1743****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1744*****************************************************
  1745
  1746         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1747             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1748             20  CF-APPLICATION-FORCE       PIC X.
  1749             20  CF-INDIVIDUAL-APP.
  1750                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1751                     28  CF-BROWSE-APP      PIC X.
  1752                     28  CF-UPDATE-APP      PIC X.
  1753
  1754         16  CF-CURRENT-TERM-ON             PIC X(4).
  1755         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1756             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1757             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1758             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1759             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1760             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1761             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1762             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1763         16  CF-PROCESSOR-CARRIER           PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  38
* EL680.cbl
  1764             88  NO-CARRIER-SECURITY            VALUE ' '.
  1765         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1766             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1767         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1768             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1769         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1770             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1771
  1772         16  CF-PROC-SYS-ACCESS-SW.
  1773             20  CF-PROC-CREDIT-CLAIMS-SW.
  1774                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1775                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1776                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1777                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1778             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1779                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1780                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1781             20  CF-PROC-LIFE-GNRLDGR-SW.
  1782                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1783                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1784                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1785                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1786             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1787                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1788                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1789         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1790             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1791             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1792         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1793
  1794         16  CF-APPROVAL-LEVEL                  PIC X.
  1795             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1796             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1797             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1798             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1799
  1800         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1801
  1802         16  CF-LANGUAGE-TYPE                   PIC X.
  1803             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1804             88  CF-LANG-IS-FR                      VALUE 'F'.
  1805         16  FILLER                             PIC  X(240).
  1806
  1807****************************************************************
  1808*             PROCESSOR/REMINDERS RECORD                       *
  1809****************************************************************
  1810
  1811     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1812         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1813             20  CF-START-REMIND-DT         PIC XX.
  1814             20  CF-END-REMIND-DT           PIC XX.
  1815             20  CF-REMINDER-TEXT           PIC X(50).
  1816         16  FILLER                         PIC X(296).
  1817
  1818
  1819****************************************************************
  1820*             STATE MASTER RECORD                              *
  1821****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  39
* EL680.cbl
  1822
  1823     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1824         16  CF-STATE-ABBREVIATION          PIC XX.
  1825         16  CF-STATE-NAME                  PIC X(25).
  1826         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1827         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1828             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1829             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1830             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1831             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1832                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1833                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1834             20  CF-ST-PREM-REJECT-SW       PIC X.
  1835                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1836                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1837             20  CF-ST-REF-REJECT-SW        PIC X.
  1838                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1839                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1840         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1841         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1842         16  CF-ST-REFUND-RULES.
  1843             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1844             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1845             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1846         16  CF-ST-FST-PMT-EXTENSION.
  1847             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1848             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1849                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1850                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1851                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1852                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1853         16  CF-ST-STATE-CALL.
  1854             20  CF-ST-CALL-UNEARNED        PIC X.
  1855             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1856             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1857         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1858             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1859             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1860         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1861         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1862         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1863         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1864         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1865         16  FILLER                         PIC X.
  1866         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1867             20  CF-ST-BENEFIT-CD           PIC XX.
  1868             20  CF-ST-BENEFIT-KIND         PIC X.
  1869                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1870                 88  CF-ST-AH-KIND              VALUE 'A'.
  1871             20  CF-ST-REM-TERM-CALC        PIC X.
  1872                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1873                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1874                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1875                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1876                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1877                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1878                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1879                 88  ST-EARN-AFTER-16TH         VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  40
* EL680.cbl
  1880
  1881             20  CF-ST-REFUND-CALC          PIC X.
  1882                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1883                 88  ST-REFD-BY-R78             VALUE '1'.
  1884                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1885                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1886                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1887                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1888                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1889                 88  ST-REFD-UTAH               VALUE '7'.
  1890                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1891                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1892                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1893
  1894             20  CF-ST-EARNING-CALC         PIC X.
  1895                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1896                 88  ST-EARN-BY-R78             VALUE '1'.
  1897                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1898                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1899                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1900                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1901                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1902                 88  ST-EARN-MEAN               VALUE '8'.
  1903                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1904
  1905             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1906                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1907                 88  ST-OVRD-BY-R78             VALUE '1'.
  1908                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1909                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1910                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1911                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1912                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1913                 88  ST-OVRD-MEAN               VALUE '8'.
  1914                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1915             20  FILLER                     PIC X.
  1916
  1917         16  CF-ST-COMMISSION-CAPS.
  1918             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1919             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1920             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1921             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1922         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1923                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1924
  1925         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1926
  1927         16  CF-ST-STATUTORY-INTEREST.
  1928             20  CF-ST-STAT-DATE-FROM       PIC X.
  1929                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1930                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1931             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1932             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1933             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1934             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1935             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1936
  1937         16  CF-ST-OVER-SHORT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  41
* EL680.cbl
  1938             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1939             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1940
  1941         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1942
  1943         16  CF-ST-RT-CALC                  PIC X.
  1944
  1945         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1946         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1947         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1948         16  CF-ST-RF-LR-CALC               PIC X.
  1949         16  CF-ST-RF-LL-CALC               PIC X.
  1950         16  CF-ST-RF-LN-CALC               PIC X.
  1951         16  CF-ST-RF-AH-CALC               PIC X.
  1952         16  CF-ST-RF-CP-CALC               PIC X.
  1953*        16  FILLER                         PIC X(206).
  1954*CIDMOD         16  FILLER                         PIC X(192).
  1955         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1956             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1957         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1958         16  FILLER                         PIC X(187).
  1959
  1960****************************************************************
  1961*             BENEFIT MASTER RECORD                            *
  1962****************************************************************
  1963
  1964     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1965         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1966             20  CF-BENEFIT-CODE            PIC XX.
  1967             20  CF-BENEFIT-NUMERIC  REDEFINES
  1968                 CF-BENEFIT-CODE            PIC XX.
  1969             20  CF-BENEFIT-ALPHA           PIC XXX.
  1970             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1971             20  CF-BENEFIT-COMMENT         PIC X(10).
  1972
  1973             20  CF-LF-COVERAGE-TYPE        PIC X.
  1974                 88  CF-REDUCING                VALUE 'R'.
  1975                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1976
  1977             20  CF-SPECIAL-CALC-CD         PIC X.
  1978                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1979                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1980                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1981                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1982                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1983                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1984                 88  CF-FARM-PLAN               VALUE 'F'.
  1985                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1986                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1987                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1988                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1989                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1990                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1991                 88  CF-PRUDENTIAL              VALUE 'P'.
  1992                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1993                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1994                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1995                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  42
* EL680.cbl
  1996                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1997                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1998
  1999             20  CF-JOINT-INDICATOR         PIC X.
  2000                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2001
  2002*            20  FILLER                     PIC X(12).
  2003             20  FILLER                     PIC X(11).
  2004             20  CF-BENEFIT-CATEGORY        PIC X.
  2005             20  CF-LOAN-TYPE               PIC X(8).
  2006
  2007             20  CF-CO-REM-TERM-CALC        PIC X.
  2008                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2009                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2010                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2011                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2012                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2013
  2014             20  CF-CO-EARNINGS-CALC        PIC X.
  2015                 88  CO-EARN-BY-R78             VALUE '1'.
  2016                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2017                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2018                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2019                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2020                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2021                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2022                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2023
  2024             20  CF-CO-REFUND-CALC          PIC X.
  2025                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2026                 88  CO-REFD-BY-R78             VALUE '1'.
  2027                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2028                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2029                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2030                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2031                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2032                 88  CO-REFD-MEAN               VALUE '8'.
  2033                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2034                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2035                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2036
  2037             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2038                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2039                 88  CO-OVRD-BY-R78             VALUE '1'.
  2040                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2041                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2042                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2043                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2044                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2045                 88  CO-OVRD-MEAN               VALUE '8'.
  2046                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2047
  2048             20  CF-CO-BEN-I-G-CD           PIC X.
  2049                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2050                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2051                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2052
  2053         16  FILLER                         PIC X(304).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  43
* EL680.cbl
  2054
  2055
  2056****************************************************************
  2057*             CARRIER MASTER RECORD                            *
  2058****************************************************************
  2059
  2060     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2061         16  CF-ADDRESS-DATA.
  2062             20  CF-MAIL-TO-NAME            PIC X(30).
  2063             20  CF-IN-CARE-OF              PIC X(30).
  2064             20  CF-ADDRESS-LINE-1          PIC X(30).
  2065             20  CF-ADDRESS-LINE-2          PIC X(30).
  2066             20  CF-CITY-STATE              PIC X(30).
  2067             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2068             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2069
  2070         16  CF-CLAIM-NO-CONTROL.
  2071             20  CF-CLAIM-NO-METHOD         PIC X.
  2072                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2073                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2074                 88  CLAIM-NO-SEQ               VALUE '3'.
  2075                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2076             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2077                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2078                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2079                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2080
  2081         16  CF-CHECK-NO-CONTROL.
  2082             20  CF-CHECK-NO-METHOD         PIC X.
  2083                 88  CHECK-NO-MANUAL            VALUE '1'.
  2084                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2085                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2086                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2087             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2088                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2089
  2090         16  CF-DOMICILE-STATE              PIC XX.
  2091
  2092         16  CF-EXPENSE-CONTROLS.
  2093             20  CF-EXPENSE-METHOD          PIC X.
  2094                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2095                 88  DOLLARS-PER-PMT            VALUE '2'.
  2096                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2097                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2098             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2099             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2100
  2101         16  CF-CORRESPONDENCE-CONTROL.
  2102             20  CF-LETTER-RESEND-OPT       PIC X.
  2103                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2104                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2105             20  FILLER                     PIC X(4).
  2106
  2107         16  CF-RESERVE-CONTROLS.
  2108             20  CF-MANUAL-SW               PIC X.
  2109                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2110             20  CF-FUTURE-SW               PIC X.
  2111                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  44
* EL680.cbl
  2112             20  CF-PTC-SW                  PIC X.
  2113                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2114             20  CF-IBNR-SW                 PIC X.
  2115                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2116             20  CF-PTC-LF-SW               PIC X.
  2117                 88  CF-LF-PTC-USED             VALUE '1'.
  2118             20  CF-CDT-ACCESS-METHOD       PIC X.
  2119                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2120                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2121                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2122             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2123
  2124         16  CF-CLAIM-CALC-METHOD           PIC X.
  2125             88  360-PLUS-MONTHS                VALUE '1'.
  2126             88  365-PLUS-MONTHS                VALUE '2'.
  2127             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2128             88  360-DAILY                      VALUE '4'.
  2129             88  365-DAILY                      VALUE '5'.
  2130
  2131         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2132         16  FILLER                         PIC X(11).
  2133
  2134         16  CF-LIMIT-AMOUNTS.
  2135             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2136             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2137             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2138             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2139             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2140             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2141             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2142             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2143             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2144             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2145
  2146         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2147         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2148         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2149
  2150         16  CF-ZIP-CODE.
  2151             20  CF-ZIP-PRIME.
  2152                 24  CF-ZIP-1ST             PIC X.
  2153                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2154                 24  FILLER                 PIC X(4).
  2155             20  CF-ZIP-PLUS4               PIC X(4).
  2156         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2157             20  CF-CAN-POSTAL-1            PIC XXX.
  2158             20  CF-CAN-POSTAL-2            PIC XXX.
  2159             20  FILLER                     PIC XXX.
  2160
  2161         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2162         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2163         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2164
  2165         16  CF-RATING-SWITCH               PIC X.
  2166             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2167             88  CF-NO-RATING                   VALUE 'N'.
  2168
  2169         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  45
* EL680.cbl
  2170
  2171         16  CF-CARRIER-OVER-SHORT.
  2172             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2173             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2174
  2175         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2176         16  CF-SECPAY-SWITCH               PIC X.
  2177             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2178             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2179         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2180         16  FILLER                         PIC X(448).
  2181*        16  FILLER                         PIC X(452).
  2182
  2183
  2184****************************************************************
  2185*             MORTALITY MASTER RECORD                          *
  2186****************************************************************
  2187
  2188     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2189         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2190                                INDEXED BY CF-MORT-NDX.
  2191             20  CF-MORT-TABLE              PIC X(5).
  2192             20  CF-MORT-TABLE-TYPE         PIC X.
  2193                 88  CF-MORT-JOINT              VALUE 'J'.
  2194                 88  CF-MORT-SINGLE             VALUE 'S'.
  2195                 88  CF-MORT-COMBINED           VALUE 'C'.
  2196                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2197                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2198             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2199             20  CF-MORT-AGE-METHOD         PIC XX.
  2200                 88  CF-AGE-LAST                VALUE 'AL'.
  2201                 88  CF-AGE-NEAR                VALUE 'AN'.
  2202             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2203             20  CF-MORT-ADJUSTMENT-DIRECTION
  2204                                            PIC X.
  2205                 88  CF-MINUS                   VALUE '-'.
  2206                 88  CF-PLUS                    VALUE '+'.
  2207             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2208             20  CF-MORT-JOINT-CODE         PIC X.
  2209                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2210             20  CF-MORT-PC-Q               PIC X.
  2211                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2212             20  CF-MORT-TABLE-CODE         PIC X(4).
  2213             20  CF-MORT-COMMENTS           PIC X(15).
  2214             20  FILLER                     PIC X(14).
  2215
  2216         16  FILLER                         PIC X(251).
  2217
  2218
  2219****************************************************************
  2220*             BUSSINESS TYPE MASTER RECORD                     *
  2221****************************************************************
  2222
  2223     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2224* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2225* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2226* AND RECORD 05 IS TYPES 81-99
  2227         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  46
* EL680.cbl
  2228             20  CF-BUSINESS-TITLE          PIC  X(19).
  2229             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2230                                            PIC S9V9(4) COMP-3.
  2231             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2232             20  FILLER                     PIC  X.
  2233         16  FILLER                         PIC  X(248).
  2234
  2235
  2236****************************************************************
  2237*             TERMINAL MASTER RECORD                           *
  2238****************************************************************
  2239
  2240     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2241
  2242         16  CF-COMPANY-TERMINALS.
  2243             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2244                                  PIC X(4).
  2245         16  FILLER               PIC X(248).
  2246
  2247
  2248****************************************************************
  2249*             LIFE EDIT MASTER RECORD                          *
  2250****************************************************************
  2251
  2252     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2253         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2254             20  CF-LIFE-CODE-IN            PIC XX.
  2255             20  CF-LIFE-CODE-OUT           PIC XX.
  2256         16  FILLER                         PIC X(248).
  2257
  2258
  2259****************************************************************
  2260*             AH EDIT MASTER RECORD                            *
  2261****************************************************************
  2262
  2263     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2264         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2265             20  CF-AH-CODE-IN              PIC XXX.
  2266             20  CF-AH-CODE-OUT             PIC XX.
  2267         16  FILLER                         PIC X(248).
  2268
  2269
  2270****************************************************************
  2271*             CREDIBILITY TABLES                               *
  2272****************************************************************
  2273
  2274     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2275         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2276                             INDEXED BY CF-CRDB-NDX.
  2277             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2278             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2279             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2280         16  FILLER                         PIC  X(332).
  2281
  2282
  2283****************************************************************
  2284*             REPORT CUSTOMIZATION RECORD                      *
  2285****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  47
* EL680.cbl
  2286
  2287     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2288         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2289             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2290             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2291             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2292**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2293****       A T-TRANSFER.                                   ****
  2294             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2295
  2296         16  FILLER                         PIC XX.
  2297
  2298         16  CF-CARRIER-CNTL-OPT.
  2299             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2300                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2301                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2302             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2303                                            PIC X.
  2304         16  CF-GROUP-CNTL-OPT.
  2305             20  CF-GROUP-OPT-SEQ           PIC 9.
  2306                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2307                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2308             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2309                                            PIC X(6).
  2310         16  CF-STATE-CNTL-OPT.
  2311             20  CF-STATE-OPT-SEQ           PIC 9.
  2312                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2313                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2314             20  CF-STATE-SELECT OCCURS 3 TIMES
  2315                                            PIC XX.
  2316         16  CF-ACCOUNT-CNTL-OPT.
  2317             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2318                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2319                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2320             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2321                                            PIC X(10).
  2322         16  CF-BUS-TYP-CNTL-OPT.
  2323             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2324                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2325                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2326             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2327                                            PIC XX.
  2328         16  CF-LF-TYP-CNTL-OPT.
  2329             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2330                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2331                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2332             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2333                                            PIC XX.
  2334         16  CF-AH-TYP-CNTL-OPT.
  2335             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2336                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2337                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2338             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2339                                            PIC XX.
  2340         16  CF-REPTCD1-CNTL-OPT.
  2341             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2342                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2343                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  48
* EL680.cbl
  2344             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2345                                            PIC X(10).
  2346         16  CF-REPTCD2-CNTL-OPT.
  2347             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2348                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2349                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2350             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2351                                            PIC X(10).
  2352         16  CF-USER1-CNTL-OPT.
  2353             20  CF-USER1-OPT-SEQ           PIC 9.
  2354                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2355                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2356             20  CF-USER1-SELECT OCCURS 3 TIMES
  2357                                            PIC X(10).
  2358         16  CF-USER2-CNTL-OPT.
  2359             20  CF-USER2-OPT-SEQ           PIC 9.
  2360                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2361                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2362             20  CF-USER2-SELECT OCCURS 3 TIMES
  2363                                            PIC X(10).
  2364         16  CF-USER3-CNTL-OPT.
  2365             20  CF-USER3-OPT-SEQ           PIC 9.
  2366                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2367                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2368             20  CF-USER3-SELECT OCCURS 3 TIMES
  2369                                            PIC X(10).
  2370         16  CF-USER4-CNTL-OPT.
  2371             20  CF-USER4-OPT-SEQ           PIC 9.
  2372                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2373                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2374             20  CF-USER4-SELECT OCCURS 3 TIMES
  2375                                            PIC X(10).
  2376         16  CF-USER5-CNTL-OPT.
  2377             20  CF-USER5-OPT-SEQ           PIC 9.
  2378                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2379                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2380             20  CF-USER5-SELECT OCCURS 3 TIMES
  2381                                            PIC X(10).
  2382         16  CF-REINS-CNTL-OPT.
  2383             20  CF-REINS-OPT-SEQ           PIC 9.
  2384                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2385                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2386             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2387                 24  CF-REINS-PRIME         PIC XXX.
  2388                 24  CF-REINS-SUB           PIC XXX.
  2389
  2390         16  CF-AGENT-CNTL-OPT.
  2391             20  CF-AGENT-OPT-SEQ           PIC 9.
  2392                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2393                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2394             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2395                                            PIC X(10).
  2396
  2397         16  FILLER                         PIC X(43).
  2398
  2399         16  CF-LOSS-RATIO-SELECT.
  2400             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2401             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  49
* EL680.cbl
  2402         16  CF-ENTRY-DATE-SELECT.
  2403             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2404             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2405         16  CF-EFFECTIVE-DATE-SELECT.
  2406             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2407             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2408
  2409         16  CF-EXCEPTION-LIST-IND          PIC X.
  2410             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2411
  2412         16  FILLER                         PIC X(318).
  2413
  2414****************************************************************
  2415*                  EXCEPTION REPORTING RECORD                  *
  2416****************************************************************
  2417
  2418     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2419         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2420             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2421
  2422         16  CF-COMBINED-LIFE-AH-OPT.
  2423             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2424             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2425             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2426             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2427
  2428         16  CF-LIFE-OPT.
  2429             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2430             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2431             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2432             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2433             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2434             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2435             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2436             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2437             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2438             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2439
  2440         16  CF-AH-OPT.
  2441             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2442             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2443             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2444             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2445             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2446             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2447             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2448             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2449             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2450             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2451
  2452         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2453             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2454             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2455             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2456
  2457         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2458
  2459         16  FILLER                         PIC X(673).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  50
* EL680.cbl
  2460
  2461
  2462****************************************************************
  2463*             MORTGAGE SYSTEM PLAN RECORD                      *
  2464****************************************************************
  2465
  2466     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2467         16  CF-PLAN-TYPE                   PIC X.
  2468             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2469             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2470             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2471         16  CF-PLAN-ABBREV                 PIC XXX.
  2472         16  CF-PLAN-DESCRIPT               PIC X(10).
  2473         16  CF-PLAN-NOTES                  PIC X(20).
  2474         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2475         16  CF-PLAN-UNDERWRITING.
  2476             20  CF-PLAN-TERM-DATA.
  2477                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2478                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2479             20  CF-PLAN-AGE-DATA.
  2480                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2481                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2482                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2483             20  CF-PLAN-BENEFIT-DATA.
  2484                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2485                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2486                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2487                                            PIC S9(7)V99  COMP-3.
  2488         16  CF-PLAN-POLICY-FORMS.
  2489             20  CF-POLICY-FORM             PIC X(12).
  2490             20  CF-MASTER-APPLICATION      PIC X(12).
  2491             20  CF-MASTER-POLICY           PIC X(12).
  2492         16  CF-PLAN-RATING.
  2493             20  CF-RATE-CODE               PIC X(5).
  2494             20  CF-SEX-RATING              PIC X.
  2495                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2496                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2497             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2498             20  CF-SUB-STD-TYPE            PIC X.
  2499                 88  CF-PCT-OF-PREM            VALUE '1'.
  2500                 88  CF-PCT-OF-BENE            VALUE '2'.
  2501         16  CF-PLAN-PREM-TOLERANCES.
  2502             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2503             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2504         16  CF-PLAN-PYMT-TOLERANCES.
  2505             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2506             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2507         16  CF-PLAN-MISC-DATA.
  2508             20  FILLER                     PIC X.
  2509             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2510             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2511         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2512         16  CF-PLAN-IND-GRP                PIC X.
  2513             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2514                                                     '1'.
  2515             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2516                                                     '2'.
  2517         16  CF-MIB-SEARCH-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  51
* EL680.cbl
  2518             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2519             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2520             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2521             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2522         16  CF-ALPHA-SEARCH-SW             PIC X.
  2523             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2524             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2525             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2526             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2527             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2528             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2529             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2530             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2531             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2532             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2533                                                     'A' 'B' 'C'
  2534                                                     'X' 'Y' 'Z'.
  2535         16  CF-EFF-DT-RULE-SW              PIC X.
  2536             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2537             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2538             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2539             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2540             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2541         16  FILLER                         PIC X(4).
  2542         16  CF-HEALTH-QUESTIONS            PIC X.
  2543             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2544         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2545         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2546         16  CF-PLAN-SNGL-JNT               PIC X.
  2547             88  CF-COMBINED-PLAN              VALUE 'C'.
  2548             88  CF-JNT-PLAN                   VALUE 'J'.
  2549             88  CF-SNGL-PLAN                  VALUE 'S'.
  2550         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2551         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2552         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2553         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2554         16  CF-RERATE-CNTL                 PIC  X.
  2555             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2556             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2557             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2558             88  CF-AUTO-RECALC                 VALUE '4'.
  2559         16  CF-BENEFIT-TYPE                PIC  X.
  2560             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2561             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2562         16  CF-POLICY-FEE                  PIC S999V99
  2563                                                    COMP-3.
  2564         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2565         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2566         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2567         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2568         16  FILLER                         PIC  X(32).
  2569         16  CF-TERMINATION-FORM            PIC  X(04).
  2570         16  FILLER                         PIC  X(08).
  2571         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2572                                                       COMP-3.
  2573         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2574         16  CF-ISSUE-LETTER                PIC  X(4).
  2575         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  52
* EL680.cbl
  2576         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2577             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2578             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2579         16  CF-MP-REFUND-CALC              PIC X.
  2580             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2581             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2582             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2583             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2584             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2585             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2586             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2587             88  CF-MP-REFD-MEAN                VALUE '8'.
  2588         16  CF-ALT-RATE-CODE               PIC  X(5).
  2589
  2590
  2591         16  FILLER                         PIC X(498).
  2592****************************************************************
  2593*             MORTGAGE COMPANY MASTER RECORD                   *
  2594****************************************************************
  2595
  2596     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2597         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2598         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2599             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2600             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2601             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2602             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2603             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2604
  2605         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2606         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2607         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2608         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2609         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2610
  2611         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2612             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2613         16  CF-MP-RECON-USE-IND            PIC X(1).
  2614             88  CF-MP-USE-RECON             VALUE 'Y'.
  2615         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2616             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2617         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2618             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2619             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2620         16  FILLER                         PIC X(1).
  2621         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2622             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2623         16  CF-MORTG-MIB-VERSION           PIC X.
  2624             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2625             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2626             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2627         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2628             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2629                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2630             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2631                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2632             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2633                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  53
* EL680.cbl
  2634             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2635                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2636             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2637                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2638             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2639                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2640         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2641         16  FILLER                         PIC X(7).
  2642         16  CF-MORTG-DESTINATION-SYMBOL.
  2643             20  CF-MORTG-MIB-COMM          PIC X(5).
  2644             20  CF-MORTG-MIB-TERM          PIC X(5).
  2645         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2646             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2647         16  FILLER                         PIC X(03).
  2648         16  CF-MP-CHECK-NO-CONTROL.
  2649             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2650                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2651                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2652                                                ' ' LOW-VALUES.
  2653                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2654                                               VALUE '3'.
  2655         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2656         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2657         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2658             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2659                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2660             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2661                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2662             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2663                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2664             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2665                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2666             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2667                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2668             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2669                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2670         16  CF-MORTG-BILLING-AREA.
  2671             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2672                                            PIC X.
  2673         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2674         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2675         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2676         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2677             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2678             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2679         16  FILLER                         PIC X.
  2680         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2681             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2682             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2683         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2684         16  FILLER                         PIC X(8).
  2685         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2686         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2687         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2688         16  CF-ACH-COMPANY-ID.
  2689             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2690                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2691                 88  CF-ACH-ICD-DUNS                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  54
* EL680.cbl
  2692                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2693             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2694         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2695             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2696         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2697             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2698             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2699         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2700         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2701         16  FILLER                         PIC X(536).
  2702
  2703****************************************************************
  2704*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2705****************************************************************
  2706
  2707     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2708         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2709             20  CF-FEMALE-HEIGHT.
  2710                 24  CF-FEMALE-FT           PIC 99.
  2711                 24  CF-FEMALE-IN           PIC 99.
  2712             20  CF-FEMALE-MIN-WT           PIC 999.
  2713             20  CF-FEMALE-MAX-WT           PIC 999.
  2714         16  FILLER                         PIC X(428).
  2715
  2716     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2717         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2718             20  CF-MALE-HEIGHT.
  2719                 24  CF-MALE-FT             PIC 99.
  2720                 24  CF-MALE-IN             PIC 99.
  2721             20  CF-MALE-MIN-WT             PIC 999.
  2722             20  CF-MALE-MAX-WT             PIC 999.
  2723         16  FILLER                         PIC X(428).
  2724******************************************************************
  2725*             AUTOMATIC ACTIVITY RECORD                          *
  2726******************************************************************
  2727     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2728         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2729             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2730             20  CF-SYS-LETTER-ID           PIC X(04).
  2731             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2732             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2733             20  CF-SYS-RESET-SW            PIC X(01).
  2734             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2735             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2736
  2737         16  FILLER                         PIC X(50).
  2738
  2739         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2740             20  CF-USER-ACTIVE-SW          PIC X(01).
  2741             20  CF-USER-LETTER-ID          PIC X(04).
  2742             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2743             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2744             20  CF-USER-RESET-SW           PIC X(01).
  2745             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2746             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2747             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2748
  2749         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  55
* EL680.cbl
  2751 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE.
  2752 0000-DFHEXIT SECTION.
  2753     MOVE '9#                    $   ' TO DFHEIV0.
  2754     MOVE 'EL680' TO DFHEIV1.
  2755     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2756     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  2757     MOVE '5'                   TO DC-OPTION-CODE.
  2758     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2759     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  2760     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  2761
  2762     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2763     MOVE 2           TO EMI-NUMBER-OF-LINES.
  2764
  2765     IF EIBCALEN = 0
  2766         GO TO 8800-UNAUTHORIZED-ACCESS.
  2767
  2768     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2769         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2770             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2771             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2772             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2773             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2774             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2775             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2776             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2777             MOVE THIS-PGM             TO PI-CALLING-PROGRAM.
  2778
  2779     IF EIBTRNID NOT = TRANS-ID
  2780         GO TO 8100-SEND-INITIAL-MAP.
  2781
  2782     IF EIBAID = DFHCLEAR
  2783         GO TO 9400-CLEAR.
  2784
  2785
  2786* EXEC CICS HANDLE CONDITION
  2787*        MAPFAIL (8100-SEND-INITIAL-MAP)
  2788*    END-EXEC.
  2789*    MOVE '"$?                   ! " #00002781' TO DFHEIV0
  2790     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  2791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2792     MOVE X'2220233030303032373831' TO DFHEIV0(25:11)
  2793     CALL 'kxdfhei1' USING DFHEIV0
  2794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2795
  2796
  2797 0100-RECEIVE-MAP.
  2798
  2799* EXEC CICS RECEIVE
  2800*        MAP    (MAP-NAME)
  2801*        MAPSET (MAPSET-NAME)
  2802*        INTO   (EL680AI)
  2803*    END-EXEC.
  2804     MOVE LENGTH OF
  2805      EL680AI
  2806       TO DFHEIV11
  2807*    MOVE '8"T I  L              ''   #00002786' TO DFHEIV0
  2808     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  56
* EL680.cbl
  2809     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2810     MOVE X'2020233030303032373836' TO DFHEIV0(25:11)
  2811     CALL 'kxdfhei1' USING DFHEIV0,
  2812           MAP-NAME,
  2813           EL680AI,
  2814           DFHEIV11,
  2815           MAPSET-NAME,
  2816           DFHEIV99,
  2817           DFHEIV99
  2818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2819
  2820
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  57
* EL680.cbl
  2822 0200-RECEIVE.
  2823     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2824         MOVE ER-0008  TO EMI-ERROR
  2825         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2826         MOVE -1    TO ANAMEL
  2827         GO TO 8200-SEND-DATAONLY.
  2828
  2829     IF PFENTERL = 0
  2830         GO TO 0300-CHECK-PFKEYS.
  2831     IF EIBAID NOT = DFHENTER
  2832         MOVE ER-0004  TO EMI-ERROR
  2833         GO TO 0320-INPUT-ERROR.
  2834
  2835     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  2836         MOVE PF-VALUES (PFENTERI) TO EIBAID
  2837     ELSE
  2838         MOVE ER-0029  TO EMI-ERROR
  2839         GO TO 0320-INPUT-ERROR.
  2840
  2841 0300-CHECK-PFKEYS.
  2842     IF EIBAID = DFHPF1
  2843         GO TO 1000-EDIT-INPUT-DATA.
  2844
  2845     IF EIBAID = DFHPF23
  2846         GO TO 8810-PF23.
  2847
  2848     IF EIBAID = DFHPF24
  2849         GO TO 9200-RETURN-MAIN-MENU.
  2850
  2851     IF EIBAID = DFHPF12
  2852         GO TO 9500-PF12.
  2853
  2854     IF EIBAID = DFHENTER
  2855         GO TO 1000-EDIT-INPUT-DATA.
  2856
  2857     MOVE ER-0029 TO EMI-ERROR.
  2858 0320-INPUT-ERROR.
  2859     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2860     MOVE AL-UNBON               TO PFENTERA.
  2861     IF PFENTERL = 0
  2862         MOVE -1                 TO ANAMEL
  2863     ELSE
  2864         MOVE -1                 TO PFENTERL.
  2865
  2866     GO TO 8200-SEND-DATAONLY.
  2867
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  58
* EL680.cbl
  2869 1000-EDIT-INPUT-DATA.
  2870******EDIT AMOUNT REQUESTED
  2871
  2872
  2873* EXEC CICS BIF DEEDIT
  2874*        FIELD  (AAMOUNTI)
  2875*        LENGTH (12)
  2876*    END-EXEC.
  2877     MOVE 12
  2878       TO DFHEIV11
  2879*    MOVE '@"L                   #   #00002843' TO DFHEIV0
  2880     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2881     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2882     MOVE X'2020233030303032383433' TO DFHEIV0(25:11)
  2883     CALL 'kxdfhei1' USING DFHEIV0,
  2884           AAMOUNTI,
  2885           DFHEIV11
  2886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2887
  2888
  2889     IF (AAMOUNTI NUMERIC)  AND
  2890        (AAMOUNTI NOT = ZERO)
  2891         MOVE AAMOUNTI       TO  WS-AMOUNT-REQUESTED
  2892                                 AAMOUNTO
  2893         MOVE AL-UNNON       TO  AAMOUNTA
  2894       ELSE
  2895         MOVE -1             TO  AAMOUNTL
  2896         MOVE AL-UNBON       TO  AAMOUNTA
  2897         MOVE ER-2361        TO  EMI-ERROR
  2898         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2899         ADD +1  TO  WS-ERROR-COUNT.
  2900
  2901***********INTEREST RATE (APR)
  2902
  2903* EXEC CICS BIF DEEDIT
  2904*        FIELD  (AINTRATI)
  2905*        LENGTH (8)
  2906*    END-EXEC.
  2907     MOVE 8
  2908       TO DFHEIV11
  2909*    MOVE '@"L                   #   #00002861' TO DFHEIV0
  2910     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2911     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2912     MOVE X'2020233030303032383631' TO DFHEIV0(25:11)
  2913     CALL 'kxdfhei1' USING DFHEIV0,
  2914           AINTRATI,
  2915           DFHEIV11
  2916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2917
  2918
  2919     IF (AINTRATI NUMERIC)  AND
  2920        (AINTRATI NOT = ZERO)
  2921         MOVE AINTRATI       TO  WS-APR
  2922                                 AINTRATO
  2923         MOVE AL-UNNON       TO  AINTRATA
  2924       ELSE
  2925         MOVE -1             TO  AINTRATL
  2926         MOVE AL-UNBON       TO  AINTRATA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  59
* EL680.cbl
  2927         MOVE ER-2363        TO  EMI-ERROR
  2928         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2929         ADD +1  TO  WS-ERROR-COUNT.
  2930
  2931***********PAYMENT FREQUENCY
  2932     IF AFREQI = 'MO' OR 'SM' OR 'BW' OR 'WK' OR
  2933                 'SA' OR 'AN' OR '13'
  2934         MOVE AL-UANON       TO  AFREQA
  2935         MOVE AFREQI         TO  WS-FREQ
  2936       ELSE
  2937         MOVE -1             TO  AFREQL
  2938         MOVE AL-UABON       TO  AFREQA
  2939         MOVE ER-2920        TO  EMI-ERROR
  2940         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2941         ADD +1  TO  WS-ERROR-COUNT.
  2942
  2943***********NUMBER OF PAYMENTS
  2944
  2945* EXEC CICS BIF DEEDIT
  2946*        FIELD  (ANOPMTSI)
  2947*        LENGTH (3)
  2948*    END-EXEC.
  2949     MOVE 3
  2950       TO DFHEIV11
  2951*    MOVE '@"L                   #   #00002891' TO DFHEIV0
  2952     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2953     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2954     MOVE X'2020233030303032383931' TO DFHEIV0(25:11)
  2955     CALL 'kxdfhei1' USING DFHEIV0,
  2956           ANOPMTSI,
  2957           DFHEIV11
  2958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2959
  2960
  2961     IF (ANOPMTSI NUMERIC) AND
  2962        (ANOPMTSI NOT = ZERO)
  2963         MOVE ANOPMTSI       TO  WS-NUMBER-OF-PMTS
  2964                                 ANOPMTSO
  2965         MOVE AL-UNNON       TO  ANOPMTSA
  2966       ELSE
  2967         MOVE -1             TO  ANOPMTSL
  2968         MOVE AL-UNBON       TO  ANOPMTSA
  2969         MOVE ER-2364        TO  EMI-ERROR
  2970         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2971         ADD +1  TO  WS-ERROR-COUNT.
  2972
  2973***********ADDITIONAL DAYS TO FIRST PAYMENT
  2974     IF AADDAYSL GREATER THAN ZERO
  2975
  2976* EXEC CICS BIF DEEDIT
  2977*            FIELD  (AADDAYSI)
  2978*            LENGTH (3)
  2979*        END-EXEC
  2980     MOVE 3
  2981       TO DFHEIV11
  2982*    MOVE '@"L                   #   #00002910' TO DFHEIV0
  2983     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2984     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  60
* EL680.cbl
  2985     MOVE X'2020233030303032393130' TO DFHEIV0(25:11)
  2986     CALL 'kxdfhei1' USING DFHEIV0,
  2987           AADDAYSI,
  2988           DFHEIV11
  2989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2990         IF AADDAYSI NUMERIC
  2991             MOVE AADDAYSI       TO  WS-ADDTL-DAYS
  2992                                     AADDAYSO
  2993             MOVE AL-UNNON       TO  AADDAYSA
  2994           ELSE
  2995             MOVE -1             TO  AADDAYSL
  2996             MOVE AL-UNBON       TO  AADDAYSA
  2997             MOVE ER-2921        TO  EMI-ERROR
  2998             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2999             ADD +1  TO  WS-ERROR-COUNT.
  3000
  3001***********ADDITIONAL DAYS CHARGING METHOD
  3002********** SPACE=NO CHG, 1=LF, 2=AH, 3=LF AND AH
  3003     IF ADDCHGL  GREATER THAN ZERO
  3004     IF ADDCHGI = '1' OR '2' OR '3' OR ' '
  3005         MOVE AL-UANON       TO  ADDCHGA
  3006         MOVE ADDCHGI        TO  WS-ADDCHG
  3007       ELSE
  3008         MOVE -1             TO  ADDCHGL
  3009         MOVE AL-UABON       TO  ADDCHGA
  3010         MOVE ER-4004        TO  EMI-ERROR
  3011         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3012         ADD +1  TO  WS-ERROR-COUNT.
  3013
  3014***********BASIS
  3015     IF ABASISI = 'AF' OR 'TP' OR 'NP'
  3016         MOVE AL-UANON       TO  ABASISA
  3017         MOVE ABASISI        TO  WS-BASIS-X
  3018       ELSE
  3019         MOVE -1             TO  ABASISL
  3020         MOVE AL-UABON       TO  ABASISA
  3021         MOVE ER-2367        TO  EMI-ERROR
  3022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3023         ADD +1  TO  WS-ERROR-COUNT.
  3024
  3025**********USE O/B NET ACTUARIAL RATE
  3026     IF OBYORNL GREATER ZERO
  3027     IF OBYORNI = 'Y' OR 'N'
  3028         MOVE AL-UANON       TO  OBYORNA
  3029         MOVE OBYORNI        TO  WS-OBYN
  3030       ELSE
  3031         MOVE -1             TO  OBYORNL
  3032         MOVE AL-UABON       TO  OBYORNA
  3033         MOVE ER-2922        TO  EMI-ERROR
  3034         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3035         ADD +1  TO  WS-ERROR-COUNT.
  3036
  3037***********NP BENEFIT INCLUDES PREMIUM (Y/N)
  3038     IF WS-BASIS-X = 'NP'
  3039         IF ANPREMI = 'Y' OR 'N'
  3040             MOVE AL-UANON       TO  ANPREMA
  3041             MOVE ANPREMI        TO  WS-NPBEN
  3042           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  61
* EL680.cbl
  3043             MOVE -1             TO  ANPREML
  3044             MOVE AL-UABON       TO  ANPREMA
  3045             MOVE ER-2922        TO  EMI-ERROR
  3046             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3047             ADD +1  TO  WS-ERROR-COUNT.
  3048
  3049***********TRUNCATED LIFE NO. OF PAYMENTS COVERED
  3050     IF ATRUNCL GREATER THAN ZERO
  3051
  3052* EXEC CICS BIF DEEDIT
  3053*            FIELD  (ATRUNCI)
  3054*            LENGTH (3)
  3055*        END-EXEC
  3056     MOVE 3
  3057       TO DFHEIV11
  3058*    MOVE '@"L                   #   #00002975' TO DFHEIV0
  3059     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3060     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3061     MOVE X'2020233030303032393735' TO DFHEIV0(25:11)
  3062     CALL 'kxdfhei1' USING DFHEIV0,
  3063           ATRUNCI,
  3064           DFHEIV11
  3065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3066         IF ATRUNCI IS NUMERIC
  3067             MOVE ATRUNCI        TO  WS-TRUNC
  3068                                     ATRUNCO
  3069             MOVE AL-UNNON       TO  ATRUNCA
  3070           IF WS-TRUNC GREATER WS-NUMBER-OF-PMTS
  3071             MOVE -1             TO  ATRUNCL
  3072             MOVE AL-UNBON       TO  ATRUNCA
  3073             MOVE ER-4007        TO  EMI-ERROR
  3074             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3075             ADD +1  TO  WS-ERROR-COUNT
  3076           ELSE
  3077             NEXT SENTENCE
  3078           ELSE
  3079             MOVE -1             TO  ATRUNCL
  3080             MOVE AL-UNBON       TO  ATRUNCA
  3081             MOVE ER-2923        TO  EMI-ERROR
  3082             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3083             ADD +1  TO  WS-ERROR-COUNT.
  3084
  3085***********EXTRA INTEREST PERIODS
  3086     IF AEXTRAL GREATER THAN ZERO
  3087
  3088* EXEC CICS BIF DEEDIT
  3089*            FIELD  (AEXTRAI)
  3090*            LENGTH (1)
  3091*        END-EXEC
  3092     MOVE 1
  3093       TO DFHEIV11
  3094*    MOVE '@"L                   #   #00003000' TO DFHEIV0
  3095     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3096     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3097     MOVE X'2020233030303033303030' TO DFHEIV0(25:11)
  3098     CALL 'kxdfhei1' USING DFHEIV0,
  3099           AEXTRAI,
  3100           DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  62
* EL680.cbl
  3101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3102         IF AEXTRAI NUMERIC
  3103             MOVE AEXTRAI        TO  WS-EXTRA
  3104                                     AEXTRAO
  3105             MOVE AL-UNNON       TO  AEXTRAA
  3106           ELSE
  3107             MOVE -1             TO  AEXTRAL
  3108             MOVE AL-UNBON       TO  AEXTRAA
  3109             MOVE ER-2924        TO  EMI-ERROR
  3110             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3111             ADD +1  TO  WS-ERROR-COUNT.
  3112
  3113***********LIFE RATE
  3114     IF ALRATEL GREATER THAN ZERO
  3115
  3116* EXEC CICS BIF DEEDIT
  3117*            FIELD  (ALRATEI)
  3118*            LENGTH (8)
  3119*        END-EXEC
  3120     MOVE 8
  3121       TO DFHEIV11
  3122*    MOVE '@"L                   #   #00003017' TO DFHEIV0
  3123     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3124     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3125     MOVE X'2020233030303033303137' TO DFHEIV0(25:11)
  3126     CALL 'kxdfhei1' USING DFHEIV0,
  3127           ALRATEI,
  3128           DFHEIV11
  3129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3130         IF ALRATEI NUMERIC
  3131             MOVE ALRATEI        TO  WS-LIFE-RATE
  3132                                     ALRATEO
  3133             MOVE AL-UNNON       TO  ALRATEA
  3134           ELSE
  3135             MOVE -1             TO  ALRATEL
  3136             MOVE AL-UNBON       TO  ALRATEA
  3137             MOVE ER-2365        TO  EMI-ERROR
  3138             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3139             ADD +1  TO  WS-ERROR-COUNT.
  3140
  3141***********LIFE DEVIATION
  3142     IF ALFDEVL GREATER THAN ZERO
  3143
  3144* EXEC CICS BIF DEEDIT
  3145*            FIELD  (ALFDEVI)
  3146*            LENGTH (7)
  3147*        END-EXEC
  3148     MOVE 7
  3149       TO DFHEIV11
  3150*    MOVE '@"L                   #   #00003034' TO DFHEIV0
  3151     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3152     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3153     MOVE X'2020233030303033303334' TO DFHEIV0(25:11)
  3154     CALL 'kxdfhei1' USING DFHEIV0,
  3155           ALFDEVI,
  3156           DFHEIV11
  3157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3158         IF ALFDEVI NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  63
* EL680.cbl
  3159             MOVE ALFDEVI        TO  WS-LIFE-DEVIATION
  3160                                     ALFDEVO
  3161             MOVE AL-UNNON       TO  ALFDEVA
  3162           ELSE
  3163             MOVE -1             TO  ALFDEVL
  3164             MOVE AL-UNBON       TO  ALFDEVA
  3165             MOVE ER-2925        TO  EMI-ERROR
  3166             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3167             ADD +1  TO  WS-ERROR-COUNT
  3168     ELSE
  3169        MOVE 100 TO WS-LIFE-DEVIATION
  3170                    ALFDEVO.
  3171
  3172***********DISABILITY RATE
  3173     IF ADRATEL GREATER THAN ZERO
  3174
  3175* EXEC CICS BIF DEEDIT
  3176*            FIELD  (ADRATEI)
  3177*            LENGTH (8)
  3178*        END-EXEC
  3179     MOVE 8
  3180       TO DFHEIV11
  3181*    MOVE '@"L                   #   #00003054' TO DFHEIV0
  3182     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3183     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3184     MOVE X'2020233030303033303534' TO DFHEIV0(25:11)
  3185     CALL 'kxdfhei1' USING DFHEIV0,
  3186           ADRATEI,
  3187           DFHEIV11
  3188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3189         IF ADRATEI NUMERIC
  3190             MOVE ADRATEI        TO  WS-AH-RATE
  3191                                     ADRATEO
  3192             MOVE AL-UNNON       TO  ADRATEA
  3193           ELSE
  3194             MOVE -1             TO  ADRATEL
  3195             MOVE AL-UNBON       TO  ADRATEA
  3196             MOVE ER-2366        TO  EMI-ERROR
  3197             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3198             ADD +1  TO  WS-ERROR-COUNT.
  3199
  3200***********AH DEVIATION
  3201     IF AAHDEVL GREATER THAN ZERO
  3202
  3203* EXEC CICS BIF DEEDIT
  3204*            FIELD  (AAHDEVI)
  3205*            LENGTH (7)
  3206*        END-EXEC
  3207     MOVE 7
  3208       TO DFHEIV11
  3209*    MOVE '@"L                   #   #00003071' TO DFHEIV0
  3210     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3211     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3212     MOVE X'2020233030303033303731' TO DFHEIV0(25:11)
  3213     CALL 'kxdfhei1' USING DFHEIV0,
  3214           AAHDEVI,
  3215           DFHEIV11
  3216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  64
* EL680.cbl
  3217         IF AAHDEVI NUMERIC
  3218             MOVE AAHDEVI        TO  WS-AH-DEVIATION
  3219                                     AAHDEVO
  3220             MOVE AL-UNNON       TO  AAHDEVA
  3221           ELSE
  3222             MOVE -1             TO  AAHDEVL
  3223             MOVE AL-UNBON       TO  AAHDEVA
  3224             MOVE ER-2926        TO  EMI-ERROR
  3225             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3226             ADD +1  TO  WS-ERROR-COUNT
  3227     ELSE
  3228        MOVE 100 TO WS-AH-DEVIATION
  3229                    AAHDEVO.
  3230
  3231********** NO. PAYMENTS COVERED IF NOT SAME AS LIFE
  3232     IF ANOTLFL GREATER THAN ZERO
  3233
  3234* EXEC CICS BIF DEEDIT
  3235*            FIELD  (ANOTLFI)
  3236*            LENGTH (3)
  3237*        END-EXEC
  3238     MOVE 3
  3239       TO DFHEIV11
  3240*    MOVE '@"L                   #   #00003091' TO DFHEIV0
  3241     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3242     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3243     MOVE X'2020233030303033303931' TO DFHEIV0(25:11)
  3244     CALL 'kxdfhei1' USING DFHEIV0,
  3245           ANOTLFI,
  3246           DFHEIV11
  3247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3248         IF ANOTLFI NUMERIC
  3249             MOVE ANOTLFI        TO  WS-PAYMENTS-COVERED
  3250                                     ANOTLFO
  3251             MOVE AL-UNNON       TO  ANOTLFA
  3252           ELSE
  3253             MOVE -1             TO  ANOTLFL
  3254             MOVE AL-UNBON       TO  ANOTLFA
  3255             MOVE ER-2927        TO  EMI-ERROR
  3256             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3257             ADD +1  TO  WS-ERROR-COUNT.
  3258
  3259********** BALLOON AMOUNT
  3260     IF BALAMTL GREATER THAN ZERO
  3261
  3262* EXEC CICS BIF DEEDIT
  3263*            FIELD  (BALAMTI)
  3264*            LENGTH (12)
  3265*        END-EXEC
  3266     MOVE 12
  3267       TO DFHEIV11
  3268*    MOVE '@"L                   #   #00003108' TO DFHEIV0
  3269     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3270     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3271     MOVE X'2020233030303033313038' TO DFHEIV0(25:11)
  3272     CALL 'kxdfhei1' USING DFHEIV0,
  3273           BALAMTI,
  3274           DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  65
* EL680.cbl
  3275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3276         IF BALAMTI NUMERIC
  3277             MOVE BALAMTI        TO  WS-BALLOON-AMOUNT
  3278                                     BALAMTO
  3279             MOVE AL-UNNON       TO  BALAMTA
  3280           ELSE
  3281             MOVE -1             TO  BALAMTL
  3282             MOVE AL-UNBON       TO  BALAMTA
  3283             MOVE ER-2927        TO  EMI-ERROR
  3284             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3285             ADD +1  TO  WS-ERROR-COUNT.
  3286
  3287***********BALLOON RATE
  3288     IF BLRATEL GREATER THAN ZERO
  3289
  3290* EXEC CICS BIF DEEDIT
  3291*            FIELD  (BLRATEI)
  3292*            LENGTH (8)
  3293*        END-EXEC
  3294     MOVE 8
  3295       TO DFHEIV11
  3296*    MOVE '@"L                   #   #00003125' TO DFHEIV0
  3297     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3298     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3299     MOVE X'2020233030303033313235' TO DFHEIV0(25:11)
  3300     CALL 'kxdfhei1' USING DFHEIV0,
  3301           BLRATEI,
  3302           DFHEIV11
  3303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3304         IF BLRATEI NUMERIC
  3305             MOVE BLRATEI        TO  WS-BL-RATE
  3306                                     BLRATEO
  3307             MOVE AL-UNNON       TO  BLRATEA
  3308           ELSE
  3309             MOVE -1             TO  BLRATEL
  3310             MOVE AL-UNBON       TO  BLRATEA
  3311             MOVE ER-2366        TO  EMI-ERROR
  3312             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3313             ADD +1  TO  WS-ERROR-COUNT.
  3314
  3315********** BALLOON PAYMENT COINCIDE W/LAST PAYMENT (Y/N)
  3316     IF BALYNL GREATER THAN ZERO
  3317         IF BALYNI = 'Y' OR 'N'
  3318             MOVE BALYNI         TO  WS-BALYN
  3319             MOVE AL-UANON       TO  BALYNA
  3320           ELSE
  3321             MOVE -1             TO  BALYNL
  3322             MOVE AL-UABON       TO  BALYNA
  3323             MOVE ER-2927        TO  EMI-ERROR
  3324             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3325             ADD +1  TO  WS-ERROR-COUNT.
  3326
  3327********** REGULAR PAYMENT AMOUNT
  3328*    IF BALPAYL GREATER THAN ZERO
  3329*        EXEC CICS BIF DEEDIT
  3330*            FIELD  (BALPAYI)
  3331*            LENGTH (12)
  3332*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  66
* EL680.cbl
  3333*        IF BALPAYI NUMERIC  AND
  3334*           BALPAYI NOT = ZERO
  3335*            MOVE BALPAYI        TO  WS-REGULAR-PAYMENT
  3336*                                    BALPAYO
  3337*            MOVE AL-UNNON       TO  BALPAYA
  3338*          ELSE
  3339*            MOVE -1             TO  BALPAYL
  3340*            MOVE AL-UNBON       TO  BALPAYA
  3341*            MOVE ER-2927        TO  EMI-ERROR
  3342*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3343*            ADD +1  TO  WS-ERROR-COUNT.
  3344
  3345     IF WS-ERROR-COUNT GREATER THAN ZERO
  3346         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  67
* EL680.cbl
  3348
  3349 4000-PERFORM-CALCULATIONS.
  3350     IF WS-FREQ = 'MO'
  3351          MOVE 12 TO PPY.
  3352     IF WS-FREQ = '13'
  3353          MOVE 13 TO PPY.
  3354     IF WS-FREQ = 'SM'
  3355          MOVE 24 TO PPY.
  3356     IF WS-FREQ = 'BW'
  3357          MOVE 26 TO PPY.
  3358     IF WS-FREQ = 'WK'
  3359          MOVE 52 TO PPY.
  3360     IF WS-FREQ = 'SA'
  3361          MOVE 2 TO PPY.
  3362     IF WS-FREQ = 'AN'
  3363          MOVE 1 TO PPY.
  3364
  3365     IF WS-BASIS-X = 'AF'
  3366          MOVE 1 TO WS-BASIS.
  3367     IF WS-BASIS-X = 'TP'
  3368          MOVE 2 TO WS-BASIS.
  3369     IF WS-BASIS-X = 'NP'
  3370          MOVE 3 TO WS-BASIS.
  3371
  3372     MOVE WS-AMOUNT-REQUESTED TO OTF.
  3373
  3374     COMPUTE I = WS-APR / (100 * PPY).
  3375
  3376     MOVE WS-ADDTL-DAYS TO ADL-DAYS.
  3377
  3378     COMPUTE ADL-ADJ = 1 + I * ADL-DAYS / (365 / PPY).
  3379
  3380     COMPUTE ATF = OTF * ADL-ADJ.
  3381
  3382     MOVE WS-TRUNC TO COV-TERM.
  3383
  3384     MOVE WS-PAYMENTS-COVERED TO AHN.
  3385
  3386     MOVE WS-NUMBER-OF-PMTS TO N.
  3387
  3388     IF AHN LESS 1
  3389         MOVE COV-TERM TO AHN.
  3390
  3391     IF AHN LESS 1
  3392         MOVE N TO AHN.
  3393
  3394     MOVE WS-EXTRA TO EMII.
  3395
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  68
* EL680.cbl
  3397
  3398 4000-CONTINUE-CALCS-1.
  3399********* M USED FOR TRUNCATED NET PAY
  3400     IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3401                         OR 'LGX'
  3402        IF WS-TRUNC NOT EQUAL +0
  3403           MOVE WS-TRUNC         TO M.
  3404
  3405     MOVE WS-LIFE-RATE TO LIFE-RATE.
  3406
  3407     COMPUTE LR = (LIFE-RATE / 100) * 12 / PPY.
  3408
  3409     COMPUTE LIFEDEV = WS-LIFE-DEVIATION / 100.
  3410
  3411     COMPUTE LR = LR * LIFEDEV.
  3412
  3413     MOVE WS-AH-RATE TO AH-RATE.
  3414
  3415     COMPUTE AH = AH-RATE / 100.
  3416
  3417     COMPUTE AHDEV = WS-AH-DEVIATION / 100.
  3418
  3419     COMPUTE AH = AH * AHDEV.
  3420
  3421****** BALLOON RATE
  3422     MOVE WS-BL-RATE TO BL-RATE.
  3423
  3424     COMPUTE BL = BL-RATE / 100.
  3425*******************
  3426
  3427*****  N1 USED FOR O/B
  3428     IF COV-TERM = ZERO
  3429        COMPUTE N1 = N * 12 / PPY
  3430       ELSE
  3431        COMPUTE N1 = COV-TERM * 12 / PPY.
  3432
  3433     COMPUTE K1 = 12 / PPY.
  3434
  3435     IF PPY = 1 OR 2
  3436         MOVE 1     TO K1.
  3437
  3438     COMPUTE PADJ = (N1 + K1) / (N1 + 1).
  3439
  3440     IF WS-OBYN = 'Y'
  3441        IF PI-COMPANY-ID EQUAL 'CSO' OR 'CID' OR 'LGX'
  3442        COMPUTE L = LR * PADJ * M / 12 * (N1 + 1) / 20 * 12 / N1
  3443        ELSE
  3444        COMPUTE L = LR * PADJ * N / 12 * (N1 + 1) / 20 * 12 / N1
  3445     ELSE
  3446        IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3447                         OR 'CID'
  3448                         OR 'LGX'
  3449           COMPUTE L = LR * PADJ * M / 12
  3450        ELSE
  3451*          COMPUTE L = LR * PADJ * N / 12.
  3452           COMPUTE L = LR * PADJ * AHN / 12.
  3453
  3454     IF WS-BALLOON-AMOUNT NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  69
* EL680.cbl
  3455         GO TO 7000-BALLOON-CALC.
  3456
  3457     COMPUTE V = 1 / (1 + I).
  3458
  3459     COMPUTE VU = 1 - V ** N.
  3460
  3461     COMPUTE ANGLN = VU / I.
  3462
  3463     IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3464                         OR 'CID'
  3465                         OR 'LGX'
  3466        COMPUTE TOT-PMTS = I / VU * M
  3467     ELSE
  3468        COMPUTE TOT-PMTS = I / VU * N.
  3469
  3470     COMPUTE ATOT-PMTS = I / VU * AHN.
  3471
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  70
* EL680.cbl
  3473
  3474 4000-CONTINUE-CALCS-2.
  3475     GO TO 4000-COMM, 4000-COMM, 4000-NP
  3476         DEPENDING ON WS-BASIS.
  3477
  3478 4000-NP.
  3479     MOVE COV-TERM TO M.
  3480     IF M = 0
  3481        MOVE N TO M.
  3482
  3483     COMPUTE VU1 = 1 - V ** (N - M).
  3484
  3485     COMPUTE ANGLM = VU1 / I.
  3486
  3487     COMPUTE VA = (M - ANGLN + ANGLM) * 2 * N
  3488                   / (I * M * (2 * N - M + 1) * ANGLN).
  3489
  3490     IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3491                         OR 'CID'
  3492                         OR 'LGX'
  3493        COMPUTE VA = VA * ((1 + N) / (1 + M)).
  3494
  3495     COMPUTE RA = 1 - (N - M) * (N - M + 1) / (N * (N + 1)).
  3496
  3497     COMPUTE TA = VA * RA.
  3498
  3499     COMPUTE NPLF = TA * L * (1 + EMII * I).
  3500
  3501     IF WS-NPBEN = 'Y'
  3502        COMPUTE NPLF = NPLF / (1 - NPLF).
  3503
  3504 4000-COMM.
  3505     MOVE ZERO TO LIFE-PREM AH-PREM.
  3506
  3507     PERFORM 4000-GET-PREMIUM THRU 4000-EXIT.
  3508     GO TO 6000-DISPLAY-RESULTS.
  3509
  3510 4000-GET-PREMIUM.
  3511     PERFORM 5000-COMPUTE-PREMIUMS THRU 5000-EXIT
  3512         VARYING XREPT FROM +1 BY +1 UNTIL XREPT = +15.
  3513 4000-EXIT.
  3514     EXIT.
  3515
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  71
* EL680.cbl
  3517
  3518 5000-COMPUTE-PREMIUMS.
  3519     GO TO 5000-AF, 5000-TP, 5000-NP
  3520         DEPENDING ON WS-BASIS.
  3521
  3522 5000-AF.
  3523     COMPUTE LIFE-PREM = L / (1 - L) * (1 + AH-PREM).
  3524     GO TO 5000-GET-AH-PREM.
  3525
  3526 5000-TP.
  3527     COMPUTE LIFE-PREM = TOT-PMTS * L / (1 - TOT-PMTS * L)
  3528                             * (1 + AH-PREM).
  3529     GO TO 5000-GET-AH-PREM.
  3530
  3531 5000-NP.
  3532     COMPUTE LIFE-PREM = NPLF * (1 + AH-PREM).
  3533     GO TO 5000-GET-AH-PREM.
  3534
  3535 5000-GET-AH-PREM.
  3536     COMPUTE AH-PREM = ATOT-PMTS * AH / (1 - ATOT-PMTS * AH)
  3537                             * (1 + LIFE-PREM).
  3538
  3539     IF AH = 0 OR
  3540        LR = 0
  3541          GO TO 4000-EXIT.
  3542
  3543 5000-EXIT.
  3544     EXIT.
  3545
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  72
* EL680.cbl
  3547
  3548 6000-DISPLAY-RESULTS.
  3549     IF CHG-LF OR CHG-LF-AH
  3550         COMPUTE L-PREMIUM = LIFE-PREM * ATF
  3551       ELSE
  3552         COMPUTE L-PREMIUM = LIFE-PREM * OTF.
  3553
  3554     COMPUTE L-PREMIUM = (L-PREMIUM * 100 + .502) / 100.
  3555
  3556     IF CHG-AH OR CHG-LF-AH
  3557         COMPUTE A-PREMIUM = AH-PREM * ATF
  3558       ELSE
  3559         COMPUTE A-PREMIUM = AH-PREM * OTF.
  3560
  3561     COMPUTE A-PREMIUM = (A-PREMIUM * 100 + .502) / 100.
  3562
  3563     COMPUTE PAYMENT = I / VU * (ATF + L-PREMIUM + A-PREMIUM).
  3564
  3565     COMPUTE PAYMENT = (PAYMENT * 100 + .002) / 100.
  3566
  3567     COMPUTE TOT-FIN = OTF + L-PREMIUM + A-PREMIUM.
  3568
  3569     COMPUTE TOT-PAYMT = N * PAYMENT.
  3570
  3571     COMPUTE TOT-INTRS = TOT-PAYMT - TOT-FIN.
  3572
  3573 6500-COMMON-DISPLAY.
  3574     MOVE TOT-FIN             TO BAMOUNTO.
  3575
  3576     MOVE L-PREMIUM           TO BLAMTO.
  3577     MOVE A-PREMIUM           TO BDAMTO.
  3578     MOVE PAYMENT             TO BMOPMTO.
  3579     MOVE TOT-PAYMT           TO BTOTPMTO.
  3580     MOVE TOT-INTRS           TO BTOTINTO.
  3581     MOVE B                   TO BALPMTO.
  3582
  3583     MOVE -1                  TO ANAMEL.
  3584     GO TO 8200-SEND-DATAONLY.
  3585
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  73
* EL680.cbl
  3587 7000-BALLOON-CALC.
  3588     MOVE WS-BALLOON-AMOUNT   TO B.
  3589*    MOVE WS-REGULAR-PAYMENT  TO MP.
  3590
  3591     COMPUTE V = 1 / (1 + I).
  3592
  3593     COMPUTE V-NTH = V ** N.
  3594
  3595     COMPUTE ANGLN = (1 - V-NTH) / I.
  3596
  3597     COMPUTE ANGLN-LESS-1 = (1 - V-NTH / V) / I.
  3598
  3599     COMPUTE NM1 = N - 1.
  3600
  3601     COMPUTE AEQ = N / (N + 1).
  3602
  3603     IF WS-BALYN = 'Y'
  3604         MOVE N TO NM1
  3605         MOVE ANGLN TO ANGLN-LESS-1
  3606         MOVE 1 TO AEQ.
  3607
  3608     IF WS-BASIS = 2
  3609         GO TO 7500-TP-BALLOON.
  3610
  3611*    IF MP NOT = ZERO
  3612*        GO TO 7200-REGULAR-PAYMENT.
  3613
  3614     COMPUTE MPT = (N + 1) / 2 * (ATF - B * V-NTH) + L * (1 + EMII
  3615                  * I) * B * ANGLN.
  3616
  3617     COMPUTE MPB = (N + 1) / 2 * (ANGLN-LESS-1 - NM1 * AH) - L
  3618                   * (1 + EMII * I) * ((NM1 - ANGLN-LESS-1) / I).
  3619
  3620     DIVIDE MPT BY MPB GIVING MP.
  3621
  3622     GO TO 8000-DISPLAY-BALLOON-RESULTS.
  3623
  3624 7200-REGULAR-PAYMENT.
  3625     COMPUTE MPB = (N + 1) / 2 * (ANGLN-LESS-1 - NM1 * AH) - L
  3626                    * (1 + EMII * I) * (NM1 - ANGLN-LESS-1) / I.
  3627
  3628     COMPUTE B = (MPB * MP - (N + 1) / 2 * ATF) / (L * (1 + EMII
  3629                   * I) * ANGLN - (N + 1) / 2 * V-NTH).
  3630
  3631     GO TO 8000-DISPLAY-BALLOON-RESULTS.
  3632
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  74
* EL680.cbl
  3634 7500-TP-BALLOON.
  3635*    IF MP NOT = ZERO
  3636*        GO TO 7600-REGULAR-PAYMENT.
  3637
  3638     COMPUTE MPT = (ATF - B * V-NTH) + L * B * 2 * N / (N + 1).
  3639
  3640     COMPUTE MPB = (ANGLN-LESS-1 - NM1 * AH) - L * NM1 * AEQ.
  3641
  3642     COMPUTE MP = MPT / MPB.
  3643
  3644     GO TO 7700-SKIP.
  3645
  3646 7600-REGULAR-PAYMENT.
  3647     COMPUTE MPB = (ANGLN-LESS-1 - NM1 * AH) - L * NM1 * AEQ.
  3648
  3649     COMPUTE B = (MPB * MP - ATF) / (L * 2 * N / (N + 1) - V-NTH).
  3650
  3651 7700-SKIP.
  3652     COMPUTE IA = MP * NM1 + B.
  3653
  3654     IF WS-BALYN = 'Y'
  3655         COMPUTE VA = 1 + B / IA * (N - 1) / (N + 1)
  3656      ELSE
  3657         COMPUTE VA = N * (IA + B) / (IA * (N + 1)).
  3658
  3659 8000-DISPLAY-BALLOON-RESULTS.
  3660     COMPUTE A-PREMIUM = NM1 * MP * AH.
  3661
  3662     IF WS-BASIS = 2
  3663        COMPUTE L-PREMIUM = L * IA * VA
  3664      ELSE
  3665        COMPUTE L-PREMIUM = MP * ANGLN-LESS-1 + B * V-NTH - ATF -
  3666                A-PREMIUM.
  3667
  3668** IF BALLOON RATE KEYED, ADD PREMIUM TO LIFE PREMIUM
  3669     IF BL GREATER ZERO
  3670         COMPUTE L-PREMIUM = L-PREMIUM + (B * BL).
  3671
  3672     COMPUTE L-PREMIUM = (L-PREMIUM * 100 + .502) / 100.
  3673
  3674     COMPUTE A-PREMIUM = (A-PREMIUM * 100 + .502) / 100.
  3675
  3676     COMPUTE TOT-FIN = OTF + L-PREMIUM + A-PREMIUM.
  3677
  3678     COMPUTE MP = (MP * 100 + .002) / 100.
  3679     COMPUTE TOT-PAYMT = MP * NM1 + B.
  3680     MOVE MP TO PAYMENT.
  3681
  3682     COMPUTE TOT-INTRS = TOT-PAYMT - TOT-FIN.
  3683
  3684     GO TO 6500-COMMON-DISPLAY.
  3685
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  75
* EL680.cbl
  3687 8100-SEND-INITIAL-MAP SECTION.
  3688     MOVE LOW-VALUES             TO  EL680AI.
  3689
  3690     MOVE SAVE-DATE              TO  ADATEO.
  3691     MOVE EIBTIME                TO  WS-TIME-WORK.
  3692     MOVE WS-TIME                TO  ATIMEO.
  3693
  3694     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3695
  3696
  3697* EXEC CICS SEND
  3698*        FROM   (EL680AI)
  3699*        MAPSET (MAPSET-NAME)
  3700*        MAP    (MAP-NAME)
  3701*        ERASE
  3702*    END-EXEC.
  3703     MOVE LENGTH OF
  3704      EL680AI
  3705       TO DFHEIV11
  3706*    MOVE '8$      T  E    H L F ,   #00003521' TO DFHEIV0
  3707     MOVE X'382420202020202054202045' TO DFHEIV0(1:12)
  3708     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3709     MOVE X'2020233030303033353231' TO DFHEIV0(25:11)
  3710     CALL 'kxdfhei1' USING DFHEIV0,
  3711           MAP-NAME,
  3712           EL680AI,
  3713           DFHEIV11,
  3714           MAPSET-NAME,
  3715           DFHEIV99,
  3716           DFHEIV99,
  3717           DFHEIV99,
  3718           DFHEIV99,
  3719           DFHEIV99,
  3720           DFHEIV99,
  3721           DFHEIV99
  3722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3723
  3724
  3725     GO TO 9100-RETURN-TRAN.
  3726
  3727 8100-EXIT.
  3728      EXIT.
  3729
  3730 8200-SEND-DATAONLY SECTION.
  3731     MOVE SAVE-DATE              TO  ADATEO.
  3732     MOVE EIBTIME                TO  WS-TIME-WORK.
  3733     MOVE WS-TIME                TO  ATIMEO.
  3734
  3735     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3736
  3737     IF EMI-ERROR = 0
  3738        IF EIBAID = DFHPF1
  3739           MOVE SPACE            TO EIBAID
  3740           PERFORM 9000-START-PRINTER THRU 9000-EXIT
  3741           MOVE SPACES           TO SPC-FLD
  3742           MOVE SPC-FLD          TO PFENTERI
  3743           MOVE 0                TO PFENTERL
  3744           MOVE AL-UNNOF         TO PFENTERA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  76
* EL680.cbl
  3745
  3746
  3747* EXEC CICS SEND DATAONLY
  3748*        FROM   (EL680AI)
  3749*        MAPSET (MAPSET-NAME)
  3750*        MAP    (MAP-NAME)
  3751*        CURSOR
  3752*    END-EXEC.
  3753     MOVE LENGTH OF
  3754      EL680AI
  3755       TO DFHEIV12
  3756     MOVE -1
  3757       TO DFHEIV11
  3758*    MOVE '8$D    CT       H L F ,   #00003549' TO DFHEIV0
  3759     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3760     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3761     MOVE X'2020233030303033353439' TO DFHEIV0(25:11)
  3762     CALL 'kxdfhei1' USING DFHEIV0,
  3763           MAP-NAME,
  3764           EL680AI,
  3765           DFHEIV12,
  3766           MAPSET-NAME,
  3767           DFHEIV99,
  3768           DFHEIV99,
  3769           DFHEIV99,
  3770           DFHEIV11,
  3771           DFHEIV99,
  3772           DFHEIV99,
  3773           DFHEIV99
  3774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3775
  3776
  3777     GO TO 9100-RETURN-TRAN.
  3778
  3779 8200-EXIT.
  3780     EXIT.
  3781
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  77
* EL680.cbl
  3783 8300-SEND-TEXT SECTION.
  3784
  3785* EXEC CICS SEND TEXT
  3786*        FROM   (LOGOFF-TEXT)
  3787*        LENGTH (LOGOFF-LENGTH)
  3788*        ERASE  FREEKB
  3789*    END-EXEC.
  3790*    MOVE '8&      T  E F  H   F -   #00003563' TO DFHEIV0
  3791     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3792     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3793     MOVE X'2020233030303033353633' TO DFHEIV0(25:11)
  3794     CALL 'kxdfhei1' USING DFHEIV0,
  3795           LOGOFF-TEXT,
  3796           LOGOFF-LENGTH,
  3797           DFHEIV99,
  3798           DFHEIV99,
  3799           DFHEIV99,
  3800           DFHEIV99,
  3801           DFHEIV99,
  3802           DFHEIV99,
  3803           DFHEIV99,
  3804           DFHEIV99,
  3805           DFHEIV99,
  3806           DFHEIV99
  3807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3808
  3809
  3810
  3811* EXEC CICS RETURN
  3812*    END-EXEC.
  3813*    MOVE '.(                    &   #00003569' TO DFHEIV0
  3814     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3815     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3816     MOVE X'2020233030303033353639' TO DFHEIV0(25:11)
  3817     CALL 'kxdfhei1' USING DFHEIV0,
  3818           DFHEIV99,
  3819           DFHEIV99,
  3820           DFHEIV99,
  3821           DFHEIV99,
  3822           DFHEIV99
  3823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3824
  3825
  3826 8300-EXIT.
  3827     EXIT.
  3828
  3829 8400-NOT-FOUND.
  3830     MOVE ER-0190                TO EMI-ERROR.
  3831     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3832     GO TO 8200-SEND-DATAONLY.
  3833
  3834 8820-TERMID-ERROR.
  3835     MOVE ER-0412                TO EMI-ERROR.
  3836     GO TO 8999-OPEN-ERROR.
  3837
  3838 8830-TRANS-ERROR.
  3839     MOVE ER-0413                TO EMI-ERROR.
  3840     GO TO 8999-OPEN-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  78
* EL680.cbl
  3841
  3842 8840-CNTL-NOT-OPEN.
  3843     MOVE ER-0042 TO EMI-ERROR.
  3844     GO TO 8999-OPEN-ERROR.
  3845
  3846 8800-UNAUTHORIZED-ACCESS.
  3847     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3848     GO TO 8300-SEND-TEXT.
  3849
  3850 8810-PF23.
  3851     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3852     MOVE XCTL-005               TO PGM-NAME.
  3853     GO TO 9300-XCTL.
  3854
  3855 8999-OPEN-ERROR.
  3856     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3857     GO TO 8200-SEND-DATAONLY.
  3858
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  79
* EL680.cbl
  3860 9000-START-PRINTER.
  3861     MOVE PI-COMPANY-ID TO CNTL-COMP-ID.
  3862
  3863
  3864* EXEC CICS HANDLE CONDITION
  3865*         NOTOPEN     (8840-CNTL-NOT-OPEN)
  3866*         NOTFND      (8400-NOT-FOUND)
  3867*         TERMIDERR   (8820-TERMID-ERROR)
  3868*         TRANSIDERR  (8830-TRANS-ERROR)
  3869*    END-EXEC.
  3870*    MOVE '"$JI[\                ! # #00003609' TO DFHEIV0
  3871     MOVE X'22244A495B5C202020202020' TO DFHEIV0(1:12)
  3872     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3873     MOVE X'2320233030303033363039' TO DFHEIV0(25:11)
  3874     CALL 'kxdfhei1' USING DFHEIV0
  3875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3876
  3877
  3878     MOVE '1'        TO CNTL-REC-TYPE.
  3879     MOVE SPACES     TO CNTL-ACCESS.
  3880     MOVE +0         TO CNTL-SEQ-NO.
  3881
  3882
  3883* EXEC CICS READ
  3884*        DATASET ('ELCNTL')
  3885*        SET     (ADDRESS OF CONTROL-FILE)
  3886*        RIDFLD  (ELCNTL-KEY)
  3887*    END-EXEC.
  3888     MOVE 'ELCNTL' TO DFHEIV1
  3889*    MOVE '&"S        E          (   #00003620' TO DFHEIV0
  3890     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3891     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3892     MOVE X'2020233030303033363230' TO DFHEIV0(25:11)
  3893     CALL 'kxdfhei1' USING DFHEIV0,
  3894           DFHEIV1,
  3895           DFHEIV20,
  3896           DFHEIV99,
  3897           ELCNTL-KEY,
  3898           DFHEIV99,
  3899           DFHEIV99,
  3900           DFHEIV99
  3901     SET ADDRESS OF CONTROL-FILE TO
  3902         DFHEIV20
  3903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3904
  3905
  3906     IF PI-COMPANY-ID = 'DMD' OR 'CID'
  3907*        MOVE EIBTRMID       TO CF-FORMS-PRINTER-ID
  3908         MOVE EL680AI        TO PI-PROGRAM-WORK-AREA
  3909
  3910* EXEC CICS START
  3911*             INTERVAL  (0)
  3912*             TRANSID   (START-TRANS-ID)
  3913*             FROM      (PROGRAM-INTERFACE-BLOCK)
  3914*             LENGTH    (PI-COMM-LENGTH)
  3915*             TERMID (CF-FORMS-PRINTER-ID)
  3916*             END-EXEC
  3917     MOVE 0 TO DFHEIV10
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  80
* EL680.cbl
  3918*    MOVE '0(ILF                 0   #00003629' TO DFHEIV0
  3919     MOVE X'3028494C4620202020202020' TO DFHEIV0(1:12)
  3920     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  3921     MOVE X'2020233030303033363239' TO DFHEIV0(25:11)
  3922     CALL 'kxdfhei1' USING DFHEIV0,
  3923           DFHEIV10,
  3924           START-TRANS-ID,
  3925           DFHEIV99,
  3926           PROGRAM-INTERFACE-BLOCK,
  3927           PI-COMM-LENGTH,
  3928           DFHEIV99,
  3929           DFHEIV99,
  3930           DFHEIV99,
  3931           DFHEIV99,
  3932           DFHEIV99,
  3933           DFHEIV99,
  3934           DFHEIV99,
  3935           DFHEIV99,
  3936           DFHEIV99,
  3937           DFHEIV99
  3938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3939     ELSE
  3940
  3941* EXEC CICS START
  3942*            TRANSID(START-TRANS-ID)
  3943*            TERMID (CF-FORMS-PRINTER-ID)
  3944*            FROM   (EL680AI)
  3945*            LENGTH (426)
  3946*        END-EXEC.
  3947     MOVE 426
  3948       TO DFHEIV11
  3949*    MOVE '0( LFT                0   #00003637' TO DFHEIV0
  3950     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  3951     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  3952     MOVE X'2020233030303033363337' TO DFHEIV0(25:11)
  3953     CALL 'kxdfhei1' USING DFHEIV0,
  3954           DFHEIV99,
  3955           START-TRANS-ID,
  3956           DFHEIV99,
  3957           EL680AI,
  3958           DFHEIV11,
  3959           CF-FORMS-PRINTER-ID,
  3960           DFHEIV99,
  3961           DFHEIV99,
  3962           DFHEIV99,
  3963           DFHEIV99,
  3964           DFHEIV99,
  3965           DFHEIV99,
  3966           DFHEIV99,
  3967           DFHEIV99,
  3968           DFHEIV99
  3969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3970
  3971
  3972 9000-EXIT.
  3973     EXIT.
  3974
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  81
* EL680.cbl
  3976 9100-RETURN-TRAN.
  3977     MOVE    EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3978     MOVE SCREEN-NUMBER             TO PI-CURRENT-SCREEN-NO.
  3979
  3980* EXEC CICS RETURN
  3981*        TRANSID    (TRANS-ID)
  3982*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3983*        LENGTH     (PI-COMM-LENGTH)
  3984*    END-EXEC.
  3985*    MOVE '.(CT                  &   #00003651' TO DFHEIV0
  3986     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3987     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3988     MOVE X'2020233030303033363531' TO DFHEIV0(25:11)
  3989     CALL 'kxdfhei1' USING DFHEIV0,
  3990           TRANS-ID,
  3991           PROGRAM-INTERFACE-BLOCK,
  3992           PI-COMM-LENGTH,
  3993           DFHEIV99,
  3994           DFHEIV99
  3995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3996
  3997
  3998
  3999* GOBACK.
  4000     MOVE '9%                    "   ' TO DFHEIV0
  4001     MOVE 'EL680' TO DFHEIV1
  4002     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4003     GOBACK.
  4004
  4005 9200-RETURN-MAIN-MENU.
  4006     MOVE XCTL-626               TO PGM-NAME.
  4007     GO TO 9300-XCTL.
  4008
  4009 9300-XCTL.
  4010
  4011* EXEC CICS XCTL
  4012*        PROGRAM    (PGM-NAME)
  4013*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  4014*        LENGTH     (PI-COMM-LENGTH)
  4015*    END-EXEC.
  4016*    MOVE '.$C                   $   #00003664' TO DFHEIV0
  4017     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4018     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4019     MOVE X'2020233030303033363634' TO DFHEIV0(25:11)
  4020     CALL 'kxdfhei1' USING DFHEIV0,
  4021           PGM-NAME,
  4022           PROGRAM-INTERFACE-BLOCK,
  4023           PI-COMM-LENGTH
  4024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4025
  4026
  4027 9400-CLEAR.
  4028     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  4029     GO TO 9300-XCTL.
  4030
  4031 9500-PF12.
  4032     MOVE XCTL-010               TO PGM-NAME.
  4033     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  82
* EL680.cbl
  4034
  4035 9600-PGMID-ERROR.
  4036
  4037* EXEC CICS HANDLE CONDITION
  4038*        PGMIDERR    (8300-SEND-TEXT)
  4039*    END-EXEC.
  4040*    MOVE '"$L                   ! $ #00003679' TO DFHEIV0
  4041     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4042     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4043     MOVE X'2420233030303033363739' TO DFHEIV0(25:11)
  4044     CALL 'kxdfhei1' USING DFHEIV0
  4045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4046
  4047
  4048     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  4049     MOVE ' '                    TO PI-ENTRY-CD-1.
  4050     MOVE XCTL-005               TO PGM-NAME.
  4051     MOVE PGM-NAME               TO LOGOFF-PGM.
  4052     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  4053     GO TO 9300-XCTL.
  4054
  4055 9700-LINK-DATE-CONVERT.
  4056
  4057* EXEC CICS LINK
  4058*        PROGRAM    ('ELDATCV')
  4059*        COMMAREA   (DATE-CONVERSION-DATA)
  4060*        LENGTH     (DC-COMM-LENGTH)
  4061*    END-EXEC.
  4062     MOVE 'ELDATCV' TO DFHEIV1
  4063*    MOVE '."C                   ''   #00003691' TO DFHEIV0
  4064     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4065     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4066     MOVE X'2020233030303033363931' TO DFHEIV0(25:11)
  4067     CALL 'kxdfhei1' USING DFHEIV0,
  4068           DFHEIV1,
  4069           DATE-CONVERSION-DATA,
  4070           DC-COMM-LENGTH,
  4071           DFHEIV99,
  4072           DFHEIV99,
  4073           DFHEIV99
  4074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4075
  4076
  4077 9700-EXIT.
  4078     EXIT.
  4079
  4080 9900-ERROR-FORMAT.
  4081     IF NOT EMI-ERRORS-COMPLETE
  4082         MOVE LINK-001           TO PGM-NAME
  4083
  4084* EXEC CICS LINK
  4085*            PROGRAM    (PGM-NAME)
  4086*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  4087*            LENGTH     (EMI-COMM-LENGTH)
  4088*        END-EXEC.
  4089*    MOVE '."C                   ''   #00003703' TO DFHEIV0
  4090     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4091     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  83
* EL680.cbl
  4092     MOVE X'2020233030303033373033' TO DFHEIV0(25:11)
  4093     CALL 'kxdfhei1' USING DFHEIV0,
  4094           PGM-NAME,
  4095           ERROR-MESSAGE-INTERFACE-BLOCK,
  4096           EMI-COMM-LENGTH,
  4097           DFHEIV99,
  4098           DFHEIV99,
  4099           DFHEIV99
  4100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4101
  4102
  4103 9900-EXIT.
  4104     EXIT.
  4105
  4106 9990-ABEND.
  4107     MOVE LINK-004               TO PGM-NAME.
  4108     MOVE DFHEIBLK               TO EMI-LINE1.
  4109
  4110
  4111* EXEC CICS LINK
  4112*        PROGRAM   (PGM-NAME)
  4113*        COMMAREA  (EMI-LINE1)
  4114*        LENGTH    (72)
  4115*    END-EXEC.
  4116     MOVE 72
  4117       TO DFHEIV11
  4118*    MOVE '."C                   ''   #00003716' TO DFHEIV0
  4119     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4120     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4121     MOVE X'2020233030303033373136' TO DFHEIV0(25:11)
  4122     CALL 'kxdfhei1' USING DFHEIV0,
  4123           PGM-NAME,
  4124           EMI-LINE1,
  4125           DFHEIV11,
  4126           DFHEIV99,
  4127           DFHEIV99,
  4128           DFHEIV99
  4129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4130
  4131
  4132     GO TO 8200-SEND-DATAONLY.
  4133
  4134
  4135 9999-DFHBACK SECTION.
  4136     MOVE '9%                    "   ' TO DFHEIV0
  4137     MOVE 'EL680' TO DFHEIV1
  4138     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4139     GOBACK.
  4140 9999-DFHEXIT.
  4141     IF DFHEIGDJ EQUAL 0001
  4142         NEXT SENTENCE
  4143     ELSE IF DFHEIGDJ EQUAL 2
  4144         GO TO 8100-SEND-INITIAL-MAP
  4145         DEPENDING ON DFHEIGDI
  4146     ELSE IF DFHEIGDJ EQUAL 3
  4147         GO TO 8840-CNTL-NOT-OPEN,
  4148               8400-NOT-FOUND,
  4149               8820-TERMID-ERROR,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  84
* EL680.cbl
  4150               8830-TRANS-ERROR
  4151         DEPENDING ON DFHEIGDI
  4152     ELSE IF DFHEIGDJ EQUAL 4
  4153         GO TO 8300-SEND-TEXT
  4154         DEPENDING ON DFHEIGDI.
  4155     MOVE '9%                    "   ' TO DFHEIV0
  4156     MOVE 'EL680' TO DFHEIV1
  4157     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4158     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        4328     Code:       11540
