* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   1
* EL630.cbl
* Options: int("EL630.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL630.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL630.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL630.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL630.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/19/94 08:59:00.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.046.
     9
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   2
* EL630.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXA5 - NEW BUSINESS - DATA ENTRY.
    25*
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 103001    2001100100006  SMVA  CHECK FOR ? MARKS ANYWHERE IN
    35*                              BATCH NUMBER
    36* 072308  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
    37* 111109  CR2008100900003  AJRA  ADD NEW CERT NOTE TABLE
    38* 030310  CR2009031200002  PEMA  OPEN LOAN OFFICER ON 6301
    39* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    40******************************************************************
    41
    42 ENVIRONMENT DIVISION.
    43
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   3
* EL630.cbl
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*    EL630 WORKING STORAGE     *'.
    51 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    52
    53*    COPY ELCSCTM.
    54******************************************************************
    55*                                                                *
    56*                                                                *
    57*                            ELCSCTM                             *
    58*                            VMOD=2.001                          *
    59*                                                                *
    60*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    61*                                                                *
    62******************************************************************
    63 01  SECURITY-MESSAGE.
    64     12  FILLER                          PIC X(30)
    65            VALUE '** LOGIC SECURITY VIOLATION -'.
    66     12  SM-READ                         PIC X(6).
    67     12  FILLER                          PIC X(5)
    68            VALUE ' PGM='.
    69     12  SM-PGM                          PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' OPR='.
    72     12  SM-PROCESSOR-ID                 PIC X(4).
    73     12  FILLER                          PIC X(6)
    74            VALUE ' TERM='.
    75     12  SM-TERMID                       PIC X(4).
    76     12  FILLER                          PIC XX   VALUE SPACE.
    77     12  SM-JUL-DATE                     PIC 9(5).
    78     12  FILLER                          PIC X    VALUE SPACE.
    79     12  SM-TIME                         PIC 99.99.
    80
    81*    COPY ELCSCRTY.
    82******************************************************************
    83*                                                                *
    84*                                                                *
    85*                            ELCSCRTY                            *
    86*                            VMOD=2.001                          *
    87*                                                                *
    88*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    89*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    90*        SAVED IN PI-SECURITY-ADDRESS.                           *
    91*                                                                *
    92******************************************************************
    93 01  SECURITY-CONTROL.
    94     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    95     12  FILLER                       PIC XX    VALUE 'SC'.
    96     12  SC-CREDIT-CODES.
    97         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    98             20  SC-CREDIT-DISPLAY    PIC X.
    99             20  SC-CREDIT-UPDATE     PIC X.
   100     12  SC-CLAIMS-CODES.
   101         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   102             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   4
* EL630.cbl
   103             20  SC-CLAIMS-UPDATE     PIC X.
   104
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   5
* EL630.cbl
   106
   107 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1900.
   108 01  STANDARD-AREAS.
   109     12  SC-ITEM                 PIC S9(4) COMP VALUE +1.
   110     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   111     12  MAP-NAME                PIC X(8)    VALUE 'EL630A'.
   112     12  MAPSET-NAME             PIC X(8)    VALUE 'EL630S '.
   113     12  SCREEN-NUMBER           PIC X(4)    VALUE '630A'.
   114     12  TRANS-ID                PIC X(4)    VALUE 'EXA5'.
   115     12  EDIT-TRANS              PIC X(4)    VALUE 'EXEB'.
   116     12  PASS-AREA-LEN           PIC S9(4)   COMP VALUE +16.
   117     12  THIS-PGM                PIC X(8)    VALUE 'EL630'.
   118     12  PGM-NAME                PIC X(8)    VALUE SPACES.
   119     12  TIME-IN                 PIC S9(7)   VALUE ZEROS.
   120     12  TIME-OUT-R  REDEFINES TIME-IN.
   121         16  FILLER              PIC X.
   122         16  TIME-OUT            PIC 99V99.
   123         16  FILLER              PIC X(2).
   124     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   125     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   126     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   127     12  XCTL-6301               PIC X(8)    VALUE 'EL6301'.
   128     12  XCTL-6302               PIC X(8)    VALUE 'EL6302'.
   129     12  XCTL-633                PIC X(8)    VALUE 'EL633'.
   130     12  XCTL-633DMD             PIC X(8)    VALUE 'EL633DMD'.
   131     12  XCTL-635                PIC X(8)    VALUE 'EL635'.
   132     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   133     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   134     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   135     12  ELCNTL-FILE-ID          PIC X(8)    VALUE 'ELCNTL'.
   136     12  ERPNDB-FILE-ID          PIC X(8)    VALUE 'ERPNDB'.
   137     12  ERACCT-FILE-ID          PIC X(8)    VALUE 'ERACCT'.
   138     12  ERACCT2-FILE-ID         PIC X(8)    VALUE 'ERACCT2'.
   139     12  ELCERT-FILE-ID          PIC X(8)    VALUE 'ELCERT'.
   140     12  ERNOTE-FILE-ID          PIC X(8)    VALUE 'ERNOTE'.
   141     12  ERCNOT-FILE-ID          PIC X(8)    VALUE 'ERCNOT'.
   142     12  ERMAIL-FILE-ID          PIC X(8)    VALUE 'ERMAIL'.
   143     12  ERCOMP-FILE-ID          PIC X(8)    VALUE 'ERCOMP'.
   144     12  ERPNDM-FILE-ID          PIC X(8)    VALUE 'ERPNDM'.
   145     12  ERRQST-FILE-ID          PIC X(8)    VALUE 'ERRQST'.
   146     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   147     12  WS-CURRENT-DT           PIC X(8)    VALUE SPACES.
   148     12  WS-CURRENT-YMD          PIC 9(6)    VALUE ZEROS.
   149     12  WS-SYNC-CNTR            PIC S9(3)   VALUE +0 COMP-3.
   150     12  WS-SUB1                 PIC S9(4)   VALUE +0 COMP.
   151     12  WS-SUB2                 PIC S9(4)   VALUE +0 COMP.
   152     12  PIC6-SUB                PIC S9(04)  VALUE +0 COMP.
   153     12  WS-AR-REPORTING         PIC X       VALUE SPACE.
   154         88  AR-NET-REPORT               VALUE 'N'.
   155         88  AR-GROSS-REPORT             VALUE 'G'.
   156     12  WS-COMP-MASTER-ERROR-SW PIC X       VALUE SPACE.
   157         88  WS-COMP-MASTER-ERROR        VALUE 'Y'.
   158
   159     12  WS-UPDATE-REFERENCE-SW  PIC X       VALUE SPACE.
   160         88  WS-UPDATE-REFERENCE         VALUE 'Y'.
   161
   162     12  WS-SWITCH               PIC X(01)   VALUE SPACE.
   163         88  QUESTION-MARK-FOUND             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   6
* EL630.cbl
   164
   165     12  WS-RECORD-FOUND-SW      PIC X       VALUE SPACE.
   166         88  RECORD-FOUND                VALUE 'Y'.
   167         88  RECORD-NOT-FOUND            VALUE 'N'.
   168
   169     12  WS-ON1-SW1              PIC X(01)   VALUE 'Y'.
   170     12  WS-ON1-SW2              PIC X(01)   VALUE 'Y'.
   171     12  WS-ON1-SW3              PIC X(01)   VALUE 'Y'.
   172     12  WS-ON1-SW4              PIC X(01)   VALUE 'Y'.
   173     12  WS-ON1-SW5              PIC X(01)   VALUE 'Y'.
   174     12  WS-ON1-SW6              PIC X(01)   VALUE 'Y'.
   175     12  WS-ON1-SW7              PIC X(01)   VALUE 'Y'.
   176
   177     12  WS-ERPNDB-RECORD        PIC X(585)  VALUE SPACES.
   178
   179 01  BATCH-TO-PROCESS.
   180     05  EDIT-COMPANY-CD         PIC X       VALUE LOW-VALUES.
   181     05  EDIT-BATCH              PIC X(6)    VALUE SPACES.
   182     05  EDIT-COMPANY-ID         PIC XXX     VALUE SPACES.
   183     05  EDIT-RESTART-BATCH      PIC X(6)    VALUE SPACES.
   184
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   7
* EL630.cbl
   186 01  ERROR-MESSAGES.
   187     12  ER-0008                 PIC X(4)    VALUE '0008'.
   188     12  ER-0023                 PIC X(4)    VALUE '0023'.
   189     12  ER-0029                 PIC X(4)    VALUE '0029'.
   190     12  ER-0070                 PIC X(4)    VALUE '0070'.
   191     12  ER-0194                 PIC X(4)    VALUE '0194'.
   192     12  ER-0195                 PIC X(4)    VALUE '0195'.
   193     12  ER-0196                 PIC X(4)    VALUE '0196'.
   194     12  ER-0197                 PIC X(4)    VALUE '0197'.
   195     12  ER-0340                 PIC X(4)    VALUE '0340'.
   196     12  ER-0587                 PIC X(4)    VALUE '0587'.
   197     12  ER-0905                 PIC X(4)    VALUE '0905'.
   198     12  ER-2119                 PIC X(4)    VALUE '2119'.
   199     12  ER-2126                 PIC X(4)    VALUE '2126'.
   200     12  ER-2132                 PIC X(4)    VALUE '2132'.
   201     12  ER-2201                 PIC X(4)    VALUE '2201'.
   202     12  ER-2208                 PIC X(4)    VALUE '2208'.
   203     12  ER-2209                 PIC X(4)    VALUE '2209'.
   204     12  ER-2210                 PIC X(4)    VALUE '2210'.
   205     12  ER-2211                 PIC X(4)    VALUE '2211'.
   206     12  ER-2212                 PIC X(4)    VALUE '2212'.
   207     12  ER-2213                 PIC X(4)    VALUE '2213'.
   208     12  ER-2214                 PIC X(4)    VALUE '2214'.
   209     12  ER-2215                 PIC X(4)    VALUE '2215'.
   210     12  ER-2216                 PIC X(4)    VALUE '2216'.
   211     12  ER-2229                 PIC X(4)    VALUE '2229'.
   212     12  ER-2242                 PIC X(4)    VALUE '2242'.
   213     12  ER-2248                 PIC X(4)    VALUE '2248'.
   214     12  ER-2370                 PIC X(4)    VALUE '2370'.
   215     12  ER-2371                 PIC X(4)    VALUE '2371'.
   216     12  ER-2402                 PIC X(4)    VALUE '2402'.
   217     12  ER-2422                 PIC X(4)    VALUE '2422'.
   218     12  ER-2800                 PIC X(4)    VALUE '2800'.
   219     12  ER-2880                 PIC X(4)    VALUE '2880'.
   220     12  ER-2990                 PIC X(4)    VALUE '2990'.
   221
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   8
* EL630.cbl
   223 01  ACCESS-KEYS.
   224     12  ELCNTL-KEY.
   225         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   226         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   227         16  CNTL-ACCESS.
   228             20  CNTL-STATE      PIC XX    VALUE SPACES.
   229             20  FILLER          PIC X     VALUE SPACES.
   230             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   231         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   232
   233     12  ERPNDB-KEY.
   234         16  PNDB-COMP-CD        PIC X     VALUE SPACE.
   235         16  PNDB-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   236         16  PNDB-BATCH-SEQ      PIC S9(4) VALUE +0 COMP.
   237         16  PNDB-BATCH-CHG-SEQ  PIC S9(4) VALUE +0 COMP.
   238
   239     12  ERACCT-KEY.
   240         16  ERACCT-COMP-KEY.
   241             20  ACCT-CO         PIC X     VALUE SPACES.
   242             20  ACCT-CARRIER    PIC X     VALUE SPACES.
   243             20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
   244             20  ACCT-STATE      PIC XX    VALUE SPACES.
   245             20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
   246         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   247         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   248     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   249
   250     12  ELCERT-KEY.
   251         16  CERT-COMPANY-CD     PIC X     VALUE SPACES.
   252         16  CERT-CARRIER        PIC X     VALUE SPACES.
   253         16  CERT-GROUPING       PIC X(6)  VALUE SPACES.
   254         16  CERT-STATE          PIC XX    VALUE SPACES.
   255         16  FILLER              PIC X(23) VALUE SPACES.
   256
   257     12  ERCOMP-KEY.
   258         16  ERCOMP-COMP-CD      PIC X     VALUE SPACE.
   259         16  ERCOMP-CARRIER      PIC X     VALUE SPACES.
   260         16  ERCOMP-GROUPING     PIC X(6)  VALUE SPACES.
   261         16  ERCOMP-FIN-RESP     PIC X(10) VALUE SPACES.
   262         16  ERCOMP-ACCT         PIC X(10) VALUE SPACES.
   263         16  ERCOMP-RECORD-TYPE  PIC X     VALUE SPACES.
   264
   265     12  ERRQST-KEY.
   266         16  ERRQST-COMP-CD      PIC X     VALUE SPACE.
   267         16  ERRQST-ENTRY-BATCH  PIC X(6)  VALUE SPACES.
   268
   269     12  ERCNOT-KEY.
   270         16  ERCNOT-PART-KEY.
   271             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   272             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   273             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   274             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   275             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   276             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   277             20  ERCNOT-CERT-NO.
   278                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   279                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   280         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   9
* EL630.cbl
   281         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   282
   283
   284 01  FILLER.
   285     12  WS-DEEDIT-FIELD         PIC S9(8)V99 VALUE ZEROS.
   286     12  WS-DT-DEEDIT-FIELD REDEFINES
   287         WS-DEEDIT-FIELD         PIC X(10).
   288     12  WS-DEEDIT-FIELD-DATE  REDEFINES  WS-DEEDIT-FIELD.
   289         16   FILLER                           PIC X(04).
   290         16   WS-DEEDIT-FIELD-DATE-OUT         PIC X(06).
   291     12  QUESTION-MARKS          PIC X(6)      VALUE '??????'.
   292     12  QUESTION-MARK           PIC X(01)     VALUE '?'.
   293     12  WS-BATCH-NO             PIC 9(6)      VALUE ZEROS.
   294     12  WS-OBAL                 PIC S9(8)V99  VALUE ZEROS.
   295     12  WS-OCNT                 PIC S9(5)     VALUE ZEROS.
   296     12  WS-DELETE-CNT           PIC S9(5)     VALUE ZEROS.
   297     12  WS-PF1-SW               PIC X         VALUE SPACES.
   298         88  WS-PF1                            VALUE 'Y'.
   299
   300     12  WS-SAV-PNDB-KEY.
   301         16  WS-SAV-COMP-CD        PIC X       VALUE LOW-VALUES.
   302         16  WS-SAV-ENTRY-BATCH    PIC X(6)       VALUE SPACES.
   303         16  WS-SAV-BATCH-SEQ      PIC S9(4) COMP VALUE ZEROS.
   304         16  WS-SAV-BATCH-CHG-SEQ  PIC S9(4) COMP VALUE ZEROS.
   305
   306     12  DATE-TEST-AREA          PIC 9(6)         VALUE ZEROS.
   307     12  DATE-TEST-AREA-R  REDEFINES DATE-TEST-AREA.
   308         16  DATE-TEST-MM        PIC 99.
   309         16  DATE-TEST-DD        PIC 99.
   310         16  DATE-TEST-YY        PIC 99.
   311     12  DIVIDE-RESULT           PIC 99           VALUE ZEROS.
   312     12  DIVIDE-REMAINDER        PIC 9            VALUE 0.
   313     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   314         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   315     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   316         88 CERT-ADDRESS-PRESENT     VALUE 'Y'.
   317     12  WS-PRM-HEADER.
   318         16  WS-PRM-OVERRIDE     PIC XX           VALUE SPACES.
   319         16  FILLER              PIC X(8)  VALUE '-PREMIUM'.
   320     12  WS-REFUND-HEADER.
   321         16  WS-REFUND-OVERRIDE  PIC XX    VALUE SPACES.
   322         16  FILLER              PIC X(7)  VALUE '-REFUND'.
   323
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  10
* EL630.cbl
   325
   326*    COPY ELCDATE.
   327******************************************************************
   328*                                                                *
   329*                                                                *
   330*                            ELCDATE.                            *
   331*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   332*                            VMOD=2.003
   333*                                                                *
   334*                                                                *
   335*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   336*                 LENGTH = 200                                   *
   337******************************************************************
   338
   339 01  DATE-CONVERSION-DATA.
   340     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   341     12  DC-OPTION-CODE                PIC X.
   342         88  BIN-TO-GREG                VALUE ' '.
   343         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   344         88  EDIT-GREG-TO-BIN           VALUE '2'.
   345         88  YMD-GREG-TO-BIN            VALUE '3'.
   346         88  MDY-GREG-TO-BIN            VALUE '4'.
   347         88  JULIAN-TO-BIN              VALUE '5'.
   348         88  BIN-PLUS-ELAPSED           VALUE '6'.
   349         88  FIND-CENTURY               VALUE '7'.
   350         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   351         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   352         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   353         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   354         88  JULIAN-TO-BIN-3            VALUE 'C'.
   355         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   356         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   357         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   358         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   359         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   360         88  CHECK-LEAP-YEAR            VALUE 'H'.
   361         88  BIN-3-TO-GREG              VALUE 'I'.
   362         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   363         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   364         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   365         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   366         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   367         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   368         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   369         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   370         88  THREE-CHARACTER-BIN
   371                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   372         88  GREGORIAN-TO-BIN
   373                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   374         88  BIN-TO-GREGORIAN
   375                  VALUES ' ' '1' 'I' '8' 'G'.
   376         88  JULIAN-TO-BINARY
   377                  VALUES '5' 'C' 'E' 'F'.
   378     12  DC-ERROR-CODE                 PIC X.
   379         88  NO-CONVERSION-ERROR        VALUE ' '.
   380         88  DATE-CONVERSION-ERROR
   381                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   382         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  11
* EL630.cbl
   383         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   384         88  DATE-IS-INVALID            VALUE '3'.
   385         88  DATE1-GREATER-DATE2        VALUE '4'.
   386         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   387         88  DATE-INVALID-OPTION        VALUE '9'.
   388         88  INVALID-CENTURY            VALUE 'A'.
   389         88  ONLY-CENTURY               VALUE 'B'.
   390         88  ONLY-LEAP-YEAR             VALUE 'C'.
   391         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   392     12  DC-END-OF-MONTH               PIC X.
   393         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   394     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   395         88  USE-NORMAL-PROCESS         VALUE ' '.
   396         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   397         88  ADJUST-UP-100-YRS          VALUE '2'.
   398     12  FILLER                        PIC X.
   399     12  DC-CONVERSION-DATES.
   400         16  DC-BIN-DATE-1             PIC XX.
   401         16  DC-BIN-DATE-2             PIC XX.
   402         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   403         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   404                       DC-GREG-DATE-1-EDIT.
   405             20  DC-EDIT1-MONTH        PIC 99.
   406             20  SLASH1-1              PIC X.
   407             20  DC-EDIT1-DAY          PIC 99.
   408             20  SLASH1-2              PIC X.
   409             20  DC-EDIT1-YEAR         PIC 99.
   410         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   411         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   412                     DC-GREG-DATE-2-EDIT.
   413             20  DC-EDIT2-MONTH        PIC 99.
   414             20  SLASH2-1              PIC X.
   415             20  DC-EDIT2-DAY          PIC 99.
   416             20  SLASH2-2              PIC X.
   417             20  DC-EDIT2-YEAR         PIC 99.
   418         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   419         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   420                     DC-GREG-DATE-1-YMD.
   421             20  DC-YMD-YEAR           PIC 99.
   422             20  DC-YMD-MONTH          PIC 99.
   423             20  DC-YMD-DAY            PIC 99.
   424         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   425         16  DC-GREG-DATE-1-MDY-R REDEFINES
   426                      DC-GREG-DATE-1-MDY.
   427             20  DC-MDY-MONTH          PIC 99.
   428             20  DC-MDY-DAY            PIC 99.
   429             20  DC-MDY-YEAR           PIC 99.
   430         16  DC-GREG-DATE-1-ALPHA.
   431             20  DC-ALPHA-MONTH        PIC X(10).
   432             20  DC-ALPHA-DAY          PIC 99.
   433             20  FILLER                PIC XX.
   434             20  DC-ALPHA-CENTURY.
   435                 24 DC-ALPHA-CEN-N     PIC 99.
   436             20  DC-ALPHA-YEAR         PIC 99.
   437         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   438         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   439         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   440         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  12
* EL630.cbl
   441         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   442                                       PIC 9(05).
   443         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   444             20  DC-JULIAN-YEAR        PIC 99.
   445             20  DC-JULIAN-DAYS        PIC 999.
   446         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   447         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   448         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   449     12  DATE-CONVERSION-VARIBLES.
   450         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   451         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   452             20  FILLER                PIC 9(3).
   453             20  HOLD-CEN-1-CCYY.
   454                 24  HOLD-CEN-1-CC     PIC 99.
   455                 24  HOLD-CEN-1-YY     PIC 99.
   456             20  HOLD-CEN-1-MO         PIC 99.
   457             20  HOLD-CEN-1-DA         PIC 99.
   458         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   459             20  HOLD-CEN-1-R-MO       PIC 99.
   460             20  HOLD-CEN-1-R-DA       PIC 99.
   461             20  HOLD-CEN-1-R-CCYY.
   462                 24  HOLD-CEN-1-R-CC   PIC 99.
   463                 24  HOLD-CEN-1-R-YY   PIC 99.
   464             20  FILLER                PIC 9(3).
   465         16  HOLD-CENTURY-1-X.
   466             20  FILLER                PIC X(3)  VALUE SPACES.
   467             20  HOLD-CEN-1-X-CCYY.
   468                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   469                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   470             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   471             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   472         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   473             20  HOLD-CEN-1-R-X-MO     PIC XX.
   474             20  HOLD-CEN-1-R-X-DA     PIC XX.
   475             20  HOLD-CEN-1-R-X-CCYY.
   476                 24  HOLD-CEN-1-R-X-CC PIC XX.
   477                 24  HOLD-CEN-1-R-X-YY PIC XX.
   478             20  FILLER                PIC XXX.
   479         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   480         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   481         16  DC-JULIAN-DATE-1          PIC 9(07).
   482         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   483             20  DC-JULIAN-1-CCYY.
   484                 24  DC-JULIAN-1-CC    PIC 99.
   485                 24  DC-JULIAN-1-YR    PIC 99.
   486             20  DC-JULIAN-DA-1        PIC 999.
   487         16  DC-JULIAN-DATE-2          PIC 9(07).
   488         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   489             20  DC-JULIAN-2-CCYY.
   490                 24  DC-JULIAN-2-CC    PIC 99.
   491                 24  DC-JULIAN-2-YR    PIC 99.
   492             20  DC-JULIAN-DA-2        PIC 999.
   493         16  DC-GREG-DATE-A-EDIT.
   494             20  DC-EDITA-MONTH        PIC 99.
   495             20  SLASHA-1              PIC X VALUE '/'.
   496             20  DC-EDITA-DAY          PIC 99.
   497             20  SLASHA-2              PIC X VALUE '/'.
   498             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  13
* EL630.cbl
   499                 24  DC-EDITA-CENT     PIC 99.
   500                 24  DC-EDITA-YEAR     PIC 99.
   501         16  DC-GREG-DATE-B-EDIT.
   502             20  DC-EDITB-MONTH        PIC 99.
   503             20  SLASHB-1              PIC X VALUE '/'.
   504             20  DC-EDITB-DAY          PIC 99.
   505             20  SLASHB-2              PIC X VALUE '/'.
   506             20  DC-EDITB-CCYY.
   507                 24  DC-EDITB-CENT     PIC 99.
   508                 24  DC-EDITB-YEAR     PIC 99.
   509         16  DC-GREG-DATE-CYMD         PIC 9(08).
   510         16  DC-GREG-DATE-CYMD-R REDEFINES
   511                              DC-GREG-DATE-CYMD.
   512             20  DC-CYMD-CEN           PIC 99.
   513             20  DC-CYMD-YEAR          PIC 99.
   514             20  DC-CYMD-MONTH         PIC 99.
   515             20  DC-CYMD-DAY           PIC 99.
   516         16  DC-GREG-DATE-MDCY         PIC 9(08).
   517         16  DC-GREG-DATE-MDCY-R REDEFINES
   518                              DC-GREG-DATE-MDCY.
   519             20  DC-MDCY-MONTH         PIC 99.
   520             20  DC-MDCY-DAY           PIC 99.
   521             20  DC-MDCY-CEN           PIC 99.
   522             20  DC-MDCY-YEAR          PIC 99.
   523    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   524        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   525    12  DC-EL310-DATE                  PIC X(21).
   526    12  FILLER                         PIC X(28).
   527
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  14
* EL630.cbl
   529*    COPY ELCLOGOF.
   530******************************************************************
   531*                                                                *
   532*                                                                *
   533*                            ELCLOGOF.                           *
   534*                            VMOD=2.001                          *
   535*                                                                *
   536*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   537*                                                                *
   538******************************************************************
   539 01  CLASIC-LOGOFF.
   540     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   541     12  LOGOFF-TEXT.
   542         16  FILLER          PIC X(5)    VALUE SPACES.
   543         16  LOGOFF-MSG.
   544             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   545             20  FILLER      PIC X       VALUE SPACES.
   546             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   547         16  FILLER          PIC X(80)
   548           VALUE '* YOU ARE NOW LOGGED OFF'.
   549         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   550         16  FILLER          PIC X       VALUE QUOTE.
   551         16  LOGOFF-SYS-MSG  PIC X(17)
   552           VALUE 'S CLAS-IC SYSTEM '.
   553     12  TEXT-MESSAGES.
   554         16  UNACCESS-MSG    PIC X(29)
   555             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   556         16  PGMIDERR-MSG    PIC X(17)
   557             VALUE 'PROGRAM NOT FOUND'.
   558
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  15
* EL630.cbl
   560*    COPY ELCATTR.
   561******************************************************************
   562*                                                                *
   563*                            ELCATTR.                            *
   564*                            VMOD=2.001                          *
   565*                                                                *
   566*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   567*                                                                *
   568*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   569*                                                                *
   570*                   POS 1   P=PROTECTED                          *
   571*                           U=UNPROTECTED                        *
   572*                           S=ASKIP                              *
   573*                   POS 2   A=ALPHA/NUMERIC                      *
   574*                           N=NUMERIC                            *
   575*                   POS 3   N=NORMAL                             *
   576*                           B=BRIGHT                             *
   577*                           D=DARK                               *
   578*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   579*                           OF=MODIFIED DATA TAG OFF             *
   580*                                                                *
   581*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   582******************************************************************
   583 01  ATTRIBUTE-LIST.
   584     12  AL-PABOF            PIC X       VALUE 'Y'.
   585     12  AL-PABON            PIC X       VALUE 'Z'.
   586     12  AL-PADOF            PIC X       VALUE '%'.
   587     12  AL-PADON            PIC X       VALUE '_'.
   588     12  AL-PANOF            PIC X       VALUE '-'.
   589     12  AL-PANON            PIC X       VALUE '/'.
   590     12  AL-SABOF            PIC X       VALUE '8'.
   591     12  AL-SABON            PIC X       VALUE '9'.
   592     12  AL-SADOF            PIC X       VALUE '@'.
   593     12  AL-SADON            PIC X       VALUE QUOTE.
   594     12  AL-SANOF            PIC X       VALUE '0'.
   595     12  AL-SANON            PIC X       VALUE '1'.
   596     12  AL-UABOF            PIC X       VALUE 'H'.
   597     12  AL-UABON            PIC X       VALUE 'I'.
   598     12  AL-UADOF            PIC X       VALUE '<'.
   599     12  AL-UADON            PIC X       VALUE '('.
   600     12  AL-UANOF            PIC X       VALUE ' '.
   601     12  AL-UANON            PIC X       VALUE 'A'.
   602     12  AL-UNBOF            PIC X       VALUE 'Q'.
   603     12  AL-UNBON            PIC X       VALUE 'R'.
   604     12  AL-UNDOF            PIC X       VALUE '*'.
   605     12  AL-UNDON            PIC X       VALUE ')'.
   606     12  AL-UNNOF            PIC X       VALUE '&'.
   607     12  AL-UNNON            PIC X       VALUE 'J'.
   608
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  16
* EL630.cbl
   610*    COPY ELCEMIB.
   611******************************************************************
   612*                                                                *
   613*                                                                *
   614*                            ELCEMIB.                            *
   615*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   616*                            VMOD=2.005                          *
   617*                                                                *
   618*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   619*                                                                *
   620******************************************************************
   621 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   622     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   623     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   624     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   625     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   626     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   627     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   628     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   629     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   630     12  EMI-SWITCH1             PIC X        VALUE '1'.
   631         88  EMI-NO-ERRORS                    VALUE '1'.
   632         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   633         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   634     12  EMI-SWITCH2             PIC X        VALUE '1'.
   635         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   636     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   637         88  EMI-AREA1-EMPTY                  VALUE '1'.
   638         88  EMI-AREA1-FULL                   VALUE '2'.
   639     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   640         88  EMI-AREA2-EMPTY                  VALUE '1'.
   641         88  EMI-AREA2-FULL                   VALUE '2'.
   642     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   643         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   644         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   645         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   646         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   647         88  EMI-BYPASS-FATALS                VALUE 'X'.
   648     12  EMI-ERROR-LINES.
   649         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   650         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   651         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   652         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   653             20  EMI-ERR-CODES OCCURS 10 TIMES.
   654                 24  EMI-ERR-NUM         PIC X(4).
   655                 24  EMI-FILLER          PIC X.
   656                 24  EMI-SEV             PIC X.
   657                 24  FILLER              PIC X.
   658             20  FILLER                  PIC X(02).
   659     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   660         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   661             20  EMI-ERROR-NUMBER    PIC X(4).
   662             20  EMI-FILL            PIC X.
   663             20  EMI-SEVERITY        PIC X.
   664             20  FILLER              PIC X.
   665             20  EMI-ERROR-TEXT.
   666                 24  EMI-TEXT-VARIABLE   PIC X(10).
   667                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  17
* EL630.cbl
   668     12  EMI-SEVERITY-SAVE           PIC X.
   669         88  EMI-NOTE                    VALUE 'N'.
   670         88  EMI-WARNING                 VALUE 'W'.
   671         88  EMI-FORCABLE                VALUE 'F'.
   672         88  EMI-FATAL                   VALUE 'X'.
   673     12  EMI-MESSAGE-FLAG            PIC X.
   674         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   675         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   676     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   677     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   678         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   679         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   680         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   681     12  emi-claim-no                pic x(7).
   682     12  emi-claim-type              pic x(6).
   683     12  FILLER                      PIC X(124)  VALUE SPACES.
   684     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   685     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   686     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   687     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   688
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  18
* EL630.cbl
   690*    COPY ELCINTF.
   691******************************************************************
   692*                                                                *
   693*                                                                *
   694*                            ELCINTF.                            *
   695*                            VMOD=2.017                          *
   696*                                                                *
   697*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   698*                                                                *
   699*       LENGTH = 1024                                            *
   700*                                                                *
   701******************************************************************
   702*                   C H A N G E   L O G
   703*
   704* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   705*-----------------------------------------------------------------
   706*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   707* EFFECTIVE    NUMBER
   708*-----------------------------------------------------------------
   709* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   710******************************************************************
   711 01  PROGRAM-INTERFACE-BLOCK.
   712     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   713     12  PI-CALLING-PROGRAM              PIC X(8).
   714     12  PI-SAVED-PROGRAM-1              PIC X(8).
   715     12  PI-SAVED-PROGRAM-2              PIC X(8).
   716     12  PI-SAVED-PROGRAM-3              PIC X(8).
   717     12  PI-SAVED-PROGRAM-4              PIC X(8).
   718     12  PI-SAVED-PROGRAM-5              PIC X(8).
   719     12  PI-SAVED-PROGRAM-6              PIC X(8).
   720     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   721     12  PI-COMPANY-ID                   PIC XXX.
   722     12  PI-COMPANY-CD                   PIC X.
   723
   724     12  PI-COMPANY-PASSWORD             PIC X(8).
   725
   726     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   727
   728     12  PI-CONTROL-IN-PROGRESS.
   729         16  PI-CARRIER                  PIC X.
   730         16  PI-GROUPING                 PIC X(6).
   731         16  PI-STATE                    PIC XX.
   732         16  PI-ACCOUNT                  PIC X(10).
   733         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   734                                         PIC X(10).
   735         16  PI-CLAIM-CERT-GRP.
   736             20  PI-CLAIM-NO             PIC X(7).
   737             20  PI-CERT-NO.
   738                 25  PI-CERT-PRIME       PIC X(10).
   739                 25  PI-CERT-SFX         PIC X.
   740             20  PI-CERT-EFF-DT          PIC XX.
   741         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   742             20  PI-PLAN-CODE            PIC X(2).
   743             20  PI-REVISION-NUMBER      PIC X(3).
   744             20  PI-PLAN-EFF-DT          PIC X(2).
   745             20  PI-PLAN-EXP-DT          PIC X(2).
   746             20  FILLER                  PIC X(11).
   747         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  19
* EL630.cbl
   748             20  PI-OE-REFERENCE-1.
   749                 25  PI-OE-REF-1-PRIME   PIC X(18).
   750                 25  PI-OE-REF-1-SUFF    PIC XX.
   751
   752     12  PI-SESSION-IN-PROGRESS          PIC X.
   753         88  CLAIM-SESSION                   VALUE '1'.
   754         88  CREDIT-SESSION                  VALUE '2'.
   755         88  WARRANTY-SESSION                VALUE '3'.
   756         88  MORTGAGE-SESSION                VALUE '4'.
   757         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   758
   759
   760*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   761
   762     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   763     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   764
   765     12  PI-CREDIT-USER                  PIC X.
   766         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   767         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   768
   769     12  PI-CLAIM-USER                   PIC X.
   770         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   771         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   772
   773     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   774         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   775         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   776         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   777         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   778         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   779
   780     12  PI-PROCESSOR-ID                 PIC X(4).
   781
   782     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   783
   784     12  PI-MEMBER-CAPTION               PIC X(10).
   785
   786     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   787         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   788
   789     12  PI-LIFE-OVERRIDE-L1             PIC X.
   790     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   791     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   792     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   793
   794     12  PI-AH-OVERRIDE-L1               PIC X.
   795     12  PI-AH-OVERRIDE-L2               PIC XX.
   796     12  PI-AH-OVERRIDE-L6               PIC X(6).
   797     12  PI-AH-OVERRIDE-L12              PIC X(12).
   798
   799     12  PI-NEW-SYSTEM                   PIC X(2).
   800
   801     12  PI-PRIMARY-CERT-NO              PIC X(11).
   802     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   803         88  PI-USES-PAID-TO                 VALUE '1'.
   804     12  PI-CRDTCRD-SYSTEM.
   805         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  20
* EL630.cbl
   806             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   807             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   808         16  PI-CC-MONTH-END-DT          PIC XX.
   809     12  PI-PROCESSOR-PRINTER            PIC X(4).
   810
   811     12  PI-OE-REFERENCE-2.
   812         16  PI-OE-REF-2-PRIME           PIC X(10).
   813         16  PI-OE-REF-2-SUFF            PIC X.
   814
   815     12  PI-REM-TRM-CALC-OPTION          PIC X.
   816
   817     12  PI-LANGUAGE-TYPE                PIC X.
   818             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   819             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   820             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   821
   822     12  PI-POLICY-LINKAGE-IND           PIC X.
   823         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   824         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   825                                                   LOW-VALUES.
   826
   827     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   828     12  PI-CLAIM-PW-SESSION             PIC X(1).
   829         88  PI-CLAIM-CREDIT                 VALUE '1'.
   830         88  PI-CLAIM-CONVEN                 VALUE '2'.
   831
   832     12  PI-PROCESSOR-CSR-IND            PIC X.
   833         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   834         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   835
   836     12  FILLER                          PIC X(3).
   837
   838     12  PI-SYSTEM-LEVEL                 PIC X(145).
   839
   840     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   841         PI-SYSTEM-LEVEL.
   842
   843         16  PI-ENTRY-CODES.
   844             20  PI-ENTRY-CD-1           PIC X.
   845             20  PI-ENTRY-CD-2           PIC X.
   846
   847         16  PI-RETURN-CODES.
   848             20  PI-RETURN-CD-1          PIC X.
   849             20  PI-RETURN-CD-2          PIC X.
   850
   851         16  PI-UPDATE-STATUS-SAVE.
   852             20  PI-UPDATE-BY            PIC X(4).
   853             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   854
   855         16  PI-LOWER-CASE-LETTERS       PIC X.
   856             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   857
   858*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   859*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   860*            88  CARRIER-CLM-CNTL            VALUE '2'.
   861
   862         16  PI-CERT-ACCESS-CONTROL      PIC X.
   863             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  21
* EL630.cbl
   864             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   865             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   866             88  ACCNT-CNTL                  VALUE '3'.
   867             88  CARR-ACCNT-CNTL             VALUE '4'.
   868
   869         16  PI-PROCESSOR-CAP-LIST.
   870             20  PI-SYSTEM-CONTROLS.
   871                24 PI-SYSTEM-DISPLAY     PIC X.
   872                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   873                24 PI-SYSTEM-MODIFY      PIC X.
   874                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   875             20  FILLER                  PIC XX.
   876             20  PI-DISPLAY-CAP          PIC X.
   877                 88  DISPLAY-CAP             VALUE 'Y'.
   878             20  PI-MODIFY-CAP           PIC X.
   879                 88  MODIFY-CAP              VALUE 'Y'.
   880             20  PI-MSG-AT-LOGON-CAP     PIC X.
   881                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   882             20  PI-FORCE-CAP            PIC X.
   883                 88  FORCE-CAP               VALUE 'Y'.
   884
   885         16  PI-PROGRAM-CONTROLS.
   886             20  PI-PGM-PRINT-OPT        PIC X.
   887             20  PI-PGM-FORMAT-OPT       PIC X.
   888             20  PI-PGM-PROCESS-OPT      PIC X.
   889             20  PI-PGM-TOTALS-OPT       PIC X.
   890
   891         16  PI-HELP-INTERFACE.
   892             20  PI-LAST-ERROR-NO        PIC X(4).
   893             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   894
   895         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   896             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   897
   898         16  PI-CR-CONTROL-IN-PROGRESS.
   899             20  PI-CR-CARRIER           PIC X.
   900             20  PI-CR-GROUPING          PIC X(6).
   901             20  PI-CR-STATE             PIC XX.
   902             20  PI-CR-ACCOUNT           PIC X(10).
   903             20  PI-CR-FIN-RESP          PIC X(10).
   904             20  PI-CR-TYPE              PIC X.
   905
   906         16  PI-CR-BATCH-NUMBER          PIC X(6).
   907
   908         16  PI-CR-MONTH-END-DT          PIC XX.
   909
   910         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   911             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   912             88  PI-ZERO-CARRIER             VALUE '1'.
   913             88  PI-ZERO-GROUPING            VALUE '2'.
   914             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   915
   916         16  PI-CARRIER-SECURITY         PIC X.
   917             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   918
   919         16  PI-ACCOUNT-SECURITY         PIC X(10).
   920             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   921             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  22
* EL630.cbl
   922
   923         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   924             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   925                                         INDEXED BY PI-ACCESS-NDX
   926                                         PIC X.
   927
   928         16  PI-GA-BILLING-CONTROL       PIC X.
   929             88  PI-GA-BILLING               VALUE '1'.
   930
   931         16  PI-MAIL-PROCESSING          PIC X.
   932             88  PI-MAIL-YES                 VALUE 'Y'.
   933
   934         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   935
   936         16  PI-AR-SYSTEM.
   937             20  PI-AR-PROCESSING-CNTL   PIC X.
   938                 88  PI-AR-PROCESSING        VALUE 'Y'.
   939             20  PI-AR-SUMMARY-CODE      PIC X(6).
   940             20  PI-AR-MONTH-END-DT      PIC XX.
   941
   942         16  PI-MP-SYSTEM.
   943             20  PI-MORTGAGE-USER            PIC X.
   944                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   945                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   946             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   947                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   948                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   949                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   950                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   951                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   952             20  PI-MP-MONTH-END-DT          PIC XX.
   953             20  PI-MP-REFERENCE-NO.
   954                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   955                 24  PI-MP-REFERENCE-SFX     PIC XX.
   956
   957         16  PI-LABEL-CONTROL            PIC X(01).
   958             88  PI-CREATE-LABELS                    VALUE 'Y'.
   959             88  PI-BYPASS-LABELS                    VALUE 'N'.
   960
   961         16  PI-BILL-GROUPING-CODE       PIC X(01).
   962             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   963
   964         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   965             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   966             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   967
   968         16  FILLER                      PIC X(14).
   969
   970     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   971******************************************************************
   972*    COPY ELC630PI.
   973******************************************************************
   974*                                                                *
   975*                            ELC630PI                            *
   976*                            VMOD=2.014                          *
   977*                                                                *
   978* - PI-PROGRAM-WORK-AREA FOR THE DATA-ENTRY SUB-SYSTEM -         *
   979*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  23
* EL630.cbl
   980*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
   981*                                                                *
   982*               EL630 - EL6301 - EL6302                          *
   983******************************************************************
   984*                   C H A N G E   L O G
   985*
   986* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   987*-----------------------------------------------------------------
   988*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   989* EFFECTIVE    NUMBER
   990*-----------------------------------------------------------------
   991* 072308  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
   992* 030310  CR2009031200002  PEMA  OPEN LOAN OFFICER FIELD
   993* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   994******************************************************************
   995
   996     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   997         16  PI-AM-NAME                  PIC X(30).
   998         16  PI-MAP-NAME                 PIC X(8).
   999         16  PI-BATCH-AMOUNTS    COMP-3.
  1000             20  PI-LF-ISS-REMITTED      PIC S9(8)V99.
  1001             20  PI-LF-ISS-ENTERED       PIC S9(8)V99.
  1002             20  PI-LF-CAN-REMITTED      PIC S9(8)V99.
  1003             20  PI-LF-CAN-ENTERED       PIC S9(8)V99.
  1004             20  PI-AH-ISS-REMITTED      PIC S9(8)V99.
  1005             20  PI-AH-ISS-ENTERED       PIC S9(8)V99.
  1006             20  PI-AH-CAN-REMITTED      PIC S9(8)V99.
  1007             20  PI-AH-CAN-ENTERED       PIC S9(8)V99.
  1008             20  PI-ISS-CNT-REMITTED     PIC S9(5).
  1009             20  PI-ISS-CNT-ENTERED      PIC S9(5).
  1010             20  PI-CAN-CNT-REMITTED     PIC S9(5).
  1011             20  PI-CAN-CNT-ENTERED      PIC S9(5).
  1012         16  PI-MAINT-FUNC               PIC X.
  1013         16  PI-ERROR-SW                 PIC X.
  1014             88  PI-DATA-ERRORS              VALUE 'Y'.
  1015         16  PI-UPDATE-SW                PIC X.
  1016             88  PI-DATA-UPDATED             VALUE 'Y'.
  1017         16  PI-DISPLAY-SW               PIC X.
  1018             88  PI-LAST-FUNC-DISPLAY        VALUE 'Y'.
  1019         16  PI-SAVE-CALLING-PGM         PIC X(8).
  1020         16  PI-LAST-SEQ-NO-ADDED        PIC S9(4) COMP.
  1021         16  PI-NEXT-DISPLAY-SEQ-NO      PIC S9(4) COMP.
  1022         16  PI-SAV-CARRIER              PIC X.
  1023         16  PI-SAV-GROUPING             PIC X(6).
  1024         16  PI-SAV-STATE                PIC XX.
  1025         16  PI-SAV-ACCOUNT              PIC X(10).
  1026         16  PI-SAV-CERT-EFF-DT          PIC XX.
  1027         16  PI-SAV-CERT-NO.
  1028             20  PI-SAV-CERT-PRIME       PIC X(14).
  1029             20  PI-SAV-CERT-SFX         PIC X.
  1030         16  PI-PYAJ-REFERENCE REDEFINES PI-SAV-CERT-NO.
  1031             20  PI-SAV-PYAJ-REFERENCE   PIC X(12).
  1032             20  FILLER                  PIC X(3).
  1033         16  PI-SAV-ENDING-ERPNDB-KEY.
  1034             20  PI-SAV-COMP-CD          PIC X.
  1035             20  PI-SAV-ENTRY-BATCH      PIC X(6).
  1036             20  PI-SAV-BATCH-SEQ        PIC S9(4) COMP.
  1037             20  PI-SAV-BATCH-CHG-SEQ    PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  24
* EL630.cbl
  1038         16  PI-SAV-REFERENCE            PIC X(12).
  1039         16  PI-SAV-FULL-CONTROL.
  1040             20  PI-SAV-FC-CARRIER       PIC X.
  1041             20  PI-SAV-FC-GROUPING      PIC X(6).
  1042             20  PI-SAV-FC-STATE         PIC XX.
  1043         16  PI-VERIFY-DELETE-SW         PIC X.
  1044             88  PI-DELETE-IS-OK             VALUE 'Y'.
  1045         16  PI-EL630-FIRST-TIME-SW      PIC X.
  1046             88  PI-EL630-FIRST-TIME         VALUE SPACE.
  1047         16  PI-CREDIT-EDIT-CONTROLS.
  1048             20  PI-MIN-PREMIUM          PIC S9(3)V99  COMP-3.
  1049             20  PI-MIN-AGE              PIC 99.
  1050             20  PI-DEFAULT-AGE          PIC 99.
  1051             20  PI-MIN-TERM             PIC S9(3)     COMP-3.
  1052             20  PI-MAX-TERM             PIC S9(3)     COMP-3.
  1053             20  PI-DEFAULT-SEX          PIC X.
  1054             20  PI-JOINT-AGE-INPUT      PIC X.
  1055                 88 PI-JOINT-AGE-IS-INPUT       VALUE '1'.
  1056             20  PI-BIRTH-DATE-INPUT     PIC X.
  1057                 88 PI-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1058         16  PI-KEYED-SWITCHES.
  1059             20  PI-ISS-SUFFIX-KEYED-SW  PIC X.
  1060                 88  PI-ISS-SUFFIX-KEYED     VALUE 'Y'.
  1061             20  PI-CAN-SUFFIX-KEYED-SW  PIC X.
  1062                 88  PI-CAN-SUFFIX-KEYED     VALUE 'Y'.
  1063             20  PI-IG-KEYED-SW          PIC X.
  1064                 88  PI-IG-KEYED             VALUE 'Y'.
  1065             20  PI-APR-KEYED-SW         PIC X.
  1066                 88  PI-APR-KEYED            VALUE 'Y'.
  1067*            20  PI-FREQ-KEYED-SW        PIC X.
  1068*                88  PI-FREQ-KEYED           VALUE 'Y'.
  1069             20  PI-VIN-KEYED-SW         PIC X.
  1070                 88  PI-VIN-KEYED            VALUE 'Y'.
  1071             20  PI-SIG-KEYED-SW         PIC X.
  1072                 88  PI-SIG-KEYED            VALUE 'Y'.
  1073             20  PI-LFRT-KEYED-SW        PIC X.
  1074                 88  PI-LFRT-KEYED           VALUE 'Y'.
  1075             20  PI-AHRT-KEYED-SW        PIC X.
  1076                 88  PI-AHRT-KEYED           VALUE 'Y'.
  1077             20  PI-SSNUM-KEYED-SW       PIC X.
  1078                 88  PI-SSNUM-KEYED          VALUE 'Y'.
  1079             20  PI-JNT-SSNUM-KEYED-SW   PIC X.
  1080                 88  PI-JNT-SSNUM-KEYED      VALUE 'Y'.
  1081             20  PI-MEMBER-KEYED-SW      PIC X.
  1082                 88  PI-MEMBER-KEYED         VALUE 'Y'.
  1083             20  PI-MODE-KEYED-SW        PIC X.
  1084                 88  PI-MODE-KEYED           VALUE 'Y'.
  1085             20  PI-PMTS-KEYED-SW        PIC X.
  1086                 88  PI-PMTS-KEYED           VALUE 'Y'.
  1087             20  PI-LN-OFFICER-KEYED-SW  PIC X.
  1088                 88  PI-LN-OFFICER-KEYED     VALUE 'Y'.
  1089             20  PI-ENTRY-KEYED-SW       PIC X.
  1090                 88  PI-ENTRY-KEYED          VALUE 'Y'.
  1091             20  PI-FORCE-KEYED-SW       PIC X.
  1092                 88  PI-FORCE-KEYED          VALUE 'Y'.
  1093             20  PI-RINCD-KEYED-SW       PIC X.
  1094                 88  PI-RINCD-KEYED          VALUE 'Y'.
  1095             20  PI-BILLCD-KEYED-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  25
* EL630.cbl
  1096                 88  PI-BILLCD-KEYED         VALUE 'Y'.
  1097             20  PI-RTCLS-KEYED-SW       PIC X.
  1098                 88  PI-RTCLS-KEYED          VALUE 'Y'.
  1099             20  PI-LNTRM-KEYED-SW       PIC X.
  1100                 88  PI-LNTRM-KEYED          VALUE 'Y'.
  1101             20  PI-EXPIR-KEYED-SW       PIC X.
  1102                 88  PI-EXPIR-KEYED          VALUE 'Y'.
  1103             20  PI-PMT-KEYED-SW         PIC X.
  1104                 88  PI-PMT-KEYED            VALUE 'Y'.
  1105             20  PI-1ST-PMT-KEYED-SW     PIC X.
  1106                 88  PI-1ST-PMT-KEYED        VALUE 'Y'.
  1107             20  PI-DAYS-KEYED-SW        PIC X.
  1108                 88  PI-DAYS-KEYED           VALUE 'Y'.
  1109             20  PI-SKPCD-KEYED-SW       PIC X.
  1110                 88  PI-SKPCD-KEYED          VALUE 'Y'.
  1111             20  PI-JNT-AGE-KEYED-SW     PIC X.
  1112                 88  PI-JNT-AGE-KEYED        VALUE 'Y'.
  1113             20  PI-JNT-NAME-KEYED-SW    PIC X.
  1114                 88  PI-JNT-NAME-KEYED       VALUE 'Y'.
  1115             20  PI-ISS-LIVES-KEYED-SW   PIC X.
  1116                 88  PI-ISS-LIVES-KEYED      VALUE 'Y'.
  1117             20  PI-CAN-LIVES-KEYED-SW   PIC X.
  1118                 88  PI-CAN-LIVES-KEYED      VALUE 'Y'.
  1119             20  PI-PAYEE-KEYED-SW       PIC X.
  1120                 88  PI-PAYEE-KEYED          VALUE 'Y'.
  1121             20  PI-CHK-REQ-KEYED-SW     PIC X.
  1122                 88  PI-CHK-REQ-KEYED        VALUE 'Y'.
  1123             20  PI-ZIP4-KEYED-SW        PIC X.
  1124                 88  PI-ZIP4-KEYED           VALUE 'Y'.
  1125             20  PI-POLICY-KEYED-SW      PIC X.
  1126                 88  PI-POLICY-KEYED         VALUE 'Y'.
  1127             20  PI-EXPIRE-KEYED-SW      PIC X.
  1128                 88  PI-EXPIRE-KEYED         VALUE 'Y'.
  1129             20  PI-CRIT-PERD-KEYED-SW    PIC X.
  1130                 88  PI-CRIT-PERD-KEYED      VALUE 'Y'.
  1131             20  PI-BENEFICIARY-KEYED-SW PIC X.
  1132                 88  PI-BENEFICIARY-KEYED    VALUE 'Y'.
  1133             20  PI-PHONE-KEYED-SW       PIC X.
  1134                 88  PI-PHONE-KEYED          VALUE 'Y'.
  1135             20  PI-ALT-BEN-KEYED-SW     PIC X.
  1136                 88  PI-ALT-BEN-KEYED        VALUE 'Y'.
  1137             20  PI-ALT-PREM-KEYED-SW    PIC X.
  1138                 88  PI-ALT-PREM-KEYED       VALUE 'Y'.
  1139             20  PI-REFUND-MTHD-KEYED-SW PIC X.
  1140                 88  PI-REFUND-MTHD-KEYED    VALUE 'Y'.
  1141         16  PI-ACCT-LOW-EFF-DT          PIC XX.
  1142         16  PI-ACCT-HIGH-EXP-DT         PIC XX.
  1143         16  PI-BATCH-EOF-SW             PIC X.
  1144             88  PI-BATCH-EOF                VALUE 'Y'.
  1145         16  PI-NB-MONTH-END-DT          PIC XX.
  1146         16  PI-ISSUE-ADDED-SW           PIC X.
  1147             88  PI-ISSUE-ADDED              VALUE 'Y'.
  1148         16  PI-BROWSE-SW                PIC X.
  1149             88  PI-BROWSE                   VALUE 'Y'.
  1150         16  PI-ACCT-AGENT-ERROR-SW      PIC X.
  1151             88  PI-ACCT-AGENT-ERROR         VALUE 'Y'.
  1152         16  PI-FIN-RESP-ERROR-SW        PIC X.
  1153             88  PI-FIN-RESP-ERROR           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  26
* EL630.cbl
  1154         16  PI-CAN-REA-KEYED-SW         PIC X.
  1155             88  PI-CAN-REA-KEYED            VALUE 'Y'.
  1156         16  PI-AM-EDIT-LOAN-OFC         PIC X.
  1157         16  PI-AM-ADDR1                 PIC X(30).
  1158         16  PI-AM-ADDR2                 PIC X(30).
  1159         16  PI-AM-CITYST.
  1160             20  PI-AM-CITY              PIC X(28).
  1161             20  PI-AM-STATE             PIC XX.
  1162         16  PI-AM-ZIP                   PIC X(9).
  1163         16  FILLER                      PIC X(290).
  1164*        16  FILLER                      PIC X(390).
  1165     12  PI-MISC.
  1166         16  PI-ACCT-DATE-RANGES OCCURS 32 TIMES.
  1167             20  PI-ACCT-EFF-DT          PIC XX.
  1168             20  PI-ACCT-EXP-DT          PIC XX.
  1169             20  PI-REMIT-AGENT          PIC X(10).
  1170             20  PI-ACCT-AGENT           PIC X(10).
  1171         16  PI-ACCOUNT-AGENT            PIC X(10).
  1172         16  PI-FIN-RESP                 PIC X(10).
  1173         16  PI-SUMMARY-CODE             PIC X(6).
  1174         16  PI-SUB                      PIC S9(4) COMP.
  1175         16  PI-COMP-CARRIER             PIC X.
  1176         16  PI-COMP-GROUPING            PIC X(6).
  1177         16  PI-ACCT-AGENT-PROCESSED-SW  PIC X.
  1178             88  PI-ACCT-AGENT-PROCESSED     VALUE 'Y'.
  1179         16  PI-CLEAR-ERROR-SW           PIC X.
  1180             88  PI-CLEAR-ERROR              VALUE 'Y'.
  1181         16  PI-AGE-KEYED-SW             PIC X.
  1182             88  PI-AGE-KEYED                VALUE 'Y'.
  1183         16  PI-BIRTHDT-KEYED-SW         PIC X.
  1184             88  PI-BIRTHDT-KEYED            VALUE 'Y'.
  1185         16  PI-RECEIVED-DT              PIC XX.
  1186         16  PI-CSR-ID                   PIC X(4).
  1187
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  27
* EL630.cbl
  1189          16  FILLER              PIC X(390).
  1190
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  28
* EL630.cbl
  1192*    COPY ELCAID.
  1193******************************************************************
  1194*                                                                *
  1195*                            ELCAID.                             *
  1196*                            VMOD=2.001                          *
  1197*                                                                *
  1198*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1199*                                                                *
  1200*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1201*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1202******************************************************************
  1203
  1204 01  DFHAID.
  1205   02  DFHNULL   PIC  X  VALUE  ' '.
  1206   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1207   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1208   02  DFHPEN    PIC  X  VALUE  '='.
  1209   02  DFHOPID   PIC  X  VALUE  'W'.
  1210   02  DFHPA1    PIC  X  VALUE  '%'.
  1211   02  DFHPA2    PIC  X  VALUE  '>'.
  1212   02  DFHPA3    PIC  X  VALUE  ','.
  1213   02  DFHPF1    PIC  X  VALUE  '1'.
  1214   02  DFHPF2    PIC  X  VALUE  '2'.
  1215   02  DFHPF3    PIC  X  VALUE  '3'.
  1216   02  DFHPF4    PIC  X  VALUE  '4'.
  1217   02  DFHPF5    PIC  X  VALUE  '5'.
  1218   02  DFHPF6    PIC  X  VALUE  '6'.
  1219   02  DFHPF7    PIC  X  VALUE  '7'.
  1220   02  DFHPF8    PIC  X  VALUE  '8'.
  1221   02  DFHPF9    PIC  X  VALUE  '9'.
  1222   02  DFHPF10   PIC  X  VALUE  ':'.
  1223   02  DFHPF11   PIC  X  VALUE  '#'.
  1224   02  DFHPF12   PIC  X  VALUE  '@'.
  1225   02  DFHPF13   PIC  X  VALUE  'A'.
  1226   02  DFHPF14   PIC  X  VALUE  'B'.
  1227   02  DFHPF15   PIC  X  VALUE  'C'.
  1228   02  DFHPF16   PIC  X  VALUE  'D'.
  1229   02  DFHPF17   PIC  X  VALUE  'E'.
  1230   02  DFHPF18   PIC  X  VALUE  'F'.
  1231   02  DFHPF19   PIC  X  VALUE  'G'.
  1232   02  DFHPF20   PIC  X  VALUE  'H'.
  1233   02  DFHPF21   PIC  X  VALUE  'I'.
  1234*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1235   02  DFHPF22   PIC  X  VALUE  '['.
  1236   02  DFHPF23   PIC  X  VALUE  '.'.
  1237   02  DFHPF24   PIC  X  VALUE  '<'.
  1238   02  DFHMSRE   PIC  X  VALUE  'X'.
  1239   02  DFHSTRF   PIC  X  VALUE  'h'.
  1240   02  DFHTRIG   PIC  X  VALUE  '"'.
  1241 01  FILLER    REDEFINES DFHAID.
  1242     12  FILLER              PIC X(8).
  1243     12  PF-VALUES           PIC X       OCCURS 2.
  1244     12  FILLER              PIC X(25).
  1245
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  29
* EL630.cbl
  1247*    COPY EL630S.
  1248 01  EL630AI.
  1249     05  FILLER            PIC  X(0012).
  1250*    -------------------------------
  1251     05  DATEL PIC S9(0004) COMP.
  1252     05  DATEF PIC  X(0001).
  1253     05  FILLER REDEFINES DATEF.
  1254         10  DATEA PIC  X(0001).
  1255     05  DATEI PIC  X(0008).
  1256*    -------------------------------
  1257     05  TIMEL PIC S9(0004) COMP.
  1258     05  TIMEF PIC  X(0001).
  1259     05  FILLER REDEFINES TIMEF.
  1260         10  TIMEA PIC  X(0001).
  1261     05  TIMEI PIC  X(0005).
  1262*    -------------------------------
  1263     05  MAINTL PIC S9(0004) COMP.
  1264     05  MAINTF PIC  X(0001).
  1265     05  FILLER REDEFINES MAINTF.
  1266         10  MAINTA PIC  X(0001).
  1267     05  MAINTI PIC  X(0001).
  1268*    -------------------------------
  1269     05  REFHDGL PIC S9(0004) COMP.
  1270     05  REFHDGF PIC  X(0001).
  1271     05  FILLER REDEFINES REFHDGF.
  1272         10  REFHDGA PIC  X(0001).
  1273     05  REFHDGI PIC  X(0015).
  1274*    -------------------------------
  1275     05  CARRHDGL PIC S9(0004) COMP.
  1276     05  CARRHDGF PIC  X(0001).
  1277     05  FILLER REDEFINES CARRHDGF.
  1278         10  CARRHDGA PIC  X(0001).
  1279     05  CARRHDGI PIC  X(0007).
  1280*    -------------------------------
  1281     05  GRPHDGL PIC S9(0004) COMP.
  1282     05  GRPHDGF PIC  X(0001).
  1283     05  FILLER REDEFINES GRPHDGF.
  1284         10  GRPHDGA PIC  X(0001).
  1285     05  GRPHDGI PIC  X(0008).
  1286*    -------------------------------
  1287     05  STHDGL PIC S9(0004) COMP.
  1288     05  STHDGF PIC  X(0001).
  1289     05  FILLER REDEFINES STHDGF.
  1290         10  STHDGA PIC  X(0001).
  1291     05  STHDGI PIC  X(0005).
  1292*    -------------------------------
  1293     05  BATCHL PIC S9(0004) COMP.
  1294     05  BATCHF PIC  X(0001).
  1295     05  FILLER REDEFINES BATCHF.
  1296         10  BATCHA PIC  X(0001).
  1297     05  BATCHI PIC  X(0006).
  1298*    -------------------------------
  1299     05  REFL PIC S9(0004) COMP.
  1300     05  REFF PIC  X(0001).
  1301     05  FILLER REDEFINES REFF.
  1302         10  REFA PIC  X(0001).
  1303     05  REFI PIC  X(0012).
  1304*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  30
* EL630.cbl
  1305     05  CARRIERL PIC S9(0004) COMP.
  1306     05  CARRIERF PIC  X(0001).
  1307     05  FILLER REDEFINES CARRIERF.
  1308         10  CARRIERA PIC  X(0001).
  1309     05  CARRIERI PIC  X(0001).
  1310*    -------------------------------
  1311     05  GROUPL PIC S9(0004) COMP.
  1312     05  GROUPF PIC  X(0001).
  1313     05  FILLER REDEFINES GROUPF.
  1314         10  GROUPA PIC  X(0001).
  1315     05  GROUPI PIC  X(0006).
  1316*    -------------------------------
  1317     05  STATEL PIC S9(0004) COMP.
  1318     05  STATEF PIC  X(0001).
  1319     05  FILLER REDEFINES STATEF.
  1320         10  STATEA PIC  X(0001).
  1321     05  STATEI PIC  X(0002).
  1322*    -------------------------------
  1323     05  ACCOUNTL PIC S9(0004) COMP.
  1324     05  ACCOUNTF PIC  X(0001).
  1325     05  FILLER REDEFINES ACCOUNTF.
  1326         10  ACCOUNTA PIC  X(0001).
  1327     05  ACCOUNTI PIC  X(0010).
  1328*    -------------------------------
  1329     05  LFPHDGL PIC S9(0004) COMP.
  1330     05  LFPHDGF PIC  X(0001).
  1331     05  FILLER REDEFINES LFPHDGF.
  1332         10  LFPHDGA PIC  X(0001).
  1333     05  LFPHDGI PIC  X(0010).
  1334*    -------------------------------
  1335     05  AHPHDGL PIC S9(0004) COMP.
  1336     05  AHPHDGF PIC  X(0001).
  1337     05  FILLER REDEFINES AHPHDGF.
  1338         10  AHPHDGA PIC  X(0001).
  1339     05  AHPHDGI PIC  X(0010).
  1340*    -------------------------------
  1341     05  LFRHDGL PIC S9(0004) COMP.
  1342     05  LFRHDGF PIC  X(0001).
  1343     05  FILLER REDEFINES LFRHDGF.
  1344         10  LFRHDGA PIC  X(0001).
  1345     05  LFRHDGI PIC  X(0009).
  1346*    -------------------------------
  1347     05  AHRHDGL PIC S9(0004) COMP.
  1348     05  AHRHDGF PIC  X(0001).
  1349     05  FILLER REDEFINES AHRHDGF.
  1350         10  AHRHDGA PIC  X(0001).
  1351     05  AHRHDGI PIC  X(0009).
  1352*    -------------------------------
  1353     05  EISSCNTL PIC S9(0004) COMP.
  1354     05  EISSCNTF PIC  X(0001).
  1355     05  FILLER REDEFINES EISSCNTF.
  1356         10  EISSCNTA PIC  X(0001).
  1357     05  EISSCNTI PIC  S9(6).
  1358*    -------------------------------
  1359     05  ELFISSL PIC S9(0004) COMP.
  1360     05  ELFISSF PIC  X(0001).
  1361     05  FILLER REDEFINES ELFISSF.
  1362         10  ELFISSA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  31
* EL630.cbl
  1363     05  ELFISSI PIC  S9(10)V9(2).
  1364*    -------------------------------
  1365     05  EAHISSL PIC S9(0004) COMP.
  1366     05  EAHISSF PIC  X(0001).
  1367     05  FILLER REDEFINES EAHISSF.
  1368         10  EAHISSA PIC  X(0001).
  1369     05  EAHISSI PIC  S9(10)V9(2).
  1370*    -------------------------------
  1371     05  ECANCNTL PIC S9(0004) COMP.
  1372     05  ECANCNTF PIC  X(0001).
  1373     05  FILLER REDEFINES ECANCNTF.
  1374         10  ECANCNTA PIC  X(0001).
  1375     05  ECANCNTI PIC  S9(6).
  1376*    -------------------------------
  1377     05  ELFCANL PIC S9(0004) COMP.
  1378     05  ELFCANF PIC  X(0001).
  1379     05  FILLER REDEFINES ELFCANF.
  1380         10  ELFCANA PIC  X(0001).
  1381     05  ELFCANI PIC  S9(8)V9(2).
  1382*    -------------------------------
  1383     05  EAHCANL PIC S9(0004) COMP.
  1384     05  EAHCANF PIC  X(0001).
  1385     05  FILLER REDEFINES EAHCANF.
  1386         10  EAHCANA PIC  X(0001).
  1387     05  EAHCANI PIC  S9(8)V9(2).
  1388*    -------------------------------
  1389     05  AISSCNTL PIC S9(0004) COMP.
  1390     05  AISSCNTF PIC  X(0001).
  1391     05  FILLER REDEFINES AISSCNTF.
  1392         10  AISSCNTA PIC  X(0001).
  1393     05  AISSCNTI PIC  S9(6).
  1394*    -------------------------------
  1395     05  ALFISSL PIC S9(0004) COMP.
  1396     05  ALFISSF PIC  X(0001).
  1397     05  FILLER REDEFINES ALFISSF.
  1398         10  ALFISSA PIC  X(0001).
  1399     05  ALFISSI PIC  S9(10)V9(2).
  1400*    -------------------------------
  1401     05  AAHISSL PIC S9(0004) COMP.
  1402     05  AAHISSF PIC  X(0001).
  1403     05  FILLER REDEFINES AAHISSF.
  1404         10  AAHISSA PIC  X(0001).
  1405     05  AAHISSI PIC  S9(10)V9(2).
  1406*    -------------------------------
  1407     05  ACANCNTL PIC S9(0004) COMP.
  1408     05  ACANCNTF PIC  X(0001).
  1409     05  FILLER REDEFINES ACANCNTF.
  1410         10  ACANCNTA PIC  X(0001).
  1411     05  ACANCNTI PIC  S9(6).
  1412*    -------------------------------
  1413     05  ALFCANL PIC S9(0004) COMP.
  1414     05  ALFCANF PIC  X(0001).
  1415     05  FILLER REDEFINES ALFCANF.
  1416         10  ALFCANA PIC  X(0001).
  1417     05  ALFCANI PIC  S9(8)V9(2).
  1418*    -------------------------------
  1419     05  AAHCANL PIC S9(0004) COMP.
  1420     05  AAHCANF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  32
* EL630.cbl
  1421     05  FILLER REDEFINES AAHCANF.
  1422         10  AAHCANA PIC  X(0001).
  1423     05  AAHCANI PIC  S9(8)V9(2).
  1424*    -------------------------------
  1425     05  OISSCNTL PIC S9(0004) COMP.
  1426     05  OISSCNTF PIC  X(0001).
  1427     05  FILLER REDEFINES OISSCNTF.
  1428         10  OISSCNTA PIC  X(0001).
  1429     05  OISSCNTI PIC  S9(6).
  1430*    -------------------------------
  1431     05  OLFISSL PIC S9(0004) COMP.
  1432     05  OLFISSF PIC  X(0001).
  1433     05  FILLER REDEFINES OLFISSF.
  1434         10  OLFISSA PIC  X(0001).
  1435     05  OLFISSI PIC  S9(10)V9(2).
  1436*    -------------------------------
  1437     05  OAHISSL PIC S9(0004) COMP.
  1438     05  OAHISSF PIC  X(0001).
  1439     05  FILLER REDEFINES OAHISSF.
  1440         10  OAHISSA PIC  X(0001).
  1441     05  OAHISSI PIC  S9(10)V9(2).
  1442*    -------------------------------
  1443     05  OCANCNTL PIC S9(0004) COMP.
  1444     05  OCANCNTF PIC  X(0001).
  1445     05  FILLER REDEFINES OCANCNTF.
  1446         10  OCANCNTA PIC  X(0001).
  1447     05  OCANCNTI PIC  S9(6).
  1448*    -------------------------------
  1449     05  OLFCANL PIC S9(0004) COMP.
  1450     05  OLFCANF PIC  X(0001).
  1451     05  FILLER REDEFINES OLFCANF.
  1452         10  OLFCANA PIC  X(0001).
  1453     05  OLFCANI PIC  S9(8)V9(2).
  1454*    -------------------------------
  1455     05  OAHCANL PIC S9(0004) COMP.
  1456     05  OAHCANF PIC  X(0001).
  1457     05  FILLER REDEFINES OAHCANF.
  1458         10  OAHCANA PIC  X(0001).
  1459     05  OAHCANI PIC  S9(8)V9(2).
  1460*    -------------------------------
  1461     05  RECEVDTL PIC S9(0004) COMP.
  1462     05  RECEVDTF PIC  X(0001).
  1463     05  FILLER REDEFINES RECEVDTF.
  1464         10  RECEVDTA PIC  X(0001).
  1465     05  RECEVDTI PIC  X(0008).
  1466*    -------------------------------
  1467     05  MNTHNDTL PIC S9(0004) COMP.
  1468     05  MNTHNDTF PIC  X(0001).
  1469     05  FILLER REDEFINES MNTHNDTF.
  1470         10  MNTHNDTA PIC  X(0001).
  1471     05  MNTHNDTI PIC  X(0008).
  1472*    -------------------------------
  1473     05  ERRMSG1L PIC S9(0004) COMP.
  1474     05  ERRMSG1F PIC  X(0001).
  1475     05  FILLER REDEFINES ERRMSG1F.
  1476         10  ERRMSG1A PIC  X(0001).
  1477     05  ERRMSG1I PIC  X(0076).
  1478*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  33
* EL630.cbl
  1479     05  ERRMSG2L PIC S9(0004) COMP.
  1480     05  ERRMSG2F PIC  X(0001).
  1481     05  FILLER REDEFINES ERRMSG2F.
  1482         10  ERRMSG2A PIC  X(0001).
  1483     05  ERRMSG2I PIC  X(0076).
  1484*    -------------------------------
  1485     05  PFENTERL PIC S9(0004) COMP.
  1486     05  PFENTERF PIC  X(0001).
  1487     05  FILLER REDEFINES PFENTERF.
  1488         10  PFENTERA PIC  X(0001).
  1489     05  PFENTERI PIC  9(2).
  1490*    -------------------------------
  1491     05  PF5L PIC S9(0004) COMP.
  1492     05  PF5F PIC  X(0001).
  1493     05  FILLER REDEFINES PF5F.
  1494         10  PF5A PIC  X(0001).
  1495     05  PF5I PIC  X(0015).
  1496 01  EL630AO REDEFINES EL630AI.
  1497     05  FILLER            PIC  X(0012).
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  DATEO PIC  X(0008).
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  TIMEO PIC  99.99.
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  MAINTO PIC  X(0001).
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
  1509     05  REFHDGO PIC  X(0015).
  1510*    -------------------------------
  1511     05  FILLER            PIC  X(0003).
  1512     05  CARRHDGO PIC  X(0007).
  1513*    -------------------------------
  1514     05  FILLER            PIC  X(0003).
  1515     05  GRPHDGO PIC  X(0008).
  1516*    -------------------------------
  1517     05  FILLER            PIC  X(0003).
  1518     05  STHDGO PIC  X(0005).
  1519*    -------------------------------
  1520     05  FILLER            PIC  X(0003).
  1521     05  BATCHO PIC  X(0006).
  1522*    -------------------------------
  1523     05  FILLER            PIC  X(0003).
  1524     05  REFO PIC  X(0012).
  1525*    -------------------------------
  1526     05  FILLER            PIC  X(0003).
  1527     05  CARRIERO PIC  X(0001).
  1528*    -------------------------------
  1529     05  FILLER            PIC  X(0003).
  1530     05  GROUPO PIC  X(0006).
  1531*    -------------------------------
  1532     05  FILLER            PIC  X(0003).
  1533     05  STATEO PIC  X(0002).
  1534*    -------------------------------
  1535     05  FILLER            PIC  X(0003).
  1536     05  ACCOUNTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  34
* EL630.cbl
  1537*    -------------------------------
  1538     05  FILLER            PIC  X(0003).
  1539     05  LFPHDGO PIC  X(0010).
  1540*    -------------------------------
  1541     05  FILLER            PIC  X(0003).
  1542     05  AHPHDGO PIC  X(0010).
  1543*    -------------------------------
  1544     05  FILLER            PIC  X(0003).
  1545     05  LFRHDGO PIC  X(0009).
  1546*    -------------------------------
  1547     05  FILLER            PIC  X(0003).
  1548     05  AHRHDGO PIC  X(0009).
  1549*    -------------------------------
  1550     05  FILLER            PIC  X(0003).
  1551     05  EISSCNTO PIC  Z(5)-.
  1552*    -------------------------------
  1553     05  FILLER            PIC  X(0003).
  1554     05  ELFISSO PIC  Z(8).99-.
  1555*    -------------------------------
  1556     05  FILLER            PIC  X(0003).
  1557     05  EAHISSO PIC  Z(8).99-.
  1558*    -------------------------------
  1559     05  FILLER            PIC  X(0003).
  1560     05  ECANCNTO PIC  Z(5)-.
  1561*    -------------------------------
  1562     05  FILLER            PIC  X(0003).
  1563     05  ELFCANO PIC  Z(6).99-.
  1564*    -------------------------------
  1565     05  FILLER            PIC  X(0003).
  1566     05  EAHCANO PIC  Z(6).99-.
  1567*    -------------------------------
  1568     05  FILLER            PIC  X(0003).
  1569     05  AISSCNTO PIC  Z(5)-.
  1570*    -------------------------------
  1571     05  FILLER            PIC  X(0003).
  1572     05  ALFISSO PIC  Z(8).99-.
  1573*    -------------------------------
  1574     05  FILLER            PIC  X(0003).
  1575     05  AAHISSO PIC  Z(8).99-.
  1576*    -------------------------------
  1577     05  FILLER            PIC  X(0003).
  1578     05  ACANCNTO PIC  Z(5)-.
  1579*    -------------------------------
  1580     05  FILLER            PIC  X(0003).
  1581     05  ALFCANO PIC  Z(6).99-.
  1582*    -------------------------------
  1583     05  FILLER            PIC  X(0003).
  1584     05  AAHCANO PIC  Z(6).99-.
  1585*    -------------------------------
  1586     05  FILLER            PIC  X(0003).
  1587     05  OISSCNTO PIC  Z(5)-.
  1588*    -------------------------------
  1589     05  FILLER            PIC  X(0003).
  1590     05  OLFISSO PIC  Z(8).99-.
  1591*    -------------------------------
  1592     05  FILLER            PIC  X(0003).
  1593     05  OAHISSO PIC  Z(8).99-.
  1594*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  35
* EL630.cbl
  1595     05  FILLER            PIC  X(0003).
  1596     05  OCANCNTO PIC  Z(5)-.
  1597*    -------------------------------
  1598     05  FILLER            PIC  X(0003).
  1599     05  OLFCANO PIC  Z(6).99-.
  1600*    -------------------------------
  1601     05  FILLER            PIC  X(0003).
  1602     05  OAHCANO PIC  Z(6).99-.
  1603*    -------------------------------
  1604     05  FILLER            PIC  X(0003).
  1605     05  RECEVDTO PIC  X(0008).
  1606*    -------------------------------
  1607     05  FILLER            PIC  X(0003).
  1608     05  MNTHNDTO PIC  X(0008).
  1609*    -------------------------------
  1610     05  FILLER            PIC  X(0003).
  1611     05  ERRMSG1O PIC  X(0076).
  1612*    -------------------------------
  1613     05  FILLER            PIC  X(0003).
  1614     05  ERRMSG2O PIC  X(0076).
  1615*    -------------------------------
  1616     05  FILLER            PIC  X(0003).
  1617     05  PFENTERO PIC  X(0002).
  1618*    -------------------------------
  1619     05  FILLER            PIC  X(0003).
  1620     05  PF5O PIC  X(0015).
  1621*    -------------------------------
  1622
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  36
* EL630.cbl
  1624****************************************************************
  1625*
  1626* Copyright (c) 2007 by Clerity Solutions, Inc.
  1627* All rights reserved.
  1628*
  1629****************************************************************
  1630 01  DFHEIV.
  1631   02  DFHEIV0               PIC X(35).
  1632   02  DFHEIV1               PIC X(08).
  1633   02  DFHEIV2               PIC X(08).
  1634   02  DFHEIV3               PIC X(08).
  1635   02  DFHEIV4               PIC X(06).
  1636   02  DFHEIV5               PIC X(04).
  1637   02  DFHEIV6               PIC X(04).
  1638   02  DFHEIV7               PIC X(02).
  1639   02  DFHEIV8               PIC X(02).
  1640   02  DFHEIV9               PIC X(01).
  1641   02  DFHEIV10              PIC S9(7) COMP-3.
  1642   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1643   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1644   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1645   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1646   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1647   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1648   02  DFHEIV17              PIC X(04).
  1649   02  DFHEIV18              PIC X(04).
  1650   02  DFHEIV19              PIC X(04).
  1651   02  DFHEIV20              USAGE IS POINTER.
  1652   02  DFHEIV21              USAGE IS POINTER.
  1653   02  DFHEIV22              USAGE IS POINTER.
  1654   02  DFHEIV23              USAGE IS POINTER.
  1655   02  DFHEIV24              USAGE IS POINTER.
  1656   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1657   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1658   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1659   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1660   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1661   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1662   02  FILLER                PIC X(02).
  1663   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1664   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1665   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1666   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1667   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1668 LINKAGE  SECTION.
  1669*****************************************************************
  1670*                                                               *
  1671* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1672* All rights reserved.                                          *
  1673*                                                               *
  1674*****************************************************************
  1675 01  dfheiblk.
  1676     02  eibtime          pic s9(7) comp-3.
  1677     02  eibdate          pic s9(7) comp-3.
  1678     02  eibtrnid         pic x(4).
  1679     02  eibtaskn         pic s9(7) comp-3.
  1680     02  eibtrmid         pic x(4).
  1681     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  37
* EL630.cbl
  1682     02  eibcposn         pic s9(4) comp.
  1683     02  eibcalen         pic s9(4) comp.
  1684     02  eibaid           pic x(1).
  1685     02  eibfiller1       pic x(1).
  1686     02  eibfn            pic x(2).
  1687     02  eibfiller2       pic x(2).
  1688     02  eibrcode         pic x(6).
  1689     02  eibfiller3       pic x(2).
  1690     02  eibds            pic x(8).
  1691     02  eibreqid         pic x(8).
  1692     02  eibrsrce         pic x(8).
  1693     02  eibsync          pic x(1).
  1694     02  eibfree          pic x(1).
  1695     02  eibrecv          pic x(1).
  1696     02  eibsend          pic x(1).
  1697     02  eibatt           pic x(1).
  1698     02  eibeoc           pic x(1).
  1699     02  eibfmh           pic x(1).
  1700     02  eibcompl         pic x(1).
  1701     02  eibsig           pic x(1).
  1702     02  eibconf          pic x(1).
  1703     02  eiberr           pic x(1).
  1704     02  eibrldbk         pic x(1).
  1705     02  eiberrcd         pic x(4).
  1706     02  eibsynrb         pic x(1).
  1707     02  eibnodat         pic x(1).
  1708     02  eibfiller5       pic x(2).
  1709     02  eibresp          pic 9(09) comp.
  1710     02  eibresp2         pic 9(09) comp.
  1711     02  dfheigdj         pic s9(4) comp.
  1712     02  dfheigdk         pic s9(4) comp.
  1713 01  DFHCOMMAREA             PIC X(1900).
  1714
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  38
* EL630.cbl
  1716
  1717*    COPY ELCCNTL.
  1718******************************************************************
  1719*                                                                *
  1720*                                                                *
  1721*                            ELCCNTL.                            *
  1722*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1723*                            VMOD=2.059                          *
  1724*                                                                *
  1725*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1726*                                                                *
  1727*   FILE TYPE = VSAM,KSDS                                        *
  1728*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1729*                                                                *
  1730*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1731*       ALTERNATE INDEX = NONE                                   *
  1732*                                                                *
  1733*   LOG = YES                                                    *
  1734*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1735******************************************************************
  1736*                   C H A N G E   L O G
  1737*
  1738* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1739*-----------------------------------------------------------------
  1740*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1741* EFFECTIVE    NUMBER
  1742*-----------------------------------------------------------------
  1743* 082503                   PEMA  ADD BENEFIT GROUP
  1744* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1745* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1746* 092705    2005050300006  PEMA  ADD SPP LEASES
  1747* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1748* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1749* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1750* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1751* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1752* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1753* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1754* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1755* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1756* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1757******************************************************************
  1758*
  1759 01  CONTROL-FILE.
  1760     12  CF-RECORD-ID                       PIC XX.
  1761         88  VALID-CF-ID                        VALUE 'CF'.
  1762
  1763     12  CF-CONTROL-PRIMARY.
  1764         16  CF-COMPANY-ID                  PIC XXX.
  1765         16  CF-RECORD-TYPE                 PIC X.
  1766             88  CF-COMPANY-MASTER              VALUE '1'.
  1767             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1768             88  CF-STATE-MASTER                VALUE '3'.
  1769             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1770             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1771             88  CF-CARRIER-MASTER              VALUE '6'.
  1772             88  CF-MORTALITY-MASTER            VALUE '7'.
  1773             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  39
* EL630.cbl
  1774             88  CF-TERMINAL-MASTER             VALUE '9'.
  1775             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1776             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1777             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1778             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1779             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1780             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1781             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1782             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1783             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1784         16  CF-ACCESS-CD-GENL              PIC X(4).
  1785         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1786             20  CF-PROCESSOR               PIC X(4).
  1787         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1788             20  CF-STATE-CODE              PIC XX.
  1789             20  FILLER                     PIC XX.
  1790         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1791             20  FILLER                     PIC XX.
  1792             20  CF-HI-BEN-IN-REC           PIC XX.
  1793         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1794             20  FILLER                     PIC XXX.
  1795             20  CF-CARRIER-CNTL            PIC X.
  1796         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1797             20  FILLER                     PIC XX.
  1798             20  CF-HI-TYPE-IN-REC          PIC 99.
  1799         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1800             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1801                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1802             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1803             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1804         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1805             20  FILLER                     PIC X.
  1806             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1807         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1808             20  FILLER                     PIC XX.
  1809             20  CF-MORTGAGE-PLAN           PIC XX.
  1810         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1811
  1812     12  CF-LAST-MAINT-DT                   PIC XX.
  1813     12  CF-LAST-MAINT-BY                   PIC X(4).
  1814     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1815
  1816     12  CF-RECORD-BODY                     PIC X(728).
  1817
  1818
  1819****************************************************************
  1820*             COMPANY MASTER RECORD                            *
  1821****************************************************************
  1822
  1823     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1824         16  CF-COMPANY-ADDRESS.
  1825             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1826             20  CF-CL-IN-CARE-OF           PIC X(30).
  1827             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1828             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1829             20  CF-CL-CITY-STATE           PIC X(30).
  1830             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1831             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  40
* EL630.cbl
  1832         16  CF-COMPANY-CD                  PIC X.
  1833         16  CF-COMPANY-PASSWORD            PIC X(8).
  1834         16  CF-SECURITY-OPTION             PIC X.
  1835             88  ALL-SECURITY                   VALUE '1'.
  1836             88  COMPANY-VERIFY                 VALUE '2'.
  1837             88  PROCESSOR-VERIFY               VALUE '3'.
  1838             88  NO-SECURITY                    VALUE '4'.
  1839             88  ALL-BUT-TERM                   VALUE '5'.
  1840         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1841             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1842         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1843             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1844         16  CF-INFORCE-LOCATION            PIC X.
  1845             88  CERTS-ARE-ONLINE               VALUE '1'.
  1846             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1847             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1848         16  CF-LOWER-CASE-LETTERS          PIC X.
  1849         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1850             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1851             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1852             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1853             88  CF-ACCNT-CNTL                  VALUE '3'.
  1854             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1855
  1856         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1857         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1858
  1859         16  CF-LGX-CREDIT-USER             PIC X.
  1860             88  CO-IS-NOT-USER                 VALUE 'N'.
  1861             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1862
  1863         16 CF-CREDIT-CALC-CODES.
  1864             20  CF-CR-REM-TERM-CALC PIC X.
  1865               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1866               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1867               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1868               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1869               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1870               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1871               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1872             20  CF-CR-R78-METHOD           PIC X.
  1873               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1874               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1875
  1876         16  CF-CLAIM-CONTROL-COUNTS.
  1877             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1878                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1879
  1880             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1881                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1882
  1883             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1884                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1885
  1886             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1887                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1888
  1889         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  41
* EL630.cbl
  1890
  1891         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1892             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1893             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1894             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1895             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1896                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1897                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1898             20  CF-CO-PREM-REJECT-SW       PIC X.
  1899                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1900                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1901             20  CF-CO-REF-REJECT-SW        PIC X.
  1902                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1903                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1904
  1905         16  CF-CO-REPORTING-DT             PIC XX.
  1906         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1907         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1908           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1909           88  CF-CO-MONTH-END                  VALUE '1'.
  1910
  1911         16  CF-LGX-CLAIM-USER              PIC X.
  1912             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1913             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1914
  1915         16  CF-CREDIT-EDIT-CONTROLS.
  1916             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1917             20  CF-MIN-AGE                 PIC 99.
  1918             20  CF-DEFAULT-AGE             PIC 99.
  1919             20  CF-MIN-TERM                PIC S999      COMP-3.
  1920             20  CF-MAX-TERM                PIC S999      COMP-3.
  1921             20  CF-DEFAULT-SEX             PIC X.
  1922             20  CF-JOINT-AGE-INPUT         PIC X.
  1923                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1924             20  CF-BIRTH-DATE-INPUT        PIC X.
  1925                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1926             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1927                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1928                 88  CF-ZERO-CARRIER            VALUE '1'.
  1929                 88  CF-ZERO-GROUPING           VALUE '2'.
  1930                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1931             20  CF-EDIT-SW                 PIC X.
  1932                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1933             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1934             20  CF-CR-PR-METHOD            PIC X.
  1935               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1936               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1937             20  FILLER                     PIC X.
  1938
  1939         16  CF-CREDIT-MISC-CONTROLS.
  1940             20  CF-REIN-TABLE-SW           PIC X.
  1941                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1942             20  CF-COMP-TABLE-SW           PIC X.
  1943                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1944             20  CF-EXPERIENCE-RETENTION-AGE
  1945                                            PIC S9        COMP-3.
  1946             20  CF-CONVERSION-DT           PIC XX.
  1947             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  42
* EL630.cbl
  1948             20  CF-RUN-FREQUENCY-SW        PIC X.
  1949                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1950                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1951
  1952             20  CF-CR-CHECK-NO-CONTROL.
  1953                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1954                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1955                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1956                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1957                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1958                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1959
  1960                 24  CF-CR-CHECK-COUNT       REDEFINES
  1961                     CF-CR-CHECK-COUNTER      PIC X(4).
  1962
  1963                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1964                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1965
  1966                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1967                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1968                 24  CF-MAIL-PROCESSING       PIC X.
  1969                     88  MAIL-PROCESSING          VALUE 'Y'.
  1970
  1971         16  CF-MISC-SYSTEM-CONTROL.
  1972             20  CF-SYSTEM-C                 PIC X.
  1973                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1974             20  CF-SYSTEM-D                 PIC X.
  1975                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1976             20  CF-SOC-SEC-NO-SW            PIC X.
  1977                 88  SOC-SEC-NO-USED             VALUE '1'.
  1978             20  CF-MEMBER-NO-SW             PIC X.
  1979                 88  MEMBER-NO-USED              VALUE '1'.
  1980             20  CF-TAX-ID-NUMBER            PIC X(11).
  1981             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1982             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1983                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1984                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1985                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1986                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1987             20  CF-SYSTEM-E                 PIC X.
  1988                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1989
  1990         16  CF-LGX-LIFE-USER               PIC X.
  1991             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1992             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1993
  1994         16  CF-CR-MONTH-END-DT             PIC XX.
  1995
  1996         16  CF-FILE-MAINT-DATES.
  1997             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1998                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1999             20  CF-LAST-BATCH       REDEFINES
  2000                 CF-LAST-BATCH-NO               PIC X(4).
  2001             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2002             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2003             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2004             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2005             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  43
* EL630.cbl
  2006             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2007             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2008             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2009             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2010             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2011
  2012         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2013         16  FILLER                         PIC X.
  2014
  2015         16  CF-ALT-MORT-CODE               PIC X(4).
  2016         16  CF-MEMBER-CAPTION              PIC X(10).
  2017
  2018         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2019             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2020             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2021             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2022             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2023             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2024
  2025         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2026
  2027         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2028         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2029         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2030         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2031
  2032         16  CF-AH-OVERRIDE-L1              PIC X.
  2033         16  CF-AH-OVERRIDE-L2              PIC XX.
  2034         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2035         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2036
  2037         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2038         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2039
  2040         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2041         16  CF-AR-LAST-EL860-DT            PIC XX.
  2042         16  CF-MP-MONTH-END-DT             PIC XX.
  2043
  2044         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2045         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2046             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2047
  2048         16  CF-AR-MONTH-END-DT             PIC XX.
  2049
  2050         16  CF-CRDTCRD-USER                PIC X.
  2051             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2052             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2053
  2054         16  CF-CC-MONTH-END-DT             PIC XX.
  2055
  2056         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2057
  2058         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2059             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2060             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2061             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2062         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2063         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  44
* EL630.cbl
  2064         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2065         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2066             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2067             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2068         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2069         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2070         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2071             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2072         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2073
  2074         16  CF-CL-ZIP-CODE.
  2075             20  CF-CL-ZIP-PRIME.
  2076                 24  CF-CL-ZIP-1ST          PIC X.
  2077                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2078                 24  FILLER                 PIC X(4).
  2079             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2080         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2081             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2082             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2083             20  FILLER                     PIC XXX.
  2084
  2085         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2086         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2087         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2088         16  CF-CO-OPTION-START-DATE        PIC XX.
  2089         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2090           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2091                                                      '3' '4'.
  2092           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2093           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2094           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2095           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2096           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2097           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2098
  2099         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2100
  2101         16  CF-PAYMENT-APPROVAL-LEVELS.
  2102             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2103             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2104             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2105             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2106             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2107             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2108
  2109         16  CF-END-USER-REPORTING-USER     PIC X.
  2110             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2111             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2112
  2113         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2114             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2115             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2116
  2117         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2118
  2119         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2120         16  FILLER                         PIC X.
  2121
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  45
* EL630.cbl
  2122         16  CF-CREDIT-ARCHIVE-CNTL.
  2123             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2124             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2125             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2126
  2127         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2128
  2129         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2130             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2131             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2132
  2133         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2134             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2135             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2136
  2137         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2138
  2139         16  CF-CO-ACH-ID-CODE              PIC  X.
  2140             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2141             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2142             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2143         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2144         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2145         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2146         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2147         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2148         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2149         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2150         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2151         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2152                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2153         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2154                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2155
  2156         16  CF-CO-OVER-SHORT.
  2157             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2158             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2159
  2160*         16  FILLER                         PIC X(102).
  2161         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2162             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2163             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2164
  2165         16  CF-AH-APPROVAL-DAYS.
  2166             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2167             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2168             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2169             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2170
  2171         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2172
  2173         16  CF-APPROV-LEV-5.
  2174             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2175             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2176             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2177
  2178         16  FILLER                         PIC X(68).
  2179****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  46
* EL630.cbl
  2180*             PROCESSOR/USER RECORD                            *
  2181****************************************************************
  2182
  2183     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2184         16  CF-PROCESSOR-NAME              PIC X(30).
  2185         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2186         16  CF-PROCESSOR-TITLE             PIC X(26).
  2187         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2188                 88  MESSAGE-YES                VALUE 'Y'.
  2189                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2190
  2191*****************************************************
  2192****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2193****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2194****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2195****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2196*****************************************************
  2197
  2198         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2199             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2200             20  CF-APPLICATION-FORCE       PIC X.
  2201             20  CF-INDIVIDUAL-APP.
  2202                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2203                     28  CF-BROWSE-APP      PIC X.
  2204                     28  CF-UPDATE-APP      PIC X.
  2205
  2206         16  CF-CURRENT-TERM-ON             PIC X(4).
  2207         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2208             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2209             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2210             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2211             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2212             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2213             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2214             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2215         16  CF-PROCESSOR-CARRIER           PIC X.
  2216             88  NO-CARRIER-SECURITY            VALUE ' '.
  2217         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2218             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2219         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2220             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2221         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2222             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2223
  2224         16  CF-PROC-SYS-ACCESS-SW.
  2225             20  CF-PROC-CREDIT-CLAIMS-SW.
  2226                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2227                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2228                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2229                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2230             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2231                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2232                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2233             20  CF-PROC-LIFE-GNRLDGR-SW.
  2234                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2235                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2236                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2237                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  47
* EL630.cbl
  2238             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2239                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2240                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2241         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2242             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2243             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2244         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2245
  2246         16  CF-APPROVAL-LEVEL                  PIC X.
  2247             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2248             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2249             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2250             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2251             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2252
  2253         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2254
  2255         16  CF-LANGUAGE-TYPE                   PIC X.
  2256             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2257             88  CF-LANG-IS-FR                      VALUE 'F'.
  2258
  2259         16  CF-CSR-IND                         PIC X.
  2260         16  FILLER                             PIC X(239).
  2261
  2262****************************************************************
  2263*             PROCESSOR/REMINDERS RECORD                       *
  2264****************************************************************
  2265
  2266     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2267         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2268             20  CF-START-REMIND-DT         PIC XX.
  2269             20  CF-END-REMIND-DT           PIC XX.
  2270             20  CF-REMINDER-TEXT           PIC X(50).
  2271         16  FILLER                         PIC X(296).
  2272
  2273
  2274****************************************************************
  2275*             STATE MASTER RECORD                              *
  2276****************************************************************
  2277
  2278     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2279         16  CF-STATE-ABBREVIATION          PIC XX.
  2280         16  CF-STATE-NAME                  PIC X(25).
  2281         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2282         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2283             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2284             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2285             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2286             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2287                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2288                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2289             20  CF-ST-PREM-REJECT-SW       PIC X.
  2290                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2291                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2292             20  CF-ST-REF-REJECT-SW        PIC X.
  2293                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2294                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2295         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  48
* EL630.cbl
  2296         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2297         16  CF-ST-REFUND-RULES.
  2298             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2299             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2300             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2301         16  CF-ST-FST-PMT-EXTENSION.
  2302             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2303             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2304                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2305                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2306                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2307                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2308         16  CF-ST-STATE-CALL.
  2309             20  CF-ST-CALL-UNEARNED        PIC X.
  2310             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2311             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2312         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2313             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2314             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2315         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2316         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2317         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2318         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2319         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2320         16  FILLER                         PIC X.
  2321         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2322             20  CF-ST-BENEFIT-CD           PIC XX.
  2323             20  CF-ST-BENEFIT-KIND         PIC X.
  2324                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2325                 88  CF-ST-AH-KIND              VALUE 'A'.
  2326             20  CF-ST-REM-TERM-CALC        PIC X.
  2327                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2328                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2329                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2330                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2331                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2332                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2333                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2334                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2335
  2336             20  CF-ST-REFUND-CALC          PIC X.
  2337                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2338                 88  ST-REFD-BY-R78             VALUE '1'.
  2339                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2340                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2341                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2342                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2343                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2344                 88  ST-REFD-UTAH               VALUE '7'.
  2345                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2346                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2347                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2348
  2349             20  CF-ST-EARNING-CALC         PIC X.
  2350                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2351                 88  ST-EARN-BY-R78             VALUE '1'.
  2352                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2353                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  49
* EL630.cbl
  2354                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2355                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2356                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2357                 88  ST-EARN-MEAN               VALUE '8'.
  2358                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2359
  2360             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2361                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2362                 88  ST-OVRD-BY-R78             VALUE '1'.
  2363                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2364                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2365                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2366                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2367                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2368                 88  ST-OVRD-MEAN               VALUE '8'.
  2369                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2370             20  FILLER                     PIC X.
  2371
  2372         16  CF-ST-COMMISSION-CAPS.
  2373             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2374             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2375             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2376             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2377         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2378                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2379
  2380         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2381
  2382         16  CF-ST-STATUTORY-INTEREST.
  2383             20  CF-ST-STAT-DATE-FROM       PIC X.
  2384                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2385                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2386             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2387             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2388             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2389             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2390             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2391
  2392         16  CF-ST-OVER-SHORT.
  2393             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2394             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2395
  2396         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2397
  2398         16  CF-ST-RT-CALC                  PIC X.
  2399
  2400         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2401         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2402         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2403         16  CF-ST-RF-LR-CALC               PIC X.
  2404         16  CF-ST-RF-LL-CALC               PIC X.
  2405         16  CF-ST-RF-LN-CALC               PIC X.
  2406         16  CF-ST-RF-AH-CALC               PIC X.
  2407         16  CF-ST-RF-CP-CALC               PIC X.
  2408*        16  FILLER                         PIC X(206).
  2409*CIDMOD         16  FILLER                         PIC X(192).
  2410         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2411             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  50
* EL630.cbl
  2412         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2413         16  CF-ST-VFY-2ND-BENE             PIC X.
  2414         16  CF-ST-CAUSAL-STATE             PIC X.
  2415         16  FILLER                         PIC X(185).
  2416
  2417****************************************************************
  2418*             BENEFIT MASTER RECORD                            *
  2419****************************************************************
  2420
  2421     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2422         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2423             20  CF-BENEFIT-CODE            PIC XX.
  2424             20  CF-BENEFIT-NUMERIC  REDEFINES
  2425                 CF-BENEFIT-CODE            PIC XX.
  2426             20  CF-BENEFIT-ALPHA           PIC XXX.
  2427             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2428             20  CF-BENEFIT-COMMENT         PIC X(10).
  2429
  2430             20  CF-LF-COVERAGE-TYPE        PIC X.
  2431                 88  CF-REDUCING                VALUE 'R'.
  2432                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2433
  2434             20  CF-SPECIAL-CALC-CD         PIC X.
  2435                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2436                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2437                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2438                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2439                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2440                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2441                 88  CF-FARM-PLAN               VALUE 'F'.
  2442                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2443                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2444                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2445                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2446                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2447                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2448                 88  CF-PRUDENTIAL              VALUE 'P'.
  2449                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2450                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2451                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2452                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2453                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2454                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2455
  2456             20  CF-JOINT-INDICATOR         PIC X.
  2457                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2458
  2459*            20  FILLER                     PIC X(12).
  2460             20  cf-maximum-benefits        pic s999 comp-3.
  2461             20  FILLER                     PIC X(09).
  2462             20  CF-BENEFIT-CATEGORY        PIC X.
  2463             20  CF-LOAN-TYPE               PIC X(8).
  2464
  2465             20  CF-CO-REM-TERM-CALC        PIC X.
  2466                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2467                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2468                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2469                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  51
* EL630.cbl
  2470                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2471
  2472             20  CF-CO-EARNINGS-CALC        PIC X.
  2473                 88  CO-EARN-BY-R78             VALUE '1'.
  2474                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2475                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2476                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2477                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2478                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2479                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2480                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2481
  2482             20  CF-CO-REFUND-CALC          PIC X.
  2483                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2484                 88  CO-REFD-BY-R78             VALUE '1'.
  2485                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2486                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2487                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2488                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2489                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2490                 88  CO-REFD-MEAN               VALUE '8'.
  2491                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2492                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2493                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2494
  2495             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2496                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2497                 88  CO-OVRD-BY-R78             VALUE '1'.
  2498                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2499                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2500                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2501                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2502                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2503                 88  CO-OVRD-MEAN               VALUE '8'.
  2504                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2505
  2506             20  CF-CO-BEN-I-G-CD           PIC X.
  2507                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2508                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2509                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2510
  2511         16  FILLER                         PIC X(304).
  2512
  2513
  2514****************************************************************
  2515*             CARRIER MASTER RECORD                            *
  2516****************************************************************
  2517
  2518     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2519         16  CF-ADDRESS-DATA.
  2520             20  CF-MAIL-TO-NAME            PIC X(30).
  2521             20  CF-IN-CARE-OF              PIC X(30).
  2522             20  CF-ADDRESS-LINE-1          PIC X(30).
  2523             20  CF-ADDRESS-LINE-2          PIC X(30).
  2524             20  CF-CITY-STATE              PIC X(30).
  2525             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2526             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2527
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  52
* EL630.cbl
  2528         16  CF-CLAIM-NO-CONTROL.
  2529             20  CF-CLAIM-NO-METHOD         PIC X.
  2530                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2531                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2532                 88  CLAIM-NO-SEQ               VALUE '3'.
  2533                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2534             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2535                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2536                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2537                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2538
  2539         16  CF-CHECK-NO-CONTROL.
  2540             20  CF-CHECK-NO-METHOD         PIC X.
  2541                 88  CHECK-NO-MANUAL            VALUE '1'.
  2542                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2543                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2544                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2545             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2546                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2547
  2548         16  CF-DOMICILE-STATE              PIC XX.
  2549
  2550         16  CF-EXPENSE-CONTROLS.
  2551             20  CF-EXPENSE-METHOD          PIC X.
  2552                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2553                 88  DOLLARS-PER-PMT            VALUE '2'.
  2554                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2555                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2556             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2557             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2558
  2559         16  CF-CORRESPONDENCE-CONTROL.
  2560             20  CF-LETTER-RESEND-OPT       PIC X.
  2561                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2562                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2563             20  FILLER                     PIC X(4).
  2564
  2565         16  CF-RESERVE-CONTROLS.
  2566             20  CF-MANUAL-SW               PIC X.
  2567                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2568             20  CF-FUTURE-SW               PIC X.
  2569                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2570             20  CF-PTC-SW                  PIC X.
  2571                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2572             20  CF-IBNR-SW                 PIC X.
  2573                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2574             20  CF-PTC-LF-SW               PIC X.
  2575                 88  CF-LF-PTC-USED             VALUE '1'.
  2576             20  CF-CDT-ACCESS-METHOD       PIC X.
  2577                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2578                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2579                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2580             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2581
  2582         16  CF-CLAIM-CALC-METHOD           PIC X.
  2583             88  360-PLUS-MONTHS                VALUE '1'.
  2584             88  365-PLUS-MONTHS                VALUE '2'.
  2585             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  53
* EL630.cbl
  2586             88  360-DAILY                      VALUE '4'.
  2587             88  365-DAILY                      VALUE '5'.
  2588
  2589         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2590         16  FILLER                         PIC X(11).
  2591
  2592         16  CF-LIMIT-AMOUNTS.
  2593             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2594             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2595             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2596             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2597             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2598             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2599             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2600             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2601             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2602             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2603
  2604         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2605         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2606         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2607
  2608         16  CF-ZIP-CODE.
  2609             20  CF-ZIP-PRIME.
  2610                 24  CF-ZIP-1ST             PIC X.
  2611                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2612                 24  FILLER                 PIC X(4).
  2613             20  CF-ZIP-PLUS4               PIC X(4).
  2614         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2615             20  CF-CAN-POSTAL-1            PIC XXX.
  2616             20  CF-CAN-POSTAL-2            PIC XXX.
  2617             20  FILLER                     PIC XXX.
  2618
  2619         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2620         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2621         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2622
  2623         16  CF-RATING-SWITCH               PIC X.
  2624             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2625             88  CF-NO-RATING                   VALUE 'N'.
  2626
  2627         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2628
  2629         16  CF-CARRIER-OVER-SHORT.
  2630             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2631             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2632
  2633         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2634         16  CF-SECPAY-SWITCH               PIC X.
  2635             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2636             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2637         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2638         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2639         16  FILLER                         PIC X(444).
  2640*        16  FILLER                         PIC X(452).
  2641
  2642
  2643****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  54
* EL630.cbl
  2644*             MORTALITY MASTER RECORD                          *
  2645****************************************************************
  2646
  2647     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2648         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2649                                INDEXED BY CF-MORT-NDX.
  2650             20  CF-MORT-TABLE              PIC X(5).
  2651             20  CF-MORT-TABLE-TYPE         PIC X.
  2652                 88  CF-MORT-JOINT              VALUE 'J'.
  2653                 88  CF-MORT-SINGLE             VALUE 'S'.
  2654                 88  CF-MORT-COMBINED           VALUE 'C'.
  2655                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2656                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2657             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2658             20  CF-MORT-AGE-METHOD         PIC XX.
  2659                 88  CF-AGE-LAST                VALUE 'AL'.
  2660                 88  CF-AGE-NEAR                VALUE 'AN'.
  2661             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2662             20  CF-MORT-ADJUSTMENT-DIRECTION
  2663                                            PIC X.
  2664                 88  CF-MINUS                   VALUE '-'.
  2665                 88  CF-PLUS                    VALUE '+'.
  2666             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2667             20  CF-MORT-JOINT-CODE         PIC X.
  2668                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2669             20  CF-MORT-PC-Q               PIC X.
  2670                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2671             20  CF-MORT-TABLE-CODE         PIC X(4).
  2672             20  CF-MORT-COMMENTS           PIC X(15).
  2673             20  FILLER                     PIC X(14).
  2674
  2675         16  FILLER                         PIC X(251).
  2676
  2677
  2678****************************************************************
  2679*             BUSSINESS TYPE MASTER RECORD                     *
  2680****************************************************************
  2681
  2682     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2683* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2684* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2685* AND RECORD 05 IS TYPES 81-99
  2686         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2687             20  CF-BUSINESS-TITLE          PIC  X(19).
  2688             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2689                                            PIC S9V9(4) COMP-3.
  2690             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2691             20  FILLER                     PIC  X.
  2692         16  FILLER                         PIC  X(248).
  2693
  2694
  2695****************************************************************
  2696*             TERMINAL MASTER RECORD                           *
  2697****************************************************************
  2698
  2699     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2700
  2701         16  CF-COMPANY-TERMINALS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  55
* EL630.cbl
  2702             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2703                                  PIC X(4).
  2704         16  FILLER               PIC X(248).
  2705
  2706
  2707****************************************************************
  2708*             LIFE EDIT MASTER RECORD                          *
  2709****************************************************************
  2710
  2711     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2712         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2713             20  CF-LIFE-CODE-IN            PIC XX.
  2714             20  CF-LIFE-CODE-OUT           PIC XX.
  2715         16  FILLER                         PIC X(248).
  2716
  2717
  2718****************************************************************
  2719*             AH EDIT MASTER RECORD                            *
  2720****************************************************************
  2721
  2722     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2723         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2724             20  CF-AH-CODE-IN              PIC XXX.
  2725             20  CF-AH-CODE-OUT             PIC XX.
  2726         16  FILLER                         PIC X(248).
  2727
  2728
  2729****************************************************************
  2730*             CREDIBILITY TABLES                               *
  2731****************************************************************
  2732
  2733     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2734         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2735                             INDEXED BY CF-CRDB-NDX.
  2736             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2737             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2738             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2739         16  FILLER                         PIC  X(332).
  2740
  2741
  2742****************************************************************
  2743*             REPORT CUSTOMIZATION RECORD                      *
  2744****************************************************************
  2745
  2746     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2747         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2748             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2749             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2750             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2751**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2752****       A T-TRANSFER.                                   ****
  2753             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2754
  2755         16  FILLER                         PIC XX.
  2756
  2757         16  CF-CARRIER-CNTL-OPT.
  2758             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2759                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  56
* EL630.cbl
  2760                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2761             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2762                                            PIC X.
  2763         16  CF-GROUP-CNTL-OPT.
  2764             20  CF-GROUP-OPT-SEQ           PIC 9.
  2765                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2766                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2767             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2768                                            PIC X(6).
  2769         16  CF-STATE-CNTL-OPT.
  2770             20  CF-STATE-OPT-SEQ           PIC 9.
  2771                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2772                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2773             20  CF-STATE-SELECT OCCURS 3 TIMES
  2774                                            PIC XX.
  2775         16  CF-ACCOUNT-CNTL-OPT.
  2776             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2777                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2778                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2779             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2780                                            PIC X(10).
  2781         16  CF-BUS-TYP-CNTL-OPT.
  2782             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2783                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2784                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2785             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2786                                            PIC XX.
  2787         16  CF-LF-TYP-CNTL-OPT.
  2788             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2789                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2790                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2791             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2792                                            PIC XX.
  2793         16  CF-AH-TYP-CNTL-OPT.
  2794             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2795                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2796                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2797             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2798                                            PIC XX.
  2799         16  CF-REPTCD1-CNTL-OPT.
  2800             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2801                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2802                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2803             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2804                                            PIC X(10).
  2805         16  CF-REPTCD2-CNTL-OPT.
  2806             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2807                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2808                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2809             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2810                                            PIC X(10).
  2811         16  CF-USER1-CNTL-OPT.
  2812             20  CF-USER1-OPT-SEQ           PIC 9.
  2813                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2814                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2815             20  CF-USER1-SELECT OCCURS 3 TIMES
  2816                                            PIC X(10).
  2817         16  CF-USER2-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  57
* EL630.cbl
  2818             20  CF-USER2-OPT-SEQ           PIC 9.
  2819                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2820                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2821             20  CF-USER2-SELECT OCCURS 3 TIMES
  2822                                            PIC X(10).
  2823         16  CF-USER3-CNTL-OPT.
  2824             20  CF-USER3-OPT-SEQ           PIC 9.
  2825                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2826                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2827             20  CF-USER3-SELECT OCCURS 3 TIMES
  2828                                            PIC X(10).
  2829         16  CF-USER4-CNTL-OPT.
  2830             20  CF-USER4-OPT-SEQ           PIC 9.
  2831                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2832                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2833             20  CF-USER4-SELECT OCCURS 3 TIMES
  2834                                            PIC X(10).
  2835         16  CF-USER5-CNTL-OPT.
  2836             20  CF-USER5-OPT-SEQ           PIC 9.
  2837                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2838                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2839             20  CF-USER5-SELECT OCCURS 3 TIMES
  2840                                            PIC X(10).
  2841         16  CF-REINS-CNTL-OPT.
  2842             20  CF-REINS-OPT-SEQ           PIC 9.
  2843                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2844                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2845             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2846                 24  CF-REINS-PRIME         PIC XXX.
  2847                 24  CF-REINS-SUB           PIC XXX.
  2848
  2849         16  CF-AGENT-CNTL-OPT.
  2850             20  CF-AGENT-OPT-SEQ           PIC 9.
  2851                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2852                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2853             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2854                                            PIC X(10).
  2855
  2856         16  FILLER                         PIC X(43).
  2857
  2858         16  CF-LOSS-RATIO-SELECT.
  2859             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2860             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2861         16  CF-ENTRY-DATE-SELECT.
  2862             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2863             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2864         16  CF-EFFECTIVE-DATE-SELECT.
  2865             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2866             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2867
  2868         16  CF-EXCEPTION-LIST-IND          PIC X.
  2869             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2870
  2871         16  FILLER                         PIC X(318).
  2872
  2873****************************************************************
  2874*                  EXCEPTION REPORTING RECORD                  *
  2875****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  58
* EL630.cbl
  2876
  2877     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2878         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2879             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2880
  2881         16  CF-COMBINED-LIFE-AH-OPT.
  2882             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2883             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2884             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2885             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2886
  2887         16  CF-LIFE-OPT.
  2888             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2889             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2890             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2891             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2892             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2893             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2894             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2895             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2896             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2897             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2898
  2899         16  CF-AH-OPT.
  2900             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2901             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2902             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2903             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2904             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2905             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2906             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2907             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2908             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2909             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2910
  2911         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2912             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2913             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2914             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2915
  2916         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2917
  2918         16  FILLER                         PIC X(673).
  2919
  2920
  2921****************************************************************
  2922*             MORTGAGE SYSTEM PLAN RECORD                      *
  2923****************************************************************
  2924
  2925     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2926         16  CF-PLAN-TYPE                   PIC X.
  2927             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2928             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2929             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2930         16  CF-PLAN-ABBREV                 PIC XXX.
  2931         16  CF-PLAN-DESCRIPT               PIC X(10).
  2932         16  CF-PLAN-NOTES                  PIC X(20).
  2933         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  59
* EL630.cbl
  2934         16  CF-PLAN-UNDERWRITING.
  2935             20  CF-PLAN-TERM-DATA.
  2936                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2937                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2938             20  CF-PLAN-AGE-DATA.
  2939                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2940                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2941                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2942             20  CF-PLAN-BENEFIT-DATA.
  2943                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2944                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2945                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2946                                            PIC S9(7)V99  COMP-3.
  2947         16  CF-PLAN-POLICY-FORMS.
  2948             20  CF-POLICY-FORM             PIC X(12).
  2949             20  CF-MASTER-APPLICATION      PIC X(12).
  2950             20  CF-MASTER-POLICY           PIC X(12).
  2951         16  CF-PLAN-RATING.
  2952             20  CF-RATE-CODE               PIC X(5).
  2953             20  CF-SEX-RATING              PIC X.
  2954                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2955                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2956             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2957             20  CF-SUB-STD-TYPE            PIC X.
  2958                 88  CF-PCT-OF-PREM            VALUE '1'.
  2959                 88  CF-PCT-OF-BENE            VALUE '2'.
  2960         16  CF-PLAN-PREM-TOLERANCES.
  2961             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2962             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2963         16  CF-PLAN-PYMT-TOLERANCES.
  2964             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2965             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2966         16  CF-PLAN-MISC-DATA.
  2967             20  FILLER                     PIC X.
  2968             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2969             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2970         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2971         16  CF-PLAN-IND-GRP                PIC X.
  2972             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2973                                                     '1'.
  2974             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2975                                                     '2'.
  2976         16  CF-MIB-SEARCH-SW               PIC X.
  2977             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2978             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2979             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2980             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2981         16  CF-ALPHA-SEARCH-SW             PIC X.
  2982             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2983             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2984             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2985             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2986             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2987             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2988             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2989             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2990             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2991             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  60
* EL630.cbl
  2992                                                     'A' 'B' 'C'
  2993                                                     'X' 'Y' 'Z'.
  2994         16  CF-EFF-DT-RULE-SW              PIC X.
  2995             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2996             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2997             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2998             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2999             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3000         16  FILLER                         PIC X(4).
  3001         16  CF-HEALTH-QUESTIONS            PIC X.
  3002             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3003         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3004         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3005         16  CF-PLAN-SNGL-JNT               PIC X.
  3006             88  CF-COMBINED-PLAN              VALUE 'C'.
  3007             88  CF-JNT-PLAN                   VALUE 'J'.
  3008             88  CF-SNGL-PLAN                  VALUE 'S'.
  3009         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3010         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3011         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3012         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3013         16  CF-RERATE-CNTL                 PIC  X.
  3014             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3015             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3016             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3017             88  CF-AUTO-RECALC                 VALUE '4'.
  3018         16  CF-BENEFIT-TYPE                PIC  X.
  3019             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3020             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3021         16  CF-POLICY-FEE                  PIC S999V99
  3022                                                    COMP-3.
  3023         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3024         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3025         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3026         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3027         16  FILLER                         PIC  X(32).
  3028         16  CF-TERMINATION-FORM            PIC  X(04).
  3029         16  FILLER                         PIC  X(08).
  3030         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3031                                                       COMP-3.
  3032         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3033         16  CF-ISSUE-LETTER                PIC  X(4).
  3034         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3035         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3036             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3037             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3038         16  CF-MP-REFUND-CALC              PIC X.
  3039             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3040             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3041             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3042             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3043             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3044             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3045             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3046             88  CF-MP-REFD-MEAN                VALUE '8'.
  3047         16  CF-ALT-RATE-CODE               PIC  X(5).
  3048
  3049
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  61
* EL630.cbl
  3050         16  FILLER                         PIC X(498).
  3051****************************************************************
  3052*             MORTGAGE COMPANY MASTER RECORD                   *
  3053****************************************************************
  3054
  3055     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3056         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3057         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3058             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3059             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3060             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3061             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3062             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3063
  3064         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3065         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3066         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3067         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3068         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3069
  3070         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3071             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3072         16  CF-MP-RECON-USE-IND            PIC X(1).
  3073             88  CF-MP-USE-RECON             VALUE 'Y'.
  3074         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3075             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3076         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3077             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3078             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3079         16  FILLER                         PIC X(1).
  3080         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3081             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3082         16  CF-MORTG-MIB-VERSION           PIC X.
  3083             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3084             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3085             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3086         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3087             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3088                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3089             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3090                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3091             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3092                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3093             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3094                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3095             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3096                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3097             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3098                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3099         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3100         16  FILLER                         PIC X(7).
  3101         16  CF-MORTG-DESTINATION-SYMBOL.
  3102             20  CF-MORTG-MIB-COMM          PIC X(5).
  3103             20  CF-MORTG-MIB-TERM          PIC X(5).
  3104         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3105             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3106         16  FILLER                         PIC X(03).
  3107         16  CF-MP-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  62
* EL630.cbl
  3108             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3109                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3110                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3111                                                ' ' LOW-VALUES.
  3112                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3113                                               VALUE '3'.
  3114         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3115         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3116         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3117             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3118                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3119             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3120                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3121             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3122                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3123             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3124                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3125             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3126                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3127             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3128                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3129         16  CF-MORTG-BILLING-AREA.
  3130             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3131                                            PIC X.
  3132         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3133         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3134         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3135         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3136             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3137             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3138         16  FILLER                         PIC X.
  3139         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3140             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3141             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3142         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3143         16  FILLER                         PIC X(8).
  3144         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3145         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3146         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3147         16  CF-ACH-COMPANY-ID.
  3148             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3149                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3150                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3151                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3152             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3153         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3154             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3155         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3156             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3157             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3158         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3159         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3160         16  FILLER                         PIC X(536).
  3161
  3162****************************************************************
  3163*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3164****************************************************************
  3165
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  63
* EL630.cbl
  3166     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3167         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3168             20  CF-FEMALE-HEIGHT.
  3169                 24  CF-FEMALE-FT           PIC 99.
  3170                 24  CF-FEMALE-IN           PIC 99.
  3171             20  CF-FEMALE-MIN-WT           PIC 999.
  3172             20  CF-FEMALE-MAX-WT           PIC 999.
  3173         16  FILLER                         PIC X(428).
  3174
  3175     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3176         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3177             20  CF-MALE-HEIGHT.
  3178                 24  CF-MALE-FT             PIC 99.
  3179                 24  CF-MALE-IN             PIC 99.
  3180             20  CF-MALE-MIN-WT             PIC 999.
  3181             20  CF-MALE-MAX-WT             PIC 999.
  3182         16  FILLER                         PIC X(428).
  3183******************************************************************
  3184*             AUTOMATIC ACTIVITY RECORD                          *
  3185******************************************************************
  3186     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3187         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3188             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3189             20  CF-SYS-LETTER-ID           PIC X(04).
  3190             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3191             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3192             20  CF-SYS-RESET-SW            PIC X(01).
  3193             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3194             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3195
  3196         16  FILLER                         PIC X(50).
  3197
  3198         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3199             20  CF-USER-ACTIVE-SW          PIC X(01).
  3200             20  CF-USER-LETTER-ID          PIC X(04).
  3201             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3202             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3203             20  CF-USER-RESET-SW           PIC X(01).
  3204             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3205             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3206             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3207
  3208         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  64
* EL630.cbl
  3210*    COPY ERCPNDB.
  3211******************************************************************
  3212*                                                                *
  3213*                                                                *
  3214*                            ERCPNDB.                            *
  3215*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3216*                            VMOD=2.025                          *
  3217*                                                                *
  3218*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3219*                                                                *
  3220******************************************************************
  3221*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3222*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3223******************************************************************
  3224*                                                                *
  3225*                                                                *
  3226*   FILE TYPE = VSAM,KSDS                                        *
  3227*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3228*                                                                *
  3229*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3230*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3231*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3232*                                                 RKP=13,LEN=36  *
  3233*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3234*                                      AND CHG-SEQ.)             *
  3235*                                                RKP=49,LEN=11   *
  3236*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3237*                                      AND CHG-SEQ.)             *
  3238*                                                RKP=60,LEN=15   *
  3239*                                                                *
  3240*   LOG = NO                                                     *
  3241*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3242******************************************************************
  3243******************************************************************
  3244*                   C H A N G E   L O G
  3245*
  3246* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3247*-----------------------------------------------------------------
  3248*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3249* EFFECTIVE    NUMBER
  3250*-----------------------------------------------------------------
  3251* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3252* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3253* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3254* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3255* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3256* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3257* 032306                   PEMA  ADD BOW LOAN NUMBER
  3258* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3259* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3260* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3261* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3262* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3263* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3264* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3265* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3266* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3267******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  65
* EL630.cbl
  3268
  3269 01  PENDING-BUSINESS.
  3270     12  PB-RECORD-ID                     PIC XX.
  3271         88  VALID-PB-ID                        VALUE 'PB'.
  3272
  3273     12  PB-CONTROL-PRIMARY.
  3274         16  PB-COMPANY-CD                PIC X.
  3275         16  PB-ENTRY-BATCH               PIC X(6).
  3276         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3277         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3278
  3279     12  PB-CONTROL-BY-ACCOUNT.
  3280         16  PB-COMPANY-CD-A1             PIC X.
  3281         16  PB-CARRIER                   PIC X.
  3282         16  PB-GROUPING.
  3283             20  PB-GROUPING-PREFIX       PIC XXX.
  3284             20  PB-GROUPING-PRIME        PIC XXX.
  3285         16  PB-STATE                     PIC XX.
  3286         16  PB-ACCOUNT.
  3287             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3288             20  PB-ACCOUNT-PRIME         PIC X(6).
  3289         16  PB-CERT-EFF-DT               PIC XX.
  3290         16  PB-CERT-NO.
  3291             20  PB-CERT-PRIME            PIC X(10).
  3292             20  PB-CERT-SFX              PIC X.
  3293         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3294
  3295         16  PB-RECORD-TYPE               PIC X.
  3296             88  PB-MAILING-DATA                VALUE '0'.
  3297             88  PB-ISSUE                       VALUE '1'.
  3298             88  PB-CANCELLATION                VALUE '2'.
  3299             88  PB-BATCH-TRAILER               VALUE '9'.
  3300
  3301     12  PB-CONTROL-BY-ORIG-BATCH.
  3302         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3303         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3304         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3305         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3306
  3307     12  PB-CONTROL-BY-CSR.
  3308         16  PB-CSR-COMPANY-CD            PIC X.
  3309         16  PB-CSR-ID                    PIC X(4).
  3310         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3311         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3312         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3313******************************************************************
  3314*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3315******************************************************************
  3316
  3317     12  PB-LAST-MAINT-DT                 PIC XX.
  3318     12  PB-LAST-MAINT-BY                 PIC X(4).
  3319     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3320
  3321     12  PB-RECORD-BODY                   PIC X(375).
  3322
  3323     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3324         16  PB-CERT-ORIGIN               PIC X.
  3325             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  66
* EL630.cbl
  3326         16  PB-I-NAME.
  3327             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3328             20  PB-I-INSURED-FIRST-NAME.
  3329                 24  PB-I-INSURED-1ST-INIT PIC X.
  3330                 24  FILLER                PIC X(9).
  3331             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3332         16  PB-I-AGE                     PIC S99   COMP-3.
  3333         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3334         16  PB-I-BIRTHDAY                PIC XX.
  3335         16  PB-I-INSURED-SEX             PIC X.
  3336             88  PB-SEX-MALE     VALUE 'M'.
  3337             88  PB-SEX-FEMALE   VALUE 'F'.
  3338
  3339         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3340         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3341         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3342         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3343         16  PB-I-SKIP-CODE               PIC X.
  3344             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3345             88  PB-SKIP-JULY              VALUE '1'.
  3346             88  PB-SKIP-AUGUST            VALUE '2'.
  3347             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3348             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3349             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3350             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3351             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3352             88  PB-SKIP-JUNE              VALUE '8'.
  3353             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3354             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3355             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3356         16  PB-I-TERM-TYPE               PIC X.
  3357             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3358             88  PB-PAID-WEEKLY            VALUE 'W'.
  3359             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3360             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3361             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3362         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3363         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3364         16  PB-I-DATA-ENTRY-SW           PIC X.
  3365             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3366             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3367             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3368             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3369         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3370         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3371*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3372         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3373         16  FILLER                       PIC X.
  3374
  3375         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3376             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3377             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3378                                                   '90' THRU '99'.
  3379         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3380                                          PIC XX.
  3381         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3382         16  PB-I-AMOUNT-FINANCED REDEFINES
  3383                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  67
* EL630.cbl
  3384         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3385         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3386                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3387         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3388         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3389         16  PB-I-CLP-AMOUNT REDEFINES
  3390                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3391         16  PB-I-LF-CALC-FLAG            PIC X.
  3392             88 PB-COMP-LF-PREM               VALUE '?'.
  3393         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3394         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3395         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3396         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3397         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3398         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3399         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3400         16  PB-I-LF-ABBR                 PIC XXX.
  3401         16  PB-I-LF-INPUT-CD             PIC XX.
  3402
  3403         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3404             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3405             88  PB-INVALID-AH               VALUE '  ' '00'
  3406                                                   '90' THRU '99'.
  3407         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3408         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3409         16  PB-I-AH-CALC-FLAG            PIC X.
  3410             88 PB-COMP-AH-PREM                  VALUE '?'.
  3411         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3412         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3413         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3414         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3415         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3416         16  PB-I-AH-ABBR                 PIC XXX.
  3417         16  PB-I-AH-INPUT-CD             PIC XXX.
  3418
  3419         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3420         16  PB-I-REIN-TABLE              PIC XXX.
  3421         16  PB-I-BUSINESS-TYPE           PIC 99.
  3422         16  PB-I-INDV-GRP-CD             PIC X.
  3423         16  PB-I-MORT-CODE.
  3424             20  PB-I-TABLE               PIC X.
  3425             20  PB-I-INTEREST            PIC XX.
  3426             20  PB-I-MORT-TYP            PIC X.
  3427         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3428         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3429         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3430         16  PB-I-INDV-GRP-OVRD           PIC X.
  3431         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3432         16  PB-I-SIG-SW                  PIC X.
  3433             88  PB-POLICY-SIGNED             VALUE 'Y'.
  3434         16  PB-I-RATE-CLASS              PIC XX.
  3435         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3436         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3437         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3438         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3439         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3440         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3441         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  68
* EL630.cbl
  3442         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3443         16  PB-I-OB-FLAG                 PIC X.
  3444             88  PB-I-OB                      VALUE 'B'.
  3445             88  PB-I-SUMMARY                 VALUE 'Z'.
  3446         16  PB-I-ENTRY-STATUS            PIC X.
  3447             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3448                                              'M' '5' '9' '2'.
  3449             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3450             88  PB-I-POLICY-PENDING          VALUE '2'.
  3451             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3452             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3453             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  3454             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3455             88  PB-I-REIN-ONLY               VALUE '9'.
  3456             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3457             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3458             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3459             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3460         16  PB-I-INT-CODE                PIC X.
  3461             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3462             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3463         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3464         16  PB-I-SOC-SEC-NO              PIC X(11).
  3465         16  PB-I-MEMBER-NO               PIC X(12).
  3466         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3467*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3468         16  PB-I-OLD-LOF                 PIC XXX.
  3469         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3470         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3471         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3472         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3473         16  PB-I-LIFE-INDICATOR          PIC X.
  3474             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3475         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3476         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3477                                          PIC S9(5)V99    COMP-3.
  3478         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3479             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3480             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3481         16  PB-I-1ST-PMT-DT              PIC XX.
  3482         16  PB-I-JOINT-INSURED.
  3483             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3484             20 PB-I-JOINT-FIRST-NAME.
  3485                24  PB-I-JOINT-FIRST-INIT PIC X.
  3486                24  FILLER                PIC X(9).
  3487             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3488*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3489         16  PB-I-BENEFICIARY-NAME.
  3490             20  PB-I-BANK-NUMBER         PIC X(10).
  3491             20  FILLER                   PIC X(15).
  3492         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  3493         16  PB-I-REFERENCE               PIC X(12).
  3494         16  FILLER REDEFINES PB-I-REFERENCE.
  3495             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3496             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3497             20  PB-I-CLP-STATE           PIC XX.
  3498         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3499             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  69
* EL630.cbl
  3500             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3501             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3502         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3503         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3504         16  PB-I-RESIDENT-STATE          PIC XX.
  3505         16  PB-I-RATE-CODE               PIC X(4).
  3506         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3507         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3508         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3509         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3510         16  PB-I-BANK-NOCHRGB            PIC 99.
  3511         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3512         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3513
  3514     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3515         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3516             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3517         16  PB-C-CANCEL-ORIGIN           PIC X.
  3518             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3519         16  PB-C-LF-CANCEL-DT            PIC XX.
  3520         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3521         16  PB-C-LF-CALC-REQ             PIC X.
  3522             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3523         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3524         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3525         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3526             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3527         16  PB-C-AH-CANCEL-DT            PIC XX.
  3528         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3529         16  PB-C-AH-CALC-REQ             PIC X.
  3530             88 PB-COMP-AH-CANCEL            VALUE '?'.
  3531         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  3532         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  3533         16  PB-C-LAST-NAME               PIC X(15).
  3534         16  PB-C-REFUND-SW               PIC X.
  3535             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  3536             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  3537         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  3538         16  PB-C-PAYEE-CODE              PIC X(6).
  3539         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  3540         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  3541         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  3542         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  3543         16  PB-C-REFERENCE               PIC X(12).
  3544         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3545         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3546         16  PB-C-POST-CARD-IND           PIC X.
  3547         16  PB-C-CANCEL-REASON           PIC X.
  3548         16  PB-C-REF-INTERFACE-SW        PIC X.
  3549         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  3550         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  3551         16  FILLER                       PIC X(01).
  3552*        16  FILLER                       PIC X(18).
  3553         16  PB-C-POLICY-FORM-NO          PIC X(12).
  3554*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  3555         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  3556         16  PB-CANCELED-CERT-DATA.
  3557             20  PB-CI-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  70
* EL630.cbl
  3558                 24  PB-CI-LAST-NAME      PIC X(15).
  3559                 24  PB-CI-INITIALS       PIC XX.
  3560             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  3561             20  PB-CI-INSURED-SEX        PIC X.
  3562             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  3563             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  3564             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  3565             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  3566             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3567             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  3568             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  3569             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  3570             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  3571             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3572             20  PB-CI-RATE-CLASS         PIC XX.
  3573             20  PB-CI-RATE-DEV-LF        PIC XXX.
  3574             20  PB-CI-RATE-DEV-AH        PIC XXX.
  3575             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  3576             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  3577             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  3578             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  3579             20  PB-CI-LF-ABBR            PIC X(3).
  3580             20  PB-CI-AH-ABBR            PIC X(3).
  3581             20  PB-CI-OB-FLAG            PIC X.
  3582                 88  PB-CI-OB                VALUE 'B'.
  3583             20  PB-CI-LF-POLICY-STATUS   PIC X.
  3584                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  3585                                           'M' '4' '5' '9' '2'.
  3586                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  3587                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  3588                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  3589                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  3590                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  3591                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  3592                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3593                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  3594                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3595                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  3596                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  3597                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  3598                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  3599             20  PB-CI-AH-POLICY-STATUS   PIC X.
  3600                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  3601                                           'M' '4' '5' '9' '2'.
  3602                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  3603                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  3604                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  3605                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  3606                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  3607                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  3608                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3609                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  3610                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3611                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  3612                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  3613                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  3614                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  3615             20  PB-CI-PAY-FREQUENCY      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  71
* EL630.cbl
  3616             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  3617             20  PB-CI-SOC-SEC-NO         PIC X(11).
  3618             20  PB-CI-MEMBER-NO          PIC X(12).
  3619             20  PB-CI-INT-CODE           PIC X.
  3620                 88  PB-CI-ADD-ON                  VALUE 'A'.
  3621                 88  PB-CI-SIMPLE                  VALUE 'S'.
  3622             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  3623             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  3624             20  PB-CI-COMP-EXCP-SW       PIC X.
  3625                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  3626                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  3627             20  PB-CI-ENTRY-STATUS       PIC X.
  3628             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  3629             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  3630             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  3631             20  PB-CI-DEATH-DT           PIC XX.
  3632             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  3633             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  3634             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3635             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3636             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  3637             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  3638             20  PB-CI-ENTRY-DT              PIC XX.
  3639             20  PB-CI-ENTRY-BATCH           PIC X(6).
  3640             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  3641             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  3642             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  3643             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  3644             20  PB-CI-OLD-LOF               PIC XXX.
  3645*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  3646             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  3647             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  3648             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  3649             20  PB-CI-INDV-GRP-CD           PIC X.
  3650             20  PB-CI-BENEFICIARY-NAME.
  3651                 24  PB-CI-BANK-NUMBER       PIC X(10).
  3652                 24  FILLER                  PIC X(15).
  3653             20  PB-CI-NOTE-SW               PIC X.
  3654             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  3655             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  3656             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  3657             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  3658             20  PB-CI-LOAN-OFFICER          PIC X(5).
  3659             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  3660             20  PB-CI-FIRST-NAME            PIC X(10).
  3661             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  3662
  3663         16  FILLER                       PIC X(13).
  3664*032306  16  FILLER                       PIC X(27).
  3665*        16  FILLER                       PIC X(46).
  3666
  3667     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  3668         16  FILLER                       PIC X(10).
  3669         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  3670         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  3671         16  PB-M-INSURED-MID-INIT        PIC X.
  3672         16  PB-M-INSURED-AGE             PIC 99.
  3673         16  PB-M-INSURED-BIRTHDAY        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  72
* EL630.cbl
  3674         16  PB-M-INSURED-SEX             PIC X.
  3675         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  3676         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  3677         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  3678         16  PB-M-INSURED-CITY-STATE.
  3679             20  PB-M-INSURED-CITY        PIC X(28).
  3680             20  PB-M-INSURED-STATE       PIC XX.
  3681         16  PB-M-INSURED-ZIP-CODE.
  3682             20  PB-M-INSURED-ZIP-PRIME.
  3683                 24  PB-M-INSURED-ZIP-1   PIC X.
  3684                     88  PB-M-CANADIAN-POST-CODE
  3685                                             VALUE 'A' THRU 'Z'.
  3686                 24  FILLER               PIC X(4).
  3687             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  3688         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  3689                                        PB-M-INSURED-ZIP-CODE.
  3690             20  PM-M-INS-CAN-POST1       PIC XXX.
  3691             20  PM-M-INS-CAN-POST2       PIC XXX.
  3692             20  FILLER                   PIC XXX.
  3693         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  3694         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  3695         16  PB-M-CRED-BENE-NAME          PIC X(30).
  3696         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  3697         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  3698         16  PB-M-CRED-BENE-CITYST.
  3699             20  PB-M-CRED-BENE-CITY      PIC X(28).
  3700             20  PB-M-CRED-BENE-STATE     PIC XX.
  3701         16  FILLER                       PIC X(92).
  3702
  3703     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  3704         16  FILLER                       PIC X(10).
  3705         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3706         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3707         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3708         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3709         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3710         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3711         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3712         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3713         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3714         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3715         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3716         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3717         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  3718         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  3719         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  3720         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  3721         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  3722         16  PB-ACCOUNT-NAME              PIC X(30).
  3723         16  PB-PREM-REF-RPT-FLAG         PIC X.
  3724         16  PB-REFERENCE                 PIC X(12).
  3725         16  PB-B-RECEIVED-DT             PIC XX.
  3726         16  FILLER                       PIC X(234).
  3727
  3728     12  PB-RECORD-STATUS.
  3729         16  PB-CREDIT-SELECT-DT          PIC XX.
  3730         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  3731         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  73
* EL630.cbl
  3732         16  PB-BILLING-STATUS            PIC X.
  3733             88  PB-ENTRY-REVERSED            VALUE 'R'.
  3734             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  3735             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  3736         16  PB-RECORD-BILL               PIC X.
  3737             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  3738             88  PB-RECORD-RETURNED           VALUE 'R'.
  3739             88  PB-RECORD-ENDORSED           VALUE 'E'.
  3740             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  3741             88  PB-OVERRIDE-AH               VALUE 'A'.
  3742             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  3743         16  PB-BATCH-ENTRY               PIC X.
  3744             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  3745             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  3746             88  PB-REISSUED-CERT             VALUE 'E'.
  3747             88  PB-CASH-CERT                 VALUE 'C'.
  3748             88  PB-MONTHLY-CERT              VALUE 'M'.
  3749             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  3750             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  3751             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  3752         16  PB-FORCE-CODE                PIC X.
  3753             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  3754             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  3755             88  PB-CANCEL-FORCE              VALUE '8'.
  3756             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  3757             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  3758             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  3759             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  3760             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  3761             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  3762             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  3763         16  PB-FATAL-FLAG                PIC X.
  3764             88  PB-FATAL-ERRORS              VALUE 'X'.
  3765         16  PB-FORCE-ER-CD               PIC X.
  3766             88  PB-FORCE-ERRORS              VALUE 'F'.
  3767             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  3768         16  PB-WARN-ER-CD                PIC X.
  3769             88  PB-WARNING-ERRORS            VALUE 'W'.
  3770         16  FILLER                       PIC X.
  3771         16  PB-OUT-BAL-CD                PIC X.
  3772             88  PB-OUT-OF-BAL                VALUE 'O'.
  3773         16  PB-LIFE-OVERRIDE-L1          PIC X.
  3774         16  PB-AH-OVERRIDE-L1            PIC X.
  3775         16  PB-INPUT-DT                  PIC XX.
  3776         16  PB-INPUT-BY                  PIC X(4).
  3777         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  3778         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  3779         16  PB-TOLERANCE-REJECT-SW       PIC X.
  3780         16  PB-LF-EARNING-METHOD         PIC X.
  3781         16  PB-AH-EARNING-METHOD         PIC X.
  3782         16  PB-LF-TERM-CALC-METHOD       PIC X.
  3783         16  PB-AH-TERM-CALC-METHOD       PIC X.
  3784         16  PB-REIN-CD                   PIC XXX.
  3785         16  PB-LF-REFUND-TYPE            PIC X.
  3786         16  PB-AH-REFUND-TYPE            PIC X.
  3787         16  PB-ACCT-EFF-DT               PIC XX.
  3788         16  PB-ACCT-EXP-DT               PIC XX.
  3789         16  PB-COMPANY-ID                PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  74
* EL630.cbl
  3790         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3791         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3792         16  PB-SV-CARRIER                PIC X.
  3793         16  PB-SV-GROUPING               PIC X(6).
  3794         16  PB-SV-STATE                  PIC XX.
  3795         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  3796         16  PB-GA-BILLING-INFO.
  3797             20  PB-GA-BILL-DT OCCURS 5 TIMES
  3798                                          PIC XX.
  3799         16  PB-SV-REMIT-TO  REDEFINES
  3800             PB-GA-BILLING-INFO           PIC X(10).
  3801         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  3802         16  PB-I-LOAN-OFFICER            PIC X(5).
  3803         16  PB-I-VIN                     PIC X(17).
  3804
  3805         16  FILLER                       PIC X(04).
  3806         16  IMNET-BYPASS-SW              PIC X.
  3807
  3808******************************************************************
  3809*                COMMON EDIT ERRORS                              *
  3810******************************************************************
  3811
  3812     12  PB-COMMON-ERRORS.
  3813         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  3814                                           PIC S9(4)     COMP.
  3815
  3816******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  75
* EL630.cbl
  3818*    COPY ERCACCT.
  3819******************************************************************
  3820*                                                                *
  3821*                                                                *
  3822*                            ERCACCT                             *
  3823*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3824*                            VMOD=2.031                          *
  3825*                                                                *
  3826*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3827*                                                                *
  3828*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3829*   VSAM ACCOUNT MASTER FILES.                                   *
  3830*                                                                *
  3831*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3832*                                                                *
  3833*   FILE TYPE = VSAM,KSDS                                        *
  3834*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3835*                                                                *
  3836*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3837*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3838*                                                                *
  3839*   LOG = NO                                                     *
  3840*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3841*                                                                *
  3842*                                                                *
  3843******************************************************************
  3844*                   C H A N G E   L O G
  3845*
  3846* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3847*-----------------------------------------------------------------
  3848*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3849* EFFECTIVE    NUMBER
  3850*-----------------------------------------------------------------
  3851* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3852* 092705    2005050300006  PEMA  ADD SPP LEASES
  3853* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3854* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3855* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3856* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3857* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3858******************************************************************
  3859
  3860 01  ACCOUNT-MASTER.
  3861     12  AM-RECORD-ID                      PIC XX.
  3862         88  VALID-AM-ID                      VALUE 'AM'.
  3863
  3864     12  AM-CONTROL-PRIMARY.
  3865         16  AM-COMPANY-CD                 PIC X.
  3866         16  AM-MSTR-CNTRL.
  3867             20  AM-CONTROL-A.
  3868                 24  AM-CARRIER            PIC X.
  3869                 24  AM-GROUPING.
  3870                     28 AM-GROUPING-PREFIX PIC XXX.
  3871                     28 AM-GROUPING-PRIME  PIC XXX.
  3872                 24  AM-STATE              PIC XX.
  3873                 24  AM-ACCOUNT.
  3874                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3875                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  76
* EL630.cbl
  3876             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3877                                           PIC X(19).
  3878             20  AM-CNTRL-B.
  3879                 24  AM-EXPIRATION-DT      PIC XX.
  3880                 24  FILLER                PIC X(4).
  3881             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3882                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3883
  3884     12  AM-CONTROL-BY-VAR-GRP.
  3885         16  AM-COMPANY-CD-A1              PIC X.
  3886         16  AM-VG-CARRIER                 PIC X.
  3887         16  AM-VG-GROUPING                PIC X(6).
  3888         16  AM-VG-STATE                   PIC XX.
  3889         16  AM-VG-ACCOUNT                 PIC X(10).
  3890         16  AM-VG-DATE.
  3891             20  AM-VG-EXPIRATION-DT       PIC XX.
  3892             20  FILLER                    PIC X(4).
  3893         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3894                                           PIC 9(11)      COMP-3.
  3895     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3896         16  FILLER                        PIC X(10).
  3897         16  AM-VG-KEY3.
  3898             20  AM-VG3-ACCOUNT            PIC X(10).
  3899             20  AM-VG3-EXP-DT             PIC XX.
  3900         16  FILLER                        PIC X(4).
  3901     12  AM-MAINT-INFORMATION.
  3902         16  AM-LAST-MAINT-DT              PIC XX.
  3903         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3904         16  AM-LAST-MAINT-USER            PIC X(4).
  3905         16  FILLER                        PIC XX.
  3906
  3907     12  AM-EFFECTIVE-DT                   PIC XX.
  3908     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3909
  3910     12  AM-PREV-DATES  COMP-3.
  3911         16  AM-PREV-EXP-DT                PIC 9(11).
  3912         16  AM-PREV-EFF-DT                PIC 9(11).
  3913
  3914     12  AM-REPORT-CODE-1                  PIC X(10).
  3915     12  AM-REPORT-CODE-2                  PIC X(10).
  3916
  3917     12  AM-CITY-CODE                      PIC X(4).
  3918     12  AM-COUNTY-PARISH                  PIC X(6).
  3919
  3920     12  AM-NAME                           PIC X(30).
  3921     12  AM-PERSON                         PIC X(30).
  3922     12  AM-ADDRS                          PIC X(30).
  3923     12  AM-CITY.
  3924         16  AM-ADDR-CITY                  PIC X(28).
  3925         16  AM-ADDR-STATE                 PIC XX.
  3926     12  AM-ZIP.
  3927         16  AM-ZIP-PRIME.
  3928             20  AM-ZIP-PRI-1ST            PIC X.
  3929                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3930             20  FILLER                    PIC X(4).
  3931         16  AM-ZIP-PLUS4                  PIC X(4).
  3932     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3933         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  77
* EL630.cbl
  3934         16  AM-CAN-POSTAL-2               PIC XXX.
  3935         16  FILLER                        PIC XXX.
  3936     12  AM-TEL-NO.
  3937         16  AM-AREA-CODE                  PIC 999.
  3938         16  AM-TEL-PRE                    PIC 999.
  3939         16  AM-TEL-NBR                    PIC 9(4).
  3940     12  AM-TEL-LOC                        PIC X.
  3941         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3942         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3943
  3944     12  AM-COMM-STRUCTURE.
  3945         16  AM-DEFN-1.
  3946             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3947                 24  AM-AGT.
  3948                     28  AM-AGT-PREFIX     PIC X(4).
  3949                     28  AM-AGT-PRIME      PIC X(6).
  3950                 24  AM-COM-TYP            PIC X.
  3951                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3952                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3953                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3954                 24  AM-RECALC-LV-INDIC    PIC X.
  3955                 24  AM-RETRO-LV-INDIC     PIC X.
  3956                 24  AM-GL-CODES           PIC X.
  3957                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3958                 24  FILLER                PIC X(01).
  3959         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3960             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3961                 24  FILLER                PIC X(11).
  3962                 24  AM-L-COMA             PIC XXX.
  3963                 24  AM-J-COMA             PIC XXX.
  3964                 24  AM-A-COMA             PIC XXX.
  3965                 24  FILLER                PIC X(6).
  3966
  3967     12  AM-COMM-CHANGE-STATUS             PIC X.
  3968         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3969
  3970     12  AM-CSR-CODE                       PIC X(4).
  3971
  3972     12  AM-BILLING-STATUS                 PIC X.
  3973         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3974         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3975     12  AM-AUTO-REFUND-SW                 PIC X.
  3976         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3977         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3978     12  AM-GPCD                           PIC 99.
  3979     12  AM-IG                             PIC X.
  3980         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3981         88  AM-HAS-GROUP                     VALUE '2'.
  3982     12  AM-STATUS                         PIC X.
  3983         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3984         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3985         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3986         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3987         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3988         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3989     12  AM-REMIT-TO                       PIC 99.
  3990     12  AM-ID-NO                          PIC X(11).
  3991
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  78
* EL630.cbl
  3992     12  AM-CAL-TABLE                      PIC XX.
  3993     12  AM-LF-DEVIATION                   PIC XXX.
  3994     12  AM-AH-DEVIATION                   PIC XXX.
  3995     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3996     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3997     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3998     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3999     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4000     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4001
  4002     12  AM-USER-FIELDS.
  4003         16  AM-FLD-1                      PIC XX.
  4004         16  AM-FLD-2                      PIC XX.
  4005         16  AM-FLD-3                      PIC XX.
  4006         16  AM-FLD-4                      PIC XX.
  4007         16  AM-FLD-5                      PIC XX.
  4008
  4009     12  AM-1ST-PROD-DATE.
  4010         16  AM-1ST-PROD-YR                PIC XX.
  4011         16  AM-1ST-PROD-MO                PIC XX.
  4012         16  AM-1ST-PROD-DA                PIC XX.
  4013     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4014     12  AM-CERTS-PURGED-DATE.
  4015         16  AM-PUR-YR                     PIC XX.
  4016         16  AM-PUR-MO                     PIC XX.
  4017         16  AM-PUR-DA                     PIC XX.
  4018     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4019     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4020     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4021     12  AM-INACTIVE-DATE.
  4022         16  AM-INA-MO                     PIC 99.
  4023         16  AM-INA-DA                     PIC 99.
  4024         16  AM-INA-YR                     PIC 99.
  4025     12  AM-AR-HI-CERT-DATE                PIC XX.
  4026
  4027     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4028     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4029
  4030     12  AM-OB-PAYMENT-MODE                PIC X.
  4031         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4032         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4033         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4034         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4035
  4036     12  AM-AH-ONLY-INDICATOR              PIC X.
  4037         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4038         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4039
  4040     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4041
  4042     12  AM-OVER-SHORT.
  4043         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4044         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4045
  4046     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4047     12  AM-DCC-CLP-STATE                  PIC XX.
  4048
  4049     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  79
* EL630.cbl
  4050     12  AM-RECALC-REIN                    PIC X.
  4051
  4052     12  AM-REI-TABLE                      PIC XXX.
  4053     12  AM-REI-ET-LF                      PIC X.
  4054     12  AM-REI-ET-AH                      PIC X.
  4055     12  AM-REI-PE-LF                      PIC X.
  4056     12  AM-REI-PE-AH                      PIC X.
  4057     12  AM-REI-PRT-ST                     PIC X.
  4058     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4059     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4060     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4061     12  AM-REI-GROUP-A                    PIC X(6).
  4062     12  AM-REI-MORT                       PIC X(4).
  4063     12  AM-REI-PRT-OW                     PIC X.
  4064     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4065     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4066     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4067     12  AM-REI-GROUP-B                    PIC X(6).
  4068
  4069     12  AM-TRUST-TYPE                     PIC X(2).
  4070
  4071     12  AM-EMPLOYER-STMT-USED             PIC X.
  4072     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4073
  4074     12  AM-STD-AH-TYPE                    PIC XX.
  4075     12  AM-EARN-METHODS.
  4076         16  AM-EARN-METHOD-R              PIC X.
  4077             88 AM-REF-RL-R78                 VALUE 'R'.
  4078             88 AM-REF-RL-PR                  VALUE 'P'.
  4079             88 AM-REF-RL-MEAN                VALUE 'M'.
  4080             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4081         16  AM-EARN-METHOD-L              PIC X.
  4082             88 AM-REF-LL-R78                 VALUE 'R'.
  4083             88 AM-REF-LL-PR                  VALUE 'P'.
  4084             88 AM-REF-LL-MEAN                VALUE 'M'.
  4085             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4086         16  AM-EARN-METHOD-A              PIC X.
  4087             88 AM-REF-AH-R78                 VALUE 'R'.
  4088             88 AM-REF-AH-PR                  VALUE 'P'.
  4089             88 AM-REF-AH-MEAN                VALUE 'M'.
  4090             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4091             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4092             88 AM-REF-AH-NET                 VALUE 'N'.
  4093
  4094     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4095     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4096     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4097
  4098     12  AM-RET-Y-N                        PIC X.
  4099     12  AM-RET-P-E                        PIC X.
  4100     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4101     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4102     12  AM-RET-GRP                        PIC X(6).
  4103     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4104         16  AM-POOL-PRIME                 PIC XXX.
  4105         16  AM-POOL-SUB                   PIC XXX.
  4106     12  AM-RETRO-EARNINGS.
  4107         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  80
* EL630.cbl
  4108         16  AM-RET-EARN-L                 PIC X.
  4109         16  AM-RET-EARN-A                 PIC X.
  4110     12  AM-RET-ST-TAX-USE                 PIC X.
  4111         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4112         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4113     12  AM-RETRO-BEG-EARNINGS.
  4114         16  AM-RET-BEG-EARN-R             PIC X.
  4115         16  AM-RET-BEG-EARN-L             PIC X.
  4116         16  AM-RET-BEG-EARN-A             PIC X.
  4117     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4118     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4119
  4120     12  AM-USER-SELECT-OPTIONS.
  4121         16  AM-USER-SELECT-1              PIC X(10).
  4122         16  AM-USER-SELECT-2              PIC X(10).
  4123         16  AM-USER-SELECT-3              PIC X(10).
  4124         16  AM-USER-SELECT-4              PIC X(10).
  4125         16  AM-USER-SELECT-5              PIC X(10).
  4126
  4127     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4128
  4129     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4130
  4131     12  AM-RPT045A-SWITCH                 PIC X.
  4132         88  RPT045A-OFF                   VALUE 'N'.
  4133
  4134     12  AM-INSURANCE-LIMITS.
  4135         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4136         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4137
  4138     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4139         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4140
  4141     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4142         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4143         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4144
  4145     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4146
  4147     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4148     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4149     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4150     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4151     12  AM-DCC-UEF-STATE                  PIC XX.
  4152     12  FILLER                            PIC XXX.
  4153     12  AM-REPORT-CODE-3                  PIC X(10).
  4154*    12  FILLER                            PIC X(22).
  4155
  4156     12  AM-RESERVE-DATE.
  4157         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4158         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4159         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4160
  4161     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4162     12  AM-NOTIFICATION-TYPES.
  4163         16  AM-NOTIF-OF-LETTERS           PIC X.
  4164         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4165         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  81
* EL630.cbl
  4166         16  AM-NOTIF-OF-STATUS            PIC X.
  4167
  4168     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4169         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4170         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4171         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4172         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4173
  4174     12  AM-BENEFIT-CONTROLS.
  4175         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4176             20  AM-BENEFIT-CODE           PIC XX.
  4177             20  AM-BENEFIT-TYPE           PIC X.
  4178             20  AM-BENEFIT-REVISION       PIC XXX.
  4179             20  AM-BENEFIT-REM-TERM       PIC X.
  4180             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4181             20  FILLER                    PIC XX.
  4182         16  FILLER                        PIC X(80).
  4183
  4184     12  AM-TRANSFER-DATA.
  4185         16  AM-TRANSFERRED-FROM.
  4186             20  AM-TRNFROM-CARRIER        PIC X.
  4187             20  AM-TRNFROM-GROUPING.
  4188                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4189                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4190             20  AM-TRNFROM-STATE          PIC XX.
  4191             20  AM-TRNFROM-ACCOUNT.
  4192                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4193                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4194             20  AM-TRNFROM-DTE            PIC XX.
  4195         16  AM-TRANSFERRED-TO.
  4196             20  AM-TRNTO-CARRIER          PIC X.
  4197             20  AM-TRNTO-GROUPING.
  4198                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4199                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4200             20  AM-TRNTO-STATE            PIC XX.
  4201             20  AM-TRNTO-ACCOUNT.
  4202                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4203                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4204             20  AM-TRNTO-DTE              PIC XX.
  4205         16  FILLER                        PIC X(10).
  4206
  4207     12  AM-SAVED-REMIT-TO                 PIC 99.
  4208
  4209     12  AM-COMM-STRUCTURE-SAVED.
  4210         16  AM-DEFN-1-SAVED.
  4211             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4212                 24  AM-AGT-SV             PIC X(10).
  4213                 24  AM-COM-TYP-SV         PIC X.
  4214                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4215                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4216                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4217                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4218                 24  FILLER                PIC X.
  4219                 24  AM-GL-CODES-SV        PIC X.
  4220                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4221                 24  FILLER                PIC X.
  4222         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4223             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  82
* EL630.cbl
  4224                 24  FILLER                PIC X(11).
  4225                 24  AM-L-COMA-SV          PIC XXX.
  4226                 24  AM-J-COMA-SV          PIC XXX.
  4227                 24  AM-A-COMA-SV          PIC XXX.
  4228                 24  FILLER                PIC X(6).
  4229
  4230     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4231         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4232            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4233            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4234            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4235
  4236     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4237     12  FILLER                            PIC X(120).
  4238
  4239     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4240         16  AM-CONTROL-NAME               PIC X(30).
  4241         16  AM-EXECUTIVE-ONE.
  4242             20  AM-EXEC1-NAME             PIC X(15).
  4243             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4244                                                          COMP-3.
  4245             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4246                                                          COMP-3.
  4247         16  AM-EXECUTIVE-TWO.
  4248             20  AM-EXEC2-NAME             PIC X(15).
  4249             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4250                                                          COMP-3.
  4251             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4252                                                          COMP-3.
  4253
  4254     12  AM-RETRO-ADDITIONAL-DATA.
  4255         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4256         16  AM-RETRO-PREM-P-E             PIC X.
  4257         16  AM-RETRO-CLMS-P-I             PIC X.
  4258         16  AM-RETRO-RET-BRACKET-LF.
  4259             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4260                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4261                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4262             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4263                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4264                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4265             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4266                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4267                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4268         16  AM-RETRO-RET-BRACKET-AH.
  4269             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4270                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4271                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4272                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4273             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4274                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4275                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4276             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4277                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4278                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4279
  4280     12  AM-COMMENTS.
  4281         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  83
* EL630.cbl
  4282
  4283     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4284         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4285         16  AM-FLI-BILLING-CODE           PIC X.
  4286         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4287         16  AM-FLI-UNITED-IDENT           PIC X.
  4288         16  AM-FLI-INTEREST-LOST-DATA.
  4289             20  AM-FLI-BANK-NO            PIC X(5).
  4290             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4291             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4292             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4293         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4294             20  AM-FLI-AGT                PIC X(9).
  4295             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4296             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4297         16  FILLER                        PIC X(102).
  4298
  4299     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4300         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4301             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4302             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4303             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4304             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4305             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4306         16  FILLER                          PIC X(10).
  4307******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  84
* EL630.cbl
  4309*    COPY ELCCERT.
  4310******************************************************************
  4311*                                                                *
  4312*                            ELCCERT.                            *
  4313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4314*                            VMOD=2.013                          *
  4315*                                                                *
  4316*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4317*                                                                *
  4318*   FILE TYPE = VSAM,KSDS                                        *
  4319*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4320*                                                                *
  4321*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4322*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4323*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4324*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4325*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4326*                                                                *
  4327*   LOG = YES                                                    *
  4328*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4329******************************************************************
  4330*                   C H A N G E   L O G
  4331*
  4332* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4333*-----------------------------------------------------------------
  4334*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4335* EFFECTIVE    NUMBER
  4336*-----------------------------------------------------------------
  4337* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4338* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4339* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4340* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4341* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4342* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4343* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4344* 032612  CR2011110200001  PEMA  AHL CHANGES
  4345******************************************************************
  4346
  4347 01  CERTIFICATE-MASTER.
  4348     12  CM-RECORD-ID                      PIC XX.
  4349         88  VALID-CM-ID                      VALUE 'CM'.
  4350
  4351     12  CM-CONTROL-PRIMARY.
  4352         16  CM-COMPANY-CD                 PIC X.
  4353         16  CM-CARRIER                    PIC X.
  4354         16  CM-GROUPING.
  4355             20  CM-GROUPING-PREFIX        PIC X(3).
  4356             20  CM-GROUPING-PRIME         PIC X(3).
  4357         16  CM-STATE                      PIC XX.
  4358         16  CM-ACCOUNT.
  4359             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4360             20  CM-ACCOUNT-PRIME          PIC X(6).
  4361         16  CM-CERT-EFF-DT                PIC XX.
  4362         16  CM-CERT-NO.
  4363             20  CM-CERT-PRIME             PIC X(10).
  4364             20  CM-CERT-SFX               PIC X.
  4365
  4366     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  85
* EL630.cbl
  4367         16  CM-COMPANY-CD-A1              PIC X.
  4368         16  CM-INSURED-LAST-NAME          PIC X(15).
  4369         16  CM-INSURED-INITIALS.
  4370             20  CM-INSURED-INITIAL1       PIC X.
  4371             20  CM-INSURED-INITIAL2       PIC X.
  4372
  4373     12  CM-CONTROL-BY-SSN.
  4374         16  CM-COMPANY-CD-A2              PIC X.
  4375         16  CM-SOC-SEC-NO.
  4376             20  CM-SSN-STATE              PIC XX.
  4377             20  CM-SSN-ACCOUNT            PIC X(6).
  4378             20  CM-SSN-LN3.
  4379                 25  CM-INSURED-INITIALS-A2.
  4380                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4381                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4382                 25 CM-PART-LAST-NAME-A2         PIC X.
  4383
  4384     12  CM-CONTROL-BY-CERT-NO.
  4385         16  CM-COMPANY-CD-A4              PIC X.
  4386         16  CM-CERT-NO-A4                 PIC X(11).
  4387
  4388     12  CM-CONTROL-BY-MEMB.
  4389         16  CM-COMPANY-CD-A5              PIC X.
  4390         16  CM-MEMBER-NO.
  4391             20  CM-MEMB-STATE             PIC XX.
  4392             20  CM-MEMB-ACCOUNT           PIC X(6).
  4393             20  CM-MEMB-LN4.
  4394                 25  CM-INSURED-INITIALS-A5.
  4395                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4396                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4397                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4398
  4399     12  CM-INSURED-PROFILE-DATA.
  4400         16  CM-INSURED-FIRST-NAME.
  4401             20  CM-INSURED-1ST-INIT       PIC X.
  4402             20  FILLER                    PIC X(9).
  4403         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4404         16  CM-INSURED-SEX                PIC X.
  4405             88  CM-SEX-MALE                  VALUE 'M'.
  4406             88  CM-SEX-FEMAL                 VALUE 'F'.
  4407         16  CM-INSURED-JOINT-AGE          PIC 99.
  4408         16  CM-JOINT-INSURED-NAME.
  4409             20  CM-JT-LAST-NAME           PIC X(15).
  4410             20  CM-JT-FIRST-NAME.
  4411                 24  CM-JT-1ST-INIT        PIC X.
  4412                 24  FILLER                PIC X(9).
  4413             20  CM-JT-INITIAL             PIC X.
  4414
  4415     12  CM-LIFE-DATA.
  4416         16  CM-LF-BENEFIT-CD              PIC XX.
  4417         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4418         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4419         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4420         16  CM-LF-DEV-CODE                PIC XXX.
  4421         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4422         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4423         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4424         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  86
* EL630.cbl
  4425         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4426         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4427         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4428         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4429         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4430         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4431         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4432         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4433         16  cm-temp-epiq                  pic xx.
  4434             88  EPIQ-CLASS                  value 'EQ'.
  4435*        16  FILLER                        PIC XX.
  4436
  4437     12  CM-AH-DATA.
  4438         16  CM-AH-BENEFIT-CD              PIC XX.
  4439         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4440         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4441         16  CM-AH-DEV-CODE                PIC XXX.
  4442         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4443         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4444         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4445         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4446         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4447         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4448         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4449         16  CM-AH-PAID-THRU-DT            PIC XX.
  4450             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4451         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4452         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4453         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4454         16  FILLER                        PIC X.
  4455
  4456     12  CM-LOAN-INFORMATION.
  4457         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4458         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4459                                           PIC S9(5)V99  COMP-3.
  4460         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4461         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4462         16  CM-PAY-FREQUENCY              PIC S99.
  4463         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4464         16  CM-RATE-CLASS                 PIC XX.
  4465         16  CM-BENEFICIARY                PIC X(25).
  4466         16  CM-POLICY-FORM-NO             PIC X(12).
  4467         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4468         16  CM-LAST-ADD-ON-DT             PIC XX.
  4469         16  CM-DEDUCTIBLE-AMOUNTS.
  4470             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4471             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4472         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4473             20  CM-RESIDENT-STATE         PIC XX.
  4474             20  CM-RATE-CODE              PIC X(4).
  4475             20  FILLER                    PIC XX.
  4476         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4477             20  CM-LOAN-OFFICER           PIC X(5).
  4478             20  FILLER                    PIC XXX.
  4479         16  CM-CSR-CODE                   PIC XXX.
  4480         16  CM-UNDERWRITING-CODE          PIC X.
  4481             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4482         16  CM-POST-CARD-IND              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  87
* EL630.cbl
  4483         16  CM-NH-INTERFACE-SW            PIC X.
  4484         16  CM-PREMIUM-TYPE               PIC X.
  4485             88  CM-SING-PRM                  VALUE '1'.
  4486             88  CM-O-B-COVERAGE              VALUE '2'.
  4487             88  CM-OPEN-END                  VALUE '3'.
  4488         16  CM-IND-GRP-TYPE               PIC X.
  4489             88  CM-INDIVIDUAL                VALUE 'I'.
  4490             88  CM-GROUP                     VALUE 'G'.
  4491         16  CM-SKIP-CODE                  PIC X.
  4492             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4493             88  SKIP-JULY                    VALUE '1'.
  4494             88  SKIP-AUGUST                  VALUE '2'.
  4495             88  SKIP-SEPTEMBER               VALUE '3'.
  4496             88  SKIP-JULY-AUG                VALUE '4'.
  4497             88  SKIP-AUG-SEPT                VALUE '5'.
  4498             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4499             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4500             88  SKIP-JUNE                    VALUE '8'.
  4501             88  SKIP-JUNE-JULY               VALUE '9'.
  4502             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4503             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4504         16  CM-PAYMENT-MODE               PIC X.
  4505             88  PAY-MONTHLY                  VALUE SPACE.
  4506             88  PAY-WEEKLY                   VALUE '1'.
  4507             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4508             88  PAY-BI-WEEKLY                VALUE '3'.
  4509             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4510         16  CM-LOAN-NUMBER                PIC X(8).
  4511         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4512         16  CM-OLD-LOF                    PIC XXX.
  4513*        16  CM-LOAN-OFFICER               PIC XXX.
  4514         16  CM-REIN-TABLE                 PIC XXX.
  4515         16  CM-SPECIAL-REIN-CODE          PIC X.
  4516         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4517         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4518         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4519
  4520     12  CM-STATUS-DATA.
  4521         16  CM-ENTRY-STATUS               PIC X.
  4522         16  CM-ENTRY-DT                   PIC XX.
  4523
  4524         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4525         16  CM-LF-CANCEL-DT               PIC XX.
  4526         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4527
  4528         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4529         16  CM-LF-DEATH-DT                PIC XX.
  4530         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4531
  4532         16  CM-LF-CURRENT-STATUS          PIC X.
  4533             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4534                                                'M' '4' '5' '9'.
  4535             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4536             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4537             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4538             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4539             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4540             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  88
* EL630.cbl
  4541             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4542             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4543             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4544             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4545             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4546             88  CM-LF-DECLINED               VALUE 'D'.
  4547             88  CM-LF-VOIDED                 VALUE 'V'.
  4548
  4549         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4550         16  CM-AH-CANCEL-DT               PIC XX.
  4551         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4552
  4553         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4554         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4555         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4556
  4557         16  CM-AH-CURRENT-STATUS          PIC X.
  4558             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4559                                                'M' '4' '5' '9'.
  4560             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4561             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4562             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4563             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4564             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4565             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4566             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4567             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4568             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4569             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4570             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4571             88  CM-AH-DECLINED               VALUE 'D'.
  4572             88  CM-AH-VOIDED                 VALUE 'V'.
  4573
  4574         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4575             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4576             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4577             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4578         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4579
  4580         16  CM-ENTRY-BATCH                PIC X(6).
  4581         16  CM-LF-EXIT-BATCH              PIC X(6).
  4582         16  CM-AH-EXIT-BATCH              PIC X(6).
  4583         16  CM-LAST-MONTH-END             PIC XX.
  4584
  4585     12  CM-NOTE-SW                        PIC X.
  4586         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4587         88  CERT-NOTES-PRESENT               VALUE '1'.
  4588         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4589         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4590         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4591         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4592         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4593         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4594     12  CM-COMP-EXCP-SW                   PIC X.
  4595         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4596         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4597     12  CM-INSURED-ADDRESS-SW             PIC X.
  4598         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  89
* EL630.cbl
  4599         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4600
  4601*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4602     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4603     12  FILLER                            PIC X.
  4604
  4605*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4606     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4607     12  FILLER                            PIC X.
  4608*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4609     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4610
  4611     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4612         88  CERT-ADDED-BATCH                 VALUE ' '.
  4613         88  CERT-ADDED-ONLINE                VALUE '1'.
  4614         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4615         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4616         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4617     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4618         88  CERT-AS-LOADED                   VALUE ' '.
  4619         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4620         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4621         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4622         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4623         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4624         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4625         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4626
  4627     12  CM-ACCOUNT-COMM-PCTS.
  4628         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4629         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4630
  4631     12  CM-USER-FIELD                     PIC X.
  4632     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4633     12  CM-CLP-STATE                      PIC XX.
  4634     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4635     12  CM-USER-RESERVED                  PIC XXX.
  4636     12  FILLER REDEFINES CM-USER-RESERVED.
  4637         16  CM-AH-CLASS-CD                PIC XX.
  4638         16  F                             PIC X.
  4639******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  90
* EL630.cbl
  4641*    COPY ERCNOTE.
  4642******************************************************************
  4643*                                                                *
  4644*                                                                *
  4645*                            ERCNOTE                             *
  4646*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4647*                            VMOD=2.003                          *
  4648*                                                                *
  4649*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  4650*                                                                *
  4651*        FILE TYPE= VSAM,KSDS                                    *
  4652*        RECORD SIZE = 825    RECFORM = FIXED                    *
  4653*                                                                *
  4654*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  4655*                                                                *
  4656*        LOG = YES                                               *
  4657*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  4658*                                                                *
  4659******************************************************************
  4660*                   C H A N G E   L O G
  4661*
  4662* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4663*-----------------------------------------------------------------
  4664*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4665* EFFECTIVE    NUMBER
  4666*-----------------------------------------------------------------
  4667* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  4668*                                FILE WILL CONTAIN BILLING NOTES O
  4669******************************************************************
  4670
  4671 01  CERTIFICATE-NOTE.
  4672     12  CN-RECORD-ID                PIC  XX.
  4673         88  VALID-CN-ID                  VALUE 'CN'.
  4674
  4675     12  CN-CONTROL-PRIMARY.
  4676         16  CN-COMPANY-CD           PIC X.
  4677         16  CN-CARRIER              PIC X.
  4678         16  CN-GROUPING.
  4679             20 CN-GROUPING-PREFIX   PIC XXX.
  4680             20 CN-GROUPING-PRIME    PIC XXX.
  4681         16  CN-STATE                PIC XX.
  4682         16  CN-ACCOUNT.
  4683             20 CN-ACCOUNT-PREFIX    PIC X(4).
  4684             20 CN-ACCOUNT-PRIME     PIC X(6).
  4685         16  CN-CERT-EFF-DT          PIC XX.
  4686         16  CN-CERT-NO.
  4687             20  CN-CERT-PRIME       PIC X(10).
  4688             20  CN-CERT-SFX         PIC X.
  4689
  4690     12  CN-BILLING-START-LINE-NO    PIC 99.
  4691     12  CN-BILLING-END-LINE-NO      PIC 99.
  4692
  4693     12  CN-LINES.
  4694         16  CN-LINE OCCURS 10       PIC X(77).
  4695
  4696     12  CN-LAST-MAINT-DT            PIC XX.
  4697     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  4698     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  91
* EL630.cbl
  4699     12  FILLER                      PIC X(6).
  4700******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  92
* EL630.cbl
  4702*    COPY ERCMAIL.
  4703******************************************************************
  4704*                                                                *
  4705*                                                                *
  4706*                            ERCMAIL                             *
  4707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4708*                            VMOD=2.003                          *
  4709*                                                                *
  4710*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  4711*                                                                *
  4712*   FILE TYPE = VSAM,KSDS                                        *
  4713*   RECORD SIZE = 374   RECFORM = FIX                            *
  4714*                                                                *
  4715*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  4716*   ALTERNATE PATH    = NOT USED                                 *
  4717*                                                                *
  4718*   LOG = YES                                                    *
  4719*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4720******************************************************************
  4721*                   C H A N G E   L O G
  4722*
  4723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4724*-----------------------------------------------------------------
  4725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4726* EFFECTIVE    NUMBER
  4727*-----------------------------------------------------------------
  4728* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  4729* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4730* 111108                   PEMA  ADD CRED BENE ADDR2
  4731******************************************************************
  4732
  4733 01  MAILING-DATA.
  4734     12  MA-RECORD-ID                      PIC XX.
  4735         88  VALID-MA-ID                       VALUE 'MA'.
  4736
  4737     12  MA-CONTROL-PRIMARY.
  4738         16  MA-COMPANY-CD                 PIC X.
  4739         16  MA-CARRIER                    PIC X.
  4740         16  MA-GROUPING.
  4741             20  MA-GROUPING-PREFIX        PIC XXX.
  4742             20  MA-GROUPING-PRIME         PIC XXX.
  4743         16  MA-STATE                      PIC XX.
  4744         16  MA-ACCOUNT.
  4745             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4746             20  MA-ACCOUNT-PRIME          PIC X(6).
  4747         16  MA-CERT-EFF-DT                PIC XX.
  4748         16  MA-CERT-NO.
  4749             20  MA-CERT-PRIME             PIC X(10).
  4750             20  MA-CERT-SFX               PIC X.
  4751
  4752     12  FILLER                            PIC XX.
  4753
  4754     12  MA-ACCESS-CONTROL.
  4755         16  MA-SOURCE-SYSTEM              PIC XX.
  4756             88  MA-FROM-CREDIT                VALUE 'CR'.
  4757             88  MA-FROM-VSI                   VALUE 'VS'.
  4758             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4759             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  93
* EL630.cbl
  4760         16  MA-RECORD-ADD-DT              PIC XX.
  4761         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4762         16  MA-LAST-MAINT-DT              PIC XX.
  4763         16  MA-LAST-MAINT-BY              PIC XXXX.
  4764         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4765
  4766     12  MA-PROFILE-INFO.
  4767         16  MA-QUALIFY-CODE-1             PIC XX.
  4768         16  MA-QUALIFY-CODE-2             PIC XX.
  4769         16  MA-QUALIFY-CODE-3             PIC XX.
  4770         16  MA-QUALIFY-CODE-4             PIC XX.
  4771         16  MA-QUALIFY-CODE-5             PIC XX.
  4772
  4773         16  MA-INSURED-LAST-NAME          PIC X(15).
  4774         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4775         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4776         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4777         16  MA-INSURED-BIRTH-DT           PIC XX.
  4778         16  MA-INSURED-SEX                PIC X.
  4779             88  MA-SEX-MALE                   VALUE 'M'.
  4780             88  MA-SEX-FEMALE                 VALUE 'F'.
  4781         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4782
  4783         16  MA-ADDRESS-CORRECTED          PIC X.
  4784         16  MA-JOINT-BIRTH-DT             PIC XX.
  4785*        16  FILLER                        PIC X(12).
  4786
  4787         16  MA-ADDRESS-LINE-1             PIC X(30).
  4788         16  MA-ADDRESS-LINE-2             PIC X(30).
  4789         16  MA-CITY-STATE.
  4790             20  MA-CITY                   PIC X(28).
  4791             20  MA-ADDR-STATE             PIC XX.
  4792         16  MA-ZIP.
  4793             20  MA-ZIP-CODE.
  4794                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4795                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4796                 24  FILLER                PIC X(4).
  4797             20  MA-ZIP-PLUS4              PIC X(4).
  4798         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4799             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4800             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4801             20  FILLER                    PIC X(3).
  4802
  4803         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4804
  4805         16  FILLER                        PIC XXX.
  4806*        16  FILLER                        PIC X(10).
  4807
  4808     12  MA-CRED-BENE-INFO.
  4809         16  MA-CRED-BENE-NAME                 PIC X(25).
  4810         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4811         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4812         16  MA-CRED-BENE-CTYST.
  4813             20  MA-CRED-BENE-CITY             PIC X(28).
  4814             20  MA-CRED-BENE-STATE            PIC XX.
  4815         16  MA-CRED-BENE-ZIP.
  4816             20  MA-CB-ZIP-CODE.
  4817                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  94
* EL630.cbl
  4818                     88  MA-CB-CANADIAN-POST-CODE
  4819                                           VALUE 'A' THRU 'Z'.
  4820                 24  FILLER                    PIC X(4).
  4821             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4822         16  MA-CB-CANADIAN-POSTAL-CODE
  4823                            REDEFINES MA-CRED-BENE-ZIP.
  4824             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4825             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4826             20  FILLER                        PIC X(3).
  4827     12  MA-POST-CARD-MAIL-DATA.
  4828         16  MA-MAIL-DATA OCCURS 7.
  4829             20  MA-MAIL-TYPE              PIC X.
  4830                 88  MA-12MO-MAILING           VALUE '1'.
  4831                 88  MA-EXP-MAILING            VALUE '2'.
  4832             20  MA-MAIL-STATUS            PIC X.
  4833                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4834                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4835                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4836             20  MA-MAIL-DATE              PIC XX.
  4837     12  FILLER                            PIC XX.
  4838     12  FILLER                            PIC XX.
  4839*    12  FILLER                            PIC X(30).
  4840******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  95
* EL630.cbl
  4842*    COPY ERCPNDM.
  4843******************************************************************
  4844*                                                                *
  4845*                                                                *
  4846*                            ERCPNDM                             *
  4847*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4848*                            VMOD=2.003                          *
  4849*                                                                *
  4850*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  4851*                                                                *
  4852*   FILE TYPE = VSAM,KSDS                                        *
  4853*   RECORD SIZE = 374   RECFORM = FIX                            *
  4854*                                                                *
  4855*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  4856*   ALTERNATE PATH    = NOT USED                                 *
  4857*                                                                *
  4858*   LOG = YES                                                    *
  4859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4860******************************************************************
  4861*                   C H A N G E   L O G
  4862*
  4863* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4864*-----------------------------------------------------------------
  4865*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4866* EFFECTIVE    NUMBER
  4867*-----------------------------------------------------------------
  4868* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  4869* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  4870* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4871******************************************************************
  4872
  4873 01  PENDING-MAILING-DATA.
  4874     12  PM-RECORD-ID                      PIC XX.
  4875         88  VALID-MA-ID                       VALUE 'PM'.
  4876
  4877     12  PM-CONTROL-PRIMARY.
  4878         16  PM-COMPANY-CD                 PIC X.
  4879         16  PM-ENTRY-BATCH                PIC X(6).
  4880         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  4881         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  4882
  4883     12  FILLER                            PIC X(14).
  4884
  4885     12  PM-ACCESS-CONTROL.
  4886         16  PM-SOURCE-SYSTEM              PIC XX.
  4887             88  PM-FROM-CREDIT                VALUE 'CR'.
  4888             88  PM-FROM-VSI                   VALUE 'VS'.
  4889             88  PM-FROM-WARRANTY              VALUE 'WA'.
  4890             88  PM-FROM-OTHER                 VALUE 'OT'.
  4891         16  PM-RECORD-ADD-DT              PIC XX.
  4892         16  PM-RECORD-ADDED-BY            PIC XXXX.
  4893         16  PM-LAST-MAINT-DT              PIC XX.
  4894         16  PM-LAST-MAINT-BY              PIC XXXX.
  4895         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4896
  4897     12  PM-PROFILE-INFO.
  4898         16  PM-QUALIFY-CODE-1             PIC XX.
  4899         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  96
* EL630.cbl
  4900         16  PM-QUALIFY-CODE-3             PIC XX.
  4901         16  PM-QUALIFY-CODE-4             PIC XX.
  4902         16  PM-QUALIFY-CODE-5             PIC XX.
  4903
  4904         16  PM-INSURED-LAST-NAME          PIC X(15).
  4905         16  PM-INSURED-FIRST-NAME         PIC X(10).
  4906         16  PM-INSURED-MIDDLE-INIT        PIC X.
  4907         16  PM-INSURED-ISSUE-AGE          PIC 99.
  4908         16  PM-INSURED-BIRTH-DT           PIC XX.
  4909         16  PM-INSURED-SEX                PIC X.
  4910             88  PM-SEX-MALE                   VALUE 'M'.
  4911             88  PM-SEX-FEMALE                 VALUE 'F'.
  4912         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  4913
  4914         16  PM-ADDRESS-CORRECTED          PIC X.
  4915         16  PM-JOINT-BIRTH-DT             PIC XX.
  4916*        16  FILLER                        PIC X(12).
  4917
  4918         16  PM-ADDRESS-LINE-1             PIC X(30).
  4919         16  PM-ADDRESS-LINE-2             PIC X(30).
  4920         16  PM-CITY-STATE.
  4921             20  PM-CITY                   PIC X(28).
  4922             20  PM-STATE                  PIC XX.
  4923         16  PM-ZIP.
  4924             20  PM-ZIP-CODE.
  4925                 24  PM-ZIP-1              PIC X.
  4926                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4927                 24  FILLER                PIC X(4).
  4928             20  PM-ZIP-PLUS4              PIC X(4).
  4929         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  4930             20  PM-CAN-POST1              PIC XXX.
  4931             20  PM-CAN-POST2              PIC XXX.
  4932             20  FILLER                    PIC XXX.
  4933
  4934         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  4935
  4936         16  FILLER                        PIC X(03).
  4937
  4938     12  PM-CRED-BENE-INFO.
  4939         16  PM-CRED-BENE-NAME             PIC X(25).
  4940         16  PM-CRED-BENE-ADDR             PIC X(30).
  4941         16  PM-CRED-BENE-ADDR2            PIC X(30).
  4942         16  PM-CRED-BENE-CTYST.
  4943             20  PM-CRED-BENE-CITY         PIC X(28).
  4944             20  PM-CRED-BENE-STATE        PIC XX.
  4945         16  PM-CRED-BENE-ZIP.
  4946             20  PM-CB-ZIP-CODE.
  4947                 24  PM-CB-ZIP-1           PIC X.
  4948                     88  PM-CB-CANADIAN-POST-CODE
  4949                                  VALUE 'A' THRU 'Z'.
  4950                 24  FILLER                PIC X(4).
  4951             20  PM-CB-ZIP-PLUS4           PIC X(4).
  4952         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  4953             20  PM-CB-CAN-POST1           PIC XXX.
  4954             20  PM-CB-CAN-POST2           PIC XXX.
  4955             20  FILLER                    PIC XXX.
  4956     12  PM-POST-CARD-MAIL-DATA.
  4957         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  97
* EL630.cbl
  4958             20  PM-MAIL-TYPE              PIC X.
  4959                 88  PM-12MO-MAILING           VALUE '1'.
  4960                 88  PM-EXP-MAILING            VALUE '2'.
  4961             20  PM-MAIL-STATUS            PIC X.
  4962                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  4963                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  4964                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  4965             20  PM-MAIL-DATE              PIC XX.
  4966     12  FILLER                            PIC XX.
  4967     12  FILLER                            PIC X(12).
  4968*    12  FILLER                            PIC X(30).
  4969
  4970******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  98
* EL630.cbl
  4972*    COPY ERCCOMP.
  4973******************************************************************
  4974*                                                                *
  4975*                                                                *
  4976*                            ERCCOMP                             *
  4977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4978*                            VMOD=2.019                          *
  4979*                                                                *
  4980*   ONLINE CREDIT SYSTEM                                         *
  4981*                                                                *
  4982*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4983*                                                                *
  4984*   FILE TYPE = VSAM,KSDS                                        *
  4985*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4986*                                                                *
  4987*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4988*       ALTERNATE PATH = NONE                                    *
  4989*                                                                *
  4990*   LOG = NO                                                     *
  4991*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4992*                                                                *
  4993******************************************************************
  4994*                   C H A N G E   L O G
  4995*
  4996* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4997*-----------------------------------------------------------------
  4998*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4999* EFFECTIVE    NUMBER
  5000*-----------------------------------------------------------------
  5001* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5002* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5003* 092205    2005050300006  PEMA  ADD LEASE FEE
  5004* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5005* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5006* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5007* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5008* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5009* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  5010******************************************************************
  5011
  5012 01  COMPENSATION-MASTER.
  5013     12  CO-RECORD-ID                          PIC XX.
  5014         88  VALID-CO-ID                          VALUE 'CO'.
  5015
  5016     12  CO-CONTROL-PRIMARY.
  5017         16  CO-COMPANY-CD                     PIC X.
  5018         16  CO-CONTROL.
  5019             20  CO-CTL-1.
  5020                 24  CO-CARR-GROUP.
  5021                     28  CO-CARRIER            PIC X.
  5022                     28  CO-GROUPING.
  5023                         32  CO-GROUP-PREFIX   PIC XXX.
  5024                         32  CO-GROUP-PRIME    PIC XXX.
  5025                 24  CO-RESP-NO.
  5026                     28  CO-RESP-PREFIX        PIC X(4).
  5027                     28  CO-RESP-PRIME         PIC X(6).
  5028             20  CO-CTL-2.
  5029                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  99
* EL630.cbl
  5030                     28  CO-ACCT-PREFIX        PIC X(4).
  5031                     28  CO-ACCT-PRIME         PIC X(6).
  5032         16  CO-TYPE                           PIC X.
  5033             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5034             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5035             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5036
  5037     12  CO-MAINT-INFORMATION.
  5038         16  CO-LAST-MAINT-DT                  PIC XX.
  5039         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5040         16  CO-LAST-MAINT-USER                PIC X(4).
  5041     12  FILLER                                PIC XX.
  5042     12  CO-STMT-TYPE                          PIC XXX.
  5043     12  CO-COMP-TYPE                          PIC X.
  5044         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5045     12  CO-STMT-OWNER                         PIC X(4).
  5046     12  CO-BALANCE-CONTROL                    PIC X.
  5047         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5048         88  CO-NO-BALANCE                        VALUE 'N'.
  5049
  5050     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5051         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5052         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5053         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5054
  5055     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5056         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5057         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5058
  5059     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5060     12  CO-GA-DIRECT-DEP                      PIC X.
  5061     12  CO-FUTURE-SPACE                       PIC X.
  5062         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5063
  5064     12  CO-ACCT-NAME                          PIC X(30).
  5065     12  CO-MAIL-NAME                          PIC X(30).
  5066     12  CO-ADDR-1                             PIC X(30).
  5067     12  CO-ADDR-2                             PIC X(30).
  5068     12  CO-ADDR-3.
  5069         16  CO-ADDR-CITY                      PIC X(27).
  5070         16  CO-ADDR-STATE                     PIC XX.
  5071     12  CO-CSO-1099                           PIC X.
  5072     12  CO-ZIP.
  5073         16  CO-ZIP-PRIME.
  5074             20  CO-ZIP-PRI-1ST                PIC X.
  5075                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5076             20  FILLER                        PIC X(4).
  5077         16  CO-ZIP-PLUS4                      PIC X(4).
  5078     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5079         16  CO-CAN-POSTAL-1                   PIC XXX.
  5080         16  CO-CAN-POSTAL-2                   PIC XXX.
  5081         16  FILLER                            PIC XXX.
  5082     12  CO-SOC-SEC                            PIC X(13).
  5083     12  CO-TELEPHONE.
  5084         16  CO-AREA-CODE                      PIC XXX.
  5085         16  CO-PREFIX                         PIC XXX.
  5086         16  CO-PHONE                          PIC X(4).
  5087
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 100
* EL630.cbl
  5088     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  5089
  5090     12  CO-AR-BAL-LEVEL                       PIC X.
  5091         88  CO-AR-REF-LVL                        VALUE '1'.
  5092         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5093         88  CO-AR-BILL-LVL                       VALUE '2'.
  5094         88  CO-AR-AGT-LVL                        VALUE '3'.
  5095         88  CO-AR-FR-LVL                         VALUE '4'.
  5096
  5097     12  CO-AR-NORMAL-PRINT                    PIC X.
  5098         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5099         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5100
  5101     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5102
  5103     12  CO-AR-REPORTING                       PIC X.
  5104         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5105         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5106
  5107     12  CO-AR-PULL-CHECK                      PIC X.
  5108         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5109         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5110
  5111     12  CO-AR-BALANCE-PRINT                   PIC X.
  5112         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5113
  5114     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5115         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5116         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5117         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5118
  5119     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5120
  5121     12  CO-USER-CODE                          PIC X.
  5122     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5123
  5124******************************************************************
  5125*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5126*    THE LAST MONTH END RUN.
  5127******************************************************************
  5128
  5129     12  CO-LAST-ACTIVITY-DATE.
  5130         16  CO-ACT-YEAR                       PIC 99.
  5131         16  CO-ACT-MONTH                      PIC 99.
  5132         16  CO-ACT-DAY                        PIC 99.
  5133
  5134     12  CO-LAST-STMT-DT.
  5135         16  CO-LAST-STMT-YEAR                 PIC 99.
  5136         16  CO-LAST-STMT-MONTH                PIC 99.
  5137         16  CO-LAST-STMT-DAY                  PIC 99.
  5138
  5139     12  CO-MO-END-TOTALS.
  5140         16  CO-MONTHLY-TOTALS.
  5141             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5142             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5143             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5144             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5145             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 101
* EL630.cbl
  5146
  5147         16  CO-AGING-TOTALS.
  5148             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5149             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5150             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5151             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5152
  5153         16  CO-YTD-TOTALS.
  5154             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5155             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5156
  5157         16  CO-OVER-UNDER-TOTALS.
  5158             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5159             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5160
  5161     12  CO-MISCELLANEOUS-TOTALS.
  5162         16  CO-FICA-TOTALS.
  5163             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5164             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5165
  5166         16  CO-CLAIM-TOTALS.
  5167             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5168             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5169
  5170******************************************************************
  5171*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5172*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5173******************************************************************
  5174
  5175     12  CO-CURRENT-TOTALS.
  5176         16  CO-CURRENT-LAST-STMT-DT.
  5177             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5178             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5179             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5180
  5181         16  CO-CURRENT-MONTHLY-TOTALS.
  5182             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5183             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5184             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5185             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5186             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5187
  5188         16  CO-CURRENT-AGING-TOTALS.
  5189             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5190             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5191             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5192             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5193
  5194         16  CO-CURRENT-YTD-TOTALS.
  5195             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5196             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5197
  5198     12  CO-PAID-COMM-TOTALS.
  5199         16  CO-YTD-PAID-COMMS.
  5200             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5201             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5202
  5203     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 102
* EL630.cbl
  5204         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  5205         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5206
  5207     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5208         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5209         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5210         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5211         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5212         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5213         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5214         88  CO-FINAL-LETTER                  VALUE 'F'.
  5215         88  CO-RECONCILING                   VALUE 'R'.
  5216         88  CO-PHONE-CALL                    VALUE 'P'.
  5217         88  CO-LEGAL                         VALUE 'L'.
  5218         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5219         88  CO-WRITE-OFF                     VALUE 'W'.
  5220         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5221
  5222     12  CO-CSR-CODE                       PIC X(4).
  5223
  5224     12  CO-GA-STATUS-INFO.
  5225         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5226         16  CO-GA-TERMINATION-DT          PIC XX.
  5227         16  CO-GA-STATUS-CODE             PIC X.
  5228             88  CO-GA-ACTIVE                 VALUE 'A'.
  5229             88  CO-GA-INACTIVE               VALUE 'I'.
  5230             88  CO-GA-PENDING                VALUE 'P'.
  5231         16  CO-GA-COMMENTS.
  5232             20  CO-GA-COMMENT-1           PIC X(40).
  5233             20  CO-GA-COMMENT-2           PIC X(40).
  5234             20  CO-GA-COMMENT-3           PIC X(40).
  5235             20  CO-GA-COMMENT-4           PIC X(40).
  5236
  5237     12  CO-RPTCD2                         PIC X(10).
  5238     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  5239         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  5240         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  5241
  5242     12  CO-TYPE-AGENT                     PIC X(01).
  5243         88  CO-CORPORATION                   VALUE 'C'.
  5244         88  CO-PARTNERSHIP                   VALUE 'P'.
  5245         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5246         88  CO-TRUST                         VALUE 'T'.
  5247         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5248
  5249     12  CO-FAXNO.
  5250         16  CO-FAX-AREA-CODE                  PIC XXX.
  5251         16  CO-FAX-PREFIX                     PIC XXX.
  5252         16  CO-FAX-PHONE                      PIC X(4).
  5253
  5254     12  CO-BANK-INFORMATION.
  5255         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5256         16  CO-BANK-TRANSIT-NON REDEFINES
  5257             CO-BANK-TRANSIT-NO                PIC 9(8).
  5258
  5259         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5260     12  CO-MISC-DEDUCT-INFO REDEFINES
  5261                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 103
* EL630.cbl
  5262         16  CO-MD-GL-ACCT                     PIC X(10).
  5263         16  CO-MD-DIV                         PIC XX.
  5264         16  CO-MD-CENTER                      PIC X(4).
  5265         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  5266         16  CO-CREATE-AP-CHECK                PIC X.
  5267         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5268         16  FILLER                            PIC XXX.
  5269     12  CO-ACH-STATUS                         PIC X.
  5270         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5271         88  CO-ACH-PENDING                        VALUE 'P'.
  5272
  5273     12  CO-BILL-SW                            PIC X.
  5274     12  CO-CONTROL-NAME                       PIC X(30).
  5275     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5276     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5277     12  CO-CLP-STATE                          PIC XX.
  5278     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5279     12  CO-SPP-REFUND-EDIT                    PIC X.
  5280
  5281******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 104
* EL630.cbl
  5283*    COPY ERCRQST.
  5284******************************************************************
  5285*                                                                *
  5286*                                                                *
  5287*                            ERCRQST.                            *
  5288*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5289*                            VMOD=2.002                          *
  5290*                                                                *
  5291*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5292*                                                                *
  5293*   FILE TYPE = VSAM,KSDS                                        *
  5294*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5295*                                                                *
  5296*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5297*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5298*                                   ACCOUNT, REF, BATCH)         *
  5299*                                                RKP=9, LEN=38   *
  5300*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5301*                                   ACCOUNT, REF, BATCH)         *
  5302*                                                RKP=47, LEN=46  *
  5303*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5304*                                   BATCH)                       *
  5305*                                                RKP=93, LEN=24  *
  5306*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5307*                                   REF, BATCH)                  *
  5308*                                                RKP=117, LEN=35 *
  5309*   LOG = NO                                                     *
  5310*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5311******************************************************************
  5312
  5313 01  AR-REQUEST-RECORD.
  5314     12  RQ-RECORD-ID                     PIC XX.
  5315         88  VALID-RQ-ID                        VALUE 'RQ'.
  5316
  5317     12  RQ-CONTROL-PRIMARY.
  5318         16  RQ-COMPANY-CD                PIC X.
  5319         16  RQ-ENTRY-BATCH               PIC X(6).
  5320
  5321     12  RQ-CONTROL-BY-ACCT-REF.
  5322         16  RQ-COMPANY-CD-A1             PIC X.
  5323         16  RQ-CARRIER-A1                PIC X.
  5324         16  RQ-GROUPING-A1               PIC X(6).
  5325         16  RQ-STATE-A1                  PIC XX.
  5326         16  RQ-ACCOUNT-A1                PIC X(10).
  5327         16  RQ-REFERENCE-A1              PIC X(12).
  5328         16  RQ-BATCH-A1                  PIC X(6).
  5329
  5330     12  RQ-CONTROL-BY-FIN-RESP.
  5331         16  RQ-COMPANY-CD-A2             PIC X.
  5332         16  RQ-CARRIER-A2                PIC X.
  5333         16  RQ-GROUPING-A2               PIC X(6).
  5334         16  RQ-FIN-RESP-A2               PIC X(10).
  5335         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5336         16  RQ-REFERENCE-A2              PIC X(12).
  5337         16  RQ-BATCH-A2                  PIC X(6).
  5338
  5339     12  RQ-CONTROL-BY-ACCT-AGENT.
  5340         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 105
* EL630.cbl
  5341         16  RQ-CARRIER-A3                PIC X.
  5342         16  RQ-GROUPING-A3               PIC X(6).
  5343         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5344         16  RQ-BATCH-A3                  PIC X(6).
  5345
  5346     12  RQ-CONTROL-BY-SUMMARY.
  5347         16  RQ-COMPANY-CD-A4             PIC X.
  5348         16  RQ-SUMMARY-CODE              PIC X(6).
  5349         16  RQ-ACCOUNT-A4                PIC X(10).
  5350         16  RQ-REFERENCE-A4              PIC X(12).
  5351         16  RQ-BATCH-A4                  PIC X(6).
  5352
  5353     12  RQ-REQUEST-METHOD                PIC X.
  5354         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5355         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5356         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5357         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5358     12  FILLER                           PIC X.
  5359     12  RQ-STATUS                        PIC X.
  5360         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5361         88  RQ-RESUBMIT                      VALUE 'R'.
  5362     12  RQ-PROCESSOR-ID                  PIC X(4).
  5363     12  RQ-ENTRY-DT                      PIC XX.
  5364     12  RQ-MO-END-DT                     PIC XX.
  5365     12  RQ-REQUEST-DT                    PIC XX.
  5366     12  RQ-STMT-DT                       PIC XX.
  5367     12  RQ-REVERSAL-DT                   PIC XX.
  5368     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5369     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5370
  5371     12  FILLER                           PIC X(27).
  5372
  5373******************************************************************
  5374
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 106
* EL630.cbl
  5376*    COPY ERCCNOT.
  5377******************************************************************
  5378*                                                                *
  5379*                            ERCCNOT                             *
  5380*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5381*                            VMOD=2.003                          *
  5382*                                                                *
  5383*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5384*                                                                *
  5385*        FILE TYPE= VSAM,KSDS                                    *
  5386*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5387*                                                                *
  5388*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5389*                                                                *
  5390*        LOG = YES                                               *
  5391*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5392*                                                                *
  5393******************************************************************
  5394*                   C H A N G E   L O G
  5395*
  5396* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5397*-----------------------------------------------------------------
  5398*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5399* EFFECTIVE    NUMBER
  5400*-----------------------------------------------------------------
  5401* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5402******************************************************************
  5403
  5404 01  CERT-NOTE-FILE.
  5405     12  CZ-RECORD-ID                PIC  XX.
  5406         88  VALID-CZ-ID                  VALUE 'CZ'.
  5407
  5408     12  CZ-CONTROL-PRIMARY.
  5409         16  CZ-COMPANY-CD           PIC X.
  5410         16  CZ-CARRIER              PIC X.
  5411         16  CZ-GROUPING.
  5412             20 CZ-GROUPING-PREFIX   PIC XXX.
  5413             20 CZ-GROUPING-PRIME    PIC XXX.
  5414         16  CZ-STATE                PIC XX.
  5415         16  CZ-ACCOUNT.
  5416             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5417             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5418         16  CZ-CERT-EFF-DT          PIC XX.
  5419         16  CZ-CERT-NO.
  5420             20  CZ-CERT-PRIME       PIC X(10).
  5421             20  CZ-CERT-SFX         PIC X.
  5422         16  CZ-RECORD-TYPE          PIC X.
  5423             88  CERT-NOTE           VALUE '1'.
  5424             88  CLAIM-CERT-NOTE     VALUE '2'.
  5425         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5426
  5427     12  CZ-LAST-MAINT-DT            PIC XX.
  5428     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5429     12  CZ-LAST-MAINT-USER          PIC X(4).
  5430
  5431     12  CZ-NOTE-INFORMATION.
  5432         16  CZ-NOTE                 PIC X(63).
  5433         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 107
* EL630.cbl
  5434******************************************************************
  5435
  5436 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5437                          PENDING-BUSINESS ACCOUNT-MASTER
  5438                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  5439                          MAILING-DATA PENDING-MAILING-DATA
  5440                          COMPENSATION-MASTER AR-REQUEST-RECORD
  5441                          CERT-NOTE-FILE.
  5442 0000-DFHEXIT SECTION.
  5443     MOVE '9#                    $   ' TO DFHEIV0.
  5444     MOVE 'EL630' TO DFHEIV1.
  5445     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5446
  5447     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5448     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  5449     IF EIBCALEN = 0
  5450         GO TO 8800-UNAUTHORIZED-ACCESS.
  5451
  5452     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5453     MOVE '5'                    TO DC-OPTION-CODE.
  5454     PERFORM 9700-DATE-LINK.
  5455
  5456     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  5457     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT.
  5458     MOVE DC-GREG-DATE-1-YMD     TO WS-CURRENT-YMD.
  5459
  5460     MOVE PI-CALLING-PROGRAM TO PI-SAVE-CALLING-PGM.
  5461     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5462         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5463             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5464             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5465             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5466             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5467             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5468             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5469             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5470             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5471             MOVE SPACES               TO PI-PROGRAM-WORK-AREA
  5472                                          PI-MISC
  5473         ELSE
  5474             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5475             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5476             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5477             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5478             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5479             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5480             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5481             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5482
  5483     MOVE LOW-VALUES             TO EL630AI.
  5484
  5485     IF PI-SAVE-CALLING-PGM = XCTL-6302
  5486         GO TO 4000-SHOW-TOTALS.
  5487
  5488     IF PI-SAVE-CALLING-PGM = XCTL-6301
  5489         MOVE 'N'                TO PI-EL630-FIRST-TIME-SW
  5490         IF (PI-CAN-CNT-REMITTED GREATER ZERO OR
  5491             PI-ISS-CNT-REMITTED GREATER ZERO)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 108
* EL630.cbl
  5492                 GO TO 4000-SHOW-TOTALS
  5493         ELSE
  5494         IF PI-ISS-CNT-ENTERED = ZEROS  AND
  5495            PI-CAN-CNT-ENTERED = ZEROS
  5496             MOVE 'Y'            TO PI-VERIFY-DELETE-SW
  5497             GO TO 3000-DELETE-ENTERED-BATCH
  5498         ELSE
  5499             GO TO 4000-SHOW-TOTALS.
  5500
  5501     IF EIBTRNID NOT = TRANS-ID
  5502         MOVE SPACE              TO PI-BROWSE-SW
  5503         MOVE ZEROS              TO PI-LAST-SEQ-NO-ADDED
  5504         MOVE SPACES             TO PI-CR-CONTROL-IN-PROGRESS
  5505         MOVE QUESTION-MARKS     TO BATCHI
  5506         MOVE AL-UANON           TO BATCHA
  5507         GO TO 8100-SEND-INITIAL-MAP.
  5508
  5509
  5510* EXEC CICS HANDLE CONDITION
  5511*        PGMIDERR  (9600-PGMID-ERROR)
  5512*        ERROR     (9990-ABEND)
  5513*    END-EXEC.
  5514*    MOVE '"$L.                  ! " #00005505' TO DFHEIV0
  5515     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5516     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5517     MOVE X'2220233030303035353035' TO DFHEIV0(25:11)
  5518     CALL 'kxdfhei1' USING DFHEIV0
  5519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5520
  5521
  5522     IF EIBAID = DFHCLEAR
  5523        MOVE SPACES              TO PI-ACCT-AGENT-PROCESSED-SW
  5524        GO TO 9400-CLEAR.
  5525
  5526     IF PI-PROCESSOR-ID = 'LGXX'
  5527         GO TO 0200-RECEIVE.
  5528
  5529
  5530* EXEC CICS READQ TS
  5531*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5532*        INTO   (SECURITY-CONTROL)
  5533*        LENGTH (SC-COMM-LENGTH)
  5534*        ITEM   (SC-ITEM)
  5535*    END-EXEC.
  5536*    MOVE '*$II   L              ''   #00005517' TO DFHEIV0
  5537     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5538     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5539     MOVE X'2020233030303035353137' TO DFHEIV0(25:11)
  5540     CALL 'kxdfhei1' USING DFHEIV0,
  5541           PI-SECURITY-TEMP-STORE-ID,
  5542           SECURITY-CONTROL,
  5543           SC-COMM-LENGTH,
  5544           SC-ITEM,
  5545           DFHEIV99,
  5546           DFHEIV99
  5547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5548
  5549
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 109
* EL630.cbl
  5550     MOVE SC-CREDIT-DISPLAY (11)  TO PI-DISPLAY-CAP.
  5551     MOVE SC-CREDIT-UPDATE  (11)  TO PI-MODIFY-CAP.
  5552
  5553     IF NOT DISPLAY-CAP
  5554         MOVE 'READ'          TO SM-READ
  5555         PERFORM 9995-SECURITY-VIOLATION
  5556                              THRU 9995-EXIT
  5557         MOVE ER-0070         TO  EMI-ERROR
  5558         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5559         GO TO 8100-SEND-INITIAL-MAP.
  5560
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 110
* EL630.cbl
  5562 0200-RECEIVE.
  5563     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5564         MOVE ER-0008            TO EMI-ERROR
  5565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5566         MOVE -1                 TO MAINTL
  5567         GO TO 8200-SEND-DATAONLY.
  5568
  5569
  5570* EXEC CICS RECEIVE
  5571*        MAP      (MAP-NAME)
  5572*        MAPSET   (MAPSET-NAME)
  5573*        INTO     (EL630AI)
  5574*    END-EXEC.
  5575     MOVE LENGTH OF
  5576      EL630AI
  5577       TO DFHEIV11
  5578*    MOVE '8"T I  L              ''   #00005543' TO DFHEIV0
  5579     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5580     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5581     MOVE X'2020233030303035353433' TO DFHEIV0(25:11)
  5582     CALL 'kxdfhei1' USING DFHEIV0,
  5583           MAP-NAME,
  5584           EL630AI,
  5585           DFHEIV11,
  5586           MAPSET-NAME,
  5587           DFHEIV99,
  5588           DFHEIV99
  5589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5590
  5591
  5592     IF PFENTERL = 0
  5593         GO TO 0300-CHECK-PFKEYS.
  5594
  5595     IF PFENTERI NUMERIC
  5596        IF PFENTERI GREATER 0 AND LESS 25
  5597           MOVE PF-VALUES (PFENTERI) TO EIBAID
  5598        ELSE
  5599           MOVE ER-0029            TO EMI-ERROR
  5600           GO TO 0320-INPUT-ERROR.
  5601
  5602 0300-CHECK-PFKEYS.
  5603     IF EIBAID = DFHENTER
  5604        IF PI-CLEAR-ERROR
  5605           MOVE -1                 TO PFENTERL
  5606           MOVE ER-2213            TO EMI-ERROR
  5607           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5608           GO TO 4000-SHOW-TOTALS.
  5609
  5610     IF EIBAID = DFHPF23
  5611         GO TO 8810-PF23.
  5612     IF EIBAID = DFHPF24
  5613         GO TO 9200-RETURN-MAIN-MENU.
  5614     IF EIBAID = DFHPF12
  5615         GO TO 9500-PF12.
  5616
  5617     IF EIBAID = DFHPF1
  5618        IF PI-DATA-UPDATED
  5619           MOVE 'Y'            TO WS-PF1-SW
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 111
* EL630.cbl
  5620           MOVE SPACE          TO PI-NB-MONTH-END-DT
  5621                                  PI-CLEAR-ERROR-SW
  5622           PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  5623           MOVE SPACES TO BATCH-TO-PROCESS
  5624           MOVE PI-COMPANY-ID  TO EDIT-COMPANY-ID
  5625           MOVE PI-COMPANY-CD  TO EDIT-COMPANY-CD
  5626           MOVE PI-SAV-ENTRY-BATCH TO EDIT-BATCH
  5627
  5628* EXEC CICS START
  5629*               TRANSID       (EDIT-TRANS)
  5630*               FROM          (BATCH-TO-PROCESS)
  5631*               LENGTH        (PASS-AREA-LEN)
  5632*          END-EXEC
  5633*    MOVE '0( LF                 1   #00005584' TO DFHEIV0
  5634     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  5635     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  5636     MOVE X'2020233030303035353834' TO DFHEIV0(25:11)
  5637     CALL 'kxdfhei1' USING DFHEIV0,
  5638           DFHEIV99,
  5639           EDIT-TRANS,
  5640           DFHEIV99,
  5641           BATCH-TO-PROCESS,
  5642           PASS-AREA-LEN,
  5643           DFHEIV99,
  5644           DFHEIV99,
  5645           DFHEIV99,
  5646           DFHEIV99,
  5647           DFHEIV99,
  5648           DFHEIV99,
  5649           DFHEIV99,
  5650           DFHEIV99,
  5651           DFHEIV99,
  5652           DFHEIV99,
  5653           DFHEIV99
  5654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5655           MOVE PI-SAV-REFERENCE TO PI-SAV-PYAJ-REFERENCE
  5656           MOVE SPACES         TO PI-UPDATE-SW
  5657                                  PI-KEYED-SWITCHES
  5658                                  PI-AGE-KEYED-SW
  5659                                  PI-BIRTHDT-KEYED-SW
  5660                                  PI-ACCT-AGENT-PROCESSED-SW
  5661                                  PI-SAV-REFERENCE
  5662           MOVE ZEROS          TO PI-ISS-CNT-ENTERED
  5663                                  PI-CAN-CNT-ENTERED
  5664           MOVE LOW-VALUES     TO EL630AO
  5665           MOVE SPACE          TO PI-BROWSE-SW
  5666           MOVE QUESTION-MARKS TO BATCHI
  5667           MOVE AL-UANON       TO BATCHA
  5668           MOVE -1             TO MAINTL
  5669           IF EMI-NO-ERRORS
  5670               MOVE ZEROS          TO EMI-ERROR
  5671               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5672               GO TO 8100-SEND-INITIAL-MAP
  5673           ELSE
  5674               GO TO 8100-SEND-INITIAL-MAP
  5675        ELSE
  5676           IF  MAINTI = 'N'
  5677               MOVE -1             TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 112
* EL630.cbl
  5678               MOVE ER-2211        TO EMI-ERROR
  5679               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5680               GO TO 8200-SEND-DATAONLY.
  5681
  5682     IF EIBAID = DFHPF1
  5683        MOVE SPACE          TO PI-NB-MONTH-END-DT
  5684                               PI-CLEAR-ERROR-SW
  5685        MOVE SPACES TO BATCH-TO-PROCESS
  5686        MOVE PI-COMPANY-ID  TO EDIT-COMPANY-ID
  5687        MOVE PI-COMPANY-CD  TO EDIT-COMPANY-CD
  5688        MOVE PI-SAV-ENTRY-BATCH TO EDIT-BATCH
  5689        IF EDIT-BATCH GREATER SPACES
  5690
  5691* EXEC CICS START
  5692*               TRANSID       (EDIT-TRANS)
  5693*               FROM          (BATCH-TO-PROCESS)
  5694*               LENGTH        (PASS-AREA-LEN)
  5695*            END-EXEC
  5696*    MOVE '0( LF                 1   #00005624' TO DFHEIV0
  5697     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  5698     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  5699     MOVE X'2020233030303035363234' TO DFHEIV0(25:11)
  5700     CALL 'kxdfhei1' USING DFHEIV0,
  5701           DFHEIV99,
  5702           EDIT-TRANS,
  5703           DFHEIV99,
  5704           BATCH-TO-PROCESS,
  5705           PASS-AREA-LEN,
  5706           DFHEIV99,
  5707           DFHEIV99,
  5708           DFHEIV99,
  5709           DFHEIV99,
  5710           DFHEIV99,
  5711           DFHEIV99,
  5712           DFHEIV99,
  5713           DFHEIV99,
  5714           DFHEIV99,
  5715           DFHEIV99,
  5716           DFHEIV99
  5717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5718             MOVE SPACES         TO PI-UPDATE-SW
  5719                                    PI-KEYED-SWITCHES
  5720                                    PI-AGE-KEYED-SW
  5721                                    PI-BIRTHDT-KEYED-SW
  5722                                    PI-ACCT-AGENT-PROCESSED-SW
  5723                                    PI-SAV-REFERENCE
  5724             MOVE ZEROS          TO PI-ISS-CNT-ENTERED
  5725                                    PI-CAN-CNT-ENTERED
  5726                                    EMI-ERROR
  5727             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5728             MOVE LOW-VALUES     TO EL630AO
  5729             MOVE SPACE          TO PI-BROWSE-SW
  5730             MOVE QUESTION-MARKS TO BATCHI
  5731             MOVE AL-UANON       TO BATCHA
  5732             MOVE -1             TO MAINTL
  5733             GO TO 8100-SEND-INITIAL-MAP
  5734        ELSE
  5735             MOVE -1             TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 113
* EL630.cbl
  5736             MOVE ER-2211        TO EMI-ERROR
  5737             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5738             GO TO 8200-SEND-DATAONLY.
  5739
  5740     IF EIBAID = DFHPF3
  5741         IF NOT PI-DATA-UPDATED
  5742             MOVE SPACE          TO PI-EL630-FIRST-TIME-SW
  5743             IF PI-AR-PROCESSING
  5744                MOVE XCTL-635       TO PGM-NAME
  5745                GO TO 9300-XCTL
  5746             ELSE
  5747                IF PI-COMPANY-ID = 'DMD'
  5748                   MOVE XCTL-633DMD TO PGM-NAME
  5749                   GO TO 9300-XCTL
  5750                ELSE
  5751                   MOVE XCTL-633    TO PGM-NAME
  5752                   GO TO 9300-XCTL
  5753         ELSE
  5754             MOVE -1             TO BATCHL
  5755             MOVE AL-UABON       TO BATCHA
  5756             MOVE ER-2213        TO EMI-ERROR
  5757             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5758             GO TO 8200-SEND-DATAONLY.
  5759
  5760     IF EIBAID = DFHPF4
  5761         IF NOT PI-EL630-FIRST-TIME
  5762             MOVE XCTL-6302      TO PGM-NAME
  5763             GO TO 9300-XCTL
  5764         ELSE
  5765             PERFORM 0400-PRIME-BATCH-TOTALS THRU 0490-EXIT
  5766             IF EMI-ERROR = ZEROS
  5767                 MOVE 'N'        TO PI-EL630-FIRST-TIME-SW
  5768                 MOVE XCTL-6302  TO PGM-NAME
  5769                 GO TO 9300-XCTL
  5770             ELSE
  5771                 GO TO 8200-SEND-DATAONLY.
  5772
  5773     IF EIBAID = DFHPF5
  5774             IF PI-EL630-FIRST-TIME
  5775                 MOVE -1         TO MAINTL
  5776                 GO TO 8200-SEND-DATAONLY
  5777             ELSE
  5778             IF PI-ISS-CNT-ENTERED = ZEROS  AND
  5779                PI-CAN-CNT-ENTERED = ZEROS
  5780                 MOVE LOW-VALUES TO     EL630AO
  5781                 MOVE QUESTION-MARKS TO BATCHI
  5782                 MOVE AL-UANON   TO     BATCHA
  5783                 MOVE -1         TO     MAINTL
  5784                 GO TO 8100-SEND-INITIAL-MAP
  5785             ELSE
  5786                 MOVE -1         TO BATCHL
  5787                 MOVE AL-UABON   TO BATCHA
  5788                 MOVE ER-2213    TO EMI-ERROR
  5789                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5790                 GO TO 4000-SHOW-TOTALS.
  5791
  5792     IF EIBAID = DFHPF2
  5793        MOVE  AL-UANON           TO  BATCHA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 114
* EL630.cbl
  5794        MOVE  BATCHI             TO PI-SAV-ENTRY-BATCH
  5795        GO TO 3000-DELETE-ENTERED-BATCH.
  5796
  5797     IF  MAINTI = 'S'
  5798         MOVE  MAINTI            TO  PI-MAINT-FUNC
  5799         PERFORM 0400-PRIME-BATCH-TOTALS  THRU  0490-EXIT
  5800             IF EMI-ERROR = ZEROS
  5801                 MOVE 'N'        TO PI-EL630-FIRST-TIME-SW
  5802                 GO TO 4000-SHOW-TOTALS
  5803             ELSE
  5804                 GO TO 8200-SEND-DATAONLY.
  5805
  5806     IF EIBAID = DFHENTER
  5807         GO TO 0330-EDIT-DATA.
  5808
  5809 0320-INPUT-ERROR.
  5810     MOVE ER-0029                TO EMI-ERROR.
  5811     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5812     MOVE AL-UNBON               TO PFENTERA.
  5813     IF PFENTERL = 0
  5814         MOVE -1                 TO MAINTL
  5815     ELSE
  5816         MOVE -1                 TO PFENTERL.
  5817
  5818     GO TO 8200-SEND-DATAONLY.
  5819
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 115
* EL630.cbl
  5821 0330-EDIT-DATA.
  5822     IF MODIFY-CAP
  5823         NEXT SENTENCE
  5824       ELSE
  5825         IF MAINTI NOT = 'S'
  5826           MOVE 'UPDATE'       TO SM-READ
  5827           PERFORM 9995-SECURITY-VIOLATION
  5828                              THRU 9995-EXIT
  5829           MOVE ER-0070        TO EMI-ERROR
  5830           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5831           GO TO 8100-SEND-INITIAL-MAP.
  5832
  5833     MOVE SPACE                  TO  PI-NB-MONTH-END-DT.
  5834
  5835     PERFORM 1250-READ-COMPANY-REC THRU 1250-EXIT.
  5836
  5837     IF MAINTI = 'N' OR 'C' OR 'B' OR 'K'
  5838         NEXT SENTENCE
  5839     ELSE
  5840         MOVE ER-0023            TO EMI-ERROR
  5841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5842         MOVE -1                 TO MAINTL
  5843         MOVE AL-UABON           TO MAINTA
  5844         GO TO 8200-SEND-DATAONLY.
  5845
  5846     IF PI-CARRIER-SECURITY GREATER SPACES
  5847         IF CARRIERL GREATER ZEROS
  5848           IF PI-CARRIER-SECURITY = CARRIERI
  5849              MOVE AL-UANON       TO CARRIERA
  5850            ELSE
  5851              MOVE -1             TO CARRIERL
  5852              MOVE AL-UABON       TO CARRIERA
  5853              MOVE ER-2370       TO EMI-ERROR
  5854              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5855
  5856     IF PI-ACCOUNT-SECURITY GREATER SPACES
  5857         IF ACCOUNTL GREATER ZEROS
  5858             IF PI-ACCOUNT-SECURITY = ACCOUNTI
  5859                 MOVE AL-UANON   TO ACCOUNTA
  5860               ELSE
  5861                 MOVE -1         TO ACCOUNTL
  5862                 MOVE AL-UABON   TO ACCOUNTA
  5863                 MOVE ER-2371   TO EMI-ERROR
  5864                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5865
  5866     IF  NOT EMI-NO-ERRORS
  5867         GO TO 8200-SEND-DATAONLY.
  5868
  5869     MOVE MAINTI                 TO PI-MAINT-FUNC.
  5870     MOVE AL-UANON               TO MAINTA.
  5871
  5872     MOVE PI-COMPANY-CD          TO PI-SAV-COMP-CD.
  5873     MOVE ZEROS                  TO PI-SAV-BATCH-SEQ
  5874                                    PI-SAV-BATCH-CHG-SEQ.
  5875     MOVE SPACES                 TO PI-SAV-CERT-EFF-DT
  5876                                    PI-SAV-CERT-NO.
  5877
  5878     IF BATCHL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 116
* EL630.cbl
  5879         MOVE -1                 TO BATCHL
  5880         MOVE AL-UNBON           TO BATCHA
  5881         MOVE ER-2201            TO EMI-ERROR
  5882         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5883     ELSE
  5884         IF BATCHI = QUESTION-MARKS OR SPACES
  5885             IF MAINTI = 'N'
  5886                 PERFORM 1300-GET-BATCH-NO THRU 1300-EXIT
  5887             ELSE
  5888                 MOVE -1         TO BATCHL
  5889                 MOVE AL-UNBON   TO BATCHA
  5890                 MOVE ER-2201    TO EMI-ERROR
  5891                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5892         ELSE
  5893             MOVE SPACE TO WS-SWITCH
  5894             PERFORM 0335-FAT-FINGER-EDIT VARYING PIC6-SUB
  5895                 FROM +1 BY +1
  5896                 UNTIL PIC6-SUB > +6 OR QUESTION-MARK-FOUND.
  5897
  5898     IF QUESTION-MARK-FOUND
  5899         IF MAINTI = 'N'
  5900             PERFORM 1300-GET-BATCH-NO THRU 1300-EXIT
  5901         ELSE
  5902             MOVE -1         TO BATCHL
  5903             MOVE AL-UNBON   TO BATCHA
  5904             MOVE ER-2201    TO EMI-ERROR
  5905             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5906     ELSE
  5907         IF BATCHI = PI-SAV-ENTRY-BATCH
  5908             MOVE AL-UANON   TO BATCHA
  5909         ELSE
  5910             MOVE BATCHI TO PI-SAV-ENTRY-BATCH
  5911             IF MAINTI = 'C' OR 'B'
  5912                 MOVE AL-UANON TO BATCHA
  5913                 MOVE ZEROS      TO ELFISSL  ELFCANL
  5914                                    EAHISSL  EAHCANL
  5915                                    EISSCNTL ECANCNTL
  5916                                    PI-LF-ISS-REMITTED
  5917                                    PI-LF-CAN-REMITTED
  5918                                    PI-AH-ISS-REMITTED
  5919                                    PI-AH-CAN-REMITTED
  5920                                    PI-ISS-CNT-REMITTED
  5921                                    PI-CAN-CNT-REMITTED.
  5922
  5923     IF REFL GREATER ZEROS
  5924        MOVE REFI                TO PI-SAV-REFERENCE.
  5925
  5926     IF MAINTI = 'C' OR 'B'
  5927         GO TO 0340-CHECK-TOTALS.
  5928
  5929     IF CARRIERL GREATER ZEROS
  5930         MOVE AL-UANON           TO CARRIERA
  5931         PERFORM 1000-VERIFY-CARRIER-ID THRU 1000-EXIT
  5932     ELSE
  5933         IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  5934             MOVE -1             TO CARRIERL
  5935             MOVE AL-UABON       TO CARRIERA
  5936             MOVE ER-0194        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 117
* EL630.cbl
  5937             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5938
  5939     IF GROUPL GREATER ZEROS
  5940         MOVE AL-UANON           TO GROUPA
  5941     ELSE
  5942         IF CARR-GROUP-ST-ACCNT-CNTL
  5943             MOVE -1 TO          GROUPL
  5944             MOVE AL-UABON       TO GROUPA
  5945             MOVE ER-0195        TO EMI-ERROR
  5946             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5947
  5948     IF STATEL GREATER ZEROS
  5949         MOVE AL-UANON           TO STATEA
  5950         PERFORM 1100-VERIFY-STATE-ID THRU 1100-EXIT
  5951     ELSE
  5952         IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  5953             MOVE -1             TO STATEL
  5954             MOVE AL-UABON       TO STATEA
  5955             MOVE ER-0196        TO EMI-ERROR
  5956             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5957
  5958     IF ACCOUNTL GREATER ZEROS
  5959         MOVE AL-UANON           TO ACCOUNTA
  5960         PERFORM 1200-VERIFY-ACCOUNT THRU 1200-EXIT
  5961     ELSE
  5962         MOVE -1 TO ACCOUNTL
  5963         MOVE AL-UABON           TO ACCOUNTA
  5964         MOVE ER-0197            TO EMI-ERROR
  5965         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5966
  5967 0335-FAT-FINGER-EDIT.
  5968
  5969     IF BATCHI (PIC6-SUB:1) = QUESTION-MARK
  5970         SET QUESTION-MARK-FOUND TO TRUE
  5971     END-IF.
  5972
  5973 0340-CHECK-TOTALS.
  5974******************************************************************
  5975*        IF MAINTENANCE FUNCTION = 'K' (COPY BATCH)              *
  5976*           GO TO CHECK ERRORS.                                  *
  5977******************************************************************
  5978
  5979     IF  MAINTI = 'K'
  5980         GO TO 0340-ERROR-CHECK.
  5981
  5982*    ********************************************************
  5983*    *         THE FOLLOWING FIELDS ARE NOT REQUIRED        *
  5984*    *         IF ENTERED THE ONLY REQUIREMENT IS NUMERIC   *
  5985*    ********************************************************
  5986
  5987     IF ELFISSL GREATER ZEROS
  5988         MOVE AL-UNNON           TO ELFISSA
  5989
  5990* EXEC CICS BIF DEEDIT
  5991*            FIELD   (ELFISSI)
  5992*            LENGTH  (12)
  5993*        END-EXEC
  5994     MOVE 12
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 118
* EL630.cbl
  5995       TO DFHEIV11
  5996*    MOVE '@"L                   #   #00005900' TO DFHEIV0
  5997     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5998     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5999     MOVE X'2020233030303035393030' TO DFHEIV0(25:11)
  6000     CALL 'kxdfhei1' USING DFHEIV0,
  6001           ELFISSI,
  6002           DFHEIV11
  6003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6004         MOVE ELFISSI            TO PI-LF-ISS-REMITTED
  6005     ELSE
  6006         MOVE ZEROS              TO PI-LF-ISS-REMITTED.
  6007
  6008     IF ELFCANL GREATER ZEROS
  6009         MOVE AL-UNNON           TO ELFCANA
  6010
  6011* EXEC CICS BIF DEEDIT
  6012*            FIELD   (ELFCANI)
  6013*            LENGTH  (10)
  6014*        END-EXEC
  6015     MOVE 10
  6016       TO DFHEIV11
  6017*    MOVE '@"L                   #   #00005910' TO DFHEIV0
  6018     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6019     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6020     MOVE X'2020233030303035393130' TO DFHEIV0(25:11)
  6021     CALL 'kxdfhei1' USING DFHEIV0,
  6022           ELFCANI,
  6023           DFHEIV11
  6024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6025         MOVE ELFCANI            TO PI-LF-CAN-REMITTED
  6026     ELSE
  6027         MOVE ZEROS              TO PI-LF-CAN-REMITTED.
  6028
  6029     IF EAHISSL GREATER ZEROS
  6030         MOVE AL-UNNON           TO EAHISSA
  6031
  6032* EXEC CICS BIF DEEDIT
  6033*            FIELD   (EAHISSI)
  6034*            LENGTH  (12)
  6035*        END-EXEC
  6036     MOVE 12
  6037       TO DFHEIV11
  6038*    MOVE '@"L                   #   #00005920' TO DFHEIV0
  6039     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6040     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6041     MOVE X'2020233030303035393230' TO DFHEIV0(25:11)
  6042     CALL 'kxdfhei1' USING DFHEIV0,
  6043           EAHISSI,
  6044           DFHEIV11
  6045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6046         MOVE EAHISSI            TO PI-AH-ISS-REMITTED
  6047     ELSE
  6048         MOVE ZEROS              TO PI-AH-ISS-REMITTED.
  6049
  6050     IF EAHCANL GREATER ZEROS
  6051         MOVE AL-UNNON           TO EAHCANA
  6052
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 119
* EL630.cbl
  6053* EXEC CICS BIF DEEDIT
  6054*            FIELD   (EAHCANI)
  6055*            LENGTH  (10)
  6056*        END-EXEC
  6057     MOVE 10
  6058       TO DFHEIV11
  6059*    MOVE '@"L                   #   #00005930' TO DFHEIV0
  6060     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6061     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6062     MOVE X'2020233030303035393330' TO DFHEIV0(25:11)
  6063     CALL 'kxdfhei1' USING DFHEIV0,
  6064           EAHCANI,
  6065           DFHEIV11
  6066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6067         MOVE EAHCANI            TO PI-AH-CAN-REMITTED
  6068     ELSE
  6069         MOVE ZEROS              TO PI-AH-CAN-REMITTED.
  6070
  6071     IF EISSCNTL GREATER ZEROS
  6072         MOVE AL-UNNON           TO EISSCNTA
  6073
  6074* EXEC CICS BIF DEEDIT
  6075*            FIELD (EISSCNTI)
  6076*            LENGTH(6)
  6077*        END-EXEC
  6078     MOVE 6
  6079       TO DFHEIV11
  6080*    MOVE '@"L                   #   #00005940' TO DFHEIV0
  6081     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6082     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6083     MOVE X'2020233030303035393430' TO DFHEIV0(25:11)
  6084     CALL 'kxdfhei1' USING DFHEIV0,
  6085           EISSCNTI,
  6086           DFHEIV11
  6087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6088         MOVE EISSCNTI           TO PI-ISS-CNT-REMITTED
  6089     ELSE
  6090         MOVE ZEROS              TO PI-ISS-CNT-REMITTED.
  6091
  6092     IF ECANCNTL GREATER ZEROS
  6093         MOVE AL-UNNON           TO ECANCNTA
  6094
  6095* EXEC CICS BIF DEEDIT
  6096*            FIELD  (ECANCNTI)
  6097*            LENGTH (6)
  6098*        END-EXEC
  6099     MOVE 6
  6100       TO DFHEIV11
  6101*    MOVE '@"L                   #   #00005950' TO DFHEIV0
  6102     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6103     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6104     MOVE X'2020233030303035393530' TO DFHEIV0(25:11)
  6105     CALL 'kxdfhei1' USING DFHEIV0,
  6106           ECANCNTI,
  6107           DFHEIV11
  6108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6109         MOVE ECANCNTI           TO PI-CAN-CNT-REMITTED
  6110     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 120
* EL630.cbl
  6111         MOVE ZEROS              TO PI-CAN-CNT-REMITTED.
  6112
  6113     IF MNTHNDTL GREATER ZEROS
  6114        NEXT SENTENCE
  6115       ELSE
  6116        GO TO 0340-RECEIVED-DATE.
  6117
  6118     MOVE MNTHNDTI               TO WS-DT-DEEDIT-FIELD.
  6119     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  6120
  6121     MOVE WS-DEEDIT-FIELD-DATE-OUT
  6122                                 TO DC-GREG-DATE-1-MDY.
  6123     MOVE '4'          TO DC-OPTION-CODE.
  6124     PERFORM 9700-DATE-LINK.
  6125
  6126     IF DATE-CONVERSION-ERROR
  6127        GO TO 0340-MNTH-DAY-ERROR.
  6128
  6129     MOVE DC-GREG-DATE-1-EDIT    TO MNTHNDTO.
  6130     MOVE DC-BIN-DATE-1          TO PI-NB-MONTH-END-DT.
  6131     MOVE DC-GREG-DATE-1-MDY     TO DATE-TEST-AREA.
  6132
  6133     IF DATE-TEST-DD = DC-DAYS-IN-MONTH OR 01
  6134        CONTINUE
  6135     ELSE
  6136        GO TO 0340-MNTH-DAY-ERROR.
  6137
  6138 0340-RECEIVED-DATE.
  6139
  6140     IF RECEVDTL GREATER ZEROS
  6141        NEXT SENTENCE
  6142       ELSE
  6143        MOVE WS-CURRENT-DT       TO RECEVDTI.
  6144
  6145     MOVE RECEVDTI               TO WS-DT-DEEDIT-FIELD.
  6146     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  6147
  6148     MOVE WS-DEEDIT-FIELD-DATE-OUT
  6149                                 TO DC-GREG-DATE-1-MDY.
  6150     MOVE '4'          TO DC-OPTION-CODE.
  6151     PERFORM 9700-DATE-LINK.
  6152
  6153     IF DATE-CONVERSION-ERROR
  6154        GO TO 0340-RECEV-DAY-ERROR.
  6155
  6156     MOVE DC-GREG-DATE-1-EDIT    TO RECEVDTO.
  6157     MOVE DC-BIN-DATE-1          TO PI-RECEIVED-DT.
  6158
  6159     GO TO 0340-ERROR-CHECK.
  6160
  6161 0340-MNTH-DAY-ERROR.
  6162
  6163     MOVE -1       TO MNTHNDTL.
  6164     MOVE AL-UABON TO MNTHNDTA.
  6165     MOVE ER-0587  TO EMI-ERROR.
  6166     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6167     GO TO 0340-ERROR-CHECK.
  6168
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 121
* EL630.cbl
  6169 0340-RECEV-DAY-ERROR.
  6170
  6171     MOVE -1       TO RECEVDTL.
  6172     MOVE AL-UABON TO RECEVDTA.
  6173     MOVE ER-0905  TO EMI-ERROR.
  6174     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6175
  6176 0340-ERROR-CHECK.
  6177
  6178     IF NOT EMI-NO-ERRORS
  6179         GO TO 8200-SEND-DATAONLY.
  6180
  6181     IF PI-NB-MONTH-END-DT EQUAL LOW-VALUES OR SPACES
  6182        GO TO 0345-END-DATE-CHECK.
  6183
  6184     IF PI-NB-MONTH-END-DT LESS THAN PI-CR-MONTH-END-DT
  6185        MOVE PI-NB-MONTH-END-DT  TO DC-BIN-DATE-1
  6186        MOVE PI-CR-MONTH-END-DT  TO DC-BIN-DATE-2
  6187     ELSE
  6188     IF PI-CR-MONTH-END-DT LESS THAN PI-NB-MONTH-END-DT
  6189        MOVE PI-NB-MONTH-END-DT  TO DC-BIN-DATE-2
  6190        MOVE PI-CR-MONTH-END-DT  TO DC-BIN-DATE-1
  6191     ELSE
  6192        GO TO 0345-END-DATE-CHECK.
  6193
  6194     MOVE  '1'                   TO  DC-OPTION-CODE.
  6195     PERFORM  9700-DATE-LINK.
  6196
  6197     IF (DATE-CONVERSION-ERROR)
  6198                   OR
  6199        ((DC-ELAPSED-MONTHS GREATER THAN +1) AND
  6200         (PI-COMPANY-ID NOT EQUAL 'DMD'))
  6201        MOVE -1       TO MNTHNDTL
  6202        MOVE AL-UABON TO MNTHNDTA
  6203        MOVE ER-0587  TO EMI-ERROR
  6204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6205
  6206 0345-END-DATE-CHECK.
  6207
  6208     IF NOT EMI-NO-ERRORS
  6209         GO TO 8200-SEND-DATAONLY.
  6210
  6211     IF PI-DELETE-IS-OK
  6212         MOVE SPACE              TO PI-VERIFY-DELETE-SW.
  6213
  6214     IF MAINTI = 'N'
  6215       AND PI-DATA-UPDATED
  6216         MOVE 'C'                TO PI-MAINT-FUNC
  6217         GO TO 0360-XCTL-EL6301.
  6218
  6219
  6220* EXEC CICS HANDLE CONDITION
  6221*        NOTFND  (0350-NO-RECORDS)
  6222*        ENDFILE (0350-NO-RECORDS)
  6223*    END-EXEC.
  6224*    MOVE '"$I''                  ! # #00006064' TO DFHEIV0
  6225     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 122
* EL630.cbl
  6227     MOVE X'2320233030303036303634' TO DFHEIV0(25:11)
  6228     CALL 'kxdfhei1' USING DFHEIV0
  6229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6230
  6231
  6232
  6233* EXEC CICS READ
  6234*        SET     (ADDRESS OF PENDING-BUSINESS)
  6235*        DATASET (ERPNDB-FILE-ID)
  6236*        RIDFLD  (PI-SAV-ENDING-ERPNDB-KEY)
  6237*        GTEQ
  6238*    END-EXEC.
  6239*    MOVE '&"S        G          (   #00006069' TO DFHEIV0
  6240     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6241     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6242     MOVE X'2020233030303036303639' TO DFHEIV0(25:11)
  6243     CALL 'kxdfhei1' USING DFHEIV0,
  6244           ERPNDB-FILE-ID,
  6245           DFHEIV20,
  6246           DFHEIV99,
  6247           PI-SAV-ENDING-ERPNDB-KEY,
  6248           DFHEIV99,
  6249           DFHEIV99,
  6250           DFHEIV99
  6251     SET ADDRESS OF PENDING-BUSINESS TO
  6252         DFHEIV20
  6253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6254
  6255
  6256     IF PI-SAV-COMP-CD     = PB-COMPANY-CD  AND
  6257        PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  6258         IF MAINTI = 'N'
  6259             MOVE ER-2229        TO EMI-ERROR
  6260             MOVE -1             TO MAINTL
  6261             MOVE AL-UABON       TO MAINTA
  6262             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6263             GO TO 8200-SEND-DATAONLY
  6264         ELSE
  6265             NEXT SENTENCE
  6266     ELSE
  6267         GO TO 0350-NO-RECORDS.
  6268
  6269     IF PI-CARRIER-SECURITY GREATER SPACES
  6270        IF PB-CARRIER = PI-CARRIER-SECURITY
  6271           NEXT SENTENCE
  6272         ELSE
  6273           GO TO 0350-NO-RECORDS.
  6274
  6275     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6276        IF PB-ACCOUNT = PI-ACCOUNT-SECURITY
  6277           NEXT SENTENCE
  6278         ELSE
  6279           GO TO 0350-NO-RECORDS.
  6280
  6281     IF PB-BILLED-DT NOT = LOW-VALUES
  6282         MOVE ER-2402            TO EMI-ERROR
  6283         MOVE -1                 TO BATCHL
  6284         MOVE AL-UABON           TO BATCHA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 123
* EL630.cbl
  6285         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6286         GO TO 8200-SEND-DATAONLY.
  6287
  6288******************************************************************
  6289*        IF MAINTENANCE FUNCTION = 'K'                           *
  6290*           REWRITE ENTIRE BATCH WITH NEW ACCOUNT INFORMATION.   *
  6291******************************************************************
  6292
  6293     IF  PI-SAV-COMP-CD = PB-COMPANY-CD
  6294         IF  PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  6295             IF  MAINTI = 'K'
  6296                 GO TO 6000-REWRITE-ENTIRE-BATCH.
  6297
  6298     IF PI-SAV-COMP-CD     = PB-COMPANY-CD   AND
  6299        PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH  AND
  6300        MAINTI NOT = 'N'
  6301         MOVE PB-CARRIER         TO PI-SAV-CARRIER
  6302                                    ACCT-CARRIER
  6303         MOVE PB-GROUPING        TO PI-SAV-GROUPING
  6304                                    ACCT-GROUPING
  6305         MOVE PB-STATE           TO PI-SAV-STATE
  6306                                    ACCT-STATE
  6307         MOVE PB-ACCOUNT         TO PI-SAV-ACCOUNT
  6308                                    ACCT-ACCOUNT
  6309         PERFORM 1200-READ-ACCOUNT THRU 1200-EXIT
  6310         PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  6311         MOVE 'EL630B'           TO PI-MAP-NAME.
  6312         GO TO 0360-XCTL-EL6301.
  6313
  6314 0350-NO-RECORDS.
  6315     IF MAINTI = 'N'
  6316         MOVE SPACE              TO PI-ISSUE-ADDED-SW
  6317         MOVE ZEROS              TO PI-LF-ISS-ENTERED
  6318                                    PI-LF-CAN-ENTERED
  6319                                    PI-AH-ISS-ENTERED
  6320                                    PI-AH-CAN-ENTERED
  6321                                    PI-ISS-CNT-ENTERED
  6322                                    PI-CAN-CNT-ENTERED
  6323         PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  6324         IF PI-LF-ISS-REMITTED  = ZEROS AND
  6325            PI-AH-ISS-REMITTED  = ZEROS AND
  6326            PI-LF-CAN-REMITTED  = ZEROS AND
  6327            PI-AH-CAN-REMITTED  = ZEROS AND
  6328            PI-ISS-CNT-REMITTED = ZEROS AND
  6329            PI-CAN-CNT-REMITTED = ZEROS
  6330             MOVE 'EL630B'     TO PI-MAP-NAME
  6331             GO TO 0360-XCTL-EL6301
  6332         ELSE
  6333             IF PI-LF-ISS-REMITTED  = ZEROS AND
  6334                PI-AH-ISS-REMITTED  = ZEROS AND
  6335                PI-ISS-CNT-REMITTED = ZEROS
  6336                 MOVE 'EL630C'     TO PI-MAP-NAME
  6337                 GO TO 0360-XCTL-EL6301
  6338             ELSE
  6339                 MOVE 'EL630B'     TO PI-MAP-NAME
  6340                 GO TO 0360-XCTL-EL6301
  6341     ELSE
  6342         MOVE ER-2212            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 124
* EL630.cbl
  6343         MOVE -1                 TO BATCHL
  6344         MOVE AL-UABON           TO BATCHA
  6345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6346         GO TO 8200-SEND-DATAONLY.
  6347
  6348 0360-XCTL-EL6301.
  6349     IF PI-MAINT-FUNC = 'N'
  6350         MOVE SPACES             TO PI-KEYED-SWITCHES
  6351                                    PI-AGE-KEYED-SW
  6352                                    PI-BIRTHDT-KEYED-SW.
  6353
  6354     MOVE XCTL-6301           TO PGM-NAME.
  6355
  6356     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 125
* EL630.cbl
  6358 0400-PRIME-BATCH-TOTALS.
  6359
  6360* EXEC CICS HANDLE CONDITION
  6361*        NOTFND (0480-NO-BATCH-TRAILER)
  6362*    END-EXEC.
  6363*    MOVE '"$I                   ! $ #00006179' TO DFHEIV0
  6364     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6365     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6366     MOVE X'2420233030303036313739' TO DFHEIV0(25:11)
  6367     CALL 'kxdfhei1' USING DFHEIV0
  6368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6369
  6370
  6371     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  6372     MOVE 9999                   TO PNDB-BATCH-SEQ.
  6373     MOVE BATCHI                 TO PNDB-ENTRY-BATCH.
  6374
  6375
  6376* EXEC CICS READ
  6377*        DATASET (ERPNDB-FILE-ID)
  6378*        SET     (ADDRESS OF PENDING-BUSINESS)
  6379*        RIDFLD  (ERPNDB-KEY)
  6380*    END-EXEC.
  6381*    MOVE '&"S        E          (   #00006187' TO DFHEIV0
  6382     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6384     MOVE X'2020233030303036313837' TO DFHEIV0(25:11)
  6385     CALL 'kxdfhei1' USING DFHEIV0,
  6386           ERPNDB-FILE-ID,
  6387           DFHEIV20,
  6388           DFHEIV99,
  6389           ERPNDB-KEY,
  6390           DFHEIV99,
  6391           DFHEIV99,
  6392           DFHEIV99
  6393     SET ADDRESS OF PENDING-BUSINESS TO
  6394         DFHEIV20
  6395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6396
  6397
  6398     IF PB-BILLED-DT NOT = LOW-VALUES
  6399         MOVE ER-2402            TO EMI-ERROR
  6400         MOVE -1                 TO BATCHL
  6401         MOVE AL-UABON           TO BATCHA
  6402         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6403         GO TO 0490-EXIT.
  6404
  6405     MOVE SPACES                   TO PI-ACCT-AGENT-PROCESSED-SW.
  6406     MOVE PI-COMPANY-CD            TO PI-SAV-COMP-CD.
  6407     MOVE PB-ENTRY-BATCH           TO PI-SAV-ENTRY-BATCH.
  6408
  6409     MOVE PB-REFERENCE             TO PI-SAV-REFERENCE.
  6410     MOVE PB-CSR-ID                TO PI-CSR-ID.
  6411
  6412     MOVE PB-CARRIER               TO PI-SAV-CARRIER.
  6413     MOVE PB-GROUPING              TO PI-SAV-GROUPING.
  6414     MOVE PB-STATE                 TO PI-SAV-STATE.
  6415     MOVE PB-ACCOUNT               TO PI-SAV-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 126
* EL630.cbl
  6416     MOVE PB-B-LF-ISS-PRM-REMITTED TO PI-LF-ISS-REMITTED.
  6417     MOVE PB-B-LF-ISS-PRM-ENTERED  TO PI-LF-ISS-ENTERED.
  6418     MOVE PB-B-AH-ISS-PRM-REMITTED TO PI-AH-ISS-REMITTED.
  6419     MOVE PB-B-AH-ISS-PRM-ENTERED  TO PI-AH-ISS-ENTERED.
  6420     MOVE PB-B-LF-CAN-PRM-REMITTED TO PI-LF-CAN-REMITTED.
  6421     MOVE PB-B-LF-CAN-PRM-ENTERED  TO PI-LF-CAN-ENTERED.
  6422     MOVE PB-B-AH-CAN-PRM-REMITTED TO PI-AH-CAN-REMITTED.
  6423     MOVE PB-B-AH-CAN-PRM-ENTERED  TO PI-AH-CAN-ENTERED.
  6424     MOVE PB-B-ISSUE-CNT-REMITTED  TO PI-ISS-CNT-REMITTED.
  6425     MOVE PB-B-ISSUE-CNT-ENTERED   TO PI-ISS-CNT-ENTERED.
  6426     MOVE PB-B-CANCEL-CNT-REMITTED TO PI-CAN-CNT-REMITTED.
  6427     MOVE PB-B-CANCEL-CNT-ENTERED  TO PI-CAN-CNT-ENTERED.
  6428
  6429******************************************************************
  6430*    IF THE MONTH-END-DATE IN THE TRAILER RECORD (BATCH HEADER)  *
  6431*       IS NOT EQUAL TO THE ACCOUNTS MONTH-END-DATE PRIME THE    *
  6432*       TRAILER'S MONTH-END-DATE.                                *
  6433******************************************************************
  6434
  6435     MOVE SPACE                    TO PI-NB-MONTH-END-DT.
  6436     IF  PB-CREDIT-SELECT-DT = PI-CR-MONTH-END-DT
  6437         NEXT SENTENCE
  6438       ELSE
  6439         MOVE PB-CREDIT-SELECT-DT  TO  PI-NB-MONTH-END-DT.
  6440
  6441     IF  PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
  6442         MOVE PB-INPUT-DT          TO PI-RECEIVED-DT
  6443     ELSE
  6444         MOVE PB-B-RECEIVED-DT     TO PI-RECEIVED-DT.
  6445
  6446     GO TO 0490-EXIT.
  6447
  6448 0480-NO-BATCH-TRAILER.
  6449     MOVE ER-2212                TO EMI-ERROR.
  6450     MOVE -1                     TO BATCHL.
  6451     MOVE AL-UABON               TO BATCHA.
  6452     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6453
  6454 0490-EXIT.
  6455     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 127
* EL630.cbl
  6457 1000-VERIFY-CARRIER-ID.
  6458     MOVE SPACES                 TO ELCNTL-KEY.
  6459     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6460     MOVE '6'                    TO CNTL-REC-TYPE.
  6461     MOVE CARRIERI               TO CNTL-CARRIER
  6462     MOVE +0                     TO CNTL-SEQ.
  6463
  6464
  6465* EXEC CICS HANDLE CONDITION
  6466*        NOTFND   (1000-NO-CARRIER)
  6467*    END-EXEC.
  6468*    MOVE '"$I                   ! % #00006259' TO DFHEIV0
  6469     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6471     MOVE X'2520233030303036323539' TO DFHEIV0(25:11)
  6472     CALL 'kxdfhei1' USING DFHEIV0
  6473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6474
  6475
  6476
  6477* EXEC CICS READ
  6478*        DATASET   (ELCNTL-FILE-ID)
  6479*        SET       (ADDRESS OF CONTROL-FILE)
  6480*        RIDFLD    (ELCNTL-KEY)
  6481*    END-EXEC.
  6482*    MOVE '&"S        E          (   #00006263' TO DFHEIV0
  6483     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6484     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6485     MOVE X'2020233030303036323633' TO DFHEIV0(25:11)
  6486     CALL 'kxdfhei1' USING DFHEIV0,
  6487           ELCNTL-FILE-ID,
  6488           DFHEIV20,
  6489           DFHEIV99,
  6490           ELCNTL-KEY,
  6491           DFHEIV99,
  6492           DFHEIV99,
  6493           DFHEIV99
  6494     SET ADDRESS OF CONTROL-FILE TO
  6495         DFHEIV20
  6496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6497
  6498
  6499     GO TO 1000-EXIT.
  6500
  6501 1000-NO-CARRIER.
  6502     MOVE ER-2208                TO EMI-ERROR
  6503     MOVE -1                     TO CARRIERL
  6504     MOVE AL-UABON               TO CARRIERA
  6505     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6506
  6507 1000-EXIT.
  6508     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 128
* EL630.cbl
  6510 1100-VERIFY-STATE-ID.
  6511     MOVE SPACES                 TO ELCNTL-KEY.
  6512     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6513     MOVE '3'                    TO CNTL-REC-TYPE.
  6514     MOVE STATEI                 TO CNTL-STATE.
  6515     MOVE +0                     TO CNTL-SEQ.
  6516
  6517
  6518* EXEC CICS HANDLE CONDITION
  6519*        NOTFND   (1100-NO-STATE)
  6520*    END-EXEC.
  6521*    MOVE '"$I                   ! & #00006287' TO DFHEIV0
  6522     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6523     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6524     MOVE X'2620233030303036323837' TO DFHEIV0(25:11)
  6525     CALL 'kxdfhei1' USING DFHEIV0
  6526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6527
  6528
  6529
  6530* EXEC CICS READ
  6531*        DATASET   (ELCNTL-FILE-ID)
  6532*        SET       (ADDRESS OF CONTROL-FILE)
  6533*        RIDFLD    (ELCNTL-KEY)
  6534*    END-EXEC.
  6535*    MOVE '&"S        E          (   #00006291' TO DFHEIV0
  6536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6538     MOVE X'2020233030303036323931' TO DFHEIV0(25:11)
  6539     CALL 'kxdfhei1' USING DFHEIV0,
  6540           ELCNTL-FILE-ID,
  6541           DFHEIV20,
  6542           DFHEIV99,
  6543           ELCNTL-KEY,
  6544           DFHEIV99,
  6545           DFHEIV99,
  6546           DFHEIV99
  6547     SET ADDRESS OF CONTROL-FILE TO
  6548         DFHEIV20
  6549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6550
  6551
  6552     GO TO 1100-EXIT.
  6553
  6554 1100-NO-STATE.
  6555     MOVE ER-2209                TO EMI-ERROR.
  6556     MOVE -1                     TO STATEL.
  6557     MOVE AL-UABON               TO STATEA.
  6558     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6559     GO TO 8200-SEND-DATAONLY.
  6560
  6561 1100-EXIT.
  6562     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 129
* EL630.cbl
  6564
  6565 1200-VERIFY-ACCOUNT.
  6566     IF CARRIERL GREATER ZEROS
  6567         MOVE CARRIERI           TO ACCT-CARRIER
  6568     ELSE
  6569         MOVE SPACES             TO ACCT-CARRIER.
  6570
  6571     IF GROUPL GREATER ZEROS
  6572         MOVE GROUPI             TO ACCT-GROUPING
  6573     ELSE
  6574         MOVE SPACES             TO ACCT-GROUPING.
  6575
  6576     IF STATEL GREATER ZEROS
  6577         MOVE STATEI             TO ACCT-STATE
  6578     ELSE
  6579         MOVE SPACES             TO ACCT-STATE.
  6580
  6581     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  6582
  6583 1200-READ-ACCOUNT.
  6584     MOVE PI-COMPANY-CD          TO ACCT-CO.
  6585     MOVE LOW-VALUES             TO ACCT-EXP-DATE
  6586                                    PI-ACCT-LOW-EFF-DT
  6587                                    PI-ACCT-HIGH-EXP-DT.
  6588
  6589
  6590* EXEC CICS HANDLE CONDITION
  6591*        NOTFND   (1200-ACCOUNT-INVALID)
  6592*        ENDFILE  (1200-ACCOUNT-INVALID)
  6593*    END-EXEC.
  6594*    MOVE '"$I''                  ! '' #00006334' TO DFHEIV0
  6595     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6597     MOVE X'2720233030303036333334' TO DFHEIV0(25:11)
  6598     CALL 'kxdfhei1' USING DFHEIV0
  6599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6600
  6601
  6602
  6603* EXEC CICS STARTBR
  6604*        DATASET (ERACCT2-FILE-ID)
  6605*        RIDFLD  (ERACCT-KEY)
  6606*    END-EXEC.
  6607     MOVE 0
  6608       TO DFHEIV11
  6609*    MOVE '&,         G          &   #00006339' TO DFHEIV0
  6610     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6611     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6612     MOVE X'2020233030303036333339' TO DFHEIV0(25:11)
  6613     CALL 'kxdfhei1' USING DFHEIV0,
  6614           ERACCT2-FILE-ID,
  6615           ERACCT-KEY,
  6616           DFHEIV99,
  6617           DFHEIV11,
  6618           DFHEIV99
  6619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6620
  6621
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 130
* EL630.cbl
  6622     MOVE ERACCT-KEY             TO ERACCT-SAVE-KEY.
  6623
  6624 1200-READ-LOOP.
  6625
  6626* EXEC CICS READNEXT
  6627*        DATASET   (ERACCT2-FILE-ID)
  6628*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6629*        RIDFLD    (ERACCT-KEY)
  6630*    END-EXEC.
  6631     MOVE 0
  6632       TO DFHEIV11
  6633*    MOVE '&.S                   )   #00006347' TO DFHEIV0
  6634     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6635     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6636     MOVE X'2020233030303036333437' TO DFHEIV0(25:11)
  6637     CALL 'kxdfhei1' USING DFHEIV0,
  6638           ERACCT2-FILE-ID,
  6639           DFHEIV20,
  6640           DFHEIV99,
  6641           ERACCT-KEY,
  6642           DFHEIV99,
  6643           DFHEIV11,
  6644           DFHEIV99,
  6645           DFHEIV99
  6646     SET ADDRESS OF ACCOUNT-MASTER TO
  6647         DFHEIV20
  6648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6649
  6650
  6651     IF ERACCT-COMP-KEY NOT = ERACCT-SAVE-KEY
  6652         GO TO 1200-ACCOUNT-INVALID.
  6653
  6654     IF WS-ON1-SW1 IS EQUAL TO 'Y'
  6655         MOVE 'N'                TO WS-ON1-SW1
  6656         MOVE +0                 TO WS-SUB1
  6657         MOVE AM-CARRIER         TO PI-SAV-FC-CARRIER
  6658         MOVE AM-GROUPING        TO PI-SAV-FC-GROUPING
  6659         MOVE AM-STATE           TO PI-SAV-FC-STATE
  6660         MOVE AM-VG-CARRIER      TO PI-SAV-CARRIER
  6661         MOVE AM-VG-GROUPING     TO PI-SAV-GROUPING
  6662         MOVE AM-VG-STATE        TO PI-SAV-STATE
  6663         MOVE AM-VG-ACCOUNT      TO PI-SAV-ACCOUNT
  6664         MOVE AM-EFFECTIVE-DT    TO PI-ACCT-LOW-EFF-DT.
  6665
  6666     MOVE AM-EXPIRATION-DT       TO PI-ACCT-HIGH-EXP-DT.
  6667     MOVE AM-NAME                TO PI-AM-NAME.
  6668     IF AM-EDIT-LOAN-OFC = 'Y'
  6669        MOVE 'Y'                 TO PI-AM-EDIT-LOAN-OFC
  6670     ELSE
  6671        MOVE 'N'                 TO PI-AM-EDIT-LOAN-OFC
  6672     END-IF
  6673     IF AM-GPCD = 02 OR 03 OR 04 OR 05
  6674        MOVE AM-PERSON           TO PI-AM-ADDR1
  6675        MOVE AM-ADDRS            TO PI-AM-ADDR2
  6676*       MOVE AM-CITY             TO PI-AM-CITYST
  6677        MOVE AM-ADDR-CITY        TO PI-AM-CITY
  6678        MOVE AM-ADDR-STATE       TO PI-AM-STATE
  6679        MOVE AM-ZIP              TO PI-AM-ZIP
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 131
* EL630.cbl
  6680     ELSE
  6681        MOVE SPACES TO PI-AM-ADDR1 PI-AM-ADDR2
  6682                      PI-AM-CITYST PI-AM-ZIP
  6683     END-IF
  6684
  6685     MOVE AM-CARRIER             TO PI-COMP-CARRIER.
  6686     MOVE AM-GROUPING            TO PI-COMP-GROUPING.
  6687     MOVE AM-CSR-CODE            TO PI-CSR-ID.
  6688
  6689     IF PI-AR-PROCESSING
  6690        MOVE 'Y'                 TO WS-RECORD-FOUND-SW
  6691        PERFORM 1260-FIND-ACCT-AGENT THRU 1260-EXIT
  6692        IF RECORD-NOT-FOUND
  6693           GO TO 8200-SEND-DATAONLY.
  6694
  6695     GO TO 1200-READ-LOOP.
  6696
  6697 1200-ACCOUNT-INVALID.
  6698     IF PI-ACCT-LOW-EFF-DT NOT = LOW-VALUES
  6699        MOVE 'Y'                 TO PI-ACCT-AGENT-PROCESSED-SW
  6700        GO TO 1200-EXIT.
  6701
  6702     IF CARR-GROUP-ST-ACCNT-CNTL
  6703         MOVE -1                     TO CARRIERL
  6704         MOVE AL-UABON               TO CARRIERA
  6705                                        GROUPA
  6706                                        STATEA
  6707                                        ACCOUNTA
  6708     ELSE
  6709         IF ST-ACCNT-CNTL
  6710             MOVE -1                 TO STATEL
  6711             MOVE AL-UABON           TO STATEA
  6712                                        ACCOUNTA
  6713         ELSE
  6714             IF CARR-ST-ACCNT-CNTL
  6715                 MOVE -1             TO CARRIERL
  6716                 MOVE AL-UABON       TO CARRIERA
  6717                                        STATEA
  6718                                        ACCOUNTA
  6719             ELSE
  6720                 IF ACCNT-CNTL
  6721                     MOVE -1         TO ACCOUNTL
  6722                     MOVE AL-UABON   TO ACCOUNTA
  6723                 ELSE
  6724                     MOVE -1         TO CARRIERL
  6725                     MOVE AL-UABON   TO CARRIERA
  6726                                        ACCOUNTA.
  6727
  6728     MOVE ER-2210                TO EMI-ERROR.
  6729     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6730
  6731 1200-EXIT.
  6732     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 132
* EL630.cbl
  6734 1250-READ-COMPANY-REC.
  6735     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6736     MOVE '1'                    TO CNTL-REC-TYPE.
  6737     MOVE SPACES                 TO CNTL-ACCESS.
  6738     MOVE +0                     TO CNTL-SEQ.
  6739
  6740
  6741* EXEC CICS HANDLE CONDITION
  6742*        NOTFND   (1250-NO-COMPANY-REC)
  6743*    END-EXEC.
  6744*    MOVE '"$I                   ! ( #00006442' TO DFHEIV0
  6745     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6746     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6747     MOVE X'2820233030303036343432' TO DFHEIV0(25:11)
  6748     CALL 'kxdfhei1' USING DFHEIV0
  6749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6750
  6751
  6752
  6753* EXEC CICS READ
  6754*        DATASET   (ELCNTL-FILE-ID)
  6755*        SET       (ADDRESS OF CONTROL-FILE)
  6756*        RIDFLD    (ELCNTL-KEY)
  6757*    END-EXEC.
  6758*    MOVE '&"S        E          (   #00006446' TO DFHEIV0
  6759     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6760     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6761     MOVE X'2020233030303036343436' TO DFHEIV0(25:11)
  6762     CALL 'kxdfhei1' USING DFHEIV0,
  6763           ELCNTL-FILE-ID,
  6764           DFHEIV20,
  6765           DFHEIV99,
  6766           ELCNTL-KEY,
  6767           DFHEIV99,
  6768           DFHEIV99,
  6769           DFHEIV99
  6770     SET ADDRESS OF CONTROL-FILE TO
  6771         DFHEIV20
  6772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6773
  6774
  6775     MOVE CF-CREDIT-EDIT-CONTROLS TO PI-CREDIT-EDIT-CONTROLS.
  6776     GO TO 1250-EXIT.
  6777
  6778 1250-NO-COMPANY-REC.
  6779     MOVE ER-2248                TO EMI-ERROR.
  6780     MOVE -1                     TO BATCHL.
  6781     MOVE AL-UABON               TO CARRIERA
  6782     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6783     GO TO 8200-SEND-DATAONLY.
  6784
  6785 1250-EXIT.
  6786     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 133
* EL630.cbl
  6788
  6789 1260-FIND-ACCT-AGENT.
  6790
  6791******************************************************************
  6792*                                                                *
  6793*            F I N D   A C C O U N T   A G E N T                 *
  6794*                                                                *
  6795*    NOTE:  IT IS NECESSARY TO LOAD EVERY DATE RANGE FOR         *
  6796*           EACH ACCOUNT AGENT / FINANCIAL RESPONSIBILITY        *
  6797*           INTO THE PROGRAM INTERFACE AREA.  THE ACCOUNT        *
  6798*           DATE RANGES ARE CHECKED DURING DATA ENTRY IN         *
  6799*           EL6301.                                              *
  6800*                                                                *
  6801******************************************************************
  6802
  6803     IF PI-ACCT-AGENT-PROCESSED
  6804        GO TO 1260-EXIT.
  6805
  6806     IF WS-ON1-SW2 IS EQUAL TO 'Y'
  6807        MOVE 'N'                 TO WS-ON1-SW2
  6808     ELSE
  6809        MOVE +0                  TO WS-SUB2
  6810        GO TO 1260-CONT-FIND-ACCT-AGENT.
  6811
  6812     MOVE +0                     TO WS-SUB2.
  6813
  6814 1260-INITIALIZE-DATE-RANGES.
  6815     ADD +1                      TO WS-SUB2.
  6816
  6817     IF WS-SUB2 GREATER +32
  6818        GO TO 1260-INITIALIZE-FINISHED.
  6819
  6820     MOVE SPACES                 TO PI-ACCT-EFF-DT (WS-SUB2)
  6821                                    PI-ACCT-EXP-DT (WS-SUB2)
  6822                                    PI-REMIT-AGENT (WS-SUB2)
  6823                                    PI-ACCT-AGENT  (WS-SUB2).
  6824
  6825     GO TO 1260-INITIALIZE-DATE-RANGES.
  6826
  6827 1260-INITIALIZE-FINISHED.
  6828     MOVE SPACES                 TO PI-ACCOUNT-AGENT
  6829                                    PI-FIN-RESP.
  6830
  6831     MOVE 'N'                    TO PI-ACCT-AGENT-ERROR-SW
  6832                                    PI-FIN-RESP-ERROR-SW.
  6833
  6834     MOVE +0                     TO WS-SUB2.
  6835
  6836 1260-CONT-FIND-ACCT-AGENT.
  6837     ADD  +1                     TO WS-SUB2.
  6838
  6839     IF WS-SUB2 GREATER +10
  6840        MOVE  SPACES             TO PI-ACCT-AGENT (WS-SUB1)
  6841        GO TO 1260-EXIT.
  6842
  6843     IF AM-COM-TYP (WS-SUB2) = 'C' OR 'D' OR 'F'
  6844        NEXT SENTENCE
  6845     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 134
* EL630.cbl
  6846        GO TO 1260-CONT-FIND-ACCT-AGENT.
  6847
  6848     IF WS-SUB1 = +0
  6849        MOVE +1                   TO WS-SUB1
  6850                                     PI-SUB
  6851        MOVE AM-EFFECTIVE-DT      TO PI-ACCT-EFF-DT (WS-SUB1)
  6852        MOVE AM-EXPIRATION-DT     TO PI-ACCT-EXP-DT (WS-SUB1)
  6853        MOVE AM-AGT (WS-SUB2)     TO PI-ACCT-AGENT  (WS-SUB1)
  6854        MOVE AM-AGT (AM-REMIT-TO) TO PI-REMIT-AGENT (WS-SUB1)
  6855        GO TO 1260-EXIT.
  6856
  6857     IF AM-AGT (WS-SUB2)     = PI-ACCT-AGENT  (WS-SUB1) AND
  6858        AM-AGT (AM-REMIT-TO) = PI-REMIT-AGENT (WS-SUB1)
  6859          MOVE AM-EXPIRATION-DT  TO PI-ACCT-EXP-DT (WS-SUB1)
  6860        ELSE
  6861          ADD +1                      TO WS-SUB1
  6862          IF WS-SUB1 GREATER +32
  6863              MOVE  ER-2119             TO EMI-ERROR
  6864              MOVE -1                   TO MAINTL
  6865              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  6866              MOVE 'N'                  TO WS-RECORD-FOUND-SW
  6867              GO TO 1260-EXIT
  6868          ELSE
  6869           MOVE WS-SUB1              TO PI-SUB
  6870           MOVE AM-EFFECTIVE-DT      TO PI-ACCT-EFF-DT (WS-SUB1)
  6871           MOVE AM-EXPIRATION-DT     TO PI-ACCT-EXP-DT (WS-SUB1)
  6872           MOVE AM-AGT (WS-SUB2)     TO PI-ACCT-AGENT  (WS-SUB1)
  6873           MOVE AM-AGT (AM-REMIT-TO) TO PI-REMIT-AGENT (WS-SUB1).
  6874
  6875 1260-EXIT.
  6876      EXIT.
  6877
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 135
* EL630.cbl
  6879
  6880 1300-GET-BATCH-NO.
  6881
  6882* EXEC CICS HANDLE CONDITION
  6883*        NOTFND   (1300-NO-COMPANY-REC)
  6884*    END-EXEC.
  6885*    MOVE '"$I                   ! ) #00006558' TO DFHEIV0
  6886     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6887     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6888     MOVE X'2920233030303036353538' TO DFHEIV0(25:11)
  6889     CALL 'kxdfhei1' USING DFHEIV0
  6890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6891
  6892
  6893
  6894* EXEC CICS READ
  6895*        DATASET   (ELCNTL-FILE-ID)
  6896*        SET       (ADDRESS OF CONTROL-FILE)
  6897*        RIDFLD    (ELCNTL-KEY)
  6898*        UPDATE
  6899*    END-EXEC.
  6900*    MOVE '&"S        EU         (   #00006562' TO DFHEIV0
  6901     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6902     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6903     MOVE X'2020233030303036353632' TO DFHEIV0(25:11)
  6904     CALL 'kxdfhei1' USING DFHEIV0,
  6905           ELCNTL-FILE-ID,
  6906           DFHEIV20,
  6907           DFHEIV99,
  6908           ELCNTL-KEY,
  6909           DFHEIV99,
  6910           DFHEIV99,
  6911           DFHEIV99
  6912     SET ADDRESS OF CONTROL-FILE TO
  6913         DFHEIV20
  6914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6915
  6916
  6917 1300-ASSIGN-NUMBER-LOOP.
  6918     IF CF-LAST-BATCH-RESET
  6919         MOVE ZEROS              TO CF-LAST-BATCH-NO
  6920         ADD +1                  TO CF-LAST-BATCH-NO
  6921     ELSE
  6922         ADD +1                  TO CF-LAST-BATCH-NO.
  6923
  6924     MOVE CF-LAST-BATCH-NO       TO WS-BATCH-NO.
  6925     MOVE WS-BATCH-NO            TO PI-SAV-ENTRY-BATCH.
  6926
  6927 1300-REWRITE-COMPANY-REC.
  6928     MOVE WS-BATCH-NO            TO BATCHI.
  6929     MOVE AL-UANON               TO BATCHA.
  6930
  6931
  6932* EXEC CICS REWRITE
  6933*        DATASET (ELCNTL-FILE-ID)
  6934*        FROM    (CONTROL-FILE)
  6935*    END-EXEC.
  6936     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 136
* EL630.cbl
  6937      CONTROL-FILE
  6938       TO DFHEIV11
  6939*    MOVE '&& L                  %   #00006583' TO DFHEIV0
  6940     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6941     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6942     MOVE X'2020233030303036353833' TO DFHEIV0(25:11)
  6943     CALL 'kxdfhei1' USING DFHEIV0,
  6944           ELCNTL-FILE-ID,
  6945           CONTROL-FILE,
  6946           DFHEIV11,
  6947           DFHEIV99
  6948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6949
  6950
  6951
  6952* EXEC CICS SYNCPOINT
  6953*    END-EXEC.
  6954*    MOVE '6"                    !   #00006588' TO DFHEIV0
  6955     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  6956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6957     MOVE X'2020233030303036353838' TO DFHEIV0(25:11)
  6958     CALL 'kxdfhei1' USING DFHEIV0
  6959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6960
  6961
  6962 1300-CHECK-FOR-DUP-BATCH.
  6963
  6964* EXEC CICS HANDLE CONDITION
  6965*        NOTFND  (1300-EXIT)
  6966*    END-EXEC.
  6967*    MOVE '"$I                   ! * #00006592' TO DFHEIV0
  6968     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6970     MOVE X'2A20233030303036353932' TO DFHEIV0(25:11)
  6971     CALL 'kxdfhei1' USING DFHEIV0
  6972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6973
  6974
  6975
  6976* EXEC CICS READ
  6977*        SET     (ADDRESS OF PENDING-BUSINESS)
  6978*        DATASET (ERPNDB-FILE-ID)
  6979*        RIDFLD  (PI-SAV-ENDING-ERPNDB-KEY)
  6980*        GTEQ
  6981*    END-EXEC.
  6982*    MOVE '&"S        G          (   #00006596' TO DFHEIV0
  6983     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6985     MOVE X'2020233030303036353936' TO DFHEIV0(25:11)
  6986     CALL 'kxdfhei1' USING DFHEIV0,
  6987           ERPNDB-FILE-ID,
  6988           DFHEIV20,
  6989           DFHEIV99,
  6990           PI-SAV-ENDING-ERPNDB-KEY,
  6991           DFHEIV99,
  6992           DFHEIV99,
  6993           DFHEIV99
  6994     SET ADDRESS OF PENDING-BUSINESS TO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 137
* EL630.cbl
  6995         DFHEIV20
  6996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6997
  6998
  6999     IF PI-SAV-COMP-CD NOT = PB-COMPANY-CD
  7000         GO TO 1300-EXIT.
  7001
  7002     IF PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  7003         MOVE LOW-VALUES         TO EL630AO
  7004         MOVE QUESTION-MARKS     TO BATCHO
  7005         MOVE AL-UABON           TO BATCHA
  7006         MOVE -1                 TO BATCHL
  7007         MOVE ER-2229            TO EMI-ERROR
  7008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7009         GO TO 8100-SEND-INITIAL-MAP.
  7010
  7011     GO TO 1300-EXIT.
  7012
  7013 1300-NO-COMPANY-REC.
  7014     MOVE ER-2248                TO EMI-ERROR.
  7015     MOVE -1                     TO BATCHL.
  7016     MOVE AL-UABON               TO CARRIERA
  7017     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7018     GO TO 8200-SEND-DATAONLY.
  7019
  7020 1300-EXIT.
  7021     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 138
* EL630.cbl
  7023
  7024 1400-VERIFY-COMP-MASTER.
  7025
  7026******************************************************************
  7027*
  7028*      V E R I F Y    C O M P E N S A T I O N    M A S T E R
  7029*
  7030*       READ COMPENSATION MASTER AND SAVE SUMMARY CODE FOR
  7031*       A.R. PROCESSING.
  7032*
  7033******************************************************************
  7034
  7035
  7036* EXEC CICS HANDLE CONDITION
  7037*        NOTFND   (1470-NO-COMP-MSTR)
  7038*    END-EXEC.
  7039*    MOVE '"$I                   ! + #00006639' TO DFHEIV0
  7040     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7042     MOVE X'2B20233030303036363339' TO DFHEIV0(25:11)
  7043     CALL 'kxdfhei1' USING DFHEIV0
  7044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7045
  7046
  7047     MOVE SPACE                  TO WS-COMP-MASTER-ERROR-SW.
  7048     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  7049
  7050     IF PI-ZERO-CARRIER OR
  7051        PI-ZERO-CAR-GROUP
  7052        MOVE ZEROS               TO ERCOMP-CARRIER
  7053     ELSE
  7054        MOVE PI-COMP-CARRIER     TO ERCOMP-CARRIER.
  7055
  7056     IF PI-ZERO-GROUPING OR
  7057        PI-ZERO-CAR-GROUP
  7058        MOVE ZEROS               TO ERCOMP-GROUPING
  7059     ELSE
  7060        MOVE PI-COMP-GROUPING    TO ERCOMP-GROUPING.
  7061
  7062     MOVE PI-FIN-RESP            TO ERCOMP-FIN-RESP.
  7063     MOVE PI-ACCOUNT-AGENT       TO ERCOMP-ACCT.
  7064     MOVE 'A'                    TO ERCOMP-RECORD-TYPE.
  7065
  7066
  7067* EXEC CICS READ
  7068*        DATASET   (ERCOMP-FILE-ID)
  7069*        SET       (ADDRESS OF COMPENSATION-MASTER)
  7070*        RIDFLD    (ERCOMP-KEY)
  7071*    END-EXEC.
  7072*    MOVE '&"S        E          (   #00006662' TO DFHEIV0
  7073     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7075     MOVE X'2020233030303036363632' TO DFHEIV0(25:11)
  7076     CALL 'kxdfhei1' USING DFHEIV0,
  7077           ERCOMP-FILE-ID,
  7078           DFHEIV20,
  7079           DFHEIV99,
  7080           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 139
* EL630.cbl
  7081           DFHEIV99,
  7082           DFHEIV99,
  7083           DFHEIV99
  7084     SET ADDRESS OF COMPENSATION-MASTER TO
  7085         DFHEIV20
  7086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7087
  7088
  7089     MOVE CO-AR-SUMMARY-CODE     TO PI-SUMMARY-CODE.
  7090
  7091     IF REFL GREATER ZEROS
  7092         GO TO 1490-EXIT.
  7093
  7094     IF PI-SAV-REFERENCE GREATER SPACES
  7095         GO TO 1490-EXIT.
  7096
  7097     IF CO-AR-NET-REPORT
  7098        MOVE 'Y'                 TO WS-UPDATE-REFERENCE-SW
  7099        MOVE WS-CURRENT-YMD      TO PI-SAV-REFERENCE
  7100     ELSE
  7101        MOVE SPACES              TO PI-SAV-REFERENCE.
  7102
  7103     GO TO 1490-EXIT.
  7104
  7105 1470-NO-COMP-MSTR.
  7106     MOVE ER-2800                TO EMI-ERROR.
  7107     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7108     MOVE 'Y'                    TO WS-COMP-MASTER-ERROR-SW.
  7109
  7110 1490-EXIT.
  7111     EXIT.
  7112
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 140
* EL630.cbl
  7114
  7115******************************************************************
  7116*                                                                *
  7117*           W R I T E   R E Q U E S T   R E C O R D              *
  7118*                                                                *
  7119******************************************************************
  7120
  7121 1900-WRITE-REQUEST-RECORD.
  7122
  7123* EXEC CICS GETMAIN
  7124*         SET       (ADDRESS OF AR-REQUEST-RECORD)
  7125*         LENGTH    (200)
  7126*         INITIMG   (GETMAIN-SPACE)
  7127*    END-EXEC.
  7128     MOVE 200
  7129       TO DFHEIV11
  7130*    MOVE ',"IL                  $   #00006701' TO DFHEIV0
  7131     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7132     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7133     MOVE X'2020233030303036373031' TO DFHEIV0(25:11)
  7134     CALL 'kxdfhei1' USING DFHEIV0,
  7135           DFHEIV20,
  7136           DFHEIV11,
  7137           GETMAIN-SPACE
  7138     SET ADDRESS OF AR-REQUEST-RECORD TO
  7139         DFHEIV20
  7140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7141
  7142
  7143     MOVE 'RQ'                   TO RQ-RECORD-ID.
  7144
  7145     MOVE PI-SAV-ENTRY-BATCH     TO RQ-ENTRY-BATCH
  7146                                    RQ-BATCH-A1
  7147                                    RQ-BATCH-A2
  7148                                    RQ-BATCH-A3
  7149                                    RQ-BATCH-A4.
  7150
  7151     MOVE PI-SAV-REFERENCE       TO RQ-REFERENCE-A1
  7152                                    RQ-REFERENCE-A2
  7153                                    RQ-REFERENCE-A4.
  7154
  7155     MOVE PI-COMPANY-CD          TO RQ-COMPANY-CD
  7156                                    RQ-COMPANY-CD-A1
  7157                                    RQ-COMPANY-CD-A2
  7158                                    RQ-COMPANY-CD-A3
  7159                                    RQ-COMPANY-CD-A4.
  7160
  7161     MOVE PI-SAV-FC-CARRIER      TO RQ-CARRIER-A1
  7162                                    RQ-CARRIER-A2
  7163                                    RQ-CARRIER-A3
  7164                                    PI-CR-CARRIER.
  7165
  7166     MOVE PI-SAV-FC-GROUPING     TO RQ-GROUPING-A1
  7167                                    RQ-GROUPING-A2
  7168                                    RQ-GROUPING-A3
  7169                                    PI-CR-GROUPING.
  7170
  7171     IF PI-ZERO-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 141
* EL630.cbl
  7172        MOVE ZERO                TO RQ-CARRIER-A2
  7173                                    PI-CR-CARRIER.
  7174
  7175     IF PI-ZERO-GROUPING
  7176        MOVE ZEROS               TO RQ-GROUPING-A2
  7177                                    PI-CR-GROUPING.
  7178
  7179     IF PI-ZERO-CAR-GROUP
  7180        MOVE ZEROS               TO RQ-CARRIER-A2
  7181                                    RQ-GROUPING-A2
  7182                                    PI-CR-CARRIER
  7183                                    PI-CR-GROUPING.
  7184
  7185     MOVE PI-SAV-FC-STATE        TO RQ-STATE-A1
  7186                                    PI-CR-STATE.
  7187
  7188     MOVE PI-SAV-ACCOUNT         TO RQ-ACCOUNT-A1
  7189                                    RQ-ACCOUNT-A4
  7190                                    PI-CR-ACCOUNT.
  7191
  7192
  7193     MOVE PI-ACCOUNT-AGENT       TO RQ-ACCT-AGENT-A2
  7194                                    RQ-ACCT-AGENT-A3.
  7195
  7196     MOVE WS-CURRENT-BIN-DT      TO RQ-ENTRY-DT.
  7197
  7198     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7199         MOVE PI-NB-MONTH-END-DT TO RQ-MO-END-DT
  7200     ELSE
  7201         MOVE PI-CR-MONTH-END-DT TO RQ-MO-END-DT.
  7202
  7203     MOVE LOW-VALUES             TO RQ-REQUEST-DT
  7204                                    RQ-STMT-DT
  7205                                    RQ-REVERSAL-DT
  7206                                    RQ-CREDIT-SELECT-DT
  7207                                    RQ-CREDIT-ACCEPT-DT.
  7208
  7209     IF PI-FIN-RESP-ERROR
  7210        MOVE 'E'                 TO RQ-STATUS
  7211        MOVE 'UNKNOWN'           TO RQ-FIN-RESP-A2
  7212                                    PI-CR-FIN-RESP
  7213     ELSE
  7214        MOVE PI-FIN-RESP         TO RQ-FIN-RESP-A2
  7215                                    PI-CR-FIN-RESP.
  7216
  7217     IF PI-ACCT-AGENT-ERROR
  7218        MOVE 'E'                 TO RQ-STATUS
  7219        MOVE 'UNKNOWN'           TO RQ-ACCT-AGENT-A2
  7220                                    RQ-ACCT-AGENT-A3.
  7221
  7222     IF WS-COMP-MASTER-ERROR
  7223        MOVE 'E'                 TO RQ-STATUS
  7224        MOVE 'UNKNOWN'           TO PI-CR-FIN-RESP.
  7225
  7226     MOVE RQ-CONTROL-PRIMARY     TO ERRQST-KEY.
  7227     MOVE LOW-VALUES             TO RQ-STMT-DT
  7228                                    RQ-REQUEST-DT
  7229                                    RQ-REVERSAL-DT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 142
* EL630.cbl
  7230
  7231     MOVE CO-AR-SUMMARY-CODE     TO RQ-SUMMARY-CODE.
  7232
  7233     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7234         MOVE PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT
  7235     ELSE
  7236         MOVE PI-CR-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  7237
  7238
  7239* EXEC CICS HANDLE CONDITION
  7240*        DUPREC (1990-EXIT)
  7241*    END-EXEC.
  7242*    MOVE '"$%                   ! , #00006802' TO DFHEIV0
  7243     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7245     MOVE X'2C20233030303036383032' TO DFHEIV0(25:11)
  7246     CALL 'kxdfhei1' USING DFHEIV0
  7247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7248
  7249
  7250
  7251* EXEC CICS WRITE
  7252*         DATASET    (ERRQST-FILE-ID)
  7253*         FROM       (AR-REQUEST-RECORD)
  7254*         RIDFLD     (ERRQST-KEY)
  7255*    END-EXEC.
  7256     MOVE LENGTH OF
  7257      AR-REQUEST-RECORD
  7258       TO DFHEIV11
  7259*    MOVE '&$ L                  ''   #00006806' TO DFHEIV0
  7260     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7261     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7262     MOVE X'2020233030303036383036' TO DFHEIV0(25:11)
  7263     CALL 'kxdfhei1' USING DFHEIV0,
  7264           ERRQST-FILE-ID,
  7265           AR-REQUEST-RECORD,
  7266           DFHEIV11,
  7267           ERRQST-KEY,
  7268           DFHEIV99,
  7269           DFHEIV99
  7270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7271
  7272
  7273 1990-EXIT.
  7274     EXIT.
  7275
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 143
* EL630.cbl
  7277 2000-WRITE-BATCH-TOTAL-REC.
  7278
  7279     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  7280     MOVE PI-SAV-ENTRY-BATCH     TO PNDB-ENTRY-BATCH.
  7281     MOVE 9999                   TO PNDB-BATCH-SEQ.
  7282
  7283
  7284* EXEC CICS HANDLE CONDITION
  7285*        NOTFND (2100-ADD-BATCH-TOTAL-REC)
  7286*    END-EXEC.
  7287*    MOVE '"$I                   ! - #00006822' TO DFHEIV0
  7288     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7290     MOVE X'2D20233030303036383232' TO DFHEIV0(25:11)
  7291     CALL 'kxdfhei1' USING DFHEIV0
  7292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7293
  7294
  7295
  7296* EXEC CICS READ
  7297*        SET    (ADDRESS OF PENDING-BUSINESS)
  7298*        DATASET(ERPNDB-FILE-ID)
  7299*        RIDFLD (ERPNDB-KEY)
  7300*        UPDATE
  7301*    END-EXEC.
  7302*    MOVE '&"S        EU         (   #00006826' TO DFHEIV0
  7303     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7304     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7305     MOVE X'2020233030303036383236' TO DFHEIV0(25:11)
  7306     CALL 'kxdfhei1' USING DFHEIV0,
  7307           ERPNDB-FILE-ID,
  7308           DFHEIV20,
  7309           DFHEIV99,
  7310           ERPNDB-KEY,
  7311           DFHEIV99,
  7312           DFHEIV99,
  7313           DFHEIV99
  7314     SET ADDRESS OF PENDING-BUSINESS TO
  7315         DFHEIV20
  7316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7317
  7318
  7319******************************************************************
  7320*    IF THE MONTH-END-DATE IN THE TRAILER RECORD (BATCH HEADER)  *
  7321*       IS NOT EQUAL TO THE ACCOUNTS MONTH-END-DATE AND THE      *
  7322*       OPERATOR HAS NOT ENTERED A NEW MONTH-END-DATE USE THE    *
  7323*       MONTH-END-DATE IN TRAILER RECORD FOR ALL DETAIL RECORDS. *
  7324******************************************************************
  7325
  7326     IF  PI-NB-MONTH-END-DT = SPACES
  7327         IF  PB-CREDIT-SELECT-DT = PI-CR-MONTH-END-DT
  7328             NEXT SENTENCE
  7329         ELSE
  7330             MOVE PB-CREDIT-SELECT-DT  TO  PI-NB-MONTH-END-DT.
  7331
  7332     IF PI-AR-PROCESSING
  7333        IF REFL = ZEROS
  7334           IF PB-REFERENCE GREATER SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 144
* EL630.cbl
  7335              MOVE PB-REFERENCE  TO PI-SAV-REFERENCE
  7336           ELSE
  7337              NEXT SENTENCE
  7338        ELSE
  7339           IF PI-SAV-REFERENCE NOT = PB-REFERENCE
  7340              MOVE 'Y'              TO WS-UPDATE-REFERENCE-SW
  7341                                       WS-RECORD-FOUND-SW
  7342              PERFORM 7100-REWRITE-REQUEST-REC THRU 7190-EXIT
  7343              IF RECORD-NOT-FOUND
  7344                  GO TO 8200-SEND-DATAONLY
  7345              ELSE
  7346                  MOVE PI-SAV-REFERENCE TO PB-REFERENCE.
  7347
  7348     IF ELFISSL NOT = ZEROS
  7349         MOVE PI-LF-ISS-REMITTED  TO PB-B-LF-ISS-PRM-REMITTED.
  7350     IF EAHISSL NOT = ZEROS
  7351         MOVE PI-AH-ISS-REMITTED  TO PB-B-AH-ISS-PRM-REMITTED.
  7352     IF EISSCNTL NOT = ZEROS
  7353         MOVE PI-ISS-CNT-REMITTED TO PB-B-ISSUE-CNT-REMITTED.
  7354     IF ECANCNTL NOT = ZEROS
  7355         MOVE PI-CAN-CNT-REMITTED TO PB-B-CANCEL-CNT-REMITTED.
  7356     IF ELFCANL NOT = ZEROS
  7357         MOVE PI-LF-CAN-REMITTED  TO PB-B-LF-CAN-PRM-REMITTED.
  7358     IF EAHCANL NOT = ZEROS
  7359         MOVE PI-AH-CAN-REMITTED  TO PB-B-AH-CAN-PRM-REMITTED.
  7360
  7361     IF WS-PF1
  7362         MOVE PI-LF-ISS-ENTERED   TO PB-B-LF-ISS-PRM-ENTERED
  7363         MOVE PI-AH-ISS-ENTERED   TO PB-B-AH-ISS-PRM-ENTERED
  7364         MOVE PI-ISS-CNT-ENTERED  TO PB-B-ISSUE-CNT-ENTERED
  7365         MOVE PI-CAN-CNT-ENTERED  TO PB-B-CANCEL-CNT-ENTERED
  7366         MOVE PI-LF-CAN-ENTERED   TO PB-B-LF-CAN-PRM-ENTERED
  7367         MOVE PI-AH-CAN-ENTERED   TO PB-B-AH-CAN-PRM-ENTERED
  7368         MOVE PI-LAST-SEQ-NO-ADDED TO PB-B-HIGHEST-SEQ-NO.
  7369
  7370     MOVE PI-RECEIVED-DT         TO PB-B-RECEIVED-DT.
  7371
  7372     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  7373     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  7374     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
  7375
  7376     IF PI-AR-PROCESSING
  7377        IF PI-DATA-UPDATED
  7378           PERFORM 1400-VERIFY-COMP-MASTER   THRU 1490-EXIT
  7379           PERFORM 1900-WRITE-REQUEST-RECORD THRU 1990-EXIT
  7380           IF PI-MAINT-FUNC NOT = 'K'
  7381              MOVE PI-SAV-REFERENCE TO PB-REFERENCE.
  7382
  7383
  7384* EXEC CICS REWRITE
  7385*        DATASET(ERPNDB-FILE-ID)
  7386*        FROM   (PENDING-BUSINESS)
  7387*    END-EXEC.
  7388     MOVE LENGTH OF
  7389      PENDING-BUSINESS
  7390       TO DFHEIV11
  7391*    MOVE '&& L                  %   #00006897' TO DFHEIV0
  7392     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 145
* EL630.cbl
  7393     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7394     MOVE X'2020233030303036383937' TO DFHEIV0(25:11)
  7395     CALL 'kxdfhei1' USING DFHEIV0,
  7396           ERPNDB-FILE-ID,
  7397           PENDING-BUSINESS,
  7398           DFHEIV11,
  7399           DFHEIV99
  7400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7401
  7402
  7403     IF  PI-AR-PROCESSING
  7404         IF WS-UPDATE-REFERENCE
  7405            PERFORM 5000-UPDATE-ENTIRE-BATCH THRU 5900-EXIT
  7406            GO TO 2990-EXIT.
  7407
  7408     IF PI-NB-MONTH-END-DT = PB-CREDIT-SELECT-DT
  7409        GO TO 2990-EXIT.
  7410
  7411     IF PI-NB-MONTH-END-DT GREATER SPACES
  7412         PERFORM 5000-UPDATE-ENTIRE-BATCH THRU 5900-EXIT
  7413             IF PI-AR-PROCESSING
  7414                 MOVE 'Y'          TO WS-RECORD-FOUND-SW
  7415                 PERFORM 7200-REWRITE-REQUEST THRU 7299-EXIT
  7416                 IF RECORD-NOT-FOUND
  7417                     GO TO 8200-SEND-DATAONLY.
  7418
  7419     GO TO 2990-EXIT.
  7420
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 146
* EL630.cbl
  7422
  7423 2100-ADD-BATCH-TOTAL-REC.
  7424
  7425* EXEC CICS GETMAIN
  7426*        SET    (ADDRESS OF PENDING-BUSINESS)
  7427*        LENGTH (585)
  7428*        INITIMG(GETMAIN-SPACE)
  7429*    END-EXEC.
  7430     MOVE 585
  7431       TO DFHEIV11
  7432*    MOVE ',"IL                  $   #00006923' TO DFHEIV0
  7433     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7434     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7435     MOVE X'2020233030303036393233' TO DFHEIV0(25:11)
  7436     CALL 'kxdfhei1' USING DFHEIV0,
  7437           DFHEIV20,
  7438           DFHEIV11,
  7439           GETMAIN-SPACE
  7440     SET ADDRESS OF PENDING-BUSINESS TO
  7441         DFHEIV20
  7442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7443
  7444
  7445     MOVE 'PB'                   TO PB-RECORD-ID.
  7446     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD
  7447                                    PB-COMPANY-CD-A1.
  7448     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
  7449     MOVE PI-SAV-ENTRY-BATCH     TO PB-ENTRY-BATCH
  7450                                    PB-CERT-NO.
  7451     MOVE 9999                   TO PB-BATCH-SEQ-NO.
  7452     MOVE HIGH-VALUES            TO PB-CERT-EFF-DT.
  7453     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  7454                                    PB-ALT-CHG-SEQ-NO.
  7455
  7456     IF REFL GREATER THAN +0
  7457        MOVE REFI                TO PB-REFERENCE
  7458                                    PI-SAV-REFERENCE.
  7459
  7460     IF PI-LF-ISS-REMITTED     NOT NUMERIC
  7461        MOVE +0                  TO PI-LF-ISS-REMITTED.
  7462
  7463     IF PI-LF-ISS-ENTERED      NOT NUMERIC
  7464        MOVE +0                  TO PI-LF-ISS-ENTERED.
  7465
  7466     IF PI-AH-ISS-REMITTED     NOT NUMERIC
  7467        MOVE +0                  TO PI-AH-ISS-REMITTED.
  7468
  7469     IF PI-AH-ISS-ENTERED      NOT NUMERIC
  7470        MOVE +0                  TO PI-AH-ISS-ENTERED.
  7471
  7472     IF PI-ISS-CNT-REMITTED    NOT NUMERIC
  7473        MOVE +0                  TO PI-ISS-CNT-REMITTED.
  7474
  7475     IF PI-ISS-CNT-ENTERED     NOT NUMERIC
  7476        MOVE +0                  TO PI-ISS-CNT-ENTERED.
  7477
  7478     IF PI-CAN-CNT-REMITTED    NOT NUMERIC
  7479        MOVE +0                  TO PI-CAN-CNT-REMITTED.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 147
* EL630.cbl
  7480
  7481     IF PI-CAN-CNT-ENTERED     NOT NUMERIC
  7482        MOVE +0                  TO PI-CAN-CNT-ENTERED.
  7483
  7484     IF PI-LF-CAN-REMITTED     NOT NUMERIC
  7485        MOVE +0                  TO PI-LF-CAN-REMITTED.
  7486
  7487     IF PI-LF-CAN-ENTERED      NOT NUMERIC
  7488        MOVE +0                  TO PI-LF-CAN-ENTERED.
  7489
  7490     IF PI-LF-CAN-REMITTED     NOT NUMERIC
  7491        MOVE +0                  TO PI-LF-CAN-REMITTED.
  7492
  7493     IF PI-AH-CAN-REMITTED     NOT NUMERIC
  7494        MOVE +0                  TO PI-AH-CAN-REMITTED.
  7495
  7496     IF PI-AH-CAN-ENTERED      NOT NUMERIC
  7497        MOVE +0                  TO PI-AH-CAN-ENTERED.
  7498
  7499
  7500     MOVE PI-SAV-CARRIER         TO PB-CARRIER.
  7501     MOVE PI-SAV-GROUPING        TO PB-GROUPING.
  7502     MOVE PI-SAV-STATE           TO PB-STATE.
  7503     MOVE PI-SAV-ACCOUNT         TO PB-ACCOUNT.
  7504     MOVE '9'                    TO PB-RECORD-TYPE.
  7505     MOVE PI-LF-ISS-REMITTED     TO PB-B-LF-ISS-PRM-REMITTED.
  7506     MOVE PI-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED.
  7507     MOVE PI-AH-ISS-REMITTED     TO PB-B-AH-ISS-PRM-REMITTED.
  7508     MOVE PI-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED.
  7509     MOVE PI-ISS-CNT-REMITTED    TO PB-B-ISSUE-CNT-REMITTED.
  7510     MOVE PI-ISS-CNT-ENTERED     TO PB-B-ISSUE-CNT-ENTERED.
  7511     MOVE PI-CAN-CNT-REMITTED    TO PB-B-CANCEL-CNT-REMITTED.
  7512     MOVE PI-CAN-CNT-ENTERED     TO PB-B-CANCEL-CNT-ENTERED.
  7513     MOVE PI-LF-CAN-REMITTED     TO PB-B-LF-CAN-PRM-REMITTED.
  7514     MOVE PI-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED.
  7515     MOVE PI-AH-CAN-REMITTED     TO PB-B-AH-CAN-PRM-REMITTED.
  7516     MOVE PI-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED.
  7517     MOVE ZEROS                  TO PB-B-LF-ISS-PRM-COMPUTED
  7518                                    PB-B-LF-CAN-PRM-COMPUTED
  7519                                    PB-B-AH-ISS-PRM-COMPUTED
  7520                                    PB-B-AH-CAN-PRM-COMPUTED
  7521                                    PB-LF-BILLED-AMTS
  7522                                    PB-AH-BILLED-AMTS
  7523                                    PB-CHG-COUNT
  7524                                    PB-CALC-TOLERANCE.
  7525     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  7526                                    PB-BILLED-DT
  7527                                    PB-ACCT-EFF-DT
  7528                                    PB-ACCT-EXP-DT.
  7529
  7530     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7531         MOVE PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT
  7532        ELSE
  7533         MOVE PI-CR-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  7534
  7535     MOVE PI-LAST-SEQ-NO-ADDED   TO PB-B-HIGHEST-SEQ-NO.
  7536
  7537     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 148
* EL630.cbl
  7538                                    PB-INPUT-BY.
  7539     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  7540     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
  7541                                    PB-INPUT-DT.
  7542
  7543     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
  7544
  7545     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
  7546     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
  7547     MOVE PI-CSR-ID              TO PB-CSR-ID.
  7548     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
  7549     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
  7550
  7551     MOVE PI-RECEIVED-DT         TO PB-B-RECEIVED-DT.
  7552
  7553     MOVE PI-AM-NAME             TO  PB-ACCOUNT-NAME.
  7554     MOVE PI-SAV-FC-CARRIER      TO  PB-SV-CARRIER.
  7555     MOVE PI-SAV-FC-GROUPING     TO  PB-SV-GROUPING.
  7556     MOVE PI-SAV-FC-STATE        TO  PB-SV-STATE.
  7557
  7558     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-KEY.
  7559
  7560
  7561* EXEC CICS WRITE
  7562*        DATASET(ERPNDB-FILE-ID)
  7563*        FROM   (PENDING-BUSINESS)
  7564*        RIDFLD (PB-CONTROL-PRIMARY)
  7565*    END-EXEC.
  7566     MOVE LENGTH OF
  7567      PENDING-BUSINESS
  7568       TO DFHEIV11
  7569*    MOVE '&$ L                  ''   #00007044' TO DFHEIV0
  7570     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7571     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7572     MOVE X'2020233030303037303434' TO DFHEIV0(25:11)
  7573     CALL 'kxdfhei1' USING DFHEIV0,
  7574           ERPNDB-FILE-ID,
  7575           PENDING-BUSINESS,
  7576           DFHEIV11,
  7577           PB-CONTROL-PRIMARY,
  7578           DFHEIV99,
  7579           DFHEIV99
  7580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7581
  7582
  7583 2990-EXIT.
  7584     EXIT.
  7585
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 149
* EL630.cbl
  7587 3000-DELETE-ENTERED-BATCH.
  7588     MOVE SPACE          TO PI-NB-MONTH-END-DT
  7589                            PI-SAV-REFERENCE.
  7590
  7591     IF NOT PI-DELETE-IS-OK
  7592         MOVE 'Y'                TO PI-VERIFY-DELETE-SW
  7593         GO TO 3300-FIRST-PF2.
  7594
  7595     MOVE SPACE                  TO PI-ACCT-AGENT-PROCESSED-SW
  7596                                    PI-VERIFY-DELETE-SW.
  7597     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  7598     MOVE PI-SAV-ENTRY-BATCH     TO PNDB-ENTRY-BATCH.
  7599     MOVE 1                      TO PNDB-BATCH-SEQ.
  7600
  7601
  7602* EXEC CICS SYNCPOINT
  7603*    END-EXEC.
  7604*    MOVE '6"                    !   #00007068' TO DFHEIV0
  7605     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7607     MOVE X'2020233030303037303638' TO DFHEIV0(25:11)
  7608     CALL 'kxdfhei1' USING DFHEIV0
  7609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7610
  7611
  7612
  7613* EXEC CICS HANDLE CONDITION
  7614*        NOTFND(3200-NO-RECORDS)
  7615*    END-EXEC.
  7616*    MOVE '"$I                   ! . #00007071' TO DFHEIV0
  7617     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7619     MOVE X'2E20233030303037303731' TO DFHEIV0(25:11)
  7620     CALL 'kxdfhei1' USING DFHEIV0
  7621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7622
  7623
  7624
  7625* EXEC CICS STARTBR
  7626*        DATASET(ERPNDB-FILE-ID)
  7627*        RIDFLD(ERPNDB-KEY)
  7628*    END-EXEC.
  7629     MOVE 0
  7630       TO DFHEIV11
  7631*    MOVE '&,         G          &   #00007075' TO DFHEIV0
  7632     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7633     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7634     MOVE X'2020233030303037303735' TO DFHEIV0(25:11)
  7635     CALL 'kxdfhei1' USING DFHEIV0,
  7636           ERPNDB-FILE-ID,
  7637           ERPNDB-KEY,
  7638           DFHEIV99,
  7639           DFHEIV11,
  7640           DFHEIV99
  7641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7642
  7643
  7644 3000-GET-NEXT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 150
* EL630.cbl
  7645
  7646* EXEC CICS HANDLE CONDITION
  7647*        NOTFND(3120-END-ROUTINE)
  7648*    END-EXEC.
  7649*    MOVE '"$I                   ! / #00007081' TO DFHEIV0
  7650     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7652     MOVE X'2F20233030303037303831' TO DFHEIV0(25:11)
  7653     CALL 'kxdfhei1' USING DFHEIV0
  7654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7655
  7656
  7657     ADD +1                      TO  WS-SYNC-CNTR.
  7658
  7659     IF WS-SYNC-CNTR GREATER +100
  7660         MOVE +0                 TO  WS-SYNC-CNTR
  7661
  7662* EXEC  CICS SYNCPOINT
  7663*        END-EXEC.
  7664*    MOVE '6"                    !   #00007089' TO DFHEIV0
  7665     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7667     MOVE X'2020233030303037303839' TO DFHEIV0(25:11)
  7668     CALL 'kxdfhei1' USING DFHEIV0
  7669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7670
  7671
  7672     IF WS-ON1-SW3 IS EQUAL TO 'Y'
  7673         MOVE 'N'                TO  WS-ON1-SW3
  7674         GO TO 3005-READ-NEXT-RECORD.
  7675
  7676
  7677* EXEC CICS STARTBR
  7678*        DATASET(ERPNDB-FILE-ID)
  7679*        RIDFLD (ERPNDB-KEY)
  7680*    END-EXEC.
  7681     MOVE 0
  7682       TO DFHEIV11
  7683*    MOVE '&,         G          &   #00007096' TO DFHEIV0
  7684     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7685     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7686     MOVE X'2020233030303037303936' TO DFHEIV0(25:11)
  7687     CALL 'kxdfhei1' USING DFHEIV0,
  7688           ERPNDB-FILE-ID,
  7689           ERPNDB-KEY,
  7690           DFHEIV99,
  7691           DFHEIV11,
  7692           DFHEIV99
  7693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7694
  7695
  7696
  7697* EXEC CICS HANDLE CONDITION
  7698*        NOTFND (3100-STOP-BROWSE)
  7699*        ENDFILE(3100-STOP-BROWSE)
  7700*    END-EXEC.
  7701*    MOVE '"$I''                  ! 0 #00007101' TO DFHEIV0
  7702     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 151
* EL630.cbl
  7703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7704     MOVE X'3020233030303037313031' TO DFHEIV0(25:11)
  7705     CALL 'kxdfhei1' USING DFHEIV0
  7706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7707
  7708
  7709 3005-READ-NEXT-RECORD.
  7710
  7711* EXEC CICS READNEXT
  7712*        SET    (ADDRESS OF PENDING-BUSINESS)
  7713*        DATASET(ERPNDB-FILE-ID)
  7714*        RIDFLD (ERPNDB-KEY)
  7715*    END-EXEC.
  7716     MOVE 0
  7717       TO DFHEIV11
  7718*    MOVE '&.S                   )   #00007107' TO DFHEIV0
  7719     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7720     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7721     MOVE X'2020233030303037313037' TO DFHEIV0(25:11)
  7722     CALL 'kxdfhei1' USING DFHEIV0,
  7723           ERPNDB-FILE-ID,
  7724           DFHEIV20,
  7725           DFHEIV99,
  7726           ERPNDB-KEY,
  7727           DFHEIV99,
  7728           DFHEIV11,
  7729           DFHEIV99,
  7730           DFHEIV99
  7731     SET ADDRESS OF PENDING-BUSINESS TO
  7732         DFHEIV20
  7733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7734
  7735
  7736     IF PB-COMPANY-CD  = PI-SAV-COMP-CD AND
  7737        PB-ENTRY-BATCH = PI-SAV-ENTRY-BATCH
  7738         NEXT SENTENCE
  7739     ELSE
  7740         GO TO 3100-STOP-BROWSE.
  7741
  7742     IF PB-BILLED-DT NOT = LOW-VALUES
  7743
  7744* EXEC CICS SYNCPOINT ROLLBACK
  7745*        END-EXEC
  7746*    MOVE '6"R                   !   #00007120' TO DFHEIV0
  7747     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  7748     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7749     MOVE X'2020233030303037313230' TO DFHEIV0(25:11)
  7750     CALL 'kxdfhei1' USING DFHEIV0
  7751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7752         MOVE ER-2402            TO EMI-ERROR
  7753         MOVE -1                 TO BATCHL
  7754         MOVE AL-UABON           TO BATCHA
  7755         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7756         GO TO 8200-SEND-DATAONLY.
  7757
  7758******************************************************************
  7759*                DELETE PENDING ADDRESS RECORD                   *
  7760******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 152
* EL630.cbl
  7761
  7762     IF PB-I-MAIL-ADDRS-PRESENT
  7763        NEXT SENTENCE
  7764       ELSE
  7765        GO TO 3006-DELETE-CERTIFICATE.
  7766
  7767
  7768* EXEC CICS HANDLE CONDITION
  7769*         NOTOPEN  (3006-DELETE-CERTIFICATE)
  7770*         NOTFND   (3006-DELETE-CERTIFICATE)
  7771*    END-EXEC.
  7772*    MOVE '"$JI                  ! 1 #00007137' TO DFHEIV0
  7773     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7775     MOVE X'3120233030303037313337' TO DFHEIV0(25:11)
  7776     CALL 'kxdfhei1' USING DFHEIV0
  7777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7778
  7779
  7780
  7781* EXEC CICS READ
  7782*        EQUAL
  7783*        DATASET   (ERPNDM-FILE-ID)
  7784*        SET       (ADDRESS OF PENDING-MAILING-DATA)
  7785*        RIDFLD    (ERPNDB-KEY)
  7786*        UPDATE
  7787*    END-EXEC.
  7788*    MOVE '&"S        EU         (   #00007142' TO DFHEIV0
  7789     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7790     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7791     MOVE X'2020233030303037313432' TO DFHEIV0(25:11)
  7792     CALL 'kxdfhei1' USING DFHEIV0,
  7793           ERPNDM-FILE-ID,
  7794           DFHEIV20,
  7795           DFHEIV99,
  7796           ERPNDB-KEY,
  7797           DFHEIV99,
  7798           DFHEIV99,
  7799           DFHEIV99
  7800     SET ADDRESS OF PENDING-MAILING-DATA TO
  7801         DFHEIV20
  7802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7803
  7804
  7805
  7806* EXEC CICS DELETE
  7807*        DATASET   (ERPNDM-FILE-ID)
  7808*    END-EXEC.
  7809*    MOVE '&(                    &   #00007150' TO DFHEIV0
  7810     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7811     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7812     MOVE X'2020233030303037313530' TO DFHEIV0(25:11)
  7813     CALL 'kxdfhei1' USING DFHEIV0,
  7814           ERPNDM-FILE-ID,
  7815           DFHEIV99,
  7816           DFHEIV99,
  7817           DFHEIV99,
  7818           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 153
* EL630.cbl
  7819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7820
  7821
  7822 3006-DELETE-CERTIFICATE.
  7823     IF PB-BATCH-TRAILER
  7824        GO TO 3020-CONTINUE-DELETE.
  7825
  7826
  7827* EXEC CICS HANDLE CONDITION
  7828*         NOTFND  (3020-CONTINUE-DELETE)
  7829*    END-EXEC.
  7830*    MOVE '"$I                   ! 2 #00007158' TO DFHEIV0
  7831     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7832     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7833     MOVE X'3220233030303037313538' TO DFHEIV0(25:11)
  7834     CALL 'kxdfhei1' USING DFHEIV0
  7835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7836
  7837
  7838     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
  7839     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7840     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7841     MOVE PB-SV-STATE            TO CERT-STATE.
  7842
  7843* EXEC CICS READ
  7844*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  7845*        DATASET (ELCERT-FILE-ID)
  7846*        RIDFLD  (ELCERT-KEY)
  7847*        UPDATE
  7848*    END-EXEC.
  7849*    MOVE '&"S        EU         (   #00007166' TO DFHEIV0
  7850     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7851     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7852     MOVE X'2020233030303037313636' TO DFHEIV0(25:11)
  7853     CALL 'kxdfhei1' USING DFHEIV0,
  7854           ELCERT-FILE-ID,
  7855           DFHEIV20,
  7856           DFHEIV99,
  7857           ELCERT-KEY,
  7858           DFHEIV99,
  7859           DFHEIV99,
  7860           DFHEIV99
  7861     SET ADDRESS OF CERTIFICATE-MASTER TO
  7862         DFHEIV20
  7863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7864
  7865
  7866     IF INSURED-ADDR-PRESENT
  7867        MOVE 'Y'                  TO WS-CERT-ADDRESS-SW
  7868     ELSE
  7869        MOVE ' '                  TO WS-CERT-ADDRESS-SW.
  7870
  7871     IF  CERT-NOTES-ARE-NOT-PRESENT
  7872         MOVE ' '                TO WS-CERT-NOTE-SW
  7873     ELSE
  7874         MOVE 'Y'                TO WS-CERT-NOTE-SW.
  7875
  7876     IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 154
* EL630.cbl
  7877        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  7878           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7879           MOVE ZERO                  TO CM-LF-ITD-CANCEL-AMT
  7880           MOVE LOW-VALUES            TO CM-LF-CANCEL-EXIT-DT
  7881                                         CM-LF-CANCEL-DT
  7882           MOVE SPACE                 TO CM-LF-EXIT-BATCH
  7883        ELSE
  7884           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7885           MOVE PB-CI-LF-CANCEL-AMT   TO CM-LF-ITD-CANCEL-AMT
  7886           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
  7887           MOVE PB-CI-LIVES              TO CM-LIVES.
  7888
  7889     IF PB-CANCELLATION
  7890        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  7891           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL SPACE
  7892               MOVE CM-LF-STATUS-AT-CANCEL
  7893                                        TO CM-LF-CURRENT-STATUS
  7894               MOVE SPACE
  7895                                        TO CM-LF-STATUS-AT-CANCEL
  7896            ELSE
  7897               MOVE PB-CI-LF-POLICY-STATUS
  7898                                        TO CM-LF-CURRENT-STATUS
  7899        ELSE
  7900            MOVE PB-CI-LF-POLICY-STATUS TO CM-LF-CURRENT-STATUS.
  7901
  7902     IF PB-CANCELLATION
  7903        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  7904           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7905           MOVE ZERO                  TO CM-AH-ITD-CANCEL-AMT
  7906           MOVE LOW-VALUES            TO CM-AH-CANCEL-EXIT-DT
  7907                                         CM-AH-CANCEL-DT
  7908           MOVE SPACE                 TO CM-AH-EXIT-BATCH
  7909        ELSE
  7910           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7911           MOVE PB-CI-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT
  7912           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
  7913           MOVE PB-CI-LIVES           TO CM-LIVES.
  7914
  7915     IF PB-CANCELLATION
  7916        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  7917           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL SPACE
  7918               MOVE CM-AH-STATUS-AT-CANCEL
  7919                                        TO CM-AH-CURRENT-STATUS
  7920               MOVE SPACE
  7921                                        TO CM-AH-STATUS-AT-CANCEL
  7922               GO TO 3010-REWRITE-CERT
  7923            ELSE
  7924               MOVE PB-CI-AH-POLICY-STATUS
  7925                                        TO CM-AH-CURRENT-STATUS
  7926               GO TO 3010-REWRITE-CERT
  7927        ELSE
  7928            MOVE PB-CI-AH-POLICY-STATUS TO CM-AH-CURRENT-STATUS
  7929            GO TO 3010-REWRITE-CERT.
  7930
  7931******************************************************************
  7932******************************************************************
  7933******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
  7934******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 155
* EL630.cbl
  7935******************************************************************
  7936******************************************************************
  7937
  7938     IF CERT-ADDED-BATCH AND
  7939        (NOT NO-CLAIM-ATTACHED
  7940         OR
  7941         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
  7942        GO TO 3010-REWRITE-CERT.
  7943
  7944******************************************************************
  7945******************************************************************
  7946
  7947     IF CERT-ADDED-BATCH  AND
  7948        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
  7949        GO TO 3010-REWRITE-CERT.
  7950
  7951     IF NO-CLAIM-ATTACHED
  7952         NEXT SENTENCE
  7953       ELSE
  7954         MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
  7955         MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
  7956         GO TO 3010-REWRITE-CERT.
  7957
  7958
  7959* EXEC CICS DELETE
  7960*            DATASET    (ELCERT-FILE-ID)
  7961*       END-EXEC.
  7962*    MOVE '&(                    &   #00007265' TO DFHEIV0
  7963     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7964     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7965     MOVE X'2020233030303037323635' TO DFHEIV0(25:11)
  7966     CALL 'kxdfhei1' USING DFHEIV0,
  7967           ELCERT-FILE-ID,
  7968           DFHEIV99,
  7969           DFHEIV99,
  7970           DFHEIV99,
  7971           DFHEIV99
  7972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7973
  7974
  7975******************************************************************
  7976*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
  7977******************************************************************
  7978
  7979     IF CERT-NOTES-ARE-PRESENT
  7980        NEXT SENTENCE
  7981     ELSE
  7982        GO TO 3007-DELETE-MAILING-DATA.
  7983
  7984
  7985* EXEC CICS HANDLE CONDITION
  7986*         NOTFND  (3006-DELETE-ERNOTE)
  7987*    END-EXEC.
  7988*    MOVE '"$I                   ! 3 #00007278' TO DFHEIV0
  7989     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7991     MOVE X'3320233030303037323738' TO DFHEIV0(25:11)
  7992     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 156
* EL630.cbl
  7993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7994
  7995
  7996     MOVE ELCERT-KEY            TO ERCNOT-KEY.
  7997     MOVE '0'                   TO ERCNOT-REC-TYPE.
  7998     MOVE 0                     TO ERCNOT-SEQUENCE.
  7999
  8000 3006-DELETE-ERCNOT-LOOP.
  8001
  8002
  8003* EXEC CICS READ
  8004*        GTEQ
  8005*        DATASET   (ERCNOT-FILE-ID)
  8006*        SET       (ADDRESS OF CERT-NOTE-FILE)
  8007*        RIDFLD    (ERCNOT-KEY)
  8008*    END-EXEC.
  8009*    MOVE '&"S        G          (   #00007288' TO DFHEIV0
  8010     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8011     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8012     MOVE X'2020233030303037323838' TO DFHEIV0(25:11)
  8013     CALL 'kxdfhei1' USING DFHEIV0,
  8014           ERCNOT-FILE-ID,
  8015           DFHEIV20,
  8016           DFHEIV99,
  8017           ERCNOT-KEY,
  8018           DFHEIV99,
  8019           DFHEIV99,
  8020           DFHEIV99
  8021     SET ADDRESS OF CERT-NOTE-FILE TO
  8022         DFHEIV20
  8023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8024
  8025
  8026     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
  8027     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
  8028         GO TO 3006-DELETE-ERNOTE
  8029     END-IF.
  8030
  8031
  8032* EXEC CICS DELETE
  8033*        DATASET   (ERCNOT-FILE-ID)
  8034*        RIDFLD    (ERCNOT-KEY)
  8035*        END-EXEC.
  8036*    MOVE '&(  R                 &   #00007300' TO DFHEIV0
  8037     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8038     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8039     MOVE X'2020233030303037333030' TO DFHEIV0(25:11)
  8040     CALL 'kxdfhei1' USING DFHEIV0,
  8041           ERCNOT-FILE-ID,
  8042           ERCNOT-KEY,
  8043           DFHEIV99,
  8044           DFHEIV99,
  8045           DFHEIV99
  8046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8047
  8048
  8049     GO TO 3006-DELETE-ERCNOT-LOOP.
  8050
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 157
* EL630.cbl
  8051 3006-DELETE-ERNOTE.
  8052
  8053
  8054* EXEC CICS HANDLE CONDITION
  8055*         NOTFND   (3007-DELETE-MAILING-DATA)
  8056*    END-EXEC.
  8057*    MOVE '"$I                   ! 4 #00007309' TO DFHEIV0
  8058     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8060     MOVE X'3420233030303037333039' TO DFHEIV0(25:11)
  8061     CALL 'kxdfhei1' USING DFHEIV0
  8062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8063
  8064
  8065
  8066* EXEC CICS READ
  8067*        EQUAL
  8068*        DATASET   (ERNOTE-FILE-ID)
  8069*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  8070*        RIDFLD    (ELCERT-KEY)
  8071*        UPDATE
  8072*    END-EXEC.
  8073*    MOVE '&"S        EU         (   #00007313' TO DFHEIV0
  8074     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8075     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8076     MOVE X'2020233030303037333133' TO DFHEIV0(25:11)
  8077     CALL 'kxdfhei1' USING DFHEIV0,
  8078           ERNOTE-FILE-ID,
  8079           DFHEIV20,
  8080           DFHEIV99,
  8081           ELCERT-KEY,
  8082           DFHEIV99,
  8083           DFHEIV99,
  8084           DFHEIV99
  8085     SET ADDRESS OF CERTIFICATE-NOTE TO
  8086         DFHEIV20
  8087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8088
  8089
  8090
  8091* EXEC CICS DELETE
  8092*        DATASET   (ERNOTE-FILE-ID)
  8093*    END-EXEC.
  8094*    MOVE '&(                    &   #00007321' TO DFHEIV0
  8095     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8096     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8097     MOVE X'2020233030303037333231' TO DFHEIV0(25:11)
  8098     CALL 'kxdfhei1' USING DFHEIV0,
  8099           ERNOTE-FILE-ID,
  8100           DFHEIV99,
  8101           DFHEIV99,
  8102           DFHEIV99,
  8103           DFHEIV99
  8104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8105
  8106
  8107******************************************************************
  8108*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 158
* EL630.cbl
  8109******************************************************************
  8110
  8111 3007-DELETE-MAILING-DATA.
  8112     IF CERT-ADDRESS-PRESENT
  8113        NEXT SENTENCE
  8114     ELSE
  8115        GO TO 3020-CONTINUE-DELETE.
  8116
  8117
  8118* EXEC CICS HANDLE CONDITION
  8119*         NOTOPEN  (3020-CONTINUE-DELETE)
  8120*         NOTFND   (3020-CONTINUE-DELETE)
  8121*    END-EXEC.
  8122*    MOVE '"$JI                  ! 5 #00007335' TO DFHEIV0
  8123     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8124     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8125     MOVE X'3520233030303037333335' TO DFHEIV0(25:11)
  8126     CALL 'kxdfhei1' USING DFHEIV0
  8127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8128
  8129
  8130
  8131* EXEC CICS READ
  8132*        EQUAL
  8133*        DATASET   (ERMAIL-FILE-ID)
  8134*        SET       (ADDRESS OF MAILING-DATA)
  8135*        RIDFLD    (ELCERT-KEY)
  8136*        UPDATE
  8137*    END-EXEC.
  8138*    MOVE '&"S        EU         (   #00007340' TO DFHEIV0
  8139     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8140     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8141     MOVE X'2020233030303037333430' TO DFHEIV0(25:11)
  8142     CALL 'kxdfhei1' USING DFHEIV0,
  8143           ERMAIL-FILE-ID,
  8144           DFHEIV20,
  8145           DFHEIV99,
  8146           ELCERT-KEY,
  8147           DFHEIV99,
  8148           DFHEIV99,
  8149           DFHEIV99
  8150     SET ADDRESS OF MAILING-DATA TO
  8151         DFHEIV20
  8152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8153
  8154
  8155
  8156* EXEC CICS DELETE
  8157*        DATASET   (ERMAIL-FILE-ID)
  8158*    END-EXEC.
  8159*    MOVE '&(                    &   #00007348' TO DFHEIV0
  8160     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8161     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8162     MOVE X'2020233030303037333438' TO DFHEIV0(25:11)
  8163     CALL 'kxdfhei1' USING DFHEIV0,
  8164           ERMAIL-FILE-ID,
  8165           DFHEIV99,
  8166           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 159
* EL630.cbl
  8167           DFHEIV99,
  8168           DFHEIV99
  8169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8170
  8171
  8172     GO TO 3020-CONTINUE-DELETE.
  8173
  8174 3010-REWRITE-CERT.
  8175
  8176
  8177* EXEC CICS REWRITE
  8178*        DATASET    (ELCERT-FILE-ID)
  8179*        FROM       (CERTIFICATE-MASTER)
  8180*    END-EXEC.
  8181     MOVE LENGTH OF
  8182      CERTIFICATE-MASTER
  8183       TO DFHEIV11
  8184*    MOVE '&& L                  %   #00007356' TO DFHEIV0
  8185     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8186     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8187     MOVE X'2020233030303037333536' TO DFHEIV0(25:11)
  8188     CALL 'kxdfhei1' USING DFHEIV0,
  8189           ELCERT-FILE-ID,
  8190           CERTIFICATE-MASTER,
  8191           DFHEIV11,
  8192           DFHEIV99
  8193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8194
  8195
  8196 3020-CONTINUE-DELETE.
  8197
  8198
  8199* EXEC CICS ENDBR
  8200*        DATASET(ERPNDB-FILE-ID)
  8201*    END-EXEC.
  8202     MOVE 0
  8203       TO DFHEIV11
  8204*    MOVE '&2                    $   #00007363' TO DFHEIV0
  8205     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8206     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8207     MOVE X'2020233030303037333633' TO DFHEIV0(25:11)
  8208     CALL 'kxdfhei1' USING DFHEIV0,
  8209           ERPNDB-FILE-ID,
  8210           DFHEIV11,
  8211           DFHEIV99
  8212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8213
  8214
  8215
  8216* EXEC CICS DELETE
  8217*        DATASET(ERPNDB-FILE-ID)
  8218*        RIDFLD (ERPNDB-KEY)
  8219*    END-EXEC.
  8220*    MOVE '&(  R                 &   #00007367' TO DFHEIV0
  8221     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8222     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8223     MOVE X'2020233030303037333637' TO DFHEIV0(25:11)
  8224     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 160
* EL630.cbl
  8225           ERPNDB-FILE-ID,
  8226           ERPNDB-KEY,
  8227           DFHEIV99,
  8228           DFHEIV99,
  8229           DFHEIV99
  8230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8231
  8232
  8233     ADD 1   TO WS-DELETE-CNT.
  8234     GO TO 3000-GET-NEXT-RECORD.
  8235
  8236 3100-STOP-BROWSE.
  8237
  8238* EXEC CICS ENDBR
  8239*        DATASET(ERPNDB-FILE-ID)
  8240*    END-EXEC.
  8241     MOVE 0
  8242       TO DFHEIV11
  8243*    MOVE '&2                    $   #00007376' TO DFHEIV0
  8244     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8245     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8246     MOVE X'2020233030303037333736' TO DFHEIV0(25:11)
  8247     CALL 'kxdfhei1' USING DFHEIV0,
  8248           ERPNDB-FILE-ID,
  8249           DFHEIV11,
  8250           DFHEIV99
  8251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8252
  8253
  8254 3120-END-ROUTINE.
  8255     MOVE SPACE                  TO PI-UPDATE-SW.
  8256
  8257     IF WS-DELETE-CNT NOT GREATER ZERO
  8258         GO TO 3200-NO-RECORDS.
  8259
  8260     IF PI-AR-PROCESSING
  8261        MOVE 'Y'                 TO WS-RECORD-FOUND-SW
  8262        PERFORM 7000-VERIFY-REQUEST-REC THRU 7090-EXIT
  8263        IF RECORD-NOT-FOUND
  8264           GO TO 8200-SEND-DATAONLY.
  8265
  8266     IF PI-SAVE-CALLING-PGM NOT = XCTL-6301
  8267         MOVE ZEROS              TO EMI-ERROR
  8268         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8269
  8270     MOVE SPACE                  TO PI-BROWSE-SW.
  8271     MOVE LOW-VALUES             TO EL630AO.
  8272     MOVE QUESTION-MARKS         TO BATCHI.
  8273     MOVE AL-UANON               TO BATCHA.
  8274     MOVE -1                     TO MAINTL.
  8275     GO TO 8100-SEND-INITIAL-MAP.
  8276
  8277 3200-NO-RECORDS.
  8278     MOVE ER-2242                TO EMI-ERROR.
  8279     MOVE -1 TO BATCHL
  8280     MOVE AL-UABON               TO BATCHA.
  8281     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8282     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 161
* EL630.cbl
  8283
  8284 3300-FIRST-PF2.
  8285     MOVE SPACE                  TO PI-CLEAR-ERROR-SW.
  8286     MOVE ER-2422                TO EMI-ERROR.
  8287     MOVE -1                     TO PFENTERL.
  8288     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8289     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 162
* EL630.cbl
  8291
  8292 4000-SHOW-TOTALS.
  8293
  8294     MOVE LOW-VALUES             TO EL630AI.
  8295     MOVE PI-SAV-ENTRY-BATCH     TO BATCHO.
  8296     MOVE PI-SAV-REFERENCE       TO REFO.
  8297
  8298     IF PI-DATA-UPDATED
  8299        MOVE 'C'                TO PI-MAINT-FUNC.
  8300
  8301     MOVE PI-MAINT-FUNC          TO MAINTO.
  8302
  8303     IF PI-SAV-CARRIER NOT = SPACES
  8304         MOVE PI-SAV-CARRIER     TO CARRIERO.
  8305
  8306     IF PI-SAV-GROUPING NOT = SPACES
  8307         MOVE PI-SAV-GROUPING    TO GROUPO.
  8308
  8309     IF PI-SAV-STATE NOT = SPACES
  8310         MOVE PI-SAV-STATE       TO STATEO.
  8311
  8312     MOVE PI-SAV-ACCOUNT         TO ACCOUNTO.
  8313
  8314     IF PI-DATA-UPDATED
  8315         MOVE AL-SANON           TO BATCHA
  8316                                    MAINTA
  8317                                    CARRIERA
  8318                                    GROUPA
  8319                                    STATEA
  8320                                    ACCOUNTA
  8321     ELSE
  8322         MOVE AL-UANON           TO BATCHA
  8323                                    MAINTA
  8324                                    CARRIERA
  8325                                    GROUPA
  8326                                    STATEA
  8327                                    ACCOUNTA.
  8328
  8329     MOVE PI-LF-ISS-ENTERED      TO ALFISSO.
  8330     IF PI-LF-ISS-REMITTED NOT = ZEROS
  8331         MOVE PI-LF-ISS-REMITTED TO ELFISSO
  8332         MOVE AL-UNNON           TO ELFISSA
  8333         COMPUTE WS-OBAL = PI-LF-ISS-REMITTED - PI-LF-ISS-ENTERED
  8334         IF WS-OBAL NOT = ZEROS
  8335             MOVE WS-OBAL        TO OLFISSO.
  8336
  8337     MOVE PI-LF-CAN-ENTERED      TO ALFCANO.
  8338     IF PI-LF-CAN-REMITTED NOT = ZEROS
  8339         MOVE PI-LF-CAN-REMITTED TO ELFCANO
  8340         MOVE AL-UNNON           TO ELFCANA
  8341         COMPUTE WS-OBAL = PI-LF-CAN-REMITTED - PI-LF-CAN-ENTERED
  8342         IF WS-OBAL NOT = ZEROS
  8343             MOVE WS-OBAL        TO OLFCANO.
  8344
  8345     MOVE PI-AH-ISS-ENTERED      TO AAHISSO.
  8346     IF PI-AH-ISS-REMITTED NOT = ZEROS
  8347         MOVE PI-AH-ISS-REMITTED TO EAHISSO
  8348         MOVE AL-UNNON           TO EAHISSA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 163
* EL630.cbl
  8349         COMPUTE WS-OBAL = PI-AH-ISS-REMITTED - PI-AH-ISS-ENTERED
  8350         IF WS-OBAL NOT = ZEROS
  8351             MOVE WS-OBAL        TO OAHISSO.
  8352
  8353     MOVE PI-AH-CAN-ENTERED      TO AAHCANO.
  8354     IF PI-AH-CAN-REMITTED NOT = ZEROS
  8355         MOVE PI-AH-CAN-REMITTED TO EAHCANO
  8356         MOVE AL-UNNON           TO EAHCANA
  8357         COMPUTE WS-OBAL = PI-AH-CAN-REMITTED - PI-AH-CAN-ENTERED
  8358         IF WS-OBAL NOT = ZEROS
  8359             MOVE WS-OBAL        TO OAHCANO.
  8360
  8361     MOVE PI-ISS-CNT-ENTERED     TO AISSCNTO.
  8362     IF PI-ISS-CNT-REMITTED NOT = ZEROS
  8363         MOVE PI-ISS-CNT-REMITTED TO EISSCNTO
  8364         MOVE AL-UNNON            TO EISSCNTA
  8365         COMPUTE WS-OCNT = PI-ISS-CNT-REMITTED -
  8366                                PI-ISS-CNT-ENTERED
  8367         IF WS-OCNT NOT = ZEROS
  8368             MOVE WS-OCNT        TO OISSCNTO.
  8369
  8370     MOVE PI-CAN-CNT-ENTERED     TO ACANCNTO.
  8371     IF PI-CAN-CNT-REMITTED NOT = ZEROS
  8372         MOVE PI-CAN-CNT-REMITTED TO ECANCNTO
  8373         MOVE AL-UNNON            TO ECANCNTA
  8374         COMPUTE WS-OCNT = PI-CAN-CNT-REMITTED -
  8375                                PI-CAN-CNT-ENTERED
  8376         IF WS-OCNT NOT = ZEROS
  8377             MOVE WS-OCNT        TO OCANCNTO.
  8378
  8379     IF  PI-NB-MONTH-END-DT GREATER SPACES
  8380         MOVE PI-NB-MONTH-END-DT TO DC-BIN-DATE-1
  8381       ELSE
  8382         MOVE PI-CR-MONTH-END-DT TO DC-BIN-DATE-1.
  8383
  8384     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8385     PERFORM  9700-DATE-LINK.
  8386
  8387     IF  DATE-CONVERSION-ERROR
  8388         MOVE LOW-VALUES TO MNTHNDTO
  8389         GO TO 0490-EXIT.
  8390
  8391     MOVE DC-GREG-DATE-1-EDIT    TO  MNTHNDTO.
  8392     MOVE AL-UANON               TO  MNTHNDTA.
  8393
  8394     IF  PI-NB-MONTH-END-DT GREATER SPACES
  8395         MOVE PI-NB-MONTH-END-DT TO DC-BIN-DATE-1
  8396       ELSE
  8397         MOVE PI-CR-MONTH-END-DT TO DC-BIN-DATE-1.
  8398
  8399     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8400     PERFORM  9700-DATE-LINK.
  8401
  8402     IF  DATE-CONVERSION-ERROR
  8403         MOVE LOW-VALUES TO MNTHNDTO
  8404     ELSE
  8405         MOVE DC-GREG-DATE-1-EDIT    TO  MNTHNDTO
  8406         MOVE AL-UANON               TO  MNTHNDTA.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 164
* EL630.cbl
  8407
  8408     MOVE PI-RECEIVED-DT         TO DC-BIN-DATE-1.
  8409
  8410     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8411     PERFORM  9700-DATE-LINK.
  8412
  8413     IF  DATE-CONVERSION-ERROR
  8414         MOVE LOW-VALUES TO RECEVDTO
  8415     ELSE
  8416         MOVE DC-GREG-DATE-1-EDIT    TO  RECEVDTO
  8417         MOVE AL-UANON               TO  RECEVDTA.
  8418
  8419     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 165
* EL630.cbl
  8421
  8422*****************************************************************
  8423*            U P D A T E   E N T I R E   B A T C H              *
  8424*  THIS SECTION UPDATES AN ENTIRE BATCH WITH A NEW MONTH END    *
  8425*  DATE.                                                        *
  8426*****************************************************************
  8427
  8428 5000-UPDATE-ENTIRE-BATCH.
  8429
  8430     MOVE ZEROS                  TO  PNDB-BATCH-SEQ
  8431                                     PNDB-BATCH-CHG-SEQ.
  8432
  8433
  8434* EXEC CICS HANDLE CONDITION
  8435*        NOTFND(5900-EXIT)
  8436*    END-EXEC.
  8437*    MOVE '"$I                   ! 6 #00007559' TO DFHEIV0
  8438     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8439     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8440     MOVE X'3620233030303037353539' TO DFHEIV0(25:11)
  8441     CALL 'kxdfhei1' USING DFHEIV0
  8442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8443
  8444
  8445
  8446* EXEC CICS STARTBR
  8447*        DATASET(ERPNDB-FILE-ID)
  8448*        RIDFLD (ERPNDB-KEY)
  8449*    END-EXEC.
  8450     MOVE 0
  8451       TO DFHEIV11
  8452*    MOVE '&,         G          &   #00007563' TO DFHEIV0
  8453     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8454     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8455     MOVE X'2020233030303037353633' TO DFHEIV0(25:11)
  8456     CALL 'kxdfhei1' USING DFHEIV0,
  8457           ERPNDB-FILE-ID,
  8458           ERPNDB-KEY,
  8459           DFHEIV99,
  8460           DFHEIV11,
  8461           DFHEIV99
  8462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8463
  8464
  8465 5010-GET-NEXT-RECORD.
  8466
  8467* EXEC CICS HANDLE CONDITION
  8468*        NOTFND (5100-STOP-BROWSE)
  8469*        ENDFILE(5100-STOP-BROWSE)
  8470*    END-EXEC.
  8471*    MOVE '"$I''                  ! 7 #00007569' TO DFHEIV0
  8472     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8474     MOVE X'3720233030303037353639' TO DFHEIV0(25:11)
  8475     CALL 'kxdfhei1' USING DFHEIV0
  8476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8477
  8478
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 166
* EL630.cbl
  8479 5020-READ-NEXT-RECORD.
  8480
  8481* EXEC CICS READNEXT
  8482*        SET    (ADDRESS OF PENDING-BUSINESS)
  8483*        DATASET(ERPNDB-FILE-ID)
  8484*        RIDFLD (ERPNDB-KEY)
  8485*    END-EXEC.
  8486     MOVE 0
  8487       TO DFHEIV11
  8488*    MOVE '&.S                   )   #00007575' TO DFHEIV0
  8489     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8490     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8491     MOVE X'2020233030303037353735' TO DFHEIV0(25:11)
  8492     CALL 'kxdfhei1' USING DFHEIV0,
  8493           ERPNDB-FILE-ID,
  8494           DFHEIV20,
  8495           DFHEIV99,
  8496           ERPNDB-KEY,
  8497           DFHEIV99,
  8498           DFHEIV11,
  8499           DFHEIV99,
  8500           DFHEIV99
  8501     SET ADDRESS OF PENDING-BUSINESS TO
  8502         DFHEIV20
  8503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8504
  8505
  8506     IF WS-ON1-SW4 IS EQUAL TO 'Y'
  8507         MOVE 'N'                    TO  WS-ON1-SW4
  8508         MOVE PB-CONTROL-PRIMARY     TO  WS-SAV-PNDB-KEY
  8509         GO TO 5030-READ-FOR-UPDATE.
  8510
  8511     IF ERPNDB-KEY = WS-SAV-PNDB-KEY
  8512        GO TO 5020-READ-NEXT-RECORD.
  8513
  8514     IF PB-COMPANY-CD  = WS-SAV-COMP-CD  AND
  8515        PB-ENTRY-BATCH = WS-SAV-ENTRY-BATCH
  8516         NEXT SENTENCE
  8517     ELSE
  8518         GO TO 5100-STOP-BROWSE.
  8519
  8520     IF PB-ISSUE
  8521        IF PB-I-REFERENCE NOT = PI-SAV-REFERENCE
  8522           GO TO 5030-READ-FOR-UPDATE.
  8523
  8524     IF PB-CANCELLATION
  8525        IF PB-C-REFERENCE NOT = PI-SAV-REFERENCE
  8526           GO TO 5030-READ-FOR-UPDATE.
  8527
  8528     IF PB-CREDIT-SELECT-DT = PI-NB-MONTH-END-DT
  8529         GO TO 5010-GET-NEXT-RECORD.
  8530
  8531 5030-READ-FOR-UPDATE.
  8532
  8533* EXEC CICS ENDBR
  8534*        DATASET(ERPNDB-FILE-ID)
  8535*    END-EXEC.
  8536     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 167
* EL630.cbl
  8537       TO DFHEIV11
  8538*    MOVE '&2                    $   #00007607' TO DFHEIV0
  8539     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8540     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8541     MOVE X'2020233030303037363037' TO DFHEIV0(25:11)
  8542     CALL 'kxdfhei1' USING DFHEIV0,
  8543           ERPNDB-FILE-ID,
  8544           DFHEIV11,
  8545           DFHEIV99
  8546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8547
  8548
  8549
  8550* EXEC CICS READ
  8551*        SET     (ADDRESS OF PENDING-BUSINESS)
  8552*        DATASET (ERPNDB-FILE-ID)
  8553*        RIDFLD  (ERPNDB-KEY)
  8554*        UPDATE
  8555*    END-EXEC.
  8556*    MOVE '&"S        EU         (   #00007611' TO DFHEIV0
  8557     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8558     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8559     MOVE X'2020233030303037363131' TO DFHEIV0(25:11)
  8560     CALL 'kxdfhei1' USING DFHEIV0,
  8561           ERPNDB-FILE-ID,
  8562           DFHEIV20,
  8563           DFHEIV99,
  8564           ERPNDB-KEY,
  8565           DFHEIV99,
  8566           DFHEIV99,
  8567           DFHEIV99
  8568     SET ADDRESS OF PENDING-BUSINESS TO
  8569         DFHEIV20
  8570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8571
  8572
  8573     MOVE ERPNDB-KEY                  TO WS-SAV-PNDB-KEY.
  8574
  8575     IF PI-NB-MONTH-END-DT GREATER THAN SPACES
  8576        MOVE  PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  8577
  8578     IF PB-ISSUE
  8579        IF PB-I-REFERENCE NOT = PI-SAV-REFERENCE
  8580           MOVE PI-SAV-REFERENCE TO PB-I-REFERENCE.
  8581
  8582     IF PB-CANCELLATION
  8583        IF PB-C-REFERENCE NOT = PI-SAV-REFERENCE
  8584           MOVE PI-SAV-REFERENCE TO PB-C-REFERENCE.
  8585
  8586 5050-REWRITE-PENDING-BUS.
  8587
  8588* EXEC CICS REWRITE
  8589*         DATASET    (ERPNDB-FILE-ID)
  8590*         FROM       (PENDING-BUSINESS)
  8591*     END-EXEC.
  8592     MOVE LENGTH OF
  8593      PENDING-BUSINESS
  8594       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 168
* EL630.cbl
  8595*    MOVE '&& L                  %   #00007632' TO DFHEIV0
  8596     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8597     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8598     MOVE X'2020233030303037363332' TO DFHEIV0(25:11)
  8599     CALL 'kxdfhei1' USING DFHEIV0,
  8600           ERPNDB-FILE-ID,
  8601           PENDING-BUSINESS,
  8602           DFHEIV11,
  8603           DFHEIV99
  8604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8605
  8606
  8607
  8608* EXEC CICS STARTBR
  8609*        DATASET(ERPNDB-FILE-ID)
  8610*        RIDFLD (ERPNDB-KEY)
  8611*    END-EXEC.
  8612     MOVE 0
  8613       TO DFHEIV11
  8614*    MOVE '&,         G          &   #00007637' TO DFHEIV0
  8615     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8616     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8617     MOVE X'2020233030303037363337' TO DFHEIV0(25:11)
  8618     CALL 'kxdfhei1' USING DFHEIV0,
  8619           ERPNDB-FILE-ID,
  8620           ERPNDB-KEY,
  8621           DFHEIV99,
  8622           DFHEIV11,
  8623           DFHEIV99
  8624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8625
  8626
  8627     GO TO 5010-GET-NEXT-RECORD.
  8628
  8629 5100-STOP-BROWSE.
  8630
  8631* EXEC CICS ENDBR
  8632*        DATASET(ERPNDB-FILE-ID)
  8633*    END-EXEC.
  8634     MOVE 0
  8635       TO DFHEIV11
  8636*    MOVE '&2                    $   #00007645' TO DFHEIV0
  8637     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8638     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8639     MOVE X'2020233030303037363435' TO DFHEIV0(25:11)
  8640     CALL 'kxdfhei1' USING DFHEIV0,
  8641           ERPNDB-FILE-ID,
  8642           DFHEIV11,
  8643           DFHEIV99
  8644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8645
  8646
  8647 5900-EXIT.
  8648      EXIT.
  8649
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 169
* EL630.cbl
  8651
  8652******************************************************************
  8653*          R E W R I T E   E N T I R E   B A T C H              *
  8654*  THIS SECTION REWRITES AN ENTIRE BATCH WITH NEW ACCOUNT INFO. *
  8655*  1.  DELETE THE PENDING BUSINESS RECORD                       *
  8656*  2.  IF THE PENDING RECORD IS AN ISSUE, AND THE CERTIFICATE   *
  8657*      HAS NOT BEEN ADDED TO BATCH OR A CLAIM IS NOT ATTACHED,  *
  8658*      DELETE THE CERTIFICATE,CERTIFICATE NOTES, AND MAILING    *
  8659*      RECORDS                                                  *
  8660*  3.  IF THE PENDING RECORD HAS BEEN ADDED TO BATCH OR A CLAIM *
  8661*      IS ATTACHED MOVE SPACE TO CM-CREDIT-INTERFACE-SW-1 AND   *
  8662*      REWRITE THE CERTIFICATE.                                 *
  8663*  4.  IF THE PENDING RECORD IS CANCELLATION, BACKOUT THE       *
  8664*      CANCELLATION INFORMATION IN THE CERTIFICATE RECORD       *
  8665*      AND REWRITE THE CERTIFICATE.                             *
  8666*  5.  WRITE A NEW PENDING BUSINESS RECORD WITH THE NEW ACCOUNT *
  8667*      INFORMATION.                                             *
  8668*  6.  AFTER EACH DETAIL RECORD IS PROCESSED REWRITE THE BATCH  *
  8669*      RECORD WITH THE NEW ACCOUNT INFORMATION.                 *
  8670*  7.  ONCE THE BATCH IS REWRITTEN FORCE THE OPERATOR TO        *
  8671*      RE-EDITED THE BATCH.                                     *
  8672*  NOTE:  THE PENDING BUSINESS RECORDS ARE DELETED AND ADDED    *
  8673*         TO RESET THE ALTERNATE INDEX.                         *
  8674******************************************************************
  8675 6000-REWRITE-ENTIRE-BATCH.
  8676     IF  NOT EMI-NO-ERRORS
  8677         GO TO 8200-SEND-DATAONLY.
  8678
  8679     PERFORM 0400-PRIME-BATCH-TOTALS  THRU  0490-EXIT.
  8680
  8681     IF  EMI-ERROR = ZEROS
  8682         MOVE 'N'                TO  PI-EL630-FIRST-TIME-SW
  8683       ELSE
  8684         GO TO 8200-SEND-DATAONLY.
  8685
  8686     MOVE PI-SAV-COMP-CD         TO  PNDB-COMP-CD.
  8687     MOVE PI-SAV-ENTRY-BATCH     TO  PNDB-ENTRY-BATCH.
  8688
  8689     MOVE ZEROS                  TO  PNDB-BATCH-SEQ
  8690                                     PNDB-BATCH-CHG-SEQ.
  8691
  8692
  8693* EXEC CICS GETMAIN
  8694*        SET    (ADDRESS OF PENDING-BUSINESS)
  8695*        LENGTH (585)
  8696*        INITIMG(GETMAIN-SPACE)
  8697*    END-EXEC.
  8698     MOVE 585
  8699       TO DFHEIV11
  8700*    MOVE ',"IL                  $   #00007694' TO DFHEIV0
  8701     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8702     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8703     MOVE X'2020233030303037363934' TO DFHEIV0(25:11)
  8704     CALL 'kxdfhei1' USING DFHEIV0,
  8705           DFHEIV20,
  8706           DFHEIV11,
  8707           GETMAIN-SPACE
  8708     SET ADDRESS OF PENDING-BUSINESS TO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 170
* EL630.cbl
  8709         DFHEIV20
  8710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8711
  8712
  8713
  8714* EXEC CICS HANDLE CONDITION
  8715*        NOTFND(6500-NO-RECORDS)
  8716*    END-EXEC.
  8717*    MOVE '"$I                   ! 8 #00007700' TO DFHEIV0
  8718     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8719     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8720     MOVE X'3820233030303037373030' TO DFHEIV0(25:11)
  8721     CALL 'kxdfhei1' USING DFHEIV0
  8722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8723
  8724
  8725 6010-GET-NEXT-RECORD.
  8726     IF WS-ON1-SW5 IS EQUAL TO 'Y'
  8727         MOVE 'N'                TO  WS-ON1-SW5
  8728         GO TO 6015-START-BROWSE.
  8729
  8730
  8731* EXEC CICS HANDLE CONDITION
  8732*        NOTFND (6400-STOP-BROWSE)
  8733*        ENDFILE(6400-STOP-BROWSE)
  8734*    END-EXEC.
  8735*    MOVE '"$I''                  ! 9 #00007709' TO DFHEIV0
  8736     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8737     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8738     MOVE X'3920233030303037373039' TO DFHEIV0(25:11)
  8739     CALL 'kxdfhei1' USING DFHEIV0
  8740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8741
  8742
  8743 6015-START-BROWSE.
  8744
  8745* EXEC CICS STARTBR
  8746*        DATASET(ERPNDB-FILE-ID)
  8747*        RIDFLD (ERPNDB-KEY)
  8748*    END-EXEC.
  8749     MOVE 0
  8750       TO DFHEIV11
  8751*    MOVE '&,         G          &   #00007715' TO DFHEIV0
  8752     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8753     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8754     MOVE X'2020233030303037373135' TO DFHEIV0(25:11)
  8755     CALL 'kxdfhei1' USING DFHEIV0,
  8756           ERPNDB-FILE-ID,
  8757           ERPNDB-KEY,
  8758           DFHEIV99,
  8759           DFHEIV11,
  8760           DFHEIV99
  8761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8762
  8763
  8764 6020-READ-NEXT-RECORD.
  8765
  8766* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 171
* EL630.cbl
  8767*        INTO   (PENDING-BUSINESS)
  8768*        DATASET(ERPNDB-FILE-ID)
  8769*        RIDFLD (ERPNDB-KEY)
  8770*    END-EXEC.
  8771     MOVE LENGTH OF
  8772      PENDING-BUSINESS
  8773       TO DFHEIV12
  8774     MOVE 0
  8775       TO DFHEIV11
  8776*    MOVE '&.IL                  )   #00007721' TO DFHEIV0
  8777     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8778     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8779     MOVE X'2020233030303037373231' TO DFHEIV0(25:11)
  8780     CALL 'kxdfhei1' USING DFHEIV0,
  8781           ERPNDB-FILE-ID,
  8782           PENDING-BUSINESS,
  8783           DFHEIV12,
  8784           ERPNDB-KEY,
  8785           DFHEIV99,
  8786           DFHEIV11,
  8787           DFHEIV99,
  8788           DFHEIV99
  8789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8790
  8791
  8792     IF WS-ON1-SW6 IS EQUAL TO 'Y'
  8793         MOVE 'N'                    TO WS-ON1-SW6
  8794         MOVE PB-CONTROL-PRIMARY     TO WS-SAV-PNDB-KEY
  8795         GO TO 6030-READ-FOR-UPDATE.
  8796
  8797     IF ERPNDB-KEY = WS-SAV-PNDB-KEY
  8798         GO TO 6020-READ-NEXT-RECORD.
  8799
  8800     IF PB-COMPANY-CD  = WS-SAV-COMP-CD  AND
  8801        PB-ENTRY-BATCH = WS-SAV-ENTRY-BATCH
  8802         NEXT SENTENCE
  8803     ELSE
  8804         GO TO 6400-STOP-BROWSE.
  8805
  8806 6030-READ-FOR-UPDATE.
  8807
  8808* EXEC CICS ENDBR
  8809*        DATASET(ERPNDB-FILE-ID)
  8810*    END-EXEC.
  8811     MOVE 0
  8812       TO DFHEIV11
  8813*    MOVE '&2                    $   #00007742' TO DFHEIV0
  8814     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8815     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8816     MOVE X'2020233030303037373432' TO DFHEIV0(25:11)
  8817     CALL 'kxdfhei1' USING DFHEIV0,
  8818           ERPNDB-FILE-ID,
  8819           DFHEIV11,
  8820           DFHEIV99
  8821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8822
  8823
  8824
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 172
* EL630.cbl
  8825* EXEC CICS READ
  8826*        INTO (PENDING-BUSINESS)
  8827*        DATASET (ERPNDB-FILE-ID)
  8828*        RIDFLD  (ERPNDB-KEY)
  8829*        UPDATE
  8830*    END-EXEC.
  8831     MOVE LENGTH OF
  8832      PENDING-BUSINESS
  8833       TO DFHEIV11
  8834*    MOVE '&"IL       EU         (   #00007746' TO DFHEIV0
  8835     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8836     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8837     MOVE X'2020233030303037373436' TO DFHEIV0(25:11)
  8838     CALL 'kxdfhei1' USING DFHEIV0,
  8839           ERPNDB-FILE-ID,
  8840           PENDING-BUSINESS,
  8841           DFHEIV11,
  8842           ERPNDB-KEY,
  8843           DFHEIV99,
  8844           DFHEIV99,
  8845           DFHEIV99
  8846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8847
  8848
  8849     MOVE ERPNDB-KEY                  TO WS-SAV-PNDB-KEY.
  8850
  8851     MOVE PENDING-BUSINESS       TO WS-ERPNDB-RECORD.
  8852
  8853 6050-DELETE-PENDING-BUS.
  8854
  8855* EXEC CICS DELETE
  8856*        DATASET    (ERPNDB-FILE-ID)
  8857*    END-EXEC.
  8858*    MOVE '&(                    &   #00007758' TO DFHEIV0
  8859     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8860     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8861     MOVE X'2020233030303037373538' TO DFHEIV0(25:11)
  8862     CALL 'kxdfhei1' USING DFHEIV0,
  8863           ERPNDB-FILE-ID,
  8864           DFHEIV99,
  8865           DFHEIV99,
  8866           DFHEIV99,
  8867           DFHEIV99
  8868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8869
  8870
  8871     MOVE WS-ERPNDB-RECORD       TO PENDING-BUSINESS.
  8872
  8873     IF  PB-BATCH-TRAILER
  8874         GO TO 6300-WRITE-PNDB-RECORD.
  8875
  8876     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
  8877     IF  PB-SV-CARRIER GREATER SPACES
  8878         MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8879     IF  PB-SV-GROUPING GREATER SPACES
  8880         MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8881     IF  PB-SV-STATE GREATER SPACES
  8882         MOVE PB-SV-STATE            TO CERT-STATE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 173
* EL630.cbl
  8883
  8884     IF PB-ISSUE
  8885         NEXT SENTENCE
  8886       ELSE
  8887         GO TO 6200-PROCESS-CANCELS.
  8888
  8889
  8890* EXEC CICS HANDLE CONDITION
  8891*         NOTFND  (6300-WRITE-PNDB-RECORD)
  8892*    END-EXEC.
  8893*    MOVE '"$I                   ! : #00007780' TO DFHEIV0
  8894     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8895     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8896     MOVE X'3A20233030303037373830' TO DFHEIV0(25:11)
  8897     CALL 'kxdfhei1' USING DFHEIV0
  8898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8899
  8900
  8901
  8902* EXEC CICS READ
  8903*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  8904*        DATASET (ELCERT-FILE-ID)
  8905*        RIDFLD  (ELCERT-KEY)
  8906*        UPDATE
  8907*    END-EXEC.
  8908*    MOVE '&"S        EU         (   #00007784' TO DFHEIV0
  8909     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8910     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8911     MOVE X'2020233030303037373834' TO DFHEIV0(25:11)
  8912     CALL 'kxdfhei1' USING DFHEIV0,
  8913           ELCERT-FILE-ID,
  8914           DFHEIV20,
  8915           DFHEIV99,
  8916           ELCERT-KEY,
  8917           DFHEIV99,
  8918           DFHEIV99,
  8919           DFHEIV99
  8920     SET ADDRESS OF CERTIFICATE-MASTER TO
  8921         DFHEIV20
  8922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8923
  8924
  8925     IF INSURED-ADDR-PRESENT
  8926        MOVE 'Y'                  TO WS-CERT-ADDRESS-SW
  8927     ELSE
  8928        MOVE ' '                  TO WS-CERT-ADDRESS-SW.
  8929
  8930     IF  CERT-NOTES-ARE-NOT-PRESENT
  8931         MOVE ' '                TO WS-CERT-NOTE-SW
  8932     ELSE
  8933         MOVE 'Y'                TO WS-CERT-NOTE-SW.
  8934
  8935     IF  CERT-ADDED-BATCH
  8936
  8937* EXEC CICS UNLOCK
  8938*             DATASET (ELCERT-FILE-ID)
  8939*        END-EXEC
  8940*    MOVE '&*                    #   #00007802' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 174
* EL630.cbl
  8941     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8942     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8943     MOVE X'2020233030303037383032' TO DFHEIV0(25:11)
  8944     CALL 'kxdfhei1' USING DFHEIV0,
  8945           ELCERT-FILE-ID,
  8946           DFHEIV99
  8947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8948         GO TO 6300-WRITE-PNDB-RECORD.
  8949
  8950     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
  8951         NEXT SENTENCE
  8952        ELSE
  8953         GO TO 6060-DELETE-CERTIFICATE.
  8954
  8955     MOVE SPACE                 TO  CM-CREDIT-INTERFACE-SW-1.
  8956     MOVE '2'                   TO  CM-CLAIM-INTERFACE-SW.
  8957
  8958
  8959* EXEC CICS REWRITE
  8960*         DATASET    (ELCERT-FILE-ID)
  8961*         FROM       (CERTIFICATE-MASTER)
  8962*    END-EXEC.
  8963     MOVE LENGTH OF
  8964      CERTIFICATE-MASTER
  8965       TO DFHEIV11
  8966*    MOVE '&& L                  %   #00007815' TO DFHEIV0
  8967     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8968     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8969     MOVE X'2020233030303037383135' TO DFHEIV0(25:11)
  8970     CALL 'kxdfhei1' USING DFHEIV0,
  8971           ELCERT-FILE-ID,
  8972           CERTIFICATE-MASTER,
  8973           DFHEIV11,
  8974           DFHEIV99
  8975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8976
  8977
  8978     GO TO 6300-WRITE-PNDB-RECORD.
  8979
  8980 6060-DELETE-CERTIFICATE.
  8981
  8982
  8983* EXEC CICS DELETE
  8984*         DATASET    (ELCERT-FILE-ID)
  8985*    END-EXEC.
  8986*    MOVE '&(                    &   #00007824' TO DFHEIV0
  8987     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8988     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8989     MOVE X'2020233030303037383234' TO DFHEIV0(25:11)
  8990     CALL 'kxdfhei1' USING DFHEIV0,
  8991           ELCERT-FILE-ID,
  8992           DFHEIV99,
  8993           DFHEIV99,
  8994           DFHEIV99,
  8995           DFHEIV99
  8996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8997
  8998
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 175
* EL630.cbl
  8999******************************************************************
  9000*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
  9001******************************************************************
  9002
  9003     IF CERT-NOTES-ARE-PRESENT
  9004        NEXT SENTENCE
  9005     ELSE
  9006        GO TO 6070-DELETE-MAILING.
  9007
  9008
  9009* EXEC CICS HANDLE CONDITION
  9010*         NOTFND  (6070-DELETE-MAILING)
  9011*    END-EXEC.
  9012*    MOVE '"$I                   ! ; #00007837' TO DFHEIV0
  9013     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9015     MOVE X'3B20233030303037383337' TO DFHEIV0(25:11)
  9016     CALL 'kxdfhei1' USING DFHEIV0
  9017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9018
  9019
  9020
  9021* EXEC CICS READ
  9022*        EQUAL
  9023*        DATASET   (ERNOTE-FILE-ID)
  9024*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  9025*        RIDFLD    (ELCERT-KEY)
  9026*        UPDATE
  9027*    END-EXEC.
  9028*    MOVE '&"S        EU         (   #00007841' TO DFHEIV0
  9029     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9030     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9031     MOVE X'2020233030303037383431' TO DFHEIV0(25:11)
  9032     CALL 'kxdfhei1' USING DFHEIV0,
  9033           ERNOTE-FILE-ID,
  9034           DFHEIV20,
  9035           DFHEIV99,
  9036           ELCERT-KEY,
  9037           DFHEIV99,
  9038           DFHEIV99,
  9039           DFHEIV99
  9040     SET ADDRESS OF CERTIFICATE-NOTE TO
  9041         DFHEIV20
  9042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9043
  9044
  9045
  9046* EXEC CICS DELETE
  9047*        DATASET   (ERNOTE-FILE-ID)
  9048*    END-EXEC.
  9049*    MOVE '&(                    &   #00007849' TO DFHEIV0
  9050     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9051     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9052     MOVE X'2020233030303037383439' TO DFHEIV0(25:11)
  9053     CALL 'kxdfhei1' USING DFHEIV0,
  9054           ERNOTE-FILE-ID,
  9055           DFHEIV99,
  9056           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 176
* EL630.cbl
  9057           DFHEIV99,
  9058           DFHEIV99
  9059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9060
  9061
  9062******************************************************************
  9063*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
  9064******************************************************************
  9065
  9066 6070-DELETE-MAILING.
  9067     IF CERT-ADDRESS-PRESENT
  9068        NEXT SENTENCE
  9069     ELSE
  9070        GO TO 6300-WRITE-PNDB-RECORD.
  9071
  9072
  9073* EXEC CICS HANDLE CONDITION
  9074*         NOTOPEN (6300-WRITE-PNDB-RECORD)
  9075*         NOTFND  (6300-WRITE-PNDB-RECORD)
  9076*    END-EXEC.
  9077*    MOVE '"$JI                  ! < #00007863' TO DFHEIV0
  9078     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9080     MOVE X'3C20233030303037383633' TO DFHEIV0(25:11)
  9081     CALL 'kxdfhei1' USING DFHEIV0
  9082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9083
  9084
  9085
  9086* EXEC CICS READ
  9087*        EQUAL
  9088*        DATASET   (ERMAIL-FILE-ID)
  9089*        SET       (ADDRESS OF MAILING-DATA)
  9090*        RIDFLD    (ELCERT-KEY)
  9091*        UPDATE
  9092*    END-EXEC.
  9093*    MOVE '&"S        EU         (   #00007868' TO DFHEIV0
  9094     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9095     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9096     MOVE X'2020233030303037383638' TO DFHEIV0(25:11)
  9097     CALL 'kxdfhei1' USING DFHEIV0,
  9098           ERMAIL-FILE-ID,
  9099           DFHEIV20,
  9100           DFHEIV99,
  9101           ELCERT-KEY,
  9102           DFHEIV99,
  9103           DFHEIV99,
  9104           DFHEIV99
  9105     SET ADDRESS OF MAILING-DATA TO
  9106         DFHEIV20
  9107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9108
  9109
  9110
  9111* EXEC CICS DELETE
  9112*        DATASET   (ERMAIL-FILE-ID)
  9113*    END-EXEC.
  9114*    MOVE '&(                    &   #00007876' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 177
* EL630.cbl
  9115     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9116     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9117     MOVE X'2020233030303037383736' TO DFHEIV0(25:11)
  9118     CALL 'kxdfhei1' USING DFHEIV0,
  9119           ERMAIL-FILE-ID,
  9120           DFHEIV99,
  9121           DFHEIV99,
  9122           DFHEIV99,
  9123           DFHEIV99
  9124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9125
  9126
  9127     GO TO 6300-WRITE-PNDB-RECORD.
  9128
  9129 6200-PROCESS-CANCELS.
  9130
  9131* EXEC CICS HANDLE CONDITION
  9132*         NOTFND  (6300-WRITE-PNDB-RECORD)
  9133*    END-EXEC.
  9134*    MOVE '"$I                   ! = #00007883' TO DFHEIV0
  9135     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9136     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9137     MOVE X'3D20233030303037383833' TO DFHEIV0(25:11)
  9138     CALL 'kxdfhei1' USING DFHEIV0
  9139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9140
  9141
  9142
  9143* EXEC CICS READ
  9144*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  9145*        DATASET (ELCERT-FILE-ID)
  9146*        RIDFLD  (ELCERT-KEY)
  9147*        UPDATE
  9148*    END-EXEC.
  9149*    MOVE '&"S        EU         (   #00007887' TO DFHEIV0
  9150     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9151     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9152     MOVE X'2020233030303037383837' TO DFHEIV0(25:11)
  9153     CALL 'kxdfhei1' USING DFHEIV0,
  9154           ELCERT-FILE-ID,
  9155           DFHEIV20,
  9156           DFHEIV99,
  9157           ELCERT-KEY,
  9158           DFHEIV99,
  9159           DFHEIV99,
  9160           DFHEIV99
  9161     SET ADDRESS OF CERTIFICATE-MASTER TO
  9162         DFHEIV20
  9163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9164
  9165
  9166     IF PB-CANCELLATION
  9167        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  9168           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9169           MOVE ZERO                   TO CM-LF-ITD-CANCEL-AMT
  9170           MOVE LOW-VALUES             TO CM-LF-CANCEL-EXIT-DT
  9171                                          CM-LF-CANCEL-DT
  9172        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 178
* EL630.cbl
  9173           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9174           MOVE PB-CI-LF-CANCEL-AMT    TO CM-LF-ITD-CANCEL-AMT
  9175           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
  9176           MOVE PB-CI-LIVES            TO CM-LIVES.
  9177
  9178     IF PB-CANCELLATION
  9179        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  9180           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL SPACE
  9181               MOVE CM-LF-STATUS-AT-CANCEL
  9182                                        TO CM-LF-CURRENT-STATUS
  9183               MOVE SPACE
  9184                                        TO CM-LF-STATUS-AT-CANCEL
  9185            ELSE
  9186               MOVE PB-CI-LF-POLICY-STATUS
  9187                                        TO CM-LF-CURRENT-STATUS
  9188        ELSE
  9189            MOVE PB-CI-LF-POLICY-STATUS TO CM-LF-CURRENT-STATUS.
  9190
  9191     IF PB-CANCELLATION
  9192        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  9193           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9194           MOVE ZERO                   TO CM-AH-ITD-CANCEL-AMT
  9195           MOVE LOW-VALUES             TO CM-AH-CANCEL-EXIT-DT
  9196                                          CM-AH-CANCEL-DT
  9197        ELSE
  9198           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9199           MOVE PB-CI-AH-CANCEL-AMT    TO CM-AH-ITD-CANCEL-AMT
  9200           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
  9201           MOVE PB-CI-LIVES            TO CM-LIVES.
  9202
  9203     IF PB-CANCELLATION
  9204        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  9205           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL SPACE
  9206               MOVE CM-AH-STATUS-AT-CANCEL
  9207                                        TO CM-AH-CURRENT-STATUS
  9208               MOVE SPACE
  9209                                        TO CM-AH-STATUS-AT-CANCEL
  9210            ELSE
  9211               MOVE PB-CI-AH-POLICY-STATUS
  9212                                        TO CM-AH-CURRENT-STATUS
  9213        ELSE
  9214            MOVE PB-CI-AH-POLICY-STATUS TO CM-AH-CURRENT-STATUS.
  9215
  9216 6255-REWRITE-CERT.
  9217
  9218
  9219* EXEC CICS REWRITE
  9220*        DATASET    (ELCERT-FILE-ID)
  9221*        FROM       (CERTIFICATE-MASTER)
  9222*    END-EXEC.
  9223     MOVE LENGTH OF
  9224      CERTIFICATE-MASTER
  9225       TO DFHEIV11
  9226*    MOVE '&& L                  %   #00007946' TO DFHEIV0
  9227     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9228     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9229     MOVE X'2020233030303037393436' TO DFHEIV0(25:11)
  9230     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 179
* EL630.cbl
  9231           ELCERT-FILE-ID,
  9232           CERTIFICATE-MASTER,
  9233           DFHEIV11,
  9234           DFHEIV99
  9235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9236
  9237
  9238 6300-WRITE-PNDB-RECORD.
  9239
  9240     MOVE 'X'                    TO  PB-FATAL-FLAG.
  9241
  9242     MOVE SPACES                 TO  PB-I-RATE-DEVIATION-LF
  9243                                     PB-I-RATE-DEVIATION-AH
  9244                                     PB-REIN-CD
  9245                                     PB-SV-CARRIER
  9246                                     PB-SV-GROUPING
  9247                                     PB-SV-STATE.
  9248
  9249     IF PB-BATCH-TRAILER
  9250         MOVE PI-AM-NAME         TO  PB-ACCOUNT-NAME
  9251         MOVE PI-SAV-FC-CARRIER  TO  PB-SV-CARRIER
  9252         MOVE PI-SAV-FC-GROUPING TO  PB-SV-GROUPING
  9253         MOVE PI-SAV-FC-STATE    TO  PB-SV-STATE.
  9254
  9255     MOVE LOW-VALUES             TO  PB-ACCT-EFF-DT
  9256                                     PB-ACCT-EXP-DT.
  9257
  9258     MOVE ZEROS                  TO  PB-CALC-TOLERANCE.
  9259
  9260     IF  CARRIERL GREATER ZEROS
  9261         MOVE CARRIERI           TO PB-CARRIER
  9262        ELSE
  9263         MOVE SPACES             TO PB-CARRIER.
  9264
  9265     IF  GROUPL   GREATER ZEROS
  9266         MOVE GROUPI             TO PB-GROUPING
  9267        ELSE
  9268         MOVE SPACES             TO PB-GROUPING.
  9269
  9270     IF  STATEL   GREATER ZEROS
  9271         MOVE STATEI             TO PB-STATE
  9272        ELSE
  9273         MOVE SPACES             TO PB-STATE.
  9274
  9275     IF  ACCOUNTL GREATER ZEROS
  9276         MOVE ACCOUNTI           TO PB-ACCOUNT
  9277        ELSE
  9278         MOVE SPACES             TO PB-ACCOUNT.
  9279
  9280     IF WS-ON1-SW7 IS EQUAL TO 'Y'
  9281         MOVE 'N'                TO WS-ON1-SW7
  9282         MOVE PB-GROUPING        TO PI-SAV-GROUPING
  9283         MOVE PB-STATE           TO PI-SAV-STATE
  9284         MOVE PB-ACCOUNT         TO PI-SAV-ACCOUNT.
  9285
  9286
  9287* EXEC CICS WRITE
  9288*        DATASET(ERPNDB-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 180
* EL630.cbl
  9289*        FROM   (PENDING-BUSINESS)
  9290*        RIDFLD (PB-CONTROL-PRIMARY)
  9291*    END-EXEC.
  9292     MOVE LENGTH OF
  9293      PENDING-BUSINESS
  9294       TO DFHEIV11
  9295*    MOVE '&$ L                  ''   #00007999' TO DFHEIV0
  9296     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9297     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9298     MOVE X'2020233030303037393939' TO DFHEIV0(25:11)
  9299     CALL 'kxdfhei1' USING DFHEIV0,
  9300           ERPNDB-FILE-ID,
  9301           PENDING-BUSINESS,
  9302           DFHEIV11,
  9303           PB-CONTROL-PRIMARY,
  9304           DFHEIV99,
  9305           DFHEIV99
  9306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9307
  9308
  9309     GO TO 6010-GET-NEXT-RECORD.
  9310
  9311 6400-STOP-BROWSE.
  9312
  9313* EXEC CICS ENDBR
  9314*        DATASET(ERPNDB-FILE-ID)
  9315*    END-EXEC.
  9316     MOVE 0
  9317       TO DFHEIV11
  9318*    MOVE '&2                    $   #00008008' TO DFHEIV0
  9319     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9320     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9321     MOVE X'2020233030303038303038' TO DFHEIV0(25:11)
  9322     CALL 'kxdfhei1' USING DFHEIV0,
  9323           ERPNDB-FILE-ID,
  9324           DFHEIV11,
  9325           DFHEIV99
  9326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9327
  9328
  9329     MOVE 'Y'                    TO  PI-UPDATE-SW.
  9330
  9331     IF PI-AR-PROCESSING
  9332        PERFORM 6600-REWRITE-REQUEST THRU 6690-EXIT.
  9333
  9334     MOVE ER-2990                TO EMI-ERROR.
  9335     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9336     MOVE -1                     TO MAINTL.
  9337     MOVE AL-SANON               TO MAINTA.
  9338     MOVE PI-SAV-REFERENCE       TO REFO.
  9339     GO TO 8200-SEND-DATAONLY.
  9340
  9341 6500-NO-RECORDS.
  9342     MOVE ER-2242                TO EMI-ERROR.
  9343     MOVE -1                     TO BATCHL.
  9344     MOVE AL-UABON               TO BATCHA.
  9345     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9346     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 181
* EL630.cbl
  9347
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 182
* EL630.cbl
  9349
  9350******************************************************************
  9351*                                                                *
  9352*          R E W R I T E   R E Q U E S T   R E C O R D           *
  9353*                                                                *
  9354******************************************************************
  9355
  9356 6600-REWRITE-REQUEST.
  9357
  9358
  9359* EXEC CICS HANDLE CONDITION
  9360*        NOTFND (6690-EXIT)
  9361*    END-EXEC.
  9362*    MOVE '"$I                   ! > #00008041' TO DFHEIV0
  9363     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9365     MOVE X'3E20233030303038303431' TO DFHEIV0(25:11)
  9366     CALL 'kxdfhei1' USING DFHEIV0
  9367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9368
  9369
  9370     MOVE PI-COMPANY-CD          TO  ERRQST-COMP-CD.
  9371     MOVE PI-SAV-ENTRY-BATCH     TO  ERRQST-ENTRY-BATCH.
  9372
  9373
  9374* EXEC CICS READ
  9375*         DATASET    (ERRQST-FILE-ID)
  9376*         SET        (ADDRESS OF AR-REQUEST-RECORD)
  9377*         RIDFLD     (ERRQST-KEY)
  9378*         UPDATE
  9379*    END-EXEC.
  9380*    MOVE '&"S        EU         (   #00008048' TO DFHEIV0
  9381     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9382     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9383     MOVE X'2020233030303038303438' TO DFHEIV0(25:11)
  9384     CALL 'kxdfhei1' USING DFHEIV0,
  9385           ERRQST-FILE-ID,
  9386           DFHEIV20,
  9387           DFHEIV99,
  9388           ERRQST-KEY,
  9389           DFHEIV99,
  9390           DFHEIV99,
  9391           DFHEIV99
  9392     SET ADDRESS OF AR-REQUEST-RECORD TO
  9393         DFHEIV20
  9394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9395
  9396
  9397     IF  CARRIERL GREATER ZEROS
  9398         MOVE CARRIERI           TO RQ-CARRIER-A1
  9399                                    RQ-CARRIER-A2
  9400                                    RQ-CARRIER-A2.
  9401
  9402     IF  GROUPL   GREATER ZEROS
  9403         MOVE GROUPI             TO RQ-GROUPING-A1
  9404                                    RQ-GROUPING-A2
  9405                                    RQ-GROUPING-A3.
  9406
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 183
* EL630.cbl
  9407     IF  STATEL   GREATER ZEROS
  9408         MOVE STATEI             TO RQ-STATE-A1.
  9409
  9410     IF  ACCOUNTL GREATER ZEROS
  9411         MOVE ACCOUNTI           TO RQ-ACCOUNT-A1
  9412                                    RQ-ACCOUNT-A4.
  9413
  9414     IF PI-ZERO-CARRIER
  9415        MOVE ZERO                TO RQ-CARRIER-A2.
  9416
  9417     IF PI-ZERO-GROUPING
  9418        MOVE ZEROS               TO RQ-GROUPING-A2.
  9419
  9420     IF PI-ZERO-CAR-GROUP
  9421        MOVE ZEROS               TO RQ-CARRIER-A2
  9422                                    RQ-GROUPING-A2.
  9423
  9424     MOVE PI-REMIT-AGENT (PI-SUB) TO RQ-FIN-RESP-A2
  9425                                     PI-FIN-RESP.
  9426
  9427     MOVE PI-ACCT-AGENT  (PI-SUB) TO RQ-ACCT-AGENT-A2
  9428                                     PI-ACCOUNT-AGENT.
  9429
  9430
  9431* EXEC CICS REWRITE
  9432*         DATASET    (ERRQST-FILE-ID)
  9433*         FROM       (AR-REQUEST-RECORD)
  9434*    END-EXEC.
  9435     MOVE LENGTH OF
  9436      AR-REQUEST-RECORD
  9437       TO DFHEIV11
  9438*    MOVE '&& L                  %   #00008088' TO DFHEIV0
  9439     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9440     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9441     MOVE X'2020233030303038303838' TO DFHEIV0(25:11)
  9442     CALL 'kxdfhei1' USING DFHEIV0,
  9443           ERRQST-FILE-ID,
  9444           AR-REQUEST-RECORD,
  9445           DFHEIV11,
  9446           DFHEIV99
  9447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9448
  9449
  9450 6690-EXIT.
  9451     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 184
* EL630.cbl
  9453
  9454******************************************************************
  9455*                                                                *
  9456*           V E R I F Y   R E Q U E S T   R E C O R D            *
  9457*                                                                *
  9458******************************************************************
  9459
  9460 7000-VERIFY-REQUEST-REC.
  9461
  9462* EXEC CICS HANDLE CONDITION
  9463*        NOTFND(7090-EXIT)
  9464*    END-EXEC.
  9465*    MOVE '"$I                   ! ? #00008104' TO DFHEIV0
  9466     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9468     MOVE X'3F20233030303038313034' TO DFHEIV0(25:11)
  9469     CALL 'kxdfhei1' USING DFHEIV0
  9470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9471
  9472
  9473     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9474     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9475
  9476
  9477* EXEC CICS READ
  9478*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9479*        DATASET(ERRQST-FILE-ID)
  9480*        RIDFLD (ERRQST-KEY)
  9481*    END-EXEC.
  9482*    MOVE '&"S        E          (   #00008111' TO DFHEIV0
  9483     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9484     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9485     MOVE X'2020233030303038313131' TO DFHEIV0(25:11)
  9486     CALL 'kxdfhei1' USING DFHEIV0,
  9487           ERRQST-FILE-ID,
  9488           DFHEIV20,
  9489           DFHEIV99,
  9490           ERRQST-KEY,
  9491           DFHEIV99,
  9492           DFHEIV99,
  9493           DFHEIV99
  9494     SET ADDRESS OF AR-REQUEST-RECORD TO
  9495         DFHEIV20
  9496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9497
  9498
  9499     IF RQ-STMT-DT NOT = LOW-VALUES
  9500        MOVE ER-2126        TO EMI-ERROR
  9501        MOVE -1             TO BATCHL
  9502        MOVE AL-UABON       TO BATCHA
  9503        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  9504        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9505        GO TO 7090-EXIT.
  9506
  9507******************************************************************
  9508*                                                                *
  9509*   IF THE BATCH IS BEING DELETED (PF2), DELETE REQUEST RECORD.  *
  9510*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 185
* EL630.cbl
  9511******************************************************************
  9512
  9513     IF EIBAID = DFHPF2
  9514        NEXT SENTENCE
  9515     ELSE
  9516        GO TO 7090-EXIT.
  9517
  9518
  9519* EXEC CICS READ
  9520*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9521*        DATASET(ERRQST-FILE-ID)
  9522*        RIDFLD (ERRQST-KEY)
  9523*        UPDATE
  9524*    END-EXEC.
  9525*    MOVE '&"S        EU         (   #00008136' TO DFHEIV0
  9526     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9527     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9528     MOVE X'2020233030303038313336' TO DFHEIV0(25:11)
  9529     CALL 'kxdfhei1' USING DFHEIV0,
  9530           ERRQST-FILE-ID,
  9531           DFHEIV20,
  9532           DFHEIV99,
  9533           ERRQST-KEY,
  9534           DFHEIV99,
  9535           DFHEIV99,
  9536           DFHEIV99
  9537     SET ADDRESS OF AR-REQUEST-RECORD TO
  9538         DFHEIV20
  9539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9540
  9541
  9542
  9543* EXEC CICS DELETE
  9544*        DATASET(ERRQST-FILE-ID)
  9545*    END-EXEC.
  9546*    MOVE '&(                    &   #00008143' TO DFHEIV0
  9547     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9548     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9549     MOVE X'2020233030303038313433' TO DFHEIV0(25:11)
  9550     CALL 'kxdfhei1' USING DFHEIV0,
  9551           ERRQST-FILE-ID,
  9552           DFHEIV99,
  9553           DFHEIV99,
  9554           DFHEIV99,
  9555           DFHEIV99
  9556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9557
  9558
  9559 7090-EXIT.
  9560      EXIT.
  9561
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 186
* EL630.cbl
  9563
  9564 7100-REWRITE-REQUEST-REC.
  9565
  9566
  9567* EXEC CICS HANDLE CONDITION
  9568*        NOTFND(7180-NO-REQUEST-REC)
  9569*    END-EXEC.
  9570*    MOVE '"$I                   ! @ #00008154' TO DFHEIV0
  9571     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9573     MOVE X'4020233030303038313534' TO DFHEIV0(25:11)
  9574     CALL 'kxdfhei1' USING DFHEIV0
  9575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9576
  9577
  9578
  9579     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9580     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9581
  9582
  9583* EXEC CICS READ
  9584*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9585*        DATASET(ERRQST-FILE-ID)
  9586*        RIDFLD (ERRQST-KEY)
  9587*        UPDATE
  9588*    END-EXEC.
  9589*    MOVE '&"S        EU         (   #00008162' TO DFHEIV0
  9590     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9591     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9592     MOVE X'2020233030303038313632' TO DFHEIV0(25:11)
  9593     CALL 'kxdfhei1' USING DFHEIV0,
  9594           ERRQST-FILE-ID,
  9595           DFHEIV20,
  9596           DFHEIV99,
  9597           ERRQST-KEY,
  9598           DFHEIV99,
  9599           DFHEIV99,
  9600           DFHEIV99
  9601     SET ADDRESS OF AR-REQUEST-RECORD TO
  9602         DFHEIV20
  9603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9604
  9605
  9606     IF RQ-STMT-DT NOT = LOW-VALUES
  9607        MOVE ER-2126        TO EMI-ERROR
  9608        MOVE -1             TO BATCHL
  9609        MOVE AL-UABON       TO BATCHA
  9610        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  9611        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9612        GO TO 7190-EXIT.
  9613
  9614     MOVE PI-SAV-REFERENCE  TO RQ-REFERENCE-A1
  9615                               RQ-REFERENCE-A2
  9616                               RQ-REFERENCE-A4.
  9617
  9618
  9619* EXEC CICS REWRITE
  9620*        DATASET(ERRQST-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 187
* EL630.cbl
  9621*        FROM   (AR-REQUEST-RECORD)
  9622*    END-EXEC.
  9623     MOVE LENGTH OF
  9624      AR-REQUEST-RECORD
  9625       TO DFHEIV11
  9626*    MOVE '&& L                  %   #00008181' TO DFHEIV0
  9627     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9628     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9629     MOVE X'2020233030303038313831' TO DFHEIV0(25:11)
  9630     CALL 'kxdfhei1' USING DFHEIV0,
  9631           ERRQST-FILE-ID,
  9632           AR-REQUEST-RECORD,
  9633           DFHEIV11,
  9634           DFHEIV99
  9635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9636
  9637
  9638     GO TO 7190-EXIT.
  9639
  9640 7180-NO-REQUEST-REC.
  9641     MOVE ER-2132        TO EMI-ERROR.
  9642     MOVE -1             TO BATCHL.
  9643     MOVE AL-UABON       TO BATCHA.
  9644     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9645     MOVE 'N'            TO WS-RECORD-FOUND-SW.
  9646     GO TO 7190-EXIT.
  9647
  9648 7190-EXIT.
  9649     EXIT.
  9650
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 188
* EL630.cbl
  9652
  9653******************************************************************
  9654*
  9655*     7200-REWRITE IS USED TO REWRITE THE REQUEST FILE WHEN
  9656*     THE EOM DATE IS CHANGED.
  9657*
  9658******************************************************************
  9659
  9660 7200-REWRITE-REQUEST.
  9661
  9662* EXEC CICS HANDLE CONDITION
  9663*        NOTFND(7280-NO-REQUEST-REC)
  9664*    END-EXEC.
  9665*    MOVE '"$I                   ! A #00008209' TO DFHEIV0
  9666     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9668     MOVE X'4120233030303038323039' TO DFHEIV0(25:11)
  9669     CALL 'kxdfhei1' USING DFHEIV0
  9670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9671
  9672
  9673     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9674     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9675
  9676
  9677* EXEC CICS READ
  9678*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9679*        DATASET(ERRQST-FILE-ID)
  9680*        RIDFLD (ERRQST-KEY)
  9681*        UPDATE
  9682*    END-EXEC.
  9683*    MOVE '&"S        EU         (   #00008216' TO DFHEIV0
  9684     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9685     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9686     MOVE X'2020233030303038323136' TO DFHEIV0(25:11)
  9687     CALL 'kxdfhei1' USING DFHEIV0,
  9688           ERRQST-FILE-ID,
  9689           DFHEIV20,
  9690           DFHEIV99,
  9691           ERRQST-KEY,
  9692           DFHEIV99,
  9693           DFHEIV99,
  9694           DFHEIV99
  9695     SET ADDRESS OF AR-REQUEST-RECORD TO
  9696         DFHEIV20
  9697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9698
  9699
  9700     IF RQ-STMT-DT NOT = LOW-VALUES
  9701        MOVE ER-2126        TO EMI-ERROR
  9702        MOVE -1             TO BATCHL
  9703        MOVE AL-UABON       TO BATCHA
  9704        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9705        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9706        GO TO 7299-EXIT.
  9707
  9708
  9709     IF PI-NB-MONTH-END-DT NOT = RQ-MO-END-DT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 189
* EL630.cbl
  9710        MOVE PI-NB-MONTH-END-DT  TO  RQ-MO-END-DT.
  9711
  9712     IF PI-SAV-REFERENCE NOT = RQ-REFERENCE-A1
  9713        MOVE PI-SAV-REFERENCE    TO RQ-REFERENCE-A1
  9714                                    RQ-REFERENCE-A2
  9715                                    RQ-REFERENCE-A4.
  9716
  9717
  9718* EXEC CICS REWRITE
  9719*        DATASET(ERRQST-FILE-ID)
  9720*        FROM   (AR-REQUEST-RECORD)
  9721*    END-EXEC.
  9722     MOVE LENGTH OF
  9723      AR-REQUEST-RECORD
  9724       TO DFHEIV11
  9725*    MOVE '&& L                  %   #00008240' TO DFHEIV0
  9726     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9727     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9728     MOVE X'2020233030303038323430' TO DFHEIV0(25:11)
  9729     CALL 'kxdfhei1' USING DFHEIV0,
  9730           ERRQST-FILE-ID,
  9731           AR-REQUEST-RECORD,
  9732           DFHEIV11,
  9733           DFHEIV99
  9734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9735
  9736
  9737     GO TO 7299-EXIT.
  9738
  9739 7280-NO-REQUEST-REC.
  9740     MOVE ER-2132        TO EMI-ERROR.
  9741     MOVE -1             TO BATCHL.
  9742     MOVE AL-UABON       TO BATCHA.
  9743     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9744     MOVE 'N'            TO WS-RECORD-FOUND-SW.
  9745
  9746 7299-EXIT.
  9747     EXIT.
  9748
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 190
* EL630.cbl
  9750
  9751 8100-SEND-INITIAL-MAP.
  9752     MOVE WS-CURRENT-DT          TO DATEO.
  9753     MOVE EIBTIME                TO TIME-IN.
  9754     MOVE TIME-OUT               TO TIMEO.
  9755     MOVE -1                     TO MAINTL.
  9756     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  9757     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  9758
  9759     MOVE PI-LIFE-OVERRIDE-L2    TO WS-PRM-OVERRIDE
  9760                                    WS-REFUND-OVERRIDE.
  9761     MOVE WS-PRM-HEADER          TO LFPHDGO.
  9762     MOVE WS-REFUND-HEADER       TO LFRHDGO.
  9763
  9764     MOVE PI-AH-OVERRIDE-L2      TO WS-PRM-OVERRIDE
  9765                                    WS-REFUND-OVERRIDE.
  9766     MOVE WS-PRM-HEADER          TO AHPHDGO.
  9767     MOVE WS-REFUND-HEADER       TO AHRHDGO.
  9768
  9769     IF NOT PI-AR-PROCESSING
  9770        MOVE AL-SADOF            TO REFHDGA
  9771                                    REFA.
  9772
  9773     MOVE AL-SANOF               TO PF5A.
  9774
  9775     IF CARR-GROUP-ST-ACCNT-CNTL
  9776         NEXT SENTENCE
  9777     ELSE
  9778         IF ST-ACCNT-CNTL
  9779             MOVE AL-SADOF       TO CARRHDGA
  9780                                    GRPHDGA
  9781             MOVE AL-SANOF       TO CARRIERA
  9782                                    GROUPA
  9783         ELSE
  9784             IF CARR-ST-ACCNT-CNTL
  9785                 MOVE AL-SADOF   TO GRPHDGA
  9786                 MOVE AL-SANOF   TO GROUPA
  9787             ELSE
  9788                 IF ACCNT-CNTL
  9789                     MOVE AL-SADOF TO CARRHDGA
  9790                                      GRPHDGA
  9791                                      STHDGA
  9792                     MOVE AL-SANOF TO CARRIERA
  9793                                      GROUPA
  9794                                      STATEA
  9795                 ELSE
  9796                     IF CARR-ACCNT-CNTL
  9797                         MOVE AL-SADOF TO GRPHDGA
  9798                                          STHDGA
  9799                         MOVE AL-SANOF TO GROUPA
  9800                                          STATEA.
  9801
  9802* EXEC CICS SEND
  9803*        MAP      (MAP-NAME)
  9804*        MAPSET   (MAPSET-NAME)
  9805*        FROM     (EL630AO)
  9806*        ERASE
  9807*        CURSOR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 191
* EL630.cbl
  9808*    END-EXEC.
  9809     MOVE LENGTH OF
  9810      EL630AO
  9811       TO DFHEIV12
  9812     MOVE -1
  9813       TO DFHEIV11
  9814*    MOVE '8$     CT  E    H L F ,   #00008309' TO DFHEIV0
  9815     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9816     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9817     MOVE X'2020233030303038333039' TO DFHEIV0(25:11)
  9818     CALL 'kxdfhei1' USING DFHEIV0,
  9819           MAP-NAME,
  9820           EL630AO,
  9821           DFHEIV12,
  9822           MAPSET-NAME,
  9823           DFHEIV99,
  9824           DFHEIV99,
  9825           DFHEIV99,
  9826           DFHEIV11,
  9827           DFHEIV99,
  9828           DFHEIV99,
  9829           DFHEIV99
  9830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9831
  9832
  9833     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 192
* EL630.cbl
  9835
  9836 8200-SEND-DATAONLY.
  9837     MOVE WS-CURRENT-DT          TO DATEO.
  9838     MOVE EIBTIME                TO TIME-IN.
  9839     MOVE TIME-OUT               TO TIMEO.
  9840     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  9841     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  9842
  9843* EXEC CICS SEND
  9844*        MAP      (MAP-NAME)
  9845*        MAPSET   (MAPSET-NAME)
  9846*        FROM     (EL630AO)
  9847*        DATAONLY
  9848*        ERASEAUP
  9849*        CURSOR
  9850*    END-EXEC.
  9851     MOVE LENGTH OF
  9852      EL630AO
  9853       TO DFHEIV12
  9854     MOVE -1
  9855       TO DFHEIV11
  9856*    MOVE '8$D    CT  A    H L F ,   #00008326' TO DFHEIV0
  9857     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9858     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9859     MOVE X'2020233030303038333236' TO DFHEIV0(25:11)
  9860     CALL 'kxdfhei1' USING DFHEIV0,
  9861           MAP-NAME,
  9862           EL630AO,
  9863           DFHEIV12,
  9864           MAPSET-NAME,
  9865           DFHEIV99,
  9866           DFHEIV99,
  9867           DFHEIV99,
  9868           DFHEIV11,
  9869           DFHEIV99,
  9870           DFHEIV99,
  9871           DFHEIV99
  9872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9873
  9874
  9875     GO TO 9100-RETURN-TRAN.
  9876
  9877 8300-SEND-TEXT.
  9878
  9879* EXEC CICS SEND TEXT
  9880*        FROM     (LOGOFF-TEXT)
  9881*        LENGTH   (LOGOFF-LENGTH)
  9882*        ERASE
  9883*        FREEKB
  9884*    END-EXEC.
  9885*    MOVE '8&      T  E F  H   F -   #00008338' TO DFHEIV0
  9886     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9887     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9888     MOVE X'2020233030303038333338' TO DFHEIV0(25:11)
  9889     CALL 'kxdfhei1' USING DFHEIV0,
  9890           LOGOFF-TEXT,
  9891           LOGOFF-LENGTH,
  9892           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 193
* EL630.cbl
  9893           DFHEIV99,
  9894           DFHEIV99,
  9895           DFHEIV99,
  9896           DFHEIV99,
  9897           DFHEIV99,
  9898           DFHEIV99,
  9899           DFHEIV99,
  9900           DFHEIV99,
  9901           DFHEIV99
  9902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9903
  9904
  9905
  9906* EXEC CICS RETURN
  9907*    END-EXEC.
  9908*    MOVE '.(                    ''   #00008345' TO DFHEIV0
  9909     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9910     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9911     MOVE X'2020233030303038333435' TO DFHEIV0(25:11)
  9912     CALL 'kxdfhei1' USING DFHEIV0,
  9913           DFHEIV99,
  9914           DFHEIV99,
  9915           DFHEIV99,
  9916           DFHEIV99,
  9917           DFHEIV99,
  9918           DFHEIV99
  9919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9920
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 194
* EL630.cbl
  9922 8600-DEEDIT.
  9923
  9924* EXEC CICS BIF DEEDIT
  9925*        FIELD (WS-DEEDIT-FIELD)
  9926*        LENGTH(10)
  9927*     END-EXEC.
  9928     MOVE 10
  9929       TO DFHEIV11
  9930*    MOVE '@"L                   #   #00008349' TO DFHEIV0
  9931     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9932     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9933     MOVE X'2020233030303038333439' TO DFHEIV0(25:11)
  9934     CALL 'kxdfhei1' USING DFHEIV0,
  9935           WS-DEEDIT-FIELD,
  9936           DFHEIV11
  9937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9938
  9939
  9940 8600-EXIT.
  9941     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 195
* EL630.cbl
  9943 8800-UNAUTHORIZED-ACCESS.
  9944     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  9945     GO TO 8300-SEND-TEXT.
  9946
  9947 8810-PF23.
  9948     IF NOT PI-DATA-UPDATED
  9949         NEXT SENTENCE
  9950     ELSE
  9951         MOVE -1                 TO PFENTERL
  9952         MOVE ER-2213            TO EMI-ERROR
  9953         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9954         GO TO 4000-SHOW-TOTALS.
  9955
  9956     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  9957     MOVE XCTL-005               TO PGM-NAME.
  9958     GO TO 9300-XCTL.
  9959
  9960 9100-RETURN-TRAN.
  9961     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  9962     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  9963
  9964* EXEC CICS RETURN
  9965*        TRANSID    (TRANS-ID)
  9966*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9967*        LENGTH     (WS-COMM-LENGTH)
  9968*    END-EXEC.
  9969*    MOVE '.(CT                  ''   #00008377' TO DFHEIV0
  9970     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9971     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9972     MOVE X'2020233030303038333737' TO DFHEIV0(25:11)
  9973     CALL 'kxdfhei1' USING DFHEIV0,
  9974           TRANS-ID,
  9975           PROGRAM-INTERFACE-BLOCK,
  9976           WS-COMM-LENGTH,
  9977           DFHEIV99,
  9978           DFHEIV99,
  9979           DFHEIV99
  9980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9981
  9982
  9983     MOVE ZEROS  TO RETURN-CODE.
  9984
  9985* GOBACK.
  9986     MOVE '9%                    "   ' TO DFHEIV0
  9987     MOVE 'EL630' TO DFHEIV1
  9988     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9989     GOBACK.
  9990
  9991 9200-RETURN-MAIN-MENU.
  9992     IF NOT PI-DATA-UPDATED
  9993         NEXT SENTENCE
  9994     ELSE
  9995         MOVE -1                 TO PFENTERL
  9996         MOVE ER-2213            TO EMI-ERROR
  9997         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9998         GO TO 4000-SHOW-TOTALS.
  9999
 10000     MOVE XCTL-626               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 196
* EL630.cbl
 10001     GO TO 9300-XCTL.
 10002
 10003 9300-XCTL.
 10004
 10005* EXEC CICS XCTL
 10006*        PROGRAM    (PGM-NAME)
 10007*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10008*        LENGTH     (WS-COMM-LENGTH)
 10009*    END-EXEC.
 10010*    MOVE '.$C                   %   #00008399' TO DFHEIV0
 10011     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10012     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10013     MOVE X'2020233030303038333939' TO DFHEIV0(25:11)
 10014     CALL 'kxdfhei1' USING DFHEIV0,
 10015           PGM-NAME,
 10016           PROGRAM-INTERFACE-BLOCK,
 10017           WS-COMM-LENGTH,
 10018           DFHEIV99
 10019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10020
 10021     MOVE ZEROS  TO RETURN-CODE.
 10022
 10023* GOBACK.
 10024     MOVE '9%                    "   ' TO DFHEIV0
 10025     MOVE 'EL630' TO DFHEIV1
 10026     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10027     GOBACK.
 10028
 10029 9400-CLEAR.
 10030     IF NOT PI-DATA-UPDATED
 10031         NEXT SENTENCE
 10032     ELSE
 10033         MOVE 'Y'                TO PI-CLEAR-ERROR-SW
 10034         MOVE -1                 TO PFENTERL
 10035         MOVE ER-2213            TO EMI-ERROR
 10036         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10037         GO TO 4000-SHOW-TOTALS.
 10038
 10039     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 10040     GO TO 9300-XCTL.
 10041
 10042 9500-PF12.
 10043     MOVE XCTL-010               TO PGM-NAME.
 10044     GO TO 9300-XCTL.
 10045
 10046 9600-PGMID-ERROR.
 10047
 10048* EXEC CICS HANDLE CONDITION
 10049*        PGMIDERR    (8300-SEND-TEXT)
 10050*    END-EXEC.
 10051*    MOVE '"$L                   ! B #00008425' TO DFHEIV0
 10052     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10053     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10054     MOVE X'4220233030303038343235' TO DFHEIV0(25:11)
 10055     CALL 'kxdfhei1' USING DFHEIV0
 10056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10057
 10058
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 197
* EL630.cbl
 10059     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10060     MOVE ' '                    TO PI-ENTRY-CD-1.
 10061     MOVE XCTL-005               TO PGM-NAME.
 10062     MOVE PGM-NAME               TO LOGOFF-PGM.
 10063     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10064     GO TO 9300-XCTL.
 10065
 10066 9700-DATE-LINK.
 10067     MOVE LINK-ELDATCV           TO PGM-NAME.
 10068
 10069* EXEC CICS LINK
 10070*        PROGRAM    (PGM-NAME)
 10071*        COMMAREA   (DATE-CONVERSION-DATA)
 10072*        LENGTH     (DC-COMM-LENGTH)
 10073*    END-EXEC.
 10074*    MOVE '."C                   (   #00008438' TO DFHEIV0
 10075     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10076     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10077     MOVE X'2020233030303038343338' TO DFHEIV0(25:11)
 10078     CALL 'kxdfhei1' USING DFHEIV0,
 10079           PGM-NAME,
 10080           DATE-CONVERSION-DATA,
 10081           DC-COMM-LENGTH,
 10082           DFHEIV99,
 10083           DFHEIV99,
 10084           DFHEIV99,
 10085           DFHEIV99
 10086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10087
 10088
 10089 9900-ERROR-FORMAT.
 10090     IF NOT EMI-ERRORS-COMPLETE
 10091         MOVE LINK-001           TO PGM-NAME
 10092
 10093* EXEC CICS LINK
 10094*            PROGRAM    (PGM-NAME)
 10095*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10096*            LENGTH     (EMI-COMM-LENGTH)
 10097*        END-EXEC.
 10098*    MOVE '."C                   (   #00008447' TO DFHEIV0
 10099     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10100     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10101     MOVE X'2020233030303038343437' TO DFHEIV0(25:11)
 10102     CALL 'kxdfhei1' USING DFHEIV0,
 10103           PGM-NAME,
 10104           ERROR-MESSAGE-INTERFACE-BLOCK,
 10105           EMI-COMM-LENGTH,
 10106           DFHEIV99,
 10107           DFHEIV99,
 10108           DFHEIV99,
 10109           DFHEIV99
 10110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10111
 10112
 10113 9900-EXIT.
 10114     EXIT.
 10115
 10116 9990-ABEND.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 198
* EL630.cbl
 10117     MOVE LINK-004               TO PGM-NAME.
 10118     MOVE DFHEIBLK               TO EMI-LINE1.
 10119
 10120* EXEC CICS LINK
 10121*        PROGRAM   (PGM-NAME)
 10122*        COMMAREA  (EMI-LINE1)
 10123*        LENGTH    (72)
 10124*    END-EXEC.
 10125     MOVE 72
 10126       TO DFHEIV11
 10127*    MOVE '."C                   (   #00008459' TO DFHEIV0
 10128     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10129     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10130     MOVE X'2020233030303038343539' TO DFHEIV0(25:11)
 10131     CALL 'kxdfhei1' USING DFHEIV0,
 10132           PGM-NAME,
 10133           EMI-LINE1,
 10134           DFHEIV11,
 10135           DFHEIV99,
 10136           DFHEIV99,
 10137           DFHEIV99,
 10138           DFHEIV99
 10139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10140
 10141
 10142     MOVE -1                     TO PFENTERL.
 10143     GO TO 8200-SEND-DATAONLY.
 10144
 10145 9995-SECURITY-VIOLATION.
 10146*                            COPY ELCSCTP.
 10147******************************************************************
 10148*                                                                *
 10149*                            ELCSCTP                             *
 10150*                            VMOD=2.001                          *
 10151*                                                                *
 10152*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10153******************************************************************
 10154
 10155
 10156     MOVE EIBDATE          TO SM-JUL-DATE.
 10157     MOVE EIBTRMID         TO SM-TERMID.
 10158     MOVE THIS-PGM         TO SM-PGM.
 10159     MOVE EIBTIME          TO TIME-IN.
 10160     MOVE TIME-OUT         TO SM-TIME.
 10161     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10162
 10163
 10164* EXEC CICS LINK
 10165*         PROGRAM  ('EL003')
 10166*         COMMAREA (SECURITY-MESSAGE)
 10167*         LENGTH   (80)
 10168*    END-EXEC.
 10169     MOVE 'EL003' TO DFHEIV1
 10170     MOVE 80
 10171       TO DFHEIV11
 10172*    MOVE '."C                   (   #00008486' TO DFHEIV0
 10173     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 199
* EL630.cbl
 10175     MOVE X'2020233030303038343836' TO DFHEIV0(25:11)
 10176     CALL 'kxdfhei1' USING DFHEIV0,
 10177           DFHEIV1,
 10178           SECURITY-MESSAGE,
 10179           DFHEIV11,
 10180           DFHEIV99,
 10181           DFHEIV99,
 10182           DFHEIV99,
 10183           DFHEIV99
 10184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10185
 10186
 10187******************************************************************
 10188
 10189
 10190 9995-EXIT.
 10191     EXIT.
 10192
 10193
 10194 9999-DFHBACK SECTION.
 10195     MOVE '9%                    "   ' TO DFHEIV0
 10196     MOVE 'EL630' TO DFHEIV1
 10197     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10198     GOBACK.
 10199 9999-DFHEXIT.
 10200     IF DFHEIGDJ EQUAL 0001
 10201         NEXT SENTENCE
 10202     ELSE IF DFHEIGDJ EQUAL 2
 10203         GO TO 9600-PGMID-ERROR,
 10204               9990-ABEND
 10205         DEPENDING ON DFHEIGDI
 10206     ELSE IF DFHEIGDJ EQUAL 3
 10207         GO TO 0350-NO-RECORDS,
 10208               0350-NO-RECORDS
 10209         DEPENDING ON DFHEIGDI
 10210     ELSE IF DFHEIGDJ EQUAL 4
 10211         GO TO 0480-NO-BATCH-TRAILER
 10212         DEPENDING ON DFHEIGDI
 10213     ELSE IF DFHEIGDJ EQUAL 5
 10214         GO TO 1000-NO-CARRIER
 10215         DEPENDING ON DFHEIGDI
 10216     ELSE IF DFHEIGDJ EQUAL 6
 10217         GO TO 1100-NO-STATE
 10218         DEPENDING ON DFHEIGDI
 10219     ELSE IF DFHEIGDJ EQUAL 7
 10220         GO TO 1200-ACCOUNT-INVALID,
 10221               1200-ACCOUNT-INVALID
 10222         DEPENDING ON DFHEIGDI
 10223     ELSE IF DFHEIGDJ EQUAL 8
 10224         GO TO 1250-NO-COMPANY-REC
 10225         DEPENDING ON DFHEIGDI
 10226     ELSE IF DFHEIGDJ EQUAL 9
 10227         GO TO 1300-NO-COMPANY-REC
 10228         DEPENDING ON DFHEIGDI
 10229     ELSE IF DFHEIGDJ EQUAL 10
 10230         GO TO 1300-EXIT
 10231         DEPENDING ON DFHEIGDI
 10232     ELSE IF DFHEIGDJ EQUAL 11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 200
* EL630.cbl
 10233         GO TO 1470-NO-COMP-MSTR
 10234         DEPENDING ON DFHEIGDI
 10235     ELSE IF DFHEIGDJ EQUAL 12
 10236         GO TO 1990-EXIT
 10237         DEPENDING ON DFHEIGDI
 10238     ELSE IF DFHEIGDJ EQUAL 13
 10239         GO TO 2100-ADD-BATCH-TOTAL-REC
 10240         DEPENDING ON DFHEIGDI
 10241     ELSE IF DFHEIGDJ EQUAL 14
 10242         GO TO 3200-NO-RECORDS
 10243         DEPENDING ON DFHEIGDI
 10244     ELSE IF DFHEIGDJ EQUAL 15
 10245         GO TO 3120-END-ROUTINE
 10246         DEPENDING ON DFHEIGDI
 10247     ELSE IF DFHEIGDJ EQUAL 16
 10248         GO TO 3100-STOP-BROWSE,
 10249               3100-STOP-BROWSE
 10250         DEPENDING ON DFHEIGDI
 10251     ELSE IF DFHEIGDJ EQUAL 17
 10252         GO TO 3006-DELETE-CERTIFICATE,
 10253               3006-DELETE-CERTIFICATE
 10254         DEPENDING ON DFHEIGDI
 10255     ELSE IF DFHEIGDJ EQUAL 18
 10256         GO TO 3020-CONTINUE-DELETE
 10257         DEPENDING ON DFHEIGDI
 10258     ELSE IF DFHEIGDJ EQUAL 19
 10259         GO TO 3006-DELETE-ERNOTE
 10260         DEPENDING ON DFHEIGDI
 10261     ELSE IF DFHEIGDJ EQUAL 20
 10262         GO TO 3007-DELETE-MAILING-DATA
 10263         DEPENDING ON DFHEIGDI
 10264     ELSE IF DFHEIGDJ EQUAL 21
 10265         GO TO 3020-CONTINUE-DELETE,
 10266               3020-CONTINUE-DELETE
 10267         DEPENDING ON DFHEIGDI
 10268     ELSE IF DFHEIGDJ EQUAL 22
 10269         GO TO 5900-EXIT
 10270         DEPENDING ON DFHEIGDI
 10271     ELSE IF DFHEIGDJ EQUAL 23
 10272         GO TO 5100-STOP-BROWSE,
 10273               5100-STOP-BROWSE
 10274         DEPENDING ON DFHEIGDI
 10275     ELSE IF DFHEIGDJ EQUAL 24
 10276         GO TO 6500-NO-RECORDS
 10277         DEPENDING ON DFHEIGDI
 10278     ELSE IF DFHEIGDJ EQUAL 25
 10279         GO TO 6400-STOP-BROWSE,
 10280               6400-STOP-BROWSE
 10281         DEPENDING ON DFHEIGDI
 10282     ELSE IF DFHEIGDJ EQUAL 26
 10283         GO TO 6300-WRITE-PNDB-RECORD
 10284         DEPENDING ON DFHEIGDI
 10285     ELSE IF DFHEIGDJ EQUAL 27
 10286         GO TO 6070-DELETE-MAILING
 10287         DEPENDING ON DFHEIGDI
 10288     ELSE IF DFHEIGDJ EQUAL 28
 10289         GO TO 6300-WRITE-PNDB-RECORD,
 10290               6300-WRITE-PNDB-RECORD
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 201
* EL630.cbl
 10291         DEPENDING ON DFHEIGDI
 10292     ELSE IF DFHEIGDJ EQUAL 29
 10293         GO TO 6300-WRITE-PNDB-RECORD
 10294         DEPENDING ON DFHEIGDI
 10295     ELSE IF DFHEIGDJ EQUAL 30
 10296         GO TO 6690-EXIT
 10297         DEPENDING ON DFHEIGDI
 10298     ELSE IF DFHEIGDJ EQUAL 31
 10299         GO TO 7090-EXIT
 10300         DEPENDING ON DFHEIGDI
 10301     ELSE IF DFHEIGDJ EQUAL 32
 10302         GO TO 7180-NO-REQUEST-REC
 10303         DEPENDING ON DFHEIGDI
 10304     ELSE IF DFHEIGDJ EQUAL 33
 10305         GO TO 7280-NO-REQUEST-REC
 10306         DEPENDING ON DFHEIGDI
 10307     ELSE IF DFHEIGDJ EQUAL 34
 10308         GO TO 8300-SEND-TEXT
 10309         DEPENDING ON DFHEIGDI.
 10310     MOVE '9%                    "   ' TO DFHEIV0
 10311     MOVE 'EL630' TO DFHEIV1
 10312     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10313     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6372     Code:       27693
