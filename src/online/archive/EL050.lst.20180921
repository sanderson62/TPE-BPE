* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    58******************************************************************
    59 ENVIRONMENT DIVISION.
    60
    61 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   3
* EL050.cbl
    63 WORKING-STORAGE SECTION.
    64 01  DFH-START PIC X(04).
    65
    66 77  FILLER   PIC X(32) VALUE '********************************'.
    67 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    68 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    69
    70 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    71 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    72                                   USAGE POINTER.
    73 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    74 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    75 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    76                                   USAGE IS POINTER.
    77 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    79                                   USAGE IS POINTER.
    80 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    82                                   USAGE IS POINTER.
    83
    84 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    85 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    86                                   USAGE IS POINTER.
    87
    88*    COPY ELC50WS.
    89*****************************************************************
    90*                                                               *
    91*                            ELC50WS.                           *
    92*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    93*                            VMOD=2.061.                        *
    94*                                                               *
    95*   THIS IS THE WORKING STORAGE FOR EL050                       *
    96*                                   EL517                       *
    97*****************************************************************
    98******************************************************************
    99*                   C H A N G E   L O G
   100*
   101* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   102*-----------------------------------------------------------------
   103*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   104* EFFECTIVE    NUMBER
   105*-----------------------------------------------------------------
   106* 123102                   PEMA  ADD DCC PROCESSING
   107* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   108* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   109* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   110* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   111* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   112* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   113* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   114* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   115* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   116* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   117* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   118* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   119* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   120* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   4
* EL050.cbl
   121* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   122* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   123* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   124* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   125* 030309  CR2009021700001  PEMA  ADD ER-2883
   126* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   127* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   128* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   129* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   130* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   131* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   132* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   133* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   134* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   135* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   136* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   137* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   138* 061412  CR2011022800001  AJRA  NAPERSOFT
   139* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   140* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   141* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   142* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   143* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   144* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   145* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   146* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   147* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   148* 091114  IR2014091000001  TANA  ADD ERROR 2898
   149* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   150* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   151* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   152* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   153* 100617  CR2017062000003  PEMA  Inforce state comm cap
   154* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   155* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   156* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   157* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   158*-----------------------------------------------------------------
   159
   160 01  WORK-AREAS.
   161
   162*****************************************************************
   163*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   164*****************************************************************
   165
   166     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   167     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   168     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   169     12  WS-NAME-EDIT-WORK-AREA.
   170         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   171         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   172             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   173         16  WS-WORK-NAME.
   174             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   175             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   176             20  FILLER           PIC X(10)     VALUE SPACES.
   177         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   178             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   5
* EL050.cbl
   179
   180*****************************************************************
   181*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   182*****************************************************************
   183
   184     12  WS-ERRESC-KEY.
   185         16 WS-ERRESC-SEARCH-KEY.
   186             20  WS-ERRESC-COMPANY-CD PIC  X.
   187             20  WS-ERRESC-CARRIER    PIC  X.
   188             20  WS-ERRESC-GROUP      PIC X(6).
   189             20  WS-ERRESC-STATE      PIC XX.
   190             20  WS-ERRESC-ACCOUNT    PIC X(10).
   191         16 WS-ERRESC-RESIDUAL-KEY.
   192             20  WS-ERRESC-AGENT      PIC X(10).
   193             20  WS-ERRESC-RES-STATE  PIC XX.
   194             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   195*                                          YYYYMMDD
   196     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   197     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   198
   199*RESIDENT STATE TAX MASTER(ERRESS)
   200*
   201     12  WS-ERRESS-KEY.
   202         16  WS-ERRESS-COMPANY-CD      PIC  X.
   203         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   204         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   205         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   206*                                          YYYYMMDD
   207
   208     12  WS-CONTRACT-DATE              PIC 9(8).
   209*                                          YYYYMMDD
   210     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   211     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   212         16 WS-YEAR-YY                 PIC   9999.
   213         16 FILLER                     PIC 9(4).
   214*                                          YYYYMMDD
   215     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   216     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   217     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   218     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   219
   220     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   221         88  DPRB-1ST-TIME                      VALUE ' '.
   222
   223*****************************************************************
   224*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   225*****************************************************************
   226
   227     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   228     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   229     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   230     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   231     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   232     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   233     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   234     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   235     12  ws-st-agent-sig-edit    pic x          value spaces.
   236     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   6
* EL050.cbl
   237     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   239     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   240         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   241         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   242     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   243         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   244         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   245     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   246
   247     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   248     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   249
   250     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   251     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   256     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   257     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   261     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   262     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   263     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   264     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   265     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   279     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   280     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   281     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   282     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   283     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   284     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   285     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   286     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   287     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   288     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   289     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   290     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   291     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   292     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   293     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   294     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   7
* EL050.cbl
   295     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   296     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   297     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   298     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   299     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   300     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   301     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   302     12  WS-2671-SW               PIC X         VALUE SPACE.
   303     12  WS-2672-SW               PIC X         VALUE SPACE.
   304     12  ws-9813-sw               pic x         value spaces.
   305     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   306         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   307     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   308         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   309     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   310
   311     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   312         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   313         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   314         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   315         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   316
   317     12  WS-CREDIT-EDIT-CONTROLS.
   318         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   319         16  WS-MIN-AGE           PIC 99                VALUE  0.
   320         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   321         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   322         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   323         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   324
   325     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   326     12  WS-AGE-FIELDS.
   327         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   328         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   329         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   330         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   331
   332     12  WS-SAVE-ALLOWABLE-BENEFIT.
   333         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   334         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   335         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   336         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   337         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   338         16  FILLER                      PIC XX.
   339
   340     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   341     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   342     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   343     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   344     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   345     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   346     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   347     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   348     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   349     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   350
   351     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   352     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   8
* EL050.cbl
   353     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   354     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   355     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   356     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   357     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   358     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   359         88  WS-REDUCING              VALUE 'R'.
   360         88  WS-LEVEL                 VALUE 'L' 'P'.
   361     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   362
   363     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   364     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   365     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   366     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   367     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   368     12  ws-ah-max-bens           pic 99        value zeros.
   369     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   370     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   371     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   372     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   373
   374     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   375     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   376     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   377     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   378     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   379     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   380     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   381     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   382     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   383     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   384     12  WS-ACCT-SIG-SW.
   385         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   386         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   387     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   388     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   389     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   390     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   391     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   392     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   393     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   394     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   395     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   396     12  WS-INITIALS.
   397         16  WS-INIT-1            PIC X         VALUE SPACES.
   398         16  WS-INIT-2            PIC X         VALUE SPACES.
   399
   400     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   401     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   402     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   403     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   404     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   405*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   406     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   407     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   408     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   409     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   410     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   9
* EL050.cbl
   411     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   412     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   413     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   414     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   416     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   417     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   418     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   419     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   420     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   421     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   422     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   423     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   424     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   425     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   426     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   427     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   428******** FLA
   429     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   430     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   431     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   432     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   433     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   434********
   435     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   436     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   437     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   438     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   439     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   440     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   441     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   442     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   443     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   444     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   445
   446     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   447         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   448                                         '0' THRU '9'.
   449
   450     12  NUMBER-OF-MONTHS.
   451         16  SK-MO OCCURS 12 TIMES PIC X.
   452
   453     12  WS-WORK-DATE.
   454         16  WS-YEAR            PIC 99    VALUE 00.
   455         16  WS-MONTH           PIC 99    VALUE 00.
   456         16  WS-DAY             PIC 99    VALUE 00.
   457
   458     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   459     12  WS-WORK-CRIT-DEV       REDEFINES
   460         WS-WORK-LF-CRIT-PER    PIC X(03).
   461
   462     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   463     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   464
   465     12  WS-WORK-DATE-FROM.
   466         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   467         16  FILLER             PIC X  VALUE SPACE.
   468         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  10
* EL050.cbl
   469         16  FILLER             PIC X         VALUE SPACE.
   470         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   471
   472     12  WS-WORK-DATE-THRU.
   473         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   474         16  FILLER             PIC X         VALUE SPACE.
   475         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   476         16  FILLER             PIC X         VALUE SPACE.
   477         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   478
   479     12  WS-LF-INPUT-CD.
   480         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   481         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   482
   483     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   484     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   485         16  WS-AH-INPUT-CD-1   PIC X.
   486         16  WS-AH-INPUT-CD-2-3 PIC XX.
   487
   488     12  WS-SWITCHES.
   489         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   490         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   491             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   492         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   493             88  BANK-ACCT-FOUND          VALUE 'Y'.
   494         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   495             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   496         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   497             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   498         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   499             88  COMP-MASTER-FOUND        VALUE 'Y'.
   500         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   501             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   502         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   503             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   504         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   505             88  STAT-MASTER-FOUND        VALUE 'Y'.
   506         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   507             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   508         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
   509             88  ELCRTT-FOUND             VALUE 'Y'.
   510         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
   511             88  ELCRTT-UPDATE            VALUE 'Y'.
   512         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   513             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   514         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   515             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   516         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   517             88  FORM-MASTER-FOUND        VALUE 'Y'.
   518         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   519             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   520         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   521             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   522         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   523             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   524         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   525             88  NO-BENEFIT-FOUND         VALUE 'N'.
   526         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  11
* EL050.cbl
   527             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   528         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   529             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   530         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   531             88  AH-BENEFIT-FOUND         VALUE ' '.
   532             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   533         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   534             88  LF-BENEFIT-FOUND         VALUE ' '.
   535             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   536         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   537             88  NO-STATE-RECORD          VALUE '1'.
   538         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   539             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   540         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   541             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   542         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   543             88  CERT-WAS-FOUND           VALUE ' '.
   544             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   545         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   546             88  BROWSE-STARTED           VALUE 'Y'.
   547         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   548             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   549         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   550             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   551         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   552             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   553         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   554             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   555         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   556             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   557         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   558             88  APP-CERT-USED            VALUE 'Y' 'A'.
   559         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   560             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   561             88  FIRST-TIME-THROUGH       VALUE '1'.
   562             88  CTBL-NOT-FOUND           VALUE '2'.
   563
   564         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   565             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   566
   567         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   568             88  DLO-ERROR-FOUND          VALUE 'Y'.
   569
   570********FLA
   571     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   572     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   573********
   574     12  RC-SW-1                  PIC X           VALUE '0'.
   575     12  RC-SW-2                  PIC X           VALUE '0'.
   576     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   577     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   578     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   579     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   580     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   581     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   582     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   583     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   584     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  12
* EL050.cbl
   585     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   586     12  LIT-SPACES               PIC X           VALUE SPACES.
   587     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   588     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   589     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   590     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   591     12  erpndm-unlock-sw         pic x           value spaces.
   592         88  need-to-unlock-erpndm  value 'Y'.
   593     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   594     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   595     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   596         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   597         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   598     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   599         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   600
   601 01  WS-EXTRA-PERIODS-BY-STATE.
   602     12  WS-INT-PERIODS          PIC 9.
   603     12  WS-EXTRA-PMTS           PIC 9.
   604 01  ws-net-only-state           pic x value 'N'.
   605 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   606     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   607     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   608 01  WS-CRI-SSN-WORK-AREA.
   609     05  WS-CRI-SOC-SEC-NO.
   610         10  WS-SS-REPT-CD       PIC X(5).
   611         10  WS-SS-LAST-NAME     PIC X(5).
   612         10  WS-SS-INITIAL       PIC X.
   613
   614     05  WS-CRI-REPORT-CODE.
   615         10  FILLER              PIC X(5).
   616         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   617
   618     05  WS-CRI-LAST-NAME.
   619         10  WS-CRI-NAME-MOVE    PIC X(5).
   620         10  FILLER              PIC X(10).
   621
   622 01  ws-state-commission-caps.
   623     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   624     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   625     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   626     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   627     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   628     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   629     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   630     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   631     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   632     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   633     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   634     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   635     05  ws-st-cap-limit-to      pic x.
   636     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   637     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   638     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   639     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   640     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   641     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   642     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  13
* EL050.cbl
   643     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   644     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   645     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   646     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   647     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   648 01  WS-NUM-TABLE                PIC X(26)  VALUE
   649     '12345678012345070923456789'.
   650 01  FILLER REDEFINES WS-NUM-TABLE.
   651     05  WS-NUM OCCURS 26        PIC 9.
   652 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   653 01  V1                          PIC S999 COMP-3.
   654 01  V2                          PIC S999 COMP-3.
   655 01  V3                          PIC S999 COMP-3.
   656 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   657 01  FILLER REDEFINES WS-WORK-VIN.
   658     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   659 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   660 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   661 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   662 01  WS-HEX-WORK.
   663     05  FILLER                  PIC X  VALUE LOW-VALUES.
   664     05  WS-HEX-BYTE             PIC X.
   665 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   666 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   667 01  WS-WORK-HIN-ROW-B.
   668     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   669
   670 01  ws-benefit-cd-chg-sw      pic x value spaces.
   671     88  benefit-code-chg           value 'Y'.
   672 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   673 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   674     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   675 01  WS-ROW-D-TABLE.
   676     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   677
   678 01  WS-HIN-TABLE-B.
   679     05  F                       PIC XX VALUE 'A2'.
   680     05  F                       PIC XX VALUE 'B3'.
   681     05  F                       PIC XX VALUE 'C4'.
   682     05  F                       PIC XX VALUE 'D5'.
   683     05  F                       PIC XX VALUE 'E6'.
   684     05  F                       PIC XX VALUE 'F7'.
   685     05  F                       PIC XX VALUE 'G8'.
   686     05  F                       PIC XX VALUE 'H9'.
   687     05  F                       PIC XX VALUE 'I1'.
   688     05  F                       PIC XX VALUE 'J2'.
   689     05  F                       PIC XX VALUE 'K3'.
   690     05  F                       PIC XX VALUE 'L4'.
   691     05  F                       PIC XX VALUE 'M5'.
   692     05  F                       PIC XX VALUE 'N6'.
   693     05  F                       PIC XX VALUE 'O0'.
   694     05  F                       PIC XX VALUE 'P7'.
   695     05  F                       PIC XX VALUE 'Q0'.
   696     05  F                       PIC XX VALUE 'R8'.
   697     05  F                       PIC XX VALUE 'S9'.
   698     05  F                       PIC XX VALUE 'T2'.
   699     05  F                       PIC XX VALUE 'U3'.
   700     05  F                       PIC XX VALUE 'V4'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  14
* EL050.cbl
   701     05  F                       PIC XX VALUE 'W5'.
   702     05  F                       PIC XX VALUE 'X6'.
   703     05  F                       PIC XX VALUE 'Y7'.
   704     05  F                       PIC XX VALUE 'Z8'.
   705 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   706     05  WS-VAL-IN               PIC X.
   707     05  WS-VAL-OUT              PIC 9.
   708 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   709 01  ws-greg-eff-date            pic x(10) value ' '.
   710 01  WS-COMPARE-BINARY-DATES.
   711     05  WS-971231                PIC XX VALUE X'92FF'.
   712     05  WS-931231                PIC XX VALUE X'8CFF'.
   713     05  WS-791231                PIC XX VALUE X'77FF'.
   714     05  WS-771001                PIC XX VALUE X'74A1'.
   715     05  WS-820301                PIC XX VALUE X'7B41'.
   716     05  WS-831031                PIC XX VALUE X'7DBF'.
   717     05  WS-831231                PIC XX VALUE X'7DFF'.
   718     05  WS-810831                PIC XX VALUE X'7A7F'.
   719     05  WS-830901                PIC XX VALUE X'7D81'.
   720
   721 01  FILE-ACCESS-IDS.
   722     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   723     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   724     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   725     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   726     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   727     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   728     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   729     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   730     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   731     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   732     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   733     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   734     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   735     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   736     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   737     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   738     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   739 01  DD-IU-SW                    PIC X   VALUE ' '.
   740     88  DD-IU-PRESENT                 VALUE 'Y'.
   741
   742 01  ACCESS-KEYS.
   743     12  ELMSTR-KEY.
   744         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   745         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   746     12  W-CLAIM-KEY.
   747         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   748         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   749
   750     12  ELCNTL-KEY.
   751         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   752         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   753         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   754         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   755
   756     12  ELCERT-KEY.
   757         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   758         16  CERT-CARRIER         PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  15
* EL050.cbl
   759         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   760         16  CERT-STATE           PIC XX      VALUE SPACES.
   761         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   762         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   763         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   764
   765     12  ELCERT2-KEY.
   766         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   767         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   768
   769     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   770
   771     12  ELCERT-SAVE.
   772         16  FILLER                      PIC XX    VALUE SPACES.
   773
   774         16  WCS-CONTROL-PRIMARY.
   775             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   776             20  WCS-CARRIER             PIC X     VALUE SPACE.
   777             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   778             20  WCS-STATE               PIC XX    VALUE SPACES.
   779             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   780             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   781             20  WCS-CERT-NO.
   782                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   783                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   784
   785         16  CS-CONTROL-BY-NAME.
   786             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   787             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   788             20  CS-INSURED-INITIALS.
   789                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   790                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   791
   792         16  CS-CONTROL-BY-SSN.
   793             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   794             20  CS-SOC-SEC-NO.
   795                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   796                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   797                 24  CS-SSN-LN3.
   798                     28 CS-INSURED-INITIALS-A2   PIC XX
   799                                     VALUE SPACES.
   800                     28 CS-PART-LAST-NAME-A2     PIC X
   801                                     VALUE SPACE.
   802
   803         16  CS-CONTROL-BY-CERT-NO.
   804             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   805             20  CS-CERT-NO-A4           PIC X(11)
   806                                     VALUE SPACES.
   807
   808         16  CS-CONTROL-BY-MEMB.
   809             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   810             20  CS-MEMBER-NO.
   811                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   812                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   813                 24  CS-MEMB-LN4.
   814                     28 CS-INSURED-INITIALS-A5   PIC XX
   815                                      VALUE SPACES.
   816                     28 CS-PART-LAST-NAME-A5     PIC XX
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  16
* EL050.cbl
   817                                      VALUE SPACES.
   818
   819         16  FILLER              PIC X(360) VALUE SPACES.
   820
   821     12  ERACCT-KEY.
   822         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   823         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   824         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   825         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   826         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   827         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   828
   829     12  ERCOMP-KEY.
   830         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   831         16  COMP-CARRIER         PIC X     VALUE SPACES.
   832         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   833         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   834         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   835         16  COMP-TYPE            PIC X     VALUE SPACES.
   836
   837     12  ERLOFC-KEY.
   838         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   839         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   840         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   841         16  LOFC-STATE           PIC XX    VALUE SPACES.
   842         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   843         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   844
   845     12  WS-ELCRTT-KEY.
   846         16  WS-ELCRTT-PRIMARY       PIC X(33).
   847         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   848
   849     12  ERBXRF-KEY.
   850         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   851         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   852         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   853         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   854
   855     12  ERAGTC-KEY.
   856         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   857         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   858         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   859         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   860         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   861         16  AGTC-TYPE            PIC X     VALUE SPACES.
   862
   863     12  ERPLAN-KEY.
   864         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   865         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   866         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   867         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   868         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   869         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   870         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   871         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   872
   873     12  ERFORM-KEY.
   874         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  17
* EL050.cbl
   875         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   876         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   877         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   878
   879     12  ERREIN-KEY.
   880         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   881         16  REIN-TYPE            PIC X     VALUE SPACES.
   882         16  REIN-TABLE-CO.
   883             20  REIN-CODE-1      PIC X     VALUE SPACE.
   884             20  REIN-CODE-2      PIC X     VALUE SPACE.
   885             20  REIN-CODE-3      PIC X     VALUE SPACE.
   886         16  FILLER               PIC X(3)  VALUE SPACES.
   887
   888     12  ERCTBL-KEY.
   889         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   890         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   891         16  CTBL-CNTRL-2.
   892             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   893             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   894
   895     12  ELCRTO-KEY.
   896         16  ELCRTO-COMPANY-CD       PIC X.
   897         16  ELCRTO-CARRIER          PIC X.
   898         16  ELCRTO-GROUPING         PIC X(6).
   899         16  ELCRTO-STATE            PIC XX.
   900         16  ELCRTO-ACCOUNT          PIC X(10).
   901         16  ELCRTO-CERT-EFF-DT      PIC XX.
   902         16  ELCRTO-CERT-NO.
   903             20  ELCRTO-CERT-PRIME   PIC X(10).
   904             20  ELCRTO-CERT-SFX     PIC X.
   905         16  ELCRTO-RECORD-TYPE      PIC X.
   906         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   907
   908
   909     12  WS-ACCESS.
   910         16  FILLER               PIC XX    VALUE SPACES.
   911         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   912
   913     12  WS-CARR-ACCESS.
   914         16  FILLER               PIC X(3)  VALUE SPACES.
   915         16  WS-CARR              PIC X     VALUE SPACE.
   916*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   917*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   918     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   919         88  WS-DMD-LF-RATING   VALUE 'Y'.
   920         88  WS-DMD-AH-RATING   VALUE 'Y'.
   921         88  WS-DMD-NO-RATING   VALUE 'N'.
   922
   923     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   924         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   925                                         'NJ' 'NL'
   926                                         'PJ' 'PL'
   927                                         'SJ' 'SL'.
   928     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   929         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   930                                         'NI' 'NJ' 'NL' 'NU'
   931                                         'PJ' 'PL' 'PI' 'PU'
   932                                         'SI' 'SJ' 'SL' 'SU'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  18
* EL050.cbl
   933                                         'MX' 'MY' 'MZ'.
   934 01  ERPDEF-KEY-SAVE             PIC X(18).
   935 01  ERPDEF-KEY.
   936     12  ERPDEF-COMPANY-CD       PIC X.
   937     12  ERPDEF-STATE            PIC XX.
   938     12  ERPDEF-PROD-CD          PIC XXX.
   939     12  F                       PIC X(7).
   940     12  ERPDEF-BEN-TYPE         PIC X.
   941     12  ERPDEF-BEN-CODE         PIC XX.
   942     12  ERPDEF-EXP-DT           PIC XX.
   943
   944 01  ELSTAT-KEY-SAVE             PIC X(20).
   945 01  ELSTAT-KEY.
   946     12  ELSTAT-COMPANY-ID       PIC XXX.
   947     12  ELSTAT-CARRIER          PIC X.
   948     12  ELSTAT-GROUP            PIC X(6).
   949     12  ELSTAT-STATE            PIC XX.
   950     12  ELSTAT-EXP-DT           PIC 9(8).
   951 01  WS-ERROR-VALUES.
   952     12  ER-1570                     PIC S9(4)   VALUE +1570.
   953     12  ER-1571                     PIC S9(4)   VALUE +1571.
   954     12  er-1572                     pic s9(4)   value +1572.
   955     12  er-1573                     pic s9(4)   value +1573.
   956     12  er-1574                     pic s9(4)   value +1574.
   957     12  ER-1575                     PIC S9(4)   VALUE +1575.
   958     12  er-1576                     pic s9(4)   value +1576.
   959     12  er-1583                     pic s9(4)   value +1583.
   960     12  er-1743                     pic s9(4)   value +1743.
   961     12  er-1744                     pic s9(4)   value +1744.
   962     12  er-1745                     pic s9(4)   value +1745.
   963     12  er-1746                     pic s9(4)   value +1746.
   964     12  er-1747                     pic s9(4)   value +1747.
   965     12  er-1748                     pic s9(4)   value +1748.
   966     12  er-1749                     pic s9(4)   value +1749.
   967     12  er-1750                     pic s9(4)   value +1750.
   968     12  er-1751                     pic s9(4)   value +1751.
   969     12  er-1752                     pic s9(4)   value +1752.
   970     12  er-1753                     pic s9(4)   value +1753.
   971     12  er-1754                     pic s9(4)   value +1754.
   972     12  er-1755                     pic s9(4)   value +1755.
   973     12  er-1756                     pic s9(4)   value +1756.
   974     12  er-1757                     pic s9(4)   value +1757.
   975     12  er-1758                     pic s9(4)   value +1758.
   976     12  er-1759                     pic s9(4)   value +1759.
   977     12  er-1760                     pic s9(4)   value +1760.
   978     12  er-1761                     pic s9(4)   value +1761.
   979     12  ER-1891                     PIC S9(4)   VALUE +1891.
   980     12  ER-1892                     PIC S9(4)   VALUE +1892.
   981     12  ER-1893                     PIC S9(4)   VALUE +1893.
   982     12  ER-1894                     PIC S9(4)   VALUE +1894.
   983     12  ER-1895                     PIC S9(4)   VALUE +1895.
   984     12  ER-1896                     PIC S9(4)   VALUE +1896.
   985     12  ER-1897                     PIC S9(4)   VALUE +1897.
   986     12  ER-1898                     PIC S9(4)   VALUE +1898.
   987     12  ER-1899                     PIC S9(4)   VALUE +1899.
   988     12  ER-1900                     PIC S9(4)   VALUE +1900.
   989     12  ER-1901                     PIC S9(4)   VALUE +1901.
   990     12  ER-1902                     PIC S9(4)   VALUE +1902.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  19
* EL050.cbl
   991     12  ER-1903                     PIC S9(4)   VALUE +1903.
   992     12  ER-1904                     PIC S9(4)   VALUE +1904.
   993     12  ER-1905                     PIC S9(4)   VALUE +1905.
   994     12  ER-1906                     PIC S9(4)   VALUE +1906.
   995     12  ER-1907                     PIC S9(4)   VALUE +1907.
   996     12  ER-1909                     PIC S9(4)   VALUE +1909.
   997     12  ER-1910                     PIC S9(4)   VALUE +1910.
   998     12  ER-1911                     PIC S9(4)   VALUE +1911.
   999     12  ER-1912                     PIC S9(4)   VALUE +1912.
  1000     12  ER-1913                     PIC S9(4)   VALUE +1913.
  1001     12  ER-1914                     PIC S9(4)   VALUE +1914.
  1002     12  ER-1915                     PIC S9(4)   VALUE +1915.
  1003     12  ER-1916                     PIC S9(4)   VALUE +1916.
  1004     12  ER-1917                     PIC S9(4)   VALUE +1917.
  1005     12  ER-1918                     PIC S9(4)   VALUE +1918.
  1006     12  ER-1919                     PIC S9(4)   VALUE +1919.
  1007     12  ER-1920                     PIC S9(4)   VALUE +1920.
  1008     12  ER-1921                     PIC S9(4)   VALUE +1921.
  1009     12  ER-1922                     PIC S9(4)   VALUE +1922.
  1010     12  ER-1923                     PIC S9(4)   VALUE +1923.
  1011     12  ER-1924                     PIC S9(4)   VALUE +1924.
  1012     12  ER-1925                     PIC S9(4)   VALUE +1925.
  1013     12  ER-1926                     PIC S9(4)   VALUE +1926.
  1014     12  ER-1927                     PIC S9(4)   VALUE +1927.
  1015     12  ER-1955                     PIC s9(4)   VALUE +1955.
  1016     12  ER-1956                     PIC s9(4)   VALUE +1956.
  1017     12  ER-1957                     PIC s9(4)   VALUE +1957.
  1018     12  ER-1958                     PIC s9(4)   VALUE +1958.
  1019     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1020     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1021     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1022     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1023     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1024     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1025     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1026     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1027     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1028     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1029     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1030     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1031     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1032     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1033     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1034     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1035     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1036     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1037     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1038     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1039     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1040     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1041     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1042     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1043     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1044     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1045     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1046     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1047     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1048     12  ER-2623                     PIC S9(4)   VALUE +2623.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  20
* EL050.cbl
  1049     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1050     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1051     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1052     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1053     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1054     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1055     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1056     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1057     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1058     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1059     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1060     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1061     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1062     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1063     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1064     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1065     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1066     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1067     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1068     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1069     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1070     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1071     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1072     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1073     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1074     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1075     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1076     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1077     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1078     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1079     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1080     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1081     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1082     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1083     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1084     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1085     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1086     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1087     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1088     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1089     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1090     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1091     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1092     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1093     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1094     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1095     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1096     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1097     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1098     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1099     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1100     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1101     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1102     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1103     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1104     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1105     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1106     12  ER-2681                     PIC S9(4)   VALUE +2681.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  21
* EL050.cbl
  1107     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1108     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1109     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1110     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1111     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1112     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1113     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1114     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1115     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1116     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1117     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1118     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1119     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1120     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1121     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1122     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1123     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1124     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1125     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1126     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1127     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1128     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1129     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1130     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1131     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1132     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1133     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1134     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1135     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1136     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1137     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1138     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1139     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1140     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1141     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1142     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1143     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1144     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1145     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1146     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1147     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1148     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1149     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1150     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1151     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1152     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1153     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1154     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1155     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1156     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1157     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1158     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1159     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1160     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1161     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1162     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1163     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1164     12  ER-2749                     PIC S9(4)   VALUE +2749.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  22
* EL050.cbl
  1165     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1166     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1167     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1168     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1169     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1170     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1171     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1172     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1173     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1174     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1175     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1176     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1177     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1178     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1179     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1180     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1181     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1182     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1183     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1184     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1185     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1186     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1187     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1188     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1189     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1190     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1191     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1192     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1193     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1194     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1195     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1196     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1197     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1198     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1199     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1200     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1201     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1202     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1203     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1204     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1205     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1206     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1207     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1208     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1209     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1210     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1211     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1212     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1213     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1214     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1215     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1216     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1217     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1218     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1219     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1220     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1221     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1222     12  ER-2891                     PIC S9(4)   VALUE +2891.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  23
* EL050.cbl
  1223     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1224     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1225     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1226     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1227     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1228     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1229     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1230     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1231     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1232     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1233     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1234     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1235     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1236     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1237     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1238     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1239     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1240     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1241     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1242     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1243     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1244     12  er-3270                     pic s9(4)   value +3270.
  1245     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1246     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1247     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1248     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1249     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1250     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1251     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1252     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1253     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1254     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1255     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1256     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1257     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1258     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1259     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1260     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1261     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1262     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1263     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1264     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1265     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1266     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1267     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1268     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1269     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1270     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1271     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1272     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1273     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1274     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1275     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1276     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1277     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1278     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1279     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1280     12  ER-8068                     PIC S9(4)   VALUE +8068.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  24
* EL050.cbl
  1281     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1282     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1283     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1284     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1285     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1286     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1287     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1288     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1289     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1290     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1291     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1292     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1293     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1294     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1295     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1296     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1297     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1298     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1299     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1300     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1301     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1302     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1303     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1304     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1305     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1306     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1307     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1308     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1309     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1310     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1311     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1312     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1313     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1314     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1315     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1316     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1317     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1318     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1319     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1320     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1321     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1322     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1323     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1324     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1325     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1326     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1327     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1328     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1329     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1330     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1331     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1332     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1333     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1334     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1335     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1336     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1337     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1338     12  er-9823                     pic s9(4)   value +9823.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  25
* EL050.cbl
  1339     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1340******************************************************************
  1341***************   END OF ELC50WS     ****************************
  1342******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  26
* EL050.cbl
  1345 01  WORKING-STORAGE-WORK-AREAS.
  1346     12  WS-RESPONSE             PIC S9(8)  COMP.
  1347         88  WS-RESP-NORMAL           VALUE +00.
  1348         88  WS-RESP-ERROR            VALUE +01.
  1349         88  WS-RESP-NOTFND           VALUE +13.
  1350         88  WS-RESP-DUPREC           VALUE +14.
  1351         88  WS-RESP-ENDFILE          VALUE +20.
  1352     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1353     12  WORK-AREAS.
  1354         16  WK-CONV-GREG.
  1355             24  WCG-CENT             PIC XX.
  1356             24  WCG-REST             PIC X(4).
  1357         16  WORK-GREGORIAN-DATE.
  1358             24  WK-GREG-CENT         PIC XX.
  1359             24  WK-GREG-DATE-YYMMDD.
  1360                 28  WK-GREG-YYMM     PIC X(4).
  1361                 28  WK-GREG-DD       PIC XX.
  1362
  1363         16  WORK-SELECT-DATE.
  1364             24  WK-SELECT-CENT            PIC XX.
  1365             24  WK-SELECT-DATE-YYMMDD.
  1366                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1367                 28  FILLER                PIC XX.
  1368
  1369         16  WK-FORM-NO.
  1370             24  WK-FORM-BANK-ID       PIC X(5).
  1371             24  WK-FORM-UNDRWRTR      PIC X(1).
  1372             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1373
  1374         16  WK-MEMBER-NO.
  1375             24  WK-MEMBER-1-6        PIC X(6).
  1376             24  WK-MEMBER-7-12       PIC X(6).
  1377
  1378         16  WK-FULL-CERT-NO.
  1379             24  WK-CERT-POS-1-2      PIC X(2).
  1380             24  WK-CERT-POS-3        PIC X(1).
  1381             24  WK-CERT-POS-4        PIC X(1).
  1382             24  WK-CERT-POS-5-6      PIC X(2).
  1383             24  WK-CERT-POS-7        PIC X(1).
  1384             24  WK-CERT-POS-8-11     PIC X(4).
  1385
  1386         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1387             88  VALID-RATE-CODE        VALUE 'Y'.
  1388             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1389
  1390         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1391         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1392         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1393         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1394         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1395         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1396         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1397         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1398         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1399         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1400
  1401* DLO001
  1402 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  27
* EL050.cbl
  1403     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1404     12  DMPF-RETURN-CODE          PIC XX.
  1405         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1406         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1407         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1408         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1409         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1410         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1411
  1412* DLO002
  1413 01  WS-DLO-INTERNAL-POLICY-FORM.
  1414     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1415     12  DIPF-RETURN-CODE          PIC XX.
  1416         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1417         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1418         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1419         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1420         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1421         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1422
  1423* DLO003
  1424 01  WS-DLO-VALID-BANK-ID.
  1425     12  DVBI-BANK-ID              PIC X(5).
  1426     12  DVBI-BANK-ID-TYPE         PIC X.
  1427         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1428         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1429         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1430         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1431         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1432     12  DVBI-RETURN-CODE          PIC XX.
  1433         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1434         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1435         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1436         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1437         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1438         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1439         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1440         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1441         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1442
  1443* DLO007
  1444 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1445     12  DCUA-RES-STATE            PIC XX.
  1446     12  DCUA-BEN-TYPE             PIC XX.
  1447     12  DCUA-SYS-IDENT            PIC X.
  1448         88  DCUA-CLAIM                        VALUE 'C'.
  1449         88  DCUA-PREMIUM                      VALUE 'P'.
  1450     12  DCUA-COVERAGE-RULE        PIC X.
  1451     12  DCUA-CLIENT-ID            PIC X(10).
  1452     12  DCUA-EFF-DATE             PIC X(8).
  1453     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1454     12  DCUA-RETURN-CODE          PIC XX.
  1455         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1456     12  DCUA-CERT-NUMBER          PIC X(11).
  1457     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1458     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1459
  1460* DLO011
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  28
* EL050.cbl
  1461 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1462     12  DPRB-RATE-CODE            PIC X(4).
  1463     12  DPRB-COVERAGE-CATEG       PIC X.
  1464     12  DPRB-RETURN-CODE          PIC XX.
  1465         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1466         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1467         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1468         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1469         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1470         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1471         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1472         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1473         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1474     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1475     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1476     12  DPRB-BEN-TYPE             PIC XX.
  1477
  1478* DLO017
  1479 01  WS-DLO-VALID-RATE-CODE.
  1480     12  DVRC-RATE-CODE            PIC X(4).
  1481     12  DVRC-RETURN-CODE          PIC XX.
  1482         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1483         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1484         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1485         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1486         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1487         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1488
  1489* DLO019
  1490 01  WS-DLO-ORIG-COV-CAT.
  1491     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1492     12  DOCC-RETURN-CODE          PIC XX.
  1493     12  DOCC-ORIG-COV-CAT         PIC X.
  1494     12  DOCC-UNDERWITER           PIC XX.
  1495     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1496     12  DOCC-FILLER               PIC X(6).
  1497
  1498* DLO021
  1499 01  WS-DLO-VALID-LOAN-OFFICER.
  1500     12  DVLO-LOAN-OFFICER.
  1501         16  DVLO-BILL-TYPE        PIC X.
  1502         16  DVLO-BILL-SOURCE      PIC X.
  1503         16  DVLO-BATCH-TYPE       PIC X.
  1504     12  DVLO-RETURN-CODE          PIC XX.
  1505         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1506         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1507         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1508         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1509         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1510         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1511
  1512* DLO022
  1513 01  WS-DLO-VALID-STATE-CODE.
  1514     12  DVSC-STATE-CODE           PIC XX.
  1515     12  DVSC-RETURN-CODE          PIC XX.
  1516         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1517
  1518* DLO023
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  29
* EL050.cbl
  1519 01  WS-DLO-VALID-CODE-VALUES.
  1520     12  DVCV-SYSTEM-ID            PIC XX.
  1521         88  DVCV-CLAIMS                       VALUE 'CL'.
  1522         88  DVCV-CREDIT                       VALUE 'CR'.
  1523     12  DVCV-RECORD-TYPE          PIC XX.
  1524         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1525         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1526         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1527         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1528         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1529         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1530         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1531         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1532     12  DVCV-RECORD-KEY           PIC X(6).
  1533     12  DVCV-RETURN-CODE          PIC XX.
  1534         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1535         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1536         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1537         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1538         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1539         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1540         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1541     12  DVCV-CODE-DESC            PIC X(60).
  1542     12  DVCV-GEN-DESC-1           PIC X(20).
  1543     12  DVCV-GEN-DESC-2           PIC X(20).
  1544     12  DVCV-GEN-DESC-3           PIC X(20).
  1545
  1546 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1547 01  hldi-pass-area.
  1548     03  PA-VIN                  PIC X(17).
  1549     03  PA-ErrorCode            PIC X(10).
  1550     03  PA-ErrorDesc            PIC X(30).
  1551     03  PA-ModelYear            PIC 9(7).
  1552     03  PA-MakeName             PIC X(50).
  1553     03  PA-ModelName            PIC X(50).
  1554     03  PA-SeriesName           PIC X(50).
  1555 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1556 01  zipcd-pass-area.
  1557     03  PA-zip                  PIC X(5).
  1558     03  PA-ErrorCode-zip        PIC X(10).
  1559     03  PA-city                 PIC x(50).
  1560     03  PA-state                PIC Xx.
  1561 01  clmhs-pass-area-len         pic s9(4) comp value +40.
  1562 01  clmhs-pass-area.
  1563     03  pa-clmhs-state          pic xx.
  1564     03  pa-account              pic x(10).
  1565     03  pa-eff-dt               pic x(10).
  1566     03  pa-cert-no              pic x(11).
  1567     03  pa-clm-count            pic 9(5).
  1568****  this is for aggregate report.
  1569****  Length is erpndb + 100 of passed-key-area
  1570 01  ws-passed-key-length        pic s9(4) comp value +587.
  1571 01  ws-pass-to-pemaggo.
  1572     05  ws-passed-erpndb        pic x(585).
  1573     05  ws-exceed-limit-yn      pic x.
  1574     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  30
* EL050.cbl
  1576*    COPY ERCBXRF.
  1577******************************************************************
  1578*                                                                *
  1579*                                                                *
  1580*                            ERCBXRF                             *
  1581*                                                                *
  1582*   ONLINE CREDIT SYSTEM                                         *
  1583*                                                                *
  1584*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1585*                                                                *
  1586*   FILE TYPE = VSAM,KSDS                                        *
  1587*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1588*                                                                *
  1589*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1590*       ALTERNATE PATH = NONE                                    *
  1591*                                                                *
  1592*   LOG = NO                                                     *
  1593*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1594*                                                                *
  1595******************************************************************
  1596
  1597 01  BANK-CROSS-REFERENCE.
  1598     12  BK-RECORD-ID                PIC XX.
  1599         88  VALID-BK-ID             VALUE 'BK'.
  1600
  1601     12  BK-CONTROL-PRIMARY.
  1602         16  BK-COMPANY-CD           PIC X.
  1603         16  BK-CARRIER              PIC X.
  1604         16  BK-GROUPING             PIC X(6).
  1605         16  BK-BANK-NO              PIC X(10).
  1606
  1607     12  BK-MAINT-INFORMATION.
  1608         16  BK-LAST-MAINT-DT        PIC XX.
  1609         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1610         16  BK-LAST-MAINT-USER      PIC X(4).
  1611         16  FILLER                  PIC X(9).
  1612
  1613     12  FILLER                      PIC X(37).
  1614
  1615     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1616
  1617     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1618                            DEPENDING ON BK-BANK-POINTER-CNT.
  1619         16  BK-AM-ACCOUNT           PIC X(10).
  1620         16  BK-AM-EXP-DT            PIC XX.
  1621         16  BK-AM-EFF-DT            PIC XX.
  1622         16  BK-AM-STATE             PIC XX.
  1623         16  FILLER                  PIC X(20).
  1624
  1625******************************************************************
  1626
  1627*    COPY ERCCOMP.
  1628******************************************************************
  1629*                                                                *
  1630*                                                                *
  1631*                            ERCCOMP                             *
  1632*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1633*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  31
* EL050.cbl
  1634*                                                                *
  1635*   ONLINE CREDIT SYSTEM                                         *
  1636*                                                                *
  1637*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1638*                                                                *
  1639*   FILE TYPE = VSAM,KSDS                                        *
  1640*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1641*                                                                *
  1642*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1643*       ALTERNATE PATH = NONE                                    *
  1644*                                                                *
  1645*   LOG = NO                                                     *
  1646*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1647*                                                                *
  1648******************************************************************
  1649*                   C H A N G E   L O G
  1650*
  1651* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1652*-----------------------------------------------------------------
  1653*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1654* EFFECTIVE    NUMBER
  1655*-----------------------------------------------------------------
  1656* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1657* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1658* 092205    2005050300006  PEMA  ADD LEASE FEE
  1659* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1660* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1661* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1662* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1663* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1664* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1665******************************************************************
  1666
  1667 01  COMPENSATION-MASTER.
  1668     12  CO-RECORD-ID                          PIC XX.
  1669         88  VALID-CO-ID                          VALUE 'CO'.
  1670
  1671     12  CO-CONTROL-PRIMARY.
  1672         16  CO-COMPANY-CD                     PIC X.
  1673         16  CO-CONTROL.
  1674             20  CO-CTL-1.
  1675                 24  CO-CARR-GROUP.
  1676                     28  CO-CARRIER            PIC X.
  1677                     28  CO-GROUPING.
  1678                         32  CO-GROUP-PREFIX   PIC XXX.
  1679                         32  CO-GROUP-PRIME    PIC XXX.
  1680                 24  CO-RESP-NO.
  1681                     28  CO-RESP-PREFIX        PIC X(4).
  1682                     28  CO-RESP-PRIME         PIC X(6).
  1683             20  CO-CTL-2.
  1684                 24  CO-ACCOUNT.
  1685                     28  CO-ACCT-PREFIX        PIC X(4).
  1686                     28  CO-ACCT-PRIME         PIC X(6).
  1687         16  CO-TYPE                           PIC X.
  1688             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1689             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1690             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1691
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  32
* EL050.cbl
  1692     12  CO-MAINT-INFORMATION.
  1693         16  CO-LAST-MAINT-DT                  PIC XX.
  1694         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1695         16  CO-LAST-MAINT-USER                PIC X(4).
  1696     12  FILLER                                PIC XX.
  1697     12  CO-STMT-TYPE                          PIC XXX.
  1698     12  CO-COMP-TYPE                          PIC X.
  1699         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1700     12  CO-STMT-OWNER                         PIC X(4).
  1701     12  CO-BALANCE-CONTROL                    PIC X.
  1702         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1703         88  CO-NO-BALANCE                        VALUE 'N'.
  1704
  1705     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1706         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1707         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1708         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1709
  1710     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1711         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1712         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1713
  1714     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1715     12  CO-GA-DIRECT-DEP                      PIC X.
  1716     12  CO-FUTURE-SPACE                       PIC X.
  1717         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1718
  1719     12  CO-ACCT-NAME                          PIC X(30).
  1720     12  CO-MAIL-NAME                          PIC X(30).
  1721     12  CO-ADDR-1                             PIC X(30).
  1722     12  CO-ADDR-2                             PIC X(30).
  1723     12  CO-ADDR-3.
  1724         16  CO-ADDR-CITY                      PIC X(27).
  1725         16  CO-ADDR-STATE                     PIC XX.
  1726     12  CO-CSO-1099                           PIC X.
  1727     12  CO-ZIP.
  1728         16  CO-ZIP-PRIME.
  1729             20  CO-ZIP-PRI-1ST                PIC X.
  1730                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1731             20  FILLER                        PIC X(4).
  1732         16  CO-ZIP-PLUS4                      PIC X(4).
  1733     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1734         16  CO-CAN-POSTAL-1                   PIC XXX.
  1735         16  CO-CAN-POSTAL-2                   PIC XXX.
  1736         16  FILLER                            PIC XXX.
  1737     12  CO-SOC-SEC                            PIC X(13).
  1738     12  CO-TELEPHONE.
  1739         16  CO-AREA-CODE                      PIC XXX.
  1740         16  CO-PREFIX                         PIC XXX.
  1741         16  CO-PHONE                          PIC X(4).
  1742
  1743     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1744
  1745     12  CO-AR-BAL-LEVEL                       PIC X.
  1746         88  CO-AR-REF-LVL                        VALUE '1'.
  1747         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1748         88  CO-AR-BILL-LVL                       VALUE '2'.
  1749         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  33
* EL050.cbl
  1750         88  CO-AR-FR-LVL                         VALUE '4'.
  1751
  1752     12  CO-AR-NORMAL-PRINT                    PIC X.
  1753         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1754         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1755
  1756     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1757
  1758     12  CO-AR-REPORTING                       PIC X.
  1759         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1760         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1761
  1762     12  CO-AR-PULL-CHECK                      PIC X.
  1763         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1764         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1765
  1766     12  CO-AR-BALANCE-PRINT                   PIC X.
  1767         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1768
  1769     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1770         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1771         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1772         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1773
  1774     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1775
  1776     12  CO-USER-CODE                          PIC X.
  1777     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1778
  1779******************************************************************
  1780*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1781*    THE LAST MONTH END RUN.
  1782******************************************************************
  1783
  1784     12  CO-LAST-ACTIVITY-DATE.
  1785         16  CO-ACT-YEAR                       PIC 99.
  1786         16  CO-ACT-MONTH                      PIC 99.
  1787         16  CO-ACT-DAY                        PIC 99.
  1788
  1789     12  CO-LAST-STMT-DT.
  1790         16  CO-LAST-STMT-YEAR                 PIC 99.
  1791         16  CO-LAST-STMT-MONTH                PIC 99.
  1792         16  CO-LAST-STMT-DAY                  PIC 99.
  1793
  1794     12  CO-MO-END-TOTALS.
  1795         16  CO-MONTHLY-TOTALS.
  1796             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1797             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1798             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1799             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1800             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1801
  1802         16  CO-AGING-TOTALS.
  1803             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1804             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1805             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1806             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1807
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  34
* EL050.cbl
  1808         16  CO-YTD-TOTALS.
  1809             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1810             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1811
  1812         16  CO-OVER-UNDER-TOTALS.
  1813             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1814             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1815
  1816     12  CO-MISCELLANEOUS-TOTALS.
  1817         16  CO-FICA-TOTALS.
  1818             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1819             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1820
  1821         16  CO-CLAIM-TOTALS.
  1822             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1823             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1824
  1825******************************************************************
  1826*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1827*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1828******************************************************************
  1829
  1830     12  CO-CURRENT-TOTALS.
  1831         16  CO-CURRENT-LAST-STMT-DT.
  1832             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1833             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1834             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1835
  1836         16  CO-CURRENT-MONTHLY-TOTALS.
  1837             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1838             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1839             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1840             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1841             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1842
  1843         16  CO-CURRENT-AGING-TOTALS.
  1844             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1845             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1846             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1847             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1848
  1849         16  CO-CURRENT-YTD-TOTALS.
  1850             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1851             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1852
  1853     12  CO-PAID-COMM-TOTALS.
  1854         16  CO-YTD-PAID-COMMS.
  1855             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1856             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1857
  1858     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1859         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1860         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1861
  1862     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1863         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1864         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1865         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  35
* EL050.cbl
  1866         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1867         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1868         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1869         88  CO-FINAL-LETTER                  VALUE 'F'.
  1870         88  CO-RECONCILING                   VALUE 'R'.
  1871         88  CO-PHONE-CALL                    VALUE 'P'.
  1872         88  CO-LEGAL                         VALUE 'L'.
  1873         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1874         88  CO-WRITE-OFF                     VALUE 'W'.
  1875         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1876
  1877     12  CO-CSR-CODE                       PIC X(4).
  1878
  1879     12  CO-GA-STATUS-INFO.
  1880         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1881         16  CO-GA-TERMINATION-DT          PIC XX.
  1882         16  CO-GA-STATUS-CODE             PIC X.
  1883             88  CO-GA-ACTIVE                 VALUE 'A'.
  1884             88  CO-GA-INACTIVE               VALUE 'I'.
  1885             88  CO-GA-PENDING                VALUE 'P'.
  1886         16  CO-GA-COMMENTS.
  1887             20  CO-GA-COMMENT-1           PIC X(40).
  1888             20  CO-GA-COMMENT-2           PIC X(40).
  1889             20  CO-GA-COMMENT-3           PIC X(40).
  1890             20  CO-GA-COMMENT-4           PIC X(40).
  1891
  1892     12  CO-RPTCD2                         PIC X(10).
  1893     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1894         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1895         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1896
  1897     12  CO-TYPE-AGENT                     PIC X(01).
  1898         88  CO-CORPORATION                   VALUE 'C'.
  1899         88  CO-PARTNERSHIP                   VALUE 'P'.
  1900         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1901         88  CO-TRUST                         VALUE 'T'.
  1902         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1903
  1904     12  CO-FAXNO.
  1905         16  CO-FAX-AREA-CODE                  PIC XXX.
  1906         16  CO-FAX-PREFIX                     PIC XXX.
  1907         16  CO-FAX-PHONE                      PIC X(4).
  1908
  1909     12  CO-BANK-INFORMATION.
  1910         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1911         16  CO-BANK-TRANSIT-NON REDEFINES
  1912             CO-BANK-TRANSIT-NO                PIC 9(8).
  1913
  1914         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1915     12  CO-MISC-DEDUCT-INFO REDEFINES
  1916                  CO-BANK-INFORMATION.
  1917         16  CO-MD-GL-ACCT                     PIC X(10).
  1918         16  CO-MD-DIV                         PIC XX.
  1919         16  CO-MD-CENTER                      PIC X(4).
  1920         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1921         16  CO-CREATE-AP-CHECK                PIC X.
  1922         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1923         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  36
* EL050.cbl
  1924     12  CO-ACH-STATUS                         PIC X.
  1925         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1926         88  CO-ACH-PENDING                        VALUE 'P'.
  1927
  1928     12  CO-BILL-SW                            PIC X.
  1929     12  CO-CONTROL-NAME                       PIC X(30).
  1930     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1931     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1932     12  CO-CLP-STATE                          PIC XX.
  1933     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1934     12  CO-SPP-REFUND-EDIT                    PIC X.
  1935
  1936******************************************************************
  1937
  1938*    COPY ERCAGTC.
  1939******************************************************************
  1940*                                                                *
  1941*                                                                *
  1942*                            ERCAGTC                             *
  1943*                            VMOD=2.001                          *
  1944*                                                                *
  1945*   ONLINE CREDIT SYSTEM                                         *
  1946*                                                                *
  1947*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1948*                                                                *
  1949*   FILE TYPE = VSAM,KSDS                                        *
  1950*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1951*                                                                *
  1952*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1953*       ALTERNATE PATH = NONE                                    *
  1954*                                                                *
  1955*   LOG = NO                                                     *
  1956*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1957*                                                                *
  1958******************************************************************
  1959*                   C H A N G E   L O G
  1960*
  1961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1962*-----------------------------------------------------------------
  1963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1964* EFFECTIVE    NUMBER
  1965*-----------------------------------------------------------------
  1966* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1967* 111004                         NEW FILE AND COPYBOOK
  1968* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1969******************************************************************
  1970 01  AGENT-COMMISSIONS.
  1971     12  AG-RECORD-ID                          PIC XX.
  1972         88  VALID-CO-ID                          VALUE 'AG'.
  1973     12  AG-CONTROL-PRIMARY.
  1974         16  AG-COMPANY-CD                     PIC X.
  1975         16  AG-CONTROL.
  1976             20  AG-CTL-1.
  1977                 24  AG-CARR-GROUP.
  1978                     28  AG-CARRIER            PIC X.
  1979                     28  AG-GROUPING           PIC X(6).
  1980                 24  AG-BANK                   PIC X(10).
  1981             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  37
* EL050.cbl
  1982                 24  AG-EXP-DT                 PIC XX.
  1983         16  AG-TYPE                           PIC X.
  1984             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1985             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1986     12  AG-MAINT-INFORMATION.
  1987         16  AG-LAST-MAINT-DT                  PIC XX.
  1988         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1989         16  AG-LAST-MAINT-USER                PIC X(4).
  1990         16  FILLER                            PIC X(10).
  1991     12  AG-EFF-DT                             PIC XX.
  1992     12  AG-COMM-STRUCTURE.
  1993         16  AG-AGT-COMMS OCCURS 10.
  1994             20  AG-AGT                PIC X(10).
  1995             20  AG-COM-TYP            PIC X.
  1996             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1997             20  AG-RECALC-LV-INDIC    PIC X.
  1998             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1999             20  AG-LRCALC-LV-INDIC    PIC X.
  2000             20  FILLER                PIC X(05).
  2001     12  FILLER                  PIC X(145).
  2002******************************************************************
  2003*    COPY ERCRESS.
  2004******************************************************************
  2005*                                                                *
  2006*                            ERCRESS                             *
  2007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2008*                            VMOD=2.002                          *
  2009*                                                                *
  2010*   CREDIT RESIDENT STATE TAXES MASTER                          *
  2011*                                                                *
  2012*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  2013*   VSAM RESIDENT STATE TAX MASTER                              *
  2014*                                                                *
  2015*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  2016*                                                                *
  2017*   FILE TYPE = VSAM,KSDS                                        *
  2018*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  2019*                                                                *
  2020*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  2021*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  2022*                                                                *
  2023*   LOG = NO                                                     *
  2024*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2025*                                                                *
  2026*                                                                *
  2027******************************************************************
  2028
  2029 01  RESIDENT-STATE-TAX-MASTER.
  2030
  2031     10  ERRESS-PRIMARY-KEY.
  2032         15  RES-COMPANY-CD        PIC X.
  2033         15  RES-RESIDENT-STATE    PIC XX.
  2034         15  RES-COVERAGE-CATEGORY PIC X.
  2035         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2036*                                      YYYYMMDD
  2037*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2038
  2039     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  38
* EL050.cbl
  2040
  2041         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2042         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2043         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2044         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2045
  2046     10 RES-RECALC-SW              PIC   X.
  2047         88 RECALC                VALUE 'Y'.
  2048         88 NO-RECALC             VALUE 'N'.
  2049     10  RES-MAINT-BY              PIC X(4).
  2050     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2051     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2052*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  39
* EL050.cbl
  2054*    COPY ERCRESC.
  2055******************************************************************
  2056*                                                                *
  2057*                            ERCRESC                             *
  2058*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2059*                            VMOD=2.003                          *
  2060*                                                                *
  2061*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2062*                                                                *
  2063*   FILE TYPE = VSAM,KSDS                                        *
  2064*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2065*                                                                *
  2066*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2067*       ALTERNATE PATH1 = NONE                                   *
  2068*                                                                *
  2069*   LOG = NO                                                     *
  2070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2071*                                                                *
  2072******************************************************************
  2073
  2074 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2075
  2076     10  ERRESC-RECORD-KEY.
  2077         15  RESC-COMPANY-CD           PIC   X.
  2078         15  RESC-CARRIER              PIC   X.
  2079         15  RESC-GROUP                PIC   X(6).
  2080         15  RESC-STATE                PIC   XX.
  2081         15  RESC-ACCOUNT              PIC   X(10).
  2082         15  RESC-AGENT                PIC   X(10).
  2083         15  RESC-RESIDENT-STATE       PIC   XX.
  2084         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2085*                                           YYYYMMDD
  2086     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2087
  2088     10  RESC-COMM-RECORD-DATA.
  2089         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2090             20 RESC-COVERAGE-CAT      PIC    X.
  2091             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2092             20 RESC-COMMISSION-TAB REDEFINES
  2093                RESC-COMMISSION-PER    PIC  XXX.
  2094
  2095     10  RESC-MAINT-BY                 PIC X(4).
  2096     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2097     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2098*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  40
* EL050.cbl
  2100*    COPY ERCPLAN.
  2101******************************************************************
  2102*                                                                *
  2103*                                                                *
  2104*                            ERCPLAN                             *
  2105*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2106*                            VMOD=2.003                          *
  2107*                                                                *
  2108*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2109*                                                                *
  2110*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2111*   PLAN MASTER                                                  *
  2112*                                                                *
  2113*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2114*                                                                *
  2115*   FILE TYPE = VSAM,KSDS                                        *
  2116*   RECORD SIZE = 420   RECFORM = FIX                            *
  2117*                                                                *
  2118*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2119*       ALTERNATE PATH1 = N/A                                    *
  2120*                                                                *
  2121*   LOG = NO                                                     *
  2122*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2123*                                                                *
  2124*                                                                *
  2125******************************************************************
  2126
  2127 01  PLAN-MASTER.
  2128     12  PL-RECORD-ID                      PIC XX.
  2129         88  VALID-PL-ID                      VALUE 'PL'.
  2130
  2131     12  PL-CONTROL-PRIMARY.
  2132         16  PL-COMPANY-CD                 PIC X.
  2133         16  PL-MSTR-CNTRL.
  2134             20  PL-CONTROL-A.
  2135                 24  PL-CARRIER            PIC X.
  2136                 24  PL-GROUPING           PIC X(6).
  2137                 24  PL-STATE              PIC XX.
  2138                 24  PL-ACCOUNT            PIC X(10).
  2139             20  PL-BENEFIT-TYPE           PIC X.
  2140             20  PL-BENEFIT-CODE           PIC XX.
  2141             20  PL-REVISION-NO            PIC X(3).
  2142
  2143     12  PL-CONTROL-BY-VAR-GRP.
  2144         16  PL-COMPANY-CD-A1              PIC X.
  2145         16  PL-VG-CARRIER                 PIC X.
  2146         16  PL-VG-GROUPING                PIC X(6).
  2147         16  PL-VG-STATE                   PIC XX.
  2148         16  PL-VG-ACCOUNT                 PIC X(10).
  2149         16  PL-BENEFIT-TYPE-A1            PIC X.
  2150         16  PL-BENEFIT-CODE-A1            PIC XX.
  2151         16  PL-REVISION-NO-A1             PIC 999.
  2152
  2153     12  PL-MAINT-INFORMATION.
  2154         16  PL-LAST-MAINT-DT              PIC XX.
  2155         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2156         16  PL-LAST-MAINT-USER            PIC X(4).
  2157         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  41
* EL050.cbl
  2158
  2159     12  PL-LIABILITY-LIMITS.
  2160         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2161         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2162             20  PL-LM-AGE                 PIC S99        COMP-3.
  2163             20  PL-LM-DUR                 PIC S999       COMP-3.
  2164             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2165             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2166
  2167     12  FILLER                            PIC X(30).
  2168
  2169     12  PL-GL-ACCOUNT-NOS.
  2170         16  PL-PREMIUM-GL                 PIC X(8).
  2171         16  PL-COMM-GL                    PIC X(8).
  2172         16  PL-CLAIM-GL                   PIC X(8).
  2173     12  FILLER                            PIC X(24).
  2174     12  PL-TOLERANCES.
  2175         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2176         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2177         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2178         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2179         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2180         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2181     12  PL-OVER-SHORT.
  2182         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2183         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2184     12  FILLER                            PIC X(24).
  2185     12  PLAN-MISC.
  2186         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2187         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2188         16  PL-IG                         PIC X.
  2189         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2190         16  PL-POLICY-FORM                PIC X(12).
  2191         16  PL-EDIT-FOR-FORM              PIC X(01).
  2192         16  PL-DEV-CODE                   PIC XXX.
  2193         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2194         16  PL-CALC-METHOD                PIC X.
  2195         16  PL-BENEFIT-GROUP              PIC X(05).
  2196         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2197
  2198         16  FILLER                        PIC X(99).
  2199******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  42
* EL050.cbl
  2201*    COPY ELCCERT.
  2202******************************************************************
  2203*                                                                *
  2204*                            ELCCERT.                            *
  2205*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2206*                            VMOD=2.013                          *
  2207*                                                                *
  2208*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2209*                                                                *
  2210*   FILE TYPE = VSAM,KSDS                                        *
  2211*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2212*                                                                *
  2213*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2214*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2215*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2216*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2217*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2218*                                                                *
  2219*   LOG = YES                                                    *
  2220*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2221******************************************************************
  2222*                   C H A N G E   L O G
  2223*
  2224* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2225*-----------------------------------------------------------------
  2226*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2227* EFFECTIVE    NUMBER
  2228*-----------------------------------------------------------------
  2229* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2230* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2231* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2232* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2233* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2234* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2235* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2236* 032612  CR2011110200001  PEMA  AHL CHANGES
  2237* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2238* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2239* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2240******************************************************************
  2241
  2242 01  CERTIFICATE-MASTER.
  2243     12  CM-RECORD-ID                      PIC XX.
  2244         88  VALID-CM-ID                      VALUE 'CM'.
  2245
  2246     12  CM-CONTROL-PRIMARY.
  2247         16  CM-COMPANY-CD                 PIC X.
  2248         16  CM-CARRIER                    PIC X.
  2249         16  CM-GROUPING.
  2250             20  CM-GROUPING-PREFIX        PIC X(3).
  2251             20  CM-GROUPING-PRIME         PIC X(3).
  2252         16  CM-STATE                      PIC XX.
  2253         16  CM-ACCOUNT.
  2254             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2255             20  CM-ACCOUNT-PRIME          PIC X(6).
  2256         16  CM-CERT-EFF-DT                PIC XX.
  2257         16  CM-CERT-NO.
  2258             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  43
* EL050.cbl
  2259             20  CM-CERT-SFX               PIC X.
  2260
  2261     12  CM-CONTROL-BY-NAME.
  2262         16  CM-COMPANY-CD-A1              PIC X.
  2263         16  CM-INSURED-LAST-NAME          PIC X(15).
  2264         16  CM-INSURED-INITIALS.
  2265             20  CM-INSURED-INITIAL1       PIC X.
  2266             20  CM-INSURED-INITIAL2       PIC X.
  2267
  2268     12  CM-CONTROL-BY-SSN.
  2269         16  CM-COMPANY-CD-A2              PIC X.
  2270         16  CM-SOC-SEC-NO.
  2271             20  CM-SSN-STATE              PIC XX.
  2272             20  CM-SSN-ACCOUNT            PIC X(6).
  2273             20  CM-SSN-LN3.
  2274                 25  CM-INSURED-INITIALS-A2.
  2275                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2276                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2277                 25 CM-PART-LAST-NAME-A2         PIC X.
  2278
  2279     12  CM-CONTROL-BY-CERT-NO.
  2280         16  CM-COMPANY-CD-A4              PIC X.
  2281         16  CM-CERT-NO-A4                 PIC X(11).
  2282
  2283     12  CM-CONTROL-BY-MEMB.
  2284         16  CM-COMPANY-CD-A5              PIC X.
  2285         16  CM-MEMBER-NO.
  2286             20  CM-MEMB-STATE             PIC XX.
  2287             20  CM-MEMB-ACCOUNT           PIC X(6).
  2288             20  CM-MEMB-LN4.
  2289                 25  CM-INSURED-INITIALS-A5.
  2290                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2291                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2292                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2293
  2294     12  CM-INSURED-PROFILE-DATA.
  2295         16  CM-INSURED-FIRST-NAME.
  2296             20  CM-INSURED-1ST-INIT       PIC X.
  2297             20  FILLER                    PIC X(9).
  2298         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2299         16  CM-INSURED-SEX                PIC X.
  2300             88  CM-SEX-MALE                  VALUE 'M'.
  2301             88  CM-SEX-FEMAL                 VALUE 'F'.
  2302         16  CM-INSURED-JOINT-AGE          PIC 99.
  2303         16  CM-JOINT-INSURED-NAME.
  2304             20  CM-JT-LAST-NAME           PIC X(15).
  2305             20  CM-JT-FIRST-NAME.
  2306                 24  CM-JT-1ST-INIT        PIC X.
  2307                 24  FILLER                PIC X(9).
  2308             20  CM-JT-INITIAL             PIC X.
  2309
  2310     12  CM-LIFE-DATA.
  2311         16  CM-LF-BENEFIT-CD              PIC XX.
  2312         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2313         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2314         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2315         16  CM-LF-DEV-CODE                PIC XXX.
  2316         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  44
* EL050.cbl
  2317         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2318         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2319         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2320         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2321         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2322         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2323         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2324         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2325         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2326         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2327         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2328         16  cm-temp-epiq                  pic xx.
  2329             88  EPIQ-CLASS                  value 'EQ'.
  2330*        16  FILLER                        PIC XX.
  2331
  2332     12  CM-AH-DATA.
  2333         16  CM-AH-BENEFIT-CD              PIC XX.
  2334         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2335         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2336         16  CM-AH-DEV-CODE                PIC XXX.
  2337         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2338         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2339         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2340         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2341         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2342         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2343         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2344         16  CM-AH-PAID-THRU-DT            PIC XX.
  2345             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2346         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2347         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2348         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2349         16  FILLER                        PIC X.
  2350
  2351     12  CM-LOAN-INFORMATION.
  2352         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2353         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2354                                           PIC S9(5)V99  COMP-3.
  2355         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2356         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2357         16  CM-PAY-FREQUENCY              PIC S99.
  2358         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2359         16  CM-RATE-CLASS                 PIC XX.
  2360         16  CM-BENEFICIARY                PIC X(25).
  2361         16  CM-POLICY-FORM-NO             PIC X(12).
  2362         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2363         16  CM-LAST-ADD-ON-DT             PIC XX.
  2364         16  CM-DEDUCTIBLE-AMOUNTS.
  2365             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2366             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2367         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2368             20  CM-RESIDENT-STATE         PIC XX.
  2369             20  CM-RATE-CODE              PIC X(4).
  2370             20  FILLER                    PIC XX.
  2371         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2372             20  CM-LOAN-OFFICER           PIC X(5).
  2373             20  FILLER                    PIC XXX.
  2374         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  45
* EL050.cbl
  2375         16  CM-UNDERWRITING-CODE          PIC X.
  2376             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2377         16  CM-POST-CARD-IND              PIC X.
  2378         16  CM-REF-INTERFACE-SW           PIC X.
  2379         16  CM-PREMIUM-TYPE               PIC X.
  2380             88  CM-SING-PRM                  VALUE '1'.
  2381             88  CM-O-B-COVERAGE              VALUE '2'.
  2382             88  CM-OPEN-END                  VALUE '3'.
  2383         16  CM-IND-GRP-TYPE               PIC X.
  2384             88  CM-INDIVIDUAL                VALUE 'I'.
  2385             88  CM-GROUP                     VALUE 'G'.
  2386         16  CM-SKIP-CODE                  PIC X.
  2387             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2388             88  SKIP-JULY                    VALUE '1'.
  2389             88  SKIP-AUGUST                  VALUE '2'.
  2390             88  SKIP-SEPTEMBER               VALUE '3'.
  2391             88  SKIP-JULY-AUG                VALUE '4'.
  2392             88  SKIP-AUG-SEPT                VALUE '5'.
  2393             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2394             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2395             88  SKIP-JUNE                    VALUE '8'.
  2396             88  SKIP-JUNE-JULY               VALUE '9'.
  2397             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2398             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2399         16  CM-PAYMENT-MODE               PIC X.
  2400             88  PAY-MONTHLY                  VALUE SPACE.
  2401             88  PAY-WEEKLY                   VALUE '1'.
  2402             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2403             88  PAY-BI-WEEKLY                VALUE '3'.
  2404             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2405         16  CM-LOAN-NUMBER                PIC X(8).
  2406         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2407         16  CM-OLD-LOF                    PIC XXX.
  2408*        16  CM-LOAN-OFFICER               PIC XXX.
  2409         16  CM-REIN-TABLE                 PIC XXX.
  2410         16  CM-SPECIAL-REIN-CODE          PIC X.
  2411         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2412         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2413         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2414
  2415     12  CM-STATUS-DATA.
  2416         16  CM-ENTRY-STATUS               PIC X.
  2417         16  CM-ENTRY-DT                   PIC XX.
  2418
  2419         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2420         16  CM-LF-CANCEL-DT               PIC XX.
  2421         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2422
  2423         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2424         16  CM-LF-DEATH-DT                PIC XX.
  2425         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2426
  2427         16  CM-LF-CURRENT-STATUS          PIC X.
  2428             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2429                                                'M' '4' '5' '9'.
  2430             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2431             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2432             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  46
* EL050.cbl
  2433             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2434             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2435             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2436             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2437             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2438             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2439             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2440             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2441             88  CM-LF-DECLINED               VALUE 'D'.
  2442             88  CM-LF-VOIDED                 VALUE 'V'.
  2443
  2444         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2445         16  CM-AH-CANCEL-DT               PIC XX.
  2446         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2447
  2448         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2449         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2450         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2451
  2452         16  CM-AH-CURRENT-STATUS          PIC X.
  2453             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2454                                                'M' '4' '5' '9'.
  2455             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2456             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2457             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2458             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2459             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2460             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2461             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2462             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2463             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2464             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2465             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2466             88  CM-AH-DECLINED               VALUE 'D'.
  2467             88  CM-AH-VOIDED                 VALUE 'V'.
  2468
  2469         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2470             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2471             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2472             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2473         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2474
  2475         16  CM-ENTRY-BATCH                PIC X(6).
  2476         16  CM-LF-EXIT-BATCH              PIC X(6).
  2477         16  CM-AH-EXIT-BATCH              PIC X(6).
  2478         16  CM-LAST-MONTH-END             PIC XX.
  2479
  2480     12  CM-NOTE-SW                        PIC X.
  2481         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2482         88  CERT-NOTES-PRESENT               VALUE '1'.
  2483         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2484         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2485         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2486         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2487         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2488         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2489     12  CM-COMP-EXCP-SW                   PIC X.
  2490         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  47
* EL050.cbl
  2491         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2492     12  CM-INSURED-ADDRESS-SW             PIC X.
  2493         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2494         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2495
  2496*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2497     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2498     12  FILLER                            PIC X.
  2499
  2500*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2501     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2502     12  FILLER                            PIC X.
  2503*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2504     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2505
  2506     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2507         88  CERT-ADDED-BATCH                 VALUE ' '.
  2508         88  CERT-ADDED-ONLINE                VALUE '1'.
  2509         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2510         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2511         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2512     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2513         88  CERT-AS-LOADED                   VALUE ' '.
  2514         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2515         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2516         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2517         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2518         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2519         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2520         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2521
  2522     12  CM-ACCOUNT-COMM-PCTS.
  2523         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2524         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2525
  2526     12  CM-USER-FIELD                     PIC X.
  2527     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2528     12  CM-CLP-STATE                      PIC XX.
  2529     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2530     12  CM-USER-RESERVED                  PIC XXX.
  2531     12  FILLER REDEFINES CM-USER-RESERVED.
  2532         16  CM-AH-CLASS-CD                PIC XX.
  2533         16  F                             PIC X.
  2534******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  48
* EL050.cbl
  2536*    COPY ERCMAIL.
  2537******************************************************************
  2538*                                                                *
  2539*                                                                *
  2540*                            ERCMAIL                             *
  2541*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2542*                            VMOD=2.003                          *
  2543*                                                                *
  2544*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2545*                                                                *
  2546*   FILE TYPE = VSAM,KSDS                                        *
  2547*   RECORD SIZE = 374   RECFORM = FIX                            *
  2548*                                                                *
  2549*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2550*   ALTERNATE PATH    = NOT USED                                 *
  2551*                                                                *
  2552*   LOG = YES                                                    *
  2553*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2554******************************************************************
  2555*                   C H A N G E   L O G
  2556*
  2557* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2558*-----------------------------------------------------------------
  2559*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2560* EFFECTIVE    NUMBER
  2561*-----------------------------------------------------------------
  2562* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2563* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2564* 111108                   PEMA  ADD CRED BENE ADDR2
  2565******************************************************************
  2566
  2567 01  MAILING-DATA.
  2568     12  MA-RECORD-ID                      PIC XX.
  2569         88  VALID-MA-ID                       VALUE 'MA'.
  2570
  2571     12  MA-CONTROL-PRIMARY.
  2572         16  MA-COMPANY-CD                 PIC X.
  2573         16  MA-CARRIER                    PIC X.
  2574         16  MA-GROUPING.
  2575             20  MA-GROUPING-PREFIX        PIC XXX.
  2576             20  MA-GROUPING-PRIME         PIC XXX.
  2577         16  MA-STATE                      PIC XX.
  2578         16  MA-ACCOUNT.
  2579             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2580             20  MA-ACCOUNT-PRIME          PIC X(6).
  2581         16  MA-CERT-EFF-DT                PIC XX.
  2582         16  MA-CERT-NO.
  2583             20  MA-CERT-PRIME             PIC X(10).
  2584             20  MA-CERT-SFX               PIC X.
  2585
  2586     12  FILLER                            PIC XX.
  2587
  2588     12  MA-ACCESS-CONTROL.
  2589         16  MA-SOURCE-SYSTEM              PIC XX.
  2590             88  MA-FROM-CREDIT                VALUE 'CR'.
  2591             88  MA-FROM-VSI                   VALUE 'VS'.
  2592             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2593             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  49
* EL050.cbl
  2594         16  MA-RECORD-ADD-DT              PIC XX.
  2595         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2596         16  MA-LAST-MAINT-DT              PIC XX.
  2597         16  MA-LAST-MAINT-BY              PIC XXXX.
  2598         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2599
  2600     12  MA-PROFILE-INFO.
  2601         16  MA-QUALIFY-CODE-1             PIC XX.
  2602         16  MA-QUALIFY-CODE-2             PIC XX.
  2603         16  MA-QUALIFY-CODE-3             PIC XX.
  2604         16  MA-QUALIFY-CODE-4             PIC XX.
  2605         16  MA-QUALIFY-CODE-5             PIC XX.
  2606
  2607         16  MA-INSURED-LAST-NAME          PIC X(15).
  2608         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2609         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2610         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2611         16  MA-INSURED-BIRTH-DT           PIC XX.
  2612         16  MA-INSURED-SEX                PIC X.
  2613             88  MA-SEX-MALE                   VALUE 'M'.
  2614             88  MA-SEX-FEMALE                 VALUE 'F'.
  2615         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2616
  2617         16  MA-ADDRESS-CORRECTED          PIC X.
  2618         16  MA-JOINT-BIRTH-DT             PIC XX.
  2619*        16  FILLER                        PIC X(12).
  2620
  2621         16  MA-ADDRESS-LINE-1             PIC X(30).
  2622         16  MA-ADDRESS-LINE-2             PIC X(30).
  2623         16  MA-CITY-STATE.
  2624             20  MA-CITY                   PIC X(28).
  2625             20  MA-ADDR-STATE             PIC XX.
  2626         16  MA-ZIP.
  2627             20  MA-ZIP-CODE.
  2628                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2629                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2630                 24  FILLER                PIC X(4).
  2631             20  MA-ZIP-PLUS4              PIC X(4).
  2632         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2633             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2634             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2635             20  FILLER                    PIC X(3).
  2636
  2637         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2638
  2639         16  FILLER                        PIC XXX.
  2640*        16  FILLER                        PIC X(10).
  2641
  2642     12  MA-CRED-BENE-INFO.
  2643         16  MA-CRED-BENE-NAME                 PIC X(25).
  2644         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2645         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2646         16  MA-CRED-BENE-CTYST.
  2647             20  MA-CRED-BENE-CITY             PIC X(28).
  2648             20  MA-CRED-BENE-STATE            PIC XX.
  2649         16  MA-CRED-BENE-ZIP.
  2650             20  MA-CB-ZIP-CODE.
  2651                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  50
* EL050.cbl
  2652                     88  MA-CB-CANADIAN-POST-CODE
  2653                                           VALUE 'A' THRU 'Z'.
  2654                 24  FILLER                    PIC X(4).
  2655             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2656         16  MA-CB-CANADIAN-POSTAL-CODE
  2657                            REDEFINES MA-CRED-BENE-ZIP.
  2658             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2659             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2660             20  FILLER                        PIC X(3).
  2661     12  MA-POST-CARD-MAIL-DATA.
  2662         16  MA-MAIL-DATA OCCURS 7.
  2663             20  MA-MAIL-TYPE              PIC X.
  2664                 88  MA-12MO-MAILING           VALUE '1'.
  2665                 88  MA-EXP-MAILING            VALUE '2'.
  2666             20  MA-MAIL-STATUS            PIC X.
  2667                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2668                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2669                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2670             20  MA-MAIL-DATE              PIC XX.
  2671     12  FILLER                            PIC XX.
  2672     12  FILLER                            PIC XX.
  2673*    12  FILLER                            PIC X(30).
  2674******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  51
* EL050.cbl
  2676*    COPY ERCPNDM.
  2677******************************************************************
  2678*                                                                *
  2679*                                                                *
  2680*                            ERCPNDM                             *
  2681*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2682*                            VMOD=2.003                          *
  2683*                                                                *
  2684*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2685*                                                                *
  2686*   FILE TYPE = VSAM,KSDS                                        *
  2687*   RECORD SIZE = 374   RECFORM = FIX                            *
  2688*                                                                *
  2689*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2690*   ALTERNATE PATH    = NOT USED                                 *
  2691*                                                                *
  2692*   LOG = YES                                                    *
  2693*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2694******************************************************************
  2695*                   C H A N G E   L O G
  2696*
  2697* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2698*-----------------------------------------------------------------
  2699*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2700* EFFECTIVE    NUMBER
  2701*-----------------------------------------------------------------
  2702* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2703* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2704* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2705* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2706******************************************************************
  2707
  2708 01  PENDING-MAILING-DATA.
  2709     12  PM-RECORD-ID                      PIC XX.
  2710         88  VALID-MA-ID                       VALUE 'PM'.
  2711
  2712     12  PM-CONTROL-PRIMARY.
  2713         16  PM-COMPANY-CD                 PIC X.
  2714         16  PM-ENTRY-BATCH                PIC X(6).
  2715         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2716         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2717
  2718     12  FILLER                            PIC X(14).
  2719
  2720     12  PM-ACCESS-CONTROL.
  2721         16  PM-SOURCE-SYSTEM              PIC XX.
  2722             88  PM-FROM-CREDIT                VALUE 'CR'.
  2723             88  PM-FROM-VSI                   VALUE 'VS'.
  2724             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2725             88  PM-FROM-OTHER                 VALUE 'OT'.
  2726         16  PM-RECORD-ADD-DT              PIC XX.
  2727         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2728         16  PM-LAST-MAINT-DT              PIC XX.
  2729         16  PM-LAST-MAINT-BY              PIC XXXX.
  2730         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2731
  2732     12  PM-PROFILE-INFO.
  2733         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  52
* EL050.cbl
  2734         16  PM-QUALIFY-CODE-2             PIC XX.
  2735         16  PM-QUALIFY-CODE-3             PIC XX.
  2736         16  PM-QUALIFY-CODE-4             PIC XX.
  2737         16  PM-QUALIFY-CODE-5             PIC XX.
  2738
  2739         16  PM-INSURED-LAST-NAME          PIC X(15).
  2740         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2741         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2742         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2743         16  PM-INSURED-BIRTH-DT           PIC XX.
  2744         16  PM-INSURED-SEX                PIC X.
  2745             88  PM-SEX-MALE                   VALUE 'M'.
  2746             88  PM-SEX-FEMALE                 VALUE 'F'.
  2747         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2748
  2749         16  PM-ADDRESS-CORRECTED          PIC X.
  2750         16  PM-JOINT-BIRTH-DT             PIC XX.
  2751*        16  FILLER                        PIC X(12).
  2752
  2753         16  PM-ADDRESS-LINE-1             PIC X(30).
  2754         16  PM-ADDRESS-LINE-2             PIC X(30).
  2755         16  PM-CITY-STATE.
  2756             20  PM-CITY                   PIC X(28).
  2757             20  PM-STATE                  PIC XX.
  2758         16  PM-ZIP.
  2759             20  PM-ZIP-CODE.
  2760                 24  PM-ZIP-1              PIC X.
  2761                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2762                 24  FILLER                PIC X(4).
  2763             20  PM-ZIP-PLUS4              PIC X(4).
  2764         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2765             20  PM-CAN-POST1              PIC XXX.
  2766             20  PM-CAN-POST2              PIC XXX.
  2767             20  FILLER                    PIC XXX.
  2768
  2769         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2770         16  pm-city-st-zip-verified       pic x.
  2771         16  FILLER                        PIC XX.
  2772
  2773     12  PM-CRED-BENE-INFO.
  2774         16  PM-CRED-BENE-NAME             PIC X(25).
  2775         16  PM-CRED-BENE-ADDR             PIC X(30).
  2776         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2777         16  PM-CRED-BENE-CTYST.
  2778             20  PM-CRED-BENE-CITY         PIC X(28).
  2779             20  PM-CRED-BENE-STATE        PIC XX.
  2780         16  PM-CRED-BENE-ZIP.
  2781             20  PM-CB-ZIP-CODE.
  2782                 24  PM-CB-ZIP-1           PIC X.
  2783                     88  PM-CB-CANADIAN-POST-CODE
  2784                                  VALUE 'A' THRU 'Z'.
  2785                 24  FILLER                PIC X(4).
  2786             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2787         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2788             20  PM-CB-CAN-POST1           PIC XXX.
  2789             20  PM-CB-CAN-POST2           PIC XXX.
  2790             20  FILLER                    PIC XXX.
  2791     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  53
* EL050.cbl
  2792         16  PM-MAIL-DATA OCCURS 7.
  2793             20  PM-MAIL-TYPE              PIC X.
  2794                 88  PM-12MO-MAILING           VALUE '1'.
  2795                 88  PM-EXP-MAILING            VALUE '2'.
  2796             20  PM-MAIL-STATUS            PIC X.
  2797                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2798                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2799                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2800             20  PM-MAIL-DATE              PIC XX.
  2801     12  FILLER                            PIC XX.
  2802     12  FILLER                            PIC X(12).
  2803*    12  FILLER                            PIC X(30).
  2804
  2805******************************************************************
  2806*                                COPY ERCLOFC.
  2807******************************************************************
  2808*                                                                *
  2809*                                                                *
  2810*                            ERCLOFC                             *
  2811*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2812*                            VMOD=2.003                          *
  2813*                                                                *
  2814*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2815*                                                                *
  2816*   FILE TYPE = VSAM,KSDS                                        *
  2817*   RECORD SIZE = 670   RECFORM = FIX                            *
  2818*                                                                *
  2819*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2820*                                                                *
  2821*   LOG = YES                                                    *
  2822*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2823*                                                                *
  2824******************************************************************
  2825
  2826 01  LOAN-OFFICER-MASTER.
  2827     12  LO-RECORD-ID                PIC XX.
  2828         88  VALID-LO-ID                VALUE 'LO'.
  2829
  2830     12  LO-CONTROL-PRIMARY.
  2831         16  LO-COMPANY-CD           PIC X.
  2832         16  LO-CARRIER              PIC X.
  2833         16  LO-GROUPING.
  2834             20  LO-GROUPING-PREFIX  PIC XXX.
  2835             20  LO-GROUPING-PRIME   PIC XXX.
  2836         16  LO-STATE                PIC XX.
  2837         16  LO-ACCOUNT.
  2838             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2839             20  LO-ACCOUNT-PRIME    PIC X(6).
  2840         16  LO-OFFICER-CODE         PIC X(5).
  2841
  2842     12  LO-OFFICER-NAME             PIC X(30).
  2843
  2844     12  LO-LAST-MAINT-DT            PIC XX.
  2845     12  LO-LAST-USER                PIC X(4).
  2846     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2847
  2848     12  LO-COMP-CONTROL             PIC X.
  2849             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  54
* EL050.cbl
  2850             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2851     12  LO-DETAIL-CONTROL           PIC X.
  2852             88  LO-PRINT-DETAIL        VALUE 'D'.
  2853             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2854
  2855     12  LO-SV-CARRIER               PIC X.
  2856     12  LO-SV-GROUPING              PIC X(6).
  2857     12  LO-SV-STATE                 PIC XX.
  2858
  2859     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2860     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2861
  2862     12  LO-OFFICER-INFO.
  2863         16  FILLER OCCURS 12 TIMES.
  2864             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2865             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2866             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2867             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2868             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2869             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2870             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2871             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2872     12  FILLER                      PIC X(198).
  2873******************************************************************
  2874*                                COPY ERCPDEF.
  2875******************************************************************
  2876*                                                                *
  2877*                                                                *
  2878*                            ERCPDEF.                            *
  2879*                                                                *
  2880*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2881*                                                                *
  2882*    FILE TYPE = VSAM,KSDS                                       *
  2883*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2884*                                                                *
  2885*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2886*                                                                *
  2887*    LOG = YES                                                   *
  2888*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2889******************************************************************
  2890*                   C H A N G E   L O G
  2891*
  2892* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2893*-----------------------------------------------------------------
  2894*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2895* EFFECTIVE    NUMBER
  2896*-----------------------------------------------------------------
  2897* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2898* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2899* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2900******************************************************************
  2901 01  PRODUCT-MASTER.
  2902    12  PD-RECORD-ID                 PIC X(02).
  2903        88  VALID-PD-ID                  VALUE 'PD'.
  2904    12  PD-CONTROL-PRIMARY.
  2905        16  PD-COMPANY-CD            PIC X.
  2906        16  PD-STATE                 PIC XX.
  2907        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  55
* EL050.cbl
  2908        16  PD-FILLER                PIC X(7).
  2909        16  PD-BEN-TYPE              PIC X.
  2910        16  PD-BEN-CODE              PIC XX.
  2911        16  PD-PROD-EXP-DT           PIC XX.
  2912    12  FILLER                       PIC X(50).
  2913    12  PD-PRODUCT-DATA OCCURS 8.
  2914        16  PD-PROD-CODE             PIC X.
  2915            88  PD-PROD-LIFE           VALUE 'L'.
  2916            88  PD-PROD-PROP           VALUE 'P'.
  2917            88  PD-PROD-AH             VALUE 'A'.
  2918            88  PD-PROD-IU             VALUE 'I'.
  2919            88  PD-PROD-GAP            VALUE 'G'.
  2920            88  PD-PROD-FAML           VALUE 'F'.
  2921        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2922        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2923        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2924        16  PD-MAX-TERM              PIC S999        COMP-3.
  2925        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2926        16  FILLER                   PIC X.
  2927        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2928        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2929        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2930        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2931        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2932        16  PD-REC-CRIT-PERIOD       PIC 99.
  2933        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2934            20  PD-RECURRING-YN      PIC X.
  2935            20  FILLER               PIC X.
  2936        16  PD-RTW-MOS               PIC 99.
  2937        16  PD-MAX-EXTENSION         PIC 99.
  2938        16  pd-ben-pct               pic sv999 comp-3.
  2939*       16  FILLER                   PIC XX.
  2940    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2941    12  PD-TERM-LIMITS OCCURS 15.
  2942        16  PD-LOW-TERM              PIC S999        COMP-3.
  2943        16  PD-HI-TERM               PIC S999        COMP-3.
  2944*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2945    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2946        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2947        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2948    12  PD-EARN-FACTORS.
  2949        16  FILLER OCCURS 15.
  2950            20  FILLER OCCURS 15.
  2951                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2952    12  PD-PRODUCT-DESC              PIC X(80).
  2953    12  PD-TRUNCATED                 PIC X.
  2954    12  FILLER                       PIC X(59).
  2955    12  PD-MAINT-INFORMATION.
  2956        16  PD-LAST-MAINT-DT         PIC X(02).
  2957        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2958        16  PD-LAST-MAINT-BY         PIC X(04).
  2959*                                COPY ELCSTATE.
  2960******************************************************************
  2961*                                                                *
  2962*                                                                *
  2963*                            ELCSTATE.                           *
  2964*                                                                *
  2965*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  56
* EL050.cbl
  2966*                                                                *
  2967*   FILE TYPE = VSAM,KSDS                                        *
  2968*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2969*                                                                *
  2970*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2971*       ALTERNATE INDEX = NONE                                   *
  2972*                                                                *
  2973*   LOG = YES                                                    *
  2974*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2975******************************************************************
  2976*                   C H A N G E   L O G
  2977*
  2978* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2979*-----------------------------------------------------------------
  2980*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2981* EFFECTIVE    NUMBER
  2982*-----------------------------------------------------------------
  2983* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2984******************************************************************
  2985*
  2986 01  STATE-FILE.
  2987     12  SF-RECORD-ID                       PIC XX.
  2988         88  VALID-CF-ID                        VALUE 'SF'.
  2989     12  SF-CONTROL-PRIMARY.
  2990         16  SF-COMPANY-ID                  PIC XXX.
  2991         16  SF-CARRIER-CODE                PIC X.
  2992         16  SF-GROUPING                    PIC X(6).
  2993         16  SF-STATE-CODE                  PIC XX.
  2994         16  SF-EXPIRE-DATE                 PIC 9(8).
  2995****************************************************************
  2996*             STATE CONTROLS
  2997****************************************************************
  2998     12  SF-LAST-MAINT-DT                   PIC XX.
  2999     12  SF-LAST-MAINT-BY                   PIC X(4).
  3000     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3001     12  SF-STATE-RT-CONTROLS.
  3002         16  SF-ST-RT-CALC                  PIC X.
  3003     12  SF-ST-TAX-CONTROLS.
  3004         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3005         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3006         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3007     12  SF-ST-REFUND-OPTIONS.
  3008         16  SF-ST-RF-LR-CALC               PIC X.
  3009         16  SF-ST-RF-LL-CALC               PIC X.
  3010         16  SF-ST-RF-LN-CALC               PIC X.
  3011         16  SF-ST-RF-AH-CALC               PIC X.
  3012         16  SF-ST-RF-CP-CALC               PIC X.
  3013     12  SF-ST-UNEARN-PREM-OPTIONS.
  3014         16  SF-ST-LUEP-R78                 PIC X.
  3015         16  SF-ST-LUEP-PRO                 PIC X.
  3016         16  SF-ST-LUEP-ST                  PIC X.
  3017         16  SF-ST-LUEP-DOM                 PIC X.
  3018         16  SF-ST-AUEP-R78                 PIC X.
  3019         16  SF-ST-AUEP-PRO                 PIC X.
  3020         16  SF-ST-AUEP-ST                  PIC X.
  3021         16  SF-ST-AUEP-DOM                 PIC X.
  3022         16  SF-ST-CUEP-R78                 PIC X.
  3023         16  SF-ST-CUEP-PRO                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  57
* EL050.cbl
  3024         16  SF-ST-CUEP-ST                  PIC X.
  3025         16  SF-ST-CUEP-DOM                 PIC X.
  3026     12  SF-ST-EARN-PREM-OPTIONS.
  3027         16  SF-ST-LEP-R78                  PIC X.
  3028         16  SF-ST-LEP-PRO                  PIC X.
  3029         16  SF-ST-LEP-ST                   PIC X.
  3030         16  SF-ST-LEP-DOM                  PIC X.
  3031         16  SF-ST-AEP-R78                  PIC X.
  3032         16  SF-ST-AEP-PRO                  PIC X.
  3033         16  SF-ST-AEP-ST                   PIC X.
  3034         16  SF-ST-AEP-DOM                  PIC X.
  3035         16  SF-ST-CEP-R78                  PIC X.
  3036         16  SF-ST-CEP-PRO                  PIC X.
  3037         16  SF-ST-CEP-ST                   PIC X.
  3038         16  SF-ST-CEP-DOM                  PIC X.
  3039     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  58
* EL050.cbl
  3041*    COPY ELCCRTT.
  3042******************************************************************
  3043*                                                                *
  3044*                            ELCCRTT.                            *
  3045*                                                                *
  3046*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3047*                                                                *
  3048*   FILE TYPE = VSAM,KSDS                                        *
  3049*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3050*                                                                *
  3051*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3052*                                                                *
  3053*   LOG = YES                                                    *
  3054*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3055******************************************************************
  3056*                   C H A N G E   L O G
  3057*
  3058* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3059*-----------------------------------------------------------------
  3060*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3061* EFFECTIVE    NUMBER
  3062*-----------------------------------------------------------------
  3063* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3064* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3065* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3066* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3067* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3068* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3069* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3070* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3071* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3072* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3073******************************************************************
  3074
  3075 01  CERTIFICATE-TRAILERS.
  3076     12  CS-RECORD-ID                      PIC XX.
  3077         88  VALID-CS-ID                      VALUE 'CS'.
  3078
  3079     12  CS-CONTROL-PRIMARY.
  3080         16  CS-COMPANY-CD                 PIC X.
  3081         16  CS-CARRIER                    PIC X.
  3082         16  CS-GROUPING                   PIC X(6).
  3083         16  CS-STATE                      PIC XX.
  3084         16  CS-ACCOUNT                    PIC X(10).
  3085         16  CS-CERT-EFF-DT                PIC XX.
  3086         16  CS-CERT-NO.
  3087             20  CS-CERT-PRIME             PIC X(10).
  3088             20  CS-CERT-SFX               PIC X.
  3089         16  CS-TRAILER-TYPE               PIC X.
  3090             88  COMM-TRLR           VALUE 'A'.
  3091             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3092             88  CERT-DATA-TRLR      VALUE 'C'.
  3093
  3094     12  CS-DATA-AREA                      PIC X(516).
  3095
  3096     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3097         16  CS-BANK-COMMISSION-AREA.
  3098             20  CS-BANK-COMMS       OCCURS 10.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  59
* EL050.cbl
  3099                 24  CS-AGT                PIC X(10).
  3100                 24  CS-COM-TYP            PIC X.
  3101                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3102                 24  CS-RECALC-LV-INDIC    PIC X.
  3103                 24  FILLER                PIC X(10).
  3104         16  FILLER                        PIC X(256).
  3105
  3106     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3107****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3108         16  CS-MB-CLAIM-DATA OCCURS 24.
  3109             20  CS-CLAIM-NO               PIC X(7).
  3110             20  CS-CLAIM-TYPE             PIC X.
  3111                 88  CS-AH-CLM               VALUE 'A'.
  3112                 88  CS-IU-CLM               VALUE 'I'.
  3113                 88  CS-GP-CLM               VALUE 'G'.
  3114                 88  CS-LF-CLM               VALUE 'L'.
  3115                 88  CS-PR-CLM               VALUE 'P'.
  3116                 88  CS-FL-CLM               VALUE 'F'.
  3117             20  CS-INSURED-TYPE           PIC X.
  3118                 88  CS-PRIM-INSURED          VALUE 'P'.
  3119                 88  CS-CO-BORROWER           VALUE 'C'.
  3120             20  CS-BENEFIT-PERIOD         PIC 99.
  3121             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3122             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3123             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3124         16  FILLER                        PIC X(12).
  3125     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3126         16  CS-VIN-NUMBER                 PIC X(17).
  3127         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3128         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3129         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3130         16  cs-agent-name.
  3131             20  cs-agent-fname            pic x(20).
  3132             20  cs-agent-mi               pic x.
  3133             20  cs-agent-lname            pic x(25).
  3134         16  cs-license-no                 pic x(15).
  3135         16  cs-npn-number                 pic x(10).
  3136         16  cs-agent-edit-status          pic x.
  3137             88  cs-ae-refer-to-manager      value 'M'.
  3138             88  cs-ae-cover-sheet           value 'C'.
  3139             88  cs-ae-sig-form              value 'S'.
  3140             88  cs-ae-verified              value 'V'.
  3141             88  cs-unidentified-signature   value 'U'.
  3142             88  cs-cert-returned            value 'R'.
  3143             88  cs-accept-no-commission     value 'N'.
  3144         16  cs-year                       pic 9999.
  3145         16  cs-make                       pic x(20).
  3146         16  cs-model                      pic x(20).
  3147         16  cs-future                     pic x(20).
  3148         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3149         16  cs-claim-verification-status  pic x.
  3150             88  cs-clm-ver-eligible         value 'A'.
  3151             88  cs-clm-ver-partial-elig     value 'B'.
  3152             88  cs-clm-ver-not-eligible     value 'C'.
  3153             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3154             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3155             88  cs-clm-ver-ND-CERT          value 'F'.
  3156             88  cs-clm-ver-spec-other       value 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  60
* EL050.cbl
  3157             88  cs-clam-ver-pratial-corrected
  3158                                             value 'H'.
  3159             88  cs-clm-ver-no-matches       value 'I'.
  3160             88  cs-clm-ver-not-elig-corrected
  3161                                             value 'J'.
  3162             88  cs-clm-ver-needs-review     value 'R'.
  3163             88  cs-clm-ver-sent-to-claims   value 'W'.
  3164         16  FILLER                        PIC X(355). *> was 420
  3165*        16  FILLER                        PIC X(496).
  3166*    COPY ELCCRTO.
  3167******************************************************************
  3168*                                                                *
  3169*                            ELCCRTO.                            *
  3170*                                                                *
  3171*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3172*                                                                *
  3173*   FILE TYPE = VSAM,KSDS                                        *
  3174*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3175*                                                                *
  3176*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3177*                                                                *
  3178*   LOG = YES                                                    *
  3179*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3180******************************************************************
  3181*                   C H A N G E   L O G
  3182*
  3183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3184*-----------------------------------------------------------------
  3185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3186* EFFECTIVE    NUMBER
  3187*-----------------------------------------------------------------
  3188* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3189* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3190* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3191* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3192* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3193******************************************************************
  3194 01  ORIGINAL-CERTIFICATE.
  3195     12  OC-RECORD-ID                      PIC XX.
  3196         88  VALID-OC-ID                      VALUE 'OC'.
  3197     12  OC-CONTROL-PRIMARY.
  3198         16  OC-COMPANY-CD                 PIC X.
  3199         16  OC-CARRIER                    PIC X.
  3200         16  OC-GROUPING                   PIC X(6).
  3201         16  OC-STATE                      PIC XX.
  3202         16  OC-ACCOUNT                    PIC X(10).
  3203         16  OC-CERT-EFF-DT                PIC XX.
  3204         16  OC-CERT-NO.
  3205             20  OC-CERT-PRIME             PIC X(10).
  3206             20  OC-CERT-SFX               PIC X.
  3207         16  OC-RECORD-TYPE                PIC X.
  3208         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3209     12  OC-LAST-MAINT-DT                  PIC XX.
  3210     12  OC-LAST-MAINT-BY                  PIC X(4).
  3211     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3212     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3213     12  FILLER                            PIC X(49).
  3214     12  OC-ORIG-REC.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  61
* EL050.cbl
  3215         16  OC-INS-LAST-NAME              PIC X(15).
  3216         16  OC-INS-FIRST-NAME             PIC X(10).
  3217         16  OC-INS-MIDDLE-INIT            PIC X.
  3218         16  OC-INS-AGE                    PIC S999     COMP-3.
  3219         16  OC-JNT-LAST-NAME              PIC X(15).
  3220         16  OC-JNT-FIRST-NAME             PIC X(10).
  3221         16  OC-JNT-MIDDLE-INIT            PIC X.
  3222         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3223         16  OC-LF-BENCD                   PIC XX.
  3224         16  OC-LF-TERM                    PIC S999      COMP-3.
  3225         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3226         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3227         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3228         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3229         16  OC-LF-EXP-DT                  PIC XX.
  3230         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3231         16  OC-LF-CANCEL-DT               PIC XX.
  3232         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3233         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3234         16  OC-AH-BENCD                   PIC XX.
  3235         16  OC-AH-TERM                    PIC S999      COMP-3.
  3236         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3237         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3238         16  OC-AH-EXP-DT                  PIC XX.
  3239         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3240         16  OC-AH-CP                      PIC 99.
  3241         16  OC-AH-CANCEL-DT               PIC XX.
  3242         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3243         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3244         16  OC-CRED-BENE-NAME             PIC X(25).
  3245         16  OC-1ST-PMT-DT                 PIC XX.
  3246         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3247         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3248         16  OC-ISSUE-TRAN-IND             PIC X.
  3249         16  OC-CANCEL-TRAN-IND            PIC X.
  3250         16  FILLER                        PIC X(211).
  3251
  3252     12  FILLER                            PIC X(50).
  3253******************************************************************
  3254
  3255*    COPY ELCDATE.
  3256******************************************************************
  3257*                                                                *
  3258*                                                                *
  3259*                            ELCDATE.                            *
  3260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3261*                            VMOD=2.003
  3262*                                                                *
  3263*                                                                *
  3264*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3265*                 LENGTH = 200                                   *
  3266******************************************************************
  3267
  3268 01  DATE-CONVERSION-DATA.
  3269     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3270     12  DC-OPTION-CODE                PIC X.
  3271         88  BIN-TO-GREG                VALUE ' '.
  3272         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  62
* EL050.cbl
  3273         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3274         88  YMD-GREG-TO-BIN            VALUE '3'.
  3275         88  MDY-GREG-TO-BIN            VALUE '4'.
  3276         88  JULIAN-TO-BIN              VALUE '5'.
  3277         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3278         88  FIND-CENTURY               VALUE '7'.
  3279         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3280         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3281         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3282         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3283         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3284         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3285         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3286         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3287         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3288         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3289         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3290         88  BIN-3-TO-GREG              VALUE 'I'.
  3291         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3292         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3293         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3294         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3295         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3296         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3297         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3298         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3299         88  THREE-CHARACTER-BIN
  3300                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3301         88  GREGORIAN-TO-BIN
  3302                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3303         88  BIN-TO-GREGORIAN
  3304                  VALUES ' ' '1' 'I' '8' 'G'.
  3305         88  JULIAN-TO-BINARY
  3306                  VALUES '5' 'C' 'E' 'F'.
  3307     12  DC-ERROR-CODE                 PIC X.
  3308         88  NO-CONVERSION-ERROR        VALUE ' '.
  3309         88  DATE-CONVERSION-ERROR
  3310                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3311         88  DATE-IS-ZERO               VALUE '1'.
  3312         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3313         88  DATE-IS-INVALID            VALUE '3'.
  3314         88  DATE1-GREATER-DATE2        VALUE '4'.
  3315         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3316         88  DATE-INVALID-OPTION        VALUE '9'.
  3317         88  INVALID-CENTURY            VALUE 'A'.
  3318         88  ONLY-CENTURY               VALUE 'B'.
  3319         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3320         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3321     12  DC-END-OF-MONTH               PIC X.
  3322         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3323     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3324         88  USE-NORMAL-PROCESS         VALUE ' '.
  3325         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3326         88  ADJUST-UP-100-YRS          VALUE '2'.
  3327     12  FILLER                        PIC X.
  3328     12  DC-CONVERSION-DATES.
  3329         16  DC-BIN-DATE-1             PIC XX.
  3330         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  63
* EL050.cbl
  3331         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3332         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3333                       DC-GREG-DATE-1-EDIT.
  3334             20  DC-EDIT1-MONTH        PIC 99.
  3335             20  SLASH1-1              PIC X.
  3336             20  DC-EDIT1-DAY          PIC 99.
  3337             20  SLASH1-2              PIC X.
  3338             20  DC-EDIT1-YEAR         PIC 99.
  3339         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3340         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3341                     DC-GREG-DATE-2-EDIT.
  3342             20  DC-EDIT2-MONTH        PIC 99.
  3343             20  SLASH2-1              PIC X.
  3344             20  DC-EDIT2-DAY          PIC 99.
  3345             20  SLASH2-2              PIC X.
  3346             20  DC-EDIT2-YEAR         PIC 99.
  3347         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3348         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3349                     DC-GREG-DATE-1-YMD.
  3350             20  DC-YMD-YEAR           PIC 99.
  3351             20  DC-YMD-MONTH          PIC 99.
  3352             20  DC-YMD-DAY            PIC 99.
  3353         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3354         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3355                      DC-GREG-DATE-1-MDY.
  3356             20  DC-MDY-MONTH          PIC 99.
  3357             20  DC-MDY-DAY            PIC 99.
  3358             20  DC-MDY-YEAR           PIC 99.
  3359         16  DC-GREG-DATE-1-ALPHA.
  3360             20  DC-ALPHA-MONTH        PIC X(10).
  3361             20  DC-ALPHA-DAY          PIC 99.
  3362             20  FILLER                PIC XX.
  3363             20  DC-ALPHA-CENTURY.
  3364                 24 DC-ALPHA-CEN-N     PIC 99.
  3365             20  DC-ALPHA-YEAR         PIC 99.
  3366         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3367         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3368         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3369         16  DC-JULIAN-DATE            PIC 9(05).
  3370         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3371                                       PIC 9(05).
  3372         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3373             20  DC-JULIAN-YEAR        PIC 99.
  3374             20  DC-JULIAN-DAYS        PIC 999.
  3375         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3376         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3377         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3378     12  DATE-CONVERSION-VARIBLES.
  3379         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3380         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3381             20  FILLER                PIC 9(3).
  3382             20  HOLD-CEN-1-CCYY.
  3383                 24  HOLD-CEN-1-CC     PIC 99.
  3384                 24  HOLD-CEN-1-YY     PIC 99.
  3385             20  HOLD-CEN-1-MO         PIC 99.
  3386             20  HOLD-CEN-1-DA         PIC 99.
  3387         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3388             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  64
* EL050.cbl
  3389             20  HOLD-CEN-1-R-DA       PIC 99.
  3390             20  HOLD-CEN-1-R-CCYY.
  3391                 24  HOLD-CEN-1-R-CC   PIC 99.
  3392                 24  HOLD-CEN-1-R-YY   PIC 99.
  3393             20  FILLER                PIC 9(3).
  3394         16  HOLD-CENTURY-1-X.
  3395             20  FILLER                PIC X(3)  VALUE SPACES.
  3396             20  HOLD-CEN-1-X-CCYY.
  3397                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3398                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3399             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3400             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3401         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3402             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3403             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3404             20  HOLD-CEN-1-R-X-CCYY.
  3405                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3406                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3407             20  FILLER                PIC XXX.
  3408         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3409         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3410         16  DC-JULIAN-DATE-1          PIC 9(07).
  3411         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3412             20  DC-JULIAN-1-CCYY.
  3413                 24  DC-JULIAN-1-CC    PIC 99.
  3414                 24  DC-JULIAN-1-YR    PIC 99.
  3415             20  DC-JULIAN-DA-1        PIC 999.
  3416         16  DC-JULIAN-DATE-2          PIC 9(07).
  3417         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3418             20  DC-JULIAN-2-CCYY.
  3419                 24  DC-JULIAN-2-CC    PIC 99.
  3420                 24  DC-JULIAN-2-YR    PIC 99.
  3421             20  DC-JULIAN-DA-2        PIC 999.
  3422         16  DC-GREG-DATE-A-EDIT.
  3423             20  DC-EDITA-MONTH        PIC 99.
  3424             20  SLASHA-1              PIC X VALUE '/'.
  3425             20  DC-EDITA-DAY          PIC 99.
  3426             20  SLASHA-2              PIC X VALUE '/'.
  3427             20  DC-EDITA-CCYY.
  3428                 24  DC-EDITA-CENT     PIC 99.
  3429                 24  DC-EDITA-YEAR     PIC 99.
  3430         16  DC-GREG-DATE-B-EDIT.
  3431             20  DC-EDITB-MONTH        PIC 99.
  3432             20  SLASHB-1              PIC X VALUE '/'.
  3433             20  DC-EDITB-DAY          PIC 99.
  3434             20  SLASHB-2              PIC X VALUE '/'.
  3435             20  DC-EDITB-CCYY.
  3436                 24  DC-EDITB-CENT     PIC 99.
  3437                 24  DC-EDITB-YEAR     PIC 99.
  3438         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3439         16  DC-GREG-DATE-CYMD-R REDEFINES
  3440                              DC-GREG-DATE-CYMD.
  3441             20  DC-CYMD-CEN           PIC 99.
  3442             20  DC-CYMD-YEAR          PIC 99.
  3443             20  DC-CYMD-MONTH         PIC 99.
  3444             20  DC-CYMD-DAY           PIC 99.
  3445         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3446         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  65
* EL050.cbl
  3447                              DC-GREG-DATE-MDCY.
  3448             20  DC-MDCY-MONTH         PIC 99.
  3449             20  DC-MDCY-DAY           PIC 99.
  3450             20  DC-MDCY-CEN           PIC 99.
  3451             20  DC-MDCY-YEAR          PIC 99.
  3452    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3453        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3454    12  DC-EL310-DATE                  PIC X(21).
  3455    12  FILLER                         PIC X(28).
  3456
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  66
* EL050.cbl
  3458*    COPY ELCCALC.
  3459******************************************************************
  3460*                                                                *
  3461*                           ELCCALC.                            *
  3462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3463*                            VMOD=2.025                          *
  3464*                                                                *
  3465*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3466*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3467*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3468*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3469*                                                                *
  3470*  PASSED TO ELRTRM                                              *
  3471*  -----------------                                             *
  3472*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3473*  ORIGINAL TERM                                                 *
  3474*  BEGINNING DATE                                                *
  3475*  ENDING DATE                                                   *
  3476*  COMPANY I.D.                                                  *
  3477*  ACCOUNT MASTER USER FIELD                                     *
  3478*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3479*  FREE LOOK DAYS                                                *
  3480*                                                                *
  3481*  RETURNED FROM ELRTRM                                          *
  3482*  ---------------------                                         *
  3483*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3484*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3485*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3486*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3487*----------------------------------------------------------------*
  3488*  PASSED TO ELRAMT                                              *
  3489*  ----------------                                              *
  3490*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3491*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3492*  ORIGINAL AMOUNT                                               *
  3493*  ALTERNATE BENEFIT (BALLON)                                    *
  3494*  A.P.R. - NET PAY ONLY                                         *
  3495*  METHOD
  3496*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3497*  COMPANY I.D.                                                  *
  3498*  BENEFIT TYPE                                                  *
  3499*                                                                *
  3500*  RETURNED FROM ELRAMT                                          *
  3501*  --------------------                                          *
  3502*  REMAINING AMOUNT 1 - CURRENT                                  *
  3503*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3504*  REMAINING AMOUNT FACTOR
  3505*----------------------------------------------------------------*
  3506*  PASSED TO ELRESV                                              *
  3507*  -----------------                                             *
  3508*  CERTIFICATE EFFECTIVE DATE                                    *
  3509*  VALUATION DATE                                                *
  3510*  PAID THRU DATE                                                *
  3511*  BENEFIT                                                       *
  3512*  INCURRED DATE                                                 *
  3513*  REPORTED DATE                                                 *
  3514*  ISSUE AGE                                                     *
  3515*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  67
* EL050.cbl
  3516*  CDT PERCENT                                                   *
  3517*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3518* *CLAIM TYPE (LIFE, A/H)                                        *
  3519* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3520* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3521*                                                                *
  3522*  RETURNED FROM ELRESV                                          *
  3523*  --------------------                                          *
  3524*  CDT TABLE USED                                                *
  3525*  CDT FACTOR USED                                               *
  3526*  PAY TO CURRENT RESERVE                                        *
  3527*  I.B.N.R. - A/H ONLY                                           *
  3528*  FUTURE (ACCRUED) AH ONLY                                      *
  3529*----------------------------------------------------------------*
  3530*  PASSED TO ELRATE                                              *
  3531*  ----------------                                              *
  3532*  CERT ISSUE DATE                                               *
  3533*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3534*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3535*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3536*  STATE CODE (CLIENT DEFINED)                                   *
  3537*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3538*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3539*  DEVIATION CODE                                                *
  3540*  ISSUE AGE                                                     *
  3541*  ORIGINAL BENEFIT AMOUNT                                       *
  3542*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3543*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3544*  BENEFIT KIND (LIFE OR A/H)                                    *
  3545*  A.P.R.                                                        *
  3546*  METHOD
  3547*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3548*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3549*  COMPANY I.D. (3 CHARACTER)                                    *
  3550*  BENEFIT CODE                                                  *
  3551*  BENEFIT OVERRIDE CODE                                         *
  3552*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3553*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3554*  JOINT INDICATOR (CSL ONLY)                                    *
  3555*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3556*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3557*                                                                *
  3558*  RETURNED FROM ELRATE                                          *
  3559*  --------------------                                          *
  3560*  CALCULATED PREMIUM                                            *
  3561*  PREMIUM RATE                                                  *
  3562*  MORTALITY CODE                                                *
  3563*  MAX ATTAINED AGE                                              *
  3564*  MAX AGE                                                       *
  3565*  MAX TERM                                                      *
  3566*  MAX MONTHLY BENEFIT                                           *
  3567*  MAX TOTAL BENIFIT                                             *
  3568*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3569*----------------------------------------------------------------*
  3570*  PASSED TO ELRFND                                              *
  3571*  ----------------                                              *
  3572*  CERT ISSUE DATE                                               *
  3573*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  68
* EL050.cbl
  3574*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3575*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3576*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3577*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3578*  STATE CODE (CLIENT DEFINED)                                   *
  3579*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3580*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3581*  DEVIATION CODE                                                *
  3582*  ISSUE AGE                                                     *
  3583*  ORIGINAL BENEFIT AMOUNT                                       *
  3584*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3585*  PROCESS TYPE (CANCEL)                                         *
  3586*  BENEFIT KIND (LIFE OR A/H)                                    *
  3587*  A.P.R.                                                        *
  3588*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3589*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3590*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3591*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3592*  COMPANY I.D. (3 CHARACTER)                                    *
  3593*  BENEFIT CODE                                                  *
  3594*  BENEFIT OVERRIDE CODE                                         *
  3595*                                                                *
  3596*  RETURNED FROM ELRFND                                          *
  3597*  --------------------                                          *
  3598*  CALCULATED REFUND                                             *
  3599*----------------------------------------------------------------*
  3600*  PASSED TO ELEARN                                              *
  3601*  ----------------                                              *
  3602*  CERT ISSUE DATE                                               *
  3603*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3604*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3605*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3606*  STATE CODE (CLIENT DEFINED)                                   *
  3607*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3608*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3609*  DEVIATION CODE                                                *
  3610*  ISSUE AGE                                                     *
  3611*  ORIGINAL BENEFIT AMOUNT                                       *
  3612*  BENEFIT KIND (LIFE OR A/H)                                    *
  3613*  A.P.R.                                                        *
  3614*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3615*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3616*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3617*  COMPANY I.D. (3 CHARACTER)                                    *
  3618*  BENEFIT CODE                                                  *
  3619*  BENEFIT OVERRIDE CODE                                         *
  3620*                                                                *
  3621*  RETURNED FROM ELEARN                                          *
  3622*  --------------------                                          *
  3623*  INDICATED  EARNINGS                                           *
  3624*----------------------------------------------------------------*
  3625*                 LENGTH = 450                                   *
  3626*                                                                *
  3627******************************************************************
  3628******************************************************************
  3629*                   C H A N G E   L O G
  3630*
  3631* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  69
* EL050.cbl
  3632*-----------------------------------------------------------------
  3633*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3634* EFFECTIVE    NUMBER
  3635*-----------------------------------------------------------------
  3636* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3637* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3638* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3639* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3640* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3641* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3642* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3643* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3644* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3645* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3646* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3647******************************************************************
  3648
  3649 01  CALCULATION-PASS-AREA.
  3650     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3651                                     COMP.
  3652
  3653     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3654       88  NO-CP-ERROR                             VALUE ZERO.
  3655       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3656                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3657       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3658       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3659       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3660       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3661       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3662       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3663       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3664       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3665       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3666       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3667       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3668       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3669       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3670       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3671       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3672       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3673       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3674
  3675     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3676       88  NO-CP-ERROR-2                           VALUE ZERO.
  3677***********************  INPUT AREAS ****************************
  3678
  3679     12  CP-CALCULATION-AREA.
  3680         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3681         16  CP-CERT-EFF-DT        PIC XX.
  3682         16  CP-VALUATION-DT       PIC XX.
  3683         16  CP-PAID-THRU-DT       PIC XX.
  3684         16  CP-BENEFIT-TYPE       PIC X.
  3685           88  CP-AH                               VALUE 'A' 'D'
  3686                                                   'I' 'U'.
  3687           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3688           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3689         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  70
* EL050.cbl
  3690         16  CP-REPORTED-DT        PIC XX.
  3691         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3692         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3693         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-CDT-METHOD         PIC X.
  3698           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3699           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3700           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3701         16  CP-CLAIM-TYPE         PIC X.
  3702           88  CP-AH-CLAIM                         VALUE 'A'.
  3703           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3704         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3705                                     COMP-3.
  3706         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3707                                     COMP-3.
  3708         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3709                                     COMP-3.
  3710         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3711                                     COMP-3.
  3712         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3713                                     COMP-3.
  3714         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3717                                     COMP-3.
  3718         16  CP-REM-TERM-METHOD    PIC X.
  3719           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3720           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3721           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3722           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3723           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3724           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3725           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3726         16  CP-EARNING-METHOD     PIC X.
  3727           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3728           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3729           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3730           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3731           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3732           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3733           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3734           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3735           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3736           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3737           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3738           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3739           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3740           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3741         16  CP-PROCESS-TYPE       PIC X.
  3742           88  CP-CLAIM                            VALUE '1'.
  3743           88  CP-CANCEL                           VALUE '2'.
  3744           88  CP-ISSUE                            VALUE '3'.
  3745         16  CP-SPECIAL-CALC-CD    PIC X.
  3746           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3747           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  71
* EL050.cbl
  3748           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3749           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3750           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3751           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3752           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3753           88  CP-FARM-PLAN                    VALUE 'F'.
  3754           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3755           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3756           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3757           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3758           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3759           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3760           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3761           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3762           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3763           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3764                                                     'W' 'X'.
  3765           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3766           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3767           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3768           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3769           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3770           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3771           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3772           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3773           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3774           88  CP-CSL-METH-1                   VALUE '5'.
  3775           88  CP-CSL-METH-2                   VALUE '6'.
  3776           88  CP-CSL-METH-3                   VALUE '7'.
  3777           88  CP-CSL-METH-4                   VALUE '8'.
  3778
  3779         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3780                                     COMP-3.
  3781         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3782         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3783         16  CP-STATE              PIC XX          VALUE SPACE.
  3784         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3785         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3786           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3787               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3788         16  CP-R78-OPTION         PIC X.
  3789           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3790           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3791
  3792         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3793         16  CP-IBNR-RESERVE-SW    PIC X.
  3794         16  CP-CLAIM-STATUS       PIC X.
  3795         16  CP-RATE-FILE          PIC X.
  3796         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3797                                     COMP-3.
  3798
  3799         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3800         16  CP-AH-OVERRIDE-CODE   PIC X.
  3801
  3802         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3803                                     COMP-3.
  3804         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3805                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  72
* EL050.cbl
  3806         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3807                                     COMP-3.
  3808         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3809                                     COMP-3.
  3810         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3811                                     COMP-3.
  3812         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3813                                  PIC S9(7)V99 COMP-3.
  3814
  3815         16  CP-PAID-FROM-DATE     PIC X(02).
  3816         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3817         16  CP-EXT-DAYS-CALC      PIC X.
  3818           88  CP-EXT-NO-CHG                   VALUE ' '.
  3819           88  CP-EXT-CHG-LF                   VALUE '1'.
  3820           88  CP-EXT-CHG-AH                   VALUE '2'.
  3821           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3822         16  CP-DOMICILE-STATE     PIC XX.
  3823         16  CP-CARRIER            PIC X.
  3824         16  CP-REIN-FLAG          PIC X.
  3825         16  CP-REM-TRM-CALC-OPTION PIC X.
  3826           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3827                      '2' '3' '4' '5'.
  3828           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3829           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3830           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3831           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3832           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3833           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3834           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3835           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3836         16  CP-SIG-SWITCH         PIC X.
  3837         16  CP-RATING-METHOD      PIC X.
  3838           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3839           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3840           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3841           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3842           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3843           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3844           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3845           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3846           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3847         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3848                                     COMP-3.
  3849         16  CP-BEN-CATEGORY       PIC X.
  3850         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3851         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3852                                   PIC S99V9(5) COMP-3.
  3853         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3854         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3855                                   PIC S99V9(5) COMP-3.
  3856         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3857         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3858         16  CP-EXPIRE-DT          PIC XX.
  3859         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3860         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3861         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3862         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3863         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  73
* EL050.cbl
  3864             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3865             88  CP-CALC-CLP              VALUE 'C'.
  3866         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3867         16  CP-CANCEL-REASON      PIC X.
  3868         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3869         16  CP-PMT-MODE           PIC X.
  3870         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3871         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3872         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3873         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3874         16  FILLER                PIC X.
  3875
  3876***************    OUTPUT FROM ELRESV   ************************
  3877
  3878         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3879
  3880         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3881                                     COMP-3.
  3882         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3883                                     COMP-3.
  3884         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3885                                     COMP-3.
  3886         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3887                                     COMP-3.
  3888         16  FILLER                PIC X(09).
  3889***************    OUTPUT FROM ELRTRM   *************************
  3890
  3891         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3892                                     COMP-3.
  3893         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3894                                     COMP-3.
  3895         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3896                                     COMP-3.
  3897         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3898                                     COMP-3.
  3899         16  FILLER                PIC X(12).
  3900
  3901***************    OUTPUT FROM ELRAMT   *************************
  3902
  3903         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3904                                     COMP-3.
  3905         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3906                                     COMP-3.
  3907         16  FILLER                PIC X(12).
  3908
  3909***************    OUTPUT FROM ELRATE   *************************
  3910
  3911         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3912                                     COMP-3.
  3913         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3914                                     COMP-3.
  3915         16  CP-MORTALITY-CODE     PIC X(4).
  3916         16  CP-RATE-EDIT-FLAG     PIC X.
  3917             88  CP-RATES-NEED-APR                  VALUE '1'.
  3918         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3919                                     COMP-3.
  3920         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3921         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  74
* EL050.cbl
  3922         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3923                                   PIC S9(7)V99 COMP-3.
  3924         16  FILLER                PIC X(07).
  3925
  3926***************    OUTPUT FROM ELRFND   *************************
  3927
  3928         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3929                                     COMP-3.
  3930         16  CP-REFUND-TYPE-USED   PIC X.
  3931           88  CP-R-AS-R78                         VALUE '1'.
  3932           88  CP-R-AS-PRORATA                     VALUE '2'.
  3933           88  CP-R-AS-CALIF                       VALUE '3'.
  3934           88  CP-R-AS-TEXAS                       VALUE '4'.
  3935           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3936           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3937           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3938           88  CP-R-AS-MEAN                        VALUE '8'.
  3939           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3940           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3941           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3942           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3943           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3944           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3945         16  FILLER                PIC X(12).
  3946
  3947***************    OUTPUT FROM ELEARN   *************************
  3948
  3949         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3950                                     COMP-3.
  3951         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3952                                     COMP-3.
  3953         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3954                                     COMP-3.
  3955         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3956                                     COMP-3.
  3957         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3958                                     COMP-3.
  3959         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3960                                     COMP-3.
  3961         16  CP-EARNING-TYPE-USED  PIC X.
  3962           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3963           88  CP-E-AS-R78                         VALUE '1'.
  3964           88  CP-E-AS-PRORATA                     VALUE '2'.
  3965           88  CP-E-AS-TEXAS                       VALUE '4'.
  3966           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3967           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3968           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3969           88  CP-E-AS-MEAN                        VALUE '8'.
  3970           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3971         16  FILLER                PIC X(12).
  3972
  3973***************    OUTPUT FROM ELPMNT   *************************
  3974
  3975         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3976                                     COMP-3.
  3977         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3978                                     COMP-3.
  3979         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  75
* EL050.cbl
  3980
  3981***************   MISC WORK AREAS    *****************************
  3982         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3983                                     COMP-3.
  3984         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3985                                     COMP-3.
  3986         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3987                                     COMP-3.
  3988         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3989                                     COMP-3.
  3990         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3991                                     COMP-3.
  3992         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3993                                     COMP-3.
  3994         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3995             88  OPEN-RATE-FILE                   VALUE 'O'.
  3996             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3997             88  IO-ERROR                         VALUE 'E'.
  3998
  3999         16  CP-FIRST-PAY-DATE     PIC XX.
  4000
  4001         16  CP-JOINT-INDICATOR    PIC X.
  4002
  4003         16  CP-RESERVE-REMAINING-TERM
  4004                                   PIC S9(4)V9    VALUE ZERO
  4005                                     COMP-3.
  4006
  4007         16  CP-INSURED-BIRTH-DT   PIC XX.
  4008
  4009         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4010                                     COMP-3.
  4011
  4012         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4013                                     COMP-3.
  4014
  4015         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4016                                     COMP-3.
  4017
  4018         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4019                                     COMP-3.
  4020
  4021         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4022                                     COMP-3.
  4023
  4024         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4025                                     COMP-3.
  4026
  4027         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4028                                     COMP-3.
  4029
  4030         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4031             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4032
  4033         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4034                                     COMP-3.
  4035         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4036                                     COMP-3.
  4037         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  76
* EL050.cbl
  4038         16  cp-extra-periods      pic 9 value zeros.
  4039         16  cp-net-only-state     pic x value spaces.
  4040         16  FILLER                PIC X(13).
  4041******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  77
* EL050.cbl
  4043******************************************************************
  4044*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4045*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4046*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4047*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4048*** MODIFICATION.                                              ***
  4049*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4050*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4051******************************************************************
  4052*    COPY ERCPNDB.
  4053******************************************************************
  4054*                                                                *
  4055*                                                                *
  4056*                            ERCPNDB.                            *
  4057*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4058*                            VMOD=2.025                          *
  4059*                                                                *
  4060*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4061*                                                                *
  4062******************************************************************
  4063*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4064*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4065******************************************************************
  4066*                                                                *
  4067*                                                                *
  4068*   FILE TYPE = VSAM,KSDS                                        *
  4069*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4070*                                                                *
  4071*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4072*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4073*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4074*                                                 RKP=13,LEN=36  *
  4075*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4076*                                      AND CHG-SEQ.)             *
  4077*                                                RKP=49,LEN=11   *
  4078*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4079*                                      AND CHG-SEQ.)             *
  4080*                                                RKP=60,LEN=15   *
  4081*                                                                *
  4082*   LOG = NO                                                     *
  4083*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4084******************************************************************
  4085******************************************************************
  4086*                   C H A N G E   L O G
  4087*
  4088* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4089*-----------------------------------------------------------------
  4090*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4091* EFFECTIVE    NUMBER
  4092*-----------------------------------------------------------------
  4093* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4094* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4095* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4096* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4097* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4098* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4099* 032306                   PEMA  ADD BOW LOAN NUMBER
  4100* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  78
* EL050.cbl
  4101* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4102* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4103* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4104* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4105* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4106* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4107* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4108* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4109* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4110* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4111* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4112******************************************************************
  4113
  4114 01  PENDING-BUSINESS.
  4115     12  PB-RECORD-ID                     PIC XX.
  4116         88  VALID-PB-ID                        VALUE 'PB'.
  4117
  4118     12  PB-CONTROL-PRIMARY.
  4119         16  PB-COMPANY-CD                PIC X.
  4120         16  PB-ENTRY-BATCH               PIC X(6).
  4121         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4122         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4123
  4124     12  PB-CONTROL-BY-ACCOUNT.
  4125         16  PB-COMPANY-CD-A1             PIC X.
  4126         16  PB-CARRIER                   PIC X.
  4127         16  PB-GROUPING.
  4128             20  PB-GROUPING-PREFIX       PIC XXX.
  4129             20  PB-GROUPING-PRIME        PIC XXX.
  4130         16  PB-STATE                     PIC XX.
  4131         16  PB-ACCOUNT.
  4132             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4133             20  PB-ACCOUNT-PRIME         PIC X(6).
  4134         16  PB-CERT-EFF-DT               PIC XX.
  4135         16  PB-CERT-NO.
  4136             20  PB-CERT-PRIME            PIC X(10).
  4137             20  PB-CERT-SFX              PIC X.
  4138         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4139
  4140         16  PB-RECORD-TYPE               PIC X.
  4141             88  PB-MAILING-DATA                VALUE '0'.
  4142             88  PB-ISSUE                       VALUE '1'.
  4143             88  PB-CANCELLATION                VALUE '2'.
  4144             88  PB-BATCH-TRAILER               VALUE '9'.
  4145
  4146     12  PB-CONTROL-BY-ORIG-BATCH.
  4147         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4148         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4149         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4150         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4151
  4152     12  PB-CONTROL-BY-CSR.
  4153         16  PB-CSR-COMPANY-CD            PIC X.
  4154         16  PB-CSR-ID                    PIC X(4).
  4155         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4156         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4157         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4158******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  79
* EL050.cbl
  4159*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4160******************************************************************
  4161
  4162     12  PB-LAST-MAINT-DT                 PIC XX.
  4163     12  PB-LAST-MAINT-BY                 PIC X(4).
  4164     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4165
  4166     12  PB-RECORD-BODY                   PIC X(375).
  4167
  4168     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4169         16  PB-CERT-ORIGIN               PIC X.
  4170             88  CLASIC-CREATED-CERT         VALUE '1'.
  4171         16  PB-I-NAME.
  4172             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4173             20  PB-I-INSURED-FIRST-NAME.
  4174                 24  PB-I-INSURED-1ST-INIT PIC X.
  4175                 24  FILLER                PIC X(9).
  4176             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4177         16  PB-I-AGE                     PIC S99   COMP-3.
  4178         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4179         16  PB-I-BIRTHDAY                PIC XX.
  4180         16  PB-I-INSURED-SEX             PIC X.
  4181             88  PB-SEX-MALE     VALUE 'M'.
  4182             88  PB-SEX-FEMALE   VALUE 'F'.
  4183
  4184         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4185         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4186         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4187         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4188         16  PB-I-SKIP-CODE               PIC X.
  4189             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4190             88  PB-SKIP-JULY              VALUE '1'.
  4191             88  PB-SKIP-AUGUST            VALUE '2'.
  4192             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4193             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4194             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4195             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4196             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4197             88  PB-SKIP-JUNE              VALUE '8'.
  4198             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4199             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4200             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4201         16  PB-I-TERM-TYPE               PIC X.
  4202             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4203             88  PB-PAID-WEEKLY            VALUE 'W'.
  4204             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4205             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4206             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4207         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4208         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4209         16  PB-I-DATA-ENTRY-SW           PIC X.
  4210             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4211             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4212             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4213             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4214         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4215         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4216*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  80
* EL050.cbl
  4217         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4218         16  FILLER                       PIC X.
  4219
  4220         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4221             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4222             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4223                                                   '90' THRU '99'.
  4224         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4225                                          PIC XX.
  4226         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4227         16  PB-I-AMOUNT-FINANCED REDEFINES
  4228                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4229         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4230         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4231                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4232         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4233         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4234         16  PB-I-CLP-AMOUNT REDEFINES
  4235                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4236         16  PB-I-LF-CALC-FLAG            PIC X.
  4237             88 PB-COMP-LF-PREM               VALUE '?'.
  4238         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4239         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4240         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4241         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4242         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4243         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4244         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4245         16  PB-I-LF-ABBR                 PIC XXX.
  4246         16  PB-I-LF-INPUT-CD             PIC XX.
  4247
  4248         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4249             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4250             88  PB-INVALID-AH               VALUE '  ' '00'
  4251                                                   '90' THRU '99'.
  4252         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4253         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4254         16  PB-I-AH-CALC-FLAG            PIC X.
  4255             88 PB-COMP-AH-PREM                  VALUE '?'.
  4256         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4257         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4258         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4259         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4260         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4261         16  PB-I-AH-ABBR                 PIC XXX.
  4262         16  PB-I-AH-INPUT-CD             PIC XXX.
  4263
  4264         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4265         16  PB-I-REIN-TABLE              PIC XXX.
  4266         16  PB-I-BUSINESS-TYPE           PIC 99.
  4267         16  PB-I-INDV-GRP-CD             PIC X.
  4268         16  PB-I-MORT-CODE.
  4269             20  PB-I-TABLE               PIC X.
  4270             20  PB-I-INTEREST            PIC XX.
  4271             20  PB-I-MORT-TYP            PIC X.
  4272         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4273         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4274         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  81
* EL050.cbl
  4275         16  PB-I-INDV-GRP-OVRD           PIC X.
  4276         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4277         16  PB-I-SIG-SW                  PIC X.
  4278             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4279         16  PB-I-RATE-CLASS              PIC XX.
  4280         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4281         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4282         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4283         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4284         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4285         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4286         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4287         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4288         16  PB-I-OB-FLAG                 PIC X.
  4289             88  PB-I-OB                      VALUE 'B'.
  4290             88  PB-I-SUMMARY                 VALUE 'Z'.
  4291         16  PB-I-ENTRY-STATUS            PIC X.
  4292             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4293                                              'M' '5' '9' '2'.
  4294             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4295             88  PB-I-POLICY-PENDING          VALUE '2'.
  4296             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4297             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4298             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4299             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4300             88  PB-I-REIN-ONLY               VALUE '9'.
  4301             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4302             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4303             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4304             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4305         16  PB-I-INT-CODE                PIC X.
  4306             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4307             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4308         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4309         16  PB-I-SOC-SEC-NO              PIC X(11).
  4310         16  PB-I-MEMBER-NO               PIC X(12).
  4311         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4312*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4313         16  PB-I-OLD-LOF                 PIC XXX.
  4314         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4315         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4316         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4317         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4318         16  PB-I-LIFE-INDICATOR          PIC X.
  4319             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4320         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4321         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4322                                          PIC S9(5)V99    COMP-3.
  4323         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4324             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4325             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4326         16  PB-I-1ST-PMT-DT              PIC XX.
  4327         16  PB-I-JOINT-INSURED.
  4328             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4329             20 PB-I-JOINT-FIRST-NAME.
  4330                24  PB-I-JOINT-FIRST-INIT PIC X.
  4331                24  FILLER                PIC X(9).
  4332             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  82
* EL050.cbl
  4333*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4334         16  PB-I-BENEFICIARY-NAME.
  4335             20  PB-I-BANK-NUMBER         PIC X(10).
  4336             20  FILLER                   PIC X(15).
  4337         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4338         16  PB-I-REFERENCE               PIC X(12).
  4339         16  FILLER REDEFINES PB-I-REFERENCE.
  4340             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4341             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4342             20  PB-I-CLP-STATE           PIC XX.
  4343         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4344             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4345             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4346             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4347         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4348         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4349         16  PB-I-RESIDENT-STATE          PIC XX.
  4350         16  PB-I-RATE-CODE               PIC X(4).
  4351         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4352         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4353         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4354         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4355         16  PB-I-BANK-NOCHRGB            PIC 99.
  4356         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4357         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4358
  4359     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4360         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4361             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4362         16  PB-C-CANCEL-ORIGIN           PIC X.
  4363             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4364         16  PB-C-LF-CANCEL-DT            PIC XX.
  4365         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4366         16  PB-C-LF-CALC-REQ             PIC X.
  4367             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4368         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4369         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4370         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4371             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4372         16  PB-C-AH-CANCEL-DT            PIC XX.
  4373         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4374         16  PB-C-AH-CALC-REQ             PIC X.
  4375             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4376         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4377         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4378         16  PB-C-LAST-NAME               PIC X(15).
  4379         16  PB-C-REFUND-SW               PIC X.
  4380             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4381             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4382         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4383         16  PB-C-PAYEE-CODE              PIC X(6).
  4384         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4385         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4386         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4387         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4388         16  PB-C-REFERENCE               PIC X(12).
  4389         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4390         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  83
* EL050.cbl
  4391         16  PB-C-POST-CARD-IND           PIC X.
  4392         16  PB-C-CANCEL-REASON           PIC X.
  4393         16  PB-C-REF-INTERFACE-SW        PIC X.
  4394         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4395         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4396         16  FILLER                       PIC X(01).
  4397*        16  FILLER                       PIC X(18).
  4398         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4399*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4400         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4401         16  PB-CANCELED-CERT-DATA.
  4402             20  PB-CI-INSURED-NAME.
  4403                 24  PB-CI-LAST-NAME      PIC X(15).
  4404                 24  PB-CI-INITIALS       PIC XX.
  4405             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4406             20  PB-CI-INSURED-SEX        PIC X.
  4407             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4408             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4409             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4410             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4411             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4412             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4413             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4414             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4415             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4416             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4417             20  PB-CI-RATE-CLASS         PIC XX.
  4418             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4419             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4420             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4421             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4422             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4423             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4424             20  PB-CI-LF-ABBR            PIC X(3).
  4425             20  PB-CI-AH-ABBR            PIC X(3).
  4426             20  PB-CI-OB-FLAG            PIC X.
  4427                 88  PB-CI-OB                VALUE 'B'.
  4428             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4429                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4430                                           'M' '4' '5' '9' '2'.
  4431                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4432                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4433                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4434                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4435                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4436                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4437                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4438                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4439                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4440                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4441                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4442                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4443                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4444             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4445                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4446                                           'M' '4' '5' '9' '2'.
  4447                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4448                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  84
* EL050.cbl
  4449                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4450                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4451                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4452                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4453                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4454                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4455                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4456                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4457                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4458                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4459                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4460             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4461             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4462             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4463             20  PB-CI-MEMBER-NO          PIC X(12).
  4464             20  PB-CI-INT-CODE           PIC X.
  4465                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4466                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4467             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4468             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4469             20  PB-CI-COMP-EXCP-SW       PIC X.
  4470                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4471                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4472             20  PB-CI-ENTRY-STATUS       PIC X.
  4473             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4474             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4475             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4476             20  PB-CI-DEATH-DT           PIC XX.
  4477             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4478             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4479             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4480             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4481             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4482             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4483             20  PB-CI-ENTRY-DT              PIC XX.
  4484             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4485             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4486             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4487             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4488             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4489             20  PB-CI-OLD-LOF               PIC XXX.
  4490*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4491             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4492             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4493             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4494             20  PB-CI-INDV-GRP-CD           PIC X.
  4495             20  PB-CI-BENEFICIARY-NAME.
  4496                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4497                 24  FILLER                  PIC X(15).
  4498             20  PB-CI-NOTE-SW               PIC X.
  4499             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4500             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4501             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4502             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4503             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4504             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4505             20  PB-CI-FIRST-NAME            PIC X(10).
  4506             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  85
* EL050.cbl
  4507
  4508         16  FILLER                       PIC X(13).
  4509*032306  16  FILLER                       PIC X(27).
  4510*        16  FILLER                       PIC X(46).
  4511
  4512     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4513         16  FILLER                       PIC X(10).
  4514         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4515         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4516         16  PB-M-INSURED-MID-INIT        PIC X.
  4517         16  PB-M-INSURED-AGE             PIC 99.
  4518         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4519         16  PB-M-INSURED-SEX             PIC X.
  4520         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4521         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4522         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4523         16  PB-M-INSURED-CITY-STATE.
  4524             20  PB-M-INSURED-CITY        PIC X(28).
  4525             20  PB-M-INSURED-STATE       PIC XX.
  4526         16  PB-M-INSURED-ZIP-CODE.
  4527             20  PB-M-INSURED-ZIP-PRIME.
  4528                 24  PB-M-INSURED-ZIP-1   PIC X.
  4529                     88  PB-M-CANADIAN-POST-CODE
  4530                                             VALUE 'A' THRU 'Z'.
  4531                 24  FILLER               PIC X(4).
  4532             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4533         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4534                                        PB-M-INSURED-ZIP-CODE.
  4535             20  PM-M-INS-CAN-POST1       PIC XXX.
  4536             20  PM-M-INS-CAN-POST2       PIC XXX.
  4537             20  FILLER                   PIC XXX.
  4538         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4539         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4540         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4541         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4542         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4543         16  PB-M-CRED-BENE-CITYST.
  4544             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4545             20  PB-M-CRED-BENE-STATE     PIC XX.
  4546         16  FILLER                       PIC X(92).
  4547
  4548     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4549         16  FILLER                       PIC X(10).
  4550         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4551         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4552         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4553         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4554         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4555         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4556         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4557         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4558         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4559         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4560         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4561         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4562         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4563         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4564         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  86
* EL050.cbl
  4565         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4566         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4567         16  PB-ACCOUNT-NAME              PIC X(30).
  4568         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4569         16  PB-REFERENCE                 PIC X(12).
  4570         16  PB-B-RECEIVED-DT             PIC XX.
  4571         16  FILLER                       PIC X(234).
  4572
  4573     12  PB-RECORD-STATUS.
  4574         16  PB-CREDIT-SELECT-DT          PIC XX.
  4575         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4576         16  PB-BILLED-DT                 PIC XX.
  4577         16  PB-BILLING-STATUS            PIC X.
  4578             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4579             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4580             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4581         16  PB-RECORD-BILL               PIC X.
  4582             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4583             88  PB-RECORD-RETURNED           VALUE 'R'.
  4584             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4585             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4586             88  PB-OVERRIDE-AH               VALUE 'A'.
  4587             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4588         16  PB-BATCH-ENTRY               PIC X.
  4589             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4590             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4591             88  PB-REISSUED-CERT             VALUE 'E'.
  4592             88  PB-CASH-CERT                 VALUE 'C'.
  4593             88  PB-MONTHLY-CERT              VALUE 'M'.
  4594             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4595             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4596             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4597         16  PB-FORCE-CODE                PIC X.
  4598             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4599             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4600             88  PB-CANCEL-FORCE              VALUE '8'.
  4601             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4602             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4603             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4604             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4605             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4606             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4607             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4608             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4609         16  PB-FATAL-FLAG                PIC X.
  4610             88  PB-FATAL-ERRORS              VALUE 'X'.
  4611         16  PB-FORCE-ER-CD               PIC X.
  4612             88  PB-FORCE-ERRORS              VALUE 'F'.
  4613             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4614         16  PB-WARN-ER-CD                PIC X.
  4615             88  PB-WARNING-ERRORS            VALUE 'W'.
  4616         16  FILLER                       PIC X.
  4617         16  PB-OUT-BAL-CD                PIC X.
  4618             88  PB-OUT-OF-BAL                VALUE 'O'.
  4619         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4620         16  PB-AH-OVERRIDE-L1            PIC X.
  4621         16  PB-INPUT-DT                  PIC XX.
  4622         16  PB-INPUT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  87
* EL050.cbl
  4623         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4624         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4625         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4626         16  PB-LF-EARNING-METHOD         PIC X.
  4627         16  PB-AH-EARNING-METHOD         PIC X.
  4628         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4629         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4630         16  PB-REIN-CD                   PIC XXX.
  4631         16  PB-LF-REFUND-TYPE            PIC X.
  4632         16  PB-AH-REFUND-TYPE            PIC X.
  4633         16  PB-ACCT-EFF-DT               PIC XX.
  4634         16  PB-ACCT-EXP-DT               PIC XX.
  4635         16  PB-COMPANY-ID                PIC X(3).
  4636         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4637         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4638         16  PB-SV-CARRIER                PIC X.
  4639         16  PB-SV-GROUPING               PIC X(6).
  4640         16  PB-SV-STATE                  PIC XX.
  4641         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4642         16  PB-GA-BILLING-INFO.
  4643             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4644                                          PIC XX.
  4645         16  PB-SV-REMIT-TO  REDEFINES
  4646             PB-GA-BILLING-INFO           PIC X(10).
  4647         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4648         16  PB-I-LOAN-OFFICER            PIC X(5).
  4649         16  PB-I-VIN                     PIC X(17).
  4650
  4651         16  FILLER                       PIC X(04).
  4652         16  IMNET-BYPASS-SW              PIC X.
  4653
  4654******************************************************************
  4655*                COMMON EDIT ERRORS                              *
  4656******************************************************************
  4657
  4658     12  PB-COMMON-ERRORS.
  4659         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4660                                           PIC S9(4)     COMP.
  4661
  4662******************************************************************
  4663
  4664* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4665*    COPY ELC50W1.
  4666******************************************************************
  4667*                                                                *
  4668*                                                                *
  4669*                             ELC50W1                            *
  4670*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4671*                            VMOD=2.004                          *
  4672*                                                                *
  4673*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4674*                                                                *
  4675*                                                                *
  4676******************************************************************
  4677
  4678     12  WK-WORK-AREA.
  4679         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4680         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  88
* EL050.cbl
  4681         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4682         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4683         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4684         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4685         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4686         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4687         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4688         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4689         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4690         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4691         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4692         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4693         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4694         16  WK-CREDIT-EDIT-CONTROLS.
  4695             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4696             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4697             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4698             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4699             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4700             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4701         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4702         16  WK-SAVE-REIN-DATA.
  4703             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4704             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4705             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4706         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4707             88  ENTRY-FROM-EL6311       VALUE '6'.
  4708         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4709         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4710     12  WK-RECORD-ADDRESSES.
  4711         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4712         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4713         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4714         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4715         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4716         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4717         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4718         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4719     12  WK-OVER-SHORT-AREA.
  4720         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4721         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4722         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4723             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4724         16  FILLER                   PIC X(5) VALUE SPACES.
  4725
  4726*    COPY ELCEDITC.
  4727******************************************************************
  4728*                                                                *
  4729*                                                                *
  4730*                            ELCEDITC                            *
  4731*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4732*                            VMOD=2.012                          *
  4733*                                                                *
  4734*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4735*                     EL6313, EL050 AND EL517.                   *
  4736*                                                                *
  4737******************************************************************
  4738******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  89
* EL050.cbl
  4739*                   C H A N G E   L O G
  4740*
  4741* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4742*-----------------------------------------------------------------
  4743*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4744* EFFECTIVE    NUMBER
  4745*-----------------------------------------------------------------
  4746* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4747******************************************************************
  4748
  4749     12  EDIT-CRITERIA-DATA.
  4750         16  EC-CO-MONTH-END-DT       PIC XX.
  4751         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4752         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4753         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4754         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4755         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4756         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4757         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4758         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4759         16  EC-CO-REM-TERM-CALC      PIC X.
  4760               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4761               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4762               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4763               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4764
  4765         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4766               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4767               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4768               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4769               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4770               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4771               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4772               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4773               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4774               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4775               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4776
  4777         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4778               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4779               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4780               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4781               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4782               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4783               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4784               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4785               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4786
  4787         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4788                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4789                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4790
  4791         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4792                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4793                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4794                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4795                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4796                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  90
* EL050.cbl
  4797                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4798                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4799                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4800
  4801         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4802               88  EC-BR-REDUCING                   VALUE 'R'.
  4803               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4804
  4805         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4806         16  EC-BR-LF-DESC             PIC X(10).
  4807         16  EC-BR-AH-DESC             PIC X(10).
  4808         16  EC-BR-LF-COMMENT          PIC X(10).
  4809         16  EC-BR-AH-COMMENT          PIC X(10).
  4810
  4811         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4812               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4813               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4814               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4815               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4816
  4817         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4818               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4819               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4820               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4821               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4822
  4823         16  EC-BR-LF-REFUND-CALC      PIC X.
  4824                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4825                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4826                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4827                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4828                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4829                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4830                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4831
  4832         16  EC-BR-AH-REFUND-CALC      PIC X.
  4833                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4834                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4835                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4836                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4837                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4838                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4839                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4840                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4841
  4842         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4843                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4844                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4845                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4846
  4847         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4848                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4849                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4850                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4851
  4852         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4853         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4854         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  91
* EL050.cbl
  4855         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4856
  4857         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4858         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4859                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4860                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4861                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4862                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4863
  4864         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4865               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4866               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4867               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4868               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4869               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4870
  4871         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4872               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4873               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4874               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4875               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4876               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4877
  4878         16  EC-ST-LF-REFUND-CALC      PIC X.
  4879                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4880                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4881                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4882                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4883                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4884                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4885                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4886                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4887
  4888         16  EC-ST-AH-REFUND-CALC      PIC X.
  4889                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4890                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4891                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4892                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4893                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4894                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4895                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4896                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4897
  4898         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4899         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4900         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4901         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4902         16  EC-AM-EXPIRATION-DT       PIC XX.
  4903         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4904         16  EC-AM-CLASS-CD            PIC XX.
  4905         16  EC-AM-LF-DEVIATION        PIC XXX.
  4906         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4907         16  EC-AM-AH-DEVIATION        PIC XXX.
  4908         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4909         16  EC-AM-PHONE-NO            PIC X(10).
  4910
  4911         16  EC-AM-LF-REFUND-CALC      PIC X.
  4912                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  92
* EL050.cbl
  4913                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4914                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4915                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4916                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4917                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4918                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4919
  4920         16  EC-AM-AH-REFUND-CALC      PIC X.
  4921                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4922                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4923                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4924                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4925                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4926                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4927                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4928
  4929         16  EC-AM-BEN-I-G-CD          PIC X.
  4930                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4931                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4932                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4933
  4934         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4935         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4936         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4937         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4938         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4939         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4940         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4941         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4942         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4943
  4944         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4945         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4946         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4947         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4948         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4949         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4950         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4951         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4952         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4953         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4954         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4955         16  EC-RT-LF-NSP-ST           PIC XX.
  4956         16  EC-RT-AH-NSP-ST           PIC XX.
  4957         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4958         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4959
  4960         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4961             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4962                                             'M' '5' '9' '2'.
  4963             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4964             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4965             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4966             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4967             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4968             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4969             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4970             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  93
* EL050.cbl
  4971             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4972             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4973
  4974         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4975             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4976                                             'M' '5' '9' '2'.
  4977             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4978             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4979             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4980             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4981             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4982             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4983             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4984             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4985             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4986             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4987
  4988         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4989         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4990         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4991         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4992         16  EC-CM-DEATH-DT            PIC XX.
  4993
  4994*DMD CUSTOM CODING FIELDS BELOW
  4995*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4996         16  EC-BR-DMD-RATING-SW       PIC X.
  4997                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4998                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4999                 88  NO-DMD-RATING               VALUE 'N'.
  5000
  5001         16  EC-NEW-CERT               PIC X(11).
  5002         16  EC-NEW-STATE              PIC XX.
  5003         16  FILLER                    PIC X.
  5004*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  5005         16  OVER-SHORT-EDIT-FIELDS.
  5006             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5007             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5008             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5009             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5010             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  5011             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5012             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5013             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5014             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5015         16  FILLER                    PIC X(71).
  5016******************************************************************
  5017
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  94
* EL050.cbl
  5019*    COPY ELCDIFRD.
  5020******************************************************************
  5021*                                                                *
  5022*                                                                *
  5023*                            ELCDIFRD.                           *
  5024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5025*                            VMOD=2.004                          *
  5026*                                                                *
  5027*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  5028*                                                                *
  5029******************************************************************
  5030*
  5031  01  WS-DIFFERENCE-CALCULATION.
  5032        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  5033        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  5034        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  5035        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  5036        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  5037        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5038        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5039        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5040        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5041        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5042        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5043
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  95
* EL050.cbl
  5045****************************************************************
  5046*
  5047* Copyright (c) 2007-2013 Dell Inc.
  5048* All rights reserved.
  5049*
  5050****************************************************************
  5051 01  DFHEIV.
  5052   02  DFHEIV0               PIC X(35).
  5053   02  DFHEIV1               PIC X(08).
  5054   02  DFHEIV2               PIC X(08).
  5055   02  DFHEIV3               PIC X(08).
  5056   02  DFHEIV4               PIC X(06).
  5057   02  DFHEIV5               PIC X(04).
  5058   02  DFHEIV6               PIC X(04).
  5059   02  DFHEIV7               PIC X(02).
  5060   02  DFHEIV8               PIC X(02).
  5061   02  DFHEIV9               PIC X(01).
  5062   02  DFHEIV10              PIC S9(7) COMP-3.
  5063   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5064   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5065   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5066   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5067   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5068   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5069   02  DFHEIV17              PIC X(04).
  5070   02  DFHEIV18              PIC X(04).
  5071   02  DFHEIV19              PIC X(04).
  5072   02  DFHEIV20              USAGE IS POINTER.
  5073   02  DFHEIV21              USAGE IS POINTER.
  5074   02  DFHEIV22              USAGE IS POINTER.
  5075   02  DFHEIV23              USAGE IS POINTER.
  5076   02  DFHEIV24              USAGE IS POINTER.
  5077   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5078   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5079   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5080   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5081   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5082   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5083   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5084   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5085   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5086   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5087   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5088   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5089   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5090   02  FILLER                PIC X(02).
  5091   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5092   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5093   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5094   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5095   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5096   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5097   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5098 LINKAGE  SECTION.
  5099*****************************************************************
  5100*                                                               *
  5101* Copyright (c) 2007-2013 Dell Inc.                             *
  5102* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  96
* EL050.cbl
  5103*                                                               *
  5104*****************************************************************
  5105 01  dfheiblk.
  5106     02  eibtime          pic s9(7) comp-3.
  5107     02  eibdate          pic s9(7) comp-3.
  5108     02  eibtrnid         pic x(4).
  5109     02  eibtaskn         pic s9(7) comp-3.
  5110     02  eibtrmid         pic x(4).
  5111     02  dfheigdi         pic s9(4) comp.
  5112     02  eibcposn         pic s9(4) comp.
  5113     02  eibcalen         pic s9(4) comp.
  5114     02  eibaid           pic x(1).
  5115     02  eibfiller1       pic x(1).
  5116     02  eibfn            pic x(2).
  5117     02  eibfiller2       pic x(2).
  5118     02  eibrcode         pic x(6).
  5119     02  eibfiller3       pic x(2).
  5120     02  eibds            pic x(8).
  5121     02  eibreqid         pic x(8).
  5122     02  eibrsrce         pic x(8).
  5123     02  eibsync          pic x(1).
  5124     02  eibfree          pic x(1).
  5125     02  eibrecv          pic x(1).
  5126     02  eibsend          pic x(1).
  5127     02  eibatt           pic x(1).
  5128     02  eibeoc           pic x(1).
  5129     02  eibfmh           pic x(1).
  5130     02  eibcompl         pic x(1).
  5131     02  eibsig           pic x(1).
  5132     02  eibconf          pic x(1).
  5133     02  eiberr           pic x(1).
  5134     02  eibrldbk         pic x(1).
  5135     02  eiberrcd         pic x(4).
  5136     02  eibsynrb         pic x(1).
  5137     02  eibnodat         pic x(1).
  5138     02  eibfiller5       pic x(2).
  5139     02  eibresp          pic s9(8) comp.
  5140     02  eibresp2         pic s9(8) comp.
  5141     02  dfheigdj         pic s9(4) comp.
  5142     02  dfheigdk         pic s9(4) comp.
  5143
  5144 01  DFHCOMMAREA                   PIC X(1036).
  5145
  5146*01 PARMLIST .
  5147*    02  FILLER                    PIC S9(8)   COMP.
  5148*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5149*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5150*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5151*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5152*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5153*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5154*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5155
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  97
* EL050.cbl
  5157*    COPY ELCCNTL.
  5158******************************************************************
  5159*                                                                *
  5160*                                                                *
  5161*                            ELCCNTL.                            *
  5162*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5163*                            VMOD=2.059                          *
  5164*                                                                *
  5165*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5166*                                                                *
  5167*   FILE TYPE = VSAM,KSDS                                        *
  5168*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5169*                                                                *
  5170*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5171*       ALTERNATE INDEX = NONE                                   *
  5172*                                                                *
  5173*   LOG = YES                                                    *
  5174*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5175******************************************************************
  5176*                   C H A N G E   L O G
  5177*
  5178* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5179*-----------------------------------------------------------------
  5180*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5181* EFFECTIVE    NUMBER
  5182*-----------------------------------------------------------------
  5183* 082503                   PEMA  ADD BENEFIT GROUP
  5184* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5185* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5186* 092705    2005050300006  PEMA  ADD SPP LEASES
  5187* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5188* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5189* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5190* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5191* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5192* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5193* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5194* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5195* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5196* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5197* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5198******************************************************************
  5199*
  5200 01  CONTROL-FILE.
  5201     12  CF-RECORD-ID                       PIC XX.
  5202         88  VALID-CF-ID                        VALUE 'CF'.
  5203
  5204     12  CF-CONTROL-PRIMARY.
  5205         16  CF-COMPANY-ID                  PIC XXX.
  5206         16  CF-RECORD-TYPE                 PIC X.
  5207             88  CF-COMPANY-MASTER              VALUE '1'.
  5208             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5209             88  CF-STATE-MASTER                VALUE '3'.
  5210             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5211             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5212             88  CF-CARRIER-MASTER              VALUE '6'.
  5213             88  CF-MORTALITY-MASTER            VALUE '7'.
  5214             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  98
* EL050.cbl
  5215             88  CF-TERMINAL-MASTER             VALUE '9'.
  5216             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5217             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5218             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5219             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5220             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5221             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5222             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5223             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5224             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5225         16  CF-ACCESS-CD-GENL              PIC X(4).
  5226         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5227             20  CF-PROCESSOR               PIC X(4).
  5228         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5229             20  CF-STATE-CODE              PIC XX.
  5230             20  FILLER                     PIC XX.
  5231         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5232             20  FILLER                     PIC XX.
  5233             20  CF-HI-BEN-IN-REC           PIC XX.
  5234         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5235             20  FILLER                     PIC XXX.
  5236             20  CF-CARRIER-CNTL            PIC X.
  5237         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5238             20  FILLER                     PIC XX.
  5239             20  CF-HI-TYPE-IN-REC          PIC 99.
  5240         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5241             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5242                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5243             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5244             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5245         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5246             20  FILLER                     PIC X.
  5247             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5248         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5249             20  FILLER                     PIC XX.
  5250             20  CF-MORTGAGE-PLAN           PIC XX.
  5251         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5252
  5253     12  CF-LAST-MAINT-DT                   PIC XX.
  5254     12  CF-LAST-MAINT-BY                   PIC X(4).
  5255     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5256
  5257     12  CF-RECORD-BODY                     PIC X(728).
  5258
  5259
  5260****************************************************************
  5261*             COMPANY MASTER RECORD                            *
  5262****************************************************************
  5263
  5264     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5265         16  CF-COMPANY-ADDRESS.
  5266             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5267             20  CF-CL-IN-CARE-OF           PIC X(30).
  5268             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5269             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5270             20  CF-CL-CITY-STATE           PIC X(30).
  5271             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5272             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  99
* EL050.cbl
  5273         16  CF-COMPANY-CD                  PIC X.
  5274         16  CF-COMPANY-PASSWORD            PIC X(8).
  5275         16  CF-SECURITY-OPTION             PIC X.
  5276             88  ALL-SECURITY                   VALUE '1'.
  5277             88  COMPANY-VERIFY                 VALUE '2'.
  5278             88  PROCESSOR-VERIFY               VALUE '3'.
  5279             88  NO-SECURITY                    VALUE '4'.
  5280             88  ALL-BUT-TERM                   VALUE '5'.
  5281         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5282             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5283         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5284             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5285         16  CF-INFORCE-LOCATION            PIC X.
  5286             88  CERTS-ARE-ONLINE               VALUE '1'.
  5287             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5288             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5289         16  CF-LOWER-CASE-LETTERS          PIC X.
  5290         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5291             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5292             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5293             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5294             88  CF-ACCNT-CNTL                  VALUE '3'.
  5295             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5296
  5297         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5298         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5299
  5300         16  CF-LGX-CREDIT-USER             PIC X.
  5301             88  CO-IS-NOT-USER                 VALUE 'N'.
  5302             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5303
  5304         16 CF-CREDIT-CALC-CODES.
  5305             20  CF-CR-REM-TERM-CALC PIC X.
  5306               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5307               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5308               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5309               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5310               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5311               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5312               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5313             20  CF-CR-R78-METHOD           PIC X.
  5314               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5315               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5316
  5317         16  CF-CLAIM-CONTROL-COUNTS.
  5318             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5319                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5320
  5321             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5322                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5323
  5324             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5325                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5326
  5327             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5328                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5329
  5330         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 100
* EL050.cbl
  5331
  5332         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5333             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5334             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5335             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5336             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5337                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5338                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5339             20  CF-CO-PREM-REJECT-SW       PIC X.
  5340                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5341                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5342             20  CF-CO-REF-REJECT-SW        PIC X.
  5343                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5344                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5345
  5346         16  CF-CO-REPORTING-DT             PIC XX.
  5347         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5348         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5349           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5350           88  CF-CO-MONTH-END                  VALUE '1'.
  5351
  5352         16  CF-LGX-CLAIM-USER              PIC X.
  5353             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5354             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5355
  5356         16  CF-CREDIT-EDIT-CONTROLS.
  5357             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5358             20  CF-MIN-AGE                 PIC 99.
  5359             20  CF-DEFAULT-AGE             PIC 99.
  5360             20  CF-MIN-TERM                PIC S999      COMP-3.
  5361             20  CF-MAX-TERM                PIC S999      COMP-3.
  5362             20  CF-DEFAULT-SEX             PIC X.
  5363             20  CF-JOINT-AGE-INPUT         PIC X.
  5364                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5365             20  CF-BIRTH-DATE-INPUT        PIC X.
  5366                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5367             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5368                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5369                 88  CF-ZERO-CARRIER            VALUE '1'.
  5370                 88  CF-ZERO-GROUPING           VALUE '2'.
  5371                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5372             20  CF-EDIT-SW                 PIC X.
  5373                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5374             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5375             20  CF-CR-PR-METHOD            PIC X.
  5376               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5377               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5378             20  FILLER                     PIC X.
  5379
  5380         16  CF-CREDIT-MISC-CONTROLS.
  5381             20  CF-REIN-TABLE-SW           PIC X.
  5382                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5383             20  CF-COMP-TABLE-SW           PIC X.
  5384                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5385             20  CF-EXPERIENCE-RETENTION-AGE
  5386                                            PIC S9        COMP-3.
  5387             20  CF-CONVERSION-DT           PIC XX.
  5388             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 101
* EL050.cbl
  5389             20  CF-RUN-FREQUENCY-SW        PIC X.
  5390                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5391                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5392
  5393             20  CF-CR-CHECK-NO-CONTROL.
  5394                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5395                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5396                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5397                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5398                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5399                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5400
  5401                 24  CF-CR-CHECK-COUNT       REDEFINES
  5402                     CF-CR-CHECK-COUNTER      PIC X(4).
  5403
  5404                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5405                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5406
  5407                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5408                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5409                 24  CF-MAIL-PROCESSING       PIC X.
  5410                     88  MAIL-PROCESSING          VALUE 'Y'.
  5411
  5412         16  CF-MISC-SYSTEM-CONTROL.
  5413             20  CF-SYSTEM-C                 PIC X.
  5414                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5415             20  CF-SYSTEM-D                 PIC X.
  5416                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5417             20  CF-SOC-SEC-NO-SW            PIC X.
  5418                 88  SOC-SEC-NO-USED             VALUE '1'.
  5419             20  CF-MEMBER-NO-SW             PIC X.
  5420                 88  MEMBER-NO-USED              VALUE '1'.
  5421             20  CF-TAX-ID-NUMBER            PIC X(11).
  5422             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5423             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5424                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5425                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5426                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5427                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5428             20  CF-SYSTEM-E                 PIC X.
  5429                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5430
  5431         16  CF-LGX-LIFE-USER               PIC X.
  5432             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5433             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5434
  5435         16  CF-CR-MONTH-END-DT             PIC XX.
  5436
  5437         16  CF-FILE-MAINT-DATES.
  5438             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5439                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5440             20  CF-LAST-BATCH       REDEFINES
  5441                 CF-LAST-BATCH-NO               PIC X(4).
  5442             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5443             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5444             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5445             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5446             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 102
* EL050.cbl
  5447             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5448             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5449             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5450             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5451             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5452
  5453         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5454         16  FILLER                         PIC X.
  5455
  5456         16  CF-ALT-MORT-CODE               PIC X(4).
  5457         16  CF-MEMBER-CAPTION              PIC X(10).
  5458
  5459         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5460             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5461             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5462             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5463             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5464             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5465
  5466         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5467
  5468         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5469         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5470         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5471         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5472
  5473         16  CF-AH-OVERRIDE-L1              PIC X.
  5474         16  CF-AH-OVERRIDE-L2              PIC XX.
  5475         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5476         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5477
  5478         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5479         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5480
  5481         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5482         16  CF-AR-LAST-EL860-DT            PIC XX.
  5483         16  CF-MP-MONTH-END-DT             PIC XX.
  5484
  5485         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5486         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5487             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5488
  5489         16  CF-AR-MONTH-END-DT             PIC XX.
  5490
  5491         16  CF-CRDTCRD-USER                PIC X.
  5492             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5493             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5494
  5495         16  CF-CC-MONTH-END-DT             PIC XX.
  5496
  5497         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5498
  5499         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5500             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5501             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5502             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5503         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5504         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 103
* EL050.cbl
  5505         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5506         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5507             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5508             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5509         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5510         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5511         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5512             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5513         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5514
  5515         16  CF-CL-ZIP-CODE.
  5516             20  CF-CL-ZIP-PRIME.
  5517                 24  CF-CL-ZIP-1ST          PIC X.
  5518                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5519                 24  FILLER                 PIC X(4).
  5520             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5521         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5522             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5523             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5524             20  FILLER                     PIC XXX.
  5525
  5526         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5527         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5528         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5529         16  CF-CO-OPTION-START-DATE        PIC XX.
  5530         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5531           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5532                                                      '3' '4'.
  5533           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5534           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5535           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5536           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5537           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5538           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5539
  5540         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5541
  5542         16  CF-PAYMENT-APPROVAL-LEVELS.
  5543             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5544             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5545             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5546             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5547             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5548             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5549
  5550         16  CF-END-USER-REPORTING-USER     PIC X.
  5551             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5552             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5553
  5554         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5555             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5556             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5557
  5558         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5559
  5560         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5561         16  FILLER                         PIC X.
  5562
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 104
* EL050.cbl
  5563         16  CF-CREDIT-ARCHIVE-CNTL.
  5564             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5565             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5566             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5567
  5568         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5569
  5570         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5571             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5572             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5573
  5574         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5575             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5576             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5577
  5578         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5579
  5580         16  CF-CO-ACH-ID-CODE              PIC  X.
  5581             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5582             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5583             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5584         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5585         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5586         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5587         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5588         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5589         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5590         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5591         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5592         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5593                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5594         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5595                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5596
  5597         16  CF-CO-OVER-SHORT.
  5598             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5599             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5600
  5601*         16  FILLER                         PIC X(102).
  5602         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5603             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5604             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5605
  5606         16  CF-AH-APPROVAL-DAYS.
  5607             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5608             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5609             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5610             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5611
  5612         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5613
  5614         16  CF-APPROV-LEV-5.
  5615             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5616             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5617             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5618
  5619         16  FILLER                         PIC X(68).
  5620****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 105
* EL050.cbl
  5621*             PROCESSOR/USER RECORD                            *
  5622****************************************************************
  5623
  5624     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5625         16  CF-PROCESSOR-NAME              PIC X(30).
  5626         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5627         16  CF-PROCESSOR-TITLE             PIC X(26).
  5628         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5629                 88  MESSAGE-YES                VALUE 'Y'.
  5630                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5631
  5632*****************************************************
  5633****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5634****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5635****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5636****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5637*****************************************************
  5638
  5639         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5640             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5641             20  CF-APPLICATION-FORCE       PIC X.
  5642             20  CF-INDIVIDUAL-APP.
  5643                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5644                     28  CF-BROWSE-APP      PIC X.
  5645                     28  CF-UPDATE-APP      PIC X.
  5646
  5647         16  CF-CURRENT-TERM-ON             PIC X(4).
  5648         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5649             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5650             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5651             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5652             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5653             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5654             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5655             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5656         16  CF-PROCESSOR-CARRIER           PIC X.
  5657             88  NO-CARRIER-SECURITY            VALUE ' '.
  5658         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5659             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5660         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5661             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5662         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5663             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5664
  5665         16  CF-PROC-SYS-ACCESS-SW.
  5666             20  CF-PROC-CREDIT-CLAIMS-SW.
  5667                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5668                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5669                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5670                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5671             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5672                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5673                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5674             20  CF-PROC-LIFE-GNRLDGR-SW.
  5675                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5676                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5677                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5678                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 106
* EL050.cbl
  5679             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5680                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5681                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5682         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5683             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5684             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5685         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5686
  5687         16  CF-APPROVAL-LEVEL                  PIC X.
  5688             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5689             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5690             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5691             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5692             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5693
  5694         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5695
  5696         16  CF-LANGUAGE-TYPE                   PIC X.
  5697             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5698             88  CF-LANG-IS-FR                      VALUE 'F'.
  5699
  5700         16  CF-CSR-IND                         PIC X.
  5701         16  FILLER                             PIC X(239).
  5702
  5703****************************************************************
  5704*             PROCESSOR/REMINDERS RECORD                       *
  5705****************************************************************
  5706
  5707     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5708         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5709             20  CF-START-REMIND-DT         PIC XX.
  5710             20  CF-END-REMIND-DT           PIC XX.
  5711             20  CF-REMINDER-TEXT           PIC X(50).
  5712         16  FILLER                         PIC X(296).
  5713
  5714
  5715****************************************************************
  5716*             STATE MASTER RECORD                              *
  5717****************************************************************
  5718
  5719     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5720         16  CF-STATE-ABBREVIATION          PIC XX.
  5721         16  CF-STATE-NAME                  PIC X(25).
  5722         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5723         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5724             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5725             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5726             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5727             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5728                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5729                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5730             20  CF-ST-PREM-REJECT-SW       PIC X.
  5731                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5732                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5733             20  CF-ST-REF-REJECT-SW        PIC X.
  5734                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5735                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5736         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 107
* EL050.cbl
  5737         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5738         16  CF-ST-REFUND-RULES.
  5739             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5740             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5741             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5742         16  CF-ST-FST-PMT-EXTENSION.
  5743             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5744             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5745                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5746                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5747                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5748                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5749         16  CF-ST-STATE-CALL.
  5750             20  CF-ST-CALL-UNEARNED        PIC X.
  5751             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5752             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5753         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5754             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5755             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5756         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5757         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5758         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5759         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5760         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5761         16  FILLER                         PIC X.
  5762         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5763             20  CF-ST-BENEFIT-CD           PIC XX.
  5764             20  CF-ST-BENEFIT-KIND         PIC X.
  5765                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5766                 88  CF-ST-AH-KIND              VALUE 'A'.
  5767             20  CF-ST-REM-TERM-CALC        PIC X.
  5768                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5769                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5770                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5771                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5772                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5773                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5774                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5775                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5776
  5777             20  CF-ST-REFUND-CALC          PIC X.
  5778                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5779                 88  ST-REFD-BY-R78             VALUE '1'.
  5780                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5781                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5782                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5783                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5784                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5785                 88  ST-REFD-UTAH               VALUE '7'.
  5786                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5787                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5788                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5789
  5790             20  CF-ST-EARNING-CALC         PIC X.
  5791                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5792                 88  ST-EARN-BY-R78             VALUE '1'.
  5793                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5794                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 108
* EL050.cbl
  5795                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5796                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5797                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5798                 88  ST-EARN-MEAN               VALUE '8'.
  5799                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5800
  5801             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5802                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5803                 88  ST-OVRD-BY-R78             VALUE '1'.
  5804                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5805                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5806                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5807                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5808                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5809                 88  ST-OVRD-MEAN               VALUE '8'.
  5810                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5811             20  cf-st-extra-periods        pic 9.
  5812*            20  FILLER                     PIC X.
  5813
  5814         16  CF-ST-COMMISSION-CAPS.
  5815             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5816             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5817             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5818             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5819         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5820                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5821                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5822                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5823
  5824         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5825
  5826         16  CF-ST-STATUTORY-INTEREST.
  5827             20  CF-ST-STAT-DATE-FROM       PIC X.
  5828                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5829                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5830             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5831             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5832             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5833             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5834             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5835
  5836         16  CF-ST-OVER-SHORT.
  5837             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5838             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5839
  5840         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5841
  5842         16  CF-ST-RT-CALC                  PIC X.
  5843
  5844         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5845         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5846         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5847         16  CF-ST-RF-LR-CALC               PIC X.
  5848         16  CF-ST-RF-LL-CALC               PIC X.
  5849         16  CF-ST-RF-LN-CALC               PIC X.
  5850         16  CF-ST-RF-AH-CALC               PIC X.
  5851         16  CF-ST-RF-CP-CALC               PIC X.
  5852*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 109
* EL050.cbl
  5853*CIDMOD         16  FILLER                         PIC X(192).
  5854         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5855             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5856         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5857         16  CF-ST-VFY-2ND-BENE             PIC X.
  5858         16  CF-ST-CAUSAL-STATE             PIC X.
  5859         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5860         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5861         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5862             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5863         16  CF-ST-NET-ONLY-STATE           PIC X.
  5864             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5865         16  cf-commission-cap-required     pic x.
  5866         16  CF-ST-GA-COMMISSION-CAPS.
  5867             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5868             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5869             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5870             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5871         16  CF-ST-TOT-COMMISSION-CAPS.
  5872             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5873             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5874             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5875             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5876         16  FILLER                         PIC X(156).
  5877
  5878****************************************************************
  5879*             BENEFIT MASTER RECORD                            *
  5880****************************************************************
  5881
  5882     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5883         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5884             20  CF-BENEFIT-CODE            PIC XX.
  5885             20  CF-BENEFIT-NUMERIC  REDEFINES
  5886                 CF-BENEFIT-CODE            PIC XX.
  5887             20  CF-BENEFIT-ALPHA           PIC XXX.
  5888             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5889             20  CF-BENEFIT-COMMENT         PIC X(10).
  5890
  5891             20  CF-LF-COVERAGE-TYPE        PIC X.
  5892                 88  CF-REDUCING                VALUE 'R'.
  5893                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5894
  5895             20  CF-SPECIAL-CALC-CD         PIC X.
  5896                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5897                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5898                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5899                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5900                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5901                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5902                 88  CF-FARM-PLAN               VALUE 'F'.
  5903                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5904                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5905                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5906                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5907                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5908                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5909                 88  CF-PRUDENTIAL              VALUE 'P'.
  5910                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 110
* EL050.cbl
  5911                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5912                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5913                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5914                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5915                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5916
  5917             20  CF-JOINT-INDICATOR         PIC X.
  5918                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5919
  5920*            20  FILLER                     PIC X(12).
  5921             20  cf-maximum-benefits        pic s999 comp-3.
  5922             20  FILLER                     PIC X(09).
  5923             20  CF-BENEFIT-CATEGORY        PIC X.
  5924             20  CF-LOAN-TYPE               PIC X(8).
  5925
  5926             20  CF-CO-REM-TERM-CALC        PIC X.
  5927                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5928                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5929                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5930                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5931                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5932
  5933             20  CF-CO-EARNINGS-CALC        PIC X.
  5934                 88  CO-EARN-BY-R78             VALUE '1'.
  5935                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5936                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5937                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5938                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5939                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5940                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5941                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5942
  5943             20  CF-CO-REFUND-CALC          PIC X.
  5944                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5945                 88  CO-REFD-BY-R78             VALUE '1'.
  5946                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5947                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5948                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5949                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5950                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5951                 88  CO-REFD-MEAN               VALUE '8'.
  5952                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5953                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5954                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5955
  5956             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5957                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5958                 88  CO-OVRD-BY-R78             VALUE '1'.
  5959                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5960                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5961                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5962                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5963                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5964                 88  CO-OVRD-MEAN               VALUE '8'.
  5965                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5966
  5967             20  CF-CO-BEN-I-G-CD           PIC X.
  5968                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 111
* EL050.cbl
  5969                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5970                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5971
  5972         16  FILLER                         PIC X(304).
  5973
  5974
  5975****************************************************************
  5976*             CARRIER MASTER RECORD                            *
  5977****************************************************************
  5978
  5979     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5980         16  CF-ADDRESS-DATA.
  5981             20  CF-MAIL-TO-NAME            PIC X(30).
  5982             20  CF-IN-CARE-OF              PIC X(30).
  5983             20  CF-ADDRESS-LINE-1          PIC X(30).
  5984             20  CF-ADDRESS-LINE-2          PIC X(30).
  5985             20  CF-CITY-STATE              PIC X(30).
  5986             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5987             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5988
  5989         16  CF-CLAIM-NO-CONTROL.
  5990             20  CF-CLAIM-NO-METHOD         PIC X.
  5991                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5992                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5993                 88  CLAIM-NO-SEQ               VALUE '3'.
  5994                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5995             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5996                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5997                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5998                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5999
  6000         16  CF-CHECK-NO-CONTROL.
  6001             20  CF-CHECK-NO-METHOD         PIC X.
  6002                 88  CHECK-NO-MANUAL            VALUE '1'.
  6003                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6004                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6005                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6006             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6007                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6008
  6009         16  CF-DOMICILE-STATE              PIC XX.
  6010
  6011         16  CF-EXPENSE-CONTROLS.
  6012             20  CF-EXPENSE-METHOD          PIC X.
  6013                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6014                 88  DOLLARS-PER-PMT            VALUE '2'.
  6015                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6016                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6017             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6018             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6019
  6020         16  CF-CORRESPONDENCE-CONTROL.
  6021             20  CF-LETTER-RESEND-OPT       PIC X.
  6022                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6023                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6024             20  FILLER                     PIC X(4).
  6025
  6026         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 112
* EL050.cbl
  6027             20  CF-MANUAL-SW               PIC X.
  6028                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6029             20  CF-FUTURE-SW               PIC X.
  6030                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6031             20  CF-PTC-SW                  PIC X.
  6032                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6033             20  CF-IBNR-SW                 PIC X.
  6034                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6035             20  CF-PTC-LF-SW               PIC X.
  6036                 88  CF-LF-PTC-USED             VALUE '1'.
  6037             20  CF-CDT-ACCESS-METHOD       PIC X.
  6038                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6039                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6040                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6041             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6042
  6043         16  CF-CLAIM-CALC-METHOD           PIC X.
  6044             88  360-PLUS-MONTHS                VALUE '1'.
  6045             88  365-PLUS-MONTHS                VALUE '2'.
  6046             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6047             88  360-DAILY                      VALUE '4'.
  6048             88  365-DAILY                      VALUE '5'.
  6049
  6050         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6051         16  FILLER                         PIC X(11).
  6052
  6053         16  CF-LIMIT-AMOUNTS.
  6054             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6055             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6056             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6057             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6058             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6059             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6060             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6061             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6062             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6063             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6064
  6065         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6066         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6067         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6068
  6069         16  CF-ZIP-CODE.
  6070             20  CF-ZIP-PRIME.
  6071                 24  CF-ZIP-1ST             PIC X.
  6072                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6073                 24  FILLER                 PIC X(4).
  6074             20  CF-ZIP-PLUS4               PIC X(4).
  6075         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6076             20  CF-CAN-POSTAL-1            PIC XXX.
  6077             20  CF-CAN-POSTAL-2            PIC XXX.
  6078             20  FILLER                     PIC XXX.
  6079
  6080         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6081         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6082         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6083
  6084         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 113
* EL050.cbl
  6085             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6086             88  CF-NO-RATING                   VALUE 'N'.
  6087
  6088         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6089
  6090         16  CF-CARRIER-OVER-SHORT.
  6091             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6092             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6093
  6094         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6095         16  CF-SECPAY-SWITCH               PIC X.
  6096             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6097             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6098         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6099         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6100         16  FILLER                         PIC X(444).
  6101*        16  FILLER                         PIC X(452).
  6102
  6103
  6104****************************************************************
  6105*             MORTALITY MASTER RECORD                          *
  6106****************************************************************
  6107
  6108     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6109         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6110                                INDEXED BY CF-MORT-NDX.
  6111             20  CF-MORT-TABLE              PIC X(5).
  6112             20  CF-MORT-TABLE-TYPE         PIC X.
  6113                 88  CF-MORT-JOINT              VALUE 'J'.
  6114                 88  CF-MORT-SINGLE             VALUE 'S'.
  6115                 88  CF-MORT-COMBINED           VALUE 'C'.
  6116                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6117                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6118             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6119             20  CF-MORT-AGE-METHOD         PIC XX.
  6120                 88  CF-AGE-LAST                VALUE 'AL'.
  6121                 88  CF-AGE-NEAR                VALUE 'AN'.
  6122             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6123             20  CF-MORT-ADJUSTMENT-DIRECTION
  6124                                            PIC X.
  6125                 88  CF-MINUS                   VALUE '-'.
  6126                 88  CF-PLUS                    VALUE '+'.
  6127             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6128             20  CF-MORT-JOINT-CODE         PIC X.
  6129                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6130             20  CF-MORT-PC-Q               PIC X.
  6131                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6132             20  CF-MORT-TABLE-CODE         PIC X(4).
  6133             20  CF-MORT-COMMENTS           PIC X(15).
  6134             20  FILLER                     PIC X(14).
  6135
  6136         16  FILLER                         PIC X(251).
  6137
  6138
  6139****************************************************************
  6140*             BUSSINESS TYPE MASTER RECORD                     *
  6141****************************************************************
  6142
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 114
* EL050.cbl
  6143     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6144* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6145* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6146* AND RECORD 05 IS TYPES 81-99
  6147         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6148             20  CF-BUSINESS-TITLE          PIC  X(19).
  6149             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6150                                            PIC S9V9(4) COMP-3.
  6151             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6152             20  FILLER                     PIC  X.
  6153         16  FILLER                         PIC  X(248).
  6154
  6155
  6156****************************************************************
  6157*             TERMINAL MASTER RECORD                           *
  6158****************************************************************
  6159
  6160     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6161
  6162         16  CF-COMPANY-TERMINALS.
  6163             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6164                                  PIC X(4).
  6165         16  FILLER               PIC X(248).
  6166
  6167
  6168****************************************************************
  6169*             LIFE EDIT MASTER RECORD                          *
  6170****************************************************************
  6171
  6172     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6173         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6174             20  CF-LIFE-CODE-IN            PIC XX.
  6175             20  CF-LIFE-CODE-OUT           PIC XX.
  6176         16  FILLER                         PIC X(248).
  6177
  6178
  6179****************************************************************
  6180*             AH EDIT MASTER RECORD                            *
  6181****************************************************************
  6182
  6183     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6184         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6185             20  CF-AH-CODE-IN              PIC XXX.
  6186             20  CF-AH-CODE-OUT             PIC XX.
  6187         16  FILLER                         PIC X(248).
  6188
  6189
  6190****************************************************************
  6191*             CREDIBILITY TABLES                               *
  6192****************************************************************
  6193
  6194     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6195         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6196                             INDEXED BY CF-CRDB-NDX.
  6197             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6198             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6199             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6200         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 115
* EL050.cbl
  6201
  6202
  6203****************************************************************
  6204*             REPORT CUSTOMIZATION RECORD                      *
  6205****************************************************************
  6206
  6207     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6208         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6209             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6210             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6211             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6212**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6213****       A T-TRANSFER.                                   ****
  6214             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6215
  6216         16  FILLER                         PIC XX.
  6217
  6218         16  CF-CARRIER-CNTL-OPT.
  6219             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6220                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6221                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6222             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6223                                            PIC X.
  6224         16  CF-GROUP-CNTL-OPT.
  6225             20  CF-GROUP-OPT-SEQ           PIC 9.
  6226                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6227                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6228             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6229                                            PIC X(6).
  6230         16  CF-STATE-CNTL-OPT.
  6231             20  CF-STATE-OPT-SEQ           PIC 9.
  6232                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6233                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6234             20  CF-STATE-SELECT OCCURS 3 TIMES
  6235                                            PIC XX.
  6236         16  CF-ACCOUNT-CNTL-OPT.
  6237             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6238                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6239                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6240             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6241                                            PIC X(10).
  6242         16  CF-BUS-TYP-CNTL-OPT.
  6243             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6244                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6245                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6246             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6247                                            PIC XX.
  6248         16  CF-LF-TYP-CNTL-OPT.
  6249             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6250                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6251                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6252             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6253                                            PIC XX.
  6254         16  CF-AH-TYP-CNTL-OPT.
  6255             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6256                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6257                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6258             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 116
* EL050.cbl
  6259                                            PIC XX.
  6260         16  CF-REPTCD1-CNTL-OPT.
  6261             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6262                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6263                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6264             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6265                                            PIC X(10).
  6266         16  CF-REPTCD2-CNTL-OPT.
  6267             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6268                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6269                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6270             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6271                                            PIC X(10).
  6272         16  CF-USER1-CNTL-OPT.
  6273             20  CF-USER1-OPT-SEQ           PIC 9.
  6274                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6275                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6276             20  CF-USER1-SELECT OCCURS 3 TIMES
  6277                                            PIC X(10).
  6278         16  CF-USER2-CNTL-OPT.
  6279             20  CF-USER2-OPT-SEQ           PIC 9.
  6280                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6281                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6282             20  CF-USER2-SELECT OCCURS 3 TIMES
  6283                                            PIC X(10).
  6284         16  CF-USER3-CNTL-OPT.
  6285             20  CF-USER3-OPT-SEQ           PIC 9.
  6286                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6287                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6288             20  CF-USER3-SELECT OCCURS 3 TIMES
  6289                                            PIC X(10).
  6290         16  CF-USER4-CNTL-OPT.
  6291             20  CF-USER4-OPT-SEQ           PIC 9.
  6292                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6293                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6294             20  CF-USER4-SELECT OCCURS 3 TIMES
  6295                                            PIC X(10).
  6296         16  CF-USER5-CNTL-OPT.
  6297             20  CF-USER5-OPT-SEQ           PIC 9.
  6298                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6299                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6300             20  CF-USER5-SELECT OCCURS 3 TIMES
  6301                                            PIC X(10).
  6302         16  CF-REINS-CNTL-OPT.
  6303             20  CF-REINS-OPT-SEQ           PIC 9.
  6304                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6305                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6306             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6307                 24  CF-REINS-PRIME         PIC XXX.
  6308                 24  CF-REINS-SUB           PIC XXX.
  6309
  6310         16  CF-AGENT-CNTL-OPT.
  6311             20  CF-AGENT-OPT-SEQ           PIC 9.
  6312                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6313                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6314             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6315                                            PIC X(10).
  6316
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 117
* EL050.cbl
  6317         16  FILLER                         PIC X(43).
  6318
  6319         16  CF-LOSS-RATIO-SELECT.
  6320             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6321             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6322         16  CF-ENTRY-DATE-SELECT.
  6323             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6324             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6325         16  CF-EFFECTIVE-DATE-SELECT.
  6326             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6327             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6328
  6329         16  CF-EXCEPTION-LIST-IND          PIC X.
  6330             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6331
  6332         16  FILLER                         PIC X(318).
  6333
  6334****************************************************************
  6335*                  EXCEPTION REPORTING RECORD                  *
  6336****************************************************************
  6337
  6338     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6339         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6340             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6341
  6342         16  CF-COMBINED-LIFE-AH-OPT.
  6343             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6344             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6345             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6346             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6347
  6348         16  CF-LIFE-OPT.
  6349             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6350             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6351             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6352             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6353             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6354             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6355             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6356             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6357             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6358             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6359
  6360         16  CF-AH-OPT.
  6361             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6362             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6363             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6364             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6365             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6366             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6367             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6368             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6369             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6370             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6371
  6372         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6373             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6374             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 118
* EL050.cbl
  6375             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6376
  6377         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6378
  6379         16  FILLER                         PIC X(673).
  6380
  6381
  6382****************************************************************
  6383*             MORTGAGE SYSTEM PLAN RECORD                      *
  6384****************************************************************
  6385
  6386     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6387         16  CF-PLAN-TYPE                   PIC X.
  6388             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6389             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6390             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6391         16  CF-PLAN-ABBREV                 PIC XXX.
  6392         16  CF-PLAN-DESCRIPT               PIC X(10).
  6393         16  CF-PLAN-NOTES                  PIC X(20).
  6394         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6395         16  CF-PLAN-UNDERWRITING.
  6396             20  CF-PLAN-TERM-DATA.
  6397                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6398                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6399             20  CF-PLAN-AGE-DATA.
  6400                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6401                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6402                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6403             20  CF-PLAN-BENEFIT-DATA.
  6404                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6405                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6406                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6407                                            PIC S9(7)V99  COMP-3.
  6408         16  CF-PLAN-POLICY-FORMS.
  6409             20  CF-POLICY-FORM             PIC X(12).
  6410             20  CF-MASTER-APPLICATION      PIC X(12).
  6411             20  CF-MASTER-POLICY           PIC X(12).
  6412         16  CF-PLAN-RATING.
  6413             20  CF-RATE-CODE               PIC X(5).
  6414             20  CF-SEX-RATING              PIC X.
  6415                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6416                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6417             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6418             20  CF-SUB-STD-TYPE            PIC X.
  6419                 88  CF-PCT-OF-PREM            VALUE '1'.
  6420                 88  CF-PCT-OF-BENE            VALUE '2'.
  6421         16  CF-PLAN-PREM-TOLERANCES.
  6422             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6423             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6424         16  CF-PLAN-PYMT-TOLERANCES.
  6425             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6426             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6427         16  CF-PLAN-MISC-DATA.
  6428             20  FILLER                     PIC X.
  6429             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6430             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6431         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6432         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 119
* EL050.cbl
  6433             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6434                                                     '1'.
  6435             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6436                                                     '2'.
  6437         16  CF-MIB-SEARCH-SW               PIC X.
  6438             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6439             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6440             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6441             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6442         16  CF-ALPHA-SEARCH-SW             PIC X.
  6443             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6444             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6445             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6446             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6447             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6448             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6449             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6450             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6451             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6452             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6453                                                     'A' 'B' 'C'
  6454                                                     'X' 'Y' 'Z'.
  6455         16  CF-EFF-DT-RULE-SW              PIC X.
  6456             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6457             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6458             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6459             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6460             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6461         16  FILLER                         PIC X(4).
  6462         16  CF-HEALTH-QUESTIONS            PIC X.
  6463             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6464         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6465         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6466         16  CF-PLAN-SNGL-JNT               PIC X.
  6467             88  CF-COMBINED-PLAN              VALUE 'C'.
  6468             88  CF-JNT-PLAN                   VALUE 'J'.
  6469             88  CF-SNGL-PLAN                  VALUE 'S'.
  6470         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6471         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6472         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6473         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6474         16  CF-RERATE-CNTL                 PIC  X.
  6475             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6476             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6477             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6478             88  CF-AUTO-RECALC                 VALUE '4'.
  6479         16  CF-BENEFIT-TYPE                PIC  X.
  6480             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6481             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6482         16  CF-POLICY-FEE                  PIC S999V99
  6483                                                    COMP-3.
  6484         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6485         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6486         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6487         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6488         16  FILLER                         PIC  X(32).
  6489         16  CF-TERMINATION-FORM            PIC  X(04).
  6490         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 120
* EL050.cbl
  6491         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6492                                                       COMP-3.
  6493         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6494         16  CF-ISSUE-LETTER                PIC  X(4).
  6495         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6496         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6497             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6498             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6499         16  CF-MP-REFUND-CALC              PIC X.
  6500             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6501             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6502             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6503             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6504             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6505             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6506             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6507             88  CF-MP-REFD-MEAN                VALUE '8'.
  6508         16  CF-ALT-RATE-CODE               PIC  X(5).
  6509
  6510
  6511         16  FILLER                         PIC X(498).
  6512****************************************************************
  6513*             MORTGAGE COMPANY MASTER RECORD                   *
  6514****************************************************************
  6515
  6516     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6517         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6518         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6519             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6520             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6521             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6522             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6523             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6524
  6525         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6526         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6527         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6528         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6529         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6530
  6531         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6532             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6533         16  CF-MP-RECON-USE-IND            PIC X(1).
  6534             88  CF-MP-USE-RECON             VALUE 'Y'.
  6535         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6536             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6537         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6538             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6539             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6540         16  FILLER                         PIC X(1).
  6541         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6542             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6543         16  CF-MORTG-MIB-VERSION           PIC X.
  6544             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6545             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6546             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6547         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6548             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 121
* EL050.cbl
  6549                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6550             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6551                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6552             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6553                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6554             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6555                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6556             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6557                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6558             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6559                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6560         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6561         16  FILLER                         PIC X(7).
  6562         16  CF-MORTG-DESTINATION-SYMBOL.
  6563             20  CF-MORTG-MIB-COMM          PIC X(5).
  6564             20  CF-MORTG-MIB-TERM          PIC X(5).
  6565         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6566             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6567         16  FILLER                         PIC X(03).
  6568         16  CF-MP-CHECK-NO-CONTROL.
  6569             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6570                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6571                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6572                                                ' ' LOW-VALUES.
  6573                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6574                                               VALUE '3'.
  6575         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6576         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6577         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6578             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6579                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6580             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6581                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6582             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6583                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6584             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6585                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6586             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6587                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6588             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6589                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6590         16  CF-MORTG-BILLING-AREA.
  6591             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6592                                            PIC X.
  6593         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6594         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6595         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6596         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6597             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6598             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6599         16  FILLER                         PIC X.
  6600         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6601             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6602             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6603         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6604         16  FILLER                         PIC X(8).
  6605         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6606         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 122
* EL050.cbl
  6607         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6608         16  CF-ACH-COMPANY-ID.
  6609             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6610                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6611                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6612                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6613             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6614         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6615             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6616         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6617             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6618             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6619         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6620         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6621         16  FILLER                         PIC X(536).
  6622
  6623****************************************************************
  6624*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6625****************************************************************
  6626
  6627     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6628         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6629             20  CF-FEMALE-HEIGHT.
  6630                 24  CF-FEMALE-FT           PIC 99.
  6631                 24  CF-FEMALE-IN           PIC 99.
  6632             20  CF-FEMALE-MIN-WT           PIC 999.
  6633             20  CF-FEMALE-MAX-WT           PIC 999.
  6634         16  FILLER                         PIC X(428).
  6635
  6636     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6637         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6638             20  CF-MALE-HEIGHT.
  6639                 24  CF-MALE-FT             PIC 99.
  6640                 24  CF-MALE-IN             PIC 99.
  6641             20  CF-MALE-MIN-WT             PIC 999.
  6642             20  CF-MALE-MAX-WT             PIC 999.
  6643         16  FILLER                         PIC X(428).
  6644******************************************************************
  6645*             AUTOMATIC ACTIVITY RECORD                          *
  6646******************************************************************
  6647     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6648         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6649             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6650             20  CF-SYS-LETTER-ID           PIC X(04).
  6651             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6652             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6653             20  CF-SYS-RESET-SW            PIC X(01).
  6654             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6655             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6656
  6657         16  FILLER                         PIC X(50).
  6658
  6659         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6660             20  CF-USER-ACTIVE-SW          PIC X(01).
  6661             20  CF-USER-LETTER-ID          PIC X(04).
  6662             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6663             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6664             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 123
* EL050.cbl
  6665             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6666             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6667             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6668
  6669         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 124
* EL050.cbl
  6671*    COPY ERCACCT.
  6672******************************************************************
  6673*                                                                *
  6674*                                                                *
  6675*                            ERCACCT                             *
  6676*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6677*                            VMOD=2.031                          *
  6678*                                                                *
  6679*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6680*                                                                *
  6681*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6682*   VSAM ACCOUNT MASTER FILES.                                   *
  6683*                                                                *
  6684*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6685*                                                                *
  6686*   FILE TYPE = VSAM,KSDS                                        *
  6687*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6688*                                                                *
  6689*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6690*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6691*                                                                *
  6692*   LOG = NO                                                     *
  6693*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6694*                                                                *
  6695*                                                                *
  6696******************************************************************
  6697*                   C H A N G E   L O G
  6698*
  6699* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6700*-----------------------------------------------------------------
  6701*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6702* EFFECTIVE    NUMBER
  6703*-----------------------------------------------------------------
  6704* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6705* 092705    2005050300006  PEMA  ADD SPP LEASES
  6706* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6707* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6708* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6709* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6710* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6711* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6712******************************************************************
  6713
  6714 01  ACCOUNT-MASTER.
  6715     12  AM-RECORD-ID                      PIC XX.
  6716         88  VALID-AM-ID                      VALUE 'AM'.
  6717
  6718     12  AM-CONTROL-PRIMARY.
  6719         16  AM-COMPANY-CD                 PIC X.
  6720         16  AM-MSTR-CNTRL.
  6721             20  AM-CONTROL-A.
  6722                 24  AM-CARRIER            PIC X.
  6723                 24  AM-GROUPING.
  6724                     28 AM-GROUPING-PREFIX PIC XXX.
  6725                     28 AM-GROUPING-PRIME  PIC XXX.
  6726                 24  AM-STATE              PIC XX.
  6727                 24  AM-ACCOUNT.
  6728                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 125
* EL050.cbl
  6729                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6730             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6731                                           PIC X(19).
  6732             20  AM-CNTRL-B.
  6733                 24  AM-EXPIRATION-DT      PIC XX.
  6734                 24  FILLER                PIC X(4).
  6735             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6736                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6737
  6738     12  AM-CONTROL-BY-VAR-GRP.
  6739         16  AM-COMPANY-CD-A1              PIC X.
  6740         16  AM-VG-CARRIER                 PIC X.
  6741         16  AM-VG-GROUPING                PIC X(6).
  6742         16  AM-VG-STATE                   PIC XX.
  6743         16  AM-VG-ACCOUNT                 PIC X(10).
  6744         16  AM-VG-DATE.
  6745             20  AM-VG-EXPIRATION-DT       PIC XX.
  6746             20  FILLER                    PIC X(4).
  6747         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6748                                           PIC 9(11)      COMP-3.
  6749     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6750         16  FILLER                        PIC X(10).
  6751         16  AM-VG-KEY3.
  6752             20  AM-VG3-ACCOUNT            PIC X(10).
  6753             20  AM-VG3-EXP-DT             PIC XX.
  6754         16  FILLER                        PIC X(4).
  6755     12  AM-MAINT-INFORMATION.
  6756         16  AM-LAST-MAINT-DT              PIC XX.
  6757         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6758         16  AM-LAST-MAINT-USER            PIC X(4).
  6759         16  FILLER                        PIC XX.
  6760
  6761     12  AM-EFFECTIVE-DT                   PIC XX.
  6762     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6763
  6764     12  AM-PREV-DATES  COMP-3.
  6765         16  AM-PREV-EXP-DT                PIC 9(11).
  6766         16  AM-PREV-EFF-DT                PIC 9(11).
  6767
  6768     12  AM-REPORT-CODE-1                  PIC X(10).
  6769     12  AM-REPORT-CODE-2                  PIC X(10).
  6770
  6771     12  AM-CITY-CODE                      PIC X(4).
  6772     12  AM-COUNTY-PARISH                  PIC X(6).
  6773
  6774     12  AM-NAME                           PIC X(30).
  6775     12  AM-PERSON                         PIC X(30).
  6776     12  AM-ADDRS                          PIC X(30).
  6777     12  AM-CITY.
  6778         16  AM-ADDR-CITY                  PIC X(28).
  6779         16  AM-ADDR-STATE                 PIC XX.
  6780     12  AM-ZIP.
  6781         16  AM-ZIP-PRIME.
  6782             20  AM-ZIP-PRI-1ST            PIC X.
  6783                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6784             20  FILLER                    PIC X(4).
  6785         16  AM-ZIP-PLUS4                  PIC X(4).
  6786     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 126
* EL050.cbl
  6787         16  AM-CAN-POSTAL-1               PIC XXX.
  6788         16  AM-CAN-POSTAL-2               PIC XXX.
  6789         16  FILLER                        PIC XXX.
  6790     12  AM-TEL-NO.
  6791         16  AM-AREA-CODE                  PIC 999.
  6792         16  AM-TEL-PRE                    PIC 999.
  6793         16  AM-TEL-NBR                    PIC 9(4).
  6794     12  AM-TEL-LOC                        PIC X.
  6795         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6796         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6797
  6798     12  AM-COMM-STRUCTURE.
  6799         16  AM-DEFN-1.
  6800             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6801                 24  AM-AGT.
  6802                     28  AM-AGT-PREFIX     PIC X(4).
  6803                     28  AM-AGT-PRIME      PIC X(6).
  6804                 24  AM-COM-TYP            PIC X.
  6805                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6806                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6807                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6808                 24  AM-RECALC-LV-INDIC    PIC X.
  6809                 24  AM-RETRO-LV-INDIC     PIC X.
  6810                 24  AM-GL-CODES           PIC X.
  6811                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6812                 24  FILLER                PIC X(01).
  6813         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6814             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6815                 24  FILLER                PIC X(11).
  6816                 24  AM-L-COMA             PIC XXX.
  6817                 24  AM-J-COMA             PIC XXX.
  6818                 24  AM-A-COMA             PIC XXX.
  6819                 24  FILLER                PIC X(6).
  6820
  6821     12  AM-COMM-CHANGE-STATUS             PIC X.
  6822         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6823
  6824     12  AM-CSR-CODE                       PIC X(4).
  6825
  6826     12  AM-BILLING-STATUS                 PIC X.
  6827         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6828         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6829     12  AM-AUTO-REFUND-SW                 PIC X.
  6830         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6831         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6832     12  AM-GPCD                           PIC 99.
  6833     12  AM-IG                             PIC X.
  6834         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6835         88  AM-HAS-GROUP                     VALUE '2'.
  6836     12  AM-STATUS                         PIC X.
  6837         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6838         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6839         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6840         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6841         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6842         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6843         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6844         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 127
* EL050.cbl
  6845         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6846         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6847     12  AM-REMIT-TO                       PIC 99.
  6848     12  AM-ID-NO                          PIC X(11).
  6849
  6850     12  AM-CAL-TABLE                      PIC XX.
  6851     12  AM-LF-DEVIATION                   PIC XXX.
  6852     12  AM-AH-DEVIATION                   PIC XXX.
  6853     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6854     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6855     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6856     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6857     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6858     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6859
  6860     12  AM-USER-FIELDS.
  6861         16  AM-FLD-1                      PIC XX.
  6862         16  AM-FLD-2                      PIC XX.
  6863         16  AM-FLD-3                      PIC XX.
  6864         16  AM-FLD-4                      PIC XX.
  6865         16  AM-FLD-5                      PIC XX.
  6866
  6867     12  AM-1ST-PROD-DATE.
  6868         16  AM-1ST-PROD-YR                PIC XX.
  6869         16  AM-1ST-PROD-MO                PIC XX.
  6870         16  AM-1ST-PROD-DA                PIC XX.
  6871     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6872     12  AM-CERTS-PURGED-DATE.
  6873         16  AM-PUR-YR                     PIC XX.
  6874         16  AM-PUR-MO                     PIC XX.
  6875         16  AM-PUR-DA                     PIC XX.
  6876     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6877     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6878     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6879     12  AM-INACTIVE-DATE.
  6880         16  AM-INA-MO                     PIC 99.
  6881         16  AM-INA-DA                     PIC 99.
  6882         16  AM-INA-YR                     PIC 99.
  6883     12  AM-AR-HI-CERT-DATE                PIC XX.
  6884
  6885     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6886     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6887
  6888     12  AM-OB-PAYMENT-MODE                PIC X.
  6889         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6890         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6891         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6892         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6893
  6894     12  AM-AH-ONLY-INDICATOR              PIC X.
  6895         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6896         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6897
  6898     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6899
  6900     12  AM-OVER-SHORT.
  6901         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6902         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 128
* EL050.cbl
  6903
  6904     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6905     12  AM-DCC-CLP-STATE                  PIC XX.
  6906
  6907     12  AM-RECALC-COMM                    PIC X.
  6908     12  AM-RECALC-REIN                    PIC X.
  6909
  6910     12  AM-REI-TABLE                      PIC XXX.
  6911     12  AM-REI-ET-LF                      PIC X.
  6912     12  AM-REI-ET-AH                      PIC X.
  6913     12  AM-REI-PE-LF                      PIC X.
  6914     12  AM-REI-PE-AH                      PIC X.
  6915     12  AM-REI-PRT-ST                     PIC X.
  6916     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6917     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6918     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6919     12  AM-REI-GROUP-A                    PIC X(6).
  6920     12  AM-REI-MORT                       PIC X(4).
  6921     12  AM-REI-PRT-OW                     PIC X.
  6922     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6923     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6924     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6925     12  AM-REI-GROUP-B                    PIC X(6).
  6926
  6927     12  AM-TRUST-TYPE                     PIC X(2).
  6928
  6929     12  AM-EMPLOYER-STMT-USED             PIC X.
  6930     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6931
  6932     12  AM-STD-AH-TYPE                    PIC XX.
  6933     12  AM-EARN-METHODS.
  6934         16  AM-EARN-METHOD-R              PIC X.
  6935             88 AM-REF-RL-R78                 VALUE 'R'.
  6936             88 AM-REF-RL-PR                  VALUE 'P'.
  6937             88 AM-REF-RL-MEAN                VALUE 'M'.
  6938             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6939         16  AM-EARN-METHOD-L              PIC X.
  6940             88 AM-REF-LL-R78                 VALUE 'R'.
  6941             88 AM-REF-LL-PR                  VALUE 'P'.
  6942             88 AM-REF-LL-MEAN                VALUE 'M'.
  6943             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6944         16  AM-EARN-METHOD-A              PIC X.
  6945             88 AM-REF-AH-R78                 VALUE 'R'.
  6946             88 AM-REF-AH-PR                  VALUE 'P'.
  6947             88 AM-REF-AH-MEAN                VALUE 'M'.
  6948             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6949             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6950             88 AM-REF-AH-NET                 VALUE 'N'.
  6951
  6952     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6953     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6954     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6955
  6956     12  AM-RET-Y-N                        PIC X.
  6957     12  AM-RET-P-E                        PIC X.
  6958     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6959     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6960     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 129
* EL050.cbl
  6961     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6962         16  AM-POOL-PRIME                 PIC XXX.
  6963         16  AM-POOL-SUB                   PIC XXX.
  6964     12  AM-RETRO-EARNINGS.
  6965         16  AM-RET-EARN-R                 PIC X.
  6966         16  AM-RET-EARN-L                 PIC X.
  6967         16  AM-RET-EARN-A                 PIC X.
  6968     12  AM-RET-ST-TAX-USE                 PIC X.
  6969         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6970         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6971     12  AM-RETRO-BEG-EARNINGS.
  6972         16  AM-RET-BEG-EARN-R             PIC X.
  6973         16  AM-RET-BEG-EARN-L             PIC X.
  6974         16  AM-RET-BEG-EARN-A             PIC X.
  6975     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6976     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6977
  6978     12  AM-USER-SELECT-OPTIONS.
  6979         16  AM-USER-SELECT-1              PIC X(10).
  6980         16  AM-USER-SELECT-2              PIC X(10).
  6981         16  AM-USER-SELECT-3              PIC X(10).
  6982         16  AM-USER-SELECT-4              PIC X(10).
  6983         16  AM-USER-SELECT-5              PIC X(10).
  6984
  6985     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6986
  6987     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6988
  6989     12  AM-RPT045A-SWITCH                 PIC X.
  6990         88  RPT045A-OFF                   VALUE 'N'.
  6991
  6992     12  AM-INSURANCE-LIMITS.
  6993         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6994         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6995
  6996     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6997         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6998
  6999     12  AM-DISMBR-COVERAGE-SW             PIC X.
  7000         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  7001         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  7002
  7003     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  7004
  7005     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  7006     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  7007     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  7008     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  7009     12  AM-DCC-UEF-STATE                  PIC XX.
  7010     12  FILLER                            PIC XXX.
  7011     12  AM-REPORT-CODE-3                  PIC X(10).
  7012*    12  FILLER                            PIC X(22).
  7013
  7014     12  AM-RESERVE-DATE.
  7015         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  7016         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  7017         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  7018
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 130
* EL050.cbl
  7019     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  7020     12  AM-NOTIFICATION-TYPES.
  7021         16  AM-NOTIF-OF-LETTERS           PIC X.
  7022         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  7023         16  AM-NOTIF-OF-REPORTS           PIC X.
  7024         16  AM-NOTIF-OF-STATUS            PIC X.
  7025
  7026     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  7027         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  7028         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  7029         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  7030         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  7031
  7032     12  AM-BENEFIT-CONTROLS.
  7033         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  7034             20  AM-BENEFIT-CODE           PIC XX.
  7035             20  AM-BENEFIT-TYPE           PIC X.
  7036             20  AM-BENEFIT-REVISION       PIC XXX.
  7037             20  AM-BENEFIT-REM-TERM       PIC X.
  7038             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  7039             20  FILLER                    PIC XX.
  7040         16  FILLER                        PIC X(80).
  7041
  7042     12  AM-TRANSFER-DATA.
  7043         16  AM-TRANSFERRED-FROM.
  7044             20  AM-TRNFROM-CARRIER        PIC X.
  7045             20  AM-TRNFROM-GROUPING.
  7046                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7047                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7048             20  AM-TRNFROM-STATE          PIC XX.
  7049             20  AM-TRNFROM-ACCOUNT.
  7050                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7051                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7052             20  AM-TRNFROM-DTE            PIC XX.
  7053         16  AM-TRANSFERRED-TO.
  7054             20  AM-TRNTO-CARRIER          PIC X.
  7055             20  AM-TRNTO-GROUPING.
  7056                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7057                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7058             20  AM-TRNTO-STATE            PIC XX.
  7059             20  AM-TRNTO-ACCOUNT.
  7060                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7061                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7062             20  AM-TRNTO-DTE              PIC XX.
  7063         16  FILLER                        PIC X(10).
  7064
  7065     12  AM-SAVED-REMIT-TO                 PIC 99.
  7066
  7067     12  AM-COMM-STRUCTURE-SAVED.
  7068         16  AM-DEFN-1-SAVED.
  7069             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7070                 24  AM-AGT-SV             PIC X(10).
  7071                 24  AM-COM-TYP-SV         PIC X.
  7072                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7073                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7074                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7075                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7076                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 131
* EL050.cbl
  7077                 24  AM-GL-CODES-SV        PIC X.
  7078                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7079                 24  FILLER                PIC X.
  7080         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7081             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7082                 24  FILLER                PIC X(11).
  7083                 24  AM-L-COMA-SV          PIC XXX.
  7084                 24  AM-J-COMA-SV          PIC XXX.
  7085                 24  AM-A-COMA-SV          PIC XXX.
  7086                 24  FILLER                PIC X(6).
  7087
  7088     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7089         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7090            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7091            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7092            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7093
  7094     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7095     12  FILLER                            PIC X(120).
  7096
  7097     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7098         16  AM-CONTROL-NAME               PIC X(30).
  7099         16  AM-EXECUTIVE-ONE.
  7100             20  AM-EXEC1-NAME             PIC X(15).
  7101             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7102                                                          COMP-3.
  7103             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7104                                                          COMP-3.
  7105         16  AM-EXECUTIVE-TWO.
  7106             20  AM-EXEC2-NAME             PIC X(15).
  7107             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7108                                                          COMP-3.
  7109             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7110                                                          COMP-3.
  7111
  7112     12  AM-RETRO-ADDITIONAL-DATA.
  7113         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7114         16  AM-RETRO-PREM-P-E             PIC X.
  7115         16  AM-RETRO-CLMS-P-I             PIC X.
  7116         16  AM-RETRO-RET-BRACKET-LF.
  7117             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7118                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7119                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7120             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7121                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7122                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7123             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7124                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7125                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7126         16  AM-RETRO-RET-BRACKET-AH.
  7127             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7128                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7129                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7130                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7131             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7132                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7133                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7134             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 132
* EL050.cbl
  7135                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7136                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7137
  7138     12  AM-COMMENTS.
  7139         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7140
  7141     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7142         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7143         16  AM-FLI-BILLING-CODE           PIC X.
  7144         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7145         16  AM-FLI-UNITED-IDENT           PIC X.
  7146         16  AM-FLI-INTEREST-LOST-DATA.
  7147             20  AM-FLI-BANK-NO            PIC X(5).
  7148             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7149             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7150             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7151         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7152             20  AM-FLI-AGT                PIC X(9).
  7153             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7154             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7155         16  FILLER                        PIC X(102).
  7156
  7157     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7158         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7159             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7160             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7161             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7162             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7163             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7164         16  FILLER                          PIC X(10).
  7165******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 133
* EL050.cbl
  7167*    COPY ERCREIN.
  7168******************************************************************
  7169*                                                                *
  7170*                            ERCREIN                             *
  7171*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7172*                            VMOD=2.010                          *
  7173*                                                                *
  7174*   ONLINE CREDIT SYSTEM                                         *
  7175*                                                                *
  7176*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7177*                                                                *
  7178*   FILE TYPE = VSAM,KSDS                                        *
  7179*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7180*                                                                *
  7181*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7182*       ALTERNATE PATH = NONE                                    *
  7183*                                                                *
  7184*   LOG = NO                                                     *
  7185*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7186*                                                                *
  7187******************************************************************
  7188*                   C H A N G E   L O G
  7189*
  7190* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7191*-----------------------------------------------------------------
  7192*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7193* EFFECTIVE    NUMBER
  7194*-----------------------------------------------------------------
  7195* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7196* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7197******************************************************************
  7198 01  REINSURANCE-RECORD.
  7199     12  RE-RECORD-ID                      PIC XX.
  7200         88  VALID-RE-ID                      VALUE 'RE'.
  7201
  7202     12  RE-CONTROL-PRIMARY.
  7203         16  RE-COMPANY-CD                 PIC X.
  7204         16  RE-KEY.
  7205             20  RE-CODE                   PIC X.
  7206                 88  RE-TABLE-RECORD          VALUE 'A'.
  7207                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7208             20  RE-TABLE                  PIC XXX.
  7209             20  FILLER                    PIC XXX.
  7210         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7211             20  FILLER                    PIC X.
  7212             20  RE-COMPANY.
  7213                 24  RE-COMP-PRIME         PIC XXX.
  7214                 24  RE-COMP-SUB           PIC XXX.
  7215
  7216     12  RE-MAINT-INFORMATION.
  7217         16  RE-LAST-MAINT-DT              PIC XX.
  7218         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7219         16  RE-LAST-MAINT-USER            PIC X(4).
  7220         16  FILLER                        PIC X(10).
  7221
  7222     12  RE-TABLE-DATA.
  7223         16  RE-100-COMP                   PIC 99.
  7224
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 134
* EL050.cbl
  7225         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7226             20  RE-REI-COMP-NO.
  7227                 24  RE-REI-COMP           PIC XXX.
  7228                 24  RE-REI-COMP-SUB       PIC XXX.
  7229             20  RE-LF-QC                  PIC X.
  7230             20  RE-AH-QC                  PIC X.
  7231             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7232             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7233             20  RE-LFAGE-LO               PIC 99.
  7234             20  RE-LFAGE-HI               PIC 99.
  7235             20  RE-AHAGE-LO               PIC 99.
  7236             20  RE-AHAGE-HI               PIC 99.
  7237             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7238             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7239             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7240             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7241             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7242             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7243             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7244             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7245             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7246             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7247             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7248             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7249             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7250             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7251             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7252             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7253             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7254             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7255             20  RE-LF-BEN-CODE            PIC X.
  7256             20  RE-AH-BEN-CODE            PIC X.
  7257             20  RE-INTERACTIVE            PIC X.
  7258             20  RE-REMAINING              PIC X.
  7259             20  RE-LF-RUNOFF-SW           PIC X.
  7260             20  RE-AH-RUNOFF-SW           PIC X.
  7261             20  FILLER                    PIC X(19).
  7262
  7263         16  RE-COMP-INFO-END              PIC X(6).
  7264         16  RE-NSP-ST-CD-LF               PIC XX.
  7265         16  RE-NSP-ST-CD-AH               PIC XX.
  7266         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7267             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7268
  7269         16  FILLER                        PIC X(27).
  7270
  7271     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7272         16  RE-NAME                       PIC X(30).
  7273         16  RE-LF-PE                      PIC X.
  7274         16  RE-AH-PE                      PIC X.
  7275         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7276         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7277         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7278         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7279         16  RE-PRT-ST                     PIC X.
  7280         16  RE-PRT-OW                     PIC X.
  7281         16  RE-MORT-CODE                  PIC X(4).
  7282         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 135
* EL050.cbl
  7283         16  RE-ZERO-LF-FEE                PIC X.
  7284         16  RE-ZERO-AH-FEE                PIC X.
  7285         16  RE-CEDE-NAME                  PIC X(30).
  7286         16  RE-LF-COMM                    PIC X.
  7287         16  RE-AH-COMM                    PIC X.
  7288         16  RE-LF-TAX                     PIC X.
  7289         16  RE-AH-TAX                     PIC X.
  7290         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7291         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7292         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7293
  7294         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7295             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7296
  7297         16  RE-LF-CEDING-FEE-BRACKETS.
  7298             20  RE-LF-FEE-METHOD          PIC X.
  7299                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7300                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7301                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7302                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7303             20  RE-LF-FEE-BASIS           PIC X.
  7304                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7305                 88  RE-LF-NET-CEDED               VALUE '2'.
  7306                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7307                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7308                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7309                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7310                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7311                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7312             20  FILLER                    PIC XXX.
  7313             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7314                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7315                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7316
  7317         16  RE-AH-CEDING-FEE-BRACKETS.
  7318             20  RE-AH-FEE-METHOD          PIC X.
  7319                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7320                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7321                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7322                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7323             20  RE-AH-FEE-BASIS           PIC X.
  7324                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7325                 88  RE-AH-NET-CEDED               VALUE '2'.
  7326                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7327                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7328                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7329                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7330                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7331                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7332             20  FILLER                    PIC XXX.
  7333             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7334                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7335                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7336
  7337         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7338
  7339         16  RE-OLD-CEDING-STMT            PIC X.
  7340
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 136
* EL050.cbl
  7341         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7342         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7343         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7344         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7345         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7346         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7347         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7348         16  RE-MORT-SW                    PIC X.
  7349         16  RE-CEDING-TYPE-FLAG           PIC X.
  7350             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7351             88  RE-CEDED                          VALUE 'C'.
  7352             88  RE-ASSUMED                        VALUE 'A'.
  7353             88  RE-PHANTOM                        VALUE 'P'.
  7354
  7355         16  RE-CEDING-STMT-OPT-A          PIC X.
  7356             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7357         16  RE-CEDING-STMT-OPT-B          PIC X.
  7358             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7359         16  RE-CEDING-STMT-OPT-C          PIC X.
  7360             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7361         16  RE-CEDING-STMT-OPT-D          PIC X.
  7362             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7363         16  RE-CEDING-STMT-OPT-E          PIC X.
  7364             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7365
  7366         16  RE-PRT-CRSV                   PIC X.
  7367
  7368         16  RE-GL-CENTER                  PIC X(4).
  7369
  7370         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7371
  7372         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7373
  7374         16  RE-EARN-STOP-CODE             PIC X.
  7375             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7376             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7377
  7378         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7379             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7380
  7381         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7382         16  FILLER                        PIC X(2281).
  7383
  7384         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7385
  7386******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 137
* EL050.cbl
  7388*    COPY ERCCTBL.
  7389******************************************************************
  7390*                                                                *
  7391*                                                                *
  7392*                            ERCCTBL                             *
  7393*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7394*                            VMOD=2.003
  7395*                                                                *
  7396*   ONLINE CREDIT SYSTEM                                         *
  7397*                                                                *
  7398*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7399*                                                                *
  7400*   FILE TYPE = VSAM,KSDS                                        *
  7401*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7402*                                                                *
  7403*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7404*       ALTERNATE PATH = NONE                                    *
  7405*                                                                *
  7406*   LOG = NO                                                     *
  7407*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7408*                                                                *
  7409*                                                                *
  7410******************************************************************
  7411
  7412 01  COMM-TABLE-RECORD.
  7413     12  CT-RECORD-ID                      PIC XX.
  7414         88  VALID-CT-ID                      VALUE 'CT'.
  7415
  7416     12  CT-CONTROL-PRIMARY.
  7417         16  CT-COMPANY-CD                 PIC X.
  7418         16  CT-TABLE                      PIC XXX.
  7419         16  CT-CNTRL-2.
  7420             20  CT-BEN-TYPE               PIC X.
  7421             20  CT-BEN-CODE               PIC XX.
  7422
  7423     12  CT-MAINT-INFORMATION.
  7424         16  CT-LAST-MAINT-DT              PIC XX.
  7425         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7426         16  CT-LAST-MAINT-USER            PIC X(4).
  7427         16  FILLER                        PIC X(31).
  7428
  7429     12  CT-LIMITS.
  7430         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7431
  7432         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7433
  7434         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7435
  7436     12  CT-RATES.
  7437         16  CT-RTX          OCCURS 27 TIMES.
  7438             20  CT-RT                     PIC SV9(5)     COMP-3.
  7439             20  CT-RT-R   REDEFINES
  7440                 CT-RT                     PIC XXX.
  7441
  7442     12  FILLER                            PIC  X(42).
  7443
  7444******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 138
* EL050.cbl
  7446*    COPY ERCFORM.
  7447******************************************************************
  7448*                                                                *
  7449*                                                                *
  7450*                            ERCFORM.                            *
  7451*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7452*                            VMOD=2.003                          *
  7453*                                                                *
  7454*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7455*                                                                *
  7456*    FILE TYPE = VSAM,KSDS                                       *
  7457*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7458*                                                                *
  7459*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7460*                                                                *
  7461*    LOG = YES                                                   *
  7462*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7463******************************************************************
  7464 01  FORM-MASTER.
  7465    12  FO-RECORD-ID                 PIC X(02).
  7466        88  VALID-FO-ID                  VALUE 'FO'.
  7467
  7468    12  FO-CONTROL-PRIMARY.
  7469        16  FO-COMPANY-CD            PIC X(01).
  7470        16  FO-STATE                 PIC X(02).
  7471        16  FO-FORM-ID               PIC X(12).
  7472        16  FO-FORM-EXP-DT           PIC X(02).
  7473
  7474    12  FO-POLICY-FORM-DATA.
  7475        16  FO-IND-GRP-CD            PIC X(01).
  7476        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7477        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7478        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7479        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7480        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7481        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7482        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7483        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7484        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7485        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7486        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7487        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7488        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7489        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7490        16  FO-APP-CERT-USE-CD       PIC X(01).
  7491
  7492    12  FILLER                       PIC X(29).
  7493
  7494    12  FO-FORM-PLAN-TABLE.
  7495        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7496            20  FO-PLAN-TYPE         PIC X(01).
  7497            20  FO-PLAN-ID           PIC X(02).
  7498            20  FO-PLAN-TERM         PIC 9(03).
  7499            20  FO-PLAN-REFUND-METHOD
  7500                                     PIC X.
  7501
  7502    12  FILLER                       PIC X(30).
  7503
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 139
* EL050.cbl
  7504    12  FO-COMMENTS-AREA.
  7505        16  FO-COMMENT-LINE-1        PIC X(78).
  7506
  7507    12  FILLER                       PIC X(20).
  7508
  7509    12  FO-MAINT-INFORMATION.
  7510        16  FO-LAST-MAINT-DT         PIC X(02).
  7511        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7512        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 140
* EL050.cbl
  7514*    COPY ELCMSTR.
  7515******************************************************************
  7516*                                                                *
  7517*                            ELCMSTR.                            *
  7518*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7519*                            VMOD=2.012                          *
  7520*                                                                *
  7521*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7522*                                                                *
  7523*   FILE TYPE = VSAM,KSDS                                        *
  7524*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7525*                                                                *
  7526*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7527*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7528*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7529*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7530*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7531*                                                 RKP=75,LEN=21  *
  7532*                                                                *
  7533*   **** NOTE ****                                               *
  7534*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7535*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7536*                                                                *
  7537*   LOG = YES                                                    *
  7538*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7539******************************************************************
  7540*                   C H A N G E   L O G
  7541*
  7542* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7543*-----------------------------------------------------------------
  7544*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7545* EFFECTIVE    NUMBER
  7546*-----------------------------------------------------------------
  7547* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7548* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7549* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7550* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7551* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7552* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7553******************************************************************
  7554 01  CLAIM-MASTER.
  7555     12  CL-RECORD-ID                PIC XX.
  7556         88  VALID-CL-ID         VALUE 'CL'.
  7557
  7558     12  CL-CONTROL-PRIMARY.
  7559         16  CL-COMPANY-CD           PIC X.
  7560         16  CL-CARRIER              PIC X.
  7561         16  CL-CLAIM-NO             PIC X(7).
  7562         16  CL-CERT-NO.
  7563             20  CL-CERT-PRIME       PIC X(10).
  7564             20  CL-CERT-SFX         PIC X.
  7565
  7566     12  CL-CONTROL-BY-NAME.
  7567         16  CL-COMPANY-CD-A1        PIC X.
  7568         16  CL-INSURED-LAST-NAME    PIC X(15).
  7569         16  CL-INSURED-NAME.
  7570             20  CL-INSURED-1ST-NAME PIC X(12).
  7571             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 141
* EL050.cbl
  7572
  7573     12  CL-CONTROL-BY-SSN.
  7574         16  CL-COMPANY-CD-A2        PIC X.
  7575         16  CL-SOC-SEC-NO.
  7576             20  CL-SSN-STATE        PIC XX.
  7577             20  CL-SSN-ACCOUNT      PIC X(6).
  7578             20  CL-SSN-LN3          PIC X(3).
  7579
  7580     12  CL-CONTROL-BY-CERT-NO.
  7581         16  CL-COMPANY-CD-A4        PIC X.
  7582         16  CL-CERT-NO-A4.
  7583             20  CL-CERT-A4-PRIME    PIC X(10).
  7584             20  CL-CERT-A4-SFX      PIC X.
  7585
  7586     12  CL-CONTROL-BY-CCN.
  7587         16  CL-COMPANY-CD-A5        PIC X.
  7588         16  CL-CCN-A5.
  7589             20  CL-CCN.
  7590                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7591                 24  CL-CCN-PRIME-A5 PIC X(12).
  7592             20  CL-CCN-FILLER-A5    PIC X(4).
  7593
  7594     12  CL-INSURED-PROFILE-DATA.
  7595         16  CL-INSURED-BIRTH-DT     PIC XX.
  7596         16  CL-INSURED-SEX-CD       PIC X.
  7597             88  INSURED-IS-MALE        VALUE 'M'.
  7598             88  INSURED-IS-FEMALE      VALUE 'F'.
  7599             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7600         16  CL-INSURED-OCC-CD       PIC X(6).
  7601         16  FILLER                  PIC X(5).
  7602
  7603     12  CL-PROCESSING-INFO.
  7604         16  CL-PROCESSOR-ID         PIC X(4).
  7605         16  CL-CLAIM-STATUS         PIC X.
  7606             88  CLAIM-IS-OPEN          VALUE 'O'.
  7607             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7608         16  CL-CLAIM-TYPE           PIC X.
  7609*            88  AH-CLAIM               VALUE 'A'.
  7610*            88  LIFE-CLAIM             VALUE 'L'.
  7611*            88  PROPERTY-CLAIM         VALUE 'P'.
  7612*            88  IUI-CLAIM              VALUE 'I'.
  7613*            88  GAP-CLAIM              VALUE 'G'.
  7614*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7615         16  CL-CLAIM-PREM-TYPE      PIC X.
  7616             88  SINGLE-PREMIUM         VALUE '1'.
  7617             88  O-B-COVERAGE           VALUE '2'.
  7618             88  OPEN-END-COVERAGE      VALUE '3'.
  7619         16  CL-INCURRED-DT          PIC XX.
  7620         16  CL-REPORTED-DT          PIC XX.
  7621         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7622         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7623         16  CL-LAST-PMT-DT          PIC XX.
  7624         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7625         16  CL-PAID-THRU-DT         PIC XX.
  7626         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7627         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7628         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7629         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 142
* EL050.cbl
  7630             88  CL-360-DAY-YR          VALUE '1'.
  7631             88  CL-365-DAY-YR          VALUE '2'.
  7632             88  CL-FULL-MONTHS         VALUE '3'.
  7633         16  CL-CAUSE-CD             PIC X(6).
  7634
  7635         16  CL-PRIME-CERT-NO.
  7636             20  CL-PRIME-CERT-PRIME PIC X(10).
  7637             20  CL-PRIME-CERT-SFX   PIC X.
  7638
  7639         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7640             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7641             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7642
  7643         16  CL-MICROFILM-NO         PIC X(10).
  7644         16  FILLER REDEFINES CL-MICROFILM-NO.
  7645             20  CL-BENEFIT-PERIOD   PIC 99.
  7646             20  FILLER              PIC X(8).
  7647         16  CL-PROG-FORM-TYPE       PIC X.
  7648         16  CL-LAST-ADD-ON-DT       PIC XX.
  7649
  7650         16  CL-LAST-REOPEN-DT       PIC XX.
  7651         16  CL-LAST-CLOSE-DT        PIC XX.
  7652         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7653             88  FINAL-PAID             VALUE '1'.
  7654             88  CLAIM-DENIED           VALUE '2'.
  7655             88  AUTO-CLOSE             VALUE '3'.
  7656             88  MANUAL-CLOSE           VALUE '4'.
  7657             88  BENEFITS-CHANGED       VALUE 'C'.
  7658             88  SETUP-ERRORS           VALUE 'E'.
  7659         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7660         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7661         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7662             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7663         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7664         16  FILLER                  PIC X.
  7665
  7666     12  CL-CERTIFICATE-DATA.
  7667         16  CL-CERT-ORIGIN          PIC X.
  7668             88  CERT-WAS-ONLINE        VALUE '1'.
  7669             88  CERT-WAS-CREATED       VALUE '2'.
  7670             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7671         16  CL-CERT-KEY-DATA.
  7672             20  CL-CERT-CARRIER     PIC X.
  7673             20  CL-CERT-GROUPING    PIC X(6).
  7674             20  CL-CERT-STATE       PIC XX.
  7675             20  CL-CERT-ACCOUNT.
  7676                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7677                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7678             20  CL-CERT-EFF-DT      PIC XX.
  7679
  7680     12  CL-STATUS-CONTROLS.
  7681         16  CL-PRIORITY-CD          PIC X.
  7682             88  CONFIDENTIAL-DATA      VALUE '8'.
  7683             88  HIGHEST-PRIORITY       VALUE '9'.
  7684         16  CL-SUPV-ATTN-CD         PIC X.
  7685             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7686             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7687         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 143
* EL050.cbl
  7688         16  CL-RESTORED-DT          PIC XX.
  7689         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7690         16  CL-NEXT-RESEND-DT       PIC XX.
  7691         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7692         16  CL-CRITICAL-PERIOD      PIC 99.
  7693*        16  FILLER                  PIC XX.
  7694         16  CL-LAST-MAINT-DT        PIC XX.
  7695         16  CL-LAST-MAINT-USER      PIC X(4).
  7696         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7697         16  CL-LAST-MAINT-TYPE      PIC X.
  7698             88  CLAIM-SET-UP           VALUE ' '.
  7699             88  PAYMENT-MADE           VALUE '1'.
  7700             88  LETTER-SENT            VALUE '2'.
  7701             88  MASTER-WAS-ALTERED     VALUE '3'.
  7702             88  MASTER-WAS-RESTORED    VALUE '4'.
  7703             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7704             88  FILE-CONVERTED         VALUE '6'.
  7705             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7706             88  ERROR-CORRECTION       VALUE 'E'.
  7707         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7708         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7709         16  CL-BENEFICIARY          PIC X(10).
  7710         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7711         16  CL-DENIAL-TYPE          PIC X.
  7712             88  CL-TYPE-DENIAL          VALUE '1'.
  7713             88  CL-TYPE-RESCISSION      VALUE '2'.
  7714             88  CL-TYPE-REFORMATION     VALUE '3'.
  7715             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7716             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7717         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7718         16  filler                  pic x(3).
  7719*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7720*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7721*        16  CL-RTW-DT               PIC XX.
  7722
  7723     12  CL-TRAILER-CONTROLS.
  7724         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7725             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7726             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7727             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7728         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7729         16  FILLER                  PIC XX.
  7730         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7731         16  CL-ADDRESS-TRAILER-CNT.
  7732             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7733                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7734             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7735                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7736             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7737                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7738             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7739                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7740             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7741                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7742             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7743                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7744             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7745                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 144
* EL050.cbl
  7746
  7747     12  CL-CV-REFERENCE-NO.
  7748         16  CL-CV-REFNO-PRIME       PIC X(18).
  7749         16  CL-CV-REFNO-SFX         PIC XX.
  7750
  7751     12  CL-FILE-LOCATION            PIC X(4).
  7752
  7753     12  CL-PROCESS-ERRORS.
  7754         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7755             88  NO-FATAL-ERRORS        VALUE ZERO.
  7756         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7757             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7758
  7759     12  CL-PRODUCT-CD               PIC X.
  7760
  7761     12  CL-CURRENT-KEY-DATA.
  7762         16  CL-CURRENT-CARRIER      PIC X.
  7763         16  CL-CURRENT-GROUPING     PIC X(6).
  7764         16  CL-CURRENT-STATE        PIC XX.
  7765         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7766
  7767     12  CL-ASSOCIATES               PIC X.
  7768         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7769         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7770         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7771         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7772
  7773     12  CL-ACTIVITY-CODE            PIC 99.
  7774     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7775     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7776
  7777     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7778     12  CL-LAG-REPORT-CODE          PIC 9.
  7779     12  CL-LOAN-TYPE                PIC XX.
  7780     12  CL-LEGAL-STATE              PIC XX.
  7781
  7782     12  CL-YESNOSW                  PIC X.
  7783     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7784         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7785         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7786         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7787     12  cl-insured-type             pic x.
  7788         88  cl-claim-on-primary         value 'P'.
  7789         88  cl-claim-on-co-borrower     value 'C'.
  7790     12  cl-benefit-expiration-dt    PIC XX.
  7791
  7792 01  PLAN-RECORDS.
  7793     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7794     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7795
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 145
* EL050.cbl
  7797 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7798                          ACCOUNT-MASTER REINSURANCE-RECORD
  7799                          COMM-TABLE-RECORD FORM-MASTER
  7800                          CLAIM-MASTER PLAN-RECORDS.
  7801 0000-DFHEXIT SECTION.
  7802     MOVE '9#                    $   ' TO DFHEIV0.
  7803     MOVE 'EL050' TO DFHEIV1.
  7804     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7805
  7806     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7807
  7808
  7809* EXEC CICS  HANDLE CONDITION
  7810*           ERROR    (9300-ABEND)
  7811*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7812*    END-EXEC.
  7813*    MOVE '"$.J                  ! " #00007804' TO DFHEIV0
  7814     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7816     MOVE X'2220233030303037383034' TO DFHEIV0(25:11)
  7817     CALL 'kxdfhei1' USING DFHEIV0
  7818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7819
  7820
  7821 0000-COPY-PROCEDURE-DIV.
  7822*                          COPY ELC50PD.
  7823******************************************************************
  7824*                                                                *
  7825*                            ELC50PD                             *
  7826*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7827*                            VMOD=2.188                          *
  7828*                                                                *
  7829******************************************************************
  7830*                   C H A N G E   L O G
  7831*
  7832* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7833*-----------------------------------------------------------------
  7834*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7835* EFFECTIVE    NUMBER
  7836*-----------------------------------------------------------------
  7837* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7838* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7839* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7840*                             2709 AND 2718
  7841* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7842* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7843* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7844* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7845* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7846*                                IS OPEN OR CNC DT < PD THRU
  7847* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7848* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7849* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7850* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7851* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7852* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7853* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7854* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 146
* EL050.cbl
  7855* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7856* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7857* 020906                   PEMA  EXPAND LOAN OFFICER
  7858* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7859* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7860* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7861* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7862* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7863* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7864* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7865* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7866* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7867* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7868* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7869* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7870* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7871* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7872* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7873* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7874* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7875* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7876* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7877* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7878* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7879* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7880* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7881* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7882* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7883*                                UPDATE VIN ON CERT TRAILER
  7884* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7885* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7886* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7887* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7888* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7889* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7890* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7891* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7892* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7893* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7894* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7895* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7896* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7897* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7898* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7899* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7900* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7901* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7902* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7903* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7904* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7905* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7906* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7907* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7908* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7909* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7910* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7911* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7912* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 147
* EL050.cbl
  7913* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7914* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7915* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7916* 032912  CR2011110200001  PEMA  AHL CHANGES
  7917* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7918* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7919* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7920* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7921* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7922* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7923* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7924* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7925* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7926* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7927* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7928* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7929* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7930* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7931* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7932* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7933* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7934* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7935* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7936* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7937* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7938* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7939* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7940* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7941* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7942* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7943* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7944*                                CERT #, ADD 2898 FORCIBLE ERROR
  7945* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7946* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7947* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7948* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7949* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7950* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7951* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7952* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7953* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7954* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7955* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7956* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7957* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7958* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7959* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7960* 100617  CR2017062000003  PEMA  New comm cap edits
  7961* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7962* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7963* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7964* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7965* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7966* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7967* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
  7968******************************************************************
  7969************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7970******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 148
* EL050.cbl
  7971
  7972     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7973
  7974     MOVE SPACES                 TO PB-FATAL-FLAG
  7975                                    PB-FORCE-ER-CD
  7976                                    PB-WARN-ER-CD
  7977                                    PB-OUT-BAL-CD.
  7978
  7979     MOVE SPACE                  TO WS-IG-OVRD-AH
  7980                                    WS-IG-OVRD-LF
  7981                                    WS-IG-OVRD-AM
  7982                                    WS-IG-OVRD
  7983                                    WS-IG-OVRD-AH-PL
  7984                                    WS-IG-OVRD-LF-PL
  7985                                    WS-IG-OVRD-AH-BEN
  7986                                    WS-IG-OVRD-LF-BEN.
  7987
  7988******************************************************************
  7989*************       INITIALIZE COMMON ERRORS       ***************
  7990******************************************************************
  7991
  7992     MOVE +0                     TO PB-NO-OF-ERRORS.
  7993     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7994
  7995******************************************************************
  7996
  7997     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7998     SET JULIAN-TO-BIN           TO TRUE.
  7999*    MOVE 5                      TO DC-OPTION-CODE.
  8000     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8001     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  8002
  8003     MOVE ZERO                   TO  SUB4.
  8004
  8005 0040-INITIALIZE-GA-BILL-DT.
  8006
  8007     ADD +1                      TO  SUB4.
  8008
  8009     IF  SUB4 GREATER THAN +5
  8010         GO TO 0050-CHECK-CNTL-FOUND.
  8011
  8012     IF  PB-GA-BILL-DT (SUB4) = SPACES
  8013         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  8014
  8015     GO TO 0040-INITIALIZE-GA-BILL-DT.
  8016
  8017 0050-CHECK-CNTL-FOUND.
  8018
  8019     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  8020        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  8021                                         WS-AH-REM-TERM-CALC
  8022                                         EC-CO-REM-TERM-CALC
  8023        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  8024        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  8025        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  8026                                         WS-TOL-AH-CLAIM
  8027        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  8028                                         WS-TOL-AH-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 149
* EL050.cbl
  8029                                         EC-CO-TOL-PREM
  8030        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  8031                                         WS-TOL-AH-REFUND
  8032                                         EC-CO-TOL-REFUND
  8033        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  8034                                         WS-AH-REFUND-OVS-AMT
  8035                                         EC-CO-OVR-SHT-AMT
  8036        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  8037                                         WS-TOL-AH-PREM-PCT
  8038                                         EC-CO-TOL-PREM-PCT
  8039        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  8040                                         WS-TOL-AH-REFUND-PCT
  8041                                         EC-CO-TOL-REFUND-PCT
  8042        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  8043                                         WS-AH-REFUND-OVS-PCT
  8044                                         EC-CO-OVR-SHT-PCT
  8045        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8046        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8047        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8048        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8049        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8050        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8051        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8052        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8053        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8054        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8055        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8056        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8057                                         EC-CO-MONTH-END-DT
  8058        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8059          GO TO 0100-READ-ACCT.
  8060
  8061     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8062     MOVE SPACES                 TO CNTL-ACCESS.
  8063     MOVE '1'                    TO CNTL-REC-TYPE.
  8064     MOVE +0                     TO CNTL-SEQ-NO.
  8065
  8066     MOVE '1' TO RC-SW-1.
  8067     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8068     IF NOT CF-COMPANY-MASTER
  8069         MOVE ZEROS             TO WK-CO-TOL-PREM
  8070                                   WK-CO-TOL-CLAIM
  8071                                   WK-CO-TOL-REFUND
  8072                                   WK-REFUND-OVS-AMT
  8073                                   WK-REFUND-OVS-PCT
  8074                                   WK-CO-TOL-PREM-PCT
  8075                                   WK-CO-TOL-REFUND-PCT
  8076                                   WK-DEFAULT-APR
  8077                                   WK-CO-MAX-CAP
  8078        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8079                                   WK-CR-R78-METHOD
  8080                                   WK-CO-REF-REJECT-SW
  8081                                   WK-CO-PREM-REJECT-SW
  8082                                   WK-REM-TRM-CALC-OPTION
  8083                                   WK-BIRTH-DATE-INPUT
  8084                                   WK-JOINT-AGE-INPUT
  8085        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8086        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 150
* EL050.cbl
  8087        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8088        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8089          GO TO 0099-COMPANY-NOT-FOUND.
  8090
  8091     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8092        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8093     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8094        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8095     IF CF-CO-TOL-CAP NOT NUMERIC
  8096        MOVE +0                    TO CF-CO-TOL-CAP.
  8097     IF CF-DEFAULT-APR NOT NUMERIC
  8098        MOVE +0                    TO CF-DEFAULT-APR.
  8099
  8100     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8101     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8102     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8103     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8104     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8105     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8106     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8107     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8108     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8109     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8110     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8111     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8112
  8113     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8114          CF-CO-OVR-SHT-AMT > +0
  8115        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8116
  8117     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8118          CF-CO-OVR-SHT-PCT > +0
  8119        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8120
  8121     IF CF-VALID-REM-TRM-OPTION
  8122         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8123     ELSE
  8124         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8125
  8126     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8127     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8128     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8129     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8130
  8131     GO TO 0050-CHECK-CNTL-FOUND.
  8132
  8133 0099-COMPANY-NOT-FOUND.
  8134
  8135     MOVE ER-2616                TO WS-ERROR.
  8136     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8137
  8138 0100-READ-ACCT.
  8139
  8140     MOVE SPACES                 TO DATE-RANGE-SW.
  8141
  8142     IF WK-ACCT-ADDR = ZEROS
  8143        GO TO 0102-ACCT-GETMAIN.
  8144
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 151
* EL050.cbl
  8145     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8146     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8147     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8148
  8149     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8150        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8151        GO TO 0105-READ-ACCT
  8152     END-IF
  8153
  8154     IF PB-CARRIER NOT = SPACES
  8155        IF PB-CARRIER NOT = AM-VG-CARRIER
  8156           GO TO 0105-READ-ACCT.
  8157
  8158     IF PB-STATE NOT = SPACES
  8159        IF PB-STATE NOT = AM-VG-STATE
  8160           GO TO 0105-READ-ACCT.
  8161
  8162     IF PB-GROUPING NOT = SPACES
  8163        IF PB-GROUPING NOT = AM-VG-GROUPING
  8164           GO TO 0105-READ-ACCT.
  8165
  8166     MOVE 'X'                 TO DATE-RANGE-SW.
  8167
  8168     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8169        MOVE 'X'                 TO DATE-RANGE-SW
  8170        GO TO 0105-READ-ACCT.
  8171
  8172     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8173        GO TO 0105-READ-ACCT.
  8174
  8175     GO TO 0180-ACCOUNT-FOUND.
  8176
  8177 0102-ACCT-GETMAIN.
  8178     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8179     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8180
  8181 0105-READ-ACCT.
  8182     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8183     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8184     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8185     MOVE PB-STATE               TO ACCT-STATE.
  8186     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8187     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8188
  8189     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8190
  8191     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8192
  8193 0110-FIND-ACCT-TOLERANCES-LOOP.
  8194     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8195
  8196     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8197        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8198        GO TO 0199-ACCT-NOT-FOUND
  8199     END-IF
  8200     IF PB-CARRIER NOT = SPACES
  8201        IF PB-CARRIER NOT = AM-VG-CARRIER
  8202           GO TO 0199-ACCT-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 152
* EL050.cbl
  8203
  8204     IF PB-STATE NOT = SPACES
  8205        IF PB-STATE NOT = AM-VG-STATE
  8206           GO TO 0199-ACCT-NOT-FOUND.
  8207
  8208     IF PB-GROUPING NOT = SPACES
  8209        IF PB-GROUPING NOT = AM-VG-GROUPING
  8210           GO TO 0199-ACCT-NOT-FOUND.
  8211
  8212     MOVE 'X'                    TO DATE-RANGE-SW.
  8213
  8214     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8215        MOVE 'X'                 TO DATE-RANGE-SW
  8216        GO TO 0199-ACCT-NOT-FOUND.
  8217
  8218     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8219        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8220
  8221 0180-ACCOUNT-FOUND.
  8222     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8223     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8224     MOVE AM-STATE               TO PB-SV-STATE.
  8225     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8226
  8227     IF AM-CANCEL-FEE  NOT NUMERIC
  8228        MOVE ZEROS TO AM-CANCEL-FEE.
  8229
  8230     IF AM-MAX-MON-BEN NOT NUMERIC
  8231        MOVE ZEROS TO AM-MAX-MON-BEN.
  8232
  8233     IF AM-MAX-TOT-BEN NOT NUMERIC
  8234        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8235
  8236     IF AM-CLP-TOL-PCT NOT NUMERIC
  8237        MOVE +0                  TO AM-CLP-TOL-PCT
  8238     END-IF
  8239     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8240        MOVE +0                  TO AM-SPP-LEASE-COMM
  8241     END-IF
  8242     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8243        MOVE ER-2611             TO   WS-ERROR
  8244        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8245
  8246     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8247        MOVE ER-2621             TO   WS-ERROR
  8248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8249
  8250     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8251        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8252        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8253        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8254         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8255
  8256     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8257     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8258     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8259     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8260     IF AM-CLP-TOL-PCT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 153
* EL050.cbl
  8261        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8262     END-IF
  8263     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8264        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8265     END-IF
  8266*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8267*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8268*                                   WS-ADMIN-FEES
  8269*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8270*          (SUB5 > +10)
  8271*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8272*             AND (AM-A-COM (SUB5) NUMERIC)
  8273*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8274*                + (AM-A-COM (SUB5) * 1000)
  8275*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8276*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8277*                + (AM-A-COM (SUB5) * 1000)
  8278*             END-IF
  8279*             IF AM-COM-TYP (SUB5) = 'N'
  8280*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8281*                + (AM-A-COM (SUB5) * 1000)
  8282*             END-IF
  8283*          END-IF
  8284*       END-PERFORM
  8285*    END-IF
  8286     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8287        AND (PB-ISSUE)
  8288        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8289                                    ws-cred-union-fees
  8290        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8291           (SUB5 > +10)
  8292           MOVE +0 TO WS-WK-RATE
  8293           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8294                                   'O' OR 'S')
  8295              IF (AM-A-COM (SUB5) NUMERIC)
  8296                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8297                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8298              ELSE
  8299                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8300                 IF PB-ISSUE
  8301                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8302                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8303                 ELSE
  8304                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8305                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8306                 END-IF
  8307                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8308                 MOVE ZEROS             TO WS-SUB1
  8309                                           WS-COMMISSION
  8310                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8311                 MOVE '0530'               TO CTBL-SW
  8312                 MOVE ' '                  TO WS-CTBL-READ-SW
  8313                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8314                 IF FIRST-TIME-THROUGH
  8315                    MOVE 'AA'              TO CTBL-BEN-CODE
  8316                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8317                 END-IF
  8318                 IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 154
* EL050.cbl
  8319                    IF PB-ISSUE
  8320                       COMPUTE WS-COMM-CK-AMT =
  8321                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8322                    ELSE
  8323                       COMPUTE WS-COMM-CK-AMT =
  8324                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8325                    END-IF
  8326                    PERFORM 8800-GET-COMP-RATE
  8327                              THRU 8800-EXIT
  8328                 END-IF
  8329              END-IF
  8330              if am-com-typ (sub5) = 'O' or 'S'
  8331                 compute ws-cred-union-fees rounded =
  8332                    ws-cred-union-fees +
  8333                    (pb-i-ah-premium-amt * ws-wk-rate)
  8334              else
  8335                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8336                + (WS-WK-RATE * 1000)
  8337              end-if
  8338           END-IF
  8339        END-PERFORM
  8340     END-IF
  8341     IF PB-COMPANY-ID EQUAL 'CRI'
  8342         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8343
  8344     IF PB-COMPANY-ID EQUAL 'NCL'
  8345         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8346     END-IF
  8347
  8348     GO TO 0200-READ-CERT.
  8349
  8350 0199-ACCT-NOT-FOUND.
  8351
  8352     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8353
  8354     IF DATE-RANGE-SW NOT = SPACES
  8355        MOVE ER-2601             TO WS-ERROR
  8356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8357     ELSE
  8358        MOVE ER-2619             TO WS-ERROR
  8359        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8360
  8361     GO TO 9990-RETURN.
  8362
  8363 0200-READ-CERT.
  8364
  8365     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8366     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8367     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8368     MOVE PB-SV-STATE            TO CERT-STATE.
  8369     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8370     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8371     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8372
  8373     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8374
  8375     IF CERT-WAS-NOT-FOUND
  8376        GO TO 0299-CERT-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 155
* EL050.cbl
  8377
  8378     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8379        MOVE ER-2759             TO WS-ERROR
  8380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8381        GO TO 0298-UNLOCK-RETURN.
  8382
  8383     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8384         MOVE ER-2758            TO WS-ERROR
  8385         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8386         GO TO 0298-UNLOCK-RETURN.
  8387
  8388     IF PB-ISSUE
  8389        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8390           IF CERT-WAS-CREATED-FOR-CLAIM
  8391              NEXT SENTENCE
  8392            ELSE
  8393              MOVE ER-2626       TO WS-ERROR
  8394              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8395              GO TO 0298-UNLOCK-RETURN.
  8396
  8397     IF NOT PB-CANCELLATION
  8398        GO TO 0300-CONTINUE-EDIT.
  8399
  8400     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8401     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8402     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8403     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8404     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8405     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8406
  8407     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8408     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8409     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8410     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8411     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8412     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8413     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8414     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8415     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8416
  8417     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8418     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8419     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8420     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8421     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8422     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8423     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8424
  8425     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8426     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8427
  8428     MOVE CM-CREDIT-INTERFACE-SW-1
  8429                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8430     MOVE CM-CREDIT-INTERFACE-SW-2
  8431                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8432
  8433     IF CM-O-B-COVERAGE
  8434         MOVE 'B'                 TO PB-CI-OB-FLAG.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 156
* EL050.cbl
  8435
  8436     IF CM-LIVES NOT NUMERIC
  8437         MOVE ZERO                TO CM-LIVES.
  8438
  8439     IF CM-BILLED NOT NUMERIC
  8440         MOVE ZERO                TO CM-BILLED.
  8441
  8442     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8443         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8444         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8445         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8446         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8447         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8448         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8449         MOVE CM-LIVES             TO PB-CI-LIVES
  8450*The next line causes a problem with my change  I dont think it is
  8451*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8452
  8453     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8454     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8455     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8456     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8457     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8458     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8459
  8460     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8461     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8462     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8463     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8464
  8465     IF CM-LIFE-COMM-PCT NUMERIC
  8466         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8467     ELSE
  8468         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8469
  8470     IF CM-AH-COMM-PCT NUMERIC
  8471         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8472     ELSE
  8473         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8474
  8475     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8476
  8477     IF CM-LOAN-APR       NOT NUMERIC
  8478           MOVE ZERO               TO CM-LOAN-APR.
  8479
  8480     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8481           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8482
  8483     IF CM-LOAN-TERM      NOT NUMERIC
  8484           MOVE ZERO               TO CM-LOAN-TERM.
  8485
  8486     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8487           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8488
  8489     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8490           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8491
  8492     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 157
* EL050.cbl
  8493     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8494     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8495     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8496     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8497     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8498     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8499     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8500     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8501     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8502     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8503     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8504     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8505
  8506     IF CM-STATE = CM-SSN-STATE
  8507         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8508
  8509     IF CM-STATE NOT = CM-MEMB-STATE
  8510         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8511
  8512     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8513
  8514     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8515*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8516        IF CM-ADDL-CLP NOT NUMERIC
  8517           MOVE +0               TO CM-ADDL-CLP
  8518        END-IF
  8519        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8520        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8521           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8522        END-IF
  8523     END-IF
  8524     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8525        MOVE +0                  TO WS-ADMIN-FEES
  8526                                    WS-CSO-ADMIN-FEE
  8527                                    WS-COMM-AND-MFEE
  8528                                    WS-1ST-YR-ALLOW
  8529        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8530           (SUB5 > +10)
  8531           MOVE +0 TO WS-WK-RATE
  8532           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8533              IF (AM-A-COM (SUB5) NUMERIC)
  8534                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8535                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8536              ELSE
  8537                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8538                 IF PB-ISSUE
  8539                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8540                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8541                 ELSE
  8542                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8543                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8544                 END-IF
  8545                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8546                 MOVE ZEROS             TO WS-SUB1
  8547                                           WS-COMMISSION
  8548                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8549                 MOVE '0530'               TO CTBL-SW
  8550                 MOVE ' '                  TO WS-CTBL-READ-SW
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 158
* EL050.cbl
  8551                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8552                 IF FIRST-TIME-THROUGH
  8553                    MOVE 'AA'              TO CTBL-BEN-CODE
  8554                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8555                 END-IF
  8556                 IF CTBL-TABLE-FOUND
  8557                    IF PB-ISSUE
  8558                       COMPUTE WS-COMM-CK-AMT =
  8559                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8560                    ELSE
  8561                       COMPUTE WS-COMM-CK-AMT =
  8562                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8563                    END-IF
  8564                    PERFORM 8800-GET-COMP-RATE
  8565                              THRU 8800-EXIT
  8566                 END-IF
  8567              END-IF
  8568              IF AM-COM-TYP (SUB5) = 'I'
  8569                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8570                   + (WS-WK-RATE * 1000)
  8571              END-IF
  8572              IF AM-COM-TYP (SUB5) = 'N'
  8573                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8574                   + (WS-WK-RATE * 1000)
  8575              END-IF
  8576              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8577                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8578                   + (WS-WK-RATE * 1000)
  8579              END-IF
  8580              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8581                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8582                   + (WS-WK-RATE * 1000)
  8583              END-IF
  8584           END-IF
  8585        END-PERFORM
  8586     END-IF
  8587     GO TO 0300-CONTINUE-EDIT.
  8588
  8589 0298-UNLOCK-RETURN.
  8590      PERFORM 9250-UNLOCK-RETURN
  8591      GO TO 9990-RETURN.
  8592
  8593 0299-CERT-NOT-FOUND.
  8594
  8595     MOVE '1'                     TO CERT-STATUS-SW.
  8596
  8597     IF PB-COMPANY-ID = 'UCL'
  8598         IF WS-ERROR = ER-2799
  8599             GO TO 3000-CONTINUE-EDIT.
  8600
  8601     IF NOT PB-CANCELLATION
  8602         GO TO 0300-CONTINUE-EDIT.
  8603
  8604     MOVE ER-2726                  TO  WS-ERROR.
  8605     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8606     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8607     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8608                                    PB-CI-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 159
* EL050.cbl
  8609                                    PB-C-LF-REM-TERM
  8610                                    PB-CI-AH-TERM
  8611                                    PB-C-AH-REM-TERM
  8612                                    PB-CI-LF-BENEFIT-CD
  8613                                    PB-CI-LF-BENEFIT-AMT
  8614                                    PB-CI-LF-ALT-BENEFIT-AMT
  8615                                    PB-CI-LF-PREMIUM-AMT
  8616                                    PB-CI-LF-ALT-PREMIUM-AMT
  8617                                    PB-CI-AH-BENEFIT-CD
  8618                                    PB-CI-AH-BENEFIT-AMT
  8619                                    PB-CI-AH-PREMIUM-AMT
  8620                                    PB-CI-PAY-FREQUENCY
  8621                                    PB-CI-LOAN-APR
  8622                                    PB-CI-LOAN-TERM
  8623                                    PB-CI-LIFE-COMMISSION
  8624                                    PB-CI-AH-COMMISSION
  8625                                    PB-CI-CURR-SEQ
  8626                                    PB-CI-AH-CANCEL-AMT
  8627                                    PB-CI-LF-CANCEL-AMT
  8628                                    PB-CI-RATE-DEV-PCT-LF
  8629                                    PB-CI-RATE-DEV-PCT-AH
  8630                                    PB-CI-EXTENTION-DAYS
  8631                                    PB-CI-TERM-IN-DAYS
  8632                                    PB-CI-LIVES
  8633                                    PB-CI-LF-CRIT-PER
  8634                                    PB-CI-AH-CRIT-PER
  8635                                    PB-CI-ADDL-CLP
  8636                                    PB-CI-DDF-IU-RATE-UP.
  8637
  8638     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8639                                    PB-CI-AH-SETTLEMENT-DT
  8640                                    PB-CI-DEATH-DT
  8641                                    PB-CI-LF-PRIOR-CANCEL-DT
  8642                                    PB-CI-AH-PRIOR-CANCEL-DT
  8643                                    PB-CI-ENTRY-DT
  8644                                    PB-CI-LF-EXPIRE-DT
  8645                                    PB-CI-AH-EXPIRE-DT
  8646                                    PB-CI-LOAN-1ST-PMT-DT.
  8647
  8648     IF ACCOUNT-MAST-FOUND
  8649        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8650        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8651
  8652
  8653 0300-CONTINUE-EDIT.
  8654
  8655     IF PB-ISSUE
  8656        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8657            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8658
  8659     IF PB-ISSUE
  8660        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8661            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8662
  8663     IF PB-ISSUE
  8664       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8665          (AM-NO-AH-ONLY)
  8666           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 160
* EL050.cbl
  8667               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8668                   MOVE ER-2679 TO WS-ERROR
  8669                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8670
  8671     IF PB-ISSUE
  8672        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8673        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8674        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8675     ELSE
  8676        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8677        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8678        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8679
  8680     MOVE 'N'                    TO PLAN-MASTER-SW
  8681                                    PLAN-MASTER-LIFE-SW
  8682                                    FORM-MASTER-SW
  8683                                    WS-APP-CERT-SW.
  8684
  8685     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8686                                    WS-PL-TOL-LF-REFUND
  8687                                    WS-PL-REF-OVS-AMT
  8688                                    WS-PL-TOL-LF-PREM-PCT
  8689                                    WS-PL-TOL-LF-REFUND-PCT
  8690                                    WS-PL-REF-OVS-PCT
  8691                                    WS-PL-TOL-LF-CLAIM.
  8692
  8693     IF PB-COMPANY-ID = 'NCL'
  8694       IF PB-ISSUE
  8695         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8696             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8697             IF FORM-MASTER-FOUND
  8698                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8699
  8700     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8701        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8702
  8703********************** MON CODE **********************
  8704     IF PB-COMPANY-ID = 'MON'
  8705     IF PB-ISSUE
  8706     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8707        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8708             PB-I-LOAN-APR = ZERO)
  8709               MOVE 14.0         TO PB-I-LOAN-APR.
  8710******************************************************
  8711
  8712     IF PB-COMPANY-ID = 'NCL'
  8713       IF PB-ISSUE
  8714           IF FORM-MASTER-FOUND
  8715             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8716                AM-DISMBR-COVERAGE
  8717                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8718                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8719                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8720                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8721                                           PB-I-LIFE-BENEFIT-CD.
  8722
  8723     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8724
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 161
* EL050.cbl
  8725     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8726         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8727         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8728         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8729         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8730         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8731           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8732             GO TO 0301-LIFE-BENEFIT-SEARCH
  8733         ELSE
  8734             NEXT SENTENCE
  8735     ELSE
  8736         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8737
  8738     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8739     MOVE '4'                    TO CNTL-REC-TYPE.
  8740     MOVE +0                     TO CNTL-SEQ-NO.
  8741     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8742
  8743     MOVE '1' TO RC-SW-2.
  8744     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8745
  8746     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8747        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8748         GO TO 0305-BENEFIT-NOT-FOUND.
  8749
  8750     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8751
  8752 0301-LIFE-BENEFIT-SEARCH.
  8753
  8754     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8755
  8756     IF NO-BENEFIT-FOUND
  8757        GO TO 0305-BENEFIT-NOT-FOUND.
  8758
  8759     IF WS-BEN-CD = '99'
  8760        GO TO 0305-BENEFIT-NOT-FOUND.
  8761
  8762     IF PB-COMPANY-ID = 'NCL'
  8763         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8764             GO TO 0304-LIFE-BENEFIT-FOUND.
  8765
  8766     MOVE +1                     TO SUB5.
  8767     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8768
  8769* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8770* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8771     IF PB-COMPANY-ID = 'DMD'
  8772         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8773
  8774 0302-EDIT-ACCT-LF-BENEFITS.
  8775
  8776     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8777        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8778           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8779                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8780           GO TO 03XX-GET-LIFE-ERPLAN.
  8781
  8782     IF SUB5 LESS THAN +20
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 162
* EL050.cbl
  8783        ADD +1                   TO SUB5
  8784        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8785
  8786     MOVE +1                     TO SUB5.
  8787
  8788     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8789        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8790
  8791 0303-EDIT-DMD-EXTRA-BENEFITS.
  8792
  8793     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8794        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8795           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8796                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8797           GO TO 03XX-GET-LIFE-ERPLAN.
  8798
  8799     IF SUB5 LESS THAN +30
  8800        ADD +1                   TO SUB5
  8801        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8802
  8803     MOVE +1                     TO SUB5.
  8804
  8805 03XX-EDIT-FOR-NINETY-LF.
  8806
  8807***************************************************************
  8808*                                                             *
  8809*    NINETY BENEFIT PLAN TYPES:                               *
  8810*                                                             *
  8811*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8812*      92 = ALL GROUP REDUCING BENEFITS                       *
  8813*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8814*      94 = ALL GROUP LEVEL BENEFITS                          *
  8815*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8816*           BENEFIT CONTROLS.                                 *
  8817*      99 = ALL BENEFITS                                      *
  8818*                                                             *
  8819***************************************************************
  8820
  8821     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8822                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8823
  8824     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8825       AND
  8826        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8827        GO TO 03XX-GET-LIFE-ERPLAN.
  8828
  8829     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8830       AND
  8831        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8832        IF CF-REDUCING (SUB3)
  8833           IF (PB-I-INDV-GRP-OVRD = 'I')
  8834              OR
  8835           ((AM-IG = '1') AND
  8836           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8837              OR
  8838           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8839           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8840           (AM-IG NOT = '2'))
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 163
* EL050.cbl
  8841              GO TO 03XX-GET-LIFE-ERPLAN.
  8842
  8843     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8844       AND
  8845        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8846        IF CF-REDUCING (SUB3)
  8847           IF (PB-I-INDV-GRP-OVRD = 'G')
  8848              OR
  8849           ((AM-IG = '2') AND
  8850           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8851              OR
  8852           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8853           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8854           (AM-IG NOT = '1'))
  8855              GO TO 03XX-GET-LIFE-ERPLAN.
  8856
  8857     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8858       AND
  8859        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8860        IF CF-LEVEL    (SUB3)
  8861           IF (PB-I-INDV-GRP-OVRD = 'I')
  8862              OR
  8863           ((AM-IG = '1') AND
  8864           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8865              OR
  8866           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8867           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8868            (AM-IG NOT = '2'))
  8869              GO TO 03XX-GET-LIFE-ERPLAN.
  8870
  8871     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8872       AND
  8873        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8874        IF CF-LEVEL    (SUB3)
  8875           IF (PB-I-INDV-GRP-OVRD = 'G')
  8876              OR
  8877           ((AM-IG = '2') AND
  8878           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8879              OR
  8880           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8881           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8882           (AM-IG NOT = '1'))
  8883              GO TO 03XX-GET-LIFE-ERPLAN.
  8884
  8885     IF SUB5 LESS THAN +20
  8886        ADD +1                   TO SUB5
  8887        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8888
  8889     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8890
  8891     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8892        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8893
  8894     MOVE +1                     TO SUB5.
  8895
  8896 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8897
  8898     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 164
* EL050.cbl
  8899                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8900
  8901     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8902       AND
  8903        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8904        GO TO 03XX-GET-LIFE-ERPLAN.
  8905
  8906     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8907       AND
  8908        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8909        IF CF-REDUCING (SUB3)
  8910           IF (PB-I-INDV-GRP-OVRD = 'I')
  8911              OR
  8912           ((AM-IG = '1') AND
  8913           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8914              OR
  8915           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8916           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8917           (AM-IG NOT = '2'))
  8918              GO TO 03XX-GET-LIFE-ERPLAN.
  8919
  8920     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8921       AND
  8922        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8923        IF CF-REDUCING (SUB3)
  8924           IF (PB-I-INDV-GRP-OVRD = 'G')
  8925              OR
  8926           ((AM-IG = '2') AND
  8927           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8928              OR
  8929           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8930           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8931           (AM-IG NOT = '1'))
  8932              GO TO 03XX-GET-LIFE-ERPLAN.
  8933
  8934     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8935       AND
  8936        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8937        IF CF-LEVEL    (SUB3)
  8938           IF (PB-I-INDV-GRP-OVRD = 'I')
  8939              OR
  8940           ((AM-IG = '1') AND
  8941           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8942              OR
  8943           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8944           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8945            (AM-IG NOT = '2'))
  8946              GO TO 03XX-GET-LIFE-ERPLAN.
  8947
  8948     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8949       AND
  8950        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8951        IF CF-LEVEL    (SUB3)
  8952           IF (PB-I-INDV-GRP-OVRD = 'G')
  8953              OR
  8954           ((AM-IG = '2') AND
  8955           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8956              OR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 165
* EL050.cbl
  8957           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8958           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8959           (AM-IG NOT = '1'))
  8960              GO TO 03XX-GET-LIFE-ERPLAN.
  8961
  8962     IF SUB5 LESS THAN +30
  8963        ADD +1                   TO SUB5
  8964        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8965
  8966     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8967
  8968 03XX-EDIT-FOR-NINETY-LF-CONT.
  8969
  8970     MOVE +99                    TO SUB5.
  8971
  8972     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8973        IF PB-ISSUE
  8974           MOVE ER-1924          TO  WS-ERROR
  8975           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8976
  8977     GO TO 0304-LIFE-BENEFIT-FOUND.
  8978
  8979 03XX-GET-LIFE-ERPLAN.
  8980
  8981     IF WK-PLAN-ADDR EQUAL +0
  8982        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8983
  8984     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8985     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8986     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8987     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8988     MOVE 'Y'                    TO PLAN-MASTER-SW
  8989                                    PLAN-MASTER-LIFE-SW.
  8990     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8991
  8992 03XX-ERPLAN-LIFE-GETMAIN.
  8993
  8994     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8995     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8996
  8997 03XX-ERPLAN-LIFE-READ.
  8998
  8999     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9000     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9001     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9002     MOVE PB-SV-STATE            TO PLAN-STATE.
  9003     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9004     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  9005     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9006     MOVE WS-SAVE-BENEFIT-REVISION
  9007                                 TO PLAN-REVISION-NO.
  9008
  9009     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9010     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  9011
  9012     IF PB-COMPANY-ID = 'NCL'
  9013       IF NOT LF-PLAN-MASTER-FOUND
  9014         IF NOT PB-POLICY-IS-DECLINED  AND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 166
* EL050.cbl
  9015            NOT PB-POLICY-IS-VOIDED
  9016             MOVE  ER-1921         TO  WS-ERROR
  9017             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9018             GO TO 0304-LIFE-BENEFIT-FOUND.
  9019
  9020     IF NOT LF-PLAN-MASTER-FOUND
  9021        GO TO 0304-LIFE-BENEFIT-FOUND.
  9022
  9023 XXXX-CHECK-LF-PLAN-KEY.
  9024
  9025     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9026        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9027        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9028        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9029        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9030        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9031        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9032        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9033        MOVE 'N'                 TO PLAN-MASTER-SW
  9034          GO TO 03XX-ERPLAN-LIFE-READ.
  9035
  9036     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  9037
  9038     IF  PB-CANCELLATION
  9039         GO TO  0303-LF-ACCT-BEN-FOUND.
  9040
  9041     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9042        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9043           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9044           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9045              MOVE ER-2644             TO WS-ERROR
  9046              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9047           ELSE
  9048              NEXT SENTENCE
  9049        ELSE
  9050           IF PB-COMPANY-ID NOT = 'NCL'
  9051              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9052                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9053
  9054 0303-LF-ACCT-BEN-FOUND.
  9055
  9056     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9057
  9058     IF PL-DEV-CODE NOT = SPACES
  9059        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9060
  9061     IF PL-DEV-PCT NUMERIC AND
  9062        PL-DEV-PCT NOT = ZEROS
  9063        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9064
  9065     IF PL-TOL-PREM-AMT GREATER THAN +0
  9066        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9067
  9068     IF PL-TOL-REF-AMT GREATER THAN +0
  9069        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9070
  9071     IF PL-TOL-PREM-PCT GREATER THAN +0
  9072        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 167
* EL050.cbl
  9073
  9074     IF PL-TOL-REF-PCT GREATER THAN +0
  9075        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9076
  9077     IF PL-TOL-CLM-AMT GREATER THAN +0
  9078        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9079
  9080     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9081                          PL-OVER-SHORT-AMT > +0
  9082        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9083
  9084     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9085                          PL-OVER-SHORT-PCT > +0
  9086        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9087
  9088     IF PL-SALES-TAX NUMERIC AND
  9089                          PL-SALES-TAX > +0
  9090         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9091
  9092     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9093        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9094                                    WS-IG-OVRD-AM.
  9095
  9096 0304-LIFE-BENEFIT-FOUND.
  9097
  9098     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9099
  9100     IF PB-ISSUE
  9101        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9102     ELSE
  9103        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9104
  9105     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9106     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9107     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9108     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9109     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9110                                         WS-LF-REFUND-CALC.
  9111     if (ws-lf-earnings-calc = '5')
  9112        and (pb-i-loan-apr = zeros)
  9113        and (benefit-code-chg)
  9114        move +99.9999 to pb-i-loan-apr
  9115     end-if
  9116
  9117     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9118        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9119
  9120     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9121        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9122     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9123
  9124     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9125     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9126     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9127     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9128     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9129     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9130
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 168
* EL050.cbl
  9131     IF PB-COMPANY-ID = 'NCL'  AND
  9132        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9133         NEXT SENTENCE
  9134     ELSE
  9135         IF SUB5 NOT GREATER THAN +20
  9136            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9137               MOVE WS-SAVE-BENEFIT-REM-TERM
  9138                                      TO WS-AM-LF-BENE-REM-TERM
  9139                                         EC-BR-LF-REM-TERM-CALC.
  9140
  9141     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9142     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9143
  9144     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9145
  9146 0305-BENEFIT-NOT-FOUND.
  9147
  9148     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9149     MOVE ER-2604                TO WS-ERROR.
  9150     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9151
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 169
* EL050.cbl
  9153
  9154 0310-FIND-AH-BENEFIT-RECORD.
  9155
  9156     MOVE 'N'                    TO PLAN-MASTER-SW
  9157                                    PLAN-MASTER-AH-SW.
  9158
  9159     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9160                                    WS-PL-TOL-AH-REFUND
  9161                                    WS-AH-PL-REF-OVS-AMT
  9162                                    WS-PL-TOL-AH-PREM-PCT
  9163                                    WS-PL-TOL-AH-REFUND-PCT
  9164                                    WS-AH-PL-REF-OVS-PCT
  9165                                    WS-PL-TOL-AH-CLAIM.
  9166     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9167
  9168
  9169     if pb-issue
  9170        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9171           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9172        end-if
  9173        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9174           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9175           GO TO 0399-BENEFIT-NOT-FOUND
  9176        end-if
  9177     end-if
  9178
  9179     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9180        GO TO 0400-FIND-CARRIER.
  9181
  9182     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9183
  9184     IF WK-AH-BEN-ADDR NOT = ZEROS
  9185         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9186         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9187         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9188         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9189           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9190             GO TO 0311-AH-BENEFIT-SEARCH
  9191         ELSE
  9192             NEXT SENTENCE
  9193     ELSE
  9194         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9195
  9196     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9197     MOVE '5'                    TO CNTL-REC-TYPE.
  9198     MOVE +0                     TO CNTL-SEQ-NO.
  9199     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9200
  9201     MOVE '2' TO RC-SW-2.
  9202     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9203
  9204     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9205        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9206          GO TO 0399-BENEFIT-NOT-FOUND.
  9207
  9208     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9209
  9210 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 170
* EL050.cbl
  9211
  9212     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9213
  9214     IF NO-BENEFIT-FOUND
  9215         GO TO 0399-BENEFIT-NOT-FOUND.
  9216
  9217     IF WS-BEN-CD = '99'
  9218        GO TO 0399-BENEFIT-NOT-FOUND.
  9219
  9220     IF PB-COMPANY-ID  =  'NCL'
  9221         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9222             GO TO 0314-A-H-BENEFIT-FOUND.
  9223
  9224     MOVE +1                     TO SUB5.
  9225     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9226
  9227* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9228* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9229     IF PB-COMPANY-ID = 'DMD'
  9230         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9231
  9232 0312-EDIT-ACCT-AH-BENEFITS.
  9233
  9234     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9235        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9236           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9237                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9238           GO TO 03XX-GET-AH-ERPLAN.
  9239
  9240     IF SUB5 LESS THAN +20
  9241        ADD +1                   TO SUB5
  9242        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9243
  9244     MOVE +1                     TO SUB5.
  9245
  9246     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9247        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9248
  9249 0313-EDIT-DMD-EXTRA-BENEFITS.
  9250
  9251     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9252        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9253           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9254                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9255           GO TO 03XX-GET-AH-ERPLAN.
  9256
  9257     IF SUB5 LESS THAN +30
  9258        ADD +1                   TO SUB5
  9259        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9260
  9261     MOVE +1                     TO SUB5.
  9262
  9263 03XX-EDIT-FOR-NINETY-AH.
  9264
  9265***************************************************************
  9266*                                                             *
  9267*    NINETY BENEFIT PLAN TYPES:                               *
  9268*                                                             *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 171
* EL050.cbl
  9269*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9270*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9271*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9272*           BENEFIT CONTROLS.                                 *
  9273*      99 = ALL BENEFITS.                                     *
  9274*                                                             *
  9275***************************************************************
  9276
  9277     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9278                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9279
  9280     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9281       AND
  9282        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9283        GO TO 03XX-GET-AH-ERPLAN.
  9284
  9285     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9286       AND
  9287        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9288           IF (PB-I-INDV-GRP-OVRD = 'I')
  9289              OR
  9290           ((AM-IG = '1') AND
  9291           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9292              OR
  9293           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9294           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9295           (AM-IG NOT = '2'))
  9296              GO TO 03XX-GET-AH-ERPLAN.
  9297
  9298     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9299       AND
  9300        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9301           IF (PB-I-INDV-GRP-OVRD = 'G')
  9302              OR
  9303           ((AM-IG = '2') AND
  9304           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9305              OR
  9306           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9307           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9308           (AM-IG NOT = '1'))
  9309              GO TO 03XX-GET-AH-ERPLAN.
  9310
  9311     IF SUB5 LESS THAN +20
  9312        ADD +1                   TO SUB5
  9313        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9314
  9315     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9316        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9317
  9318     MOVE +1                    TO SUB5.
  9319
  9320 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9321
  9322     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9323                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9324
  9325     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9326       AND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 172
* EL050.cbl
  9327        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9328        GO TO 03XX-GET-AH-ERPLAN.
  9329
  9330     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9331       AND
  9332        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9333           IF (PB-I-INDV-GRP-OVRD = 'I')
  9334              OR
  9335           ((AM-IG = '1') AND
  9336           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9337              OR
  9338           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9339           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9340           (AM-IG NOT = '2'))
  9341              GO TO 03XX-GET-AH-ERPLAN.
  9342
  9343     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9344       AND
  9345        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9346           IF (PB-I-INDV-GRP-OVRD = 'G')
  9347              OR
  9348           ((AM-IG = '2') AND
  9349           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9350              OR
  9351           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9352           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9353           (AM-IG NOT = '1'))
  9354              GO TO 03XX-GET-AH-ERPLAN.
  9355
  9356     IF SUB5 LESS THAN +30
  9357        ADD +1                   TO SUB5
  9358        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9359
  9360 03XX-EDIT-FOR-NINETY-AH-CONT.
  9361
  9362     MOVE +99                    TO SUB5.
  9363
  9364     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9365
  9366     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9367        IF PB-ISSUE
  9368           MOVE ER-1925          TO  WS-ERROR
  9369           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9370
  9371     GO TO 0314-A-H-BENEFIT-FOUND.
  9372
  9373 03XX-GET-AH-ERPLAN.
  9374
  9375     IF WK-PLAN-ADDR EQUAL +0
  9376         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9377
  9378     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9379     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9380     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9381     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9382     MOVE 'Y'                    TO PLAN-MASTER-SW
  9383                                    PLAN-MASTER-AH-SW.
  9384*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 173
* EL050.cbl
  9385     GO TO 03XX-ERPLAN-AH-READ.
  9386
  9387 03XX-ERPLAN-AH-GETMAIN.
  9388
  9389     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9390     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9391
  9392 03XX-ERPLAN-AH-READ.
  9393
  9394     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9395     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9396     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9397     MOVE PB-SV-STATE            TO PLAN-STATE.
  9398     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9399     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9400     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9401     MOVE WS-SAVE-BENEFIT-REVISION
  9402                                 TO PLAN-REVISION-NO.
  9403
  9404     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9405     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9406
  9407     IF PB-COMPANY-ID = 'NCL'
  9408       IF NOT AH-PLAN-MASTER-FOUND
  9409         IF NOT PB-POLICY-IS-DECLINED  AND
  9410            NOT PB-POLICY-IS-VOIDED
  9411             MOVE  ER-1922         TO  WS-ERROR
  9412             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9413             GO TO 0314-A-H-BENEFIT-FOUND.
  9414
  9415     IF NOT AH-PLAN-MASTER-FOUND
  9416        GO TO 0314-A-H-BENEFIT-FOUND.
  9417
  9418 XXXX-CHECK-AH-PLAN-KEY.
  9419
  9420     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9421        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9422        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9423        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9424        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9425        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9426        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9427        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9428        MOVE 'N'                 TO PLAN-MASTER-SW
  9429          GO TO 03XX-ERPLAN-AH-READ.
  9430
  9431     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9432
  9433     IF  PB-CANCELLATION
  9434         GO TO  0313-AH-ACCT-BEN-FOUND.
  9435
  9436     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9437       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9438          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9439          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9440             MOVE ER-2644             TO WS-ERROR
  9441             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9442          ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 174
* EL050.cbl
  9443             NEXT SENTENCE
  9444       ELSE
  9445          IF PB-COMPANY-ID NOT = 'NCL'
  9446             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9447                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9448
  9449 0313-AH-ACCT-BEN-FOUND.
  9450
  9451     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9452
  9453     IF PL-DEV-CODE NOT = SPACES
  9454        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9455
  9456     IF PL-DEV-PCT NUMERIC AND
  9457        PL-DEV-PCT NOT = ZEROS
  9458        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9459
  9460     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9461        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9462
  9463     IF PL-TOL-REF-AMT NOT EQUAL +0
  9464        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9465
  9466     IF PL-TOL-PREM-PCT GREATER THAN +0
  9467        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9468
  9469     IF PL-TOL-REF-PCT GREATER THAN +0
  9470        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9471
  9472     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9473        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9474
  9475     IF PL-OVER-SHORT-AMT NUMERIC AND
  9476                          PL-OVER-SHORT-AMT > +0
  9477        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9478
  9479     IF PL-OVER-SHORT-PCT NUMERIC AND
  9480                          PL-OVER-SHORT-PCT > +0
  9481        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9482
  9483     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9484        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9485        IF WS-IG-OVRD-AM EQUAL SPACES
  9486            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9487
  9488 0314-A-H-BENEFIT-FOUND.
  9489
  9490     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9491
  9492     IF PB-ISSUE
  9493        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9494       ELSE
  9495        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9496
  9497     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9498     if cf-maximum-benefits (sub3) numeric
  9499        move cf-maximum-benefits (sub3)
  9500                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 175
* EL050.cbl
  9501     else
  9502        move zeros               to ws-ah-max-bens
  9503     end-if
  9504     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9505     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9506     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9507                                         WS-AH-REFUND-CALC.
  9508
  9509     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9510        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9511
  9512     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9513        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9514     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9515
  9516     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9517     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9518     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9519     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9520     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9521     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9522
  9523     IF PB-COMPANY-ID = 'NCL'  AND
  9524        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9525         NEXT SENTENCE
  9526     ELSE
  9527         IF SUB5 NOT GREATER THAN +20
  9528            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9529                MOVE WS-SAVE-BENEFIT-REM-TERM
  9530                                      TO WS-AM-AH-BENE-REM-TERM
  9531                                         EC-BR-AH-REM-TERM-CALC.
  9532
  9533     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9534     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9535
  9536     GO TO 0400-FIND-CARRIER.
  9537
  9538 0399-BENEFIT-NOT-FOUND.
  9539
  9540     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9541     MOVE ER-2605                TO WS-ERROR.
  9542     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9543
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 176
* EL050.cbl
  9545
  9546 0400-FIND-CARRIER.
  9547
  9548     MOVE PB-SV-CARRIER          TO WS-CARR.
  9549
  9550     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9551     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9552     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9553     MOVE '6'                    TO CNTL-REC-TYPE.
  9554
  9555*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9556     MOVE SPACE                  TO WS-DMD-RATING-SW
  9557                                    EC-BR-DMD-RATING-SW.
  9558
  9559     MOVE '2'                    TO RC-SW-1.
  9560     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9561
  9562     IF NOT CF-CARRIER-MASTER
  9563        GO TO 0400-CARRIER-NOT-FOUND.
  9564
  9565 0400-BUILD-CARR-TOL.
  9566
  9567     IF CF-CR-TOL-PREM NUMERIC AND
  9568        CF-CR-TOL-PREM GREATER THAN +0
  9569        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9570                                    WS-TOL-AH-PREM.
  9571
  9572     IF CF-CR-TOL-REFUND NUMERIC AND
  9573        CF-CR-TOL-REFUND GREATER THAN +0
  9574        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9575                                    WS-TOL-AH-REFUND.
  9576
  9577     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9578        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9579        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9580                                    WS-AH-REFUND-OVS-AMT.
  9581
  9582     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9583        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9584        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9585                                    WS-AH-REFUND-OVS-PCT.
  9586
  9587     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9588        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9589        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9590                                    WS-TOL-AH-PREM-PCT.
  9591
  9592     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9593        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9594        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9595                                     WS-TOL-AH-REFUND-PCT.
  9596
  9597     IF CF-COMPANY-ID EQUAL 'DMD'
  9598         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9599                                    EC-BR-DMD-RATING-SW.
  9600
  9601     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9602     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 177
* EL050.cbl
  9603        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9604     END-IF
  9605     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9606        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9607     END-IF
  9608     IF WS-TOL-CLP-PCT = ZEROS
  9609        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9610     END-IF
  9611
  9612     IF WS-SPP-LEASE-COMM = ZEROS
  9613        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9614     END-IF
  9615     GO TO 0400-FIND-ERPDEF.
  9616
  9617 0400-CARRIER-NOT-FOUND.
  9618
  9619     MOVE ER-2602                TO WS-ERROR.
  9620     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9621
  9622 0400-FIND-ERPDEF.
  9623*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9624     IF (PB-COMPANY-ID = 'DCC')
  9625        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9626        CONTINUE
  9627     ELSE
  9628        GO TO 0400-FIND-ERCOMP
  9629     END-IF
  9630     MOVE ' '                    TO PDEF-MASTER-SW
  9631     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9632     MOVE PB-STATE               TO ERPDEF-STATE
  9633     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9634        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9635     END-IF
  9636     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9637     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9638     IF PB-ISSUE
  9639        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9640     ELSE
  9641        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9642     END-IF
  9643     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9644     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9645     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9646     IF PDEF-MASTER-FOUND
  9647        MOVE 'N'                 TO PDEF-MASTER-SW
  9648        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9649        IF PDEF-MASTER-FOUND
  9650           IF (ERPDEF-KEY-SAVE (1:16) =
  9651                        PD-CONTROL-PRIMARY (1:16))
  9652              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9653              CONTINUE
  9654           ELSE
  9655              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9656              IF (ERPDEF-KEY-SAVE (1:16) =
  9657                        PD-CONTROL-PRIMARY (1:16))
  9658                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9659                 CONTINUE
  9660              ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 178
* EL050.cbl
  9661                 MOVE 'N'        TO PDEF-MASTER-SW
  9662              END-IF
  9663           END-IF
  9664        END-IF
  9665        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9666     END-IF
  9667     IF PDEF-MASTER-FOUND
  9668        IF PD-TRUNCATED = 'Y'
  9669           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9670        END-IF
  9671     END-IF
  9672     .
  9673 0400-FIND-ERCOMP.
  9674     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9675        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9676           (WS-SUB1 > +10)
  9677           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9678                 OR 'A' OR 'N'
  9679              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9680              MOVE PB-CARRIER    TO COMP-CARRIER
  9681              MOVE PB-GROUPING   TO COMP-GROUPING
  9682              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9683              MOVE AM-AGT (WS-SUB1)
  9684                                 TO COMP-FIN-RESP
  9685              MOVE 'G'           TO COMP-TYPE
  9686              PERFORM 8582-READ-COMPENSATION-MASTER
  9687                                 THRU 8582-EXIT
  9688              IF COMP-MASTER-FOUND
  9689                 IF CO-GA-INACTIVE
  9690                    MOVE ER-2763 TO WS-ERROR
  9691                    PERFORM 9900-ERROR-FORMAT
  9692                                 THRU 9900-EXIT
  9693                    MOVE +11     TO WS-SUB1
  9694                 END-IF
  9695                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9696                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9697                    MOVE ER-2788 TO WS-ERROR
  9698                    PERFORM 9900-ERROR-FORMAT
  9699                                 THRU 9900-EXIT
  9700                    MOVE +11     TO WS-SUB1
  9701                 END-IF
  9702              END-IF
  9703           END-IF
  9704        END-PERFORM
  9705     END-IF
  9706     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9707        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9708           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9709                                    WS-CLP-STATE
  9710        ELSE
  9711           MOVE SPACES           TO PB-I-CLP-STATE
  9712                                    WS-CLP-STATE
  9713        END-IF
  9714     END-IF
  9715
  9716     IF (PB-COMPANY-ID = 'DCC')
  9717        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9718        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 179
* EL050.cbl
  9719        CONTINUE
  9720     ELSE
  9721        GO TO 0400-FIND-STATE-RECORD
  9722     END-IF
  9723     MOVE SPACES                 TO WS-CLP-STATE
  9724     MOVE +0                     TO WS-BANK-FEE
  9725                                    WS-BANK-LFEE
  9726                                    WS-BANK-NOCHRGB
  9727
  9728     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9729     IF (PB-ISSUE)
  9730        AND (PB-I-BANK-NUMBER NOT =
  9731            SPACES AND ZEROS AND LOW-VALUES)
  9732        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9733     ELSE
  9734        IF (PB-CANCELLATION)
  9735           AND (PB-CI-BANK-NUMBER NOT =
  9736                SPACES AND ZEROS AND LOW-VALUES)
  9737           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9738        END-IF
  9739     END-IF
  9740     IF COMP-FIN-RESP NOT = LOW-VALUES
  9741        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9742        MOVE PB-CARRIER          TO COMP-CARRIER
  9743        MOVE PB-GROUPING         TO COMP-GROUPING
  9744        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9745        MOVE 'B'                 TO COMP-TYPE
  9746        PERFORM 8582-READ-COMPENSATION-MASTER
  9747                                 THRU 8582-EXIT
  9748        IF COMP-MASTER-FOUND
  9749           IF CO-MAX-BANK-FEE NOT NUMERIC
  9750              MOVE +0            TO CO-MAX-BANK-FEE
  9751           END-IF
  9752           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9753              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9754           END-IF
  9755           IF CO-GA-INACTIVE
  9756              MOVE ER-2763       TO WS-ERROR
  9757              PERFORM 9900-ERROR-FORMAT
  9758                                 THRU 9900-EXIT
  9759           END-IF
  9760           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9761              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9762              MOVE ER-2788 TO WS-ERROR
  9763              PERFORM 9900-ERROR-FORMAT
  9764                                 THRU 9900-EXIT
  9765              MOVE +11     TO WS-SUB1
  9766           END-IF
  9767           IF WS-AH-BEN-CATEGORY = 'G'
  9768              MOVE CO-MAX-BANK-FEE
  9769                                 TO WS-BANK-FEE
  9770                                    PB-I-BANK-FEE
  9771           ELSE
  9772              MOVE CO-MAX-BANK-FEE-LEASE
  9773                                 TO WS-BANK-LFEE
  9774                                    PB-I-BANK-FEE
  9775           END-IF
  9776           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 180
* EL050.cbl
  9777              AND (WS-AH-REFUND-CALC = 'G'))
  9778                        OR
  9779              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9780              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9781              CONTINUE
  9782           ELSE
  9783              MOVE ER-2789 TO WS-ERROR
  9784              PERFORM 9900-ERROR-FORMAT
  9785                                 THRU 9900-EXIT
  9786           END-IF
  9787           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9788                                    PB-I-CLP-STATE
  9789           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9790           MOVE CO-CARRIER       TO BXRF-CARRIER
  9791           MOVE CO-GROUPING      TO BXRF-GROUPING
  9792           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9793           MOVE BXRF-MAX-REC-LENGTH
  9794                                 TO BXRF-REC-LENGTH
  9795           PERFORM 8584-READ-BANK-CROSS-REF
  9796                                 THRU 8584-EXIT
  9797           IF BXRF-MASTER-FOUND
  9798              MOVE ' '           TO BANK-ACCT-SW
  9799              MOVE BK-BANK-POINTER-CNT
  9800                                 TO BK-BANK-POINTER-CNT
  9801              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9802                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9803                 OR (BANK-ACCT-FOUND)
  9804                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9805                    AND (BK-AM-EXP-DT (WS-SUB1)
  9806                                 > PB-CERT-EFF-DT)
  9807                    AND (BK-AM-EFF-DT (WS-SUB1)
  9808                                 NOT > PB-CERT-EFF-DT)
  9809                    SET BANK-ACCT-FOUND TO TRUE
  9810                 END-IF
  9811              END-PERFORM
  9812              IF NOT BANK-ACCT-FOUND
  9813                 MOVE ZEROS      TO WS-BANK-FEE
  9814                                    WS-BANK-LFEE
  9815                 MOVE ER-2869    TO WS-ERROR
  9816                 PERFORM 9900-ERROR-FORMAT
  9817                                 THRU 9900-EXIT
  9818              ELSE
  9819                 PERFORM 5000-PROCESS-REPS
  9820                                 THRU 5000-EXIT
  9821                 IF AGENT-MASTER-FOUND
  9822                    MOVE +0      TO WS-BANK-FEE
  9823                                    WS-BANK-LFEE
  9824*                   MOVE AG-SPP-FEES (1)
  9825*                                TO PB-I-BANK-FEE
  9826*                                   WS-BANK-FEE
  9827                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9828                       (WS-SUB1 > +10)
  9829                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9830                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9831                       END-IF
  9832                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9833                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9834                       END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 181
* EL050.cbl
  9835                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9836                          AG-SPP-FEES (WS-SUB1)
  9837                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9838                          AG-SPP-LFEES (WS-SUB1)
  9839                    END-PERFORM
  9840                    IF WS-AH-BEN-CATEGORY = 'G'
  9841                       MOVE WS-BANK-FEE
  9842                                 TO PB-I-BANK-FEE
  9843                    ELSE
  9844                       MOVE WS-BANK-LFEE
  9845                                 TO PB-I-BANK-FEE
  9846                    END-IF
  9847                 END-IF
  9848              END-IF
  9849           END-IF
  9850        ELSE
  9851           MOVE ER-2879          TO WS-ERROR
  9852           PERFORM 9900-ERROR-FORMAT
  9853                                 THRU 9900-EXIT
  9854        END-IF
  9855     ELSE
  9856        MOVE ER-2879             TO WS-ERROR
  9857        PERFORM 9900-ERROR-FORMAT
  9858                                 THRU 9900-EXIT
  9859     END-IF
  9860     IF WS-AH-BEN-CATEGORY = 'G'
  9861        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9862        + WS-BANK-FEE
  9863     ELSE
  9864        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9865        + WS-BANK-LFEE
  9866     END-IF
  9867     .
  9868 0400-FIND-STATE-RECORD.
  9869
  9870     IF WK-STATE-ADDR NOT = ZEROS
  9871         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9872         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9873         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9874         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9875         IF PB-SV-STATE = CF-STATE-CODE
  9876             GO TO 0405-CONTINUE-EDIT
  9877         ELSE
  9878             NEXT SENTENCE
  9879     ELSE
  9880         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9881
  9882     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9883     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9884     MOVE '3'                    TO CNTL-REC-TYPE.
  9885     MOVE +0                     TO CNTL-SEQ-NO.
  9886
  9887     MOVE '3'                    TO RC-SW-2.
  9888     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9889
  9890     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9891        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9892        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 182
* EL050.cbl
  9893        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9894                                    WS-TOL-AH-CLAIM
  9895                                    WS-MINIMUM-REFUND
  9896                                    WS-TOL-LF-PREM
  9897                                    WS-TOL-AH-PREM
  9898                                    WS-TOL-LF-REFUND
  9899                                    WS-TOL-AH-REFUND
  9900                                    EC-ST-TOL-PREM-PCT
  9901                                    WS-TOL-LF-PREM-PCT
  9902                                    WS-TOL-AH-PREM-PCT
  9903                                    EC-ST-TOL-REFUND-PCT
  9904                                    WS-TOL-LF-REFUND-PCT
  9905                                    WS-TOL-AH-REFUND-PCT
  9906                                    EC-ST-TOL-PREM
  9907                                    EC-ST-TOL-REFUND
  9908                                    EC-ST-FST-PMT-DAYS-MAX
  9909                                    WS-FREE-LOOK-PERIOD
  9910                                    WS-ST-LF-PREM-TAX
  9911                                    WS-ST-AH-PREM-TAX-I
  9912                                    WS-ST-AH-PREM-TAX-G
  9913                                    WS-BANK-FEE
  9914                                    WS-BANK-LFEE
  9915                                    WS-TOL-CLP-PCT
  9916                                    WS-SPP-LEASE-COMM
  9917                                    WS-INT-PERIODS
  9918                                    WS-EXTRA-PMTS
  9919        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9920                                    EC-ST-FST-PMT-DAYS-CHG
  9921                                    WS-LF-REM-TERM-CALC
  9922                                    WS-LF-REFUND-CALC
  9923                                    EC-ST-LF-REM-TERM-CALC
  9924                                    EC-ST-LF-REFUND-CALC
  9925                                    WS-AH-REM-TERM-CALC
  9926                                    WS-AH-REFUND-CALC
  9927                                    WS-LF-BEN-CATEGORY
  9928                                    WS-AH-BEN-CATEGORY
  9929                                    WS-CLP-STATE
  9930                                    WS-ST-REFUND-CLAIM-FLAG
  9931                                    WS-ST-CAUSAL-STATE
  9932                                    ws-st-agent-sig-edit
  9933                                    EC-ST-AH-REM-TERM-CALC
  9934                                    EC-ST-AH-REFUND-CALC
  9935          GO TO 0499-STATE-NOT-FOUND.
  9936
  9937     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9938
  9939 0405-CONTINUE-EDIT.
  9940
  9941     IF (PB-COMPANY-ID <> 'AHL')
  9942        and (pb-issue)
  9943        MOVE +0                  TO SUB3
  9944        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9945        IF SUB3 > +0
  9946           MOVE ER-3270          TO WS-ERROR
  9947           PERFORM 9900-ERROR-FORMAT
  9948                                 THRU 9900-EXIT
  9949        else
  9950           IF PB-CERT-PRIME NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 183
* EL050.cbl
  9951              MOVE ER-2722       TO WS-ERROR
  9952              PERFORM 9900-ERROR-FORMAT
  9953                                 THRU 9900-EXIT
  9954           end-if
  9955        END-IF
  9956     END-IF
  9957     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9958
  9959     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9960        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9961                                    WS-TOL-AH-CLAIM.
  9962
  9963     IF CF-ST-REFUND-MIN NOT NUMERIC
  9964        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9965
  9966     IF CF-ST-REFUND-MIN NOT = ZEROS
  9967        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9968
  9969     IF CF-ST-TOL-PREM  NOT = ZEROS
  9970        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9971                                    WS-TOL-AH-PREM
  9972        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9973
  9974     IF CF-ST-TOL-REFUND NOT = ZEROS
  9975        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9976                                    WS-TOL-AH-REFUND
  9977        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9978
  9979     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9980        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9981        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9982                                    WS-AH-REFUND-OVS-AMT
  9983                                    EC-ST-OVR-SHT-AMT.
  9984
  9985     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9986        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9987        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9988                                    WS-TOL-LF-PREM-PCT
  9989                                    WS-TOL-AH-PREM-PCT.
  9990
  9991     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9992        CF-ST-TOL-REF-PCT GREATER THAN +0
  9993        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9994                                    WS-TOL-LF-REFUND-PCT
  9995                                    WS-TOL-AH-REFUND-PCT.
  9996
  9997     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9998        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9999        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
 10000                                    WS-AH-REFUND-OVS-PCT
 10001                                    EC-ST-OVR-SHT-PCT.
 10002
 10003     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
 10004     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
 10005
 10006     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
 10007          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
 10008
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 184
* EL050.cbl
 10009     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
 10010     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
 10011     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
 10012
 10013     IF CF-ST-LF-PREM-TAX NUMERIC
 10014        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10015     END-IF
 10016     IF CF-ST-AH-PREM-TAX-I NUMERIC
 10017        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10018     END-IF
 10019     IF CF-ST-AH-PREM-TAX-G NUMERIC
 10020        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10021     END-IF
 10022
 10023     IF CF-ST-REF-AH-DEATH-IND > SPACES
 10024         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 10025     END-IF.
 10026
 10027     IF CF-ST-CAUSAL-STATE > SPACES
 10028         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 10029     END-IF.
 10030     if cf-st-extra-interest-periods not numeric
 10031        move zeros               to cf-st-extra-interest-periods
 10032     end-if
 10033     if cf-st-extra-payments not numeric
 10034        move zeros               to cf-st-extra-payments
 10035     end-if
 10036
 10037     move cf-st-extra-interest-periods
 10038                                 to ws-int-periods
 10039     move cf-st-extra-payments   to ws-extra-pmts
 10040     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10041     move cf-st-net-only-state   to ws-net-only-state
 10042     if cf-st-comm-cap-sl not numeric
 10043        move zeros               to cf-st-comm-cap-sl
 10044     end-if
 10045     if cf-st-comm-cap-jl not numeric
 10046        move zeros               to cf-st-comm-cap-jl
 10047     end-if
 10048     if cf-st-comm-cap-sa not numeric
 10049        move zeros               to cf-st-comm-cap-sa
 10050     end-if
 10051     if cf-st-comm-cap-ja not numeric
 10052        move zeros               to cf-st-comm-cap-ja
 10053     end-if
 10054     if cf-st-ga-comm-cap-sl not numeric
 10055        move zeros               to cf-st-ga-comm-cap-sl
 10056     end-if
 10057     if cf-st-ga-comm-cap-jl not numeric
 10058        move zeros               to cf-st-ga-comm-cap-jl
 10059     end-if
 10060     if cf-st-ga-comm-cap-sa not numeric
 10061        move zeros               to cf-st-ga-comm-cap-sa
 10062     end-if
 10063     if cf-st-ga-comm-cap-ja not numeric
 10064        move zeros               to cf-st-ga-comm-cap-ja
 10065     end-if
 10066
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 185
* EL050.cbl
 10067     if cf-st-tot-comm-cap-sl not numeric
 10068        move zeros               to cf-st-tot-comm-cap-sl
 10069     end-if
 10070     if cf-st-tot-comm-cap-jl not numeric
 10071        move zeros               to cf-st-tot-comm-cap-jl
 10072     end-if
 10073     if cf-st-tot-comm-cap-sa not numeric
 10074        move zeros               to cf-st-tot-comm-cap-sa
 10075     end-if
 10076     if cf-st-tot-comm-cap-ja not numeric
 10077        move zeros               to cf-st-tot-comm-cap-ja
 10078     end-if
 10079
 10080     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10081     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10082     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10083     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10084     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10085     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10086     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10087     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10088     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10089     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10090     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10091     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10092     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10093     IF WS-LF-BENEFIT-CD = ZEROS
 10094        GO TO 0410-CHECK-AH.
 10095
 10096     IF CF-ST-RT-CALC NOT = SPACES
 10097        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10098                                    EC-ST-LF-REM-TERM-CALC
 10099     END-IF
 10100
 10101     IF WS-LF-COVERAGE-TYPE = 'R'
 10102        IF WS-LF-EARNINGS-CALC = '5'
 10103           IF CF-ST-RF-LN-CALC > '0'
 10104              MOVE CF-ST-RF-LN-CALC
 10105                                 TO WS-LF-REFUND-CALC
 10106                                    EC-ST-LF-REFUND-CALC
 10107           END-IF
 10108        ELSE
 10109           IF CF-ST-RF-LR-CALC > '0'
 10110              MOVE CF-ST-RF-LR-CALC
 10111                                 TO WS-LF-REFUND-CALC
 10112                                    EC-ST-LF-REFUND-CALC
 10113           END-IF
 10114        END-IF
 10115     ELSE
 10116        IF CF-ST-RF-LL-CALC > '0'
 10117           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10118                                    EC-ST-LF-REFUND-CALC
 10119        END-IF
 10120     END-IF
 10121
 10122     IF CF-ST-RT-CALC NOT = SPACES
 10123        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10124                                    EC-ST-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 186
* EL050.cbl
 10125     END-IF
 10126
 10127     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10128     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10129
 10130     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10131
 10132     IF NO-BENEFIT-FOUND
 10133        GO TO 0410-CHECK-AH.
 10134
 10135     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10136        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10137                                 TO EC-ST-LF-REM-TERM-CALC
 10138                                    WS-LF-REM-TERM-CALC
 10139     END-IF
 10140
 10141     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10142        MOVE CF-ST-REFUND-CALC (SUB3)
 10143                                 TO WS-LF-REFUND-CALC
 10144                                    EC-ST-LF-REFUND-CALC
 10145     END-IF
 10146*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10147     if cf-st-extra-periods (sub3) not numeric
 10148        move zeros               to cf-st-extra-periods (sub3)
 10149     end-if
 10150     if cf-st-extra-periods (sub3) > zeros
 10151        if ws-lf-ben-category = 'P'
 10152           move cf-st-extra-periods (sub3)
 10153                                 to ws-extra-pmts
 10154        else
 10155           if ws-lf-ben-category = 'I'
 10156              move cf-st-extra-periods (sub3)
 10157                                 to ws-int-periods
 10158           end-if
 10159        end-if
 10160     end-if
 10161     .
 10162 0410-CHECK-AH.
 10163
 10164     IF WS-AH-BENEFIT-CD = ZEROS
 10165        GO TO 0500-SET-ACCOUNT.
 10166
 10167     IF CF-ST-RT-CALC NOT = SPACES
 10168        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10169                                    EC-ST-AH-REM-TERM-CALC
 10170     END-IF
 10171
 10172     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10173        IF CF-ST-RF-CP-CALC > '0'
 10174           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10175                                    EC-ST-AH-REFUND-CALC
 10176        END-IF
 10177     ELSE
 10178        IF CF-ST-RF-AH-CALC > '0'
 10179           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10180                                    EC-ST-AH-REFUND-CALC
 10181        END-IF
 10182     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 187
* EL050.cbl
 10183     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10184     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10185
 10186     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10187
 10188     IF NO-BENEFIT-FOUND
 10189        GO TO 0500-SET-ACCOUNT.
 10190
 10191     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10192        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10193                                 TO WS-AH-REM-TERM-CALC
 10194                                    EC-ST-AH-REM-TERM-CALC
 10195     END-IF
 10196
 10197     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10198        MOVE CF-ST-REFUND-CALC (SUB3)
 10199                                 TO WS-AH-REFUND-CALC
 10200                                    EC-ST-AH-REFUND-CALC
 10201     END-IF
 10202
 10203*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10204
 10205     GO TO 0500-SET-ACCOUNT.
 10206
 10207 0499-STATE-NOT-FOUND.
 10208
 10209     MOVE ER-2603                TO WS-ERROR.
 10210     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10211
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 188
* EL050.cbl
 10213
 10214 0500-SET-ACCOUNT.
 10215*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10216     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10217        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10218        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10219        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10220        MOVE '3'                 TO CNTL-REC-TYPE
 10221        MOVE +0                  TO CNTL-SEQ-NO
 10222
 10223        MOVE '3'                 TO RC-SW-2
 10224        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10225
 10226        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10227           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10228           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10229           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10230                                    WS-ST-AH-PREM-TAX-I
 10231                                    WS-ST-AH-PREM-TAX-G
 10232        ELSE
 10233           IF CF-ST-LF-PREM-TAX NUMERIC
 10234              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10235           END-IF
 10236           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10237              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10238           END-IF
 10239           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10240              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10241           END-IF
 10242        END-IF
 10243        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10244     END-IF
 10245*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10246*  FOR DCC ONLY
 10247     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10248
 10249        MOVE ' '                 TO STAT-MASTER-SW
 10250        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10251        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10252        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10253        MOVE PB-STATE            TO ELSTAT-STATE
 10254        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10255           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10256        END-IF
 10257
 10258        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10259        SET BIN-TO-GREG          TO TRUE
 10260        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10261        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10262        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10263
 10264        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10265        IF STAT-MASTER-FOUND
 10266           MOVE 'N'              TO STAT-MASTER-SW
 10267           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10268           IF STAT-MASTER-FOUND
 10269              IF (ELSTAT-KEY-SAVE (1:12) =
 10270                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 189
* EL050.cbl
 10271                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10272                    MOVE 'F'        TO STAT-MASTER-SW
 10273                 ELSE
 10274                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10275                    IF (STAT-MASTER-FOUND)
 10276                       AND (ELSTAT-KEY-SAVE (1:12) =
 10277                           SF-CONTROL-PRIMARY (1:12))
 10278                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10279                       MOVE 'F'     TO STAT-MASTER-SW
 10280                    END-IF
 10281                 END-IF
 10282              END-IF
 10283           END-IF
 10284        END-IF
 10285
 10286        IF STAT-MASTER-SW = 'F'
 10287           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10288              and (sf-st-lf-prem-tax > zeros)
 10289              MOVE SF-ST-LF-PREM-TAX
 10290                                 TO WS-ST-LF-PREM-TAX
 10291           END-IF
 10292           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10293              and (sf-st-ah-prem-tax-i > zeros)
 10294              MOVE SF-ST-AH-PREM-TAX-I
 10295                                 TO WS-ST-AH-PREM-TAX-I
 10296           END-IF
 10297           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10298              and (sf-st-ah-prem-tax-g > zeros)
 10299              MOVE SF-ST-AH-PREM-TAX-G
 10300                                 TO WS-ST-AH-PREM-TAX-G
 10301           END-IF
 10302        END-IF
 10303     END-IF
 10304     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10305        AND (PB-ISSUE)
 10306        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10307        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10308        AND (AM-GPCD = 06)
 10309        MOVE 'Y'                 TO WS-GOOD-HIN
 10310        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10311           MOVE PB-I-VIN         TO WS-WORK-VIN
 10312           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10313              (V1 > 16)
 10314              IF WS-WORK-VIN (V1:1) NUMERIC
 10315                 MOVE WS-WORK-VIN-N (V1)
 10316                                 TO WS-ROW-B-VAL (V1)
 10317              ELSE
 10318                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10319                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10320                    OR (V2 > 26)
 10321                 END-PERFORM
 10322                 IF V2 < 27
 10323                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10324                 ELSE
 10325                    MOVE 'N'     TO WS-GOOD-HIN
 10326                 END-IF
 10327              END-IF
 10328              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 190
* EL050.cbl
 10329                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10330              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10331                 WS-ROW-D-VAL (V1)
 10332           END-PERFORM
 10333           MOVE ZEROS            TO WS-VIN-REMAINDER
 10334           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10335             REMAINDER WS-VIN-REMAINDER
 10336           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10337              CONTINUE
 10338           ELSE
 10339              MOVE 'N'           TO WS-GOOD-HIN
 10340           END-IF
 10341        ELSE
 10342           MOVE 'N'              TO WS-GOOD-HIN
 10343        END-IF
 10344        IF WS-GOOD-HIN NOT = 'Y'
 10345           MOVE ER-3826           TO WS-ERROR
 10346           PERFORM 9900-ERROR-FORMAT
 10347                                 THRU 9900-EXIT
 10348        END-IF
 10349     END-IF
 10350     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10351        AND (PB-ISSUE)
 10352        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10353        AND (AM-GPCD NOT = 06)
 10354        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10355           perform 3400-edit-vin thru 3400-exit
 10356        ELSE
 10357          MOVE ER-3826           TO WS-ERROR
 10358          PERFORM 9900-ERROR-FORMAT
 10359                                 THRU 9900-EXIT
 10360        END-IF
 10361     END-IF
 10362     if (pb-company-id = 'CID')
 10363        and (pb-issue)
 10364        and (pb-i-vin not = spaces and low-values and zeros)
 10365        perform 3400-edit-vin    thru 3400-exit
 10366     end-if
 10367******************************************************************
 10368******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10369******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10370******* METHODS.
 10371******************************************************************
 10372     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10373        IF PB-CANCELLATION
 10374           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10375              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10376                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10377                IF FORM-MASTER-FOUND
 10378                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10379******************************************************************
 10380
 10381     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10382     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10383
 10384     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10385     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10386     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 191
* EL050.cbl
 10387     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10388
 10389
 10390     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10391     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10392     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10393
 10394     IF AM-LF-OB-RATE NOT NUMERIC
 10395         MOVE ZERO               TO AM-LF-OB-RATE.
 10396
 10397     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10398         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10399
 10400     IF AM-AH-OB-RATE NOT NUMERIC
 10401         MOVE ZERO               TO AM-AH-OB-RATE.
 10402
 10403     IF WS-LF-JOINT-INDICATOR = 'J'
 10404         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10405     ELSE
 10406         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10407
 10408     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10409
 10410     IF WS-IG-OVRD-AM  EQUAL SPACE
 10411         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10412
 10413     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10414         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10415                                       WS-IG-OVRD
 10416     ELSE
 10417         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10418             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10419                                       WS-IG-OVRD
 10420         ELSE
 10421             MOVE AM-IG             TO WS-IG-OVRD-AH
 10422                                       WS-IG-OVRD.
 10423
 10424     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10425         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10426                                       WS-IG-OVRD
 10427     ELSE
 10428         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10429             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10430                                       WS-IG-OVRD
 10431         ELSE
 10432             MOVE AM-IG             TO WS-IG-OVRD-LF
 10433                                       WS-IG-OVRD.
 10434
 10435     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10436     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10437     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10438     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10439*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10440     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10441                                              TO 'PRLDSFCTIA'.
 10442
 10443     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10444     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 192
* EL050.cbl
 10445     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10446     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10447
 10448     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10449     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10450     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10451     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10452     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10453     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10454     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10455
 10456     IF WS-ACCT-AH-DEV-PCT > +0
 10457        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10458     ELSE
 10459        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10460
 10461     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10462        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10463     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10464        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10465
 10466        IF AM-EARN-METHOD-L = 'S'
 10467            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10468                                        WS-LF-REFUND-CALC.
 10469
 10470        IF AM-EARN-METHOD-R = 'S'
 10471            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10472                                        WS-LF-REFUND-CALC.
 10473
 10474     IF WS-LF-COVERAGE-TYPE = 'R'
 10475         IF AM-EARN-METHOD-R = 'R'
 10476            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10477                                    WS-LF-REFUND-CALC.
 10478     IF WS-LF-COVERAGE-TYPE = 'R'
 10479         IF AM-EARN-METHOD-R = 'P'
 10480            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10481                                    WS-LF-REFUND-CALC.
 10482     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10483         IF AM-EARN-METHOD-L = 'R'
 10484            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10485                                    WS-LF-REFUND-CALC.
 10486     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10487         IF AM-EARN-METHOD-L = 'P'
 10488            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10489                                    WS-LF-REFUND-CALC.
 10490     IF WS-LF-COVERAGE-TYPE = 'R'
 10491         IF AM-EARN-METHOD-R = 'A'
 10492            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10493                                    WS-LF-REFUND-CALC.
 10494     IF WS-LF-COVERAGE-TYPE = 'R'
 10495         IF AM-EARN-METHOD-R = 'M'
 10496            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10497                                    WS-LF-REFUND-CALC.
 10498     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10499         IF AM-EARN-METHOD-L = 'A'
 10500            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10501                                    WS-LF-REFUND-CALC.
 10502     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 193
* EL050.cbl
 10503         IF AM-EARN-METHOD-L = 'M'
 10504            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10505                                    WS-LF-REFUND-CALC.
 10506
 10507     IF AM-EARN-METHOD-A = 'R'
 10508        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10509                                    WS-AH-REFUND-CALC.
 10510     IF AM-EARN-METHOD-A = 'P'
 10511        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10512                                    WS-AH-REFUND-CALC.
 10513     IF AM-EARN-METHOD-A = 'C'
 10514        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10515                                    WS-AH-REFUND-CALC.
 10516     IF AM-EARN-METHOD-A = 'A'
 10517        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10518                                    WS-AH-REFUND-CALC.
 10519     IF AM-EARN-METHOD-A = 'M'
 10520        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10521                                    WS-AH-REFUND-CALC.
 10522     IF AM-EARN-METHOD-A = 'N'
 10523        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10524                                    WS-AH-REFUND-CALC.
 10525     IF AM-EARN-METHOD-A = 'S'
 10526        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10527                                    WS-AH-REFUND-CALC.
 10528
 10529     IF AM-TOL-PREM NOT = ZEROS
 10530        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10531                                    WS-TOL-AH-PREM.
 10532
 10533     IF AM-OVR-SHT-AMT NUMERIC AND
 10534                  AM-OVR-SHT-AMT > 0
 10535        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10536                                    EC-AM-LF-OVR-SHT-AMT
 10537                                    WS-AH-REFUND-OVS-AMT
 10538                                    EC-AM-AH-OVR-SHT-AMT.
 10539
 10540     IF AM-OVR-SHT-PCT NUMERIC AND
 10541                    AM-OVR-SHT-PCT > 0
 10542        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10543                                    EC-AM-LF-OVR-SHT-PCT
 10544                                    WS-AH-REFUND-OVS-PCT
 10545                                    EC-AM-AH-OVR-SHT-PCT.
 10546
 10547     IF AM-TOL-REF-PCT NUMERIC AND
 10548                  AM-TOL-REF-PCT > 0
 10549        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10550                                    WS-TOL-AH-REFUND-PCT.
 10551
 10552     IF AM-TOL-REF  NOT = ZEROS  AND
 10553                  AM-TOL-REF NUMERIC
 10554        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10555                                    EC-AM-LF-TOL-REFUND
 10556                                    WS-TOL-AH-REFUND
 10557                                    EC-AM-AH-TOL-REFUND.
 10558
 10559     IF AM-TOL-CLM  NOT = ZEROS
 10560        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 194
* EL050.cbl
 10561                                    WS-TOL-AH-CLAIM.
 10562
 10563     IF AM-CLP-TOL-PCT NOT NUMERIC
 10564        MOVE +0                  TO AM-CLP-TOL-PCT
 10565     END-IF
 10566
 10567     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10568        MOVE +0                  TO AM-SPP-LEASE-COMM
 10569     END-IF
 10570     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10571        MOVE WS-PL-TOL-LF-PREM-PCT
 10572                                 TO WS-TOL-LF-PREM-PCT.
 10573
 10574     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10575        MOVE WS-PL-TOL-AH-PREM-PCT
 10576                                 TO WS-TOL-AH-PREM-PCT.
 10577
 10578     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10579        MOVE WS-PL-TOL-LF-REFUND-PCT
 10580                                 TO WS-TOL-LF-REFUND-PCT.
 10581
 10582     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10583        MOVE WS-PL-TOL-AH-REFUND-PCT
 10584                                 TO WS-TOL-AH-REFUND-PCT.
 10585
 10586     IF WS-PL-REF-OVS-AMT > +0
 10587        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10588
 10589     IF WS-PL-REF-OVS-PCT > +0
 10590        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10591
 10592     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10593        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10594     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10595        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10596     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10597        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10598     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10599        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10600     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10601        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10602     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10603        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10604
 10605     IF WS-AH-PL-REF-OVS-AMT > +0
 10606        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10607
 10608     IF WS-AH-PL-REF-OVS-PCT > +0
 10609        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10610
 10611     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10612     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10613
 10614     IF PB-CANCELLATION
 10615        GO TO 3000-CONTINUE-EDIT.
 10616
 10617     MOVE +1 TO SUB1.
 10618     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 195
* EL050.cbl
 10619     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10620
 10621     IF CF-COMPANY-ID = 'DMD'
 10622       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10623         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10624        ELSE
 10625         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10626
 10627  0525-FIND-ACCT-COMM.
 10628     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10629        NEXT SENTENCE
 10630      ELSE
 10631         ADD +1 TO SUB1
 10632         IF SUB1 LESS +11
 10633            GO TO 0525-FIND-ACCT-COMM
 10634          ELSE
 10635             GO TO 0550-st-comm-cap-check.
 10636
 10637     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10638     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10639                                    PB-I-LIFE-COMMISSION.
 10640***  IF PB-COMPANY-ID = 'CRI'
 10641     IF PB-PREM-ACCTNG-ONLY
 10642         GO TO 0550-st-comm-cap-check.
 10643
 10644     MOVE '0530' TO CTBL-SW.
 10645     MOVE ' '    TO WS-CTBL-READ-SW.
 10646
 10647
 10648 0530-GET-AH-COMP.
 10649     IF NO-AH-COVERAGE  OR
 10650        NO-AH-BENEFIT-MATCH
 10651           GO TO 0540-NEXT-READ-STEP.
 10652
 10653     IF AM-A-COM (SUB1) NUMERIC
 10654        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10655         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10656         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10657         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10658         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10659     ELSE
 10660          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10661          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10662          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10663          MOVE ZEROS             TO WS-SUB1
 10664                                    WS-COMMISSION
 10665          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10666          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10667          IF WS-COMMISSION > ZEROS
 10668             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10669             GO TO 0540-NEXT-READ-STEP
 10670          END-IF
 10671          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10672          IF CTBL-TABLE-FOUND
 10673             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10674                                        PB-I-AH-TERM
 10675             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10676             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 196
* EL050.cbl
 10677             GO TO 0540-NEXT-READ-STEP
 10678          ELSE
 10679             IF FIRST-TIME-THROUGH
 10680                 GO TO 0530-GET-AH-COMP
 10681             ELSE
 10682                 MOVE ER-2609                TO WS-ERROR
 10683                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10684
 10685 0540-NEXT-READ-STEP.
 10686     MOVE '0540' TO CTBL-SW.
 10687     MOVE ' '    TO WS-CTBL-READ-SW.
 10688
 10689 0540-GET-LF-COMP.
 10690     IF NO-LIFE-COVERAGE  OR
 10691        NO-LF-BENEFIT-MATCH
 10692           GO TO 0550-st-comm-cap-check.
 10693
 10694     IF WS-LF-JOINT-INDICATOR = 'J'
 10695        IF AM-J-COM (SUB1) NUMERIC
 10696           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10697           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10698           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10699           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10700           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10701        ELSE
 10702           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10703           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10704           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10705           MOVE ZEROS                TO WS-SUB1
 10706                                        WS-COMMISSION
 10707           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10708           IF WS-COMMISSION > ZEROS
 10709              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10710              GO TO 0550-st-comm-cap-check
 10711           END-IF
 10712           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10713           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10714           IF CTBL-TABLE-FOUND
 10715              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10716              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10717              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10718              GO TO 0550-st-comm-cap-check
 10719           ELSE
 10720              IF FIRST-TIME-THROUGH
 10721                  GO TO 0540-GET-LF-COMP
 10722              ELSE
 10723                  MOVE ER-2609                TO WS-ERROR
 10724                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10725                  GO TO 0550-st-comm-cap-check.
 10726
 10727     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10728        IF AM-L-COM (SUB1) NUMERIC
 10729           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10730           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10731           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10732           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10733           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10734        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 197
* EL050.cbl
 10735           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10736           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10737           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10738           MOVE ZEROS                TO WS-SUB1
 10739                                        WS-COMMISSION
 10740           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10741           IF WS-COMMISSION IS GREATER THAN ZEROS
 10742              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10743              GO TO 0550-st-comm-cap-check
 10744           END-IF
 10745           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10746           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10747           IF CTBL-TABLE-FOUND
 10748              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10749              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10750              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10751              GO TO 0550-st-comm-cap-check
 10752           ELSE
 10753              IF FIRST-TIME-THROUGH
 10754                  GO TO 0540-GET-LF-COMP
 10755              ELSE
 10756                  MOVE ER-2609                TO WS-ERROR
 10757                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10758
 10759 0550-st-comm-cap-check.
 10760
 10761     move +0                     to ws-tot-sl-wk-rate
 10762                                    ws-sl-wk-rate
 10763                                    ws-ga-sl-wk-rate
 10764                                    ws-tot-jl-wk-rate
 10765                                    ws-jl-wk-rate
 10766                                    ws-ga-jl-wk-rate
 10767                                    ws-tot-sa-wk-rate
 10768                                    ws-sa-wk-rate
 10769                                    ws-ga-sa-wk-rate
 10770                                    ws-tot-ja-wk-rate
 10771                                    ws-ja-wk-rate
 10772                                    ws-ga-ja-wk-rate
 10773     perform varying sub5 from +1 by +1 until
 10774        (sub5 > +10)
 10775        move +0                  to ws-wk-rate
 10776        if (am-gl-codes (sub5) <> 'Y')
 10777           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10778           if pb-i-lf-benefit-cd <> '  ' and '00'
 10779              move zeros         to ws-wk-rate
 10780              if (am-l-com (sub5) numeric)
 10781                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10782                 move am-l-com(sub5)
 10783                                 to ws-wk-rate
 10784              else
 10785                 move pb-company-cd to ctbl-company-cd
 10786                 move pb-i-lf-benefit-cd
 10787                                 to ctbl-ben-code
 10788                 move pb-i-lf-term  to ws-work-term
 10789                 move pb-life-override-l1
 10790                                 to ctbl-ben-type
 10791                 move zeros      to ws-sub1
 10792                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 198
* EL050.cbl
 10793                 move am-l-coma (sub5)
 10794                                 to ctbl-table
 10795                 move '0540'     to ctbl-sw
 10796                 perform 0552-get-it
 10797                                 thru 0552-exit
 10798              end-if
 10799              compute ws-tot-sl-wk-rate =
 10800                 ws-tot-sl-wk-rate + ws-wk-rate
 10801              if am-com-typ(sub5) = 'C' or 'D'
 10802                 compute ws-sl-wk-rate =
 10803                    ws-sl-wk-rate + ws-wk-rate
 10804              else
 10805                 if am-com-typ(sub5) = 'O' or 'P'
 10806                    compute ws-ga-sl-wk-rate =
 10807                       ws-ga-sl-wk-rate + ws-wk-rate
 10808                 end-if
 10809              end-if
 10810
 10811              move zeros         to ws-wk-rate
 10812              if (am-j-com (sub5) numeric)
 10813                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10814                 move am-j-com(sub5)
 10815                                 to ws-wk-rate
 10816              else
 10817                 move pb-company-cd to ctbl-company-cd
 10818                 move pb-i-lf-benefit-cd
 10819                                 to ctbl-ben-code
 10820                 move pb-i-lf-term  to ws-work-term
 10821                 move pb-life-override-l1
 10822                                 to ctbl-ben-type
 10823                 move zeros      to ws-sub1
 10824                                    ws-commission
 10825                 move am-j-coma (sub5)
 10826                                 to ctbl-table
 10827                 move '0540'     to ctbl-sw
 10828                 perform 0552-get-it
 10829                                 thru 0552-exit
 10830              end-if
 10831              compute ws-tot-jl-wk-rate =
 10832                 ws-tot-jl-wk-rate + ws-wk-rate
 10833              if am-com-typ(sub5) = 'C' or 'D'
 10834                 compute ws-jl-wk-rate =
 10835                    ws-jl-wk-rate + ws-wk-rate
 10836              else
 10837                 if am-com-typ(sub5) = 'O' or 'P'
 10838                    compute ws-ga-jl-wk-rate =
 10839                       ws-ga-jl-wk-rate + ws-wk-rate
 10840                 end-if
 10841              end-if
 10842           end-if
 10843           move zeros            to ws-wk-rate
 10844
 10845           if pb-i-ah-benefit-cd <> '  ' and '00'
 10846              if (am-a-com (sub5) numeric)
 10847                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10848                 move am-a-com(sub5)
 10849                                 to ws-wk-rate
 10850              else
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 199
* EL050.cbl
 10851                 move pb-company-cd to ctbl-company-cd
 10852                 move pb-i-ah-benefit-cd
 10853                                 to ctbl-ben-code
 10854                 move pb-i-ah-term  to ws-work-term
 10855                 move pb-ah-override-l1
 10856                                 to ctbl-ben-type
 10857                 move zeros      to ws-sub1
 10858                                    ws-commission
 10859                 move am-a-coma (sub5)
 10860                                 to ctbl-table
 10861                 move '0530'     to ctbl-sw
 10862                 perform 0552-get-it
 10863                                 thru 0552-exit
 10864              end-if
 10865              compute ws-tot-sa-wk-rate =
 10866                 ws-tot-sa-wk-rate + ws-wk-rate
 10867              if am-com-typ(sub5) = 'C' or 'D'
 10868                 compute ws-sa-wk-rate =
 10869                    ws-sa-wk-rate + ws-wk-rate
 10870              else
 10871                 if am-com-typ(sub5) = 'O' or 'P'
 10872                    compute ws-ga-sa-wk-rate =
 10873                       ws-ga-sa-wk-rate + ws-wk-rate
 10874                 end-if
 10875              end-if
 10876           end-if
 10877        end-if
 10878     end-perform
 10879
 10880     go to 0550-continue
 10881
 10882     .
 10883 0552-get-it.
 10884
 10885     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10886     MOVE ZEROS                  TO WS-SUB1
 10887                                    WS-COMMISSION
 10888     MOVE ' '                    TO WS-CTBL-READ-SW
 10889     PERFORM 8300-READ-CTBL-TABLE
 10890                                 THRU 8300-EXIT
 10891     IF FIRST-TIME-THROUGH
 10892        MOVE 'AA'                TO CTBL-BEN-CODE
 10893        PERFORM 8300-READ-CTBL-TABLE
 10894                                 THRU 8300-EXIT
 10895     END-IF
 10896     IF CTBL-TABLE-FOUND
 10897        if pb-life-override-l1 = ctbl-ben-type
 10898           move pb-i-lf-benefit-amt
 10899                                 to WS-COMM-CK-AMT
 10900        else
 10901           compute ws-comm-ck-amt =
 10902              pb-I-ah-benefit-amt * pb-i-ah-term
 10903        end-if
 10904        PERFORM 8800-GET-COMP-RATE
 10905                                 THRU 8800-EXIT
 10906     else
 10907        move zeros               to ws-wk-rate
 10908     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 200
* EL050.cbl
 10909
 10910     .
 10911 0552-exit.
 10912     exit.
 10913
 10914 0550-continue.
 10915
 10916     if ws-lf-joint-indicator = 'J'
 10917        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10918           and (ws-st-comm-cap-jl <> zeros)
 10919           MOVE ER-1956          TO WS-ERROR
 10920           PERFORM 9900-ERROR-FORMAT
 10921                                 THRU 9900-EXIT
 10922        end-if
 10923        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10924           and (ws-st-ga-comm-cap-jl <> zeros)
 10925           MOVE ER-1959          TO WS-ERROR
 10926           PERFORM 9900-ERROR-FORMAT
 10927                                 THRU 9900-EXIT
 10928        end-if
 10929        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10930           and (ws-st-tot-comm-cap-jl <> zeros)
 10931           MOVE ER-1962          TO WS-ERROR
 10932           PERFORM 9900-ERROR-FORMAT
 10933                                 THRU 9900-EXIT
 10934        end-if
 10935     else
 10936        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10937           and (ws-st-comm-cap-sl <> zeros)
 10938           MOVE ER-1955          TO WS-ERROR
 10939           PERFORM 9900-ERROR-FORMAT
 10940                                 THRU 9900-EXIT
 10941        end-if
 10942        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10943           and (ws-st-ga-comm-cap-sl <> zeros)
 10944           MOVE ER-1958          TO WS-ERROR
 10945           PERFORM 9900-ERROR-FORMAT
 10946                                 THRU 9900-EXIT
 10947        end-if
 10948        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10949           and (ws-st-tot-comm-cap-sl <> zeros)
 10950           MOVE ER-1961          TO WS-ERROR
 10951           PERFORM 9900-ERROR-FORMAT
 10952                                 THRU 9900-EXIT
 10953        end-if
 10954
 10955     if ws-ah-joint-indicator = 'J'
 10956        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10957           and (ws-st-comm-cap-ja <> zeros)
 10958           MOVE ER-1957          TO WS-ERROR
 10959           PERFORM 9900-ERROR-FORMAT
 10960                                 THRU 9900-EXIT
 10961        end-if
 10962        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10963           and (ws-st-ga-comm-cap-ja <> zeros)
 10964           MOVE ER-1960          TO WS-ERROR
 10965           PERFORM 9900-ERROR-FORMAT
 10966                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 201
* EL050.cbl
 10967        end-if
 10968        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10969           and (ws-st-tot-comm-cap-ja <> zeros)
 10970           MOVE ER-1963          TO WS-ERROR
 10971           PERFORM 9900-ERROR-FORMAT
 10972                                 THRU 9900-EXIT
 10973        end-if
 10974     else
 10975        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10976           and (ws-st-comm-cap-sa <> zeros)
 10977           MOVE ER-1957          TO WS-ERROR
 10978           PERFORM 9900-ERROR-FORMAT
 10979                                 THRU 9900-EXIT
 10980        end-if
 10981        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 10982           and (ws-st-ga-comm-cap-sa <> zeros)
 10983           MOVE ER-1960          TO WS-ERROR
 10984           PERFORM 9900-ERROR-FORMAT
 10985                                 THRU 9900-EXIT
 10986        end-if
 10987        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 10988           and (ws-st-tot-comm-cap-sa <> zeros)
 10989           MOVE ER-1963          TO WS-ERROR
 10990           PERFORM 9900-ERROR-FORMAT
 10991                                 THRU 9900-EXIT
 10992        end-if
 10993     end-if
 10994     .
 10995 0560-EDIT-CONTINUE.
 10996     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10997                                    WS-AH-PMF-COMM
 10998*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10999*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 11000     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 11001        (SUB1 > +10)
 11002        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 11003           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 11004           MOVE '0530'           TO CTBL-SW
 11005           MOVE ' '              TO WS-CTBL-READ-SW
 11006           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 11007           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 11008           MOVE '0540'           TO CTBL-SW
 11009           MOVE ' '              TO WS-CTBL-READ-SW
 11010           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 11011        END-IF
 11012     END-PERFORM
 11013     GO TO 0564-EDIT-CONTINUE
 11014     .
 11015 0561-CHECK-AH.
 11016     IF (NO-AH-COVERAGE)
 11017        OR (NO-AH-BENEFIT-MATCH)
 11018        CONTINUE
 11019     ELSE
 11020        IF (AM-A-COM (SUB1) NUMERIC)
 11021           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11022           IF (AM-COM-TYP (SUB1) = 'A')
 11023              AND (WS-AH-PMF-COMM = ZEROS)
 11024              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 202
* EL050.cbl
 11025           END-IF
 11026           CONTINUE
 11027        ELSE
 11028           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 11029           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 11030           MOVE PB-AH-OVERRIDE-L1
 11031                                 TO CTBL-BEN-TYPE
 11032           MOVE ZEROS            TO WS-SUB1
 11033                                    WS-COMMISSION
 11034           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11035           PERFORM 8300-READ-CTBL-TABLE
 11036                                 THRU 8300-EXIT
 11037           IF CTBL-TABLE-FOUND
 11038              IF (AM-COM-TYP (SUB1) = 'A')
 11039                 AND (WS-AH-PMF-COMM = ZEROS)
 11040                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11041                                        PB-I-AH-TERM
 11042                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11043                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11044              END-IF
 11045              CONTINUE
 11046           ELSE
 11047              IF FIRST-TIME-THROUGH
 11048                 GO TO 0561-CHECK-AH
 11049              ELSE
 11050                 MOVE ER-2609    TO WS-ERROR
 11051                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11052              END-IF
 11053           END-IF
 11054        END-IF
 11055     END-IF
 11056     .
 11057 0561-EXIT.
 11058     EXIT.
 11059 0563-CHECK-LF.
 11060     IF (NO-LIFE-COVERAGE)
 11061        OR (NO-LF-BENEFIT-MATCH)
 11062        CONTINUE
 11063     ELSE
 11064        IF WS-LF-JOINT-INDICATOR = 'J'
 11065           IF AM-J-COM (SUB1) NUMERIC
 11066              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11067              IF (AM-COM-TYP (SUB1) = 'A')
 11068                 AND (WS-LF-PMF-COMM = ZEROS)
 11069                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11070              END-IF
 11071              CONTINUE
 11072           ELSE
 11073              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11074              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11075              MOVE PB-LIFE-OVERRIDE-L1
 11076                                 TO CTBL-BEN-TYPE
 11077              MOVE ZEROS         TO WS-SUB1
 11078                                    WS-COMMISSION
 11079              MOVE AM-J-COMA (SUB1)
 11080                                 TO CTBL-TABLE
 11081              PERFORM 8300-READ-CTBL-TABLE
 11082                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 203
* EL050.cbl
 11083              IF CTBL-TABLE-FOUND
 11084                 IF (AM-COM-TYP (SUB1) = 'A')
 11085                    AND (WS-LF-PMF-COMM = ZEROS)
 11086                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11087                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11088                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11089                 END-IF
 11090                 CONTINUE
 11091              ELSE
 11092                 IF FIRST-TIME-THROUGH
 11093                    GO TO 0563-CHECK-LF
 11094                 ELSE
 11095                    MOVE ER-2609 TO WS-ERROR
 11096                    PERFORM 9900-ERROR-FORMAT
 11097                                 THRU 9900-EXIT
 11098*                   GO TO 0560-EDIT-CONTINUE
 11099                 END-IF
 11100              END-IF
 11101           END-IF
 11102        ELSE
 11103           IF AM-L-COM (SUB1) NUMERIC
 11104              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11105              IF (AM-COM-TYP (SUB1) = 'A')
 11106                 AND (WS-LF-PMF-COMM = ZEROS)
 11107                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11108              END-IF
 11109              CONTINUE
 11110           ELSE
 11111              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11112              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11113              MOVE PB-LIFE-OVERRIDE-L1
 11114                                 TO CTBL-BEN-TYPE
 11115              MOVE ZEROS         TO WS-SUB1
 11116                                    WS-COMMISSION
 11117              MOVE AM-L-COMA (SUB1)
 11118                                 TO CTBL-TABLE
 11119              PERFORM 8300-READ-CTBL-TABLE
 11120                                 THRU 8300-EXIT
 11121              IF CTBL-TABLE-FOUND
 11122                 CONTINUE
 11123              ELSE
 11124                 IF FIRST-TIME-THROUGH
 11125                    GO TO 0563-CHECK-LF
 11126                 ELSE
 11127                    MOVE ER-2609 TO WS-ERROR
 11128                    PERFORM 9900-ERROR-FORMAT
 11129                                 THRU 9900-EXIT
 11130                 END-IF
 11131              END-IF
 11132           END-IF
 11133        END-IF
 11134     END-IF
 11135     .
 11136 0563-EXIT.
 11137     EXIT.
 11138 0564-EDIT-CONTINUE.
 11139
 11140     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 204
* EL050.cbl
 11141         IF PB-I-NUM-BILLED EQUAL ZEROS
 11142            MOVE ER-8148       TO WS-ERROR
 11143            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11144
 11145*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11146*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11147*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11148*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11149*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11150*         IF NO-CONVERSION-ERROR
 11151*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11152*         ELSE
 11153*             IF PB-COMPANY-ID EQUAL 'HAN'
 11154*                 MOVE ZEROS     TO PB-I-AGE.
 11155     IF PB-I-BIRTHDAY > LOW-VALUES
 11156        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11157        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11158        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11159        PERFORM 8500-DATE-CONVERT
 11160                                 THRU 8500-EXIT
 11161        IF NO-CONVERSION-ERROR
 11162           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11163           IF PB-I-AGE > ZEROS
 11164              IF WS-WORK-AGE NOT = PB-I-AGE
 11165                 MOVE ER-9501    TO WS-ERROR
 11166                 PERFORM 9900-ERROR-FORMAT
 11167                                 THRU 9900-EXIT
 11168              END-IF
 11169           ELSE
 11170              MOVE WS-WORK-AGE   TO PB-I-AGE
 11171           END-IF
 11172        END-IF
 11173     END-IF
 11174     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11175                                   WS-INS-AGE-SET
 11176     IF PB-I-AGE = ZEROS
 11177        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11178           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11179                                   WS-INS-AGE-SET
 11180           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11181
 11182     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11183                                   WS-AH-EDIT-AGE.
 11184
 11185     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11186        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11187        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11188        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11189        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11190        IF NO-CONVERSION-ERROR
 11191           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11192           IF PB-I-JOINT-AGE > 0
 11193              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11194                 MOVE ER-9503    TO WS-ERROR
 11195                 PERFORM 9900-ERROR-FORMAT
 11196                                 THRU 9900-EXIT
 11197              END-IF
 11198           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 205
* EL050.cbl
 11199              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11200           END-IF
 11201        ELSE
 11202           MOVE ZEROS            TO PB-I-JOINT-AGE
 11203        END-IF
 11204     END-IF
 11205     IF PB-I-JOINT-AGE NOT NUMERIC
 11206        MOVE ZERO               TO PB-I-JOINT-AGE.
 11207
 11208     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11209                                   WS-JNT-AGE-SET
 11210     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11211        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11212           (WS-AH-JOINT-INDICATOR = 'J')
 11213           IF PB-I-JOINT-AGE = ZEROS
 11214               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11215                                          WS-JNT-AGE-SET
 11216               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11217           END-IF
 11218        END-IF
 11219     END-IF
 11220
 11221     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11222     IF WS-LF-JOINT-INDICATOR = 'J'
 11223        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11224        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11225            IF  PB-I-JOINT-AGE = ZERO
 11226                MOVE ER-2686       TO WS-ERROR
 11227                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11228            ELSE
 11229                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11230                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11231                    IF PB-COMPANY-ID NOT = 'LBL'
 11232                        MOVE ER-2685    TO WS-ERROR
 11233                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11234
 11235     IF WS-AH-JOINT-INDICATOR = 'J'
 11236        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11237            IF  PB-I-JOINT-AGE = ZERO
 11238                MOVE ER-2686       TO WS-ERROR
 11239                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11240            ELSE
 11241                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11242                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11243                                           WS-EDIT-AGE
 11244                    IF PB-COMPANY-ID NOT = 'LBL'
 11245                        MOVE ER-2685    TO WS-ERROR
 11246                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11247
 11248******************************************************************
 11249*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11250******************************************************************
 11251
 11252     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11253        (WS-AH-SPECIAL-CALC-CD = 'O')
 11254        NEXT SENTENCE
 11255     ELSE
 11256        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 206
* EL050.cbl
 11257          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11258           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11259            WS-AH-JOINT-INDICATOR = 'J')  AND
 11260           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11261            MOVE ER-2627             TO WS-ERROR
 11262            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11263
 11264     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11265        (WS-AH-SPECIAL-CALC-CD = 'O')
 11266         NEXT SENTENCE
 11267     ELSE
 11268         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11269            WS-AH-JOINT-INDICATOR = 'J'
 11270             IF PB-I-JOINT-INSURED = SPACES
 11271                 IF PB-COMPANY-ID NOT = 'JAL'
 11272                     MOVE ER-2696    TO WS-ERROR
 11273                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11274
 11275     IF PB-COMPANY-ID NOT = 'BOA'
 11276        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11277           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11278           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11279               PB-I-JOINT-INSURED NOT = SPACES)
 11280                MOVE ER-2691         TO WS-ERROR
 11281                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11282
 11283     IF PB-COMPANY-ID = 'BOA'
 11284        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11285           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11286            IF PB-I-JOINT-AGE NOT = ZEROS
 11287                MOVE ER-2691         TO WS-ERROR
 11288                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11289
 11290     IF PB-COMPANY-ID = 'CRI'
 11291        IF PB-I-SIG-SW = 'J'
 11292           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11293              WS-AH-JOINT-INDICATOR NOT = 'J'
 11294              MOVE ER-2675       TO WS-ERROR
 11295              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11296
 11297     IF PB-COMPANY-ID = 'CRI'
 11298        IF PB-I-SIG-SW = 'S'
 11299           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11300              WS-AH-JOINT-INDICATOR = 'J'
 11301              MOVE ER-2676       TO WS-ERROR
 11302              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11303
 11304     IF PB-COMPANY-ID = 'CVL'
 11305         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11306            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11307              MOVE ER-2783           TO WS-ERROR
 11308              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11309     IF (WS-LF-JOINT-INDICATOR = 'J')
 11310        AND (WS-AH-JOINT-INDICATOR = 'J')
 11311        AND (PB-I-LF-TERM > 120)
 11312        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11313        MOVE ER-2783             TO WS-ERROR
 11314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 207
* EL050.cbl
 11315     END-IF
 11316     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11317
 11318     IF PB-I-INDV-GRP-OVRD = 'I'
 11319        MOVE ER-2666             TO WS-ERROR
 11320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11321        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11322
 11323     IF PB-I-INDV-GRP-OVRD = 'G'
 11324        MOVE ER-2666             TO WS-ERROR
 11325        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11326        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11327
 11328     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11329        NEXT SENTENCE
 11330     ELSE
 11331        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11332
 11333     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11334        IF WS-ERROR = ER-2666
 11335           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11336           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11337
 11338     IF PB-COMPANY-ID = 'CID'
 11339        IF PB-STATE = 'UT' OR 'MO'
 11340           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11341                 OR '76' OR '77')
 11342                      OR
 11343               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11344                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11345                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11346                   OR '2K' OR '2L'))
 11347              AND PB-I-INDV-GRP-CD = 'I'
 11348              MOVE ER-2721             TO WS-ERROR
 11349              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11350           END-IF
 11351        END-IF
 11352     END-IF
 11353
 11354     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11355     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11356        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11357     ELSE
 11358        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11359     END-IF
 11360
 11361*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11362*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11363     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11364                                    ACCOUNT-AH-CK-SW.
 11365
 11366     IF PB-REISSUED-CERT       OR
 11367        PB-REIN-ONLY-CERT      OR
 11368        PB-POLICY-IS-DECLINED  OR
 11369        PB-POLICY-IS-VOIDED
 11370*       OR PB-MONTHLY-CERT
 11371         GO TO 3000-CONTINUE-EDIT.
 11372
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 208
* EL050.cbl
 11373     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11374        IF WS-EDIT-AGE           > +65
 11375           MOVE ER-2709          TO WS-ERROR
 11376           PERFORM 9900-ERROR-FORMAT
 11377                                 THRU 9900-EXIT
 11378        ELSE
 11379           IF WS-EDIT-AGE        > +55
 11380              MOVE ER-2718       TO WS-ERROR
 11381              PERFORM 9900-ERROR-FORMAT
 11382                                 THRU 9900-EXIT
 11383           END-IF
 11384        END-IF
 11385     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11386        IF WS-EDIT-AGE           > +65
 11387           MOVE ER-2709          TO WS-ERROR
 11388           PERFORM 9900-ERROR-FORMAT
 11389                                 THRU 9900-EXIT
 11390        END-IF
 11391     END-IF
 11392     .
 11393
 11394 0565-LIFE-PLAN-LIMIT-EDITS.
 11395
 11396     IF NOT LF-PLAN-MASTER-FOUND
 11397        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11398                                    EC-AM-LF-MAX-TOT-BEN
 11399        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11400
 11401     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11402
 11403     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11404         IF PL-LM-AGE (1) = ZEROS
 11405             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11406
 11407     IF NO-LF-BENEFIT-MATCH          OR
 11408        WS-LF-BENEFIT-CD = ZEROS     OR
 11409        WS-LF-SPECIAL-CALC-CD = 'M'
 11410        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11411
 11412     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11413     MOVE +1                     TO SUB2.
 11414
 11415     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11416        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11417           MOVE +5   TO SUB2
 11418           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11419              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11420              (PL-LM-AGE (SUB2) EQUAL +0)
 11421              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11422              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11423
 11424     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11425
 11426     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11427                               + PB-I-LF-ALT-BENEFIT-AMT.
 11428
 11429 0568-CHECK-LIFE-ATT-AGE.
 11430
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 209
* EL050.cbl
 11431     IF PL-ATT-AGE NUMERIC AND
 11432        PL-ATT-AGE > +0
 11433        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11434     END-IF
 11435*    IF PL-ATT-AGE NUMERIC AND
 11436*       PL-ATT-AGE > +0
 11437*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11438*       IF PB-I-BIRTHDAY > LOW-VALUES
 11439*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11440*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11441*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11442*          SET BIN-PLUS-ELAPSED  TO TRUE
 11443*          PERFORM 8500-DATE-CONVERT
 11444*                                THRU 8500-EXIT
 11445*          IF NO-CONVERSION-ERROR
 11446*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11447*             MOVE ER-2669       TO WS-ERROR
 11448*             PERFORM 9900-ERROR-FORMAT
 11449*                                THRU 9900-EXIT
 11450*          END-IF
 11451*       ELSE
 11452*          IF WS-ATT-AGE >= PL-ATT-AGE
 11453*             MOVE ER-2669       TO WS-ERROR
 11454*             PERFORM 9900-ERROR-FORMAT
 11455*                                THRU 9900-EXIT
 11456*          END-IF
 11457*       END-IF
 11458*    END-IF
 11459     .
 11460 0570-CHECK-LIFE-LIMITS.
 11461
 11462     IF PB-COMPANY-ID EQUAL 'CRI'
 11463        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11464           IF SUB2 GREATER THAN +4
 11465              MOVE ER-2637 TO WS-ERROR
 11466              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11467              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11468
 11469     IF PB-COMPANY-ID  =  'NCL'
 11470        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11471            SUB2 GREATER THAN +8
 11472             MOVE 'U'         TO PB-BATCH-ENTRY
 11473             MOVE ER-2637     TO WS-ERROR
 11474             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11475             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11476
 11477     IF SUB2 > +8
 11478        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11479           AND (PB-I-SIG-SW = 'Y')
 11480           CONTINUE
 11481        ELSE
 11482           MOVE ER-2637          TO WS-ERROR
 11483           PERFORM 9900-ERROR-FORMAT
 11484                                 THRU 9900-EXIT
 11485        END-IF
 11486        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11487     END-IF
 11488     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 210
* EL050.cbl
 11489     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11490     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11491
 11492     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11493        ADD +1  TO SUB2
 11494        GO TO 0570-CHECK-LIFE-LIMITS.
 11495
 11496     IF PB-COMPANY-ID = 'NCL'
 11497         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11498
 11499     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11500        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11501        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11502           AND (PB-I-SIG-SW = 'Y')
 11503           CONTINUE
 11504        ELSE
 11505           MOVE ER-2637          TO WS-ERROR
 11506           PERFORM 9900-ERROR-FORMAT
 11507                                 THRU 9900-EXIT
 11508        END-IF
 11509     END-IF
 11510     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11511
 11512
 11513 0570-CHECK-NCL-LIFE-LIMITS.
 11514
 11515     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11516        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11517         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11518
 11519     IF APP-CERT-USED
 11520         IF SUB2  LESS THAN  +5
 11521             MOVE +5          TO SUB2
 11522             GO TO 0570-CHECK-LIFE-LIMITS.
 11523
 11524     MOVE ER-2637             TO WS-ERROR.
 11525     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11526
 11527     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11528
 11529 0575-CHECK-NCL-SIG-SWITCH.
 11530
 11531     IF NOT APP-CERT-USED
 11532         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11533
 11534     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11535        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11536        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11537        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11538         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11539
 11540     IF SUB2 GREATER THAN +4
 11541         IF PL-LM-AGE (5) = ZEROS  AND
 11542            PL-LM-AGE (6) = ZEROS  AND
 11543            PL-LM-AGE (7) = ZEROS  AND
 11544            PL-LM-AGE (8) = ZEROS
 11545             MOVE  ER-1927        TO WS-ERROR
 11546             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 211
* EL050.cbl
 11547             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11548         ELSE
 11549             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11550                 MOVE  ER-1920    TO WS-ERROR
 11551                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11552
 11553     IF PB-I-SIG-SW  = 'Y'
 11554       IF NOT PB-I-POLICY-ACCEPTED  AND
 11555          NOT PB-I-POLICY-DECLINED
 11556           MOVE 'U'               TO PB-BATCH-ENTRY
 11557           MOVE  ER-1926          TO WS-ERROR
 11558           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11559
 11560
 11561 0580-AH-PLAN-LIMIT-EDITS.
 11562
 11563     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11564        IF PB-I-AH-BENEFIT-AMT > +1250
 11565           MOVE ER-2702          TO WS-ERROR
 11566           PERFORM 9900-ERROR-FORMAT
 11567                                 THRU 9900-EXIT
 11568        END-IF
 11569     END-IF
 11570
 11571     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11572        AND (PB-MONTHLY-CERT)
 11573        IF PB-I-AH-BENEFIT-AMT > +3000
 11574           MOVE ER-2881          TO WS-ERROR
 11575           PERFORM 9900-ERROR-FORMAT
 11576                                 THRU 9900-EXIT
 11577        END-IF
 11578     END-IF
 11579     IF NOT AH-PLAN-MASTER-FOUND
 11580        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11581        GO TO 3000-CONTINUE-EDIT.
 11582
 11583     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11584
 11585     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11586         IF PL-LM-AGE (1) = ZEROS
 11587             GO TO 3000-CONTINUE-EDIT.
 11588
 11589     IF NO-AH-BENEFIT-MATCH          OR
 11590        WS-AH-BENEFIT-CD = ZEROS     OR
 11591        WS-AH-SPECIAL-CALC-CD = 'M'
 11592        GO TO 3000-CONTINUE-EDIT.
 11593
 11594     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11595     MOVE +1                     TO SUB2.
 11596
 11597     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11598        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11599           MOVE +5 TO SUB2
 11600           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11601              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11602              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11603              (PL-LM-AGE (SUB2) EQUAL +0)
 11604              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 212
* EL050.cbl
 11605              GO TO 3000-CONTINUE-EDIT.
 11606
 11607     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11608
 11609 0590-CHECK-AH-ATT-AGE.
 11610
 11611     IF PL-ATT-AGE NUMERIC AND
 11612        PL-ATT-AGE GREATER THAN +0
 11613        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11614     END-IF
 11615*       IF WS-ATT-AGE >= PL-ATT-AGE
 11616*          MOVE ER-3054          TO WS-ERROR
 11617*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11618     .
 11619 0597-CHECK-AH-LIMITS.
 11620
 11621     IF PB-COMPANY-ID EQUAL 'CRI'
 11622        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11623           IF SUB2 GREATER THAN +4
 11624              MOVE ER-2638       TO WS-ERROR
 11625              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11626              GO TO 3000-CONTINUE-EDIT.
 11627
 11628     IF PB-COMPANY-ID  =  'NCL'
 11629        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11630            SUB2 GREATER THAN +8
 11631             MOVE 'U'            TO PB-BATCH-ENTRY
 11632             MOVE ER-2638        TO WS-ERROR
 11633             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11634             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11635
 11636     IF SUB2 > +8
 11637        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11638           AND (PB-I-SIG-SW = 'Y')
 11639           CONTINUE
 11640        ELSE
 11641           MOVE ER-2638          TO WS-ERROR
 11642           PERFORM 9900-ERROR-FORMAT
 11643                                 THRU 9900-EXIT
 11644        END-IF
 11645        GO TO 3000-CONTINUE-EDIT
 11646     END-IF
 11647
 11648     IF PB-COMPANY-ID = 'CRI'
 11649        IF WS-ERROR = ER-2638
 11650           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11651
 11652     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11653     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11654     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11655     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11656
 11657     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11658        ADD +1                   TO SUB2
 11659        GO TO 0597-CHECK-AH-LIMITS.
 11660
 11661     IF PB-COMPANY-ID = 'NCL'
 11662         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 213
* EL050.cbl
 11663
 11664     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11665        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11666        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11667                                 > PL-LM-AMT (SUB2))
 11668        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11669           AND (PB-I-SIG-SW = 'Y')
 11670           CONTINUE
 11671        ELSE
 11672           MOVE ER-2638          TO WS-ERROR
 11673           PERFORM 9900-ERROR-FORMAT
 11674                                 THRU 9900-EXIT
 11675        END-IF
 11676     END-IF
 11677
 11678     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11679         IF  WS-ERROR    EQUAL    ER-2638
 11680             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11681                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11682                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11683                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11684                MOVE  ER-1910    TO  WS-ERROR
 11685                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11686
 11687     IF PB-COMPANY-ID = 'CRI'
 11688        IF WS-ERROR = ER-2638
 11689            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11690            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11691            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11692
 11693     GO TO 3000-CONTINUE-EDIT.
 11694
 11695 0597-CHECK-NCL-AH-LIMITS.
 11696
 11697     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11698        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11699        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11700                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11701         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11702
 11703     IF APP-CERT-USED
 11704         IF SUB2  LESS THAN  +5
 11705             MOVE +5             TO SUB2
 11706             GO TO 0597-CHECK-AH-LIMITS.
 11707
 11708     MOVE ER-2638                TO WS-ERROR.
 11709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11710
 11711     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11712
 11713 0599-CHECK-NCL-SIG-SWITCH.
 11714
 11715     IF NOT APP-CERT-USED
 11716         GO TO 3000-CONTINUE-EDIT.
 11717
 11718     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11719        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11720        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 214
* EL050.cbl
 11721        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11722         GO TO 3000-CONTINUE-EDIT.
 11723
 11724     IF SUB2 GREATER THAN +4
 11725         IF PL-LM-AGE (5) = ZEROS  AND
 11726            PL-LM-AGE (6) = ZEROS  AND
 11727            PL-LM-AGE (7) = ZEROS  AND
 11728            PL-LM-AGE (8) = ZEROS
 11729             MOVE  ER-1927        TO WS-ERROR
 11730             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11731             GO TO 3000-CONTINUE-EDIT
 11732         ELSE
 11733             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11734                 MOVE  ER-1920    TO WS-ERROR
 11735                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11736
 11737     IF PB-I-SIG-SW  = 'Y'
 11738       IF NOT PB-I-POLICY-ACCEPTED  AND
 11739          NOT PB-I-POLICY-DECLINED
 11740           MOVE 'U'               TO PB-BATCH-ENTRY
 11741           MOVE  ER-1926          TO WS-ERROR
 11742           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11743
 11744******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 215
* EL050.cbl
 11746
 11747 3000-CONTINUE-EDIT.
 11748
 11749     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11750     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11751     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11752     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11753     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11754
 11755     IF BROWSE-STARTED
 11756        PERFORM 9990-RETURN THRU 9990-EXIT
 11757        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11758
 11759     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11760        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11761        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11762        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11763*       MOVE 1                   TO DC-OPTION-CODE
 11764        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11765        IF DATE-CONVERSION-ERROR
 11766           MOVE ER-2622          TO WS-ERROR
 11767           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11768        ELSE
 11769           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11770              MOVE ER-2623       TO WS-ERROR
 11771              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11772           ELSE
 11773              MOVE ER-2622       TO WS-ERROR
 11774              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11775
 11776     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11777     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11778     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11779*    MOVE 1                      TO DC-OPTION-CODE.
 11780     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11781     IF DATE-CONVERSION-ERROR
 11782        GO TO 3005-EDIT-CONTINUE
 11783     ELSE
 11784        IF DC-ELAPSED-DAYS GREATER +180
 11785           MOVE ER-2613          TO WS-ERROR
 11786           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11787        ELSE
 11788           IF DC-ELAPSED-DAYS GREATER +90
 11789              MOVE ER-2612       TO WS-ERROR
 11790              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11791           ELSE
 11792             IF DC-ELAPSED-DAYS GREATER +60
 11793                MOVE ER-2614     TO WS-ERROR
 11794                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11795
 11796 3005-EDIT-CONTINUE.
 11797
 11798     IF PB-CANCELLATION
 11799         GO TO 3700-EDIT-CANCEL.
 11800
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 216
* EL050.cbl
 11802******************************************************************
 11803*                  E D I T   I S S U E                           *
 11804******************************************************************
 11805
 11806 3020-EDIT-ISSUE.
 11807
 11808      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11809      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11810      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11811      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11812      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11813
 11814     IF PB-ISSUE-FORCE
 11815        OR PB-ISSUE-DATE-FORCED
 11816        OR PB-FORCE-OFF
 11817        OR PB-OVERCHARGE-FORCE
 11818        or pb-exceeded-limit-forced
 11819        CONTINUE
 11820     ELSE
 11821        MOVE ER-2670             TO WS-ERROR
 11822        PERFORM 9900-ERROR-FORMAT
 11823                                 THRU 9900-EXIT
 11824     END-IF
 11825     .
 11826 3022-SET-POLICY-STATUS.
 11827
 11828     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11829
 11830     IF (PB-REISSUED-CERT)
 11831             OR
 11832        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11833         AND (PB-MONTHLY-CERT))
 11834         MOVE '5'                TO PB-I-ENTRY-STATUS
 11835         MOVE 'E'                TO PB-BATCH-ENTRY
 11836     END-IF
 11837
 11838     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11839        IF PB-MONTHLY-CERT
 11840           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11841        END-IF
 11842        IF PB-CASH-CERT
 11843           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11844        END-IF
 11845     END-IF
 11846     IF PB-POLICY-IS-DECLINED
 11847         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11848     IF PB-POLICY-IS-VOIDED
 11849         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11850     IF PB-NEEDS-UNDERWRITING
 11851         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11852     IF PB-REIN-ONLY-CERT
 11853         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11854     IF PB-PREM-ACCTNG-ONLY
 11855         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11856
 11857     MOVE SPACE                  TO PB-I-OB-FLAG.
 11858
 11859     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 217
* EL050.cbl
 11860         MOVE ER-2665            TO WS-ERROR
 11861         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11862         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11863
 11864     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11865        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11866           MOVE 'Z'             TO PB-I-OB-FLAG.
 11867
 11868     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11869        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11870           MOVE 'Z'             TO PB-I-OB-FLAG.
 11871
 11872     IF ACCOUNT-MAST-FOUND
 11873         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11874         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11875         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11876         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11877         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11878         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11879         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11880     END-IF
 11881
 11882     IF ACCOUNT-MAST-FOUND
 11883        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11884         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11885
 11886     IF (ACCOUNT-MAST-FOUND)
 11887*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11888        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11889        IF PB-REISSUED-CERT
 11890           CONTINUE
 11891        ELSE
 11892           MOVE ER-2608          TO WS-ERROR
 11893           PERFORM 9900-ERROR-FORMAT
 11894                                 THRU 9900-EXIT
 11895         END-IF
 11896     END-IF
 11897
 11898     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11899        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11900        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11901
 11902**********   DMD CUSTOM CODE FOLLOWS  **********
 11903 3024-EDIT-DMD-FIELDS.
 11904     IF PB-COMPANY-ID NOT = 'DMD'
 11905        GO TO 3025-EDIT-REINSURANCE.
 11906
 11907*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11908*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11909*** ERROR IF THEY ARE NOT EQUAL.
 11910
 11911     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11912     SET BIN-TO-GREG               TO TRUE.
 11913     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11914     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11915**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11916
 11917     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 218
* EL050.cbl
 11918     SET BIN-TO-GREG               TO TRUE.
 11919     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11920     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11921**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11922
 11923     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11924        MOVE ER-8116               TO WS-ERROR
 11925        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11926
 11927     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11928
 11929     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11930                                      WK-FULL-CERT-NO.
 11931     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11932
 11933     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11934
 11935     IF PB-VALID-LIFE
 11936        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11937     ELSE
 11938        IF PB-VALID-AH
 11939          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11940
 11941
 11942     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11943     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11944     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11945                                      DCUA-UNDRWRTR-CODE
 11946                                      DCUA-UNDRWRTR-GROUP-CODE
 11947                                      DCUA-RETURN-CODE.
 11948
 11949****************************************************************
 11950*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11951***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11952***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11953***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11954***   TO THIS RECORD.                                        ***
 11955****************************************************************
 11956     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11957     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11958     IF DCUA-SUCCESSFUL-PROCESS
 11959        GO TO 3024-EDIT-DL7-CONT.
 11960
 11961     IF DCUA-RETURN-CODE EQUAL '01'
 11962        MOVE ER-8110               TO WS-ERROR
 11963        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11964        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11965        GO TO 3024-EDIT-DL7-CONT.
 11966
 11967     IF DCUA-RETURN-CODE EQUAL '02'
 11968        MOVE ER-8111               TO WS-ERROR
 11969        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11970        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11971        GO TO 3024-EDIT-DL7-CONT.
 11972
 11973     IF DCUA-RETURN-CODE EQUAL '03'
 11974        MOVE ER-8074               TO WS-ERROR
 11975        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 219
* EL050.cbl
 11976        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11977        GO TO 3024-EDIT-DL7-CONT.
 11978
 11979     IF DCUA-RETURN-CODE EQUAL '04'
 11980        MOVE ER-8075               TO WS-ERROR
 11981        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11982        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11983        GO TO 3024-EDIT-DL7-CONT.
 11984
 11985     IF DCUA-RETURN-CODE EQUAL '05'
 11986        MOVE ER-8076               TO WS-ERROR
 11987        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11988        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11989        GO TO 3024-EDIT-DL7-CONT.
 11990
 11991     IF DCUA-RETURN-CODE EQUAL '06'
 11992        MOVE ER-8077               TO WS-ERROR
 11993        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11994        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11995        GO TO 3024-EDIT-DL7-CONT.
 11996
 11997     IF DCUA-RETURN-CODE EQUAL '07'
 11998        MOVE ER-8078               TO WS-ERROR
 11999        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12000        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12001        GO TO 3024-EDIT-DL7-CONT.
 12002
 12003     IF DCUA-RETURN-CODE EQUAL 'E1'
 12004        MOVE ER-8079               TO WS-ERROR
 12005        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12006        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12007        GO TO 3024-EDIT-DL7-CONT.
 12008
 12009     IF DCUA-RETURN-CODE EQUAL 'E2'
 12010        MOVE ER-8080               TO WS-ERROR
 12011        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12012        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12013        GO TO 3024-EDIT-DL7-CONT.
 12014
 12015     IF DCUA-RETURN-CODE EQUAL 'E3'
 12016        MOVE ER-8098               TO WS-ERROR
 12017        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12018        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12019        GO TO 3024-EDIT-DL7-CONT.
 12020
 12021     IF DCUA-RETURN-CODE EQUAL 'C1'
 12022        MOVE ER-8099               TO WS-ERROR
 12023        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12024        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12025        GO TO 3024-EDIT-DL7-CONT.
 12026
 12027     IF DCUA-RETURN-CODE EQUAL 'U1'
 12028        MOVE ER-8109               TO WS-ERROR
 12029        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12030        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12031        GO TO 3024-EDIT-DL7-CONT.
 12032
 12033     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 220
* EL050.cbl
 12034        MOVE ER-8112               TO WS-ERROR
 12035        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12037        GO TO 3024-EDIT-DL7-CONT.
 12038
 12039     IF DCUA-RETURN-CODE EQUAL 'N2'
 12040        MOVE ER-8113               TO WS-ERROR
 12041        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12042        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12043        GO TO 3024-EDIT-DL7-CONT.
 12044
 12045     IF DCUA-RETURN-CODE EQUAL 'N3'
 12046        MOVE ER-8114               TO WS-ERROR
 12047        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12048        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12049        GO TO 3024-EDIT-DL7-CONT.
 12050
 12051     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12052     MOVE ER-8097                  TO WS-ERROR.
 12053     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12054     GO TO 3024-EDIT-DL7-CONT.
 12055
 12056 3024-EDIT-DL7-CONT.
 12057
 12058     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12059     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12060     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12061        NEXT SENTENCE
 12062     ELSE
 12063        MOVE ER-9263               TO WS-ERROR
 12064        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12065
 12066******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12067******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12068     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12069        NEXT SENTENCE
 12070     ELSE
 12071        MOVE ER-8039               TO WS-ERROR
 12072        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12073
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 221
* EL050.cbl
 12075****************************************************************
 12076*** VALIDATE STATE  : DLO022                                 ***
 12077****************************************************************
 12078     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12079     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12080
 12081     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12082     IF DVSC-SUCCESSFUL-EDIT
 12083        GO TO 3024-EDIT-DL22-CONT.
 12084
 12085     IF DVSC-RETURN-CODE EQUAL '01'
 12086        MOVE ER-8300               TO WS-ERROR
 12087        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12088        GO TO 3024-EDIT-DL22-CONT.
 12089
 12090     IF DVSC-RETURN-CODE EQUAL '02'
 12091        MOVE ER-8301               TO WS-ERROR
 12092        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12093        GO TO 3024-EDIT-DL22-CONT.
 12094
 12095     IF DVSC-RETURN-CODE EQUAL '03'
 12096        MOVE ER-8302               TO WS-ERROR
 12097        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12098        GO TO 3024-EDIT-DL22-CONT.
 12099
 12100     IF DVSC-RETURN-CODE EQUAL 'N1'
 12101        MOVE ER-8304               TO WS-ERROR
 12102        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12103        GO TO 3024-EDIT-DL22-CONT.
 12104
 12105     MOVE ER-8303                  TO WS-ERROR
 12106     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12107
 12108 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 222
* EL050.cbl
 12110****************************************************************
 12111*** VALIDATE LOAN OFFICER : DLO021                           ***
 12112****************************************************************
 12113
 12114     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12115     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12116     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12117     IF DVLO-SUCCESSFUL-EDIT
 12118        GO TO 3024-EDIT-DL21-CONT.
 12119
 12120     IF DVLO-RETURN-CODE EQUAL '01'
 12121        MOVE ER-8081               TO WS-ERROR
 12122        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12123        GO TO 3024-EDIT-DL21-CONT.
 12124
 12125     IF DVLO-RETURN-CODE EQUAL '02'
 12126        MOVE ER-8082               TO WS-ERROR
 12127        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12128        GO TO 3024-EDIT-DL21-CONT.
 12129
 12130     IF DVLO-RETURN-CODE EQUAL '03'
 12131        MOVE ER-8083               TO WS-ERROR
 12132        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12133        GO TO 3024-EDIT-DL21-CONT.
 12134
 12135     IF DVLO-RETURN-CODE EQUAL '04'
 12136        MOVE ER-8084               TO WS-ERROR
 12137        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12138        GO TO 3024-EDIT-DL21-CONT.
 12139
 12140     IF DVLO-RETURN-CODE EQUAL '05'
 12141        MOVE ER-8085               TO WS-ERROR
 12142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12143        GO TO 3024-EDIT-DL21-CONT.
 12144
 12145     MOVE ER-7825                  TO WS-ERROR
 12146     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12147     GO TO 3024-EDIT-DL21-CONT.
 12148
 12149 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 223
* EL050.cbl
 12151
 12152****************************************************************
 12153*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12154****************************************************************
 12155
 12156     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12157     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12158     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12159     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12160     IF DIPF-SUCCESSFUL-EDIT
 12161        GO TO 3024-EDIT-DL02-CONT.
 12162
 12163     IF DIPF-RETURN-CODE EQUAL '01'
 12164        MOVE ER-8086               TO WS-ERROR
 12165        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12166        GO TO 3024-EDIT-DL02-CONT.
 12167
 12168     IF DIPF-RETURN-CODE EQUAL '02'
 12169        MOVE ER-8087               TO WS-ERROR
 12170        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12171        GO TO 3024-EDIT-DL02-CONT.
 12172
 12173     IF DIPF-RETURN-CODE EQUAL '03'
 12174        MOVE ER-8088               TO WS-ERROR
 12175        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12176        GO TO 3024-EDIT-DL02-CONT.
 12177
 12178     MOVE ER-8095                  TO WS-ERROR
 12179     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12180     GO TO 3024-EDIT-DL02-CONT.
 12181
 12182 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 224
* EL050.cbl
 12184
 12185****************************************************************
 12186*** VALIDATE BANK ID : DLO003                                ***
 12187****************************************************************
 12188
 12189     MOVE WK-GREG-CENT           TO WCG-CENT.
 12190     MOVE WK-GREG-YYMM           TO WCG-REST.
 12191     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12192        MOVE ER-8040               TO WS-ERROR
 12193        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12194
 12195     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12196     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12197     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12198     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12199     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12200     IF DVBI-SUCCESSFUL-EDIT
 12201        GO TO 3024-EDIT-DL03-CONT.
 12202
 12203     IF DVBI-RETURN-CODE EQUAL '01'
 12204        MOVE ER-8089               TO WS-ERROR
 12205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12206        GO TO 3024-EDIT-DL03-CONT.
 12207
 12208     IF DVBI-RETURN-CODE EQUAL '02'
 12209        MOVE ER-8090               TO WS-ERROR
 12210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12211        GO TO 3024-EDIT-DL03-CONT.
 12212
 12213     IF DVBI-RETURN-CODE EQUAL '03'
 12214        MOVE ER-8091               TO WS-ERROR
 12215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12216        GO TO 3024-EDIT-DL03-CONT.
 12217
 12218     IF DVBI-RETURN-CODE EQUAL '04'
 12219        MOVE ER-8092               TO WS-ERROR
 12220        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12221        GO TO 3024-EDIT-DL03-CONT.
 12222
 12223     IF DVBI-RETURN-CODE EQUAL '05'
 12224        MOVE ER-8093               TO WS-ERROR
 12225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12226        GO TO 3024-EDIT-DL03-CONT.
 12227
 12228     IF DVBI-RETURN-CODE EQUAL '06'
 12229        MOVE ER-8094               TO WS-ERROR
 12230        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12231        GO TO 3024-EDIT-DL03-CONT.
 12232
 12233     MOVE ER-8096                  TO WS-ERROR
 12234     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12235     GO TO 3024-EDIT-DL03-CONT.
 12236
 12237 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 225
* EL050.cbl
 12239
 12240     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12241        NEXT SENTENCE
 12242     ELSE
 12243        MOVE ER-8042               TO WS-ERROR
 12244        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12245
 12246     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12247     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12248     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12249
 12250     IF DMPF-RETURN-CODE = '01'
 12251        MOVE ER-8067               TO WS-ERROR
 12252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12253        GO TO 3024-EDIT-DL01-CONT.
 12254
 12255     IF DMPF-RETURN-CODE = '02'
 12256        MOVE ER-8068               TO WS-ERROR
 12257        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12258        GO TO 3024-EDIT-DL01-CONT.
 12259
 12260     IF DMPF-RETURN-CODE = '03'
 12261        MOVE ER-8069               TO WS-ERROR
 12262        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12263        GO TO 3024-EDIT-DL01-CONT.
 12264
 12265     IF DMPF-RETURN-CODE = 'E1'
 12266        MOVE ER-8070               TO WS-ERROR
 12267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12268        GO TO 3024-EDIT-DL01-CONT.
 12269
 12270     IF DMPF-RETURN-CODE = 'N1'
 12271        MOVE ER-8071               TO WS-ERROR
 12272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12273        GO TO 3024-EDIT-DL01-CONT.
 12274
 12275     IF DMPF-RETURN-CODE NOT = 'OK'
 12276        MOVE ER-8072               TO WS-ERROR
 12277        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12278
 12279 3024-EDIT-DL01-CONT.
 12280******************************************************************
 12281***  VALIDATES RATE CODES : DLO017                             ***
 12282******************************************************************
 12283
 12284      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12285      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12286      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12287      IF DVRC-SUCCESSFUL-EDIT
 12288        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12289        GO TO 3024-CHECK-VALID-RATE.
 12290
 12291      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12292
 12293      IF DVRC-RETURN-CODE EQUAL '01'
 12294         MOVE ER-7817                   TO WS-ERROR
 12295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12296         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 226
* EL050.cbl
 12297
 12298      IF DVRC-RETURN-CODE EQUAL '02'
 12299         MOVE ER-7818                   TO WS-ERROR
 12300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12301         GO TO 3025-EDIT-REINSURANCE.
 12302
 12303      IF DVRC-RETURN-CODE EQUAL '03'
 12304         MOVE ER-7819                   TO WS-ERROR
 12305         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12306         GO TO 3025-EDIT-REINSURANCE.
 12307
 12308       MOVE ER-7820                     TO WS-ERROR.
 12309       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12310       GO TO 3025-EDIT-REINSURANCE.
 12311
 12312******************************************************************
 12313***  GET PREMIUM RATES : DLO011                                ***
 12314******************************************************************
 12315
 12316 3024-CHECK-VALID-RATE.
 12317
 12318     IF VALID-RATE-CODE
 12319        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12320        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12321        MOVE SPACES                TO DPRB-RETURN-CODE
 12322        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12323     ELSE
 12324         GO TO 3025-EDIT-REINSURANCE.
 12325
 12326      IF DPRB-SUCCESSFUL-PROCESS
 12327         IF PB-VALID-LIFE
 12328             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12329             GO TO 3025-EDIT-REINSURANCE
 12330         ELSE
 12331             IF PB-VALID-AH
 12332                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12333                 GO TO 3025-EDIT-REINSURANCE.
 12334
 12335      IF DPRB-RETURN-CODE EQUAL '01'
 12336         MOVE ER-7812                   TO WS-ERROR
 12337         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12338         GO TO 3025-EDIT-REINSURANCE.
 12339
 12340      IF DPRB-RETURN-CODE EQUAL '02'
 12341         MOVE ER-7813                   TO WS-ERROR
 12342         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12343         GO TO 3025-EDIT-REINSURANCE.
 12344
 12345      IF DPRB-RETURN-CODE EQUAL '03'
 12346         MOVE ER-7814                   TO WS-ERROR
 12347         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12348         GO TO 3025-EDIT-REINSURANCE.
 12349
 12350      IF DPRB-RETURN-CODE EQUAL '04'
 12351         IF NOT DPRB-1ST-TIME
 12352            MOVE ER-7815                   TO WS-ERROR
 12353            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12354            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 227
* EL050.cbl
 12355          ELSE
 12356         IF PB-VALID-LIFE
 12357            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12358          ELSE
 12359            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12360         END-IF
 12361         MOVE SPACES                TO DOCC-RETURN-CODE
 12362         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12363         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12364         IF DOCC-RETURN-CODE = 'OK'
 12365             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12366             GO TO 3024-CHECK-VALID-RATE
 12367           ELSE
 12368             MOVE ER-7823               TO WS-ERROR
 12369             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12370             GO TO 3025-EDIT-REINSURANCE.
 12371
 12372       MOVE ER-7816                     TO WS-ERROR.
 12373       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12374       GO TO 3025-EDIT-REINSURANCE.
 12375
 12376**********   DMD CUSTOM CODE ABOVE    **********
 12377
 12378 3025-EDIT-REINSURANCE.
 12379     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12380         GO TO 3027-EDIT-CONTINUE.
 12381
 12382     MOVE LOW-VALUES               TO ERREIN-KEY.
 12383     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12384     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12385                                      REIN-CODE-2
 12386                                      REIN-CODE-3.
 12387     MOVE 'A'                      TO REIN-TYPE.
 12388
 12389     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12390
 12391     MOVE '3026' TO REIN-SW.
 12392     MOVE ' '                   TO WS-REIN-READ-SW.
 12393
 12394     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12395     IF REIN-TABLE-NOT-FOUND
 12396         GO TO 3026-NO-SPEC-TABLE.
 12397
 12398     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12399     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12400                                   WS-NSP-ST-CD-LF.
 12401     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12402                                   WS-NSP-ST-CD-AH.
 12403
 12404     GO TO 3040-EDIT-CONTINUE.
 12405
 12406 3026-NO-SPEC-TABLE.
 12407
 12408     MOVE ER-2664                TO WS-ERROR.
 12409     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12410     GO TO 3040-EDIT-CONTINUE.
 12411
 12412 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 228
* EL050.cbl
 12413
 12414     IF PB-I-REIN-TABLE = SPACES
 12415       GO TO 3040-EDIT-CONTINUE.
 12416
 12417     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12418          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12419          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12420           GO TO 3040-EDIT-CONTINUE.
 12421
 12422     MOVE LOW-VALUES            TO ERREIN-KEY.
 12423     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12424     MOVE 'A'                   TO REIN-TYPE.
 12425     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12426
 12427     MOVE '3028'                TO REIN-SW.
 12428     MOVE ' '                   TO WS-REIN-READ-SW.
 12429
 12430     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12431     IF REIN-TABLE-NOT-FOUND
 12432         GO TO 3028-NO-REIN-TABLE.
 12433
 12434     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12435     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12436                                   WS-NSP-ST-CD-LF.
 12437     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12438                                   WS-NSP-ST-CD-AH.
 12439
 12440     GO TO 3040-EDIT-CONTINUE.
 12441
 12442 3028-NO-REIN-TABLE.
 12443
 12444     MOVE ER-2615                TO WS-ERROR.
 12445     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12446     GO TO 3040-EDIT-CONTINUE.
 12447
 12448 3040-EDIT-CONTINUE.
 12449
 12450     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12451         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12452
 12453     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12454         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12455
 12456     IF (NOT PB-REISSUED-CERT)
 12457        AND (NOT PB-MONTHLY-CERT)
 12458        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12459            MOVE '001'           TO PB-I-LF-TERM
 12460            MOVE 'M'             TO PB-I-INSURED-SEX.
 12461
 12462     IF (NOT PB-REISSUED-CERT)
 12463        AND (NOT PB-MONTHLY-CERT)
 12464        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12465            MOVE '001'           TO PB-I-AH-TERM
 12466            MOVE 'M'             TO PB-I-INSURED-SEX.
 12467
 12468 3040-EDIT-1ST-PMT-DT.
 12469     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12470     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 229
* EL050.cbl
 12471         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12472
 12473******************************************************************
 12474*                                                                *
 12475*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12476*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12477*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12478*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12479*                                                                *
 12480******************************************************************
 12481
 12482     IF PB-EFF-DT-PROCESSING
 12483        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12484                                    PB-I-LF-EXPIRE-DT
 12485                                    PB-I-AH-EXPIRE-DT
 12486        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12487        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12488        MOVE ZERO                TO DC-ELAPSED-DAYS
 12489        MOVE +1                  TO DC-ELAPSED-MONTHS
 12490        SET BIN-PLUS-ELAPSED     TO TRUE
 12491*       MOVE 6                   TO DC-OPTION-CODE
 12492        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12493        IF NO-CONVERSION-ERROR
 12494           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12495
 12496******************************************************************
 12497*                                                                *
 12498*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12499*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12500*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12501*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12502*                                                                *
 12503******************************************************************
 12504
 12505     IF PB-EXT-DAYS-PROCESSING
 12506          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12507                                         PB-I-LF-EXPIRE-DT
 12508                                         PB-I-AH-EXPIRE-DT
 12509          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12510          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12511          MOVE +1                     TO DC-ELAPSED-MONTHS
 12512          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12513          SET BIN-PLUS-ELAPSED        TO TRUE
 12514*         MOVE 6                      TO DC-OPTION-CODE
 12515          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12516          IF NO-CONVERSION-ERROR
 12517             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12518
 12519******************************************************************
 12520*                                                                *
 12521*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12522*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12523*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12524*        (EXPIRE DATE - (TERM -1))  *  -1.
 12525*                                                                *
 12526******************************************************************
 12527
 12528     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 230
* EL050.cbl
 12529        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12530           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12531              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12532              MOVE PB-I-AH-TERM      TO WS-TERM
 12533           ELSE
 12534              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12535              MOVE PB-I-LF-TERM      TO WS-TERM
 12536        ELSE
 12537           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12538              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12539              MOVE PB-I-LF-TERM      TO WS-TERM
 12540           ELSE
 12541              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12542              MOVE PB-I-AH-TERM      TO WS-TERM.
 12543
 12544     IF PB-EXPIRE-DT-PROCESSING
 12545        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12546        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12547        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12548        MOVE ZERO                TO DC-ELAPSED-DAYS
 12549                                    DC-ODD-DAYS-OVER
 12550          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12551          SET BIN-PLUS-ELAPSED    TO TRUE
 12552*         MOVE 6                  TO DC-OPTION-CODE
 12553          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12554          IF NO-CONVERSION-ERROR
 12555             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12556
 12557******************************************************************
 12558*                                                                *
 12559*            1ST PAYMENT DATE PROCESSING                         *
 12560*                                                                *
 12561******************************************************************
 12562
 12563     IF PB-1ST-PMT-DT-PROCESSING
 12564        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12565                                    PB-I-AH-EXPIRE-DT
 12566        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12567
 12568     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12569         NEXT SENTENCE
 12570     ELSE
 12571         MOVE ER-2680                 TO WS-ERROR
 12572         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12573         GO TO 3060-ORIG-TERM-CHECK.
 12574
 12575     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12576     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12577     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12578*    MOVE 1                      TO DC-OPTION-CODE.
 12579     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12580                                    DC-ELAPSED-DAYS
 12581                                    DC-ODD-DAYS-OVER.
 12582
 12583     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12584
 12585     IF DATE-CONVERSION-ERROR
 12586        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 231
* EL050.cbl
 12587
 12588     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12589     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12590        AND (WS-LF-COVERAGE-TYPE = 'L')
 12591        IF (DC-ELAPSED-MONTHS > 1)
 12592                      OR
 12593           ((DC-ELAPSED-MONTHS = 1)
 12594           AND (DC-ODD-DAYS-OVER > 0))
 12595           MOVE ER-2882          TO WS-ERROR
 12596           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12597        END-IF
 12598     END-IF
 12599     if dc-elapsed-months > 0
 12600        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12601        + dc-odd-days-over
 12602     end-if
 12603     IF PB-EXT-DAYS-PROCESSING
 12604        CONTINUE
 12605     ELSE
 12606        IF DC-ELAPSED-MONTHS = +0
 12607           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12608        ELSE
 12609           IF (WS-LF-EARNINGS-CALC = '4')
 12610              AND (DC-ELAPSED-MONTHS > ZERO)
 12611              AND (DC-ELAPSED-DAYS > ZERO)
 12612              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12613           ELSE
 12614              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12615                                 THRU 6499-EXIT
 12616              MOVE WS-ODD-DAYS-OVER
 12617                                 TO PB-I-EXTENTION-DAYS
 12618           END-IF
 12619        END-IF
 12620     END-IF
 12621******************************************************************
 12622*                                                                *
 12623*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12624*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12625*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12626*            AND ANY ODD DAYS.                                   *
 12627*                                                                *
 12628******************************************************************
 12629
 12630     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12631                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12632     IF WS-LF-EARNINGS-CALC NOT = '4'
 12633        IF DC-ELAPSED-DAYS > ZEROS
 12634           MOVE ER-2681          TO WS-ERROR
 12635           PERFORM 9900-ERROR-FORMAT
 12636                                 THRU 9900-EXIT
 12637        END-IF
 12638     END-IF
 12639
 12640     IF WS-LF-EARNINGS-CALC NOT = '4'
 12641        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12642           MOVE ER-2681          TO WS-ERROR
 12643           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12644
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 232
* EL050.cbl
 12645     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12646        (PB-I-LF-TERM NOT = ZERO) AND
 12647         NOT NO-LIFE-COVERAGE
 12648          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12649          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12650          IF WS-LF-EARNINGS-CALC = '4'
 12651             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12652             PB-I-PAY-FREQUENCY
 12653          END-IF
 12654          MOVE ZERO              TO DC-ELAPSED-DAYS
 12655                                    DC-ODD-DAYS-OVER
 12656          MOVE 1                 TO DC-END-OF-MONTH
 12657          SET BIN-PLUS-ELAPSED        TO TRUE
 12658*         MOVE 6                 TO DC-OPTION-CODE
 12659          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12660          IF NO-CONVERSION-ERROR
 12661             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12662             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12663                (WS-LF-SPECIAL-CALC-CD = 'L')
 12664                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12665                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12666                  MOVE +1             TO DC-ELAPSED-MONTHS
 12667                  SET BIN-PLUS-ELAPSED  TO TRUE
 12668*                 MOVE 6              TO DC-OPTION-CODE
 12669                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12670                  IF NO-CONVERSION-ERROR
 12671                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12672
 12673* okay, i had to move the new att age edit down here because the
 12674* expiration date could get recalculated and i need the exp date
 12675     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12676        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12677        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12678        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12679           AND ZEROS
 12680           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12681           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12682           SET ELAPSED-BETWEEN-BIN TO TRUE
 12683           PERFORM 8500-DATE-CONVERT
 12684                                 THRU 8500-EXIT
 12685           IF NO-CONVERSION-ERROR
 12686              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12687                 MOVE ER-2669       TO WS-ERROR
 12688*                PERFORM 9900-ERROR-FORMAT
 12689*                                THRU 9900-EXIT
 12690              END-IF
 12691           END-IF
 12692        ELSE
 12693           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12694           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12695              MOVE ER-2669       TO WS-ERROR
 12696*             PERFORM 9900-ERROR-FORMAT
 12697*                                THRU 9900-EXIT
 12698           ELSE
 12699              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12700                 MOVE ER-1570    TO WS-ERROR
 12701                 PERFORM 9900-ERROR-FORMAT
 12702                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 233
* EL050.cbl
 12703              END-IF
 12704           END-IF
 12705        END-IF
 12706        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12707           AND ZEROS
 12708           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12709           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12710           SET ELAPSED-BETWEEN-BIN TO TRUE
 12711           PERFORM 8500-DATE-CONVERT
 12712                                 THRU 8500-EXIT
 12713           IF NO-CONVERSION-ERROR
 12714              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12715                 MOVE ER-2669       TO WS-ERROR
 12716*                PERFORM 9900-ERROR-FORMAT
 12717*                                THRU 9900-EXIT
 12718              END-IF
 12719           END-IF
 12720        ELSE
 12721           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12722             (PB-I-LF-TERM / 12)
 12723           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12724              MOVE ER-2669       TO WS-ERROR
 12725*             PERFORM 9900-ERROR-FORMAT
 12726*                                THRU 9900-EXIT
 12727           ELSE
 12728              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12729                 MOVE ER-1571    TO WS-ERROR
 12730                 PERFORM 9900-ERROR-FORMAT
 12731                                 THRU 9900-EXIT
 12732              END-IF
 12733           END-IF
 12734        END-IF
 12735        IF WS-ERROR = ER-2669
 12736           PERFORM 9900-ERROR-FORMAT
 12737                                 THRU 9900-EXIT
 12738        END-IF
 12739     END-IF
 12740     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12741        (PB-I-AH-TERM NOT = ZERO) AND
 12742         NOT NO-AH-COVERAGE
 12743          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12744             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12745             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12746             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12747          ELSE
 12748             IF WS-LF-EARNINGS-CALC = '4'
 12749                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12750                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12751                PB-I-PAY-FREQUENCY
 12752             ELSE
 12753                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12754                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12755             END-IF
 12756          END-IF
 12757          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12758                                         DC-ODD-DAYS-OVER
 12759          MOVE 1                      TO DC-END-OF-MONTH
 12760          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 234
* EL050.cbl
 12761*         MOVE 6                      TO DC-OPTION-CODE
 12762          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12763          IF NO-CONVERSION-ERROR
 12764             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12765     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12766        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12767        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12768        IF PB-I-BIRTHDAY > LOW-VALUES
 12769           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12770           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12771           SET ELAPSED-BETWEEN-BIN TO TRUE
 12772           PERFORM 8500-DATE-CONVERT
 12773                                 THRU 8500-EXIT
 12774           IF NO-CONVERSION-ERROR
 12775              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12776                 MOVE ER-3054       TO WS-ERROR
 12777*                PERFORM 9900-ERROR-FORMAT
 12778*                                THRU 9900-EXIT
 12779              END-IF
 12780           END-IF
 12781        ELSE
 12782           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12783           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12784              MOVE ER-3054       TO WS-ERROR
 12785*             PERFORM 9900-ERROR-FORMAT
 12786*                                THRU 9900-EXIT
 12787           END-IF
 12788        END-IF
 12789        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12790           AND ZEROS
 12791           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12792           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12793           SET ELAPSED-BETWEEN-BIN TO TRUE
 12794           PERFORM 8500-DATE-CONVERT
 12795                                 THRU 8500-EXIT
 12796           IF NO-CONVERSION-ERROR
 12797              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12798                 MOVE ER-3054       TO WS-ERROR
 12799*                PERFORM 9900-ERROR-FORMAT
 12800*                                THRU 9900-EXIT
 12801              END-IF
 12802           END-IF
 12803        ELSE
 12804           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12805             (PB-I-AH-TERM / 12)
 12806           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12807              MOVE ER-3054       TO WS-ERROR
 12808*             PERFORM 9900-ERROR-FORMAT
 12809*                                THRU 9900-EXIT
 12810           END-IF
 12811        END-IF
 12812        IF WS-ERROR = ER-3054
 12813           PERFORM 9900-ERROR-FORMAT
 12814                                 THRU 9900-EXIT
 12815        END-IF
 12816     END-IF
 12817     MOVE SPACE                       TO DC-END-OF-MONTH.
 12818
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 235
* EL050.cbl
 12819     IF PB-COMPANY-ID = 'NCB'
 12820        GO TO 3040-EDIT-EXTENSION-DAYS.
 12821
 12822     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12823       AND
 12824        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12825        NEXT SENTENCE
 12826     ELSE
 12827        GO TO 3040-EDIT-EXTENSION-DAYS.
 12828
 12829     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12830        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12831        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12832     ELSE
 12833        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12834        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12835
 12836     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12837*    MOVE '1'      TO DC-OPTION-CODE
 12838     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12839     IF (NO-CONVERSION-ERROR)
 12840        AND (DC-ELAPSED-MONTHS > +1)
 12841        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12842        MOVE ER-2668   TO WS-ERROR
 12843        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12844
 12845 3040-EDIT-EXTENSION-DAYS.
 12846
 12847     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12848        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12849         GO TO 3050-EDIT-TERM-IN-DAYS
 12850     ELSE
 12851         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12852
 12853     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12854         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12855     ELSE
 12856        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12857           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12858           MOVE ER-2681         TO WS-ERROR
 12859           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12860
 12861     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12862        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12863        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12864         GO TO 3060-ORIG-TERM-CHECK.
 12865
 12866     GO TO 3060-ORIG-TERM-CHECK.
 12867
 12868 3050-EDIT-TERM-IN-DAYS.
 12869
 12870     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12871
 12872     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12873         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12874     ELSE
 12875         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12876            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 236
* EL050.cbl
 12877            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12878
 12879     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12880                                       REMAINDER WS-WORK-TERM.
 12881     IF WS-WORK-TERM GREATER THAN ZERO
 12882         ADD +1 TO PB-I-LF-TERM.
 12883
 12884     IF NOT NO-AH-COVERAGE
 12885         MOVE ER-2684            TO WS-ERROR
 12886         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12887
 12888
 12889 3060-ORIG-TERM-CHECK.
 12890
 12891******************************************************************
 12892*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12893******************************************************************
 12894
 12895     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12896        NEXT SENTENCE
 12897     ELSE
 12898        IF NOT NO-LIFE-COVERAGE
 12899           IF PB-I-LF-TERM NUMERIC
 12900              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12901              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12902              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12903                  NEXT SENTENCE
 12904           ELSE
 12905              MOVE ER-2647       TO WS-ERROR
 12906              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12907
 12908     IF NOT NO-AH-COVERAGE
 12909         IF PB-I-AH-TERM NUMERIC
 12910            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12911            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12912            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12913             NEXT SENTENCE
 12914          ELSE
 12915              MOVE ER-2658       TO WS-ERROR
 12916              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12917
 12918     IF PB-COMPANY-ID = 'NCB'
 12919        GO TO 3070-LOAN-TERM-CHECK.
 12920
 12921     IF POLICY-HAS-AH
 12922       AND
 12923        POLICY-HAS-LIFE
 12924       AND
 12925        PB-I-LF-TERM NUMERIC
 12926       AND
 12927        PB-I-AH-TERM NUMERIC
 12928        NEXT SENTENCE
 12929     ELSE
 12930        GO TO 3070-LOAN-TERM-CHECK.
 12931
 12932     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12933     IF WS-TEX-FACT-2 LESS THAN +0
 12934        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 237
* EL050.cbl
 12935
 12936     IF WS-TEX-FACT-2 GREATER THAN +1
 12937        MOVE ER-2668             TO WS-ERROR
 12938        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12939
 12940 3070-LOAN-TERM-CHECK.
 12941
 12942     IF (WS-LF-BENEFIT-CD = ZERO)
 12943         OR (NO-LF-BENEFIT-MATCH)
 12944            GO TO 3125-EDIT-PMT-FREQ.
 12945*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12946*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12947*          AND 'V' AND 'W' AND 'X'
 12948*          GO TO 3125-EDIT-PMT-FREQ
 12949*       END-IF
 12950*    ELSE
 12951*       IF WS-AH-DCC-TRUNC = 'T'
 12952*          CONTINUE
 12953*       ELSE
 12954*          GO TO 3125-EDIT-PMT-FREQ
 12955*       END-IF
 12956*    END-IF
 12957     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12958                    OR
 12959        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12960        AND (WS-AH-DCC-TRUNC = 'T'))
 12961        CONTINUE
 12962     ELSE
 12963        GO TO 3125-EDIT-PMT-FREQ
 12964     END-IF
 12965     IF PB-I-LOAN-TERM NOT NUMERIC
 12966         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12967
 12968     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12969        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12970*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12971        PB-I-LOAN-TERM NOT GREATER THAN +360
 12972         NEXT SENTENCE
 12973     ELSE
 12974         MOVE ER-2648            TO WS-ERROR
 12975         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12976
 12977     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12978        MOVE ER-3058             TO WS-ERROR
 12979        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12980     end-if
 12981
 12982     IF WS-STATE-ABBREVIATION = 'NC'
 12983        IF PB-I-LOAN-TERM > +59
 12984           CONTINUE
 12985        ELSE
 12986           MOVE ER-2792          TO WS-ERROR
 12987           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12988        END-IF
 12989     END-IF
 12990
 12991     .
 12992 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 238
* EL050.cbl
 12993     IF (WS-LF-BENEFIT-CD = ZERO)
 12994         OR (NO-LF-BENEFIT-MATCH)
 12995            GO TO 3127-EDIT-LOAN-OFFICER.
 12996     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12997                    OR
 12998        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12999        AND (WS-AH-DCC-TRUNC = 'T'))
 13000                    OR
 13001         (PB-COMPANY-ID = 'AHL')
 13002        CONTINUE
 13003     ELSE
 13004        IF (PB-I-LOAN-TERM > ZEROS)
 13005           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 13006           MOVE ER-1575          TO WS-ERROR
 13007           PERFORM 9900-ERROR-FORMAT
 13008                                 THRU 9900-EXIT
 13009        END-IF
 13010     END-IF
 13011     IF WS-LF-EARNINGS-CALC NOT = '4'
 13012         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 13013            MOVE ER-2653         TO WS-ERROR
 13014            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13015            GO TO 3127-EDIT-LOAN-OFFICER
 13016         ELSE
 13017            GO TO 3127-EDIT-LOAN-OFFICER.
 13018
 13019     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 13020         MOVE ER-2655            TO WS-ERROR
 13021         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13022         GO TO 3127-EDIT-LOAN-OFFICER.
 13023
 13024     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 13025         MOVE ER-2654            TO WS-ERROR
 13026         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13027         GO TO 3127-EDIT-LOAN-OFFICER.
 13028
 13029     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 13030         GIVING WS-TEX-FACT-2
 13031             REMAINDER WS-TEX-FACT-3.
 13032
 13033*    IF WS-TEX-FACT-3 NOT = ZERO
 13034*       MOVE ER-2654             TO WS-ERROR
 13035*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13036
 13037
 13038 3127-EDIT-LOAN-OFFICER.
 13039
 13040     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13041        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13042           MOVE ER-2690          TO WS-ERROR
 13043           PERFORM 9900-ERROR-FORMAT
 13044                                 THRU 9900-EXIT
 13045        ELSE
 13046           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13047           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13048           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13049           MOVE PB-SV-STATE      TO LOFC-STATE
 13050           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 239
* EL050.cbl
 13051           MOVE PB-I-LOAN-OFFICER
 13052                                 TO LOFC-CODE
 13053           PERFORM 8586-READ-LOAN-OFFICER
 13054                                 THRU 8586-EXIT
 13055           IF (NOT LOFC-MASTER-FOUND)
 13056              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13057              MOVE ER-3006       TO WS-ERROR
 13058              PERFORM 9900-ERROR-FORMAT
 13059                                 THRU 9900-EXIT
 13060           END-IF
 13061        END-IF
 13062     END-IF
 13063     .
 13064 3129-EDIT-APR.
 13065
 13066     IF (WS-LF-BENEFIT-CD = ZERO)
 13067        OR (NO-LF-BENEFIT-MATCH)
 13068        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13069           GO TO 3130-EDIT-AGE
 13070*       ELSE
 13071*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13072*             GO TO 3130-EDIT-AGE
 13073*          END-IF
 13074        END-IF
 13075     END-IF
 13076
 13077     IF (WS-STATE-ABBREVIATION = 'OH')
 13078         AND (PB-I-RATE-CLASS NOT = 'L ')
 13079         AND (PB-I-LF-TERM GREATER THAN 60)
 13080         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13081         GO TO 3129-APR-CONT.
 13082
 13083     IF (WS-STATE-ABBREVIATION = 'RI')
 13084         AND (PB-I-LF-TERM GREATER THAN 60)
 13085         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13086         GO TO 3129-APR-CONT.
 13087
 13088     IF (WS-STATE-ABBREVIATION = 'UT')
 13089         AND (PB-I-LF-TERM GREATER THAN 62)
 13090         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13091         AND (PB-CERT-EFF-DT LESS WS-830901)
 13092         GO TO 3129-APR-CONT.
 13093
 13094     IF PB-COMPANY-ID = 'LAP'
 13095        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13096           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13097              MOVE ER-2656         TO WS-ERROR
 13098              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13099              GO TO 3130-EDIT-AGE.
 13100
 13101     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13102        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13103        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13104        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13105        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13106        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13107         GO TO 3130-EDIT-AGE.
 13108
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 240
* EL050.cbl
 13109 3129-APR-CONT.
 13110     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13111         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13112         GO TO 3130-EDIT-AGE.
 13113
 13114     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13115         WS-AH-BENEFIT-CD (1:1) = 'S')
 13116        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13117        AND (PB-I-LOAN-APR = ZERO)
 13118        MOVE ER-2657             TO WS-ERROR
 13119        PERFORM 9900-ERROR-FORMAT
 13120                                 THRU 9900-EXIT
 13121        GO TO 3130-EDIT-AGE
 13122     END-IF
 13123*    IF PB-I-LOAN-APR = ZERO
 13124*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13125*    END-IF
 13126
 13127     if pb-i-loan-apr = +99.9999
 13128        move er-2656             to ws-error
 13129        PERFORM 9900-ERROR-FORMAT
 13130                                 THRU 9900-EXIT
 13131        GO TO 3130-EDIT-AGE
 13132     end-if
 13133*    IF PB-I-LOAN-APR = ZERO
 13134*       MOVE ER-2656             TO WS-ERROR
 13135*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13136*       GO TO 3130-EDIT-AGE.
 13137
 13138*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13139     if pb-i-loan-apr not = +99.9999
 13140        IF PB-I-LOAN-APR > +30.000
 13141           MOVE ER-2657          TO WS-ERROR
 13142           PERFORM 9900-ERROR-FORMAT
 13143                                 THRU 9900-EXIT
 13144        end-if
 13145     end-if
 13146     .
 13147 3130-EDIT-AGE.
 13148
 13149******************************************************************
 13150*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13151******************************************************************
 13152
 13153     IF NOT NO-LIFE-COVERAGE
 13154        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13155           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13156               MOVE ER-2628             TO WS-ERROR
 13157               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13158
 13159     IF NOT NO-AH-COVERAGE
 13160        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13161           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13162               MOVE ER-2628         TO WS-ERROR
 13163               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13164
 13165 3133-SEX-CODE.
 13166     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 241
* EL050.cbl
 13167         IF WS-DEFAULT-SEX = 'M'
 13168             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13169          ELSE
 13170             IF WS-DEFAULT-SEX = 'F'
 13171             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13172
 13173     IF PB-I-INSURED-SEX = '1'
 13174         MOVE 'M' TO PB-I-INSURED-SEX.
 13175
 13176     IF PB-I-INSURED-SEX = '2'
 13177         MOVE 'F' TO PB-I-INSURED-SEX.
 13178
 13179 3134-SIG-SW-EDIT.
 13180     IF PB-I-SIG-SW = SPACE
 13181         MOVE 'N'                TO  PB-I-SIG-SW.
 13182
 13183     IF PB-COMPANY-ID = 'NCL'
 13184         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13185             NEXT SENTENCE
 13186         ELSE
 13187             MOVE ER-1923        TO  WS-ERROR
 13188             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13189     ELSE
 13190     IF PB-COMPANY-ID = 'CRI'
 13191         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13192             NEXT SENTENCE
 13193         ELSE
 13194             MOVE ER-2606        TO  WS-ERROR
 13195             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13196     ELSE
 13197     IF PB-COMPANY-ID = 'TMS'
 13198         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13199             NEXT SENTENCE
 13200         ELSE
 13201             MOVE ER-2689        TO  WS-ERROR
 13202             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13203     ELSE
 13204         IF PB-I-SIG-SW = 'Y' OR 'N'
 13205             NEXT SENTENCE
 13206         ELSE
 13207             MOVE ER-2651        TO  WS-ERROR
 13208             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13209
 13210     IF PB-COMPANY-ID = 'FLA'
 13211         IF (WS-EDIT-AGE GREATER 54  OR
 13212             WS-AH-EDIT-AGE GREATER 54)  AND
 13213            PB-I-SIG-SW = 'N'
 13214            MOVE ER-2651         TO  WS-ERROR
 13215            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13216
 13217 3135-NAME-EDIT.
 13218
 13219     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13220        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13221        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13222           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13223                                 TO PB-I-JOINT-FIRST-NAME
 13224        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 242
* EL050.cbl
 13225     END-IF
 13226     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13227        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13228        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13229           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13230                                 TO PB-I-JOINT-LAST-NAME
 13231        END-PERFORM
 13232     END-IF
 13233     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13234        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13235        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13236           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13237                                 TO PB-I-INSURED-FIRST-NAME
 13238        END-PERFORM
 13239     END-IF
 13240     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13241        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13242        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13243           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13244                                 TO PB-I-INSURED-LAST-NAME
 13245        END-PERFORM
 13246     END-IF
 13247     IF PB-I-INSURED-LAST-NAME = SPACES
 13248       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13249       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13250           MOVE ER-2660    TO WS-ERROR
 13251           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13252
 13253 3136-EDIT-SEX.
 13254
 13255******************************************************************
 13256*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13257******************************************************************
 13258
 13259     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13260        (WS-AH-SPECIAL-CALC-CD = 'O')
 13261        NEXT SENTENCE
 13262     ELSE
 13263        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13264           NEXT SENTENCE
 13265        ELSE
 13266           MOVE ER-2629            TO WS-ERROR
 13267           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13268
 13269 3137-EDIT-EFF-DATE.
 13270
 13271     IF PB-REISSUED-CERT       OR
 13272        PB-POLICY-IS-DECLINED  OR
 13273        PB-POLICY-IS-VOIDED
 13274         GO TO 3139-EDIT-COVERAGE-CODES.
 13275
 13276     MOVE SPACE                  TO WS-2671-SW
 13277                                    WS-2672-SW.
 13278
 13279     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13280         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13281             MOVE ER-2703        TO WS-ERROR
 13282             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 243
* EL050.cbl
 13283             GO TO 3139-EDIT-COVERAGE-CODES.
 13284
 13285     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13286         GO TO 3139-EDIT-COVERAGE-CODES.
 13287
 13288     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13289     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13290*    MOVE '1'                    TO DC-OPTION-CODE.
 13291     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13292     MOVE +0                     TO DC-ELAPSED-MONTHS
 13293                                    DC-ELAPSED-DAYS.
 13294     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13295
 13296     IF DATE-CONVERSION-ERROR
 13297         GO TO 3139-EDIT-COVERAGE-CODES.
 13298
 13299     IF DC-ELAPSED-DAYS GREATER +180
 13300         MOVE ER-2672            TO WS-ERROR
 13301         MOVE 'Y'                TO WS-2672-SW
 13302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13303     END-IF
 13304
 13305     IF WS-ERROR = ER-2671  AND
 13306        PB-COMPANY-ID  = 'LBL'
 13307        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13308        MOVE SPACE               TO WS-2671-SW
 13309        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13310
 13311     IF PB-ISSUE-DATE-FORCED  AND
 13312      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13313         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13314         MOVE ER-2673            TO WS-ERROR
 13315         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13316         MOVE SPACE              TO WS-2671-SW
 13317                                    WS-2672-SW.
 13318
 13319     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13320         IF PB-ISSUE-DATE-FORCED
 13321             MOVE ER-2600          TO  WS-ERROR
 13322             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13323         ELSE
 13324             MOVE ER-2692          TO  WS-ERROR
 13325             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13326
 13327
 13328 3139-EDIT-COVERAGE-CODES.
 13329
 13330     if pb-company-id not = 'AHL'
 13331        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13332           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13333           MOVE ER-2787          TO WS-ERROR
 13334           PERFORM 9900-ERROR-FORMAT
 13335                                 THRU 9900-EXIT
 13336        END-IF
 13337     end-if
 13338     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13339        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13340                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 244
* EL050.cbl
 13341           MOVE ER-2719          TO WS-ERROR
 13342           PERFORM 9900-ERROR-FORMAT
 13343                                 THRU 9900-EXIT
 13344        END-IF
 13345     END-IF
 13346
 13347     IF PB-POLICY-IS-DECLINED  OR
 13348        PB-POLICY-IS-VOIDED
 13349         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13350
 13351     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13352        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13353         MOVE ER-2630                TO WS-ERROR
 13354         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13355
 13356     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13357        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13358        PB-I-LF-PREMIUM-AMT = ZERO
 13359         GO TO 3140-CHECK-AH-FOR-ZERO.
 13360
 13361     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13362        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13363        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13364         GO TO 3140-CHECK-AH-FOR-ZERO.
 13365
 13366     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13367        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13368        MOVE ER-2631             TO WS-ERROR
 13369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13370     END-IF
 13371
 13372
 13373******************************************************************
 13374*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13375******************************************************************
 13376
 13377     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13378        NEXT SENTENCE
 13379     ELSE
 13380        IF PB-I-LF-BENEFIT-AMT = ZERO
 13381           MOVE ER-2632             TO WS-ERROR
 13382           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13383
 13384
 13385******************************************************************
 13386*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13387******************************************************************
 13388
 13389     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13390        CONTINUE
 13391     ELSE
 13392        IF PB-I-LF-PREMIUM-AMT = ZERO
 13393           IF (NOT PB-COMP-LF-PREM)
 13394              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13395              and (ws-lf-ben-category not = 'C')
 13396              MOVE ER-2633       TO WS-ERROR
 13397              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13398           END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 245
* EL050.cbl
 13399        END-IF
 13400     END-IF
 13401     .
 13402 3140-CHECK-AH-FOR-ZERO.
 13403
 13404     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13405        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13406        PB-I-AH-PREMIUM-AMT = ZERO
 13407         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13408
 13409     IF PB-COMPANY-ID = 'CSL'  AND
 13410        PB-I-AH-BENEFIT-CD = ZERO  AND
 13411        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13412        PB-I-AH-PREMIUM-AMT = ZERO
 13413         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13414
 13415     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13416        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13417        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13418         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13419
 13420     IF PB-I-AH-BENEFIT-CD = ZERO
 13421         MOVE ER-2634            TO WS-ERROR
 13422         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13423
 13424******************************************************************
 13425*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13426******************************************************************
 13427
 13428     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13429        NEXT SENTENCE
 13430     ELSE
 13431        IF PB-I-AH-BENEFIT-AMT = ZERO
 13432           MOVE ER-2635             TO WS-ERROR
 13433           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13434
 13435******************************************************************
 13436*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13437******************************************************************
 13438
 13439     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13440        NEXT SENTENCE
 13441     ELSE
 13442        IF PB-I-AH-PREMIUM-AMT = ZERO
 13443            IF NOT PB-COMP-AH-PREM
 13444                MOVE ER-2636    TO WS-ERROR
 13445                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13446
 13447
 13448 3140-EDIT-MAX-AMT-SIZES.
 13449* CUSTOM CODE FOR CLIENT    'DMD'
 13450     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13451                                     WS-RES-MUNI-TAX
 13452                                     PB-I-STATE-TAX
 13453                                     PB-I-MUNI-TAX.
 13454
 13455     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13456
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 246
* EL050.cbl
 13457     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13458        GO TO 3150-RATE-OUTSTAND-BAL.
 13459
 13460     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13461        GO TO 3150-RATE-OUTSTAND-BAL.
 13462
 13463     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13464        GO TO 3150-RATE-OUTSTAND-BAL.
 13465
 13466     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13467                             OR 'RIC')
 13468        GO TO 3150-RATE-OUTSTAND-BAL.
 13469
 13470     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13471        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13472            GO TO 3150-RATE-OUTSTAND-BAL
 13473        ELSE
 13474           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13475               GO TO 3150-RATE-OUTSTAND-BAL.
 13476
 13477     IF NOT PB-NO-MONTHS-SKIPPED
 13478        GO TO 3150-RATE-OUTSTAND-BAL.
 13479
 13480     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13481        GO TO 3150-RATE-OUTSTAND-BAL.
 13482
 13483     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13484        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13485           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13486             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13487           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13488           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13489              MOVE ER-2693     TO WS-ERROR
 13490              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13491              GO TO 3150-RATE-OUTSTAND-BAL
 13492           ELSE
 13493              GO TO 3150-RATE-OUTSTAND-BAL.
 13494
 13495 3150-RATE-OUTSTAND-BAL.
 13496
 13497* DMD RATING TEST
 13498     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13499         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13500         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13501         MOVE ER-2687                 TO WS-ERROR
 13502         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13503         MOVE 'B'                     TO PB-I-OB-FLAG
 13504         GO TO 3260-EDIT-CONTINUE.
 13505
 13506     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13507         IF  WS-ERROR    EQUAL    ER-2693
 13508             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13509                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13510                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13511                 MOVE  +0            TO  WS-ERROR.
 13512
 13513     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13514         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 247
* EL050.cbl
 13515             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13516                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13517                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13518                 MOVE  +0            TO  WS-ERROR.
 13519
 13520     IF PLAN-MASTER-AH-SW = 'Y'
 13521        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13522            IF  WS-ERROR    EQUAL    ER-2693
 13523              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13524                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13525                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13526                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13527                 MOVE  ER-1910           TO  WS-ERROR
 13528                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13529
 13530     IF PLAN-MASTER-AH-SW = 'Y'
 13531        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13532            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13533               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13534               MOVE  ER-1910           TO  WS-ERROR
 13535               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13536
 13537     IF PLAN-MASTER-AH-SW = 'Y'
 13538        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13539            IF  WS-ERROR    EQUAL    ER-2693
 13540                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13541                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13542                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13543                 MOVE  +0       TO  WS-ERROR.
 13544
 13545     IF WS-ERROR = ER-2693
 13546        IF PB-COMPANY-ID = 'JAL' AND
 13547           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13548           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13549           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13550
 13551     IF WS-ERROR = ER-2693
 13552        IF PB-COMPANY-ID = 'NCL'  AND
 13553           PB-I-AH-BENEFIT-CD = 'OA'
 13554           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13555           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13556
 13557     IF WS-ERROR = ER-2693
 13558        IF PB-COMPANY-ID = 'CNL' AND
 13559           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13560           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13561           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13562
 13563     IF WS-ERROR = ER-2693
 13564        IF PB-COMPANY-ID = 'HER'
 13565           IF WS-LEVEL
 13566              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13567              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13568
 13569     IF ((LF-BENEFIT-FOUND) AND
 13570         (NOT NO-LIFE-COVERAGE)  AND
 13571         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13572       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 248
* EL050.cbl
 13573             (NOT NO-AH-COVERAGE)    AND
 13574             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13575         NEXT SENTENCE
 13576     ELSE
 13577         GO TO 3215-EDIT-RATES.
 13578
 13579     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13580        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13581           MOVE ER-2674          TO WS-ERROR
 13582           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13583           GO TO 3215-EDIT-RATES.
 13584
 13585     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13586        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13587           MOVE ER-2674          TO WS-ERROR
 13588           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13589           GO TO 3215-EDIT-RATES.
 13590
 13591     MOVE 'B'                    TO PB-I-OB-FLAG.
 13592
 13593     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13594         NEXT SENTENCE
 13595     ELSE
 13596         IF NOT NO-LIFE-COVERAGE
 13597             IF WS-ACCT-LF-OB-RT = ZERO
 13598                MOVE ER-2641    TO WS-ERROR
 13599                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13600
 13601     IF PB-COMPANY-ID = 'CRI'
 13602       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13603         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13604         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13605         IF WS-ERROR = ER-2675
 13606            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13607            MOVE ER-2687              TO WS-ERROR
 13608            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13609         ELSE
 13610            MOVE ER-2687              TO WS-ERROR
 13611            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13612
 13613
 13614     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13615         NEXT SENTENCE
 13616     ELSE
 13617       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13618            NEXT SENTENCE
 13619       ELSE
 13620         IF NOT NO-AH-COVERAGE
 13621             IF WS-ACCT-AH-OB-RT = ZERO
 13622                MOVE ER-2642    TO WS-ERROR
 13623                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13624
 13625     IF PB-COMPANY-ID = 'CRI'
 13626       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13627         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13628         IF WS-ERROR = ER-2676
 13629            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13630            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 249
* EL050.cbl
 13631            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13632         ELSE
 13633            MOVE ER-2687              TO WS-ERROR
 13634            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13635
 13636     IF PB-COMPANY-ID NOT = 'GIC'
 13637         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13638            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13639     ELSE
 13640         IF PB-I-LF-PREM-CALC = ZEROS
 13641             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13642                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13643
 13644     IF PB-COMPANY-ID NOT = 'GIC'
 13645         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13646            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13647     ELSE
 13648         IF PB-I-AH-PREM-CALC = ZEROS
 13649             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13650                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13651
 13652     MOVE ZEROS TO PB-I-MORT-CODE.
 13653
 13654     GO TO 3260-EDIT-CONTINUE.
 13655
 13656
 13657 3215-EDIT-RATES.
 13658     IF ACCOUNT-MAST-FOUND
 13659         NEXT SENTENCE
 13660     ELSE
 13661         GO TO 3999-END-EDIT.
 13662
 13663 3220-CHECK-LF-RATES.
 13664
 13665     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13666        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13667        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13668        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13669           AND (NOT WS-LF-CASH))
 13670                           OR
 13671           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13672           AND (NOT WS-AH-CASH)))
 13673                       AND
 13674           (PB-I-ENTRY-STATUS NOT = '5')
 13675           MOVE 'M'              TO PB-BATCH-ENTRY
 13676                                    PB-I-ENTRY-STATUS
 13677        END-IF
 13678     END-IF
 13679     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13680                                    PB-I-AH-PREM-CALC
 13681                                    PB-I-LF-ALT-PREM-CALC
 13682                                    PB-I-LF-ALT-RATE
 13683                                    PB-I-LF-REI-RATE
 13684                                    PB-I-LF-ALT-REI-RATE
 13685                                    PB-I-AH-REI-RATE
 13686                                    PB-I-TOT-FEES-CALC.
 13687
 13688     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 250
* EL050.cbl
 13689        NEXT SENTENCE
 13690     ELSE
 13691        MOVE ZEROS               TO PB-I-LF-RATE
 13692                                    PB-I-AH-RATE.
 13693
 13694     IF PB-I-TOT-FEES NOT NUMERIC
 13695        MOVE ZEROS               TO PB-I-TOT-FEES
 13696     END-IF
 13697     IF PB-I-LIVES NOT NUMERIC
 13698         MOVE ZERO               TO PB-I-LIVES.
 13699
 13700     IF PB-I-NUM-BILLED NOT NUMERIC
 13701         MOVE ZERO               TO PB-I-NUM-BILLED.
 13702
 13703     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13704        MOVE +0                  TO PB-I-LF-PREM-TAX
 13705     END-IF
 13706
 13707     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13708        MOVE +0                  TO PB-I-AH-PREM-TAX
 13709     END-IF
 13710
 13711     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13712        PB-I-PAY-FREQUENCY = ZEROS
 13713            MOVE 12 TO CP-PAY-FREQUENCY
 13714     ELSE
 13715            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13716
 13717     IF PB-I-STATE-TAX NOT NUMERIC
 13718         MOVE ZEROS               TO PB-I-STATE-TAX.
 13719
 13720     IF PB-I-MUNI-TAX NOT NUMERIC
 13721         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13722
 13723     MOVE SPACES                 TO CP-BEN-CATEGORY
 13724     IF PB-COMPANY-ID  = 'CSL'  AND
 13725        PB-I-LF-TERM NOT = ZERO
 13726        COMPUTE WS-PAYMENT-AMT =
 13727             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13728        COMPUTE WS-CSL-AMT1 =
 13729             PB-I-LF-TERM * AM-MAX-MON-BEN
 13730        COMPUTE WS-CSL-AMT2 =
 13731             WS-PAYMENT-AMT * PB-I-LF-TERM
 13732        IF CP-PAY-FREQUENCY NOT = 12
 13733           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13734           MOVE '8' TO WS-CSL-CALC-CD
 13735        ELSE
 13736           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13737              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13738               AM-MAX-TOT-BEN
 13739               MOVE '6' TO WS-CSL-CALC-CD
 13740           ELSE
 13741              IF (WS-CSL-AMT1  GREATER THAN
 13742                 AM-MAX-TOT-BEN) AND
 13743                 (WS-CSL-AMT2  GREATER THAN
 13744                 AM-MAX-TOT-BEN)
 13745                 MOVE '7' TO WS-CSL-CALC-CD
 13746              ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 251
* EL050.cbl
 13747                 MOVE '5' TO WS-CSL-CALC-CD.
 13748
 13749     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13750         NEXT SENTENCE
 13751     ELSE
 13752         GO TO 3300-CHECK-AH-RATES.
 13753
 13754*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13755
 13756     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13757        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13758              OR
 13759           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13760           MOVE ER-2618          TO WS-ERROR
 13761           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13762           GO TO 3300-CHECK-AH-RATES.
 13763
 13764     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13765           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13766                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13767
 13768     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13769         MOVE ER-2687             TO WS-ERROR
 13770         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13771         MOVE 'Z000'              TO PB-I-MORT-CODE
 13772         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13773         GO TO 3300-CHECK-AH-RATES.
 13774
 13775     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13776        IF PB-I-LIVES = ZERO
 13777           MOVE ER-2688          TO WS-ERROR
 13778           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13779
 13780     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13781
 13782     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13783     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13784     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13785     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13786     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13787     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13788     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13789     MOVE '3'                    TO CP-PROCESS-TYPE.
 13790     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13791     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13792
 13793******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13794     IF PB-COMPANY-ID EQUAL 'CDL'
 13795         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13796            CP-EARN-AS-NET-PAY)
 13797             IF PB-CERT-EFF-DT GREATER  WS-931231
 13798                 MOVE '1'        TO CP-EARNING-METHOD.
 13799*******
 13800
 13801     MOVE PB-SV-STATE            TO CP-STATE.
 13802     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13803     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13804     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 252
* EL050.cbl
 13805     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13806     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13807                                    CP-RATING-BENEFIT-AMT.
 13808     IF CP-STATE-STD-ABBRV = 'OR'
 13809         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13810                                         PB-I-LF-ALT-BENEFIT-AMT.
 13811     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13812     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13813     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13814     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13815     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13816     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13817     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13818     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13819     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13820                                    CP-REMAINING-TERM
 13821                                    CP-LOAN-TERM.
 13822
 13823     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13824         NEXT SENTENCE
 13825     ELSE
 13826         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13827             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13828                                           PB-I-LF-PREMIUM-AMT.
 13829
 13830     IF PB-COMPANY-ID EQUAL 'CSL'
 13831        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13832           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13833                                         PB-I-LF-PREMIUM-AMT.
 13834
 13835     IF PB-COMPANY-ID EQUAL 'NCB'
 13836         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13837            CP-EARN-AS-NET-PAY
 13838             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13839                 PB-I-LF-PREMIUM-AMT.
 13840
 13841     IF (CP-TRUNCATED-LIFE)
 13842        or ((pb-company-id = 'AHL')
 13843           and (pb-i-loan-term > pb-i-lf-term))
 13844        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13845
 13846     IF PB-COMPANY-ID EQUAL 'CRI'
 13847        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13848
 13849     IF CP-TERM-IS-DAYS
 13850         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13851     ELSE
 13852         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13853     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13854        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13855        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13856        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13857        IF WS-LF-BEN-CATEGORY = 'D'
 13858           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13859           MOVE PB-I-LIFE-COMMISSION
 13860                                 TO CP-DCC-ACT-COMM
 13861           MOVE WS-LF-BEN-CATEGORY
 13862                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 253
* EL050.cbl
 13863        END-IF
 13864        IF (CP-BENEFIT-CD (1:1) = 'P')
 13865           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13866           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13867           add pb-i-ah-premium-amt to cp-original-premium
 13868        END-IF
 13869     END-IF
 13870     IF PB-COMPANY-ID = 'CSL'
 13871         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13872         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13873         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13874
 13875     IF PB-COMPANY-ID = 'CSL'
 13876        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13877
 13878     IF (CP-SPECIAL-CALC-CD = 'H')
 13879        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13880         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13881                                    TO CP-ALTERNATE-BENEFIT
 13882         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13883     if (pb-company-id = 'CID')
 13884        and (ws-lf-earnings-calc = '4')
 13885        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13886        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13887        move pb-i-term-type      to cp-pmt-mode
 13888        move pb-i-no-of-payments to cp-no-of-pmts
 13889     end-if
 13890     move ws-net-only-state      to cp-net-only-state
 13891     IF (PB-COMPANY-ID = 'CID')
 13892        AND (WS-LF-EARNINGS-CALC = 'B')
 13893        AND (CP-STATE-STD-ABBRV = 'MN')
 13894        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13895                                 TO CP-ALTERNATE-BENEFIT
 13896        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13897     END-IF
 13898     IF (PB-COMPANY-ID = 'CID')
 13899        AND (WS-LF-EARNINGS-CALC = 'B')
 13900        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13901                                 TO CP-ALTERNATE-BENEFIT
 13902        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13903        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13904*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13905*         pb-i-lf-alt-premium-amt
 13906        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13907        IF WS-LF-BEN-CATEGORY = 'P'
 13908           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13909        ELSE
 13910           IF WS-LF-BEN-CATEGORY = 'I'
 13911              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13912           END-IF
 13913        END-IF
 13914     END-IF
 13915     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13916     MOVE 'R'                   TO CP-RATE-FILE.
 13917     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13918
 13919     IF CP-ERROR-RATE-NOT-FOUND
 13920        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 254
* EL050.cbl
 13921        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13922        GO TO 3300-CHECK-AH-RATES.
 13923
 13924     IF PB-COMPANY-ID EQUAL 'CRI'
 13925        IF CP-ERROR-NO-LIMITS-CRI
 13926           IF NOT ACCOUNT-LIFE-CHECKED
 13927              MOVE ER-2607      TO WS-ERROR
 13928              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13929
 13930******************************************************************
 13931*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13932*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13933******************************************************************
 13934
 13935* CALC LIFE AGE AT EXPIRATION.
 13936
 13937     COMPUTE WS-AGE-AT-EXPIRE =
 13938          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13939
 13940*    IF PB-STATE = 'CO' OR 'UT'
 13941*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13942*        MOVE 'F'            TO PB-FATAL-FLAG
 13943*        MOVE ER-2709        TO WS-ERROR
 13944*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13945*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13946
 13947*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13948*        MOVE 'X'            TO PB-FATAL-FLAG
 13949*        MOVE ER-2718        TO WS-ERROR
 13950*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13951*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13952
 13953* CALC A & H AGE AT EXPIRATION.
 13954
 13955     COMPUTE WS-AGE-AT-EXPIRE =
 13956          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13957
 13958*    IF PB-STATE = 'CO' OR 'UT'
 13959*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13960*        MOVE 'F'            TO PB-FATAL-FLAG
 13961*        MOVE ER-2709        TO WS-ERROR
 13962*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13963*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13964
 13965*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13966*        MOVE 'X'            TO PB-FATAL-FLAG
 13967*        MOVE ER-2718        TO WS-ERROR
 13968*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13969*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13970
 13971     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13972        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13973
 13974     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13975        and (not pb-monthly-cert)
 13976        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13977     end-if
 13978
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 255
* EL050.cbl
 13979     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13980        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13981
 13982     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13983         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13984         MOVE ER-2639        TO WS-ERROR
 13985         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13986
 13987
 13988******************************************************************
 13989*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13990******************************************************************
 13991
 13992 PREMIUM-EDITING-IS-BYPASSED.
 13993     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13994        AND (CP-R-MAX-ATT-AGE > +0)
 13995        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13996        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13997           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13998           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13999           MOVE '1'              TO DC-OPTION-CODE
 14000           PERFORM 8500-DATE-CONVERT
 14001                                 THRU 8500-EXIT
 14002           IF NO-CONVERSION-ERROR
 14003              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14004                 MOVE ER-2661       TO WS-ERROR
 14005*                PERFORM 9900-ERROR-FORMAT
 14006*                                THRU 9900-EXIT
 14007              END-IF
 14008           END-IF
 14009        ELSE
 14010           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14011           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14012              MOVE ER-2661       TO WS-ERROR
 14013*             PERFORM 9900-ERROR-FORMAT
 14014*                                THRU 9900-EXIT
 14015           ELSE
 14016              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14017                 MOVE ER-1570    TO WS-ERROR
 14018                 PERFORM 9900-ERROR-FORMAT
 14019                                 THRU 9900-EXIT
 14020              END-IF
 14021           END-IF
 14022        END-IF
 14023        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14024           MOVE PB-I-JOINT-BIRTHDAY
 14025                                 TO DC-BIN-DATE-1
 14026           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14027           MOVE '1'              TO DC-OPTION-CODE
 14028           PERFORM 8500-DATE-CONVERT
 14029                                 THRU 8500-EXIT
 14030           IF NO-CONVERSION-ERROR
 14031              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14032                 MOVE ER-2661       TO WS-ERROR
 14033*                PERFORM 9900-ERROR-FORMAT
 14034*                                THRU 9900-EXIT
 14035              END-IF
 14036           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 256
* EL050.cbl
 14037              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14038           END-IF
 14039        ELSE
 14040           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14041             (PB-I-LF-TERM / 12)
 14042           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14043              MOVE ER-2661       TO WS-ERROR
 14044*             PERFORM 9900-ERROR-FORMAT
 14045*                                THRU 9900-EXIT
 14046           ELSE
 14047              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14048                 MOVE ER-1571    TO WS-ERROR
 14049                 PERFORM 9900-ERROR-FORMAT
 14050                                 THRU 9900-EXIT
 14051              END-IF
 14052           END-IF
 14053        END-IF
 14054        IF WS-ERROR = ER-2661
 14055           PERFORM 9900-ERROR-FORMAT
 14056                                 THRU 9900-EXIT
 14057        END-IF
 14058     END-IF
 14059*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14060*       MOVE ER-2661             TO WS-ERROR
 14061*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14062
 14063     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14064        MOVE ER-2662             TO WS-ERROR
 14065        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14066
 14067     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14068        MOVE ER-2677             TO WS-ERROR
 14069        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14070
 14071     IF CP-ERROR-LOAN-TERM
 14072        MOVE ER-2648             TO WS-ERROR
 14073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14074
 14075 3221-CHECK-ERROR-RATE-OPEN.
 14076
 14077     IF CP-ERROR-RATE-FILE-NOTOPEN
 14078         GO TO 3990-FILES-NOT-OPEN.
 14079
 14080     IF PB-COMPANY-ID NOT = 'DMD'
 14081        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14082     END-IF
 14083     .
 14084 3221-CONTINUE.
 14085     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14086                                    WS-DCC-AH-RATE
 14087     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14088        IF WS-LF-BEN-CATEGORY = 'D'
 14089           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14090              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14091        END-IF
 14092     END-IF
 14093     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14094*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 257
* EL050.cbl
 14095     IF (PB-COMPANY-ID = 'CID')
 14096        AND (WS-LF-EARNINGS-CALC = 'B')
 14097        AND (CP-STATE-STD-ABBRV = 'MN')
 14098        AND (PB-CERT-EFF-DT > X'A4FF')
 14099        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14100     END-IF
 14101     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14102
 14103     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14104     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14105        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14106        AND (PB-I-POLICY-IS-MONTHLY)
 14107        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14108        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14109     END-IF
 14110     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14111     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14112     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14113     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14114     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14115        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14116        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14117        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14118        MOVE ER-2786             TO WS-ERROR
 14119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14120     END-IF
 14121
 14122     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14123
 14124******************************************************************
 14125*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14126******************************************************************
 14127     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14128        and ((not pb-monthly-cert)
 14129        or (ws-lf-ben-category = 'C'))
 14130        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14131
 14132     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14133        GO TO 3225-CHECK-ALT-LIFE-RATE
 14134     ELSE
 14135       IF PB-I-LF-RATE = ZERO
 14136          MOVE ER-2641          TO WS-ERROR
 14137          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14138
 14139 3225-CHECK-ALT-LIFE-RATE.
 14140
 14141     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14142        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14143        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14144         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14145
 14146     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14147         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14148             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14149                   OR
 14150              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14151              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14152              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 258
* EL050.cbl
 14153             MOVE ER-2720        TO  WS-ERROR
 14154             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14155             GO TO 3225-RATING-CONT
 14156         ELSE
 14157             GO TO 3225-RATING-CONT.
 14158     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14159        AND (AM-GPCD = 01 OR 06 OR 15)
 14160        MOVE ER-2798             TO WS-ERROR
 14161        PERFORM 9900-ERROR-FORMAT
 14162                                 THRU 9900-EXIT
 14163*       GO TO 3225-RATING-CONT
 14164     END-IF
 14165     if (pb-company-id = 'CID')
 14166        and (ws-lf-earnings-calc = 'B')
 14167        and (ws-lf-ben-category = 'P' or 'I')
 14168        and (ws-net-only-state = 'Y')
 14169        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14170        display ' balloon prem ' pb-i-lf-alt-prem-calc
 14171        go to 3225-rating-cont
 14172     end-if
 14173     IF (PB-COMPANY-ID = 'CID')
 14174        AND (WS-LF-EARNINGS-CALC = 'B')
 14175        AND (CP-STATE-STD-ABBRV = 'MN')
 14176        AND (PB-CERT-EFF-DT > X'A4FF')
 14177        GO TO 3225-RATING-CONT
 14178     END-IF
 14179     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14180        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14181           AND (PB-I-POLICY-IS-MONTHLY)
 14182           GO TO 3225-RATING-CONT
 14183        END-IF
 14184     END-IF
 14185
 14186     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14187        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14188        CP-EARN-AS-REG-BALLOON
 14189        NEXT SENTENCE
 14190     ELSE
 14191        MOVE '2'                 TO CP-EARNING-METHOD.
 14192
 14193 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14194
 14195     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14196
 14197     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14198        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14199        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14200         NEXT SENTENCE
 14201     ELSE
 14202         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14203
 14204     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14205     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14206     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14207                                     CP-RATING-BENEFIT-AMT.
 14208     IF CP-STATE-STD-ABBRV = 'OR'
 14209         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14210                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 259
* EL050.cbl
 14211     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14212        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14213     END-IF
 14214     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14215     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14216     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14217                                    CP-REMAINING-TERM
 14218                                    CP-LOAN-TERM.
 14219     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14220        ADD +1                   TO CP-ORIGINAL-TERM
 14221                                    CP-REMAINING-TERM
 14222                                    CP-LOAN-TERM.
 14223
 14224     MOVE 'R'                   TO CP-RATE-FILE.
 14225     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14226
 14227     IF CP-ERROR-RATE-NOT-FOUND
 14228         MOVE ER-2641            TO WS-ERROR
 14229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14230         GO TO 3300-CHECK-AH-RATES.
 14231
 14232     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14233     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14234
 14235     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14236         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14237
 14238     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14239                               + PB-I-LF-ALT-BENEFIT-AMT.
 14240
 14241     IF ACCOUNT-LIFE-CHECKED  OR
 14242        PB-POLICY-IS-VOIDED   OR
 14243        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14244        and (not pb-monthly-cert))
 14245        GO TO 3225-CONTINUE.
 14246
 14247     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14248        GO TO 3225-CONTINUE.
 14249
 14250     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14251                             EC-RT-LF-MAX-TOT-BEN
 14252        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14253        MOVE ER-2639       TO WS-ERROR
 14254        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14255
 14256 3225-CONTINUE.
 14257     IF PB-I-LF-ALT-RATE = ZERO
 14258         MOVE ER-2659            TO WS-ERROR
 14259         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14260
 14261     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14262        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14263        MOVE ER-2698             TO WS-ERROR
 14264        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14265
 14266 3225-RATING-CONT.
 14267
 14268     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 260
* EL050.cbl
 14269        and (not pb-monthly-cert)
 14270         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14271         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14272         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14273            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14274            CONTINUE
 14275         ELSE
 14276            MOVE ER-2687         TO WS-ERROR
 14277            PERFORM 9900-ERROR-FORMAT
 14278                                 THRU 9900-EXIT
 14279         END-IF
 14280         GO TO 3290-EDIT-LF-REIN-RATE
 14281     END-IF
 14282
 14283* DMD RATING TEST
 14284     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14285         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14286         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14287         MOVE ER-2687                 TO WS-ERROR
 14288         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14289         GO TO 3290-EDIT-LF-REIN-RATE.
 14290
 14291 3230-CLIENT-MORT-CD-SPECIALS.
 14292
 14293     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14294     SET BIN-TO-GREG          TO TRUE.
 14295*    MOVE ' '                 TO DC-OPTION-CODE.
 14296     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14297     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14298
 14299 C-POS-3230-MORT-CD.
 14300     IF PB-COMPANY-ID = 'POS' AND
 14301        PB-SV-CARRIER = '2'
 14302         NEXT SENTENCE
 14303     ELSE
 14304         GO TO C-POS-3240-MORT-CD.
 14305
 14306     IF PB-SV-GROUPING = '030'
 14307        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14308         MOVE '2350' TO PB-I-MORT-CODE
 14309      ELSE
 14310         MOVE '3300' TO PB-I-MORT-CODE.
 14311
 14312
 14313 C-POS-3240-MORT-CD.
 14314     IF PB-COMPANY-ID = 'POS' AND
 14315        PB-SV-CARRIER = '1'
 14316         NEXT SENTENCE
 14317     ELSE
 14318         GO TO 3230-CONTINUE.
 14319
 14320     IF PB-SV-STATE = '45' OR '47'
 14321        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14322         MOVE '5200' TO PB-I-MORT-CODE
 14323     ELSE
 14324         MOVE '8300' TO PB-I-MORT-CODE.
 14325
 14326 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 261
* EL050.cbl
 14327
 14328     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14329        GO TO 3240-CONTINUE
 14330     END-IF
 14331
 14332     IF PB-CERT-EFF-DT > WS-971231
 14333        GO TO 3240-CONTINUE
 14334     END-IF
 14335
 14336     IF LF-BENEFIT-FOUND AND
 14337        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14338         MOVE 'F250'       TO PB-I-MORT-CODE
 14339     ELSE
 14340         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14341             MOVE '7250'   TO PB-I-MORT-CODE
 14342         ELSE
 14343             MOVE '4251'   TO PB-I-MORT-CODE
 14344         END-IF
 14345     END-IF
 14346
 14347     .
 14348 3240-CONTINUE.
 14349
 14350     IF PB-COMPANY-ID NOT = 'GNL'
 14351         GO TO 3256-CONTINUE.
 14352
 14353     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14354         MOVE 'A300' TO PB-I-MORT-CODE
 14355     ELSE
 14356         MOVE '8350' TO PB-I-MORT-CODE.
 14357
 14358 3256-CONTINUE.
 14359     IF PB-COMPANY-ID NOT = 'ABL'
 14360         GO TO 3260-EDIT-CONTINUE.
 14361
 14362     IF PB-I-LF-TERM GREATER THAN 59
 14363         MOVE 'F550' TO PB-I-MORT-CODE
 14364     ELSE
 14365         MOVE 'E550' TO PB-I-MORT-CODE.
 14366
 14367 3260-EDIT-CONTINUE.
 14368     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14369
 14370 3290-EDIT-LF-REIN-RATE.
 14371     IF LF-REIN-NSP-NOT-USED
 14372         GO TO 3290-RATING-CONT.
 14373
 14374     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14375        GO TO 3290-RATING-CONT.
 14376     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14377     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14378     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14379     MOVE '3'                   TO CP-PROCESS-TYPE.
 14380     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14381
 14382******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14383     IF PB-COMPANY-ID EQUAL 'CDL'
 14384         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 262
* EL050.cbl
 14385            CP-EARN-AS-NET-PAY)
 14386             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14387*            MOVE SPACE          TO DC-OPTION-CODE
 14388             SET BIN-TO-GREG     TO TRUE
 14389             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14390***  Y2K PROJ 7744
 14391             IF DC-GREG-DATE-CYMD GREATER 19931231
 14392                 MOVE '1'        TO CP-EARNING-METHOD.
 14393***  Y2K PROJ 7744
 14394*******
 14395
 14396     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14397     MOVE PB-SV-STATE           TO CP-STATE.
 14398     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14399     MOVE ZERO                  TO CP-DEVIATION-CODE
 14400                                   CP-RATE-DEV-PCT.
 14401     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14402     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14403                                   CP-RATING-BENEFIT-AMT.
 14404
 14405************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14406     IF PB-COMPANY-ID EQUAL 'NCB'
 14407         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14408            CP-EARN-AS-NET-PAY
 14409             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14410                 PB-I-LF-PREMIUM-AMT.
 14411************
 14412
 14413     IF CP-STATE-STD-ABBRV = 'OR'
 14414         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14415                                         PB-I-LF-ALT-BENEFIT-AMT.
 14416     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14417     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14418     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14419     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14420     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14421     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14422     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14423     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14424                                   CP-REMAINING-TERM
 14425                                   CP-LOAN-TERM.
 14426     IF CP-TRUNCATED-LIFE
 14427        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14428
 14429     IF CP-TERM-IS-DAYS
 14430         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14431     ELSE
 14432         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14433
 14434     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14435        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14436     END-IF
 14437     IF PB-COMPANY-ID NOT = 'TIC'
 14438          MOVE ZERO          TO CP-CLASS-CODE.
 14439
 14440     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14441
 14442     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 263
* EL050.cbl
 14443     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14444
 14445     IF CP-ERROR-RATE-NOT-FOUND
 14446        IF PB-I-OB
 14447           MOVE ER-2625      TO WS-ERROR
 14448           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14449           GO TO 3299-EDIT-CONTINUE
 14450        ELSE
 14451           MOVE ER-2643      TO WS-ERROR
 14452           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14453           GO TO 3299-EDIT-CONTINUE.
 14454
 14455     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14456
 14457     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14458     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14459
 14460     IF PB-I-LF-REI-RATE = ZERO
 14461         MOVE ER-2643        TO WS-ERROR
 14462         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14463
 14464 3290-CHECK-ALT-REIN-RATE.
 14465
 14466     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14467        GO TO 3290-RATING-CONT.
 14468
 14469     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14470     MOVE '2'                    TO CP-EARNING-METHOD.
 14471     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14472     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14473     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14474     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14475                                     CP-RATING-BENEFIT-AMT.
 14476     IF CP-STATE-STD-ABBRV = 'OR'
 14477         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14478                                         PB-I-LF-ALT-BENEFIT-AMT.
 14479     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14480        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14481     END-IF
 14482     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14483     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14484     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14485                                    CP-REMAINING-TERM
 14486                                    CP-LOAN-TERM.
 14487     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14488        ADD +1                   TO CP-ORIGINAL-TERM
 14489                                    CP-REMAINING-TERM
 14490                                    CP-LOAN-TERM.
 14491
 14492     MOVE 'R'                   TO CP-RATE-FILE.
 14493     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14494
 14495     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14496
 14497     IF PB-I-LF-ALT-REI-RATE = ZERO
 14498         MOVE ER-2643            TO WS-ERROR
 14499         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14500
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 264
* EL050.cbl
 14501 3290-RATING-CONT.
 14502
 14503     IF PB-I-OB
 14504*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14505        GO TO 3300-CHECK-AH-RATES.
 14506
 14507 3299-EDIT-CONTINUE.
 14508
 14509     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14510         NEXT SENTENCE
 14511     ELSE
 14512         MOVE ER-2620           TO WS-ERROR
 14513         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14514
 14515 3300-CHECK-AH-RATES.
 14516     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14517         NEXT SENTENCE
 14518     ELSE
 14519         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14520
 14521     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14522        and (not pb-monthly-cert))
 14523                  or
 14524        ((CF-COMPANY-ID = 'DMD') AND
 14525                (NO-DMD-RATING))
 14526         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14527            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14528            CONTINUE
 14529         ELSE
 14530            MOVE ER-2687         TO WS-ERROR
 14531            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14532         END-IF
 14533         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14534         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14535     END-IF
 14536
 14537     IF PB-I-OB
 14538        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14539
 14540     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14541         MOVE ER-2687             TO WS-ERROR
 14542         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14543         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14544         GO TO 3999-END-EDIT.
 14545
 14546*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14547     if pb-company-id = 'AHL'
 14548        go to 3300-skip-crit-per
 14549     end-if
 14550     if (pb-i-ah-crit-per not = zeros)
 14551        and (ws-ah-special-calc-cd not = 'C')
 14552        MOVE ER-1572             TO WS-ERROR
 14553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14554        go to 3300-skip-crit-per
 14555     END-IF
 14556     if (pb-company-id = 'DCC' or 'VPP')
 14557        and (am-dcc-product-code not = spaces)
 14558        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 265
* EL050.cbl
 14559     end-if
 14560     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14561        IF PB-I-AH-CRIT-PER = ZERO
 14562           move ws-ah-max-bens   to pb-i-ah-crit-per
 14563*          MOVE ER-2618       TO WS-ERROR
 14564*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14565*          GO TO 3999-END-EDIT
 14566        END-IF
 14567     END-IF
 14568     if (ws-ah-special-calc-cd = 'C')
 14569        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14570        MOVE ER-1576             TO WS-ERROR
 14571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14572     end-if
 14573
 14574     .
 14575 3300-skip-crit-per.
 14576     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14577     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14578     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14579     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14580     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14581     MOVE PB-SV-STATE            TO CP-STATE.
 14582     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14583     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14584     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14585*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14586     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14587     MOVE '3'                    TO CP-PROCESS-TYPE.
 14588     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14589     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14590                                    CP-RATING-BENEFIT-AMT.
 14591     IF PB-COMPANY-ID = 'CID'
 14592               OR
 14593        CP-STATE-STD-ABBRV = 'OR'
 14594         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14595                                         PB-I-AH-TERM.
 14596     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14597        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14598           AND (PB-I-POLICY-IS-MONTHLY)
 14599           MOVE PB-I-LF-BENEFIT-AMT
 14600                                 TO CP-NET-BENEFIT-AMT
 14601           move pb-i-ah-premium-amt to cp-original-premium
 14602           add pb-i-lf-premium-amt to cp-original-premium
 14603        END-IF
 14604     END-IF
 14605     MOVE SPACES                 TO CP-BEN-CATEGORY
 14606     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14607        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14608        EVALUATE TRUE
 14609           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14610              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14611              MOVE PB-I-LF-BENEFIT-AMT
 14612                                 TO CP-RATING-BENEFIT-AMT
 14613              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14614           WHEN WS-AH-BEN-CATEGORY = 'G'
 14615              MOVE PB-I-UNPAID-CASH-PRICE
 14616                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 266
* EL050.cbl
 14617           WHEN WS-AH-BEN-CATEGORY = 'D'
 14618              MOVE WS-AH-PMF-COMM
 14619                                 TO CP-DCC-PMF-COMM
 14620              MOVE PB-I-AH-COMMISSION
 14621                                 TO CP-DCC-ACT-COMM
 14622        END-EVALUATE
 14623     END-IF
 14624     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14625     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14626     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14627     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14628     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14629     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14630     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14631                                    CP-REMAINING-TERM
 14632                                    WS-WORK-TERM.
 14633     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14634
 14635     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14636     SET BIN-TO-GREG             TO TRUE.
 14637*    MOVE ' '                    TO DC-OPTION-CODE.
 14638     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14639     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE
 14640
 14641     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14642     IF NOT VALID-SKIP-CODE
 14643         MOVE ER-2683            TO WS-ERROR
 14644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14645         GO TO 3320-RATE-CONTINUE.
 14646
 14647     IF PB-NO-MONTHS-SKIPPED
 14648         GO TO 3320-RATE-CONTINUE.
 14649
 14650     MOVE SPACE TO NUMBER-OF-MONTHS.
 14651
 14652     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14653         MOVE 'S'                TO SK-MO (6).
 14654     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14655         MOVE 'S'                TO SK-MO (7).
 14656     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14657         MOVE 'S'                TO SK-MO (8).
 14658     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14659         MOVE 'S'                TO SK-MO (9).
 14660     IF PB-I-SKIP-CODE = 'A'
 14661         MOVE 'S'                TO SK-MO (10).
 14662
 14663     MOVE 1                      TO SUB2.
 14664     MOVE PB-I-AH-TERM           TO SUB3.
 14665     MOVE WS-MONTH               TO SUB1.
 14666     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14667     GO TO 3320-RATE-CONTINUE.
 14668
 14669 3310-GET-SKIP-MO.
 14670     IF SUB1 = 13
 14671         MOVE 1                  TO SUB1.
 14672
 14673     IF SK-MO (SUB1) = 'S'
 14674         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 267
* EL050.cbl
 14675
 14676     ADD 1 TO SUB2
 14677              SUB1.
 14678
 14679 3320-RATE-CONTINUE.
 14680
 14681     IF WS-WORK-TERM = ZERO
 14682         MOVE 1                  TO WS-WORK-TERM.
 14683
 14684     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14685                                    CP-LOAN-TERM.
 14686
 14687     IF PB-COMPANY-ID EQUAL 'DMD'
 14688         NEXT SENTENCE
 14689     ELSE
 14690         MOVE ZERO               TO PB-I-AH-RATE
 14691                                    PB-I-AH-REI-RATE.
 14692
 14693
 14694     IF PB-COMPANY-ID EQUAL 'CRI'
 14695        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14696
 14697     IF PB-COMPANY-ID = 'CSL'
 14698         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14699         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14700         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14701         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14702
 14703     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14704        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14705           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14706              PB-I-RATE-DEV-PCT-LF
 14707        END-IF
 14708        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14709                                 TO CP-ALTERNATE-BENEFIT
 14710        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14711        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14712        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14713     END-IF
 14714*    if ws-clp-state not = spaces
 14715*       move ws-clp-state to cp-state
 14716*    end-if
 14717     IF (PB-COMPANY-ID = 'CID')
 14718        AND (WS-LF-EARNINGS-CALC = 'B')
 14719        AND (CP-STATE-STD-ABBRV = 'MN')
 14720        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14721     ELSE
 14722        MOVE ' '                 TO CP-AH-BALLOON-SW
 14723     END-IF
 14724     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14725     MOVE 'R'                   TO CP-RATE-FILE.
 14726     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14727
 14728     IF (CP-ERROR-RATE-NOT-FOUND)
 14729        and (not pb-monthly-cert)
 14730        IF PB-I-OB
 14731           MOVE ER-2624          TO WS-ERROR
 14732           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 268
* EL050.cbl
 14733           GO TO 3340-CALCULATE-PREMIUM-AMT
 14734        ELSE
 14735          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14736              NEXT SENTENCE
 14737          ELSE
 14738           MOVE ER-2642          TO WS-ERROR
 14739           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14740           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14741
 14742     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14743        CP-ERROR-DIV-BY-ZERO
 14744           MOVE ER-3782          TO WS-ERROR
 14745           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14746
 14747     IF PB-COMPANY-ID EQUAL 'CRI'
 14748        IF CP-ERROR-NO-LIMITS-CRI
 14749           IF NOT ACCOUNT-AH-CHECKED
 14750              MOVE ER-2607          TO WS-ERROR
 14751              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14752
 14753     IF ACCOUNT-AH-CHECKED
 14754        NEXT SENTENCE
 14755     ELSE
 14756       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14757          MOVE ER-2640           TO WS-ERROR
 14758          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14759
 14760     IF PB-COMPANY-ID = 'CRI'
 14761         IF WS-ERROR = ER-2640
 14762             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14763     IF ACCOUNT-AH-CHECKED
 14764        CONTINUE
 14765     ELSE
 14766        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14767           AND (CP-R-MAX-ATT-AGE > +0)
 14768           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14769           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14770              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14771              MOVE PB-I-AH-EXPIRE-DT
 14772                                 TO DC-BIN-DATE-2
 14773              MOVE '1'           TO DC-OPTION-CODE
 14774              PERFORM 8500-DATE-CONVERT
 14775                                 THRU 8500-EXIT
 14776              IF NO-CONVERSION-ERROR
 14777                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14778                    MOVE ER-2661       TO WS-ERROR
 14779*                   PERFORM 9900-ERROR-FORMAT
 14780*                                THRU 9900-EXIT
 14781                 END-IF
 14782              END-IF
 14783           ELSE
 14784              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14785              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14786                 MOVE ER-2661    TO WS-ERROR
 14787*                PERFORM 9900-ERROR-FORMAT
 14788*                                THRU 9900-EXIT
 14789              ELSE
 14790                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 269
* EL050.cbl
 14791                    MOVE ER-1570 TO WS-ERROR
 14792                    PERFORM 9900-ERROR-FORMAT
 14793                                 THRU 9900-EXIT
 14794                 END-IF
 14795              END-IF
 14796           END-IF
 14797           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14798              MOVE PB-I-JOINT-BIRTHDAY
 14799                                    TO DC-BIN-DATE-1
 14800              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14801              MOVE '1'              TO DC-OPTION-CODE
 14802              PERFORM 8500-DATE-CONVERT
 14803                                    THRU 8500-EXIT
 14804              IF NO-CONVERSION-ERROR
 14805                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14806                    MOVE ER-2661       TO WS-ERROR
 14807*                   PERFORM 9900-ERROR-FORMAT
 14808*                                   THRU 9900-EXIT
 14809                 END-IF
 14810              END-IF
 14811           ELSE
 14812              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14813                (PB-I-AH-TERM / 12)
 14814              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14815                 MOVE ER-2661       TO WS-ERROR
 14816*                PERFORM 9900-ERROR-FORMAT
 14817*                                   THRU 9900-EXIT
 14818              ELSE
 14819                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14820                    MOVE ER-1571 TO WS-ERROR
 14821                    PERFORM 9900-ERROR-FORMAT
 14822                                 THRU 9900-EXIT
 14823                 END-IF
 14824              END-IF
 14825           END-IF
 14826           IF WS-ERROR = ER-2661
 14827              PERFORM 9900-ERROR-FORMAT
 14828                                    THRU 9900-EXIT
 14829           END-IF
 14830        END-IF
 14831     END-IF
 14832*    IF ACCOUNT-AH-CHECKED
 14833*       NEXT SENTENCE
 14834*    ELSE
 14835*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14836*          MOVE ER-2661          TO WS-ERROR
 14837*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14838
 14839     IF ACCOUNT-AH-CHECKED
 14840        NEXT SENTENCE
 14841     ELSE
 14842        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14843           MOVE ER-2663          TO WS-ERROR
 14844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14845
 14846     IF ACCOUNT-AH-CHECKED OR
 14847        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14848         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 270
* EL050.cbl
 14849        NEXT SENTENCE
 14850     ELSE
 14851        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14852           MOVE ER-2667            TO WS-ERROR
 14853           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14854
 14855     IF PB-COMPANY-ID = 'CRI'
 14856         IF WS-ERROR = ER-2667
 14857             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14858
 14859     IF ACCOUNT-AH-CHECKED
 14860        NEXT SENTENCE
 14861     ELSE
 14862        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14863           MOVE ER-2678            TO WS-ERROR
 14864           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14865
 14866     IF CP-ERROR-RATE-FILE-NOTOPEN
 14867         GO TO 3990-FILES-NOT-OPEN.
 14868
 14869 3321-CONTINUE.
 14870     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14871     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14872     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14873*    IF (PB-COMPANY-ID = 'DCC')
 14874        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14875        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14876                                    PB-I-LF-ALT-PREM-CALC
 14877        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14878        IF WS-AH-BEN-CATEGORY = 'G'
 14879           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14880           + PB-I-ADDL-CLP)
 14881           * (1 + WS-TOL-CLP-PCT)
 14882*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14883        ELSE
 14884           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14885           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14886*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14887        END-IF
 14888        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14889                                 TO PB-I-AH-PREM-CALC
 14890        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14891           MOVE ER-8152          TO WS-ERROR
 14892           PERFORM 9900-ERROR-FORMAT
 14893                                 THRU 9900-EXIT
 14894        ELSE
 14895           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14896                 PB-I-ADDL-CLP)
 14897              MOVE ER-8148       TO WS-ERROR
 14898              PERFORM 9900-ERROR-FORMAT
 14899                                 THRU 9900-EXIT
 14900           END-IF
 14901        END-IF
 14902     END-IF
 14903     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14904        AND (PB-I-POLICY-IS-MONTHLY)
 14905        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14906        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 271
* EL050.cbl
 14907        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14908           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14909        END-IF
 14910     END-IF
 14911     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14912        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14913        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14914        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14915        MOVE ER-2786             TO WS-ERROR
 14916        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14917     END-IF
 14918     MOVE +0                     TO PB-I-AH-CLP
 14919     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14920        evaluate true
 14921           when WS-AH-BEN-CATEGORY = 'D'
 14922              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14923                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14924           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14925              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14926           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14927              compute ws-cred-union-fees rounded =
 14928                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14929                    pb-i-ah-commission)
 14930              COMPUTE PB-I-AH-CLP =
 14931                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14932        end-evaluate
 14933     END-IF
 14934     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14935
 14936     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14937         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14938
 14939     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14940         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14941
 14942     if (ws-ah-special-calc-cd = 'E')
 14943        and (pb-monthly-cert)
 14944        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14945     end-if
 14946     IF PB-COMPANY-ID = 'CRI'
 14947         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14948            PB-I-PAYMENT-AMOUNT = ZERO
 14949             NEXT SENTENCE
 14950         ELSE
 14951             COMPUTE PB-I-AH-PREM-CALC =
 14952                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14953                 (CP-PREMIUM-RATE / 100)
 14954             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14955                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14956                                             PB-I-RATE-DEV-PCT-AH.
 14957
 14958     IF (PB-I-AH-RATE  = ZERO)
 14959        and (not pb-monthly-cert)
 14960       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14961           NEXT SENTENCE
 14962       ELSE
 14963         MOVE ER-2642            TO WS-ERROR
 14964         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 272
* EL050.cbl
 14965
 14966     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14967     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14968     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14969     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14970     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14971     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14972
 14973     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14974        AND (WS-AH-BEN-CATEGORY = 'G')
 14975        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14976        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14977        IF CP-DEVIATION-CODE NOT = '000'
 14978           MOVE '000'            TO CP-DEVIATION-CODE
 14979           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14980           IF NO-CP-ERROR
 14981              COMPUTE PB-I-DDF-IU-RATE-UP =
 14982              PB-I-AH-CLP - CP-CALC-PREMIUM
 14983           ELSE
 14984              MOVE ER-3057        TO WS-ERROR
 14985              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14986           END-IF
 14987        END-IF
 14988     END-IF
 14989     .
 14990 3335-EDIT-AH-REIN-NSP-RATE.
 14991     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14992        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14993              compute ws-cred-union-fees rounded =
 14994                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14995                    pb-i-ah-commission)
 14996              COMPUTE PB-I-AH-CLP =
 14997                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14998        end-if
 14999     END-IF
 15000     IF AH-REIN-NSP-NOT-USED
 15001         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15002
 15003     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 15004     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15005         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15006     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 15007     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 15008     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 15009     MOVE PB-SV-STATE            TO CP-STATE.
 15010     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15011     MOVE ZERO                   TO CP-DEVIATION-CODE
 15012                                    CP-RATE-DEV-PCT.
 15013*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15014     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15015     MOVE '3'                    TO CP-PROCESS-TYPE.
 15016     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 15017     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15018                                    CP-RATING-BENEFIT-AMT.
 15019     IF CP-STATE-STD-ABBRV = 'OR'
 15020         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 15021                                         PB-I-AH-TERM.
 15022     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 273
* EL050.cbl
 15023     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15024     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15025     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15026     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15027     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 15028                                    CP-REMAINING-TERM
 15029                                    WS-WORK-TERM.
 15030     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 15031     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15032        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15033     END-IF
 15034     IF  PB-COMPANY-ID = 'TIC'
 15035         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15036            MOVE ZERO TO CP-CLASS-CODE.
 15037
 15038     IF PB-COMPANY-ID NOT = 'TIC'
 15039          MOVE ZERO          TO CP-CLASS-CODE.
 15040
 15041     MOVE ZERO               TO CP-DEVIATION-CODE.
 15042
 15043     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15044
 15045     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15046
 15047     MOVE 'R'                   TO CP-RATE-FILE.
 15048     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15049
 15050     IF CP-ERROR-RATE-NOT-FOUND
 15051         MOVE ER-2645        TO WS-ERROR
 15052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15053         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15054
 15055     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15056
 15057     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15058     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15059
 15060     IF PB-I-AH-REI-RATE = ZERO
 15061         MOVE ER-2645        TO WS-ERROR
 15062         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15063
 15064
 15065 3340-CALCULATE-PREMIUM-AMT.
 15066     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15067     SET BIN-TO-GREG             TO TRUE
 15068     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 15069     move dc-greg-date-a-edit    to ws-greg-eff-date
 15070
 15071     IF PB-COMPANY-ID = 'NCL'
 15072         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15073             WS-AH-SPECIAL-CALC-CD = 'O')
 15074             GO TO 3999-END-EDIT.
 15075
 15076     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15077                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15078                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15079                         OR 'AHL'
 15080         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 274
* EL050.cbl
 15081     ELSE
 15082         IF WS-STATE-ABBREVIATION = 'CT'
 15083             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15084                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 15085                 COMPUTE PB-I-LF-PREM-CALC =
 15086                                     PB-I-LF-PREM-CALC * .90
 15087                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15088                                     PB-I-LF-ALT-PREM-CALC * .90
 15089                 COMPUTE PB-I-AH-PREM-CALC =
 15090                                     PB-I-AH-PREM-CALC * .90.
 15091
 15092     IF PB-COMP-LF-PREM
 15093        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15094        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15095
 15096     IF PB-COMP-AH-PREM
 15097        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15098
 15099 3340-CHECK-DCC-TOT-FEES.
 15100     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15101        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15102        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15103        AND (PB-I-POLICY-IS-MONTHLY)
 15104        CONTINUE
 15105     ELSE
 15106        GO TO 3340-EDIT-LF-AH-TOL
 15107     END-IF
 15108     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15109     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15110     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15111        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15112           PB-I-RATE-DEV-PCT-LF
 15113     END-IF
 15114     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15115        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15116           PB-I-RATE-DEV-PCT-AH
 15117     END-IF
 15118     MOVE 'N'                    TO CP-BEN-CATEGORY
 15119     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15120
 15121     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15122     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15123     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15124     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15125     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15126     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15127     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15128     MOVE '3'                    TO CP-PROCESS-TYPE.
 15129     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15130     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15131
 15132     MOVE PB-SV-STATE            TO CP-STATE.
 15133     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15134     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15135     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15136     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15137     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15138                                    CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 275
* EL050.cbl
 15139     IF CP-STATE-STD-ABBRV = 'OR'
 15140         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15141                                         PB-I-LF-ALT-BENEFIT-AMT.
 15142     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 15143     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15144     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15145     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15146     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15147     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15148     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15149     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15150     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15151                                    CP-REMAINING-TERM
 15152                                    CP-LOAN-TERM.
 15153     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15154        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15155           PB-I-LF-PREMIUM-AMT
 15156     end-if
 15157
 15158     IF CP-TRUNCATED-LIFE
 15159        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15160
 15161     IF CP-TERM-IS-DAYS
 15162         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15163     ELSE
 15164         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15165
 15166     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15167     IF CP-SPECIAL-CALC-CD = 'H'
 15168         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15169                                    TO CP-ALTERNATE-BENEFIT
 15170         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15171     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15172     MOVE 'R'                    TO CP-RATE-FILE
 15173     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15174     IF NOT CP-ERROR-RATE-NOT-FOUND
 15175        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15176        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15177           AND (CP-BENEFIT-CD (1:1) = 'S')
 15178           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15179                                    PB-I-LF-PREMIUM-AMT
 15180        END-IF
 15181     ELSE
 15182        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15183     END-IF
 15184     .
 15185 3340-EDIT-LF-AH-TOL.
 15186
 15187***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15188***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15189***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15190***
 15191     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15192         PB-I-AH-PREMIUM-AMT
 15193          GIVING WS-CALC-WORK.
 15194
 15195     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15196        AND WS-CALC-WORK NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 276
* EL050.cbl
 15197         MOVE ER-2649            TO WS-ERROR
 15198         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15199
 15200     SUBTRACT PB-I-LF-PREM-CALC
 15201             FROM PB-I-LF-PREMIUM-AMT
 15202                 GIVING WS-UNSIGN-WRK1.
 15203
 15204     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15205             FROM PB-I-LF-ALT-PREMIUM-AMT
 15206                 GIVING WS-UNSIGN-WRK4.
 15207
 15208     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15209                                + WS-UNSIGN-WRK4.
 15210
 15211     SUBTRACT PB-I-AH-PREM-CALC
 15212             FROM PB-I-AH-PREMIUM-AMT
 15213                 GIVING WS-UNSIGN-WRK2.
 15214
 15215******************************************************************
 15216*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15217******************************************************************
 15218
 15219     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15220         MOVE ZERO TO WS-UNSIGN-WRK1.
 15221
 15222     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15223         MOVE ZERO TO WS-UNSIGN-WRK2.
 15224
 15225     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15226             GIVING WS-UNSIGN-WRK3.
 15227
 15228 3342-CONTINUE.
 15229
 15230     IF (PB-I-LF-RATE = ZERO  AND
 15231         PB-I-AH-RATE = ZERO)
 15232         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15233            WS-AH-SPECIAL-CALC-CD = 'O'
 15234              NEXT SENTENCE
 15235         ELSE
 15236             GO TO 3345-EDIT-CONTINUE.
 15237
 15238     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15239         NEXT SENTENCE
 15240     ELSE
 15241     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15242        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15243           IF (PB-REISSUED-CERT         OR
 15244               PB-POLICY-IS-DECLINED    OR
 15245               PB-POLICY-IS-VOIDED)
 15246              NEXT SENTENCE
 15247           ELSE
 15248              IF WS-PREM-REJECT-SW = SPACE
 15249                 MOVE ER-2652    TO WS-ERROR
 15250                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15251                 GO TO 3344-CHECK-AH
 15252              ELSE
 15253                 MOVE ER-2650    TO WS-ERROR
 15254                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 277
* EL050.cbl
 15255                 GO TO 3344-CHECK-AH.
 15256
 15257***
 15258***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 15259***
 15260
 15261     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15262         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15263            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15264             (1 + WS-TOL-LF-PREM-PCT)
 15265         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15266            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15267             (1 - WS-TOL-LF-PREM-PCT)
 15268     ELSE
 15269         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15270         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15271
 15272***
 15273***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15274***
 15275
 15276     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15277         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15278          WS-TOL-LF-PREM.
 15279
 15280     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15281         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15282          WS-TOL-LF-PREM.
 15283
 15284     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15285        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15286
 15287     IF PB-REISSUED-CERT
 15288        or PB-POLICY-IS-DECLINED
 15289        or PB-POLICY-IS-VOIDED
 15290        continue
 15291     ELSE
 15292        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15293              > WS-TOL-LF-HIGH-PREM-AMT)
 15294           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15295              < WS-TOL-LF-LOW-PREM-AMT))
 15296                      or
 15297           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15298              > WS-TOL-LF-HIGH-PREM-PCT)
 15299           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15300              < WS-TOL-LF-LOW-PREM-PCT))
 15301           IF WS-PREM-REJECT-SW = SPACE
 15302              MOVE ER-2652       TO WS-ERROR
 15303              PERFORM 9900-ERROR-FORMAT
 15304                                 THRU 9900-EXIT
 15305           ELSE
 15306              MOVE ER-2650       TO WS-ERROR
 15307              PERFORM 9900-ERROR-FORMAT
 15308                                 THRU 9900-EXIT
 15309           end-if
 15310        end-if
 15311     end-if
 15312
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 278
* EL050.cbl
 15313*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15314*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15315*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15316*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15317
 15318     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15319        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15320                      OR
 15321           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15322           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15323           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15324           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15325        END-IF
 15326     END-IF
 15327
 15328     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15329        IF WS-COMP-MAX-CAP GREATER THAN +0
 15330           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15331              IF (PB-REISSUED-CERT         OR
 15332                  PB-POLICY-IS-DECLINED    OR
 15333                  PB-POLICY-IS-VOIDED)
 15334                 NEXT SENTENCE
 15335              ELSE
 15336                  MOVE ER-2646   TO  WS-ERROR
 15337                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15338
 15339 3344-CVL-TOLERANCE-CHECK.
 15340
 15341      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15342          GO TO 3344-CHECK-AH.
 15343
 15344      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15345          GO TO 3344-CHECK-AH.
 15346
 15347      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15348                                     WS-UNSIGN-WRK6.
 15349
 15350      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15351          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15352                                 + PB-I-LF-PREMIUM-AMT
 15353                                 - PB-I-LF-PREM-CALC.
 15354
 15355      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15356          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15357                                 + PB-I-LF-ALT-PREMIUM-AMT
 15358                                 - PB-I-LF-ALT-PREM-CALC.
 15359
 15360      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15361          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15362              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15363                 MOVE ER-2652    TO  WS-ERROR
 15364                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15365              ELSE
 15366                 MOVE ER-2650    TO  WS-ERROR
 15367                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15368
 15369      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15370          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 279
* EL050.cbl
 15371              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15372                 MOVE ER-2652    TO  WS-ERROR
 15373                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15374              ELSE
 15375                 MOVE ER-2650    TO  WS-ERROR
 15376                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15377
 15378 3344-CHECK-AH.
 15379
 15380****************************************************************
 15381***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15382***
 15383
 15384     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15385         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15386             (1 + WS-TOL-AH-PREM-PCT)
 15387         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15388             (1 - WS-TOL-AH-PREM-PCT)
 15389     ELSE
 15390         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15391         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15392
 15393***
 15394***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15395***
 15396
 15397     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15398         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15399
 15400     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15401         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15402
 15403     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15404        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15405
 15406     IF (PB-REISSUED-CERT)
 15407        OR (PB-POLICY-IS-DECLINED)
 15408        OR (PB-POLICY-IS-VOIDED)
 15409        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15410        CONTINUE
 15411     ELSE
 15412        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15413              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15414                          or
 15415           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15416              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15417           IF WS-PREM-REJECT-SW = SPACE
 15418              MOVE ER-3052       TO WS-ERROR
 15419              PERFORM 9900-ERROR-FORMAT
 15420                                 THRU 9900-EXIT
 15421           ELSE
 15422              MOVE ER-3050       TO WS-ERROR
 15423              PERFORM 9900-ERROR-FORMAT
 15424                                 THRU 9900-EXIT
 15425           END-IF
 15426        END-IF
 15427     END-IF
 15428     if (pb-company-id = 'DCC' or 'VPP')
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 280
* EL050.cbl
 15429        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15430        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15431        and (pb-i-policy-is-monthly)
 15432        compute ws-tol-ah-high-prem-amt =
 15433           pb-i-tot-fees-calc + ws-tol-ah-prem
 15434        compute ws-tol-ah-low-prem-amt =
 15435           pb-i-tot-fees-calc - ws-tol-ah-prem
 15436        if ws-tol-ah-prem-pct > zeros
 15437           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15438              (1 + ws-tol-ah-prem-pct)
 15439           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15440              (1 - ws-tol-ah-prem-pct)
 15441        else
 15442           move +9999999.99      to ws-tol-ah-high-prem-pct
 15443           move +0               to ws-tol-ah-low-prem-pct
 15444        end-if
 15445        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15446            or
 15447           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15448                          or
 15449           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15450           or
 15451           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15452            move er-3049         to ws-error
 15453           perform 9900-error-format
 15454                                 thru 9900-exit
 15455
 15456        end-if
 15457     end-if
 15458     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15459         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15460             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15461             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15462
 15463     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15464        IF WS-COMP-MAX-CAP GREATER THAN +0
 15465           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15466              IF (PB-REISSUED-CERT         OR
 15467                  PB-POLICY-IS-DECLINED    OR
 15468                  PB-POLICY-IS-VOIDED)
 15469                 NEXT SENTENCE
 15470              ELSE
 15471                  MOVE ER-2646   TO  WS-ERROR
 15472                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15473
 15474     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15475        (WS-COMP-MAX-CAP EQUAL +0)
 15476           GO TO 3345-EDIT-CONTINUE.
 15477
 15478     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15479        GREATER THAN WS-COMP-MAX-CAP
 15480           MOVE ER-2646          TO  WS-ERROR
 15481           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15482
 15483 3345-EDIT-CONTINUE.
 15484
 15485*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15486*       IF PB-ENTRY-BATCH   NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 281
* EL050.cbl
 15487*          IF PB-ISSUE
 15488*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15489*          ELSE
 15490*              IF PB-CANCELLATION
 15491*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15492
 15493*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15494*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15495*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15496*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15497*        ELSE
 15498*            MOVE  ER-1909            TO  WS-ERROR
 15499*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15500
 15501     IF PB-I-POLICY-ACCEPTED
 15502        IF PB-POLICY-IS-DECLINED  OR
 15503           PB-REISSUED-CERT  OR
 15504           PB-REIN-ONLY-CERT  OR
 15505           PB-POLICY-IS-VOIDED
 15506            MOVE  ER-1891         TO  WS-ERROR
 15507            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15508        ELSE
 15509            MOVE SPACE            TO  PB-BATCH-ENTRY
 15510            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15511
 15512     IF PB-I-POLICY-DECLINED
 15513        IF PB-REISSUED-CERT  OR
 15514           PB-REIN-ONLY-CERT  OR
 15515           PB-POLICY-IS-VOIDED
 15516            MOVE  ER-1906         TO  WS-ERROR
 15517            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15518        ELSE
 15519            MOVE  'D'             TO  PB-BATCH-ENTRY
 15520                                      PB-I-ENTRY-STATUS.
 15521
 15522     IF PB-I-NEEDS-UNDERWRITING
 15523        IF PB-POLICY-IS-DECLINED OR
 15524           PB-REISSUED-CERT  OR
 15525           PB-REIN-ONLY-CERT  OR
 15526           PB-POLICY-IS-VOIDED
 15527            MOVE  ER-1907         TO  WS-ERROR
 15528            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15529        ELSE
 15530            MOVE 'U'              TO  PB-BATCH-ENTRY
 15531                                      PB-I-ENTRY-STATUS.
 15532
 15533     IF PB-NEEDS-UNDERWRITING
 15534        MOVE  ER-1901             TO  WS-ERROR
 15535        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15536     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15537        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15538        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15539        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15540           AND (NOT WS-LF-CASH))
 15541                           OR
 15542           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15543           AND (NOT WS-AH-CASH)))
 15544                       AND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 282
* EL050.cbl
 15545           (PB-I-ENTRY-STATUS NOT = '5')
 15546           MOVE 'M'              TO PB-BATCH-ENTRY
 15547                                    PB-I-ENTRY-STATUS
 15548        END-IF
 15549     END-IF
 15550     move pending-business       to ws-passed-erpndb
 15551     move ' '                    to ws-exceed-limit-yn
 15552     perform 7780-call-agg       thru 7780-exit
 15553*    display ' el050 exceed ' ws-exceed-limit-yn
 15554     if ws-exceed-limit-yn = 'Y'
 15555        MOVE  ER-9813            TO WS-ERROR
 15556        move 'Y'                 to ws-9813-sw
 15557        PERFORM  9900-ERROR-FORMAT
 15558                                 THRU 9900-EXIT
 15559     end-if
 15560     if (PB-EXCEEDED-LIMIT-FORCED)
 15561        and (ws-9813-sw = 'Y')
 15562        subtract +1 from PB-NO-OF-ERRORS
 15563        move er-9823             to ws-error
 15564        PERFORM  9900-ERROR-FORMAT
 15565                                 THRU 9900-EXIT
 15566     end-if
 15567     IF  PB-COMPANY-ID NOT = 'NCL'
 15568         GO TO 3999-END-EDIT.
 15569
 15570     IF PB-REISSUED-CERT  OR
 15571        PB-POLICY-IS-DECLINED  OR
 15572        PB-POLICY-IS-VOIDED  OR
 15573        PB-I-OB
 15574         GO TO 3999-END-EDIT.
 15575
 15576     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15577         MOVE  ER-2644            TO  WS-ERROR
 15578         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15579         GO TO 3999-END-EDIT.
 15580
 15581     MOVE 'N'                     TO  FORM-MASTER-SW.
 15582     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15583
 15584     IF NOT FORM-MASTER-FOUND
 15585         GO TO 3999-END-EDIT.
 15586
 15587     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15588                                      FORM-MASTER-AH-SW.
 15589
 15590     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15591         MOVE  +1                 TO SUB6
 15592         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15593
 15594     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15595         MOVE  +1                 TO SUB6
 15596         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15597
 15598     IF LF-FORM-MASTER-FOUND  OR
 15599        AH-FORM-MASTER-FOUND
 15600         GO TO 3360-CHECK-FORM-LIMITS
 15601     ELSE
 15602         GO TO 3999-END-EDIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 283
* EL050.cbl
 15603
 15604******************************************************************
 15605*                  3350-GET-ERFORM                               *
 15606*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15607*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15608******************************************************************
 15609
 15610 3350-GET-ERFORM.
 15611
 15612     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15613         GO TO  3350-ERFORM-GETMAIN.
 15614
 15615     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15616     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15617     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15618     MOVE 'Y'                     TO FORM-MASTER-SW.
 15619
 15620     IF PB-CANCELLATION
 15621         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15622            PB-SV-STATE          EQUAL   FO-STATE       AND
 15623            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15624              GO TO 3350-EXIT
 15625         ELSE
 15626             NEXT SENTENCE
 15627     ELSE
 15628         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15629            PB-SV-STATE          EQUAL   FO-STATE       AND
 15630            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15631              GO TO 3350-EXIT.
 15632
 15633 3350-ERFORM-GETMAIN.
 15634
 15635     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15636     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15637
 15638 3350-ERFORM-READ.
 15639
 15640     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15641     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15642     IF PB-CANCELLATION
 15643         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15644     ELSE
 15645         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15646     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15647
 15648     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15649
 15650     IF FORM-MASTER-FOUND
 15651       IF PB-CANCELLATION
 15652          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15653             PB-SV-STATE          EQUAL   FO-STATE       AND
 15654             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15655              GO  TO 3350-EXIT
 15656          ELSE
 15657              NEXT SENTENCE
 15658       ELSE
 15659          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15660             PB-SV-STATE          EQUAL   FO-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 284
* EL050.cbl
 15661             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15662              GO  TO 3350-EXIT.
 15663
 15664     MOVE  'N'                    TO  FORM-MASTER-SW.
 15665     MOVE  ER-1895                TO  WS-ERROR.
 15666     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15667
 15668 3350-EXIT.
 15669      EXIT.
 15670
 15671******************************************************************
 15672*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15673*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15674*   VALID FOR THE POLICY FORM USED.                              *
 15675******************************************************************
 15676
 15677 3355-EDIT-FORM-LF-BENEFITS.
 15678
 15679     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15680        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15681         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15682         GO TO   3355-EXIT.
 15683
 15684     IF  SUB6    LESS THAN   +40
 15685         ADD  +1      TO  SUB6
 15686         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15687
 15688     MOVE  ER-1896         TO  WS-ERROR.
 15689     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15690
 15691 3355-EXIT.
 15692      EXIT.
 15693
 15694******************************************************************
 15695*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15696*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15697*   VALID FOR THE POLICY FORM USED.                              *
 15698******************************************************************
 15699
 15700 3356-EDIT-FORM-AH-BENEFITS.
 15701
 15702     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15703        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15704         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15705         GO TO  3356-EXIT.
 15706
 15707      IF  SUB6    LESS THAN     +40
 15708          ADD  +1      TO  SUB6
 15709          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15710
 15711     MOVE  ER-1897         TO  WS-ERROR.
 15712     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15713
 15714 3356-EXIT.
 15715      EXIT.
 15716
 15717******************************************************************
 15718*                  3357-BENEFIT-SEARCH                           *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 285
* EL050.cbl
 15719*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15720*   CANCELLATIONS ONLY.                                          *
 15721******************************************************************
 15722 3357-BENEFIT-SEARCH.
 15723     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15724         MOVE +1                          TO SUB6
 15725         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15726
 15727     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15728         MOVE +1                          TO SUB6
 15729         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15730
 15731 3357-EXIT.
 15732     EXIT.
 15733
 15734******************************************************************
 15735*                  3358-BENEFIT-LIFE-SEARCH                      *
 15736*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15737*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15738*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15739******************************************************************
 15740 3358-BENEFIT-LIFE-SEARCH.
 15741     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15742       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15743         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15744           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15745              IF FO-PLAN-REFUND-METHOD (SUB6)
 15746                     IS GREATER THAN SPACES
 15747                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15748                                          WS-LF-REFUND-CALC
 15749                 GO TO 3358-EXIT.
 15750
 15751     IF SUB6 LESS THAN +40
 15752         ADD +1                 TO SUB6
 15753         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15754
 15755 3358-EXIT.
 15756     EXIT.
 15757******************************************************************
 15758*                  3359-BENEFIT-AH-SEARCH                        *
 15759*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15760*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15761*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15762******************************************************************
 15763 3359-BENEFIT-AH-SEARCH.
 15764     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15765       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15766         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15767           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15768              IF FO-PLAN-REFUND-METHOD (SUB6)
 15769                      IS GREATER THAN SPACES
 15770                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15771                                          WS-AH-REFUND-CALC
 15772                 GO TO 3359-EXIT.
 15773
 15774     IF SUB6 LESS THAN +40
 15775         ADD +1                 TO SUB6
 15776         GO TO 3359-BENEFIT-AH-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 286
* EL050.cbl
 15777
 15778 3359-EXIT.
 15779     EXIT.
 15780
 15781******************************************************************
 15782*                  3360-CHECK-FORM-LIMITS                        *
 15783*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15784*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15785******************************************************************
 15786
 15787 3360-CHECK-FORM-LIMITS.
 15788
 15789     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15790         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15791
 15792     IF NOT LF-FORM-MASTER-FOUND
 15793         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15794
 15795 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15796
 15797     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15798       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15799        WS-LF-JOINT-INDICATOR = 'J'  AND
 15800        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15801         IF PB-COMPANY-ID = 'NCL'
 15802            MOVE  ER-1911          TO  WS-ERROR
 15803            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15804         ELSE
 15805            MOVE  ER-1892          TO  WS-ERROR
 15806            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15807
 15808 3360-CHECK-FORM-LF-ATT-AGE.
 15809
 15810     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15811
 15812     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15813         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15814         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15815            IF PB-COMPANY-ID = 'NCL'
 15816                MOVE  ER-1913      TO  WS-ERROR
 15817                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15818            ELSE
 15819                MOVE  ER-1894      TO  WS-ERROR
 15820                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15821
 15822 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15823
 15824     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15825         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15826         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15827            IF PB-COMPANY-ID = 'NCL'
 15828                MOVE  ER-1914      TO  WS-ERROR
 15829                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15830            ELSE
 15831                MOVE  ER-1899      TO  WS-ERROR
 15832                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15833
 15834 3360-CHECK-FORM-LF-TERM-BAMT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 287
* EL050.cbl
 15835
 15836     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15837         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15838         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15839           IF  PB-COMPANY-ID = 'NCL'
 15840               MOVE  ER-1916       TO  WS-ERROR
 15841               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15842           ELSE
 15843               MOVE  ER-1902       TO  WS-ERROR
 15844               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15845
 15846     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15847                                    PB-I-LF-ALT-BENEFIT-AMT.
 15848
 15849     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15850         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15851         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15852             IF  PB-COMPANY-ID = 'NCL'
 15853                 MOVE  ER-1918     TO  WS-ERROR
 15854                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15855             ELSE
 15856                 MOVE  ER-1904     TO  WS-ERROR
 15857                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15858
 15859******************************************************************
 15860*                  3360-CHECK-FORM-AH-LIMITS                     *
 15861*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15862*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15863******************************************************************
 15864
 15865 3360-CHECK-FORM-AH-LIMITS.
 15866
 15867     IF NOT AH-FORM-MASTER-FOUND
 15868         GO TO 3999-END-EDIT.
 15869
 15870 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15871
 15872     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15873       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15874        WS-AH-JOINT-INDICATOR = 'J'  AND
 15875        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15876         IF PB-COMPANY-ID = 'NCL'
 15877            MOVE  ER-1912          TO  WS-ERROR
 15878            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15879         ELSE
 15880            MOVE  ER-1893          TO  WS-ERROR
 15881            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15882
 15883 3360-CHECK-FORM-AH-ATT-AGE.
 15884
 15885     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15886
 15887     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15888         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15889         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15890            IF PB-COMPANY-ID = 'NCL'
 15891                MOVE  ER-1913      TO  WS-ERROR
 15892                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 288
* EL050.cbl
 15893            ELSE
 15894                MOVE  ER-1894      TO  WS-ERROR
 15895                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15896
 15897 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15898
 15899     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15900         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15901         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15902            IF PB-COMPANY-ID = 'NCL'
 15903                MOVE  ER-1915      TO  WS-ERROR
 15904                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15905            ELSE
 15906                MOVE  ER-1900      TO  WS-ERROR
 15907                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15908
 15909 3360-CHECK-FORM-AH-TERM-BAMT.
 15910
 15911     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15912         FO-AH-MAX-TERM    GREATER THAN  +0
 15913         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15914             IF  PB-COMPANY-ID = 'NCL'
 15915                 MOVE  ER-1917     TO  WS-ERROR
 15916                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15917             ELSE
 15918                  MOVE  ER-1903    TO  WS-ERROR
 15919                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15920
 15921     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15922         FO-MAX-AH-AMT    GREATER THAN  +0
 15923         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15924             IF  PB-COMPANY-ID = 'NCL'
 15925                 MOVE  ER-1919     TO  WS-ERROR
 15926                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15927             ELSE
 15928                 MOVE  ER-1905     TO  WS-ERROR
 15929                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15930
 15931     GO TO 3999-END-EDIT.
 15932
 15933******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 289
* EL050.cbl
 15935 3400-edit-vin.
 15936
 15937     move spaces                 to hldi-pass-area
 15938     MOVE PB-I-VIN               TO WS-WORK-VIN
 15939     MOVE +8                     TO V2
 15940     MOVE ZEROS                  TO WS-VIN-TOTAL
 15941     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15942      (V1 > 17)
 15943        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15944           MOVE ER-3825          TO WS-ERROR
 15945           PERFORM 9900-ERROR-FORMAT
 15946                                 THRU 9900-EXIT
 15947        ELSE
 15948           IF V1 = 8
 15949              MOVE 10            TO V2
 15950           END-IF
 15951           IF V1 = 9
 15952              MOVE 0             TO V2
 15953           END-IF
 15954           IF V1 = 10
 15955              MOVE 9             TO V2
 15956           END-IF
 15957           IF WS-WORK-VIN (V1:1) NUMERIC
 15958              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15959               + (WS-WORK-VIN-N (V1) * V2)
 15960           ELSE
 15961              MOVE WS-WORK-VIN (V1:1)
 15962                            TO WS-HEX-BYTE
 15963              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15964              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15965               + (WS-NUM (V3) * V2)
 15966           END-IF
 15967           COMPUTE V2 = V2 - 1
 15968        END-IF
 15969     END-PERFORM
 15970     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15971     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15972        REMAINDER WS-VIN-REMAINDER
 15973     IF ((WS-WORK-VIN (9:1) = 'X')
 15974        AND (WS-VIN-REMAINDER = 10))
 15975                OR
 15976        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15977        if pb-company-id = 'VPP'
 15978           perform 3410-check-with-hldi
 15979                                 thru 3410-exit
 15980        end-if
 15981     ELSE
 15982        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15983           MOVE ER-3826          TO WS-ERROR
 15984           PERFORM 9900-ERROR-FORMAT
 15985                                 THRU 9900-EXIT
 15986        ELSE
 15987           MOVE ER-3827          TO WS-ERROR
 15988           PERFORM 9900-ERROR-FORMAT
 15989                                 THRU 9900-EXIT
 15990        END-IF
 15991     END-IF
 15992
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 290
* EL050.cbl
 15993     .
 15994 3400-exit.
 15995     exit.
 15996 3410-check-with-hldi.
 15997     move spaces                 to hldi-pass-area
 15998     move pb-i-vin               to pa-vin
 15999     perform 7785-call-hldi      thru 7785-exit
 16000*    display 'PA-VIN        ' PA-VIN
 16001*    display 'PA-ErrorCode  ' PA-ErrorCode
 16002*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 16003*    display 'PA-ModelYear  ' PA-ModelYear
 16004*    display 'PA-MakeName   ' PA-MakeName
 16005*    display 'PA-ModelName  ' PA-ModelName
 16006*    display 'PA-SeriesName ' PA-SeriesName
 16007     if pa-errorcode (1:1) not = '0'
 16008        move spaces              to hldi-pass-area
 16009        move pb-i-vin            to pa-vin
 16010*       move pa-errordesc        to pa-seriesname
 16011*       perform 7786-call-hldim  thru 7786-exit
 16012*       display 'PA-VIN        ' PA-VIN
 16013*       display 'PA-ErrorCode  ' PA-ErrorCode
 16014*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 16015*       display 'PA-ModelYear  ' PA-ModelYear
 16016*       display 'PA-MakeName   ' PA-MakeName
 16017*       display 'PA-ModelName  ' PA-ModelName
 16018*       display 'PA-SeriesName ' PA-SeriesName
 16019     end-if
 16020     .
 16021 3410-exit.
 16022     exit.
 16023******************************************************************
 16024*                  E D I T   C A N C E L                         *
 16025******************************************************************
 16026
 16027 3700-EDIT-CANCEL.
 16028     IF PB-COMPANY-ID = 'DMD'
 16029         MOVE ZEROS                   TO WS-RES-STATE-TAX
 16030                                         WS-RES-MUNI-TAX
 16031                                         PB-CI-STATE-TAX
 16032                                         PB-CI-MUNI-TAX
 16033         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 16034
 16035*    IF PB-COMPANY-ID  EQUAL  'NCL'
 16036*       IF PB-ENTRY-BATCH  NUMERIC
 16037*          IF PB-CANCELLATION
 16038*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16039*          ELSE
 16040*             IF PB-ISSUE
 16041*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16042
 16043     IF PB-C-INT-ON-REFS NOT NUMERIC
 16044        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16045     END-IF
 16046*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16047*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16048
 16049     IF CM-ENTRY-STATUS = 'V'
 16050        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 291
* EL050.cbl
 16051        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16052        GO TO 3999-END-EDIT.
 16053
 16054     IF CM-ENTRY-STATUS = 'D'
 16055        MOVE ER-2781             TO WS-ERROR
 16056        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16057        GO TO 3999-END-EDIT.
 16058
 16059     IF CM-ENTRY-STATUS = 'U'
 16060        MOVE ER-2782             TO WS-ERROR
 16061        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16062
 16063***************************************************************
 16064*                                                             *
 16065*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16066*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16067*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16068*   OF ANOTHER COVERAGE.                                      *
 16069*                                                             *
 16070***************************************************************
 16071
 16072     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16073                                    PB-C-AH-CANCEL-VOID-SW.
 16074
 16075     if pb-company-id = 'DCC' or 'VPP'
 16076        if ((pb-ci-lf-cancel-amt <> zeros)
 16077                       or
 16078            (pb-ci-ah-cancel-amt <> zeros))
 16079           MOVE ER-3068          TO WS-ERROR
 16080           PERFORM 9900-ERROR-FORMAT
 16081                                 THRU 9900-EXIT
 16082           GO TO 3999-END-EDIT
 16083        end-if
 16084     end-if
 16085     IF PB-C-LF-CANCEL-AMT = ZERO
 16086        NEXT SENTENCE
 16087     ELSE
 16088        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16089           AND
 16090           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16091               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16092               MOVE ER-2745           TO WS-ERROR
 16093               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16094
 16095     IF PB-C-AH-CANCEL-AMT = ZERO
 16096        NEXT SENTENCE
 16097     ELSE
 16098        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16099           AND
 16100           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16101               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16102               MOVE ER-2745           TO WS-ERROR
 16103               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16104
 16105     IF WS-LF-EARNINGS-CALC = '4'
 16106        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16107
 16108     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 292
* EL050.cbl
 16109     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16110     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16111     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16112     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16113     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16114
 16115     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16116                                      PB-C-AH-REF-CALC.
 16117     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16118
 16119******************************************************************
 16120*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16121*             TO VALIDATE COVERAGE.                              *
 16122******************************************************************
 16123
 16124     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16125        PB-C-LF-CANCEL-AMT = ZEROS
 16126          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16127      ELSE
 16128          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16129
 16130     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16131        PB-C-AH-CANCEL-AMT = ZEROS
 16132          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16133      ELSE
 16134          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16135
 16136     EVALUATE TRUE
 16137         WHEN PB-CANCEL-FORCE             OR
 16138              PB-CANCEL-DATE-FORCED       OR
 16139              PB-FORCE-OFF
 16140                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16141                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16142                  END-IF
 16143         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16144               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16145              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16146                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16147         WHEN OTHER
 16148              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16149                 MOVE ER-2794              TO WS-ERROR
 16150              ELSE
 16151                 MOVE ER-2749              TO WS-ERROR
 16152              END-IF
 16153              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16154     END-EVALUATE.
 16155
 16156
 16157*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16158*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16159*            MOVE  ER-1909            TO  WS-ERROR
 16160*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16161*        ELSE
 16162*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16163
 16164     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16165     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16166        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 293
* EL050.cbl
 16167     ELSE
 16168        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16169     END-IF
 16170     .
 16171 3705-EDIT-CANCEL-DT.
 16172
 16173     IF LF-COVERAGE-CANCELLED
 16174        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16175         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16176         MOVE WS-CURRENT-MONTH-END
 16177                                 TO DC-BIN-DATE-2
 16178         SET ELAPSED-BETWEEN-BIN TO TRUE
 16179*        MOVE 1                  TO DC-OPTION-CODE
 16180         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16181         IF DATE-CONVERSION-ERROR
 16182            NEXT SENTENCE
 16183          ELSE
 16184             IF DC-ELAPSED-DAYS GREATER +180
 16185                IF PB-CANCEL-DATE-FORCED  OR
 16186                   PB-CANCEL-DATE-FORCED-NO-FEE
 16187                      MOVE ER-2751  TO WS-ERROR
 16188                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16189                 ELSE
 16190                   MOVE ER-2752  TO WS-ERROR
 16191                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16192
 16193     IF AH-COVERAGE-CANCELLED
 16194        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16195         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16196         MOVE WS-CURRENT-MONTH-END
 16197                                 TO DC-BIN-DATE-2
 16198         SET ELAPSED-BETWEEN-BIN TO TRUE
 16199*        MOVE 1                  TO DC-OPTION-CODE
 16200         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16201         IF DATE-CONVERSION-ERROR
 16202            NEXT SENTENCE
 16203          ELSE
 16204             IF DC-ELAPSED-DAYS GREATER +180
 16205                IF PB-CANCEL-DATE-FORCED OR
 16206                   PB-CANCEL-DATE-FORCED-NO-FEE
 16207                      MOVE ER-2751  TO WS-ERROR
 16208                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16209                 ELSE
 16210                   MOVE ER-2752  TO WS-ERROR
 16211                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16212
 16213     IF WS-ERROR = ER-2752
 16214        AND (PB-COMPANY-ID = 'ABL'
 16215         OR  PB-COMPANY-ID = 'FGL'
 16216         OR  PB-COMPANY-ID = 'IST'
 16217         OR  PB-COMPANY-ID = 'JHL'
 16218         OR  PB-COMPANY-ID = 'LAP'
 16219         OR  PB-COMPANY-ID = 'LBL'
 16220         OR  PB-COMPANY-ID = 'NCB'
 16221         OR  PB-COMPANY-ID = 'NLI'
 16222         OR  PB-COMPANY-ID = 'OFI'
 16223         OR  PB-COMPANY-ID = 'PLI'
 16224         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 294
* EL050.cbl
 16225         OR  PB-COMPANY-ID = 'TIC'
 16226         OR  PB-COMPANY-ID = 'HER'
 16227         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16228         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16229            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16230            MOVE ER-2762     TO WS-ERROR
 16231            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16232
 16233     IF LF-COVERAGE-CANCELLED
 16234        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16235        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16236             MOVE ER-2733         TO WS-ERROR
 16237             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16238
 16239     IF AH-COVERAGE-CANCELLED
 16240        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16241        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16242              MOVE ER-2733        TO WS-ERROR
 16243              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16244
 16245     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16246        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16247        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16248           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16249            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16250              IF PB-COMPANY-ID NOT = 'LAP'
 16251               MOVE ER-2704            TO WS-ERROR
 16252               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16253
 16254     IF CERT-WAS-NOT-FOUND
 16255         GO TO 3999-END-EDIT.
 16256
 16257     IF PB-COMPANY-ID EQUAL 'CDC'
 16258        IF LF-COVERAGE-CANCELLED
 16259           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16260            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16261            MOVE PB-C-LF-CANCEL-DT
 16262                                 TO DC-BIN-DATE-2
 16263            SET ELAPSED-BETWEEN-BIN TO TRUE
 16264*           MOVE 1               TO DC-OPTION-CODE
 16265            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16266            IF DATE-CONVERSION-ERROR
 16267               NEXT SENTENCE
 16268             ELSE
 16269                IF DC-ELAPSED-DAYS GREATER +60
 16270                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16271
 16272     IF PB-COMPANY-ID EQUAL 'CDC'
 16273        IF AH-COVERAGE-CANCELLED
 16274           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16275            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16276            MOVE PB-C-AH-CANCEL-DT
 16277                                 TO DC-BIN-DATE-2
 16278            MOVE +0              TO DC-ELAPSED-DAYS
 16279                                    DC-ELAPSED-MONTHS
 16280            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16281*           MOVE 1               TO DC-OPTION-CODE
 16282            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 295
* EL050.cbl
 16283            IF DATE-CONVERSION-ERROR
 16284               NEXT SENTENCE
 16285             ELSE
 16286                IF DC-ELAPSED-DAYS GREATER +60
 16287                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16288
 16289     MOVE +0                     TO DC-ELAPSED-DAYS
 16290                                    DC-ELAPSED-MONTHS.
 16291
 16292     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16293        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16294          MOVE 'Z'                TO PB-CI-OB-FLAG
 16295          MOVE ER-2767            TO WS-ERROR
 16296          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16297          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16298          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16299          GO TO 3775-OVER-REF-CHK
 16300        ELSE
 16301          MOVE ZEROS              TO PB-CI-LIVES
 16302                                     PB-C-LIVES
 16303          IF PB-CI-OB-FLAG NOT = 'B'
 16304             MOVE SPACE           TO PB-CI-OB-FLAG.
 16305
 16306     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16307         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16308     ELSE
 16309         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16310
 16311     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16312        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16313            MOVE ER-2760         TO WS-ERROR
 16314            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16315
 16316     IF LF-COVERAGE-CANCELLED
 16317        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16318         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16319            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16320               MOVE ER-2774       TO WS-ERROR
 16321               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16322
 16323     IF AH-COVERAGE-CANCELLED
 16324        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16325         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16326            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16327               MOVE ER-2775       TO WS-ERROR
 16328               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16329
 16330     IF LF-COVERAGE-CANCELLED
 16331        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16332         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16333            MOVE ER-2776         TO WS-ERROR
 16334            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16335
 16336     IF AH-COVERAGE-CANCELLED
 16337        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16338         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16339            MOVE ER-2777         TO WS-ERROR
 16340            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 296
* EL050.cbl
 16341
 16342     IF LF-COVERAGE-CANCELLED
 16343        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16344        if pb-ci-lf-expire-dt = low-values or spaces
 16345           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16346           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16347           MOVE PB-CI-EXTENTION-DAYS
 16348                                 TO DC-ELAPSED-DAYS
 16349           SET BIN-PLUS-ELAPSED  TO TRUE
 16350           PERFORM 8500-DATE-CONVERT
 16351                                 THRU 8500-EXIT
 16352           IF DATE-CONVERSION-ERROR
 16353              move low-values    to dc-bin-date-2
 16354           end-if
 16355        else
 16356           move pb-ci-lf-expire-dt
 16357                                 to dc-bin-date-2
 16358        end-if
 16359        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16360           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16361                             OR  'FIA'
 16362              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16363           ELSE
 16364              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16365              MOVE ER-2731       TO WS-ERROR
 16366              PERFORM 9900-ERROR-FORMAT
 16367                                 THRU 9900-EXIT
 16368           end-if
 16369        end-if
 16370     end-if
 16371*    IF LF-COVERAGE-CANCELLED
 16372*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16373*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16374*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16375*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16376*        SET BIN-PLUS-ELAPSED      TO TRUE
 16377*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16378*        IF DATE-CONVERSION-ERROR
 16379*           NEXT SENTENCE
 16380*         ELSE
 16381*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16382*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16383*                            OR  'FIA'
 16384*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16385*              ELSE
 16386*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16387*               MOVE ER-2731       TO WS-ERROR
 16388*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16389     .
 16390 3705-EDIT-AH-CANCEL-DT.
 16391     IF AH-COVERAGE-CANCELLED
 16392        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16393        if pb-ci-AH-expire-dt = low-values or spaces
 16394           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16395           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16396           MOVE PB-CI-EXTENTION-DAYS
 16397                                 TO DC-ELAPSED-DAYS
 16398           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 297
* EL050.cbl
 16399           PERFORM 8500-DATE-CONVERT
 16400                                 THRU 8500-EXIT
 16401           IF DATE-CONVERSION-ERROR
 16402              move low-values    to dc-bin-date-2
 16403           end-if
 16404        else
 16405           move pb-ci-ah-expire-dt
 16406                                 to dc-bin-date-2
 16407        end-if
 16408        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16409           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16410                             OR  'FIA'
 16411              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16412           ELSE
 16413              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16414              MOVE ER-2771       TO WS-ERROR
 16415              PERFORM 9900-ERROR-FORMAT
 16416                                 THRU 9900-EXIT
 16417           end-if
 16418        end-if
 16419     end-if
 16420*    IF AH-COVERAGE-CANCELLED
 16421*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16422*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16423*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16424*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16425**       MOVE 6                    TO DC-OPTION-CODE
 16426*        SET BIN-PLUS-ELAPSED      TO TRUE
 16427*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16428*        IF DATE-CONVERSION-ERROR
 16429*           NEXT SENTENCE
 16430*         ELSE
 16431*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16432*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16433*                             OR 'FIA'
 16434*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16435*             ELSE
 16436*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16437*              MOVE ER-2771       TO WS-ERROR
 16438*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16439     .
 16440 3705-EDIT-CONTINUED.
 16441
 16442*    IF LF-COVERAGE-CANCELLED
 16443*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16444*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16445*            MOVE ER-2727         TO WS-ERROR
 16446*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16447*
 16448*    IF AH-COVERAGE-CANCELLED
 16449*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16450*        IF PB-COMPANY-ID = 'ACE'
 16451*           MOVE ER-2727        TO WS-ERROR
 16452*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16453*        ELSE
 16454*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16455*              MOVE ER-2727     TO WS-ERROR
 16456*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 298
* EL050.cbl
 16457
 16458     IF PB-COMPANY-ID = 'ACE'
 16459       IF AH-COVERAGE-CANCELLED
 16460         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16461           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16462              MOVE ER-2732      TO WS-ERROR
 16463              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16464
 16465     IF PB-COMPANY-ID      EQUAL   'HER'
 16466        IF WS-ERROR        EQUAL   ER-2727
 16467            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16468            MOVE  ER-2725          TO  WS-ERROR
 16469            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16470
 16471     IF PB-C-CLAIM-CREATED-CANCEL
 16472            MOVE ER-2748         TO WS-ERROR
 16473            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16474
 16475     IF PB-C-LAST-NAME NOT = SPACES
 16476         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16477            MOVE ER-2747         TO WS-ERROR
 16478            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16479
 16480 3710-EDIT-LUMP-SUM-PRIOR.
 16481
 16482     IF AH-COVERAGE-CANCELLED
 16483         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16484             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16485                MOVE ER-2735    TO WS-ERROR
 16486                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16487
 16488     IF LF-COVERAGE-CANCELLED
 16489         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16490             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16491                MOVE ER-2735    TO WS-ERROR
 16492                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16493
 16494 3710-EDIT-PRIOR-DEATH.
 16495
 16496*    IF LF-COVERAGE-CANCELLED
 16497*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16498*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16499*           (NOT PB-CI-OB)
 16500*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16501*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16502*                   MOVE ER-2732  TO WS-ERROR
 16503*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16504*
 16505*    IF AH-COVERAGE-CANCELLED
 16506*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16507*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16508*           (NOT PB-CI-OB)
 16509*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16510*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16511*                   MOVE ER-2732  TO WS-ERROR
 16512*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16513
 16514     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 299
* EL050.cbl
 16515         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16516            (NOT PB-COMP-LF-CANCEL)
 16517             NEXT SENTENCE
 16518         ELSE
 16519           IF PB-C-LF-CANCEL-VOIDED
 16520              NEXT SENTENCE
 16521           ELSE
 16522              MOVE ER-2753      TO WS-ERROR
 16523              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16524
 16525     IF CANCEL-FUTURE-DT
 16526         GO TO 3999-END-EDIT.
 16527
 16528 3715-GET-REMAIN-TERM-LF.
 16529
 16530     IF NO-LF-BENEFIT-MATCH  OR
 16531        WS-LF-BENEFIT-CD = ZEROS
 16532        GO TO 3730-GET-AH-REMAIN-TERM.
 16533
 16534     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16535     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16536     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16537     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16538     MOVE PB-SV-STATE            TO CP-STATE.
 16539     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16540     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16541     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16542     MOVE '2'                    TO CP-PROCESS-TYPE.
 16543     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16544     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16545     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16546     IF (PB-COMPANY-ID = 'CID')
 16547        AND (CP-STATE-STD-ABBRV = 'WI')
 16548        MOVE '7'                 TO CP-REM-TERM-METHOD
 16549        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16550     ELSE
 16551        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16552        MOVE WS-REM-TRM-CALC-OPTION
 16553                                 TO CP-REM-TRM-CALC-OPTION
 16554     END-IF
 16555**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16556     IF (PB-COMPANY-ID = 'CID')
 16557        AND (CP-STATE-STD-ABBRV = 'MO')
 16558        AND (PB-CERT-EFF-DT >= X'9B41')
 16559        AND (PB-CERT-EFF-DT <= X'A2FB')
 16560        MOVE '7'                 TO CP-REM-TERM-METHOD
 16561        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16562     END-IF
 16563     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16564                                    CP-LOAN-TERM.
 16565     IF CP-TRUNCATED-LIFE
 16566        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16567
 16568     IF CP-TERM-IS-DAYS
 16569         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16570     ELSE
 16571         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16572
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 300
* EL050.cbl
 16573     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16574
 16575     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16576
 16577     IF LF-COVERAGE-CANCELLED
 16578        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16579        NEXT SENTENCE
 16580      ELSE
 16581          GO TO 3730-GET-AH-REMAIN-TERM.
 16582
 16583 3720-GET-LF-REFUND.
 16584
 16585     IF PB-C-LF-CANCEL-VOIDED
 16586        GO TO 3730-GET-AH-REMAIN-TERM
 16587     end-if
 16588
 16589     IF PB-COMPANY-ID EQUAL 'BOA'
 16590         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16591         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16592         GO TO 3730-GET-AH-REMAIN-TERM.
 16593
 16594     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16595        (WS-AH-SPECIAL-CALC-CD = 'M')
 16596         MOVE ER-2767            TO WS-ERROR
 16597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16598         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16599         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16600         GO TO 3780-UPDATE-CANCEL-CERT.
 16601
 16602*    if (ws-lf-earnings-calc = '6')
 16603*       or (pb-c-lf-refund-override = '6')
 16604*       move cp-remaining-term-1 to cp-remaining-term-2
 16605*    end-if
 16606     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16607
 16608     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16609     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16610     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16611     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16612     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16613     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16614     IF PB-COMPANY-ID = 'DCC'
 16615        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16616        IF PDEF-MASTER-FOUND
 16617           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16618              (V1 > +8)
 16619              OR (PD-PROD-CODE (V1) = 'L')
 16620           END-PERFORM
 16621           IF V1 < +9
 16622              MOVE PD-MAX-AMT (V1)
 16623                           TO CP-R-MAX-TOT-BEN
 16624                              EC-AM-LF-MAX-TOT-BEN
 16625           END-IF
 16626        ELSE
 16627        MOVE ' '                 TO PDEF-MASTER-SW
 16628        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16629        MOVE PB-STATE            TO ERPDEF-STATE
 16630        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 301
* EL050.cbl
 16631           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16632        END-IF
 16633        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16634        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16635        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16636        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16637        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16638        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16639        IF PDEF-MASTER-FOUND
 16640           MOVE 'N'              TO PDEF-MASTER-SW
 16641           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16642           IF PDEF-MASTER-FOUND
 16643              IF (ERPDEF-KEY-SAVE (1:16) =
 16644                           PD-CONTROL-PRIMARY (1:16))
 16645                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16646                 CONTINUE
 16647              ELSE
 16648                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16649                 IF (ERPDEF-KEY-SAVE (1:16) =
 16650                           PD-CONTROL-PRIMARY (1:16))
 16651                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16652                    CONTINUE
 16653                 ELSE
 16654                    MOVE 'N'     TO PDEF-MASTER-SW
 16655                 END-IF
 16656              END-IF
 16657
 16658              IF PDEF-MASTER-FOUND
 16659                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16660                    (V1 > +8)
 16661                    OR (PD-PROD-CODE (V1) = 'L')
 16662                 END-PERFORM
 16663                 IF V1 < +9
 16664                    MOVE PD-MAX-AMT (V1)
 16665                                 TO CP-R-MAX-TOT-BEN
 16666                                    EC-AM-LF-MAX-TOT-BEN
 16667                 END-IF
 16668              END-IF
 16669           END-IF
 16670           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16671        END-IF
 16672        END-IF
 16673     END-IF
 16674     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16675
 16676     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16677
 16678     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16679                                    PB-C-LF-REM-TERM.
 16680
 16681     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16682     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16683
 16684     IF PB-COMPANY-ID EQUAL 'FLC'
 16685        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16686           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16687           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16688                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 302
* EL050.cbl
 16689                    - CM-LF-ITD-DEATH-AMT
 16690           IF PB-C-LF-REF-CALC LESS THAN +0
 16691              MOVE +0            TO PB-C-LF-REF-CALC
 16692              GO TO 3730-GET-AH-REMAIN-TERM
 16693           ELSE
 16694              GO TO 3730-GET-AH-REMAIN-TERM.
 16695
 16696     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16697                            OR '4' OR '5' OR '6' OR '8'
 16698                            OR '9' OR 'G'
 16699        MOVE PB-C-LF-REFUND-OVERRIDE
 16700                                 TO CP-EARNING-METHOD.
 16701
 16702     if pb-company-id = 'AHL'
 16703        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16704        if cp-class-code = spaces
 16705           move zeros            to cp-class-code
 16706        end-if
 16707     ELSE
 16708        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16709     END-IF
 16710*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16711     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16712     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16713                                    CP-RATING-BENEFIT-AMT.
 16714     IF CP-STATE-STD-ABBRV = 'OR'
 16715         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16716                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16717     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16718     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16719     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16720     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16721     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16722     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16723     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16724     IF WS-DEFAULT-APR NOT NUMERIC
 16725         MOVE ZEROS TO WS-DEFAULT-APR.
 16726****   N O T E   ****
 16727*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16728*      THE OH HARD CODING IN ELCRFNDP
 16729
 16730     IF PB-COMPANY-ID = 'CID'
 16731        IF CP-STATE-STD-ABBRV = 'OH'
 16732           MOVE WS-LF-EARNINGS-CALC
 16733                                 TO CP-EARNING-METHOD
 16734        END-IF
 16735     END-IF
 16736
 16737****   N O T E   ****
 16738
 16739*    IF CP-EARN-AS-NET-PAY
 16740*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16741*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16742*               MOVE WS-DEFAULT-APR
 16743*                                TO  CP-LOAN-APR
 16744*               MOVE ER-3780     TO  WS-ERROR
 16745*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16746*           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 303
* EL050.cbl
 16747*               MOVE ER-3781     TO  WS-ERROR
 16748*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16749*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16750     move ' '                    to cp-ext-days-calc
 16751     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16752
 16753     IF CP-REFUND-TYPE-USED NOT = SPACE
 16754         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16755
 16756     IF CP-ERROR-RATE-IS-ZERO OR
 16757        CP-ERROR-RATE-NOT-FOUND
 16758        MOVE ER-2740             TO WS-ERROR
 16759        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16760
 16761     IF CP-ERROR-RATE-FILE-NOTOPEN
 16762        MOVE ER-2617             TO WS-ERROR
 16763        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16764
 16765     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16766        AND PB-CI-ENTRY-STATUS = 'M'
 16767        MOVE +0                  TO PB-C-LF-REF-CALC
 16768     ELSE
 16769        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16770     END-IF
 16771
 16772     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16773         GO TO 3730-GET-AH-REMAIN-TERM.
 16774
 16775*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16776*       ADD +1                   TO PB-C-LF-REM-TERM
 16777*                                   CP-REMAINING-TERM
 16778*                                   CP-ORIGINAL-TERM.
 16779
 16780     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16781     MOVE '2'                    TO CP-EARNING-METHOD
 16782                                    CP-RATING-METHOD.
 16783     IF PB-COMPANY-ID = 'CID'
 16784        IF (CP-STATE-STD-ABBRV = 'MN')
 16785           AND (PB-CERT-EFF-DT > X'A4FF')
 16786           AND (WS-LF-EARNINGS-CALC = 'B')
 16787           MOVE '5'              TO CP-EARNING-METHOD
 16788           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16789        END-IF
 16790     END-IF
 16791     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16792                                        CP-REMAINING-BENEFIT
 16793                                        CP-RATING-BENEFIT-AMT.
 16794     IF CP-STATE-STD-ABBRV = 'OR'
 16795         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16796                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16797     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16798     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16799
 16800     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16801
 16802     IF CP-ERROR-RATE-IS-ZERO OR
 16803        CP-ERROR-RATE-NOT-FOUND
 16804        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 304
* EL050.cbl
 16805        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16806
 16807     IF CP-ERROR-RATE-FILE-NOTOPEN
 16808        MOVE ER-2617             TO WS-ERROR
 16809        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16810
 16811     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16812
 16813******************************************************************
 16814
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 305
* EL050.cbl
 16816 3730-GET-AH-REMAIN-TERM.
 16817     IF NO-AH-BENEFIT-MATCH  OR
 16818        WS-AH-BENEFIT-CD = ZEROS
 16819         GO TO 3770-CHECK-REFUNDS.
 16820
 16821     IF PB-CI-AH-LUMP-SUM-DISAB
 16822         IF  PB-C-AH-CANCEL-AMT = ZERO
 16823            IF NOT PB-COMP-AH-CANCEL
 16824             GO TO 3770-CHECK-REFUNDS.
 16825
 16826     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16827     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16828     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16829     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16830     MOVE PB-SV-STATE            TO CP-STATE.
 16831     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16832     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16833     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16834     MOVE '2'                    TO CP-PROCESS-TYPE.
 16835     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16836     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16837     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16838     IF (PB-COMPANY-ID = 'CID')
 16839        AND (CP-STATE-STD-ABBRV = 'WI')
 16840        MOVE '7'                 TO CP-REM-TERM-METHOD
 16841        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16842     ELSE
 16843        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16844        MOVE WS-REM-TRM-CALC-OPTION
 16845                                 TO CP-REM-TRM-CALC-OPTION
 16846     END-IF
 16847     IF (PB-COMPANY-ID = 'CID')
 16848        AND (CP-STATE-STD-ABBRV = 'MO')
 16849        AND (PB-CERT-EFF-DT >= X'9B41')
 16850        AND (PB-CERT-EFF-DT <= X'A2FB')
 16851        MOVE '7'                 TO CP-REM-TERM-METHOD
 16852        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16853     END-IF
 16854     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16855                                    CP-LOAN-TERM.
 16856     IF NOT CP-TERM-IS-DAYS
 16857         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16858
 16859     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16860
 16861     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16862
 16863     IF AH-COVERAGE-CANCELLED
 16864        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16865        NEXT SENTENCE
 16866      ELSE
 16867         GO TO 3770-CHECK-REFUNDS.
 16868
 16869 3740-GET-AH-REFUND.
 16870
 16871     IF PB-C-AH-CANCEL-VOIDED
 16872        GO TO 3780-UPDATE-CANCEL-CERT
 16873     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 306
* EL050.cbl
 16874
 16875     IF PB-COMPANY-ID = 'BOA'
 16876         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16877         GO TO 3770-CHECK-REFUNDS.
 16878
 16879     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16880*    MOVE ' '                    TO DC-OPTION-CODE
 16881     SET BIN-TO-GREG             TO TRUE
 16882     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16883     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16884                                    PB-C-AH-REM-TERM.
 16885     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16886     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16887
 16888     IF PB-COMPANY-ID EQUAL 'FLC'
 16889        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16890           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16891           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16892                    - CM-AH-ITD-AH-PMT)
 16893           IF PB-C-AH-REF-CALC LESS THAN +0
 16894              MOVE +0            TO PB-C-AH-REF-CALC
 16895              GO TO 3770-CHECK-REFUNDS
 16896           ELSE
 16897              GO TO 3770-CHECK-REFUNDS.
 16898
 16899     IF PB-COMPANY-ID = 'DCC'
 16900        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16901            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16902           MOVE 'S'              TO CP-EARNING-METHOD
 16903        END-IF
 16904     END-IF
 16905     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16906                            OR '4' OR '5' OR '6' OR '8'
 16907                            OR '9' OR 'G' OR 'S'
 16908        MOVE PB-C-AH-REFUND-OVERRIDE
 16909                                 TO CP-EARNING-METHOD.
 16910
 16911     if pb-company-id = 'AHL'
 16912        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16913        if cp-class-code = spaces
 16914           move zeros            to cp-class-code
 16915        end-if
 16916     ELSE
 16917        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16918     END-IF
 16919*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16920     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16921     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16922                                    CP-RATING-BENEFIT-AMT.
 16923     IF CP-STATE-STD-ABBRV = 'OR'
 16924         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16925                                         PB-CI-AH-TERM.
 16926     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16927     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16928     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16929     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16930     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16931     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 307
* EL050.cbl
 16932
 16933     IF CP-STATE-STD-ABBRV = 'OH'
 16934        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16935                                AND 'CID' AND 'DCC' and 'VPP'
 16936                                AND 'AHL')
 16937           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16938              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16939              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16940              MOVE '6' TO CP-EARNING-METHOD
 16941           END-IF
 16942        END-IF
 16943        IF PB-COMPANY-ID = 'CID'
 16944           IF NO-LIFE-COVERAGE
 16945              IF CP-CRITICAL-PERIOD
 16946                 MOVE '2'       TO CP-EARNING-METHOD
 16947              ELSE
 16948                 MOVE '6'       TO CP-EARNING-METHOD
 16949              END-IF
 16950           ELSE
 16951              IF WS-LF-COVERAGE-TYPE = 'L'
 16952                 MOVE '2'       TO CP-EARNING-METHOD
 16953              ELSE
 16954                 IF (PB-CI-LF-TERM > +60) OR
 16955                    (WS-LF-EARNINGS-CALC = '5')
 16956                    IF CP-CRITICAL-PERIOD
 16957                       MOVE '2'  TO CP-EARNING-METHOD
 16958                    ELSE
 16959                       MOVE '6'  TO CP-EARNING-METHOD
 16960                    END-IF
 16961                 ELSE
 16962                    MOVE '1'     TO CP-EARNING-METHOD
 16963                 END-IF
 16964              END-IF
 16965           END-IF
 16966        END-IF
 16967     END-IF
 16968
 16969*    IF CP-STATE-STD-ABBRV = 'VA'
 16970*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16971*          IF CP-ORIGINAL-TERM GREATER 61
 16972*             MOVE '6' TO CP-EARNING-METHOD
 16973*          ELSE
 16974*             MOVE '1' TO CP-EARNING-METHOD.
 16975
 16976     IF WS-DEFAULT-APR NOT NUMERIC
 16977         MOVE ZEROS TO WS-DEFAULT-APR.
 16978     IF CP-EARN-AS-NET-PAY
 16979         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16980            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16981                MOVE WS-DEFAULT-APR
 16982                                 TO  CP-LOAN-APR
 16983                MOVE ER-3780     TO  WS-ERROR
 16984                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16985            ELSE
 16986                MOVE ER-3781     TO  WS-ERROR
 16987                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16988     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16989     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 308
* EL050.cbl
 16990        AND CP-CANCEL-REASON = 'R'
 16991        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16992        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16993     END-IF
 16994     IF PB-COMPANY-ID = 'DCC'
 16995        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16996        AND (CP-EARNING-METHOD = 'D')
 16997        AND (CP-CANCEL-REASON NOT = 'R')
 16998        CONTINUE
 16999     ELSE
 17000        GO TO 3750-CONTINUE
 17001     END-IF
 17002     MOVE ' '                    TO DD-IU-SW
 17003     IF NOT PDEF-MASTER-FOUND
 17004        MOVE ' '                 TO PDEF-MASTER-SW
 17005        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17006        MOVE PB-STATE            TO ERPDEF-STATE
 17007        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 17008           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 17009        END-IF
 17010        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17011        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17012        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17013        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17014        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17015        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17016        IF PDEF-MASTER-FOUND
 17017           MOVE 'N'              TO PDEF-MASTER-SW
 17018           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17019           IF PDEF-MASTER-FOUND
 17020              IF (ERPDEF-KEY-SAVE (1:16) =
 17021                           PD-CONTROL-PRIMARY (1:16))
 17022                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17023                 CONTINUE
 17024              ELSE
 17025                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17026                 IF (ERPDEF-KEY-SAVE (1:16) =
 17027                           PD-CONTROL-PRIMARY (1:16))
 17028                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17029                    CONTINUE
 17030                 ELSE
 17031                    MOVE ER-2740 TO WS-ERROR
 17032                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17033                    GO TO 3770-CHECK-REFUNDS
 17034                 END-IF
 17035              END-IF
 17036           END-IF
 17037           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17038        END-IF
 17039     END-IF
 17040     IF PDEF-MASTER-FOUND
 17041        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17042           (V1 > +8)
 17043           OR (PD-PROD-CODE (V1) = 'I')
 17044        END-PERFORM
 17045        IF V1 < +9
 17046           SET DD-IU-PRESENT        TO TRUE
 17047        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 309
* EL050.cbl
 17048        IF WS-AH-DCC-TRUNC = 'T'
 17049           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17050        ELSE
 17051           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17052        END-IF
 17053        EVALUATE TRUE
 17054           WHEN WS-TERM > +168
 17055              MOVE 15               TO V1
 17056           WHEN WS-TERM > +156
 17057              MOVE 14               TO V1
 17058           WHEN WS-TERM > +144
 17059              MOVE 13               TO V1
 17060           WHEN WS-TERM > +132
 17061              MOVE 12               TO V1
 17062           WHEN WS-TERM > +120
 17063              MOVE 11               TO V1
 17064           WHEN WS-TERM > +108
 17065              MOVE 10               TO V1
 17066           WHEN WS-TERM > +96
 17067              MOVE 9                TO V1
 17068           WHEN WS-TERM > +84
 17069              MOVE 8                TO V1
 17070           WHEN WS-TERM > +72
 17071              MOVE 7                TO V1
 17072           WHEN WS-TERM > +60
 17073              MOVE 6                TO V1
 17074           WHEN WS-TERM > +48
 17075              MOVE 5                TO V1
 17076           WHEN WS-TERM > +36
 17077              MOVE 4                TO V1
 17078           WHEN WS-TERM > +24
 17079              MOVE 3                TO V1
 17080           WHEN WS-TERM > +12
 17081              MOVE 2                TO V1
 17082           WHEN OTHER
 17083              MOVE 1                TO V1
 17084        END-EVALUATE
 17085
 17086        EVALUATE TRUE
 17087*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17088*             < +13)
 17089*             AND (DD-IU-PRESENT)
 17090*             MOVE 2                TO V2
 17091*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17092*             MOVE 1                TO V2
 17093           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17094              MOVE 2                TO V2
 17095           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17096              MOVE 3                TO V2
 17097           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17098              MOVE 4                TO V2
 17099           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17100              MOVE 5                TO V2
 17101           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17102              MOVE 6                TO V2
 17103           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17104              MOVE 7                TO V2
 17105           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 310
* EL050.cbl
 17106              MOVE 8                TO V2
 17107           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17108              MOVE 9                TO V2
 17109           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17110              MOVE 10               TO V2
 17111           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17112              MOVE 11               TO V2
 17113           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17114              MOVE 12               TO V2
 17115           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17116              MOVE 13               TO V2
 17117           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17118              MOVE 14               TO V2
 17119           WHEN OTHER
 17120              MOVE 15               TO V2
 17121        END-EVALUATE
 17122
 17123        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17124                                 TO CP-DDF-LO-FACT
 17125        MOVE PD-UEP-FACTOR (V1 V2)
 17126                                 TO CP-DDF-HI-FACT
 17127
 17128        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17129        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17130        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17131           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17132        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17133        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17134        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17135           + PD-1ST-YR-ADMIN-ALLOW
 17136
 17137        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17138*       IF PI-CLP-YN = 'Y'
 17139*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17140*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17141*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17142*       END-IF
 17143
 17144        IF DD-IU-PRESENT
 17145           MOVE 'I'              TO CP-EARNING-METHOD
 17146        END-IF
 17147        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17148                                     CP-CLP-RATE-UP
 17149        IF CP-IU-RATE-UP NOT = ZEROS
 17150           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17151              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17152           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17153              / (1 - WS-WORK-FACT)
 17154        END-IF
 17155     END-IF
 17156     .
 17157 3750-CONTINUE.
 17158     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17159
 17160     IF CP-REFUND-TYPE-USED NOT = SPACE
 17161         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17162
 17163     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 311
* EL050.cbl
 17164        CP-ERROR-RATE-NOT-FOUND
 17165        MOVE ER-2740             TO WS-ERROR
 17166        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17167
 17168     IF CP-ERROR-RATE-FILE-NOTOPEN
 17169        MOVE ER-2617             TO WS-ERROR
 17170        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17171     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17172        AND (PB-CI-ENTRY-STATUS = 'M')
 17173        MOVE +0                  TO PB-C-AH-REF-CALC
 17174     ELSE
 17175        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17176     END-IF
 17177     if pb-company-id = 'VPP'
 17178        MOVE cm-ah-clp           to cp-original-premium
 17179        move zeros               to cp-calc-refund
 17180        perform 7600-get-refund  thru 7600-exit
 17181        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17182           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17183        else
 17184           move zeros            to pb-c-ah-rfnd-clp
 17185        end-if
 17186        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17187           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17188           pb-ci-cancel-fee
 17189     end-if
 17190     IF PB-COMPANY-ID = 'DCC'
 17191        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17192        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17193        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17194        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17195        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17196        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17197        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17198        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17199*       if pb-c-cancel-amt < +0
 17200*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17201*       end-if
 17202*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17203     END-IF
 17204     .
 17205 3770-CHECK-REFUNDS.
 17206
 17207     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17208        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17209           MOVE ER-2766          TO WS-ERROR
 17210           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17211           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17212           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17213              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17214
 17215     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17216        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17217           MOVE ER-2766          TO WS-ERROR
 17218           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17219           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17220           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17221              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 312
* EL050.cbl
 17222
 17223     IF PB-COMP-LF-CANCEL
 17224        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17225        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17226           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17227              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17228
 17229     IF PB-COMP-AH-CANCEL
 17230        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17231        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17232           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17233              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17234
 17235     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17236             GIVING WS-UNSIGN-WRK1
 17237     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17238             GIVING WS-UNSIGN-WRK2.
 17239
 17240     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17241         MOVE ZERO TO WS-UNSIGN-WRK1.
 17242
 17243     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17244         MOVE ZERO TO WS-UNSIGN-WRK2.
 17245
 17246     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17247
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 313
* EL050.cbl
 17249
 17250 3772-CONTINUE.
 17251
 17252**********************************
 17253*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17254*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17255*** DOUBLES THE TOLERANCE AMOUNT.
 17256***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17257**********************************
 17258     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17259     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17260         IF WS-REF-REJECT-SW = SPACE
 17261             MOVE ER-2754        TO WS-ERROR
 17262             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17263           ELSE
 17264             MOVE ER-2736        TO WS-ERROR
 17265             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17266**********************************
 17267
 17268 3773-CONTINUE.
 17269
 17270     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17271        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17272           MOVE ER-2723          TO WS-ERROR
 17273           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17274
 17275     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17276        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17277           MOVE ER-2724          TO WS-ERROR
 17278           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17279
 17280     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17281         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17282             (1 + WS-LF-REFUND-OVS-PCT)
 17283     ELSE
 17284         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17285
 17286     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17287         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17288             (1 - WS-TOL-LF-REFUND-PCT)
 17289     ELSE
 17290         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17291
 17292     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17293        AND (PB-CI-ENTRY-STATUS = 'M')
 17294        AND (PB-C-LF-CANCEL-AMT > +0)
 17295        MOVE ER-3843             TO WS-ERROR
 17296        PERFORM 9900-ERROR-FORMAT
 17297                                 THRU 9900-EXIT
 17298     END-IF
 17299     EVALUATE TRUE
 17300        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17301           CONTINUE
 17302        WHEN PB-C-LF-CANCEL-AMT = +0
 17303                 AND PB-C-LF-REF-CALC > +0
 17304           CONTINUE
 17305        WHEN WS-LF-REFUND-OVS-AMT = 0
 17306                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 314
* EL050.cbl
 17307           CONTINUE
 17308        WHEN OTHER
 17309           IF WS-TOL-LF-REFUND  = +0
 17310              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17311           END-IF
 17312           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17313                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17314                          (PB-C-LF-CANCEL-AMT))
 17315              CONTINUE
 17316           ELSE
 17317              IF WS-LF-REFUND-OVS-AMT = +0
 17318                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17319              END-IF
 17320              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17321                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17322                                       PB-C-LF-CANCEL-AMT)
 17323                 CONTINUE
 17324              ELSE
 17325                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17326                   MOVE ER-2754   TO  WS-ERROR
 17327                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17328                 ELSE
 17329                    MOVE ER-2736   TO  WS-ERROR
 17330                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17331                 END-IF
 17332              END-IF
 17333           END-IF
 17334     END-EVALUATE.
 17335
 17336     EVALUATE TRUE
 17337        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17338           CONTINUE
 17339        WHEN PB-C-LF-CANCEL-AMT = +0
 17340                 AND PB-C-LF-REF-CALC > +0
 17341           CONTINUE
 17342        WHEN OTHER
 17343           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17344               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17345              CONTINUE
 17346           ELSE
 17347              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17348               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17349                CONTINUE
 17350              ELSE
 17351                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17352                     MOVE ER-2754   TO  WS-ERROR
 17353                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17354                 ELSE
 17355                     MOVE ER-2736   TO  WS-ERROR
 17356                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17357                 END-IF
 17358              END-IF
 17359           END-IF
 17360     END-EVALUATE.
 17361
 17362     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17363         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17364             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 315
* EL050.cbl
 17365     ELSE
 17366         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17367
 17368     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17369         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17370             (1 - WS-TOL-AH-REFUND-PCT)
 17371     ELSE
 17372         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17373
 17374     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17375        AND (PB-CI-ENTRY-STATUS = 'M')
 17376        AND (PB-C-AH-CANCEL-AMT > +0)
 17377        MOVE ER-3843             TO WS-ERROR
 17378        PERFORM 9900-ERROR-FORMAT
 17379                                 THRU 9900-EXIT
 17380     END-IF
 17381     EVALUATE TRUE
 17382        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17383           CONTINUE
 17384*       WHEN PB-C-AH-REF-CALC = +0 AND
 17385*                  PB-C-AH-CANCEL-AMT > +0
 17386        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17387                   PB-C-AH-REF-CALC > +0
 17388           CONTINUE
 17389        WHEN WS-AH-REFUND-OVS-AMT = +0
 17390                AND WS-TOL-AH-REFUND = +0
 17391           CONTINUE
 17392        WHEN OTHER
 17393           IF WS-TOL-AH-REFUND = +0
 17394              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17395           END-IF
 17396           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17397               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17398                                         PB-C-AH-CANCEL-AMT)
 17399              CONTINUE
 17400           ELSE
 17401              IF WS-AH-REFUND-OVS-AMT = +0
 17402                 MOVE +9999999.99 TO
 17403                         WS-AH-REFUND-OVS-AMT
 17404              END-IF
 17405              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17406                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17407                                         PB-C-AH-CANCEL-AMT)
 17408                 CONTINUE
 17409              ELSE
 17410                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17411                    MOVE ER-2754   TO  WS-ERROR
 17412                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17413                 ELSE
 17414                    MOVE ER-2736   TO  WS-ERROR
 17415                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17416                 END-IF
 17417              END-IF
 17418           END-IF
 17419     END-EVALUATE.
 17420
 17421     EVALUATE TRUE
 17422        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 316
* EL050.cbl
 17423           CONTINUE
 17424*       WHEN PB-C-AH-REF-CALC > +0 AND
 17425*                  PB-C-AH-CANCEL-AMT = +0
 17426        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17427                   PB-C-AH-REF-CALC = +0
 17428           CONTINUE
 17429        WHEN OTHER
 17430           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17431               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17432              CONTINUE
 17433           ELSE
 17434              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17435                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17436                 CONTINUE
 17437              ELSE
 17438                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17439                     MOVE ER-2754   TO  WS-ERROR
 17440                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17441                 ELSE
 17442                     MOVE ER-2736   TO  WS-ERROR
 17443                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17444                 END-IF
 17445              END-IF
 17446           END-IF
 17447     END-EVALUATE.
 17448
 17449     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17450        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17451        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17452           AND  PB-C-LF-REF-CALC < +1.00
 17453           AND  PB-C-AH-REF-CALC < +1.00
 17454           CONTINUE
 17455        ELSE
 17456           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17457              AND (PB-CI-ENTRY-STATUS = 'M')
 17458              CONTINUE
 17459           ELSE
 17460              MOVE ER-2741       TO WS-ERROR
 17461              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17462           END-IF
 17463        END-IF
 17464     END-IF
 17465
 17466     IF (PB-C-LF-CANCEL-AMT = ZERO
 17467        AND WS-LF-BENEFIT-CD NOT = ZERO
 17468        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17469        AND PB-C-LF-REF-CALC NOT = ZERO)
 17470        OR
 17471        (PB-C-LF-CANCEL-AMT = ZERO
 17472        AND WS-LF-BENEFIT-CD NOT = ZERO
 17473        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17474             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17475                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17476                NEXT SENTENCE
 17477             ELSE
 17478                MOVE ER-2739        TO WS-ERROR
 17479                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17480
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 317
* EL050.cbl
 17481     IF (PB-C-AH-CANCEL-AMT = ZERO
 17482        AND WS-AH-BENEFIT-CD NOT = ZERO
 17483        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17484        AND PB-C-AH-REF-CALC NOT = ZERO)
 17485        OR
 17486        (PB-C-AH-CANCEL-AMT = ZERO
 17487        AND WS-AH-BENEFIT-CD NOT = ZERO
 17488        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17489             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17490                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17491                NEXT SENTENCE
 17492             ELSE
 17493                MOVE ER-2738        TO WS-ERROR
 17494                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17495
 17496 3775-OVER-REF-CHK.
 17497
 17498     IF PB-CI-ENTRY-STATUS = '5'
 17499        GO TO 3780-UPDATE-CANCEL-CERT.
 17500
 17501     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17502                              PB-CI-LF-ALT-PREMIUM-AMT.
 17503
 17504     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17505        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17506                                 PB-C-LF-REF-CALC
 17507      ELSE
 17508        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17509                                 PB-C-LF-CANCEL-AMT.
 17510
 17511     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17512        MOVE ER-2755             TO WS-ERROR
 17513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17514
 17515     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17516
 17517     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17518        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17519                                 PB-C-AH-REF-CALC
 17520      ELSE
 17521        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17522                                 PB-C-AH-CANCEL-AMT.
 17523
 17524     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17525        MOVE ER-2778             TO WS-ERROR
 17526        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17527
 17528     IF PB-CI-OB-FLAG NOT = 'Z'
 17529        NEXT SENTENCE
 17530       ELSE
 17531         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17532            MOVE ER-2757           TO WS-ERROR
 17533            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17534
 17535 3780-UPDATE-CANCEL-CERT.
 17536
 17537     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17538        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 318
* EL050.cbl
 17539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17540
 17541     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17542         MOVE ER-2729              TO WS-ERROR
 17543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17544
 17545     IF PB-CI-LF-BENEFIT-CD = ZERO
 17546         GO TO 3780-UPDATE-CONT-1.
 17547
 17548     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17549         GO TO 3780-UPDATE-CONT-1.
 17550
 17551     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17552       AND
 17553        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17554       AND
 17555        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17556       AND
 17557        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17558            NEXT SENTENCE
 17559       ELSE
 17560        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17561          AND
 17562***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17563***       AND
 17564           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17565            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17566               MOVE ER-2730      TO WS-ERROR
 17567               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17568               GO TO 3999-END-EDIT
 17569            ELSE
 17570               GO TO 3999-END-EDIT
 17571        ELSE
 17572            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17573               MOVE ER-2765           TO WS-ERROR
 17574               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17575               GO TO 3785-CHECK-REF-INT.
 17576*              GO TO 3999-END-EDIT.
 17577
 17578 3780-UPDATE-CONT-1.
 17579     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17580
 17581     IF PB-CI-AH-BENEFIT-CD = ZERO
 17582         GO TO 3780-UPDATE-CONT-2.
 17583
 17584     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17585         GO TO 3780-UPDATE-CONT-2.
 17586
 17587     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17588
 17589     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17590       AND
 17591        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17592       AND
 17593        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17594       AND
 17595        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17596            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 319
* EL050.cbl
 17597       ELSE
 17598        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17599          AND
 17600***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17601***       AND
 17602           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17603           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17604            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17605               MOVE ER-2773      TO WS-ERROR
 17606               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17607               GO TO 3999-END-EDIT
 17608            ELSE
 17609               GO TO 3999-END-EDIT
 17610            END-IF
 17611           ELSE
 17612             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17613                IF MSTR-CERT-NO = W-CL-CERT-NO
 17614                   MOVE ER-2890 TO WS-ERROR
 17615                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17616                   GO TO 3999-END-EDIT
 17617                ELSE
 17618                   MOVE ER-2898 TO WS-ERROR
 17619                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17620                   GO TO 3999-END-EDIT
 17621                END-IF
 17622             ELSE
 17623                GO TO 3785-CHECK-REF-INT
 17624             END-IF
 17625           END-IF
 17626          ELSE
 17627            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17628              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17629                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17630                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17631                      MOVE ER-2890 TO WS-ERROR
 17632                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17633                      GO TO 3999-END-EDIT
 17634                   ELSE
 17635                      MOVE ER-2898 TO WS-ERROR
 17636                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17637                      GO TO 3999-END-EDIT
 17638                   END-IF
 17639                ELSE
 17640                   MOVE ER-2765 TO WS-ERROR
 17641                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17642                   GO TO 3785-CHECK-REF-INT
 17643                END-IF
 17644              ELSE
 17645               MOVE ER-2765      TO WS-ERROR
 17646               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17647               GO TO 3785-CHECK-REF-INT.
 17648*              GO TO 3999-END-EDIT.
 17649
 17650 3780-UPDATE-CONT-2.
 17651
 17652     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17653        AND WS-LF-BENEFIT-CD = ZERO
 17654           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 320
* EL050.cbl
 17655           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17656
 17657     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17658        AND WS-AH-BENEFIT-CD = ZERO
 17659           MOVE ER-2744           TO WS-ERROR
 17660           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17661
 17662     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17663        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17664        AND
 17665        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17666         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17667           MOVE ER-2746           TO WS-ERROR
 17668           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17669
 17670     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17671       AND
 17672        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17673             MOVE ER-2737        TO WS-ERROR
 17674             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17675
 17676     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17677       AND
 17678        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17679             MOVE ER-2737        TO WS-ERROR
 17680             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17681
 17682     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17683         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17684             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17685             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17686         ELSE
 17687             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17688                 MOVE ER-2768    TO WS-ERROR
 17689                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17690             ELSE
 17691                 MOVE ER-2756    TO WS-ERROR
 17692                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17693
 17694     IF CERT-PEND-ISSUE-RETURNED
 17695        MOVE ER-2772             TO WS-ERROR
 17696        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17697 3785-CHECK-REF-INT.
 17698*    IF PB-STATE NOT = 'NH' and 'TN'
 17699     IF PB-STATE NOT = 'NH'
 17700        GO TO 3999-END-EDIT
 17701     END-IF
 17702
 17703     MOVE ER-2796                TO WS-ERROR
 17704     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17705     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17706        OR (CM-REF-INTERFACE-SW = 'Y')
 17707        MOVE ER-2793             TO WS-ERROR
 17708        PERFORM 9900-ERROR-FORMAT
 17709                                 THRU 9900-EXIT
 17710     END-IF
 17711     MOVE +0                     TO WS-PAYMENT-AMT
 17712     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 321
* EL050.cbl
 17713        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17714               PB-C-AH-CANCEL-DT
 17715           GO TO 3999-END-EDIT
 17716        END-IF
 17717     end-if
 17718***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17719***-_-
 17720***-_-   For TN it's only flat cancels
 17721***-_-
 17722***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17723     if pb-state = 'TN'
 17724        if ((pb-c-lf-cancel-dt <> low-values)
 17725           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17726                      or
 17727           ((pb-c-ah-cancel-dt <> low-values)
 17728           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17729           GO TO 3999-END-EDIT
 17730        END-IF
 17731     end-if
 17732     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17733        GO TO 3999-END-EDIT
 17734     END-IF
 17735***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17736***-_-
 17737***-_-   if cancel date within 15 days of effective date, bypass
 17738***-_-
 17739***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17740     IF PB-STATE NOT = 'NH'
 17741        GO TO 3785-CONTINUE
 17742     END-IF
 17743     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17744     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17745     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17746        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17747     END-IF
 17748     MOVE '1'                    TO DC-OPTION-CODE
 17749     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17750     IF NO-CONVERSION-ERROR
 17751        IF DC-ELAPSED-DAYS < +16
 17752           GO TO 3999-END-EDIT
 17753        END-IF
 17754     END-IF
 17755***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17756***-_-
 17757***-_-   if cancel date within 30 days of current date then
 17758***-_-   bypass else subtract 15 days from period
 17759***-_-
 17760***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17761     MOVE +0                     TO DC-ELAPSED-DAYS
 17762     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17763     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17764     MOVE '1'                    TO DC-OPTION-CODE
 17765     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17766     IF NO-CONVERSION-ERROR
 17767        IF DC-ELAPSED-DAYS > +30
 17768           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17769        ELSE
 17770           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 322
* EL050.cbl
 17771        END-IF
 17772     ELSE
 17773        GO TO 3999-END-EDIT
 17774     END-IF
 17775     .
 17776 3785-CONTINUE.
 17777     if pb-state = 'TN'
 17778        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17779        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17780        MOVE '1'                 TO DC-OPTION-CODE
 17781        PERFORM 8500-DATE-CONVERT
 17782                                 THRU 8500-EXIT
 17783        IF no-CONVERSION-ERROR
 17784           IF DC-ELAPSED-DAYS < +16
 17785              GO TO 3999-END-EDIT
 17786           END-IF
 17787        END-IF
 17788     end-if
 17789***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17790***-_-
 17791***-_-   'NH' is 10%, TN is 3.5%
 17792***-_-
 17793***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17794*    if pb-state = 'NH'
 17795*       move +1.10               to ws-work-rate
 17796*    else
 17797*       move +1.035              to ws-work-rate
 17798*    end-if
 17799     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17800     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17801        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17802           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17803     IF WS-PAYMENT-AMT < 10.00
 17804        GO TO 3999-END-EDIT
 17805     END-IF
 17806*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17807
 17808     if (cm-soc-sec-no(1:9) numeric)
 17809        and (cm-soc-sec-no(1:9) not = zeros)
 17810        GO TO 3999-END-EDIT
 17811     END-IF
 17812     MOVE ER-2795                TO WS-ERROR
 17813     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17814
 17815     GO TO 3999-END-EDIT.
 17816******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 323
* EL050.cbl
 17818 3990-FILES-NOT-OPEN.
 17819
 17820     MOVE ER-2617                TO WS-ERROR.
 17821     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17822     GO TO 9990-RETURN.
 17823
 17824 3999-END-EDIT.
 17825
 17826     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17827
 17828     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17829         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17830         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17831             PERFORM 9250-UNLOCK-RETURN
 17832             GO TO 9990-RETURN
 17833          ELSE
 17834             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17835             GO TO 9990-RETURN.
 17836
 17837     IF PB-CANCELLATION
 17838          GO TO 9990-RETURN.
 17839
 17840     IF CERT-WAS-NOT-FOUND
 17841        MOVE SPACES              TO CERTIFICATE-MASTER.
 17842
 17843     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17844
 17845     IF CERT-WAS-FOUND
 17846         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17847             PERFORM 9250-UNLOCK-RETURN
 17848          ELSE
 17849            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17850      ELSE
 17851         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17852
 17853*    if pb-company-id = 'VPP'
 17854*       perform 8150-read-elcrtt thru 8150-exit
 17855*       if ws-vehicle-odometer numeric
 17856*          if ws-vehicle-odometer > 6000
 17857*             move er-1583       to ws-error
 17858*             PERFORM 9900-ERROR-FORMAT
 17859*                                THRU 9900-EXIT
 17860*          end-if
 17861*       end-if
 17862*    end-if
 17863     perform 8145-read-elcrtt-upd thru 8145-exit
 17864     if not elcrtt-found
 17865        move 'CS'                to certificate-trailers
 17866        move cm-control-primary  to cs-control-primary
 17867        move 'C'                 TO cs-trailer-type
 17868        move zeros               to cs-vehicle-odometer
 17869     end-if
 17870     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17871        IF ((PB-COMPANY-ID = 'DCC')
 17872           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17873                         or
 17874           (pb-company-id = 'CID' or 'VPP')
 17875           IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 324
* EL050.cbl
 17876               or (hldi-pass-area not = spaces)
 17877               move pa-modelyear        to cs-year
 17878               move pa-makename         to cs-make
 17879               move pa-modelname        to cs-model
 17880               move pa-seriesname       to cs-future
 17881               MOVE PB-I-VIN            TO CS-VIN-NUMBER
 17882               move 'Y'                 to elcrtt-update-sw
 17883           end-if
 17884        end-if
 17885     end-if
 17886     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17887        IF WS-INS-AGE-SET = 'Y'
 17888           MOVE WS-INS-AGE-DEFAULTED
 17889                                 TO CS-INS-AGE-DEFAULT-FLAG
 17890           move 'Y'              to elcrtt-update-sw
 17891        END-IF
 17892        IF WS-JNT-AGE-SET = 'Y'
 17893           MOVE WS-JNT-AGE-DEFAULTED
 17894                                 TO CS-JNT-AGE-DEFAULT-FLAG
 17895           move 'Y'              to elcrtt-update-sw
 17896        END-IF
 17897     end-if
 17898     move cs-ins-age-default-flag to ws-ins-age-defaulted
 17899     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 17900     move cs-vehicle-odometer    to ws-vehicle-odometer
 17901     if ws-ins-age-defaulted = 'Y'
 17902        move er-1573             to ws-error
 17903        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17904     end-if
 17905
 17906     if ws-jnt-age-defaulted = 'Y'
 17907        move er-1574             to ws-error
 17908        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17909     end-if
 17910***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17911***                                                           ****
 17912***  Set an error if the state requires verification of agent ****
 17913***  and agent hasn't verified yet and the status is not =    ****
 17914***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17915***  and the entry date > 09/01/2015.                         ****
 17916***                                                           ****
 17917***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17918     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17919        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17920        and (pb-account (9:2) not = 'OB')
 17921        if (ws-st-agent-sig-edit = 'Y')
 17922           and (am-report-code-1 not = 'CONLEY')
 17923           evaluate true
 17924              when cs-agent-edit-status = 'C'
 17925                 move er-1743    to ws-error
 17926                 perform 9900-error-format
 17927                                 thru 9900-exit
 17928              when cs-agent-edit-status = 'S'
 17929                 move er-1744    to ws-error
 17930                 perform 9900-error-format
 17931                                 thru 9900-exit
 17932              when cs-agent-edit-status = 'M'
 17933                 move er-1745    to ws-error
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 325
* EL050.cbl
 17934                 perform 9900-error-format
 17935                                 thru 9900-exit
 17936              when cs-agent-edit-status = 'R'
 17937                 move er-1747    to ws-error
 17938                 perform 9900-error-format
 17939                                 thru 9900-exit
 17940              when cs-agent-edit-status = 'N'
 17941                 move er-1748    to ws-error
 17942                 perform 9900-error-format
 17943                                 thru 9900-exit
 17944              when cs-agent-edit-status <> 'V' and 'U' and
 17945                                           'R' and 'N'
 17946                 move er-1746    to ws-error
 17947                 perform 9900-error-format
 17948                                 thru 9900-exit
 17949           end-evaluate
 17950        end-if
 17951     end-if
 17952*    move ' ' to cs-claim-verification-status
 17953*    move 'Y' to elcrtt-update-sw
 17954     if cs-claim-verification-status = ' ' or 'R'
 17955        move pb-state            to pa-clmhs-state
 17956        move pb-account          to pa-account
 17957        move ws-greg-eff-date    to pa-eff-dt
 17958        move pb-cert-no          to pa-cert-no
 17959        perform 7795-call-sqlclmhs
 17960                                 thru 7795-exit
 17961        display ' back from sqlclmhs ' pa-clm-count
 17962        if pa-clm-count > 0
 17963           if cs-claim-verification-status = ' '
 17964              move 'R'           to cs-claim-verification-status
 17965              display 'Updating elcrtt ' pb-state ' '
 17966                 pb-account ' ' pb-cert-no
 17967              move 'Y'           to elcrtt-update-sw
 17968           end-if
 17969        else
 17970           if cs-claim-verification-status = 'R'
 17971              move ' '           to cs-claim-verification-status
 17972              move 'Y'           to elcrtt-update-sw
 17973           end-if
 17974        end-if
 17975     end-if
 17976
 17977     if cs-claim-verification-status <> ' '
 17978        evaluate true
 17979           when cs-claim-verification-status = 'R'
 17980              move er-1749    to ws-error
 17981              perform 9900-error-format
 17982                              thru 9900-exit
 17983           when cs-claim-verification-status = 'W'
 17984              move er-1750    to ws-error
 17985              perform 9900-error-format
 17986                              thru 9900-exit
 17987           when cs-claim-verification-status = 'I'
 17988              move er-1751    to ws-error
 17989              perform 9900-error-format
 17990                              thru 9900-exit
 17991           when cs-claim-verification-status = 'K'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 326
* EL050.cbl
 17992              move er-1761    to ws-error
 17993              perform 9900-error-format
 17994                              thru 9900-exit
 17995           when cs-claim-verification-status = 'A'
 17996              move er-1752    to ws-error
 17997              perform 9900-error-format
 17998                              thru 9900-exit
 17999           when cs-claim-verification-status = 'B'
 18000              move er-1754    to ws-error
 18001              perform 9900-error-format
 18002                              thru 9900-exit
 18003           when cs-claim-verification-status = 'C'
 18004              move er-1753    to ws-error
 18005              perform 9900-error-format
 18006                              thru 9900-exit
 18007           when cs-claim-verification-status = 'D'
 18008              move er-1757    to ws-error
 18009              perform 9900-error-format
 18010                              thru 9900-exit
 18011           when cs-claim-verification-status = 'E'
 18012              move er-1758    to ws-error
 18013              perform 9900-error-format
 18014                              thru 9900-exit
 18015           when cs-claim-verification-status = 'F'
 18016              move er-1759    to ws-error
 18017              perform 9900-error-format
 18018                              thru 9900-exit
 18019           when cs-claim-verification-status = 'G'
 18020              move er-1760    to ws-error
 18021              perform 9900-error-format
 18022                              thru 9900-exit
 18023*          when cs-claim-verification-status = 'H'
 18024*             move er-1756    to ws-error
 18025*             perform 9900-error-format
 18026*                             thru 9900-exit
 18027*          when cs-claim-verification-status = 'J'
 18028*             move er-1755    to ws-error
 18029*             perform 9900-error-format
 18030*                             thru 9900-exit
 18031        end-evaluate
 18032     end-if
 18033
 18034     IF ELCRTT-UPDATE
 18035        perform 8150-update-elcrtt thru 8150-exit
 18036*       display ' back from 8150 ' elcrtt-file-status
 18037     else
 18038        if elcrtt-found
 18039           perform 8155-unlock-elcrtt
 18040                                 thru 8155-exit
 18041        end-if
 18042     end-if
 18043     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18044     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 18045        AND (WS-NO-SECURE-PAY))
 18046                  OR
 18047        (WS-LF-SPECIAL-CALC-CD = 'O'
 18048        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18049        SET SKIP-ADDR-EDIT       TO TRUE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 327
* EL050.cbl
 18050     END-IF
 18051     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18052        AND (NOT SKIP-ADDR-EDIT)
 18053        MOVE ER-2963             TO WS-ERROR
 18054        PERFORM 9900-ERROR-FORMAT
 18055                                 THRU 9900-EXIT
 18056        GO TO 9990-RETURN
 18057     END-IF
 18058     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 18059     IF ERPNDM-FOUND NOT = 'X'
 18060        move 'Y'                 to erpndm-unlock-sw
 18061        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18062           OR (PM-CITY        = SPACES OR LOW-VALUES)
 18063           OR (PM-STATE       = SPACES OR LOW-VALUES)
 18064           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 18065           or (pm-zip-code    = zeros)
 18066           or (pm-zip-code not numeric))
 18067           AND (NOT SKIP-ADDR-EDIT)
 18068           MOVE ER-2694          TO WS-ERROR
 18069           PERFORM 9900-ERROR-FORMAT
 18070                                 THRU 9900-EXIT
 18071        END-IF
 18072        MOVE ' '                 TO STATE-RECORD-ERROR
 18073        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18074        MOVE PM-STATE            TO CNTL-ACCESS
 18075        MOVE '3'                 TO CNTL-REC-TYPE
 18076        MOVE +0                  TO CNTL-SEQ-NO
 18077        MOVE '0'                 TO RC-SW-2
 18078        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18079        IF (NO-STATE-RECORD)
 18080           OR (CF-RECORD-TYPE NOT = '3')
 18081           OR (PM-STATE NOT = CF-STATE-CODE)
 18082           IF (PM-STATE = SPACES)
 18083              AND (SKIP-ADDR-EDIT)
 18084              CONTINUE
 18085           ELSE
 18086              MOVE ER-2963       TO WS-ERROR
 18087              PERFORM 9900-ERROR-FORMAT
 18088                                 THRU 9900-EXIT
 18089           END-IF
 18090        END-IF
 18091        if (ws-error not = er-2963 and er-2694)
 18092           and (pm-city-st-zip-verified = ' ')
 18093           and (pb-company-id = 'CID')
 18094           move spaces           to zipcd-pass-area
 18095           move pm-zip-code      to pa-zip
 18096           move pm-city          to pa-city
 18097           move pm-state         to pa-state
 18098           perform 7790-call-zip-verify
 18099                                 thru 7790-exit
 18100           if pa-errorcode-zip (1:1) = ' '
 18101                    move 'Y'     to pm-city-st-zip-verified
 18102                    PERFORM 8102-REWRITE-ERPNDM
 18103                                 THRU 8102-EXIT
 18104                    move 'N'     to erpndm-unlock-sw
 18105           else
 18106              MOVE ER-3061       TO WS-ERROR
 18107              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 328
* EL050.cbl
 18108                                 THRU 9900-EXIT
 18109           end-if
 18110        end-if
 18111        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18112           MOVE ER-2883          TO WS-ERROR
 18113           PERFORM 9900-ERROR-FORMAT
 18114                                 THRU 9900-EXIT
 18115        END-IF
 18116        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18117           MOVE ' '                 TO STATE-RECORD-ERROR
 18118           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18119           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18120           MOVE '3'                 TO CNTL-REC-TYPE
 18121           MOVE +0                  TO CNTL-SEQ-NO
 18122           MOVE '0'                 TO RC-SW-2
 18123           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18124           IF NO-STATE-RECORD
 18125              OR (CF-RECORD-TYPE NOT = '3')
 18126              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18127              MOVE ER-2964          TO WS-ERROR
 18128              PERFORM 9900-ERROR-FORMAT
 18129                                    THRU 9900-EXIT
 18130           END-IF
 18131        END-IF
 18132     ELSE
 18133        IF NOT SKIP-ADDR-EDIT
 18134           MOVE ER-2393          TO WS-ERROR
 18135           PERFORM 9900-ERROR-FORMAT
 18136                                 THRU 9900-EXIT
 18137        END-IF
 18138     END-IF
 18139     if need-to-unlock-erpndm
 18140        perform 8104-unlock-erpndm
 18141                                 thru 8104-exit
 18142     end-if
 18143     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 18144
 18145     IF (ERMAIL-FOUND = ' ' AND
 18146        ERPNDM-FOUND = ' ')
 18147        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 18148           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18149           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18150          OR
 18151           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18152          OR
 18153           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18154           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18155           GO TO 3999-UNLOCK-ERMAIL.
 18156
 18157     IF ERPNDM-FOUND = 'X'
 18158        GO TO 3999-UNLOCK-ERMAIL.
 18159
 18160     IF PM-INSURED-LAST-NAME      = SPACES
 18161        AND PM-INSURED-FIRST-NAME = SPACES
 18162        AND PM-ADDRESS-LINE-1     = SPACES
 18163        AND PM-ADDRESS-LINE-2     = SPACES
 18164        AND PM-CITY-STATE         = SPACES
 18165        AND PM-CRED-BENE-NAME     = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 329
* EL050.cbl
 18166        AND PM-CRED-BENE-ADDR     = SPACES
 18167        AND PM-CRED-BENE-CTYST    = SPACES
 18168        GO TO 3999-UNLOCK-ERMAIL
 18169     END-IF
 18170
 18171     MOVE SPACES                 TO MAILING-DATA.
 18172
 18173     MOVE 'MA'                   TO MA-RECORD-ID.
 18174     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18175     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18176     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18177     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18178     MOVE PB-SV-STATE            TO MA-STATE.
 18179     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18180     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18181
 18182     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18183     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18184
 18185     IF ERMAIL-FOUND = ' '
 18186        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18187     ELSE
 18188        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18189        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18190        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18191
 18192     GO TO 9990-RETURN.
 18193
 18194 3999-UNLOCK-ERMAIL.
 18195     IF ERMAIL-FOUND = ' '
 18196        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18197
 18198     GO TO 9990-RETURN.
 18199******************************************************************
 18200
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 330
* EL050.cbl
 18202 4000-UPDATE-CANCELLED-CERT.
 18203     IF CERT-WAS-NOT-FOUND
 18204        GO TO 4299-EXIT.
 18205
 18206*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18207     IF PB-C-INT-ON-REFS > ZEROS
 18208        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18209     END-IF
 18210     IF PB-C-REF-INTERFACE-SW = 'Y'
 18211        MOVE PB-C-REF-INTERFACE-SW
 18212                                 TO CM-ref-INTERFACE-SW
 18213     END-IF
 18214*    IF ERMAIL-FOUND = ' '
 18215*       PERFORM 8140-UNLOCK-ERMAIL
 18216*                                THRU 8140-EXIT
 18217*    end-if
 18218     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18219     IF ERMAIL-FOUND = 'X'
 18220        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18221        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18222        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18223        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18224           MOVE ER-2694          TO WS-ERROR
 18225           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18226     END-IF
 18227
 18228     IF PB-C-POST-CARD-IND = 'Y'
 18229        MOVE +8                  TO SUB
 18230*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18231        IF ERMAIL-FOUND = ' '
 18232           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18233              (SUB > +7)
 18234              OR (MA-MAIL-STATUS (SUB) = '1')
 18235           END-PERFORM
 18236        END-IF
 18237        IF (SUB > +7)
 18238           OR (ERMAIL-FOUND = 'X')
 18239           MOVE ER-3789          TO WS-ERROR
 18240           PERFORM 9900-ERROR-FORMAT
 18241                                 THRU 9900-EXIT
 18242        END-IF
 18243     ELSE
 18244        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18245     END-IF
 18246
 18247     IF ERMAIL-FOUND = ' '
 18248        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18249     END-IF.
 18250
 18251     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18252
 18253     IF PB-CI-OB-FLAG = 'Z'
 18254        GO TO 4150-SUMMARY-CERT-CANCEL.
 18255
 18256     IF PB-C-LF-CANCEL-VOIDED
 18257         PERFORM 4200-REVERSE-LF-CANCEL.
 18258     IF PB-C-AH-CANCEL-VOIDED
 18259         PERFORM 4200-REVERSE-AH-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 331
* EL050.cbl
 18260
 18261 4100-APPLY-LF-CANCEL.
 18262
 18263     MOVE +0                     TO WS-SUB.
 18264
 18265 4100-CHECK-LF-ERRORS.
 18266
 18267     ADD +1                       TO WS-SUB.
 18268
 18269     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18270        IF LF-COVERAGE-CANCELLED
 18271           GO TO 4100-LF-CANCEL-CONT
 18272        ELSE
 18273           GO TO 4100-UPDATE-LF-COVERAGE.
 18274
 18275     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18276                                   ER-2729 OR
 18277                                   ER-2730 OR
 18278                                   ER-2731 OR
 18279                                   ER-2732 OR
 18280                                   ER-2737 OR
 18281                                   ER-2740 OR
 18282                                   ER-2743 OR
 18283                                   ER-2749 OR
 18284                                   ER-2750 OR
 18285                                   ER-2755 OR
 18286                                   ER-2757 OR
 18287                                   ER-2760 OR
 18288                                   ER-2772 OR
 18289                                   ER-2774 OR
 18290                                   ER-2776 OR
 18291                                   ER-2794
 18292        GO TO 4100-UPDATE-LF-COVERAGE.
 18293
 18294     GO TO 4100-CHECK-LF-ERRORS.
 18295
 18296 4100-UPDATE-LF-COVERAGE.
 18297
 18298     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18299     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18300     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18301        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18302     END-IF
 18303     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18304                                      TO CM-CREDIT-INTERFACE-SW-2.
 18305     IF CM-LF-CANCEL-DT = LOW-VALUE
 18306         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18307
 18308     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18309         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18310                                         CM-LF-STATUS-AT-CANCEL.
 18311
 18312     GO TO 4100-APPLY-AH-CANCEL.
 18313
 18314 4100-LF-CANCEL-CONT.
 18315     IF PB-C-LF-CANCEL-VOIDED
 18316         GO TO 4100-APPLY-AH-CANCEL.
 18317
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 332
* EL050.cbl
 18318     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18319         GO TO 4100-APPLY-AH-CANCEL.
 18320
 18321     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18322        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18323           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18324        ELSE
 18325           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18326
 18327     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18328     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18329
 18330     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18331         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18332
 18333     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18334        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18335         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18336         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18337
 18338     IF PB-RECORD-RETURNED
 18339        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18340      ELSE
 18341        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18342
 18343 4100-APPLY-AH-CANCEL.
 18344
 18345     MOVE +0                      TO WS-SUB.
 18346
 18347 4100-CHECK-AH-ERRORS.
 18348
 18349     ADD +1                       TO WS-SUB.
 18350
 18351     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18352        IF AH-COVERAGE-CANCELLED
 18353           GO TO 4100-AH-CANCEL-CONT
 18354        ELSE
 18355           GO TO 4100-UPDATE-AH-COVERAGE.
 18356
 18357     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18358                                   ER-2729 OR
 18359                                   ER-2732 OR
 18360                                   ER-2737 OR
 18361                                   ER-2740 OR
 18362                                   ER-2744 OR
 18363                                   ER-2749 OR
 18364                                   ER-2750 OR
 18365                                   ER-2755 OR
 18366                                   ER-2757 OR
 18367                                   ER-2760 OR
 18368                                   ER-2771 OR
 18369                                   ER-2772 OR
 18370                                   ER-2773 OR
 18371                                   ER-2775 OR
 18372                                   ER-2777 OR
 18373                                   ER-2778 OR
 18374                                   ER-2794
 18375        GO TO 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 333
* EL050.cbl
 18376
 18377     GO TO 4100-CHECK-AH-ERRORS.
 18378
 18379 4100-UPDATE-AH-COVERAGE.
 18380
 18381     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18382     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18383     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18384     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18385                                      TO CM-CREDIT-INTERFACE-SW-2.
 18386     IF CM-AH-CANCEL-DT = LOW-VALUE
 18387         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18388
 18389     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18390         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18391                                         CM-AH-STATUS-AT-CANCEL.
 18392
 18393     IF LF-COVERAGE-CANCELLED
 18394         IF PB-RECORD-RETURNED
 18395              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18396          ELSE
 18397              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18398
 18399     GO TO 4299-EXIT.
 18400
 18401 4100-AH-CANCEL-CONT.
 18402     IF PB-C-AH-CANCEL-VOIDED
 18403         GO TO 4299-EXIT.
 18404
 18405     if cm-credit-interface-sw-2 = ' '
 18406        if pb-fatal-errors or pb-unforced-errors
 18407           move '4'              to cm-credit-interface-sw-2
 18408        else
 18409           move '1'              to cm-credit-interface-sw-2
 18410        end-if
 18411     end-if
 18412     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18413         GO TO 4299-EXIT.
 18414
 18415     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18416        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18417           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18418        ELSE
 18419           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18420
 18421     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18422     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18423
 18424     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18425         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18426
 18427     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18428         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18429         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18430
 18431     IF PB-RECORD-RETURNED
 18432        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18433      ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 334
* EL050.cbl
 18434        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18435
 18436     GO TO 4299-EXIT.
 18437
 18438 4150-SUMMARY-CERT-CANCEL.
 18439     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18440
 18441     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18442        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18443                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18444     ELSE
 18445        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18446                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18447
 18448     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18449        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18450                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18451     ELSE
 18452        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18453                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18454
 18455     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18456        NEXT SENTENCE
 18457     ELSE
 18458        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18459
 18460     GO TO 4299-EXIT.
 18461
 18462 4200-REVERSE-LF-CANCEL.
 18463     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18464
 18465     IF CM-LF-CANCEL-APPLIED
 18466        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18467        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18468        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 18469
 18470     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18471
 18472     IF PB-RECORD-RETURNED
 18473        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18474       ELSE
 18475        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18476
 18477 4200-REVERSE-LF-EXIT.
 18478       EXIT.
 18479
 18480 4200-REVERSE-AH-CANCEL.
 18481     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18482
 18483     IF CM-AH-CANCEL-APPLIED
 18484        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18485        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18486        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18487
 18488     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18489
 18490     IF PB-RECORD-RETURNED
 18491        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 335
* EL050.cbl
 18492       ELSE
 18493        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18494
 18495 4200-REVERSE-AH-EXIT.
 18496       EXIT.
 18497
 18498 4299-EXIT.
 18499       EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 336
* EL050.cbl
 18501
 18502 4500-UPDATE-NEW-CERT.
 18503     IF CERT-WAS-FOUND
 18504         NEXT SENTENCE
 18505       ELSE
 18506         GO TO 4520-BUILD-NEW-KEY.
 18507
 18508     IF  CLASIC-CREATED-CERT
 18509         GO TO 4999-EXIT.
 18510
 18511     IF  CERT-WAS-CREATED-FOR-CLAIM
 18512         GO TO 4520-BUILD-NEW-KEY.
 18513
 18514     IF CERT-ADDED-BATCH
 18515        IF CM-RECORD-ID = 'CM'
 18516            GO TO 4999-EXIT.
 18517
 18518 4520-BUILD-NEW-KEY.
 18519* BUILD CONTROL PRIMARY
 18520
 18521     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18522                                       CM-COMPANY-CD-A1
 18523                                       CM-COMPANY-CD-A2
 18524                                       CM-COMPANY-CD-A4
 18525                                       CM-COMPANY-CD-A5.
 18526
 18527     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18528     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18529     MOVE PB-SV-STATE               TO CM-STATE.
 18530     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18531     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18532     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18533     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18534
 18535     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18536
 18537     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18538     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18539     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18540     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18541
 18542     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18543        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18544
 18545     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18546         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18547         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18548         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18549         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18550     ELSE
 18551         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18552
 18553     IF PB-COMPANY-ID   EQUAL  'CRI'
 18554         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18555         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18556         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18557         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18558         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 337
* EL050.cbl
 18559
 18560     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18561        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18562         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18563
 18564     IF PB-COMPANY-ID  = 'LBL'
 18565        IF PB-I-JOINT-COVERAGE
 18566            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18567                                           PB-I-MEMBER-NO
 18568            GO TO 4550-CONT-CERT-PROCESS.
 18569
 18570     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18571        NEXT SENTENCE
 18572     ELSE
 18573        GO TO 4540-BUILD-MEMBER-NO.
 18574
 18575******************************************************************
 18576*                                                                *
 18577*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18578*    FOR 'MON'.                                                  *
 18579*                                                                *
 18580******************************************************************
 18581
 18582     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18583     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18584     MOVE +1                     TO WS-SUB1
 18585                                    WS-SUB2.
 18586
 18587 4530-EDIT-MEMB-NAME.
 18588
 18589     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18590        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18591        ADD +1                       TO WS-SUB2.
 18592
 18593     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18594        ADD +1                       TO WS-SUB1
 18595        GO TO 4530-EDIT-MEMB-NAME.
 18596
 18597     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18598     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18599     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18600*    MOVE SPACE                      TO DC-OPTION-CODE.
 18601     SET  BIN-TO-GREG                TO TRUE.
 18602     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18603     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18604
 18605     GO TO 4550-CONT-CERT-PROCESS.
 18606
 18607******************************************************************
 18608*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18609******************************************************************
 18610
 18611 4540-BUILD-MEMBER-NO.
 18612
 18613     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18614         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18615         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18616         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 338
* EL050.cbl
 18617         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18618     ELSE
 18619         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18620
 18621     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18622        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18623         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18624
 18625 4550-CONT-CERT-PROCESS.
 18626
 18627*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18628*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18629*    ELSE
 18630*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18631
 18632     IF CERT-WAS-CREATED-FOR-CLAIM
 18633        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18634        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18635
 18636     IF CERT-AND-CLAIM-ONLINE
 18637        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18638        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18639
 18640     MOVE 'CM'                     TO CM-RECORD-ID.
 18641     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18642
 18643     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18644        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18645        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18646     ELSE
 18647        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18648        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18649
 18650     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18651     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18652     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18653     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18654     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18655     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18656     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18657                                      CM-LF-ITD-CANCEL-AMT
 18658                                      CM-LF-ITD-DEATH-AMT
 18659                                      CM-AH-ITD-AH-PMT
 18660                                      CM-AH-ITD-LUMP-PMT
 18661                                      CM-AH-ITD-CANCEL-AMT
 18662                                      CM-LF-NSP-PREMIUM-AMT
 18663                                      CM-AH-NSP-PREMIUM-AMT.
 18664*                                     CM-CLAIM-DEDUCT-WITHHELD
 18665*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18666     if pb-i-loan-apr = +99.9999
 18667        move zeros                 to cm-loan-apr
 18668     else
 18669        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18670     end-if
 18671     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18672     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18673     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18674     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 339
* EL050.cbl
 18675     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18676     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18677     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18678     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18679     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18680     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18681     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18682
 18683     IF PB-I-LIVES NOT NUMERIC
 18684         MOVE ZERO                 TO PB-I-LIVES.
 18685
 18686     IF PB-I-NUM-BILLED NOT NUMERIC
 18687         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18688
 18689     MOVE PB-I-LIVES               TO CM-LIVES.
 18690     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18691
 18692     IF PB-COMPANY-ID EQUAL  'DMD'
 18693         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18694         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18695
 18696     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18697     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18698     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18699     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18700     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18701     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18702
 18703     IF PB-I-LF-POLICY-FEE NUMERIC
 18704        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18705     ELSE
 18706        MOVE +0                    TO CM-LF-POLICY-FEE.
 18707
 18708     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18709        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18710        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18711     ELSE
 18712        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18713
 18714     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18715     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18716     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18717     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18718     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18719     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18720     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18721     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18722     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18723
 18724     IF PB-I-CANCEL-FEE NUMERIC
 18725        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18726     ELSE
 18727        MOVE +0                  TO CM-CANCEL-FEE
 18728     END-IF
 18729
 18730     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18731        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18732     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 340
* EL050.cbl
 18733        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18734
 18735     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18736     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18737
 18738     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18739                                      CM-LF-DEATH-EXIT-DT
 18740                                      CM-AH-SETTLEMENT-EXIT-DT.
 18741
 18742*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18743*                       'TIH' OR 'OFL' OR 'FLA' OR
 18744*                       'TII' OR 'TMS' OR 'CRI' OR
 18745*                       'NCL'
 18746     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18747
 18748     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18749         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18750            MOVE '2'                TO CM-PREMIUM-TYPE.
 18751
 18752     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18753         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18754            MOVE '2'                TO CM-PREMIUM-TYPE.
 18755
 18756     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18757         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18758     ELSE
 18759         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18760         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18761
 18762     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18763     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18764     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18765     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18766     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18767     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18768     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18769     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18770
 18771     IF PB-NO-MONTHS-SKIPPED
 18772         MOVE SPACE                 TO CM-SKIP-CODE
 18773     ELSE
 18774         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18775
 18776     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18777     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18778                                       CM-LF-STATUS-AT-CANCEL.
 18779
 18780     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18781     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18782                                       CM-AH-STATUS-AT-CANCEL.
 18783
 18784     MOVE '1'                       TO CM-ENTRY-STATUS.
 18785
 18786     IF PB-REISSUED-CERT
 18787        MOVE '5'                    TO CM-ENTRY-STATUS.
 18788
 18789     IF PB-MONTHLY-CERT
 18790        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 341
* EL050.cbl
 18791
 18792     IF PB-CASH-CERT
 18793        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18794
 18795     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18796     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18797     IF PB-POLICY-IS-DECLINED
 18798        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18799
 18800     IF PB-POLICY-IS-VOIDED
 18801        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18802
 18803     IF PB-NEEDS-UNDERWRITING
 18804        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18805
 18806     IF PB-REIN-ONLY-CERT
 18807        MOVE '9'                    TO CM-ENTRY-STATUS.
 18808
 18809     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18810         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18811     ELSE
 18812         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18813
 18814     IF PB-RECORD-RETURNED
 18815        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18816      ELSE
 18817        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18818
 18819     IF PB-I-MAIL-ADDRS-PRESENT
 18820        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18821
 18822     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18823                                       CM-ENTRY-DT.
 18824
 18825 4999-EXIT.
 18826     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 342
* EL050.cbl
 18828
 18829 5000-PROCESS-REPS.
 18830     MOVE ' '                    TO AGTC-MASTER-SW
 18831     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18832     MOVE CO-TYPE                TO AGTC-TYPE
 18833     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18834     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18835     IF (AGTC-MASTER-SW NOT = 'N')
 18836        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18837        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18838        PERFORM 8583-READ-ERAGTC-NEXT
 18839                                 THRU 8583-EXIT
 18840     END-IF
 18841     IF AGTC-MASTER-SW = 'N'
 18842        CONTINUE
 18843     ELSE
 18844        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18845           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18846              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18847              MOVE 'Y'           TO AGTC-MASTER-SW
 18848           END-IF
 18849        END-IF
 18850     END-IF
 18851     .
 18852 5000-EXIT.
 18853     EXIT.
 18854 6370-EDIT-INPUT-LF-CODE.
 18855     move ' ' to ws-benefit-cd-chg-sw
 18856     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18857        MOVE +1                  TO SUB
 18858        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18859        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18860        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18861        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18862        GO TO 6370-SEARCH-LOOP.
 18863
 18864     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18865
 18866     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18867     MOVE SPACES                 TO CNTL-ACCESS.
 18868*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18869     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18870     MOVE +0                     TO CNTL-SEQ-NO.
 18871     MOVE '4' TO RC-SW-2.
 18872     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18873
 18874     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18875        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18876        GO TO 6370-NO-LF-FOUND.
 18877
 18878     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18879     MOVE +1                     TO SUB.
 18880
 18881 6370-SEARCH-LOOP.
 18882     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18883         GO TO 6370-NO-LF-FOUND.
 18884
 18885     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 343
* EL050.cbl
 18886        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18887           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18888           set benefit-code-chg to true
 18889        end-if
 18890        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18891        GO TO 6370-HER-NET-PAY-CHECK.
 18892
 18893     ADD 1   TO SUB.
 18894*    IF SUB GREATER 120
 18895     IF SUB GREATER 200
 18896         GO TO 6370-NO-LF-FOUND.
 18897
 18898     GO TO 6370-SEARCH-LOOP.
 18899
 18900 6370-NO-LF-FOUND.
 18901
 18902     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18903        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18904        set benefit-code-chg to true
 18905     end-if
 18906     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18907
 18908 6370-HER-NET-PAY-CHECK.
 18909
 18910     IF PB-COMPANY-ID = 'CID'
 18911        IF PB-SV-STATE = 'CA' OR 'MN'
 18912           IF PB-I-LF-BENEFIT-CD = '02'
 18913              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18914           ELSE
 18915              IF PB-I-LF-BENEFIT-CD = '04'
 18916                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18917              END-IF
 18918           END-IF
 18919        END-IF
 18920     END-IF
 18921
 18922     IF PB-COMPANY-ID NOT = 'HER'
 18923         GO TO 6370-EXIT.
 18924
 18925     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18926         GO TO 6370-EXIT.
 18927
 18928     IF PB-I-LF-TERM NOT NUMERIC
 18929         MOVE ZEROS              TO PB-I-LF-TERM.
 18930
 18931     IF PB-I-LOAN-TERM NOT NUMERIC
 18932         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18933
 18934     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18935         GO TO 6370-EXIT.
 18936
 18937     IF PB-I-LF-BENEFIT-CD = '33'
 18938         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18939
 18940     IF PB-I-LF-BENEFIT-CD = '34'
 18941         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18942
 18943 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 344
* EL050.cbl
 18944     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 345
* EL050.cbl
 18946
 18947 6380-EDIT-INPUT-AH-CODE.
 18948     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18949        MOVE +1                  TO SUB
 18950        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18951        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18952        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18953        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18954        GO TO 6380-SEARCH-LOOP.
 18955
 18956     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18957
 18958     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18959     MOVE SPACES                 TO CNTL-ACCESS.
 18960     MOVE 'A'                    TO CNTL-REC-TYPE.
 18961*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18962     MOVE +0                     TO CNTL-SEQ-NO.
 18963     MOVE '5' TO RC-SW-2.
 18964     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18965
 18966     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18967        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18968        GO TO 6380-NO-AH-FOUND.
 18969
 18970     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18971     MOVE +1 TO SUB.
 18972
 18973 6380-SEARCH-LOOP.
 18974     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18975         GO TO 6380-NO-AH-FOUND.
 18976
 18977     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18978         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18979         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18980
 18981     ADD 1   TO SUB.
 18982     IF SUB GREATER THAN 96
 18983*    IF SUB GREATER THAN 300
 18984         GO TO 6380-NO-AH-FOUND.
 18985
 18986     GO TO 6380-SEARCH-LOOP.
 18987
 18988 6380-NO-AH-FOUND.
 18989
 18990     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18991
 18992     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18993         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18994     ELSE
 18995         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18996
 18997 6380-CSO-AH-ONLY-CHECKS.
 18998
 18999     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 19000        NEXT SENTENCE
 19001      ELSE
 19002        GO TO 6380-EXIT.
 19003
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 346
* EL050.cbl
 19004     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 19005         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 19006
 19007
 19008     GO TO 6380-EXIT
 19009     .
 19010 6380-CSO-LIFE-WITH-AH-CHECKS.
 19011
 19012
 19013     .
 19014 6380-EXIT.
 19015     EXIT.
 19016
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 347
* EL050.cbl
 19018
 19019 6400-COMPUTE-EXTENSION-DAYS.
 19020
 19021******************************************************************
 19022*                                                                *
 19023*                   COMPUTE EXTENSION DAYS                       *
 19024*                                                                *
 19025*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 19026*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 19027*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 19028*    THE EXTENSION DAYS.                                         *
 19029*                                                                *
 19030******************************************************************
 19031
 19032     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 19033     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 19034
 19035******************************************************************
 19036*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 19037*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 19038******************************************************************
 19039
 19040     IF DC-ELAPSED-MONTHS GREATER THAN +0
 19041        COMPUTE WS-ODD-DAYS-OVER =
 19042               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 19043     ELSE
 19044        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 19045
 19046     IF WS-ODD-DAYS-OVER = ZEROS
 19047           GO TO 6499-EXIT
 19048     ELSE
 19049        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 19050           IF WS-WDF-MONTH = 02
 19051              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 19052              ADD 2       TO  WS-ODD-DAYS-OVER
 19053              GO TO 6499-EXIT
 19054           ELSE
 19055              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 19056                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 19057                 GO TO 6499-EXIT
 19058               ELSE
 19059                 GO TO 6499-EXIT
 19060        ELSE
 19061           GO TO 6499-EXIT.
 19062
 19063 6412-CHECK-TO-DAY.
 19064
 19065        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 19066           IF WS-WDT-DAY = 28
 19067              ADD 2              TO WS-ODD-DAYS-OVER
 19068           ELSE
 19069              IF WS-WDT-DAY = 29
 19070                 ADD 1           TO WS-ODD-DAYS-OVER
 19071              ELSE
 19072                 NEXT SENTENCE
 19073        ELSE
 19074           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 19075              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 348
* EL050.cbl
 19076
 19077     GO TO 6499-EXIT.
 19078
 19079
 19080 6415-CHECK-LEAP-YEAR.
 19081
 19082     IF DC-DAYS-IN-MONTH = 29
 19083        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 19084
 19085 6415-EXIT.
 19086     EXIT.
 19087
 19088 6499-EXIT.
 19089      EXIT.
 19090
 19091 6500-END.
 19092     EXIT.
 19093
 19094
 19095******************************************************************
 19096************* PROCEDURE DIVISION FOR EL050 ***********************
 19097********************** ELC50PD END *******************************
 19098
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 349
* EL050.cbl
 19100
 19101**START***********************************************************
 19102*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 19103*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 19104******************************************************************
 19105*
 19106 6600-GET-STATE-MUNICIPAL-TAX.
 19107
 19108     IF PB-COMPANY-ID NOT = 'DMD'
 19109         GO TO 6640-EXIT.
 19110
 19111     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19112     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19113     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19114*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19115*
 19116***  Y2K PROJ 7744
 19117     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19118     SET BIN-TO-GREG          TO TRUE.
 19119     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19120
 19121     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19122
 19123     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19124     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 19125
 19126
 19127* EXEC CICS HANDLE CONDITION
 19128*        INVREQ    (6610-START-BROWSE)
 19129*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19130*        NOTFND    (6630-END-OF-FILE)
 19131*    END-EXEC.
 19132*    MOVE '"$8JI                 ! # #00019116' TO DFHEIV0
 19133     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 19134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19135     MOVE X'2320233030303139313136' TO DFHEIV0(25:11)
 19136     CALL 'kxdfhei1' USING DFHEIV0
 19137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19138
 19139
 19140 6610-START-BROWSE.
 19141
 19142
 19143* EXEC CICS HANDLE CONDITION
 19144*        NOTFND    (6630-END-OF-FILE)
 19145*        DISABLED  (6630-ERRESS-PROBLEM)
 19146*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19147*        ENDFILE   (6630-END-OF-FILE)
 19148*    END-EXEC.
 19149*    MOVE '"$IcJ''                ! $ #00019124' TO DFHEIV0
 19150     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19152     MOVE X'2420233030303139313234' TO DFHEIV0(25:11)
 19153     CALL 'kxdfhei1' USING DFHEIV0
 19154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19155
 19156
 19157
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 350
* EL050.cbl
 19158* EXEC CICS STARTBR
 19159*        DATASET (FILE-ID-ERRESS)
 19160*        RIDFLD  (WS-ERRESS-KEY)
 19161*        GTEQ
 19162*    END-EXEC.
 19163     MOVE 0
 19164       TO DFHEIV11
 19165*    MOVE '&,         G          &   #00019131' TO DFHEIV0
 19166     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19167     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19168     MOVE X'2020233030303139313331' TO DFHEIV0(25:11)
 19169     CALL 'kxdfhei1' USING DFHEIV0,
 19170           FILE-ID-ERRESS,
 19171           WS-ERRESS-KEY,
 19172           DFHEIV99,
 19173           DFHEIV11,
 19174           DFHEIV99
 19175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19176
 19177
 19178 6620-READ-NEXT-ERRESS-MASTER.
 19179
 19180
 19181* EXEC CICS HANDLE CONDITION
 19182*        NOTFND    (6630-END-OF-FILE)
 19183*        ENDFILE   (6630-END-OF-FILE)
 19184*        DISABLED  (6630-ERRESS-PROBLEM)
 19185*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19186*    END-EXEC.
 19187*    MOVE '"$I''cJ                ! % #00019139' TO DFHEIV0
 19188     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19190     MOVE X'2520233030303139313339' TO DFHEIV0(25:11)
 19191     CALL 'kxdfhei1' USING DFHEIV0
 19192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19193
 19194
 19195
 19196* EXEC CICS READNEXT
 19197*        DATASET (FILE-ID-ERRESS)
 19198*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19199*        RIDFLD  (WS-ERRESS-KEY)
 19200*    END-EXEC.
 19201     MOVE LENGTH OF
 19202      RESIDENT-STATE-TAX-MASTER
 19203       TO DFHEIV12
 19204     MOVE 0
 19205       TO DFHEIV11
 19206*    MOVE '&.IL                  )   #00019146' TO DFHEIV0
 19207     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19208     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19209     MOVE X'2020233030303139313436' TO DFHEIV0(25:11)
 19210     CALL 'kxdfhei1' USING DFHEIV0,
 19211           FILE-ID-ERRESS,
 19212           RESIDENT-STATE-TAX-MASTER,
 19213           DFHEIV12,
 19214           WS-ERRESS-KEY,
 19215           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 351
* EL050.cbl
 19216           DFHEIV11,
 19217           DFHEIV99,
 19218           DFHEIV99
 19219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19220
 19221
 19222     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19223
 19224* EXEC CICS ENDBR
 19225*            DATASET (FILE-ID-ERRESS)
 19226*       END-EXEC
 19227     MOVE 0
 19228       TO DFHEIV11
 19229*    MOVE '&2                    $   #00019153' TO DFHEIV0
 19230     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19231     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19232     MOVE X'2020233030303139313533' TO DFHEIV0(25:11)
 19233     CALL 'kxdfhei1' USING DFHEIV0,
 19234           FILE-ID-ERRESS,
 19235           DFHEIV11,
 19236           DFHEIV99
 19237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19238        GO TO 6630-END-OF-FILE.
 19239
 19240     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19241        NEXT SENTENCE
 19242      ELSE
 19243        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19244
 19245*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19246*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19247*
 19248     MOVE +2                     TO WS-SUB1.
 19249
 19250     IF PB-ISSUE
 19251     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19252        MOVE +1                  TO WS-SUB1.
 19253
 19254     IF PB-CANCELLATION
 19255     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19256        MOVE +1                  TO WS-SUB1.
 19257*
 19258*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19259*
 19260***  Y2K PROJ 7744
 19261     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19262***  Y2K PROJ 7744
 19263
 19264*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19265* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19266* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19267
 19268     ADD 1                    TO WS-YEAR-YY.
 19269
 19270     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19271         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19272                              TO WS-RES-STATE-TAX
 19273         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 352
* EL050.cbl
 19274                              TO WS-RES-MUNI-TAX
 19275     ELSE
 19276         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19277                              TO WS-RES-STATE-TAX
 19278         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19279                              TO WS-RES-MUNI-TAX.
 19280
 19281*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19282
 19283     IF PB-CANCELLATION
 19284         GO TO 6640-CANCEL-TAX.
 19285
 19286     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19287         COMPUTE PB-I-STATE-TAX ROUNDED =
 19288                                   PB-I-LF-PREMIUM-AMT
 19289                                 * WS-RES-STATE-TAX
 19290         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19291                                   PB-I-LF-PREMIUM-AMT
 19292                                 * WS-RES-MUNI-TAX
 19293     ELSE
 19294     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19295         COMPUTE PB-I-STATE-TAX ROUNDED =
 19296                                   PB-I-AH-PREMIUM-AMT
 19297                                 * WS-RES-STATE-TAX
 19298         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19299                                   PB-I-AH-PREMIUM-AMT
 19300                                 * WS-RES-MUNI-TAX.
 19301
 19302
 19303* EXEC CICS ENDBR
 19304*         DATASET (FILE-ID-ERRESS)
 19305*    END-EXEC.
 19306     MOVE 0
 19307       TO DFHEIV11
 19308*    MOVE '&2                    $   #00019220' TO DFHEIV0
 19309     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19310     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19311     MOVE X'2020233030303139323230' TO DFHEIV0(25:11)
 19312     CALL 'kxdfhei1' USING DFHEIV0,
 19313           FILE-ID-ERRESS,
 19314           DFHEIV11,
 19315           DFHEIV99
 19316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19317
 19318
 19319     GO TO 6640-EXIT.
 19320
 19321 6640-CANCEL-TAX.
 19322     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19323
 19324     IF PB-C-LF-CANCEL-AMT > ZEROS
 19325         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19326                                   PB-C-LF-CANCEL-AMT
 19327                                 * WS-RES-STATE-TAX
 19328         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19329                                   PB-C-LF-CANCEL-AMT
 19330                                *  WS-RES-MUNI-TAX
 19331     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 353
* EL050.cbl
 19332     IF PB-C-AH-CANCEL-AMT > ZEROS
 19333         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19334                                   PB-C-AH-CANCEL-AMT
 19335                                 * WS-RES-STATE-TAX
 19336         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19337                                   PB-C-AH-CANCEL-AMT
 19338                                *  WS-RES-MUNI-TAX.
 19339
 19340
 19341* EXEC CICS ENDBR
 19342*         DATASET (FILE-ID-ERRESS)
 19343*    END-EXEC.
 19344     MOVE 0
 19345       TO DFHEIV11
 19346*    MOVE '&2                    $   #00019245' TO DFHEIV0
 19347     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19348     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19349     MOVE X'2020233030303139323435' TO DFHEIV0(25:11)
 19350     CALL 'kxdfhei1' USING DFHEIV0,
 19351           FILE-ID-ERRESS,
 19352           DFHEIV11,
 19353           DFHEIV99
 19354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19355
 19356
 19357     GO TO 6640-EXIT.
 19358
 19359 6630-END-OF-FILE.
 19360     MOVE ER-8002              TO WS-ERROR.
 19361     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19362
 19363     GO TO 6640-EXIT.
 19364
 19365 6630-ERRESS-PROBLEM.
 19366     MOVE ER-8044              TO WS-ERROR.
 19367     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19368
 19369 6640-EXIT.
 19370     EXIT.
 19371
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 354
* EL050.cbl
 19373 6650-GET-RES-STATE-COMM.
 19374
 19375     IF PB-COMPANY-ID NOT = 'DMD'
 19376         GO TO 6700-COMM-EXIT.
 19377
 19378     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19379     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19380     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19381     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19382     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19383     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19384     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19385
 19386*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19387*
 19388***  Y2K PROJ 7744
 19389     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19390     SET BIN-TO-GREG          TO TRUE.
 19391     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19392
 19393     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19394***  Y2K PROJ 7744
 19395
 19396     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19397
 19398
 19399* EXEC CICS HANDLE CONDITION
 19400*        INVREQ    (6660-START-BROWSE)
 19401*        DISABLED  (6690-ERRESC-PROBLEM)
 19402*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19403*        NOTFND    (6690-END-OF-FILE)
 19404*    END-EXEC.
 19405*    MOVE '"$8cJI                ! & #00019290' TO DFHEIV0
 19406     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19407     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19408     MOVE X'2620233030303139323930' TO DFHEIV0(25:11)
 19409     CALL 'kxdfhei1' USING DFHEIV0
 19410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19411
 19412
 19413
 19414* EXEC CICS RESETBR
 19415*        DATASET (FILE-ID-ERRESC)
 19416*        RIDFLD  (WS-ERRESC-KEY)
 19417*    END-EXEC.
 19418     MOVE 0
 19419       TO DFHEIV11
 19420*    MOVE '&4         G          &   #00019297' TO DFHEIV0
 19421     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19422     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19423     MOVE X'2020233030303139323937' TO DFHEIV0(25:11)
 19424     CALL 'kxdfhei1' USING DFHEIV0,
 19425           FILE-ID-ERRESC,
 19426           WS-ERRESC-KEY,
 19427           DFHEIV99,
 19428           DFHEIV11,
 19429           DFHEIV99
 19430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 355
* EL050.cbl
 19431
 19432
 19433 6660-START-BROWSE.
 19434
 19435
 19436* EXEC CICS HANDLE CONDITION
 19437*        NOTFND    (6690-END-OF-FILE)
 19438*        DISABLED  (6690-ERRESC-PROBLEM)
 19439*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19440*        ENDFILE   (6690-END-OF-FILE)
 19441*    END-EXEC.
 19442*    MOVE '"$IcJ''                ! '' #00019304' TO DFHEIV0
 19443     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19445     MOVE X'2720233030303139333034' TO DFHEIV0(25:11)
 19446     CALL 'kxdfhei1' USING DFHEIV0
 19447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19448
 19449
 19450
 19451* EXEC CICS STARTBR
 19452*        DATASET (FILE-ID-ERRESC)
 19453*        RIDFLD  (WS-ERRESC-KEY)
 19454*        GTEQ
 19455*    END-EXEC.
 19456     MOVE 0
 19457       TO DFHEIV11
 19458*    MOVE '&,         G          &   #00019311' TO DFHEIV0
 19459     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19460     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19461     MOVE X'2020233030303139333131' TO DFHEIV0(25:11)
 19462     CALL 'kxdfhei1' USING DFHEIV0,
 19463           FILE-ID-ERRESC,
 19464           WS-ERRESC-KEY,
 19465           DFHEIV99,
 19466           DFHEIV11,
 19467           DFHEIV99
 19468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19469
 19470
 19471     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19472
 19473 6670-READ-NEXT-ERRESC-MASTER.
 19474
 19475
 19476* EXEC CICS HANDLE CONDITION
 19477*        NOTFND    (6690-END-OF-FILE)
 19478*        DISABLED  (6690-ERRESC-PROBLEM)
 19479*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19480*        ENDFILE   (6690-END-OF-FILE)
 19481*    END-EXEC.
 19482*    MOVE '"$IcJ''                ! ( #00019321' TO DFHEIV0
 19483     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19485     MOVE X'2820233030303139333231' TO DFHEIV0(25:11)
 19486     CALL 'kxdfhei1' USING DFHEIV0
 19487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19488
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 356
* EL050.cbl
 19489
 19490
 19491* EXEC CICS READNEXT
 19492*        DATASET (FILE-ID-ERRESC)
 19493*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19494*        RIDFLD  (ERRESC-RECORD-KEY)
 19495*    END-EXEC.
 19496     MOVE LENGTH OF
 19497      ACCOUNT-RESIDENT-ST-COMMISSION
 19498       TO DFHEIV12
 19499     MOVE 0
 19500       TO DFHEIV11
 19501*    MOVE '&.IL                  )   #00019328' TO DFHEIV0
 19502     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19503     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19504     MOVE X'2020233030303139333238' TO DFHEIV0(25:11)
 19505     CALL 'kxdfhei1' USING DFHEIV0,
 19506           FILE-ID-ERRESC,
 19507           ACCOUNT-RESIDENT-ST-COMMISSION,
 19508           DFHEIV12,
 19509           ERRESC-RECORD-KEY,
 19510           DFHEIV99,
 19511           DFHEIV11,
 19512           DFHEIV99,
 19513           DFHEIV99
 19514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19515
 19516
 19517     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19518        NEXT SENTENCE
 19519     ELSE
 19520
 19521* EXEC CICS ENDBR
 19522*            DATASET (FILE-ID-ERRESC)
 19523*       END-EXEC
 19524     MOVE 0
 19525       TO DFHEIV11
 19526*    MOVE '&2                    $   #00019337' TO DFHEIV0
 19527     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19528     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19529     MOVE X'2020233030303139333337' TO DFHEIV0(25:11)
 19530     CALL 'kxdfhei1' USING DFHEIV0,
 19531           FILE-ID-ERRESC,
 19532           DFHEIV11,
 19533           DFHEIV99
 19534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19535        GO TO 6690-END-OF-FILE.
 19536
 19537     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19538
 19539* EXEC CICS ENDBR
 19540*            DATASET (FILE-ID-ERRESC)
 19541*       END-EXEC
 19542     MOVE 0
 19543       TO DFHEIV11
 19544*    MOVE '&2                    $   #00019343' TO DFHEIV0
 19545     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19546     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 357
* EL050.cbl
 19547     MOVE X'2020233030303139333433' TO DFHEIV0(25:11)
 19548     CALL 'kxdfhei1' USING DFHEIV0,
 19549           FILE-ID-ERRESC,
 19550           DFHEIV11,
 19551           DFHEIV99
 19552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19553        GO TO 6690-END-OF-FILE.
 19554
 19555     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19556        NEXT SENTENCE
 19557      ELSE
 19558        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19559
 19560* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19561*
 19562     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19563
 19564     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19565
 19566     IF WS-SUB1 > ZERO
 19567         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19568             PERFORM 6680-SET-COMMISSION
 19569         ELSE
 19570             PERFORM 6680-SET-TABLE-CODE.
 19571
 19572
 19573* EXEC CICS ENDBR
 19574*         DATASET (FILE-ID-ERRESC)
 19575*    END-EXEC.
 19576     MOVE 0
 19577       TO DFHEIV11
 19578*    MOVE '&2                    $   #00019365' TO DFHEIV0
 19579     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19580     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19581     MOVE X'2020233030303139333635' TO DFHEIV0(25:11)
 19582     CALL 'kxdfhei1' USING DFHEIV0,
 19583           FILE-ID-ERRESC,
 19584           DFHEIV11,
 19585           DFHEIV99
 19586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19587
 19588
 19589     GO TO 6700-COMM-EXIT.
 19590
 19591 6680-SET-TABLE-CODE.
 19592     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19593        MOVE ZEROS             TO WS-SUB1
 19594     ELSE
 19595* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19596* TO COMPUTE AH COMMISSION.
 19597        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19598        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19599        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19600        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19601        PERFORM 6680-READ-CTBL-TABLE
 19602        IF WS-CTBL-READ-SW NOT = 'Y'
 19603           MOVE ZEROS          TO WS-SUB1.
 19604
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 358
* EL050.cbl
 19605 6680-READ-CTBL-TABLE.
 19606*
 19607* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19608* TO COMPUTE LIFE COMMISSION
 19609
 19610     IF CTBL-SW = '0540'
 19611        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19612        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19613        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19614
 19615     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19616
 19617     IF CTBL-TABLE-FOUND
 19618        IF CTBL-SW = '0530'
 19619             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19620                                    * PB-I-AH-TERM
 19621             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19622             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19623        ELSE
 19624             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19625             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19626             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19627     ELSE
 19628        IF FIRST-TIME-THROUGH
 19629            GO TO 6680-READ-CTBL-TABLE
 19630        ELSE
 19631            MOVE ZEROS         TO WS-SUB1.
 19632
 19633 6680-SET-COMMISSION.
 19634     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19635           MOVE ZEROS          TO WS-SUB1
 19636       ELSE
 19637           MOVE RESC-COMMISSION-PER (WS-SUB)
 19638                               TO WS-COMMISSION
 19639           IF CTBL-SW = '0530'
 19640               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19641           ELSE
 19642               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19643
 19644 6680-SEARCH-CATEGORY.
 19645     ADD +1                   TO WS-SUB.
 19646     IF WS-SUB > +12
 19647         GO TO 6680-EXIT.
 19648
 19649     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19650          MOVE WS-SUB         TO WS-SUB1
 19651          GO TO 6680-EXIT.
 19652
 19653     GO TO 6680-SEARCH-CATEGORY.
 19654
 19655 6680-EXIT.
 19656     EXIT.
 19657
 19658 6690-END-OF-FILE.
 19659     GO TO 6700-COMM-EXIT.
 19660
 19661 6690-ERRESC-PROBLEM.
 19662      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 359
* EL050.cbl
 19663      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19664
 19665      GO TO 6700-COMM-EXIT.
 19666
 19667 6700-COMM-EXIT.
 19668     EXIT.
 19669
 19670 7000-GET-RATE.
 19671
 19672* EXEC CICS LINK
 19673*        PROGRAM    ('ELRATE')
 19674*        COMMAREA   (CALCULATION-PASS-AREA)
 19675*        LENGTH     (CP-COMM-LENGTH)
 19676*    END-EXEC.
 19677     MOVE 'ELRATE' TO DFHEIV1
 19678*    MOVE '."C                   (   #00019451' TO DFHEIV0
 19679     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19680     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19681     MOVE X'2020233030303139343531' TO DFHEIV0(25:11)
 19682     CALL 'kxdfhei1' USING DFHEIV0,
 19683           DFHEIV1,
 19684           CALCULATION-PASS-AREA,
 19685           CP-COMM-LENGTH,
 19686           DFHEIV99,
 19687           DFHEIV99,
 19688           DFHEIV99,
 19689           DFHEIV99
 19690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19691
 19692
 19693 7000-EXIT.
 19694     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 360
* EL050.cbl
 19696 7100-FIND-BENEFIT-IN-STATE.
 19697     MOVE 'N'                    TO BEN-SEARCH-SW.
 19698
 19699     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19700         VARYING SUB3 FROM 1 BY 1 UNTIL
 19701            ((SUB3 GREATER 50) OR
 19702              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19703               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19704
 19705     IF SUB3 NOT = 51
 19706         MOVE 'Y'                TO BEN-SEARCH-SW.
 19707
 19708     GO TO 7199-EXIT.
 19709
 19710 7100-BENEFIT-DUMMY.
 19711
 19712 7100-DUMMY-EXIT.
 19713     EXIT.
 19714
 19715 7199-EXIT.
 19716     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 361
* EL050.cbl
 19718 7200-FIND-BENEFIT.
 19719     MOVE 'N'                    TO BEN-SEARCH-SW.
 19720
 19721     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19722         VARYING SUB3 FROM 1 BY 1 UNTIL
 19723            ((SUB3 GREATER 8) OR
 19724            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19725
 19726     IF SUB3 NOT = 9
 19727         MOVE 'Y'                TO BEN-SEARCH-SW.
 19728
 19729     GO TO 7200-EXIT.
 19730
 19731 7200-BENEFIT-DUMMY.
 19732
 19733 7200-DUMMY-EXIT.
 19734     EXIT.
 19735
 19736 7200-EXIT.
 19737     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 362
* EL050.cbl
 19739 7250-LOOK-FOR-RESCINDED-CLAIM.
 19740     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19741                                    W-CL-COMP-CD.
 19742     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19743                                    W-CL-CERT-NO.
 19744
 19745
 19746* EXEC CICS HANDLE CONDITION
 19747*        NOTFND  (7250-CONTINUE)
 19748*        ENDFILE (7250-CONTINUE)
 19749*    END-EXEC.
 19750*    MOVE '"$I''                  ! ) #00019509' TO DFHEIV0
 19751     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19752     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19753     MOVE X'2920233030303139353039' TO DFHEIV0(25:11)
 19754     CALL 'kxdfhei1' USING DFHEIV0
 19755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19756
 19757
 19758
 19759* EXEC CICS IGNORE CONDITION
 19760*        DUPKEY
 19761*    END-EXEC.
 19762*    MOVE '"*$                   !   #00019514' TO DFHEIV0
 19763     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19765     MOVE X'2020233030303139353134' TO DFHEIV0(25:11)
 19766     CALL 'kxdfhei1' USING DFHEIV0
 19767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19768
 19769
 19770
 19771* EXEC CICS STARTBR
 19772*        DATASET   (CLMS-ID)
 19773*        RIDFLD    (ELMSTR-KEY)
 19774*        GENERIC   EQUAL
 19775*        KEYLENGTH (ELMSTR-LENGTH)
 19776*    END-EXEC.
 19777     MOVE 0
 19778       TO DFHEIV11
 19779*    MOVE '&,   KG    E          &   #00019518' TO DFHEIV0
 19780     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19781     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19782     MOVE X'2020233030303139353138' TO DFHEIV0(25:11)
 19783     CALL 'kxdfhei1' USING DFHEIV0,
 19784           CLMS-ID,
 19785           ELMSTR-KEY,
 19786           ELMSTR-LENGTH,
 19787           DFHEIV11,
 19788           DFHEIV99
 19789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19790
 19791
 19792     MOVE 'Y'                    TO W-BROWSE-SW.
 19793
 19794 7250-NEXT-CLAIM.
 19795
 19796
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 363
* EL050.cbl
 19797* EXEC CICS READNEXT
 19798*        DATASET   (CLMS-ID)
 19799*        RIDFLD    (ELMSTR-KEY)
 19800*        SET       (ADDRESS OF CLAIM-MASTER)
 19801*    END-EXEC.
 19802     MOVE 0
 19803       TO DFHEIV11
 19804*    MOVE '&.S                   )   #00019529' TO DFHEIV0
 19805     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19806     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19807     MOVE X'2020233030303139353239' TO DFHEIV0(25:11)
 19808     CALL 'kxdfhei1' USING DFHEIV0,
 19809           CLMS-ID,
 19810           DFHEIV20,
 19811           DFHEIV99,
 19812           ELMSTR-KEY,
 19813           DFHEIV99,
 19814           DFHEIV11,
 19815           DFHEIV99,
 19816           DFHEIV99
 19817     SET ADDRESS OF CLAIM-MASTER TO
 19818         DFHEIV20
 19819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19820
 19821
 19822     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19823        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19824         GO TO 7250-CONTINUE
 19825     END-IF.
 19826
 19827     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19828        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19829        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19830        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19831        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19832         GO TO 7250-NEXT-CLAIM
 19833     END-IF.
 19834
 19835     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19836        OR (CL-CLAIM-TYPE = 'I')
 19837        OR (CL-CLAIM-TYPE = 'G')
 19838        OR (CL-CLAIM-TYPE = 'F')
 19839          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19840              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19841              GO TO 7250-CONTINUE
 19842          END-IF
 19843     END-IF.
 19844
 19845     GO TO 7250-NEXT-CLAIM.
 19846
 19847 7250-CONTINUE.
 19848
 19849     IF W-BROWSE-SW = 'Y'
 19850
 19851* EXEC CICS ENDBR
 19852*            DATASET   (CLMS-ID)
 19853*        END-EXEC
 19854     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 364
* EL050.cbl
 19855       TO DFHEIV11
 19856*    MOVE '&2                    $   #00019563' TO DFHEIV0
 19857     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19858     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19859     MOVE X'2020233030303139353633' TO DFHEIV0(25:11)
 19860     CALL 'kxdfhei1' USING DFHEIV0,
 19861           CLMS-ID,
 19862           DFHEIV11,
 19863           DFHEIV99
 19864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19865         MOVE 'N' TO W-BROWSE-SW
 19866     END-IF.
 19867
 19868 7250-EXIT.
 19869     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 365
* EL050.cbl
 19871 7300-CHECK-FOR-OPEN-CLMS.
 19872
 19873*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19874*    MOVE SPACES                 TO CNTL-ACCESS.
 19875*    MOVE '1'                    TO CNTL-REC-TYPE.
 19876*    MOVE +0                     TO CNTL-SEQ-NO.
 19877
 19878*    MOVE '3'                    TO RC-SW-1.
 19879*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19880
 19881*    IF NOT CF-COMPANY-MASTER
 19882*         PERFORM 0099-COMPANY-NOT-FOUND
 19883*         GO TO 7300-EXIT.
 19884
 19885     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19886                                    W-CL-COMP-CD.
 19887     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19888                                    W-CL-CERT-NO.
 19889
 19890
 19891* EXEC CICS HANDLE CONDITION
 19892*        NOTFND  (7300-CONTINUE)
 19893*        ENDFILE (7300-CONTINUE)
 19894*    END-EXEC.
 19895*    MOVE '"$I''                  ! * #00019591' TO DFHEIV0
 19896     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19898     MOVE X'2A20233030303139353931' TO DFHEIV0(25:11)
 19899     CALL 'kxdfhei1' USING DFHEIV0
 19900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19901
 19902
 19903
 19904* EXEC CICS IGNORE CONDITION
 19905*        DUPKEY
 19906*    END-EXEC.
 19907*    MOVE '"*$                   !   #00019596' TO DFHEIV0
 19908     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19909     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19910     MOVE X'2020233030303139353936' TO DFHEIV0(25:11)
 19911     CALL 'kxdfhei1' USING DFHEIV0
 19912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19913
 19914
 19915
 19916* EXEC CICS STARTBR
 19917*        DATASET   (CLMS-ID)
 19918*        RIDFLD    (ELMSTR-KEY)
 19919*        GENERIC   EQUAL
 19920*        KEYLENGTH (ELMSTR-LENGTH)
 19921*    END-EXEC.
 19922     MOVE 0
 19923       TO DFHEIV11
 19924*    MOVE '&,   KG    E          &   #00019600' TO DFHEIV0
 19925     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19926     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19927     MOVE X'2020233030303139363030' TO DFHEIV0(25:11)
 19928     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 366
* EL050.cbl
 19929           CLMS-ID,
 19930           ELMSTR-KEY,
 19931           ELMSTR-LENGTH,
 19932           DFHEIV11,
 19933           DFHEIV99
 19934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19935
 19936
 19937     MOVE 'Y'                    TO W-BROWSE-SW.
 19938
 19939 7300-NEXT-CLAIM.
 19940
 19941
 19942* EXEC CICS READNEXT
 19943*        DATASET   (CLMS-ID)
 19944*        RIDFLD    (ELMSTR-KEY)
 19945*        SET       (ADDRESS OF CLAIM-MASTER)
 19946*    END-EXEC.
 19947     MOVE 0
 19948       TO DFHEIV11
 19949*    MOVE '&.S                   )   #00019611' TO DFHEIV0
 19950     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19951     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19952     MOVE X'2020233030303139363131' TO DFHEIV0(25:11)
 19953     CALL 'kxdfhei1' USING DFHEIV0,
 19954           CLMS-ID,
 19955           DFHEIV20,
 19956           DFHEIV99,
 19957           ELMSTR-KEY,
 19958           DFHEIV99,
 19959           DFHEIV11,
 19960           DFHEIV99,
 19961           DFHEIV99
 19962     SET ADDRESS OF CLAIM-MASTER TO
 19963         DFHEIV20
 19964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19965
 19966
 19967     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19968        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19969         GO TO 7300-CONTINUE.
 19970
 19971     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19972        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19973        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19974        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19975        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19976         GO TO 7300-NEXT-CLAIM.
 19977
 19978*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19979     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19980        OR (CL-CLAIM-TYPE = 'I')
 19981        OR (CL-CLAIM-TYPE = 'G')
 19982        OR (CL-CLAIM-TYPE = 'F')
 19983        IF CLAIM-IS-OPEN
 19984           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19985             AND PB-C-AH-CANCEL-DT > SPACES
 19986              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 367
* EL050.cbl
 19987              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19988           END-IF
 19989           EVALUATE TRUE
 19990             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19991                 MOVE ER-2884      TO WS-ERROR
 19992             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19993                 MOVE ER-2887      TO WS-ERROR
 19994             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19995                 MOVE ER-2886      TO WS-ERROR
 19996             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19997                 MOVE ER-2888      TO WS-ERROR
 19998             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19999                 MOVE ER-2885      TO WS-ERROR
 20000             WHEN OTHER
 20001                 MOVE ER-2768      TO WS-ERROR
 20002           END-EVALUATE
 20003           IF PB-C-AH-CANCEL-VOIDED OR
 20004              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20005                NOT AH-COVERAGE-CANCELLED)
 20006               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20007               MOVE ER-2768      TO WS-ERROR
 20008           END-IF
 20009           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20010           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20011              PB-FORCE-CODE NOT EQUAL '8'
 20012               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20013           END-IF
 20014           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20015           GO TO 7300-NEXT-CLAIM
 20016        ELSE
 20017           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20018*****THIS IS A RESCISSION OR REFORMATION
 20019              IF AH-COVERAGE-CANCELLED
 20020                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 20021                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 20022                    MOVE 1                   TO DC-ELAPSED-DAYS
 20023                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 20024                    SET BIN-PLUS-ELAPSED     TO TRUE
 20025                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 20026                    IF NO-CONVERSION-ERROR
 20027                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 20028                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 20029                          MOVE ER-2897 TO WS-ERROR
 20030                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20031                          GO TO 7300-NEXT-CLAIM
 20032                       END-IF
 20033                    END-IF
 20034                 ELSE
 20035                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 20036                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20037                         MOVE ER-2890 TO WS-ERROR
 20038                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20039                         GO TO 7300-NEXT-CLAIM
 20040                      ELSE
 20041                         MOVE ER-2898 TO WS-ERROR
 20042                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20043                         GO TO 7300-NEXT-CLAIM
 20044                      END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 368
* EL050.cbl
 20045                   END-IF
 20046                 END-IF
 20047              END-IF
 20048           ELSE
 20049              IF CL-DENIAL-TYPE = '1'  AND
 20050                 CL-TOTAL-PAID-AMT = 0
 20051                    GO TO 7300-NEXT-CLAIM
 20052              END-IF
 20053              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20054               AND PB-C-AH-CANCEL-DT > SPACES
 20055                 MOVE ER-2756        TO WS-ERROR
 20056                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20057                 GO TO 7300-NEXT-CLAIM
 20058              END-IF
 20059           END-IF
 20060        END-IF
 20061     ELSE
 20062*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 20063        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 20064           IF (CLAIM-IS-OPEN)
 20065              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 20066                 <> zeros
 20067              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 20068                 <> zeros)
 20069              MOVE ER-2889      TO WS-ERROR
 20070              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20071              GO TO 7300-NEXT-CLAIM
 20072           ELSE
 20073              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20074*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 20075                 IF (LF-COVERAGE-CANCELLED AND
 20076                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20077                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20078                         MOVE ER-2890 TO WS-ERROR
 20079                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20080                         GO TO 7300-NEXT-CLAIM
 20081                      ELSE
 20082                         MOVE ER-2898 TO WS-ERROR
 20083                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20084                         GO TO 7300-NEXT-CLAIM
 20085                      END-IF
 20086                 END-IF
 20087              ELSE
 20088                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 20089                    and (CL-TOTAL-PAID-AMT = 0)
 20090                    GO TO 7300-NEXT-CLAIM
 20091                 END-IF
 20092                 IF (
 20093                      (AH-COVERAGE-CANCELLED)
 20094                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 20095                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 20096                      and (pb-ci-ah-cancel-amt +
 20097                         pb-c-ah-cancel-amt) <> zeros
 20098                    )
 20099                               OR
 20100                    (
 20101                      (LF-COVERAGE-CANCELLED)
 20102                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 369
* EL050.cbl
 20103                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 20104                      and (pb-ci-lf-cancel-amt +
 20105                         pb-c-lf-cancel-amt) <> zeros
 20106                    )
 20107                       MOVE ER-2965 TO WS-ERROR
 20108                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20109                       GO TO 7300-NEXT-CLAIM
 20110                 END-IF
 20111                 IF LF-COVERAGE-CANCELLED
 20112                  IF CL-TOTAL-PAID-AMT > 0
 20113                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20114                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20115                        MOVE ER-2891 TO WS-ERROR
 20116                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20117                        GO TO 7300-NEXT-CLAIM
 20118                      END-IF
 20119                    ELSE
 20120****only show this error if cert num matches exactly
 20121                      IF PB-CERT-NO = CL-CERT-NO
 20122                         MOVE ER-2892 TO WS-ERROR
 20123                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20124                         GO TO 7300-NEXT-CLAIM
 20125                      END-IF
 20126                    END-IF
 20127                  END-IF
 20128                 END-IF
 20129              END-IF
 20130           END-IF
 20131        END-IF
 20132     END-IF
 20133
 20134     GO TO 7300-NEXT-CLAIM.
 20135
 20136 7300-CONTINUE.
 20137
 20138     IF W-BROWSE-SW = 'Y'
 20139
 20140* EXEC CICS ENDBR
 20141*            DATASET   (CLMS-ID)
 20142*        END-EXEC.
 20143     MOVE 0
 20144       TO DFHEIV11
 20145*    MOVE '&2                    $   #00019789' TO DFHEIV0
 20146     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20147     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20148     MOVE X'2020233030303139373839' TO DFHEIV0(25:11)
 20149     CALL 'kxdfhei1' USING DFHEIV0,
 20150           CLMS-ID,
 20151           DFHEIV11,
 20152           DFHEIV99
 20153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20154
 20155
 20156 7300-EXIT.
 20157     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 370
* EL050.cbl
 20159
 20160 7400-GET-REMAIN-TERM.
 20161
 20162* EXEC CICS LINK
 20163*        PROGRAM    ('ELRTRM')
 20164*        COMMAREA   (CALCULATION-PASS-AREA)
 20165*        LENGTH     (CP-COMM-LENGTH)
 20166*    END-EXEC.
 20167     MOVE 'ELRTRM' TO DFHEIV1
 20168*    MOVE '."C                   (   #00019798' TO DFHEIV0
 20169     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20170     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20171     MOVE X'2020233030303139373938' TO DFHEIV0(25:11)
 20172     CALL 'kxdfhei1' USING DFHEIV0,
 20173           DFHEIV1,
 20174           CALCULATION-PASS-AREA,
 20175           CP-COMM-LENGTH,
 20176           DFHEIV99,
 20177           DFHEIV99,
 20178           DFHEIV99,
 20179           DFHEIV99
 20180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20181
 20182
 20183 7400-EXIT.
 20184     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 371
* EL050.cbl
 20186
 20187 7500-GET-REMAIN-AMOUNT.
 20188
 20189* EXEC CICS LINK
 20190*        PROGRAM    ('ELRAMT')
 20191*        COMMAREA   (CALCULATION-PASS-AREA)
 20192*        LENGTH     (CP-COMM-LENGTH)
 20193*    END-EXEC.
 20194     MOVE 'ELRAMT' TO DFHEIV1
 20195*    MOVE '."C                   (   #00019809' TO DFHEIV0
 20196     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20198     MOVE X'2020233030303139383039' TO DFHEIV0(25:11)
 20199     CALL 'kxdfhei1' USING DFHEIV0,
 20200           DFHEIV1,
 20201           CALCULATION-PASS-AREA,
 20202           CP-COMM-LENGTH,
 20203           DFHEIV99,
 20204           DFHEIV99,
 20205           DFHEIV99,
 20206           DFHEIV99
 20207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20208
 20209
 20210 7500-EXIT.
 20211     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 372
* EL050.cbl
 20213
 20214 7600-GET-REFUND.
 20215
 20216* EXEC CICS LINK
 20217*        PROGRAM    ('ELRFND')
 20218*        COMMAREA   (CALCULATION-PASS-AREA)
 20219*        LENGTH     (CP-COMM-LENGTH)
 20220*    END-EXEC.
 20221     MOVE 'ELRFND' TO DFHEIV1
 20222*    MOVE '."C                   (   #00019820' TO DFHEIV0
 20223     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20224     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20225     MOVE X'2020233030303139383230' TO DFHEIV0(25:11)
 20226     CALL 'kxdfhei1' USING DFHEIV0,
 20227           DFHEIV1,
 20228           CALCULATION-PASS-AREA,
 20229           CP-COMM-LENGTH,
 20230           DFHEIV99,
 20231           DFHEIV99,
 20232           DFHEIV99,
 20233           DFHEIV99
 20234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20235
 20236
 20237 7600-EXIT.
 20238     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 373
* EL050.cbl
 20240 7700-CALL-DL1.
 20241
 20242* EXEC CICS LINK
 20243*        PROGRAM    ('DLO001')
 20244*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20245*        LENGTH     (DLO001-COMM-LENGTH)
 20246*    END-EXEC.
 20247     MOVE 'DLO001' TO DFHEIV1
 20248*    MOVE '."C                   (   #00019830' TO DFHEIV0
 20249     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20251     MOVE X'2020233030303139383330' TO DFHEIV0(25:11)
 20252     CALL 'kxdfhei1' USING DFHEIV0,
 20253           DFHEIV1,
 20254           WS-DLO-MASTER-POLICY-FORM,
 20255           DLO001-COMM-LENGTH,
 20256           DFHEIV99,
 20257           DFHEIV99,
 20258           DFHEIV99,
 20259           DFHEIV99
 20260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20261
 20262
 20263 7700-EXIT.
 20264     EXIT.
 20265
 20266 7710-CALL-DL2.
 20267
 20268* EXEC CICS LINK
 20269*        PROGRAM    ('DLO002')
 20270*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20271*        LENGTH     (DLO002-COMM-LENGTH)
 20272*    END-EXEC.
 20273     MOVE 'DLO002' TO DFHEIV1
 20274*    MOVE '."C                   (   #00019840' TO DFHEIV0
 20275     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20277     MOVE X'2020233030303139383430' TO DFHEIV0(25:11)
 20278     CALL 'kxdfhei1' USING DFHEIV0,
 20279           DFHEIV1,
 20280           WS-DLO-INTERNAL-POLICY-FORM,
 20281           DLO002-COMM-LENGTH,
 20282           DFHEIV99,
 20283           DFHEIV99,
 20284           DFHEIV99,
 20285           DFHEIV99
 20286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20287
 20288
 20289 7710-EXIT.
 20290     EXIT.
 20291
 20292 7720-CALL-DL3.
 20293
 20294* EXEC CICS LINK
 20295*        PROGRAM    ('DLO003')
 20296*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20297*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 374
* EL050.cbl
 20298*    END-EXEC.
 20299     MOVE 'DLO003' TO DFHEIV1
 20300*    MOVE '."C                   (   #00019850' TO DFHEIV0
 20301     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20302     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20303     MOVE X'2020233030303139383530' TO DFHEIV0(25:11)
 20304     CALL 'kxdfhei1' USING DFHEIV0,
 20305           DFHEIV1,
 20306           WS-DLO-VALID-BANK-ID,
 20307           DLO003-COMM-LENGTH,
 20308           DFHEIV99,
 20309           DFHEIV99,
 20310           DFHEIV99,
 20311           DFHEIV99
 20312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20313
 20314
 20315 7720-EXIT.
 20316     EXIT.
 20317
 20318 7730-CALL-DL7.
 20319
 20320* EXEC CICS LINK
 20321*        PROGRAM    ('DLO007')
 20322*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20323*        LENGTH     (DLO007-COMM-LENGTH)
 20324*    END-EXEC.
 20325     MOVE 'DLO007' TO DFHEIV1
 20326*    MOVE '."C                   (   #00019860' TO DFHEIV0
 20327     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20329     MOVE X'2020233030303139383630' TO DFHEIV0(25:11)
 20330     CALL 'kxdfhei1' USING DFHEIV0,
 20331           DFHEIV1,
 20332           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20333           DLO007-COMM-LENGTH,
 20334           DFHEIV99,
 20335           DFHEIV99,
 20336           DFHEIV99,
 20337           DFHEIV99
 20338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20339
 20340
 20341 7730-EXIT.
 20342     EXIT.
 20343
 20344 7740-CALL-DL11.
 20345
 20346* EXEC CICS LINK
 20347*        PROGRAM    ('DLO011')
 20348*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20349*        LENGTH     (DLO011-COMM-LENGTH)
 20350*    END-EXEC.
 20351     MOVE 'DLO011' TO DFHEIV1
 20352*    MOVE '."C                   (   #00019870' TO DFHEIV0
 20353     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20354     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20355     MOVE X'2020233030303139383730' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 375
* EL050.cbl
 20356     CALL 'kxdfhei1' USING DFHEIV0,
 20357           DFHEIV1,
 20358           WS-DLO-PREM-RATES-BEN-TYPE,
 20359           DLO011-COMM-LENGTH,
 20360           DFHEIV99,
 20361           DFHEIV99,
 20362           DFHEIV99,
 20363           DFHEIV99
 20364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20365
 20366
 20367 7740-EXIT.
 20368     EXIT.
 20369
 20370 7750-CALL-DL17.
 20371
 20372* EXEC CICS LINK
 20373*        PROGRAM    ('DLO017')
 20374*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20375*        LENGTH     (DLO017-COMM-LENGTH)
 20376*    END-EXEC.
 20377     MOVE 'DLO017' TO DFHEIV1
 20378*    MOVE '."C                   (   #00019880' TO DFHEIV0
 20379     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20381     MOVE X'2020233030303139383830' TO DFHEIV0(25:11)
 20382     CALL 'kxdfhei1' USING DFHEIV0,
 20383           DFHEIV1,
 20384           WS-DLO-VALID-RATE-CODE,
 20385           DLO017-COMM-LENGTH,
 20386           DFHEIV99,
 20387           DFHEIV99,
 20388           DFHEIV99,
 20389           DFHEIV99
 20390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20391
 20392
 20393 7750-EXIT.
 20394     EXIT.
 20395
 20396 7755-CALL-DL19.
 20397
 20398* EXEC CICS LINK
 20399*        PROGRAM    ('DLO019')
 20400*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20401*        LENGTH     (DLO019-COMM-LENGTH)
 20402*    END-EXEC.
 20403     MOVE 'DLO019' TO DFHEIV1
 20404*    MOVE '."C                   (   #00019890' TO DFHEIV0
 20405     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20406     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20407     MOVE X'2020233030303139383930' TO DFHEIV0(25:11)
 20408     CALL 'kxdfhei1' USING DFHEIV0,
 20409           DFHEIV1,
 20410           WS-DLO-ORIG-COV-CAT,
 20411           DLO019-COMM-LENGTH,
 20412           DFHEIV99,
 20413           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 376
* EL050.cbl
 20414           DFHEIV99,
 20415           DFHEIV99
 20416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20417
 20418
 20419 7755-EXIT.
 20420     EXIT.
 20421
 20422 7760-CALL-DL21.
 20423
 20424* EXEC CICS LINK
 20425*        PROGRAM    ('DLO021')
 20426*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20427*        LENGTH     (DLO021-COMM-LENGTH)
 20428*    END-EXEC.
 20429     MOVE 'DLO021' TO DFHEIV1
 20430*    MOVE '."C                   (   #00019900' TO DFHEIV0
 20431     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20432     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20433     MOVE X'2020233030303139393030' TO DFHEIV0(25:11)
 20434     CALL 'kxdfhei1' USING DFHEIV0,
 20435           DFHEIV1,
 20436           WS-DLO-VALID-LOAN-OFFICER,
 20437           DLO021-COMM-LENGTH,
 20438           DFHEIV99,
 20439           DFHEIV99,
 20440           DFHEIV99,
 20441           DFHEIV99
 20442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20443
 20444
 20445 7760-EXIT.
 20446     EXIT.
 20447
 20448 7770-CALL-DL22.
 20449
 20450* EXEC CICS LINK
 20451*        PROGRAM    ('DLO022')
 20452*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20453*        LENGTH     (DLO022-COMM-LENGTH)
 20454*    END-EXEC.
 20455     MOVE 'DLO022' TO DFHEIV1
 20456*    MOVE '."C                   (   #00019910' TO DFHEIV0
 20457     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20459     MOVE X'2020233030303139393130' TO DFHEIV0(25:11)
 20460     CALL 'kxdfhei1' USING DFHEIV0,
 20461           DFHEIV1,
 20462           WS-DLO-VALID-STATE-CODE,
 20463           DLO022-COMM-LENGTH,
 20464           DFHEIV99,
 20465           DFHEIV99,
 20466           DFHEIV99,
 20467           DFHEIV99
 20468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20469
 20470
 20471 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 377
* EL050.cbl
 20472     EXIT.
 20473
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 378
* EL050.cbl
 20475
 20476 7780-CALL-AGG.
 20477
 20478* EXEC CICS LINK
 20479*        PROGRAM    ('ELAGGO')
 20480*        COMMAREA   (WS-PASS-to-pemaggo)
 20481*        LENGTH     (ws-passed-key-LENGTH)
 20482*    END-EXEC.
 20483     MOVE 'ELAGGO' TO DFHEIV1
 20484*    MOVE '."C                   (   #00019922' TO DFHEIV0
 20485     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20487     MOVE X'2020233030303139393232' TO DFHEIV0(25:11)
 20488     CALL 'kxdfhei1' USING DFHEIV0,
 20489           DFHEIV1,
 20490           WS-PASS-to-pemaggo,
 20491           ws-passed-key-LENGTH,
 20492           DFHEIV99,
 20493           DFHEIV99,
 20494           DFHEIV99,
 20495           DFHEIV99
 20496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20497
 20498 7780-EXIT.
 20499     EXIT.
 20500 7785-CALL-HLDI.
 20501
 20502* EXEC CICS LINK
 20503*        PROGRAM    ('ELHLDI')
 20504*        COMMAREA   (HLDI-PASS-AREA)
 20505*        LENGTH     (HLDI-PASS-AREA-LEN)
 20506*    END-EXEC.
 20507     MOVE 'ELHLDI' TO DFHEIV1
 20508*    MOVE '."C                   (   #00019930' TO DFHEIV0
 20509     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20510     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20511     MOVE X'2020233030303139393330' TO DFHEIV0(25:11)
 20512     CALL 'kxdfhei1' USING DFHEIV0,
 20513           DFHEIV1,
 20514           HLDI-PASS-AREA,
 20515           HLDI-PASS-AREA-LEN,
 20516           DFHEIV99,
 20517           DFHEIV99,
 20518           DFHEIV99,
 20519           DFHEIV99
 20520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20521
 20522 7785-EXIT.
 20523     EXIT.
 20524 7786-CALL-HLDIM.
 20525
 20526* EXEC CICS LINK
 20527*        PROGRAM    ('ELHLDIM')
 20528*        COMMAREA   (HLDI-PASS-AREA)
 20529*        LENGTH     (HLDI-PASS-AREA-LEN)
 20530*    END-EXEC.
 20531     MOVE 'ELHLDIM' TO DFHEIV1
 20532*    MOVE '."C                   (   #00019938' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 379
* EL050.cbl
 20533     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20534     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20535     MOVE X'2020233030303139393338' TO DFHEIV0(25:11)
 20536     CALL 'kxdfhei1' USING DFHEIV0,
 20537           DFHEIV1,
 20538           HLDI-PASS-AREA,
 20539           HLDI-PASS-AREA-LEN,
 20540           DFHEIV99,
 20541           DFHEIV99,
 20542           DFHEIV99,
 20543           DFHEIV99
 20544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20545
 20546 7786-EXIT.
 20547     EXIT.
 20548 7790-CALL-ZIP-VERIFY.
 20549
 20550
 20551* EXEC CICS LINK
 20552*        PROGRAM    ('WSZIPCD')
 20553*        COMMAREA   (ZIPCD-PASS-AREA)
 20554*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20555*    END-EXEC.
 20556     MOVE 'WSZIPCD' TO DFHEIV1
 20557*    MOVE '."C                   (   #00019947' TO DFHEIV0
 20558     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20560     MOVE X'2020233030303139393437' TO DFHEIV0(25:11)
 20561     CALL 'kxdfhei1' USING DFHEIV0,
 20562           DFHEIV1,
 20563           ZIPCD-PASS-AREA,
 20564           ZIPCD-PASS-AREA-LEN,
 20565           DFHEIV99,
 20566           DFHEIV99,
 20567           DFHEIV99,
 20568           DFHEIV99
 20569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20570
 20571
 20572 7790-EXIT.
 20573     EXIT.
 20574 7795-call-sqlclmhs.
 20575
 20576
 20577* EXEC CICS LINK
 20578*        PROGRAM    ('SQLCLMHS')
 20579*        COMMAREA   (clmhs-PASS-AREA)
 20580*        LENGTH     (clmhs-PASS-AREA-LEN)
 20581*    END-EXEC.
 20582     MOVE 'SQLCLMHS' TO DFHEIV1
 20583*    MOVE '."C                   (   #00019957' TO DFHEIV0
 20584     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20585     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20586     MOVE X'2020233030303139393537' TO DFHEIV0(25:11)
 20587     CALL 'kxdfhei1' USING DFHEIV0,
 20588           DFHEIV1,
 20589           clmhs-PASS-AREA,
 20590           clmhs-PASS-AREA-LEN,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 380
* EL050.cbl
 20591           DFHEIV99,
 20592           DFHEIV99,
 20593           DFHEIV99,
 20594           DFHEIV99
 20595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20596
 20597
 20598 7795-EXIT.
 20599     EXIT.
 20600 7800-REWRITE-CERT.
 20601******************************************************************
 20602*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20603*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20604******************************************************************
 20605
 20606     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20607        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20608        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20609        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20610
 20611* EXEC CICS REWRITE
 20612*                  DATASET (CERT-ID)
 20613*                  FROM    (CERTIFICATE-MASTER)
 20614*              END-EXEC
 20615     MOVE LENGTH OF
 20616      CERTIFICATE-MASTER
 20617       TO DFHEIV11
 20618*    MOVE '&& L                  %   #00019975' TO DFHEIV0
 20619     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20620     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20621     MOVE X'2020233030303139393735' TO DFHEIV0(25:11)
 20622     CALL 'kxdfhei1' USING DFHEIV0,
 20623           CERT-ID,
 20624           CERTIFICATE-MASTER,
 20625           DFHEIV11,
 20626           DFHEIV99
 20627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20628        GO TO 7800-EXIT.
 20629
 20630       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20631       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20632
 20633 7800-EXIT.
 20634      EXIT.
 20635
 20636 7900-DELETE-CERT.
 20637
 20638* EXEC CICS DELETE
 20639*        DATASET (CERT-ID)
 20640*    END-EXEC.
 20641*    MOVE '&(                    &   #00019988' TO DFHEIV0
 20642     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20643     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20644     MOVE X'2020233030303139393838' TO DFHEIV0(25:11)
 20645     CALL 'kxdfhei1' USING DFHEIV0,
 20646           CERT-ID,
 20647           DFHEIV99,
 20648           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 381
* EL050.cbl
 20649           DFHEIV99,
 20650           DFHEIV99
 20651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20652
 20653
 20654 7900-EXIT.
 20655     EXIT.
 20656
 20657 8000-WRITE-CERT.
 20658
 20659* EXEC CICS HANDLE CONDITION
 20660*        DUPKEY    (8000-FREE-MAIN)
 20661*    END-EXEC.
 20662*    MOVE '"$$                   ! + #00019996' TO DFHEIV0
 20663     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20665     MOVE X'2B20233030303139393936' TO DFHEIV0(25:11)
 20666     CALL 'kxdfhei1' USING DFHEIV0
 20667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20668
 20669
 20670
 20671* EXEC CICS WRITE
 20672*        DATASET     (CERT-ID)
 20673*        FROM        (CERTIFICATE-MASTER)
 20674*        RIDFLD      (ELCERT-KEY)
 20675*    END-EXEC.
 20676     MOVE LENGTH OF
 20677      CERTIFICATE-MASTER
 20678       TO DFHEIV11
 20679*    MOVE '&$ L                  ''   #00020000' TO DFHEIV0
 20680     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20681     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20682     MOVE X'2020233030303230303030' TO DFHEIV0(25:11)
 20683     CALL 'kxdfhei1' USING DFHEIV0,
 20684           CERT-ID,
 20685           CERTIFICATE-MASTER,
 20686           DFHEIV11,
 20687           ELCERT-KEY,
 20688           DFHEIV99,
 20689           DFHEIV99
 20690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20691
 20692
 20693 8000-FREE-MAIN.
 20694
 20695 8000-EXIT.
 20696      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 382
* EL050.cbl
 20698
 20699 8100-READ-ERPNDM.
 20700
 20701* EXEC CICS HANDLE CONDITION
 20702*         NOTFND     (8100-NOTFND)
 20703*         ENDFILE    (8100-NOTFND)
 20704*    END-EXEC.
 20705*    MOVE '"$I''                  ! , #00020013' TO DFHEIV0
 20706     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20708     MOVE X'2C20233030303230303133' TO DFHEIV0(25:11)
 20709     CALL 'kxdfhei1' USING DFHEIV0
 20710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20711
 20712
 20713     MOVE SPACES                 TO ERPNDM-FOUND.
 20714     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20715
 20716
 20717* EXEC CICS READ UPDATE
 20718*         DATASET   (FILE-ERPNDM)
 20719*         RIDFLD    (PM-CONTROL-PRIMARY)
 20720*         INTO      (PENDING-MAILING-DATA)
 20721*    END-EXEC.
 20722     MOVE LENGTH OF
 20723      PENDING-MAILING-DATA
 20724       TO DFHEIV11
 20725*    MOVE '&"IL       EU         (   #00020021' TO DFHEIV0
 20726     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20727     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20728     MOVE X'2020233030303230303231' TO DFHEIV0(25:11)
 20729     CALL 'kxdfhei1' USING DFHEIV0,
 20730           FILE-ERPNDM,
 20731           PENDING-MAILING-DATA,
 20732           DFHEIV11,
 20733           PM-CONTROL-PRIMARY,
 20734           DFHEIV99,
 20735           DFHEIV99,
 20736           DFHEIV99
 20737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20738
 20739
 20740     GO TO 8100-EXIT.
 20741
 20742 8100-NOTFND.
 20743
 20744     MOVE 'X'                    TO ERPNDM-FOUND.
 20745     MOVE ER-2694                TO WS-ERROR.
 20746     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20747     MOVE ER-2883                TO WS-ERROR
 20748     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20749     .
 20750 8100-EXIT.
 20751     EXIT.
 20752 8102-REWRITE-ERPNDM.
 20753
 20754
 20755* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 383
* EL050.cbl
 20756*         DATASET    (FILE-ERPNDM)
 20757*         FROM       (PENDING-MAILING-DATA)
 20758*    END-EXEC
 20759     MOVE LENGTH OF
 20760      PENDING-MAILING-DATA
 20761       TO DFHEIV11
 20762*    MOVE '&& L                  %   #00020041' TO DFHEIV0
 20763     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20764     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20765     MOVE X'2020233030303230303431' TO DFHEIV0(25:11)
 20766     CALL 'kxdfhei1' USING DFHEIV0,
 20767           FILE-ERPNDM,
 20768           PENDING-MAILING-DATA,
 20769           DFHEIV11,
 20770           DFHEIV99
 20771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20772
 20773     .
 20774 8102-EXIT.
 20775     EXIT.
 20776 8104-UNLOCK-ERPNDM.
 20777
 20778
 20779* EXEC CICS UNLOCK
 20780*         DATASET   (FILE-ERPNDM)
 20781*    END-EXEC
 20782*    MOVE '&*                    #   #00020051' TO DFHEIV0
 20783     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20784     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20785     MOVE X'2020233030303230303531' TO DFHEIV0(25:11)
 20786     CALL 'kxdfhei1' USING DFHEIV0,
 20787           FILE-ERPNDM,
 20788           DFHEIV99
 20789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20790
 20791     .
 20792 8104-EXIT.
 20793     EXIT.
 20794 8110-READ-ERMAIL.
 20795
 20796* EXEC CICS HANDLE CONDITION
 20797*         NOTFND     (8110-NOTFND)
 20798*         ENDFILE    (8110-NOTFND)
 20799*    END-EXEC.
 20800*    MOVE '"$I''                  ! - #00020059' TO DFHEIV0
 20801     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20803     MOVE X'2D20233030303230303539' TO DFHEIV0(25:11)
 20804     CALL 'kxdfhei1' USING DFHEIV0
 20805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20806
 20807
 20808     MOVE SPACES                 TO ERMAIL-FOUND.
 20809     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20810     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20811     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20812     MOVE PB-SV-STATE            TO MA-STATE.
 20813
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 384
* EL050.cbl
 20814
 20815* EXEC CICS READ
 20816*         UPDATE
 20817*         DATASET   (FILE-ERMAIL)
 20818*         RIDFLD    (MA-CONTROL-PRIMARY)
 20819*         INTO      (MAILING-DATA)
 20820*    END-EXEC.
 20821     MOVE LENGTH OF
 20822      MAILING-DATA
 20823       TO DFHEIV11
 20824*    MOVE '&"IL       EU         (   #00020070' TO DFHEIV0
 20825     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20826     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20827     MOVE X'2020233030303230303730' TO DFHEIV0(25:11)
 20828     CALL 'kxdfhei1' USING DFHEIV0,
 20829           FILE-ERMAIL,
 20830           MAILING-DATA,
 20831           DFHEIV11,
 20832           MA-CONTROL-PRIMARY,
 20833           DFHEIV99,
 20834           DFHEIV99,
 20835           DFHEIV99
 20836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20837
 20838
 20839     GO TO 8110-EXIT.
 20840
 20841 8110-NOTFND.
 20842     MOVE 'X'                    TO ERMAIL-FOUND.
 20843
 20844 8110-EXIT.
 20845     EXIT.
 20846
 20847 8120-REWRITE-ERMAIL.
 20848
 20849* EXEC CICS REWRITE
 20850*         DATASET    (FILE-ERMAIL)
 20851*         FROM       (MAILING-DATA)
 20852*    END-EXEC.
 20853     MOVE LENGTH OF
 20854      MAILING-DATA
 20855       TO DFHEIV11
 20856*    MOVE '&& L                  %   #00020086' TO DFHEIV0
 20857     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20858     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20859     MOVE X'2020233030303230303836' TO DFHEIV0(25:11)
 20860     CALL 'kxdfhei1' USING DFHEIV0,
 20861           FILE-ERMAIL,
 20862           MAILING-DATA,
 20863           DFHEIV11,
 20864           DFHEIV99
 20865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20866
 20867
 20868 8120-EXIT.
 20869     EXIT.
 20870
 20871 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 385
* EL050.cbl
 20872
 20873* EXEC CICS HANDLE CONDITION
 20874*         DUPKEY   (8130-EXIT)
 20875*    END-EXEC.
 20876*    MOVE '"$$                   ! . #00020095' TO DFHEIV0
 20877     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20879     MOVE X'2E20233030303230303935' TO DFHEIV0(25:11)
 20880     CALL 'kxdfhei1' USING DFHEIV0
 20881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20882
 20883
 20884
 20885* EXEC CICS WRITE
 20886*         DATASET     (FILE-ERMAIL)
 20887*         RIDFLD      (MA-CONTROL-PRIMARY)
 20888*         FROM        (MAILING-DATA)
 20889*    END-EXEC.
 20890     MOVE LENGTH OF
 20891      MAILING-DATA
 20892       TO DFHEIV11
 20893*    MOVE '&$ L                  ''   #00020099' TO DFHEIV0
 20894     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20895     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20896     MOVE X'2020233030303230303939' TO DFHEIV0(25:11)
 20897     CALL 'kxdfhei1' USING DFHEIV0,
 20898           FILE-ERMAIL,
 20899           MAILING-DATA,
 20900           DFHEIV11,
 20901           MA-CONTROL-PRIMARY,
 20902           DFHEIV99,
 20903           DFHEIV99
 20904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20905
 20906
 20907 8130-EXIT.
 20908     EXIT.
 20909
 20910 8140-UNLOCK-ERMAIL.
 20911
 20912* EXEC CICS UNLOCK
 20913*         DATASET   (FILE-ERMAIL)
 20914*    END-EXEC.
 20915*    MOVE '&*                    #   #00020109' TO DFHEIV0
 20916     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20917     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20918     MOVE X'2020233030303230313039' TO DFHEIV0(25:11)
 20919     CALL 'kxdfhei1' USING DFHEIV0,
 20920           FILE-ERMAIL,
 20921           DFHEIV99
 20922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20923
 20924
 20925 8140-EXIT.
 20926     EXIT.
 20927
 20928 8145-read-elcrtt-upd.
 20929
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 386
* EL050.cbl
 20930     move ' '                    to elcrtt-found-sw
 20931                                    elcrtt-update-sw
 20932
 20933* EXEC CICS HANDLE CONDITION
 20934*        NOTFND   (8145-exit)
 20935*    END-EXEC
 20936*    MOVE '"$I                   ! / #00020120' TO DFHEIV0
 20937     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20938     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20939     MOVE X'2F20233030303230313230' TO DFHEIV0(25:11)
 20940     CALL 'kxdfhei1' USING DFHEIV0
 20941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20942
 20943     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20944     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20945
 20946
 20947* EXEC CICS READ UPDATE
 20948*        DATASET  (CRTT-ID)
 20949*        RIDFLD   (WS-ELCRTT-KEY)
 20950*        INTO     (CERTIFICATE-TRAILERS)
 20951*    END-EXEC
 20952     MOVE LENGTH OF
 20953      CERTIFICATE-TRAILERS
 20954       TO DFHEIV11
 20955*    MOVE '&"IL       EU         (   #00020127' TO DFHEIV0
 20956     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20957     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20958     MOVE X'2020233030303230313237' TO DFHEIV0(25:11)
 20959     CALL 'kxdfhei1' USING DFHEIV0,
 20960           CRTT-ID,
 20961           CERTIFICATE-TRAILERS,
 20962           DFHEIV11,
 20963           WS-ELCRTT-KEY,
 20964           DFHEIV99,
 20965           DFHEIV99,
 20966           DFHEIV99
 20967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20968
 20969     set elcrtt-found to true
 20970
 20971     .
 20972 8145-exit.
 20973     exit.
 20974 8150-UPDATE-ELCRTT.
 20975
 20976     if elcrtt-found
 20977
 20978* EXEC CICS REWRITE
 20979*           DATASET  (CRTT-ID)
 20980*           FROM     (CERTIFICATE-TRAILERS)
 20981*        END-EXEC
 20982     MOVE LENGTH OF
 20983      CERTIFICATE-TRAILERS
 20984       TO DFHEIV11
 20985*    MOVE '&& L                  %   #00020141' TO DFHEIV0
 20986     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20987     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 387
* EL050.cbl
 20988     MOVE X'2020233030303230313431' TO DFHEIV0(25:11)
 20989     CALL 'kxdfhei1' USING DFHEIV0,
 20990           CRTT-ID,
 20991           CERTIFICATE-TRAILERS,
 20992           DFHEIV11,
 20993           DFHEIV99
 20994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20995     ELSE
 20996
 20997* EXEC CICS WRITE
 20998*          DATASET  (CRTT-ID)
 20999*          RIDFLD   (WS-ELCRTT-KEY)
 21000*          FROM     (CERTIFICATE-TRAILERS)
 21001*       END-EXEC
 21002     MOVE LENGTH OF
 21003      CERTIFICATE-TRAILERS
 21004       TO DFHEIV11
 21005*    MOVE '&$ L                  ''   #00020146' TO DFHEIV0
 21006     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21007     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21008     MOVE X'2020233030303230313436' TO DFHEIV0(25:11)
 21009     CALL 'kxdfhei1' USING DFHEIV0,
 21010           CRTT-ID,
 21011           CERTIFICATE-TRAILERS,
 21012           DFHEIV11,
 21013           WS-ELCRTT-KEY,
 21014           DFHEIV99,
 21015           DFHEIV99
 21016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21017     end-if
 21018
 21019     .
 21020 8150-EXIT.
 21021     EXIT.
 21022
 21023 8155-unlock-elcrtt.
 21024
 21025
 21026* EXEC CICS UNLOCK
 21027*       DATASET  (CRTT-ID)
 21028*    END-EXEC
 21029*    MOVE '&*                    #   #00020159' TO DFHEIV0
 21030     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21031     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21032     MOVE X'2020233030303230313539' TO DFHEIV0(25:11)
 21033     CALL 'kxdfhei1' USING DFHEIV0,
 21034           CRTT-ID,
 21035           DFHEIV99
 21036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21037
 21038     .
 21039 8155-exit.
 21040     exit.
 21041
 21042 8190-UPDATE-REFUND-CLAIM-FLAG.
 21043
 21044* EXEC CICS HANDLE CONDITION
 21045*        NOTFND   (8190-NOTFND)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 388
* EL050.cbl
 21046*    END-EXEC.
 21047*    MOVE '"$I                   ! 0 #00020168' TO DFHEIV0
 21048     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21049     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21050     MOVE X'3020233030303230313638' TO DFHEIV0(25:11)
 21051     CALL 'kxdfhei1' USING DFHEIV0
 21052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21053
 21054
 21055     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21056     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21057
 21058
 21059* EXEC CICS READ
 21060*        UPDATE
 21061*        DATASET  (CRTT-ID)
 21062*        RIDFLD   (WS-ELCRTT-KEY)
 21063*        INTO     (CERTIFICATE-TRAILERS)
 21064*    END-EXEC.
 21065     MOVE LENGTH OF
 21066      CERTIFICATE-TRAILERS
 21067       TO DFHEIV11
 21068*    MOVE '&"IL       EU         (   #00020175' TO DFHEIV0
 21069     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21070     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21071     MOVE X'2020233030303230313735' TO DFHEIV0(25:11)
 21072     CALL 'kxdfhei1' USING DFHEIV0,
 21073           CRTT-ID,
 21074           CERTIFICATE-TRAILERS,
 21075           DFHEIV11,
 21076           WS-ELCRTT-KEY,
 21077           DFHEIV99,
 21078           DFHEIV99,
 21079           DFHEIV99
 21080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21081
 21082
 21083     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21084
 21085* EXEC CICS REWRITE
 21086*       DATASET  (CRTT-ID)
 21087*       FROM     (CERTIFICATE-TRAILERS)
 21088*    END-EXEC.
 21089     MOVE LENGTH OF
 21090      CERTIFICATE-TRAILERS
 21091       TO DFHEIV11
 21092*    MOVE '&& L                  %   #00020183' TO DFHEIV0
 21093     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21094     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21095     MOVE X'2020233030303230313833' TO DFHEIV0(25:11)
 21096     CALL 'kxdfhei1' USING DFHEIV0,
 21097           CRTT-ID,
 21098           CERTIFICATE-TRAILERS,
 21099           DFHEIV11,
 21100           DFHEIV99
 21101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21102
 21103
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 389
* EL050.cbl
 21104     GO TO 8190-EXIT.
 21105
 21106 8190-NOTFND.
 21107
 21108     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21109     MOVE 'CS'         TO CS-RECORD-ID.
 21110     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21111     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21112     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21113     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21114
 21115* EXEC CICS WRITE
 21116*       DATASET  (CRTT-ID)
 21117*       RIDFLD   (WS-ELCRTT-KEY)
 21118*       FROM     (CERTIFICATE-TRAILERS)
 21119*    END-EXEC.
 21120     MOVE LENGTH OF
 21121      CERTIFICATE-TRAILERS
 21122       TO DFHEIV11
 21123*    MOVE '&$ L                  ''   #00020198' TO DFHEIV0
 21124     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21125     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21126     MOVE X'2020233030303230313938' TO DFHEIV0(25:11)
 21127     CALL 'kxdfhei1' USING DFHEIV0,
 21128           CRTT-ID,
 21129           CERTIFICATE-TRAILERS,
 21130           DFHEIV11,
 21131           WS-ELCRTT-KEY,
 21132           DFHEIV99,
 21133           DFHEIV99
 21134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21135
 21136
 21137 8190-EXIT.
 21138     EXIT.
 21139
 21140 8195-UPDATE-AGE-FLAGS.
 21141
 21142* EXEC CICS HANDLE CONDITION
 21143*        NOTFND   (8195-NOTFND)
 21144*    END-EXEC.
 21145*    MOVE '"$I                   ! 1 #00020208' TO DFHEIV0
 21146     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21148     MOVE X'3120233030303230323038' TO DFHEIV0(25:11)
 21149     CALL 'kxdfhei1' USING DFHEIV0
 21150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21151
 21152
 21153     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21154     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21155
 21156
 21157* EXEC CICS READ
 21158*        UPDATE
 21159*        DATASET  (CRTT-ID)
 21160*        RIDFLD   (WS-ELCRTT-KEY)
 21161*        INTO     (CERTIFICATE-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 390
* EL050.cbl
 21162*    END-EXEC.
 21163     MOVE LENGTH OF
 21164      CERTIFICATE-TRAILERS
 21165       TO DFHEIV11
 21166*    MOVE '&"IL       EU         (   #00020215' TO DFHEIV0
 21167     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21168     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21169     MOVE X'2020233030303230323135' TO DFHEIV0(25:11)
 21170     CALL 'kxdfhei1' USING DFHEIV0,
 21171           CRTT-ID,
 21172           CERTIFICATE-TRAILERS,
 21173           DFHEIV11,
 21174           WS-ELCRTT-KEY,
 21175           DFHEIV99,
 21176           DFHEIV99,
 21177           DFHEIV99
 21178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21179
 21180
 21181     IF WS-INS-AGE-SET = 'Y'
 21182        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21183     END-IF
 21184     IF WS-JNT-AGE-SET = 'Y'
 21185        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21186     END-IF
 21187
 21188
 21189* EXEC CICS REWRITE
 21190*       DATASET  (CRTT-ID)
 21191*       FROM     (CERTIFICATE-TRAILERS)
 21192*    END-EXEC.
 21193     MOVE LENGTH OF
 21194      CERTIFICATE-TRAILERS
 21195       TO DFHEIV11
 21196*    MOVE '&& L                  %   #00020229' TO DFHEIV0
 21197     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21198     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21199     MOVE X'2020233030303230323239' TO DFHEIV0(25:11)
 21200     CALL 'kxdfhei1' USING DFHEIV0,
 21201           CRTT-ID,
 21202           CERTIFICATE-TRAILERS,
 21203           DFHEIV11,
 21204           DFHEIV99
 21205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21206
 21207
 21208     GO TO 8195-EXIT.
 21209
 21210 8195-NOTFND.
 21211
 21212     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21213     MOVE 'CS'         TO CS-RECORD-ID.
 21214     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21215     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21216     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21217     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21218     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21219
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 391
* EL050.cbl
 21220* EXEC CICS WRITE
 21221*       DATASET  (CRTT-ID)
 21222*       RIDFLD   (WS-ELCRTT-KEY)
 21223*       FROM     (CERTIFICATE-TRAILERS)
 21224*    END-EXEC.
 21225     MOVE LENGTH OF
 21226      CERTIFICATE-TRAILERS
 21227       TO DFHEIV11
 21228*    MOVE '&$ L                  ''   #00020245' TO DFHEIV0
 21229     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21230     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21231     MOVE X'2020233030303230323435' TO DFHEIV0(25:11)
 21232     CALL 'kxdfhei1' USING DFHEIV0,
 21233           CRTT-ID,
 21234           CERTIFICATE-TRAILERS,
 21235           DFHEIV11,
 21236           WS-ELCRTT-KEY,
 21237           DFHEIV99,
 21238           DFHEIV99
 21239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21240
 21241
 21242 8195-EXIT.
 21243     EXIT.
 21244
 21245 8200-READ-REIN-TABLE.
 21246
 21247* EXEC CICS HANDLE CONDITION
 21248*         NOTFND   (8200-NOTFND)
 21249*    END-EXEC.
 21250*    MOVE '"$I                   ! 2 #00020255' TO DFHEIV0
 21251     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21253     MOVE X'3220233030303230323535' TO DFHEIV0(25:11)
 21254     CALL 'kxdfhei1' USING DFHEIV0
 21255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21256
 21257
 21258
 21259* EXEC CICS READ
 21260*        DATASET     (REIN-ID)
 21261*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21262*        RIDFLD      (ERREIN-KEY)
 21263*    END-EXEC.
 21264*    MOVE '&"S        E          (   #00020259' TO DFHEIV0
 21265     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21267     MOVE X'2020233030303230323539' TO DFHEIV0(25:11)
 21268     CALL 'kxdfhei1' USING DFHEIV0,
 21269           REIN-ID,
 21270           DFHEIV20,
 21271           DFHEIV99,
 21272           ERREIN-KEY,
 21273           DFHEIV99,
 21274           DFHEIV99,
 21275           DFHEIV99
 21276     SET ADDRESS OF REINSURANCE-RECORD TO
 21277         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 392
* EL050.cbl
 21278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21279
 21280
 21281     GO TO 8200-EXIT.
 21282
 21283 8200-NOTFND.
 21284     MOVE 'N'             TO WS-REIN-READ-SW.
 21285
 21286 8200-EXIT.
 21287      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 393
* EL050.cbl
 21289
 21290 8300-READ-CTBL-TABLE.
 21291
 21292* EXEC CICS HANDLE CONDITION
 21293*        NOTFND    (8300-NOTFND)
 21294*        DISABLED  (8300-ERRESS-PROBLEM)
 21295*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21296*        ENDFILE   (8300-NOTFND)
 21297*    END-EXEC.
 21298*    MOVE '"$IcJ''                ! 3 #00020275' TO DFHEIV0
 21299     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21301     MOVE X'3320233030303230323735' TO DFHEIV0(25:11)
 21302     CALL 'kxdfhei1' USING DFHEIV0
 21303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21304
 21305
 21306
 21307* EXEC CICS READ
 21308*        DATASET     (CTBL-ID)
 21309*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21310*        RIDFLD      (ERCTBL-KEY)
 21311*    END-EXEC.
 21312*    MOVE '&"S        E          (   #00020282' TO DFHEIV0
 21313     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21315     MOVE X'2020233030303230323832' TO DFHEIV0(25:11)
 21316     CALL 'kxdfhei1' USING DFHEIV0,
 21317           CTBL-ID,
 21318           DFHEIV20,
 21319           DFHEIV99,
 21320           ERCTBL-KEY,
 21321           DFHEIV99,
 21322           DFHEIV99,
 21323           DFHEIV99
 21324     SET ADDRESS OF COMM-TABLE-RECORD TO
 21325         DFHEIV20
 21326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21327
 21328
 21329     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21330
 21331     GO TO 8300-EXIT.
 21332
 21333 8300-NOTFND.
 21334
 21335     IF CTBL-SW = '0530'
 21336         MOVE 'AA'                     TO WS-AH-COMP-CD
 21337         MOVE '0550'                   TO CTBL-SW
 21338         MOVE '1'                      TO WS-CTBL-READ-SW
 21339         GO TO 8300-EXIT.
 21340
 21341     IF CTBL-SW = '0540'
 21342         MOVE 'AA'                     TO WS-LF-COMP-CD
 21343         MOVE '0550'                   TO CTBL-SW
 21344         MOVE '1'                      TO WS-CTBL-READ-SW
 21345         GO TO 8300-EXIT.
 21346
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 394
* EL050.cbl
 21347     IF CTBL-SW = '0550'
 21348         MOVE '2'                      TO WS-CTBL-READ-SW
 21349         GO TO 8300-EXIT.
 21350
 21351     GO TO 8300-EXIT.
 21352
 21353 8300-ERRESS-PROBLEM.
 21354
 21355      MOVE ER-8050              TO WS-ERROR.
 21356      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21357
 21358     GO TO 8300-EXIT.
 21359
 21360 8300-EXIT.
 21361      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 395
* EL050.cbl
 21363
 21364
 21365 8400-GETMAIN-ERFORM.
 21366
 21367
 21368* EXEC CICS   GETMAIN
 21369*        LENGTH  (500)
 21370*        SET     (ADDRESS OF FORM-MASTER)
 21371*    END-EXEC.
 21372     MOVE 500
 21373       TO DFHEIV11
 21374*    MOVE '," L                  $   #00020326' TO DFHEIV0
 21375     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21376     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21377     MOVE X'2020233030303230333236' TO DFHEIV0(25:11)
 21378     CALL 'kxdfhei1' USING DFHEIV0,
 21379           DFHEIV20,
 21380           DFHEIV11,
 21381           DFHEIV99
 21382     SET ADDRESS OF FORM-MASTER TO
 21383         DFHEIV20
 21384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21385
 21386
 21387     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21388
 21389 8400-EXIT.
 21390      EXIT.
 21391
 21392 8450-READ-FORM-MASTER.
 21393
 21394
 21395* EXEC CICS  HANDLE CONDITION
 21396*        NOTFND   (8450-FORM-NOT-FOUND)
 21397*        ENDFILE  (8450-FORM-NOT-FOUND)
 21398*    END-EXEC.
 21399*    MOVE '"$I''                  ! 4 #00020338' TO DFHEIV0
 21400     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21402     MOVE X'3420233030303230333338' TO DFHEIV0(25:11)
 21403     CALL 'kxdfhei1' USING DFHEIV0
 21404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21405
 21406
 21407
 21408* EXEC CICS   READ
 21409*        DATASET   (FORM-ID)
 21410*        RIDFLD    (ERFORM-KEY)
 21411*        INTO      (FORM-MASTER)
 21412*        GTEQ
 21413*    END-EXEC.
 21414     MOVE LENGTH OF
 21415      FORM-MASTER
 21416       TO DFHEIV11
 21417*    MOVE '&"IL       G          (   #00020343' TO DFHEIV0
 21418     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21419     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21420     MOVE X'2020233030303230333433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 396
* EL050.cbl
 21421     CALL 'kxdfhei1' USING DFHEIV0,
 21422           FORM-ID,
 21423           FORM-MASTER,
 21424           DFHEIV11,
 21425           ERFORM-KEY,
 21426           DFHEIV99,
 21427           DFHEIV99,
 21428           DFHEIV99
 21429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21430
 21431
 21432     MOVE  'Y'           TO  FORM-MASTER-SW.
 21433
 21434     GO TO  8450-EXIT.
 21435
 21436 8450-FORM-NOT-FOUND.
 21437
 21438     MOVE  'N'           TO  FORM-MASTER-SW.
 21439
 21440 8450-EXIT.
 21441      EXIT.
 21442
 21443 8500-DATE-CONVERT.
 21444
 21445* EXEC CICS LINK
 21446*        PROGRAM    ('ELDATCV')
 21447*        COMMAREA   (DATE-CONVERSION-DATA)
 21448*        LENGTH     (DC-COMM-LENGTH)
 21449*    END-EXEC.
 21450     MOVE 'ELDATCV' TO DFHEIV1
 21451*    MOVE '."C                   (   #00020362' TO DFHEIV0
 21452     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21454     MOVE X'2020233030303230333632' TO DFHEIV0(25:11)
 21455     CALL 'kxdfhei1' USING DFHEIV0,
 21456           DFHEIV1,
 21457           DATE-CONVERSION-DATA,
 21458           DC-COMM-LENGTH,
 21459           DFHEIV99,
 21460           DFHEIV99,
 21461           DFHEIV99,
 21462           DFHEIV99
 21463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21464
 21465
 21466 8500-EXIT.
 21467     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 397
* EL050.cbl
 21469
 21470 8555-RELOAD-CONTROL-FILE.
 21471     CONTINUE.
 21472
 21473 8555-EXIT.
 21474     EXIT.
 21475
 21476 8557-GETMAIN-ERPLAN.
 21477
 21478
 21479* EXEC CICS GETMAIN
 21480*        LENGTH    (840)
 21481*        SET       (ADDRESS OF PLAN-RECORDS)
 21482*    END-EXEC.
 21483     MOVE 840
 21484       TO DFHEIV11
 21485*    MOVE '," L                  $   #00020380' TO DFHEIV0
 21486     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21487     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21488     MOVE X'2020233030303230333830' TO DFHEIV0(25:11)
 21489     CALL 'kxdfhei1' USING DFHEIV0,
 21490           DFHEIV20,
 21491           DFHEIV11,
 21492           DFHEIV99
 21493     SET ADDRESS OF PLAN-RECORDS TO
 21494         DFHEIV20
 21495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21496
 21497
 21498     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21499
 21500 8557-EXIT.
 21501     EXIT.
 21502
 21503 8560-GETMAIN.
 21504
 21505* EXEC CICS GETMAIN
 21506*        LENGTH    (2000)
 21507*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21508*    END-EXEC.
 21509     MOVE 2000
 21510       TO DFHEIV11
 21511*    MOVE '," L                  $   #00020391' TO DFHEIV0
 21512     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21513     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21514     MOVE X'2020233030303230333931' TO DFHEIV0(25:11)
 21515     CALL 'kxdfhei1' USING DFHEIV0,
 21516           DFHEIV20,
 21517           DFHEIV11,
 21518           DFHEIV99
 21519     SET ADDRESS OF ACCOUNT-MASTER TO
 21520         DFHEIV20
 21521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21522
 21523
 21524     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21525
 21526 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 398
* EL050.cbl
 21527     EXIT.
 21528
 21529 8570-START-ACCOUNT-MASTER.
 21530
 21531* EXEC CICS HANDLE CONDITION
 21532*        NOTFND    (0199-ACCT-NOT-FOUND)
 21533*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21534*    END-EXEC.
 21535*    MOVE '"$I''                  ! 5 #00020402' TO DFHEIV0
 21536     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21538     MOVE X'3520233030303230343032' TO DFHEIV0(25:11)
 21539     CALL 'kxdfhei1' USING DFHEIV0
 21540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21541
 21542
 21543
 21544* EXEC CICS STARTBR
 21545*        DATASET    (ACCT-ID)
 21546*        RIDFLD     (ERACCT-KEY)
 21547*        GTEQ
 21548*    END-EXEC.
 21549     MOVE 0
 21550       TO DFHEIV11
 21551*    MOVE '&,         G          &   #00020407' TO DFHEIV0
 21552     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21553     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21554     MOVE X'2020233030303230343037' TO DFHEIV0(25:11)
 21555     CALL 'kxdfhei1' USING DFHEIV0,
 21556           ACCT-ID,
 21557           ERACCT-KEY,
 21558           DFHEIV99,
 21559           DFHEIV11,
 21560           DFHEIV99
 21561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21562
 21563
 21564 8570-EXIT.
 21565     EXIT.
 21566
 21567 8580-READ-ACCOUNT-MASTER.
 21568
 21569* EXEC CICS HANDLE CONDITION
 21570*        NOTFND    (0199-ACCT-NOT-FOUND)
 21571*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21572*    END-EXEC.
 21573*    MOVE '"$I''                  ! 6 #00020417' TO DFHEIV0
 21574     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21576     MOVE X'3620233030303230343137' TO DFHEIV0(25:11)
 21577     CALL 'kxdfhei1' USING DFHEIV0
 21578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21579
 21580
 21581
 21582* EXEC CICS READNEXT
 21583*        DATASET     (ACCT-ID)
 21584*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 399
* EL050.cbl
 21585*        RIDFLD      (ERACCT-KEY)
 21586*    END-EXEC.
 21587     MOVE LENGTH OF
 21588      ACCOUNT-MASTER
 21589       TO DFHEIV12
 21590     MOVE 0
 21591       TO DFHEIV11
 21592*    MOVE '&.IL                  )   #00020422' TO DFHEIV0
 21593     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21594     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21595     MOVE X'2020233030303230343232' TO DFHEIV0(25:11)
 21596     CALL 'kxdfhei1' USING DFHEIV0,
 21597           ACCT-ID,
 21598           ACCOUNT-MASTER,
 21599           DFHEIV12,
 21600           ERACCT-KEY,
 21601           DFHEIV99,
 21602           DFHEIV11,
 21603           DFHEIV99,
 21604           DFHEIV99
 21605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21606
 21607
 21608 8580-EXIT.
 21609     EXIT.
 21610
 21611 8582-READ-COMPENSATION-MASTER.
 21612
 21613* EXEC CICS HANDLE CONDITION
 21614*        NOTFND    (8582-COMP-NOT-FOUND)
 21615*        ENDFILE   (8582-COMP-NOT-FOUND)
 21616*    END-EXEC.
 21617*    MOVE '"$I''                  ! 7 #00020432' TO DFHEIV0
 21618     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21619     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21620     MOVE X'3720233030303230343332' TO DFHEIV0(25:11)
 21621     CALL 'kxdfhei1' USING DFHEIV0
 21622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21623
 21624
 21625
 21626* EXEC CICS READ
 21627*        DATASET     (COMP-ID)
 21628*        INTO        (COMPENSATION-MASTER)
 21629*        RIDFLD      (ERCOMP-KEY)
 21630*    END-EXEC.
 21631     MOVE LENGTH OF
 21632      COMPENSATION-MASTER
 21633       TO DFHEIV11
 21634*    MOVE '&"IL       E          (   #00020437' TO DFHEIV0
 21635     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21636     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21637     MOVE X'2020233030303230343337' TO DFHEIV0(25:11)
 21638     CALL 'kxdfhei1' USING DFHEIV0,
 21639           COMP-ID,
 21640           COMPENSATION-MASTER,
 21641           DFHEIV11,
 21642           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 400
* EL050.cbl
 21643           DFHEIV99,
 21644           DFHEIV99,
 21645           DFHEIV99
 21646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21647
 21648
 21649     MOVE 'Y'                    TO COMP-MASTER-SW
 21650
 21651     GO TO 8582-EXIT
 21652     .
 21653 8582-COMP-NOT-FOUND.
 21654
 21655     MOVE 'N'                    TO COMP-MASTER-SW.
 21656
 21657 8582-EXIT.
 21658     EXIT.
 21659
 21660 8583-READ-ERAGTC.
 21661
 21662* EXEC CICS HANDLE CONDITION
 21663*        NOTFND    (8583-AGTC-NOT-FOUND)
 21664*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21665*    END-EXEC.
 21666*    MOVE '"$I''                  ! 8 #00020455' TO DFHEIV0
 21667     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21669     MOVE X'3820233030303230343535' TO DFHEIV0(25:11)
 21670     CALL 'kxdfhei1' USING DFHEIV0
 21671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21672
 21673
 21674
 21675* EXEC CICS STARTBR
 21676*        DATASET    (AGTC-ID)
 21677*        RIDFLD     (ERAGTC-KEY)
 21678*        GTEQ
 21679*    END-EXEC.
 21680     MOVE 0
 21681       TO DFHEIV11
 21682*    MOVE '&,         G          &   #00020460' TO DFHEIV0
 21683     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21684     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21685     MOVE X'2020233030303230343630' TO DFHEIV0(25:11)
 21686     CALL 'kxdfhei1' USING DFHEIV0,
 21687           AGTC-ID,
 21688           ERAGTC-KEY,
 21689           DFHEIV99,
 21690           DFHEIV11,
 21691           DFHEIV99
 21692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21693
 21694
 21695 8583-READ-ERAGTC-NEXT.
 21696
 21697* EXEC CICS READNEXT
 21698*        DATASET     (AGTC-ID)
 21699*        INTO        (AGENT-COMMISSIONS)
 21700*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 401
* EL050.cbl
 21701*    END-EXEC.
 21702     MOVE LENGTH OF
 21703      AGENT-COMMISSIONS
 21704       TO DFHEIV12
 21705     MOVE 0
 21706       TO DFHEIV11
 21707*    MOVE '&.IL                  )   #00020467' TO DFHEIV0
 21708     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21709     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21710     MOVE X'2020233030303230343637' TO DFHEIV0(25:11)
 21711     CALL 'kxdfhei1' USING DFHEIV0,
 21712           AGTC-ID,
 21713           AGENT-COMMISSIONS,
 21714           DFHEIV12,
 21715           ERAGTC-KEY,
 21716           DFHEIV99,
 21717           DFHEIV11,
 21718           DFHEIV99,
 21719           DFHEIV99
 21720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21721
 21722
 21723*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21724
 21725     GO TO 8583-EXIT
 21726     .
 21727 8583-AGTC-NOT-FOUND.
 21728
 21729     MOVE 'N'                    TO AGTC-MASTER-SW.
 21730
 21731 8583-EXIT.
 21732     EXIT.
 21733
 21734 8584-READ-BANK-CROSS-REF.
 21735
 21736* EXEC CICS HANDLE CONDITION
 21737*        NOTFND    (8584-BXRF-NOT-FOUND)
 21738*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21739*    END-EXEC.
 21740*    MOVE '"$I''                  ! 9 #00020485' TO DFHEIV0
 21741     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21742     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21743     MOVE X'3920233030303230343835' TO DFHEIV0(25:11)
 21744     CALL 'kxdfhei1' USING DFHEIV0
 21745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21746
 21747
 21748
 21749* EXEC CICS READ
 21750*        DATASET     (BXRF-ID)
 21751*        INTO        (BANK-CROSS-REFERENCE)
 21752*        RIDFLD      (ERBXRF-KEY)
 21753*        LENGTH      (BXRF-REC-LENGTH)
 21754*    END-EXEC.
 21755*    MOVE '&"IL       E          (   #00020490' TO DFHEIV0
 21756     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21757     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21758     MOVE X'2020233030303230343930' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 402
* EL050.cbl
 21759     CALL 'kxdfhei1' USING DFHEIV0,
 21760           BXRF-ID,
 21761           BANK-CROSS-REFERENCE,
 21762           BXRF-REC-LENGTH,
 21763           ERBXRF-KEY,
 21764           DFHEIV99,
 21765           DFHEIV99,
 21766           DFHEIV99
 21767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21768
 21769
 21770     MOVE 'Y'                    TO BXRF-MASTER-SW
 21771
 21772     GO TO 8584-EXIT
 21773     .
 21774 8584-BXRF-NOT-FOUND.
 21775
 21776     MOVE 'N'                    TO BXRF-MASTER-SW.
 21777
 21778 8584-EXIT.
 21779     EXIT.
 21780
 21781 8585-READ-PLAN-MASTER.
 21782
 21783
 21784* EXEC CICS HANDLE CONDITION
 21785*        NOTFND    (8585-PLAN-NOT-FOUND)
 21786*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21787*    END-EXEC.
 21788*    MOVE '"$I''                  ! : #00020510' TO DFHEIV0
 21789     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21791     MOVE X'3A20233030303230353130' TO DFHEIV0(25:11)
 21792     CALL 'kxdfhei1' USING DFHEIV0
 21793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21794
 21795
 21796
 21797* EXEC CICS READ
 21798*        DATASET     (PLAN-ID)
 21799*        INTO        (PLAN-MASTER)
 21800*        RIDFLD      (ERPLAN-KEY)
 21801*    END-EXEC.
 21802     MOVE LENGTH OF
 21803      PLAN-MASTER
 21804       TO DFHEIV11
 21805*    MOVE '&"IL       E          (   #00020515' TO DFHEIV0
 21806     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21808     MOVE X'2020233030303230353135' TO DFHEIV0(25:11)
 21809     CALL 'kxdfhei1' USING DFHEIV0,
 21810           PLAN-ID,
 21811           PLAN-MASTER,
 21812           DFHEIV11,
 21813           ERPLAN-KEY,
 21814           DFHEIV99,
 21815           DFHEIV99,
 21816           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 403
* EL050.cbl
 21817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21818
 21819
 21820     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21821
 21822     GO TO 8585-EXIT.
 21823
 21824 8585-PLAN-NOT-FOUND.
 21825
 21826     MOVE 'N'                    TO PLAN-MASTER-SW.
 21827
 21828 8585-EXIT.
 21829     EXIT.
 21830
 21831 8586-READ-LOAN-OFFICER.
 21832
 21833* EXEC CICS READ
 21834*        DATASET     (LOFC-ID)
 21835*        INTO        (LOAN-OFFICER-MASTER)
 21836*        RIDFLD      (ERLOFC-KEY)
 21837*        RESP        (WS-RESPONSE)
 21838*    END-EXEC
 21839     MOVE LENGTH OF
 21840      LOAN-OFFICER-MASTER
 21841       TO DFHEIV11
 21842*    MOVE '&"IL       E          (  N#00020533' TO DFHEIV0
 21843     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21844     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21845     MOVE X'204E233030303230353333' TO DFHEIV0(25:11)
 21846     CALL 'kxdfhei1' USING DFHEIV0,
 21847           LOFC-ID,
 21848           LOAN-OFFICER-MASTER,
 21849           DFHEIV11,
 21850           ERLOFC-KEY,
 21851           DFHEIV99,
 21852           DFHEIV99,
 21853           DFHEIV99
 21854     MOVE EIBRESP  TO WS-RESPONSE
 21855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21856
 21857     IF WS-RESP-NORMAL
 21858        MOVE 'Y'                 TO LOFC-MASTER-SW
 21859     ELSE
 21860        MOVE 'N'                 TO LOFC-MASTER-SW
 21861     END-IF
 21862     .
 21863 8586-EXIT.
 21864     EXIT.
 21865 8587-START-ERPDEF.
 21866
 21867* EXEC CICS STARTBR
 21868*       DATASET   (PDEF-ID)
 21869*       RIDFLD    (ERPDEF-KEY)
 21870*       GTEQ
 21871*       RESP      (WS-RESPONSE)
 21872*    END-EXEC
 21873     MOVE 0
 21874       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 404
* EL050.cbl
 21875*    MOVE '&,         G          &  N#00020549' TO DFHEIV0
 21876     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21877     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21878     MOVE X'204E233030303230353439' TO DFHEIV0(25:11)
 21879     CALL 'kxdfhei1' USING DFHEIV0,
 21880           PDEF-ID,
 21881           ERPDEF-KEY,
 21882           DFHEIV99,
 21883           DFHEIV11,
 21884           DFHEIV99
 21885     MOVE EIBRESP  TO WS-RESPONSE
 21886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21887     IF WS-RESP-NORMAL
 21888        MOVE 'Y'                 TO PDEF-MASTER-SW
 21889     ELSE
 21890        MOVE 'N'                 TO PDEF-MASTER-SW
 21891     END-IF
 21892     .
 21893 8587-EXIT.
 21894     EXIT.
 21895 8588-READ-ERPDEF.
 21896
 21897* EXEC CICS READNEXT
 21898*       DATASET   (PDEF-ID)
 21899*       RIDFLD    (ERPDEF-KEY)
 21900*       INTO      (PRODUCT-MASTER)
 21901*       RESP      (WS-RESPONSE)
 21902*    END-EXEC
 21903     MOVE LENGTH OF
 21904      PRODUCT-MASTER
 21905       TO DFHEIV12
 21906     MOVE 0
 21907       TO DFHEIV11
 21908*    MOVE '&.IL                  )  N#00020564' TO DFHEIV0
 21909     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21910     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21911     MOVE X'204E233030303230353634' TO DFHEIV0(25:11)
 21912     CALL 'kxdfhei1' USING DFHEIV0,
 21913           PDEF-ID,
 21914           PRODUCT-MASTER,
 21915           DFHEIV12,
 21916           ERPDEF-KEY,
 21917           DFHEIV99,
 21918           DFHEIV11,
 21919           DFHEIV99,
 21920           DFHEIV99
 21921     MOVE EIBRESP  TO WS-RESPONSE
 21922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21923     IF WS-RESP-NORMAL
 21924        MOVE 'Y'                 TO PDEF-MASTER-SW
 21925     ELSE
 21926        MOVE 'N'                 TO PDEF-MASTER-SW
 21927     END-IF
 21928     .
 21929 8588-EXIT.
 21930     EXIT.
 21931 8589-ENDBR-ERPDEF.
 21932
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 405
* EL050.cbl
 21933* EXEC CICS ENDBR
 21934*       DATASET   (PDEF-ID)
 21935*    END-EXEC
 21936     MOVE 0
 21937       TO DFHEIV11
 21938*    MOVE '&2                    $   #00020579' TO DFHEIV0
 21939     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21940     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21941     MOVE X'2020233030303230353739' TO DFHEIV0(25:11)
 21942     CALL 'kxdfhei1' USING DFHEIV0,
 21943           PDEF-ID,
 21944           DFHEIV11,
 21945           DFHEIV99
 21946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21947     .
 21948 8589-EXIT.
 21949     EXIT.
 21950 8590-READ-CERT-MASTER.
 21951     IF PB-COMPANY-ID = 'UCL'
 21952         GO TO 8690-READ-CERT-MASTER-UCL.
 21953
 21954
 21955* EXEC CICS HANDLE CONDITION
 21956*         NOTFND    (0299-CERT-NOT-FOUND)
 21957*    END-EXEC.
 21958*    MOVE '"$I                   ! ; #00020589' TO DFHEIV0
 21959     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21960     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21961     MOVE X'3B20233030303230353839' TO DFHEIV0(25:11)
 21962     CALL 'kxdfhei1' USING DFHEIV0
 21963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21964
 21965
 21966
 21967* EXEC CICS READ
 21968*        DATASET     (CERT-ID)
 21969*        INTO        (CERTIFICATE-MASTER)
 21970*        RIDFLD      (ELCERT-KEY)
 21971*        UPDATE
 21972*    END-EXEC.
 21973     MOVE LENGTH OF
 21974      CERTIFICATE-MASTER
 21975       TO DFHEIV11
 21976*    MOVE '&"IL       EU         (   #00020593' TO DFHEIV0
 21977     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21978     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21979     MOVE X'2020233030303230353933' TO DFHEIV0(25:11)
 21980     CALL 'kxdfhei1' USING DFHEIV0,
 21981           CERT-ID,
 21982           CERTIFICATE-MASTER,
 21983           DFHEIV11,
 21984           ELCERT-KEY,
 21985           DFHEIV99,
 21986           DFHEIV99,
 21987           DFHEIV99
 21988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21989
 21990
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 406
* EL050.cbl
 21991 8590-EXIT.
 21992     EXIT.
 21993
 21994 8690-READ-CERT-MASTER-UCL.
 21995
 21996* EXEC CICS HANDLE CONDITION
 21997*         NOTFND    (8700-READ-CERT-MASTER)
 21998*    END-EXEC.
 21999*    MOVE '"$I                   ! < #00020604' TO DFHEIV0
 22000     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22001     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22002     MOVE X'3C20233030303230363034' TO DFHEIV0(25:11)
 22003     CALL 'kxdfhei1' USING DFHEIV0
 22004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22005
 22006
 22007 8690-READ-CERT-CONT.
 22008
 22009* EXEC CICS READ
 22010*        DATASET     (CERT-ID)
 22011*        INTO        (CERTIFICATE-MASTER)
 22012*        RIDFLD      (ELCERT-KEY)
 22013*        UPDATE
 22014*    END-EXEC.
 22015     MOVE LENGTH OF
 22016      CERTIFICATE-MASTER
 22017       TO DFHEIV11
 22018*    MOVE '&"IL       EU         (   #00020609' TO DFHEIV0
 22019     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22020     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22021     MOVE X'2020233030303230363039' TO DFHEIV0(25:11)
 22022     CALL 'kxdfhei1' USING DFHEIV0,
 22023           CERT-ID,
 22024           CERTIFICATE-MASTER,
 22025           DFHEIV11,
 22026           ELCERT-KEY,
 22027           DFHEIV99,
 22028           DFHEIV99,
 22029           DFHEIV99
 22030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22031
 22032
 22033     GO TO 8590-EXIT.
 22034
 22035 8700-READ-CERT-MASTER.
 22036     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 22037     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 22038
 22039* EXEC CICS HANDLE CONDITION
 22040*         DUPKEY    (8720-COMP-ACCOUNTS)
 22041*         ENDFILE   (8730-END-BROWSE)
 22042*         NOTFND    (8740-NOT-FOUND)
 22043*    END-EXEC.
 22044*    MOVE '"$$''I                 ! = #00020621' TO DFHEIV0
 22045     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 22046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22047     MOVE X'3D20233030303230363231' TO DFHEIV0(25:11)
 22048     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 407
* EL050.cbl
 22049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22050
 22051
 22052
 22053* EXEC CICS STARTBR
 22054*        DATASET     ('ELCERT5')
 22055*        RIDFLD      (ELCERT2-KEY)
 22056*        EQUAL
 22057*    END-EXEC.
 22058     MOVE 'ELCERT5' TO DFHEIV1
 22059     MOVE 0
 22060       TO DFHEIV11
 22061*    MOVE '&,         E          &   #00020627' TO DFHEIV0
 22062     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 22063     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22064     MOVE X'2020233030303230363237' TO DFHEIV0(25:11)
 22065     CALL 'kxdfhei1' USING DFHEIV0,
 22066           DFHEIV1,
 22067           ELCERT2-KEY,
 22068           DFHEIV99,
 22069           DFHEIV11,
 22070           DFHEIV99
 22071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22072
 22073
 22074 8710-READ-NEXT.
 22075
 22076* EXEC CICS READNEXT
 22077*        DATASET     ('ELCERT5')
 22078*        INTO        (CERTIFICATE-MASTER)
 22079*        RIDFLD      (ELCERT2-KEY)
 22080*    END-EXEC.
 22081     MOVE LENGTH OF
 22082      CERTIFICATE-MASTER
 22083       TO DFHEIV12
 22084     MOVE 'ELCERT5' TO DFHEIV1
 22085     MOVE 0
 22086       TO DFHEIV11
 22087*    MOVE '&.IL                  )   #00020634' TO DFHEIV0
 22088     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22089     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22090     MOVE X'2020233030303230363334' TO DFHEIV0(25:11)
 22091     CALL 'kxdfhei1' USING DFHEIV0,
 22092           DFHEIV1,
 22093           CERTIFICATE-MASTER,
 22094           DFHEIV12,
 22095           ELCERT2-KEY,
 22096           DFHEIV99,
 22097           DFHEIV11,
 22098           DFHEIV99,
 22099           DFHEIV99
 22100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22101
 22102
 22103 8720-COMP-ACCOUNTS.
 22104
 22105* EXEC CICS ENTER
 22106*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 408
* EL050.cbl
 22107*         FROM (PB-C-LAST-NAME)
 22108*    END-EXEC.
 22109     MOVE 001
 22110       TO DFHEIV11
 22111*    MOVE ':$F                   %   #00020641' TO DFHEIV0
 22112     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22113     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22114     MOVE X'2020233030303230363431' TO DFHEIV0(25:11)
 22115     CALL 'kxdfhei1' USING DFHEIV0,
 22116           DFHEIV11,
 22117           PB-C-LAST-NAME,
 22118           DFHEIV99,
 22119           DFHEIV99
 22120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22121
 22122
 22123
 22124* EXEC CICS ENTER
 22125*         TRACEID (002)
 22126*         FROM (CM-INSURED-LAST-NAME)
 22127*    END-EXEC.
 22128     MOVE 002
 22129       TO DFHEIV11
 22130*    MOVE ':$F                   %   #00020646' TO DFHEIV0
 22131     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22132     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22133     MOVE X'2020233030303230363436' TO DFHEIV0(25:11)
 22134     CALL 'kxdfhei1' USING DFHEIV0,
 22135           DFHEIV11,
 22136           CM-INSURED-LAST-NAME,
 22137           DFHEIV99,
 22138           DFHEIV99
 22139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22140
 22141
 22142     IF PB-CERT-NO NOT = CM-CERT-NO
 22143         GO TO 8730-END-BROWSE.
 22144
 22145     IF PB-ACCOUNT = CM-ACCOUNT
 22146         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22147             MOVE ER-2799        TO WS-ERROR
 22148             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22149             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22150             GO TO 8730-END-BROWSE.
 22151
 22152     GO TO 8710-READ-NEXT.
 22153
 22154 8730-END-BROWSE.
 22155
 22156* EXEC CICS ENDBR
 22157*         DATASET    ('ELCERT5')
 22158*    END-EXEC.
 22159     MOVE 'ELCERT5' TO DFHEIV1
 22160     MOVE 0
 22161       TO DFHEIV11
 22162*    MOVE '&2                    $   #00020664' TO DFHEIV0
 22163     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22164     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 409
* EL050.cbl
 22165     MOVE X'2020233030303230363634' TO DFHEIV0(25:11)
 22166     CALL 'kxdfhei1' USING DFHEIV0,
 22167           DFHEIV1,
 22168           DFHEIV11,
 22169           DFHEIV99
 22170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22171
 22172
 22173 8740-NOT-FOUND.
 22174     GO TO 0299-CERT-NOT-FOUND.
 22175
 22176 8750-START-ELSTAT.
 22177
 22178* EXEC CICS STARTBR
 22179*       DATASET   (STAT-ID)
 22180*       RIDFLD    (ELSTAT-KEY)
 22181*       GTEQ
 22182*       RESP      (WS-RESPONSE)
 22183*    END-EXEC
 22184     MOVE 0
 22185       TO DFHEIV11
 22186*    MOVE '&,         G          &  N#00020672' TO DFHEIV0
 22187     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22188     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22189     MOVE X'204E233030303230363732' TO DFHEIV0(25:11)
 22190     CALL 'kxdfhei1' USING DFHEIV0,
 22191           STAT-ID,
 22192           ELSTAT-KEY,
 22193           DFHEIV99,
 22194           DFHEIV11,
 22195           DFHEIV99
 22196     MOVE EIBRESP  TO WS-RESPONSE
 22197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22198     IF WS-RESP-NORMAL
 22199        MOVE 'Y'                 TO STAT-MASTER-SW
 22200     ELSE
 22201        MOVE 'N'                 TO STAT-MASTER-SW
 22202     END-IF
 22203     .
 22204 8750-EXIT.
 22205     EXIT.
 22206 8752-READ-ELSTAT.
 22207
 22208* EXEC CICS READNEXT
 22209*       DATASET   (STAT-ID)
 22210*       RIDFLD    (ELSTAT-KEY)
 22211*       INTO      (STATE-FILE)
 22212*       RESP      (WS-RESPONSE)
 22213*    END-EXEC
 22214     MOVE LENGTH OF
 22215      STATE-FILE
 22216       TO DFHEIV12
 22217     MOVE 0
 22218       TO DFHEIV11
 22219*    MOVE '&.IL                  )  N#00020687' TO DFHEIV0
 22220     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22221     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22222     MOVE X'204E233030303230363837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 410
* EL050.cbl
 22223     CALL 'kxdfhei1' USING DFHEIV0,
 22224           STAT-ID,
 22225           STATE-FILE,
 22226           DFHEIV12,
 22227           ELSTAT-KEY,
 22228           DFHEIV99,
 22229           DFHEIV11,
 22230           DFHEIV99,
 22231           DFHEIV99
 22232     MOVE EIBRESP  TO WS-RESPONSE
 22233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22234     IF WS-RESP-NORMAL
 22235        MOVE 'Y'                 TO STAT-MASTER-SW
 22236     ELSE
 22237        MOVE 'N'                 TO STAT-MASTER-SW
 22238     END-IF
 22239     .
 22240 8752-EXIT.
 22241     EXIT.
 22242 8800-GET-COMP-RATE.
 22243     MOVE +1 TO IB.
 22244     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22245         ADD +9 TO IB
 22246         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22247             ADD +9 TO IB
 22248             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22249                MOVE ZEROS       TO WS-WK-RATE
 22250                GO TO 8800-EXIT.
 22251
 22252     IF PB-I-AGE GREATER CT-AGE (1)
 22253         ADD +3 TO IB
 22254         IF PB-I-AGE GREATER CT-AGE (2)
 22255             ADD +3 TO IB
 22256             IF PB-I-AGE GREATER CT-AGE (3)
 22257                MOVE ZEROS       TO WS-WK-RATE
 22258                GO TO 8800-EXIT.
 22259
 22260     IF WS-WORK-TERM GREATER CT-TRM (1)
 22261         ADD +1 TO IB
 22262         IF WS-WORK-TERM GREATER CT-TRM (2)
 22263             ADD +1 TO IB
 22264             IF WS-WORK-TERM GREATER CT-TRM (3)
 22265                MOVE ZEROS       TO WS-WK-RATE
 22266                GO TO 8800-EXIT.
 22267
 22268     IF CT-RT (IB) NOT NUMERIC
 22269         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22270         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22271         GO TO 8800-GET-COMP-RATE.
 22272
 22273     MOVE CT-RT (IB) TO WS-WK-RATE.
 22274
 22275 8800-EXIT.
 22276     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 411
* EL050.cbl
 22278 8900-ADDRESS-FILE.
 22279     IF ERACCT-FILE-ADDRESSED
 22280         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22281         GO TO 8900-ADDRESS-EXIT.
 22282
 22283     IF ELCNTL-FILE-ADDRESSED
 22284         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22285         GO TO 8900-ADDRESS-EXIT.
 22286
 22287     IF ERPLAN-FILE-ADDRESSED
 22288         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22289         GO TO 8900-ADDRESS-EXIT.
 22290
 22291     IF ERFORM-FILE-ADDRESSED
 22292         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22293         GO TO 8900-ADDRESS-EXIT.
 22294
 22295 8900-ADDRESS-EXIT.
 22296     EXIT.
 22297
 22298 9000-READ-CONTROL.
 22299
 22300* EXEC CICS HANDLE CONDITION
 22301*        NOTFND    (9000-NOTFND)
 22302*    END-EXEC.
 22303*    MOVE '"$I                   ! > #00020758' TO DFHEIV0
 22304     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22306     MOVE X'3E20233030303230373538' TO DFHEIV0(25:11)
 22307     CALL 'kxdfhei1' USING DFHEIV0
 22308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22309
 22310
 22311
 22312* EXEC CICS READ
 22313*        DATASET     (CNTL-ID)
 22314*        SET         (ADDRESS OF CONTROL-FILE)
 22315*        RIDFLD      (ELCNTL-KEY)
 22316*        GTEQ
 22317*    END-EXEC.
 22318*    MOVE '&"S        G          (   #00020762' TO DFHEIV0
 22319     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22320     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22321     MOVE X'2020233030303230373632' TO DFHEIV0(25:11)
 22322     CALL 'kxdfhei1' USING DFHEIV0,
 22323           CNTL-ID,
 22324           DFHEIV20,
 22325           DFHEIV99,
 22326           ELCNTL-KEY,
 22327           DFHEIV99,
 22328           DFHEIV99,
 22329           DFHEIV99
 22330     SET ADDRESS OF CONTROL-FILE TO
 22331         DFHEIV20
 22332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22333
 22334
 22335     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 412
* EL050.cbl
 22336
 22337 9000-NOTFND.
 22338     IF RC-SW-1 = '1'
 22339        MOVE ER-2616              TO WS-ERROR
 22340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22341        GO TO 9000-EXIT.
 22342
 22343     IF RC-SW-1 = '2'
 22344        MOVE ER-2602              TO WS-ERROR
 22345        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22346
 22347 9000-EXIT.
 22348      EXIT.
 22349
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 413
* EL050.cbl
 22351 9100-READ-CONTROL.
 22352
 22353* EXEC CICS HANDLE CONDITION
 22354*        NOTFND  (9100-NOTFND)
 22355*        ENDFILE (9100-NOTFND)
 22356*    END-EXEC.
 22357*    MOVE '"$I''                  ! ? #00020786' TO DFHEIV0
 22358     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22359     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22360     MOVE X'3F20233030303230373836' TO DFHEIV0(25:11)
 22361     CALL 'kxdfhei1' USING DFHEIV0
 22362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22363
 22364
 22365
 22366* EXEC CICS READ
 22367*        DATASET     (CNTL-ID)
 22368*        INTO        (CONTROL-FILE)
 22369*        RIDFLD      (ELCNTL-KEY)
 22370*        GTEQ
 22371*    END-EXEC.
 22372     MOVE LENGTH OF
 22373      CONTROL-FILE
 22374       TO DFHEIV11
 22375*    MOVE '&"IL       G          (   #00020791' TO DFHEIV0
 22376     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22378     MOVE X'2020233030303230373931' TO DFHEIV0(25:11)
 22379     CALL 'kxdfhei1' USING DFHEIV0,
 22380           CNTL-ID,
 22381           CONTROL-FILE,
 22382           DFHEIV11,
 22383           ELCNTL-KEY,
 22384           DFHEIV99,
 22385           DFHEIV99,
 22386           DFHEIV99
 22387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22388
 22389
 22390     GO TO 9100-EXIT.
 22391
 22392 9100-NOTFND.
 22393     IF RC-SW-2 = '0'
 22394        MOVE '1'                  TO STATE-RECORD-ERROR
 22395        GO TO 9100-EXIT
 22396     END-IF
 22397     IF RC-SW-2 = '1'
 22398        MOVE '1'                  TO LF-BENEFIT-ERROR
 22399        MOVE ER-2604              TO WS-ERROR
 22400        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22401        GO TO 9100-EXIT.
 22402
 22403     IF RC-SW-2 = '2'
 22404        MOVE '1'                  TO AH-BENEFIT-ERROR
 22405        MOVE ER-2605              TO WS-ERROR
 22406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22407        GO TO 9100-EXIT.
 22408
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 414
* EL050.cbl
 22409     IF RC-SW-2 = '3'
 22410         MOVE ER-2603           TO WS-ERROR
 22411         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22412         GO TO 9100-EXIT.
 22413
 22414     IF RC-SW-2 = '4'
 22415         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22416         GO TO 9100-EXIT.
 22417
 22418     IF RC-SW-2 = '5'
 22419         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22420         IF WS-AH-INPUT-CD-1 = SPACE
 22421             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22422         ELSE
 22423             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22424
 22425 9100-EXIT.
 22426      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 415
* EL050.cbl
 22428 9200-CONTROL-GETMAIN.
 22429
 22430* EXEC CICS GETMAIN
 22431*         LENGTH   (750)
 22432*         SET      (ADDRESS OF CONTROL-FILE)
 22433*    END-EXEC.
 22434     MOVE 750
 22435       TO DFHEIV11
 22436*    MOVE '," L                  $   #00020837' TO DFHEIV0
 22437     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22438     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22439     MOVE X'2020233030303230383337' TO DFHEIV0(25:11)
 22440     CALL 'kxdfhei1' USING DFHEIV0,
 22441           DFHEIV20,
 22442           DFHEIV11,
 22443           DFHEIV99
 22444     SET ADDRESS OF CONTROL-FILE TO
 22445         DFHEIV20
 22446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22447
 22448
 22449     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22450
 22451 9200-EXIT.
 22452     EXIT.
 22453
 22454 9250-UNLOCK-RETURN.
 22455
 22456* EXEC CICS UNLOCK
 22457*        DATASET   (CERT-ID)
 22458*    END-EXEC.
 22459*    MOVE '&*                    #   #00020848' TO DFHEIV0
 22460     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22461     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22462     MOVE X'2020233030303230383438' TO DFHEIV0(25:11)
 22463     CALL 'kxdfhei1' USING DFHEIV0,
 22464           CERT-ID,
 22465           DFHEIV99
 22466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22467
 22468
 22469 9300-ABEND.
 22470     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22471
 22472
 22473* EXEC CICS LINK
 22474*        PROGRAM   ('EL004')
 22475*        COMMAREA  (WS-ERROR-LINE)
 22476*        LENGTH    (72)
 22477*    END-EXEC.
 22478     MOVE 'EL004' TO DFHEIV1
 22479     MOVE 72
 22480       TO DFHEIV11
 22481*    MOVE '."C                   (   #00020855' TO DFHEIV0
 22482     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22483     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22484     MOVE X'2020233030303230383535' TO DFHEIV0(25:11)
 22485     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 416
* EL050.cbl
 22486           DFHEIV1,
 22487           WS-ERROR-LINE,
 22488           DFHEIV11,
 22489           DFHEIV99,
 22490           DFHEIV99,
 22491           DFHEIV99,
 22492           DFHEIV99
 22493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22494
 22495
 22496     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22497
 22498
 22499* EXEC CICS ABEND
 22500*        ABCODE ('EL50')
 22501*    END-EXEC.
 22502     MOVE 'EL50' TO DFHEIV5
 22503*    MOVE '.,A                   "   #00020863' TO DFHEIV0
 22504     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22505     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22506     MOVE X'2020233030303230383633' TO DFHEIV0(25:11)
 22507     CALL 'kxdfhei1' USING DFHEIV0,
 22508           DFHEIV5
 22509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22510
 22511
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 417
* EL050.cbl
 22513
 22514******************************************************************
 22515*                                                                *
 22516*            E R R O R   F O R M A T   R O U T I N E             *
 22517*                                                                *
 22518******************************************************************
 22519
 22520 9900-ERROR-FORMAT.
 22521
 22522     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22523                    PB-COMMON-ERROR (2) OR
 22524                    PB-COMMON-ERROR (3) OR
 22525                    PB-COMMON-ERROR (4) OR
 22526                    PB-COMMON-ERROR (5) OR
 22527                    PB-COMMON-ERROR (6) OR
 22528                    PB-COMMON-ERROR (7) OR
 22529                    PB-COMMON-ERROR (8) OR
 22530                    PB-COMMON-ERROR (9) OR
 22531                    PB-COMMON-ERROR (10)
 22532        GO TO 9900-EXIT.
 22533
 22534     IF PB-NO-OF-ERRORS = +10
 22535        GO TO 9900-EXIT.
 22536
 22537     ADD +1  TO PB-NO-OF-ERRORS.
 22538     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22539                                       (PB-NO-OF-ERRORS).
 22540 9900-EXIT.
 22541     EXIT.
 22542
 22543 9990-RETURN.
 22544     IF BROWSE-STARTED
 22545
 22546* EXEC CICS ENDBR
 22547*            DATASET  (ACCT-ID)
 22548*       END-EXEC.
 22549     MOVE 0
 22550       TO DFHEIV11
 22551*    MOVE '&2                    $   #00020900' TO DFHEIV0
 22552     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22553     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22554     MOVE X'2020233030303230393030' TO DFHEIV0(25:11)
 22555     CALL 'kxdfhei1' USING DFHEIV0,
 22556           ACCT-ID,
 22557           DFHEIV11,
 22558           DFHEIV99
 22559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22560
 22561
 22562 9990-EXIT.
 22563     EXIT.
 22564
 22565
 22566****Check for CRTO record, add one if not found.
 22567 9991-CHECK-FOR-ELCRTO.
 22568
 22569* EXEC CICS HANDLE CONDITION
 22570*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 418
* EL050.cbl
 22571*         ENDFILE (9991-CRTO-NOT-FOUND)
 22572*     END-EXEC.
 22573*    MOVE '"$I''                  ! @ #00020910' TO DFHEIV0
 22574     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22576     MOVE X'4020233030303230393130' TO DFHEIV0(25:11)
 22577     CALL 'kxdfhei1' USING DFHEIV0
 22578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22579
 22580     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22581     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22582     MOVE +0                     TO ELCRTO-SEQ-NO
 22583
 22584
 22585* EXEC CICS READ
 22586*       DATASET   ('ELCRTO')
 22587*       INTO      (ORIGINAL-CERTIFICATE)
 22588*       RIDFLD    (ELCRTO-KEY)
 22589*       GTEQ
 22590*       RESP      (WS-RESPONSE)
 22591*    END-EXEC
 22592     MOVE LENGTH OF
 22593      ORIGINAL-CERTIFICATE
 22594       TO DFHEIV11
 22595     MOVE 'ELCRTO' TO DFHEIV1
 22596*    MOVE '&"IL       G          (  N#00020918' TO DFHEIV0
 22597     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22599     MOVE X'204E233030303230393138' TO DFHEIV0(25:11)
 22600     CALL 'kxdfhei1' USING DFHEIV0,
 22601           DFHEIV1,
 22602           ORIGINAL-CERTIFICATE,
 22603           DFHEIV11,
 22604           ELCRTO-KEY,
 22605           DFHEIV99,
 22606           DFHEIV99,
 22607           DFHEIV99
 22608     MOVE EIBRESP  TO WS-RESPONSE
 22609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22610
 22611     IF WS-RESP-NORMAL
 22612        AND (OC-CONTROL-PRIMARY (1:33) =
 22613                 PB-CONTROL-BY-ACCOUNT (1:33))
 22614        AND (OC-RECORD-TYPE =  'I')
 22615           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22616               GO TO 9991-CHECK-INDICATORS
 22617           ELSE
 22618               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22619               GO TO 9991-CRTO-ADD-REC
 22620           END-IF
 22621     END-IF.
 22622
 22623 9991-CRTO-NOT-FOUND.
 22624
 22625     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22626     MOVE 'OC'                TO OC-RECORD-ID
 22627     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22628                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 419
* EL050.cbl
 22629     MOVE +4096               TO OC-KEY-SEQ-NO.
 22630
 22631 9991-CRTO-ADD-REC.
 22632
 22633     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22634     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22635     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22636     MOVE 'I'                 TO OC-RECORD-TYPE
 22637     IF PB-ISSUE
 22638         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22639         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22640         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22641         MOVE PB-I-AGE               TO OC-INS-AGE
 22642         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22643         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22644         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22645         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22646         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22647         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22648         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22649         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22650         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22651         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22652         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22653         IF PB-I-JOINT-COMMISSION > +0
 22654             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22655         ELSE
 22656             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22657         END-IF
 22658         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22659         MOVE +0                     TO OC-LF-CANCEL-AMT
 22660                                        OC-LF-ITD-CANCEL-AMT
 22661         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22662         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22663         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22664         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22665         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22666         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22667         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22668         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22669         MOVE +0                     TO OC-AH-CANCEL-AMT
 22670                                        OC-AH-ITD-CANCEL-AMT
 22671         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22672         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22673         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22674     ELSE
 22675         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22676         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22677         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22678         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22679         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22680         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22681         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22682         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22683         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22684          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22685             MOVE SPACES             TO OC-LF-BENCD
 22686             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 420
* EL050.cbl
 22687                                        OC-LF-BEN-AMT
 22688                                        OC-LF-PRM-AMT
 22689                                        OC-LF-ALT-BEN-AMT
 22690                                        OC-LF-ALT-PRM-AMT
 22691                                        OC-LF-COMM-PCT
 22692                                        OC-LF-CANCEL-AMT
 22693             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22694             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22695         ELSE
 22696             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22697             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22698             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22699             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22700             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22701             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22702             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22703             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22704             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22705             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22706         END-IF
 22707         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22708         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22709          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22710             MOVE SPACES             TO OC-AH-BENCD
 22711             MOVE ZEROS              TO OC-AH-TERM
 22712                                        OC-AH-BEN-AMT
 22713                                        OC-AH-PRM-AMT
 22714                                        OC-AH-COMM-PCT
 22715                                        OC-AH-CANCEL-AMT
 22716                                        OC-AH-CP
 22717             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22718             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22719         ELSE
 22720             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22721             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22722             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22723             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22724             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22725             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22726             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22727             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22728             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22729         END-IF
 22730         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22731         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22732         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22733         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22734     END-IF
 22735     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22736
 22737     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22738
 22739
 22740* EXEC CICS READ
 22741*         DATASET   (FILE-ERMAIL)
 22742*         RIDFLD    (MA-CONTROL-PRIMARY)
 22743*         INTO      (MAILING-DATA)
 22744*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 421
* EL050.cbl
 22745*    END-EXEC
 22746     MOVE LENGTH OF
 22747      MAILING-DATA
 22748       TO DFHEIV11
 22749*    MOVE '&"IL       E          (  N#00021054' TO DFHEIV0
 22750     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22751     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22752     MOVE X'204E233030303231303534' TO DFHEIV0(25:11)
 22753     CALL 'kxdfhei1' USING DFHEIV0,
 22754           FILE-ERMAIL,
 22755           MAILING-DATA,
 22756           DFHEIV11,
 22757           MA-CONTROL-PRIMARY,
 22758           DFHEIV99,
 22759           DFHEIV99,
 22760           DFHEIV99
 22761     MOVE EIBRESP  TO WS-RESPONSE
 22762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22763
 22764     IF WS-RESP-NORMAL
 22765         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22766     END-IF.
 22767
 22768     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22769     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22770
 22771
 22772* EXEC CICS READ
 22773*         DATASET  (CRTT-ID)
 22774*         RIDFLD   (WS-ELCRTT-KEY)
 22775*         INTO     (CERTIFICATE-TRAILERS)
 22776*         RESP     (WS-RESPONSE)
 22777*    END-EXEC
 22778     MOVE LENGTH OF
 22779      CERTIFICATE-TRAILERS
 22780       TO DFHEIV11
 22781*    MOVE '&"IL       E          (  N#00021068' TO DFHEIV0
 22782     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22784     MOVE X'204E233030303231303638' TO DFHEIV0(25:11)
 22785     CALL 'kxdfhei1' USING DFHEIV0,
 22786           CRTT-ID,
 22787           CERTIFICATE-TRAILERS,
 22788           DFHEIV11,
 22789           WS-ELCRTT-KEY,
 22790           DFHEIV99,
 22791           DFHEIV99,
 22792           DFHEIV99
 22793     MOVE EIBRESP  TO WS-RESPONSE
 22794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22795
 22796     IF WS-RESP-NORMAL
 22797         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22798         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22799     END-IF.
 22800
 22801
 22802* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 422
* EL050.cbl
 22803*       DATASET   ('ELCRTO')
 22804*       FROM      (ORIGINAL-CERTIFICATE)
 22805*       RIDFLD    (OC-CONTROL-PRIMARY)
 22806*       RESP      (WS-RESPONSE)
 22807*    END-EXEC.
 22808     MOVE LENGTH OF
 22809      ORIGINAL-CERTIFICATE
 22810       TO DFHEIV11
 22811     MOVE 'ELCRTO' TO DFHEIV1
 22812*    MOVE '&$ L                  ''  N#00021080' TO DFHEIV0
 22813     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22814     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22815     MOVE X'204E233030303231303830' TO DFHEIV0(25:11)
 22816     CALL 'kxdfhei1' USING DFHEIV0,
 22817           DFHEIV1,
 22818           ORIGINAL-CERTIFICATE,
 22819           DFHEIV11,
 22820           OC-CONTROL-PRIMARY,
 22821           DFHEIV99,
 22822           DFHEIV99
 22823     MOVE EIBRESP  TO WS-RESPONSE
 22824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22825
 22826
 22827     GO TO 9991-EXIT.
 22828
 22829 9991-CHECK-INDICATORS.
 22830
 22831     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22832         GO TO 9991-EXIT
 22833     END-IF.
 22834
 22835     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22836         GO TO 9991-EXIT
 22837     END-IF.
 22838
 22839
 22840* EXEC CICS READ
 22841*       DATASET   ('ELCRTO')
 22842*       INTO      (ORIGINAL-CERTIFICATE)
 22843*       RIDFLD    (OC-CONTROL-PRIMARY)
 22844*       UPDATE
 22845*       RESP      (WS-RESPONSE)
 22846*    END-EXEC
 22847     MOVE LENGTH OF
 22848      ORIGINAL-CERTIFICATE
 22849       TO DFHEIV11
 22850     MOVE 'ELCRTO' TO DFHEIV1
 22851*    MOVE '&"IL       EU         (  N#00021099' TO DFHEIV0
 22852     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22853     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22854     MOVE X'204E233030303231303939' TO DFHEIV0(25:11)
 22855     CALL 'kxdfhei1' USING DFHEIV0,
 22856           DFHEIV1,
 22857           ORIGINAL-CERTIFICATE,
 22858           DFHEIV11,
 22859           OC-CONTROL-PRIMARY,
 22860           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 423
* EL050.cbl
 22861           DFHEIV99,
 22862           DFHEIV99
 22863     MOVE EIBRESP  TO WS-RESPONSE
 22864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22865     IF WS-RESP-NORMAL
 22866        IF PB-ISSUE
 22867          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22868          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22869          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22870          MOVE PB-I-AGE               TO OC-INS-AGE
 22871          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22872          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22873          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22874          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22875          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22876          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22877          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22878          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22879          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22880          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22881          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22882          IF PB-I-JOINT-COMMISSION > +0
 22883              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22884          ELSE
 22885              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22886          END-IF
 22887          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22888          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22889          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22890          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22891          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22892          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22893          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22894          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22895          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22896
 22897          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22898
 22899* EXEC CICS READ
 22900*             DATASET   (FILE-ERMAIL)
 22901*             RIDFLD    (MA-CONTROL-PRIMARY)
 22902*             INTO      (MAILING-DATA)
 22903*             RESP      (WS-RESPONSE)
 22904*         END-EXEC
 22905     MOVE LENGTH OF
 22906      MAILING-DATA
 22907       TO DFHEIV11
 22908*    MOVE '&"IL       E          (  N#00021139' TO DFHEIV0
 22909     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22911     MOVE X'204E233030303231313339' TO DFHEIV0(25:11)
 22912     CALL 'kxdfhei1' USING DFHEIV0,
 22913           FILE-ERMAIL,
 22914           MAILING-DATA,
 22915           DFHEIV11,
 22916           MA-CONTROL-PRIMARY,
 22917           DFHEIV99,
 22918           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 424
* EL050.cbl
 22919           DFHEIV99
 22920     MOVE EIBRESP  TO WS-RESPONSE
 22921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22922          IF WS-RESP-NORMAL
 22923             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22924          END-IF
 22925
 22926          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22927          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22928
 22929* EXEC CICS READ
 22930*             DATASET  (CRTT-ID)
 22931*             RIDFLD   (WS-ELCRTT-KEY)
 22932*             INTO     (CERTIFICATE-TRAILERS)
 22933*             RESP     (WS-RESPONSE)
 22934*         END-EXEC
 22935     MOVE LENGTH OF
 22936      CERTIFICATE-TRAILERS
 22937       TO DFHEIV11
 22938*    MOVE '&"IL       E          (  N#00021151' TO DFHEIV0
 22939     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22940     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22941     MOVE X'204E233030303231313531' TO DFHEIV0(25:11)
 22942     CALL 'kxdfhei1' USING DFHEIV0,
 22943           CRTT-ID,
 22944           CERTIFICATE-TRAILERS,
 22945           DFHEIV11,
 22946           WS-ELCRTT-KEY,
 22947           DFHEIV99,
 22948           DFHEIV99,
 22949           DFHEIV99
 22950     MOVE EIBRESP  TO WS-RESPONSE
 22951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22952          IF WS-RESP-NORMAL
 22953             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22954                               OC-INS-AGE-DEFAULT-FLAG
 22955             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22956                               OC-JNT-AGE-DEFAULT-FLAG
 22957          END-IF
 22958
 22959        ELSE
 22960          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22961             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22962             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22963             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22964          END-IF
 22965          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22966             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22967             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22968             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22969          END-IF
 22970          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22971        END-IF
 22972
 22973* EXEC CICS REWRITE
 22974*          DATASET   ('ELCRTO')
 22975*          FROM      (ORIGINAL-CERTIFICATE)
 22976*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 425
* EL050.cbl
 22977*       END-EXEC
 22978     MOVE LENGTH OF
 22979      ORIGINAL-CERTIFICATE
 22980       TO DFHEIV11
 22981     MOVE 'ELCRTO' TO DFHEIV1
 22982*    MOVE '&& L                  %  N#00021177' TO DFHEIV0
 22983     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22984     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22985     MOVE X'204E233030303231313737' TO DFHEIV0(25:11)
 22986     CALL 'kxdfhei1' USING DFHEIV0,
 22987           DFHEIV1,
 22988           ORIGINAL-CERTIFICATE,
 22989           DFHEIV11,
 22990           DFHEIV99
 22991     MOVE EIBRESP  TO WS-RESPONSE
 22992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22993     END-IF.
 22994
 22995 9991-EXIT.
 22996     EXIT.
 22997
 22998
 22999 9999-RETURN.
 23000     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 23001
 23002
 23003* EXEC CICS RETURN
 23004*    END-EXEC.
 23005*    MOVE '.(                    ''   #00021191' TO DFHEIV0
 23006     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23007     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23008     MOVE X'2020233030303231313931' TO DFHEIV0(25:11)
 23009     CALL 'kxdfhei1' USING DFHEIV0,
 23010           DFHEIV99,
 23011           DFHEIV99,
 23012           DFHEIV99,
 23013           DFHEIV99,
 23014           DFHEIV99,
 23015           DFHEIV99
 23016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23017
 23018
 23019
 23020* GOBACK.
 23021     MOVE '9%                    "   ' TO DFHEIV0
 23022     MOVE 'EL050' TO DFHEIV1
 23023     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23024     GOBACK.
 23025
 23026 9999-DFHBACK SECTION.
 23027     MOVE '9%                    "   ' TO DFHEIV0
 23028     MOVE 'EL050' TO DFHEIV1
 23029     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23030     GOBACK.
 23031 9999-DFHEXIT.
 23032     IF DFHEIGDJ EQUAL 0001
 23033         NEXT SENTENCE
 23034     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 426
* EL050.cbl
 23035         GO TO 9300-ABEND,
 23036               3990-FILES-NOT-OPEN
 23037         DEPENDING ON DFHEIGDI
 23038     ELSE IF DFHEIGDJ EQUAL 3
 23039         GO TO 6610-START-BROWSE,
 23040               6630-ERRESS-PROBLEM,
 23041               6630-END-OF-FILE
 23042         DEPENDING ON DFHEIGDI
 23043     ELSE IF DFHEIGDJ EQUAL 4
 23044         GO TO 6630-END-OF-FILE,
 23045               6630-ERRESS-PROBLEM,
 23046               6630-ERRESS-PROBLEM,
 23047               6630-END-OF-FILE
 23048         DEPENDING ON DFHEIGDI
 23049     ELSE IF DFHEIGDJ EQUAL 5
 23050         GO TO 6630-END-OF-FILE,
 23051               6630-END-OF-FILE,
 23052               6630-ERRESS-PROBLEM,
 23053               6630-ERRESS-PROBLEM
 23054         DEPENDING ON DFHEIGDI
 23055     ELSE IF DFHEIGDJ EQUAL 6
 23056         GO TO 6660-START-BROWSE,
 23057               6690-ERRESC-PROBLEM,
 23058               6690-ERRESC-PROBLEM,
 23059               6690-END-OF-FILE
 23060         DEPENDING ON DFHEIGDI
 23061     ELSE IF DFHEIGDJ EQUAL 7
 23062         GO TO 6690-END-OF-FILE,
 23063               6690-ERRESC-PROBLEM,
 23064               6690-ERRESC-PROBLEM,
 23065               6690-END-OF-FILE
 23066         DEPENDING ON DFHEIGDI
 23067     ELSE IF DFHEIGDJ EQUAL 8
 23068         GO TO 6690-END-OF-FILE,
 23069               6690-ERRESC-PROBLEM,
 23070               6690-ERRESC-PROBLEM,
 23071               6690-END-OF-FILE
 23072         DEPENDING ON DFHEIGDI
 23073     ELSE IF DFHEIGDJ EQUAL 9
 23074         GO TO 7250-CONTINUE,
 23075               7250-CONTINUE
 23076         DEPENDING ON DFHEIGDI
 23077     ELSE IF DFHEIGDJ EQUAL 10
 23078         GO TO 7300-CONTINUE,
 23079               7300-CONTINUE
 23080         DEPENDING ON DFHEIGDI
 23081     ELSE IF DFHEIGDJ EQUAL 11
 23082         GO TO 8000-FREE-MAIN
 23083         DEPENDING ON DFHEIGDI
 23084     ELSE IF DFHEIGDJ EQUAL 12
 23085         GO TO 8100-NOTFND,
 23086               8100-NOTFND
 23087         DEPENDING ON DFHEIGDI
 23088     ELSE IF DFHEIGDJ EQUAL 13
 23089         GO TO 8110-NOTFND,
 23090               8110-NOTFND
 23091         DEPENDING ON DFHEIGDI
 23092     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 427
* EL050.cbl
 23093         GO TO 8130-EXIT
 23094         DEPENDING ON DFHEIGDI
 23095     ELSE IF DFHEIGDJ EQUAL 15
 23096         GO TO 8145-exit
 23097         DEPENDING ON DFHEIGDI
 23098     ELSE IF DFHEIGDJ EQUAL 16
 23099         GO TO 8190-NOTFND
 23100         DEPENDING ON DFHEIGDI
 23101     ELSE IF DFHEIGDJ EQUAL 17
 23102         GO TO 8195-NOTFND
 23103         DEPENDING ON DFHEIGDI
 23104     ELSE IF DFHEIGDJ EQUAL 18
 23105         GO TO 8200-NOTFND
 23106         DEPENDING ON DFHEIGDI
 23107     ELSE IF DFHEIGDJ EQUAL 19
 23108         GO TO 8300-NOTFND,
 23109               8300-ERRESS-PROBLEM,
 23110               8300-ERRESS-PROBLEM,
 23111               8300-NOTFND
 23112         DEPENDING ON DFHEIGDI
 23113     ELSE IF DFHEIGDJ EQUAL 20
 23114         GO TO 8450-FORM-NOT-FOUND,
 23115               8450-FORM-NOT-FOUND
 23116         DEPENDING ON DFHEIGDI
 23117     ELSE IF DFHEIGDJ EQUAL 21
 23118         GO TO 0199-ACCT-NOT-FOUND,
 23119               0199-ACCT-NOT-FOUND
 23120         DEPENDING ON DFHEIGDI
 23121     ELSE IF DFHEIGDJ EQUAL 22
 23122         GO TO 0199-ACCT-NOT-FOUND,
 23123               0199-ACCT-NOT-FOUND
 23124         DEPENDING ON DFHEIGDI
 23125     ELSE IF DFHEIGDJ EQUAL 23
 23126         GO TO 8582-COMP-NOT-FOUND,
 23127               8582-COMP-NOT-FOUND
 23128         DEPENDING ON DFHEIGDI
 23129     ELSE IF DFHEIGDJ EQUAL 24
 23130         GO TO 8583-AGTC-NOT-FOUND,
 23131               8583-AGTC-NOT-FOUND
 23132         DEPENDING ON DFHEIGDI
 23133     ELSE IF DFHEIGDJ EQUAL 25
 23134         GO TO 8584-BXRF-NOT-FOUND,
 23135               8584-BXRF-NOT-FOUND
 23136         DEPENDING ON DFHEIGDI
 23137     ELSE IF DFHEIGDJ EQUAL 26
 23138         GO TO 8585-PLAN-NOT-FOUND,
 23139               8585-PLAN-NOT-FOUND
 23140         DEPENDING ON DFHEIGDI
 23141     ELSE IF DFHEIGDJ EQUAL 27
 23142         GO TO 0299-CERT-NOT-FOUND
 23143         DEPENDING ON DFHEIGDI
 23144     ELSE IF DFHEIGDJ EQUAL 28
 23145         GO TO 8700-READ-CERT-MASTER
 23146         DEPENDING ON DFHEIGDI
 23147     ELSE IF DFHEIGDJ EQUAL 29
 23148         GO TO 8720-COMP-ACCOUNTS,
 23149               8730-END-BROWSE,
 23150               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 428
* EL050.cbl
 23151         DEPENDING ON DFHEIGDI
 23152     ELSE IF DFHEIGDJ EQUAL 30
 23153         GO TO 9000-NOTFND
 23154         DEPENDING ON DFHEIGDI
 23155     ELSE IF DFHEIGDJ EQUAL 31
 23156         GO TO 9100-NOTFND,
 23157               9100-NOTFND
 23158         DEPENDING ON DFHEIGDI
 23159     ELSE IF DFHEIGDJ EQUAL 32
 23160         GO TO 9991-CRTO-NOT-FOUND,
 23161               9991-CRTO-NOT-FOUND
 23162         DEPENDING ON DFHEIGDI.
 23163     MOVE '9%                    "   ' TO DFHEIV0
 23164     MOVE 'EL050' TO DFHEIV1
 23165     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23166     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41808     Code:       95033
