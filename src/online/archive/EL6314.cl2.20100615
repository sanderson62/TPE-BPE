       IDENTIFICATION DIVISION.

       PROGRAM-ID.                 EL6314.
      *              PROGRAM CONVERTED BY
      *              COBOL CONVERSION AID PO 5785-ABJ
      *              CONVERSION DATE 01/12/96 10:01:33.
      *                            VMOD=2.015.
      *
      *
      *AUTHOR.        CENTRAL STATES HEALTH AND LIFE.
      *               OMAHA, NEBRASKA

      *DATE-COMPILED.

      *SECURITY.   *****************************************************
      *            *                                                   *
      *            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
      *            *   HEALTH AND LIFE                                 *
      *            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
      *            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
      *            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
      *            *                                                   *
      *            *****************************************************
052307*-----------------------------------------------------------------
052307*                   C H A N G E   L O G
052307*
052307* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
052307*-----------------------------------------------------------------
052307*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
052307* EFFECTIVE    NUMBER
052307*-----------------------------------------------------------------
052307* 052307   2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS  
052307*                               WITH OPEN CLAIMS
072209* 072209   2008101500003  AJRA  PRINT BORROWER FIRST NAME
111109* 111109   2008100900003  AJRA  UPDATE CERT WHEN NOTE DELETED
052307*-----------------------------------------------------------------

      *REMARKS.
      *        TRANSACTION - EXBA - ENDORSEMENT MAINTENANCE
       EJECT
       ENVIRONMENT DIVISION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       77  FILLER  PIC X(32)  VALUE '********************************'.
       77  FILLER  PIC X(32)  VALUE '*    EL6314 WORKING STORAGE    *'.
       77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
       77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.

           COPY ELCSCTM.

           COPY ELCSCRTY.
       EJECT

       01  STANDARD-AREAS.
           12  TIME-MT                 PIC S9(7).
           12  TIME-MT-R  REDEFINES TIME-MT.
               16  FILLER              PIC X.
               16  TIME-LMT            PIC 99V99.
               16  FILLER              PIC X(2).
           12  GETMAIN-SPACE           PIC X VALUE SPACES.
PEMMOD*    12  ERENDR-LENGTH           PIC S9(04) VALUE +373 COMP.
PEMMOD     12  ERENDR-LENGTH           PIC S9(04) VALUE +513 COMP.
           12  WS-ERNOTE-KEY.
               16  W-NOTE-COMPANY-CD   PIC X.
               16  W-NOTE-CARRIER      PIC X.
               16  W-NOTE-GROUPING     PIC X(6).
               16  W-NOTE-STATE        PIC XX.
               16  W-NOTE-ACCOUNT      PIC X(10).
               16  W-NOTE-CERT-EFF-DT  PIC XX.
               16  W-NOTE-CERT-PRIME   PIC X(10).
               16  W-NOTE-CERT-SFX     PIC X.
           12  WS-ERENDR-KEY.
               16  WS-COMPANY-CD       PIC X.
               16  WS-CARRIER          PIC X.
               16  WS-GROUPING         PIC X(6).
               16  WS-STATE            PIC XX.
               16  WS-ACCOUNT          PIC X(10).
               16  WS-CERT-EFF-DT      PIC XX.
               16  WS-CERT-PRIME       PIC X(10).
               16  WS-CERT-SFX         PIC X.
               16  WS-CHG-SEQ-NO       PIC S9(4) COMP.
               16  WS-RECORD-TYPE      PIC X.
           12  WS-ELCERT-KEY.
               16  CERT-COMPANY-CD     PIC X.
               16  CERT-CARRIER        PIC X.
               16  CERT-GROUPING       PIC X(6).
               16  CERT-STATE          PIC XX.
               16  CERT-ACCOUNT        PIC X(10).
               16  CERT-CERT-EFF-DT    PIC XX.
               16  CERT-CERT-PRIME     PIC X(10).
               16  CERT-CERT-SFX       PIC X.
           12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
           12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
           12  WS-CURRENT-DT.
               16  FILLER              PIC X(6)    VALUE SPACES.
               16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
           12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
           12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
               88  CANCEL-REC            VALUE 'C'.
               88  ISSUE-REC             VALUE 'I'.
           12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
           12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
           12  ELCNTL-KEY.
               16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
               16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
               16  CNTL-ACCESS.
                   20  CNTL-STATE      PIC XX    VALUE SPACES.
                   20  FILLER          PIC X     VALUE SPACES.
                   20  CNTL-CARRIER    PIC X     VALUE SPACES.
               16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
           12  ERACCT-KEY.
               16  ERACCT-COMP-KEY.
                   20  ACCT-CO         PIC X     VALUE SPACES.
                   20  ACCT-CARRIER    PIC X     VALUE SPACES.
                   20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
                   20  ACCT-STATE      PIC XX    VALUE SPACES.
                   20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
               16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
               16  FILLER              PIC X(4)  VALUE LOW-VALUES.
           12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
           12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
           12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
           12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
           12  WS-ERENDR-FILE-ID       PIC X(8) VALUE 'ERENDR'.
           12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
           12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
           12  WS-RESPONSE             PIC S9(8)   COMP.
               88  RESP-NORMAL                  VALUE +00.
               88  RESP-NOTFND                  VALUE +13.
               88  RESP-NOTOPEN                 VALUE +19.
               88  RESP-ENDFILE                 VALUE +20.
           12  MAP-NAME            PIC X(8)    VALUE 'EL631G'.
           12  MAPSET-NAME         PIC X(8)    VALUE 'EL6314S'.
           12  SCREEN-NUMBER       PIC X(4)    VALUE '631G'.
           12  TRANS-ID            PIC X(4)    VALUE 'EXBA'.
           12  THIS-PGM            PIC X(8)    VALUE 'EL6314'.
           12  PGM-NAME            PIC X(8).
           12  TIME-IN             PIC S9(7).
           12  TIME-OUT-R  REDEFINES TIME-IN.
               16  FILLER          PIC X.
               16  TIME-OUT        PIC 99V99.
               16  FILLER          PIC X(2).
           12  XCTL-005            PIC X(8)    VALUE 'EL005'.
           12  XCTL-010            PIC X(8)    VALUE 'EL010'.
           12  XCTL-626            PIC X(8)    VALUE 'EL626'.
           12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
           12  LINK-001            PIC X(8)    VALUE 'EL001'.
           12  LINK-004            PIC X(8)    VALUE 'EL004'.
           12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
           12  WS-PHONE.
               16  WS-PH1              PIC XXX.
               16  WS-PH2              PIC XXX.
               16  WS-PH3              PIC XXXX.
           12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
           12  WS-DEV-RT               PIC S9V9(6) COMP-3.

       01  ERROR-MESSAGES.
           12  ER-0000                 PIC X(4)  VALUE '0000'.
           12  ER-0004                 PIC X(4)  VALUE '0004'.
           12  ER-0008                 PIC X(4)  VALUE '0008'.
           12  ER-0023                 PIC X(4)  VALUE '0023'.
           12  ER-0029                 PIC X(4)  VALUE '0029'.
           12  ER-0068                 PIC X(4)  VALUE '0068'.
           12  ER-0132                 PIC X(4)  VALUE '0132'.
           12  ER-0142                 PIC X(4)  VALUE '0142'.
           12  ER-0148                 PIC X(4)  VALUE '0148'.
           12  ER-0215                 PIC X(4)  VALUE '0215'.
           12  ER-0348                 PIC X(4)  VALUE '0348'.
           12  ER-0419                 PIC X(4)  VALUE '0419'.
           12  ER-1101                 PIC X(4)  VALUE '1101'.
           12  ER-2056                 PIC X(4)  VALUE '2056'.
           12  ER-2079                 PIC X(4)  VALUE '2079'.
           12  ER-2208                 PIC X(4)  VALUE '2208'.
           12  ER-2209                 PIC X(4)  VALUE '2209'.
           12  ER-2237                 PIC X(4)  VALUE '2237'.
           12  ER-2238                 PIC X(4)  VALUE '2238'.
           12  ER-2253                 PIC X(4)  VALUE '2253'.
           12  ER-2619                 PIC X(4)  VALUE '2619'.
           12  ER-2651                 PIC X(4)  VALUE '2651'.
           12  ER-2784                 PIC X(4)  VALUE '2784'.
           12  ER-2785                 PIC X(4)  VALUE '2785'.
           12  ER-2786                 PIC X(4)  VALUE '2786'.
052307     12  ER-2791                 PIC X(4)  VALUE '2791'.
           12  ER-2845                 PIC X(4)  VALUE '2845'.
           12  ER-2848                 PIC X(4)  VALUE '2848'.
           12  ER-2851                 PIC X(4)  VALUE '2851'.
           12  ER-7638                 PIC X(4)  VALUE '7638'.
           12  ER-9999                 PIC X(4)  VALUE '9999'.
       EJECT
           COPY ELCDATE.
       EJECT
           COPY ELCLOGOF.
       EJECT
           COPY ELCATTR.
       EJECT
           COPY ELCEMIB.
       EJECT
           COPY ELCINTF.
           12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
              16  PI-ISS-CAN-SW           PIC X.
              16  PI-ENDR-PENDING-KEY.
                  20  PI-ENDR-COMPANY-CD  PIC X.
                  20  PI-ENDR-CARRIER     PIC X.
                  20  PI-ENDR-GROUPING    PIC X(6).
                  20  PI-ENDR-STATE       PIC XX.
                  20  PI-ENDR-ACCOUNT     PIC X(10).
                  20  PI-ENDR-CERT-EFF-DT PIC XX.
                  20  PI-ENDR-CERT-PRIME  PIC X(10).
                  20  PI-ENDR-CERT-SFX    PIC X.
                  20  PI-ENDR-CHG-SEQ-NO  PIC S9(4) COMP.
                  20  PI-ENDR-RECORD-TYPE PIC X.
              16  FILLER                  PIC X(603).
          12  FILLER                      PIC X(276).
       EJECT
           COPY ELCAID.

       01  FILLER    REDEFINES DFHAID.
           12  FILLER              PIC X(8).
           12  PF-VALUES           PIC X       OCCURS 24 TIMES.
       EJECT
          COPY EL6314S.
       EJECT
       LINKAGE SECTION.
       01  DFHCOMMAREA                 PIC X(1300).
                                       COPY ERCACCT.
      /
                                       COPY ELCCNTL.
      /
                                       COPY ERCPNDB.
      /
                                       COPY ELCCERT.
      /
                                       COPY ERCENDR.
      /
                                       COPY ERCNOTE.
      /
       PROCEDURE DIVISION.
           MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK

           MOVE EIBDATE                TO DC-JULIAN-YYDDD
           MOVE '5'                    TO DC-OPTION-CODE
           PERFORM 9700-DATE-LINK
           MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT
           MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT

           IF EIBCALEN = 0
              GO TO 8800-UNAUTHORIZED-ACCESS
           END-IF

           MOVE LOW-VALUES             TO EL631GI

           IF PI-CALLING-PROGRAM NOT = THIS-PGM
              IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
                 MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
                 MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
                 MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
                 MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
                 MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
                 MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
                 MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
                 MOVE THIS-PGM             TO PI-CALLING-PROGRAM
                 GO TO 0350-DISPLAY-COMMON-DATA
              END-IF
           END-IF

           IF EIBAID = DFHCLEAR
              GO TO 9400-CLEAR
           END-IF

           .
       0200-RECEIVE.

           IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
              MOVE ER-0008             TO EMI-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              MOVE -1                  TO GPFENTRL
              GO TO 8100-SEND-INITIAL-MAP
           END-IF

           EXEC CICS RECEIVE
               MAP      (MAP-NAME)
               MAPSET   (MAPSET-NAME)
               INTO     (EL631GI)
           END-EXEC

           IF GPFENTRL = 0
               GO TO 0300-CHECK-PFKEYS
           END-IF
           IF EIBAID NOT = DFHENTER
               MOVE ER-0004            TO EMI-ERROR
               GO TO 0320-INPUT-ERROR
           END-IF

           IF (GPFENTRI NUMERIC) AND (GPFENTRI > 0 AND < 25)
              MOVE PF-VALUES (GPFENTRI) TO EIBAID
           ELSE
              MOVE ER-0029            TO EMI-ERROR
              GO TO 0320-INPUT-ERROR
           END-IF

           .
       0300-CHECK-PFKEYS.

           IF EIBAID = DFHPF1
              MOVE PI-ENDR-PENDING-KEY TO WS-ERENDR-KEY
              PERFORM 0520-ERENDR-STARTBR
                                       THRU 0520-EXIT
              PERFORM 0510-ERENDR-READNEXT
                                       THRU 0510-EXIT
              PERFORM 0510-ERENDR-READNEXT
                                       THRU 0510-EXIT
              IF (RESP-NORMAL) AND
                 (PI-COMPANY-CD = EN-COMPANY-CD)
                 PERFORM 0390-BUILD-FROM-ERENDR
                                       THRU 0390-EXIT
                 MOVE ER-0000          TO EMI-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 GO TO 8100-SEND-INITIAL-MAP
              ELSE
                 MOVE ER-2237          TO EMI-ERROR
                 MOVE -1               TO GMAINTL
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 GO TO 8200-SEND-DATAONLY
              END-IF
           END-IF

           IF EIBAID = DFHPF2
              MOVE PI-ENDR-PENDING-KEY TO WS-ERENDR-KEY
              MOVE +0                  TO WS-CHG-SEQ-NO
              PERFORM 0520-ERENDR-STARTBR
                                       THRU 0520-EXIT
              PERFORM 0510-ERENDR-READNEXT
                                       THRU 0510-EXIT
              PERFORM 0530-ERENDR-READPREV
                                       THRU 0530-EXIT
              PERFORM 0530-ERENDR-READPREV
                                       THRU 0530-EXIT
              IF (RESP-NORMAL) AND
                 (PI-COMPANY-CD = EN-COMPANY-CD)
                 PERFORM 0390-BUILD-FROM-ERENDR
                                       THRU 0390-EXIT
                 MOVE ER-0000          TO EMI-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 GO TO 8100-SEND-INITIAL-MAP
              ELSE
                 MOVE ER-2238          TO EMI-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 MOVE -1               TO GMAINTL
                 GO TO 8200-SEND-DATAONLY
              END-IF
           END-IF

           IF EIBAID = DFHPF23
              GO TO 8810-PF23
           END-IF

           IF EIBAID = DFHPF24
              GO TO 9200-RETURN-MAIN-MENU
           END-IF

           IF EIBAID = DFHPF12
              GO TO 9500-PF12
           END-IF

           IF EIBAID = DFHENTER
              GO TO 0325-EDIT-SCREEN
           END-IF

           MOVE ER-0029                TO EMI-ERROR

           .
       0320-INPUT-ERROR.

           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
           MOVE AL-UNBON               TO GPFENTRA
           MOVE -1                     TO GPFENTRL
           GO TO 8200-SEND-DATAONLY
           .
       EJECT
       0325-EDIT-SCREEN.

           IF GMAINTL > +0
              IF GMAINTI = 'S' OR 'A' OR 'C' OR 'D'
                 MOVE AL-UANON         TO GMAINTA
              ELSE
                 MOVE -1               TO GMAINTL
                 MOVE AL-UABON         TO GMAINTA
                 MOVE ER-1101          TO EMI-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
           ELSE
               MOVE -1                 TO  GMAINTL
               MOVE AL-UABON           TO  GMAINTA
               MOVE ER-1101            TO  EMI-ERROR
               PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
           END-IF

           MOVE PI-COMPANY-CD          TO WS-COMPANY-CD

           IF GCARRL > +0
              MOVE GCARRI              TO WS-CARRIER
              MOVE AL-UANON            TO GCARRA
           END-IF

           IF GGROUPL > +0
              MOVE GGROUPI             TO WS-GROUPING
              MOVE AL-UANON            TO GGROUPA
           END-IF

           IF GSTATEL > +0
              MOVE GSTATEI             TO WS-STATE
              MOVE AL-UANON            TO GSTATEA
           END-IF

           IF GACCTL > +0
              MOVE GACCTI              TO WS-ACCOUNT
              MOVE AL-UANON            TO GACCTA
           END-IF

           IF GCERTNOL > +0
              MOVE GCERTNOI            TO WS-CERT-PRIME
              MOVE AL-UANON            TO GCERTNOA
           END-IF

           IF GSUFIXL > +0
              MOVE GSUFIXI             TO WS-CERT-SFX
              MOVE AL-UANON            TO GSUFIXA
           END-IF

           MOVE +0                     TO WS-CHG-SEQ-NO
           IF (GLCNCDTL > +0) OR
              (GACNCDTL > +0)
              MOVE '2'                 TO WS-RECORD-TYPE
           ELSE
              MOVE '1'                 TO WS-RECORD-TYPE
           END-IF
           IF GEFFDTL > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GEFFDTI)
                   LENGTH  (8)
              END-EXEC
              MOVE GEFFDTI             TO DC-GREG-DATE-1-MDY
              MOVE '4'                 TO DC-OPTION-CODE
              PERFORM 9700-DATE-LINK
              IF DATE-CONVERSION-ERROR
                 MOVE ER-0215          TO EMI-ERROR
                 MOVE -1               TO GEFFDTL
                 MOVE AL-UABON         TO GEFFDTA
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              ELSE
                 MOVE DC-BIN-DATE-1    TO WS-CERT-EFF-DT
                 MOVE AL-UANON         TO GEFFDTA
                 MOVE DC-GREG-DATE-1-EDIT
                                       TO GEFFDTO
              END-IF
           END-IF

           IF EMI-NO-ERRORS
              CONTINUE
           ELSE
              GO TO 8200-SEND-DATAONLY
           END-IF

           IF GMAINTI = 'S'
              PERFORM 0330-SHOW-ERENDR THRU 0330-EXIT
              GO TO 8100-SEND-INITIAL-MAP
           END-IF

           IF GMAINTI = 'A'
              PERFORM 0400-ADD-ERENDR  THRU 0400-EXIT
              PERFORM 0390-BUILD-FROM-ERENDR
                                       THRU 0390-EXIT
              MOVE ER-0000             TO EMI-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              GO TO 8100-SEND-INITIAL-MAP
           END-IF

           IF GMAINTI = 'C'
              PERFORM 0420-CHANGE-ERENDR
                                       THRU 0420-EXIT
              PERFORM 0390-BUILD-FROM-ERENDR
                                       THRU 0390-EXIT
              MOVE ER-0000             TO EMI-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              GO TO 8100-SEND-INITIAL-MAP
           END-IF

           IF GMAINTI = 'D'
              PERFORM 0430-DELETE-ERENDR THRU 0430-EXIT
              PERFORM 0440-DELETE-ERNOTE THRU 0440-EXIT
              MOVE ER-0000             TO EMI-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              GO TO 8100-SEND-INITIAL-MAP
           END-IF

           .
       0325-EXIT.
           EXIT.

       0330-SHOW-ERENDR.

           MOVE +0                     TO WS-CHG-SEQ-NO
           MOVE '1'                    TO WS-RECORD-TYPE

           PERFORM 0365-READ-ERENDR    THRU 0365-EXIT

           IF RESP-NORMAL
              PERFORM 0390-BUILD-FROM-ERENDR
                                       THRU 0390-EXIT
           ELSE
              IF RESP-NOTFND OR RESP-ENDFILE
                 MOVE '2'              TO WS-RECORD-TYPE
                 PERFORM 0365-READ-ERENDR
                                       THRU 0365-EXIT
                 IF RESP-NORMAL
                    PERFORM 0390-BUILD-FROM-ERENDR
                                       THRU 0390-EXIT
                 ELSE
                    MOVE ER-2253       TO EMI-ERROR
                    PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                    MOVE -1            TO GMAINTL
                    GO TO 8200-SEND-DATAONLY
                 END-IF
              ELSE
                 MOVE ER-9999          TO EMI-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 MOVE -1               TO GMAINTL
                 GO TO 8100-SEND-INITIAL-MAP
              END-IF
           END-IF

           .
       0330-EXIT.
           EXIT.

       0350-DISPLAY-COMMON-DATA.

           IF PI-RETURN-TO-PROGRAM = 'EL6311'
              PERFORM 0360-CHECK-PENDING THRU 0360-EXIT
           ELSE
              PERFORM 0355-CHECK-ELCERT THRU 0355-EXIT
           END-IF

           GO TO 8100-SEND-INITIAL-MAP

           .
       0350-EXIT.
           EXIT.

       0355-CHECK-ELCERT.

           MOVE PI-COMPANY-CD          TO CERT-COMPANY-CD
           MOVE PI-CARRIER             TO CERT-CARRIER
           MOVE PI-GROUPING            TO CERT-GROUPING
           MOVE PI-STATE               TO CERT-STATE
           MOVE PI-ACCOUNT             TO CERT-ACCOUNT
           MOVE PI-CERT-PRIME          TO CERT-CERT-PRIME
           MOVE PI-CERT-SFX            TO CERT-CERT-SFX
           MOVE PI-CERT-EFF-DT         TO CERT-CERT-EFF-DT

           MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
           MOVE PI-CARRIER             TO WS-CARRIER
           MOVE PI-GROUPING            TO WS-GROUPING
           MOVE PI-STATE               TO WS-STATE
           MOVE PI-ACCOUNT             TO WS-ACCOUNT
           MOVE PI-CERT-PRIME          TO WS-CERT-PRIME
           MOVE PI-CERT-SFX            TO WS-CERT-SFX
           MOVE PI-CERT-EFF-DT         TO WS-CERT-EFF-DT
           MOVE +0                     TO WS-CHG-SEQ-NO
           MOVE '1'                    TO WS-RECORD-TYPE

           PERFORM 0365-READ-ERENDR    THRU 0365-EXIT

           IF RESP-NORMAL
              PERFORM 0390-BUILD-FROM-ERENDR THRU 0390-EXIT
           ELSE
              IF RESP-NOTFND OR RESP-ENDFILE
                 PERFORM 0375-READ-ELCERT THRU 0375-EXIT
      *       ELSE
      *          PERFORM XXXX-SOME-ERROR THRU XXXX-EXIT
              END-IF
           END-IF

           .
       0355-EXIT.
           EXIT.

       0360-CHECK-PENDING.

           MOVE PI-COMPANY-CD          TO PI-ENDR-COMPANY-CD
           MOVE PI-CARRIER             TO PI-ENDR-CARRIER
           MOVE PI-GROUPING            TO PI-ENDR-GROUPING
           MOVE PI-STATE               TO PI-ENDR-STATE
           MOVE PI-ACCOUNT             TO PI-ENDR-ACCOUNT
           MOVE PI-CERT-PRIME          TO PI-ENDR-CERT-PRIME
           MOVE PI-CERT-SFX            TO PI-ENDR-CERT-SFX
           MOVE PI-CERT-EFF-DT         TO PI-ENDR-CERT-EFF-DT

           MOVE PI-ENDR-COMPANY-CD     TO WS-COMPANY-CD
           MOVE PI-ENDR-CARRIER        TO WS-CARRIER
           MOVE PI-ENDR-GROUPING       TO WS-GROUPING
           MOVE PI-ENDR-STATE          TO WS-STATE
           MOVE PI-ENDR-ACCOUNT        TO WS-ACCOUNT
           MOVE PI-ENDR-CERT-PRIME     TO WS-CERT-PRIME
           MOVE PI-ENDR-CERT-SFX       TO WS-CERT-SFX
           MOVE PI-ENDR-CERT-EFF-DT    TO WS-CERT-EFF-DT
           MOVE +0                     TO WS-CHG-SEQ-NO
           IF PI-ISS-CAN-SW = '2'
              MOVE '2'                 TO WS-RECORD-TYPE
           ELSE
              MOVE '1'                 TO WS-RECORD-TYPE
           END-IF

           PERFORM 0365-READ-ERENDR    THRU 0365-EXIT

           IF RESP-NORMAL
              PERFORM 0390-BUILD-FROM-ERENDR THRU 0390-EXIT
           ELSE
              IF RESP-NOTFND OR RESP-ENDFILE
                 PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
      *       ELSE
      *          PERFORM XXXX-SOME-ERROR THRU XXXX-EXIT
              END-IF
           END-IF

           .
       0360-EXIT.
           EXIT.

       0365-READ-ERENDR.

           EXEC CICS READ
               DATASET   (WS-ERENDR-FILE-ID)
               SET       (ADDRESS OF ENDORSEMENT-RECORD)
               RIDFLD    (WS-ERENDR-KEY)
               RESP      (WS-RESPONSE)
           END-EXEC

           .
       0365-EXIT.
           EXIT.

       0370-READ-ERPNDB.

           MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
           MOVE PI-ENDR-CARRIER        TO WS-CARRIER
           MOVE PI-ENDR-GROUPING       TO WS-GROUPING
           MOVE PI-ENDR-STATE          TO WS-STATE
           MOVE PI-ENDR-ACCOUNT        TO WS-ACCOUNT
           MOVE PI-ENDR-CERT-PRIME     TO WS-CERT-PRIME
           MOVE PI-ENDR-CERT-SFX       TO WS-CERT-SFX
           MOVE PI-ENDR-CERT-EFF-DT    TO WS-CERT-EFF-DT
           MOVE +0                     TO WS-CHG-SEQ-NO
           IF PI-ISS-CAN-SW = '2'
              MOVE '2'                 TO WS-RECORD-TYPE
           ELSE
              MOVE '1'                 TO WS-RECORD-TYPE
           END-IF

           EXEC CICS READ
               DATASET   (WS-ERPNDB2-FILE-ID)
               SET       (ADDRESS OF PENDING-BUSINESS)
               RIDFLD    (WS-ERENDR-KEY)
               RESP      (WS-RESPONSE)
           END-EXEC

           IF RESP-NORMAL
              PERFORM 0380-BUILD-FROM-ERPNDB THRU 0380-EXIT
           ELSE
              IF RESP-NOTFND
                 MOVE LOW-VALUES       TO EL631GI
                 MOVE ER-2253          TO EMI-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 MOVE -1               TO GMAINTL
                 GO TO 8100-SEND-INITIAL-MAP
      *       ELSE
      *          PERFORM XXXX-SOME-ERROR THRU XXXX-EXIT
              END-IF
           END-IF

           .
       0370-EXIT.
           EXIT.

       0375-READ-ELCERT.

           EXEC CICS READ
               DATASET   (WS-ELCERT-FILE-ID)
               SET       (ADDRESS OF CERTIFICATE-MASTER)
               RIDFLD    (WS-ELCERT-KEY)
               RESP      (WS-RESPONSE)
           END-EXEC

           IF RESP-NORMAL
              PERFORM 0395-BUILD-FROM-ELCERT THRU 0395-EXIT
           ELSE
              IF RESP-NOTFND
                 MOVE LOW-VALUES       TO EL631GI
                 MOVE ER-2253          TO EMI-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 MOVE -1               TO GMAINTL
                 GO TO 8100-SEND-INITIAL-MAP
      *       ELSE
      *          PERFORM XXXX-SOME-ERROR THRU XXXX-EXIT
              END-IF
           END-IF

           .
       0375-EXIT.
           EXIT.

       0380-BUILD-FROM-ERPNDB.

           MOVE PB-CARRIER             TO GCARRO
           MOVE PB-GROUPING            TO GGROUPO
           MOVE PB-STATE               TO GSTATEO
           MOVE PB-ACCOUNT             TO GACCTO
           MOVE PB-CERT-PRIME          TO GCERTNOO
           MOVE PB-CERT-SFX            TO GSUFIXO

           MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
           MOVE ' '                    TO DC-OPTION-CODE
           PERFORM 9700-DATE-LINK
           IF NO-CONVERSION-ERROR
              MOVE DC-GREG-DATE-1-EDIT TO GEFFDTO
           END-IF

           IF PB-CANCELLATION
              MOVE 'CAN'               TO GTYP1O
                                          GTYP2O
              IF PB-CI-LAST-NAME NOT = SPACES
                 MOVE PB-CI-LAST-NAME  TO GLSTNMO
                 MOVE AL-UANON         TO GLSTNMA
              END-IF
072209        IF PB-CI-FIRST-NAME NOT = SPACES
072209           MOVE PB-CI-FIRST-NAME TO G1STNMO
072209           MOVE AL-UANON         TO G1STNMA
072209        ELSE
              IF PB-CI-INITIALS (1:1) NOT = SPACES
                 MOVE PB-CI-INITIALS (1:1)
                                       TO G1STNMO
                 MOVE AL-UANON         TO G1STNMA
              END-IF
072209        END-IF              
              IF PB-CI-INITIALS (2:1) NOT = SPACES
                 MOVE PB-CI-INITIALS (2:1)
                                       TO GINITO
                 MOVE AL-UANON         TO GINITA
              END-IF
              IF PB-CI-LF-BENEFIT-CD NOT = SPACES AND ZEROS
                 MOVE PB-CI-LF-BENEFIT-CD
                                       TO GBEN1O
                 MOVE AL-PANON         TO GBEN1A
              END-IF
              IF PB-CI-AH-BENEFIT-CD NOT = SPACES AND ZEROS
                 MOVE PB-CI-AH-BENEFIT-CD
                                       TO GBEN2O
                 MOVE AL-PANON         TO GBEN2A
              END-IF
              IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
                 IF PB-CI-LF-TERM NOT = ZEROS
                    MOVE PB-CI-LF-TERM TO GLOTRMO
                    MOVE AL-UNNON      TO GLOTRMA
                 END-IF
                 IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
                    COMPUTE WS-WORK-AMT = PB-CI-LF-PREMIUM-AMT +
                    PB-CI-LF-ALT-PREMIUM-AMT
                    MOVE WS-WORK-AMT   TO GLOPRMO
                    MOVE AL-UNNON      TO GLOPRMA
                 END-IF
                 IF PB-CI-LIFE-COMMISSION NOT = ZEROS
                    MOVE PB-CI-LIFE-COMMISSION
                                       TO GLFCOMMO
                    MOVE AL-UNNON      TO GLFCOMMA
                 END-IF
                 IF PB-C-LF-CANCEL-AMT NOT = ZEROS
                    MOVE PB-C-LF-CANCEL-AMT
                                       TO GLAMT1O
                    MOVE AL-UNNON      TO GLAMT1A
                 END-IF
                 IF PB-C-LF-REF-CALC NOT = ZEROS
                    MOVE PB-C-LF-REF-CALC
                                       TO GLAMT2O
                    MOVE AL-UNNON      TO GLAMT2A
                 END-IF
                 IF PB-C-LF-REM-TERM NOT = ZEROS
                    MOVE PB-C-LF-REM-TERM
                                       TO GLRTRMO
                    MOVE AL-UNNON      TO GLRTRMA
                 END-IF
                 IF PB-CI-LF-BENEFIT-AMT NOT = ZEROS
                    COMPUTE WS-WORK-AMT = PB-CI-LF-BENEFIT-AMT +
                          PB-CI-LF-ALT-BENEFIT-AMT
                    MOVE WS-WORK-AMT   TO GLINS1O
                                          GLINS2O
                    MOVE AL-UNNON      TO GLINS1A
                                          GLINS2A
                 END-IF
                 MOVE PB-C-LF-CANCEL-DT
                                       TO DC-BIN-DATE-1
                 MOVE ' '              TO DC-OPTION-CODE
                 PERFORM 9700-DATE-LINK
                 IF NO-CONVERSION-ERROR
                    MOVE DC-GREG-DATE-1-EDIT
                                       TO GLCNCDTO
                    MOVE AL-UANON      TO GLCNCDTA
                 END-IF
              END-IF
              IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
                 IF PB-CI-AH-TERM NOT = ZEROS
                    MOVE PB-CI-AH-TERM TO GAOTRMO
                    MOVE AL-UNNON      TO GAOTRMA
                 END-IF
                 IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
                    MOVE PB-CI-AH-PREMIUM-AMT
                                       TO GAOPRMO
                    MOVE AL-UNNON      TO GAOPRMA
                 END-IF
                 IF PB-C-AH-CANCEL-AMT NOT = ZEROS
                    MOVE PB-C-AH-CANCEL-AMT
                                       TO GAAMT1O
                    MOVE AL-UNNON      TO GAAMT1A
                 END-IF
                 IF PB-C-AH-REF-CALC NOT = ZEROS
                    MOVE PB-C-AH-REF-CALC
                                       TO GAAMT2O
                    MOVE AL-UNNON      TO GAAMT2A
                 END-IF
                 IF PB-C-AH-REM-TERM NOT = ZEROS
                    MOVE PB-C-AH-REM-TERM
                                       TO GARTRMO
                    MOVE AL-UNNON      TO GARTRMA
                 END-IF
                 IF PB-CI-AH-BENEFIT-AMT NOT = ZEROS
                    MOVE PB-CI-AH-BENEFIT-AMT
                                       TO GAINS1O
                                          GAINS2O
                    MOVE AL-UNNON      TO GAINS1A
                                          GAINS2A
                 END-IF
                 IF PB-CI-AH-COMMISSION NOT = ZEROS
                    MOVE PB-CI-AH-COMMISSION
                                       TO GAHCOMMO
                    MOVE AL-UNNON      TO GAHCOMMA
                 END-IF
                 MOVE PB-C-AH-CANCEL-DT
                                       TO DC-BIN-DATE-1
                 MOVE ' '              TO DC-OPTION-CODE
                 PERFORM 9700-DATE-LINK
                 IF NO-CONVERSION-ERROR
                    MOVE DC-GREG-DATE-1-EDIT
                                       TO GACNCDTO
                    MOVE AL-UANON      TO GACNCDTA
                 END-IF
              END-IF
           ELSE
              MOVE 'ISS'               TO GTYP1O
                                          GTYP2O
              IF PB-I-INSURED-LAST-NAME NOT = SPACES
                 MOVE PB-I-INSURED-LAST-NAME
                                       TO GLSTNMO
                 MOVE AL-UANON         TO GLSTNMA
              END-IF
              IF PB-I-INSURED-FIRST-NAME NOT = SPACES
                 MOVE PB-I-INSURED-FIRST-NAME
                                       TO G1STNMO
                 MOVE AL-UANON         TO G1STNMA
              END-IF
              IF PB-I-INSURED-MIDDLE-INIT NOT = SPACES
                 MOVE PB-I-INSURED-MIDDLE-INIT
                                       TO GINITO
                 MOVE AL-UANON         TO GINITA
              END-IF
              IF PB-I-JOINT-LAST-NAME NOT = SPACES
                 MOVE PB-I-JOINT-LAST-NAME
                                       TO GJLSTNMO
                 MOVE AL-UANON         TO GJLSTNMA
              END-IF
              IF PB-I-JOINT-FIRST-NAME NOT = SPACES
                 MOVE PB-I-JOINT-FIRST-NAME
                                       TO GJ1STNMO
                 MOVE AL-UANON         TO GJ1STNMA
              END-IF
              IF PB-I-JOINT-MIDDLE-INIT NOT = SPACES
                 MOVE PB-I-JOINT-MIDDLE-INIT
                                       TO GJINITO
                 MOVE AL-UANON         TO GJINITA
              END-IF
              IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
                 MOVE PB-I-LF-BENEFIT-CD
                                       TO GBEN1O
                 MOVE AL-PANON         TO GBEN1A
              END-IF
              IF PB-I-AH-BENEFIT-CD NOT = SPACES AND ZEROS
                 MOVE PB-I-AH-BENEFIT-CD
                                       TO GBEN2O
                 MOVE AL-PANON         TO GBEN2A
              END-IF
              IF PB-I-LF-TERM NOT = ZEROS
                 MOVE PB-I-LF-TERM     TO GLOTRMO
                 MOVE AL-UNNON         TO GLOTRMA
              END-IF
              IF PB-I-AH-TERM NOT = ZEROS
                 MOVE PB-I-AH-TERM     TO GAOTRMO
                 MOVE AL-UNNON         TO GAOTRMA
              END-IF
              IF PB-I-LIFE-COMMISSION NOT = ZEROS
                 MOVE PB-I-LIFE-COMMISSION
                                       TO GLFCOMMO
                 MOVE AL-UNNON         TO GLFCOMMA
              END-IF
              IF PB-I-AH-COMMISSION NOT = ZEROS
                 MOVE PB-I-AH-COMMISSION
                                       TO GAHCOMMO
                 MOVE AL-UNNON         TO GAHCOMMA
              END-IF
              IF PB-I-LF-PREMIUM-AMT NOT = ZEROS
                 COMPUTE WS-WORK-AMT = PB-I-LF-PREMIUM-AMT +
                        PB-I-LF-ALT-PREMIUM-AMT
                 MOVE WS-WORK-AMT      TO GLAMT1O
                 MOVE AL-UNNON         TO GLAMT1A
              END-IF
              IF PB-I-AH-PREMIUM-AMT NOT = ZEROS
                 MOVE PB-I-AH-PREMIUM-AMT
                                       TO GAAMT1O
                 MOVE AL-UNNON         TO GAAMT1A
              END-IF
              IF PB-I-LF-PREM-CALC NOT = ZEROS
                 MOVE PB-I-LF-PREM-CALC
                                       TO GLAMT2O
                 MOVE AL-UNNON         TO GLAMT2A
              END-IF
              IF PB-I-AH-PREM-CALC NOT = ZEROS
                 MOVE PB-I-AH-PREM-CALC
                                       TO GAAMT2O
                 MOVE AL-UNNON         TO GAAMT2A
              END-IF
              IF PB-I-LF-BENEFIT-AMT NOT = ZEROS
                 COMPUTE WS-WORK-AMT = PB-I-LF-BENEFIT-AMT +
                        PB-I-LF-ALT-BENEFIT-AMT
                 MOVE WS-WORK-AMT      TO GLINS1O
                                          GLINS2O
                 MOVE AL-UNNON         TO GLINS1A
                                          GLINS2A
              END-IF
              IF PB-I-AH-BENEFIT-AMT NOT = ZEROS
                 MOVE PB-I-AH-BENEFIT-AMT
                                       TO GAINS1O
                                          GAINS2O
                 MOVE AL-UNNON         TO GAINS1A
                                          GAINS2A
              END-IF
           END-IF

           MOVE ER-2785                TO EMI-ERROR
           PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT

           .
       0380-EXIT.
           EXIT.

       0390-BUILD-FROM-ERENDR.

           MOVE LOW-VALUES             TO EL631GI
           MOVE PI-COMPANY-CD          TO PI-ENDR-COMPANY-CD
           MOVE EN-CARRIER             TO PI-ENDR-CARRIER
           MOVE EN-GROUPING            TO PI-ENDR-GROUPING
           MOVE EN-STATE               TO PI-ENDR-STATE
           MOVE EN-ACCOUNT             TO PI-ENDR-ACCOUNT
           MOVE EN-CERT-PRIME          TO PI-ENDR-CERT-PRIME
           MOVE EN-CERT-SFX            TO PI-ENDR-CERT-SFX
           MOVE EN-CERT-EFF-DT         TO PI-ENDR-CERT-EFF-DT
           MOVE EN-REC-TYPE            TO PI-ENDR-RECORD-TYPE
           MOVE +0                     TO PI-ENDR-CHG-SEQ-NO

           MOVE EN-CARRIER             TO GCARRO
           MOVE EN-GROUPING            TO GGROUPO
           MOVE EN-STATE               TO GSTATEO
           MOVE EN-ACCOUNT             TO GACCTO
           MOVE EN-CERT-PRIME          TO GCERTNOO
           MOVE EN-CERT-SFX            TO GSUFIXO

           MOVE EN-CERT-EFF-DT         TO DC-BIN-DATE-1
           MOVE ' '                    TO DC-OPTION-CODE
           PERFORM 9700-DATE-LINK
           IF NO-CONVERSION-ERROR
              MOVE DC-GREG-DATE-1-EDIT TO GEFFDTO
           END-IF

           IF EN-LAST-MAINT-HHMMSS NOT NUMERIC
              MOVE +0                  TO EN-LAST-MAINT-HHMMSS
           END-IF

           MOVE EN-LAST-MAINT-HHMMSS   TO TIME-MT
                                          PI-UPDATE-HHMMSS
           MOVE TIME-LMT               TO GMANTATO

           MOVE EN-LAST-MAINT-BY       TO GMANTBYO
                                          PI-UPDATE-BY
           MOVE EN-LAST-MAINT-DT       TO DC-BIN-DATE-1
           MOVE ' '                    TO DC-OPTION-CODE
           PERFORM 9700-DATE-LINK
           IF NO-CONVERSION-ERROR
              MOVE DC-GREG-DATE-1-EDIT TO GMANTDTO
           END-IF

           IF EN-PRINT-DT NOT = SPACES AND LOW-VALUES
              MOVE EN-PRINT-DT         TO DC-BIN-DATE-1
              MOVE ' '                 TO DC-OPTION-CODE
              PERFORM 9700-DATE-LINK
              IF NO-CONVERSION-ERROR
                 MOVE DC-GREG-DATE-1-EDIT
                                       TO GPRTDTO
                 MOVE AL-UANON         TO GPRTDTA
              END-IF
           END-IF
           IF EN-INPUT-DT NOT = SPACES AND LOW-VALUES
              MOVE EN-INPUT-DT         TO DC-BIN-DATE-1
              MOVE ' '                 TO DC-OPTION-CODE
              PERFORM 9700-DATE-LINK
              IF NO-CONVERSION-ERROR
                 MOVE DC-GREG-DATE-1-EDIT
                                       TO GINPDTO
              END-IF
           END-IF
           IF EN-LAST-NAME NOT = SPACES
              MOVE EN-LAST-NAME        TO GLSTNMO
              MOVE AL-UANON            TO GLSTNMA
           END-IF
           IF EN-FIRST-NAME NOT = SPACES
              MOVE EN-FIRST-NAME       TO G1STNMO
              MOVE AL-UANON            TO G1STNMA
           END-IF
           IF EN-MIDDLE-INIT NOT = SPACES
              MOVE EN-MIDDLE-INIT      TO GINITO
              MOVE AL-UANON            TO GINITA
           END-IF
           IF EN-JOINT-LAST-NAME NOT = SPACES
              MOVE EN-JOINT-LAST-NAME  TO GJLSTNMO
              MOVE AL-UANON            TO GJLSTNMA
           END-IF
           IF EN-JOINT-FIRST-NAME NOT = SPACES
              MOVE EN-JOINT-FIRST-NAME TO GJ1STNMO
              MOVE AL-UANON            TO GJ1STNMA
           END-IF
           IF EN-JOINT-MIDDLE-INIT NOT = SPACES
              MOVE EN-JOINT-MIDDLE-INIT
                                       TO GJINITO
              MOVE AL-UANON            TO GJINITA
           END-IF
           IF EN-LF-TERM NOT NUMERIC
              MOVE +0                  TO EN-LF-TERM
           END-IF
           IF EN-AH-TERM NOT NUMERIC
              MOVE +0                  TO EN-AH-TERM
           END-IF
           IF EN-LF-PREM-ENT-AMT NOT NUMERIC
              MOVE +0                  TO EN-LF-PREM-ENT-AMT
           END-IF
           IF EN-AH-PREM-ENT-AMT NOT NUMERIC
              MOVE +0                  TO EN-AH-PREM-ENT-AMT
           END-IF
           IF EN-LF-PREM-CAL-AMT NOT NUMERIC
              MOVE +0                  TO EN-LF-PREM-CAL-AMT
           END-IF
           IF EN-AH-PREM-CAL-AMT NOT NUMERIC
              MOVE +0                  TO EN-AH-PREM-CAL-AMT
           END-IF
           IF EN-LF-CANC-ENT-AMT NOT NUMERIC
              MOVE +0                  TO EN-LF-CANC-ENT-AMT
           END-IF
           IF EN-AH-CANC-ENT-AMT NOT NUMERIC
              MOVE +0                  TO EN-AH-CANC-ENT-AMT
           END-IF
           IF EN-LF-CANC-CAL-AMT NOT NUMERIC
              MOVE +0                  TO EN-LF-CANC-CAL-AMT
           END-IF
           IF EN-AH-CANC-CAL-AMT NOT NUMERIC
              MOVE +0                  TO EN-AH-CANC-CAL-AMT
           END-IF
           IF EN-LF-COMMISSION NOT NUMERIC
              MOVE +0                  TO EN-LF-COMMISSION
           END-IF
           IF EN-AH-COMMISSION NOT NUMERIC
              MOVE +0                  TO EN-AH-COMMISSION
           END-IF
           IF EN-LF-BEN-ENT-AMT NOT NUMERIC
              MOVE +0                  TO EN-LF-BEN-ENT-AMT
           END-IF
           IF EN-AH-BEN-ENT-AMT NOT NUMERIC
              MOVE +0                  TO EN-AH-BEN-ENT-AMT
           END-IF
           IF EN-LF-BEN-CAL-AMT NOT NUMERIC
              MOVE +0                  TO EN-LF-BEN-CAL-AMT
           END-IF
           IF EN-AH-BEN-CAL-AMT NOT NUMERIC
              MOVE +0                  TO EN-AH-BEN-CAL-AMT
           END-IF
           IF EN-LF-COMMISSION NOT = ZEROS
              MOVE EN-LF-COMMISSION    TO GLFCOMMO
              MOVE AL-UNNON            TO GLFCOMMA
           END-IF
           IF EN-AH-COMMISSION NOT = ZEROS
              MOVE EN-AH-COMMISSION    TO GAHCOMMO
              MOVE AL-UNNON            TO GAHCOMMA
           END-IF
           IF EN-LF-BEN-CD NOT = ZEROS AND SPACES
              MOVE EN-LF-BEN-CD        TO GBEN1O
              MOVE AL-PANON            TO GBEN1A
           END-IF
           IF EN-AH-BEN-CD NOT = ZEROS AND SPACES
              MOVE EN-AH-BEN-CD        TO GBEN2O
              MOVE AL-PANON            TO GBEN2A
           END-IF
           IF EN-LF-TERM NOT = ZEROS
              MOVE EN-LF-TERM          TO GLOTRMO
              MOVE AL-UNNON            TO GLOTRMA
           END-IF
           IF EN-AH-TERM NOT = ZEROS
              MOVE EN-AH-TERM          TO GAOTRMO
              MOVE AL-UNNON            TO GAOTRMA
           END-IF
           IF EN-SIG-SW NOT = SPACES
              MOVE EN-SIG-SW           TO GSIGO
              MOVE AL-UANON            TO GSIGA
           END-IF
           IF EN-COMMENTS1 NOT = SPACES
              MOVE EN-COMMENTS1        TO GTEXT1O
              MOVE AL-UANON            TO GTEXT1A
           END-IF
           IF EN-COMMENTS2 NOT = SPACES
              MOVE EN-COMMENTS2        TO GTEXT2O
              MOVE AL-UANON            TO GTEXT2A
           END-IF
PEMMOD     IF EN-COMMENTS3 NOT = SPACES
PEMMOD        MOVE EN-COMMENTS3        TO GTEXT3O
PEMMOD        MOVE AL-UANON            TO GTEXT3A
PEMMOD     END-IF
PEMMOD     IF EN-COMMENTS4 NOT = SPACES
PEMMOD        MOVE EN-COMMENTS4        TO GTEXT4O
PEMMOD        MOVE AL-UANON            TO GTEXT4A
PEMMOD     END-IF
052307     IF EN-FLAG-CERT NOT = SPACES
052307        MOVE EN-FLAG-CERT        TO GFLAGO
052307        MOVE AL-UANON            TO GFLAGA
052307     END-IF           
           IF EN-LF-BEN-ENT-AMT NOT = ZEROS
              MOVE EN-LF-BEN-ENT-AMT   TO GLINS1O
              MOVE AL-UNNON            TO GLINS1A
           END-IF
           IF EN-AH-BEN-ENT-AMT NOT = ZEROS
              MOVE EN-AH-BEN-ENT-AMT   TO GAINS1O
              MOVE AL-UNNON            TO GAINS1A
           END-IF
           IF EN-LF-BEN-CAL-AMT NOT = ZEROS
              MOVE EN-LF-BEN-CAL-AMT   TO GLINS2O
              MOVE AL-UNNON            TO GLINS2A
           END-IF
           IF EN-AH-BEN-CAL-AMT NOT = ZEROS
              MOVE EN-AH-BEN-CAL-AMT   TO GAINS2O
              MOVE AL-UNNON            TO GAINS2A
           END-IF
           IF EN-CANCELLATION
              MOVE 'CAN'               TO GTYP1O
                                          GTYP2O
              IF EN-LF-PREM-ENT-AMT NOT = ZEROS
                 MOVE EN-LF-PREM-ENT-AMT
                                       TO GLOPRMO
                 MOVE AL-UNNON         TO GLOPRMA
              END-IF
              IF EN-AH-PREM-ENT-AMT NOT = ZEROS
                 MOVE EN-AH-PREM-ENT-AMT
                                       TO GAOPRMO
                 MOVE AL-UNNON         TO GAOPRMA
              END-IF
              IF EN-LF-CANC-ENT-AMT NOT = ZEROS
                 MOVE EN-LF-CANC-ENT-AMT
                                       TO GLAMT1O
                 MOVE AL-UNNON         TO GLAMT1A
              END-IF
              IF EN-AH-CANC-ENT-AMT NOT = ZEROS
                 MOVE EN-AH-CANC-ENT-AMT
                                       TO GAAMT1O
                 MOVE AL-UNNON         TO GAAMT1A
              END-IF
              IF EN-LF-CANC-CAL-AMT NOT = ZEROS
                 MOVE EN-LF-CANC-CAL-AMT
                                       TO GLAMT2O
                 MOVE AL-UNNON         TO GLAMT2A
              END-IF
              IF EN-AH-CANC-CAL-AMT NOT = ZEROS
                 MOVE EN-AH-CANC-CAL-AMT
                                       TO GAAMT2O
                 MOVE AL-UNNON         TO GAAMT2A
              END-IF
      *       MOVE PB-C-LF-REM-TERM    TO GLRTRMO
      *       MOVE PB-C-AH-REM-TERM    TO GARTRMO
              IF EN-LF-CANC-DT NOT = SPACES AND LOW-VALUES
                 MOVE AL-UANON         TO GLCNCDTA
                 MOVE EN-LF-CANC-DT    TO DC-BIN-DATE-1
                 MOVE ' '              TO DC-OPTION-CODE
                 PERFORM 9700-DATE-LINK
                 IF NO-CONVERSION-ERROR
                    MOVE DC-GREG-DATE-1-EDIT
                                       TO GLCNCDTO
                 END-IF
              END-IF
              IF EN-AH-CANC-DT NOT = SPACES AND LOW-VALUES
                 MOVE AL-UANON         TO GACNCDTA
                 MOVE EN-AH-CANC-DT    TO DC-BIN-DATE-1
                 MOVE ' '              TO DC-OPTION-CODE
                 PERFORM 9700-DATE-LINK
                 IF NO-CONVERSION-ERROR
                    MOVE DC-GREG-DATE-1-EDIT
                                       TO GACNCDTO
                 END-IF
              END-IF
           ELSE
              MOVE 'ISS'               TO GTYP1O
                                          GTYP2O
              IF EN-LF-PREM-ENT-AMT NOT = ZEROS
                 MOVE EN-LF-PREM-ENT-AMT
                                       TO GLAMT1O
                 MOVE AL-UNNON         TO GLAMT1A
              END-IF
              IF EN-AH-PREM-ENT-AMT NOT = ZEROS
                 MOVE EN-AH-PREM-ENT-AMT
                                       TO GAAMT1O
                 MOVE AL-UNNON         TO GAAMT1A
              END-IF
              IF EN-LF-PREM-CAL-AMT NOT = ZEROS
                 MOVE EN-LF-PREM-CAL-AMT
                                       TO GLAMT2O
                 MOVE AL-UNNON         TO GLAMT2A
              END-IF
              IF EN-AH-PREM-CAL-AMT NOT = ZEROS
                 MOVE EN-AH-PREM-CAL-AMT
                                       TO GAAMT2O
                 MOVE AL-UNNON         TO GAAMT2A
              END-IF
           END-IF


           .
       0390-EXIT.
           EXIT.

       0395-BUILD-FROM-ELCERT.

           MOVE LOW-VALUES             TO EL631GI
           MOVE PI-COMPANY-CD          TO PI-ENDR-COMPANY-CD
           MOVE CM-CARRIER             TO PI-ENDR-CARRIER
           MOVE CM-GROUPING            TO PI-ENDR-GROUPING
           MOVE CM-STATE               TO PI-ENDR-STATE
           MOVE CM-ACCOUNT             TO PI-ENDR-ACCOUNT
           MOVE CM-CERT-PRIME          TO PI-ENDR-CERT-PRIME
           MOVE CM-CERT-SFX            TO PI-ENDR-CERT-SFX
           MOVE CM-CERT-EFF-DT         TO PI-ENDR-CERT-EFF-DT
           MOVE '1'                    TO PI-ENDR-RECORD-TYPE
           MOVE +0                     TO PI-ENDR-CHG-SEQ-NO

           MOVE CM-CARRIER             TO GCARRO
           MOVE CM-GROUPING            TO GGROUPO
           MOVE CM-STATE               TO GSTATEO
           MOVE CM-ACCOUNT             TO GACCTO
           MOVE CM-CERT-PRIME          TO GCERTNOO
           MOVE CM-CERT-SFX            TO GSUFIXO

           MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
           MOVE ' '                    TO DC-OPTION-CODE
           PERFORM 9700-DATE-LINK
           IF NO-CONVERSION-ERROR
              MOVE DC-GREG-DATE-1-EDIT TO GEFFDTO
           END-IF

           IF CM-INSURED-LAST-NAME NOT = SPACES
              MOVE CM-INSURED-LAST-NAME
                                       TO GLSTNMO
              MOVE AL-UANON            TO GLSTNMA
           END-IF
           IF CM-INSURED-FIRST-NAME NOT = SPACES
              MOVE CM-INSURED-FIRST-NAME
                                       TO G1STNMO
              MOVE AL-UANON            TO G1STNMA
           END-IF
           IF CM-INSURED-INITIAL2 NOT = SPACES
              MOVE CM-INSURED-INITIAL2 TO GINITO
              MOVE AL-UANON            TO GINITA
           END-IF
           IF CM-JT-LAST-NAME NOT = SPACES
              MOVE CM-JT-LAST-NAME     TO GJLSTNMO
              MOVE AL-UANON            TO GJLSTNMA
           END-IF
           IF CM-JT-FIRST-NAME NOT = SPACES
              MOVE CM-JT-FIRST-NAME    TO GJ1STNMO
              MOVE AL-UANON            TO GJ1STNMA
           END-IF
           IF CM-JT-INITIAL NOT = SPACES
              MOVE CM-JT-INITIAL       TO GJINITO
              MOVE AL-UANON            TO GJINITA
           END-IF
           IF CM-LF-ORIG-TERM NOT NUMERIC
              MOVE +0                  TO CM-LF-ORIG-TERM
           END-IF
           IF CM-AH-ORIG-TERM NOT NUMERIC
              MOVE +0                  TO CM-AH-ORIG-TERM
           END-IF
           IF CM-LF-PREMIUM-AMT NOT NUMERIC
              MOVE +0                  TO CM-LF-PREMIUM-AMT
           END-IF
           IF CM-AH-PREMIUM-AMT NOT NUMERIC
              MOVE +0                  TO CM-AH-PREMIUM-AMT
           END-IF
           IF CM-LIFE-COMM-PCT NOT NUMERIC
              MOVE +0                  TO CM-LIFE-COMM-PCT
           END-IF
           IF CM-AH-COMM-PCT NOT NUMERIC
              MOVE +0                  TO CM-AH-COMM-PCT
           END-IF
           IF CM-LIFE-COMM-PCT NOT = ZEROS
              MOVE CM-LIFE-COMM-PCT    TO GLFCOMMO
              MOVE AL-UNNON            TO GLFCOMMA
           END-IF
           IF CM-AH-COMM-PCT NOT = ZEROS
              MOVE CM-AH-COMM-PCT      TO GAHCOMMO
              MOVE AL-UNNON            TO GAHCOMMA
           END-IF
           IF CM-LF-BENEFIT-CD NOT = SPACES AND ZEROS
              MOVE CM-LF-BENEFIT-CD    TO GBEN1O
              MOVE AL-PANON            TO GBEN1A
           END-IF
           IF CM-AH-BENEFIT-CD NOT = SPACES AND ZEROS
              MOVE CM-AH-BENEFIT-CD    TO GBEN2O
              MOVE AL-PANON            TO GBEN2A
           END-IF
           IF CM-LF-ORIG-TERM NOT = ZEROS
              MOVE CM-LF-ORIG-TERM     TO GLOTRMO
              MOVE AL-UNNON            TO GLOTRMA
           END-IF
           IF CM-AH-ORIG-TERM NOT = ZEROS
              MOVE CM-AH-ORIG-TERM     TO GAOTRMO
              MOVE AL-UNNON            TO GAOTRMA
           END-IF

           MOVE 'ISS'                  TO GTYP1O
                                          GTYP2O
           IF CM-LF-PREMIUM-AMT NOT = ZEROS
              MOVE CM-LF-PREMIUM-AMT   TO GLAMT1O
                                          GLAMT2O
              MOVE AL-UNNON            TO GLAMT1A
                                          GLAMT2A
           END-IF
           IF CM-AH-PREMIUM-AMT NOT = ZEROS
              MOVE CM-AH-PREMIUM-AMT   TO GAAMT1O
                                          GAAMT2O
              MOVE AL-UNNON            TO GAAMT1A
                                          GAAMT2A
           END-IF
           IF CM-LF-BENEFIT-AMT NOT NUMERIC
              MOVE ZEROS TO CM-LF-BENEFIT-AMT
           END-IF
           IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
              MOVE ZEROS TO CM-LF-ALT-BENEFIT-AMT
           END-IF
           IF CM-LF-BENEFIT-AMT NOT = ZEROS
              COMPUTE WS-WORK-AMT = CM-LF-BENEFIT-AMT +
                     CM-LF-ALT-BENEFIT-AMT
              MOVE WS-WORK-AMT         TO GLINS1O
                                          GLINS2O
              MOVE AL-UNNON            TO GLINS1A
                                          GLINS2A
           END-IF
           IF CM-AH-BENEFIT-AMT NOT = ZEROS
              MOVE CM-AH-BENEFIT-AMT   TO GAINS1O
                                          GAINS2O
              MOVE AL-UNNON            TO GAINS1A
                                          GAINS2A
           END-IF

           MOVE ER-2784                TO EMI-ERROR
           PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT

           .
       0395-EXIT.
           EXIT.

       0400-ADD-ERENDR.

           MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
           MOVE '6'                    TO CNTL-REC-TYPE
           MOVE SPACES                 TO CNTL-ACCESS
           MOVE GCARRI                 TO CNTL-CARRIER
           MOVE +0                     TO CNTL-SEQ

           EXEC CICS READ
               DATASET   (WS-ELCNTL-FILE-ID)
               SET       (ADDRESS OF CONTROL-FILE)
               RIDFLD    (ELCNTL-KEY)
               RESP      (WS-RESPONSE)
           END-EXEC

           IF RESP-NORMAL
              CONTINUE
           ELSE
              MOVE ER-2208             TO EMI-ERROR
              MOVE -1                  TO GCARRL
              MOVE AL-UABON            TO GCARRA
              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
           END-IF

           MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
           MOVE '3'                    TO CNTL-REC-TYPE
           MOVE SPACES                 TO CNTL-ACCESS
           MOVE GSTATEI                TO CNTL-STATE
           MOVE +0                     TO CNTL-SEQ

           EXEC CICS READ
               DATASET   (WS-ELCNTL-FILE-ID)
               SET       (ADDRESS OF CONTROL-FILE)
               RIDFLD    (ELCNTL-KEY)
               RESP      (WS-RESPONSE)
           END-EXEC

           IF RESP-NORMAL
              CONTINUE
           ELSE
              MOVE ER-2209             TO EMI-ERROR
              MOVE -1                  TO GSTATEL
              MOVE AL-UABON            TO GSTATEA
              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
           END-IF

           EXEC CICS BIF DEEDIT
                FIELD   (GEFFDTI)
                LENGTH  (8)
           END-EXEC

           MOVE GEFFDTI                TO DC-GREG-DATE-1-MDY
           MOVE '4'                    TO DC-OPTION-CODE
           PERFORM 9700-DATE-LINK
           IF DATE-CONVERSION-ERROR
              MOVE ER-0348             TO EMI-ERROR
              MOVE -1                  TO GEFFDTL
              MOVE AL-UABON            TO GEFFDTA
              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              GO TO 8200-SEND-DATAONLY
           ELSE
              MOVE DC-BIN-DATE-1       TO WS-CERT-EFF-DT
           END-IF

           MOVE LOW-VALUES             TO WS-LF-CANC-DT
                                          WS-AH-CANC-DT

           IF GLCNCDTL > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GLCNCDTI)
                   LENGTH  (8)
              END-EXEC
              MOVE GLCNCDTI            TO DC-GREG-DATE-1-MDY
              MOVE '4'                 TO DC-OPTION-CODE
              PERFORM 9700-DATE-LINK
              IF DATE-CONVERSION-ERROR
                 MOVE ER-7638          TO EMI-ERROR
                 MOVE -1               TO GLCNCDTL
                 MOVE AL-UABON         TO GLCNCDTA
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 GO TO 8200-SEND-DATAONLY
              ELSE
                 MOVE DC-BIN-DATE-1    TO WS-LF-CANC-DT
              END-IF
           END-IF

           IF GACNCDTL > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GACNCDTI)
                   LENGTH  (8)
              END-EXEC
              MOVE GACNCDTI            TO DC-GREG-DATE-1-MDY
              MOVE '4'                 TO DC-OPTION-CODE
              PERFORM 9700-DATE-LINK
              IF DATE-CONVERSION-ERROR
                 MOVE ER-7638          TO EMI-ERROR
                 MOVE -1               TO GACNCDTL
                 MOVE AL-UABON         TO GACNCDTA
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 GO TO 8200-SEND-DATAONLY
              ELSE
                 MOVE DC-BIN-DATE-1    TO WS-AH-CANC-DT
              END-IF
           END-IF

           IF (GLCNCDTL > +0) OR
              (GACNCDTL > +0)
              MOVE 'C'                 TO WS-ISS-CAN-SW
           ELSE
              MOVE 'I'                 TO WS-ISS-CAN-SW
           END-IF

           MOVE GCARRI                 TO ACCT-CARRIER
           MOVE GGROUPI                TO ACCT-GROUPING
           MOVE GSTATEI                TO ACCT-STATE
           MOVE GACCTI                 TO ACCT-ACCOUNT
           MOVE PI-COMPANY-CD          TO ACCT-CO
           MOVE WS-CERT-EFF-DT         TO ACCT-EXP-DATE

           MOVE ERACCT-KEY             TO WS-HOLD-ACCT-KEY

           EXEC CICS STARTBR
               DATASET    (WS-ERACCT2-FILE-ID)
               RIDFLD     (ERACCT-KEY)
               RESP       (WS-RESPONSE)
               GTEQ
           END-EXEC

           IF RESP-NORMAL
              PERFORM 0480-READNEXT-ERACCT THRU 0480-EXIT UNTIL
                 (NOT RESP-NORMAL)
                         OR
                 (WS-HOLD-ACCT-KEY (2:19) NOT = ERACCT-KEY (2:19))
                         OR
                 ((WS-HOLD-ACCT-KEY (2:19) = ERACCT-KEY (2:19)) AND
                  (WS-CERT-EFF-DT < ACCT-EXP-DATE))
           ELSE
              MOVE ER-2851             TO EMI-ERROR
              MOVE -1                  TO GACCTL
              MOVE AL-UABON            TO GACCTA
              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              GO TO 8200-SEND-DATAONLY
           END-IF

           IF (WS-HOLD-ACCT-KEY (2:19) = ERACCT-KEY (2:19)) AND
              (WS-CERT-EFF-DT < ACCT-EXP-DATE)
              CONTINUE
           ELSE
              MOVE ER-2851             TO EMI-ERROR
              MOVE -1                  TO GACCTL
              MOVE AL-UABON            TO GACCTA
              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              GO TO 8200-SEND-DATAONLY
           END-IF

           EXEC CICS GETMAIN
                SET      (ADDRESS OF ENDORSEMENT-RECORD)
                LENGTH   (ERENDR-LENGTH)
                INITIMG  (GETMAIN-SPACE)
           END-EXEC

           PERFORM 0410-INIT-ERENDR    THRU 0410-EXIT
           MOVE PI-COMPANY-CD          TO EN-COMPANY-CD
           MOVE GCARRI                 TO EN-CARRIER
           MOVE GGROUPI                TO EN-GROUPING
           MOVE GSTATEI                TO EN-STATE
           MOVE GACCTI                 TO EN-ACCOUNT
           MOVE WS-CERT-EFF-DT         TO EN-CERT-EFF-DT
           MOVE GCERTNOI               TO EN-CERT-PRIME
           MOVE GSUFIXI                TO EN-CERT-SFX
           MOVE +0                     TO EN-SEQ-NO
           MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
           MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
           MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
           MOVE WS-CURRENT-BIN-DT      TO EN-INPUT-DT
           IF (GLSTNML > +0) AND
              (GLSTNMI NOT = '*')
              MOVE GLSTNMI             TO EN-LAST-NAME
           ELSE
              MOVE SPACES              TO EN-LAST-NAME
           END-IF
           IF (G1STNML > +0) AND
              (G1STNMI NOT = '*')
              MOVE G1STNMI             TO EN-FIRST-NAME
           ELSE
              MOVE SPACES              TO EN-FIRST-NAME
           END-IF
           IF (GINITL > +0) AND
              (GINITI NOT = '*')
              MOVE GINITI              TO EN-MIDDLE-INIT
           ELSE
              MOVE SPACES              TO EN-MIDDLE-INIT
           END-IF
           IF (GJLSTNML > +0) AND
              (GJLSTNMI NOT = '*')
              MOVE GJLSTNMI            TO EN-JOINT-LAST-NAME
           ELSE
              MOVE SPACES              TO EN-JOINT-LAST-NAME
           END-IF
           IF (GJ1STNML > +0) AND
              (GJ1STNMI NOT = '*')
              MOVE GJ1STNMI            TO EN-JOINT-FIRST-NAME
           ELSE
              MOVE SPACES              TO EN-JOINT-FIRST-NAME
           END-IF
           IF (GJINITL > +0) AND
              (GJINITI NOT = '*')
              MOVE GJINITI             TO EN-JOINT-MIDDLE-INIT
           ELSE
              MOVE SPACES              TO EN-JOINT-MIDDLE-INIT
           END-IF
           IF GBEN1L > +0
              MOVE GBEN1I              TO EN-LF-BEN-CD
           END-IF
           IF GBEN2L > +0
              MOVE GBEN2I              TO EN-AH-BEN-CD
           END-IF
           IF GTEXT1L > +0
              MOVE GTEXT1I              TO EN-COMMENTS1
           END-IF
           IF GTEXT2L > +0
              MOVE GTEXT2I              TO EN-COMMENTS2
           END-IF
PEMMOD     IF GTEXT3L > +0
PEMMOD        MOVE GTEXT3I              TO EN-COMMENTS3
PEMMOD     END-IF
PEMMOD     IF GTEXT4L > +0
PEMMOD        MOVE GTEXT4I              TO EN-COMMENTS4
PEMMOD     END-IF
052307     IF GFLAGL > +0
052307        IF GFLAGI = 'Y' OR 'N' OR ' '
052307            MOVE GFLAGI          TO EN-FLAG-CERT
052307            MOVE AL-UANON        TO GFLAGA
052307        ELSE
052307           MOVE -1               TO GFLAGL
052307           MOVE ER-2791          TO EMI-ERROR
052307           MOVE AL-UABON         TO GFLAGA
052307           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
052307        END-IF
052307     END-IF

           IF GLOTRML GREATER +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GLOTRMI)
                   LENGTH  (3)
              END-EXEC
              IF GLOTRMI  NUMERIC
                 MOVE GLOTRMI          TO EN-LF-TERM
                 MOVE AL-UNNON         TO GLOTRMA
              ELSE
                 MOVE -1               TO GLOTRML
                 MOVE ER-2079          TO EMI-ERROR
                 MOVE AL-UNBON         TO GLOTRMA
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF

           IF GAOTRML GREATER +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GAOTRMI)
                   LENGTH  (3)
              END-EXEC
              IF GAOTRMI  NUMERIC
                 MOVE GAOTRMI          TO EN-AH-TERM
                 MOVE AL-UNNON         TO GAOTRMA
              ELSE
                 MOVE -1               TO GAOTRML
                 MOVE ER-2079          TO EMI-ERROR
                 MOVE AL-UNBON         TO GAOTRMA
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF

           IF GLFCOMML > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GLFCOMMI)
                   LENGTH  (6)
              END-EXEC
              IF GLFCOMMI  NUMERIC
                 MOVE GLFCOMMI         TO EN-LF-COMMISSION
                 MOVE AL-UNNON         TO GLFCOMMA
              ELSE
                 MOVE -1               TO GLFCOMML
                 MOVE ER-9999          TO EMI-ERROR
                 MOVE AL-UNBON         TO GLFCOMMA
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF
           IF GAHCOMML > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GAHCOMMI)
                   LENGTH  (6)
              END-EXEC
              IF GAHCOMMI  NUMERIC
                 MOVE GAHCOMMI         TO EN-AH-COMMISSION
                 MOVE AL-UNNON         TO GAHCOMMA
              ELSE
                 MOVE -1               TO GAHCOMML
                 MOVE ER-9999          TO EMI-ERROR
                 MOVE AL-UNBON         TO GAHCOMMA
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF
           IF GLINS1L > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GLINS1I)
                   LENGTH  (11)
              END-EXEC
              IF GLINS1I  NUMERIC
                 MOVE GLINS1I          TO EN-LF-BEN-ENT-AMT
                 MOVE AL-UNNON         TO GLINS1A
              ELSE
                 MOVE -1               TO GLINS1L
                 MOVE ER-0419          TO EMI-ERROR
                 MOVE AL-UNBON         TO GLINS1A
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF
           IF GLINS2L > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GLINS2I)
                   LENGTH  (11)
              END-EXEC
              IF GLINS2I  NUMERIC
                 MOVE GLINS2I          TO EN-LF-BEN-CAL-AMT
                 MOVE AL-UNNON         TO GLINS2A
              ELSE
                 MOVE -1               TO GLINS2L
                 MOVE ER-0419          TO EMI-ERROR
                 MOVE AL-UNBON         TO GLINS2A
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF
           IF GAINS1L > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GAINS1I)
                   LENGTH  (11)
              END-EXEC
              IF GAINS1I  NUMERIC
                 MOVE GAINS1I          TO EN-AH-BEN-ENT-AMT
                 MOVE AL-UNNON         TO GAINS1A
              ELSE
                 MOVE -1               TO GAINS1L
                 MOVE ER-0419          TO EMI-ERROR
                 MOVE AL-UNBON         TO GAINS1A
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF
           IF GAINS2L > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GAINS2I)
                   LENGTH  (11)
              END-EXEC
              IF GAINS2I  NUMERIC
                 MOVE GAINS2I          TO EN-AH-BEN-CAL-AMT
                 MOVE AL-UNNON         TO GAINS2A
              ELSE
                 MOVE -1               TO GAINS2L
                 MOVE ER-0419          TO EMI-ERROR
                 MOVE AL-UNBON         TO GAINS2A
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF

           IF ISSUE-REC
              MOVE '1'                 TO EN-REC-TYPE
              IF GSIGL > +0
                 IF GSIGI = 'Y' OR 'N' OR ' '
                    MOVE GSIGI         TO EN-SIG-SW
                    MOVE AL-UANON      TO GSIGA
                 ELSE
                    MOVE -1            TO GSIGL
                    MOVE AL-UABON      TO GSIGA
                    MOVE ER-2651       TO EMI-ERROR
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GLAMT1L > +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GLAMT1I)
                      LENGTH  (11)
                 END-EXEC
                 IF GLAMT1I  NUMERIC
                    MOVE GLAMT1I       TO EN-LF-PREM-ENT-AMT
                    MOVE AL-UNNON      TO GLAMT1A
                 ELSE
                    MOVE -1            TO GLAMT1L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GLAMT1A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GAAMT1L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GAAMT1I)
                      LENGTH  (11)
                 END-EXEC
                 IF GAAMT1I  NUMERIC
                    MOVE GAAMT1I       TO EN-AH-PREM-ENT-AMT
                    MOVE AL-UNNON      TO GAAMT1A
                 ELSE
                    MOVE -1            TO GAAMT1L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GAAMT1A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GLAMT2L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GLAMT2I)
                      LENGTH  (11)
                 END-EXEC
                 IF GLAMT2I  NUMERIC
                    MOVE GLAMT2I       TO EN-LF-PREM-CAL-AMT
                    MOVE AL-UNNON      TO GLAMT2A
                 ELSE
                    MOVE -1            TO GLAMT2L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GLAMT2A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GAAMT2L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GAAMT2I)
                      LENGTH  (11)
                 END-EXEC
                 IF GAAMT2I  NUMERIC
                    MOVE GAAMT2I       TO EN-AH-PREM-CAL-AMT
                    MOVE AL-UNNON      TO GAAMT2A
                 ELSE
                    MOVE -1            TO GAAMT2L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GAAMT2A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
           ELSE
              MOVE '2'                 TO EN-REC-TYPE
              IF GLOPRML GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GLOPRMI)
                      LENGTH  (11)
                 END-EXEC
                 IF GLOPRMI  NUMERIC
                    MOVE GLOPRMI       TO EN-LF-PREM-ENT-AMT
                    MOVE AL-UNNON      TO GLOPRMA
                 ELSE
                    MOVE -1            TO GLOPRML
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GLOPRMA
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GAOPRML GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GAOPRMI)
                      LENGTH  (11)
                 END-EXEC
                 IF GAOPRMI  NUMERIC
                    MOVE GAOPRMI       TO EN-AH-PREM-ENT-AMT
                    MOVE AL-UNNON      TO GAOPRMA
                 ELSE
                    MOVE -1            TO GAOPRML
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GAOPRMA
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GLAMT1L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GLAMT1I)
                      LENGTH  (11)
                 END-EXEC
                 IF GLAMT1I  NUMERIC
                    MOVE GLAMT1I       TO EN-LF-CANC-ENT-AMT
                    MOVE AL-UNNON      TO GLAMT1A
                 ELSE
                    MOVE -1            TO GLAMT1L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GLAMT1A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GAAMT1L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GAAMT1I)
                      LENGTH  (11)
                 END-EXEC
                 IF GAAMT1I  NUMERIC
                    MOVE GAAMT1I       TO EN-AH-CANC-ENT-AMT
                    MOVE AL-UNNON      TO GAAMT1A
                 ELSE
                    MOVE -1            TO GAAMT1L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GAAMT1A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GLAMT2L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GLAMT2I)
                      LENGTH  (11)
                 END-EXEC
                 IF GLAMT2I  NUMERIC
                    MOVE GLAMT2I       TO EN-LF-CANC-CAL-AMT
                    MOVE AL-UNNON      TO GLAMT2A
                 ELSE
                    MOVE -1            TO GLAMT2L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GLAMT2A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GAAMT2L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GAAMT2I)
                      LENGTH  (11)
                 END-EXEC
                 IF GAAMT2I  NUMERIC
                    MOVE GAAMT2I       TO EN-AH-CANC-CAL-AMT
                    MOVE AL-UNNON      TO GAAMT2A
                 ELSE
                    MOVE -1            TO GAAMT2L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GAAMT2A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              MOVE WS-LF-CANC-DT       TO EN-LF-CANC-DT
              MOVE WS-AH-CANC-DT       TO EN-AH-CANC-DT
           END-IF

           IF EMI-NO-ERRORS
              EXEC CICS WRITE
                   DATASET   (WS-ERENDR-FILE-ID)
                   FROM      (ENDORSEMENT-RECORD)
                   RIDFLD    (EN-CONTROL-PRIMARY)
                   RESP      (WS-RESPONSE)
              END-EXEC
              IF RESP-NORMAL
                 CONTINUE
              ELSE
                 MOVE -1               TO GMAINTL
                 MOVE ER-0132          TO EMI-ERROR
                 MOVE AL-UABON         TO GMAINTA
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           ELSE
              GO TO 8200-SEND-DATAONLY
           END-IF


           .
       0400-EXIT.
           EXIT.

       EJECT
       0410-INIT-ERENDR.

           MOVE SPACES                 TO ENDORSEMENT-RECORD
           MOVE 'EN'                   TO EN-RECORD-ID
           MOVE +0                     TO EN-SEQ-NO
                                          EN-LAST-MAINT-HHMMSS
                                          EN-LF-TERM
                                          EN-AH-TERM
                                          EN-LF-PREM-ENT-AMT
                                          EN-AH-PREM-ENT-AMT
                                          EN-LF-CANC-ENT-AMT
                                          EN-AH-CANC-ENT-AMT
                                          EN-LF-PREM-CAL-AMT
                                          EN-AH-PREM-CAL-AMT
                                          EN-LF-CANC-CAL-AMT
                                          EN-AH-CANC-CAL-AMT
                                          EN-LF-COMMISSION
                                          EN-AH-COMMISSION
                                          EN-LF-BEN-ENT-AMT
                                          EN-AH-BEN-ENT-AMT
                                          EN-LF-BEN-CAL-AMT
                                          EN-AH-BEN-CAL-AMT
           MOVE LOW-VALUES             TO EN-LF-CANC-DT
                                          EN-AH-CANC-DT
                                          EN-PRINT-DT

           .
       0410-EXIT.
           EXIT.

       EJECT
       0420-CHANGE-ERENDR.

           IF WS-ERENDR-KEY = PI-ENDR-PENDING-KEY
              CONTINUE
           ELSE
              MOVE ER-2056             TO EMI-ERROR
              MOVE -1                  TO GMAINTL
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              GO TO 8200-SEND-DATAONLY
           END-IF

           PERFORM 0490-ERENDR-READ-UPDATE
                                       THRU 0490-EXIT

           IF RESP-NORMAL
              IF (PI-UPDATE-BY = EN-LAST-MAINT-BY) AND
                 (PI-UPDATE-HHMMSS = EN-LAST-MAINT-HHMMSS)
                 CONTINUE
              ELSE
                 EXEC CICS UNLOCK
                    DATASET    (WS-ERENDR-FILE-ID)
                 END-EXEC
                 MOVE ER-0068          TO EMI-ERROR
                 MOVE -1               TO GMAINTL
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 GO TO 8200-SEND-DATAONLY
              END-IF
           END-IF

           MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
           MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
           MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT

           IF GPRTDTL > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GPRTDTI)
                   LENGTH  (8)
              END-EXEC
              IF GPRTDTI = ZEROS
                 MOVE LOW-VALUES       TO EN-PRINT-DT
              ELSE
                 MOVE GPRTDTI          TO DC-GREG-DATE-1-MDY
                 MOVE '4'              TO DC-OPTION-CODE
                 PERFORM 9700-DATE-LINK
                 IF DATE-CONVERSION-ERROR
                    MOVE ER-2786       TO EMI-ERROR
                    MOVE -1            TO GPRTDTL
                    MOVE AL-UABON      TO GPRTDTA
                    PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                    GO TO 8200-SEND-DATAONLY
                 ELSE
                    MOVE DC-BIN-DATE-1
                                       TO EN-PRINT-DT
                 END-IF
              END-IF
           END-IF

           IF GLSTNML > +0
              MOVE GLSTNMI             TO EN-LAST-NAME
              MOVE AL-UANON            TO GLSTNMA
           END-IF
           IF G1STNML > +0
              MOVE G1STNMI             TO EN-FIRST-NAME
              MOVE AL-UANON            TO G1STNMA
           END-IF
           IF GINITL > +0
              MOVE GINITI              TO EN-MIDDLE-INIT
              MOVE AL-UANON            TO GINITA
           END-IF

           IF GJLSTNML > +0
              MOVE GJLSTNMI            TO EN-JOINT-LAST-NAME
              MOVE AL-UANON            TO GJLSTNMA
           END-IF
           IF GJ1STNML > +0
              MOVE GJ1STNMI            TO EN-JOINT-FIRST-NAME
              MOVE AL-UANON            TO GJ1STNMA
           END-IF
           IF GJINITL > +0
              MOVE GJINITI             TO EN-JOINT-MIDDLE-INIT
              MOVE AL-UANON            TO GJINITA
           END-IF

           IF GLOTRML GREATER +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GLOTRMI)
                   LENGTH  (3)
              END-EXEC
              IF GLOTRMI  NUMERIC
                 MOVE GLOTRMI          TO EN-LF-TERM
                 MOVE AL-UNNON         TO GLOTRMA
              ELSE
                 MOVE -1               TO GLOTRML
                 MOVE ER-2079          TO EMI-ERROR
                 MOVE AL-UNBON         TO GLOTRMA
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF

           IF GAOTRML GREATER +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GAOTRMI)
                   LENGTH  (3)
              END-EXEC
              IF GAOTRMI  NUMERIC
                 MOVE GAOTRMI          TO EN-AH-TERM
                 MOVE AL-UNNON         TO GAOTRMA
              ELSE
                 MOVE -1               TO GAOTRML
                 MOVE ER-2079          TO EMI-ERROR
                 MOVE AL-UNBON         TO GAOTRMA
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF
           IF GLFCOMML > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GLFCOMMI)
                   LENGTH  (6)
              END-EXEC
              IF GLFCOMMI  NUMERIC
                 MOVE GLFCOMMI         TO EN-LF-COMMISSION
                 MOVE AL-UNNON         TO GLFCOMMA
              ELSE
                 MOVE -1               TO GLFCOMML
                 MOVE ER-9999          TO EMI-ERROR
                 MOVE AL-UNBON         TO GLFCOMMA
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF

           IF GAHCOMML > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GAHCOMMI)
                   LENGTH  (6)
              END-EXEC
              IF GAHCOMMI  NUMERIC
                 MOVE GAHCOMMI         TO EN-AH-COMMISSION
                 MOVE AL-UNNON         TO GAHCOMMA
              ELSE
                 MOVE -1               TO GAHCOMML
                 MOVE ER-9999          TO EMI-ERROR
                 MOVE AL-UNBON         TO GAHCOMMA
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF

           IF GTEXT1L > +0
              MOVE GTEXT1I             TO EN-COMMENTS1
              MOVE AL-UANON            TO GTEXT1A
           END-IF
           IF GTEXT2L > +0
              MOVE GTEXT2I             TO EN-COMMENTS2
              MOVE AL-UANON            TO GTEXT2A
           END-IF
PEMMOD     IF GTEXT3L > +0
PEMMOD        MOVE GTEXT3I             TO EN-COMMENTS3
PEMMOD        MOVE AL-UANON            TO GTEXT3A
PEMMOD     END-IF
PEMMOD     IF GTEXT4L > +0
PEMMOD        MOVE GTEXT4I             TO EN-COMMENTS4
PEMMOD        MOVE AL-UANON            TO GTEXT4A
PEMMOD     END-IF
052307     IF GFLAGL > +0
052307        IF GFLAGI = 'Y' OR 'N' OR ' '
052307            MOVE GFLAGI          TO EN-FLAG-CERT
052307            MOVE AL-UANON        TO GFLAGA
052307        ELSE
052307           MOVE -1               TO GFLAGL
052307           MOVE ER-2791          TO EMI-ERROR
052307           MOVE AL-UABON         TO GFLAGA
052307           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
052307        END-IF
052307     END-IF

           IF GLINS1L > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GLINS1I)
                   LENGTH  (11)
              END-EXEC
              IF GLINS1I  NUMERIC
                 MOVE GLINS1I          TO EN-LF-BEN-ENT-AMT
                 MOVE AL-UNNON         TO GLINS1A
              ELSE
                 MOVE -1               TO GLINS1L
                 MOVE ER-0419          TO EMI-ERROR
                 MOVE AL-UNBON         TO GLINS1A
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF
           IF GLINS2L > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GLINS2I)
                   LENGTH  (11)
              END-EXEC
              IF GLINS2I  NUMERIC
                 MOVE GLINS2I          TO EN-LF-BEN-CAL-AMT
                 MOVE AL-UNNON         TO GLINS2A
              ELSE
                 MOVE -1               TO GLINS2L
                 MOVE ER-0419          TO EMI-ERROR
                 MOVE AL-UNBON         TO GLINS2A
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF
           IF GAINS1L > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GAINS1I)
                   LENGTH  (11)
              END-EXEC
              IF GAINS1I  NUMERIC
                 MOVE GAINS1I          TO EN-AH-BEN-ENT-AMT
                 MOVE AL-UNNON         TO GAINS1A
              ELSE
                 MOVE -1               TO GAINS1L
                 MOVE ER-0419          TO EMI-ERROR
                 MOVE AL-UNBON         TO GAINS1A
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF
           IF GAINS2L > +0
              EXEC CICS BIF DEEDIT
                   FIELD   (GAINS2I)
                   LENGTH  (11)
              END-EXEC
              IF GAINS2I  NUMERIC
                 MOVE GAINS2I          TO EN-AH-BEN-CAL-AMT
                 MOVE AL-UNNON         TO GAINS2A
              ELSE
                 MOVE -1               TO GAINS2L
                 MOVE ER-0419          TO EMI-ERROR
                 MOVE AL-UNBON         TO GAINS2A
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           END-IF

           IF EN-ISSUE
              IF GSIGL > +0
                 IF GSIGI = 'Y' OR 'N' OR ' '
                    MOVE GSIGI         TO EN-SIG-SW
                    MOVE AL-UANON      TO GSIGA
                 ELSE
                    MOVE -1            TO GSIGL
                    MOVE ER-2651       TO EMI-ERROR
                    MOVE AL-UABON      TO GSIGA
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GLAMT1L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GLAMT1I)
                      LENGTH  (11)
                 END-EXEC
                 IF GLAMT1I  NUMERIC
                    MOVE GLAMT1I       TO EN-LF-PREM-ENT-AMT
                    MOVE AL-UNNON      TO GLAMT1A
                 ELSE
                    MOVE -1            TO GLAMT1L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GLAMT1A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GAAMT1L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GAAMT1I)
                      LENGTH  (11)
                 END-EXEC
                 IF GAAMT1I  NUMERIC
                    MOVE GAAMT1I       TO EN-AH-PREM-ENT-AMT
                    MOVE AL-UNNON      TO GAAMT1A
                 ELSE
                    MOVE -1            TO GAAMT1L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GAAMT1A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GLAMT2L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GLAMT2I)
                      LENGTH  (11)
                 END-EXEC
                 IF GLAMT2I  NUMERIC
                    MOVE GLAMT2I       TO EN-LF-PREM-CAL-AMT
                    MOVE AL-UNNON      TO GLAMT2A
                 ELSE
                    MOVE -1            TO GLAMT2L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GLAMT2A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GAAMT2L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GAAMT2I)
                      LENGTH  (11)
                 END-EXEC
                 IF GAAMT2I  NUMERIC
                    MOVE GAAMT2I       TO EN-AH-PREM-CAL-AMT
                    MOVE AL-UNNON      TO GAAMT2A
                 ELSE
                    MOVE -1            TO GAAMT2L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GAAMT2A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
           ELSE
              IF GLCNCDTL > +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GLCNCDTI)
                      LENGTH  (8)
                 END-EXEC
                 IF GLCNCDTI = ZEROS
                    MOVE LOW-VALUES    TO EN-LF-CANC-DT
                 ELSE
                    MOVE GLCNCDTI      TO DC-GREG-DATE-1-MDY
                    MOVE '4'           TO DC-OPTION-CODE
                    PERFORM 9700-DATE-LINK
                    IF DATE-CONVERSION-ERROR
                       MOVE ER-7638    TO EMI-ERROR
                       MOVE -1         TO GLCNCDTL
                       MOVE AL-UABON   TO GLCNCDTA
                       PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                       GO TO 8200-SEND-DATAONLY
                    ELSE
                       MOVE DC-BIN-DATE-1
                                       TO EN-LF-CANC-DT
                    END-IF
                 END-IF
              END-IF

              IF GACNCDTL > +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GACNCDTI)
                      LENGTH  (8)
                 END-EXEC
                 IF GACNCDTI = ZEROS
                    MOVE LOW-VALUES    TO EN-AH-CANC-DT
                 ELSE
                    MOVE GACNCDTI      TO DC-GREG-DATE-1-MDY
                    MOVE '4'           TO DC-OPTION-CODE
                    PERFORM 9700-DATE-LINK
                    IF DATE-CONVERSION-ERROR
                       MOVE ER-7638    TO EMI-ERROR
                       MOVE -1         TO GACNCDTL
                       MOVE AL-UABON   TO GACNCDTA
                       PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                       GO TO 8200-SEND-DATAONLY
                    ELSE
                       MOVE DC-BIN-DATE-1
                                       TO EN-AH-CANC-DT
                    END-IF
                 END-IF
              END-IF
              IF GLOPRML GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GLOPRMI)
                      LENGTH  (11)
                 END-EXEC
                 IF GLOPRMI  NUMERIC
                    MOVE GLOPRMI       TO EN-LF-PREM-ENT-AMT
                    MOVE AL-UNNON      TO GLOPRMA
                 ELSE
                    MOVE -1            TO GLOPRML
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GLOPRMA
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GAOPRML GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GAOPRMI)
                      LENGTH  (11)
                 END-EXEC
                 IF GAOPRMI  NUMERIC
                    MOVE GAOPRMI       TO EN-AH-PREM-ENT-AMT
                    MOVE AL-UNNON      TO GAOPRMA
                 ELSE
                    MOVE -1            TO GAOPRML
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GAOPRMA
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GLAMT1L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GLAMT1I)
                      LENGTH  (11)
                 END-EXEC
                 IF GLAMT1I  NUMERIC
                    MOVE GLAMT1I       TO EN-LF-CANC-ENT-AMT
                    MOVE AL-UNNON      TO GLAMT1A
                 ELSE
                    MOVE -1            TO GLAMT1L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GLAMT1A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GAAMT1L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GAAMT1I)
                      LENGTH  (11)
                 END-EXEC
                 IF GAAMT1I  NUMERIC
                    MOVE GAAMT1I       TO EN-AH-CANC-ENT-AMT
                    MOVE AL-UNNON      TO GAAMT1A
                 ELSE
                    MOVE -1            TO GAAMT1L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GAAMT1A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GLAMT2L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GLAMT2I)
                      LENGTH  (11)
                 END-EXEC
                 IF GLAMT2I  NUMERIC
                    MOVE GLAMT2I       TO EN-LF-CANC-CAL-AMT
                    MOVE AL-UNNON      TO GLAMT2A
                 ELSE
                    MOVE -1            TO GLAMT2L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GLAMT2A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
              IF GAAMT2L GREATER +0
                 EXEC CICS BIF DEEDIT
                      FIELD   (GAAMT2I)
                      LENGTH  (11)
                 END-EXEC
                 IF GAAMT2I  NUMERIC
                    MOVE GAAMT2I       TO EN-AH-CANC-CAL-AMT
                    MOVE AL-UNNON      TO GAAMT2A
                 ELSE
                    MOVE -1            TO GAAMT2L
                    MOVE ER-0419       TO EMI-ERROR
                    MOVE AL-UNBON      TO GAAMT2A
                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
           END-IF

           IF EMI-NO-ERRORS
              EXEC CICS REWRITE
                   DATASET   (WS-ERENDR-FILE-ID)
                   FROM      (ENDORSEMENT-RECORD)
                   RESP      (WS-RESPONSE)
              END-EXEC
              IF RESP-NORMAL
                 CONTINUE
              ELSE
                 MOVE -1               TO GMAINTL
                 MOVE ER-0132          TO EMI-ERROR
                 MOVE AL-UNBON         TO GMAINTA
                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
              END-IF
           ELSE
              GO TO 8200-SEND-DATAONLY
           END-IF


           .
       0420-EXIT.
           EXIT.

       0430-DELETE-ERENDR.

           IF WS-ERENDR-KEY = PI-ENDR-PENDING-KEY
              CONTINUE
           ELSE
              MOVE ER-2056             TO EMI-ERROR
              MOVE -1                  TO GMAINTL
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              GO TO 8200-SEND-DATAONLY
           END-IF

           PERFORM 0490-ERENDR-READ-UPDATE
                                       THRU 0490-EXIT

           IF RESP-NORMAL
              IF (PI-UPDATE-BY = EN-LAST-MAINT-BY) AND
                 (PI-UPDATE-HHMMSS = EN-LAST-MAINT-HHMMSS)
                 EXEC CICS DELETE
                    DATASET    (WS-ERENDR-FILE-ID)
                    RESP       (WS-RESPONSE)
                 END-EXEC
              ELSE
                 MOVE ER-0068          TO EMI-ERROR
                 MOVE -1               TO GMAINTL
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 GO TO 8200-SEND-DATAONLY
              END-IF
           END-IF

           .
       0430-EXIT.
           EXIT.

       0440-DELETE-ERNOTE.

           MOVE WS-ERENDR-KEY          TO WS-ERNOTE-KEY

           PERFORM 0491-ERNOTE-READ-UPDATE
                                       THRU 0491-EXIT

           PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
              (NOTE-SUB > +10) OR
              (CN-LINE (NOTE-SUB) (1:8) = 'ENDORSED')
           END-PERFORM
           IF NOTE-SUB < +11
              MOVE SPACES              TO CN-LINE (NOTE-SUB)
              IF CN-BILLING-END-LINE-NO > 0
111109         AND NOTE-SUB >= CN-BILLING-START-LINE-NO
111109         AND NOTE-SUB <= CN-BILLING-END-LINE-NO              
                 SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
111109           PERFORM 0493-SQUEEZE-ERNOTE
111109                                 THRU 0493-EXIT
              END-IF
              IF CN-BILLING-END-LINE-NO < CN-BILLING-START-LINE-NO
                 MOVE ZEROS            TO CN-BILLING-END-LINE-NO
                                          CN-BILLING-START-LINE-NO
              END-IF
              PERFORM 0492-REWRITE-ERNOTE
                                       THRU 0492-EXIT
111109        IF CN-BILLING-START-LINE-NO = ZERO
111109            PERFORM 0495-UPDATE-CERTIFICATE THRU 0495-EXIT
111109        END-IF                                       
           END-IF

           .
       0440-EXIT.
           EXIT.

       0480-READNEXT-ERACCT.

           EXEC CICS READNEXT
              DATASET    (WS-ERACCT2-FILE-ID)
              RIDFLD     (ERACCT-KEY)
              SET        (ADDRESS OF ACCOUNT-MASTER)
              RESP       (WS-RESPONSE)
           END-EXEC
           .
       0480-EXIT.
           EXIT.

       0490-ERENDR-READ-UPDATE.

           EXEC CICS READ
              UPDATE
              DATASET    (WS-ERENDR-FILE-ID)
              RIDFLD     (WS-ERENDR-KEY)
              SET        (ADDRESS OF ENDORSEMENT-RECORD)
              RESP       (WS-RESPONSE)
           END-EXEC
           .
       0490-EXIT.
           EXIT.

       0491-ERNOTE-READ-UPDATE.

           EXEC CICS READ
              UPDATE
              DATASET    (WS-ERNOTE-FILE-ID)
              RIDFLD     (WS-ERNOTE-KEY)
              SET        (ADDRESS OF CERTIFICATE-NOTE)
              RESP       (WS-RESPONSE)
           END-EXEC
           .
       0491-EXIT.
           EXIT.

       0492-REWRITE-ERNOTE.

           MOVE 'E631'              TO CN-LAST-MAINT-USER
           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS

           EXEC CICS REWRITE
              DATASET    (WS-ERNOTE-FILE-ID)
              FROM       (CERTIFICATE-NOTE)
              RESP       (WS-RESPONSE)
           END-EXEC

           .
       0492-EXIT.
           EXIT.

       0493-SQUEEZE-ERNOTE.

111109     IF CN-BILLING-START-LINE-NO > 0 
111109         MOVE CN-BILLING-START-LINE-NO TO NOTE-SUB
111109     ELSE
111109         MOVE +1                 TO NOTE-SUB
111109     END-IF.
111109
111109     PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
              (NOTE-SUB > +9)
              IF CN-LINE (NOTE-SUB) = SPACES
                 MOVE CN-LINE (NOTE-SUB + +1)
                                       TO CN-LINE (NOTE-SUB)
                 MOVE SPACES           TO CN-LINE (NOTE-SUB + +1)
              END-IF
           END-PERFORM


           .
       0493-EXIT.
           EXIT.
111109
111109 0495-UPDATE-CERTIFICATE.
111109
111109     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CD
111109     MOVE PI-CARRIER             TO CERT-CARRIER
111109     MOVE PI-GROUPING            TO CERT-GROUPING
111109     MOVE PI-STATE               TO CERT-STATE
111109     MOVE PI-ACCOUNT             TO CERT-ACCOUNT
111109     MOVE PI-CERT-PRIME          TO CERT-CERT-PRIME
111109     MOVE PI-CERT-SFX            TO CERT-CERT-SFX
111109     MOVE PI-CERT-EFF-DT         TO CERT-CERT-EFF-DT
111109
111109     EXEC CICS HANDLE CONDITION
111109         NOTFND   (0495-EXIT)
111109     END-EXEC.               
111109                             
111109     EXEC CICS READ          
111109         DATASET   (WS-ELCERT-FILE-ID)
111109         SET       (ADDRESS OF CERTIFICATE-MASTER)
111109         RIDFLD    (WS-ELCERT-KEY)
111109         RESP      (WS-RESPONSE)
111109         UPDATE                           
111109     END-EXEC.                            
111109
111109     IF RESP-NORMAL                                          
111109         IF CM-NOTE-SW = '2' 
111109             MOVE ' '                TO  CM-NOTE-SW
111109         ELSE
111109           IF CM-NOTE-SW = '3'
111109              MOVE '1'               TO  CM-NOTE-SW
111109           ELSE
111109             IF CM-NOTE-SW = '6'
111109                MOVE '4'             TO  CM-NOTE-SW
111109             ELSE
111109               IF CM-NOTE-SW = '7'
111109                  MOVE '5'           TO  CM-NOTE-SW
111109               END-IF
111109             END-IF
111109           END-IF
111109         END-IF
111109         EXEC CICS REWRITE
111109             FROM      (CERTIFICATE-MASTER)
111109             DATASET   (WS-ELCERT-FILE-ID)
111109         END-EXEC
111109     END-IF.
111109 0495-EXIT.
111109      EXIT.           

       0500-ERENDR-READ-GTEQ.

           EXEC CICS READ
               DATASET    (WS-ERENDR-FILE-ID)
               RIDFLD     (WS-ERENDR-KEY)
               SET        (ADDRESS OF ENDORSEMENT-RECORD)
               RESP       (WS-RESPONSE)
               GTEQ
           END-EXEC

           IF NOT RESP-NORMAL
              MOVE ER-2237             TO EMI-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              MOVE -1                  TO GMAINTL
              GO TO 8200-SEND-DATAONLY
           END-IF

           .
       0500-EXIT.
           EXIT.

       0510-ERENDR-READNEXT.

           EXEC CICS READNEXT
              DATASET    (WS-ERENDR-FILE-ID)
              RIDFLD     (WS-ERENDR-KEY)
              SET        (ADDRESS OF ENDORSEMENT-RECORD)
              RESP       (WS-RESPONSE)
           END-EXEC

           IF NOT RESP-NORMAL
              MOVE ER-2237             TO EMI-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              MOVE -1                  TO GMAINTL
              GO TO 8200-SEND-DATAONLY
           END-IF

           .
       0510-EXIT.
           EXIT.

       0520-ERENDR-STARTBR.

           EXEC CICS STARTBR
              DATASET    (WS-ERENDR-FILE-ID)
              RIDFLD     (WS-ERENDR-KEY)
              RESP       (WS-RESPONSE)
           END-EXEC

           IF NOT RESP-NORMAL
              MOVE ER-2237             TO EMI-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              MOVE -1                  TO GMAINTL
              GO TO 8200-SEND-DATAONLY
           END-IF

           .
       0520-EXIT.
           EXIT.

       0530-ERENDR-READPREV.

           EXEC CICS READPREV
              DATASET    (WS-ERENDR-FILE-ID)
              RIDFLD     (WS-ERENDR-KEY)
              SET        (ADDRESS OF ENDORSEMENT-RECORD)
              RESP       (WS-RESPONSE)
           END-EXEC

           IF NOT RESP-NORMAL
              MOVE ER-2238             TO EMI-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              MOVE -1                  TO GMAINTL
              GO TO 8200-SEND-DATAONLY
           END-IF

           .
       0530-EXIT.
           EXIT.

       8100-SEND-INITIAL-MAP.

           MOVE EIBDATE                TO DC-JULIAN-YYDDD.
           MOVE '5'                    TO DC-OPTION-CODE.
           PERFORM 9700-DATE-LINK.
           MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
           MOVE EIBTIME                TO TIME-IN.
           MOVE TIME-OUT               TO TIMEO.
           MOVE -1                     TO GMAINTL
           MOVE EMI-MESSAGE-AREA (1)   TO GERMSGO.
           EXEC CICS SEND
               MAP      (MAP-NAME)
               MAPSET   (MAPSET-NAME)
               FROM     (EL631GO)
               ERASE
               CURSOR
           END-EXEC.

           GO TO 9100-RETURN-TRAN.

       8200-SEND-DATAONLY.

           MOVE EIBDATE                TO DC-JULIAN-YYDDD.
           MOVE '5'                    TO DC-OPTION-CODE.
           PERFORM 9700-DATE-LINK.
           MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
           MOVE EIBTIME                TO TIME-IN.
           MOVE TIME-OUT               TO TIMEO.
           MOVE -1                     TO GPFENTRL
           MOVE EMI-MESSAGE-AREA (1)   TO GERMSGO
           EXEC CICS SEND
               MAP      (MAP-NAME)
               MAPSET   (MAPSET-NAME)
               FROM     (EL631GO)
               DATAONLY
               ERASEAUP
               CURSOR
           END-EXEC.

           GO TO 9100-RETURN-TRAN.

       8300-SEND-TEXT.
           EXEC CICS SEND TEXT
               FROM     (LOGOFF-TEXT)
               LENGTH   (LOGOFF-LENGTH)
               ERASE
               FREEKB
           END-EXEC.

           EXEC CICS RETURN
           END-EXEC.

       8800-UNAUTHORIZED-ACCESS.
           MOVE UNACCESS-MSG           TO LOGOFF-MSG.
           GO TO 8300-SEND-TEXT.

       8810-PF23.
           MOVE EIBAID                 TO PI-ENTRY-CD-1.
           MOVE XCTL-005               TO PGM-NAME.
           GO TO 9300-XCTL.
       9000-RETURN-CICS.
           EXEC CICS RETURN
           END-EXEC.

       9100-RETURN-TRAN.
           MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
           MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.

           EXEC CICS RETURN
               TRANSID    (TRANS-ID)
               COMMAREA   (PROGRAM-INTERFACE-BLOCK)
               LENGTH     (1300)
           END-EXEC.

       9200-RETURN-MAIN-MENU.
           MOVE XCTL-626               TO PGM-NAME.
           GO TO 9300-XCTL.

       9300-XCTL.
           EXEC CICS XCTL
               PROGRAM    (PGM-NAME)
               COMMAREA   (PROGRAM-INTERFACE-BLOCK)
               LENGTH     (1300)
           END-EXEC.

       9400-CLEAR.
           MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.

           EXEC CICS XCTL
               PROGRAM    (PGM-NAME)
               COMMAREA   (PROGRAM-INTERFACE-BLOCK)
               LENGTH     (1300)
           END-EXEC.

       9500-PF12.
           MOVE XCTL-010               TO PGM-NAME.
           GO TO 9300-XCTL.

       9600-PGMID-ERROR.
           EXEC CICS HANDLE CONDITION
               PGMIDERR    (8300-SEND-TEXT)
           END-EXEC.

           MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
           MOVE ' '                    TO PI-ENTRY-CD-1.
           MOVE XCTL-005               TO PGM-NAME.
           MOVE PGM-NAME               TO LOGOFF-PGM.
           MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
           GO TO 9300-XCTL.

       9700-DATE-LINK.
           MOVE LINK-ELDATCV           TO PGM-NAME.

           EXEC CICS LINK
               PROGRAM    (PGM-NAME)
               COMMAREA   (DATE-CONVERSION-DATA)
               LENGTH     (DC-COMM-LENGTH)
           END-EXEC.

       9900-ERROR-FORMAT.
           IF NOT EMI-ERRORS-COMPLETE
              MOVE LINK-001            TO PGM-NAME
              EXEC CICS LINK
                  PROGRAM    (PGM-NAME)
                  COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
                  LENGTH     (EMI-COMM-LENGTH)
              END-EXEC
           END-IF

           .
       9900-EXIT.
           EXIT.

       9990-ABEND.
           MOVE LINK-004               TO PGM-NAME.
           MOVE DFHEIBLK               TO EMI-LINE1.
           EXEC CICS LINK
               PROGRAM   (PGM-NAME)
               COMMAREA  (EMI-LINE1)
               LENGTH    (72)
           END-EXEC.

           GO TO 8200-SEND-DATAONLY.

           GOBACK.

       9995-SECURITY-VIOLATION.
                                   COPY ELCSCTP.

       9995-EXIT.
           EXIT.

