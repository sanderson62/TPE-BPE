* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   1
* EL201.cbl
* Options: int("EL201.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL201.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL201.
    10*
    11*AUTHOR.    Pablo.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   2
* EL201.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  Post check number and check written date to refund checks ***
    17***                                                            ***
    18***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 011714  CR2013053000001  PEMA  NEW PROGRAM
    28* 022014  IR2014022000001  PEMA  chg process when file is empty
    29* 082014  IR2014081400001  PEMA  bypass manual request checks
    30* 082014  IR2015082100001  PEMA  bypass more manual request checks
    31* 092215  IR2015092200001  PEMA  modify determination of manual ch
    32* 091615  CR2015082000001  PEMA  Add Endorsement check processing
    33* 020816  IR2016020500001  PEMA  Add env to unikix cmd for cid1p
    34* 042517  IR2017042500001  PEMA  Reduce number of print lines per
    35* 060717  CR2017032900002  PEMA  CHANGE TEST DB
    36* 030921  CR2019012500003  PEMA  Connect to sdv-db01.cso.local
    37 environment division.
    38 INPUT-OUTPUT SECTION.
    39 FILE-CONTROL.
    40 SELECT CPS-WRITTEN-IN ASSIGN TO dynamic ws-written-in
    41    FILE STATUS IS WRITTEN-STATUS
    42                            ORGANIZATION IS LINE SEQUENTIAL.
    43 SELECT CPS-WRITTEN-RPT ASSIGN TO dynamic ws-written-rpt
    44    FILE STATUS IS WRITRPT-STATUS
    45                            ORGANIZATION IS LINE SEQUENTIAL.
    46 data division.
    47 FILE SECTION.
    48 FD  CPS-WRITTEN-IN
    49     BLOCK CONTAINS 0
    50     RECORDING MODE F.
    51 01  CPS-WRITTEN-IN-REC          pic x(200).
    52 FD  CPS-WRITTEN-RPT
    53     BLOCK CONTAINS 0
    54     RECORDING MODE F.
    55 01  CPS-WRITTEN-RPT-REC         pic x(132).
    56 working-storage section.
    57 01  DFH-START PIC X(04).
    58 77  ws-process-sw               pic x value ' '.
    59     88  process-cashed            value 'C'.
    60     88  process-written           value 'W'.
    61 77  ws-writ-cnt                 pic 9(5) value zeros.
    62 77  ws-tot-writ-amt             pic s9(9)v99 comp-3 value +0.
    63 77  s1                          pic s999 comp-3 value +0.
    64 77  s2                          pic s999 comp-3 value +0.
    65 77  i1                          pic s999 comp-3 value +0.
    66 77  o1                          pic s999 comp-3 value +0.
    67 77  ws-bin-cashed-dt            pic xx  value low-values.
    68 77  ws-bin-check-dt             pic xx  value low-values.
    69 77  ws-page-cntr                pic 999  value zeros.
    70 77  ws-line-cntr                pic 999  value 070.
    71 77  ws-max-lines                pic 999  value 055.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   3
* EL201.cbl
    72 77  ws-erchek-sw                pic x    value spaces.
    73     88  erchek-found              value 'Y'.
    74 77  ws-table-sw                 pic x    value spaces.
    75     88  table-found               value 'Y'.
    76 77  ws-continue-sw              pic x  value 'Y'.
    77     88  ok-to-continue            value 'Y'.
    78     88  not-ok-to-continue        value 'N'.
    79 77  ws-in-recs                  pic 9(5) value zeros.
    80 77  ws-eof-sw                   pic x  value spaces.
    81     88  end-of-input                  value 'Y'.
    82 77  ws-sql-code                 pic s9(7) value zeros.
    83 77  ws-dis-sql-code             pic -9999999 value zeros.
    84 01  ws-work-dynamic.
    85     05  ws-work-dir             pic x(27) value spaces.
    86     05  ws-work-env             pic x(8)  value spaces.
    87     05  ws-work-comp-id         pic xxx   value spaces.
    88     05  ws-work-file-in         pic x(16) value spaces.
    89     05  ws-work-rpt-out         pic x(13) value spaces.
    90     05  ws-work-job-name        pic x(8)  value spaces.
    91 01  ws-written-in               pic x(58).
    92 01  ws-written-rpt              pic x(58).
    93 01  P pointer.
    94 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    95 01  var-ptr pointer.
    96 01  env-var-len                 pic 9(4)  binary.
    97 01  rc                          pic 9(9)  binary.
    98
    99 01  WS-KIXSYS.
   100     05  WS-KIX-FIL1             PIC X(10).
   101     05  WS-KIX-APPS             PIC X(10).
   102     05  WS-KIX-ENV              PIC X(10).
   103     05  WS-KIX-MYENV            PIC X(10).
   104     05  WS-KIX-SYS              PIC X(10).
*  105 EXEC SQL
*  106    INCLUDE SQLDA
*  107 END-EXEC
   108 01 SQLDA sync.
   109    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   110    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   111    05 SQLN                  PIC S9(4) COMP-5 value 0.
   112    05 SQLD                  PIC S9(4) COMP-5 value 0.
   113    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   114       10 SQLTYPE            PIC S9(4) COMP-5.
   115       10 SQLLEN             PIC S9(4) COMP-5.
   116$IF P64 SET
   117X      *> For 64-bit environments, ensure that SQLDATA is
   118X      *> aligned on an 8-byte boundary.
   119X      10 FILLER             PIC S9(9) COMP-5.
   120$END
   121       10 SQLDATA            USAGE POINTER.
   122       10 SQLIND             USAGE POINTER.
   123       10 SQLNAME.
   124          15 SQLNAMEL        PIC S9(4) COMP-5.
   125          15 SQLNAMEC        PIC X(30).
   126
   127* Values for SQLTYPE
   128
   129 78  ESQL-DATE-CHAR              VALUE 384.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   4
* EL201.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   131 78  ESQL-DATE-REC               VALUE 386.
   132 78  ESQL-DATE-REC-NULL          VALUE 387.
   133 78  ESQL-TIME-CHAR              VALUE 388.
   134 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   135 78  ESQL-TIME-REC               VALUE 390.
   136 78  ESQL-TIME-REC-NULL          VALUE 391.
   137 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   138 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   139 78  ESQL-TIMESTAMP-REC          VALUE 394.
   140 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   141 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   142 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   143 78  ESQL-TS-OFFSET-REC          VALUE 398.
   144 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   145 78  ESQL-LONGVARBINARY          VALUE 404.
   146 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   147 78  ESQL-LONGVARCHAR            VALUE 408.
   148 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   149 78  ESQL-BINARY                 VALUE 444.
   150 78  ESQL-BINARY-NULL            VALUE 445.
   151 78  ESQL-VARBINARY              VALUE 446.
   152 78  ESQL-VARBINARY-NULL         VALUE 447.
   153 78  ESQL-VARCHAR                VALUE 448.
   154 78  ESQL-VARCHAR-NULL           VALUE 449.
   155
   156 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   157 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   158
   159 78  ESQL-CHAR                   VALUE 452.
   160 78  ESQL-CHAR-NULL              VALUE 453.
   161
   162 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   163 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   164
   165 78  ESQL-DOUBLE                 VALUE 480.
   166 78  ESQL-DOUBLE-NULL            VALUE 481.
   167 78  ESQL-REAL                   VALUE 482.
   168 78  ESQL-REAL-NULL              VALUE 483.
   169 78  ESQL-DECIMAL                VALUE 484.
   170 78  ESQL-DECIMAL-NULL           VALUE 485.
   171 78  ESQL-INTEGER                VALUE 496.
   172 78  ESQL-INTEGER-NULL           VALUE 497.
   173 78  ESQL-SMALLINT               VALUE 500.
   174 78  ESQL-SMALLINT-NULL          VALUE 501.
   175 78  ESQL-TINYINT                VALUE 502.
   176 78  ESQL-TINYINT-NULL           VALUE 503.
*  177 EXEC SQL
*  178    INCLUDE SQLCA
*  179 END-EXEC
   180 01 SQLCA.
   181     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   182     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   183     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   184     05  SQLERRM.
   185         49  SQLERRML    PIC S9(4) COMP-5.
   186         49  SQLERRMC    PIC X(70).
   187     05  SQLERRP         PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   5
* EL201.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   189     05  SQLWARN.
   190         10  SQLWARN0    PIC X.
   191         10  SQLWARN1    PIC X.
   192         10  SQLWARN2    PIC X.
   193         10  SQLWARN3    PIC X.
   194         10  SQLWARN4    PIC X.
   195         10  SQLWARN5    PIC X.
   196         10  SQLWARN6    PIC X.
   197         10  SQLWARN7    PIC X.
   198     05  SQLEXT.
   199         10  SQLWARN8    PIC X.
   200         10  SQLWARN9    PIC X.
   201         10  SQLWARN10   PIC X.
   202         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   203     05  SQLSTATE    PIC X(5).
   204 EXEC SQL
   205    BEGIN DECLARE SECTION
   206 END-EXEC
   207 01  ws-key-stuff.
   208     05  ws-check-key            pic 9(7).
   209     05  ws-check-no             pic x(7).
   210     05  ws-compid               pic xxx.
   211     05  ws-carrier              pic x.
   212     05  ws-grouping             pic x(6).
   213     05  ws-state                pic xx.
   214     05  ws-account              pic x(10).
   215     05  ws-eff-date             pic x(10).
   216     05  ws-certificate          pic x(10).
   217     05  ws-cert-sfx             pic x.
   218     05  ws-seq-no               pic 999.
   219     05  ws-type                 pic 999.
   220 01  sqlcmd                      pic x(1024).
   221 01  WS-MOE-DATE                 pic x(10).
   222 01  svr                         pic x(32).
   223 01  usr                         pic x(32).
   224 01  pass                        pic x(32).
   225 01  usr-pass                    pic x(64).
   226 01  ws-disp-code                pic s9(11).
   227***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   228***                                                            ***
   229***  These indicators are used to determine if a variable      ***
   230***  is passed nulls from sql. The indicator will be -1        ***
   231***  if the value on sql is nulls and +0 if the value is       ***
   232***  something other than nulls. Here is an example on how     ***
   233***  to use the indicator variables.                           ***
   234***                                                            ***
   235***     EXEC SQL                                               ***
   236***        fetch checkapp into                                 ***
   237***           :db-app-status :nu-app-status,                   ***
   238***           :db-app-by     :nu-app-by,                       ***
   239***           :db-app-date   :nu-app-date,                     ***
   240***           :db-app-batch  :nu-app-batch                     ***
   241***     END-EXEC                                               ***
   242***                                                            ***
   243***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   244 01  indicator-vaiables-for-nulls.
   245     05  nu-app-status           pic s9(4) comp value +0.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   6
* EL201.cbl
   246     05  nu-app-by               pic s9(4) comp value +0.
   247     05  nu-app-date             pic s9(4) comp value +0.
   248     05  nu-app-batch            pic s9(4) comp value +0.
   249     05  nu-fincar               pic s9(4) comp value +0.
   250     05  nu-checkno              pic s9(4) comp value +0.
   251 01  daily-check-request-rec.
   252     05  db-checkkey             pic x(7).
   253     05  db-compid               pic xxx.
   254     05  db-carrier              pic x.
   255     05  db-grouping             pic x(6).
   256     05  db-state                pic xx.
   257     05  db-account              pic x(10).
   258     05  db-effdate              pic x(24).
   259     05  db-certificate          pic x(10).
   260     05  db-cert-sfx             pic x.
   261     05  db-seq-no               pic x(7).
   262     05  db-type                 pic x(7).
   263     05  db-amount               pic x(10).
   264     05  db-amount-n redefines
   265         db-amount               pic 9(7).99.
   266     05  db-checkno              pic x(15).
   267     05  db-checkdate            pic x(10).
   268     05  db-checkstatus          pic 9(5).
   269     05  db-releasebatch         pic 9(5).
   270     05  db-releasedt            pic x(10).
   271     05  db-releaseby            pic x(4).
   272     05  db-payeename1           pic x(30).
   273     05  db-payeename2           pic x(30).
   274     05  db-payeeaddr1           pic x(30).
   275     05  db-payeeaddr2           pic x(30).
   276     05  db-payeecity            pic x(30).
   277     05  db-payeest              pic xx.
   278     05  db-payeezip             pic x(10).
   279     05  db-fincar               pic x.
   280     05  db-fingrp               pic x(6).
   281     05  db-finresp              pic x(10).
   282     05  db-finacct              pic x(10).
   283     05  db-preparer             pic x(4).
   284     05  db-app-status           pic x(9).
   285     05  dp-app-status-n redefines db-app-status
   286                                 pic 9(9).
   287     05  db-app-by               pic x(20).
   288     05  db-app-date             pic x(30).
   289     05  db-app-batch            pic x(10).
   290     05  db-return-to            pic x(30).
   291     05  db-check-sub-type       pic x.
   292 EXEC SQL
   293    END DECLARE SECTION
   294 END-EXEC
   295 01  FILE-KEYS.
   296     12  ELCNTL-KEY.
   297         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   298         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   299         16 ELCNTL-ACCESS.
   300             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   301             20  FILLER              PIC X       VALUE SPACES.
   302             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   303         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   7
* EL201.cbl
   304 01  f.
   305     05  ws-connect-sw               pic x  value ' '.
   306         88  connected-to-db             value 'Y'.
   307     05  written-status          pic xx.
   308     05  writrpt-status          pic xx.
   309     05  ws-comp-id              pic xxx.
   310     05  ws-comp-cd              pic x.
   311 01  ws-raw-record.
   312     05  raw-check-no            pic x(20).
   313     05  raw-check-dt            pic x(20).
   314     05  raw-check-amt           pic x(15).
   315     05  raw-vendor-id           pic x(20).
   316     05  raw-user-defined        pic x(30).
   317     05  raw-voucher-ref         pic x(35).
   318 01  ws-written-rec.
   319     05  wsw-check-no            pic x(20).
   320     05  wsw-check-dt            pic x(20).
   321     05  wsw-check-amt           pic x(15).
   322     05  wsw-vendor-id           pic x(20).
   323     05  wsw-user-defined        pic x(30).
   324     05  wsw-voucher-ref         pic x(35).
   325 01  filler.
   326     05  wsw-check-key           pic x(7).
   327     05  wsw-check-key-num redefines wsw-check-key
   328                                 pic 9(7).
   329 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   330     88  RESP-NORMAL                    VALUE +0.
   331     88  resp-file-notfnd               value +12.
   332     88  RESP-NOTFND                    VALUE +13.
   333     88  resp-duprec                    value +14.
   334     88  resp-dupkey                    value +15.
   335     88  resp-invreq                    value +16.
   336     88  RESP-NOTOPEN                   VALUE +19.
   337     88  RESP-ENDFILE                   VALUE +20.
   338     88  resp-lengtherr                 value +22.
   339 01  ws-work-amt-alpha           pic x(10).
   340 01  ws-work-amt-num redefines ws-work-amt-alpha
   341                                 pic 9(8)v99.
   342 01  ws-qry-string               pic x(80) value spaces.
   343 01  ws-qrystr-len               pic s9(8) comp value +60.
   344 01  ws-seq-alpha                pic x(5).
   345 01  ws-seq-no-num redefines ws-seq-alpha
   346                                 pic 9(5).
   347*                                copy ERCCHEK.
   348******************************************************************
   349*                                                                *
   350*                                                                *
   351*                            ERCCHEK                             *
   352*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   353*                            VMOD=2.008                          *
   354*                                                                *
   355*   FILE DESCRIPTION = CHECK RECORDS                             *
   356*                                                                *
   357*   FILE TYPE = VSAM,KSDS                                        *
   358*   RECORD SIZE = 600    RECFORM = FIXED                         *
   359*                                                                *
   360*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
   361*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   8
* EL201.cbl
   362*                                                                *
   363*   LOG = YES                                                    *
   364*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   365******************************************************************
   366*                   C H A N G E   L O G
   367*
   368* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   369*-----------------------------------------------------------------
   370*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   371* EFFECTIVE    NUMBER
   372*-----------------------------------------------------------------
   373* 021414    2003053000001  PEMA  changes for auto chk request
   374******************************************************************
   375 01  CHECK-RECORDS.
   376     12  CH-RECORD-ID                      PIC XX.
   377         88  VALID-CH-ID                      VALUE 'CH'.
   378
   379     12  CH-CONTROL-PRIMARY.
   380         16  CH-COMPANY-CD                 PIC X.
   381         16  CH-CARRIER                    PIC X.
   382         16  CH-GROUPING                   PIC X(6).
   383         16  CH-STATE                      PIC XX.
   384         16  CH-ACCOUNT                    PIC X(10).
   385         16  CH-CERT-EFF-DT                PIC XX.
   386         16  CH-CERT-NO.
   387             20  CH-CERT-PRIME             PIC X(10).
   388             20  CH-CERT-SFX               PIC X.
   389         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
   390
   391     12  CH-RECORDED-DT                    PIC XX.
   392     12  CH-RECORDED-BY                    PIC X(4).
   393     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
   394
   395     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
   396     12  CH-CHECK-NO                       PIC X(7).
   397     12  CH-REASON-FOR-CHECK               PIC X(25).
   398     12  CH-CHECK-WRITTEN-DT               PIC XX.
   399     12  FILLER                            PIC X.
   400
   401     12  CH-PAYEE-INFO.
   402         16  CH-PAYEE-NAME-1               PIC X(30).
   403         16  CH-PAYEE-NAME-2               PIC X(30).
   404         16  CH-PAYEE-ADDRESS-1            PIC X(30).
   405         16  CH-PAYEE-ADDRESS-2            PIC X(30).
   406         16  CH-PAYEE-CITY-ST.
   407             20  CH-PAYEE-CITY             PIC X(28).
   408             20  CH-PAYEE-STATE            PIC XX.
   409         16  CH-PAYEE-ZIP-CODE.
   410             20  CH-PAYEE-ZIP.
   411                 24  CH-ZIP-PRI-1ST        PIC X.
   412                     88  CH-CANADIAN-POST-CODE
   413                                           VALUES 'A' THRU 'Z'.
   414                 24  FILLER                PIC X(4).
   415             20  CH-PAYEE-ZIP-EXT          PIC X(4).
   416         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
   417             20  CH-CAN-POSTAL-1           PIC XXX.
   418             20  CH-CAN-POSTAL-2           PIC XXX.
   419             20  FILLER                    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page   9
* EL201.cbl
   420
   421     12  CH-CHECK-STUB-TEXT.
   422         16  CH-STUB-LINE-1                PIC X(30).
   423         16  CH-TEXT-LINE-1                PIC X(50).
   424         16  CH-TEXT-LINE-2                PIC X(50).
   425         16  CH-TEXT-LINE-3                PIC X(40).
   426     12  CH-RETURN-TO                      PIC X(30).
   427
   428     12  CH-COMPENSATION-CONTROL.
   429         16  CH-COMP-CARRIER               PIC X.
   430         16  CH-COMP-GROUPING              PIC X(6).
   431         16  CH-COMP-FIN-RESP              PIC X(10).
   432         16  CH-COMP-ACCOUNT               PIC X(10).
   433
   434     12  CH-CREDIT-SELECT-DT               PIC XX.
   435     12  CH-CREDIT-ACCEPT-DT               PIC XX.
   436     12  CH-PAYEE-CODE                     PIC X(6).
   437
   438     12  CH-VOID-DATA.
   439         20  CH-VOID-DT                    PIC XX.
   440         20  CH-VOID-BY                    PIC X(4).
   441         20  CH-VOID-REASON                PIC X(25).
   442
   443     12  CH-APPROVAL-DATA.
   444         20  CH-APPROVAL-DT                PIC XX.
   445         20  CH-APPROVAL-STATUS            PIC X.
   446             88  CH-IN-LIMBO                  VALUE ' '.
   447             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   448             88  CH-APPROVED                  VALUE 'A'.
   449             88  CH-DENIED                    VALUE 'D'.
   450         20  CH-APPROVED-BY                PIC XXXX.
   451     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
   452             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   453     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
   454
   455     12  ch-released-dt                    pic xx.
   456     12  ch-check-cashed-dt                pic xx.
   457     12  FILLER                            PIC X.
   458*    12  CH-CHECK-REFERENCE                PIC X(12).
   459     12  CH-CHECK-ORIGIN-SW                PIC X.
   460             88  CH-REFUND-CHECK              VALUE 'R'.
   461             88  CH-MAINT-CHECK               VALUE 'M'.
   462
   463     12  CH-CANC-DT                        PIC XX.
   464     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
   465     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
   466
   467     12  CH-INSURED-NAME                   PIC X(28).
   468
   469     12  ch-released-by                    pic x(4).
   470     12  ch-csr                            pic x(4).
   471     12  ch-deduct-commission              pic x.
   472         88  ch-deduct-comm                  value 'Y'.
   473         88  ch-do-not-deduct-comm           value 'N'.
   474
   475     12  FILLER                            PIC X(11).
   476*    12  CH-LETTER-TABLE.
   477*        16  CH-LETTERS OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  10
* EL201.cbl
   478*                       INDEXED BY CH-LT-NDX
   479*                                          PIC X(04).
   480
   481     12  FILLER                            PIC X(07).
   482
   483*                                copy ELCFUNDT.
   484*****************************************************************
   485*                                                               *
   486*                            ELCFUNDT.                          *
   487*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   488*                            VMOD=2.001                         *
   489*                                                               *
   490*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   491*                                                               *
   492*****************************************************************
   493
   494
   495 01  FUNCTION-DATE.
   496     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   497     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   498         10  WS-FN-CCYR            PIC 9(4).
   499         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   500             15  WS-FN-CC          PIC 99.
   501             15  WS-FN-YR          PIC 99.
   502         10  WS-FN-MO              PIC 99.
   503         10  WS-FN-DA              PIC 99.
   504     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   505     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   506     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   507     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   508     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   509         88  WS-BEHIND-GMT                     VALUE '-'.
   510         88  WS-AFTER-GMT                      VALUE '+'.
   511         88  WS-NO-GMT                         VALUE ZERO.
   512     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   513     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   514*                                COPY ELCDATE.
   515******************************************************************
   516*                                                                *
   517*                                                                *
   518*                            ELCDATE.                            *
   519*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   520*                            VMOD=2.003
   521*                                                                *
   522*                                                                *
   523*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   524*                 LENGTH = 200                                   *
   525******************************************************************
   526
   527 01  DATE-CONVERSION-DATA.
   528     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   529     12  DC-OPTION-CODE                PIC X.
   530         88  BIN-TO-GREG                VALUE ' '.
   531         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   532         88  EDIT-GREG-TO-BIN           VALUE '2'.
   533         88  YMD-GREG-TO-BIN            VALUE '3'.
   534         88  MDY-GREG-TO-BIN            VALUE '4'.
   535         88  JULIAN-TO-BIN              VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  11
* EL201.cbl
   536         88  BIN-PLUS-ELAPSED           VALUE '6'.
   537         88  FIND-CENTURY               VALUE '7'.
   538         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   539         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   540         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   541         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   542         88  JULIAN-TO-BIN-3            VALUE 'C'.
   543         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   544         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   545         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   546         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   547         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   548         88  CHECK-LEAP-YEAR            VALUE 'H'.
   549         88  BIN-3-TO-GREG              VALUE 'I'.
   550         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   551         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   552         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   553         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   554         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   555         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   556         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   557         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   558         88  THREE-CHARACTER-BIN
   559                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   560         88  GREGORIAN-TO-BIN
   561                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   562         88  BIN-TO-GREGORIAN
   563                  VALUES ' ' '1' 'I' '8' 'G'.
   564         88  JULIAN-TO-BINARY
   565                  VALUES '5' 'C' 'E' 'F'.
   566     12  DC-ERROR-CODE                 PIC X.
   567         88  NO-CONVERSION-ERROR        VALUE ' '.
   568         88  DATE-CONVERSION-ERROR
   569                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   570         88  DATE-IS-ZERO               VALUE '1'.
   571         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   572         88  DATE-IS-INVALID            VALUE '3'.
   573         88  DATE1-GREATER-DATE2        VALUE '4'.
   574         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   575         88  DATE-INVALID-OPTION        VALUE '9'.
   576         88  INVALID-CENTURY            VALUE 'A'.
   577         88  ONLY-CENTURY               VALUE 'B'.
   578         88  ONLY-LEAP-YEAR             VALUE 'C'.
   579         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   580     12  DC-END-OF-MONTH               PIC X.
   581         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   582     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   583         88  USE-NORMAL-PROCESS         VALUE ' '.
   584         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   585         88  ADJUST-UP-100-YRS          VALUE '2'.
   586     12  FILLER                        PIC X.
   587     12  DC-CONVERSION-DATES.
   588         16  DC-BIN-DATE-1             PIC XX.
   589         16  DC-BIN-DATE-2             PIC XX.
   590         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   591         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   592                       DC-GREG-DATE-1-EDIT.
   593             20  DC-EDIT1-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  12
* EL201.cbl
   594             20  SLASH1-1              PIC X.
   595             20  DC-EDIT1-DAY          PIC 99.
   596             20  SLASH1-2              PIC X.
   597             20  DC-EDIT1-YEAR         PIC 99.
   598         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   599         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   600                     DC-GREG-DATE-2-EDIT.
   601             20  DC-EDIT2-MONTH        PIC 99.
   602             20  SLASH2-1              PIC X.
   603             20  DC-EDIT2-DAY          PIC 99.
   604             20  SLASH2-2              PIC X.
   605             20  DC-EDIT2-YEAR         PIC 99.
   606         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   607         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   608                     DC-GREG-DATE-1-YMD.
   609             20  DC-YMD-YEAR           PIC 99.
   610             20  DC-YMD-MONTH          PIC 99.
   611             20  DC-YMD-DAY            PIC 99.
   612         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   613         16  DC-GREG-DATE-1-MDY-R REDEFINES
   614                      DC-GREG-DATE-1-MDY.
   615             20  DC-MDY-MONTH          PIC 99.
   616             20  DC-MDY-DAY            PIC 99.
   617             20  DC-MDY-YEAR           PIC 99.
   618         16  DC-GREG-DATE-1-ALPHA.
   619             20  DC-ALPHA-MONTH        PIC X(10).
   620             20  DC-ALPHA-DAY          PIC 99.
   621             20  FILLER                PIC XX.
   622             20  DC-ALPHA-CENTURY.
   623                 24 DC-ALPHA-CEN-N     PIC 99.
   624             20  DC-ALPHA-YEAR         PIC 99.
   625         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   626         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   627         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   628         16  DC-JULIAN-DATE            PIC 9(05).
   629         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   630                                       PIC 9(05).
   631         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   632             20  DC-JULIAN-YEAR        PIC 99.
   633             20  DC-JULIAN-DAYS        PIC 999.
   634         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   635         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   636         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   637     12  DATE-CONVERSION-VARIBLES.
   638         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   639         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   640             20  FILLER                PIC 9(3).
   641             20  HOLD-CEN-1-CCYY.
   642                 24  HOLD-CEN-1-CC     PIC 99.
   643                 24  HOLD-CEN-1-YY     PIC 99.
   644             20  HOLD-CEN-1-MO         PIC 99.
   645             20  HOLD-CEN-1-DA         PIC 99.
   646         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   647             20  HOLD-CEN-1-R-MO       PIC 99.
   648             20  HOLD-CEN-1-R-DA       PIC 99.
   649             20  HOLD-CEN-1-R-CCYY.
   650                 24  HOLD-CEN-1-R-CC   PIC 99.
   651                 24  HOLD-CEN-1-R-YY   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  13
* EL201.cbl
   652             20  FILLER                PIC 9(3).
   653         16  HOLD-CENTURY-1-X.
   654             20  FILLER                PIC X(3)  VALUE SPACES.
   655             20  HOLD-CEN-1-X-CCYY.
   656                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   657                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   658             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   659             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   660         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   661             20  HOLD-CEN-1-R-X-MO     PIC XX.
   662             20  HOLD-CEN-1-R-X-DA     PIC XX.
   663             20  HOLD-CEN-1-R-X-CCYY.
   664                 24  HOLD-CEN-1-R-X-CC PIC XX.
   665                 24  HOLD-CEN-1-R-X-YY PIC XX.
   666             20  FILLER                PIC XXX.
   667         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   668         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   669         16  DC-JULIAN-DATE-1          PIC 9(07).
   670         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   671             20  DC-JULIAN-1-CCYY.
   672                 24  DC-JULIAN-1-CC    PIC 99.
   673                 24  DC-JULIAN-1-YR    PIC 99.
   674             20  DC-JULIAN-DA-1        PIC 999.
   675         16  DC-JULIAN-DATE-2          PIC 9(07).
   676         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   677             20  DC-JULIAN-2-CCYY.
   678                 24  DC-JULIAN-2-CC    PIC 99.
   679                 24  DC-JULIAN-2-YR    PIC 99.
   680             20  DC-JULIAN-DA-2        PIC 999.
   681         16  DC-GREG-DATE-A-EDIT.
   682             20  DC-EDITA-MONTH        PIC 99.
   683             20  SLASHA-1              PIC X VALUE '/'.
   684             20  DC-EDITA-DAY          PIC 99.
   685             20  SLASHA-2              PIC X VALUE '/'.
   686             20  DC-EDITA-CCYY.
   687                 24  DC-EDITA-CENT     PIC 99.
   688                 24  DC-EDITA-YEAR     PIC 99.
   689         16  DC-GREG-DATE-B-EDIT.
   690             20  DC-EDITB-MONTH        PIC 99.
   691             20  SLASHB-1              PIC X VALUE '/'.
   692             20  DC-EDITB-DAY          PIC 99.
   693             20  SLASHB-2              PIC X VALUE '/'.
   694             20  DC-EDITB-CCYY.
   695                 24  DC-EDITB-CENT     PIC 99.
   696                 24  DC-EDITB-YEAR     PIC 99.
   697         16  DC-GREG-DATE-CYMD         PIC 9(08).
   698         16  DC-GREG-DATE-CYMD-R REDEFINES
   699                              DC-GREG-DATE-CYMD.
   700             20  DC-CYMD-CEN           PIC 99.
   701             20  DC-CYMD-YEAR          PIC 99.
   702             20  DC-CYMD-MONTH         PIC 99.
   703             20  DC-CYMD-DAY           PIC 99.
   704         16  DC-GREG-DATE-MDCY         PIC 9(08).
   705         16  DC-GREG-DATE-MDCY-R REDEFINES
   706                              DC-GREG-DATE-MDCY.
   707             20  DC-MDCY-MONTH         PIC 99.
   708             20  DC-MDCY-DAY           PIC 99.
   709             20  DC-MDCY-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  14
* EL201.cbl
   710             20  DC-MDCY-YEAR          PIC 99.
   711    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   712        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   713    12  DC-EL310-DATE                  PIC X(21).
   714    12  FILLER                         PIC X(28).
   715*                                COPY ELCCNTL.
   716******************************************************************
   717*                                                                *
   718*                                                                *
   719*                            ELCCNTL.                            *
   720*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   721*                            VMOD=2.059                          *
   722*                                                                *
   723*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   724*                                                                *
   725*   FILE TYPE = VSAM,KSDS                                        *
   726*   RECORD SIZE = 750  RECFORM = FIXED                           *
   727*                                                                *
   728*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   729*       ALTERNATE INDEX = NONE                                   *
   730*                                                                *
   731*   LOG = YES                                                    *
   732*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   733******************************************************************
   734*                   C H A N G E   L O G
   735*
   736* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   737*-----------------------------------------------------------------
   738*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   739* EFFECTIVE    NUMBER
   740*-----------------------------------------------------------------
   741* 082503                   PEMA  ADD BENEFIT GROUP
   742* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   743* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   744* 092705    2005050300006  PEMA  ADD SPP LEASES
   745* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   746* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   747* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   748* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   749* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   750* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   751* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   752* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   753* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   754* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   755* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
   756******************************************************************
   757*
   758 01  CONTROL-FILE.
   759     12  CF-RECORD-ID                       PIC XX.
   760         88  VALID-CF-ID                        VALUE 'CF'.
   761
   762     12  CF-CONTROL-PRIMARY.
   763         16  CF-COMPANY-ID                  PIC XXX.
   764         16  CF-RECORD-TYPE                 PIC X.
   765             88  CF-COMPANY-MASTER              VALUE '1'.
   766             88  CF-PROCESSOR-MASTER            VALUE '2'.
   767             88  CF-STATE-MASTER                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  15
* EL201.cbl
   768             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   769             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   770             88  CF-CARRIER-MASTER              VALUE '6'.
   771             88  CF-MORTALITY-MASTER            VALUE '7'.
   772             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   773             88  CF-TERMINAL-MASTER             VALUE '9'.
   774             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   775             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   776             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   777             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   778             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   779             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   780             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   781             88  CF-REMINDERS-MASTER            VALUE 'R'.
   782             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   783         16  CF-ACCESS-CD-GENL              PIC X(4).
   784         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   785             20  CF-PROCESSOR               PIC X(4).
   786         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   787             20  CF-STATE-CODE              PIC XX.
   788             20  FILLER                     PIC XX.
   789         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   790             20  FILLER                     PIC XX.
   791             20  CF-HI-BEN-IN-REC           PIC XX.
   792         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   793             20  FILLER                     PIC XXX.
   794             20  CF-CARRIER-CNTL            PIC X.
   795         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   796             20  FILLER                     PIC XX.
   797             20  CF-HI-TYPE-IN-REC          PIC 99.
   798         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   799             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   800                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   801             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   802             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   803         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   804             20  FILLER                     PIC X.
   805             20  CF-CUSTOM-REPORT-NO        PIC 999.
   806         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   807             20  FILLER                     PIC XX.
   808             20  CF-MORTGAGE-PLAN           PIC XX.
   809         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   810
   811     12  CF-LAST-MAINT-DT                   PIC XX.
   812     12  CF-LAST-MAINT-BY                   PIC X(4).
   813     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   814
   815     12  CF-RECORD-BODY                     PIC X(728).
   816
   817
   818****************************************************************
   819*             COMPANY MASTER RECORD                            *
   820****************************************************************
   821
   822     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   823         16  CF-COMPANY-ADDRESS.
   824             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   825             20  CF-CL-IN-CARE-OF           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  16
* EL201.cbl
   826             20  CF-CL-ADDR-LINE-1          PIC X(30).
   827             20  CF-CL-ADDR-LINE-2          PIC X(30).
   828             20  CF-CL-CITY-STATE           PIC X(30).
   829             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   830             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   831         16  CF-COMPANY-CD                  PIC X.
   832         16  CF-COMPANY-PASSWORD            PIC X(8).
   833         16  CF-SECURITY-OPTION             PIC X.
   834             88  ALL-SECURITY                   VALUE '1'.
   835             88  COMPANY-VERIFY                 VALUE '2'.
   836             88  PROCESSOR-VERIFY               VALUE '3'.
   837             88  NO-SECURITY                    VALUE '4'.
   838             88  ALL-BUT-TERM                   VALUE '5'.
   839         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   840             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   841         16  CF-LGX-INTERFACE-CNTL          PIC X.
   842             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   843         16  CF-INFORCE-LOCATION            PIC X.
   844             88  CERTS-ARE-ONLINE               VALUE '1'.
   845             88  CERTS-ARE-OFFLINE              VALUE '2'.
   846             88  NO-CERTS-AVAILABLE             VALUE '3'.
   847         16  CF-LOWER-CASE-LETTERS          PIC X.
   848         16  CF-CERT-ACCESS-CONTROL         PIC X.
   849             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   850             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   851             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   852             88  CF-ACCNT-CNTL                  VALUE '3'.
   853             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   854
   855         16  CF-FORMS-PRINTER-ID            PIC X(4).
   856         16  CF-CHECK-PRINTER-ID            PIC X(4).
   857
   858         16  CF-LGX-CREDIT-USER             PIC X.
   859             88  CO-IS-NOT-USER                 VALUE 'N'.
   860             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   861
   862         16 CF-CREDIT-CALC-CODES.
   863             20  CF-CR-REM-TERM-CALC PIC X.
   864               88  CR-EARN-AFTER-15TH           VALUE '1'.
   865               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   866               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   867               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   868               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   869               88  CR-EARN-AFTER-14TH           VALUE '6'.
   870               88  CR-EARN-AFTER-16TH           VALUE '7'.
   871             20  CF-CR-R78-METHOD           PIC X.
   872               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   873               88  DONT-USE-PLUS-ONE            VALUE '1'.
   874
   875         16  CF-CLAIM-CONTROL-COUNTS.
   876             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   877                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   878
   879             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   880                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   881
   882             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   883                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  17
* EL201.cbl
   884
   885             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   886                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   887
   888         16  CF-CURRENT-MONTH-END           PIC XX.
   889
   890         16  CF-CO-CALC-QUOTE-TOLERANCE.
   891             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   892             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   893             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   894             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   895                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   896                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   897             20  CF-CO-PREM-REJECT-SW       PIC X.
   898                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   899                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   900             20  CF-CO-REF-REJECT-SW        PIC X.
   901                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   902                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   903
   904         16  CF-CO-REPORTING-DT             PIC XX.
   905         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   906         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   907           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   908           88  CF-CO-MONTH-END                  VALUE '1'.
   909
   910         16  CF-LGX-CLAIM-USER              PIC X.
   911             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   912             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   913
   914         16  CF-CREDIT-EDIT-CONTROLS.
   915             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   916             20  CF-MIN-AGE                 PIC 99.
   917             20  CF-DEFAULT-AGE             PIC 99.
   918             20  CF-MIN-TERM                PIC S999      COMP-3.
   919             20  CF-MAX-TERM                PIC S999      COMP-3.
   920             20  CF-DEFAULT-SEX             PIC X.
   921             20  CF-JOINT-AGE-INPUT         PIC X.
   922                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   923             20  CF-BIRTH-DATE-INPUT        PIC X.
   924                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   925             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   926                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   927                 88  CF-ZERO-CARRIER            VALUE '1'.
   928                 88  CF-ZERO-GROUPING           VALUE '2'.
   929                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   930             20  CF-EDIT-SW                 PIC X.
   931                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   932             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   933             20  CF-CR-PR-METHOD            PIC X.
   934               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   935               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   936             20  FILLER                     PIC X.
   937
   938         16  CF-CREDIT-MISC-CONTROLS.
   939             20  CF-REIN-TABLE-SW           PIC X.
   940                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   941             20  CF-COMP-TABLE-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  18
* EL201.cbl
   942                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   943             20  CF-EXPERIENCE-RETENTION-AGE
   944                                            PIC S9        COMP-3.
   945             20  CF-CONVERSION-DT           PIC XX.
   946             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   947             20  CF-RUN-FREQUENCY-SW        PIC X.
   948                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   949                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   950
   951             20  CF-CR-CHECK-NO-CONTROL.
   952                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   953                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   954                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   955                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   956                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   957                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   958
   959                 24  CF-CR-CHECK-COUNT       REDEFINES
   960                     CF-CR-CHECK-COUNTER      PIC X(4).
   961
   962                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   963                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   964
   965                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   966                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   967                 24  CF-MAIL-PROCESSING       PIC X.
   968                     88  MAIL-PROCESSING          VALUE 'Y'.
   969
   970         16  CF-MISC-SYSTEM-CONTROL.
   971             20  CF-SYSTEM-C                 PIC X.
   972                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   973             20  CF-SYSTEM-D                 PIC X.
   974                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   975             20  CF-SOC-SEC-NO-SW            PIC X.
   976                 88  SOC-SEC-NO-USED             VALUE '1'.
   977             20  CF-MEMBER-NO-SW             PIC X.
   978                 88  MEMBER-NO-USED              VALUE '1'.
   979             20  CF-TAX-ID-NUMBER            PIC X(11).
   980             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   981             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   982                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   983                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   984                 88  CF-ALL-APPROVED             VALUE 'Y'.
   985                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   986             20  CF-SYSTEM-E                 PIC X.
   987                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   988
   989         16  CF-LGX-LIFE-USER               PIC X.
   990             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   991             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   992
   993         16  CF-CR-MONTH-END-DT             PIC XX.
   994
   995         16  CF-FILE-MAINT-DATES.
   996             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   997                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   998             20  CF-LAST-BATCH       REDEFINES
   999                 CF-LAST-BATCH-NO               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  19
* EL201.cbl
  1000             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1001             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1002             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1003             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1004             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1005             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1006             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1007             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1008             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1009             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1010
  1011         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1012         16  FILLER                         PIC X.
  1013
  1014         16  CF-ALT-MORT-CODE               PIC X(4).
  1015         16  CF-MEMBER-CAPTION              PIC X(10).
  1016
  1017         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1018             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1019             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1020             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1021             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1022             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1023
  1024         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1025
  1026         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1027         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1028         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1029         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1030
  1031         16  CF-AH-OVERRIDE-L1              PIC X.
  1032         16  CF-AH-OVERRIDE-L2              PIC XX.
  1033         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1034         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1035
  1036         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1037         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1038
  1039         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1040         16  CF-AR-LAST-EL860-DT            PIC XX.
  1041         16  CF-MP-MONTH-END-DT             PIC XX.
  1042
  1043         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1044         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1045             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1046
  1047         16  CF-AR-MONTH-END-DT             PIC XX.
  1048
  1049         16  CF-CRDTCRD-USER                PIC X.
  1050             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1051             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1052
  1053         16  CF-CC-MONTH-END-DT             PIC XX.
  1054
  1055         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1056
  1057         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  20
* EL201.cbl
  1058             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1059             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1060             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1061         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1062         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1063         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1064         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1065             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1066             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1067         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1068         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1069         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1070             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1071         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1072
  1073         16  CF-CL-ZIP-CODE.
  1074             20  CF-CL-ZIP-PRIME.
  1075                 24  CF-CL-ZIP-1ST          PIC X.
  1076                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1077                 24  FILLER                 PIC X(4).
  1078             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1079         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1080             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1081             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1082             20  FILLER                     PIC XXX.
  1083
  1084         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1085         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1086         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1087         16  CF-CO-OPTION-START-DATE        PIC XX.
  1088         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1089           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1090                                                      '3' '4'.
  1091           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1092           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1093           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1094           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1095           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1096           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1097
  1098         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1099
  1100         16  CF-PAYMENT-APPROVAL-LEVELS.
  1101             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1102             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1103             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1104             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1105             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1106             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1107
  1108         16  CF-END-USER-REPORTING-USER     PIC X.
  1109             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1110             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1111
  1112         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1113             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1114             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1115
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  21
* EL201.cbl
  1116         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1117
  1118         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1119         16  FILLER                         PIC X.
  1120
  1121         16  CF-CREDIT-ARCHIVE-CNTL.
  1122             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1123             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1124             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1125
  1126         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1127
  1128         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1129             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1130             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1131
  1132         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1133             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1134             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1135
  1136         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1137
  1138         16  CF-CO-ACH-ID-CODE              PIC  X.
  1139             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1140             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1141             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1142         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1143         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1144         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1145         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1146         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1147         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1148         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1149         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1150         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1151                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1152         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1153                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1154
  1155         16  CF-CO-OVER-SHORT.
  1156             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1157             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1158
  1159*         16  FILLER                         PIC X(102).
  1160         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1161             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1162             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1163
  1164         16  CF-AH-APPROVAL-DAYS.
  1165             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1166             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1167             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1168             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1169
  1170         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1171
  1172         16  CF-APPROV-LEV-5.
  1173             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  22
* EL201.cbl
  1174             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1175             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1176
  1177         16  FILLER                         PIC X(68).
  1178****************************************************************
  1179*             PROCESSOR/USER RECORD                            *
  1180****************************************************************
  1181
  1182     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1183         16  CF-PROCESSOR-NAME              PIC X(30).
  1184         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1185         16  CF-PROCESSOR-TITLE             PIC X(26).
  1186         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1187                 88  MESSAGE-YES                VALUE 'Y'.
  1188                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1189
  1190*****************************************************
  1191****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1192****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1193****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1194****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1195*****************************************************
  1196
  1197         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1198             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1199             20  CF-APPLICATION-FORCE       PIC X.
  1200             20  CF-INDIVIDUAL-APP.
  1201                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1202                     28  CF-BROWSE-APP      PIC X.
  1203                     28  CF-UPDATE-APP      PIC X.
  1204
  1205         16  CF-CURRENT-TERM-ON             PIC X(4).
  1206         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1207             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1208             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1209             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1210             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1211             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1212             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1213             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1214         16  CF-PROCESSOR-CARRIER           PIC X.
  1215             88  NO-CARRIER-SECURITY            VALUE ' '.
  1216         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1217             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1218         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1219             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1220         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1221             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1222
  1223         16  CF-PROC-SYS-ACCESS-SW.
  1224             20  CF-PROC-CREDIT-CLAIMS-SW.
  1225                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1226                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1227                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1228                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1229             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1230                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1231                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  23
* EL201.cbl
  1232             20  CF-PROC-LIFE-GNRLDGR-SW.
  1233                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1234                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1235                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1236                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1237             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1238                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1239                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1240         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1241             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1242             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1243         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1244
  1245         16  CF-APPROVAL-LEVEL                  PIC X.
  1246             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1247             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1248             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1249             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1250             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1251
  1252         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1253
  1254         16  CF-LANGUAGE-TYPE                   PIC X.
  1255             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1256             88  CF-LANG-IS-FR                      VALUE 'F'.
  1257
  1258         16  CF-CSR-IND                         PIC X.
  1259         16  FILLER                             PIC X(239).
  1260
  1261****************************************************************
  1262*             PROCESSOR/REMINDERS RECORD                       *
  1263****************************************************************
  1264
  1265     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1266         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1267             20  CF-START-REMIND-DT         PIC XX.
  1268             20  CF-END-REMIND-DT           PIC XX.
  1269             20  CF-REMINDER-TEXT           PIC X(50).
  1270         16  FILLER                         PIC X(296).
  1271
  1272
  1273****************************************************************
  1274*             STATE MASTER RECORD                              *
  1275****************************************************************
  1276
  1277     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1278         16  CF-STATE-ABBREVIATION          PIC XX.
  1279         16  CF-STATE-NAME                  PIC X(25).
  1280         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1281         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1282             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1283             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1284             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1285             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1286                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1287                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1288             20  CF-ST-PREM-REJECT-SW       PIC X.
  1289                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  24
* EL201.cbl
  1290                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1291             20  CF-ST-REF-REJECT-SW        PIC X.
  1292                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1293                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1294         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1295         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1296         16  CF-ST-REFUND-RULES.
  1297             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1298             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1299             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1300         16  CF-ST-FST-PMT-EXTENSION.
  1301             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1302             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1303                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1304                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1305                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1306                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1307         16  CF-ST-STATE-CALL.
  1308             20  CF-ST-CALL-UNEARNED        PIC X.
  1309             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1310             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1311         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1312             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1313             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1314         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1315         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1316         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1317         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1318         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1319         16  FILLER                         PIC X.
  1320         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1321             20  CF-ST-BENEFIT-CD           PIC XX.
  1322             20  CF-ST-BENEFIT-KIND         PIC X.
  1323                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1324                 88  CF-ST-AH-KIND              VALUE 'A'.
  1325             20  CF-ST-REM-TERM-CALC        PIC X.
  1326                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1327                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1328                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1329                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1330                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1331                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1332                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1333                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1334
  1335             20  CF-ST-REFUND-CALC          PIC X.
  1336                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1337                 88  ST-REFD-BY-R78             VALUE '1'.
  1338                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1339                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1340                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1341                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1342                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1343                 88  ST-REFD-UTAH               VALUE '7'.
  1344                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1345                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1346                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1347
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  25
* EL201.cbl
  1348             20  CF-ST-EARNING-CALC         PIC X.
  1349                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1350                 88  ST-EARN-BY-R78             VALUE '1'.
  1351                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1352                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1353                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1354                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1355                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1356                 88  ST-EARN-MEAN               VALUE '8'.
  1357                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1358
  1359             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1360                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1361                 88  ST-OVRD-BY-R78             VALUE '1'.
  1362                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1363                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1364                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1365                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1366                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1367                 88  ST-OVRD-MEAN               VALUE '8'.
  1368                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1369             20  cf-st-extra-periods        pic 9.
  1370*            20  FILLER                     PIC X.
  1371
  1372         16  CF-ST-COMMISSION-CAPS.
  1373             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1374             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1375             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1376             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1377         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1378                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1379                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1380                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1381
  1382         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1383
  1384         16  CF-ST-STATUTORY-INTEREST.
  1385             20  CF-ST-STAT-DATE-FROM       PIC X.
  1386                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1387                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1388             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1389             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1390             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1391             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1392             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1393
  1394         16  CF-ST-OVER-SHORT.
  1395             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1396             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1397
  1398         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1399
  1400         16  CF-ST-RT-CALC                  PIC X.
  1401
  1402         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1403         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1404         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1405         16  CF-ST-RF-LR-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  26
* EL201.cbl
  1406         16  CF-ST-RF-LL-CALC               PIC X.
  1407         16  CF-ST-RF-LN-CALC               PIC X.
  1408         16  CF-ST-RF-AH-CALC               PIC X.
  1409         16  CF-ST-RF-CP-CALC               PIC X.
  1410*        16  FILLER                         PIC X(206).
  1411*CIDMOD         16  FILLER                         PIC X(192).
  1412         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1413             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1414         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1415         16  CF-ST-VFY-2ND-BENE             PIC X.
  1416         16  CF-ST-CAUSAL-STATE             PIC X.
  1417         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1418         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1419         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1420             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1421         16  CF-ST-NET-ONLY-STATE           PIC X.
  1422             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1423         16  cf-commission-cap-required     pic x.
  1424         16  CF-ST-GA-COMMISSION-CAPS.
  1425             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  1426             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  1427             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  1428             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  1429         16  CF-ST-TOT-COMMISSION-CAPS.
  1430             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  1431             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  1432             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  1433             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  1434         16  FILLER                         PIC X(156).
  1435
  1436****************************************************************
  1437*             BENEFIT MASTER RECORD                            *
  1438****************************************************************
  1439
  1440     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1441         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1442             20  CF-BENEFIT-CODE            PIC XX.
  1443             20  CF-BENEFIT-NUMERIC  REDEFINES
  1444                 CF-BENEFIT-CODE            PIC XX.
  1445             20  CF-BENEFIT-ALPHA           PIC XXX.
  1446             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1447             20  CF-BENEFIT-COMMENT         PIC X(10).
  1448
  1449             20  CF-LF-COVERAGE-TYPE        PIC X.
  1450                 88  CF-REDUCING                VALUE 'R'.
  1451                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1452
  1453             20  CF-SPECIAL-CALC-CD         PIC X.
  1454                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1455                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1456                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1457                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1458                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1459                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1460                 88  CF-FARM-PLAN               VALUE 'F'.
  1461                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1462                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1463                 88  CF-3-MTH-INTEREST          VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  27
* EL201.cbl
  1464                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1465                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1466                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1467                 88  CF-PRUDENTIAL              VALUE 'P'.
  1468                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1469                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1470                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1471                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1472                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1473                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1474
  1475             20  CF-JOINT-INDICATOR         PIC X.
  1476                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1477
  1478*            20  FILLER                     PIC X(12).
  1479             20  cf-maximum-benefits        pic s999 comp-3.
  1480             20  FILLER                     PIC X(09).
  1481             20  CF-BENEFIT-CATEGORY        PIC X.
  1482             20  CF-LOAN-TYPE               PIC X(8).
  1483
  1484             20  CF-CO-REM-TERM-CALC        PIC X.
  1485                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1486                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1487                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1488                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1489                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1490
  1491             20  CF-CO-EARNINGS-CALC        PIC X.
  1492                 88  CO-EARN-BY-R78             VALUE '1'.
  1493                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1494                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1495                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1496                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1497                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1498                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1499                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1500
  1501             20  CF-CO-REFUND-CALC          PIC X.
  1502                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1503                 88  CO-REFD-BY-R78             VALUE '1'.
  1504                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1505                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1506                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1507                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1508                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1509                 88  CO-REFD-MEAN               VALUE '8'.
  1510                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1511                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1512                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1513
  1514             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1515                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1516                 88  CO-OVRD-BY-R78             VALUE '1'.
  1517                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1518                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1519                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1520                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1521                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  28
* EL201.cbl
  1522                 88  CO-OVRD-MEAN               VALUE '8'.
  1523                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1524
  1525             20  CF-CO-BEN-I-G-CD           PIC X.
  1526                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1527                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1528                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1529
  1530         16  FILLER                         PIC X(304).
  1531
  1532
  1533****************************************************************
  1534*             CARRIER MASTER RECORD                            *
  1535****************************************************************
  1536
  1537     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1538         16  CF-ADDRESS-DATA.
  1539             20  CF-MAIL-TO-NAME            PIC X(30).
  1540             20  CF-IN-CARE-OF              PIC X(30).
  1541             20  CF-ADDRESS-LINE-1          PIC X(30).
  1542             20  CF-ADDRESS-LINE-2          PIC X(30).
  1543             20  CF-CITY-STATE              PIC X(30).
  1544             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1545             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1546
  1547         16  CF-CLAIM-NO-CONTROL.
  1548             20  CF-CLAIM-NO-METHOD         PIC X.
  1549                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1550                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1551                 88  CLAIM-NO-SEQ               VALUE '3'.
  1552                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1553             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1554                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1555                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1556                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1557
  1558         16  CF-CHECK-NO-CONTROL.
  1559             20  CF-CHECK-NO-METHOD         PIC X.
  1560                 88  CHECK-NO-MANUAL            VALUE '1'.
  1561                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1562                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1563                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1564             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1565                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1566
  1567         16  CF-DOMICILE-STATE              PIC XX.
  1568
  1569         16  CF-EXPENSE-CONTROLS.
  1570             20  CF-EXPENSE-METHOD          PIC X.
  1571                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1572                 88  DOLLARS-PER-PMT            VALUE '2'.
  1573                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1574                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1575             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1576             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1577
  1578         16  CF-CORRESPONDENCE-CONTROL.
  1579             20  CF-LETTER-RESEND-OPT       PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  29
* EL201.cbl
  1580                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1581                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1582             20  FILLER                     PIC X(4).
  1583
  1584         16  CF-RESERVE-CONTROLS.
  1585             20  CF-MANUAL-SW               PIC X.
  1586                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1587             20  CF-FUTURE-SW               PIC X.
  1588                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1589             20  CF-PTC-SW                  PIC X.
  1590                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1591             20  CF-IBNR-SW                 PIC X.
  1592                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1593             20  CF-PTC-LF-SW               PIC X.
  1594                 88  CF-LF-PTC-USED             VALUE '1'.
  1595             20  CF-CDT-ACCESS-METHOD       PIC X.
  1596                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1597                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1598                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1599             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1600
  1601         16  CF-CLAIM-CALC-METHOD           PIC X.
  1602             88  360-PLUS-MONTHS                VALUE '1'.
  1603             88  365-PLUS-MONTHS                VALUE '2'.
  1604             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1605             88  360-DAILY                      VALUE '4'.
  1606             88  365-DAILY                      VALUE '5'.
  1607
  1608         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1609         16  FILLER                         PIC X(11).
  1610
  1611         16  CF-LIMIT-AMOUNTS.
  1612             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1613             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1614             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1615             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1616             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1617             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1618             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1619             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1620             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1621             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1622
  1623         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1624         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1625         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1626
  1627         16  CF-ZIP-CODE.
  1628             20  CF-ZIP-PRIME.
  1629                 24  CF-ZIP-1ST             PIC X.
  1630                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1631                 24  FILLER                 PIC X(4).
  1632             20  CF-ZIP-PLUS4               PIC X(4).
  1633         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1634             20  CF-CAN-POSTAL-1            PIC XXX.
  1635             20  CF-CAN-POSTAL-2            PIC XXX.
  1636             20  FILLER                     PIC XXX.
  1637
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  30
* EL201.cbl
  1638         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1639         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1640         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1641
  1642         16  CF-RATING-SWITCH               PIC X.
  1643             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1644             88  CF-NO-RATING                   VALUE 'N'.
  1645
  1646         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1647
  1648         16  CF-CARRIER-OVER-SHORT.
  1649             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1650             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1651
  1652         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1653         16  CF-SECPAY-SWITCH               PIC X.
  1654             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1655             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1656         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1657         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1658         16  FILLER                         PIC X(444).
  1659*        16  FILLER                         PIC X(452).
  1660
  1661
  1662****************************************************************
  1663*             MORTALITY MASTER RECORD                          *
  1664****************************************************************
  1665
  1666     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1667         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1668                                INDEXED BY CF-MORT-NDX.
  1669             20  CF-MORT-TABLE              PIC X(5).
  1670             20  CF-MORT-TABLE-TYPE         PIC X.
  1671                 88  CF-MORT-JOINT              VALUE 'J'.
  1672                 88  CF-MORT-SINGLE             VALUE 'S'.
  1673                 88  CF-MORT-COMBINED           VALUE 'C'.
  1674                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1675                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1676             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1677             20  CF-MORT-AGE-METHOD         PIC XX.
  1678                 88  CF-AGE-LAST                VALUE 'AL'.
  1679                 88  CF-AGE-NEAR                VALUE 'AN'.
  1680             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1681             20  CF-MORT-ADJUSTMENT-DIRECTION
  1682                                            PIC X.
  1683                 88  CF-MINUS                   VALUE '-'.
  1684                 88  CF-PLUS                    VALUE '+'.
  1685             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1686             20  CF-MORT-JOINT-CODE         PIC X.
  1687                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1688             20  CF-MORT-PC-Q               PIC X.
  1689                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1690             20  CF-MORT-TABLE-CODE         PIC X(4).
  1691             20  CF-MORT-COMMENTS           PIC X(15).
  1692             20  FILLER                     PIC X(14).
  1693
  1694         16  FILLER                         PIC X(251).
  1695
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  31
* EL201.cbl
  1696
  1697****************************************************************
  1698*             BUSSINESS TYPE MASTER RECORD                     *
  1699****************************************************************
  1700
  1701     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1702* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1703* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1704* AND RECORD 05 IS TYPES 81-99
  1705         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1706             20  CF-BUSINESS-TITLE          PIC  X(19).
  1707             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1708                                            PIC S9V9(4) COMP-3.
  1709             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1710             20  FILLER                     PIC  X.
  1711         16  FILLER                         PIC  X(248).
  1712
  1713
  1714****************************************************************
  1715*             TERMINAL MASTER RECORD                           *
  1716****************************************************************
  1717
  1718     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1719
  1720         16  CF-COMPANY-TERMINALS.
  1721             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1722                                  PIC X(4).
  1723         16  FILLER               PIC X(248).
  1724
  1725
  1726****************************************************************
  1727*             LIFE EDIT MASTER RECORD                          *
  1728****************************************************************
  1729
  1730     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1731         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1732             20  CF-LIFE-CODE-IN            PIC XX.
  1733             20  CF-LIFE-CODE-OUT           PIC XX.
  1734         16  FILLER                         PIC X(248).
  1735
  1736
  1737****************************************************************
  1738*             AH EDIT MASTER RECORD                            *
  1739****************************************************************
  1740
  1741     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1742         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1743             20  CF-AH-CODE-IN              PIC XXX.
  1744             20  CF-AH-CODE-OUT             PIC XX.
  1745         16  FILLER                         PIC X(248).
  1746
  1747
  1748****************************************************************
  1749*             CREDIBILITY TABLES                               *
  1750****************************************************************
  1751
  1752     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1753         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  32
* EL201.cbl
  1754                             INDEXED BY CF-CRDB-NDX.
  1755             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1756             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1757             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1758         16  FILLER                         PIC  X(332).
  1759
  1760
  1761****************************************************************
  1762*             REPORT CUSTOMIZATION RECORD                      *
  1763****************************************************************
  1764
  1765     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1766         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1767             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1768             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1769             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1770**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1771****       A T-TRANSFER.                                   ****
  1772             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1773
  1774         16  FILLER                         PIC XX.
  1775
  1776         16  CF-CARRIER-CNTL-OPT.
  1777             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1778                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1779                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1780             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1781                                            PIC X.
  1782         16  CF-GROUP-CNTL-OPT.
  1783             20  CF-GROUP-OPT-SEQ           PIC 9.
  1784                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1785                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1786             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1787                                            PIC X(6).
  1788         16  CF-STATE-CNTL-OPT.
  1789             20  CF-STATE-OPT-SEQ           PIC 9.
  1790                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1791                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1792             20  CF-STATE-SELECT OCCURS 3 TIMES
  1793                                            PIC XX.
  1794         16  CF-ACCOUNT-CNTL-OPT.
  1795             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1796                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1797                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1798             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1799                                            PIC X(10).
  1800         16  CF-BUS-TYP-CNTL-OPT.
  1801             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1802                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1803                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1804             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1805                                            PIC XX.
  1806         16  CF-LF-TYP-CNTL-OPT.
  1807             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1808                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1809                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1810             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1811                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  33
* EL201.cbl
  1812         16  CF-AH-TYP-CNTL-OPT.
  1813             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1814                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1815                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1816             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1817                                            PIC XX.
  1818         16  CF-REPTCD1-CNTL-OPT.
  1819             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1820                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1821                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1822             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1823                                            PIC X(10).
  1824         16  CF-REPTCD2-CNTL-OPT.
  1825             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1826                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1827                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1828             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1829                                            PIC X(10).
  1830         16  CF-USER1-CNTL-OPT.
  1831             20  CF-USER1-OPT-SEQ           PIC 9.
  1832                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1833                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1834             20  CF-USER1-SELECT OCCURS 3 TIMES
  1835                                            PIC X(10).
  1836         16  CF-USER2-CNTL-OPT.
  1837             20  CF-USER2-OPT-SEQ           PIC 9.
  1838                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1839                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1840             20  CF-USER2-SELECT OCCURS 3 TIMES
  1841                                            PIC X(10).
  1842         16  CF-USER3-CNTL-OPT.
  1843             20  CF-USER3-OPT-SEQ           PIC 9.
  1844                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1845                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1846             20  CF-USER3-SELECT OCCURS 3 TIMES
  1847                                            PIC X(10).
  1848         16  CF-USER4-CNTL-OPT.
  1849             20  CF-USER4-OPT-SEQ           PIC 9.
  1850                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1851                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1852             20  CF-USER4-SELECT OCCURS 3 TIMES
  1853                                            PIC X(10).
  1854         16  CF-USER5-CNTL-OPT.
  1855             20  CF-USER5-OPT-SEQ           PIC 9.
  1856                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1857                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1858             20  CF-USER5-SELECT OCCURS 3 TIMES
  1859                                            PIC X(10).
  1860         16  CF-REINS-CNTL-OPT.
  1861             20  CF-REINS-OPT-SEQ           PIC 9.
  1862                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1863                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1864             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1865                 24  CF-REINS-PRIME         PIC XXX.
  1866                 24  CF-REINS-SUB           PIC XXX.
  1867
  1868         16  CF-AGENT-CNTL-OPT.
  1869             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  34
* EL201.cbl
  1870                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1871                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1872             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1873                                            PIC X(10).
  1874
  1875         16  FILLER                         PIC X(43).
  1876
  1877         16  CF-LOSS-RATIO-SELECT.
  1878             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1879             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1880         16  CF-ENTRY-DATE-SELECT.
  1881             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1882             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1883         16  CF-EFFECTIVE-DATE-SELECT.
  1884             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1885             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1886
  1887         16  CF-EXCEPTION-LIST-IND          PIC X.
  1888             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1889
  1890         16  FILLER                         PIC X(318).
  1891
  1892****************************************************************
  1893*                  EXCEPTION REPORTING RECORD                  *
  1894****************************************************************
  1895
  1896     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1897         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1898             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1899
  1900         16  CF-COMBINED-LIFE-AH-OPT.
  1901             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1902             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1903             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1904             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1905
  1906         16  CF-LIFE-OPT.
  1907             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1908             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1909             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1910             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1911             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1912             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1913             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1914             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1915             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1916             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1917
  1918         16  CF-AH-OPT.
  1919             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1920             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1921             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1922             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1923             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1924             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1925             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1926             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1927             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  35
* EL201.cbl
  1928             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1929
  1930         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1931             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1932             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1933             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1934
  1935         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1936
  1937         16  FILLER                         PIC X(673).
  1938
  1939
  1940****************************************************************
  1941*             MORTGAGE SYSTEM PLAN RECORD                      *
  1942****************************************************************
  1943
  1944     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1945         16  CF-PLAN-TYPE                   PIC X.
  1946             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1947             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1948             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1949         16  CF-PLAN-ABBREV                 PIC XXX.
  1950         16  CF-PLAN-DESCRIPT               PIC X(10).
  1951         16  CF-PLAN-NOTES                  PIC X(20).
  1952         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1953         16  CF-PLAN-UNDERWRITING.
  1954             20  CF-PLAN-TERM-DATA.
  1955                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1956                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1957             20  CF-PLAN-AGE-DATA.
  1958                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1959                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1960                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1961             20  CF-PLAN-BENEFIT-DATA.
  1962                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1963                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1964                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1965                                            PIC S9(7)V99  COMP-3.
  1966         16  CF-PLAN-POLICY-FORMS.
  1967             20  CF-POLICY-FORM             PIC X(12).
  1968             20  CF-MASTER-APPLICATION      PIC X(12).
  1969             20  CF-MASTER-POLICY           PIC X(12).
  1970         16  CF-PLAN-RATING.
  1971             20  CF-RATE-CODE               PIC X(5).
  1972             20  CF-SEX-RATING              PIC X.
  1973                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1974                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1975             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1976             20  CF-SUB-STD-TYPE            PIC X.
  1977                 88  CF-PCT-OF-PREM            VALUE '1'.
  1978                 88  CF-PCT-OF-BENE            VALUE '2'.
  1979         16  CF-PLAN-PREM-TOLERANCES.
  1980             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1981             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1982         16  CF-PLAN-PYMT-TOLERANCES.
  1983             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1984             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1985         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  36
* EL201.cbl
  1986             20  FILLER                     PIC X.
  1987             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1988             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1989         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1990         16  CF-PLAN-IND-GRP                PIC X.
  1991             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1992                                                     '1'.
  1993             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1994                                                     '2'.
  1995         16  CF-MIB-SEARCH-SW               PIC X.
  1996             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1997             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1998             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1999             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2000         16  CF-ALPHA-SEARCH-SW             PIC X.
  2001             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2002             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2003             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2004             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2005             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2006             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2007             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2008             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2009             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2010             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2011                                                     'A' 'B' 'C'
  2012                                                     'X' 'Y' 'Z'.
  2013         16  CF-EFF-DT-RULE-SW              PIC X.
  2014             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2015             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2016             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2017             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2018             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2019         16  FILLER                         PIC X(4).
  2020         16  CF-HEALTH-QUESTIONS            PIC X.
  2021             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2022         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2023         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2024         16  CF-PLAN-SNGL-JNT               PIC X.
  2025             88  CF-COMBINED-PLAN              VALUE 'C'.
  2026             88  CF-JNT-PLAN                   VALUE 'J'.
  2027             88  CF-SNGL-PLAN                  VALUE 'S'.
  2028         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2029         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2030         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2031         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2032         16  CF-RERATE-CNTL                 PIC  X.
  2033             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2034             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2035             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2036             88  CF-AUTO-RECALC                 VALUE '4'.
  2037         16  CF-BENEFIT-TYPE                PIC  X.
  2038             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2039             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2040         16  CF-POLICY-FEE                  PIC S999V99
  2041                                                    COMP-3.
  2042         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2043         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  37
* EL201.cbl
  2044         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2045         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2046         16  FILLER                         PIC  X(32).
  2047         16  CF-TERMINATION-FORM            PIC  X(04).
  2048         16  FILLER                         PIC  X(08).
  2049         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2050                                                       COMP-3.
  2051         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2052         16  CF-ISSUE-LETTER                PIC  X(4).
  2053         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2054         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2055             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2056             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2057         16  CF-MP-REFUND-CALC              PIC X.
  2058             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2059             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2060             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2061             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2062             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2063             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2064             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2065             88  CF-MP-REFD-MEAN                VALUE '8'.
  2066         16  CF-ALT-RATE-CODE               PIC  X(5).
  2067
  2068
  2069         16  FILLER                         PIC X(498).
  2070****************************************************************
  2071*             MORTGAGE COMPANY MASTER RECORD                   *
  2072****************************************************************
  2073
  2074     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2075         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2076         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2077             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2078             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2079             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2080             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2081             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2082
  2083         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2084         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2085         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2086         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2087         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2088
  2089         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2090             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2091         16  CF-MP-RECON-USE-IND            PIC X(1).
  2092             88  CF-MP-USE-RECON             VALUE 'Y'.
  2093         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2094             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2095         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2096             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2097             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2098         16  FILLER                         PIC X(1).
  2099         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2100             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2101         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  38
* EL201.cbl
  2102             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2103             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2104             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2105         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2106             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2107                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2108             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2109                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2110             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2111                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2112             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2113                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2114             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2115                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2116             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2117                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2118         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2119         16  FILLER                         PIC X(7).
  2120         16  CF-MORTG-DESTINATION-SYMBOL.
  2121             20  CF-MORTG-MIB-COMM          PIC X(5).
  2122             20  CF-MORTG-MIB-TERM          PIC X(5).
  2123         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2124             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2125         16  FILLER                         PIC X(03).
  2126         16  CF-MP-CHECK-NO-CONTROL.
  2127             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2128                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2129                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2130                                                ' ' LOW-VALUES.
  2131                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2132                                               VALUE '3'.
  2133         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2134         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2135         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2136             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2137                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2138             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2139                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2140             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2141                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2142             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2143                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2144             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2145                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2146             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2147                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2148         16  CF-MORTG-BILLING-AREA.
  2149             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2150                                            PIC X.
  2151         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2152         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2153         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2154         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2155             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2156             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2157         16  FILLER                         PIC X.
  2158         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2159             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  39
* EL201.cbl
  2160             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2161         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2162         16  FILLER                         PIC X(8).
  2163         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2164         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2165         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2166         16  CF-ACH-COMPANY-ID.
  2167             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2168                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2169                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2170                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2171             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2172         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2173             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2174         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2175             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2176             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2177         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2178         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2179         16  FILLER                         PIC X(536).
  2180
  2181****************************************************************
  2182*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2183****************************************************************
  2184
  2185     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2186         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2187             20  CF-FEMALE-HEIGHT.
  2188                 24  CF-FEMALE-FT           PIC 99.
  2189                 24  CF-FEMALE-IN           PIC 99.
  2190             20  CF-FEMALE-MIN-WT           PIC 999.
  2191             20  CF-FEMALE-MAX-WT           PIC 999.
  2192         16  FILLER                         PIC X(428).
  2193
  2194     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2195         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2196             20  CF-MALE-HEIGHT.
  2197                 24  CF-MALE-FT             PIC 99.
  2198                 24  CF-MALE-IN             PIC 99.
  2199             20  CF-MALE-MIN-WT             PIC 999.
  2200             20  CF-MALE-MAX-WT             PIC 999.
  2201         16  FILLER                         PIC X(428).
  2202******************************************************************
  2203*             AUTOMATIC ACTIVITY RECORD                          *
  2204******************************************************************
  2205     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2206         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2207             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2208             20  CF-SYS-LETTER-ID           PIC X(04).
  2209             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2210             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2211             20  CF-SYS-RESET-SW            PIC X(01).
  2212             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2213             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2214
  2215         16  FILLER                         PIC X(50).
  2216
  2217         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  40
* EL201.cbl
  2218             20  CF-USER-ACTIVE-SW          PIC X(01).
  2219             20  CF-USER-LETTER-ID          PIC X(04).
  2220             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2221             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2222             20  CF-USER-RESET-SW           PIC X(01).
  2223             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2224             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2225             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2226
  2227         16  FILLER                         PIC X(246).
  2228 01  ws-heading1.
  2229     05  ws-head1                pic x(120)  value '
  2230-     '                                   DAILY CHECK RECONCILIATI
  2231-     'ON                                            '.
  2232     05  ws-h1-rpt-id            pic x(6)  value 'EL201A'.
  2233 01  ws-heading2.
  2234     05  filler                  pic x(51) value spaces.
  2235     05  WS-H2-CLIENT-NAME       PIC X(59) VALUE SPACES.
  2236     05  WS-H2-DATE              PIC X(10).
  2237     05  ws-h2-time              pic x(8).
  2238 01  ws-heading3.
  2239     05  filler                  pic x(53) value spaces.
  2240     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2241     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2242     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2243 01  ws-heading4.
  2244     05  filler                  pic x(117)   value ' CAR  GROUP
  2245-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2246-        '  CHECK CASHED DT   PREPARER   AMOUNT    MESSAGE'.
  2247 01  ws-hd1-written.
  2248     05  filler                  pic x(120)  value '
  2249-     '                                   DAILY WRITTEN CHECKS REP
  2250-     'ORT                                           '.
  2251 01  ws-hd4-written.
  2252     05  filler                  pic x(117)   value ' CAR  GROUP
  2253-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2254-        '  CHECK WRITTEN DT  PREPARER   AMOUNT    MESSAGE'.
  2255 01  ws-detail1.
  2256     05  filler                  pic xx value '  '.
  2257     05  ws-d1-carr              pic x(4) value spaces.
  2258     05  ws-d1-grp               pic x(7) value spaces.
  2259     05  ws-d1-state             pic x(4) value spaces.
  2260     05  ws-d1-account           pic x(12) value spaces.
  2261     05  ws-d1-eff-dt            pic x(12) value spaces.
  2262     05  ws-d1-cert-no           pic x(14) value spaces.
  2263     05  ws-d1-chk-type          pic x(5) value spaces.
  2264     05  ws-d1-chk-no            pic x(12) value spaces.
  2265     05  f                       pic xx value spaces.
  2266     05  ws-d1-writ-cash-dt      pic x(16) value spaces.
  2267     05  ws-d1-preparer          pic x(8) value spaces.
  2268     05  ws-d1-chk-amt-a         pic x(10) value spaces.
  2269     05  ws-d1-chk-amt redefines
  2270         ws-d1-chk-amt-a         pic $$$,$$9.99.
  2271     05  filler                  pic xx value spaces.
  2272     05  ws-d1-message           pic x(20) value spaces.
  2273 01  ws-detail2.
  2274     05  filler                  pic x(12) value '    PAYEE - '.
  2275     05  ws-d2-addr-line         pic x(120) value spaces.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  41
* EL201.cbl
  2276 01  ws-total1.
  2277     05  filler                  pic x(5) value '     '.
  2278     05  ws-t1-cnt               pic zzzz9  value zeros.
  2279     05  ws-t1-chks              pic x(24)  value spaces.
  2280     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2281 01  w-doctoken                  pic x(16).
  2282 01 output-data.
  2283    05  filler                   pic x(6) value "TITLE=".
  2284    05  output-title             pic x(26) value 'Check Posting'.
  2285    05  filler                   pic x(8) value "&COMPID=".
  2286    05  out-comp-id              pic xxx.
  2287    05  filler                   pic x(5) value "&MSG=".
  2288    05  output-msg               pic x(50).
  2289 01  tran-data-line1             pic x(80) value spaces.
  2290 01  tran-data-line2             pic x(80) value spaces.
  2291* 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
  2292**    'cd /apps/prod/cid1p/jcl'.
  2293*      'cd /apps/test/ahltst/jcl'.
  2294* 01  TRAN-DATA-LINE2.
  2295*     05  filler                  pic x(10) value 'unikixjob '.
  2296*     05  tdl2-job                pic x(8) value 'cilg201b'.
  2297**    05  filler                  pic x(9) value ' -k cid1p'.
  2298*     05  filler                  pic x(10) value ' -k ahltst'.
  2299*     05  filler                  pic x(50) value spaces.
  2300****************************************************************
  2301*
  2302* Copyright (c) 2007-2013 Dell Inc.
  2303* All rights reserved.
  2304*
  2305****************************************************************
  2306 01  DFHEIV.
  2307   02  DFHEIV0               PIC X(35).
  2308   02  DFHEIV1               PIC X(08).
  2309   02  DFHEIV2               PIC X(08).
  2310   02  DFHEIV3               PIC X(08).
  2311   02  DFHEIV4               PIC X(06).
  2312   02  DFHEIV5               PIC X(04).
  2313   02  DFHEIV6               PIC X(04).
  2314   02  DFHEIV7               PIC X(02).
  2315   02  DFHEIV8               PIC X(02).
  2316   02  DFHEIV9               PIC X(01).
  2317   02  DFHEIV10              PIC S9(7) COMP-3.
  2318   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2319   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2320   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2321   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2322   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2323   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2324   02  DFHEIV17              PIC X(04).
  2325   02  DFHEIV18              PIC X(04).
  2326   02  DFHEIV19              PIC X(04).
  2327   02  DFHEIV20              USAGE IS POINTER.
  2328   02  DFHEIV21              USAGE IS POINTER.
  2329   02  DFHEIV22              USAGE IS POINTER.
  2330   02  DFHEIV23              USAGE IS POINTER.
  2331   02  DFHEIV24              USAGE IS POINTER.
  2332   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2333   02  DFHEIV26              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  42
* EL201.cbl
  2334   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2335   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2336   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2337   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2338   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2339   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2340   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2341   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2342   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2343   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2344   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2345   02  FILLER                PIC X(02).
  2346   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2347   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2348   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2349   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2350   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2351   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2352   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2353 LINKAGE  SECTION.
  2354*****************************************************************
  2355*                                                               *
  2356* Copyright (c) 2007-2013 Dell Inc.                             *
  2357* All rights reserved.                                          *
  2358*                                                               *
  2359*****************************************************************
  2360 01  dfheiblk.
  2361     02  eibtime          pic s9(7) comp-3.
  2362     02  eibdate          pic s9(7) comp-3.
  2363     02  eibtrnid         pic x(4).
  2364     02  eibtaskn         pic s9(7) comp-3.
  2365     02  eibtrmid         pic x(4).
  2366     02  dfheigdi         pic s9(4) comp.
  2367     02  eibcposn         pic s9(4) comp.
  2368     02  eibcalen         pic s9(4) comp.
  2369     02  eibaid           pic x(1).
  2370     02  eibfiller1       pic x(1).
  2371     02  eibfn            pic x(2).
  2372     02  eibfiller2       pic x(2).
  2373     02  eibrcode         pic x(6).
  2374     02  eibfiller3       pic x(2).
  2375     02  eibds            pic x(8).
  2376     02  eibreqid         pic x(8).
  2377     02  eibrsrce         pic x(8).
  2378     02  eibsync          pic x(1).
  2379     02  eibfree          pic x(1).
  2380     02  eibrecv          pic x(1).
  2381     02  eibsend          pic x(1).
  2382     02  eibatt           pic x(1).
  2383     02  eibeoc           pic x(1).
  2384     02  eibfmh           pic x(1).
  2385     02  eibcompl         pic x(1).
  2386     02  eibsig           pic x(1).
  2387     02  eibconf          pic x(1).
  2388     02  eiberr           pic x(1).
  2389     02  eibrldbk         pic x(1).
  2390     02  eiberrcd         pic x(4).
  2391     02  eibsynrb         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  43
* EL201.cbl
  2392     02  eibnodat         pic x(1).
  2393     02  eibfiller5       pic x(2).
  2394     02  eibresp          pic s9(8) comp.
  2395     02  eibresp2         pic s9(8) comp.
  2396     02  dfheigdj         pic s9(4) comp.
  2397     02  dfheigdk         pic s9(4) comp.
  2398 01  DFHCOMMAREA       PIC X(01).
  2399 01  VAR                         PIC X(30).
  2400 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  2401 0000-DFHEXIT SECTION.
  2402     MOVE '9#                    $   ' TO DFHEIV0.
  2403     MOVE 'EL201' TO DFHEIV1.
  2404     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2405***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2406***                                                            ***
  2407***  Even though this program is using WEB Servies we don't    ***
  2408***  have any form fields to browse through, we are getting    ***
  2409***  the information we need through the variables that are    ***
  2410***  included in the URL. These variables are retrieved by     ***
  2411***  the           exec cics web extract                       ***
  2412***                   querystring  (data-value)                ***
  2413***                   querystrlen  (data-value)                ***
  2414***                end-exec                                    ***
  2415***  BTW, you must provide the length it isn't passed to you.  ***
  2416***  Allow for extra on the length or you will get a length    ***
  2417***  error instead of just truncation.                         ***
  2418***                                                            ***
  2419***  This program is expecting                                 ***
  2420*** http://slunikix:7001/cics/cwba/EL201?comp=CID&file=written***
  2421*** http://slunikix:7003/cics/cwba/EL201?comp=CID&file=written***
  2422*** http://logictest:6007/cics/cwba/EL201?comp=CID&file=written***
  2423***                                                            ***
  2424***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2425     display ' Entering program EL201 '
  2426     set P to address of KIXSYS
  2427     CALL "getenv" using by value P returning var-ptr
  2428     if var-ptr = null then
  2429        display ' kixsys not set '
  2430     else
  2431        set address of var to var-ptr
  2432        move 0 to env-var-len
  2433        inspect var tallying env-var-len
  2434          for characters before X'00'
  2435        unstring var (1:env-var-len) delimited by '/'
  2436           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2437              WS-KIX-SYS
  2438        end-unstring
  2439     end-if
  2440     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2441     move ws-fn-cymd             to dc-greg-date-cymd
  2442     move 'L'                    to dc-option-code
  2443     perform 9700-date-convert   thru 9700-exit
  2444     if no-conversion-error
  2445        move dc-greg-date-1-alpha to ws-h3-date
  2446        move dc-greg-date-1-edit to ws-h2-date
  2447     else
  2448        display ' error current dt invalid ' dc-error-code
  2449     end-if
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  44
* EL201.cbl
  2450     string ws-fn-hours   ':'
  2451            ws-fn-minutes ':'
  2452            ws-fn-seconds
  2453        delimited by size into ws-h2-time
  2454     end-string
  2455
  2456* exec cics web extract
  2457*       querystring  (ws-qry-string)
  2458*       querystrlen  (ws-qrystr-len)
  2459*    end-exec
  2460*    MOVE 'X0  QL                .   #00002358' TO DFHEIV0
  2461     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2462     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2463     MOVE X'2020233030303032333538' TO DFHEIV0(25:11)
  2464     CALL 'kxdfhei1' USING DFHEIV0,
  2465           DFHEIV99,
  2466           DFHEIV99,
  2467           ws-qry-string,
  2468           ws-qrystr-len,
  2469           DFHEIV99,
  2470           DFHEIV99,
  2471           DFHEIV99,
  2472           DFHEIV99,
  2473           DFHEIV99,
  2474           DFHEIV99,
  2475           DFHEIV99,
  2476           DFHEIV99,
  2477           DFHEIV99
  2478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2479     move ws-qry-string (6:3)    to ws-comp-id
  2480                                    out-comp-id
  2481     move 'Successful Run   '    to output-msg
  2482     move ws-comp-id             to elcntl-key
  2483     move '1'                    to elcntl-rec-type
  2484     move +0                     to elcntl-seq
  2485
  2486* exec cics read
  2487*       dataset  ('ELCNTL')
  2488*       into     (control-file)
  2489*       ridfld   (elcntl-key)
  2490*       resp     (ws-response)
  2491*    end-exec
  2492     MOVE LENGTH OF
  2493      control-file
  2494       TO DFHEIV11
  2495     MOVE 'ELCNTL' TO DFHEIV1
  2496*    MOVE '&"IL       E          (  N#00002368' TO DFHEIV0
  2497     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2498     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2499     MOVE X'204E233030303032333638' TO DFHEIV0(25:11)
  2500     CALL 'kxdfhei1' USING DFHEIV0,
  2501           DFHEIV1,
  2502           control-file,
  2503           DFHEIV11,
  2504           elcntl-key,
  2505           DFHEIV99,
  2506           DFHEIV99,
  2507           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  45
* EL201.cbl
  2508     MOVE EIBRESP  TO ws-response
  2509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2510     if resp-normal
  2511        move cf-cl-mail-to-name  to ws-h2-client-name
  2512        move cf-company-cd       to ws-comp-cd
  2513     else
  2514        move 'Company Rec not found ' to ws-h2-client-name
  2515                                         output-msg
  2516        display ' error elcntl read ' ws-response ' '
  2517           elcntl-key (1:8)
  2518        go to 0000-return
  2519     end-if
  2520     evaluate true
  2521        when ws-qry-string (15:7) = 'written' or 'WRITTEN'
  2522           set process-written      to true
  2523           perform 2000-process-written
  2524                                 thru 2000-exit
  2525        when other
  2526           move 'Invalid File ' to output-msg
  2527     end-evaluate
  2528     if connected-to-db
  2529        EXEC SQL
  2530            commit work release
  2531        END-EXEC
  2532        if sqlcode not = 0
  2533           move ' Failed to Commit DB '
  2534                                 to output-msg
  2535           display "Error: commit release "
  2536           display ' sql return code ' sqlcode
  2537           display ' sql err mess    ' sqlerrmc
  2538        end-if
  2539     end-if
  2540     .
  2541 0000-return.
  2542     perform 1030-send-form      thru 1030-exit
  2543
  2544* exec cics
  2545*       return
  2546*    end-exec
  2547*    MOVE '.(                    ''   #00002407' TO DFHEIV0
  2548     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2549     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2550     MOVE X'2020233030303032343037' TO DFHEIV0(25:11)
  2551     CALL 'kxdfhei1' USING DFHEIV0,
  2552           DFHEIV99,
  2553           DFHEIV99,
  2554           DFHEIV99,
  2555           DFHEIV99,
  2556           DFHEIV99,
  2557           DFHEIV99
  2558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2559     .
  2560 1000-CONNECT-DB.
  2561     string
  2562         usr delimited space
  2563         "." delimited size
  2564         pass delimited space into usr-pass
  2565     end-string
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  46
* EL201.cbl
  2566     EXEC SQL
  2567        CONNECT TO :svr USER :usr-pass
  2568     END-EXEC
  2569     if sqlcode not = 0
  2570        display "Error: cannot connect "
  2571        display sqlcode
  2572        display sqlerrmc
  2573        move 'Failed to connect to DB'
  2574                                 to output-msg
  2575        go to 0000-return
  2576     else
  2577        set connected-to-db to true
  2578     end-if
  2579     .
  2580 1000-EXIT.
  2581     EXIT.
  2582 1020-read-erchek.
  2583     move ws-comp-cd             to ch-company-cd
  2584     move db-carrier             to ch-carrier
  2585     move db-grouping            to ch-grouping
  2586     move db-state               to ch-state
  2587     move db-account             to ch-account
  2588     move db-certificate         to ch-cert-prime
  2589     move db-cert-sfx            to ch-cert-sfx
  2590     string db-effdate (1:4)
  2591            db-effdate (6:2)
  2592            db-effdate (9:2)
  2593        delimited by size into dc-greg-date-cymd-r
  2594     end-string
  2595     move 'L'                    to dc-option-code
  2596     perform 9700-date-convert   thru 9700-exit
  2597     if no-conversion-error
  2598        move dc-bin-date-1       to ch-cert-eff-dt
  2599     else
  2600        display ' error cvtdte eff dt ' db-effdate ' '
  2601           dc-error-code
  2602     end-if
  2603     move zeros                  to ws-seq-alpha
  2604     move +5                     to s2
  2605     perform varying s1 from +5 by -1 until s1 < +1
  2606        if db-seq-no (s1:1) numeric
  2607           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2608           subtract +1 from s2
  2609        end-if
  2610     end-perform
  2611     move ws-seq-no-num          to ch-sequence-no
  2612*    display ' dte   **' db-effdate '**'
  2613*    display ' carrier ' ch-carrier
  2614*    display ' group   ' ch-grouping
  2615*    display ' state   ' ch-state
  2616*    display ' acct    ' ch-account
  2617*    display ' cert  **' ch-cert-no '**'
  2618*    display ' seq     ' ch-sequence-no
  2619
  2620* exec cics read
  2621*       update
  2622*       dataset    ('ERCHEK')
  2623*       into       (check-records)
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  47
* EL201.cbl
  2624*       ridfld     (ch-control-primary)
  2625*       resp       (ws-response)
  2626*    end-exec
  2627     MOVE LENGTH OF
  2628      check-records
  2629       TO DFHEIV11
  2630     MOVE 'ERCHEK' TO DFHEIV1
  2631*    MOVE '&"IL       EU         (  N#00002470' TO DFHEIV0
  2632     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2633     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2634     MOVE X'204E233030303032343730' TO DFHEIV0(25:11)
  2635     CALL 'kxdfhei1' USING DFHEIV0,
  2636           DFHEIV1,
  2637           check-records,
  2638           DFHEIV11,
  2639           ch-control-primary,
  2640           DFHEIV99,
  2641           DFHEIV99,
  2642           DFHEIV99
  2643     MOVE EIBRESP  TO ws-response
  2644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2645     .
  2646 1020-exit.
  2647     exit.
  2648 1030-send-form.
  2649
  2650* exec cics document create
  2651*       doctoken   (w-doctoken)
  2652*       template   ('WCHECKS')
  2653*       symbollist (output-data)
  2654*       listlength (length of output-data)
  2655*    end-exec
  2656     MOVE 'WCHECKS' TO DFHEIV1
  2657     MOVE LENGTH OF
  2658      output-data TO DFHEIV16
  2659*    MOVE '\"D tSL               )   #00002481' TO DFHEIV0
  2660     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  2661     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2662     MOVE X'2020233030303032343831' TO DFHEIV0(25:11)
  2663     CALL 'kxdfhei1' USING DFHEIV0,
  2664           w-doctoken,
  2665           DFHEIV99,
  2666           DFHEIV1,
  2667           output-data,
  2668           DFHEIV16,
  2669           DFHEIV99,
  2670           DFHEIV99,
  2671           DFHEIV99
  2672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2673
  2674* exec cics web send
  2675*       doctoken(w-doctoken)
  2676*    end-exec
  2677*    MOVE 'X$D                   *   #00002487' TO DFHEIV0
  2678     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2679     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2680     MOVE X'2020233030303032343837' TO DFHEIV0(25:11)
  2681     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  48
* EL201.cbl
  2682           w-doctoken,
  2683           DFHEIV99,
  2684           DFHEIV99,
  2685           DFHEIV99,
  2686           DFHEIV99,
  2687           DFHEIV99,
  2688           DFHEIV99,
  2689           DFHEIV99,
  2690           DFHEIV99
  2691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2692     .
  2693 1030-exit.
  2694     exit.
  2695 1050-disconnect.
  2696     if connected-to-db
  2697        EXEC SQL
  2698            disconnect all
  2699        END-EXEC
  2700        move ' ' to ws-connect-sw
  2701     end-if
  2702     .
  2703 1050-exit.
  2704     exit.
  2705 2000-process-written.
  2706     perform 2010-open-files     thru 2010-exit
  2707     perform 2020-init           thru 2020-exit
  2708     perform 2050-process-input  thru 2050-exit until
  2709        end-of-input
  2710     if ws-writ-cnt > zeros
  2711        move ws-writ-cnt         to ws-t1-cnt
  2712        move ' Written '         to ws-t1-chks
  2713        move ws-tot-writ-amt     to ws-t1-amount
  2714     else
  2715        perform 4010-write-headings
  2716                                 thru 4010-exit
  2717        move spaces              to ws-total1
  2718        string ' No checks for '
  2719           ws-work-comp-id
  2720           ' today. ' delimited by size into ws-total1
  2721        end-string
  2722     end-if
  2723     move spaces                 to cps-written-rpt-rec
  2724     perform 4020-write-a-line   thru 4020-exit
  2725     move ws-total1              to cps-written-rpt-rec
  2726     perform 4020-write-a-line   thru 4020-exit
  2727     perform 2500-close-files    thru 2500-exit
  2728     perform 5000-submit-job     thru 5000-exit
  2729     .
  2730 2000-exit.
  2731     exit.
  2732 2010-open-files.
  2733     if ws-kix-myenv = 'cid1p'
  2734        move 'SDVDB01_ChkApprv'  to svr
  2735        move 'appuser'           to usr
  2736        move 'appuser@cso'       to pass
  2737        move '/data/seqfiles/'   to ws-work-dir
  2738        move 'cd /apps/prod/cid1p/jcl'
  2739                                 to tran-data-line1
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  49
* EL201.cbl
  2740        move ws-kix-myenv        to ws-work-env
  2741     else
  2742        move 'HOVTSTDB01_ChkApprv' to svr
  2743        move 'appuser'           to usr
  2744        move 'appuser@cso'       to pass
  2745        move ws-kix-myenv        to ws-work-env
  2746        string
  2747           '/data/test/' delimited by size
  2748           ws-work-env   delimited by space
  2749           '/seqfiles/'  delimited by size
  2750              into ws-work-dir
  2751        end-string
  2752        string
  2753           'cd /apps/test/' delimited by size
  2754           ws-work-env      delimited by space
  2755           '/jcl'           delimited by size
  2756              into tran-data-line1
  2757        end-string
  2758     end-if
  2759     move function upper-case(ws-comp-id)
  2760                                 to ws-work-comp-id
  2761     move 'miscpymts.csv'        to ws-work-file-in
  2762     move 'cilg201b'             to ws-work-job-name
  2763     if ws-work-comp-id = 'AHL'
  2764        move 'miscpymtsahl.csv'  to ws-work-file-in
  2765        move 'ahlg201b'          to ws-work-job-name
  2766     end-if
  2767     move spaces                 to ws-written-in
  2768                                    ws-written-rpt
  2769     string
  2770        ws-work-dir delimited by space
  2771        ws-work-file-in delimited by space
  2772           into ws-written-in
  2773     end-string
  2774     move 'miscpymts.rpt'        to ws-work-rpt-out
  2775     string
  2776        ws-work-dir delimited by space
  2777        ws-work-comp-id delimited by size
  2778        ws-work-rpt-out delimited by size
  2779           into ws-written-rpt
  2780     end-string
  2781     string
  2782        'unikixjob '     delimited by size
  2783        ws-work-job-name delimited by size
  2784        ' -k '           delimited by size
  2785        ws-work-env      delimited by space
  2786           into tran-data-line2
  2787     end-string
  2788*     display ' svr    ' svr
  2789*     display ' user   ' usr
  2790*     display ' pw     ' pass
  2791*     display ' input  ' ws-written-in
  2792*     display ' output ' ws-written-rpt
  2793*     display ' line 1 ' tran-data-line1
  2794*     display ' line 2 ' tran-data-line2
  2795     open input CPS-WRITTEN-IN
  2796         output CPS-WRITTEN-RPT
  2797     if written-status not = '00'
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  50
* EL201.cbl
  2798        display 'error written open ' written-status
  2799        move ' Invalid or missing file '
  2800                                 to output-msg
  2801        go to 0000-return
  2802     end-if
  2803     .
  2804 2010-exit.
  2805     exit.
  2806 2020-init.
  2807     move spaces                 to ws-detail1
  2808     move ws-hd1-written         to ws-head1
  2809     move 'EL201B'               to ws-h1-rpt-id
  2810     move ws-hd4-written         to ws-heading4
  2811     move 'Posting of Written Checks '
  2812                                 to output-title
  2813*    if ws-comp-id = 'AHL'
  2814*       move 'ahlg201b'          to tdl2-job
  2815*    else
  2816*       move 'cilg201b'          to tdl2-job
  2817*    end-if
  2818     if not connected-to-db
  2819        perform 1000-connect-db  thru 1000-exit
  2820     end-if
  2821***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2822***                                                            ***
  2823**     I do 2 reads to bypass the header record                ***
  2824***                                                            ***
  2825***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2826     perform 2040-read-input     thru 2040-exit
  2827     perform 2040-read-input     thru 2040-exit
  2828     .
  2829 2020-exit.
  2830     exit.
  2831 2040-read-input.
  2832     read CPS-WRITTEN-IN at end
  2833        set end-of-input   to true
  2834     end-read
  2835     if not end-of-input
  2836        add 1 to ws-in-recs
  2837     end-if
  2838     .
  2839 2040-exit.
  2840     exit.
  2841 2050-process-input.
  2842     move spaces                 to ws-raw-record
  2843                                    ws-written-rec
  2844     unstring cps-written-in-rec
  2845        delimited by ',' into
  2846           raw-check-no
  2847           raw-check-dt
  2848           raw-check-amt
  2849           raw-vendor-id
  2850           raw-user-defined
  2851           raw-voucher-ref
  2852     end-unstring
  2853*    display ' chk no    **' wsw-check-no '**'
  2854*    display ' chk dt    **' wsw-check-dt '**'
  2855*    display ' chk amt   **' wsw-check-amt '**'
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  51
* EL201.cbl
  2856*    display ' vend id   **' wsw-vendor-id '**'
  2857*    display ' user def  **' wsw-user-defined '**'
  2858*    display ' vouch ref **' wsw-voucher-ref '**'
  2859***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2860***                                                            ***
  2861***    Every now and then I get bogus records with quotes      ***
  2862***  so I am just going to remove them.  These are normally    ***
  2863***  a result of a manual process that should not be included  ***
  2864***  in this file.                                             ***
  2865***                                                            ***
  2866***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2867
  2868     move +1                     to o1
  2869     perform varying i1 from +1 by +1 until i1 > +20
  2870        if raw-check-no (i1:1) <> '"'
  2871           move raw-check-no (i1:1)
  2872                                 to wsw-check-no (o1:1)
  2873           add +1 to o1
  2874        end-if
  2875     end-perform
  2876
  2877     move +1                     to o1
  2878     perform varying i1 from +1 by +1 until i1 > +20
  2879        if raw-check-dt (i1:1) <> '"'
  2880           move raw-check-dt (i1:1)
  2881                                 to wsw-check-dt (o1:1)
  2882           add +1 to o1
  2883        end-if
  2884     end-perform
  2885
  2886     move +1                     to o1
  2887     perform varying i1 from +1 by +1 until i1 > +15
  2888        if raw-check-amt (i1:1) <> '"'
  2889           move raw-check-amt (i1:1)
  2890                                 to wsw-check-amt (o1:1)
  2891           add +1 to o1
  2892        end-if
  2893     end-perform
  2894
  2895     move +1                     to o1
  2896     perform varying i1 from +1 by +1 until i1 > +20
  2897        if raw-vendor-id (i1:1) <> '"'
  2898           move raw-vendor-id (i1:1)
  2899                                 to wsw-vendor-id (o1:1)
  2900           add +1 to o1
  2901        end-if
  2902     end-perform
  2903
  2904     move +1                     to o1
  2905     perform varying i1 from +1 by +1 until i1 > +30
  2906        if raw-user-defined (i1:1) <> '"'
  2907           move raw-user-defined (i1:1)
  2908                                 to wsw-user-defined (o1:1)
  2909           add +1 to o1
  2910        end-if
  2911     end-perform
  2912
  2913     move +1                     to o1
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  52
* EL201.cbl
  2914     perform varying i1 from +1 by +1 until i1 > +35
  2915        if raw-voucher-ref (i1:1) <> '"'
  2916           move raw-voucher-ref (i1:1)
  2917                                 to wsw-voucher-ref (o1:1)
  2918           add +1 to o1
  2919        end-if
  2920     end-perform
  2921     if (wsw-check-no = spaces)
  2922        and (wsw-check-dt = spaces)
  2923        and (wsw-check-amt = spaces)
  2924        display ' empty record ' cps-written-in-rec
  2925        go to 2050-read
  2926     end-if
  2927     string wsw-check-dt (1:4)
  2928            wsw-check-dt (6:2)
  2929            wsw-check-dt (9:2)
  2930        delimited by size into dc-greg-date-cymd-r
  2931     end-string
  2932     move 'L'                    to dc-option-code
  2933     perform 9700-date-convert   thru 9700-exit
  2934     if no-conversion-error
  2935        move dc-bin-date-1       to ws-bin-check-dt
  2936     else
  2937        display ' error cvtdte chek dt ' wsw-check-dt ' '
  2938           dc-error-code
  2939     end-if
  2940     perform varying s1 from +1 by +1 until
  2941        (s1 > +28)
  2942        or (wsw-voucher-ref (s1:6) = 'REF DI' or 'REFUND' or
  2943          'CANCEL')
  2944     end-perform
  2945     if s1 < +29
  2946        move 'Bypass- Manual Entry'    to ws-d1-message
  2947        move ' '                 to ws-table-sw
  2948        go to 2050-continue
  2949     end-if
  2950*    if wsw-user-defined (1:3) not numeric
  2951*       move 'Bypass- Manual Entry'
  2952*                                to ws-d1-message
  2953*       move ' '                 to ws-table-sw
  2954*       go to 2050-continue
  2955*    end-if
  2956     perform varying s1 from +1 by +1 until
  2957        (s1 > +30)
  2958        or (wsw-user-defined (s1:1) = ' ')
  2959     end-perform
  2960     if (s1 < +12)
  2961        and (s1 > +8)
  2962        continue
  2963     else
  2964        move 'Bypass- Manual Entry'
  2965                                 to ws-d1-message
  2966        move ' '                 to ws-table-sw
  2967        go to 2050-continue
  2968     end-if
  2969     move spaces                 to wsw-check-key
  2970     perform varying s1 from +30 by -1 until
  2971        (s1 < +1)
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  53
* EL201.cbl
  2972        or (wsw-user-defined (s1:1) numeric)
  2973     end-perform
  2974     if s1 > +7
  2975        move wsw-user-defined (s1 - 6:7)
  2976                                 to wsw-check-key
  2977     else
  2978        move 'Invalid Input CK-KEY'    to ws-d1-message
  2979        go to 2050-continue
  2980     end-if
  2981*    go to 2050-read
  2982     move ' '                    to ws-erchek-sw
  2983                                    ws-table-sw
  2984     perform 2200-get-tbl-row    thru 2200-exit
  2985     if sqlcode = 0
  2986        set table-found          to true
  2987        perform 1020-read-erchek thru 1020-exit
  2988        if resp-normal
  2989           set erchek-found to true
  2990           perform 2310-upd-erchek
  2991                                 thru 2310-exit
  2992           perform 2320-upd-table thru 2320-exit
  2993        else
  2994           display ' erchek not fnd ' ch-carrier ' ' ch-state ' '
  2995              ch-account ' ' db-effdate (1:10) ' ' db-certificate
  2996              ' ' ws-response
  2997           move ' chk rec not found ' to ws-d1-message
  2998        end-if
  2999     else
  3000        move ' tbl row not found ' to ws-d1-message
  3001     end-if
  3002     .
  3003 2050-continue.
  3004     perform 2400-build-print-line thru 2400-exit
  3005     .
  3006 2050-read.
  3007     perform 2040-read-input     thru 2040-exit
  3008     .
  3009 2050-exit.
  3010     exit.
  3011 2200-get-tbl-row.
  3012***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3013***                                                            ***
  3014***  I'm only expecting one row so no cursor is declared       ***
  3015***                                                            ***
  3016***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3017     move ws-comp-id             to ws-compid
  3018     move wsw-check-key-num      to ws-check-key
  3019     move 1                      to ws-type
  3020     exec sql
  3021        SELECT
  3022           CheckKey,
  3023           Company,
  3024           CertCarrier,
  3025           CertGroup,
  3026           CertState,
  3027           CertAccount,
  3028           CertEffDate,
  3029           CertNumber,
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  54
* EL201.cbl
  3030           CertNumberSuf,
  3031           CheckSeqNbr,
  3032           CheckType,
  3033           CheckAmount,
  3034           Preparer,
  3035           CheckSubType
  3036        INTO
  3037           :db-checkkey,
  3038           :db-compid,
  3039           :db-carrier,
  3040           :db-grouping,
  3041           :db-state,
  3042           :db-account,
  3043           :db-effdate,
  3044           :db-certificate,
  3045           :db-cert-sfx,
  3046           :db-seq-no,
  3047           :db-type,
  3048           :db-amount,
  3049           :db-preparer,
  3050           :db-check-sub-type
  3051        FROM
  3052           ChkApp_Check
  3053        WHERE
  3054           (CheckKey    = :ws-check-key)
  3055           and (Company = :ws-compid)
  3056     end-exec
  3057     if sqlcode not = 0
  3058        move sqlcode to ws-sql-code
  3059        move ws-sql-code to ws-dis-sql-code
  3060        display ' dis sql code ' ws-dis-sql-code
  3061        display "Error: cannot read row "
  3062        display ' sql return code ' sqlcode
  3063        display ' sql err mess    ' sqlerrmc
  3064     end-if
  3065     .
  3066 2200-exit.
  3067     exit.
  3068 2310-upd-erchek.
  3069     move ws-bin-check-dt        to ch-check-written-dt
  3070     if wsw-check-no (1:1) = '"'
  3071        move wsw-check-no (5:7)  to ch-check-no
  3072     else
  3073        move wsw-check-no (4:7)  to ch-check-no
  3074     end-if
  3075*    move zeros                  to ws-response
  3076
  3077* exec cics rewrite
  3078*       dataset     ('ERCHEK')
  3079*       from        (check-records)
  3080*       resp        (ws-response)
  3081*    end-exec
  3082     MOVE LENGTH OF
  3083      check-records
  3084       TO DFHEIV11
  3085     MOVE 'ERCHEK' TO DFHEIV1
  3086*    MOVE '&& L                  %  N#00002875' TO DFHEIV0
  3087     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  55
* EL201.cbl
  3088     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3089     MOVE X'204E233030303032383735' TO DFHEIV0(25:11)
  3090     CALL 'kxdfhei1' USING DFHEIV0,
  3091           DFHEIV1,
  3092           check-records,
  3093           DFHEIV11,
  3094           DFHEIV99
  3095     MOVE EIBRESP  TO ws-response
  3096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3097     if resp-normal
  3098        add 1 to ws-writ-cnt
  3099        compute ws-tot-writ-amt =
  3100           ws-tot-writ-amt + ch-amount-paid
  3101        move 'Successful Post '  to ws-d1-message
  3102     else
  3103        move '*** ERROR - NOT POSTED ***' TO ws-d1-message
  3104     end-if
  3105     .
  3106 2310-exit.
  3107     exit.
  3108 2320-upd-table.
  3109     string wsw-check-dt (6:2) '/'
  3110            wsw-check-dt (9:2) '/'
  3111            wsw-check-dt (1:4)
  3112        delimited by size into db-checkdate
  3113     move ch-check-no            to db-checkno
  3114*    move zeros to sqlcode
  3115     EXEC SQL
  3116        UPDATE
  3117           ChkApp_Check
  3118        SET
  3119           CheckNumber = :db-checkno,
  3120           CheckDate = :db-checkdate
  3121        WHERE
  3122           CheckKey = :db-checkkey
  3123     END-EXEC
  3124     if sqlcode not = 0
  3125        move 'Table not updated ' to ws-d1-message
  3126        display "Error: cannot update table   "
  3127        display ' sql retrun code ' sqlcode
  3128        display ' sql err mess    ' sqlerrmc
  3129     end-if
  3130     .
  3131 2320-exit.
  3132     exit.
  3133 2400-build-print-line.
  3134     if table-found
  3135        move db-carrier          to ws-d1-carr
  3136        move db-grouping         to ws-d1-grp
  3137        move db-state            to ws-d1-state
  3138        move db-account          to ws-d1-account
  3139        string
  3140           db-effdate (6:2)   '/'
  3141           db-effdate (9:2)   '/'
  3142           db-effdate (1:4)
  3143           delimited by size into ws-d1-eff-dt
  3144        end-string
  3145        move db-certificate      to ws-d1-cert-no
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  56
* EL201.cbl
  3146        move db-cert-sfx         to ws-d1-cert-no (11:1)
  3147        if db-check-sub-type = '2'
  3148           move 'COR'            to ws-d1-chk-type
  3149        else
  3150           move 'REF'            to ws-d1-chk-type
  3151        end-if
  3152        move +10                 to s2
  3153        move zeros               to ws-work-amt-alpha
  3154        perform varying s1 from +10 by -1 until s1 < +1
  3155           if db-amount (s1:1) numeric
  3156              move db-amount (s1:1)
  3157                                 to ws-work-amt-alpha (s2:1)
  3158              subtract +1 from s2
  3159           end-if
  3160        end-perform
  3161        move ws-work-amt-num     to ws-d1-chk-amt
  3162        move db-preparer         to ws-d1-preparer
  3163        move db-checkno          to ws-d1-chk-no
  3164        move db-checkdate        to ws-d1-writ-cash-dt
  3165     else
  3166        move wsw-check-no        to ws-d1-chk-no
  3167     end-if
  3168     perform 4000-write-report   thru 4000-exit
  3169     move spaces                 to ws-detail1
  3170     .
  3171 2400-exit.
  3172     exit.
  3173 2500-close-files.
  3174     close cps-written-in cps-written-rpt
  3175     .
  3176 2500-exit.
  3177     exit.
  3178 4000-write-report.
  3179     if ws-line-cntr > ws-max-lines
  3180        move zeros               to ws-line-cntr
  3181        perform 4010-write-headings thru 4010-exit
  3182     end-if
  3183     move ws-detail1             to cps-written-rpt-rec
  3184     perform 4020-write-a-line   thru 4020-exit
  3185     .
  3186 4000-exit.
  3187     exit.
  3188 4010-write-headings.
  3189     add 1 to ws-page-cntr
  3190     move ws-page-cntr           to ws-h3-page
  3191     move ws-heading1            to cps-written-rpt-rec
  3192     perform 4020-write-a-line   thru 4020-exit
  3193     move ws-heading2            to cps-written-rpt-rec
  3194     perform 4020-write-a-line   thru 4020-exit
  3195     move ws-heading3            to cps-written-rpt-rec
  3196     perform 4020-write-a-line   thru 4020-exit
  3197     move spaces                 to cps-written-rpt-rec
  3198     perform 4020-write-a-line   thru 4020-exit
  3199     move spaces                 to cps-written-rpt-rec
  3200     perform 4020-write-a-line   thru 4020-exit
  3201     move ws-heading4            to cps-written-rpt-rec
  3202     perform 4020-write-a-line   thru 4020-exit
  3203     move spaces                 to cps-written-rpt-rec
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  57
* EL201.cbl
  3204     perform 4020-write-a-line   thru 4020-exit
  3205     .
  3206 4010-exit.
  3207     exit.
  3208 4020-write-a-line.
  3209     write cps-written-rpt-rec
  3210     add 1 to ws-line-cntr
  3211     .
  3212 4020-exit.
  3213     exit.
  3214 5000-submit-job.
  3215
  3216* EXEC CICS WRITEQ TD
  3217*       QUEUE ('BTCH')
  3218*       FROM (TRAN-DATA-LINE1)
  3219*       LENGTH (80)
  3220*    END-EXEC
  3221     MOVE 80
  3222       TO DFHEIV11
  3223     MOVE 'BTCH' TO DFHEIV5
  3224*    MOVE '(" L   L              &   #00002998' TO DFHEIV0
  3225     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  3226     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3227     MOVE X'2020233030303032393938' TO DFHEIV0(25:11)
  3228     CALL 'kxdfhei1' USING DFHEIV0,
  3229           DFHEIV5,
  3230           TRAN-DATA-LINE1,
  3231           DFHEIV11,
  3232           DFHEIV99,
  3233           DFHEIV99
  3234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3235
  3236* EXEC CICS WRITEQ TD
  3237*       QUEUE ('BTCH')
  3238*       FROM (TRAN-DATA-LINE2)
  3239*       LENGTH (80)
  3240*    END-EXEC
  3241     MOVE 80
  3242       TO DFHEIV11
  3243     MOVE 'BTCH' TO DFHEIV5
  3244*    MOVE '(" L   L              &   #00003003' TO DFHEIV0
  3245     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  3246     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3247     MOVE X'2020233030303033303033' TO DFHEIV0(25:11)
  3248     CALL 'kxdfhei1' USING DFHEIV0,
  3249           DFHEIV5,
  3250           TRAN-DATA-LINE2,
  3251           DFHEIV11,
  3252           DFHEIV99,
  3253           DFHEIV99
  3254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3255     .
  3256 5000-exit.
  3257     exit.
  3258 9700-DATE-CONVERT.
  3259
  3260* EXEC CICS LINK
  3261*         PROGRAM  ('ELDATCV')
* Micro Focus Server Express         V5.1 revision 000 09-Mar-21 14:59 Page  58
* EL201.cbl
  3262*         COMMAREA (DATE-CONVERSION-DATA)
  3263*         LENGTH   (DC-COMM-LENGTH)
  3264*    END-EXEC.
  3265     MOVE 'ELDATCV' TO DFHEIV1
  3266*    MOVE '."C                   (   #00003012' TO DFHEIV0
  3267     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3269     MOVE X'2020233030303033303132' TO DFHEIV0(25:11)
  3270     CALL 'kxdfhei1' USING DFHEIV0,
  3271           DFHEIV1,
  3272           DATE-CONVERSION-DATA,
  3273           DC-COMM-LENGTH,
  3274           DFHEIV99,
  3275           DFHEIV99,
  3276           DFHEIV99,
  3277           DFHEIV99
  3278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3279
  3280 9700-EXIT.
  3281      EXIT.
  3282
  3283 9999-DFHBACK SECTION.
  3284     MOVE '9%                    "   ' TO DFHEIV0
  3285     MOVE 'EL201' TO DFHEIV1
  3286     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3287     GOBACK.
  3288 9999-DFHEXIT.
  3289     IF DFHEIGDJ EQUAL 0001
  3290         NEXT SENTENCE.
  3291     MOVE '9%                    "   ' TO DFHEIV0
  3292     MOVE 'EL201' TO DFHEIV1
  3293     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3294     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      140212     Code:       10718
