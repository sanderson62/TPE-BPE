* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page   1
* EL633.cbl
* Options: int("EL633.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL633.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL633.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page   2
* EL633.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52* 120711  CR2011120100004  PEMA ADD GL NUMBER FOR CCC
    53* 031912  CR2011120900003  AJRA AHL COMPANY CODE
    54* 100713  CR2013100700001  AJRA ADD 1825091000 FOR CID
    55* 081414    2014012300001  PEMA  ADD PROCESSING FOR CARRIER 7 DCC
    56* 110315  CR2015101400001  PEMA ADD NEW DCC G/L #'S FOR ACH
    57******************************************************************
    58
    59 ENVIRONMENT DIVISION.
    60 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page   3
* EL633.cbl
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64 77  FILLER  PIC X(32)  VALUE '********************************'.
    65 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    66 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    67
    68*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    69*77  SV-COFA PIC X(42)  VALUE SPACES.
    70*77  K-SPACE PIC X(11)  VALUE SPACES.
    71
    72 01  DATE-WORK-AREAS.
    73     05  WS-GREG-STORE.
    74         10  WS-GS-MM  PIC XX.
    75         10  FILLER    PIC X.
    76         10  WS-GS-DD  PIC XX.
    77         10  FILLER    PIC X.
    78         10  WS-GS-YY  PIC XX.
    79     05  WS-SDTE-STORE.
    80         10  WS-SS-MM  PIC XX.
    81         10  WS-SS-DD  PIC XX.
    82         10  WS-SS-YY  PIC XX.
    83*                            COPY ELCSCTM.
    84******************************************************************
    85*                                                                *
    86*                                                                *
    87*                            ELCSCTM                             *
    88*                            VMOD=2.001                          *
    89*                                                                *
    90*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    91*                                                                *
    92******************************************************************
    93 01  SECURITY-MESSAGE.
    94     12  FILLER                          PIC X(30)
    95            VALUE '** LOGIC SECURITY VIOLATION -'.
    96     12  SM-READ                         PIC X(6).
    97     12  FILLER                          PIC X(5)
    98            VALUE ' PGM='.
    99     12  SM-PGM                          PIC X(6).
   100     12  FILLER                          PIC X(5)
   101            VALUE ' OPR='.
   102     12  SM-PROCESSOR-ID                 PIC X(4).
   103     12  FILLER                          PIC X(6)
   104            VALUE ' TERM='.
   105     12  SM-TERMID                       PIC X(4).
   106     12  FILLER                          PIC XX   VALUE SPACE.
   107     12  SM-JUL-DATE                     PIC 9(5).
   108     12  FILLER                          PIC X    VALUE SPACE.
   109     12  SM-TIME                         PIC 99.99.
   110
   111*                            COPY ELCSCRTY.
   112******************************************************************
   113*                                                                *
   114*                                                                *
   115*                            ELCSCRTY                            *
   116*                            VMOD=2.001                          *
   117*                                                                *
   118*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   119*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page   4
* EL633.cbl
   120*        SAVED IN PI-SECURITY-ADDRESS.                           *
   121*                                                                *
   122******************************************************************
   123 01  SECURITY-CONTROL.
   124     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   125     12  FILLER                       PIC XX    VALUE 'SC'.
   126     12  SC-CREDIT-CODES.
   127         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   128             20  SC-CREDIT-DISPLAY    PIC X.
   129             20  SC-CREDIT-UPDATE     PIC X.
   130     12  SC-CLAIMS-CODES.
   131         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   132             20  SC-CLAIMS-DISPLAY    PIC X.
   133             20  SC-CLAIMS-UPDATE     PIC X.
   134
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page   5
* EL633.cbl
   136
   137 01  STANDARD-AREAS.
   138     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   139     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   140     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   141     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   142     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   143     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   144     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   145     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   146     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   147     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   148     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   149     12  PGM-NAME            PIC  X(8).
   150     12  TIME-IN             PIC S9(7).
   151     12  TIME-OUT-R  REDEFINES  TIME-IN.
   152         16  FILLER          PIC  X.
   153         16  TIME-OUT        PIC  99V99.
   154         16  FILLER          PIC  X(2).
   155     12  EL640               PIC  X(8)       VALUE 'EL640'.
   156     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   157     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   158     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   159     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   160     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   161     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   162     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   163     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   164     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   165     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   166     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   167     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   168     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   169     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   170     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   171     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   172     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   173         88  PYAJ-1ST-READ                   VALUE 'Y'.
   174     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   175         88  FIRST-ADD                       VALUE 'Y'.
   176     12  ZERO-NDX            PIC  9          VALUE ZERO.
   177     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   178     12  WORK-SEQ-TIME       PIC  9(6).
   179     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   180         16  WORK-SEQ-HHMMS  PIC  9(5).
   181         16  FILLER          PIC  9.
   182     12  WORK-DATE-JULIAN.
   183         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   184         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   185     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   186     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   187         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   188                                                    'S' 'T' 'U'
   189                                                    'X' 'Y' 'Z'
   190                                                    'F'.
   191     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   192         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   193     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page   6
* EL633.cbl
   194         88  FORCE-SHOW                      VALUE  'Y'.
   195
   196     12  WS-EOM-DTS OCCURS 13  TIMES
   197                              INDEXED BY PINDEX.
   198         16  WS-EOM-DT               PIC XX.
   199*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   200
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page   7
* EL633.cbl
   202     12  WS-ERROR-CODES.
   203         16  ER-0000         PIC  X(4)       VALUE '0000'.
   204         16  ER-0008         PIC  X(4)       VALUE '0008'.
   205         16  ER-0023         PIC  X(4)       VALUE '0023'.
   206         16  ER-0029         PIC  X(4)       VALUE '0029'.
   207         16  ER-0070         PIC  X(4)       VALUE '0070'.
   208         16  ER-0587         PIC  X(4)       VALUE '0587'.
   209         16  ER-2056         PIC  X(4)       VALUE '2056'.
   210         16  ER-2230         PIC  X(4)       VALUE '2230'.
   211         16  ER-2231         PIC  X(4)       VALUE '2231'.
   212         16  ER-2232         PIC  X(4)       VALUE '2232'.
   213         16  ER-2233         PIC  X(4)       VALUE '2233'.
   214         16  ER-2234         PIC  X(4)       VALUE '2234'.
   215         16  ER-2235         PIC  X(4)       VALUE '2235'.
   216         16  ER-2236         PIC  X(4)       VALUE '2236'.
   217         16  ER-2237         PIC  X(4)       VALUE '2237'.
   218         16  ER-2238         PIC  X(4)       VALUE '2238'.
   219         16  ER-2239         PIC  X(4)       VALUE '2239'.
   220         16  ER-2244         PIC  X(4)       VALUE '2244'.
   221         16  ER-2245         PIC  X(4)       VALUE '2245'.
   222         16  ER-2246         PIC  X(4)       VALUE '2246'.
   223         16  ER-2370         PIC  X(4)       VALUE '2370'.
   224         16  ER-2432         PIC  X(4)       VALUE '2432'.
   225         16  ER-2449         PIC  X(4)       VALUE '2449'.
   226         16  ER-2587         PIC  X(4)       VALUE '2587'.
   227         16  ER-2588         PIC  X(4)       VALUE '2588'.
   228         16  ER-2595         PIC  X(4)       VALUE '2595'.
   229         16  ER-2596         PIC  X(4)       VALUE '2596'.
   230         16  ER-2763         PIC  X(4)       VALUE '2763'.
   231         16  ER-2929         PIC  X(4)       VALUE '2929'.
   232         16  ER-2957         PIC  X(4)       VALUE '2957'.
   233         16  ER-2958         PIC  X(4)       VALUE '2958'.
   234*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   235         16  ER-2960         PIC  X(4)       VALUE '2960'.
   236         16  ER-3020         PIC  X(4)       VALUE '3020'.
   237
   238*************************************************************
   239*                      TABLE OF STATE NAMES
   240*************************************************************
   241
   242 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   243     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   244                                   'CD' 'CO' 'CT' 'DC' 'DE'
   245                                   'FL' 'GA' 'GM' 'HI' 'IA'
   246                                   'ID' 'IL' 'IN' 'KS' 'KY'
   247                                   'LA' 'MA' 'MD' 'ME' 'MI'
   248                                   'MN' 'MO' 'MS' 'MT' 'MX'
   249                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   250                                   'NM' 'NV' 'NY' 'OF' 'OH'
   251                                   'OK' 'OR' 'PA' 'PI' 'PR'
   252                                   'RI' 'SC' 'SD' 'TN' 'TX'
   253                                   'UT' 'VA' 'VI' 'VT' 'WA'
   254                                   'WI' 'WV' 'WY'.
   255
   256 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   257     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   258                                 '1108125100'
   259                                 '1721211400'
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page   8
* EL633.cbl
   260                                 '1825011200'
   261                                 '1825011300'
   262                                 '1825091000'
   263                                 '1825099050'
   264                                 '8505700033'
   265                                 '8506400030'
   266                                 '8507200020'
   267                                 '8507200010'.
   268     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   269                                     '2725040320'
   270                                     '2725040330'
   271                                     '2725040310'
   272                                     '8506400030'
   273                                     '8507200010'
   274                                     '1108121250'.
   275     88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   276                                     '2725040110'
   277                                     '2725040120'
   278                                     '2725040130'
   279                                     '2725020400'.
   280
   281     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   282                                     '1825013200'
   283                                     '1825013300'
   284                                     '1825013400'
   285                                     '8506400030'
   286                                     '8507200010'
   287                                     '8507200020'
   288                                     '1108121010'.
   289
   290*01  WS-ACCT-BREAK.
   291*    05  WS-ACCT-1               PIC X.
   292*    05  FILLER                  PIC X(6).
   293*
   294 01  WORK-AREA.
   295     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   296     12  QID.
   297         16  QID-TERM        PIC X(04).
   298         16  FILLER          PIC X(04)       VALUE '633A'.
   299     12  DEEDIT-FIELD        PIC X(11).
   300     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   301     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   302     12  DATE-TEST-AREA      PIC  9(6).
   303     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   304         16  DATE-TEST-MM    PIC  99.
   305         16  DATE-TEST-DD    PIC  99.
   306         16  DATE-TEST-YY    PIC  99.
   307     12  DIVIDE-RESULT       PIC  99.
   308     12  DIVIDE-REMAINDER    PIC  9.
   309     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   310     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   311     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   312     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   313     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   314     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   315     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   316     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   317
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page   9
* EL633.cbl
   318 01  ACCESS-KEYS.
   319     12  ERPYAJ-KEY.
   320         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   321         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   322         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   323         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   324         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   325         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   326         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   327
   328     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   329     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   330
   331     12  ERCHKQ-KEY.
   332         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   333         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   334         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   335     12  ERCOMP-KEY.
   336         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   337         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   338         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   339         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   340         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   341         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   342*    12  COFA-KEY-X.
   343*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   344*        16  COFA-ACCOUNT.
   345*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   346*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   347*
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  10
* EL633.cbl
   349*                                    COPY ELCDATE.
   350******************************************************************
   351*                                                                *
   352*                                                                *
   353*                            ELCDATE.                            *
   354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   355*                            VMOD=2.003
   356*                                                                *
   357*                                                                *
   358*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   359*                 LENGTH = 200                                   *
   360******************************************************************
   361
   362 01  DATE-CONVERSION-DATA.
   363     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   364     12  DC-OPTION-CODE                PIC X.
   365         88  BIN-TO-GREG                VALUE ' '.
   366         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   367         88  EDIT-GREG-TO-BIN           VALUE '2'.
   368         88  YMD-GREG-TO-BIN            VALUE '3'.
   369         88  MDY-GREG-TO-BIN            VALUE '4'.
   370         88  JULIAN-TO-BIN              VALUE '5'.
   371         88  BIN-PLUS-ELAPSED           VALUE '6'.
   372         88  FIND-CENTURY               VALUE '7'.
   373         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   374         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   375         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   376         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   377         88  JULIAN-TO-BIN-3            VALUE 'C'.
   378         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   379         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   380         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   381         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   382         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   383         88  CHECK-LEAP-YEAR            VALUE 'H'.
   384         88  BIN-3-TO-GREG              VALUE 'I'.
   385         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   386         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   387         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   388         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   389         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   390         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   391         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   392         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   393         88  THREE-CHARACTER-BIN
   394                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   395         88  GREGORIAN-TO-BIN
   396                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   397         88  BIN-TO-GREGORIAN
   398                  VALUES ' ' '1' 'I' '8' 'G'.
   399         88  JULIAN-TO-BINARY
   400                  VALUES '5' 'C' 'E' 'F'.
   401     12  DC-ERROR-CODE                 PIC X.
   402         88  NO-CONVERSION-ERROR        VALUE ' '.
   403         88  DATE-CONVERSION-ERROR
   404                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   405         88  DATE-IS-ZERO               VALUE '1'.
   406         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  11
* EL633.cbl
   407         88  DATE-IS-INVALID            VALUE '3'.
   408         88  DATE1-GREATER-DATE2        VALUE '4'.
   409         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   410         88  DATE-INVALID-OPTION        VALUE '9'.
   411         88  INVALID-CENTURY            VALUE 'A'.
   412         88  ONLY-CENTURY               VALUE 'B'.
   413         88  ONLY-LEAP-YEAR             VALUE 'C'.
   414         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   415     12  DC-END-OF-MONTH               PIC X.
   416         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   417     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   418         88  USE-NORMAL-PROCESS         VALUE ' '.
   419         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   420         88  ADJUST-UP-100-YRS          VALUE '2'.
   421     12  FILLER                        PIC X.
   422     12  DC-CONVERSION-DATES.
   423         16  DC-BIN-DATE-1             PIC XX.
   424         16  DC-BIN-DATE-2             PIC XX.
   425         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   426         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   427                       DC-GREG-DATE-1-EDIT.
   428             20  DC-EDIT1-MONTH        PIC 99.
   429             20  SLASH1-1              PIC X.
   430             20  DC-EDIT1-DAY          PIC 99.
   431             20  SLASH1-2              PIC X.
   432             20  DC-EDIT1-YEAR         PIC 99.
   433         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   434         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   435                     DC-GREG-DATE-2-EDIT.
   436             20  DC-EDIT2-MONTH        PIC 99.
   437             20  SLASH2-1              PIC X.
   438             20  DC-EDIT2-DAY          PIC 99.
   439             20  SLASH2-2              PIC X.
   440             20  DC-EDIT2-YEAR         PIC 99.
   441         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   442         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   443                     DC-GREG-DATE-1-YMD.
   444             20  DC-YMD-YEAR           PIC 99.
   445             20  DC-YMD-MONTH          PIC 99.
   446             20  DC-YMD-DAY            PIC 99.
   447         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   448         16  DC-GREG-DATE-1-MDY-R REDEFINES
   449                      DC-GREG-DATE-1-MDY.
   450             20  DC-MDY-MONTH          PIC 99.
   451             20  DC-MDY-DAY            PIC 99.
   452             20  DC-MDY-YEAR           PIC 99.
   453         16  DC-GREG-DATE-1-ALPHA.
   454             20  DC-ALPHA-MONTH        PIC X(10).
   455             20  DC-ALPHA-DAY          PIC 99.
   456             20  FILLER                PIC XX.
   457             20  DC-ALPHA-CENTURY.
   458                 24 DC-ALPHA-CEN-N     PIC 99.
   459             20  DC-ALPHA-YEAR         PIC 99.
   460         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   461         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   462         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   463         16  DC-JULIAN-DATE            PIC 9(05).
   464         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  12
* EL633.cbl
   465                                       PIC 9(05).
   466         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   467             20  DC-JULIAN-YEAR        PIC 99.
   468             20  DC-JULIAN-DAYS        PIC 999.
   469         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   470         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   471         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   472     12  DATE-CONVERSION-VARIBLES.
   473         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   474         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   475             20  FILLER                PIC 9(3).
   476             20  HOLD-CEN-1-CCYY.
   477                 24  HOLD-CEN-1-CC     PIC 99.
   478                 24  HOLD-CEN-1-YY     PIC 99.
   479             20  HOLD-CEN-1-MO         PIC 99.
   480             20  HOLD-CEN-1-DA         PIC 99.
   481         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   482             20  HOLD-CEN-1-R-MO       PIC 99.
   483             20  HOLD-CEN-1-R-DA       PIC 99.
   484             20  HOLD-CEN-1-R-CCYY.
   485                 24  HOLD-CEN-1-R-CC   PIC 99.
   486                 24  HOLD-CEN-1-R-YY   PIC 99.
   487             20  FILLER                PIC 9(3).
   488         16  HOLD-CENTURY-1-X.
   489             20  FILLER                PIC X(3)  VALUE SPACES.
   490             20  HOLD-CEN-1-X-CCYY.
   491                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   492                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   493             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   494             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   495         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   496             20  HOLD-CEN-1-R-X-MO     PIC XX.
   497             20  HOLD-CEN-1-R-X-DA     PIC XX.
   498             20  HOLD-CEN-1-R-X-CCYY.
   499                 24  HOLD-CEN-1-R-X-CC PIC XX.
   500                 24  HOLD-CEN-1-R-X-YY PIC XX.
   501             20  FILLER                PIC XXX.
   502         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   503         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   504         16  DC-JULIAN-DATE-1          PIC 9(07).
   505         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   506             20  DC-JULIAN-1-CCYY.
   507                 24  DC-JULIAN-1-CC    PIC 99.
   508                 24  DC-JULIAN-1-YR    PIC 99.
   509             20  DC-JULIAN-DA-1        PIC 999.
   510         16  DC-JULIAN-DATE-2          PIC 9(07).
   511         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   512             20  DC-JULIAN-2-CCYY.
   513                 24  DC-JULIAN-2-CC    PIC 99.
   514                 24  DC-JULIAN-2-YR    PIC 99.
   515             20  DC-JULIAN-DA-2        PIC 999.
   516         16  DC-GREG-DATE-A-EDIT.
   517             20  DC-EDITA-MONTH        PIC 99.
   518             20  SLASHA-1              PIC X VALUE '/'.
   519             20  DC-EDITA-DAY          PIC 99.
   520             20  SLASHA-2              PIC X VALUE '/'.
   521             20  DC-EDITA-CCYY.
   522                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  13
* EL633.cbl
   523                 24  DC-EDITA-YEAR     PIC 99.
   524         16  DC-GREG-DATE-B-EDIT.
   525             20  DC-EDITB-MONTH        PIC 99.
   526             20  SLASHB-1              PIC X VALUE '/'.
   527             20  DC-EDITB-DAY          PIC 99.
   528             20  SLASHB-2              PIC X VALUE '/'.
   529             20  DC-EDITB-CCYY.
   530                 24  DC-EDITB-CENT     PIC 99.
   531                 24  DC-EDITB-YEAR     PIC 99.
   532         16  DC-GREG-DATE-CYMD         PIC 9(08).
   533         16  DC-GREG-DATE-CYMD-R REDEFINES
   534                              DC-GREG-DATE-CYMD.
   535             20  DC-CYMD-CEN           PIC 99.
   536             20  DC-CYMD-YEAR          PIC 99.
   537             20  DC-CYMD-MONTH         PIC 99.
   538             20  DC-CYMD-DAY           PIC 99.
   539         16  DC-GREG-DATE-MDCY         PIC 9(08).
   540         16  DC-GREG-DATE-MDCY-R REDEFINES
   541                              DC-GREG-DATE-MDCY.
   542             20  DC-MDCY-MONTH         PIC 99.
   543             20  DC-MDCY-DAY           PIC 99.
   544             20  DC-MDCY-CEN           PIC 99.
   545             20  DC-MDCY-YEAR          PIC 99.
   546    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   547        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   548    12  DC-EL310-DATE                  PIC X(21).
   549    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  14
* EL633.cbl
   551*                                    COPY ELCLOGOF.
   552******************************************************************
   553*                                                                *
   554*                                                                *
   555*                            ELCLOGOF.                           *
   556*                            VMOD=2.001                          *
   557*                                                                *
   558*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   559*                                                                *
   560******************************************************************
   561 01  CLASIC-LOGOFF.
   562     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   563     12  LOGOFF-TEXT.
   564         16  FILLER          PIC X(5)    VALUE SPACES.
   565         16  LOGOFF-MSG.
   566             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   567             20  FILLER      PIC X       VALUE SPACES.
   568             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   569         16  FILLER          PIC X(80)
   570           VALUE '* YOU ARE NOW LOGGED OFF'.
   571         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   572         16  FILLER          PIC X       VALUE QUOTE.
   573         16  LOGOFF-SYS-MSG  PIC X(17)
   574           VALUE 'S CLAS-IC SYSTEM '.
   575     12  TEXT-MESSAGES.
   576         16  UNACCESS-MSG    PIC X(29)
   577             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   578         16  PGMIDERR-MSG    PIC X(17)
   579             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  15
* EL633.cbl
   581*                                    COPY ELCATTR.
   582******************************************************************
   583*                                                                *
   584*                            ELCATTR.                            *
   585*                            VMOD=2.001                          *
   586*                                                                *
   587*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   588*                                                                *
   589*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   590*                                                                *
   591*                   POS 1   P=PROTECTED                          *
   592*                           U=UNPROTECTED                        *
   593*                           S=ASKIP                              *
   594*                   POS 2   A=ALPHA/NUMERIC                      *
   595*                           N=NUMERIC                            *
   596*                   POS 3   N=NORMAL                             *
   597*                           B=BRIGHT                             *
   598*                           D=DARK                               *
   599*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   600*                           OF=MODIFIED DATA TAG OFF             *
   601*                                                                *
   602*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   603******************************************************************
   604 01  ATTRIBUTE-LIST.
   605     12  AL-PABOF            PIC X       VALUE 'Y'.
   606     12  AL-PABON            PIC X       VALUE 'Z'.
   607     12  AL-PADOF            PIC X       VALUE '%'.
   608     12  AL-PADON            PIC X       VALUE '_'.
   609     12  AL-PANOF            PIC X       VALUE '-'.
   610     12  AL-PANON            PIC X       VALUE '/'.
   611     12  AL-SABOF            PIC X       VALUE '8'.
   612     12  AL-SABON            PIC X       VALUE '9'.
   613     12  AL-SADOF            PIC X       VALUE '@'.
   614     12  AL-SADON            PIC X       VALUE QUOTE.
   615     12  AL-SANOF            PIC X       VALUE '0'.
   616     12  AL-SANON            PIC X       VALUE '1'.
   617     12  AL-UABOF            PIC X       VALUE 'H'.
   618     12  AL-UABON            PIC X       VALUE 'I'.
   619     12  AL-UADOF            PIC X       VALUE '<'.
   620     12  AL-UADON            PIC X       VALUE '('.
   621     12  AL-UANOF            PIC X       VALUE ' '.
   622     12  AL-UANON            PIC X       VALUE 'A'.
   623     12  AL-UNBOF            PIC X       VALUE 'Q'.
   624     12  AL-UNBON            PIC X       VALUE 'R'.
   625     12  AL-UNDOF            PIC X       VALUE '*'.
   626     12  AL-UNDON            PIC X       VALUE ')'.
   627     12  AL-UNNOF            PIC X       VALUE '&'.
   628     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  16
* EL633.cbl
   630*                                    COPY ELCEMIB.
   631******************************************************************
   632*                                                                *
   633*                                                                *
   634*                            ELCEMIB.                            *
   635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   636*                            VMOD=2.005                          *
   637*                                                                *
   638*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   639*                                                                *
   640******************************************************************
   641 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   642     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   643     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   644     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   645     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   646     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   647     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   648     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   649     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   650     12  EMI-SWITCH1             PIC X        VALUE '1'.
   651         88  EMI-NO-ERRORS                    VALUE '1'.
   652         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   653         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   654     12  EMI-SWITCH2             PIC X        VALUE '1'.
   655         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   656     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   657         88  EMI-AREA1-EMPTY                  VALUE '1'.
   658         88  EMI-AREA1-FULL                   VALUE '2'.
   659     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   660         88  EMI-AREA2-EMPTY                  VALUE '1'.
   661         88  EMI-AREA2-FULL                   VALUE '2'.
   662     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   663         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   664         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   665         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   666         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   667         88  EMI-BYPASS-FATALS                VALUE 'X'.
   668     12  EMI-ERROR-LINES.
   669         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   670         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   671         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   672         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   673             20  EMI-ERR-CODES OCCURS 10 TIMES.
   674                 24  EMI-ERR-NUM         PIC X(4).
   675                 24  EMI-FILLER          PIC X.
   676                 24  EMI-SEV             PIC X.
   677                 24  FILLER              PIC X.
   678             20  FILLER                  PIC X(02).
   679     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   680         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   681             20  EMI-ERROR-NUMBER    PIC X(4).
   682             20  EMI-FILL            PIC X.
   683             20  EMI-SEVERITY        PIC X.
   684             20  FILLER              PIC X.
   685             20  EMI-ERROR-TEXT.
   686                 24  EMI-TEXT-VARIABLE   PIC X(10).
   687                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  17
* EL633.cbl
   688     12  EMI-SEVERITY-SAVE           PIC X.
   689         88  EMI-NOTE                    VALUE 'N'.
   690         88  EMI-WARNING                 VALUE 'W'.
   691         88  EMI-FORCABLE                VALUE 'F'.
   692         88  EMI-FATAL                   VALUE 'X'.
   693     12  EMI-MESSAGE-FLAG            PIC X.
   694         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   695         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   696     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   697     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   698         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   699         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   700         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   701     12  emi-claim-no                pic x(7).
   702     12  emi-claim-type              pic x(6).
   703     12  FILLER                      PIC X(124)  VALUE SPACES.
   704     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   705     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   706     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   707     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  18
* EL633.cbl
   709*                                    COPY ELCINTF.
   710******************************************************************
   711*                                                                *
   712*                                                                *
   713*                            ELCINTF.                            *
   714*                            VMOD=2.017                          *
   715*                                                                *
   716*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   717*                                                                *
   718*       LENGTH = 1024                                            *
   719*                                                                *
   720******************************************************************
   721*                   C H A N G E   L O G
   722*
   723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   724*-----------------------------------------------------------------
   725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   726* EFFECTIVE    NUMBER
   727*-----------------------------------------------------------------
   728* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   729******************************************************************
   730 01  PROGRAM-INTERFACE-BLOCK.
   731     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   732     12  PI-CALLING-PROGRAM              PIC X(8).
   733     12  PI-SAVED-PROGRAM-1              PIC X(8).
   734     12  PI-SAVED-PROGRAM-2              PIC X(8).
   735     12  PI-SAVED-PROGRAM-3              PIC X(8).
   736     12  PI-SAVED-PROGRAM-4              PIC X(8).
   737     12  PI-SAVED-PROGRAM-5              PIC X(8).
   738     12  PI-SAVED-PROGRAM-6              PIC X(8).
   739     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   740     12  PI-COMPANY-ID                   PIC XXX.
   741     12  PI-COMPANY-CD                   PIC X.
   742
   743     12  PI-COMPANY-PASSWORD             PIC X(8).
   744
   745     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   746
   747     12  PI-CONTROL-IN-PROGRESS.
   748         16  PI-CARRIER                  PIC X.
   749         16  PI-GROUPING                 PIC X(6).
   750         16  PI-STATE                    PIC XX.
   751         16  PI-ACCOUNT                  PIC X(10).
   752         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   753                                         PIC X(10).
   754         16  PI-CLAIM-CERT-GRP.
   755             20  PI-CLAIM-NO             PIC X(7).
   756             20  PI-CERT-NO.
   757                 25  PI-CERT-PRIME       PIC X(10).
   758                 25  PI-CERT-SFX         PIC X.
   759             20  PI-CERT-EFF-DT          PIC XX.
   760         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   761             20  PI-PLAN-CODE            PIC X(2).
   762             20  PI-REVISION-NUMBER      PIC X(3).
   763             20  PI-PLAN-EFF-DT          PIC X(2).
   764             20  PI-PLAN-EXP-DT          PIC X(2).
   765             20  FILLER                  PIC X(11).
   766         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  19
* EL633.cbl
   767             20  PI-OE-REFERENCE-1.
   768                 25  PI-OE-REF-1-PRIME   PIC X(18).
   769                 25  PI-OE-REF-1-SUFF    PIC XX.
   770
   771     12  PI-SESSION-IN-PROGRESS          PIC X.
   772         88  CLAIM-SESSION                   VALUE '1'.
   773         88  CREDIT-SESSION                  VALUE '2'.
   774         88  WARRANTY-SESSION                VALUE '3'.
   775         88  MORTGAGE-SESSION                VALUE '4'.
   776         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   777
   778
   779*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   780
   781     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   782     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   783
   784     12  PI-CREDIT-USER                  PIC X.
   785         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   786         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   787
   788     12  PI-CLAIM-USER                   PIC X.
   789         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   790         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   791
   792     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   793         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   794         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   795         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   796         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   797         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   798
   799     12  PI-PROCESSOR-ID                 PIC X(4).
   800
   801     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   802
   803     12  PI-MEMBER-CAPTION               PIC X(10).
   804
   805     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   806         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   807
   808     12  PI-LIFE-OVERRIDE-L1             PIC X.
   809     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   810     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   811     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   812
   813     12  PI-AH-OVERRIDE-L1               PIC X.
   814     12  PI-AH-OVERRIDE-L2               PIC XX.
   815     12  PI-AH-OVERRIDE-L6               PIC X(6).
   816     12  PI-AH-OVERRIDE-L12              PIC X(12).
   817
   818     12  PI-NEW-SYSTEM                   PIC X(2).
   819
   820     12  PI-PRIMARY-CERT-NO              PIC X(11).
   821     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   822         88  PI-USES-PAID-TO                 VALUE '1'.
   823     12  PI-CRDTCRD-SYSTEM.
   824         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  20
* EL633.cbl
   825             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   826             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   827         16  PI-CC-MONTH-END-DT          PIC XX.
   828     12  PI-PROCESSOR-PRINTER            PIC X(4).
   829
   830     12  PI-OE-REFERENCE-2.
   831         16  PI-OE-REF-2-PRIME           PIC X(10).
   832         16  PI-OE-REF-2-SUFF            PIC X.
   833
   834     12  PI-REM-TRM-CALC-OPTION          PIC X.
   835
   836     12  PI-LANGUAGE-TYPE                PIC X.
   837             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   838             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   839             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   840
   841     12  PI-POLICY-LINKAGE-IND           PIC X.
   842         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   843         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   844                                                   LOW-VALUES.
   845
   846     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   847     12  PI-CLAIM-PW-SESSION             PIC X(1).
   848         88  PI-CLAIM-CREDIT                 VALUE '1'.
   849         88  PI-CLAIM-CONVEN                 VALUE '2'.
   850
   851     12  PI-PROCESSOR-CSR-IND            PIC X.
   852         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   853         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   854
   855     12  FILLER                          PIC X(3).
   856
   857     12  PI-SYSTEM-LEVEL                 PIC X(145).
   858
   859     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   860         PI-SYSTEM-LEVEL.
   861
   862         16  PI-ENTRY-CODES.
   863             20  PI-ENTRY-CD-1           PIC X.
   864             20  PI-ENTRY-CD-2           PIC X.
   865
   866         16  PI-RETURN-CODES.
   867             20  PI-RETURN-CD-1          PIC X.
   868             20  PI-RETURN-CD-2          PIC X.
   869
   870         16  PI-UPDATE-STATUS-SAVE.
   871             20  PI-UPDATE-BY            PIC X(4).
   872             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   873
   874         16  PI-LOWER-CASE-LETTERS       PIC X.
   875             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   876
   877*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   878*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   879*            88  CARRIER-CLM-CNTL            VALUE '2'.
   880
   881         16  PI-CERT-ACCESS-CONTROL      PIC X.
   882             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  21
* EL633.cbl
   883             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   884             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   885             88  ACCNT-CNTL                  VALUE '3'.
   886             88  CARR-ACCNT-CNTL             VALUE '4'.
   887
   888         16  PI-PROCESSOR-CAP-LIST.
   889             20  PI-SYSTEM-CONTROLS.
   890                24 PI-SYSTEM-DISPLAY     PIC X.
   891                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   892                24 PI-SYSTEM-MODIFY      PIC X.
   893                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   894             20  FILLER                  PIC XX.
   895             20  PI-DISPLAY-CAP          PIC X.
   896                 88  DISPLAY-CAP             VALUE 'Y'.
   897             20  PI-MODIFY-CAP           PIC X.
   898                 88  MODIFY-CAP              VALUE 'Y'.
   899             20  PI-MSG-AT-LOGON-CAP     PIC X.
   900                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   901             20  PI-FORCE-CAP            PIC X.
   902                 88  FORCE-CAP               VALUE 'Y'.
   903
   904         16  PI-PROGRAM-CONTROLS.
   905             20  PI-PGM-PRINT-OPT        PIC X.
   906             20  PI-PGM-FORMAT-OPT       PIC X.
   907             20  PI-PGM-PROCESS-OPT      PIC X.
   908             20  PI-PGM-TOTALS-OPT       PIC X.
   909
   910         16  PI-HELP-INTERFACE.
   911             20  PI-LAST-ERROR-NO        PIC X(4).
   912             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   913
   914         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   915             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   916
   917         16  PI-CR-CONTROL-IN-PROGRESS.
   918             20  PI-CR-CARRIER           PIC X.
   919             20  PI-CR-GROUPING          PIC X(6).
   920             20  PI-CR-STATE             PIC XX.
   921             20  PI-CR-ACCOUNT           PIC X(10).
   922             20  PI-CR-FIN-RESP          PIC X(10).
   923             20  PI-CR-TYPE              PIC X.
   924
   925         16  PI-CR-BATCH-NUMBER          PIC X(6).
   926
   927         16  PI-CR-MONTH-END-DT          PIC XX.
   928
   929         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   930             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   931             88  PI-ZERO-CARRIER             VALUE '1'.
   932             88  PI-ZERO-GROUPING            VALUE '2'.
   933             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   934
   935         16  PI-CARRIER-SECURITY         PIC X.
   936             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   937
   938         16  PI-ACCOUNT-SECURITY         PIC X(10).
   939             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   940             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  22
* EL633.cbl
   941
   942         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   943             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   944                                         INDEXED BY PI-ACCESS-NDX
   945                                         PIC X.
   946
   947         16  PI-GA-BILLING-CONTROL       PIC X.
   948             88  PI-GA-BILLING               VALUE '1'.
   949
   950         16  PI-MAIL-PROCESSING          PIC X.
   951             88  PI-MAIL-YES                 VALUE 'Y'.
   952
   953         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   954
   955         16  PI-AR-SYSTEM.
   956             20  PI-AR-PROCESSING-CNTL   PIC X.
   957                 88  PI-AR-PROCESSING        VALUE 'Y'.
   958             20  PI-AR-SUMMARY-CODE      PIC X(6).
   959             20  PI-AR-MONTH-END-DT      PIC XX.
   960
   961         16  PI-MP-SYSTEM.
   962             20  PI-MORTGAGE-USER            PIC X.
   963                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   964                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   965             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   966                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   967                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   968                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   969                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   970                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   971             20  PI-MP-MONTH-END-DT          PIC XX.
   972             20  PI-MP-REFERENCE-NO.
   973                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   974                 24  PI-MP-REFERENCE-SFX     PIC XX.
   975
   976         16  PI-LABEL-CONTROL            PIC X(01).
   977             88  PI-CREATE-LABELS                    VALUE 'Y'.
   978             88  PI-BYPASS-LABELS                    VALUE 'N'.
   979
   980         16  PI-BILL-GROUPING-CODE       PIC X(01).
   981             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   982
   983         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   984             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   985             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   986
   987         16  FILLER                      PIC X(14).
   988
   989     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   990******************************************************************
   991     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
   992         16  PI-PYAJ-FILE-SW             PIC  X.
   993             88  END-OF-ACCT                 VALUE 'A'.
   994             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
   995             88  END-OF-FILE                 VALUE 'X'.
   996             88  TOP-OF-FILE                 VALUE 'T'.
   997             88  PAGE-FULL                   VALUE 'F'.
   998             88  NO-RECORDS                  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  23
* EL633.cbl
   999             88  NOT-OPEN                    VALUE 'Z'.
  1000         16  PI-PREV-FUNCTION            PIC  X.
  1001         16  PI-SAV-FUNCTION             PIC  X.
  1002         16  PI-PREV-PFKEY               PIC  X.
  1003         16  PI-SEQ-NOS.
  1004             20  FILLER  OCCURS 13 TIMES
  1005                             INDEXED BY NDX.
  1006                 24  PI-REC-TYPE         PIC  X.
  1007                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
  1008         16  PI-SAV-ENDING-PYAJ-KEY.
  1009             20  PI-SAV-COMP-CD          PIC  X.
  1010             20  PI-SAV-COMP-CONTROL.
  1011                 24  PI-SAV-CARRIER      PIC  X.
  1012                 24  PI-SAV-GROUPING     PIC  X(6).
  1013                 24  PI-SAV-FIN-RESP     PIC  X(10).
  1014                 24  PI-SAV-ACCOUNT      PIC  X(10).
  1015                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
  1016                 24  PI-SAV-RECORD-TYPE  PIC  X.
  1017         16  PI-START-PYAJ-KEY           PIC  X(33).
  1018         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
  1019         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
  1020         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
  1021         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
  1022         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1023             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1024         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1025         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1026         16  PI-FRST-RECORD-TYPE         PIC  X.
  1027         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1028         16  PI-PREV-RECORD-TYPE         PIC  X.
  1029         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1030         16  PI-LAST-RECORD-TYPE         PIC  X.
  1031         16  PI-PAGE-SW                  PIC  X.
  1032             88  FIRST-PAGE                          VALUE 'Y'.
  1033         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  24
* EL633.cbl
  1035*                            COPY ELCJPFX.
  1036******************************************************************
  1037*                                                                *
  1038*                                                                *
  1039*                            ELCJPFX.                            *
  1040*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1041*                            VMOD=2.002                          *
  1042*                                                                *
  1043*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1044*                                                                *
  1045*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1046*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1047*        ELCNTL - CONTROL FILE                                   *
  1048*        ELMSTR - CLAIM MASTERS                                  *
  1049*        ELTRLR - ACTIVITY TRAILERS                              *
  1050*        ELCHKQ - CHECK QUE                                      *
  1051******************************************************************
  1052 01  JOURNAL-RECORD.
  1053     12  jp-date                     pic s9(5) comp-3.
  1054     12  jp-time                     pic s9(7) comp-3.
  1055     12  JP-USER-ID                  PIC X(4).
  1056     12  JP-FILE-ID                  PIC X(8).
  1057     12  JP-PROGRAM-ID               PIC X(8).
  1058     12  JP-RECORD-TYPE              PIC X.
  1059         88 JP-ADD              VALUE 'A'.
  1060         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1061         88 JP-AFTER-CHANGE     VALUE 'C'.
  1062         88 JP-DELETE           VALUE 'D'.
  1063         88 JP-GENERIC-DELETE   VALUE 'G'.
  1064         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1065         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1066     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1067     12  JP-RECORD-AREA
  1068
  1069
  1070                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  25
* EL633.cbl
  1072*                            COPY ELCAID.
  1073******************************************************************
  1074*                                                                *
  1075*                            ELCAID.                             *
  1076*                            VMOD=2.001                          *
  1077*                                                                *
  1078*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1079*                                                                *
  1080*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1081*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1082******************************************************************
  1083
  1084 01  DFHAID.
  1085   02  DFHNULL   PIC  X  VALUE  ' '.
  1086   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1087   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1088   02  DFHPEN    PIC  X  VALUE  '='.
  1089   02  DFHOPID   PIC  X  VALUE  'W'.
  1090   02  DFHPA1    PIC  X  VALUE  '%'.
  1091   02  DFHPA2    PIC  X  VALUE  '>'.
  1092   02  DFHPA3    PIC  X  VALUE  ','.
  1093   02  DFHPF1    PIC  X  VALUE  '1'.
  1094   02  DFHPF2    PIC  X  VALUE  '2'.
  1095   02  DFHPF3    PIC  X  VALUE  '3'.
  1096   02  DFHPF4    PIC  X  VALUE  '4'.
  1097   02  DFHPF5    PIC  X  VALUE  '5'.
  1098   02  DFHPF6    PIC  X  VALUE  '6'.
  1099   02  DFHPF7    PIC  X  VALUE  '7'.
  1100   02  DFHPF8    PIC  X  VALUE  '8'.
  1101   02  DFHPF9    PIC  X  VALUE  '9'.
  1102   02  DFHPF10   PIC  X  VALUE  ':'.
  1103   02  DFHPF11   PIC  X  VALUE  '#'.
  1104   02  DFHPF12   PIC  X  VALUE  '@'.
  1105   02  DFHPF13   PIC  X  VALUE  'A'.
  1106   02  DFHPF14   PIC  X  VALUE  'B'.
  1107   02  DFHPF15   PIC  X  VALUE  'C'.
  1108   02  DFHPF16   PIC  X  VALUE  'D'.
  1109   02  DFHPF17   PIC  X  VALUE  'E'.
  1110   02  DFHPF18   PIC  X  VALUE  'F'.
  1111   02  DFHPF19   PIC  X  VALUE  'G'.
  1112   02  DFHPF20   PIC  X  VALUE  'H'.
  1113   02  DFHPF21   PIC  X  VALUE  'I'.
  1114*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1115   02  DFHPF22   PIC  X  VALUE  '['.
  1116   02  DFHPF23   PIC  X  VALUE  '.'.
  1117   02  DFHPF24   PIC  X  VALUE  '<'.
  1118   02  DFHMSRE   PIC  X  VALUE  'X'.
  1119   02  DFHSTRF   PIC  X  VALUE  'h'.
  1120   02  DFHTRIG   PIC  X  VALUE  '"'.
  1121
  1122 01  FILLER  REDEFINES  DFHAID.
  1123     12  FILLER              PIC  X(8).
  1124     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  26
* EL633.cbl
  1126*                            COPY EL633S.
  1127 01  EL633AI.
  1128     05  FILLER            PIC  X(0012).
  1129*    -------------------------------
  1130     05  DATEL PIC S9(0004) COMP.
  1131     05  DATEF PIC  X(0001).
  1132     05  FILLER REDEFINES DATEF.
  1133         10  DATEA PIC  X(0001).
  1134     05  DATEI PIC  X(0008).
  1135*    -------------------------------
  1136     05  TIMEL PIC S9(0004) COMP.
  1137     05  TIMEF PIC  X(0001).
  1138     05  FILLER REDEFINES TIMEF.
  1139         10  TIMEA PIC  X(0001).
  1140     05  TIMEI PIC  X(0005).
  1141*    -------------------------------
  1142     05  CMPNYIDL PIC S9(0004) COMP.
  1143     05  CMPNYIDF PIC  X(0001).
  1144     05  FILLER REDEFINES CMPNYIDF.
  1145         10  CMPNYIDA PIC  X(0001).
  1146     05  CMPNYIDI PIC  X(0003).
  1147*    -------------------------------
  1148     05  USERIDL PIC S9(0004) COMP.
  1149     05  USERIDF PIC  X(0001).
  1150     05  FILLER REDEFINES USERIDF.
  1151         10  USERIDA PIC  X(0001).
  1152     05  USERIDI PIC  X(0004).
  1153*    -------------------------------
  1154     05  MAINTL PIC S9(0004) COMP.
  1155     05  MAINTF PIC  X(0001).
  1156     05  FILLER REDEFINES MAINTF.
  1157         10  MAINTA PIC  X(0001).
  1158     05  MAINTI PIC  X(0001).
  1159*    -------------------------------
  1160     05  CARRIERL PIC S9(0004) COMP.
  1161     05  CARRIERF PIC  X(0001).
  1162     05  FILLER REDEFINES CARRIERF.
  1163         10  CARRIERA PIC  X(0001).
  1164     05  CARRIERI PIC  X(0001).
  1165*    -------------------------------
  1166     05  GROUPL PIC S9(0004) COMP.
  1167     05  GROUPF PIC  X(0001).
  1168     05  FILLER REDEFINES GROUPF.
  1169         10  GROUPA PIC  X(0001).
  1170     05  GROUPI PIC  X(0006).
  1171*    -------------------------------
  1172     05  FINRESPL PIC S9(0004) COMP.
  1173     05  FINRESPF PIC  X(0001).
  1174     05  FILLER REDEFINES FINRESPF.
  1175         10  FINRESPA PIC  X(0001).
  1176     05  FINRESPI PIC  X(0010).
  1177*    -------------------------------
  1178     05  ACCTL PIC S9(0004) COMP.
  1179     05  ACCTF PIC  X(0001).
  1180     05  FILLER REDEFINES ACCTF.
  1181         10  ACCTA PIC  X(0001).
  1182     05  ACCTI PIC  X(0010).
  1183*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  27
* EL633.cbl
  1184     05  MSAAC1L PIC S9(0004) COMP.
  1185     05  MSAAC1F PIC  X(0001).
  1186     05  FILLER REDEFINES MSAAC1F.
  1187         10  MSAAC1A PIC  X(0001).
  1188     05  MSAAC1I PIC  X(0010).
  1189*    -------------------------------
  1190     05  MSAST1L PIC S9(0004) COMP.
  1191     05  MSAST1F PIC  X(0001).
  1192     05  FILLER REDEFINES MSAST1F.
  1193         10  MSAST1A PIC  X(0001).
  1194     05  MSAST1I PIC  X(0002).
  1195*    -------------------------------
  1196     05  MSACN1L PIC S9(0004) COMP.
  1197     05  MSACN1F PIC  X(0001).
  1198     05  FILLER REDEFINES MSACN1F.
  1199         10  MSACN1A PIC  X(0001).
  1200     05  MSACN1I PIC  X(0001).
  1201*    -------------------------------
  1202     05  MSACM1L PIC S9(0004) COMP.
  1203     05  MSACM1F PIC  X(0001).
  1204     05  FILLER REDEFINES MSACM1F.
  1205         10  MSACM1A PIC  X(0001).
  1206     05  MSACM1I PIC  X(0010).
  1207*    -------------------------------
  1208     05  TYPE1L PIC S9(0004) COMP.
  1209     05  TYPE1F PIC  X(0001).
  1210     05  FILLER REDEFINES TYPE1F.
  1211         10  TYPE1A PIC  X(0001).
  1212     05  TYPE1I PIC  X(0001).
  1213*    -------------------------------
  1214     05  AMT1L PIC S9(0004) COMP.
  1215     05  AMT1F PIC  X(0001).
  1216     05  FILLER REDEFINES AMT1F.
  1217         10  AMT1A PIC  X(0001).
  1218     05  AMT1I PIC  X(0011).
  1219*    -------------------------------
  1220     05  VOID1L PIC S9(0004) COMP.
  1221     05  VOID1F PIC  X(0001).
  1222     05  FILLER REDEFINES VOID1F.
  1223         10  VOID1A PIC  X(0001).
  1224     05  VOID1I PIC  X(0001).
  1225*    -------------------------------
  1226     05  MDT1L PIC S9(0004) COMP.
  1227     05  MDT1F PIC  X(0001).
  1228     05  FILLER REDEFINES MDT1F.
  1229         10  MDT1A PIC  X(0001).
  1230     05  MDT1I PIC  X(0006).
  1231*    -------------------------------
  1232     05  BDT1L PIC S9(0004) COMP.
  1233     05  BDT1F PIC  X(0001).
  1234     05  FILLER REDEFINES BDT1F.
  1235         10  BDT1A PIC  X(0001).
  1236     05  BDT1I PIC  X(0006).
  1237*    -------------------------------
  1238     05  SDT1L PIC S9(0004) COMP.
  1239     05  SDT1F PIC  X(0001).
  1240     05  FILLER REDEFINES SDT1F.
  1241         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  28
* EL633.cbl
  1242     05  SDT1I PIC  X(0006).
  1243*    -------------------------------
  1244     05  MSAAC2L PIC S9(0004) COMP.
  1245     05  MSAAC2F PIC  X(0001).
  1246     05  FILLER REDEFINES MSAAC2F.
  1247         10  MSAAC2A PIC  X(0001).
  1248     05  MSAAC2I PIC  X(0010).
  1249*    -------------------------------
  1250     05  MSAST2L PIC S9(0004) COMP.
  1251     05  MSAST2F PIC  X(0001).
  1252     05  FILLER REDEFINES MSAST2F.
  1253         10  MSAST2A PIC  X(0001).
  1254     05  MSAST2I PIC  X(0002).
  1255*    -------------------------------
  1256     05  MSACN2L PIC S9(0004) COMP.
  1257     05  MSACN2F PIC  X(0001).
  1258     05  FILLER REDEFINES MSACN2F.
  1259         10  MSACN2A PIC  X(0001).
  1260     05  MSACN2I PIC  X(0001).
  1261*    -------------------------------
  1262     05  MSACM2L PIC S9(0004) COMP.
  1263     05  MSACM2F PIC  X(0001).
  1264     05  FILLER REDEFINES MSACM2F.
  1265         10  MSACM2A PIC  X(0001).
  1266     05  MSACM2I PIC  X(0010).
  1267*    -------------------------------
  1268     05  TYPE2L PIC S9(0004) COMP.
  1269     05  TYPE2F PIC  X(0001).
  1270     05  FILLER REDEFINES TYPE2F.
  1271         10  TYPE2A PIC  X(0001).
  1272     05  TYPE2I PIC  X(0001).
  1273*    -------------------------------
  1274     05  AMT2L PIC S9(0004) COMP.
  1275     05  AMT2F PIC  X(0001).
  1276     05  FILLER REDEFINES AMT2F.
  1277         10  AMT2A PIC  X(0001).
  1278     05  AMT2I PIC  X(0011).
  1279*    -------------------------------
  1280     05  VOID2L PIC S9(0004) COMP.
  1281     05  VOID2F PIC  X(0001).
  1282     05  FILLER REDEFINES VOID2F.
  1283         10  VOID2A PIC  X(0001).
  1284     05  VOID2I PIC  X(0001).
  1285*    -------------------------------
  1286     05  MDT2L PIC S9(0004) COMP.
  1287     05  MDT2F PIC  X(0001).
  1288     05  FILLER REDEFINES MDT2F.
  1289         10  MDT2A PIC  X(0001).
  1290     05  MDT2I PIC  X(0006).
  1291*    -------------------------------
  1292     05  BDT2L PIC S9(0004) COMP.
  1293     05  BDT2F PIC  X(0001).
  1294     05  FILLER REDEFINES BDT2F.
  1295         10  BDT2A PIC  X(0001).
  1296     05  BDT2I PIC  X(0006).
  1297*    -------------------------------
  1298     05  SDT2L PIC S9(0004) COMP.
  1299     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  29
* EL633.cbl
  1300     05  FILLER REDEFINES SDT2F.
  1301         10  SDT2A PIC  X(0001).
  1302     05  SDT2I PIC  X(0006).
  1303*    -------------------------------
  1304     05  MSAAC3L PIC S9(0004) COMP.
  1305     05  MSAAC3F PIC  X(0001).
  1306     05  FILLER REDEFINES MSAAC3F.
  1307         10  MSAAC3A PIC  X(0001).
  1308     05  MSAAC3I PIC  X(0010).
  1309*    -------------------------------
  1310     05  MSAST3L PIC S9(0004) COMP.
  1311     05  MSAST3F PIC  X(0001).
  1312     05  FILLER REDEFINES MSAST3F.
  1313         10  MSAST3A PIC  X(0001).
  1314     05  MSAST3I PIC  X(0002).
  1315*    -------------------------------
  1316     05  MSACN3L PIC S9(0004) COMP.
  1317     05  MSACN3F PIC  X(0001).
  1318     05  FILLER REDEFINES MSACN3F.
  1319         10  MSACN3A PIC  X(0001).
  1320     05  MSACN3I PIC  X(0001).
  1321*    -------------------------------
  1322     05  MSACM3L PIC S9(0004) COMP.
  1323     05  MSACM3F PIC  X(0001).
  1324     05  FILLER REDEFINES MSACM3F.
  1325         10  MSACM3A PIC  X(0001).
  1326     05  MSACM3I PIC  X(0010).
  1327*    -------------------------------
  1328     05  TYPE3L PIC S9(0004) COMP.
  1329     05  TYPE3F PIC  X(0001).
  1330     05  FILLER REDEFINES TYPE3F.
  1331         10  TYPE3A PIC  X(0001).
  1332     05  TYPE3I PIC  X(0001).
  1333*    -------------------------------
  1334     05  AMT3L PIC S9(0004) COMP.
  1335     05  AMT3F PIC  X(0001).
  1336     05  FILLER REDEFINES AMT3F.
  1337         10  AMT3A PIC  X(0001).
  1338     05  AMT3I PIC  X(0011).
  1339*    -------------------------------
  1340     05  VOID3L PIC S9(0004) COMP.
  1341     05  VOID3F PIC  X(0001).
  1342     05  FILLER REDEFINES VOID3F.
  1343         10  VOID3A PIC  X(0001).
  1344     05  VOID3I PIC  X(0001).
  1345*    -------------------------------
  1346     05  MDT3L PIC S9(0004) COMP.
  1347     05  MDT3F PIC  X(0001).
  1348     05  FILLER REDEFINES MDT3F.
  1349         10  MDT3A PIC  X(0001).
  1350     05  MDT3I PIC  X(0006).
  1351*    -------------------------------
  1352     05  BDT3L PIC S9(0004) COMP.
  1353     05  BDT3F PIC  X(0001).
  1354     05  FILLER REDEFINES BDT3F.
  1355         10  BDT3A PIC  X(0001).
  1356     05  BDT3I PIC  X(0006).
  1357*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  30
* EL633.cbl
  1358     05  SDT3L PIC S9(0004) COMP.
  1359     05  SDT3F PIC  X(0001).
  1360     05  FILLER REDEFINES SDT3F.
  1361         10  SDT3A PIC  X(0001).
  1362     05  SDT3I PIC  X(0006).
  1363*    -------------------------------
  1364     05  MSAAC4L PIC S9(0004) COMP.
  1365     05  MSAAC4F PIC  X(0001).
  1366     05  FILLER REDEFINES MSAAC4F.
  1367         10  MSAAC4A PIC  X(0001).
  1368     05  MSAAC4I PIC  X(0010).
  1369*    -------------------------------
  1370     05  MSAST4L PIC S9(0004) COMP.
  1371     05  MSAST4F PIC  X(0001).
  1372     05  FILLER REDEFINES MSAST4F.
  1373         10  MSAST4A PIC  X(0001).
  1374     05  MSAST4I PIC  X(0002).
  1375*    -------------------------------
  1376     05  MSACN4L PIC S9(0004) COMP.
  1377     05  MSACN4F PIC  X(0001).
  1378     05  FILLER REDEFINES MSACN4F.
  1379         10  MSACN4A PIC  X(0001).
  1380     05  MSACN4I PIC  X(0001).
  1381*    -------------------------------
  1382     05  MSACM4L PIC S9(0004) COMP.
  1383     05  MSACM4F PIC  X(0001).
  1384     05  FILLER REDEFINES MSACM4F.
  1385         10  MSACM4A PIC  X(0001).
  1386     05  MSACM4I PIC  X(0010).
  1387*    -------------------------------
  1388     05  TYPE4L PIC S9(0004) COMP.
  1389     05  TYPE4F PIC  X(0001).
  1390     05  FILLER REDEFINES TYPE4F.
  1391         10  TYPE4A PIC  X(0001).
  1392     05  TYPE4I PIC  X(0001).
  1393*    -------------------------------
  1394     05  AMT4L PIC S9(0004) COMP.
  1395     05  AMT4F PIC  X(0001).
  1396     05  FILLER REDEFINES AMT4F.
  1397         10  AMT4A PIC  X(0001).
  1398     05  AMT4I PIC  X(0011).
  1399*    -------------------------------
  1400     05  VOID4L PIC S9(0004) COMP.
  1401     05  VOID4F PIC  X(0001).
  1402     05  FILLER REDEFINES VOID4F.
  1403         10  VOID4A PIC  X(0001).
  1404     05  VOID4I PIC  X(0001).
  1405*    -------------------------------
  1406     05  MDT4L PIC S9(0004) COMP.
  1407     05  MDT4F PIC  X(0001).
  1408     05  FILLER REDEFINES MDT4F.
  1409         10  MDT4A PIC  X(0001).
  1410     05  MDT4I PIC  X(0006).
  1411*    -------------------------------
  1412     05  BDT4L PIC S9(0004) COMP.
  1413     05  BDT4F PIC  X(0001).
  1414     05  FILLER REDEFINES BDT4F.
  1415         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  31
* EL633.cbl
  1416     05  BDT4I PIC  X(0006).
  1417*    -------------------------------
  1418     05  SDT4L PIC S9(0004) COMP.
  1419     05  SDT4F PIC  X(0001).
  1420     05  FILLER REDEFINES SDT4F.
  1421         10  SDT4A PIC  X(0001).
  1422     05  SDT4I PIC  X(0006).
  1423*    -------------------------------
  1424     05  MSAAC5L PIC S9(0004) COMP.
  1425     05  MSAAC5F PIC  X(0001).
  1426     05  FILLER REDEFINES MSAAC5F.
  1427         10  MSAAC5A PIC  X(0001).
  1428     05  MSAAC5I PIC  X(0010).
  1429*    -------------------------------
  1430     05  MSAST5L PIC S9(0004) COMP.
  1431     05  MSAST5F PIC  X(0001).
  1432     05  FILLER REDEFINES MSAST5F.
  1433         10  MSAST5A PIC  X(0001).
  1434     05  MSAST5I PIC  X(0002).
  1435*    -------------------------------
  1436     05  MSACN5L PIC S9(0004) COMP.
  1437     05  MSACN5F PIC  X(0001).
  1438     05  FILLER REDEFINES MSACN5F.
  1439         10  MSACN5A PIC  X(0001).
  1440     05  MSACN5I PIC  X(0001).
  1441*    -------------------------------
  1442     05  MSACM5L PIC S9(0004) COMP.
  1443     05  MSACM5F PIC  X(0001).
  1444     05  FILLER REDEFINES MSACM5F.
  1445         10  MSACM5A PIC  X(0001).
  1446     05  MSACM5I PIC  X(0010).
  1447*    -------------------------------
  1448     05  TYPE5L PIC S9(0004) COMP.
  1449     05  TYPE5F PIC  X(0001).
  1450     05  FILLER REDEFINES TYPE5F.
  1451         10  TYPE5A PIC  X(0001).
  1452     05  TYPE5I PIC  X(0001).
  1453*    -------------------------------
  1454     05  AMT5L PIC S9(0004) COMP.
  1455     05  AMT5F PIC  X(0001).
  1456     05  FILLER REDEFINES AMT5F.
  1457         10  AMT5A PIC  X(0001).
  1458     05  AMT5I PIC  X(0011).
  1459*    -------------------------------
  1460     05  VOID5L PIC S9(0004) COMP.
  1461     05  VOID5F PIC  X(0001).
  1462     05  FILLER REDEFINES VOID5F.
  1463         10  VOID5A PIC  X(0001).
  1464     05  VOID5I PIC  X(0001).
  1465*    -------------------------------
  1466     05  MDT5L PIC S9(0004) COMP.
  1467     05  MDT5F PIC  X(0001).
  1468     05  FILLER REDEFINES MDT5F.
  1469         10  MDT5A PIC  X(0001).
  1470     05  MDT5I PIC  X(0006).
  1471*    -------------------------------
  1472     05  BDT5L PIC S9(0004) COMP.
  1473     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  32
* EL633.cbl
  1474     05  FILLER REDEFINES BDT5F.
  1475         10  BDT5A PIC  X(0001).
  1476     05  BDT5I PIC  X(0006).
  1477*    -------------------------------
  1478     05  SDT5L PIC S9(0004) COMP.
  1479     05  SDT5F PIC  X(0001).
  1480     05  FILLER REDEFINES SDT5F.
  1481         10  SDT5A PIC  X(0001).
  1482     05  SDT5I PIC  X(0006).
  1483*    -------------------------------
  1484     05  MSAAC6L PIC S9(0004) COMP.
  1485     05  MSAAC6F PIC  X(0001).
  1486     05  FILLER REDEFINES MSAAC6F.
  1487         10  MSAAC6A PIC  X(0001).
  1488     05  MSAAC6I PIC  X(0010).
  1489*    -------------------------------
  1490     05  MSAST6L PIC S9(0004) COMP.
  1491     05  MSAST6F PIC  X(0001).
  1492     05  FILLER REDEFINES MSAST6F.
  1493         10  MSAST6A PIC  X(0001).
  1494     05  MSAST6I PIC  X(0002).
  1495*    -------------------------------
  1496     05  MSACN6L PIC S9(0004) COMP.
  1497     05  MSACN6F PIC  X(0001).
  1498     05  FILLER REDEFINES MSACN6F.
  1499         10  MSACN6A PIC  X(0001).
  1500     05  MSACN6I PIC  X(0001).
  1501*    -------------------------------
  1502     05  MSACM6L PIC S9(0004) COMP.
  1503     05  MSACM6F PIC  X(0001).
  1504     05  FILLER REDEFINES MSACM6F.
  1505         10  MSACM6A PIC  X(0001).
  1506     05  MSACM6I PIC  X(0010).
  1507*    -------------------------------
  1508     05  TYPE6L PIC S9(0004) COMP.
  1509     05  TYPE6F PIC  X(0001).
  1510     05  FILLER REDEFINES TYPE6F.
  1511         10  TYPE6A PIC  X(0001).
  1512     05  TYPE6I PIC  X(0001).
  1513*    -------------------------------
  1514     05  AMT6L PIC S9(0004) COMP.
  1515     05  AMT6F PIC  X(0001).
  1516     05  FILLER REDEFINES AMT6F.
  1517         10  AMT6A PIC  X(0001).
  1518     05  AMT6I PIC  X(0011).
  1519*    -------------------------------
  1520     05  VOID6L PIC S9(0004) COMP.
  1521     05  VOID6F PIC  X(0001).
  1522     05  FILLER REDEFINES VOID6F.
  1523         10  VOID6A PIC  X(0001).
  1524     05  VOID6I PIC  X(0001).
  1525*    -------------------------------
  1526     05  MDT6L PIC S9(0004) COMP.
  1527     05  MDT6F PIC  X(0001).
  1528     05  FILLER REDEFINES MDT6F.
  1529         10  MDT6A PIC  X(0001).
  1530     05  MDT6I PIC  X(0006).
  1531*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  33
* EL633.cbl
  1532     05  BDT6L PIC S9(0004) COMP.
  1533     05  BDT6F PIC  X(0001).
  1534     05  FILLER REDEFINES BDT6F.
  1535         10  BDT6A PIC  X(0001).
  1536     05  BDT6I PIC  X(0006).
  1537*    -------------------------------
  1538     05  SDT6L PIC S9(0004) COMP.
  1539     05  SDT6F PIC  X(0001).
  1540     05  FILLER REDEFINES SDT6F.
  1541         10  SDT6A PIC  X(0001).
  1542     05  SDT6I PIC  X(0006).
  1543*    -------------------------------
  1544     05  MSAAC7L PIC S9(0004) COMP.
  1545     05  MSAAC7F PIC  X(0001).
  1546     05  FILLER REDEFINES MSAAC7F.
  1547         10  MSAAC7A PIC  X(0001).
  1548     05  MSAAC7I PIC  X(0010).
  1549*    -------------------------------
  1550     05  MSAST7L PIC S9(0004) COMP.
  1551     05  MSAST7F PIC  X(0001).
  1552     05  FILLER REDEFINES MSAST7F.
  1553         10  MSAST7A PIC  X(0001).
  1554     05  MSAST7I PIC  X(0002).
  1555*    -------------------------------
  1556     05  MSACN7L PIC S9(0004) COMP.
  1557     05  MSACN7F PIC  X(0001).
  1558     05  FILLER REDEFINES MSACN7F.
  1559         10  MSACN7A PIC  X(0001).
  1560     05  MSACN7I PIC  X(0001).
  1561*    -------------------------------
  1562     05  MSACM7L PIC S9(0004) COMP.
  1563     05  MSACM7F PIC  X(0001).
  1564     05  FILLER REDEFINES MSACM7F.
  1565         10  MSACM7A PIC  X(0001).
  1566     05  MSACM7I PIC  X(0010).
  1567*    -------------------------------
  1568     05  TYPE7L PIC S9(0004) COMP.
  1569     05  TYPE7F PIC  X(0001).
  1570     05  FILLER REDEFINES TYPE7F.
  1571         10  TYPE7A PIC  X(0001).
  1572     05  TYPE7I PIC  X(0001).
  1573*    -------------------------------
  1574     05  AMT7L PIC S9(0004) COMP.
  1575     05  AMT7F PIC  X(0001).
  1576     05  FILLER REDEFINES AMT7F.
  1577         10  AMT7A PIC  X(0001).
  1578     05  AMT7I PIC  X(0011).
  1579*    -------------------------------
  1580     05  VOID7L PIC S9(0004) COMP.
  1581     05  VOID7F PIC  X(0001).
  1582     05  FILLER REDEFINES VOID7F.
  1583         10  VOID7A PIC  X(0001).
  1584     05  VOID7I PIC  X(0001).
  1585*    -------------------------------
  1586     05  MDT7L PIC S9(0004) COMP.
  1587     05  MDT7F PIC  X(0001).
  1588     05  FILLER REDEFINES MDT7F.
  1589         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  34
* EL633.cbl
  1590     05  MDT7I PIC  X(0006).
  1591*    -------------------------------
  1592     05  BDT7L PIC S9(0004) COMP.
  1593     05  BDT7F PIC  X(0001).
  1594     05  FILLER REDEFINES BDT7F.
  1595         10  BDT7A PIC  X(0001).
  1596     05  BDT7I PIC  X(0006).
  1597*    -------------------------------
  1598     05  SDT7L PIC S9(0004) COMP.
  1599     05  SDT7F PIC  X(0001).
  1600     05  FILLER REDEFINES SDT7F.
  1601         10  SDT7A PIC  X(0001).
  1602     05  SDT7I PIC  X(0006).
  1603*    -------------------------------
  1604     05  MSAAC8L PIC S9(0004) COMP.
  1605     05  MSAAC8F PIC  X(0001).
  1606     05  FILLER REDEFINES MSAAC8F.
  1607         10  MSAAC8A PIC  X(0001).
  1608     05  MSAAC8I PIC  X(0010).
  1609*    -------------------------------
  1610     05  MSAST8L PIC S9(0004) COMP.
  1611     05  MSAST8F PIC  X(0001).
  1612     05  FILLER REDEFINES MSAST8F.
  1613         10  MSAST8A PIC  X(0001).
  1614     05  MSAST8I PIC  X(0002).
  1615*    -------------------------------
  1616     05  MSACN8L PIC S9(0004) COMP.
  1617     05  MSACN8F PIC  X(0001).
  1618     05  FILLER REDEFINES MSACN8F.
  1619         10  MSACN8A PIC  X(0001).
  1620     05  MSACN8I PIC  X(0001).
  1621*    -------------------------------
  1622     05  MSACM8L PIC S9(0004) COMP.
  1623     05  MSACM8F PIC  X(0001).
  1624     05  FILLER REDEFINES MSACM8F.
  1625         10  MSACM8A PIC  X(0001).
  1626     05  MSACM8I PIC  X(0010).
  1627*    -------------------------------
  1628     05  TYPE8L PIC S9(0004) COMP.
  1629     05  TYPE8F PIC  X(0001).
  1630     05  FILLER REDEFINES TYPE8F.
  1631         10  TYPE8A PIC  X(0001).
  1632     05  TYPE8I PIC  X(0001).
  1633*    -------------------------------
  1634     05  AMT8L PIC S9(0004) COMP.
  1635     05  AMT8F PIC  X(0001).
  1636     05  FILLER REDEFINES AMT8F.
  1637         10  AMT8A PIC  X(0001).
  1638     05  AMT8I PIC  X(0011).
  1639*    -------------------------------
  1640     05  VOID8L PIC S9(0004) COMP.
  1641     05  VOID8F PIC  X(0001).
  1642     05  FILLER REDEFINES VOID8F.
  1643         10  VOID8A PIC  X(0001).
  1644     05  VOID8I PIC  X(0001).
  1645*    -------------------------------
  1646     05  MDT8L PIC S9(0004) COMP.
  1647     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  35
* EL633.cbl
  1648     05  FILLER REDEFINES MDT8F.
  1649         10  MDT8A PIC  X(0001).
  1650     05  MDT8I PIC  X(0006).
  1651*    -------------------------------
  1652     05  BDT8L PIC S9(0004) COMP.
  1653     05  BDT8F PIC  X(0001).
  1654     05  FILLER REDEFINES BDT8F.
  1655         10  BDT8A PIC  X(0001).
  1656     05  BDT8I PIC  X(0006).
  1657*    -------------------------------
  1658     05  SDT8L PIC S9(0004) COMP.
  1659     05  SDT8F PIC  X(0001).
  1660     05  FILLER REDEFINES SDT8F.
  1661         10  SDT8A PIC  X(0001).
  1662     05  SDT8I PIC  X(0006).
  1663*    -------------------------------
  1664     05  MSAAC9L PIC S9(0004) COMP.
  1665     05  MSAAC9F PIC  X(0001).
  1666     05  FILLER REDEFINES MSAAC9F.
  1667         10  MSAAC9A PIC  X(0001).
  1668     05  MSAAC9I PIC  X(0010).
  1669*    -------------------------------
  1670     05  MSAST9L PIC S9(0004) COMP.
  1671     05  MSAST9F PIC  X(0001).
  1672     05  FILLER REDEFINES MSAST9F.
  1673         10  MSAST9A PIC  X(0001).
  1674     05  MSAST9I PIC  X(0002).
  1675*    -------------------------------
  1676     05  MSACN9L PIC S9(0004) COMP.
  1677     05  MSACN9F PIC  X(0001).
  1678     05  FILLER REDEFINES MSACN9F.
  1679         10  MSACN9A PIC  X(0001).
  1680     05  MSACN9I PIC  X(0001).
  1681*    -------------------------------
  1682     05  MSACM9L PIC S9(0004) COMP.
  1683     05  MSACM9F PIC  X(0001).
  1684     05  FILLER REDEFINES MSACM9F.
  1685         10  MSACM9A PIC  X(0001).
  1686     05  MSACM9I PIC  X(0010).
  1687*    -------------------------------
  1688     05  TYPE9L PIC S9(0004) COMP.
  1689     05  TYPE9F PIC  X(0001).
  1690     05  FILLER REDEFINES TYPE9F.
  1691         10  TYPE9A PIC  X(0001).
  1692     05  TYPE9I PIC  X(0001).
  1693*    -------------------------------
  1694     05  AMT9L PIC S9(0004) COMP.
  1695     05  AMT9F PIC  X(0001).
  1696     05  FILLER REDEFINES AMT9F.
  1697         10  AMT9A PIC  X(0001).
  1698     05  AMT9I PIC  X(0011).
  1699*    -------------------------------
  1700     05  VOID9L PIC S9(0004) COMP.
  1701     05  VOID9F PIC  X(0001).
  1702     05  FILLER REDEFINES VOID9F.
  1703         10  VOID9A PIC  X(0001).
  1704     05  VOID9I PIC  X(0001).
  1705*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  36
* EL633.cbl
  1706     05  MDT9L PIC S9(0004) COMP.
  1707     05  MDT9F PIC  X(0001).
  1708     05  FILLER REDEFINES MDT9F.
  1709         10  MDT9A PIC  X(0001).
  1710     05  MDT9I PIC  X(0006).
  1711*    -------------------------------
  1712     05  BDT9L PIC S9(0004) COMP.
  1713     05  BDT9F PIC  X(0001).
  1714     05  FILLER REDEFINES BDT9F.
  1715         10  BDT9A PIC  X(0001).
  1716     05  BDT9I PIC  X(0006).
  1717*    -------------------------------
  1718     05  SDT9L PIC S9(0004) COMP.
  1719     05  SDT9F PIC  X(0001).
  1720     05  FILLER REDEFINES SDT9F.
  1721         10  SDT9A PIC  X(0001).
  1722     05  SDT9I PIC  X(0006).
  1723*    -------------------------------
  1724     05  MSAAC10L PIC S9(0004) COMP.
  1725     05  MSAAC10F PIC  X(0001).
  1726     05  FILLER REDEFINES MSAAC10F.
  1727         10  MSAAC10A PIC  X(0001).
  1728     05  MSAAC10I PIC  X(0010).
  1729*    -------------------------------
  1730     05  MSAST10L PIC S9(0004) COMP.
  1731     05  MSAST10F PIC  X(0001).
  1732     05  FILLER REDEFINES MSAST10F.
  1733         10  MSAST10A PIC  X(0001).
  1734     05  MSAST10I PIC  X(0002).
  1735*    -------------------------------
  1736     05  MSACN10L PIC S9(0004) COMP.
  1737     05  MSACN10F PIC  X(0001).
  1738     05  FILLER REDEFINES MSACN10F.
  1739         10  MSACN10A PIC  X(0001).
  1740     05  MSACN10I PIC  X(0001).
  1741*    -------------------------------
  1742     05  MSACM10L PIC S9(0004) COMP.
  1743     05  MSACM10F PIC  X(0001).
  1744     05  FILLER REDEFINES MSACM10F.
  1745         10  MSACM10A PIC  X(0001).
  1746     05  MSACM10I PIC  X(0010).
  1747*    -------------------------------
  1748     05  TYPE10L PIC S9(0004) COMP.
  1749     05  TYPE10F PIC  X(0001).
  1750     05  FILLER REDEFINES TYPE10F.
  1751         10  TYPE10A PIC  X(0001).
  1752     05  TYPE10I PIC  X(0001).
  1753*    -------------------------------
  1754     05  AMT10L PIC S9(0004) COMP.
  1755     05  AMT10F PIC  X(0001).
  1756     05  FILLER REDEFINES AMT10F.
  1757         10  AMT10A PIC  X(0001).
  1758     05  AMT10I PIC  X(0011).
  1759*    -------------------------------
  1760     05  VOID10L PIC S9(0004) COMP.
  1761     05  VOID10F PIC  X(0001).
  1762     05  FILLER REDEFINES VOID10F.
  1763         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  37
* EL633.cbl
  1764     05  VOID10I PIC  X(0001).
  1765*    -------------------------------
  1766     05  MDT10L PIC S9(0004) COMP.
  1767     05  MDT10F PIC  X(0001).
  1768     05  FILLER REDEFINES MDT10F.
  1769         10  MDT10A PIC  X(0001).
  1770     05  MDT10I PIC  X(0006).
  1771*    -------------------------------
  1772     05  BDT10L PIC S9(0004) COMP.
  1773     05  BDT10F PIC  X(0001).
  1774     05  FILLER REDEFINES BDT10F.
  1775         10  BDT10A PIC  X(0001).
  1776     05  BDT10I PIC  X(0006).
  1777*    -------------------------------
  1778     05  SDT10L PIC S9(0004) COMP.
  1779     05  SDT10F PIC  X(0001).
  1780     05  FILLER REDEFINES SDT10F.
  1781         10  SDT10A PIC  X(0001).
  1782     05  SDT10I PIC  X(0006).
  1783*    -------------------------------
  1784     05  MSAAC11L PIC S9(0004) COMP.
  1785     05  MSAAC11F PIC  X(0001).
  1786     05  FILLER REDEFINES MSAAC11F.
  1787         10  MSAAC11A PIC  X(0001).
  1788     05  MSAAC11I PIC  X(0010).
  1789*    -------------------------------
  1790     05  MSAST11L PIC S9(0004) COMP.
  1791     05  MSAST11F PIC  X(0001).
  1792     05  FILLER REDEFINES MSAST11F.
  1793         10  MSAST11A PIC  X(0001).
  1794     05  MSAST11I PIC  X(0002).
  1795*    -------------------------------
  1796     05  MSACN11L PIC S9(0004) COMP.
  1797     05  MSACN11F PIC  X(0001).
  1798     05  FILLER REDEFINES MSACN11F.
  1799         10  MSACN11A PIC  X(0001).
  1800     05  MSACN11I PIC  X(0001).
  1801*    -------------------------------
  1802     05  MSACM11L PIC S9(0004) COMP.
  1803     05  MSACM11F PIC  X(0001).
  1804     05  FILLER REDEFINES MSACM11F.
  1805         10  MSACM11A PIC  X(0001).
  1806     05  MSACM11I PIC  X(0010).
  1807*    -------------------------------
  1808     05  TYPE11L PIC S9(0004) COMP.
  1809     05  TYPE11F PIC  X(0001).
  1810     05  FILLER REDEFINES TYPE11F.
  1811         10  TYPE11A PIC  X(0001).
  1812     05  TYPE11I PIC  X(0001).
  1813*    -------------------------------
  1814     05  AMT11L PIC S9(0004) COMP.
  1815     05  AMT11F PIC  X(0001).
  1816     05  FILLER REDEFINES AMT11F.
  1817         10  AMT11A PIC  X(0001).
  1818     05  AMT11I PIC  X(0011).
  1819*    -------------------------------
  1820     05  VOID11L PIC S9(0004) COMP.
  1821     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  38
* EL633.cbl
  1822     05  FILLER REDEFINES VOID11F.
  1823         10  VOID11A PIC  X(0001).
  1824     05  VOID11I PIC  X(0001).
  1825*    -------------------------------
  1826     05  MDT11L PIC S9(0004) COMP.
  1827     05  MDT11F PIC  X(0001).
  1828     05  FILLER REDEFINES MDT11F.
  1829         10  MDT11A PIC  X(0001).
  1830     05  MDT11I PIC  X(0006).
  1831*    -------------------------------
  1832     05  BDT11L PIC S9(0004) COMP.
  1833     05  BDT11F PIC  X(0001).
  1834     05  FILLER REDEFINES BDT11F.
  1835         10  BDT11A PIC  X(0001).
  1836     05  BDT11I PIC  X(0006).
  1837*    -------------------------------
  1838     05  SDT11L PIC S9(0004) COMP.
  1839     05  SDT11F PIC  X(0001).
  1840     05  FILLER REDEFINES SDT11F.
  1841         10  SDT11A PIC  X(0001).
  1842     05  SDT11I PIC  X(0006).
  1843*    -------------------------------
  1844     05  MSAAC12L PIC S9(0004) COMP.
  1845     05  MSAAC12F PIC  X(0001).
  1846     05  FILLER REDEFINES MSAAC12F.
  1847         10  MSAAC12A PIC  X(0001).
  1848     05  MSAAC12I PIC  X(0010).
  1849*    -------------------------------
  1850     05  MSAST12L PIC S9(0004) COMP.
  1851     05  MSAST12F PIC  X(0001).
  1852     05  FILLER REDEFINES MSAST12F.
  1853         10  MSAST12A PIC  X(0001).
  1854     05  MSAST12I PIC  X(0002).
  1855*    -------------------------------
  1856     05  MSACN12L PIC S9(0004) COMP.
  1857     05  MSACN12F PIC  X(0001).
  1858     05  FILLER REDEFINES MSACN12F.
  1859         10  MSACN12A PIC  X(0001).
  1860     05  MSACN12I PIC  X(0001).
  1861*    -------------------------------
  1862     05  MSACM12L PIC S9(0004) COMP.
  1863     05  MSACM12F PIC  X(0001).
  1864     05  FILLER REDEFINES MSACM12F.
  1865         10  MSACM12A PIC  X(0001).
  1866     05  MSACM12I PIC  X(0010).
  1867*    -------------------------------
  1868     05  TYPE12L PIC S9(0004) COMP.
  1869     05  TYPE12F PIC  X(0001).
  1870     05  FILLER REDEFINES TYPE12F.
  1871         10  TYPE12A PIC  X(0001).
  1872     05  TYPE12I PIC  X(0001).
  1873*    -------------------------------
  1874     05  AMT12L PIC S9(0004) COMP.
  1875     05  AMT12F PIC  X(0001).
  1876     05  FILLER REDEFINES AMT12F.
  1877         10  AMT12A PIC  X(0001).
  1878     05  AMT12I PIC  X(0011).
  1879*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  39
* EL633.cbl
  1880     05  VOID12L PIC S9(0004) COMP.
  1881     05  VOID12F PIC  X(0001).
  1882     05  FILLER REDEFINES VOID12F.
  1883         10  VOID12A PIC  X(0001).
  1884     05  VOID12I PIC  X(0001).
  1885*    -------------------------------
  1886     05  MDT12L PIC S9(0004) COMP.
  1887     05  MDT12F PIC  X(0001).
  1888     05  FILLER REDEFINES MDT12F.
  1889         10  MDT12A PIC  X(0001).
  1890     05  MDT12I PIC  X(0006).
  1891*    -------------------------------
  1892     05  BDT12L PIC S9(0004) COMP.
  1893     05  BDT12F PIC  X(0001).
  1894     05  FILLER REDEFINES BDT12F.
  1895         10  BDT12A PIC  X(0001).
  1896     05  BDT12I PIC  X(0006).
  1897*    -------------------------------
  1898     05  SDT12L PIC S9(0004) COMP.
  1899     05  SDT12F PIC  X(0001).
  1900     05  FILLER REDEFINES SDT12F.
  1901         10  SDT12A PIC  X(0001).
  1902     05  SDT12I PIC  X(0006).
  1903*    -------------------------------
  1904     05  MSAAC13L PIC S9(0004) COMP.
  1905     05  MSAAC13F PIC  X(0001).
  1906     05  FILLER REDEFINES MSAAC13F.
  1907         10  MSAAC13A PIC  X(0001).
  1908     05  MSAAC13I PIC  X(0010).
  1909*    -------------------------------
  1910     05  MSAST13L PIC S9(0004) COMP.
  1911     05  MSAST13F PIC  X(0001).
  1912     05  FILLER REDEFINES MSAST13F.
  1913         10  MSAST13A PIC  X(0001).
  1914     05  MSAST13I PIC  X(0002).
  1915*    -------------------------------
  1916     05  MSACN13L PIC S9(0004) COMP.
  1917     05  MSACN13F PIC  X(0001).
  1918     05  FILLER REDEFINES MSACN13F.
  1919         10  MSACN13A PIC  X(0001).
  1920     05  MSACN13I PIC  X(0001).
  1921*    -------------------------------
  1922     05  MSACM13L PIC S9(0004) COMP.
  1923     05  MSACM13F PIC  X(0001).
  1924     05  FILLER REDEFINES MSACM13F.
  1925         10  MSACM13A PIC  X(0001).
  1926     05  MSACM13I PIC  X(0010).
  1927*    -------------------------------
  1928     05  TYPE13L PIC S9(0004) COMP.
  1929     05  TYPE13F PIC  X(0001).
  1930     05  FILLER REDEFINES TYPE13F.
  1931         10  TYPE13A PIC  X(0001).
  1932     05  TYPE13I PIC  X(0001).
  1933*    -------------------------------
  1934     05  AMT13L PIC S9(0004) COMP.
  1935     05  AMT13F PIC  X(0001).
  1936     05  FILLER REDEFINES AMT13F.
  1937         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  40
* EL633.cbl
  1938     05  AMT13I PIC  X(0011).
  1939*    -------------------------------
  1940     05  VOID13L PIC S9(0004) COMP.
  1941     05  VOID13F PIC  X(0001).
  1942     05  FILLER REDEFINES VOID13F.
  1943         10  VOID13A PIC  X(0001).
  1944     05  VOID13I PIC  X(0001).
  1945*    -------------------------------
  1946     05  MDT13L PIC S9(0004) COMP.
  1947     05  MDT13F PIC  X(0001).
  1948     05  FILLER REDEFINES MDT13F.
  1949         10  MDT13A PIC  X(0001).
  1950     05  MDT13I PIC  X(0006).
  1951*    -------------------------------
  1952     05  BDT13L PIC S9(0004) COMP.
  1953     05  BDT13F PIC  X(0001).
  1954     05  FILLER REDEFINES BDT13F.
  1955         10  BDT13A PIC  X(0001).
  1956     05  BDT13I PIC  X(0006).
  1957*    -------------------------------
  1958     05  SDT13L PIC S9(0004) COMP.
  1959     05  SDT13F PIC  X(0001).
  1960     05  FILLER REDEFINES SDT13F.
  1961         10  SDT13A PIC  X(0001).
  1962     05  SDT13I PIC  X(0006).
  1963*    -------------------------------
  1964     05  ERRMSG1L PIC S9(0004) COMP.
  1965     05  ERRMSG1F PIC  X(0001).
  1966     05  FILLER REDEFINES ERRMSG1F.
  1967         10  ERRMSG1A PIC  X(0001).
  1968     05  ERRMSG1I PIC  X(0079).
  1969*    -------------------------------
  1970     05  ERRMSG2L PIC S9(0004) COMP.
  1971     05  ERRMSG2F PIC  X(0001).
  1972     05  FILLER REDEFINES ERRMSG2F.
  1973         10  ERRMSG2A PIC  X(0001).
  1974     05  ERRMSG2I PIC  X(0079).
  1975*    -------------------------------
  1976     05  PFENTERL PIC S9(0004) COMP.
  1977     05  PFENTERF PIC  X(0001).
  1978     05  FILLER REDEFINES PFENTERF.
  1979         10  PFENTERA PIC  X(0001).
  1980     05  PFENTERI PIC  9(2).
  1981 01  EL633AO REDEFINES EL633AI.
  1982     05  FILLER            PIC  X(0012).
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  DATEO PIC  X(0008).
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  TIMEO PIC  99.99.
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
  1991     05  CMPNYIDO PIC  X(0003).
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  USERIDO PIC  X(0004).
  1995*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  41
* EL633.cbl
  1996     05  FILLER            PIC  X(0003).
  1997     05  MAINTO PIC  X(0001).
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  CARRIERO PIC  X(0001).
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  GROUPO PIC  X(0006).
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  FINRESPO PIC  X(0010).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  ACCTO PIC  X(0010).
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  MSAAC1O PIC  X(0010).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  MSAST1O PIC  X(0002).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  MSACN1O PIC  X(0001).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  MSACM1O PIC  X(0010).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  TYPE1O PIC  X(0001).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  AMT1O PIC  X(0011).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  VOID1O PIC  X(0001).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  MDT1O PIC  X(0006).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  BDT1O PIC  X(0006).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  SDT1O PIC  X(0006).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  MSAAC2O PIC  X(0010).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  MSAST2O PIC  X(0002).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  MSACN2O PIC  X(0001).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  MSACM2O PIC  X(0010).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  42
* EL633.cbl
  2054     05  TYPE2O PIC  X(0001).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  AMT2O PIC  X(0011).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  VOID2O PIC  X(0001).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  MDT2O PIC  X(0006).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  BDT2O PIC  X(0006).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  SDT2O PIC  X(0006).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  MSAAC3O PIC  X(0010).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  MSAST3O PIC  X(0002).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  MSACN3O PIC  X(0001).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  MSACM3O PIC  X(0010).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  TYPE3O PIC  X(0001).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  AMT3O PIC  X(0011).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  VOID3O PIC  X(0001).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  MDT3O PIC  X(0006).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  BDT3O PIC  X(0006).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  SDT3O PIC  X(0006).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  MSAAC4O PIC  X(0010).
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  MSAST4O PIC  X(0002).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  MSACN4O PIC  X(0001).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  43
* EL633.cbl
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  TYPE4O PIC  X(0001).
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  AMT4O PIC  X(0011).
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  VOID4O PIC  X(0001).
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  MDT4O PIC  X(0006).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  BDT4O PIC  X(0006).
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  SDT4O PIC  X(0006).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  MSAAC5O PIC  X(0010).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  MSAST5O PIC  X(0002).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  MSACN5O PIC  X(0001).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  MSACM5O PIC  X(0010).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  TYPE5O PIC  X(0001).
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  AMT5O PIC  X(0011).
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  VOID5O PIC  X(0001).
  2151*    -------------------------------
  2152     05  FILLER            PIC  X(0003).
  2153     05  MDT5O PIC  X(0006).
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  BDT5O PIC  X(0006).
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  SDT5O PIC  X(0006).
  2160*    -------------------------------
  2161     05  FILLER            PIC  X(0003).
  2162     05  MSAAC6O PIC  X(0010).
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  MSAST6O PIC  X(0002).
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  MSACN6O PIC  X(0001).
  2169*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  44
* EL633.cbl
  2170     05  FILLER            PIC  X(0003).
  2171     05  MSACM6O PIC  X(0010).
  2172*    -------------------------------
  2173     05  FILLER            PIC  X(0003).
  2174     05  TYPE6O PIC  X(0001).
  2175*    -------------------------------
  2176     05  FILLER            PIC  X(0003).
  2177     05  AMT6O PIC  X(0011).
  2178*    -------------------------------
  2179     05  FILLER            PIC  X(0003).
  2180     05  VOID6O PIC  X(0001).
  2181*    -------------------------------
  2182     05  FILLER            PIC  X(0003).
  2183     05  MDT6O PIC  X(0006).
  2184*    -------------------------------
  2185     05  FILLER            PIC  X(0003).
  2186     05  BDT6O PIC  X(0006).
  2187*    -------------------------------
  2188     05  FILLER            PIC  X(0003).
  2189     05  SDT6O PIC  X(0006).
  2190*    -------------------------------
  2191     05  FILLER            PIC  X(0003).
  2192     05  MSAAC7O PIC  X(0010).
  2193*    -------------------------------
  2194     05  FILLER            PIC  X(0003).
  2195     05  MSAST7O PIC  X(0002).
  2196*    -------------------------------
  2197     05  FILLER            PIC  X(0003).
  2198     05  MSACN7O PIC  X(0001).
  2199*    -------------------------------
  2200     05  FILLER            PIC  X(0003).
  2201     05  MSACM7O PIC  X(0010).
  2202*    -------------------------------
  2203     05  FILLER            PIC  X(0003).
  2204     05  TYPE7O PIC  X(0001).
  2205*    -------------------------------
  2206     05  FILLER            PIC  X(0003).
  2207     05  AMT7O PIC  X(0011).
  2208*    -------------------------------
  2209     05  FILLER            PIC  X(0003).
  2210     05  VOID7O PIC  X(0001).
  2211*    -------------------------------
  2212     05  FILLER            PIC  X(0003).
  2213     05  MDT7O PIC  X(0006).
  2214*    -------------------------------
  2215     05  FILLER            PIC  X(0003).
  2216     05  BDT7O PIC  X(0006).
  2217*    -------------------------------
  2218     05  FILLER            PIC  X(0003).
  2219     05  SDT7O PIC  X(0006).
  2220*    -------------------------------
  2221     05  FILLER            PIC  X(0003).
  2222     05  MSAAC8O PIC  X(0010).
  2223*    -------------------------------
  2224     05  FILLER            PIC  X(0003).
  2225     05  MSAST8O PIC  X(0002).
  2226*    -------------------------------
  2227     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  45
* EL633.cbl
  2228     05  MSACN8O PIC  X(0001).
  2229*    -------------------------------
  2230     05  FILLER            PIC  X(0003).
  2231     05  MSACM8O PIC  X(0010).
  2232*    -------------------------------
  2233     05  FILLER            PIC  X(0003).
  2234     05  TYPE8O PIC  X(0001).
  2235*    -------------------------------
  2236     05  FILLER            PIC  X(0003).
  2237     05  AMT8O PIC  X(0011).
  2238*    -------------------------------
  2239     05  FILLER            PIC  X(0003).
  2240     05  VOID8O PIC  X(0001).
  2241*    -------------------------------
  2242     05  FILLER            PIC  X(0003).
  2243     05  MDT8O PIC  X(0006).
  2244*    -------------------------------
  2245     05  FILLER            PIC  X(0003).
  2246     05  BDT8O PIC  X(0006).
  2247*    -------------------------------
  2248     05  FILLER            PIC  X(0003).
  2249     05  SDT8O PIC  X(0006).
  2250*    -------------------------------
  2251     05  FILLER            PIC  X(0003).
  2252     05  MSAAC9O PIC  X(0010).
  2253*    -------------------------------
  2254     05  FILLER            PIC  X(0003).
  2255     05  MSAST9O PIC  X(0002).
  2256*    -------------------------------
  2257     05  FILLER            PIC  X(0003).
  2258     05  MSACN9O PIC  X(0001).
  2259*    -------------------------------
  2260     05  FILLER            PIC  X(0003).
  2261     05  MSACM9O PIC  X(0010).
  2262*    -------------------------------
  2263     05  FILLER            PIC  X(0003).
  2264     05  TYPE9O PIC  X(0001).
  2265*    -------------------------------
  2266     05  FILLER            PIC  X(0003).
  2267     05  AMT9O PIC  X(0011).
  2268*    -------------------------------
  2269     05  FILLER            PIC  X(0003).
  2270     05  VOID9O PIC  X(0001).
  2271*    -------------------------------
  2272     05  FILLER            PIC  X(0003).
  2273     05  MDT9O PIC  X(0006).
  2274*    -------------------------------
  2275     05  FILLER            PIC  X(0003).
  2276     05  BDT9O PIC  X(0006).
  2277*    -------------------------------
  2278     05  FILLER            PIC  X(0003).
  2279     05  SDT9O PIC  X(0006).
  2280*    -------------------------------
  2281     05  FILLER            PIC  X(0003).
  2282     05  MSAAC10O PIC  X(0010).
  2283*    -------------------------------
  2284     05  FILLER            PIC  X(0003).
  2285     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  46
* EL633.cbl
  2286*    -------------------------------
  2287     05  FILLER            PIC  X(0003).
  2288     05  MSACN10O PIC  X(0001).
  2289*    -------------------------------
  2290     05  FILLER            PIC  X(0003).
  2291     05  MSACM10O PIC  X(0010).
  2292*    -------------------------------
  2293     05  FILLER            PIC  X(0003).
  2294     05  TYPE10O PIC  X(0001).
  2295*    -------------------------------
  2296     05  FILLER            PIC  X(0003).
  2297     05  AMT10O PIC  X(0011).
  2298*    -------------------------------
  2299     05  FILLER            PIC  X(0003).
  2300     05  VOID10O PIC  X(0001).
  2301*    -------------------------------
  2302     05  FILLER            PIC  X(0003).
  2303     05  MDT10O PIC  X(0006).
  2304*    -------------------------------
  2305     05  FILLER            PIC  X(0003).
  2306     05  BDT10O PIC  X(0006).
  2307*    -------------------------------
  2308     05  FILLER            PIC  X(0003).
  2309     05  SDT10O PIC  X(0006).
  2310*    -------------------------------
  2311     05  FILLER            PIC  X(0003).
  2312     05  MSAAC11O PIC  X(0010).
  2313*    -------------------------------
  2314     05  FILLER            PIC  X(0003).
  2315     05  MSAST11O PIC  X(0002).
  2316*    -------------------------------
  2317     05  FILLER            PIC  X(0003).
  2318     05  MSACN11O PIC  X(0001).
  2319*    -------------------------------
  2320     05  FILLER            PIC  X(0003).
  2321     05  MSACM11O PIC  X(0010).
  2322*    -------------------------------
  2323     05  FILLER            PIC  X(0003).
  2324     05  TYPE11O PIC  X(0001).
  2325*    -------------------------------
  2326     05  FILLER            PIC  X(0003).
  2327     05  AMT11O PIC  X(0011).
  2328*    -------------------------------
  2329     05  FILLER            PIC  X(0003).
  2330     05  VOID11O PIC  X(0001).
  2331*    -------------------------------
  2332     05  FILLER            PIC  X(0003).
  2333     05  MDT11O PIC  X(0006).
  2334*    -------------------------------
  2335     05  FILLER            PIC  X(0003).
  2336     05  BDT11O PIC  X(0006).
  2337*    -------------------------------
  2338     05  FILLER            PIC  X(0003).
  2339     05  SDT11O PIC  X(0006).
  2340*    -------------------------------
  2341     05  FILLER            PIC  X(0003).
  2342     05  MSAAC12O PIC  X(0010).
  2343*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  47
* EL633.cbl
  2344     05  FILLER            PIC  X(0003).
  2345     05  MSAST12O PIC  X(0002).
  2346*    -------------------------------
  2347     05  FILLER            PIC  X(0003).
  2348     05  MSACN12O PIC  X(0001).
  2349*    -------------------------------
  2350     05  FILLER            PIC  X(0003).
  2351     05  MSACM12O PIC  X(0010).
  2352*    -------------------------------
  2353     05  FILLER            PIC  X(0003).
  2354     05  TYPE12O PIC  X(0001).
  2355*    -------------------------------
  2356     05  FILLER            PIC  X(0003).
  2357     05  AMT12O PIC  X(0011).
  2358*    -------------------------------
  2359     05  FILLER            PIC  X(0003).
  2360     05  VOID12O PIC  X(0001).
  2361*    -------------------------------
  2362     05  FILLER            PIC  X(0003).
  2363     05  MDT12O PIC  X(0006).
  2364*    -------------------------------
  2365     05  FILLER            PIC  X(0003).
  2366     05  BDT12O PIC  X(0006).
  2367*    -------------------------------
  2368     05  FILLER            PIC  X(0003).
  2369     05  SDT12O PIC  X(0006).
  2370*    -------------------------------
  2371     05  FILLER            PIC  X(0003).
  2372     05  MSAAC13O PIC  X(0010).
  2373*    -------------------------------
  2374     05  FILLER            PIC  X(0003).
  2375     05  MSAST13O PIC  X(0002).
  2376*    -------------------------------
  2377     05  FILLER            PIC  X(0003).
  2378     05  MSACN13O PIC  X(0001).
  2379*    -------------------------------
  2380     05  FILLER            PIC  X(0003).
  2381     05  MSACM13O PIC  X(0010).
  2382*    -------------------------------
  2383     05  FILLER            PIC  X(0003).
  2384     05  TYPE13O PIC  X(0001).
  2385*    -------------------------------
  2386     05  FILLER            PIC  X(0003).
  2387     05  AMT13O PIC  X(0011).
  2388*    -------------------------------
  2389     05  FILLER            PIC  X(0003).
  2390     05  VOID13O PIC  X(0001).
  2391*    -------------------------------
  2392     05  FILLER            PIC  X(0003).
  2393     05  MDT13O PIC  X(0006).
  2394*    -------------------------------
  2395     05  FILLER            PIC  X(0003).
  2396     05  BDT13O PIC  X(0006).
  2397*    -------------------------------
  2398     05  FILLER            PIC  X(0003).
  2399     05  SDT13O PIC  X(0006).
  2400*    -------------------------------
  2401     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  48
* EL633.cbl
  2402     05  ERRMSG1O PIC  X(0079).
  2403*    -------------------------------
  2404     05  FILLER            PIC  X(0003).
  2405     05  ERRMSG2O PIC  X(0079).
  2406*    -------------------------------
  2407     05  FILLER            PIC  X(0003).
  2408     05  PFENTERO PIC  X(0002).
  2409*    -------------------------------
  2410
  2411 01  MAP-EL633A  REDEFINES  EL633AI.
  2412     12  FILLER                  PIC  X(87).
  2413     12  DATA-AREA       OCCURS 13 TIMES
  2414                             INDEXED BY PINDX.
  2415         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2416         16  GL-ACCT-ATTRB       PIC  X.
  2417         16  GL-ACCT             PIC  X(10).
  2418         16  WSL-COMM  REDEFINES GL-ACCT.
  2419             20  WSL-COMM-DTE.
  2420                 24  WSL-MO      PIC  X(2).
  2421                 24  WSL-DA      PIC  X(2).
  2422                 24  WSL-YR      PIC  X(2).
  2423             20  WSL-COMM-REST   PIC  X(4).
  2424         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2425         16  GL-STATE-ATTRB      PIC  X.
  2426         16  GL-STATE            PIC  X(02).
  2427         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2428         16  GL-CANC-ATTRB       PIC  X.
  2429         16  GL-CANC             PIC  X.
  2430         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2431         16  GL-COMM-ATTRB       PIC  X.
  2432         16  GL-COMM             PIC  X(10).
  2433         16  RTYPE-LEN           PIC S9(4)              COMP.
  2434         16  RTYPE-ATTRB         PIC  X.
  2435         16  RTYPE               PIC  X.
  2436         16  AMT-LEN             PIC S9(4)              COMP.
  2437         16  AMT-ATTRB           PIC  X.
  2438         16  AMT                 PIC S9(9)V9(2).
  2439         16  AMTO  REDEFINES
  2440             AMT                 PIC Z(7).9(2)-.
  2441         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2442         16  VOID-SW-ATTRB       PIC  X.
  2443         16  VOID-SW             PIC  X.
  2444         16  MDTE-LEN            PIC S9(4)              COMP.
  2445         16  MDTE-ATTRB          PIC  X.
  2446         16  MDTE                PIC  X(6).
  2447         16  BDTE-LEN            PIC S9(4)              COMP.
  2448         16  BDTE-ATTRB          PIC  X.
  2449         16  BDTE                PIC  X(6).
  2450         16  SDTE-LEN            PIC S9(4)              COMP.
  2451         16  SDTE-ATTRB          PIC  X.
  2452         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  49
* EL633.cbl
  2454****************************************************************
  2455*
  2456* Copyright (c) 2007 by Clerity Solutions, Inc.
  2457* All rights reserved.
  2458*
  2459****************************************************************
  2460 01  DFHEIV.
  2461   02  DFHEIV0               PIC X(35).
  2462   02  DFHEIV1               PIC X(08).
  2463   02  DFHEIV2               PIC X(08).
  2464   02  DFHEIV3               PIC X(08).
  2465   02  DFHEIV4               PIC X(06).
  2466   02  DFHEIV5               PIC X(04).
  2467   02  DFHEIV6               PIC X(04).
  2468   02  DFHEIV7               PIC X(02).
  2469   02  DFHEIV8               PIC X(02).
  2470   02  DFHEIV9               PIC X(01).
  2471   02  DFHEIV10              PIC S9(7) COMP-3.
  2472   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2473   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2474   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2475   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2476   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2477   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2478   02  DFHEIV17              PIC X(04).
  2479   02  DFHEIV18              PIC X(04).
  2480   02  DFHEIV19              PIC X(04).
  2481   02  DFHEIV20              USAGE IS POINTER.
  2482   02  DFHEIV21              USAGE IS POINTER.
  2483   02  DFHEIV22              USAGE IS POINTER.
  2484   02  DFHEIV23              USAGE IS POINTER.
  2485   02  DFHEIV24              USAGE IS POINTER.
  2486   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2487   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2488   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2489   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2490   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2491   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2492   02  FILLER                PIC X(02).
  2493   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2494   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2495   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2496   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2497   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2498 LINKAGE  SECTION.
  2499*****************************************************************
  2500*                                                               *
  2501* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2502* All rights reserved.                                          *
  2503*                                                               *
  2504*****************************************************************
  2505 01  dfheiblk.
  2506     02  eibtime          pic s9(7) comp-3.
  2507     02  eibdate          pic s9(7) comp-3.
  2508     02  eibtrnid         pic x(4).
  2509     02  eibtaskn         pic s9(7) comp-3.
  2510     02  eibtrmid         pic x(4).
  2511     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  50
* EL633.cbl
  2512     02  eibcposn         pic s9(4) comp.
  2513     02  eibcalen         pic s9(4) comp.
  2514     02  eibaid           pic x(1).
  2515     02  eibfiller1       pic x(1).
  2516     02  eibfn            pic x(2).
  2517     02  eibfiller2       pic x(2).
  2518     02  eibrcode         pic x(6).
  2519     02  eibfiller3       pic x(2).
  2520     02  eibds            pic x(8).
  2521     02  eibreqid         pic x(8).
  2522     02  eibrsrce         pic x(8).
  2523     02  eibsync          pic x(1).
  2524     02  eibfree          pic x(1).
  2525     02  eibrecv          pic x(1).
  2526     02  eibsend          pic x(1).
  2527     02  eibatt           pic x(1).
  2528     02  eibeoc           pic x(1).
  2529     02  eibfmh           pic x(1).
  2530     02  eibcompl         pic x(1).
  2531     02  eibsig           pic x(1).
  2532     02  eibconf          pic x(1).
  2533     02  eiberr           pic x(1).
  2534     02  eibrldbk         pic x(1).
  2535     02  eiberrcd         pic x(4).
  2536     02  eibsynrb         pic x(1).
  2537     02  eibnodat         pic x(1).
  2538     02  eibfiller5       pic x(2).
  2539     02  eibresp          pic 9(09) comp.
  2540     02  eibresp2         pic 9(09) comp.
  2541     02  dfheigdj         pic s9(4) comp.
  2542     02  dfheigdk         pic s9(4) comp.
  2543 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  51
* EL633.cbl
  2544/
  2545*                            COPY ERCCHKQ.
  2546******************************************************************
  2547*                                                                *
  2548*                                                                *
  2549*                            ERCCHKQ                             *
  2550*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2551*                            VMOD=2.005                          *
  2552*                                                                *
  2553*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2554*                                                                *
  2555*   FILE TYPE = VSAM,KSDS                                        *
  2556*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2557*                                                                *
  2558*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2559*       ALTERNATE PATH  = NONE                                   *
  2560*                                                                *
  2561*   LOG = YES                                                    *
  2562*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2563******************************************************************
  2564 01  CHECK-QUE.
  2565     12  CQ-RECORD-ID                PIC XX.
  2566         88  VALID-CQ-ID                     VALUE 'CQ'.
  2567
  2568     12  CQ-CONTROL-PRIMARY.
  2569         16  CQ-COMPANY-CD           PIC X.
  2570         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2571         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2572
  2573     12  CQ-ENTRY-TYPE               PIC X.
  2574             88  CHECK-ON-QUE           VALUE 'Q'.
  2575             88  ALIGNMENT-CHECK        VALUE 'A'.
  2576             88  MANUAL-CHECK           VALUE 'M'.
  2577             88  SPOILED-CHECK          VALUE 'S'.
  2578             88  VOIDED-CHECK           VALUE 'V'.
  2579             88  PAYMENT-ABORTED        VALUE 'X'.
  2580
  2581     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2582
  2583     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2584         CQ-CREDIT-MASTER-CNTL.
  2585         16  CQ-PYAJ-CARRIER         PIC X.
  2586         16  CQ-PYAJ-GROUPING        PIC X(6).
  2587         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2588         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2589         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2590         16  CQ-PYAJ-REC-TYPE        PIC X.
  2591         16  FILLER                  PIC X(18).
  2592
  2593     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2594         CQ-CREDIT-MASTER-CNTL.
  2595         16  CQ-CHEK-CARRIER         PIC X.
  2596         16  CQ-CHEK-GROUPING        PIC X(6).
  2597         16  CQ-CHEK-STATE           PIC XX.
  2598         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2599         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2600         16  CQ-CHEK-CERT-NO.
  2601             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  52
* EL633.cbl
  2602             20  CQ-CHEK-CERT-SFX    PIC X.
  2603         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2604         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2605         16  FILLER                  PIC X(06).
  2606
  2607     12  CQ-CHECK-NUMBER             PIC X(7).
  2608     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2609     12  CQ-PAYMENT-TYPE             PIC X.
  2610             88  CQ-BILLING-CREDIT         VALUE '1'.
  2611             88  CQ-REFUND-PMT             VALUE '2'.
  2612             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2613     12  CQ-VOID-INDICATOR           PIC X.
  2614             88  CHECK-IS-VOID             VALUE 'V'.
  2615     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2616     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2617     12  CQ-CHECK-BY-USER            PIC X(4).
  2618     12  CQ-PRE-NUMBERING-SW         PIC X.
  2619       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2620       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2621
  2622     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2623     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2624     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2625     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2626
  2627     12  CQ-LETTERS-IND              PIC X.
  2628         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2629
  2630******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  53
* EL633.cbl
  2631/
  2632*                            COPY ERCPYAJ.
  2633******************************************************************
  2634*                                                                *
  2635*                            ERCPYAJ                             *
  2636*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2637*                            VMOD=2.015                          *
  2638*                                                                *
  2639*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2640*                                                                *
  2641*                                                                *
  2642*   FILE TYPE = VSAM,KSDS                                        *
  2643*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2644*                                                                *
  2645*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2646*       ALTERNATE PATHS = NONE                                   *
  2647*                                                                *
  2648*   LOG = YES                                                    *
  2649*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2650******************************************************************
  2651******************************************************************
  2652*                   C H A N G E   L O G
  2653*
  2654* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2655*-----------------------------------------------------------------
  2656*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2657* EFFECTIVE    NUMBER
  2658*-----------------------------------------------------------------
  2659* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2660* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2661******************************************************************
  2662
  2663 01  PENDING-PAY-ADJ.
  2664     12  PY-RECORD-ID                     PIC XX.
  2665         88  VALID-PY-ID                        VALUE 'PY'.
  2666
  2667     12  PY-CONTROL-PRIMARY.
  2668         16  PY-COMPANY-CD                PIC X.
  2669         16  PY-CARRIER                   PIC X.
  2670         16  PY-GROUPING                  PIC X(6).
  2671         16  PY-FIN-RESP                  PIC X(10).
  2672         16  PY-ACCOUNT                   PIC X(10).
  2673         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2674                                          PIC X(10).
  2675         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2676         16  PY-RECORD-TYPE               PIC X.
  2677             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2678             88  PY-DEPOSIT                   VALUE 'D'.
  2679             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2680             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2681             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2682             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2683             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2684             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2685             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2686             88  PY-FICA-ENTRY                VALUE 'F'.
  2687             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2688             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  54
* EL633.cbl
  2689             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2690
  2691     12  PY-PYMT-TYPE                     PIC X.
  2692             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2693             88  PY-REINS-PYMT                VALUE 'R'.
  2694             88  PY-EXP-PYMT                  VALUE 'E'.
  2695
  2696     12  PY-BIL-INV                       PIC X(6).
  2697     12  PY-REF-NO                        PIC X(12).
  2698
  2699     12  PY-LAST-MAINT-DT                 PIC XX.
  2700     12  PY-LAST-MAINT-BY                 PIC X(4).
  2701     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2702
  2703     12  PY-PYADJ-RECORD.
  2704         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2705         16  PY-ENTRY-COMMENT             PIC X(30).
  2706         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2707             20  PY-GL-ACCOUNT            PIC X(10).
  2708             20  PY-GL-STATE              PIC X(02).
  2709             20  PY-GL-CANC-SW            PIC X(01).
  2710                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2711                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2712             20  PY-GL-COMMENT            PIC X(10).
  2713             20  FILLER      REDEFINES PY-GL-COMMENT.
  2714                 24  PY-GL-CHECK-NO       PIC 9(06).
  2715                 24  FILLER               PIC X(04).
  2716             20  FILLER                   PIC X(07).
  2717         16  PY-SAVE-ACCOUNT              PIC X(10).
  2718         16  PY-SAVE-TYPE                 PIC X(01).
  2719
  2720         16  PY-LETTERS.
  2721             20  PY-LETTER OCCURS 3 TIMES
  2722                           INDEXED BY PY-LET-NDX
  2723                                          PIC X(04).
  2724
  2725         16  PY-ERCOMP-TYPE               PIC X.
  2726             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2727             88  PY-GA-TYPE                   VALUE 'G'.
  2728             88  PY-BANK-TYPE                 VALUE 'B'.
  2729         16  FILLER                       PIC X(05).
  2730
  2731     12  PY-RECORD-STATUS.
  2732         16  PY-CREDIT-SELECT-DT          PIC XX.
  2733         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2734         16  PY-BILLED-DATE               PIC XX.
  2735         16  PY-REPORTED-DT               PIC XX.
  2736         16  PY-PMT-APPLIED               PIC X.
  2737             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2738             88  PY-GA-PMT                    VALUE 'G'.
  2739             88  PY-OVWRITE-PMT               VALUE 'O'.
  2740             88  PY-NON-AR-PMT                VALUE 'N'.
  2741         16  FILLER                       PIC X(5).
  2742         16  PY-INPUT-DT                  PIC XX.
  2743         16  PY-CHECK-NUMBER              PIC X(6).
  2744         16  PY-VOID-SW                   PIC X.
  2745             88  PY-CHECK-VOIDED              VALUE 'V'.
  2746         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  55
* EL633.cbl
  2747             88  PY-BILLING-CHECK             VALUE 'B'.
  2748             88  PY-REFUND-CHECK              VALUE 'R'.
  2749             88  PY-GA-CHECK                  VALUE 'G'.
  2750             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2751             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2752         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2753         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2754         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2755         16  PY-BILL-FLAG                 PIC X.
  2756             88  PY-BILLED                    VALUE 'B'.
  2757         16  PY-AR-FLAG                   PIC X.
  2758             88  PY-AR-CYCLE                  VALUE 'C'.
  2759             88  PY-AR-MONTH-END              VALUE 'M'.
  2760         16  PY-AR-DATE                   PIC XX.
  2761
  2762     12  PY-GL-CODES.
  2763         16  PY-GL-DB                     PIC X(14).
  2764         16  PY-GL-CR                     PIC X(14).
  2765         16  PY-GL-FLAG                   PIC X.
  2766         16  PY-GL-DATE                   PIC XX.
  2767
  2768     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2769     12  FILLER                           PIC X(3).
  2770******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  56
* EL633.cbl
  2771/
  2772*                            COPY ERCCOMP.
  2773******************************************************************
  2774*                                                                *
  2775*                                                                *
  2776*                            ERCCOMP                             *
  2777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2778*                            VMOD=2.019                          *
  2779*                                                                *
  2780*   ONLINE CREDIT SYSTEM                                         *
  2781*                                                                *
  2782*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2783*                                                                *
  2784*   FILE TYPE = VSAM,KSDS                                        *
  2785*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2786*                                                                *
  2787*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2788*       ALTERNATE PATH = NONE                                    *
  2789*                                                                *
  2790*   LOG = NO                                                     *
  2791*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2792*                                                                *
  2793******************************************************************
  2794*                   C H A N G E   L O G
  2795*
  2796* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2797*-----------------------------------------------------------------
  2798*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2799* EFFECTIVE    NUMBER
  2800*-----------------------------------------------------------------
  2801* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2802* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2803* 092205    2005050300006  PEMA  ADD LEASE FEE
  2804* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2805* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2806* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2807* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2808* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2809* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2810******************************************************************
  2811
  2812 01  COMPENSATION-MASTER.
  2813     12  CO-RECORD-ID                          PIC XX.
  2814         88  VALID-CO-ID                          VALUE 'CO'.
  2815
  2816     12  CO-CONTROL-PRIMARY.
  2817         16  CO-COMPANY-CD                     PIC X.
  2818         16  CO-CONTROL.
  2819             20  CO-CTL-1.
  2820                 24  CO-CARR-GROUP.
  2821                     28  CO-CARRIER            PIC X.
  2822                     28  CO-GROUPING.
  2823                         32  CO-GROUP-PREFIX   PIC XXX.
  2824                         32  CO-GROUP-PRIME    PIC XXX.
  2825                 24  CO-RESP-NO.
  2826                     28  CO-RESP-PREFIX        PIC X(4).
  2827                     28  CO-RESP-PRIME         PIC X(6).
  2828             20  CO-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  57
* EL633.cbl
  2829                 24  CO-ACCOUNT.
  2830                     28  CO-ACCT-PREFIX        PIC X(4).
  2831                     28  CO-ACCT-PRIME         PIC X(6).
  2832         16  CO-TYPE                           PIC X.
  2833             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2834             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2835             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2836
  2837     12  CO-MAINT-INFORMATION.
  2838         16  CO-LAST-MAINT-DT                  PIC XX.
  2839         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2840         16  CO-LAST-MAINT-USER                PIC X(4).
  2841     12  FILLER                                PIC XX.
  2842     12  CO-STMT-TYPE                          PIC XXX.
  2843     12  CO-COMP-TYPE                          PIC X.
  2844         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2845     12  CO-STMT-OWNER                         PIC X(4).
  2846     12  CO-BALANCE-CONTROL                    PIC X.
  2847         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2848         88  CO-NO-BALANCE                        VALUE 'N'.
  2849
  2850     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2851         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2852         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2853         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2854
  2855     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2856         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2857         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2858
  2859     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2860     12  CO-GA-DIRECT-DEP                      PIC X.
  2861     12  CO-FUTURE-SPACE                       PIC X.
  2862         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2863
  2864     12  CO-ACCT-NAME                          PIC X(30).
  2865     12  CO-MAIL-NAME                          PIC X(30).
  2866     12  CO-ADDR-1                             PIC X(30).
  2867     12  CO-ADDR-2                             PIC X(30).
  2868     12  CO-ADDR-3.
  2869         16  CO-ADDR-CITY                      PIC X(27).
  2870         16  CO-ADDR-STATE                     PIC XX.
  2871     12  CO-CSO-1099                           PIC X.
  2872     12  CO-ZIP.
  2873         16  CO-ZIP-PRIME.
  2874             20  CO-ZIP-PRI-1ST                PIC X.
  2875                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2876             20  FILLER                        PIC X(4).
  2877         16  CO-ZIP-PLUS4                      PIC X(4).
  2878     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2879         16  CO-CAN-POSTAL-1                   PIC XXX.
  2880         16  CO-CAN-POSTAL-2                   PIC XXX.
  2881         16  FILLER                            PIC XXX.
  2882     12  CO-SOC-SEC                            PIC X(13).
  2883     12  CO-TELEPHONE.
  2884         16  CO-AREA-CODE                      PIC XXX.
  2885         16  CO-PREFIX                         PIC XXX.
  2886         16  CO-PHONE                          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  58
* EL633.cbl
  2887
  2888     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2889
  2890     12  CO-AR-BAL-LEVEL                       PIC X.
  2891         88  CO-AR-REF-LVL                        VALUE '1'.
  2892         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2893         88  CO-AR-BILL-LVL                       VALUE '2'.
  2894         88  CO-AR-AGT-LVL                        VALUE '3'.
  2895         88  CO-AR-FR-LVL                         VALUE '4'.
  2896
  2897     12  CO-AR-NORMAL-PRINT                    PIC X.
  2898         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2899         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2900
  2901     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2902
  2903     12  CO-AR-REPORTING                       PIC X.
  2904         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2905         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2906
  2907     12  CO-AR-PULL-CHECK                      PIC X.
  2908         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2909         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2910
  2911     12  CO-AR-BALANCE-PRINT                   PIC X.
  2912         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2913
  2914     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2915         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2916         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2917         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2918
  2919     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2920
  2921     12  CO-USER-CODE                          PIC X.
  2922     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2923
  2924******************************************************************
  2925*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2926*    THE LAST MONTH END RUN.
  2927******************************************************************
  2928
  2929     12  CO-LAST-ACTIVITY-DATE.
  2930         16  CO-ACT-YEAR                       PIC 99.
  2931         16  CO-ACT-MONTH                      PIC 99.
  2932         16  CO-ACT-DAY                        PIC 99.
  2933
  2934     12  CO-LAST-STMT-DT.
  2935         16  CO-LAST-STMT-YEAR                 PIC 99.
  2936         16  CO-LAST-STMT-MONTH                PIC 99.
  2937         16  CO-LAST-STMT-DAY                  PIC 99.
  2938
  2939     12  CO-MO-END-TOTALS.
  2940         16  CO-MONTHLY-TOTALS.
  2941             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2942             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2943             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2944             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  59
* EL633.cbl
  2945             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2946
  2947         16  CO-AGING-TOTALS.
  2948             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2949             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2950             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2951             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2952
  2953         16  CO-YTD-TOTALS.
  2954             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2955             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2956
  2957         16  CO-OVER-UNDER-TOTALS.
  2958             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2959             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2960
  2961     12  CO-MISCELLANEOUS-TOTALS.
  2962         16  CO-FICA-TOTALS.
  2963             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2964             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2965
  2966         16  CO-CLAIM-TOTALS.
  2967             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2968             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2969
  2970******************************************************************
  2971*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2972*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2973******************************************************************
  2974
  2975     12  CO-CURRENT-TOTALS.
  2976         16  CO-CURRENT-LAST-STMT-DT.
  2977             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2978             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2979             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2980
  2981         16  CO-CURRENT-MONTHLY-TOTALS.
  2982             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2983             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2984             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2985             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2986             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2987
  2988         16  CO-CURRENT-AGING-TOTALS.
  2989             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2990             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2991             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2992             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2993
  2994         16  CO-CURRENT-YTD-TOTALS.
  2995             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2996             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2997
  2998     12  CO-PAID-COMM-TOTALS.
  2999         16  CO-YTD-PAID-COMMS.
  3000             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  3001             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3002
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  60
* EL633.cbl
  3003     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3004         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  3005         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3006
  3007     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3008         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  3009         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3010         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3011         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3012         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3013         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3014         88  CO-FINAL-LETTER                  VALUE 'F'.
  3015         88  CO-RECONCILING                   VALUE 'R'.
  3016         88  CO-PHONE-CALL                    VALUE 'P'.
  3017         88  CO-LEGAL                         VALUE 'L'.
  3018         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3019         88  CO-WRITE-OFF                     VALUE 'W'.
  3020         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3021
  3022     12  CO-CSR-CODE                       PIC X(4).
  3023
  3024     12  CO-GA-STATUS-INFO.
  3025         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3026         16  CO-GA-TERMINATION-DT          PIC XX.
  3027         16  CO-GA-STATUS-CODE             PIC X.
  3028             88  CO-GA-ACTIVE                 VALUE 'A'.
  3029             88  CO-GA-INACTIVE               VALUE 'I'.
  3030             88  CO-GA-PENDING                VALUE 'P'.
  3031         16  CO-GA-COMMENTS.
  3032             20  CO-GA-COMMENT-1           PIC X(40).
  3033             20  CO-GA-COMMENT-2           PIC X(40).
  3034             20  CO-GA-COMMENT-3           PIC X(40).
  3035             20  CO-GA-COMMENT-4           PIC X(40).
  3036
  3037     12  CO-RPTCD2                         PIC X(10).
  3038     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  3039         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  3040         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  3041
  3042     12  CO-TYPE-AGENT                     PIC X(01).
  3043         88  CO-CORPORATION                   VALUE 'C'.
  3044         88  CO-PARTNERSHIP                   VALUE 'P'.
  3045         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3046         88  CO-TRUST                         VALUE 'T'.
  3047         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3048
  3049     12  CO-FAXNO.
  3050         16  CO-FAX-AREA-CODE                  PIC XXX.
  3051         16  CO-FAX-PREFIX                     PIC XXX.
  3052         16  CO-FAX-PHONE                      PIC X(4).
  3053
  3054     12  CO-BANK-INFORMATION.
  3055         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3056         16  CO-BANK-TRANSIT-NON REDEFINES
  3057             CO-BANK-TRANSIT-NO                PIC 9(8).
  3058
  3059         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3060     12  CO-MISC-DEDUCT-INFO REDEFINES
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  61
* EL633.cbl
  3061                  CO-BANK-INFORMATION.
  3062         16  CO-MD-GL-ACCT                     PIC X(10).
  3063         16  CO-MD-DIV                         PIC XX.
  3064         16  CO-MD-CENTER                      PIC X(4).
  3065         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3066         16  CO-CREATE-AP-CHECK                PIC X.
  3067         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3068         16  FILLER                            PIC XXX.
  3069     12  CO-ACH-STATUS                         PIC X.
  3070         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3071         88  CO-ACH-PENDING                        VALUE 'P'.
  3072
  3073     12  CO-BILL-SW                            PIC X.
  3074     12  CO-CONTROL-NAME                       PIC X(30).
  3075     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3076     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3077     12  CO-CLP-STATE                          PIC XX.
  3078     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3079     12  CO-SPP-REFUND-EDIT                    PIC X.
  3080
  3081******************************************************************
  3082*
  3083*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  62
* EL633.cbl
  3084/
  3085 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3086                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3087 0000-DFHEXIT SECTION.
  3088     MOVE '9#                    $   ' TO DFHEIV0.
  3089     MOVE 'EL633' TO DFHEIV1.
  3090     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3091
  3092     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3093     MOVE EIBTRMID               TO  QID-TERM.
  3094     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3095
  3096     IF EIBCALEN = ZERO
  3097         GO TO 8800-UNAUTHORIZED-ACCESS.
  3098
  3099     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3100         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3101
  3102     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3103     MOVE '5'                    TO  DC-OPTION-CODE.
  3104
  3105     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3106
  3107     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3108     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3109
  3110     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3111         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3112             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3113             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3114             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3115             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3116             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3117             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3118             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3119             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3120         ELSE
  3121             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3122             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3123             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3124             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3125             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3126             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3127             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3128             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3129
  3130     MOVE LOW-VALUES             TO  EL633AI.
  3131
  3132     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3133     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3134     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3135     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3136
  3137     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3138                                     TOTAL-ACCT-NET.
  3139
  3140     IF RETURNED-FROM = XCTL-6331 OR
  3141                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  63
* EL633.cbl
  3142                        XCTL-642  OR
  3143                        XCTL-652
  3144         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3145
  3146     IF EIBTRNID NOT = TRANS-ID
  3147         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3148         MOVE 'Y'                TO  PI-PAGE-SW
  3149         MOVE ZEROS              TO  PI-SEQ-NOS
  3150         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3151                                     PI-SAV-ACCT-NET
  3152                                     PI-SAV-PREV-AMT
  3153                                     PI-SAV-PREV-NET
  3154         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3155             EIBTRNID NOT = EL642-TRANS-ID  AND
  3156             EIBTRNID NOT = EL652-TRANS-ID) OR
  3157             PI-CR-FIN-RESP = SPACES
  3158             GO TO 8100-SEND-INITIAL-MAP
  3159         ELSE
  3160             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3161                            EL640-TRANS-ID   OR
  3162                            EL642-TRANS-ID)  AND
  3163                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3164                GO TO 8100-SEND-INITIAL-MAP
  3165             ELSE
  3166                 MOVE DFHENTER   TO  EIBAID
  3167                 MOVE 'S'        TO  MAINTI
  3168                 MOVE PI-CR-CARRIER
  3169                                 TO  CARRIERI
  3170                 MOVE PI-CR-GROUPING
  3171                                 TO  GROUPI
  3172                 MOVE PI-CR-FIN-RESP
  3173                                 TO  FINRESPI
  3174                 MOVE PI-CR-ACCOUNT
  3175                                 TO  ACCTI
  3176                 MOVE 1          TO  CARRIERL  MAINTA
  3177                 MOVE 3          TO  GROUPL
  3178                 MOVE 6          TO  FINRESPL  ACCTL
  3179                 GO TO 0400-VALIDATE-KEY-DATA.
  3180
  3181
  3182* EXEC CICS HANDLE CONDITION
  3183*        PGMIDERR  (9600-PGMID-ERROR)
  3184*        ERROR     (9990-ABEND)
  3185*    END-EXEC.
  3186*    MOVE '"$L.                  ! " #00003177' TO DFHEIV0
  3187     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3189     MOVE X'2220233030303033313737' TO DFHEIV0(25:11)
  3190     CALL 'kxdfhei1' USING DFHEIV0
  3191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3192
  3193
  3194     IF EIBAID = DFHCLEAR
  3195         GO TO 9400-CLEAR.
  3196
  3197     IF PI-PROCESSOR-ID = 'LGXX'
  3198         GO TO 0200-RECEIVE.
  3199
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  64
* EL633.cbl
  3200
  3201* EXEC CICS READQ TS
  3202*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3203*        INTO   (SECURITY-CONTROL)
  3204*        LENGTH (SC-COMM-LENGTH)
  3205*        ITEM   (SC-ITEM)
  3206*    END-EXEC.
  3207*    MOVE '*$II   L              ''   #00003188' TO DFHEIV0
  3208     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3209     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3210     MOVE X'2020233030303033313838' TO DFHEIV0(25:11)
  3211     CALL 'kxdfhei1' USING DFHEIV0,
  3212           PI-SECURITY-TEMP-STORE-ID,
  3213           SECURITY-CONTROL,
  3214           SC-COMM-LENGTH,
  3215           SC-ITEM,
  3216           DFHEIV99,
  3217           DFHEIV99
  3218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3219
  3220
  3221     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3222     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3223
  3224     IF NOT DISPLAY-CAP
  3225         MOVE 'READ'          TO SM-READ
  3226         PERFORM 9995-SECURITY-VIOLATION
  3227         MOVE ER-0070         TO  EMI-ERROR
  3228         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3229         GO TO 8100-SEND-INITIAL-MAP.
  3230
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  65
* EL633.cbl
  3232 0200-RECEIVE.
  3233
  3234     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3235         MOVE ER-0008            TO  EMI-ERROR
  3236         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3237         MOVE -1                 TO  MAINTL
  3238         GO TO 8200-SEND-DATAONLY.
  3239
  3240
  3241* EXEC CICS RECEIVE
  3242*        MAP     (MAP-NAME)
  3243*        MAPSET  (MAPSET-NAME)
  3244*        INTO    (EL633AI)
  3245*    END-EXEC.
  3246     MOVE LENGTH OF
  3247      EL633AI
  3248       TO DFHEIV11
  3249*    MOVE '8"T I  L              ''   #00003214' TO DFHEIV0
  3250     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3251     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3252     MOVE X'2020233030303033323134' TO DFHEIV0(25:11)
  3253     CALL 'kxdfhei1' USING DFHEIV0,
  3254           MAP-NAME,
  3255           EL633AI,
  3256           DFHEIV11,
  3257           MAPSET-NAME,
  3258           DFHEIV99,
  3259           DFHEIV99
  3260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3261
  3262
  3263     IF MAINTI = 'S' AND
  3264        EIBAID = DFHENTER
  3265         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3266                                     PI-SAV-ACCT-NET
  3267                                     PI-SAV-PREV-AMT
  3268                                     PI-SAV-PREV-NET
  3269                                     PI-FRST-FILE-SEQ-NO
  3270         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3271
  3272     IF PFENTERL = ZERO
  3273         GO TO 0300-CHECK-PFKEYS.
  3274
  3275     IF (PFENTERI  IS NUMERIC)
  3276       AND (PFENTERI GREATER 0 AND LESS 25)
  3277         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3278     ELSE
  3279         MOVE ER-0029               TO  EMI-ERROR
  3280         GO TO 0320-INPUT-ERROR.
  3281
  3282 0300-CHECK-PFKEYS.
  3283     IF EIBAID = DFHPF23
  3284         GO TO 8810-PF23.
  3285
  3286     IF EIBAID = DFHPF24
  3287         GO TO 9200-RETURN-MAIN-MENU.
  3288
  3289     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  66
* EL633.cbl
  3290         GO TO 9500-PF12.
  3291
  3292     IF EIBAID = DFHPF3
  3293         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3294             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3295             MOVE XCTL-652       TO  PGM-NAME
  3296             IF ERCOMP-KEY  NOT =      SPACES
  3297                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3298                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3299                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3300                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3301             END-IF
  3302
  3303             IF PI-CR-ACCOUNT = LOW-VALUES
  3304                 MOVE 'G'        TO  PI-CR-TYPE
  3305                 GO TO 9300-XCTL
  3306             ELSE
  3307                 MOVE 'A'        TO  PI-CR-TYPE
  3308                 GO TO 9300-XCTL
  3309         ELSE
  3310            MOVE ER-3020         TO  EMI-ERROR
  3311            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3312            GO TO 8100-SEND-INITIAL-MAP.
  3313
  3314     IF EIBAID = DFHPF4
  3315         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3316         MOVE XCTL-6331          TO  PGM-NAME
  3317         GO TO 9300-XCTL.
  3318
  3319     IF EIBAID = DFHPF5
  3320         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3321         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3322         MOVE XCTL-640           TO  PGM-NAME
  3323         IF PI-CR-ACCOUNT = LOW-VALUES
  3324             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3325             IF ACCTI = LOW-VALUES
  3326                MOVE 'G'         TO  PI-CR-TYPE
  3327             END-IF
  3328             GO TO 9300-XCTL
  3329         ELSE
  3330             MOVE 'A'        TO  PI-CR-TYPE
  3331             GO TO 9300-XCTL.
  3332
  3333     IF EIBAID = DFHPF6
  3334        IF PI-GA-BILLING
  3335            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3336            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3337            MOVE XCTL-642        TO  PGM-NAME
  3338            IF PI-CR-ACCOUNT = LOW-VALUES
  3339                 MOVE 'G'        TO  PI-CR-TYPE
  3340                 GO TO 9300-XCTL
  3341             ELSE
  3342                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3343                 GO TO 9300-XCTL
  3344        ELSE
  3345            MOVE ER-2929         TO  EMI-ERROR
  3346            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3347            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  67
* EL633.cbl
  3348            IF PFENTERL = ZERO
  3349                MOVE -1          TO  MAINTL
  3350                GO TO 8200-SEND-DATAONLY
  3351            ELSE
  3352                MOVE -1          TO  PFENTERL
  3353                GO TO 8200-SEND-DATAONLY.
  3354
  3355     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3356         GO TO 0400-VALIDATE-KEY-DATA.
  3357
  3358 0320-INPUT-ERROR.
  3359     MOVE ER-0029                TO  EMI-ERROR.
  3360
  3361     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3362
  3363     MOVE AL-UNBON               TO  PFENTERA.
  3364
  3365     IF PFENTERL = ZERO
  3366         MOVE -1                 TO  MAINTL
  3367     ELSE
  3368         MOVE -1                 TO  PFENTERL.
  3369
  3370     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  68
* EL633.cbl
  3372 0400-VALIDATE-KEY-DATA.
  3373     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3374         NEXT SENTENCE
  3375       ELSE
  3376        IF MAINTI NOT = 'S'
  3377         MOVE 'UPDATE'       TO SM-READ
  3378         PERFORM 9995-SECURITY-VIOLATION
  3379         MOVE ER-0070        TO EMI-ERROR
  3380         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3381         GO TO 8100-SEND-INITIAL-MAP.
  3382
  3383     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3384
  3385     IF EIBAID = DFHPF1
  3386         GO TO 4000-BROWSE-FRWD.
  3387
  3388     IF EIBAID   = DFHPF1   AND
  3389        CARRIERL = ZEROS    AND
  3390        GROUPL   = ZEROS    AND
  3391        FINRESPL = ZEROS    AND
  3392        ACCTL    = ZEROS
  3393         GO TO 4000-BROWSE-FRWD.
  3394
  3395     IF PI-PROCESSOR-ID = 'LGXX'
  3396         IF MAINTI = 'C'
  3397             MOVE AL-UANON       TO MAINTA
  3398             MOVE MAINTI         TO PI-SAV-FUNCTION
  3399             GO TO CSO-BRANCH
  3400         END-IF
  3401     END-IF.
  3402
  3403     IF MAINTI = 'C' OR  'S'
  3404         MOVE AL-UANON           TO  MAINTA
  3405         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3406     ELSE
  3407         MOVE -1                 TO  MAINTL
  3408         MOVE ER-0023            TO  EMI-ERROR
  3409         MOVE AL-UABON           TO  MAINTA
  3410         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3411
  3412 CSO-BRANCH.
  3413
  3414     IF MAINTI = 'C'
  3415       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3416         MOVE -1                 TO  MAINTL
  3417         MOVE ER-2056            TO  EMI-ERROR
  3418         MOVE AL-UABON           TO  MAINTA
  3419         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3420
  3421     IF CARRIERL = ZEROS  AND
  3422        GROUPL   = ZEROS  AND
  3423        FINRESPL = ZEROS  AND
  3424        ACCTL    = ZEROS
  3425         MOVE -1                 TO  CARRIERL
  3426         MOVE ER-2231            TO  EMI-ERROR
  3427         MOVE AL-UABON           TO  CARRIERA
  3428                                     GROUPA
  3429                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  69
* EL633.cbl
  3430                                     ACCTA
  3431         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3432         GO TO 8200-SEND-DATAONLY.
  3433
  3434     IF CARRIERL NOT = ZEROS
  3435         MOVE AL-UANON           TO  CARRIERA
  3436         MOVE CARRIERI           TO  COMP-CARRIER
  3437                                     PI-SAV-CARRIER
  3438                                     PI-CR-CARRIER
  3439         IF CARRIERI NOT = ZEROS
  3440           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3441             MOVE ER-2587        TO  EMI-ERROR
  3442             MOVE -1             TO  CARRIERL
  3443             MOVE AL-UABON       TO  CARRIERA
  3444             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3445         ELSE
  3446             NEXT SENTENCE
  3447     ELSE
  3448         MOVE LOW-VALUES          TO  COMP-CARRIER
  3449                                      PI-SAV-CARRIER.
  3450
  3451     IF CARRIERL NOT = ZEROS
  3452         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3453             IF PI-CARRIER-SECURITY = CARRIERI
  3454                 NEXT SENTENCE
  3455             ELSE
  3456                 MOVE -1         TO  CARRIERL
  3457                 MOVE ER-2370    TO  EMI-ERROR
  3458                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3459
  3460     IF GROUPL NOT = ZEROS
  3461         MOVE AL-UANON           TO  GROUPA
  3462         MOVE GROUPI             TO  COMP-GROUPING
  3463                                     PI-SAV-GROUPING
  3464                                     PI-CR-GROUPING
  3465         IF GROUPI NOT = ZEROS
  3466           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3467             MOVE ER-2588        TO  EMI-ERROR
  3468             MOVE -1             TO  GROUPL
  3469             MOVE AL-UABON       TO  GROUPA
  3470             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3471         ELSE
  3472             NEXT SENTENCE
  3473     ELSE
  3474         MOVE LOW-VALUES         TO  COMP-GROUPING
  3475                                     PI-SAV-GROUPING.
  3476
  3477     IF FINRESPL NOT = ZEROS
  3478         MOVE AL-UANON           TO  FINRESPA
  3479         MOVE FINRESPI           TO  COMP-FIN-RESP
  3480                                     PI-SAV-FIN-RESP
  3481                                     PI-CR-FIN-RESP
  3482     ELSE
  3483         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3484                                     PI-SAV-FIN-RESP.
  3485
  3486     IF ACCTL NOT = ZEROS
  3487         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  70
* EL633.cbl
  3488         MOVE ACCTI              TO  COMP-ACCOUNT
  3489                                     PI-SAV-ACCOUNT
  3490                                     PI-CR-ACCOUNT
  3491     ELSE
  3492         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3493                                     PI-SAV-ACCOUNT
  3494                                     PI-CR-ACCOUNT.
  3495
  3496     IF EMI-ERROR = ZEROS
  3497         NEXT SENTENCE
  3498     ELSE
  3499         IF EIBTRNID = EL640-TRANS-ID OR
  3500            EIBTRNID = EL642-TRANS-ID OR
  3501            EIBTRNID = EL6331-TRANS-ID
  3502             GO TO 8100-SEND-INITIAL-MAP
  3503         ELSE
  3504             GO TO 8200-SEND-DATAONLY.
  3505
  3506     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3507
  3508     IF MAINTI = 'S'
  3509         IF EIBAID = DFHPF1              OR  DFHENTER
  3510             GO TO 4000-BROWSE-FRWD
  3511         ELSE
  3512             GO TO 4100-BROWSE-BKWD.
  3513
  3514     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3515     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3516
  3517
  3518* EXEC CICS HANDLE CONDITION
  3519*        NOTFND   (0410-NO-COMP-MSTR)
  3520*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3521*        END-EXEC.
  3522*    MOVE '"$IJ                  ! # #00003474' TO DFHEIV0
  3523     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3525     MOVE X'2320233030303033343734' TO DFHEIV0(25:11)
  3526     CALL 'kxdfhei1' USING DFHEIV0
  3527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3528
  3529
  3530
  3531* EXEC CICS READ
  3532*        DATASET  (COMP-FILE-ID)
  3533*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3534*        RIDFLD   (ERCOMP-KEY)
  3535*        GTEQ
  3536*        END-EXEC.
  3537*    MOVE '&"S        G          (   #00003479' TO DFHEIV0
  3538     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3540     MOVE X'2020233030303033343739' TO DFHEIV0(25:11)
  3541     CALL 'kxdfhei1' USING DFHEIV0,
  3542           COMP-FILE-ID,
  3543           DFHEIV20,
  3544           DFHEIV99,
  3545           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  71
* EL633.cbl
  3546           DFHEIV99,
  3547           DFHEIV99,
  3548           DFHEIV99
  3549     SET ADDRESS OF COMPENSATION-MASTER TO
  3550         DFHEIV20
  3551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3552
  3553
  3554     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3555        COMP-CARRIER  = CO-CARRIER     AND
  3556        COMP-GROUPING = CO-GROUPING    AND
  3557        COMP-FIN-RESP = CO-RESP-NO    AND
  3558        COMP-ACCOUNT  = CO-ACCOUNT
  3559         NEXT SENTENCE
  3560     ELSE
  3561         GO TO 0410-NO-COMP-MSTR.
  3562
  3563     IF PI-COMPANY-ID = 'NCL'
  3564         IF CO-GA-INACTIVE
  3565             GO TO 0420-INACTIVE-COMP.
  3566
  3567     IF MAINTI = 'C'
  3568         GO TO 1000-EDIT-DATA.
  3569
  3570     IF EIBAID = DFHPF1
  3571       OR DFHENTER
  3572         GO TO 4000-BROWSE-FRWD.
  3573
  3574     IF EIBAID = DFHPF2
  3575         GO TO 4100-BROWSE-BKWD.
  3576
  3577 0410-NO-COMP-MSTR.
  3578     MOVE ER-2230                TO  EMI-ERROR.
  3579     MOVE -1                     TO  CARRIERL.
  3580     MOVE AL-UABON               TO  CARRIERA
  3581                                     GROUPA
  3582                                     FINRESPA
  3583                                     ACCTA.
  3584
  3585     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3586
  3587     GO TO 8200-SEND-DATAONLY.
  3588
  3589 0420-INACTIVE-COMP.
  3590     MOVE ER-2763                TO  EMI-ERROR.
  3591     MOVE -1                     TO  CARRIERL.
  3592     MOVE AL-UABON               TO  CARRIERA
  3593                                     GROUPA
  3594                                     FINRESPA
  3595                                     ACCTA.
  3596
  3597     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3598
  3599     GO TO 8200-SEND-DATAONLY.
  3600
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  72
* EL633.cbl
  3602 0500-CREATE-TEMP-STORAGE.
  3603
  3604     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3605
  3606
  3607* EXEC CICS WRITEQ TS
  3608*        QUEUE  (QID)
  3609*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3610*        LENGTH (PI-COMM-LENGTH)
  3611*    END-EXEC.
  3612*    MOVE '*"                    ''   #00003538' TO DFHEIV0
  3613     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3614     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3615     MOVE X'2020233030303033353338' TO DFHEIV0(25:11)
  3616     CALL 'kxdfhei1' USING DFHEIV0,
  3617           QID,
  3618           PROGRAM-INTERFACE-BLOCK,
  3619           PI-COMM-LENGTH,
  3620           DFHEIV99,
  3621           DFHEIV99,
  3622           DFHEIV99
  3623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3624
  3625
  3626 0590-EXIT.
  3627      EXIT.
  3628
  3629 0600-RECOVER-TEMP-STORAGE.
  3630
  3631* EXEC CICS READQ TS
  3632*        QUEUE  (QID)
  3633*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3634*        LENGTH (PI-COMM-LENGTH)
  3635*    END-EXEC.
  3636*    MOVE '*$I    L              ''   #00003548' TO DFHEIV0
  3637     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3638     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3639     MOVE X'2020233030303033353438' TO DFHEIV0(25:11)
  3640     CALL 'kxdfhei1' USING DFHEIV0,
  3641           QID,
  3642           PROGRAM-INTERFACE-BLOCK,
  3643           PI-COMM-LENGTH,
  3644           DFHEIV99,
  3645           DFHEIV99,
  3646           DFHEIV99
  3647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3648
  3649
  3650     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3651
  3652 0690-EXIT.
  3653      EXIT.
  3654
  3655 0800-DELETE-TS.
  3656
  3657* EXEC CICS HANDLE CONDITION
  3658*        QIDERR (0890-EXIT)
  3659*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  73
* EL633.cbl
  3660*    MOVE '"$N                   ! $ #00003560' TO DFHEIV0
  3661     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3663     MOVE X'2420233030303033353630' TO DFHEIV0(25:11)
  3664     CALL 'kxdfhei1' USING DFHEIV0
  3665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3666
  3667
  3668
  3669* EXEC CICS DELETEQ TS
  3670*        QUEUE  (QID)
  3671*    END-EXEC.
  3672*    MOVE '*&                    #   #00003564' TO DFHEIV0
  3673     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3674     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3675     MOVE X'2020233030303033353634' TO DFHEIV0(25:11)
  3676     CALL 'kxdfhei1' USING DFHEIV0,
  3677           QID,
  3678           DFHEIV99
  3679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3680
  3681
  3682
  3683* EXEC CICS SYNCPOINT
  3684*    END-EXEC.
  3685*    MOVE '6"                    !   #00003568' TO DFHEIV0
  3686     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3687     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3688     MOVE X'2020233030303033353638' TO DFHEIV0(25:11)
  3689     CALL 'kxdfhei1' USING DFHEIV0
  3690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3691
  3692
  3693 0890-EXIT.
  3694      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  74
* EL633.cbl
  3696
  3697 1000-EDIT-DATA.
  3698     SET PINDX                   TO  1.
  3699
  3700     .
  3701 1010-EDIT-LOOP.
  3702     SET NDX                     TO  PINDX.
  3703     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3704        GL-STATE-LEN (PINDX) = ZEROS   AND
  3705        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3706        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3707        RTYPE-LEN (PINDX)     = ZEROS  AND
  3708        AMT-LEN (PINDX)       = ZEROS  AND
  3709        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3710        SDTE-LEN (PINDX)      = ZEROS
  3711         GO TO 1020-INCREMENT-PINDX.
  3712
  3713     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3714         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3715         IF PI-COMPANY-ID NOT = 'WSL'
  3716             NEXT SENTENCE
  3717         ELSE
  3718             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3719             MOVE '4'                   TO  DC-OPTION-CODE
  3720             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3721             IF NO-CONVERSION-ERROR
  3722                 NEXT SENTENCE
  3723             ELSE
  3724                 MOVE ER-2595    TO  EMI-ERROR
  3725                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3726                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3727                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3728     ELSE
  3729         IF PI-COMPANY-ID = 'WSL'
  3730           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3731             MOVE ER-2596        TO  EMI-ERROR
  3732             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3733             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3734             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3735
  3736
  3737     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3738*        MOVE K-SPACE            TO COFA-FILLER
  3739*        MOVE '0001'             TO COFA-COMPANY-X
  3740*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3741         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3742     ELSE
  3743         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3744             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3745             MOVE ER-2957        TO EMI-ERROR
  3746             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3747             PERFORM 9900-ERROR-FORMAT THRU
  3748                     9900-EXIT
  3749             GO TO 1040-CONTINUE-EDIT
  3750         ELSE
  3751             GO TO 1040-CONTINUE-EDIT
  3752         END-IF
  3753     END-IF.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  75
* EL633.cbl
  3754
  3755     IF (PI-COMPANY-ID = 'DCC' or 'CAP')
  3756        AND (RTYPE (PINDX) = 'P')
  3757        GO TO 1040-CONTINUE-EDIT
  3758     END-IF
  3759     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3760        MOVE GL-ACCT (PINDX)     TO CHECK-GL-ACCT
  3761     ELSE
  3762        MOVE SPACES              TO CHECK-GL-ACCT
  3763     END-IF
  3764
  3765     EVALUATE TRUE
  3766        WHEN (PI-COMPANY-ID = 'DCC' or 'CAP')
  3767           AND (CO-CARRIER = '1' OR '2' or '9')
  3768           AND (VALID-DCC-GL-ACCOUNT)
  3769           GO TO 1040-CONTINUE-EDIT
  3770        WHEN (PI-COMPANY-ID = 'DCC' or 'CAP')
  3771           AND (CO-CARRIER = '3' OR '4')
  3772           AND VALID-CSI-GL-ACCOUNT
  3773           GO TO 1040-CONTINUE-EDIT
  3774        WHEN (PI-COMPANY-ID = 'DCC' or 'CAP')
  3775           AND (CO-CARRIER = '5' OR '6' or '7')
  3776           AND (VALID-CCC-GL-ACCOUNT)
  3777           GO TO 1040-CONTINUE-EDIT
  3778        WHEN (PI-COMPANY-ID = 'CID' OR 'AHL')
  3779           AND (VALID-GL-ACCOUNT)
  3780           GO TO 1040-CONTINUE-EDIT
  3781     END-EVALUATE
  3782*    EXEC CICS HANDLE CONDITION
  3783*         NOTFND (1040-NO-COFA-MSTR)
  3784*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3785*    END-EXEC.
  3786*
  3787*    EXEC CICS READ
  3788*         DATASET (COFA-FILE-ID)
  3789*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3790*         RIDFLD  (COFA-KEY-X)
  3791*    END-EXEC.
  3792*
  3793*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3794*    GO TO 1040-CONTINUE-EDIT.
  3795*
  3796*1040-NO-COFA-MSTR.
  3797
  3798     MOVE ER-2960                TO EMI-ERROR.
  3799     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3800     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3801     PERFORM 9900-ERROR-FORMAT THRU
  3802             9900-EXIT.
  3803
  3804 1040-CONTINUE-EDIT.
  3805
  3806*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3807     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3808         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
  3809         IF NOT VALID-STATE-CODE
  3810             MOVE -1             TO GL-STATE-LEN (PINDX)
  3811             MOVE ER-2957        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  76
* EL633.cbl
  3812             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3813             PERFORM 9900-ERROR-FORMAT THRU
  3814                     9900-EXIT
  3815         ELSE
  3816             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3817         END-IF
  3818     END-IF.
  3819
  3820 1040-CSO-SKIP.
  3821
  3822     IF GL-CANC (PINDX) = LOW-VALUES
  3823         MOVE SPACES             TO GL-CANC (PINDX)
  3824     END-IF.
  3825
  3826     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3827         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3828         IF NOT VALID-CANC-TYPE
  3829             MOVE -1             TO GL-CANC-LEN (PINDX)
  3830             MOVE ER-2958        TO EMI-ERROR
  3831             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3832             PERFORM 9900-ERROR-FORMAT THRU
  3833                     9900-EXIT
  3834         ELSE
  3835             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3836         END-IF
  3837     END-IF.
  3838
  3839     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3840        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3841        IF (PI-COMPANY-ID = 'DCC' or 'CAP')
  3842           AND (RTYPE (PINDX) = 'P')
  3843           SET VALID-REC-TYPE   TO TRUE
  3844        END-IF
  3845         IF NOT VALID-REC-TYPE
  3846             MOVE -1             TO  RTYPE-LEN (PINDX)
  3847             MOVE ER-2234        TO  EMI-ERROR
  3848             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3849             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3850         ELSE
  3851             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3852     ELSE
  3853         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3854             MOVE -1             TO  RTYPE-LEN (PINDX)
  3855             MOVE ER-2235        TO  EMI-ERROR
  3856             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3857             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3858
  3859     IF AMT-LEN (PINDX) NOT = ZEROS
  3860
  3861* EXEC CICS BIF DEEDIT
  3862*           FIELD (AMT (PINDX))
  3863*           LENGTH (11)
  3864*       END-EXEC
  3865     MOVE 11
  3866       TO DFHEIV11
  3867*    MOVE '@"L                   #   #00003738' TO DFHEIV0
  3868     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3869     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  77
* EL633.cbl
  3870     MOVE X'2020233030303033373338' TO DFHEIV0(25:11)
  3871     CALL 'kxdfhei1' USING DFHEIV0,
  3872           AMT(PINDX),
  3873           DFHEIV11
  3874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3875         IF AMT (PINDX) = ZEROS
  3876             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3877                 NEXT SENTENCE
  3878             ELSE
  3879                 MOVE ER-2245    TO  EMI-ERROR
  3880                 MOVE -1         TO  AMT-LEN(PINDX)
  3881                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3882                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3883         ELSE
  3884             IF AMT (PINDX) NUMERIC
  3885                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3886             ELSE
  3887                 MOVE ER-2245    TO  EMI-ERROR
  3888                 MOVE -1         TO  AMT-LEN(PINDX)
  3889                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3890                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3891     ELSE
  3892         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3893             MOVE -1             TO  AMT-LEN (PINDX)
  3894             MOVE ER-2236        TO  EMI-ERROR
  3895             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3896             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3897
  3898     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3899         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3900           AND (PI-REC-TYPE (NDX) = 'C')
  3901             IF VOID-SW (PINDX) = 'V'
  3902                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3903             ELSE
  3904                 MOVE ER-2246    TO  EMI-ERROR
  3905                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3906                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3907                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3908         ELSE
  3909             MOVE ER-2449        TO  EMI-ERROR
  3910             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3911             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3912             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3913
  3914     IF SDTE-LEN (PINDX) = ZEROS
  3915        GO TO 1020-INCREMENT-PINDX.
  3916
  3917     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3918
  3919     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3920     PERFORM 8600-DEEDIT.
  3921
  3922     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3923        GO TO 1015-DAY-ERROR.
  3924
  3925     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3926     MOVE '4'                    TO  DC-OPTION-CODE.
  3927     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  78
* EL633.cbl
  3928
  3929     IF NO-CONVERSION-ERROR
  3930        SET PINDEX               TO  PINDX
  3931        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3932     ELSE
  3933        GO TO 1015-DAY-ERROR.
  3934
  3935     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3936
  3937     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3938         IF DATE-TEST-DD  NOT = 30
  3939             GO TO 1015-DAY-ERROR
  3940         ELSE
  3941             GO TO 1020-INCREMENT-PINDX.
  3942
  3943     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3944                             8  OR  10  OR  12
  3945         IF DATE-TEST-DD  NOT = 31
  3946             GO TO 1015-DAY-ERROR
  3947         ELSE
  3948             GO TO 1020-INCREMENT-PINDX.
  3949
  3950     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3951         REMAINDER  DIVIDE-REMAINDER.
  3952
  3953     IF (DATE-TEST-YY = ZERO)
  3954       OR (DIVIDE-REMAINDER NOT = ZERO)
  3955         IF DATE-TEST-DD  NOT = 28
  3956             GO TO 1015-DAY-ERROR
  3957         ELSE
  3958             GO TO 1020-INCREMENT-PINDX
  3959     ELSE
  3960         IF DATE-TEST-DD = 29
  3961             GO TO 1020-INCREMENT-PINDX.
  3962
  3963 1015-DAY-ERROR.
  3964     MOVE -1                     TO  SDTE-LEN (PINDX).
  3965     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  3966     MOVE ER-0587                TO  EMI-ERROR.
  3967
  3968     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3969
  3970 1020-INCREMENT-PINDX.
  3971     SET PINDX  UP  BY  1.
  3972
  3973     IF PINDX  IS NOT GREATER THAN  13
  3974         GO TO 1010-EDIT-LOOP.
  3975
  3976     IF EMI-ERROR = ZEROS
  3977         NEXT SENTENCE
  3978     ELSE
  3979         MOVE 'S'                TO  PI-PREV-FUNCTION
  3980         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  79
* EL633.cbl
  3982 2000-UPDATE-THE-FILE.
  3983     SET PINDX                   TO  ZERO-NDX.
  3984*    SET NDX                     TO  ZERO-NDX.
  3985*    SET NDX  UP  BY  1.
  3986
  3987     IF PI-PYAJ-FILE-SW = 'B'
  3988         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  3989         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  3990     ELSE
  3991         MOVE PI-LAST-FILE-SEQ-NO
  3992                                 TO  PI-SAV-FILE-SEQ-NO
  3993         MOVE PI-LAST-RECORD-TYPE
  3994                                 TO  PI-SAV-RECORD-TYPE.
  3995
  3996 2100-UPDATE-LOOP.
  3997     SET PINDX  UP  BY  1.
  3998     SET NDX                     TO  PINDX.
  3999
  4000     IF PINDX  IS GREATER THAN  13
  4001         GO TO 2200-UPDATE-COMPLETE.
  4002
  4003     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  4004        GL-STATE-LEN (PINDX) = ZEROS AND
  4005        GL-CANC-LEN (PINDX)   = ZEROS AND
  4006        GL-COMM-LEN (PINDX)   = ZEROS AND
  4007        RTYPE-LEN (PINDX)   = ZEROS  AND
  4008        AMT-LEN (PINDX)     = ZEROS  AND
  4009        VOID-SW-LEN (PINDX) = ZEROS  AND
  4010        SDTE-LEN (PINDX)    = ZEROS
  4011         GO TO 2100-UPDATE-LOOP.
  4012
  4013
  4014* EXEC CICS BIF DEEDIT
  4015*         FIELD (AMT (PINDX))
  4016*         LENGTH (11)
  4017*    END-EXEC.
  4018     MOVE 11
  4019       TO DFHEIV11
  4020*    MOVE '@"L                   #   #00003880' TO DFHEIV0
  4021     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4022     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4023     MOVE X'2020233030303033383830' TO DFHEIV0(25:11)
  4024     CALL 'kxdfhei1' USING DFHEIV0,
  4025           AMT(PINDX),
  4026           DFHEIV11
  4027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4028
  4029
  4030     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4031         NEXT SENTENCE
  4032     ELSE
  4033         GO TO 2110-ADD-RECORD.
  4034
  4035
  4036* EXEC CICS HANDLE CONDITION
  4037*        NOTFND  (2110-ADD-RECORD)
  4038*    END-EXEC.
  4039*    MOVE '"$I                   ! % #00003890' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  80
* EL633.cbl
  4040     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4042     MOVE X'2520233030303033383930' TO DFHEIV0(25:11)
  4043     CALL 'kxdfhei1' USING DFHEIV0
  4044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4045
  4046
  4047     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4048     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4049     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4050
  4051
  4052* EXEC CICS READ
  4053*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4054*        DATASET  (PYAJ-FILE-ID)
  4055*        RIDFLD   (ERPYAJ-KEY)
  4056*        UPDATE
  4057*    END-EXEC.
  4058*    MOVE '&"S        EU         (   #00003898' TO DFHEIV0
  4059     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4060     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4061     MOVE X'2020233030303033383938' TO DFHEIV0(25:11)
  4062     CALL 'kxdfhei1' USING DFHEIV0,
  4063           PYAJ-FILE-ID,
  4064           DFHEIV20,
  4065           DFHEIV99,
  4066           ERPYAJ-KEY,
  4067           DFHEIV99,
  4068           DFHEIV99,
  4069           DFHEIV99
  4070     SET ADDRESS OF PENDING-PAY-ADJ TO
  4071         DFHEIV20
  4072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4073
  4074
  4075
  4076     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4077        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4078            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4079            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4080            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4081
  4082     IF AMT-LEN (PINDX) NOT = ZEROS
  4083         IF AMT (PINDX) = ZEROS
  4084             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4085                 GO TO 2120-DELETE-RECORD
  4086             ELSE
  4087                 MOVE ER-2244       TO  EMI-ERROR
  4088                 MOVE -1            TO  AMT-LEN (PINDX)
  4089                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4090                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4091                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4092
  4093* EXEC CICS UNLOCK
  4094*                    DATASET  (PYAJ-FILE-ID)
  4095*                END-EXEC
  4096*    MOVE '&*                    #   #00003922' TO DFHEIV0
  4097     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  81
* EL633.cbl
  4098     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4099     MOVE X'2020233030303033393232' TO DFHEIV0(25:11)
  4100     CALL 'kxdfhei1' USING DFHEIV0,
  4101           PYAJ-FILE-ID,
  4102           DFHEIV99
  4103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4104                 GO TO 8200-SEND-DATAONLY.
  4105
  4106     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4107     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4108     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4109
  4110     PERFORM 8400-LOG-JOURNAL-RECORD.
  4111
  4112     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4113     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4114     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4115
  4116     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4117         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4118     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4119         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4120     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4121         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4122     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4123         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4124     IF AMT-LEN (PINDX) NOT = ZEROS
  4125         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4126
  4127     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4128         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4129
  4130     IF SDTE-LEN (PINDX) NOT = ZEROS
  4131        SET PINDEX               TO  PINDX
  4132        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4133
  4134     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4135     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4136     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4137
  4138
  4139* EXEC CICS REWRITE
  4140*        DATASET  (PYAJ-FILE-ID)
  4141*        FROM     (PENDING-PAY-ADJ)
  4142*    END-EXEC.
  4143     MOVE LENGTH OF
  4144      PENDING-PAY-ADJ
  4145       TO DFHEIV11
  4146*    MOVE '&& L                  %   #00003959' TO DFHEIV0
  4147     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4148     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4149     MOVE X'2020233030303033393539' TO DFHEIV0(25:11)
  4150     CALL 'kxdfhei1' USING DFHEIV0,
  4151           PYAJ-FILE-ID,
  4152           PENDING-PAY-ADJ,
  4153           DFHEIV11,
  4154           DFHEIV99
  4155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  82
* EL633.cbl
  4156
  4157
  4158     PERFORM 8400-LOG-JOURNAL-RECORD.
  4159
  4160     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  83
* EL633.cbl
  4162 2110-ADD-RECORD.
  4163
  4164* EXEC CICS GETMAIN
  4165*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4166*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4167*        INITIMG  (GETMAIN-SPACE)
  4168*    END-EXEC.
  4169*    MOVE ',"IL                  $   #00003969' TO DFHEIV0
  4170     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4171     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4172     MOVE X'2020233030303033393639' TO DFHEIV0(25:11)
  4173     CALL 'kxdfhei1' USING DFHEIV0,
  4174           DFHEIV20,
  4175           ERPYAJ-RECORD-LENGTH,
  4176           GETMAIN-SPACE
  4177     SET ADDRESS OF PENDING-PAY-ADJ TO
  4178         DFHEIV20
  4179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4180
  4181
  4182     MOVE 'PY'                   TO  PY-RECORD-ID.
  4183     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4184     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4185     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4186     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4187     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4188
  4189     ADD +1                      TO  WORK-SEQ-NO.
  4190     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4191
  4192     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4193     MOVE GL-STATE (PINDX)       TO  PY-GL-STATE.
  4194     MOVE GL-CANC (PINDX)        TO  PY-GL-CANC-SW.
  4195     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4196
  4197     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4198     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4199     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4200        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4201     END-IF
  4202     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4203     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4204     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4205                                     PY-INPUT-DT.
  4206     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4207                                     PY-CHECK-QUE-SEQUENCE.
  4208     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4209                                     PY-BILLED-DATE
  4210                                     PY-AR-DATE
  4211                                     PY-REPORTED-DT
  4212                                     PY-CHECK-WRITTEN-DT.
  4213     IF SDTE-LEN (PINDX) = ZEROS
  4214         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4215         GO TO 2115-WRITE-REC
  4216     END-IF.
  4217
  4218     IF SDTE (PINDX) IS NUMERIC
  4219         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  84
* EL633.cbl
  4220         MOVE '4'            TO  DC-OPTION-CODE
  4221         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4222         IF DATE-CONVERSION-ERROR
  4223             MOVE PI-CR-MONTH-END-DT
  4224                             TO  PY-CREDIT-SELECT-DT
  4225         ELSE
  4226             MOVE DC-BIN-DATE-1
  4227                             TO  PY-CREDIT-SELECT-DT
  4228         END-IF
  4229     ELSE
  4230         MOVE PI-CR-MONTH-END-DT
  4231                             TO  PY-CREDIT-SELECT-DT
  4232     END-IF
  4233
  4234     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4235         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4236         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4237
  4238     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4239         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4240         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4241
  4242     MOVE 'N'                    TO  FIRST-ADD-SW.
  4243
  4244     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4245     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4246     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4247 2115-WRITE-REC.
  4248
  4249* EXEC CICS WRITE
  4250*        DATASET  (PYAJ-FILE-ID)
  4251*        FROM     (PENDING-PAY-ADJ)
  4252*        RIDFLD   (PY-CONTROL-PRIMARY)
  4253*    END-EXEC.
  4254     MOVE LENGTH OF
  4255      PENDING-PAY-ADJ
  4256       TO DFHEIV11
  4257*    MOVE '&$ L                  ''   #00004041' TO DFHEIV0
  4258     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4259     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4260     MOVE X'2020233030303034303431' TO DFHEIV0(25:11)
  4261     CALL 'kxdfhei1' USING DFHEIV0,
  4262           PYAJ-FILE-ID,
  4263           PENDING-PAY-ADJ,
  4264           DFHEIV11,
  4265           PY-CONTROL-PRIMARY,
  4266           DFHEIV99,
  4267           DFHEIV99
  4268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4269
  4270
  4271     PERFORM 8400-LOG-JOURNAL-RECORD.
  4272
  4273     GO TO 2100-UPDATE-LOOP.
  4274
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  85
* EL633.cbl
  4276 2120-DELETE-RECORD.
  4277     IF PY-RECORD-TYPE NOT = 'C'
  4278         GO TO 2120-DELETE-CONT.
  4279
  4280     IF PY-CHECK-QUE-CONTROL = ZEROS
  4281       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4282         GO TO 2120-DELETE-CONT.
  4283
  4284
  4285* EXEC CICS HANDLE CONDITION
  4286*        NOTFND  (2120-DELETE-CONT)
  4287*    END-EXEC.
  4288*    MOVE '"$I                   ! & #00004060' TO DFHEIV0
  4289     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4290     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4291     MOVE X'2620233030303034303630' TO DFHEIV0(25:11)
  4292     CALL 'kxdfhei1' USING DFHEIV0
  4293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4294
  4295
  4296     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4297     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4298     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4299
  4300
  4301* EXEC CICS READ
  4302*        SET      (ADDRESS OF CHECK-QUE)
  4303*        DATASET  (CHKQ-FILE-ID)
  4304*        RIDFLD   (ERCHKQ-KEY)
  4305*        UPDATE
  4306*    END-EXEC.
  4307*    MOVE '&"S        EU         (   #00004068' TO DFHEIV0
  4308     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4309     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4310     MOVE X'2020233030303034303638' TO DFHEIV0(25:11)
  4311     CALL 'kxdfhei1' USING DFHEIV0,
  4312           CHKQ-FILE-ID,
  4313           DFHEIV20,
  4314           DFHEIV99,
  4315           ERCHKQ-KEY,
  4316           DFHEIV99,
  4317           DFHEIV99,
  4318           DFHEIV99
  4319     SET ADDRESS OF CHECK-QUE TO
  4320         DFHEIV20
  4321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4322
  4323
  4324*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4325*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4326*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4327*
  4328*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4329
  4330
  4331* EXEC CICS DELETE
  4332*        DATASET  (CHKQ-FILE-ID)
  4333*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  86
* EL633.cbl
  4334*    MOVE '&(                    &   #00004081' TO DFHEIV0
  4335     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4336     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4337     MOVE X'2020233030303034303831' TO DFHEIV0(25:11)
  4338     CALL 'kxdfhei1' USING DFHEIV0,
  4339           CHKQ-FILE-ID,
  4340           DFHEIV99,
  4341           DFHEIV99,
  4342           DFHEIV99,
  4343           DFHEIV99
  4344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4345
  4346
  4347 2120-DELETE-CONT.
  4348*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4349*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4350*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4351*
  4352*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4353
  4354     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4355         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4356         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4357         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4358                                     PI-SAV-ACCT-NET
  4359                                     PI-SAV-PREV-AMT
  4360                                     PI-SAV-PREV-NET.
  4361
  4362
  4363* EXEC CICS DELETE
  4364*        DATASET(PYAJ-FILE-ID)
  4365*    END-EXEC.
  4366*    MOVE '&(                    &   #00004100' TO DFHEIV0
  4367     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4368     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4369     MOVE X'2020233030303034313030' TO DFHEIV0(25:11)
  4370     CALL 'kxdfhei1' USING DFHEIV0,
  4371           PYAJ-FILE-ID,
  4372           DFHEIV99,
  4373           DFHEIV99,
  4374           DFHEIV99,
  4375           DFHEIV99
  4376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4377
  4378
  4379     GO TO 2100-UPDATE-LOOP.
  4380
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  87
* EL633.cbl
  4382
  4383 2190-CHANGE-RECORD-TYPE.
  4384
  4385*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4386*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4387*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4388*
  4389*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4390
  4391
  4392* EXEC CICS DELETE
  4393*        DATASET(PYAJ-FILE-ID)
  4394*    END-EXEC.
  4395*    MOVE '&(                    &   #00004116' TO DFHEIV0
  4396     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4397     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4398     MOVE X'2020233030303034313136' TO DFHEIV0(25:11)
  4399     CALL 'kxdfhei1' USING DFHEIV0,
  4400           PYAJ-FILE-ID,
  4401           DFHEIV99,
  4402           DFHEIV99,
  4403           DFHEIV99,
  4404           DFHEIV99
  4405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4406
  4407
  4408
  4409* EXEC CICS GETMAIN
  4410*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4411*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4412*        INITIMG  (GETMAIN-SPACE)
  4413*    END-EXEC.
  4414*    MOVE ',"IL                  $   #00004120' TO DFHEIV0
  4415     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4416     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4417     MOVE X'2020233030303034313230' TO DFHEIV0(25:11)
  4418     CALL 'kxdfhei1' USING DFHEIV0,
  4419           DFHEIV20,
  4420           ERPYAJ-RECORD-LENGTH,
  4421           GETMAIN-SPACE
  4422     SET ADDRESS OF PENDING-PAY-ADJ TO
  4423         DFHEIV20
  4424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4425
  4426
  4427*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4428*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4429
  4430     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4431     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4432                                    PYAJ-RECORD-TYPE.
  4433
  4434
  4435* EXEC CICS HANDLE CONDITION
  4436*        DUPREC (2190-DUP-RECORD)
  4437*    END-EXEC.
  4438*    MOVE '"$%                   ! '' #00004133' TO DFHEIV0
  4439     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  88
* EL633.cbl
  4440     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4441     MOVE X'2720233030303034313333' TO DFHEIV0(25:11)
  4442     CALL 'kxdfhei1' USING DFHEIV0
  4443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4444
  4445
  4446*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4447*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4448*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4449
  4450 2190-RETRY-WRITE.
  4451
  4452
  4453* EXEC CICS WRITE
  4454*        DATASET  (PYAJ-FILE-ID)
  4455*        FROM     (PENDING-PAY-ADJ)
  4456*        RIDFLD   (PY-CONTROL-PRIMARY)
  4457*    END-EXEC.
  4458     MOVE LENGTH OF
  4459      PENDING-PAY-ADJ
  4460       TO DFHEIV11
  4461*    MOVE '&$ L                  ''   #00004143' TO DFHEIV0
  4462     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4463     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4464     MOVE X'2020233030303034313433' TO DFHEIV0(25:11)
  4465     CALL 'kxdfhei1' USING DFHEIV0,
  4466           PYAJ-FILE-ID,
  4467           PENDING-PAY-ADJ,
  4468           DFHEIV11,
  4469           PY-CONTROL-PRIMARY,
  4470           DFHEIV99,
  4471           DFHEIV99
  4472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4473
  4474
  4475*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4476
  4477
  4478* EXEC CICS READ
  4479*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4480*        DATASET  (PYAJ-FILE-ID)
  4481*        RIDFLD   (ERPYAJ-KEY)
  4482*        UPDATE
  4483*    END-EXEC.
  4484*    MOVE '&"S        EU         (   #00004151' TO DFHEIV0
  4485     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4486     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4487     MOVE X'2020233030303034313531' TO DFHEIV0(25:11)
  4488     CALL 'kxdfhei1' USING DFHEIV0,
  4489           PYAJ-FILE-ID,
  4490           DFHEIV20,
  4491           DFHEIV99,
  4492           ERPYAJ-KEY,
  4493           DFHEIV99,
  4494           DFHEIV99,
  4495           DFHEIV99
  4496     SET ADDRESS OF PENDING-PAY-ADJ TO
  4497         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  89
* EL633.cbl
  4498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4499
  4500
  4501     GO TO 2190-EXIT.
  4502
  4503 2190-DUP-RECORD.
  4504
  4505     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4506
  4507     GO TO 2190-RETRY-WRITE.
  4508
  4509 2190-EXIT.
  4510     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  90
* EL633.cbl
  4512
  4513 2200-UPDATE-COMPLETE.
  4514     IF EIBAID = DFHPF1
  4515         GO TO 4000-BROWSE-FRWD.
  4516
  4517     IF EIBAID = DFHPF2
  4518         GO TO 4100-BROWSE-BKWD.
  4519
  4520     MOVE LOW-VALUES             TO  EL633AI.
  4521
  4522     MOVE ER-0000                TO  EMI-ERROR.
  4523     MOVE -1                     TO  MAINTL.
  4524
  4525     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4526
  4527     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4528     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4529
  4530*    GO TO 4000-BROWSE-FRWD.
  4531
  4532*    GO TO 8100-SEND-INITIAL-MAP.
  4533
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  91
* EL633.cbl
  4535 4000-BROWSE-FRWD.
  4536     MOVE '1'                     TO  PI-PREV-PFKEY.
  4537     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4538
  4539     IF EIBAID = DFHPF1
  4540         IF PAGE-FULL
  4541             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4542                                      TO  PYAJ-FILE-SEQ-NO
  4543             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4544             MOVE 'N'                 TO  PYAJ-READ-SW
  4545             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4546             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4547             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4548             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4549         ELSE
  4550             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4551                                          PI-SAV-ACCT-NET
  4552                                          PI-SAV-PREV-AMT
  4553                                          PI-SAV-PREV-NET
  4554             MOVE 'Y'                 TO  PI-PAGE-SW
  4555             IF NOT END-OF-FILE
  4556                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4557                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4558             END-IF
  4559             IF TOP-OF-FILE
  4560                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4561                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4562                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4563             ELSE
  4564                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4565                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4566     ELSE
  4567         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4568         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4569         IF MAINTI = 'S'
  4570             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4571             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4572
  4573
  4574     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4575
  4576     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4577         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4578
  4579 4000-BROWSE-FRWD-FOR-PREV.
  4580*    IF END-OF-FILE
  4581*        IF EIBAID = DFHPF1
  4582*           IF PI-TOTAL-DISPLAYED
  4583*              NEXT SENTENCE
  4584*           ELSE
  4585*              MOVE -1                 TO  MAINTL
  4586*              MOVE ER-2237            TO  EMI-ERROR
  4587*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4588*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4589*              SET PINDX               TO  +2
  4590*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4591*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4592*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  92
* EL633.cbl
  4593*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4594*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4595*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4596*                                          PI-SAV-ACCT-NET
  4597*              GO TO 8100-SEND-INITIAL-MAP.
  4598*
  4599*     IF END-OF-FILE
  4600*        IF EIBAID = DFHPF1
  4601*           MOVE -1             TO  MAINTL
  4602*           MOVE ER-2237        TO  EMI-ERROR
  4603*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4604*           GO TO 8200-SEND-DATAONLY.
  4605*
  4606     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4607
  4608     IF NO-RECORDS
  4609        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4610        MOVE LOW-VALUES         TO  EL633AO
  4611        MOVE ER-2239            TO  EMI-ERROR
  4612        MOVE -1                 TO  MAINTL
  4613        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4614        GO TO 8100-SEND-INITIAL-MAP.
  4615
  4616     IF NOT-OPEN
  4617         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4618
  4619     MOVE LOW-VALUES             TO  EL633AO.
  4620     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4621
  4622     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4623          VARYING  PINDX  FROM  1  BY  1
  4624             UNTIL  END-OF-ACCT
  4625                 OR  END-OF-FILE
  4626                     OR  PAGE-FULL
  4627                         OR  NO-RECORDS.
  4628
  4629     IF NO-RECORDS
  4630         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4631         MOVE LOW-VALUES         TO  EL633AO
  4632         MOVE ER-2239            TO  EMI-ERROR
  4633         MOVE -1                 TO  MAINTL
  4634         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4635         GO TO 8100-SEND-INITIAL-MAP.
  4636
  4637     IF END-OF-FILE
  4638         IF EIBAID = DFHPF2
  4639             MOVE ER-2238        TO  EMI-ERROR
  4640             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4641             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4642         ELSE
  4643             MOVE ER-2237        TO  EMI-ERROR
  4644             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4645
  4646     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4647                                     PI-SAV-FUNCTION.
  4648
  4649     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  93
* EL633.cbl
  4651 4100-BROWSE-BKWD.
  4652     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4653                                      PI-TOTAL-DISPLAYED-SW.
  4654     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4655     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4656     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4657     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4658                                      PI-SAV-ACCT-NET
  4659                                      PI-SAV-PREV-AMT
  4660                                      PI-SAV-PREV-NET.
  4661
  4662     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4663
  4664     IF NO-RECORDS
  4665         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4666         MOVE LOW-VALUES         TO  EL633AO
  4667         MOVE ER-2239            TO  EMI-ERROR
  4668         MOVE -1                 TO  MAINTL
  4669         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4670         GO TO 8100-SEND-INITIAL-MAP.
  4671
  4672     IF NOT-OPEN
  4673         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4674
  4675
  4676* EXEC CICS READNEXT
  4677*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4678*        DATASET  (PYAJ-FILE-ID)
  4679*        RIDFLD   (ERPYAJ-KEY)
  4680*    END-EXEC.
  4681     MOVE 0
  4682       TO DFHEIV11
  4683*    MOVE '&.S                   )   #00004332' TO DFHEIV0
  4684     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4685     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4686     MOVE X'2020233030303034333332' TO DFHEIV0(25:11)
  4687     CALL 'kxdfhei1' USING DFHEIV0,
  4688           PYAJ-FILE-ID,
  4689           DFHEIV20,
  4690           DFHEIV99,
  4691           ERPYAJ-KEY,
  4692           DFHEIV99,
  4693           DFHEIV11,
  4694           DFHEIV99,
  4695           DFHEIV99
  4696     SET ADDRESS OF PENDING-PAY-ADJ TO
  4697         DFHEIV20
  4698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4699
  4700
  4701     IF FIRST-PAGE OR
  4702        PI-PREV-PFKEY = '2'
  4703         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4704         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4705
  4706     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4707
  4708     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  94
* EL633.cbl
  4709     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4710     MOVE '2'                     TO  PI-PREV-PFKEY.
  4711
  4712     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  95
* EL633.cbl
  4714 5000-START-BROWSE.
  4715
  4716* EXEC CICS HANDLE CONDITION
  4717*        NOTOPEN  (5010-NOT-OPEN)
  4718*        NOTFND   (5020-NO-RECORDS)
  4719*        ENDFILE  (5020-NO-RECORDS)
  4720*    END-EXEC.
  4721*    MOVE '"$JI''                 ! ( #00004352' TO DFHEIV0
  4722     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4723     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4724     MOVE X'2820233030303034333532' TO DFHEIV0(25:11)
  4725     CALL 'kxdfhei1' USING DFHEIV0
  4726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4727
  4728
  4729
  4730* EXEC CICS STARTBR
  4731*        DATASET  (PYAJ-FILE-ID)
  4732*        RIDFLD   (ERPYAJ-KEY)
  4733*    END-EXEC.
  4734     MOVE 0
  4735       TO DFHEIV11
  4736*    MOVE '&,         G          &   #00004358' TO DFHEIV0
  4737     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4738     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4739     MOVE X'2020233030303034333538' TO DFHEIV0(25:11)
  4740     CALL 'kxdfhei1' USING DFHEIV0,
  4741           PYAJ-FILE-ID,
  4742           ERPYAJ-KEY,
  4743           DFHEIV99,
  4744           DFHEIV11,
  4745           DFHEIV99
  4746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4747
  4748
  4749     GO TO 5030-EXIT.
  4750
  4751 5010-NOT-OPEN.
  4752     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4753
  4754     GO TO 5030-EXIT.
  4755
  4756 5020-NO-RECORDS.
  4757     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4758     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4759
  4760 5030-EXIT.
  4761     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  96
* EL633.cbl
  4763 5100-READ-PREVIOUS.
  4764
  4765* EXEC CICS HANDLE CONDITION
  4766*        ENDFILE  (5110-END-OF-FILE)
  4767*        NOTFND   (5110-END-OF-FILE)
  4768*    END-EXEC.
  4769*    MOVE '"$''I                  ! ) #00004378' TO DFHEIV0
  4770     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4771     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4772     MOVE X'2920233030303034333738' TO DFHEIV0(25:11)
  4773     CALL 'kxdfhei1' USING DFHEIV0
  4774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4775
  4776
  4777
  4778* EXEC CICS READPREV
  4779*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4780*        DATASET  (PYAJ-FILE-ID)
  4781*        RIDFLD   (ERPYAJ-KEY)
  4782*    END-EXEC.
  4783     MOVE 0
  4784       TO DFHEIV11
  4785*    MOVE '&0S                   )   #00004383' TO DFHEIV0
  4786     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4787     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4788     MOVE X'2020233030303034333833' TO DFHEIV0(25:11)
  4789     CALL 'kxdfhei1' USING DFHEIV0,
  4790           PYAJ-FILE-ID,
  4791           DFHEIV20,
  4792           DFHEIV99,
  4793           ERPYAJ-KEY,
  4794           DFHEIV99,
  4795           DFHEIV11,
  4796           DFHEIV99,
  4797           DFHEIV99
  4798     SET ADDRESS OF PENDING-PAY-ADJ TO
  4799         DFHEIV20
  4800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4801
  4802
  4803     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4804         IF PI-CARRIER-SECURITY = PY-CARRIER
  4805             NEXT SENTENCE
  4806         ELSE
  4807             GO TO 5110-END-OF-FILE.
  4808
  4809     GO TO 5120-EXIT.
  4810
  4811 5110-END-OF-FILE.
  4812     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4813     MOVE ER-2238                TO  EMI-ERROR.
  4814     MOVE -1                     TO  PFENTERL.
  4815
  4816     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4817
  4818     GO TO 8200-SEND-DATAONLY.
  4819
  4820 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  97
* EL633.cbl
  4821     EXIT.
  4822
  4823 5200-END-BROWSE.
  4824
  4825* EXEC CICS ENDBR
  4826*        DATASET  (PYAJ-FILE-ID)
  4827*    END-EXEC.
  4828     MOVE 0
  4829       TO DFHEIV11
  4830*    MOVE '&2                    $   #00004410' TO DFHEIV0
  4831     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4832     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4833     MOVE X'2020233030303034343130' TO DFHEIV0(25:11)
  4834     CALL 'kxdfhei1' USING DFHEIV0,
  4835           PYAJ-FILE-ID,
  4836           DFHEIV11,
  4837           DFHEIV99
  4838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4839
  4840
  4841 5200-EXIT.
  4842     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  98
* EL633.cbl
  4844 6000-READ-AND-FORMAT-SCREEN.
  4845
  4846* EXEC CICS HANDLE CONDITION
  4847*        ENDFILE  (6100-END-OF-FILE)
  4848*        NOTFND   (6100-END-OF-FILE)
  4849*    END-EXEC.
  4850*    MOVE '"$''I                  ! * #00004418' TO DFHEIV0
  4851     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4853     MOVE X'2A20233030303034343138' TO DFHEIV0(25:11)
  4854     CALL 'kxdfhei1' USING DFHEIV0
  4855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4856
  4857
  4858*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4859*    INITIALIZE  PI-SEQ-NOS.
  4860
  4861 6010-READ-NEXT.
  4862
  4863
  4864* EXEC CICS READNEXT
  4865*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4866*        DATASET  (PYAJ-FILE-ID)
  4867*        RIDFLD   (ERPYAJ-KEY)
  4868*    END-EXEC.
  4869     MOVE 0
  4870       TO DFHEIV11
  4871*    MOVE '&.S                   )   #00004428' TO DFHEIV0
  4872     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4873     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4874     MOVE X'2020233030303034343238' TO DFHEIV0(25:11)
  4875     CALL 'kxdfhei1' USING DFHEIV0,
  4876           PYAJ-FILE-ID,
  4877           DFHEIV20,
  4878           DFHEIV99,
  4879           ERPYAJ-KEY,
  4880           DFHEIV99,
  4881           DFHEIV11,
  4882           DFHEIV99,
  4883           DFHEIV99
  4884     SET ADDRESS OF PENDING-PAY-ADJ TO
  4885         DFHEIV20
  4886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4887
  4888
  4889     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4890       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4891         GO TO 6100-END-OF-FILE.
  4892
  4893     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4894         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4895             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4896                 GO TO 6100-END-OF-FILE.
  4897
  4898     IF PYAJ-1ST-READ
  4899       AND EIBAID NOT = DFHENTER
  4900       AND NOT PAGE-FULL
  4901         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page  99
* EL633.cbl
  4902         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4903         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4904         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4905         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4906
  4907     IF PYAJ-1ST-READ
  4908         MOVE PI-SAV-ENDING-PYAJ-KEY
  4909                                 TO  PI-START-PYAJ-KEY.
  4910
  4911     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4912        PI-SAV-CARRIER  = PY-CARRIER     AND
  4913        PI-SAV-GROUPING = PY-GROUPING    AND
  4914        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4915        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4916         NEXT SENTENCE
  4917     ELSE
  4918         IF PYAJ-1ST-READ
  4919             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4920             MOVE SPACE          TO  PYAJ-READ-SW
  4921             GO TO 6200-EXIT
  4922         ELSE
  4923             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4924             IF PINDX  IS LESS THAN  12
  4925                 SET PINDX  UP  BY  1
  4926                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4927                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4928                 SET PINDX  UP  BY  1
  4929                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4930                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4931                     GO TO 6200-EXIT
  4932             ELSE
  4933                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4934                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4935                 SET PINDX  UP  BY  1
  4936                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4937                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4938                 GO TO 6200-EXIT.
  4939
  4940*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4941
  4942     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4943         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4944
  4945*    SET PINDX  UP  BY +1.
  4946
  4947     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4948
  4949     IF PINDX  IS GREATER THAN  13
  4950         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4951         MOVE +13                TO  PI-FULL-INDX
  4952         MOVE PI-FRST-FILE-SEQ-NO
  4953                                 TO  PI-LAST-FILE-SEQ-NO
  4954         MOVE PI-FRST-RECORD-TYPE
  4955                                 TO  PI-LAST-RECORD-TYPE
  4956         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  4957         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  4958         GO TO 6200-EXIT.
  4959
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 100
* EL633.cbl
  4960     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  4961     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  4962
  4963     IF PYAJ-1ST-READ
  4964         MOVE SPACE              TO  PYAJ-READ-SW.
  4965
  4966     IF PINDX = 1
  4967         MOVE PI-PREV-FILE-SEQ-NO
  4968                                 TO  PI-FRST-FILE-SEQ-NO
  4969         MOVE PI-PREV-RECORD-TYPE
  4970                                 TO  PI-FRST-RECORD-TYPE
  4971         MOVE PI-PREV-FILE-SEQ-NO
  4972                                 TO  PI-LAST-FILE-SEQ-NO
  4973         MOVE PI-PREV-RECORD-TYPE
  4974                                 TO  PI-LAST-RECORD-TYPE.
  4975
  4976     SET NDX                     TO  PINDX.
  4977     SET WS-SAVE-NDX-VALUE       TO  NDX.
  4978
  4979     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  4980
  4981     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  4982     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  4983     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  4984     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  4985     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  4986
  4987     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  4988
  4989     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  4990         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  4991     ELSE
  4992         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  4993
  4994     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  4995                                     PI-REC-TYPE (NDX).
  4996
  4997     IF PY-VOID-SW NOT = SPACE
  4998         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  4999
  5000     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  5001         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  5002     ELSE
  5003         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  5004                                     PREV-BIN-MAINT-DT
  5005         MOVE SPACE              TO  DC-OPTION-CODE
  5006         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5007* DAN    MOVE DC-GREG-DATE-1-EDIT
  5008         MOVE DC-GREG-DATE-1-MDY
  5009                                 TO  MDTE (PINDX)
  5010                                     PREV-MAINT-DT.
  5011
  5012*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  5013     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  5014         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  5015         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  5016*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  5017*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 101
* EL633.cbl
  5018     END-IF.
  5019
  5020     IF PY-BILLED-DATE NOT = LOW-VALUES
  5021         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  5022                                     AMT-ATTRB (PINDX)
  5023                                     VOID-SW-ATTRB (PINDX)
  5024         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  5025             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  5026         ELSE
  5027             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5028                                     PREV-BIN-BL-DT
  5029             MOVE SPACE          TO  DC-OPTION-CODE
  5030             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5031* DAN        MOVE DC-GREG-DATE-1-EDIT
  5032             MOVE DC-GREG-DATE-1-MDY
  5033                                 TO  BDTE (PINDX)
  5034                                     PREV-BL-DT.
  5035
  5036     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5037         NEXT SENTENCE
  5038     ELSE
  5039         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5040                                     AMT-ATTRB     (PINDX).
  5041
  5042     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5043         MOVE PY-CREDIT-SELECT-DT
  5044                                 TO  DC-BIN-DATE-1
  5045         MOVE SPACE              TO  DC-OPTION-CODE
  5046         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5047
  5048         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5049         MOVE WS-GS-MM             TO  WS-SS-MM
  5050         MOVE WS-GS-DD             TO  WS-SS-DD
  5051         MOVE WS-GS-YY             TO  WS-SS-YY
  5052         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5053     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5054        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5055         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5056                                    AMT-ATTRB      (PINDX)
  5057                                    GL-ACCT-ATTRB  (PINDX)
  5058                                    GL-COMM-ATTRB  (PINDX)
  5059                                    VOID-SW-ATTRB  (PINDX)
  5060                                    GL-STATE-ATTRB (PINDX)
  5061                                    GL-CANC-ATTRB  (PINDX)
  5062                                    SDTE-ATTRB     (PINDX)
  5063
  5064     END-IF
  5065
  5066*    GO TO 6010-READ-NEXT.
  5067     GO TO 6200-EXIT.
  5068
  5069 6100-END-OF-FILE.
  5070     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5071
  5072     IF PINDX  IS LESS THAN  12
  5073         SET PINDX  UP  BY  1
  5074         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5075         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 102
* EL633.cbl
  5076         SET PINDX  UP  BY  1
  5077         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5078         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5079         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5080     ELSE
  5081         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5082         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5083         SET PINDX  UP  BY  1
  5084         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5085         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5086
  5087 6200-EXIT.
  5088     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 103
* EL633.cbl
  5090 7000-PYAJ-FILE-NOTOPEN.
  5091     MOVE -1                     TO  MAINTL.
  5092     MOVE ER-2232                TO  EMI-ERROR.
  5093
  5094     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5095
  5096     GO TO 8200-SEND-DATAONLY.
  5097
  5098 7100-COMP-FILE-NOTOPEN.
  5099     MOVE -1                     TO  MAINTL.
  5100     MOVE ER-2233                TO  EMI-ERROR.
  5101
  5102     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5103
  5104     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 104
* EL633.cbl
  5106*
  5107*7100-COFA-FILE-NOTOPEN.
  5108*    MOVE -1                     TO PFENTERL.
  5109*    MOVE ER-2959                TO EMI-ERROR.
  5110*    PERFORM 9900-ERROR-FORMAT THRU
  5111*            9900-EXIT.
  5112*    GO TO 8200-SEND-DATAONLY.
  5113*
  5114 8100-SEND-INITIAL-MAP.
  5115     MOVE WS-CURRENT-DT          TO  DATEO.
  5116     MOVE EIBTIME                TO  TIME-IN.
  5117     MOVE TIME-OUT               TO  TIMEO.
  5118     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5119     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5120     MOVE -1                     TO  MAINTL.
  5121     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5122     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5123
  5124     IF EIBTRNID = TRANS-ID
  5125       OR EL640-TRANS-ID
  5126       OR EL642-TRANS-ID
  5127       OR EL652-TRANS-ID
  5128       OR EL6331-TRANS-ID
  5129         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5130             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5131             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5132             MOVE PI-SAV-GROUPING  TO  GROUPO
  5133             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5134             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5135             MOVE AL-UANON         TO  MAINTA
  5136                                       CARRIERA
  5137                                       GROUPA
  5138                                       FINRESPA
  5139                                       ACCTA
  5140         ELSE
  5141             NEXT SENTENCE.
  5142
  5143
  5144* EXEC CICS SEND
  5145*        MAP     (MAP-NAME)
  5146*        MAPSET  (MAPSET-NAME)
  5147*        FROM    (EL633AO)
  5148*        ERASE
  5149*        CURSOR
  5150*        END-EXEC.
  5151     MOVE LENGTH OF
  5152      EL633AO
  5153       TO DFHEIV12
  5154     MOVE -1
  5155       TO DFHEIV11
  5156*    MOVE '8$     CT  E    H L F ,   #00004688' TO DFHEIV0
  5157     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5158     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5159     MOVE X'2020233030303034363838' TO DFHEIV0(25:11)
  5160     CALL 'kxdfhei1' USING DFHEIV0,
  5161           MAP-NAME,
  5162           EL633AO,
  5163           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 105
* EL633.cbl
  5164           MAPSET-NAME,
  5165           DFHEIV99,
  5166           DFHEIV99,
  5167           DFHEIV99,
  5168           DFHEIV11,
  5169           DFHEIV99,
  5170           DFHEIV99,
  5171           DFHEIV99
  5172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5173
  5174
  5175     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 106
* EL633.cbl
  5177 8200-SEND-DATAONLY.
  5178     MOVE WS-CURRENT-DT          TO  DATEO.
  5179     MOVE EIBTIME                TO  TIME-IN.
  5180     MOVE TIME-OUT               TO  TIMEO.
  5181     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5182     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5183     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5184     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5185
  5186
  5187* EXEC CICS SEND
  5188*        MAP     (MAP-NAME)
  5189*        MAPSET  (MAPSET-NAME)
  5190*        FROM    (EL633AO)
  5191*        DATAONLY
  5192*        CURSOR
  5193*    END-EXEC.
  5194     MOVE LENGTH OF
  5195      EL633AO
  5196       TO DFHEIV12
  5197     MOVE -1
  5198       TO DFHEIV11
  5199*    MOVE '8$D    CT       H L F ,   #00004707' TO DFHEIV0
  5200     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5201     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5202     MOVE X'2020233030303034373037' TO DFHEIV0(25:11)
  5203     CALL 'kxdfhei1' USING DFHEIV0,
  5204           MAP-NAME,
  5205           EL633AO,
  5206           DFHEIV12,
  5207           MAPSET-NAME,
  5208           DFHEIV99,
  5209           DFHEIV99,
  5210           DFHEIV99,
  5211           DFHEIV11,
  5212           DFHEIV99,
  5213           DFHEIV99,
  5214           DFHEIV99
  5215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5216
  5217
  5218     GO TO 9100-RETURN-TRAN.
  5219
  5220 8300-SEND-TEXT.
  5221
  5222* EXEC CICS SEND TEXT
  5223*        FROM    (LOGOFF-TEXT)
  5224*        LENGTH  (LOGOFF-LENGTH)
  5225*        ERASE
  5226*        FREEKB
  5227*    END-EXEC.
  5228*    MOVE '8&      T  E F  H   F -   #00004718' TO DFHEIV0
  5229     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5230     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5231     MOVE X'2020233030303034373138' TO DFHEIV0(25:11)
  5232     CALL 'kxdfhei1' USING DFHEIV0,
  5233           LOGOFF-TEXT,
  5234           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 107
* EL633.cbl
  5235           DFHEIV99,
  5236           DFHEIV99,
  5237           DFHEIV99,
  5238           DFHEIV99,
  5239           DFHEIV99,
  5240           DFHEIV99,
  5241           DFHEIV99,
  5242           DFHEIV99,
  5243           DFHEIV99,
  5244           DFHEIV99
  5245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5246
  5247
  5248
  5249* EXEC CICS RETURN
  5250*    END-EXEC.
  5251*    MOVE '.(                    ''   #00004725' TO DFHEIV0
  5252     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5253     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5254     MOVE X'2020233030303034373235' TO DFHEIV0(25:11)
  5255     CALL 'kxdfhei1' USING DFHEIV0,
  5256           DFHEIV99,
  5257           DFHEIV99,
  5258           DFHEIV99,
  5259           DFHEIV99,
  5260           DFHEIV99,
  5261           DFHEIV99
  5262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5263
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 108
* EL633.cbl
  5265 8400-LOG-JOURNAL-RECORD.
  5266*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5267*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5268
  5269*    EXEC CICS JOURNAL
  5270*        JFILEID  (PI-JOURNAL-FILE-ID)
  5271*        JTYPEID  ('EL')
  5272*        FROM     (JOURNAL-RECORD)
  5273*        LENGTH   (223)
  5274*        END-EXEC.
  5275
  5276 8500-DATE-CONVERT.
  5277
  5278* EXEC CICS LINK
  5279*        PROGRAM   (LINK-CLDATCV)
  5280*        COMMAREA  (DATE-CONVERSION-DATA)
  5281*        LENGTH    (DC-COMM-LENGTH)
  5282*    END-EXEC.
  5283*    MOVE '."C                   (   #00004740' TO DFHEIV0
  5284     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5285     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5286     MOVE X'2020233030303034373430' TO DFHEIV0(25:11)
  5287     CALL 'kxdfhei1' USING DFHEIV0,
  5288           LINK-CLDATCV,
  5289           DATE-CONVERSION-DATA,
  5290           DC-COMM-LENGTH,
  5291           DFHEIV99,
  5292           DFHEIV99,
  5293           DFHEIV99,
  5294           DFHEIV99
  5295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5296
  5297
  5298 8500-EXIT.
  5299     EXIT.
  5300
  5301 8600-DEEDIT.
  5302
  5303* EXEC CICS BIF DEEDIT
  5304*        FIELD   (DEEDIT-FIELD)
  5305*        LENGTH  (11)
  5306*    END-EXEC.
  5307     MOVE 11
  5308       TO DFHEIV11
  5309*    MOVE '@"L                   #   #00004750' TO DFHEIV0
  5310     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5311     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5312     MOVE X'2020233030303034373530' TO DFHEIV0(25:11)
  5313     CALL 'kxdfhei1' USING DFHEIV0,
  5314           DEEDIT-FIELD,
  5315           DFHEIV11
  5316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5317
  5318
  5319 8600-EXIT.
  5320     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 109
* EL633.cbl
  5322 8800-UNAUTHORIZED-ACCESS.
  5323     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5324
  5325     GO TO 8300-SEND-TEXT.
  5326
  5327 8810-PF23.
  5328     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5329     MOVE XCTL-005               TO  PGM-NAME.
  5330
  5331     GO TO 9300-XCTL.
  5332
  5333 9100-RETURN-TRAN.
  5334     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5335     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5336
  5337
  5338* EXEC CICS RETURN
  5339*        TRANSID   (TRANS-ID)
  5340*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5341*        LENGTH    (PI-COMM-LENGTH)
  5342*    END-EXEC.
  5343*    MOVE '.(CT                  ''   #00004773' TO DFHEIV0
  5344     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5345     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5346     MOVE X'2020233030303034373733' TO DFHEIV0(25:11)
  5347     CALL 'kxdfhei1' USING DFHEIV0,
  5348           TRANS-ID,
  5349           PROGRAM-INTERFACE-BLOCK,
  5350           PI-COMM-LENGTH,
  5351           DFHEIV99,
  5352           DFHEIV99,
  5353           DFHEIV99
  5354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5355
  5356
  5357 9200-RETURN-MAIN-MENU.
  5358     MOVE XCTL-626               TO  PGM-NAME.
  5359
  5360     GO TO 9300-XCTL.
  5361
  5362 9300-XCTL.
  5363
  5364* EXEC CICS XCTL
  5365*        PROGRAM   (PGM-NAME)
  5366*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5367*        LENGTH    (PI-COMM-LENGTH)
  5368*    END-EXEC.
  5369*    MOVE '.$C                   %   #00004785' TO DFHEIV0
  5370     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5371     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5372     MOVE X'2020233030303034373835' TO DFHEIV0(25:11)
  5373     CALL 'kxdfhei1' USING DFHEIV0,
  5374           PGM-NAME,
  5375           PROGRAM-INTERFACE-BLOCK,
  5376           PI-COMM-LENGTH,
  5377           DFHEIV99
  5378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5379
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 110
* EL633.cbl
  5380
  5381 9400-CLEAR.
  5382     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5383
  5384     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5385     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5386                                     PI-SAV-COMP-CONTROL.
  5387
  5388     GO TO 9300-XCTL.
  5389
  5390 9500-PF12.
  5391     MOVE XCTL-010               TO  PGM-NAME.
  5392
  5393     GO TO 9300-XCTL.
  5394
  5395 9600-PGMID-ERROR.
  5396
  5397* EXEC CICS HANDLE CONDITION
  5398*        PGMIDERR  (8300-SEND-TEXT)
  5399*    END-EXEC.
  5400*    MOVE '"$L                   ! + #00004806' TO DFHEIV0
  5401     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5402     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5403     MOVE X'2B20233030303034383036' TO DFHEIV0(25:11)
  5404     CALL 'kxdfhei1' USING DFHEIV0
  5405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5406
  5407
  5408     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5409     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5410     MOVE XCTL-005               TO  PGM-NAME.
  5411     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5412     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5413
  5414     GO TO 9300-XCTL.
  5415
  5416 9900-ERROR-FORMAT.
  5417     IF NOT EMI-ERRORS-COMPLETE
  5418         MOVE LINK-001           TO  PGM-NAME
  5419
  5420* EXEC CICS LINK
  5421*            PROGRAM   (PGM-NAME)
  5422*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5423*            LENGTH    (EMI-COMM-LENGTH)
  5424*        END-EXEC.
  5425*    MOVE '."C                   (   #00004821' TO DFHEIV0
  5426     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5428     MOVE X'2020233030303034383231' TO DFHEIV0(25:11)
  5429     CALL 'kxdfhei1' USING DFHEIV0,
  5430           PGM-NAME,
  5431           ERROR-MESSAGE-INTERFACE-BLOCK,
  5432           EMI-COMM-LENGTH,
  5433           DFHEIV99,
  5434           DFHEIV99,
  5435           DFHEIV99,
  5436           DFHEIV99
  5437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 111
* EL633.cbl
  5438
  5439
  5440 9900-EXIT.
  5441     EXIT.
  5442
  5443 9990-ABEND.
  5444     MOVE LINK-004               TO  PGM-NAME.
  5445     MOVE DFHEIBLK               TO  EMI-LINE1.
  5446
  5447
  5448* EXEC CICS LINK
  5449*        PROGRAM   (PGM-NAME)
  5450*        COMMAREA  (EMI-LINE1)
  5451*        LENGTH    (72)
  5452*    END-EXEC.
  5453     MOVE 72
  5454       TO DFHEIV11
  5455*    MOVE '."C                   (   #00004834' TO DFHEIV0
  5456     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5458     MOVE X'2020233030303034383334' TO DFHEIV0(25:11)
  5459     CALL 'kxdfhei1' USING DFHEIV0,
  5460           PGM-NAME,
  5461           EMI-LINE1,
  5462           DFHEIV11,
  5463           DFHEIV99,
  5464           DFHEIV99,
  5465           DFHEIV99,
  5466           DFHEIV99
  5467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5468
  5469
  5470     MOVE -1                     TO  PFENTERL.
  5471
  5472     GO TO 8200-SEND-DATAONLY.
  5473
  5474 9995-SECURITY-VIOLATION.
  5475*                            COPY ELCSCTP.
  5476******************************************************************
  5477*                                                                *
  5478*                            ELCSCTP                             *
  5479*                            VMOD=2.001                          *
  5480*                                                                *
  5481*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5482******************************************************************
  5483
  5484
  5485     MOVE EIBDATE          TO SM-JUL-DATE.
  5486     MOVE EIBTRMID         TO SM-TERMID.
  5487     MOVE THIS-PGM         TO SM-PGM.
  5488     MOVE EIBTIME          TO TIME-IN.
  5489     MOVE TIME-OUT         TO SM-TIME.
  5490     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5491
  5492
  5493* EXEC CICS LINK
  5494*         PROGRAM  ('EL003')
  5495*         COMMAREA (SECURITY-MESSAGE)
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 112
* EL633.cbl
  5496*         LENGTH   (80)
  5497*    END-EXEC.
  5498     MOVE 'EL003' TO DFHEIV1
  5499     MOVE 80
  5500       TO DFHEIV11
  5501*    MOVE '."C                   (   #00004862' TO DFHEIV0
  5502     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5504     MOVE X'2020233030303034383632' TO DFHEIV0(25:11)
  5505     CALL 'kxdfhei1' USING DFHEIV0,
  5506           DFHEIV1,
  5507           SECURITY-MESSAGE,
  5508           DFHEIV11,
  5509           DFHEIV99,
  5510           DFHEIV99,
  5511           DFHEIV99,
  5512           DFHEIV99
  5513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5514
  5515
  5516******************************************************************
  5517
  5518
  5519 9995-EXIT.
  5520     EXIT.
  5521
  5522
  5523 9999-DFHBACK SECTION.
  5524     MOVE '9%                    "   ' TO DFHEIV0
  5525     MOVE 'EL633' TO DFHEIV1
  5526     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5527     GOBACK.
  5528 9999-DFHEXIT.
  5529     IF DFHEIGDJ EQUAL 0001
  5530         NEXT SENTENCE
  5531     ELSE IF DFHEIGDJ EQUAL 2
  5532         GO TO 9600-PGMID-ERROR,
  5533               9990-ABEND
  5534         DEPENDING ON DFHEIGDI
  5535     ELSE IF DFHEIGDJ EQUAL 3
  5536         GO TO 0410-NO-COMP-MSTR,
  5537               7100-COMP-FILE-NOTOPEN
  5538         DEPENDING ON DFHEIGDI
  5539     ELSE IF DFHEIGDJ EQUAL 4
  5540         GO TO 0890-EXIT
  5541         DEPENDING ON DFHEIGDI
  5542     ELSE IF DFHEIGDJ EQUAL 5
  5543         GO TO 2110-ADD-RECORD
  5544         DEPENDING ON DFHEIGDI
  5545     ELSE IF DFHEIGDJ EQUAL 6
  5546         GO TO 2120-DELETE-CONT
  5547         DEPENDING ON DFHEIGDI
  5548     ELSE IF DFHEIGDJ EQUAL 7
  5549         GO TO 2190-DUP-RECORD
  5550         DEPENDING ON DFHEIGDI
  5551     ELSE IF DFHEIGDJ EQUAL 8
  5552         GO TO 5010-NOT-OPEN,
  5553               5020-NO-RECORDS,
* Micro Focus Server Express         V5.1 revision 000 03-Nov-15 11:09 Page 113
* EL633.cbl
  5554               5020-NO-RECORDS
  5555         DEPENDING ON DFHEIGDI
  5556     ELSE IF DFHEIGDJ EQUAL 9
  5557         GO TO 5110-END-OF-FILE,
  5558               5110-END-OF-FILE
  5559         DEPENDING ON DFHEIGDI
  5560     ELSE IF DFHEIGDJ EQUAL 10
  5561         GO TO 6100-END-OF-FILE,
  5562               6100-END-OF-FILE
  5563         DEPENDING ON DFHEIGDI
  5564     ELSE IF DFHEIGDJ EQUAL 11
  5565         GO TO 8300-SEND-TEXT
  5566         DEPENDING ON DFHEIGDI.
  5567     MOVE '9%                    "   ' TO DFHEIV0
  5568     MOVE 'EL633' TO DFHEIV1
  5569     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5570     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5640     Code:       16804
