* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35******************************************************************
    36
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page   3
* EL131.cbl
    38 ENVIRONMENT DIVISION.
    39
    40 DATA DIVISION.
    41
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    48 77  s1                          pic s999 comp-3 value+0.
    49 77  s2                          pic s999 comp-3 value+0.
    50 77  a1                          pic s999 comp-3 value+0.
    51 77  WS-CRIT-PER-RECURRENT       PIC X     VALUE ' '.
    52 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    53 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    54 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    55 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    56 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    57 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    58 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    59     88  ERPDEF-FOUND                 VALUE 'Y'.
    60
    61 01  LCP-TIME-OF-DAY-XX.
    62     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    63     05  FILLER                    PIC 99.
    64 01  LCP-CICS-TIME                 PIC 9(15).
    65*                            COPY ELCSCTM.
    66******************************************************************
    67*                                                                *
    68*                                                                *
    69*                            ELCSCTM                             *
    70*                            VMOD=2.001                          *
    71*                                                                *
    72*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    73*                                                                *
    74******************************************************************
    75 01  SECURITY-MESSAGE.
    76     12  FILLER                          PIC X(30)
    77            VALUE '** LOGIC SECURITY VIOLATION -'.
    78     12  SM-READ                         PIC X(6).
    79     12  FILLER                          PIC X(5)
    80            VALUE ' PGM='.
    81     12  SM-PGM                          PIC X(6).
    82     12  FILLER                          PIC X(5)
    83            VALUE ' OPR='.
    84     12  SM-PROCESSOR-ID                 PIC X(4).
    85     12  FILLER                          PIC X(6)
    86            VALUE ' TERM='.
    87     12  SM-TERMID                       PIC X(4).
    88     12  FILLER                          PIC XX   VALUE SPACE.
    89     12  SM-JUL-DATE                     PIC 9(5).
    90     12  FILLER                          PIC X    VALUE SPACE.
    91     12  SM-TIME                         PIC 99.99.
    92
    93
    94*                            COPY ELCSCRTY.
    95******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page   4
* EL131.cbl
    96*                                                                *
    97*                                                                *
    98*                            ELCSCRTY                            *
    99*                            VMOD=2.001                          *
   100*                                                                *
   101*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   102*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   103*        SAVED IN PI-SECURITY-ADDRESS.                           *
   104*                                                                *
   105******************************************************************
   106 01  SECURITY-CONTROL.
   107     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   108     12  FILLER                       PIC XX    VALUE 'SC'.
   109     12  SC-CREDIT-CODES.
   110         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   111             20  SC-CREDIT-DISPLAY    PIC X.
   112             20  SC-CREDIT-UPDATE     PIC X.
   113     12  SC-CLAIMS-CODES.
   114         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   115             20  SC-CLAIMS-DISPLAY    PIC X.
   116             20  SC-CLAIMS-UPDATE     PIC X.
   117
   118*                            COPY ELCNWA.
   119*****************************************************************
   120*                                                               *
   121*                                                               *
   122*                            ELCNWA.                            *
   123*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   124*                            VMOD=2.003                         *
   125*                                                               *
   126*            M O V E   N A M E   W O R K   A R E A.             *
   127*                                                               *
   128*****************************************************************.
   129
   130 01  WS-NAME-WORK-AREA.
   131     05  WS-INSURED-LAST-NAME        PIC X(15).
   132     05  WS-INSURED-1ST-NAME         PIC X(12).
   133     05  WS-INSURED-MID-INIT         PIC X.
   134
   135     05  WS-NAME-WORK.
   136         10  WS-NW                   PIC X
   137             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   138
   139     05  WS-NAME-WORK2.
   140         10  WS-NW2                  PIC X
   141             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   142                                        NWA-INDEX0.
   143
   144     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   145                                     COMP-3.
   146
   147
   148 01  ws-dcc-error-line.
   149     05  filler occurs 15.
   150         10  ws-error-no        pic x(4).
   151 01  WS-DATE-AREA.
   152     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   153     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page   5
* EL131.cbl
   154     12  SAVE-DATE-CCYYMMDD.
   155         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   156         16  SAVE-DATE-YMD.
   157             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   158             20  FILLER         PIC X(4)    VALUE SPACES.
   159
   160 01  WS-BLANK                   PIC X       VALUE ' '.
   161
   162 01  CSO-WORK-FIELDS.
   163     05  WS-HOLD-CLAIM-STATUS    PIC X.
   164
   165 01  LITERALS-NUMBERS.
   166     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   167     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   168     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   169     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   170     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   171     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   172     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   173     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   174
   175     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   176     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   177     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   178     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   179     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   180     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   181     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   182     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   183     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   184     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   185
   186     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   187
   188     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   189
   190     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   191     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   192     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   193     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   194     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   195     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   196     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   197     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   198     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   199     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   200     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   201
   202     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   203     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   204     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   205     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   206         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   207     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   208     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   209     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   210     12  WS-CLAIM-SEQU.
   211         16  FILLER              PIC X VALUE '('.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page   6
* EL131.cbl
   212         16  WS-CURRENT-SEQU     PIC Z9.
   213         16  FILLER              PIC X(04) VALUE ' OF '.
   214         16  WS-OF-SEQU          PIC Z9.
   215         16  FILLER              PIC X VALUE ')'.
   216     12  WS-EDIT-BEN-CODE        PIC XX.
   217         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   218                                          '90' THRU '99'.
   219
   220     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   221     12  WS-EDIT-NUMBER          PIC ZZZ9.
   222
   223     12  WS-RESPONSE             PIC S9(8)   COMP.
   224         88  WS-RESP-NORMAL              VALUE +00.
   225         88  WS-RESP-ERROR               VALUE +01.
   226         88  WS-RESP-NOTFND              VALUE +13.
   227         88  WS-RESP-DUPKEY              VALUE +15.
   228         88  WS-RESP-NOTOPEN             VALUE +19.
   229         88  WS-RESP-ENDFILE             VALUE +20.
   230
   231     12  WS-MOS-PAID             PIC 999.
   232     12  WS-ODD-DAYS             PIC 99.
   233     12  WS-REM-MOS              PIC 999.
   234     12  WS-REM-DAYS             PIC 99.
   235     12  WS-TERM-IN-DAYS         PIC 9(4).
   236     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   237
   238     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   239     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   240     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   241     12  WS-RESET-SW             PIC X       VALUE 'N'.
   242     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   243     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   244     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   245
   246 01  DMD-DATE-YYYYMMDD.
   247     12  DMD-DECADE          PIC XX      VALUE SPACES.
   248     12  DMD-YYMMDD.
   249         16  DMD-YY          PIC XX      VALUE SPACES.
   250         16  DMD-MM          PIC XX      VALUE SPACES.
   251         16  DMD-DD          PIC XX      VALUE SPACES.
   252
   253 01  DMD-DATE-MMDDYYYY.
   254     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   255     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   256     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   257     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   258     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   259     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   260
   261 01  WS-MAIL-CODE.
   262     12  FILLER              PIC X.
   263     12  DMD-MAIL-CODE.
   264         16  WS-MAIL-4       PIC X(4).
   265         16  WS-MAIL-5       PIC X.
   266     12  FILLER              PIC X(4).
   267
   268     12  W-NAME-LAST             PIC  X(15).
   269     12  W-NAME-FIRST            PIC  X(15).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page   7
* EL131.cbl
   270     12  W-NAME-MIDDLE.
   271         16  FILLER              PIC  X.
   272         16  W-NAME-MIDDLE-2     PIC  X.
   273         16  FILLER              PIC  X(13).
   274
   275*    COPY ELCDCTB.
   276******************************************************************
   277*                                                                *
   278*                                                                *
   279*                            ELCDCTB.                            *
   280*                            VMOD=2.002                          *
   281*                                                                *
   282*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   283*       COMMUNICATIONS AREA                                      *
   284*                                                                *
   285******************************************************************
   286 01  DCT-COMMUNICATION-AREA.
   287     12  DCT-BILLING-BANK-ID      PIC  X(05).
   288     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   289     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   290     12  DCT-PRODUCT-CODE         PIC  X(02).
   291     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   292     12  DCT-RETURN-CODE          PIC  X(02).
   293     12  DCT-MAIL-CODE            PIC  X(05).
   294     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   295     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page   8
* EL131.cbl
   297 01  ERROR-SWITCHES.
   298     12  ERROR-SWITCH            PIC X.
   299         88  SCREEN-ERROR                    VALUE 'X'.
   300     12  MSTR-KEY-SWITCH         PIC X.
   301         88  MSTR-KEY-CHANGED                VALUE 'X'.
   302     12  CERT-KEY-SWITCH         PIC X.
   303*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   304         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   305*********SET TO Y IF PRIMARY KEY WILL CHANGE
   306         88  CERT-KEY-CHANGED                VALUE 'Y'.
   307     12  MSTR-SWITCH             PIC X.
   308         88  MSTR-UPDATES                    VALUE 'X'.
   309     12  CERT-SWITCH             PIC X.
   310         88  CERT-UPDATES                    VALUE 'X'.
   311     12  UPDATE-SWITCH           PIC X.
   312         88  UPDATES-PRESENT                 VALUE 'X'.
   313     12  TRLR-SWITCH             PIC X.
   314         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   315         88  UPDATE-MADE                     VALUE 'Y'.
   316     12  NINETY-TRLR-SWITCH      PIC X.
   317         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   318     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   319         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   320     12  EARNINGS-CALC-SWITCH    PIC X.
   321         88  TEX-REG                         VALUE '4'.
   322         88  NET-PAY                         VALUE '5'.
   323     12  DLYACTV-SW              PIC X       VALUE 'N'.
   324         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page   9
* EL131.cbl
   326 01  EDIT-WORK-AREA.
   327     12  COUNT-2                 PIC 9.
   328     12  CALL-PGM                PIC X(8).
   329     12  TRANS-ID                PIC X(4).
   330     12  CHECK-PFKEYS            PIC 99.
   331     12  CHECK-MAINT             PIC X.
   332         88  ADD-ALPHA-RECORD                VALUE 'A'.
   333         88  CHANGE-CLAIM                    VALUE 'C'.
   334         88  DELETE-CLAIM                    VALUE 'D'.
   335         88  CHANGE-NAME                     VALUE 'N'.
   336         88  VALID-OPTIONS                   VALUE 'A' 'C'
   337                                                   'D' 'N'.
   338
   339     12  HOLD-BENEFIT            PIC XX.
   340     12  HOLD-FREQ               PIC XX.
   341     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   342     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   343     12  HOLD-PDTHRU             PIC XX.
   344     12  HOLD-ADDON              PIC XX.
   345     12  HOLD-NODAYS             PIC 9(4).
   346     12  HOLD-NOPMTS             PIC 9(3).
   347     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   348     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   349     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   350     12  HOLD-BIRTH              PIC XX.
   351     12  HOLD-END                PIC XX.
   352     12  HOLD-EFF                PIC XX.
   353     12  HOLD-ENTRY              PIC XX.
   354     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   355     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   356     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   357     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   358     12  HOLD-LF-CV-CAN          PIC XX.
   359     12  HOLD-AH-CV-CAN          PIC XX.
   360     12  DIVIDE-QUOT             PIC 9(3).
   361     12  DIVIDE-REM              PIC 9(3).
   362
   363     12  WS-ALPHA-DATE.
   364         16  WS-ALPHA-YEAR.
   365             20  WS-ALPHA-YY-1   PIC 99.
   366             20  WS-ALPHA-YY-2   PIC 99.
   367         16  WS-ALPHA-MM         PIC 99.
   368         16  WS-ALPHA-DD         PIC 99.
   369
   370     12  BUILD-VALID-DATE.
   371         16  BUILD-MONTH         PIC 99.
   372         16  BUILD-DAY           PIC 99.
   373         16  BUILD-YEAR          PIC 99.
   374     12  DEEDIT-MMYY-INPUT.
   375         16  FILLER              PIC X.
   376         16  DEEDIT-MONTH        PIC XX.
   377         16  DEEDIT-YEAR         PIC XX.
   378     12  DEEDIT-BEN              PIC 9(9)V99.
   379     12  DEEDIT-DATE-INPUT.
   380         16  FILLER              PIC XX.
   381         16  DEEDIT-DATE         PIC X(6).
   382     12  WORK-DATE-MDY.
   383         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  10
* EL131.cbl
   384         16  FILLER              PIC X(4).
   385         16  YEAR-WORK           PIC XX.
   386     12  WORK-DATE-MY.
   387         16  WORK-MONTH          PIC XX.
   388         16  WORK-SLASH          PIC X       VALUE '/'.
   389         16  WORK-YEAR           PIC XX.
   390     12  HOLD-DATE.
   391         16  HOLD-MONTH          PIC 99.
   392         16  FILLER              PIC X(4).
   393         16  HOLD-YEAR           PIC 99.
   394     12  SPLIT-INFO-LINE-1.
   395         16  SPLIT-INFO-DESC     PIC X(15).
   396         16  FILLER              PIC X(5)    VALUE ' OLD='.
   397         16  SPLIT-INFO-OLD      PIC X(40).
   398     12  EFF-TERM-MO             PIC 9(4).
   399     12  CURR-MO                 PIC 9(4).
   400     12  WS-BIN-CURRENT-DT       PIC XX.
   401     12  WS-CALC-METHOD          PIC X.
   402     12  WS-INITIALS.
   403         16  WS-INIT-1           PIC X.
   404         16  WS-INIT-2           PIC X.
   405     12  WS-REIN-TABLE.
   406         16  WS-REIN-1           PIC X.
   407         16  WS-REIN-2           PIC X.
   408         16  WS-REIN-3           PIC X.
   409     12  PI-KEY.
   410         16  PI-TERM             PIC X(4).
   411         16  PI-QUAL             PIC X(4).
   412     12  CHECK-KEY               PIC X(20).
   413     12  SAVE-ACCT-KEY           PIC X(20).
   414     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   415     12  WS-SOC-SEC-NUMBER.
   416         16  WS-SOC-SEC-NO       PIC 9(9).
   417         16  WS-SOC-SEC-BLANK    PIC X(2).
   418     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   419         16  WS-SSN-1-3          PIC 9(3).
   420         16  WS-SSN-DASH1        PIC X(1).
   421         16  WS-SSN-4-5          PIC 9(2).
   422         16  WS-SSN-DASH2        PIC X(1).
   423         16  WS-SSN-6-9          PIC 9(4).
   424     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   425     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   426
   427 01  WS-SAVE-FIELDS.
   428     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   429     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   430     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   431     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   432     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   433     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   434     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   435     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   436     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   437     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   438     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   439     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   440     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   441     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  11
* EL131.cbl
   442     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   443     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   444     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   445     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   446     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   447     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   448     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   449     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   450     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   451     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   452     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   453     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   454     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   455     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   456     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   457     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   458     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   459     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   460     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   461     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   462     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   463     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   464     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   465     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   466     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   467     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   468     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   469     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   470     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   471     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   472     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   473     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   474     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   475     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   476     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   477     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   478     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   479
   480 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   481     12  M                   PIC S9(7)V99           VALUE ZEROS.
   482     12  L                   PIC S9(7)V99           VALUE ZEROS.
   483     12  N                   PIC S9(3)              VALUE ZEROS.
   484     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   485     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   486     12  I                   PIC S99V9(5)           VALUE ZEROS.
   487     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   488     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   489     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   490     12  R                   PIC S9(3)              VALUE ZEROS.
   491     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   492     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   493     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   494     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   495     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   496     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   497     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   498     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   499     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  12
* EL131.cbl
   500
   501 01  TERM-CALC-WORK-AREA.
   502     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   503     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   504     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   505     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   506     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   507     12  V-EXPONENTS.
   508        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   509     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   510
   511 01  TIME-IN.
   512     12  UN-HOURS                PIC XX.
   513     12  UN-MINUTES              PIC XX.
   514     12  FILLER                  PIC XX.
   515
   516 01  TIME-OUT.
   517     12  FOR-HOURS               PIC XX.
   518     12  FILLER                  PIC X       VALUE '.'.
   519     12  FOR-MINUTES             PIC XX.
   520
   521 01  ERROR-NUMBERS.
   522     12  ER-0000                 PIC X(4)    VALUE '0000'.
   523     12  ER-0004                 PIC X(4)    VALUE '0004'.
   524     12  ER-0008                 PIC X(4)    VALUE '0008'.
   525     12  ER-0023                 PIC X(4)    VALUE '0023'.
   526     12  ER-0029                 PIC X(4)    VALUE '0029'.
   527     12  ER-0068                 PIC X(4)    VALUE '0068'.
   528     12  ER-0070                 PIC X(4)    VALUE '0070'.
   529     12  ER-0149                 PIC X(4)    VALUE '0149'.
   530     12  ER-0154                 PIC X(4)    VALUE '0154'.
   531     12  ER-0169                 PIC X(4)    VALUE '0169'.
   532     12  ER-0192                 PIC X(4)    VALUE '0192'.
   533     12  ER-0199                 PIC X(4)    VALUE '0199'.
   534     12  ER-0203                 PIC X(4)    VALUE '0203'.
   535     12  ER-0204                 PIC X(4)    VALUE '0204'.
   536     12  ER-0205                 PIC X(4)    VALUE '0205'.
   537     12  ER-0206                 PIC X(4)    VALUE '0206'.
   538     12  ER-0208                 PIC X(4)    VALUE '0208'.
   539     12  ER-0210                 PIC X(4)    VALUE '0210'.
   540     12  ER-0215                 PIC X(4)    VALUE '0215'.
   541     12  ER-0219                 PIC X(4)    VALUE '0219'.
   542     12  ER-0220                 PIC X(4)    VALUE '0220'.
   543     12  ER-0222                 PIC X(4)    VALUE '0222'.
   544     12  ER-0223                 PIC X(4)    VALUE '0223'.
   545     12  ER-0224                 PIC X(4)    VALUE '0224'.
   546     12  ER-0227                 PIC X(4)    VALUE '0227'.
   547     12  ER-0230                 PIC X(4)    VALUE '0230'.
   548     12  ER-0232                 PIC X(4)    VALUE '0232'.
   549     12  ER-0233                 PIC X(4)    VALUE '0233'.
   550     12  ER-0236                 PIC X(4)    VALUE '0236'.
   551     12  ER-0237                 PIC X(4)    VALUE '0237'.
   552     12  ER-0238                 PIC X(4)    VALUE '0238'.
   553     12  ER-0240                 PIC X(4)    VALUE '0240'.
   554     12  ER-0241                 PIC X(4)    VALUE '0241'.
   555     12  ER-0243                 PIC X(4)    VALUE '0243'.
   556     12  ER-0244                 PIC X(4)    VALUE '0244'.
   557     12  ER-0246                 PIC X(4)    VALUE '0246'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  13
* EL131.cbl
   558     12  ER-0247                 PIC X(4)    VALUE '0247'.
   559     12  ER-0248                 PIC X(4)    VALUE '0248'.
   560     12  ER-0250                 PIC X(4)    VALUE '0250'.
   561     12  ER-0251                 PIC X(4)    VALUE '0251'.
   562     12  ER-0253                 PIC X(4)    VALUE '0253'.
   563     12  ER-0256                 PIC X(4)    VALUE '0256'.
   564     12  ER-0257                 PIC X(4)    VALUE '0257'.
   565     12  ER-0258                 PIC X(4)    VALUE '0258'.
   566     12  ER-0259                 PIC X(4)    VALUE '0259'.
   567     12  ER-0260                 PIC X(4)    VALUE '0260'.
   568     12  ER-0261                 PIC X(4)    VALUE '0261'.
   569     12  ER-0262                 PIC X(4)    VALUE '0262'.
   570     12  ER-0263                 PIC X(4)    VALUE '0263'.
   571     12  ER-0273                 PIC X(4)    VALUE '0273'.
   572     12  ER-0274                 PIC X(4)    VALUE '0274'.
   573     12  ER-0276                 PIC X(4)    VALUE '0276'.
   574     12  ER-0282                 PIC X(4)    VALUE '0282'.
   575     12  ER-0283                 PIC X(4)    VALUE '0283'.
   576     12  ER-0309                 PIC X(4)    VALUE '0309'.
   577     12  ER-0310                 PIC X(4)    VALUE '0310'.
   578     12  ER-0311                 PIC X(4)    VALUE '0311'.
   579     12  ER-0333                 PIC X(4)    VALUE '0333'.
   580     12  ER-0360                 PIC X(4)    VALUE '0360'.
   581     12  ER-0377                 PIC X(4)    VALUE '0377'.
   582     12  ER-0402                 PIC X(4)    VALUE '0402'.
   583     12  ER-0416                 PIC X(4)    VALUE '0416'.
   584     12  ER-0426                 PIC X(4)    VALUE '0426'.
   585     12  ER-0427                 PIC X(4)    VALUE '0427'.
   586     12  ER-0428                 PIC X(4)    VALUE '0428'.
   587     12  ER-0429                 PIC X(4)    VALUE '0429'.
   588     12  ER-0430                 PIC X(4)    VALUE '0430'.
   589     12  ER-0458                 PIC X(4)    VALUE '0458'.
   590     12  ER-0475                 PIC X(4)    VALUE '0475'.
   591     12  ER-0491                 PIC X(4)    VALUE '0491'.
   592     12  ER-0509                 PIC X(4)    VALUE '0509'.
   593     12  ER-0510                 PIC X(4)    VALUE '0510'.
   594     12  ER-0511                 PIC X(4)    VALUE '0511'.
   595     12  ER-0512                 PIC X(4)    VALUE '0512'.
   596     12  ER-0519                 PIC X(4)    VALUE '0519'.
   597     12  ER-0520                 PIC X(4)    VALUE '0520'.
   598     12  ER-0521                 PIC X(4)    VALUE '0521'.
   599     12  ER-0547                 PIC X(4)    VALUE '0547'.
   600     12  ER-0548                 PIC X(4)    VALUE '0548'.
   601     12  ER-0549                 PIC X(4)    VALUE '0549'.
   602     12  ER-0565                 PIC X(4)    VALUE '0565'.
   603     12  ER-0598                 PIC X(4)    VALUE '0598'.
   604     12  ER-0639                 PIC X(4)    VALUE '0639'.
   605     12  ER-0797                 PIC X(4)    VALUE '0797'.
   606     12  ER-0802                 PIC X(4)    VALUE '0802'.
   607     12  ER-0803                 PIC X(4)    VALUE '0803'.
   608     12  ER-0849                 PIC X(4)    VALUE '0849'.
   609     12  ER-0885                 PIC X(4)    VALUE '0885'.
   610     12  ER-0887                 PIC X(4)    VALUE '0887'.
   611     12  ER-0919                 PIC X(4)    VALUE '0919'.
   612     12  ER-0921                 PIC X(4)    VALUE '0921'.
   613     12  ER-0938                 PIC X(4)    VALUE '0938'.
   614     12  ER-0946                 PIC X(4)    VALUE '0946'.
   615     12  ER-0947                 PIC X(4)    VALUE '0947'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  14
* EL131.cbl
   616     12  ER-0948                 PIC X(4)    VALUE '0948'.
   617     12  ER-0949                 PIC X(4)    VALUE '0949'.
   618     12  ER-0950                 PIC X(4)    VALUE '0950'.
   619     12  ER-0951                 PIC X(4)    VALUE '0951'.
   620     12  ER-0954                 PIC X(4)    VALUE '0954'.
   621     12  ER-0974                 PIC X(4)    VALUE '0974'.
   622     12  ER-0975                 PIC X(4)    VALUE '0975'.
   623     12  ER-1651                 PIC X(4)    VALUE '1651'.
   624     12  ER-1652                 PIC X(4)    VALUE '1652'.
   625     12  ER-1653                 PIC X(4)    VALUE '1653'.
   626     12  ER-1654                 PIC X(4)    VALUE '1654'.
   627     12  ER-1655                 PIC X(4)    VALUE '1655'.
   628     12  er-1656                 pic x(4)    value '1656'.
   629     12  ER-1661                 PIC X(4)    VALUE '1661'.
   630     12  ER-1662                 PIC X(4)    VALUE '1662'.
   631     12  ER-1663                 PIC X(4)    VALUE '1663'.
   632     12  ER-1773                 PIC X(4)    VALUE '1773'.
   633     12  ER-2280                 PIC X(4)    VALUE '2280'.
   634     12  ER-2878                 PIC X(4)    VALUE '2878'.
   635     12  ER-7641                 PIC X(4)    VALUE '7641'.
   636     12  ER-7642                 PIC X(4)    VALUE '7642'.
   637     12  ER-7650                 PIC X(4)    VALUE '7650'.
   638     12  ER-7651                 PIC X(4)    VALUE '7651'.
   639     12  ER-7687                 PIC X(4)    VALUE '7687'.
   640     12  ER-7689                 PIC X(4)    VALUE '7689'.
   641     12  ER-7690                 PIC X(4)    VALUE '7690'.
   642     12  ER-7691                 PIC X(4)    VALUE '7691'.
   643     12  ER-8003                 PIC X(4)    VALUE '8003'.
   644     12  ER-8051                 PIC X(4)    VALUE '8051'.
   645     12  ER-8052                 PIC X(4)    VALUE '8052'.
   646     12  ER-8053                 PIC X(4)    VALUE '8053'.
   647     12  ER-8054                 PIC X(4)    VALUE '8054'.
   648     12  ER-8055                 PIC X(4)    VALUE '8055'.
   649     12  ER-8056                 PIC X(4)    VALUE '8056'.
   650     12  ER-8057                 PIC X(4)    VALUE '8057'.
   651     12  ER-8058                 PIC X(4)    VALUE '8058'.
   652     12  ER-8059                 PIC X(4)    VALUE '8059'.
   653     12  ER-8060                 PIC X(4)    VALUE '8060'.
   654     12  ER-8061                 PIC X(4)    VALUE '8061'.
   655     12  ER-8062                 PIC X(4)    VALUE '8062'.
   656     12  ER-8063                 PIC X(4)    VALUE '8063'.
   657     12  ER-8064                 PIC X(4)    VALUE '8064'.
   658     12  ER-8065                 PIC X(4)    VALUE '8065'.
   659     12  ER-8066                 PIC X(4)    VALUE '8066'.
   660     12  ER-8152                 PIC X(4)    VALUE '8152'.
   661     12  ER-8153                 PIC X(4)    VALUE '8153'.
   662     12  ER-8154                 PIC X(4)    VALUE '8154'.
   663     12  ER-8155                 PIC X(4)    VALUE '8155'.
   664 01  ERPDEF-KEY-SAVE             PIC X(18).
   665 01  ERPDEF-KEY.
   666     12  ERPDEF-COMPANY-CD       PIC X.
   667     12  ERPDEF-STATE            PIC XX.
   668     12  ERPDEF-PROD-CD          PIC XXX.
   669     12  F                       PIC X(7).
   670     12  ERPDEF-BEN-TYPE         PIC X.
   671     12  ERPDEF-BEN-CODE         PIC XX.
   672     12  ERPDEF-EXP-DT           PIC XX.
   673 01  MSTR-KEY.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  15
* EL131.cbl
   674     12  COMPANY-CODE            PIC X.
   675     12  CARRIER-CODE            PIC X.
   676     12  CLAIM-NO                PIC X(7).
   677     12  CERT-NO.
   678         16  CERT-NO-PRIME       PIC X(10).
   679         16  CERT-NO-SUFX        PIC X.
   680
   681 01  WS-SAVE-CLAIM-KEY.
   682     12  WS-SAVE-COMPANY-CD      PIC X.
   683     12  WS-SAVE-CARRIER         PIC X.
   684     12  WS-SAVE-CLAIM-NO        PIC X(7).
   685     12  WS-SAVE-CERT-NO.
   686         16  WS-CERT-NO-PRIME    PIC X(10).
   687         16  WS-CERT-NO-SUFX     PIC X.
   688
   689 01  CERT-KEY.
   690     12  CERT-COMPANY-CODE       PIC X.
   691     12  CERT-CARRIER            PIC X.
   692     12  CERT-GROUP              PIC X(6).
   693     12  CERT-STATE              PIC XX.
   694     12  CERT-ACCOUNT            PIC X(10).
   695     12  CERT-DATE               PIC XX.
   696     12  CERT-CERT.
   697         16  CERT-CERT-PRIME     PIC X(10).
   698         16  CERT-CERT-SUFX      PIC X.
   699
   700 01  ELCRTT-KEY.
   701     05  CTRLR-COMP-CD       PIC X.
   702     05  CTRLR-CARRIER       PIC X.
   703     05  CTRLR-GROUPING      PIC X(6).
   704     05  CTRLR-STATE         PIC X(2).
   705     05  CTRLR-ACCOUNT       PIC X(10).
   706     05  CTRLR-EFF-DT        PIC XX.
   707     05  CTRLR-CERT-NO       PIC X(11).
   708     05  CTRLR-REC-TYPE      PIC X.
   709 01  NOTE-KEY.
   710     12  NOTE-COMP-CD            PIC X.
   711     12  NOTE-CERT-KEY.
   712         16  NOTE-CARRIER        PIC X.
   713         16  NOTE-GROUP          PIC X(6).
   714         16  NOTE-STATE          PIC XX.
   715         16  NOTE-ACCOUNT        PIC X(10).
   716         16  NOTE-DATE           PIC XX.
   717         16  NOTE-CERT-NO        PIC X(11).
   718
   719 01  TRLR-KEY.
   720     12  TRLR-MAIN-KEY.
   721         16  TRLR-COMPANY-CD     PIC X.
   722         16  TRLR-CARRIER        PIC X.
   723         16  TRLR-CLAIM-NO       PIC X(07).
   724         16  TRLR-CERT-NO        PIC X(11).
   725     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   726
   727 01  BENEFIT-KEY.
   728     12  BEN-CO-ID               PIC X(3).
   729     12  BEN-REC-TYPE            PIC X.
   730     12  FILLER                  PIC XX.
   731     12  BEN-ACC-CD              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  16
* EL131.cbl
   732     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   733
   734 01  CNTL-KEY.
   735     12  CNTL-CO-ID              PIC X(3).
   736     12  CNTL-REC-TYPE           PIC X.
   737     12  CNTL-PROC-ID            PIC X(4).
   738     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   739         16  CNTL-STATE-NUMBER   PIC XX.
   740         16  FILLER              PIC XX.
   741     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   742         16  FILLER              PIC X(3).
   743         16  CNTL-CARRIER        PIC X.
   744     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   745
   746 01  ACTQ-KEY                    PIC X(20).
   747
   748 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   749
   750 01  CHKQ-KEY.
   751     12  CHKQ-COMPANY-CODE       PIC X.
   752     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   753     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   754
   755 01  ARCH-KEY.
   756     12  ARCH-COMPANY-CODE       PIC X.
   757     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   758     12  ARCH-RECORD-TYPE        PIC X.
   759     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   760
   761 01  ACCT-KEY.
   762     05  ACCT-PARTIAL-KEY.
   763         12  ACCT-COMPANY-CODE   PIC X.
   764         12  ACCT-CARRIER        PIC X.
   765         12  ACCT-GROUP          PIC X(6).
   766         12  ACCT-STATE          PIC XX.
   767         12  ACCT-ACCOUNT        PIC X(10).
   768     05  ACCT-DATE               PIC XX.
   769
   770 01  WS-ELBENE-KEY.
   771     12  WS-ELBENE-COMPANY-CD    PIC X.
   772     12  WS-ELBENE-RECORD-TYPE   PIC X.
   773     12  WS-ELBENE-ID            PIC X(10).
   774
   775 01  ELALPH-KEY.
   776     12  ELALPH-COMPANY-CD       PIC X.
   777     12  ELALPH-SOURCE           PIC X.
   778     12  ELALPH-NAME.
   779         16  ELALPH-LAST-NAME    PIC X(15).
   780         16  ELALPH-FIRST-NAME.
   781             20  ELALPH-FIRST-INIT   PIC X.
   782             20  FILLER              PIC X(11).
   783         16  ELALPH-MIDDLE-INIT  PIC X.
   784     12  ELALPH-DATE             PIC X(08).
   785     12  ELALPH-TIME             PIC S9(04)    COMP.
   786
   787 01  COMP-LENGTHS.
   788     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   789     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  17
* EL131.cbl
   790     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   791     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   792     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   793     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   794     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   795     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   796     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   797     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   798     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   799     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   800     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   801     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  18
* EL131.cbl
   803*                                COPY ELCLNKLT.
   804******************************************************************
   805*                                                                *
   806*                                                                *
   807*                           ELCLNKLT                             *
   808*                            VMOD=2.003                          *
   809*                                                                *
   810*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   811*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   812*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   813*                                                                *
   814*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   815*   COMPLETING THE REQUIRED FIELDS.                              *
   816*                                                                *
   817*   THE CALLING PROGRAM SHOULD CHECK:                            *
   818*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   819*                              9999 INDICATES AN UNKNOWN ABEND   *
   820*                                   WAS DETECTED.                *
   821*                              ALL OTHER VALUES ARE NORMAL ERROR *
   822*                              CODES FOUND IN THE ERROR FILE.    *
   823******************************************************************
   824 01  W-1523-LINKDATA.
   825     12  W-1523-COMMON-PI-DATA.
   826         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   827         16  FILLER              PIC  X(67).
   828         16  W-1523-COMPANY-CD   PIC  X(01).
   829         16  FILLER              PIC  X(10).
   830         16  W-1523-CONTROL-IN-PROGRESS.
   831             20  W-1523-CARRIER  PIC  X(01).
   832             20  W-1523-GROUPING PIC  X(06).
   833             20  W-1523-STATE    PIC  X(02).
   834             20  W-1523-ACCOUNT  PIC  X(10).
   835             20  W-1523-CLAIM-CERT-GRP.
   836                 24  W-1523-CLAIM-NO
   837                                 PIC  X(07).
   838                 24  W-1523-CERT-NO.
   839                     28  W-1523-CERT-PRIME
   840                                 PIC  X(10).
   841                     28  W-1523-CERT-SFX
   842                                 PIC  X(01).
   843                 24  W-1523-CERT-EFF-DT
   844                                 PIC  X(02).
   845         16  FILLER              PIC X(265).
   846
   847     12  W-1523-WORK-AREA.
   848         16  W-1523-FORM-NUMBER  PIC  X(04).
   849         16  W-1523-NUMBER-COPIES
   850                                 PIC  9(01).
   851         16  W-1523-ADDR-TYPE    PIC  X(02).
   852         16  W-1523-FOLLOW-UP-DATE
   853                                 PIC  X(02).
   854         16  W-1523-RESEND-DATE  PIC  X(02).
   855         16  W-1523-ERROR-CODE   PIC  9(04).
   856             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   857             88  W-1523-FATAL-ERROR
   858                                    VALUES  0006 0013 0042
   859                                            0154 0168 0169
   860                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  19
* EL131.cbl
   861                                            0179 0186 0281
   862                                            0332 2055 3697
   863                                            3698 3699 3770
   864                                            3771 3772 7675
   865                                            9106 9808 9883
   866                                            9887.
   867             88  W-1523-STOP-ERRORS
   868                                    VALUES  0013 0042 0154
   869                                            0168 0169 0172
   870                                            0281 0332 2055
   871                                            3698 3699 7675
   872                                            9106 9808 9883
   873                                            9999.
   874         16  W-1523-REASON       PIC  X(70).
   875         16  W-1523-ARCHIVE-NUMBER
   876                                 PIC  9(08).
   877     12  W-1523-POINTER-AREA.
   878         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   879         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   880         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   881         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   882         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  20
* EL131.cbl
   884*                                COPY ELCINTF.
   885******************************************************************
   886*                                                                *
   887*                                                                *
   888*                            ELCINTF.                            *
   889*                            VMOD=2.017                          *
   890*                                                                *
   891*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   892*                                                                *
   893*       LENGTH = 1024                                            *
   894*                                                                *
   895******************************************************************
   896*                   C H A N G E   L O G
   897*
   898* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   899*-----------------------------------------------------------------
   900*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   901* EFFECTIVE    NUMBER
   902*-----------------------------------------------------------------
   903* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   904******************************************************************
   905 01  PROGRAM-INTERFACE-BLOCK.
   906     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   907     12  PI-CALLING-PROGRAM              PIC X(8).
   908     12  PI-SAVED-PROGRAM-1              PIC X(8).
   909     12  PI-SAVED-PROGRAM-2              PIC X(8).
   910     12  PI-SAVED-PROGRAM-3              PIC X(8).
   911     12  PI-SAVED-PROGRAM-4              PIC X(8).
   912     12  PI-SAVED-PROGRAM-5              PIC X(8).
   913     12  PI-SAVED-PROGRAM-6              PIC X(8).
   914     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   915     12  PI-COMPANY-ID                   PIC XXX.
   916     12  PI-COMPANY-CD                   PIC X.
   917
   918     12  PI-COMPANY-PASSWORD             PIC X(8).
   919
   920     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   921
   922     12  PI-CONTROL-IN-PROGRESS.
   923         16  PI-CARRIER                  PIC X.
   924         16  PI-GROUPING                 PIC X(6).
   925         16  PI-STATE                    PIC XX.
   926         16  PI-ACCOUNT                  PIC X(10).
   927         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   928                                         PIC X(10).
   929         16  PI-CLAIM-CERT-GRP.
   930             20  PI-CLAIM-NO             PIC X(7).
   931             20  PI-CERT-NO.
   932                 25  PI-CERT-PRIME       PIC X(10).
   933                 25  PI-CERT-SFX         PIC X.
   934             20  PI-CERT-EFF-DT          PIC XX.
   935         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   936             20  PI-PLAN-CODE            PIC X(2).
   937             20  PI-REVISION-NUMBER      PIC X(3).
   938             20  PI-PLAN-EFF-DT          PIC X(2).
   939             20  PI-PLAN-EXP-DT          PIC X(2).
   940             20  FILLER                  PIC X(11).
   941         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  21
* EL131.cbl
   942             20  PI-OE-REFERENCE-1.
   943                 25  PI-OE-REF-1-PRIME   PIC X(18).
   944                 25  PI-OE-REF-1-SUFF    PIC XX.
   945
   946     12  PI-SESSION-IN-PROGRESS          PIC X.
   947         88  CLAIM-SESSION                   VALUE '1'.
   948         88  CREDIT-SESSION                  VALUE '2'.
   949         88  WARRANTY-SESSION                VALUE '3'.
   950         88  MORTGAGE-SESSION                VALUE '4'.
   951         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   952
   953
   954*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   955
   956     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   957     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   958
   959     12  PI-CREDIT-USER                  PIC X.
   960         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   961         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   962
   963     12  PI-CLAIM-USER                   PIC X.
   964         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   965         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   966
   967     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   968         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   969         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   970         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   971         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   972         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   973
   974     12  PI-PROCESSOR-ID                 PIC X(4).
   975
   976     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   977
   978     12  PI-MEMBER-CAPTION               PIC X(10).
   979
   980     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   981         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   982
   983     12  PI-LIFE-OVERRIDE-L1             PIC X.
   984     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   985     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   986     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   987
   988     12  PI-AH-OVERRIDE-L1               PIC X.
   989     12  PI-AH-OVERRIDE-L2               PIC XX.
   990     12  PI-AH-OVERRIDE-L6               PIC X(6).
   991     12  PI-AH-OVERRIDE-L12              PIC X(12).
   992
   993     12  PI-NEW-SYSTEM                   PIC X(2).
   994
   995     12  PI-PRIMARY-CERT-NO              PIC X(11).
   996     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   997         88  PI-USES-PAID-TO                 VALUE '1'.
   998     12  PI-CRDTCRD-SYSTEM.
   999         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  22
* EL131.cbl
  1000             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1001             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1002         16  PI-CC-MONTH-END-DT          PIC XX.
  1003     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1004
  1005     12  PI-OE-REFERENCE-2.
  1006         16  PI-OE-REF-2-PRIME           PIC X(10).
  1007         16  PI-OE-REF-2-SUFF            PIC X.
  1008
  1009     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1010
  1011     12  PI-LANGUAGE-TYPE                PIC X.
  1012             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1013             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1014             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1015
  1016     12  PI-POLICY-LINKAGE-IND           PIC X.
  1017         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1018         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1019                                                   LOW-VALUES.
  1020
  1021     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1022     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1023         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1024         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1025
  1026     12  PI-PROCESSOR-CSR-IND            PIC X.
  1027         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1028         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1029
  1030     12  FILLER                          PIC X(3).
  1031
  1032     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1033
  1034     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1035         PI-SYSTEM-LEVEL.
  1036
  1037         16  PI-ENTRY-CODES.
  1038             20  PI-ENTRY-CD-1           PIC X.
  1039             20  PI-ENTRY-CD-2           PIC X.
  1040
  1041         16  PI-RETURN-CODES.
  1042             20  PI-RETURN-CD-1          PIC X.
  1043             20  PI-RETURN-CD-2          PIC X.
  1044
  1045         16  PI-UPDATE-STATUS-SAVE.
  1046             20  PI-UPDATE-BY            PIC X(4).
  1047             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1048
  1049         16  PI-LOWER-CASE-LETTERS       PIC X.
  1050             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1051
  1052*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1053*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1054*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1055
  1056         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1057             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  23
* EL131.cbl
  1058             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1059             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1060             88  ACCNT-CNTL                  VALUE '3'.
  1061             88  CARR-ACCNT-CNTL             VALUE '4'.
  1062
  1063         16  PI-PROCESSOR-CAP-LIST.
  1064             20  PI-SYSTEM-CONTROLS.
  1065                24 PI-SYSTEM-DISPLAY     PIC X.
  1066                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1067                24 PI-SYSTEM-MODIFY      PIC X.
  1068                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1069             20  FILLER                  PIC XX.
  1070             20  PI-DISPLAY-CAP          PIC X.
  1071                 88  DISPLAY-CAP             VALUE 'Y'.
  1072             20  PI-MODIFY-CAP           PIC X.
  1073                 88  MODIFY-CAP              VALUE 'Y'.
  1074             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1075                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1076             20  PI-FORCE-CAP            PIC X.
  1077                 88  FORCE-CAP               VALUE 'Y'.
  1078
  1079         16  PI-PROGRAM-CONTROLS.
  1080             20  PI-PGM-PRINT-OPT        PIC X.
  1081             20  PI-PGM-FORMAT-OPT       PIC X.
  1082             20  PI-PGM-PROCESS-OPT      PIC X.
  1083             20  PI-PGM-TOTALS-OPT       PIC X.
  1084
  1085         16  PI-HELP-INTERFACE.
  1086             20  PI-LAST-ERROR-NO        PIC X(4).
  1087             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1088
  1089         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1090             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1091
  1092         16  PI-CR-CONTROL-IN-PROGRESS.
  1093             20  PI-CR-CARRIER           PIC X.
  1094             20  PI-CR-GROUPING          PIC X(6).
  1095             20  PI-CR-STATE             PIC XX.
  1096             20  PI-CR-ACCOUNT           PIC X(10).
  1097             20  PI-CR-FIN-RESP          PIC X(10).
  1098             20  PI-CR-TYPE              PIC X.
  1099
  1100         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1101
  1102         16  PI-CR-MONTH-END-DT          PIC XX.
  1103
  1104         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1105             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1106             88  PI-ZERO-CARRIER             VALUE '1'.
  1107             88  PI-ZERO-GROUPING            VALUE '2'.
  1108             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1109
  1110         16  PI-CARRIER-SECURITY         PIC X.
  1111             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1112
  1113         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1114             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1115             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  24
* EL131.cbl
  1116
  1117         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1118             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1119                                         INDEXED BY PI-ACCESS-NDX
  1120                                         PIC X.
  1121
  1122         16  PI-GA-BILLING-CONTROL       PIC X.
  1123             88  PI-GA-BILLING               VALUE '1'.
  1124
  1125         16  PI-MAIL-PROCESSING          PIC X.
  1126             88  PI-MAIL-YES                 VALUE 'Y'.
  1127
  1128         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1129
  1130         16  PI-AR-SYSTEM.
  1131             20  PI-AR-PROCESSING-CNTL   PIC X.
  1132                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1133             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1134             20  PI-AR-MONTH-END-DT      PIC XX.
  1135
  1136         16  PI-MP-SYSTEM.
  1137             20  PI-MORTGAGE-USER            PIC X.
  1138                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1139                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1140             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1141                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1142                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1143                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1144                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1145                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1146             20  PI-MP-MONTH-END-DT          PIC XX.
  1147             20  PI-MP-REFERENCE-NO.
  1148                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1149                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1150
  1151         16  PI-LABEL-CONTROL            PIC X(01).
  1152             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1153             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1154
  1155         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1156             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1157
  1158         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1159             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1160             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1161
  1162         16  FILLER                      PIC X(14).
  1163
  1164     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1165******************************************************************
  1166     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1167         16  PI-NO-PMTS                    PIC 9(4).
  1168         16  PI-CERT-SWITCH                PIC X.
  1169             88  CREATED-CERT              VALUE '2'.
  1170         16  PI-PREM-TYPE                  PIC X.
  1171         16  PI-SAVE-CERT-NO.
  1172             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1173             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  25
* EL131.cbl
  1174         16  FILLER                        PIC X(46).
  1175         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1176         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1177         16  PI-REC-FOUND-SW               PIC X.
  1178         16  PI-LETTER-SW                  PIC X.
  1179         16  PI-PREV-TRLR-KEY              PIC X(22).
  1180         16  pi-claim-type                 pic x.
  1181         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1182         16  pi-approval-level             pic x.
  1183         16  FILLER                        PIC X(543).
  1184
  1185 01  SAVE-RECORD                 PIC X(450).
  1186
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  26
* EL131.cbl
  1188*                                COPY ELCLOGOF SUPPRESS.
  1189******************************************************************
  1190*                                                                *
  1191*                                                                *
  1192*                            ELCLOGOF.                           *
  1193*                            VMOD=2.001                          *
  1194*                                                                *
  1195*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1196*                                                                *
  1197******************************************************************
  1198 01  CLASIC-LOGOFF.
  1199     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1200     12  LOGOFF-TEXT.
  1201         16  FILLER          PIC X(5)    VALUE SPACES.
  1202         16  LOGOFF-MSG.
  1203             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1204             20  FILLER      PIC X       VALUE SPACES.
  1205             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1206         16  FILLER          PIC X(80)
  1207           VALUE '* YOU ARE NOW LOGGED OFF'.
  1208         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1209         16  FILLER          PIC X       VALUE QUOTE.
  1210         16  LOGOFF-SYS-MSG  PIC X(17)
  1211           VALUE 'S CLAS-IC SYSTEM '.
  1212     12  TEXT-MESSAGES.
  1213         16  UNACCESS-MSG    PIC X(29)
  1214             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1215         16  PGMIDERR-MSG    PIC X(17)
  1216             VALUE 'PROGRAM NOT FOUND'.
  1217
  1218*                                COPY ELCATTR SUPPRESS.
  1219******************************************************************
  1220*                                                                *
  1221*                            ELCATTR.                            *
  1222*                            VMOD=2.001                          *
  1223*                                                                *
  1224*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1225*                                                                *
  1226*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1227*                                                                *
  1228*                   POS 1   P=PROTECTED                          *
  1229*                           U=UNPROTECTED                        *
  1230*                           S=ASKIP                              *
  1231*                   POS 2   A=ALPHA/NUMERIC                      *
  1232*                           N=NUMERIC                            *
  1233*                   POS 3   N=NORMAL                             *
  1234*                           B=BRIGHT                             *
  1235*                           D=DARK                               *
  1236*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1237*                           OF=MODIFIED DATA TAG OFF             *
  1238*                                                                *
  1239*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1240******************************************************************
  1241 01  ATTRIBUTE-LIST.
  1242     12  AL-PABOF            PIC X       VALUE 'Y'.
  1243     12  AL-PABON            PIC X       VALUE 'Z'.
  1244     12  AL-PADOF            PIC X       VALUE '%'.
  1245     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  27
* EL131.cbl
  1246     12  AL-PANOF            PIC X       VALUE '-'.
  1247     12  AL-PANON            PIC X       VALUE '/'.
  1248     12  AL-SABOF            PIC X       VALUE '8'.
  1249     12  AL-SABON            PIC X       VALUE '9'.
  1250     12  AL-SADOF            PIC X       VALUE '@'.
  1251     12  AL-SADON            PIC X       VALUE QUOTE.
  1252     12  AL-SANOF            PIC X       VALUE '0'.
  1253     12  AL-SANON            PIC X       VALUE '1'.
  1254     12  AL-UABOF            PIC X       VALUE 'H'.
  1255     12  AL-UABON            PIC X       VALUE 'I'.
  1256     12  AL-UADOF            PIC X       VALUE '<'.
  1257     12  AL-UADON            PIC X       VALUE '('.
  1258     12  AL-UANOF            PIC X       VALUE ' '.
  1259     12  AL-UANON            PIC X       VALUE 'A'.
  1260     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1261     12  AL-UNBON            PIC X       VALUE 'R'.
  1262     12  AL-UNDOF            PIC X       VALUE '*'.
  1263     12  AL-UNDON            PIC X       VALUE ')'.
  1264     12  AL-UNNOF            PIC X       VALUE '&'.
  1265     12  AL-UNNON            PIC X       VALUE 'J'.
  1266
  1267*                                COPY ELCAID SUPPRESS.
  1268******************************************************************
  1269*                                                                *
  1270*                            ELCAID.                             *
  1271*                            VMOD=2.001                          *
  1272*                                                                *
  1273*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1274*                                                                *
  1275*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1276*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1277******************************************************************
  1278
  1279 01  DFHAID.
  1280   02  DFHNULL   PIC  X  VALUE  ' '.
  1281   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1282   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1283   02  DFHPEN    PIC  X  VALUE  '='.
  1284   02  DFHOPID   PIC  X  VALUE  'W'.
  1285   02  DFHPA1    PIC  X  VALUE  '%'.
  1286   02  DFHPA2    PIC  X  VALUE  '>'.
  1287   02  DFHPA3    PIC  X  VALUE  ','.
  1288   02  DFHPF1    PIC  X  VALUE  '1'.
  1289   02  DFHPF2    PIC  X  VALUE  '2'.
  1290   02  DFHPF3    PIC  X  VALUE  '3'.
  1291   02  DFHPF4    PIC  X  VALUE  '4'.
  1292   02  DFHPF5    PIC  X  VALUE  '5'.
  1293   02  DFHPF6    PIC  X  VALUE  '6'.
  1294   02  DFHPF7    PIC  X  VALUE  '7'.
  1295   02  DFHPF8    PIC  X  VALUE  '8'.
  1296   02  DFHPF9    PIC  X  VALUE  '9'.
  1297   02  DFHPF10   PIC  X  VALUE  ':'.
  1298   02  DFHPF11   PIC  X  VALUE  '#'.
  1299   02  DFHPF12   PIC  X  VALUE  '@'.
  1300   02  DFHPF13   PIC  X  VALUE  'A'.
  1301   02  DFHPF14   PIC  X  VALUE  'B'.
  1302   02  DFHPF15   PIC  X  VALUE  'C'.
  1303   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  28
* EL131.cbl
  1304   02  DFHPF17   PIC  X  VALUE  'E'.
  1305   02  DFHPF18   PIC  X  VALUE  'F'.
  1306   02  DFHPF19   PIC  X  VALUE  'G'.
  1307   02  DFHPF20   PIC  X  VALUE  'H'.
  1308   02  DFHPF21   PIC  X  VALUE  'I'.
  1309*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1310   02  DFHPF22   PIC  X  VALUE  '['.
  1311   02  DFHPF23   PIC  X  VALUE  '.'.
  1312   02  DFHPF24   PIC  X  VALUE  '<'.
  1313   02  DFHMSRE   PIC  X  VALUE  'X'.
  1314   02  DFHSTRF   PIC  X  VALUE  'h'.
  1315   02  DFHTRIG   PIC  X  VALUE  '"'.
  1316 01  FILLER REDEFINES DFHAID.
  1317     12  FILLER                  PIC X(8).
  1318     12  AID-KEYS OCCURS 24 TIMES.
  1319         16  FILLER              PIC X.
  1320
  1321*                                COPY EL131S.
  1322 01  EL131AI.
  1323     05  FILLER            PIC  X(0012).
  1324*    -------------------------------
  1325     05  DATEL PIC S9(0004) COMP.
  1326     05  DATEF PIC  X(0001).
  1327     05  FILLER REDEFINES DATEF.
  1328         10  DATEA PIC  X(0001).
  1329     05  DATEI PIC  X(0008).
  1330*    -------------------------------
  1331     05  TIMEL PIC S9(0004) COMP.
  1332     05  TIMEF PIC  X(0001).
  1333     05  FILLER REDEFINES TIMEF.
  1334         10  TIMEA PIC  X(0001).
  1335     05  TIMEI PIC  X(0005).
  1336*    -------------------------------
  1337     05  SEQUL PIC S9(0004) COMP.
  1338     05  SEQUF PIC  X(0001).
  1339     05  FILLER REDEFINES SEQUF.
  1340         10  SEQUA PIC  X(0001).
  1341     05  SEQUI PIC  X(0010).
  1342*    -------------------------------
  1343     05  COMPL PIC S9(0004) COMP.
  1344     05  COMPF PIC  X(0001).
  1345     05  FILLER REDEFINES COMPF.
  1346         10  COMPA PIC  X(0001).
  1347     05  COMPI PIC  X(0003).
  1348*    -------------------------------
  1349     05  USERIDL PIC S9(0004) COMP.
  1350     05  USERIDF PIC  X(0001).
  1351     05  FILLER REDEFINES USERIDF.
  1352         10  USERIDA PIC  X(0001).
  1353     05  USERIDI PIC  X(0004).
  1354*    -------------------------------
  1355     05  CCNOL PIC S9(0004) COMP.
  1356     05  CCNOF PIC  X(0001).
  1357     05  FILLER REDEFINES CCNOF.
  1358         10  CCNOA PIC  X(0001).
  1359     05  CCNOI PIC  X(0016).
  1360*    -------------------------------
  1361     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  29
* EL131.cbl
  1362     05  MAINTF PIC  X(0001).
  1363     05  FILLER REDEFINES MAINTF.
  1364         10  MAINTA PIC  X(0001).
  1365     05  MAINTI PIC  X(0001).
  1366*    -------------------------------
  1367     05  CLAIML PIC S9(0004) COMP.
  1368     05  CLAIMF PIC  X(0001).
  1369     05  FILLER REDEFINES CLAIMF.
  1370         10  CLAIMA PIC  X(0001).
  1371     05  CLAIMI PIC  X(0007).
  1372*    -------------------------------
  1373     05  CARRL PIC S9(0004) COMP.
  1374     05  CARRF PIC  X(0001).
  1375     05  FILLER REDEFINES CARRF.
  1376         10  CARRA PIC  X(0001).
  1377     05  CARRI PIC  X(0001).
  1378*    -------------------------------
  1379     05  CERTL PIC S9(0004) COMP.
  1380     05  CERTF PIC  X(0001).
  1381     05  FILLER REDEFINES CERTF.
  1382         10  CERTA PIC  X(0001).
  1383     05  CERTI PIC  X(0010).
  1384*    -------------------------------
  1385     05  SUFXL PIC S9(0004) COMP.
  1386     05  SUFXF PIC  X(0001).
  1387     05  FILLER REDEFINES SUFXF.
  1388         10  SUFXA PIC  X(0001).
  1389     05  SUFXI PIC  X(0001).
  1390*    -------------------------------
  1391     05  TYPEL PIC S9(0004) COMP.
  1392     05  TYPEF PIC  X(0001).
  1393     05  FILLER REDEFINES TYPEF.
  1394         10  TYPEA PIC  X(0001).
  1395     05  TYPEI PIC  X(0001).
  1396*    -------------------------------
  1397     05  LABEL1L PIC S9(0004) COMP.
  1398     05  LABEL1F PIC  X(0001).
  1399     05  FILLER REDEFINES LABEL1F.
  1400         10  LABEL1A PIC  X(0001).
  1401     05  LABEL1I PIC  X(0011).
  1402*    -------------------------------
  1403     05  PCERTNOL PIC S9(0004) COMP.
  1404     05  PCERTNOF PIC  X(0001).
  1405     05  FILLER REDEFINES PCERTNOF.
  1406         10  PCERTNOA PIC  X(0001).
  1407     05  PCERTNOI PIC  X(0010).
  1408*    -------------------------------
  1409     05  PSUFXL PIC S9(0004) COMP.
  1410     05  PSUFXF PIC  X(0001).
  1411     05  FILLER REDEFINES PSUFXF.
  1412         10  PSUFXA PIC  X(0001).
  1413     05  PSUFXI PIC  X(0001).
  1414*    -------------------------------
  1415     05  STATUSL PIC S9(0004) COMP.
  1416     05  STATUSF PIC  X(0001).
  1417     05  FILLER REDEFINES STATUSF.
  1418         10  STATUSA PIC  X(0001).
  1419     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  30
* EL131.cbl
  1420*    -------------------------------
  1421     05  INCL PIC S9(0004) COMP.
  1422     05  INCF PIC  X(0001).
  1423     05  FILLER REDEFINES INCF.
  1424         10  INCA PIC  X(0001).
  1425     05  INCI PIC  X(0008).
  1426*    -------------------------------
  1427     05  REPL PIC S9(0004) COMP.
  1428     05  REPF PIC  X(0001).
  1429     05  FILLER REDEFINES REPF.
  1430         10  REPA PIC  X(0001).
  1431     05  REPI PIC  X(0008).
  1432*    -------------------------------
  1433     05  CAUSEL PIC S9(0004) COMP.
  1434     05  CAUSEF PIC  X(0001).
  1435     05  FILLER REDEFINES CAUSEF.
  1436         10  CAUSEA PIC  X(0001).
  1437     05  CAUSEI PIC  X(0006).
  1438*    -------------------------------
  1439     05  ENDL PIC S9(0004) COMP.
  1440     05  ENDF PIC  X(0001).
  1441     05  FILLER REDEFINES ENDF.
  1442         10  ENDA PIC  X(0001).
  1443     05  ENDI PIC  X(0008).
  1444*    -------------------------------
  1445     05  DIAGL PIC S9(0004) COMP.
  1446     05  DIAGF PIC  X(0001).
  1447     05  FILLER REDEFINES DIAGF.
  1448         10  DIAGA PIC  X(0001).
  1449     05  DIAGI PIC  X(0060).
  1450*    -------------------------------
  1451     05  ACCSWL PIC S9(0004) COMP.
  1452     05  ACCSWF PIC  X(0001).
  1453     05  FILLER REDEFINES ACCSWF.
  1454         10  ACCSWA PIC  X(0001).
  1455     05  ACCSWI PIC  X(0001).
  1456*    -------------------------------
  1457     05  BENEL PIC S9(0004) COMP.
  1458     05  BENEF PIC  X(0001).
  1459     05  FILLER REDEFINES BENEF.
  1460         10  BENEA PIC  X(0001).
  1461     05  BENEI PIC  X(0010).
  1462*    -------------------------------
  1463     05  BIRTHL PIC S9(0004) COMP.
  1464     05  BIRTHF PIC  X(0001).
  1465     05  FILLER REDEFINES BIRTHF.
  1466         10  BIRTHA PIC  X(0001).
  1467     05  BIRTHI PIC  X(0008).
  1468*    -------------------------------
  1469     05  SOCIALL PIC S9(0004) COMP.
  1470     05  SOCIALF PIC  X(0001).
  1471     05  FILLER REDEFINES SOCIALF.
  1472         10  SOCIALA PIC  X(0001).
  1473     05  SOCIALI PIC  X(0011).
  1474*    -------------------------------
  1475     05  SEXL PIC S9(0004) COMP.
  1476     05  SEXF PIC  X(0001).
  1477     05  FILLER REDEFINES SEXF.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  31
* EL131.cbl
  1478         10  SEXA PIC  X(0001).
  1479     05  SEXI PIC  X(0001).
  1480*    -------------------------------
  1481     05  MLNAMEL PIC S9(0004) COMP.
  1482     05  MLNAMEF PIC  X(0001).
  1483     05  FILLER REDEFINES MLNAMEF.
  1484         10  MLNAMEA PIC  X(0001).
  1485     05  MLNAMEI PIC  X(0015).
  1486*    -------------------------------
  1487     05  MFNAMEL PIC S9(0004) COMP.
  1488     05  MFNAMEF PIC  X(0001).
  1489     05  FILLER REDEFINES MFNAMEF.
  1490         10  MFNAMEA PIC  X(0001).
  1491     05  MFNAMEI PIC  X(0012).
  1492*    -------------------------------
  1493     05  MMINITL PIC S9(0004) COMP.
  1494     05  MMINITF PIC  X(0001).
  1495     05  FILLER REDEFINES MMINITF.
  1496         10  MMINITA PIC  X(0001).
  1497     05  MMINITI PIC  X(0001).
  1498*    -------------------------------
  1499     05  LOANNOL PIC S9(0004) COMP.
  1500     05  LOANNOF PIC  X(0001).
  1501     05  FILLER REDEFINES LOANNOF.
  1502         10  LOANNOA PIC  X(0001).
  1503     05  LOANNOI PIC  X(0008).
  1504*    -------------------------------
  1505     05  CRTLNMEL PIC S9(0004) COMP.
  1506     05  CRTLNMEF PIC  X(0001).
  1507     05  FILLER REDEFINES CRTLNMEF.
  1508         10  CRTLNMEA PIC  X(0001).
  1509     05  CRTLNMEI PIC  X(0015).
  1510*    -------------------------------
  1511     05  CRTFNMEL PIC S9(0004) COMP.
  1512     05  CRTFNMEF PIC  X(0001).
  1513     05  FILLER REDEFINES CRTFNMEF.
  1514         10  CRTFNMEA PIC  X(0001).
  1515     05  CRTFNMEI PIC  X(0012).
  1516*    -------------------------------
  1517     05  CRTINITL PIC S9(0004) COMP.
  1518     05  CRTINITF PIC  X(0001).
  1519     05  FILLER REDEFINES CRTINITF.
  1520         10  CRTINITA PIC  X(0001).
  1521     05  CRTINITI PIC  X(0001).
  1522*    -------------------------------
  1523     05  LOANBALL PIC S9(0004) COMP.
  1524     05  LOANBALF PIC  X(0001).
  1525     05  FILLER REDEFINES LOANBALF.
  1526         10  LOANBALA PIC  X(0001).
  1527     05  LOANBALI PIC  9(7)V99.
  1528*    -------------------------------
  1529     05  PROCL PIC S9(0004) COMP.
  1530     05  PROCF PIC  X(0001).
  1531     05  FILLER REDEFINES PROCF.
  1532         10  PROCA PIC  X(0001).
  1533     05  PROCI PIC  X(0004).
  1534*    -------------------------------
  1535     05  SUPVL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  32
* EL131.cbl
  1536     05  SUPVF PIC  X(0001).
  1537     05  FILLER REDEFINES SUPVF.
  1538         10  SUPVA PIC  X(0001).
  1539     05  SUPVI PIC  X(0001).
  1540*    -------------------------------
  1541     05  PRICDL PIC S9(0004) COMP.
  1542     05  PRICDF PIC  X(0001).
  1543     05  FILLER REDEFINES PRICDF.
  1544         10  PRICDA PIC  X(0001).
  1545     05  PRICDI PIC  X(0001).
  1546*    -------------------------------
  1547     05  CRITPL PIC S9(0004) COMP.
  1548     05  CRITPF PIC  X(0001).
  1549     05  FILLER REDEFINES CRITPF.
  1550         10  CRITPA PIC  X(0001).
  1551     05  CRITPI PIC  X(0002).
  1552*    -------------------------------
  1553     05  CRITPTL PIC S9(0004) COMP.
  1554     05  CRITPTF PIC  X(0001).
  1555     05  FILLER REDEFINES CRITPTF.
  1556         10  CRITPTA PIC  X(0001).
  1557     05  CRITPTI PIC  X(0001).
  1558*    -------------------------------
  1559     05  RTWMOSL PIC S9(0004) COMP.
  1560     05  RTWMOSF PIC  X(0001).
  1561     05  FILLER REDEFINES RTWMOSF.
  1562         10  RTWMOSA PIC  X(0001).
  1563     05  RTWMOSI PIC  X(0002).
  1564*    -------------------------------
  1565     05  FILETOL PIC S9(0004) COMP.
  1566     05  FILETOF PIC  X(0001).
  1567     05  FILLER REDEFINES FILETOF.
  1568         10  FILETOA PIC  X(0001).
  1569     05  FILETOI PIC  X(0004).
  1570*    -------------------------------
  1571     05  PTHRHDGL PIC S9(0004) COMP.
  1572     05  PTHRHDGF PIC  X(0001).
  1573     05  FILLER REDEFINES PTHRHDGF.
  1574         10  PTHRHDGA PIC  X(0001).
  1575     05  PTHRHDGI PIC  X(0010).
  1576*    -------------------------------
  1577     05  PDTHRUL PIC S9(0004) COMP.
  1578     05  PDTHRUF PIC  X(0001).
  1579     05  FILLER REDEFINES PDTHRUF.
  1580         10  PDTHRUA PIC  X(0001).
  1581     05  PDTHRUI PIC  X(0008).
  1582*    -------------------------------
  1583     05  PDAMTL PIC S9(0004) COMP.
  1584     05  PDAMTF PIC  X(0001).
  1585     05  FILLER REDEFINES PDAMTF.
  1586         10  PDAMTA PIC  X(0001).
  1587     05  PDAMTI PIC  9(7)V99.
  1588*    -------------------------------
  1589     05  NODAYSL PIC S9(0004) COMP.
  1590     05  NODAYSF PIC  X(0001).
  1591     05  FILLER REDEFINES NODAYSF.
  1592         10  NODAYSA PIC  X(0001).
  1593     05  NODAYSI PIC  9(5).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  33
* EL131.cbl
  1594*    -------------------------------
  1595     05  NOPMTSL PIC S9(0004) COMP.
  1596     05  NOPMTSF PIC  X(0001).
  1597     05  FILLER REDEFINES NOPMTSF.
  1598         10  NOPMTSA PIC  X(0001).
  1599     05  NOPMTSI PIC  9(4).
  1600*    -------------------------------
  1601     05  FORMTYPL PIC S9(0004) COMP.
  1602     05  FORMTYPF PIC  X(0001).
  1603     05  FILLER REDEFINES FORMTYPF.
  1604         10  FORMTYPA PIC  X(0001).
  1605     05  FORMTYPI PIC  X(0001).
  1606*    -------------------------------
  1607     05  ESTL PIC S9(0004) COMP.
  1608     05  ESTF PIC  X(0001).
  1609     05  FILLER REDEFINES ESTF.
  1610         10  ESTA PIC  X(0001).
  1611     05  ESTI PIC  X(0008).
  1612*    -------------------------------
  1613     05  AUIDL PIC S9(0004) COMP.
  1614     05  AUIDF PIC  X(0001).
  1615     05  FILLER REDEFINES AUIDF.
  1616         10  AUIDA PIC  X(0001).
  1617     05  AUIDI PIC  X(0004).
  1618*    -------------------------------
  1619     05  OCCL PIC S9(0004) COMP.
  1620     05  OCCF PIC  X(0001).
  1621     05  FILLER REDEFINES OCCF.
  1622         10  OCCA PIC  X(0001).
  1623     05  OCCI PIC  X(0006).
  1624*    -------------------------------
  1625     05  MNTDTL PIC S9(0004) COMP.
  1626     05  MNTDTF PIC  X(0001).
  1627     05  FILLER REDEFINES MNTDTF.
  1628         10  MNTDTA PIC  X(0001).
  1629     05  MNTDTI PIC  X(0008).
  1630*    -------------------------------
  1631     05  MNTTYPEL PIC S9(0004) COMP.
  1632     05  MNTTYPEF PIC  X(0001).
  1633     05  FILLER REDEFINES MNTTYPEF.
  1634         10  MNTTYPEA PIC  X(0001).
  1635     05  MNTTYPEI PIC  X(0006).
  1636*    -------------------------------
  1637     05  CERTCARL PIC S9(0004) COMP.
  1638     05  CERTCARF PIC  X(0001).
  1639     05  FILLER REDEFINES CERTCARF.
  1640         10  CERTCARA PIC  X(0001).
  1641     05  CERTCARI PIC  X(0001).
  1642*    -------------------------------
  1643     05  CERTGRPL PIC S9(0004) COMP.
  1644     05  CERTGRPF PIC  X(0001).
  1645     05  FILLER REDEFINES CERTGRPF.
  1646         10  CERTGRPA PIC  X(0001).
  1647     05  CERTGRPI PIC  X(0006).
  1648*    -------------------------------
  1649     05  CERTSTL PIC S9(0004) COMP.
  1650     05  CERTSTF PIC  X(0001).
  1651     05  FILLER REDEFINES CERTSTF.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  34
* EL131.cbl
  1652         10  CERTSTA PIC  X(0001).
  1653     05  CERTSTI PIC  X(0002).
  1654*    -------------------------------
  1655     05  CERTACTL PIC S9(0004) COMP.
  1656     05  CERTACTF PIC  X(0001).
  1657     05  FILLER REDEFINES CERTACTF.
  1658         10  CERTACTA PIC  X(0001).
  1659     05  CERTACTI PIC  X(0010).
  1660*    -------------------------------
  1661     05  CERTEFFL PIC S9(0004) COMP.
  1662     05  CERTEFFF PIC  X(0001).
  1663     05  FILLER REDEFINES CERTEFFF.
  1664         10  CERTEFFA PIC  X(0001).
  1665     05  CERTEFFI PIC  X(0008).
  1666*    -------------------------------
  1667     05  ISSAGEL PIC S9(0004) COMP.
  1668     05  ISSAGEF PIC  X(0001).
  1669     05  FILLER REDEFINES ISSAGEF.
  1670         10  ISSAGEA PIC  X(0001).
  1671     05  ISSAGEI PIC  X(0002).
  1672*    -------------------------------
  1673     05  APRL PIC S9(0004) COMP.
  1674     05  APRF PIC  X(0001).
  1675     05  FILLER REDEFINES APRF.
  1676         10  APRA PIC  X(0001).
  1677     05  APRI PIC  9(4)V9(4).
  1678*    -------------------------------
  1679     05  PMTFREQL PIC S9(0004) COMP.
  1680     05  PMTFREQF PIC  X(0001).
  1681     05  FILLER REDEFINES PMTFREQF.
  1682         10  PMTFREQA PIC  X(0001).
  1683     05  PMTFREQI PIC  99.
  1684*    -------------------------------
  1685     05  INDGRPL PIC S9(0004) COMP.
  1686     05  INDGRPF PIC  X(0001).
  1687     05  FILLER REDEFINES INDGRPF.
  1688         10  INDGRPA PIC  X(0001).
  1689     05  INDGRPI PIC  X(0001).
  1690*    -------------------------------
  1691     05  PREMTYPL PIC S9(0004) COMP.
  1692     05  PREMTYPF PIC  X(0001).
  1693     05  FILLER REDEFINES PREMTYPF.
  1694         10  PREMTYPA PIC  X(0001).
  1695     05  PREMTYPI PIC  X(0001).
  1696*    -------------------------------
  1697     05  REINCDL PIC S9(0004) COMP.
  1698     05  REINCDF PIC  X(0001).
  1699     05  FILLER REDEFINES REINCDF.
  1700         10  REINCDA PIC  X(0001).
  1701     05  REINCDI PIC  X(0001).
  1702*    -------------------------------
  1703     05  JNTLNMEL PIC S9(0004) COMP.
  1704     05  JNTLNMEF PIC  X(0001).
  1705     05  FILLER REDEFINES JNTLNMEF.
  1706         10  JNTLNMEA PIC  X(0001).
  1707     05  JNTLNMEI PIC  X(0015).
  1708*    -------------------------------
  1709     05  JNTFNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  35
* EL131.cbl
  1710     05  JNTFNMEF PIC  X(0001).
  1711     05  FILLER REDEFINES JNTFNMEF.
  1712         10  JNTFNMEA PIC  X(0001).
  1713     05  JNTFNMEI PIC  X(0012).
  1714*    -------------------------------
  1715     05  JNTINITL PIC S9(0004) COMP.
  1716     05  JNTINITF PIC  X(0001).
  1717     05  FILLER REDEFINES JNTINITF.
  1718         10  JNTINITA PIC  X(0001).
  1719     05  JNTINITI PIC  X(0001).
  1720*    -------------------------------
  1721     05  JNTAGEL PIC S9(0004) COMP.
  1722     05  JNTAGEF PIC  X(0001).
  1723     05  FILLER REDEFINES JNTAGEF.
  1724         10  JNTAGEA PIC  X(0001).
  1725     05  JNTAGEI PIC  X(0002).
  1726*    -------------------------------
  1727     05  ADDONDTL PIC S9(0004) COMP.
  1728     05  ADDONDTF PIC  X(0001).
  1729     05  FILLER REDEFINES ADDONDTF.
  1730         10  ADDONDTA PIC  X(0001).
  1731     05  ADDONDTI PIC  X(0008).
  1732*    -------------------------------
  1733     05  LCVDSCRL PIC S9(0004) COMP.
  1734     05  LCVDSCRF PIC  X(0001).
  1735     05  FILLER REDEFINES LCVDSCRF.
  1736         10  LCVDSCRA PIC  X(0001).
  1737     05  LCVDSCRI PIC  X(0006).
  1738*    -------------------------------
  1739     05  LCVKINDL PIC S9(0004) COMP.
  1740     05  LCVKINDF PIC  X(0001).
  1741     05  FILLER REDEFINES LCVKINDF.
  1742         10  LCVKINDA PIC  X(0001).
  1743     05  LCVKINDI PIC  X(0003).
  1744*    -------------------------------
  1745     05  LCVCDL PIC S9(0004) COMP.
  1746     05  LCVCDF PIC  X(0001).
  1747     05  FILLER REDEFINES LCVCDF.
  1748         10  LCVCDA PIC  X(0001).
  1749     05  LCVCDI PIC  X(0002).
  1750*    -------------------------------
  1751     05  LCVOTRML PIC S9(0004) COMP.
  1752     05  LCVOTRMF PIC  X(0001).
  1753     05  FILLER REDEFINES LCVOTRMF.
  1754         10  LCVOTRMA PIC  X(0001).
  1755     05  LCVOTRMI PIC  999.
  1756*    -------------------------------
  1757     05  LCVRTRML PIC S9(0004) COMP.
  1758     05  LCVRTRMF PIC  X(0001).
  1759     05  FILLER REDEFINES LCVRTRMF.
  1760         10  LCVRTRMA PIC  X(0001).
  1761     05  LCVRTRMI PIC  X(0003).
  1762*    -------------------------------
  1763     05  LCVRATEL PIC S9(0004) COMP.
  1764     05  LCVRATEF PIC  X(0001).
  1765     05  FILLER REDEFINES LCVRATEF.
  1766         10  LCVRATEA PIC  X(0001).
  1767     05  LCVRATEI PIC  9999V99.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  36
* EL131.cbl
  1768*    -------------------------------
  1769     05  LCVBENEL PIC S9(0004) COMP.
  1770     05  LCVBENEF PIC  X(0001).
  1771     05  FILLER REDEFINES LCVBENEF.
  1772         10  LCVBENEA PIC  X(0001).
  1773     05  LCVBENEI PIC  9(9)V99.
  1774*    -------------------------------
  1775     05  LCVFORML PIC S9(0004) COMP.
  1776     05  LCVFORMF PIC  X(0001).
  1777     05  FILLER REDEFINES LCVFORMF.
  1778         10  LCVFORMA PIC  X(0001).
  1779     05  LCVFORMI PIC  X(0012).
  1780*    -------------------------------
  1781     05  LCVCNDTL PIC S9(0004) COMP.
  1782     05  LCVCNDTF PIC  X(0001).
  1783     05  FILLER REDEFINES LCVCNDTF.
  1784         10  LCVCNDTA PIC  X(0001).
  1785     05  LCVCNDTI PIC  X(0008).
  1786*    -------------------------------
  1787     05  LCVEXITL PIC S9(0004) COMP.
  1788     05  LCVEXITF PIC  X(0001).
  1789     05  FILLER REDEFINES LCVEXITF.
  1790         10  LCVEXITA PIC  X(0001).
  1791     05  LCVEXITI PIC  X(0008).
  1792*    -------------------------------
  1793     05  LCVSTATL PIC S9(0004) COMP.
  1794     05  LCVSTATF PIC  X(0001).
  1795     05  FILLER REDEFINES LCVSTATF.
  1796         10  LCVSTATA PIC  X(0001).
  1797     05  LCVSTATI PIC  X(0006).
  1798*    -------------------------------
  1799     05  ACVDSCRL PIC S9(0004) COMP.
  1800     05  ACVDSCRF PIC  X(0001).
  1801     05  FILLER REDEFINES ACVDSCRF.
  1802         10  ACVDSCRA PIC  X(0001).
  1803     05  ACVDSCRI PIC  X(0006).
  1804*    -------------------------------
  1805     05  ACVKINDL PIC S9(0004) COMP.
  1806     05  ACVKINDF PIC  X(0001).
  1807     05  FILLER REDEFINES ACVKINDF.
  1808         10  ACVKINDA PIC  X(0001).
  1809     05  ACVKINDI PIC  X(0003).
  1810*    -------------------------------
  1811     05  ACVCDL PIC S9(0004) COMP.
  1812     05  ACVCDF PIC  X(0001).
  1813     05  FILLER REDEFINES ACVCDF.
  1814         10  ACVCDA PIC  X(0001).
  1815     05  ACVCDI PIC  X(0002).
  1816*    -------------------------------
  1817     05  ACVOTRML PIC S9(0004) COMP.
  1818     05  ACVOTRMF PIC  X(0001).
  1819     05  FILLER REDEFINES ACVOTRMF.
  1820         10  ACVOTRMA PIC  X(0001).
  1821     05  ACVOTRMI PIC  999.
  1822*    -------------------------------
  1823     05  ACVRTRML PIC S9(0004) COMP.
  1824     05  ACVRTRMF PIC  X(0001).
  1825     05  FILLER REDEFINES ACVRTRMF.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  37
* EL131.cbl
  1826         10  ACVRTRMA PIC  X(0001).
  1827     05  ACVRTRMI PIC  X(0003).
  1828*    -------------------------------
  1829     05  ACVRATEL PIC S9(0004) COMP.
  1830     05  ACVRATEF PIC  X(0001).
  1831     05  FILLER REDEFINES ACVRATEF.
  1832         10  ACVRATEA PIC  X(0001).
  1833     05  ACVRATEI PIC  9999V99.
  1834*    -------------------------------
  1835     05  ACVBENEL PIC S9(0004) COMP.
  1836     05  ACVBENEF PIC  X(0001).
  1837     05  FILLER REDEFINES ACVBENEF.
  1838         10  ACVBENEA PIC  X(0001).
  1839     05  ACVBENEI PIC  9(9)V99.
  1840*    -------------------------------
  1841     05  ACVFORML PIC S9(0004) COMP.
  1842     05  ACVFORMF PIC  X(0001).
  1843     05  FILLER REDEFINES ACVFORMF.
  1844         10  ACVFORMA PIC  X(0001).
  1845     05  ACVFORMI PIC  X(0012).
  1846*    -------------------------------
  1847     05  ACVCNDTL PIC S9(0004) COMP.
  1848     05  ACVCNDTF PIC  X(0001).
  1849     05  FILLER REDEFINES ACVCNDTF.
  1850         10  ACVCNDTA PIC  X(0001).
  1851     05  ACVCNDTI PIC  X(0008).
  1852*    -------------------------------
  1853     05  ACVEXITL PIC S9(0004) COMP.
  1854     05  ACVEXITF PIC  X(0001).
  1855     05  FILLER REDEFINES ACVEXITF.
  1856         10  ACVEXITA PIC  X(0001).
  1857     05  ACVEXITI PIC  X(0008).
  1858*    -------------------------------
  1859     05  ACVSTATL PIC S9(0004) COMP.
  1860     05  ACVSTATF PIC  X(0001).
  1861     05  FILLER REDEFINES ACVSTATF.
  1862         10  ACVSTATA PIC  X(0001).
  1863     05  ACVSTATI PIC  X(0006).
  1864*    -------------------------------
  1865     05  LABEL2L PIC S9(0004) COMP.
  1866     05  LABEL2F PIC  X(0001).
  1867     05  FILLER REDEFINES LABEL2F.
  1868         10  LABEL2A PIC  X(0001).
  1869     05  LABEL2I PIC  X(0014).
  1870*    -------------------------------
  1871     05  BCERT1L PIC S9(0004) COMP.
  1872     05  BCERT1F PIC  X(0001).
  1873     05  FILLER REDEFINES BCERT1F.
  1874         10  BCERT1A PIC  X(0001).
  1875     05  BCERT1I PIC  X(0010).
  1876*    -------------------------------
  1877     05  BSUFX1L PIC S9(0004) COMP.
  1878     05  BSUFX1F PIC  X(0001).
  1879     05  FILLER REDEFINES BSUFX1F.
  1880         10  BSUFX1A PIC  X(0001).
  1881     05  BSUFX1I PIC  X(0001).
  1882*    -------------------------------
  1883     05  BCERT2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  38
* EL131.cbl
  1884     05  BCERT2F PIC  X(0001).
  1885     05  FILLER REDEFINES BCERT2F.
  1886         10  BCERT2A PIC  X(0001).
  1887     05  BCERT2I PIC  X(0010).
  1888*    -------------------------------
  1889     05  BSUFX2L PIC S9(0004) COMP.
  1890     05  BSUFX2F PIC  X(0001).
  1891     05  FILLER REDEFINES BSUFX2F.
  1892         10  BSUFX2A PIC  X(0001).
  1893     05  BSUFX2I PIC  X(0001).
  1894*    -------------------------------
  1895     05  BCERT3L PIC S9(0004) COMP.
  1896     05  BCERT3F PIC  X(0001).
  1897     05  FILLER REDEFINES BCERT3F.
  1898         10  BCERT3A PIC  X(0001).
  1899     05  BCERT3I PIC  X(0010).
  1900*    -------------------------------
  1901     05  BSUFX3L PIC S9(0004) COMP.
  1902     05  BSUFX3F PIC  X(0001).
  1903     05  FILLER REDEFINES BSUFX3F.
  1904         10  BSUFX3A PIC  X(0001).
  1905     05  BSUFX3I PIC  X(0001).
  1906*    -------------------------------
  1907     05  BCERT4L PIC S9(0004) COMP.
  1908     05  BCERT4F PIC  X(0001).
  1909     05  FILLER REDEFINES BCERT4F.
  1910         10  BCERT4A PIC  X(0001).
  1911     05  BCERT4I PIC  X(0010).
  1912*    -------------------------------
  1913     05  BSUFX4L PIC S9(0004) COMP.
  1914     05  BSUFX4F PIC  X(0001).
  1915     05  FILLER REDEFINES BSUFX4F.
  1916         10  BSUFX4A PIC  X(0001).
  1917     05  BSUFX4I PIC  X(0001).
  1918*    -------------------------------
  1919     05  BCERT5L PIC S9(0004) COMP.
  1920     05  BCERT5F PIC  X(0001).
  1921     05  FILLER REDEFINES BCERT5F.
  1922         10  BCERT5A PIC  X(0001).
  1923     05  BCERT5I PIC  X(0010).
  1924*    -------------------------------
  1925     05  BSUFX5L PIC S9(0004) COMP.
  1926     05  BSUFX5F PIC  X(0001).
  1927     05  FILLER REDEFINES BSUFX5F.
  1928         10  BSUFX5A PIC  X(0001).
  1929     05  BSUFX5I PIC  X(0001).
  1930*    -------------------------------
  1931     05  MSG1L PIC S9(0004) COMP.
  1932     05  MSG1F PIC  X(0001).
  1933     05  FILLER REDEFINES MSG1F.
  1934         10  MSG1A PIC  X(0001).
  1935     05  MSG1I PIC  X(0072).
  1936*    -------------------------------
  1937     05  MSG2L PIC S9(0004) COMP.
  1938     05  MSG2F PIC  X(0001).
  1939     05  FILLER REDEFINES MSG2F.
  1940         10  MSG2A PIC  X(0001).
  1941     05  MSG2I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  39
* EL131.cbl
  1942*    -------------------------------
  1943     05  PFKEYL PIC S9(0004) COMP.
  1944     05  PFKEYF PIC  X(0001).
  1945     05  FILLER REDEFINES PFKEYF.
  1946         10  PFKEYA PIC  X(0001).
  1947     05  PFKEYI PIC  99.
  1948*    -------------------------------
  1949     05  PFKEY6L PIC S9(0004) COMP.
  1950     05  PFKEY6F PIC  X(0001).
  1951     05  FILLER REDEFINES PFKEY6F.
  1952         10  PFKEY6A PIC  X(0001).
  1953     05  PFKEY6I PIC  X(0016).
  1954 01  EL131AO REDEFINES EL131AI.
  1955     05  FILLER            PIC  X(0012).
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  DATEO PIC  X(0008).
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  TIMEO PIC  99.99.
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  SEQUO PIC  X(0010).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  COMPO PIC  X(0003).
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
  1970     05  USERIDO PIC  X(0004).
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  CCNOO PIC  X(0016).
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
  1976     05  MAINTO PIC  X(0001).
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  CLAIMO PIC  X(0007).
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
  1982     05  CARRO PIC  X(0001).
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  CERTO PIC  X(0010).
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  SUFXO PIC  X(0001).
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
  1991     05  TYPEO PIC  X(0001).
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  LABEL1O PIC  X(0011).
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  PCERTNOO PIC  X(0010).
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  40
* EL131.cbl
  2000     05  PSUFXO PIC  X(0001).
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  STATUSO PIC  X(0006).
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  INCO PIC  X(0008).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  REPO PIC  X(0008).
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  CAUSEO PIC  X(0006).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  ENDO PIC  X(0008).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  DIAGO PIC  X(0060).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  ACCSWO PIC  X(0001).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  BENEO PIC  X(0010).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  BIRTHO PIC  X(0008).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  SOCIALO PIC  X(0011).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  SEXO PIC  X(0001).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  MLNAMEO PIC  X(0015).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  MFNAMEO PIC  X(0012).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  MMINITO PIC  X(0001).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  LOANNOO PIC  X(0008).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  CRTLNMEO PIC  X(0015).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  CRTFNMEO PIC  X(0012).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  CRTINITO PIC  X(0001).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  LOANBALO PIC  ZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  41
* EL131.cbl
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  PROCO PIC  X(0004).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  SUPVO PIC  X(0001).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  PRICDO PIC  X(0001).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  CRITPO PIC  X(0002).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  CRITPTO PIC  X(0001).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  RTWMOSO PIC  X(0002).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  FILETOO PIC  X(0004).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  PTHRHDGO PIC  X(0010).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  PDTHRUO PIC  X(0008).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  PDAMTO PIC  Z(06).99.
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  NODAYSO PIC  ZZZ99.
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  NOPMTSO PIC  ZZ99.
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  FORMTYPO PIC  X(0001).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  ESTO PIC  X(0008).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  AUIDO PIC  X(0004).
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  OCCO PIC  X(0006).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  MNTDTO PIC  X(0008).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  MNTTYPEO PIC  X(0006).
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  CERTCARO PIC  X(0001).
  2115*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  42
* EL131.cbl
  2116     05  FILLER            PIC  X(0003).
  2117     05  CERTGRPO PIC  X(0006).
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  CERTSTO PIC  X(0002).
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  CERTACTO PIC  X(0010).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  CERTEFFO PIC  X(0008).
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  ISSAGEO PIC  X(0002).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  APRO PIC  9(3).9(4).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  PMTFREQO PIC  99.
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  INDGRPO PIC  X(0001).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  PREMTYPO PIC  X(0001).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  REINCDO PIC  X(0001).
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  JNTLNMEO PIC  X(0015).
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  JNTFNMEO PIC  X(0012).
  2151*    -------------------------------
  2152     05  FILLER            PIC  X(0003).
  2153     05  JNTINITO PIC  X(0001).
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  JNTAGEO PIC  X(0002).
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  ADDONDTO PIC  X(0008).
  2160*    -------------------------------
  2161     05  FILLER            PIC  X(0003).
  2162     05  LCVDSCRO PIC  X(0006).
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  LCVKINDO PIC  X(0003).
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  LCVCDO PIC  X(0002).
  2169*    -------------------------------
  2170     05  FILLER            PIC  X(0003).
  2171     05  LCVOTRMO PIC  999.
  2172*    -------------------------------
  2173     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  43
* EL131.cbl
  2174     05  LCVRTRMO PIC  999.
  2175*    -------------------------------
  2176     05  FILLER            PIC  X(0003).
  2177     05  LCVRATEO PIC  ZZZ.ZZ.
  2178*    -------------------------------
  2179     05  FILLER            PIC  X(0003).
  2180     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2181*    -------------------------------
  2182     05  FILLER            PIC  X(0003).
  2183     05  LCVFORMO PIC  X(0012).
  2184*    -------------------------------
  2185     05  FILLER            PIC  X(0003).
  2186     05  LCVCNDTO PIC  X(0008).
  2187*    -------------------------------
  2188     05  FILLER            PIC  X(0003).
  2189     05  LCVEXITO PIC  X(0008).
  2190*    -------------------------------
  2191     05  FILLER            PIC  X(0003).
  2192     05  LCVSTATO PIC  X(0006).
  2193*    -------------------------------
  2194     05  FILLER            PIC  X(0003).
  2195     05  ACVDSCRO PIC  X(0006).
  2196*    -------------------------------
  2197     05  FILLER            PIC  X(0003).
  2198     05  ACVKINDO PIC  X(0003).
  2199*    -------------------------------
  2200     05  FILLER            PIC  X(0003).
  2201     05  ACVCDO PIC  X(0002).
  2202*    -------------------------------
  2203     05  FILLER            PIC  X(0003).
  2204     05  ACVOTRMO PIC  999.
  2205*    -------------------------------
  2206     05  FILLER            PIC  X(0003).
  2207     05  ACVRTRMO PIC  999.
  2208*    -------------------------------
  2209     05  FILLER            PIC  X(0003).
  2210     05  ACVRATEO PIC  ZZZ.ZZ.
  2211*    -------------------------------
  2212     05  FILLER            PIC  X(0003).
  2213     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2214*    -------------------------------
  2215     05  FILLER            PIC  X(0003).
  2216     05  ACVFORMO PIC  X(0012).
  2217*    -------------------------------
  2218     05  FILLER            PIC  X(0003).
  2219     05  ACVCNDTO PIC  X(0008).
  2220*    -------------------------------
  2221     05  FILLER            PIC  X(0003).
  2222     05  ACVEXITO PIC  X(0008).
  2223*    -------------------------------
  2224     05  FILLER            PIC  X(0003).
  2225     05  ACVSTATO PIC  X(0006).
  2226*    -------------------------------
  2227     05  FILLER            PIC  X(0003).
  2228     05  LABEL2O PIC  X(0014).
  2229*    -------------------------------
  2230     05  FILLER            PIC  X(0003).
  2231     05  BCERT1O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  44
* EL131.cbl
  2232*    -------------------------------
  2233     05  FILLER            PIC  X(0003).
  2234     05  BSUFX1O PIC  X(0001).
  2235*    -------------------------------
  2236     05  FILLER            PIC  X(0003).
  2237     05  BCERT2O PIC  X(0010).
  2238*    -------------------------------
  2239     05  FILLER            PIC  X(0003).
  2240     05  BSUFX2O PIC  X(0001).
  2241*    -------------------------------
  2242     05  FILLER            PIC  X(0003).
  2243     05  BCERT3O PIC  X(0010).
  2244*    -------------------------------
  2245     05  FILLER            PIC  X(0003).
  2246     05  BSUFX3O PIC  X(0001).
  2247*    -------------------------------
  2248     05  FILLER            PIC  X(0003).
  2249     05  BCERT4O PIC  X(0010).
  2250*    -------------------------------
  2251     05  FILLER            PIC  X(0003).
  2252     05  BSUFX4O PIC  X(0001).
  2253*    -------------------------------
  2254     05  FILLER            PIC  X(0003).
  2255     05  BCERT5O PIC  X(0010).
  2256*    -------------------------------
  2257     05  FILLER            PIC  X(0003).
  2258     05  BSUFX5O PIC  X(0001).
  2259*    -------------------------------
  2260     05  FILLER            PIC  X(0003).
  2261     05  MSG1O PIC  X(0072).
  2262*    -------------------------------
  2263     05  FILLER            PIC  X(0003).
  2264     05  MSG2O PIC  X(0072).
  2265*    -------------------------------
  2266     05  FILLER            PIC  X(0003).
  2267     05  PFKEYO PIC  X(0002).
  2268*    -------------------------------
  2269     05  FILLER            PIC  X(0003).
  2270     05  PFKEY6O PIC  X(0016).
  2271*    -------------------------------
  2272
  2273*                                COPY ELCEMIB SUPPRESS.
  2274******************************************************************
  2275*                                                                *
  2276*                                                                *
  2277*                            ELCEMIB.                            *
  2278*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2279*                            VMOD=2.005                          *
  2280*                                                                *
  2281*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2282*                                                                *
  2283******************************************************************
  2284 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2285     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2286     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2287     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2288     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2289     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  45
* EL131.cbl
  2290     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2291     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2292     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2293     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2294         88  EMI-NO-ERRORS                    VALUE '1'.
  2295         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2296         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2297     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2298         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2299     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2300         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2301         88  EMI-AREA1-FULL                   VALUE '2'.
  2302     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2303         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2304         88  EMI-AREA2-FULL                   VALUE '2'.
  2305     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2306         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2307         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2308         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2309         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2310         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2311     12  EMI-ERROR-LINES.
  2312         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2313         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2314         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2315         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2316             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2317                 24  EMI-ERR-NUM         PIC X(4).
  2318                 24  EMI-FILLER          PIC X.
  2319                 24  EMI-SEV             PIC X.
  2320                 24  FILLER              PIC X.
  2321             20  FILLER                  PIC X(02).
  2322     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2323         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2324             20  EMI-ERROR-NUMBER    PIC X(4).
  2325             20  EMI-FILL            PIC X.
  2326             20  EMI-SEVERITY        PIC X.
  2327             20  FILLER              PIC X.
  2328             20  EMI-ERROR-TEXT.
  2329                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2330                 24  FILLER          PIC X(55).
  2331     12  EMI-SEVERITY-SAVE           PIC X.
  2332         88  EMI-NOTE                    VALUE 'N'.
  2333         88  EMI-WARNING                 VALUE 'W'.
  2334         88  EMI-FORCABLE                VALUE 'F'.
  2335         88  EMI-FATAL                   VALUE 'X'.
  2336     12  EMI-MESSAGE-FLAG            PIC X.
  2337         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2338         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2339     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2340     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2341         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2342         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2343         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2344     12  emi-claim-no                pic x(7).
  2345     12  emi-claim-type              pic x(6).
  2346     12  FILLER                      PIC X(124)  VALUE SPACES.
  2347     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  46
* EL131.cbl
  2348     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2349     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2350     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2351
  2352*                                COPY ELCJPFX SUPPRESS.
  2353******************************************************************
  2354*                                                                *
  2355*                                                                *
  2356*                            ELCJPFX.                            *
  2357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2358*                            VMOD=2.002                          *
  2359*                                                                *
  2360*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2361*                                                                *
  2362*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2363*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2364*        ELCNTL - CONTROL FILE                                   *
  2365*        ELMSTR - CLAIM MASTERS                                  *
  2366*        ELTRLR - ACTIVITY TRAILERS                              *
  2367*        ELCHKQ - CHECK QUE                                      *
  2368******************************************************************
  2369 01  JOURNAL-RECORD.
  2370     12  JP-USER-ID                  PIC X(4).
  2371     12  JP-FILE-ID                  PIC X(8).
  2372     12  JP-PROGRAM-ID               PIC X(8).
  2373     12  JP-RECORD-TYPE              PIC X.
  2374         88 JP-ADD              VALUE 'A'.
  2375         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2376         88 JP-AFTER-CHANGE     VALUE 'C'.
  2377         88 JP-DELETE           VALUE 'D'.
  2378         88 JP-GENERIC-DELETE   VALUE 'G'.
  2379         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2380         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2381     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2382     12  JP-RECORD-AREA
  2383
  2384
  2385                                 PIC X(750).
  2386
  2387*                                COPY ELCCALC.
  2388******************************************************************
  2389*                                                                *
  2390*                           ELCCALC.                            *
  2391*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2392*                            VMOD=2.025                          *
  2393*                                                                *
  2394*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2395*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2396*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2397*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2398*                                                                *
  2399*  PASSED TO ELRTRM                                              *
  2400*  -----------------                                             *
  2401*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2402*  ORIGINAL TERM                                                 *
  2403*  BEGINNING DATE                                                *
  2404*  ENDING DATE                                                   *
  2405*  COMPANY I.D.                                                  *
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  47
* EL131.cbl
  2406*  ACCOUNT MASTER USER FIELD                                     *
  2407*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2408*  FREE LOOK DAYS                                                *
  2409*                                                                *
  2410*  RETURNED FROM ELRTRM                                          *
  2411*  ---------------------                                         *
  2412*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2413*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2414*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2415*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2416*----------------------------------------------------------------*
  2417*  PASSED TO ELRAMT                                              *
  2418*  ----------------                                              *
  2419*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2420*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2421*  ORIGINAL AMOUNT                                               *
  2422*  ALTERNATE BENEFIT (BALLON)                                    *
  2423*  A.P.R. - NET PAY ONLY                                         *
  2424*  METHOD
  2425*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2426*  COMPANY I.D.                                                  *
  2427*  BENEFIT TYPE                                                  *
  2428*                                                                *
  2429*  RETURNED FROM ELRAMT                                          *
  2430*  --------------------                                          *
  2431*  REMAINING AMOUNT 1 - CURRENT                                  *
  2432*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2433*  REMAINING AMOUNT FACTOR
  2434*----------------------------------------------------------------*
  2435*  PASSED TO ELRESV                                              *
  2436*  -----------------                                             *
  2437*  CERTIFICATE EFFECTIVE DATE                                    *
  2438*  VALUATION DATE                                                *
  2439*  PAID THRU DATE                                                *
  2440*  BENEFIT                                                       *
  2441*  INCURRED DATE                                                 *
  2442*  REPORTED DATE                                                 *
  2443*  ISSUE AGE                                                     *
  2444*  TERM                                                          *
  2445*  CDT PERCENT                                                   *
  2446*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2447* *CLAIM TYPE (LIFE, A/H)                                        *
  2448* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2449* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2450*                                                                *
  2451*  RETURNED FROM ELRESV                                          *
  2452*  --------------------                                          *
  2453*  CDT TABLE USED                                                *
  2454*  CDT FACTOR USED                                               *
  2455*  PAY TO CURRENT RESERVE                                        *
  2456*  I.B.N.R. - A/H ONLY                                           *
  2457*  FUTURE (ACCRUED) AH ONLY                                      *
  2458*----------------------------------------------------------------*
  2459*  PASSED TO ELRATE                                              *
  2460*  ----------------                                              *
  2461*  CERT ISSUE DATE                                               *
  2462*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2463*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  48
* EL131.cbl
  2464*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2465*  STATE CODE (CLIENT DEFINED)                                   *
  2466*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2467*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2468*  DEVIATION CODE                                                *
  2469*  ISSUE AGE                                                     *
  2470*  ORIGINAL BENEFIT AMOUNT                                       *
  2471*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2472*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2473*  BENEFIT KIND (LIFE OR A/H)                                    *
  2474*  A.P.R.                                                        *
  2475*  METHOD
  2476*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2477*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2478*  COMPANY I.D. (3 CHARACTER)                                    *
  2479*  BENEFIT CODE                                                  *
  2480*  BENEFIT OVERRIDE CODE                                         *
  2481*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2482*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2483*  JOINT INDICATOR (CSL ONLY)                                    *
  2484*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2485*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2486*                                                                *
  2487*  RETURNED FROM ELRATE                                          *
  2488*  --------------------                                          *
  2489*  CALCULATED PREMIUM                                            *
  2490*  PREMIUM RATE                                                  *
  2491*  MORTALITY CODE                                                *
  2492*  MAX ATTAINED AGE                                              *
  2493*  MAX AGE                                                       *
  2494*  MAX TERM                                                      *
  2495*  MAX MONTHLY BENEFIT                                           *
  2496*  MAX TOTAL BENIFIT                                             *
  2497*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2498*----------------------------------------------------------------*
  2499*  PASSED TO ELRFND                                              *
  2500*  ----------------                                              *
  2501*  CERT ISSUE DATE                                               *
  2502*  REFUND DATE                                                   *
  2503*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2504*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2505*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2506*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2507*  STATE CODE (CLIENT DEFINED)                                   *
  2508*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2509*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2510*  DEVIATION CODE                                                *
  2511*  ISSUE AGE                                                     *
  2512*  ORIGINAL BENEFIT AMOUNT                                       *
  2513*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2514*  PROCESS TYPE (CANCEL)                                         *
  2515*  BENEFIT KIND (LIFE OR A/H)                                    *
  2516*  A.P.R.                                                        *
  2517*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2518*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2519*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2520*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2521*  COMPANY I.D. (3 CHARACTER)                                    *
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  49
* EL131.cbl
  2522*  BENEFIT CODE                                                  *
  2523*  BENEFIT OVERRIDE CODE                                         *
  2524*                                                                *
  2525*  RETURNED FROM ELRFND                                          *
  2526*  --------------------                                          *
  2527*  CALCULATED REFUND                                             *
  2528*----------------------------------------------------------------*
  2529*  PASSED TO ELEARN                                              *
  2530*  ----------------                                              *
  2531*  CERT ISSUE DATE                                               *
  2532*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2533*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2534*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2535*  STATE CODE (CLIENT DEFINED)                                   *
  2536*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2537*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2538*  DEVIATION CODE                                                *
  2539*  ISSUE AGE                                                     *
  2540*  ORIGINAL BENEFIT AMOUNT                                       *
  2541*  BENEFIT KIND (LIFE OR A/H)                                    *
  2542*  A.P.R.                                                        *
  2543*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2544*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2545*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2546*  COMPANY I.D. (3 CHARACTER)                                    *
  2547*  BENEFIT CODE                                                  *
  2548*  BENEFIT OVERRIDE CODE                                         *
  2549*                                                                *
  2550*  RETURNED FROM ELEARN                                          *
  2551*  --------------------                                          *
  2552*  INDICATED  EARNINGS                                           *
  2553*----------------------------------------------------------------*
  2554*                 LENGTH = 450                                   *
  2555*                                                                *
  2556******************************************************************
  2557******************************************************************
  2558*                   C H A N G E   L O G
  2559*
  2560* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2561*-----------------------------------------------------------------
  2562*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2563* EFFECTIVE    NUMBER
  2564*-----------------------------------------------------------------
  2565* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2566* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2567* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2568* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2569* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2570* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2571* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2572* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2573* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2574******************************************************************
  2575
  2576 01  CALCULATION-PASS-AREA.
  2577     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2578                                     COMP.
  2579
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  50
* EL131.cbl
  2580     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2581       88  NO-CP-ERROR                             VALUE ZERO.
  2582       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2583                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2584       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2585       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2586       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2587       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2588       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2589       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2590       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2591       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2592       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2593       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2594       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2595       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2596       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2597       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2598       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2599       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2600       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2601
  2602     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2603       88  NO-CP-ERROR-2                           VALUE ZERO.
  2604***********************  INPUT AREAS ****************************
  2605
  2606     12  CP-CALCULATION-AREA.
  2607         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2608         16  CP-CERT-EFF-DT        PIC XX.
  2609         16  CP-VALUATION-DT       PIC XX.
  2610         16  CP-PAID-THRU-DT       PIC XX.
  2611         16  CP-BENEFIT-TYPE       PIC X.
  2612           88  CP-AH                               VALUE 'A' 'D'
  2613                                                   'I' 'U'.
  2614           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2615           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2616         16  CP-INCURRED-DT        PIC XX.
  2617         16  CP-REPORTED-DT        PIC XX.
  2618         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2619         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2620         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2621                                     COMP-3.
  2622         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2623                                     COMP-3.
  2624         16  CP-CDT-METHOD         PIC X.
  2625           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2626           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2627           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2628         16  CP-CLAIM-TYPE         PIC X.
  2629           88  CP-AH-CLAIM                         VALUE 'A'.
  2630           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2631         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2632                                     COMP-3.
  2633         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2634                                     COMP-3.
  2635         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2636                                     COMP-3.
  2637         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  51
* EL131.cbl
  2638                                     COMP-3.
  2639         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2640                                     COMP-3.
  2641         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2642                                     COMP-3.
  2643         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2644                                     COMP-3.
  2645         16  CP-REM-TERM-METHOD    PIC X.
  2646           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2647           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2648           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2649           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2650           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2651           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2652           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2653         16  CP-EARNING-METHOD     PIC X.
  2654           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2655           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2656           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2657           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2658           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2659           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2660           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2661           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2662           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2663           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2664           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2665           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2666           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2667           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2668         16  CP-PROCESS-TYPE       PIC X.
  2669           88  CP-CLAIM                            VALUE '1'.
  2670           88  CP-CANCEL                           VALUE '2'.
  2671           88  CP-ISSUE                            VALUE '3'.
  2672         16  CP-SPECIAL-CALC-CD    PIC X.
  2673           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2674           88  CP-1-MTH-INTEREST               VALUE ' '.
  2675           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2676           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2677           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2678           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2679           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2680           88  CP-FARM-PLAN                    VALUE 'F'.
  2681           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2682           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2683           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2684           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2685           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2686           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2687           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2688           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2689           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2690           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2691                                                     'W' 'X'.
  2692           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2693           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2694           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2695           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  52
* EL131.cbl
  2696           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2697           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2698           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2699           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2700           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2701           88  CP-CSL-METH-1                   VALUE '5'.
  2702           88  CP-CSL-METH-2                   VALUE '6'.
  2703           88  CP-CSL-METH-3                   VALUE '7'.
  2704           88  CP-CSL-METH-4                   VALUE '8'.
  2705
  2706         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2707                                     COMP-3.
  2708         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2709         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2710         16  CP-STATE              PIC XX          VALUE SPACE.
  2711         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2712         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2713           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2714               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2715         16  CP-R78-OPTION         PIC X.
  2716           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2717           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2718
  2719         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2720         16  CP-IBNR-RESERVE-SW    PIC X.
  2721         16  CP-CLAIM-STATUS       PIC X.
  2722         16  CP-RATE-FILE          PIC X.
  2723         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2724                                     COMP-3.
  2725
  2726         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2727         16  CP-AH-OVERRIDE-CODE   PIC X.
  2728
  2729         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2730                                     COMP-3.
  2731         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2732                                   PIC S9(5)V99 COMP-3.
  2733         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2734                                     COMP-3.
  2735         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2736                                     COMP-3.
  2737         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2738                                     COMP-3.
  2739         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2740                                  PIC S9(7)V99 COMP-3.
  2741
  2742         16  CP-PAID-FROM-DATE     PIC X(02).
  2743         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2744         16  CP-EXT-DAYS-CALC      PIC X.
  2745           88  CP-EXT-NO-CHG                   VALUE ' '.
  2746           88  CP-EXT-CHG-LF                   VALUE '1'.
  2747           88  CP-EXT-CHG-AH                   VALUE '2'.
  2748           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2749         16  CP-DOMICILE-STATE     PIC XX.
  2750         16  CP-CARRIER            PIC X.
  2751         16  CP-REIN-FLAG          PIC X.
  2752         16  CP-REM-TRM-CALC-OPTION PIC X.
  2753           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  53
* EL131.cbl
  2754                      '2' '3' '4' '5'.
  2755           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2756           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2757           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2758           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2759           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2760           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2761           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2762           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2763         16  CP-SIG-SWITCH         PIC X.
  2764         16  CP-RATING-METHOD      PIC X.
  2765           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2766           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2767           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2768           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2769           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2770           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2771           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2772           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2773           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2774         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2775                                     COMP-3.
  2776         16  CP-BEN-CATEGORY       PIC X.
  2777         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2778         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2779                                   PIC S99V9(5) COMP-3.
  2780         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2781         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2782                                   PIC S99V9(5) COMP-3.
  2783         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2784         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2785         16  CP-EXPIRE-DT          PIC XX.
  2786         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2787         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2788         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2789         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2790         16  CP-DDF-SPEC-CALC      PIC X.
  2791             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2792             88  CP-CALC-CLP              VALUE 'C'.
  2793         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2794         16  CP-CANCEL-REASON      PIC X.
  2795         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2796         16  CP-PMT-MODE           PIC X.
  2797         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2798         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2799         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2800         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2801         16  FILLER                PIC X.
  2802
  2803***************    OUTPUT FROM ELRESV   ************************
  2804
  2805         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2806
  2807         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2808                                     COMP-3.
  2809         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2810                                     COMP-3.
  2811         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  54
* EL131.cbl
  2812                                     COMP-3.
  2813         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2814                                     COMP-3.
  2815         16  FILLER                PIC X(09).
  2816***************    OUTPUT FROM ELRTRM   *************************
  2817
  2818         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2819                                     COMP-3.
  2820         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2821                                     COMP-3.
  2822         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2823                                     COMP-3.
  2824         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2825                                     COMP-3.
  2826         16  FILLER                PIC X(12).
  2827
  2828***************    OUTPUT FROM ELRAMT   *************************
  2829
  2830         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2831                                     COMP-3.
  2832         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2833                                     COMP-3.
  2834         16  FILLER                PIC X(12).
  2835
  2836***************    OUTPUT FROM ELRATE   *************************
  2837
  2838         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2839                                     COMP-3.
  2840         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2841                                     COMP-3.
  2842         16  CP-MORTALITY-CODE     PIC X(4).
  2843         16  CP-RATE-EDIT-FLAG     PIC X.
  2844             88  CP-RATES-NEED-APR                  VALUE '1'.
  2845         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2846                                     COMP-3.
  2847         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2848         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2849         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2850                                   PIC S9(7)V99 COMP-3.
  2851         16  FILLER                PIC X(07).
  2852
  2853***************    OUTPUT FROM ELRFND   *************************
  2854
  2855         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2856                                     COMP-3.
  2857         16  CP-REFUND-TYPE-USED   PIC X.
  2858           88  CP-R-AS-R78                         VALUE '1'.
  2859           88  CP-R-AS-PRORATA                     VALUE '2'.
  2860           88  CP-R-AS-CALIF                       VALUE '3'.
  2861           88  CP-R-AS-TEXAS                       VALUE '4'.
  2862           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2863           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2864           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2865           88  CP-R-AS-MEAN                        VALUE '8'.
  2866           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2867           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2868           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2869           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  55
* EL131.cbl
  2870           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2871           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2872         16  FILLER                PIC X(12).
  2873
  2874***************    OUTPUT FROM ELEARN   *************************
  2875
  2876         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2877                                     COMP-3.
  2878         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2879                                     COMP-3.
  2880         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2881                                     COMP-3.
  2882         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2883                                     COMP-3.
  2884         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2885                                     COMP-3.
  2886         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2887                                     COMP-3.
  2888         16  CP-EARNING-TYPE-USED  PIC X.
  2889           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2890           88  CP-E-AS-R78                         VALUE '1'.
  2891           88  CP-E-AS-PRORATA                     VALUE '2'.
  2892           88  CP-E-AS-TEXAS                       VALUE '4'.
  2893           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2894           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2895           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2896           88  CP-E-AS-MEAN                        VALUE '8'.
  2897           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2898         16  FILLER                PIC X(12).
  2899
  2900***************    OUTPUT FROM ELPMNT   *************************
  2901
  2902         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2903                                     COMP-3.
  2904         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2905                                     COMP-3.
  2906         16  FILLER                PIC X(12).
  2907
  2908***************   MISC WORK AREAS    *****************************
  2909         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2910                                     COMP-3.
  2911         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2912                                     COMP-3.
  2913         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2914                                     COMP-3.
  2915         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2916                                     COMP-3.
  2917         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2918                                     COMP-3.
  2919         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2920                                     COMP-3.
  2921         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2922             88  OPEN-RATE-FILE                   VALUE 'O'.
  2923             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2924             88  IO-ERROR                         VALUE 'E'.
  2925
  2926         16  CP-FIRST-PAY-DATE     PIC XX.
  2927
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  56
* EL131.cbl
  2928         16  CP-JOINT-INDICATOR    PIC X.
  2929
  2930         16  CP-RESERVE-REMAINING-TERM
  2931                                   PIC S9(4)V9    VALUE ZERO
  2932                                     COMP-3.
  2933
  2934         16  CP-INSURED-BIRTH-DT   PIC XX.
  2935
  2936         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2937                                     COMP-3.
  2938
  2939         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2940                                     COMP-3.
  2941
  2942         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2943                                     COMP-3.
  2944
  2945         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2946                                     COMP-3.
  2947
  2948         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2949                                     COMP-3.
  2950
  2951         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2952                                     COMP-3.
  2953
  2954         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2955                                     COMP-3.
  2956
  2957         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2958             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2959
  2960         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2961                                     COMP-3.
  2962         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2963                                     COMP-3.
  2964         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2965         16  FILLER                PIC X(15).
  2966******************************************************************
  2967
  2968*                                COPY ELCDATE.
  2969******************************************************************
  2970*                                                                *
  2971*                                                                *
  2972*                            ELCDATE.                            *
  2973*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2974*                            VMOD=2.003
  2975*                                                                *
  2976*                                                                *
  2977*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2978*                 LENGTH = 200                                   *
  2979******************************************************************
  2980
  2981 01  DATE-CONVERSION-DATA.
  2982     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2983     12  DC-OPTION-CODE                PIC X.
  2984         88  BIN-TO-GREG                VALUE ' '.
  2985         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  57
* EL131.cbl
  2986         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2987         88  YMD-GREG-TO-BIN            VALUE '3'.
  2988         88  MDY-GREG-TO-BIN            VALUE '4'.
  2989         88  JULIAN-TO-BIN              VALUE '5'.
  2990         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2991         88  FIND-CENTURY               VALUE '7'.
  2992         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2993         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2994         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2995         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2996         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2997         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2998         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2999         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3000         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3001         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3002         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3003         88  BIN-3-TO-GREG              VALUE 'I'.
  3004         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3005         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3006         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3007         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3008         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3009         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3010         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3011         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3012         88  THREE-CHARACTER-BIN
  3013                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3014         88  GREGORIAN-TO-BIN
  3015                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3016         88  BIN-TO-GREGORIAN
  3017                  VALUES ' ' '1' 'I' '8' 'G'.
  3018         88  JULIAN-TO-BINARY
  3019                  VALUES '5' 'C' 'E' 'F'.
  3020     12  DC-ERROR-CODE                 PIC X.
  3021         88  NO-CONVERSION-ERROR        VALUE ' '.
  3022         88  DATE-CONVERSION-ERROR
  3023                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3024         88  DATE-IS-ZERO               VALUE '1'.
  3025         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3026         88  DATE-IS-INVALID            VALUE '3'.
  3027         88  DATE1-GREATER-DATE2        VALUE '4'.
  3028         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3029         88  DATE-INVALID-OPTION        VALUE '9'.
  3030         88  INVALID-CENTURY            VALUE 'A'.
  3031         88  ONLY-CENTURY               VALUE 'B'.
  3032         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3033         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3034     12  DC-END-OF-MONTH               PIC X.
  3035         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3036     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3037         88  USE-NORMAL-PROCESS         VALUE ' '.
  3038         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3039         88  ADJUST-UP-100-YRS          VALUE '2'.
  3040     12  FILLER                        PIC X.
  3041     12  DC-CONVERSION-DATES.
  3042         16  DC-BIN-DATE-1             PIC XX.
  3043         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  58
* EL131.cbl
  3044         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3045         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3046                       DC-GREG-DATE-1-EDIT.
  3047             20  DC-EDIT1-MONTH        PIC 99.
  3048             20  SLASH1-1              PIC X.
  3049             20  DC-EDIT1-DAY          PIC 99.
  3050             20  SLASH1-2              PIC X.
  3051             20  DC-EDIT1-YEAR         PIC 99.
  3052         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3053         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3054                     DC-GREG-DATE-2-EDIT.
  3055             20  DC-EDIT2-MONTH        PIC 99.
  3056             20  SLASH2-1              PIC X.
  3057             20  DC-EDIT2-DAY          PIC 99.
  3058             20  SLASH2-2              PIC X.
  3059             20  DC-EDIT2-YEAR         PIC 99.
  3060         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3061         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3062                     DC-GREG-DATE-1-YMD.
  3063             20  DC-YMD-YEAR           PIC 99.
  3064             20  DC-YMD-MONTH          PIC 99.
  3065             20  DC-YMD-DAY            PIC 99.
  3066         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3067         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3068                      DC-GREG-DATE-1-MDY.
  3069             20  DC-MDY-MONTH          PIC 99.
  3070             20  DC-MDY-DAY            PIC 99.
  3071             20  DC-MDY-YEAR           PIC 99.
  3072         16  DC-GREG-DATE-1-ALPHA.
  3073             20  DC-ALPHA-MONTH        PIC X(10).
  3074             20  DC-ALPHA-DAY          PIC 99.
  3075             20  FILLER                PIC XX.
  3076             20  DC-ALPHA-CENTURY.
  3077                 24 DC-ALPHA-CEN-N     PIC 99.
  3078             20  DC-ALPHA-YEAR         PIC 99.
  3079         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3080         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3081         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3082         16  DC-JULIAN-DATE            PIC 9(05).
  3083         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3084                                       PIC 9(05).
  3085         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3086             20  DC-JULIAN-YEAR        PIC 99.
  3087             20  DC-JULIAN-DAYS        PIC 999.
  3088         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3089         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3090         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3091     12  DATE-CONVERSION-VARIBLES.
  3092         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3093         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3094             20  FILLER                PIC 9(3).
  3095             20  HOLD-CEN-1-CCYY.
  3096                 24  HOLD-CEN-1-CC     PIC 99.
  3097                 24  HOLD-CEN-1-YY     PIC 99.
  3098             20  HOLD-CEN-1-MO         PIC 99.
  3099             20  HOLD-CEN-1-DA         PIC 99.
  3100         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3101             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  59
* EL131.cbl
  3102             20  HOLD-CEN-1-R-DA       PIC 99.
  3103             20  HOLD-CEN-1-R-CCYY.
  3104                 24  HOLD-CEN-1-R-CC   PIC 99.
  3105                 24  HOLD-CEN-1-R-YY   PIC 99.
  3106             20  FILLER                PIC 9(3).
  3107         16  HOLD-CENTURY-1-X.
  3108             20  FILLER                PIC X(3)  VALUE SPACES.
  3109             20  HOLD-CEN-1-X-CCYY.
  3110                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3111                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3112             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3113             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3114         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3115             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3116             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3117             20  HOLD-CEN-1-R-X-CCYY.
  3118                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3119                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3120             20  FILLER                PIC XXX.
  3121         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3122         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3123         16  DC-JULIAN-DATE-1          PIC 9(07).
  3124         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3125             20  DC-JULIAN-1-CCYY.
  3126                 24  DC-JULIAN-1-CC    PIC 99.
  3127                 24  DC-JULIAN-1-YR    PIC 99.
  3128             20  DC-JULIAN-DA-1        PIC 999.
  3129         16  DC-JULIAN-DATE-2          PIC 9(07).
  3130         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3131             20  DC-JULIAN-2-CCYY.
  3132                 24  DC-JULIAN-2-CC    PIC 99.
  3133                 24  DC-JULIAN-2-YR    PIC 99.
  3134             20  DC-JULIAN-DA-2        PIC 999.
  3135         16  DC-GREG-DATE-A-EDIT.
  3136             20  DC-EDITA-MONTH        PIC 99.
  3137             20  SLASHA-1              PIC X VALUE '/'.
  3138             20  DC-EDITA-DAY          PIC 99.
  3139             20  SLASHA-2              PIC X VALUE '/'.
  3140             20  DC-EDITA-CCYY.
  3141                 24  DC-EDITA-CENT     PIC 99.
  3142                 24  DC-EDITA-YEAR     PIC 99.
  3143         16  DC-GREG-DATE-B-EDIT.
  3144             20  DC-EDITB-MONTH        PIC 99.
  3145             20  SLASHB-1              PIC X VALUE '/'.
  3146             20  DC-EDITB-DAY          PIC 99.
  3147             20  SLASHB-2              PIC X VALUE '/'.
  3148             20  DC-EDITB-CCYY.
  3149                 24  DC-EDITB-CENT     PIC 99.
  3150                 24  DC-EDITB-YEAR     PIC 99.
  3151         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3152         16  DC-GREG-DATE-CYMD-R REDEFINES
  3153                              DC-GREG-DATE-CYMD.
  3154             20  DC-CYMD-CEN           PIC 99.
  3155             20  DC-CYMD-YEAR          PIC 99.
  3156             20  DC-CYMD-MONTH         PIC 99.
  3157             20  DC-CYMD-DAY           PIC 99.
  3158         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3159         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  60
* EL131.cbl
  3160                              DC-GREG-DATE-MDCY.
  3161             20  DC-MDCY-MONTH         PIC 99.
  3162             20  DC-MDCY-DAY           PIC 99.
  3163             20  DC-MDCY-CEN           PIC 99.
  3164             20  DC-MDCY-YEAR          PIC 99.
  3165    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3166        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3167    12  DC-EL310-DATE                  PIC X(21).
  3168    12  FILLER                         PIC X(28).
  3169
  3170*                                COPY ELCDMO.
  3171******************************************************************
  3172*                                                                *
  3173*                                                                *
  3174*                            ELCDMO.                             *
  3175*                            VMOD=2.004                          *
  3176*                                                                *
  3177*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3178*        COMMUNICATION AREA                                      *
  3179*   FILE TYPE = NA                                               *
  3180*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3181*                                                                *
  3182******************************************************************
  3183 01  DMO-COMMUNICATION-AREA.
  3184     12  DM-RECORD-TYPE                  PIC  X(02).
  3185             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3186             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3187             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3188     12  DM-DIST-CODE                    PIC  X(04).
  3189     12  DM-MAIL-CODE                    PIC  X(05).
  3190     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3191     12  DM-INSURED-NAME                 PIC  X(30).
  3192     12  DM-CLAIM-NO                     PIC  X(07).
  3193     12  DM-CLAIM-TYPE                   PIC  X.
  3194
  3195     12  DM-STATUS-DATA-AREA.
  3196         16  DM-CLAIM-STATUS             PIC  X.
  3197             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3198             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3199             88  DM-CLOSED                        VALUE '3'.
  3200             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3201             88  DM-DEFAULT                       VALUE '9'.
  3202         16  DM-STATUS-DATE              PIC  X(08).
  3203******YYYYMMDD
  3204         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3205             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3206             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3207             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3208             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3209             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3210             88  DM-RE-OPENED                     VALUE 'R'.
  3211             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3212             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3213             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3214         16  DM-STAT-CARRIER             PIC X.
  3215
  3216     12  DM-DRAFT-DATA-AREA.
  3217         16  DM-PAYMENT-TYPE             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  61
* EL131.cbl
  3218             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3219         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3220         16  DM-PAYMENT-DATE             PIC  X(08).
  3221******YYYYMMDD
  3222         16  DM-CERT-NO                  PIC  X(11).
  3223         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3224         16  DM-CARRIER                  PIC  X.
  3225
  3226     12  DM-RETURN-CODE                  PIC  XX.
  3227*                                COPY ERCPDEF.
  3228******************************************************************
  3229*                                                                *
  3230*                                                                *
  3231*                            ERCPDEF.                            *
  3232*                                                                *
  3233*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3234*                                                                *
  3235*    FILE TYPE = VSAM,KSDS                                       *
  3236*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3237*                                                                *
  3238*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3239*                                                                *
  3240*    LOG = YES                                                   *
  3241*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3242******************************************************************
  3243 01  PRODUCT-MASTER.
  3244    12  PD-RECORD-ID                 PIC X(02).
  3245        88  VALID-PD-ID                  VALUE 'PD'.
  3246    12  PD-CONTROL-PRIMARY.
  3247        16  PD-COMPANY-CD            PIC X.
  3248        16  PD-STATE                 PIC XX.
  3249        16  PD-PRODUCT-CD            PIC XXX.
  3250        16  PD-FILLER                PIC X(7).
  3251        16  PD-BEN-TYPE              PIC X.
  3252        16  PD-BEN-CODE              PIC XX.
  3253        16  PD-PROD-EXP-DT           PIC XX.
  3254    12  FILLER                       PIC X(50).
  3255    12  PD-PRODUCT-DATA OCCURS 8.
  3256        16  PD-PROD-CODE             PIC X.
  3257            88  PD-PROD-LIFE           VALUE 'L'.
  3258            88  PD-PROD-PROP           VALUE 'P'.
  3259            88  PD-PROD-AH             VALUE 'A'.
  3260            88  PD-PROD-IU             VALUE 'I'.
  3261            88  PD-PROD-GAP            VALUE 'G'.
  3262        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3263        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3264        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3265        16  PD-MAX-TERM              PIC S999        COMP-3.
  3266        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3267        16  FILLER                   PIC X.
  3268        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3269        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3270        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3271        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3272        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3273        16  PD-REC-CRIT-PERIOD       PIC X.
  3274        16  PD-RTW-MOS               PIC 99.
  3275        16  FILLER                   PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  62
* EL131.cbl
  3276    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3277    12  PD-TERM-LIMITS OCCURS 15.
  3278        16  PD-LOW-TERM              PIC S999        COMP-3.
  3279        16  PD-HI-TERM               PIC S999        COMP-3.
  3280*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3281    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3282        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3283        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3284    12  PD-EARN-FACTORS.
  3285        16  FILLER OCCURS 15.
  3286            20  FILLER OCCURS 15.
  3287                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3288    12  PD-PRODUCT-DESC              PIC X(80).
  3289    12  PD-TRUNCATED                 PIC X.
  3290    12  FILLER                       PIC X(59).
  3291    12  PD-MAINT-INFORMATION.
  3292        16  PD-LAST-MAINT-DT         PIC X(02).
  3293        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3294        16  PD-LAST-MAINT-BY         PIC X(04).
  3295*                                COPY ELCCRTT.
  3296******************************************************************
  3297*                                                                *
  3298*                            ELCCRTT.                            *
  3299*                                                                *
  3300*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3301*                                                                *
  3302*   FILE TYPE = VSAM,KSDS                                        *
  3303*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3304*                                                                *
  3305*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3306*                                                                *
  3307*   LOG = YES                                                    *
  3308*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3309******************************************************************
  3310*                   C H A N G E   L O G
  3311*
  3312* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3313*-----------------------------------------------------------------
  3314*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3315* EFFECTIVE    NUMBER
  3316*-----------------------------------------------------------------
  3317* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3318* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3319* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3320* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3321* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3322******************************************************************
  3323
  3324 01  CERTIFICATE-TRAILERS.
  3325     12  CS-RECORD-ID                      PIC XX.
  3326         88  VALID-CS-ID                      VALUE 'CS'.
  3327
  3328     12  CS-CONTROL-PRIMARY.
  3329         16  CS-COMPANY-CD                 PIC X.
  3330         16  CS-CARRIER                    PIC X.
  3331         16  CS-GROUPING                   PIC X(6).
  3332         16  CS-STATE                      PIC XX.
  3333         16  CS-ACCOUNT                    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  63
* EL131.cbl
  3334         16  CS-CERT-EFF-DT                PIC XX.
  3335         16  CS-CERT-NO.
  3336             20  CS-CERT-PRIME             PIC X(10).
  3337             20  CS-CERT-SFX               PIC X.
  3338         16  CS-TRAILER-TYPE               PIC X.
  3339             88  COMM-TRLR           VALUE 'A'.
  3340             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3341             88  CERT-DATA-TRLR      VALUE 'C'.
  3342
  3343     12  CS-DATA-AREA                      PIC X(516).
  3344
  3345     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3346         16  CS-BANK-COMMISSION-AREA.
  3347             20  CS-BANK-COMMS       OCCURS 10.
  3348                 24  CS-AGT                PIC X(10).
  3349                 24  CS-COM-TYP            PIC X.
  3350                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3351                 24  CS-RECALC-LV-INDIC    PIC X.
  3352                 24  FILLER                PIC X(10).
  3353         16  FILLER                        PIC X(256).
  3354
  3355     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3356****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3357****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  3358         16  CS-MB-CLAIM-DATA OCCURS 2.
  3359             20  FILLER OCCURS 10.
  3360                 24  CS-CLAIM-TYPE         PIC X.
  3361                     88  CS-AH-CLM           VALUE 'A'.
  3362                     88  CS-IU-CLM           VALUE 'I'.
  3363                     88  CS-GP-CLM           VALUE 'G'.
  3364                     88  CS-LF-CLM           VALUE 'L'.
  3365                     88  CS-PR-CLM           VALUE 'P'.
  3366                 24  CS-BANK               PIC S999 COMP-3.
  3367                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  3368                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  3369                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  3370         16  FILLER                        PIC X(216).
  3371     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3372         16  CS-VIN-NUMBER                 PIC X(17).
  3373         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3374         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3375         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3376         16  FILLER                        PIC X(496).
  3377******************************************************************
  3378
  3379****************************************************************
  3380*
  3381* Copyright (c) 2007 by Clerity Solutions, Inc.
  3382* All rights reserved.
  3383*
  3384****************************************************************
  3385 01  DFHEIV.
  3386   02  DFHEIV0               PIC X(35).
  3387   02  DFHEIV1               PIC X(08).
  3388   02  DFHEIV2               PIC X(08).
  3389   02  DFHEIV3               PIC X(08).
  3390   02  DFHEIV4               PIC X(06).
  3391   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  64
* EL131.cbl
  3392   02  DFHEIV6               PIC X(04).
  3393   02  DFHEIV7               PIC X(02).
  3394   02  DFHEIV8               PIC X(02).
  3395   02  DFHEIV9               PIC X(01).
  3396   02  DFHEIV10              PIC S9(7) COMP-3.
  3397   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3398   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3399   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3400   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3401   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3402   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3403   02  DFHEIV17              PIC X(04).
  3404   02  DFHEIV18              PIC X(04).
  3405   02  DFHEIV19              PIC X(04).
  3406   02  DFHEIV20              USAGE IS POINTER.
  3407   02  DFHEIV21              USAGE IS POINTER.
  3408   02  DFHEIV22              USAGE IS POINTER.
  3409   02  DFHEIV23              USAGE IS POINTER.
  3410   02  DFHEIV24              USAGE IS POINTER.
  3411   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3412   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3413   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3414   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3415   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3416   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3417   02  FILLER                PIC X(02).
  3418   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3419   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3420   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3421   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3422   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3423 LINKAGE  SECTION.
  3424*****************************************************************
  3425*                                                               *
  3426* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3427* All rights reserved.                                          *
  3428*                                                               *
  3429*****************************************************************
  3430 01  dfheiblk.
  3431     02  eibtime          pic s9(7) comp-3.
  3432     02  eibdate          pic s9(7) comp-3.
  3433     02  eibtrnid         pic x(4).
  3434     02  eibtaskn         pic s9(7) comp-3.
  3435     02  eibtrmid         pic x(4).
  3436     02  dfheigdi         pic s9(4) comp.
  3437     02  eibcposn         pic s9(4) comp.
  3438     02  eibcalen         pic s9(4) comp.
  3439     02  eibaid           pic x(1).
  3440     02  eibfiller1       pic x(1).
  3441     02  eibfn            pic x(2).
  3442     02  eibfiller2       pic x(2).
  3443     02  eibrcode         pic x(6).
  3444     02  eibfiller3       pic x(2).
  3445     02  eibds            pic x(8).
  3446     02  eibreqid         pic x(8).
  3447     02  eibrsrce         pic x(8).
  3448     02  eibsync          pic x(1).
  3449     02  eibfree          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  65
* EL131.cbl
  3450     02  eibrecv          pic x(1).
  3451     02  eibsend          pic x(1).
  3452     02  eibatt           pic x(1).
  3453     02  eibeoc           pic x(1).
  3454     02  eibfmh           pic x(1).
  3455     02  eibcompl         pic x(1).
  3456     02  eibsig           pic x(1).
  3457     02  eibconf          pic x(1).
  3458     02  eiberr           pic x(1).
  3459     02  eibrldbk         pic x(1).
  3460     02  eiberrcd         pic x(4).
  3461     02  eibsynrb         pic x(1).
  3462     02  eibnodat         pic x(1).
  3463     02  eibfiller5       pic x(2).
  3464     02  eibresp          pic 9(09) comp.
  3465     02  eibresp2         pic 9(09) comp.
  3466     02  dfheigdj         pic s9(4) comp.
  3467     02  dfheigdk         pic s9(4) comp.
  3468 01  DFHCOMMAREA                 PIC X(1024).
  3469
  3470*                                COPY ELCMSTR.
  3471******************************************************************
  3472*                                                                *
  3473*                            ELCMSTR.                            *
  3474*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3475*                            VMOD=2.012                          *
  3476*                                                                *
  3477*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3478*                                                                *
  3479*   FILE TYPE = VSAM,KSDS                                        *
  3480*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3481*                                                                *
  3482*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3483*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3484*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3485*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3486*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3487*                                                 RKP=75,LEN=21  *
  3488*                                                                *
  3489*   **** NOTE ****                                               *
  3490*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3491*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3492*                                                                *
  3493*   LOG = YES                                                    *
  3494*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3495******************************************************************
  3496*                   C H A N G E   L O G
  3497*
  3498* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3499*-----------------------------------------------------------------
  3500*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3501* EFFECTIVE    NUMBER
  3502*-----------------------------------------------------------------
  3503* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3504* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3505* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3506******************************************************************
  3507 01  CLAIM-MASTER.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  66
* EL131.cbl
  3508     12  CL-RECORD-ID                PIC XX.
  3509         88  VALID-CL-ID         VALUE 'CL'.
  3510
  3511     12  CL-CONTROL-PRIMARY.
  3512         16  CL-COMPANY-CD           PIC X.
  3513         16  CL-CARRIER              PIC X.
  3514         16  CL-CLAIM-NO             PIC X(7).
  3515         16  CL-CERT-NO.
  3516             20  CL-CERT-PRIME       PIC X(10).
  3517             20  CL-CERT-SFX         PIC X.
  3518
  3519     12  CL-CONTROL-BY-NAME.
  3520         16  CL-COMPANY-CD-A1        PIC X.
  3521         16  CL-INSURED-LAST-NAME    PIC X(15).
  3522         16  CL-INSURED-NAME.
  3523             20  CL-INSURED-1ST-NAME PIC X(12).
  3524             20  CL-INSURED-MID-INIT PIC X.
  3525
  3526     12  CL-CONTROL-BY-SSN.
  3527         16  CL-COMPANY-CD-A2        PIC X.
  3528         16  CL-SOC-SEC-NO.
  3529             20  CL-SSN-STATE        PIC XX.
  3530             20  CL-SSN-ACCOUNT      PIC X(6).
  3531             20  CL-SSN-LN3          PIC X(3).
  3532
  3533     12  CL-CONTROL-BY-CERT-NO.
  3534         16  CL-COMPANY-CD-A4        PIC X.
  3535         16  CL-CERT-NO-A4.
  3536             20  CL-CERT-A4-PRIME    PIC X(10).
  3537             20  CL-CERT-A4-SFX      PIC X.
  3538
  3539     12  CL-CONTROL-BY-CCN.
  3540         16  CL-COMPANY-CD-A5        PIC X.
  3541         16  CL-CCN-A5.
  3542             20  CL-CCN.
  3543                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3544                 24  CL-CCN-PRIME-A5 PIC X(12).
  3545             20  CL-CCN-FILLER-A5    PIC X(4).
  3546
  3547     12  CL-INSURED-PROFILE-DATA.
  3548         16  CL-INSURED-BIRTH-DT     PIC XX.
  3549         16  CL-INSURED-SEX-CD       PIC X.
  3550             88  INSURED-IS-MALE        VALUE 'M'.
  3551             88  INSURED-IS-FEMALE      VALUE 'F'.
  3552             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3553         16  CL-INSURED-OCC-CD       PIC X(6).
  3554         16  FILLER                  PIC X(5).
  3555
  3556     12  CL-PROCESSING-INFO.
  3557         16  CL-PROCESSOR-ID         PIC X(4).
  3558         16  CL-CLAIM-STATUS         PIC X.
  3559             88  CLAIM-IS-OPEN          VALUE 'O'.
  3560             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3561         16  CL-CLAIM-TYPE           PIC X.
  3562*            88  AH-CLAIM               VALUE 'A'.
  3563*            88  LIFE-CLAIM             VALUE 'L'.
  3564*            88  PROPERTY-CLAIM         VALUE 'P'.
  3565*            88  IUI-CLAIM              VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  67
* EL131.cbl
  3566*            88  GAP-CLAIM              VALUE 'G'.
  3567         16  CL-CLAIM-PREM-TYPE      PIC X.
  3568             88  SINGLE-PREMIUM         VALUE '1'.
  3569             88  O-B-COVERAGE           VALUE '2'.
  3570             88  OPEN-END-COVERAGE      VALUE '3'.
  3571         16  CL-INCURRED-DT          PIC XX.
  3572         16  CL-REPORTED-DT          PIC XX.
  3573         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3574         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3575         16  CL-LAST-PMT-DT          PIC XX.
  3576         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3577         16  CL-PAID-THRU-DT         PIC XX.
  3578         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3579         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3580         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3581         16  CL-PMT-CALC-METHOD      PIC X.
  3582             88  CL-360-DAY-YR          VALUE '1'.
  3583             88  CL-365-DAY-YR          VALUE '2'.
  3584             88  CL-FULL-MONTHS         VALUE '3'.
  3585         16  CL-CAUSE-CD             PIC X(6).
  3586
  3587         16  CL-PRIME-CERT-NO.
  3588             20  CL-PRIME-CERT-PRIME PIC X(10).
  3589             20  CL-PRIME-CERT-SFX   PIC X.
  3590
  3591         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3592             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3593             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3594
  3595         16  CL-MICROFILM-NO         PIC X(10).
  3596         16  CL-PROG-FORM-TYPE       PIC X.
  3597         16  CL-LAST-ADD-ON-DT       PIC XX.
  3598
  3599         16  CL-LAST-REOPEN-DT       PIC XX.
  3600         16  CL-LAST-CLOSE-DT        PIC XX.
  3601         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3602             88  FINAL-PAID             VALUE '1'.
  3603             88  CLAIM-DENIED           VALUE '2'.
  3604             88  AUTO-CLOSE             VALUE '3'.
  3605             88  MANUAL-CLOSE           VALUE '4'.
  3606             88  BENEFITS-CHANGED       VALUE 'C'.
  3607             88  SETUP-ERRORS           VALUE 'E'.
  3608         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3609         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3610         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3611             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3612         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3613         16  FILLER                  PIC X.
  3614
  3615     12  CL-CERTIFICATE-DATA.
  3616         16  CL-CERT-ORIGIN          PIC X.
  3617             88  CERT-WAS-ONLINE        VALUE '1'.
  3618             88  CERT-WAS-CREATED       VALUE '2'.
  3619             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3620         16  CL-CERT-KEY-DATA.
  3621             20  CL-CERT-CARRIER     PIC X.
  3622             20  CL-CERT-GROUPING    PIC X(6).
  3623             20  CL-CERT-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  68
* EL131.cbl
  3624             20  CL-CERT-ACCOUNT.
  3625                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3626                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3627             20  CL-CERT-EFF-DT      PIC XX.
  3628
  3629     12  CL-STATUS-CONTROLS.
  3630         16  CL-PRIORITY-CD          PIC X.
  3631             88  CONFIDENTIAL-DATA      VALUE '8'.
  3632             88  HIGHEST-PRIORITY       VALUE '9'.
  3633         16  CL-SUPV-ATTN-CD         PIC X.
  3634             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3635             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3636         16  CL-PURGED-DT            PIC XX.
  3637         16  CL-RESTORED-DT          PIC XX.
  3638         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3639         16  CL-NEXT-RESEND-DT       PIC XX.
  3640         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3641         16  CL-CRITICAL-PERIOD      PIC 99.
  3642*        16  FILLER                  PIC XX.
  3643         16  CL-LAST-MAINT-DT        PIC XX.
  3644         16  CL-LAST-MAINT-USER      PIC X(4).
  3645         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3646         16  CL-LAST-MAINT-TYPE      PIC X.
  3647             88  CLAIM-SET-UP           VALUE ' '.
  3648             88  PAYMENT-MADE           VALUE '1'.
  3649             88  LETTER-SENT            VALUE '2'.
  3650             88  MASTER-WAS-ALTERED     VALUE '3'.
  3651             88  MASTER-WAS-RESTORED    VALUE '4'.
  3652             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3653             88  FILE-CONVERTED         VALUE '6'.
  3654             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3655             88  ERROR-CORRECTION       VALUE 'E'.
  3656         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3657         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3658         16  CL-BENEFICIARY          PIC X(10).
  3659         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3660         16  CL-DENIAL-TYPE          PIC X.
  3661             88  CL-TYPE-DENIAL          VALUE '1'.
  3662             88  CL-TYPE-RESCISSION      VALUE '2'.
  3663             88  CL-TYPE-REFORMATION     VALUE '3'.
  3664             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3665             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3666         16  CL-CRIT-PER-RECURRENT   PIC X.
  3667         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3668         16  CL-RTW-DT               PIC XX.
  3669
  3670     12  CL-TRAILER-CONTROLS.
  3671         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3672             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3673             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3674             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3675         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3676         16  FILLER                  PIC XX.
  3677         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3678         16  CL-ADDRESS-TRAILER-CNT.
  3679             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3680                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3681             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  69
* EL131.cbl
  3682                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3683             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3684                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3685             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3686                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3687             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3688                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3689             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3690                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3691             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3692                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3693
  3694     12  CL-CV-REFERENCE-NO.
  3695         16  CL-CV-REFNO-PRIME       PIC X(18).
  3696         16  CL-CV-REFNO-SFX         PIC XX.
  3697
  3698     12  CL-FILE-LOCATION            PIC X(4).
  3699
  3700     12  CL-PROCESS-ERRORS.
  3701         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3702             88  NO-FATAL-ERRORS        VALUE ZERO.
  3703         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3704             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3705
  3706     12  CL-PRODUCT-CD               PIC X.
  3707
  3708     12  CL-CURRENT-KEY-DATA.
  3709         16  CL-CURRENT-CARRIER      PIC X.
  3710         16  CL-CURRENT-GROUPING     PIC X(6).
  3711         16  CL-CURRENT-STATE        PIC XX.
  3712         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3713
  3714     12  CL-ASSOCIATES               PIC X.
  3715         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3716         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3717         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3718         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3719
  3720     12  CL-ACTIVITY-CODE            PIC 99.
  3721     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3722     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3723
  3724     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3725     12  CL-LAG-REPORT-CODE          PIC 9.
  3726     12  CL-LOAN-TYPE                PIC XX.
  3727     12  CL-LEGAL-STATE              PIC XX.
  3728
  3729     12  CL-YESNOSW                  PIC X.
  3730     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3731         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3732         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3733         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3734     12  cl-insured-claim            pic x.
  3735         88  cl-claim-on-primary         value 'P'.
  3736         88  cl-claim-on-secondary       value 'S'.
  3737     12  cl-benefit-expiration-dt    PIC XX.
  3738
  3739*                                COPY ELCCERT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  70
* EL131.cbl
  3740******************************************************************
  3741*                                                                *
  3742*                            ELCCERT.                            *
  3743*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3744*                            VMOD=2.013                          *
  3745*                                                                *
  3746*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3747*                                                                *
  3748*   FILE TYPE = VSAM,KSDS                                        *
  3749*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3750*                                                                *
  3751*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3752*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3753*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3754*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3755*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3756*                                                                *
  3757*   LOG = YES                                                    *
  3758*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3759******************************************************************
  3760*                   C H A N G E   L O G
  3761*
  3762* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3763*-----------------------------------------------------------------
  3764*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3765* EFFECTIVE    NUMBER
  3766*-----------------------------------------------------------------
  3767* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3768* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3769* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3770* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3771* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3772* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3773* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3774* 032612  CR2011110200001  PEMA  AHL CHANGES
  3775******************************************************************
  3776
  3777 01  CERTIFICATE-MASTER.
  3778     12  CM-RECORD-ID                      PIC XX.
  3779         88  VALID-CM-ID                      VALUE 'CM'.
  3780
  3781     12  CM-CONTROL-PRIMARY.
  3782         16  CM-COMPANY-CD                 PIC X.
  3783         16  CM-CARRIER                    PIC X.
  3784         16  CM-GROUPING.
  3785             20  CM-GROUPING-PREFIX        PIC X(3).
  3786             20  CM-GROUPING-PRIME         PIC X(3).
  3787         16  CM-STATE                      PIC XX.
  3788         16  CM-ACCOUNT.
  3789             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3790             20  CM-ACCOUNT-PRIME          PIC X(6).
  3791         16  CM-CERT-EFF-DT                PIC XX.
  3792         16  CM-CERT-NO.
  3793             20  CM-CERT-PRIME             PIC X(10).
  3794             20  CM-CERT-SFX               PIC X.
  3795
  3796     12  CM-CONTROL-BY-NAME.
  3797         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  71
* EL131.cbl
  3798         16  CM-INSURED-LAST-NAME          PIC X(15).
  3799         16  CM-INSURED-INITIALS.
  3800             20  CM-INSURED-INITIAL1       PIC X.
  3801             20  CM-INSURED-INITIAL2       PIC X.
  3802
  3803     12  CM-CONTROL-BY-SSN.
  3804         16  CM-COMPANY-CD-A2              PIC X.
  3805         16  CM-SOC-SEC-NO.
  3806             20  CM-SSN-STATE              PIC XX.
  3807             20  CM-SSN-ACCOUNT            PIC X(6).
  3808             20  CM-SSN-LN3.
  3809                 25  CM-INSURED-INITIALS-A2.
  3810                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3811                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3812                 25 CM-PART-LAST-NAME-A2         PIC X.
  3813
  3814     12  CM-CONTROL-BY-CERT-NO.
  3815         16  CM-COMPANY-CD-A4              PIC X.
  3816         16  CM-CERT-NO-A4                 PIC X(11).
  3817
  3818     12  CM-CONTROL-BY-MEMB.
  3819         16  CM-COMPANY-CD-A5              PIC X.
  3820         16  CM-MEMBER-NO.
  3821             20  CM-MEMB-STATE             PIC XX.
  3822             20  CM-MEMB-ACCOUNT           PIC X(6).
  3823             20  CM-MEMB-LN4.
  3824                 25  CM-INSURED-INITIALS-A5.
  3825                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3826                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3827                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3828
  3829     12  CM-INSURED-PROFILE-DATA.
  3830         16  CM-INSURED-FIRST-NAME.
  3831             20  CM-INSURED-1ST-INIT       PIC X.
  3832             20  FILLER                    PIC X(9).
  3833         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3834         16  CM-INSURED-SEX                PIC X.
  3835             88  CM-SEX-MALE                  VALUE 'M'.
  3836             88  CM-SEX-FEMAL                 VALUE 'F'.
  3837         16  CM-INSURED-JOINT-AGE          PIC 99.
  3838         16  CM-JOINT-INSURED-NAME.
  3839             20  CM-JT-LAST-NAME           PIC X(15).
  3840             20  CM-JT-FIRST-NAME.
  3841                 24  CM-JT-1ST-INIT        PIC X.
  3842                 24  FILLER                PIC X(9).
  3843             20  CM-JT-INITIAL             PIC X.
  3844
  3845     12  CM-LIFE-DATA.
  3846         16  CM-LF-BENEFIT-CD              PIC XX.
  3847         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3848         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3849         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3850         16  CM-LF-DEV-CODE                PIC XXX.
  3851         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3852         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3853         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3854         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3855         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  72
* EL131.cbl
  3856         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3857         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3858         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3859         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3860         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3861         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3862         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3863         16  FILLER                        PIC XX.
  3864
  3865     12  CM-AH-DATA.
  3866         16  CM-AH-BENEFIT-CD              PIC XX.
  3867         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3868         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3869         16  CM-AH-DEV-CODE                PIC XXX.
  3870         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3871         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3872         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3873         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3874         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3875         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3876         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3877         16  CM-AH-PAID-THRU-DT            PIC XX.
  3878             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3879         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3880         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3881         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3882         16  FILLER                        PIC X.
  3883
  3884     12  CM-LOAN-INFORMATION.
  3885         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3886         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3887                                           PIC S9(5)V99  COMP-3.
  3888         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3889         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3890         16  CM-PAY-FREQUENCY              PIC S99.
  3891         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3892         16  CM-RATE-CLASS                 PIC XX.
  3893         16  CM-BENEFICIARY                PIC X(25).
  3894         16  CM-POLICY-FORM-NO             PIC X(12).
  3895         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3896         16  CM-LAST-ADD-ON-DT             PIC XX.
  3897         16  CM-DEDUCTIBLE-AMOUNTS.
  3898             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3899             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3900         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3901             20  CM-RESIDENT-STATE         PIC XX.
  3902             20  CM-RATE-CODE              PIC X(4).
  3903             20  FILLER                    PIC XX.
  3904         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3905             20  CM-LOAN-OFFICER           PIC X(5).
  3906             20  FILLER                    PIC XXX.
  3907         16  CM-CSR-CODE                   PIC XXX.
  3908         16  CM-UNDERWRITING-CODE          PIC X.
  3909             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3910         16  CM-POST-CARD-IND              PIC X.
  3911         16  CM-NH-INTERFACE-SW            PIC X.
  3912         16  CM-PREMIUM-TYPE               PIC X.
  3913             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  73
* EL131.cbl
  3914             88  CM-O-B-COVERAGE              VALUE '2'.
  3915             88  CM-OPEN-END                  VALUE '3'.
  3916         16  CM-IND-GRP-TYPE               PIC X.
  3917             88  CM-INDIVIDUAL                VALUE 'I'.
  3918             88  CM-GROUP                     VALUE 'G'.
  3919         16  CM-SKIP-CODE                  PIC X.
  3920             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3921             88  SKIP-JULY                    VALUE '1'.
  3922             88  SKIP-AUGUST                  VALUE '2'.
  3923             88  SKIP-SEPTEMBER               VALUE '3'.
  3924             88  SKIP-JULY-AUG                VALUE '4'.
  3925             88  SKIP-AUG-SEPT                VALUE '5'.
  3926             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3927             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3928             88  SKIP-JUNE                    VALUE '8'.
  3929             88  SKIP-JUNE-JULY               VALUE '9'.
  3930             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3931             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3932         16  CM-PAYMENT-MODE               PIC X.
  3933             88  PAY-MONTHLY                  VALUE SPACE.
  3934             88  PAY-WEEKLY                   VALUE '1'.
  3935             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3936             88  PAY-BI-WEEKLY                VALUE '3'.
  3937             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3938         16  CM-LOAN-NUMBER                PIC X(8).
  3939         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3940         16  CM-OLD-LOF                    PIC XXX.
  3941*        16  CM-LOAN-OFFICER               PIC XXX.
  3942         16  CM-REIN-TABLE                 PIC XXX.
  3943         16  CM-SPECIAL-REIN-CODE          PIC X.
  3944         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3945         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3946         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3947
  3948     12  CM-STATUS-DATA.
  3949         16  CM-ENTRY-STATUS               PIC X.
  3950         16  CM-ENTRY-DT                   PIC XX.
  3951
  3952         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3953         16  CM-LF-CANCEL-DT               PIC XX.
  3954         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3955
  3956         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3957         16  CM-LF-DEATH-DT                PIC XX.
  3958         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3959
  3960         16  CM-LF-CURRENT-STATUS          PIC X.
  3961             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3962                                                'M' '4' '5' '9'.
  3963             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3964             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3965             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3966             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3967             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3968             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3969             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3970             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3971             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  74
* EL131.cbl
  3972             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3973             88  CM-LF-DECLINED               VALUE 'D'.
  3974             88  CM-LF-VOIDED                 VALUE 'V'.
  3975
  3976         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3977         16  CM-AH-CANCEL-DT               PIC XX.
  3978         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3979
  3980         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3981         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3982         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3983
  3984         16  CM-AH-CURRENT-STATUS          PIC X.
  3985             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3986                                                'M' '4' '5' '9'.
  3987             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3988             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3989             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3990             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3991             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3992             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3993             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3994             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3995             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3996             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  3997             88  CM-AH-DECLINED               VALUE 'D'.
  3998             88  CM-AH-VOIDED                 VALUE 'V'.
  3999
  4000         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4001             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4002             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4003             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4004         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4005
  4006         16  CM-ENTRY-BATCH                PIC X(6).
  4007         16  CM-LF-EXIT-BATCH              PIC X(6).
  4008         16  CM-AH-EXIT-BATCH              PIC X(6).
  4009         16  CM-LAST-MONTH-END             PIC XX.
  4010
  4011     12  CM-NOTE-SW                        PIC X.
  4012         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4013         88  CERT-NOTES-PRESENT               VALUE '1'.
  4014         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4015         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4016         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4017         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4018         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4019         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4020     12  CM-COMP-EXCP-SW                   PIC X.
  4021         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4022         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4023     12  CM-INSURED-ADDRESS-SW             PIC X.
  4024         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4025         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4026
  4027*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4028     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4029     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  75
* EL131.cbl
  4030
  4031*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4032     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4033     12  FILLER                            PIC X.
  4034*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4035     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4036
  4037     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4038         88  CERT-ADDED-BATCH                 VALUE ' '.
  4039         88  CERT-ADDED-ONLINE                VALUE '1'.
  4040         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4041         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4042         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4043     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4044         88  CERT-AS-LOADED                   VALUE ' '.
  4045         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4046         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4047         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4048         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4049         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4050         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4051         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4052
  4053     12  CM-ACCOUNT-COMM-PCTS.
  4054         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4055         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4056
  4057     12  CM-USER-FIELD                     PIC X.
  4058     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4059     12  CM-CLP-STATE                      PIC XX.
  4060     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4061     12  CM-USER-RESERVED                  PIC XXX.
  4062     12  FILLER REDEFINES CM-USER-RESERVED.
  4063         16  CM-AH-CLASS-CD                PIC XX.
  4064         16  F                             PIC X.
  4065******************************************************************
  4066
  4067*                                COPY ELCTRLR.
  4068******************************************************************
  4069*                                                                *
  4070*                            ELCTRLR.                            *
  4071*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4072*                            VMOD=2.014                          *
  4073*                                                                *
  4074*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4075*                                                                *
  4076*   FILE TYPE = VSAM,KSDS                                        *
  4077*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4078*                                                                *
  4079*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4080*       ALTERNATE INDEX = NONE                                   *
  4081*                                                                *
  4082*   LOG = YES                                                    *
  4083*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4084******************************************************************
  4085*                   C H A N G E   L O G
  4086*
  4087* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  76
* EL131.cbl
  4088*-----------------------------------------------------------------
  4089*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4090* EFFECTIVE    NUMBER
  4091*-----------------------------------------------------------------
  4092* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4093* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4094* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4095* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4096* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4097* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4098* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4099* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4100* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4101* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4102* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4103* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4104* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4105* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4106* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4107* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4108******************************************************************
  4109 01  ACTIVITY-TRAILERS.
  4110     12  AT-RECORD-ID                    PIC XX.
  4111         88  VALID-AT-ID                       VALUE 'AT'.
  4112
  4113     12  AT-CONTROL-PRIMARY.
  4114         16  AT-COMPANY-CD               PIC X.
  4115         16  AT-CARRIER                  PIC X.
  4116         16  AT-CLAIM-NO                 PIC X(7).
  4117         16  AT-CERT-NO.
  4118             20  AT-CERT-PRIME           PIC X(10).
  4119             20  AT-CERT-SFX             PIC X.
  4120         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4121             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4122             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4123             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4124             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4125             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4126             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4127             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4128             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4129             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4130             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4131             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4132             88  AT-BENEFICIARY-TRL           VALUE +91.
  4133             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4134             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4135             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4136             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4137
  4138     12  AT-TRAILER-TYPE                 PIC X.
  4139         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4140         88  PAYMENT-TR                       VALUE '2'.
  4141         88  AUTO-PAY-TR                      VALUE '3'.
  4142         88  CORRESPONDENCE-TR                VALUE '4'.
  4143         88  ADDRESS-TR                       VALUE '5'.
  4144         88  GENERAL-INFO-TR                  VALUE '6'.
  4145         88  AUTO-PROMPT-TR                   VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  77
* EL131.cbl
  4146         88  DENIAL-TR                        VALUE '8'.
  4147         88  INCURRED-CHG-TR                  VALUE '9'.
  4148         88  FORM-CONTROL-TR                  VALUE 'A'.
  4149
  4150     12  AT-RECORDED-DT                  PIC XX.
  4151     12  AT-RECORDED-BY                  PIC X(4).
  4152     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4153
  4154     12  AT-TRAILER-BODY                 PIC X(165).
  4155
  4156     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4157         16  AT-RESERVE-CONTROLS.
  4158             20  AT-MANUAL-SW            PIC X.
  4159                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4160             20  AT-FUTURE-SW            PIC X.
  4161                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4162             20  AT-PTC-SW               PIC X.
  4163                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4164             20  AT-IBNR-SW              PIC X.
  4165                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4166             20  AT-PTC-LF-SW            PIC X.
  4167                 88  AT-LF-PTC-USED          VALUE '1'.
  4168             20  AT-CDT-ACCESS-METHOD    PIC X.
  4169                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4170                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4171                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4172             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4173         16  AT-LAST-COMPUTED-DT         PIC XX.
  4174         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4175         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4176         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4177         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4178         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4179         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4180         16  AT-EXPENSE-CONTROLS.
  4181             20  AT-EXPENSE-METHOD       PIC X.
  4182                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4183                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4184                 88  PERCENT-OF-PMT           VALUE '3'.
  4185                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4186             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4187             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4188         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4189         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4190
  4191         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4192         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4193
  4194*        16  FILLER                      PIC X(53).
  4195         16  FILLER                      PIC X(47).
  4196
  4197         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4198         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4199
  4200         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4201             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4202             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4203*                    C = CLOSED
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  78
* EL131.cbl
  4204*                    O = OPEN
  4205             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4206*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4207
  4208     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4209         16  AT-PAYMENT-TYPE             PIC X.
  4210             88  PARTIAL-PAYMENT                VALUE '1'.
  4211             88  FINAL-PAYMENT                  VALUE '2'.
  4212             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4213             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4214             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4215             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4216             88  VOIDED-PAYMENT                 VALUE '9'.
  4217             88  TRANSFER                       VALUE 'T'.
  4218             88  LIFE-INTEREST                  VALUE 'I'.
  4219
  4220         16  AT-CLAIM-TYPE               PIC X.
  4221             88  PAID-FOR-AH                    VALUE 'A'.
  4222             88  PAID-FOR-LIFE                  VALUE 'L'.
  4223             88  PAID-FOR-IUI                   VALUE 'I'.
  4224             88  PAID-FOR-GAP                   VALUE 'G'.
  4225         16  AT-CLAIM-PREM-TYPE          PIC X.
  4226             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4227             88  AT-O-B-COVERAGE                VALUE '2'.
  4228             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4229         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4230         16  AT-CHECK-NO                 PIC X(7).
  4231         16  AT-PAID-FROM-DT             PIC XX.
  4232         16  AT-PAID-THRU-DT             PIC XX.
  4233         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4234         16  FILLER                      PIC X.
  4235         16  AT-PAYEES-NAME              PIC X(30).
  4236         16  AT-PAYMENT-ORIGIN           PIC X.
  4237             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4238             88  ONLINE-AUTO-PMT                VALUE '2'.
  4239             88  OFFLINE-PMT                    VALUE '3'.
  4240         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4241         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4242         16  AT-VOID-DATA.
  4243             20  AT-VOID-DT              PIC XX.
  4244*00144       20  AT-VOID-REASON          PIC X(30).
  4245             20  AT-VOID-REASON          PIC X(26).
  4246         16  AT-PMT-APPROVED-BY          PIC X(04).
  4247         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4248         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4249         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4250                                         PIC S99V9(5)  COMP-3.
  4251         16  AT-CREDIT-INTERFACE.
  4252             20  AT-PMT-SELECT-DT        PIC XX.
  4253                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4254             20  AT-PMT-ACCEPT-DT        PIC XX.
  4255                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4256             20  AT-VOID-SELECT-DT       PIC XX.
  4257                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4258             20  AT-VOID-ACCEPT-DT       PIC XX.
  4259                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4260
  4261         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  79
* EL131.cbl
  4262                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4263                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4264         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4265
  4266         16  AT-FORCE-CONTROL            PIC X.
  4267             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4268         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4269         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4270         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4271         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4272         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4273         16  AT-BENEFIT-TYPE             PIC X.
  4274
  4275         16  AT-EXPENSE-TYPE             PIC X.
  4276         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4277
  4278         16  AT-PAYEE-TYPE-CD.
  4279             20  AT-PAYEE-TYPE           PIC X.
  4280                 88  INSURED-PAID           VALUE 'I'.
  4281                 88  BENEFICIARY-PAID       VALUE 'B'.
  4282                 88  ACCOUNT-PAID           VALUE 'A'.
  4283                 88  OTHER-1-PAID           VALUE 'O'.
  4284                 88  OTHER-2-PAID           VALUE 'Q'.
  4285                 88  DOCTOR-PAID            VALUE 'P'.
  4286                 88  EMPLOYER-PAID          VALUE 'E'.
  4287             20  AT-PAYEE-SEQ            PIC X.
  4288
  4289         16  AT-CASH-PAYMENT             PIC X.
  4290         16  AT-GROUPED-PAYMENT          PIC X.
  4291         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4292         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4293         16  AT-APPROVED-LEVEL           PIC X.
  4294         16  AT-VOID-TYPE                PIC X.
  4295             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4296             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4297         16  AT-AIG-UNEMP-IND            PIC X.
  4298             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4299         16  AT-ASSOCIATES               PIC X.
  4300             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4301             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4302
  4303         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4304         16  AT-CV-PMT-CODE              PIC X.
  4305             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4306             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4307             88  FULL-ADD-PAYMENT           VALUE '3'.
  4308             88  HALF-ADD-PAYMENT           VALUE '4'.
  4309             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4310             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4311             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4312             88  ADDL-PAYMENT               VALUE '8'.
  4313
  4314         16  AT-EOB-CODE1                PIC XXX.
  4315         16  AT-EOB-CODE2                PIC XXX.
  4316         16  AT-EOB-CODE3                PIC XXX.
  4317         16  FILLER REDEFINES AT-EOB-CODE3.
  4318             20  AT-PRINT-CLM-FORM       PIC X.
  4319             20  AT-PRINT-SURVEY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  80
* EL131.cbl
  4320             20  FILLER                  PIC X.
  4321         16  AT-EOB-CODE4                PIC XXX.
  4322         16  FILLER REDEFINES AT-EOB-CODE4.
  4323             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4324             20  FILLER                  PIC X.
  4325         16  AT-EOB-CODE5                PIC XXX.
  4326         16  FILLER REDEFINES AT-EOB-CODE5.
  4327             20  AT-PMT-PROOF-DT         PIC XX.
  4328             20  FILLER                  PIC X.
  4329
  4330         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4331             88  AT-PRINT-EOB            VALUE 'Y'.
  4332
  4333         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4334         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4335
  4336     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4337         16  AT-SCHEDULE-START-DT        PIC XX.
  4338         16  AT-SCHEDULE-END-DT          PIC XX.
  4339         16  AT-TERMINATED-DT            PIC XX.
  4340         16  AT-LAST-PMT-TYPE            PIC X.
  4341             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4342             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4343         16  AT-FIRST-PMT-DATA.
  4344             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4345             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4346             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4347         16  AT-REGULAR-PMT-DATA.
  4348             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4349             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4350             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4351         16  AT-AUTO-PAYEE-CD.
  4352             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4353                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4354                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4355                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4356                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4357                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4358             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4359         16  AT-AUTO-PAY-DAY             PIC 99.
  4360         16  AT-AUTO-CASH                PIC X.
  4361             88  AT-CASH                      VALUE 'Y'.
  4362             88  AT-NON-CASH                  VALUE 'N'.
  4363*        16  FILLER                      PIC X(129).
  4364         16  AT-AUTO-END-LETTER          PIC X(4).
  4365         16  FILLER                      PIC X(125).
  4366
  4367         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4368         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4369
  4370     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4371         16  AT-LETTER-SENT-DT           PIC XX.
  4372         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4373         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4374         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4375         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4376         16  AT-LETTER-ORIGIN            PIC X.
  4377             88  ONLINE-CREATION              VALUE '1' '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  81
* EL131.cbl
  4378             88  OFFLINE-CREATION             VALUE '2' '4'.
  4379             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4380             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4381         16  AT-STD-LETTER-FORM          PIC X(4).
  4382         16  AT-REASON-TEXT              PIC X(70).
  4383         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4384         16  AT-ADDRESEE-TYPE            PIC X.
  4385              88  INSURED-ADDRESEE            VALUE 'I'.
  4386              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4387              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4388              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4389              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4390              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4391              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4392         16  AT-ADDRESSEE-NAME           PIC X(30).
  4393         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4394         16  AT-RESEND-PRINT-DATE        PIC XX.
  4395         16  AT-CORR-SOL-UNSOL           PIC X.
  4396         16  AT-LETTER-PURGED-DT         PIC XX.
  4397*
  4398*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4399*
  4400         16  AT-CSO-REDEFINITION.
  4401             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4402             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4403             20  AT-LETTER-TO-BENE       PIC X(1).
  4404             20  AT-STOP-LETTER-DT       PIC X(2).
  4405             20  FILLER                  PIC X(19).
  4406*             20  FILLER                  PIC X(27).
  4407             20  AT-CSO-LETTER-STATUS    PIC X.
  4408                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4409                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4410                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4411             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4412             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4413*
  4414*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4415*
  4416*        16  FILLER                      PIC X(26).
  4417*
  4418*        16  AT-DMD-BSR-CODE             PIC X.
  4419*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4420*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4421*
  4422*        16  AT-DMD-LETTER-STATUS        PIC X.
  4423*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4424*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4425*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4426*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4427*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4428
  4429         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4430         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4431
  4432     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4433         16  AT-ADDRESS-TYPE             PIC X.
  4434             88  INSURED-ADDRESS               VALUE 'I'.
  4435             88  BENEFICIARY-ADDRESS           VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  82
* EL131.cbl
  4436             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4437             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4438             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4439             88  OTHER-ADDRESS-1               VALUE 'O'.
  4440             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4441         16  AT-MAIL-TO-NAME             PIC X(30).
  4442         16  AT-ADDRESS-LINE-1           PIC X(30).
  4443         16  AT-ADDRESS-LINE-2           PIC X(30).
  4444         16  AT-CITY-STATE.
  4445             20  AT-CITY                 PIC X(28).
  4446             20  AT-STATE                PIC XX.
  4447         16  AT-ZIP.
  4448             20  AT-ZIP-CODE.
  4449                 24  AT-ZIP-1ST          PIC X.
  4450                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4451                 24  FILLER              PIC X(4).
  4452             20  AT-ZIP-PLUS4            PIC X(4).
  4453         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4454             20  AT-CAN-POSTAL-1         PIC XXX.
  4455             20  AT-CAN-POSTAL-2         PIC XXX.
  4456             20  FILLER                  PIC XXX.
  4457         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4458*         16  FILLER                      PIC X(23).
  4459         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4460         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4461         16  FILLER                      PIC X(13).
  4462         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4463         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4464
  4465     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4466         16  AT-INFO-LINE-1              PIC X(60).
  4467         16  FILLER REDEFINES AT-INFO-LINE-1.
  4468             20  AT-NOTE-ERROR-NO OCCURS 15
  4469                                         PIC X(4).
  4470         16  AT-INFO-LINE-2              PIC X(60).
  4471         16  AT-INFO-TRAILER-TYPE        PIC X.
  4472             88  AT-ERRORS-NOTE          VALUE 'E'.
  4473             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4474             88  AT-CALL-NOTE            VALUE 'C'.
  4475             88  AT-MAINT-NOTE           VALUE 'M'.
  4476             88  AT-CERT-CHANGE          VALUE 'X'.
  4477             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4478             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4479         16  AT-CALL-TYPE                PIC X.
  4480             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4481             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4482         16  AT-NOTE-CONTINUATION        PIC X.
  4483             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4484         16  AT-EOB-CODES-EXIST          PIC X.
  4485             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4486         16  FILLER                      PIC X(35).
  4487         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4488         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4489
  4490     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4491         16  AT-PROMPT-LINE-1            PIC X(60).
  4492         16  AT-PROMPT-LINE-2            PIC X(60).
  4493         16  AT-PROMPT-START-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  83
* EL131.cbl
  4494         16  AT-PROMPT-END-DT            PIC XX.
  4495         16  FILLER                      PIC X(35).
  4496         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4497         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4498
  4499     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4500         16  AT-DENIAL-INFO-1            PIC X(60).
  4501         16  AT-DENIAL-INFO-2            PIC X(60).
  4502         16  AT-DENIAL-DT                PIC XX.
  4503         16  AT-RETRACTION-DT            PIC XX.
  4504         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4505*         16  FILLER                      PIC X(31).
  4506         16  AT-DENIAL-PROOF-DT          PIC XX.
  4507         16  FILLER                      PIC X(29).
  4508         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4509         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4510
  4511     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4512         16  AT-OLD-INCURRED-DT          PIC XX.
  4513         16  AT-OLD-REPORTED-DT          PIC XX.
  4514         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4515         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4516         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4517         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4518         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4519         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4520         16  FILLER                      PIC X(26).
  4521         16  AT-OLD-DIAG-CODE            PIC X(6).
  4522         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4523         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4524         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4525         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4526         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4527         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4528         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4529         16  FILLER                      PIC X(25).
  4530         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4531
  4532     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4533         16  AT-FORM-SEND-ON-DT          PIC XX.
  4534         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4535         16  AT-FORM-RE-SEND-DT          PIC XX.
  4536         16  AT-FORM-ANSWERED-DT         PIC XX.
  4537         16  AT-FORM-PRINTED-DT          PIC XX.
  4538         16  AT-FORM-REPRINT-DT          PIC XX.
  4539         16  AT-FORM-TYPE                PIC X.
  4540             88  INITIAL-FORM                  VALUE '1'.
  4541             88  PROGRESS-FORM                 VALUE '2'.
  4542         16  AT-INSTRUCT-LN-1            PIC X(28).
  4543         16  AT-INSTRUCT-LN-2            PIC X(28).
  4544         16  AT-INSTRUCT-LN-3            PIC X(28).
  4545         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4546         16  AT-FORM-ADDRESS             PIC X.
  4547             88  FORM-TO-INSURED              VALUE 'I'.
  4548             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4549             88  FORM-TO-OTHER-1              VALUE 'O'.
  4550             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4551         16  AT-RELATED-1.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  84
* EL131.cbl
  4552             20 AT-REL-CARR-1            PIC X.
  4553             20 AT-REL-CLAIM-1           PIC X(7).
  4554             20 AT-REL-CERT-1            PIC X(11).
  4555         16  AT-RELATED-2.
  4556             20 AT-REL-CARR-2            PIC X.
  4557             20 AT-REL-CLAIM-2           PIC X(7).
  4558             20 AT-REL-CERT-2            PIC X(11).
  4559         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4560         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4561         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4562         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4563         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4564         16  AT-STOP-FORM-DT             PIC X(2).
  4565
  4566         16  FILLER                      PIC X(09).
  4567         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4568         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4569******************************************************************
  4570
  4571*                                COPY ELCCNTL.
  4572******************************************************************
  4573*                                                                *
  4574*                                                                *
  4575*                            ELCCNTL.                            *
  4576*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4577*                            VMOD=2.059                          *
  4578*                                                                *
  4579*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4580*                                                                *
  4581*   FILE TYPE = VSAM,KSDS                                        *
  4582*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4583*                                                                *
  4584*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4585*       ALTERNATE INDEX = NONE                                   *
  4586*                                                                *
  4587*   LOG = YES                                                    *
  4588*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4589******************************************************************
  4590*                   C H A N G E   L O G
  4591*
  4592* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4593*-----------------------------------------------------------------
  4594*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4595* EFFECTIVE    NUMBER
  4596*-----------------------------------------------------------------
  4597* 082503                   PEMA  ADD BENEFIT GROUP
  4598* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4599* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4600* 092705    2005050300006  PEMA  ADD SPP LEASES
  4601* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4602* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4603* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4604* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4605* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4606* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4607* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4608* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4609******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  85
* EL131.cbl
  4610*
  4611 01  CONTROL-FILE.
  4612     12  CF-RECORD-ID                       PIC XX.
  4613         88  VALID-CF-ID                        VALUE 'CF'.
  4614
  4615     12  CF-CONTROL-PRIMARY.
  4616         16  CF-COMPANY-ID                  PIC XXX.
  4617         16  CF-RECORD-TYPE                 PIC X.
  4618             88  CF-COMPANY-MASTER              VALUE '1'.
  4619             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4620             88  CF-STATE-MASTER                VALUE '3'.
  4621             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4622             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4623             88  CF-CARRIER-MASTER              VALUE '6'.
  4624             88  CF-MORTALITY-MASTER            VALUE '7'.
  4625             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4626             88  CF-TERMINAL-MASTER             VALUE '9'.
  4627             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4628             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4629             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4630             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4631             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4632             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4633             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4634             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4635             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4636         16  CF-ACCESS-CD-GENL              PIC X(4).
  4637         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4638             20  CF-PROCESSOR               PIC X(4).
  4639         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4640             20  CF-STATE-CODE              PIC XX.
  4641             20  FILLER                     PIC XX.
  4642         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4643             20  FILLER                     PIC XX.
  4644             20  CF-HI-BEN-IN-REC           PIC XX.
  4645         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4646             20  FILLER                     PIC XXX.
  4647             20  CF-CARRIER-CNTL            PIC X.
  4648         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4649             20  FILLER                     PIC XX.
  4650             20  CF-HI-TYPE-IN-REC          PIC 99.
  4651         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4652             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4653                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4654             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4655             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4656         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4657             20  FILLER                     PIC X.
  4658             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4659         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4660             20  FILLER                     PIC XX.
  4661             20  CF-MORTGAGE-PLAN           PIC XX.
  4662         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4663
  4664     12  CF-LAST-MAINT-DT                   PIC XX.
  4665     12  CF-LAST-MAINT-BY                   PIC X(4).
  4666     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4667
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  86
* EL131.cbl
  4668     12  CF-RECORD-BODY                     PIC X(728).
  4669
  4670
  4671****************************************************************
  4672*             COMPANY MASTER RECORD                            *
  4673****************************************************************
  4674
  4675     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4676         16  CF-COMPANY-ADDRESS.
  4677             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4678             20  CF-CL-IN-CARE-OF           PIC X(30).
  4679             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4680             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4681             20  CF-CL-CITY-STATE           PIC X(30).
  4682             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4683             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4684         16  CF-COMPANY-CD                  PIC X.
  4685         16  CF-COMPANY-PASSWORD            PIC X(8).
  4686         16  CF-SECURITY-OPTION             PIC X.
  4687             88  ALL-SECURITY                   VALUE '1'.
  4688             88  COMPANY-VERIFY                 VALUE '2'.
  4689             88  PROCESSOR-VERIFY               VALUE '3'.
  4690             88  NO-SECURITY                    VALUE '4'.
  4691             88  ALL-BUT-TERM                   VALUE '5'.
  4692         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4693             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4694         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4695             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4696         16  CF-INFORCE-LOCATION            PIC X.
  4697             88  CERTS-ARE-ONLINE               VALUE '1'.
  4698             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4699             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4700         16  CF-LOWER-CASE-LETTERS          PIC X.
  4701         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4702             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4703             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4704             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4705             88  CF-ACCNT-CNTL                  VALUE '3'.
  4706             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4707
  4708         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4709         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4710
  4711         16  CF-LGX-CREDIT-USER             PIC X.
  4712             88  CO-IS-NOT-USER                 VALUE 'N'.
  4713             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4714
  4715         16 CF-CREDIT-CALC-CODES.
  4716             20  CF-CR-REM-TERM-CALC PIC X.
  4717               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4718               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4719               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4720               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4721               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4722               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4723               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4724             20  CF-CR-R78-METHOD           PIC X.
  4725               88  USE-TERM-PLUS-ONE            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  87
* EL131.cbl
  4726               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4727
  4728         16  CF-CLAIM-CONTROL-COUNTS.
  4729             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4730                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4731
  4732             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4733                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4734
  4735             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4736                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4737
  4738             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4739                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4740
  4741         16  CF-CURRENT-MONTH-END           PIC XX.
  4742
  4743         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4744             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4745             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4746             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4747             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4748                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4749                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4750             20  CF-CO-PREM-REJECT-SW       PIC X.
  4751                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4752                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4753             20  CF-CO-REF-REJECT-SW        PIC X.
  4754                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4755                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4756
  4757         16  CF-CO-REPORTING-DT             PIC XX.
  4758         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4759         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4760           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4761           88  CF-CO-MONTH-END                  VALUE '1'.
  4762
  4763         16  CF-LGX-CLAIM-USER              PIC X.
  4764             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4765             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4766
  4767         16  CF-CREDIT-EDIT-CONTROLS.
  4768             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4769             20  CF-MIN-AGE                 PIC 99.
  4770             20  CF-DEFAULT-AGE             PIC 99.
  4771             20  CF-MIN-TERM                PIC S999      COMP-3.
  4772             20  CF-MAX-TERM                PIC S999      COMP-3.
  4773             20  CF-DEFAULT-SEX             PIC X.
  4774             20  CF-JOINT-AGE-INPUT         PIC X.
  4775                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4776             20  CF-BIRTH-DATE-INPUT        PIC X.
  4777                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4778             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4779                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4780                 88  CF-ZERO-CARRIER            VALUE '1'.
  4781                 88  CF-ZERO-GROUPING           VALUE '2'.
  4782                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4783             20  CF-EDIT-SW                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  88
* EL131.cbl
  4784                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4785             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4786             20  CF-CR-PR-METHOD            PIC X.
  4787               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4788               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4789             20  FILLER                     PIC X.
  4790
  4791         16  CF-CREDIT-MISC-CONTROLS.
  4792             20  CF-REIN-TABLE-SW           PIC X.
  4793                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4794             20  CF-COMP-TABLE-SW           PIC X.
  4795                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4796             20  CF-EXPERIENCE-RETENTION-AGE
  4797                                            PIC S9        COMP-3.
  4798             20  CF-CONVERSION-DT           PIC XX.
  4799             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4800             20  CF-RUN-FREQUENCY-SW        PIC X.
  4801                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4802                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4803
  4804             20  CF-CR-CHECK-NO-CONTROL.
  4805                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4806                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4807                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4808                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4809                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4810                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4811
  4812                 24  CF-CR-CHECK-COUNT       REDEFINES
  4813                     CF-CR-CHECK-COUNTER      PIC X(4).
  4814
  4815                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4816                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4817
  4818                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4819                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4820                 24  CF-MAIL-PROCESSING       PIC X.
  4821                     88  MAIL-PROCESSING          VALUE 'Y'.
  4822
  4823         16  CF-MISC-SYSTEM-CONTROL.
  4824             20  CF-SYSTEM-C                 PIC X.
  4825                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4826             20  CF-SYSTEM-D                 PIC X.
  4827                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4828             20  CF-SOC-SEC-NO-SW            PIC X.
  4829                 88  SOC-SEC-NO-USED             VALUE '1'.
  4830             20  CF-MEMBER-NO-SW             PIC X.
  4831                 88  MEMBER-NO-USED              VALUE '1'.
  4832             20  CF-TAX-ID-NUMBER            PIC X(11).
  4833             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4834             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4835                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4836                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4837                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4838                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4839             20  CF-SYSTEM-E                 PIC X.
  4840                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4841
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  89
* EL131.cbl
  4842         16  CF-LGX-LIFE-USER               PIC X.
  4843             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4844             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4845
  4846         16  CF-CR-MONTH-END-DT             PIC XX.
  4847
  4848         16  CF-FILE-MAINT-DATES.
  4849             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4850                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4851             20  CF-LAST-BATCH       REDEFINES
  4852                 CF-LAST-BATCH-NO               PIC X(4).
  4853             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4854             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4855             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4856             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4857             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4858             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4859             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4860             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4861             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4862             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4863
  4864         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4865         16  FILLER                         PIC X.
  4866
  4867         16  CF-ALT-MORT-CODE               PIC X(4).
  4868         16  CF-MEMBER-CAPTION              PIC X(10).
  4869
  4870         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4871             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4872             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4873             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4874             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4875             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4876
  4877         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4878
  4879         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4880         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4881         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4882         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4883
  4884         16  CF-AH-OVERRIDE-L1              PIC X.
  4885         16  CF-AH-OVERRIDE-L2              PIC XX.
  4886         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4887         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4888
  4889         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4890         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4891
  4892         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4893         16  CF-AR-LAST-EL860-DT            PIC XX.
  4894         16  CF-MP-MONTH-END-DT             PIC XX.
  4895
  4896         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4897         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4898             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4899
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  90
* EL131.cbl
  4900         16  CF-AR-MONTH-END-DT             PIC XX.
  4901
  4902         16  CF-CRDTCRD-USER                PIC X.
  4903             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4904             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4905
  4906         16  CF-CC-MONTH-END-DT             PIC XX.
  4907
  4908         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4909
  4910         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4911             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4912             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4913             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4914         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4915         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4916         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4917         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4918             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4919             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4920         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4921         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4922         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4923             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4924         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4925
  4926         16  CF-CL-ZIP-CODE.
  4927             20  CF-CL-ZIP-PRIME.
  4928                 24  CF-CL-ZIP-1ST          PIC X.
  4929                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4930                 24  FILLER                 PIC X(4).
  4931             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4932         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4933             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4934             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4935             20  FILLER                     PIC XXX.
  4936
  4937         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4938         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4939         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4940         16  CF-CO-OPTION-START-DATE        PIC XX.
  4941         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4942           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4943                                                      '3' '4'.
  4944           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4945           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4946           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4947           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4948           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4949           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4950
  4951         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4952
  4953         16  CF-PAYMENT-APPROVAL-LEVELS.
  4954             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4955             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4956             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4957             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  91
* EL131.cbl
  4958             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4959             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4960
  4961         16  CF-END-USER-REPORTING-USER     PIC X.
  4962             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4963             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4964
  4965         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4966             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4967             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4968
  4969         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4970
  4971         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4972         16  FILLER                         PIC X.
  4973
  4974         16  CF-CREDIT-ARCHIVE-CNTL.
  4975             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4976             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4977             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4978
  4979         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4980
  4981         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4982             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4983             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4984
  4985         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4986             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4987             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4988
  4989         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4990
  4991         16  CF-CO-ACH-ID-CODE              PIC  X.
  4992             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4993             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4994             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4995         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4996         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4997         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4998         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4999         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5000         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5001         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5002         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5003         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5004                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5005         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5006                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5007
  5008         16  CF-CO-OVER-SHORT.
  5009             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5010             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5011
  5012*         16  FILLER                         PIC X(102).
  5013         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5014             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5015             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  92
* EL131.cbl
  5016
  5017         16  CF-AH-APPROVAL-DAYS.
  5018             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5019             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5020             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5021             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5022
  5023         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5024
  5025         16  FILLER                         PIC X(79).
  5026****************************************************************
  5027*             PROCESSOR/USER RECORD                            *
  5028****************************************************************
  5029
  5030     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5031         16  CF-PROCESSOR-NAME              PIC X(30).
  5032         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5033         16  CF-PROCESSOR-TITLE             PIC X(26).
  5034         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5035                 88  MESSAGE-YES                VALUE 'Y'.
  5036                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5037
  5038*****************************************************
  5039****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5040****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5041****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5042****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5043*****************************************************
  5044
  5045         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5046             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5047             20  CF-APPLICATION-FORCE       PIC X.
  5048             20  CF-INDIVIDUAL-APP.
  5049                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5050                     28  CF-BROWSE-APP      PIC X.
  5051                     28  CF-UPDATE-APP      PIC X.
  5052
  5053         16  CF-CURRENT-TERM-ON             PIC X(4).
  5054         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5055             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5056             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5057             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5058             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5059             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5060             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5061             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5062         16  CF-PROCESSOR-CARRIER           PIC X.
  5063             88  NO-CARRIER-SECURITY            VALUE ' '.
  5064         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5065             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5066         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5067             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5068         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5069             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5070
  5071         16  CF-PROC-SYS-ACCESS-SW.
  5072             20  CF-PROC-CREDIT-CLAIMS-SW.
  5073                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  93
* EL131.cbl
  5074                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5075                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5076                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5077             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5078                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5079                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5080             20  CF-PROC-LIFE-GNRLDGR-SW.
  5081                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5082                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5083                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5084                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5085             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5086                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5087                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5088         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5089             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5090             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5091         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5092
  5093         16  CF-APPROVAL-LEVEL                  PIC X.
  5094             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5095             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5096             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5097             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5098
  5099         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5100
  5101         16  CF-LANGUAGE-TYPE                   PIC X.
  5102             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5103             88  CF-LANG-IS-FR                      VALUE 'F'.
  5104
  5105         16  CF-CSR-IND                         PIC X.
  5106         16  FILLER                             PIC X(239).
  5107
  5108****************************************************************
  5109*             PROCESSOR/REMINDERS RECORD                       *
  5110****************************************************************
  5111
  5112     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5113         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5114             20  CF-START-REMIND-DT         PIC XX.
  5115             20  CF-END-REMIND-DT           PIC XX.
  5116             20  CF-REMINDER-TEXT           PIC X(50).
  5117         16  FILLER                         PIC X(296).
  5118
  5119
  5120****************************************************************
  5121*             STATE MASTER RECORD                              *
  5122****************************************************************
  5123
  5124     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5125         16  CF-STATE-ABBREVIATION          PIC XX.
  5126         16  CF-STATE-NAME                  PIC X(25).
  5127         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5128         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5129             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5130             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5131             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  94
* EL131.cbl
  5132             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5133                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5134                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5135             20  CF-ST-PREM-REJECT-SW       PIC X.
  5136                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5137                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5138             20  CF-ST-REF-REJECT-SW        PIC X.
  5139                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5140                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5141         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5142         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5143         16  CF-ST-REFUND-RULES.
  5144             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5145             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5146             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5147         16  CF-ST-FST-PMT-EXTENSION.
  5148             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5149             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5150                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5151                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5152                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5153                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5154         16  CF-ST-STATE-CALL.
  5155             20  CF-ST-CALL-UNEARNED        PIC X.
  5156             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5157             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5158         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5159             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5160             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5161         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5162         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5163         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5164         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5165         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5166         16  FILLER                         PIC X.
  5167         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5168             20  CF-ST-BENEFIT-CD           PIC XX.
  5169             20  CF-ST-BENEFIT-KIND         PIC X.
  5170                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5171                 88  CF-ST-AH-KIND              VALUE 'A'.
  5172             20  CF-ST-REM-TERM-CALC        PIC X.
  5173                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5174                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5175                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5176                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5177                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5178                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5179                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5180                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5181
  5182             20  CF-ST-REFUND-CALC          PIC X.
  5183                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5184                 88  ST-REFD-BY-R78             VALUE '1'.
  5185                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5186                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5187                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5188                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5189                 88  ST-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  95
* EL131.cbl
  5190                 88  ST-REFD-UTAH               VALUE '7'.
  5191                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5192                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5193                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5194
  5195             20  CF-ST-EARNING-CALC         PIC X.
  5196                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5197                 88  ST-EARN-BY-R78             VALUE '1'.
  5198                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5199                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5200                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5201                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5202                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5203                 88  ST-EARN-MEAN               VALUE '8'.
  5204                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5205
  5206             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5207                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5208                 88  ST-OVRD-BY-R78             VALUE '1'.
  5209                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5210                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5211                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5212                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5213                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5214                 88  ST-OVRD-MEAN               VALUE '8'.
  5215                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5216             20  FILLER                     PIC X.
  5217
  5218         16  CF-ST-COMMISSION-CAPS.
  5219             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5220             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5221             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5222             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5223         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5224                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5225
  5226         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5227
  5228         16  CF-ST-STATUTORY-INTEREST.
  5229             20  CF-ST-STAT-DATE-FROM       PIC X.
  5230                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5231                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5232             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5233             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5234             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5235             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5236             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5237
  5238         16  CF-ST-OVER-SHORT.
  5239             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5240             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5241
  5242         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5243
  5244         16  CF-ST-RT-CALC                  PIC X.
  5245
  5246         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5247         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  96
* EL131.cbl
  5248         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5249         16  CF-ST-RF-LR-CALC               PIC X.
  5250         16  CF-ST-RF-LL-CALC               PIC X.
  5251         16  CF-ST-RF-LN-CALC               PIC X.
  5252         16  CF-ST-RF-AH-CALC               PIC X.
  5253         16  CF-ST-RF-CP-CALC               PIC X.
  5254*        16  FILLER                         PIC X(206).
  5255*CIDMOD         16  FILLER                         PIC X(192).
  5256         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5257             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5258         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5259         16  CF-ST-VFY-2ND-BENE             PIC X.
  5260         16  CF-ST-CAUSAL-STATE             PIC X.
  5261         16  FILLER                         PIC X(185).
  5262
  5263****************************************************************
  5264*             BENEFIT MASTER RECORD                            *
  5265****************************************************************
  5266
  5267     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5268         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5269             20  CF-BENEFIT-CODE            PIC XX.
  5270             20  CF-BENEFIT-NUMERIC  REDEFINES
  5271                 CF-BENEFIT-CODE            PIC XX.
  5272             20  CF-BENEFIT-ALPHA           PIC XXX.
  5273             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5274             20  CF-BENEFIT-COMMENT         PIC X(10).
  5275
  5276             20  CF-LF-COVERAGE-TYPE        PIC X.
  5277                 88  CF-REDUCING                VALUE 'R'.
  5278                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5279
  5280             20  CF-SPECIAL-CALC-CD         PIC X.
  5281                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5282                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5283                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5284                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5285                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5286                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5287                 88  CF-FARM-PLAN               VALUE 'F'.
  5288                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5289                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5290                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5291                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5292                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5293                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5294                 88  CF-PRUDENTIAL              VALUE 'P'.
  5295                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5296                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5297                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5298                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5299                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5300                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5301
  5302             20  CF-JOINT-INDICATOR         PIC X.
  5303                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5304
  5305*            20  FILLER                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  97
* EL131.cbl
  5306             20  FILLER                     PIC X(11).
  5307             20  CF-BENEFIT-CATEGORY        PIC X.
  5308             20  CF-LOAN-TYPE               PIC X(8).
  5309
  5310             20  CF-CO-REM-TERM-CALC        PIC X.
  5311                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5312                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5313                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5314                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5315                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5316
  5317             20  CF-CO-EARNINGS-CALC        PIC X.
  5318                 88  CO-EARN-BY-R78             VALUE '1'.
  5319                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5320                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5321                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5322                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5323                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5324                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5325                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5326
  5327             20  CF-CO-REFUND-CALC          PIC X.
  5328                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5329                 88  CO-REFD-BY-R78             VALUE '1'.
  5330                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5331                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5332                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5333                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5334                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5335                 88  CO-REFD-MEAN               VALUE '8'.
  5336                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5337                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5338                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5339
  5340             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5341                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5342                 88  CO-OVRD-BY-R78             VALUE '1'.
  5343                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5344                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5345                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5346                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5347                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5348                 88  CO-OVRD-MEAN               VALUE '8'.
  5349                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5350
  5351             20  CF-CO-BEN-I-G-CD           PIC X.
  5352                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5353                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5354                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5355
  5356         16  FILLER                         PIC X(304).
  5357
  5358
  5359****************************************************************
  5360*             CARRIER MASTER RECORD                            *
  5361****************************************************************
  5362
  5363     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  98
* EL131.cbl
  5364         16  CF-ADDRESS-DATA.
  5365             20  CF-MAIL-TO-NAME            PIC X(30).
  5366             20  CF-IN-CARE-OF              PIC X(30).
  5367             20  CF-ADDRESS-LINE-1          PIC X(30).
  5368             20  CF-ADDRESS-LINE-2          PIC X(30).
  5369             20  CF-CITY-STATE              PIC X(30).
  5370             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5371             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5372
  5373         16  CF-CLAIM-NO-CONTROL.
  5374             20  CF-CLAIM-NO-METHOD         PIC X.
  5375                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5376                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5377                 88  CLAIM-NO-SEQ               VALUE '3'.
  5378                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5379             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5380                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5381                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5382                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5383
  5384         16  CF-CHECK-NO-CONTROL.
  5385             20  CF-CHECK-NO-METHOD         PIC X.
  5386                 88  CHECK-NO-MANUAL            VALUE '1'.
  5387                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5388                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5389                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5390             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5391                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5392
  5393         16  CF-DOMICILE-STATE              PIC XX.
  5394
  5395         16  CF-EXPENSE-CONTROLS.
  5396             20  CF-EXPENSE-METHOD          PIC X.
  5397                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5398                 88  DOLLARS-PER-PMT            VALUE '2'.
  5399                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5400                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5401             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5402             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5403
  5404         16  CF-CORRESPONDENCE-CONTROL.
  5405             20  CF-LETTER-RESEND-OPT       PIC X.
  5406                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5407                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5408             20  FILLER                     PIC X(4).
  5409
  5410         16  CF-RESERVE-CONTROLS.
  5411             20  CF-MANUAL-SW               PIC X.
  5412                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5413             20  CF-FUTURE-SW               PIC X.
  5414                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5415             20  CF-PTC-SW                  PIC X.
  5416                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5417             20  CF-IBNR-SW                 PIC X.
  5418                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5419             20  CF-PTC-LF-SW               PIC X.
  5420                 88  CF-LF-PTC-USED             VALUE '1'.
  5421             20  CF-CDT-ACCESS-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page  99
* EL131.cbl
  5422                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5423                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5424                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5425             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5426
  5427         16  CF-CLAIM-CALC-METHOD           PIC X.
  5428             88  360-PLUS-MONTHS                VALUE '1'.
  5429             88  365-PLUS-MONTHS                VALUE '2'.
  5430             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5431             88  360-DAILY                      VALUE '4'.
  5432             88  365-DAILY                      VALUE '5'.
  5433
  5434         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5435         16  FILLER                         PIC X(11).
  5436
  5437         16  CF-LIMIT-AMOUNTS.
  5438             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5439             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5440             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5441             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5442             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5443             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5444             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5445             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5446             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5447             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5448
  5449         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5450         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5451         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5452
  5453         16  CF-ZIP-CODE.
  5454             20  CF-ZIP-PRIME.
  5455                 24  CF-ZIP-1ST             PIC X.
  5456                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5457                 24  FILLER                 PIC X(4).
  5458             20  CF-ZIP-PLUS4               PIC X(4).
  5459         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5460             20  CF-CAN-POSTAL-1            PIC XXX.
  5461             20  CF-CAN-POSTAL-2            PIC XXX.
  5462             20  FILLER                     PIC XXX.
  5463
  5464         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5465         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5466         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5467
  5468         16  CF-RATING-SWITCH               PIC X.
  5469             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5470             88  CF-NO-RATING                   VALUE 'N'.
  5471
  5472         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5473
  5474         16  CF-CARRIER-OVER-SHORT.
  5475             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5476             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5477
  5478         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5479         16  CF-SECPAY-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 100
* EL131.cbl
  5480             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5481             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5482         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5483         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5484         16  FILLER                         PIC X(444).
  5485*        16  FILLER                         PIC X(452).
  5486
  5487
  5488****************************************************************
  5489*             MORTALITY MASTER RECORD                          *
  5490****************************************************************
  5491
  5492     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5493         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5494                                INDEXED BY CF-MORT-NDX.
  5495             20  CF-MORT-TABLE              PIC X(5).
  5496             20  CF-MORT-TABLE-TYPE         PIC X.
  5497                 88  CF-MORT-JOINT              VALUE 'J'.
  5498                 88  CF-MORT-SINGLE             VALUE 'S'.
  5499                 88  CF-MORT-COMBINED           VALUE 'C'.
  5500                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5501                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5502             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5503             20  CF-MORT-AGE-METHOD         PIC XX.
  5504                 88  CF-AGE-LAST                VALUE 'AL'.
  5505                 88  CF-AGE-NEAR                VALUE 'AN'.
  5506             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5507             20  CF-MORT-ADJUSTMENT-DIRECTION
  5508                                            PIC X.
  5509                 88  CF-MINUS                   VALUE '-'.
  5510                 88  CF-PLUS                    VALUE '+'.
  5511             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5512             20  CF-MORT-JOINT-CODE         PIC X.
  5513                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5514             20  CF-MORT-PC-Q               PIC X.
  5515                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5516             20  CF-MORT-TABLE-CODE         PIC X(4).
  5517             20  CF-MORT-COMMENTS           PIC X(15).
  5518             20  FILLER                     PIC X(14).
  5519
  5520         16  FILLER                         PIC X(251).
  5521
  5522
  5523****************************************************************
  5524*             BUSSINESS TYPE MASTER RECORD                     *
  5525****************************************************************
  5526
  5527     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5528* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5529* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5530* AND RECORD 05 IS TYPES 81-99
  5531         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5532             20  CF-BUSINESS-TITLE          PIC  X(19).
  5533             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5534                                            PIC S9V9(4) COMP-3.
  5535             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5536             20  FILLER                     PIC  X.
  5537         16  FILLER                         PIC  X(248).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 101
* EL131.cbl
  5538
  5539
  5540****************************************************************
  5541*             TERMINAL MASTER RECORD                           *
  5542****************************************************************
  5543
  5544     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5545
  5546         16  CF-COMPANY-TERMINALS.
  5547             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5548                                  PIC X(4).
  5549         16  FILLER               PIC X(248).
  5550
  5551
  5552****************************************************************
  5553*             LIFE EDIT MASTER RECORD                          *
  5554****************************************************************
  5555
  5556     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5557         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5558             20  CF-LIFE-CODE-IN            PIC XX.
  5559             20  CF-LIFE-CODE-OUT           PIC XX.
  5560         16  FILLER                         PIC X(248).
  5561
  5562
  5563****************************************************************
  5564*             AH EDIT MASTER RECORD                            *
  5565****************************************************************
  5566
  5567     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5568         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5569             20  CF-AH-CODE-IN              PIC XXX.
  5570             20  CF-AH-CODE-OUT             PIC XX.
  5571         16  FILLER                         PIC X(248).
  5572
  5573
  5574****************************************************************
  5575*             CREDIBILITY TABLES                               *
  5576****************************************************************
  5577
  5578     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5579         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5580                             INDEXED BY CF-CRDB-NDX.
  5581             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5582             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5583             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5584         16  FILLER                         PIC  X(332).
  5585
  5586
  5587****************************************************************
  5588*             REPORT CUSTOMIZATION RECORD                      *
  5589****************************************************************
  5590
  5591     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5592         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5593             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5594             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5595             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 102
* EL131.cbl
  5596**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5597****       A T-TRANSFER.                                   ****
  5598             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5599
  5600         16  FILLER                         PIC XX.
  5601
  5602         16  CF-CARRIER-CNTL-OPT.
  5603             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5604                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5605                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5606             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5607                                            PIC X.
  5608         16  CF-GROUP-CNTL-OPT.
  5609             20  CF-GROUP-OPT-SEQ           PIC 9.
  5610                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5611                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5612             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5613                                            PIC X(6).
  5614         16  CF-STATE-CNTL-OPT.
  5615             20  CF-STATE-OPT-SEQ           PIC 9.
  5616                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5617                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5618             20  CF-STATE-SELECT OCCURS 3 TIMES
  5619                                            PIC XX.
  5620         16  CF-ACCOUNT-CNTL-OPT.
  5621             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5622                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5623                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5624             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5625                                            PIC X(10).
  5626         16  CF-BUS-TYP-CNTL-OPT.
  5627             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5628                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5629                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5630             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5631                                            PIC XX.
  5632         16  CF-LF-TYP-CNTL-OPT.
  5633             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5634                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5635                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5636             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5637                                            PIC XX.
  5638         16  CF-AH-TYP-CNTL-OPT.
  5639             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5640                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5641                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5642             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5643                                            PIC XX.
  5644         16  CF-REPTCD1-CNTL-OPT.
  5645             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5646                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5647                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5648             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5649                                            PIC X(10).
  5650         16  CF-REPTCD2-CNTL-OPT.
  5651             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5652                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5653                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 103
* EL131.cbl
  5654             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5655                                            PIC X(10).
  5656         16  CF-USER1-CNTL-OPT.
  5657             20  CF-USER1-OPT-SEQ           PIC 9.
  5658                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5659                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5660             20  CF-USER1-SELECT OCCURS 3 TIMES
  5661                                            PIC X(10).
  5662         16  CF-USER2-CNTL-OPT.
  5663             20  CF-USER2-OPT-SEQ           PIC 9.
  5664                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5665                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5666             20  CF-USER2-SELECT OCCURS 3 TIMES
  5667                                            PIC X(10).
  5668         16  CF-USER3-CNTL-OPT.
  5669             20  CF-USER3-OPT-SEQ           PIC 9.
  5670                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5671                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5672             20  CF-USER3-SELECT OCCURS 3 TIMES
  5673                                            PIC X(10).
  5674         16  CF-USER4-CNTL-OPT.
  5675             20  CF-USER4-OPT-SEQ           PIC 9.
  5676                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5677                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5678             20  CF-USER4-SELECT OCCURS 3 TIMES
  5679                                            PIC X(10).
  5680         16  CF-USER5-CNTL-OPT.
  5681             20  CF-USER5-OPT-SEQ           PIC 9.
  5682                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5683                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5684             20  CF-USER5-SELECT OCCURS 3 TIMES
  5685                                            PIC X(10).
  5686         16  CF-REINS-CNTL-OPT.
  5687             20  CF-REINS-OPT-SEQ           PIC 9.
  5688                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5689                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5690             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5691                 24  CF-REINS-PRIME         PIC XXX.
  5692                 24  CF-REINS-SUB           PIC XXX.
  5693
  5694         16  CF-AGENT-CNTL-OPT.
  5695             20  CF-AGENT-OPT-SEQ           PIC 9.
  5696                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5697                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5698             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5699                                            PIC X(10).
  5700
  5701         16  FILLER                         PIC X(43).
  5702
  5703         16  CF-LOSS-RATIO-SELECT.
  5704             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5705             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5706         16  CF-ENTRY-DATE-SELECT.
  5707             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5708             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5709         16  CF-EFFECTIVE-DATE-SELECT.
  5710             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5711             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 104
* EL131.cbl
  5712
  5713         16  CF-EXCEPTION-LIST-IND          PIC X.
  5714             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5715
  5716         16  FILLER                         PIC X(318).
  5717
  5718****************************************************************
  5719*                  EXCEPTION REPORTING RECORD                  *
  5720****************************************************************
  5721
  5722     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5723         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5724             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5725
  5726         16  CF-COMBINED-LIFE-AH-OPT.
  5727             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5728             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5729             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5730             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5731
  5732         16  CF-LIFE-OPT.
  5733             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5734             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5735             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5736             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5737             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5738             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5739             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5740             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5741             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5742             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5743
  5744         16  CF-AH-OPT.
  5745             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5746             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5747             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5748             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5749             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5750             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5751             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5752             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5753             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5754             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5755
  5756         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5757             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5758             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5759             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5760
  5761         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5762
  5763         16  FILLER                         PIC X(673).
  5764
  5765
  5766****************************************************************
  5767*             MORTGAGE SYSTEM PLAN RECORD                      *
  5768****************************************************************
  5769
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 105
* EL131.cbl
  5770     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5771         16  CF-PLAN-TYPE                   PIC X.
  5772             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5773             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5774             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5775         16  CF-PLAN-ABBREV                 PIC XXX.
  5776         16  CF-PLAN-DESCRIPT               PIC X(10).
  5777         16  CF-PLAN-NOTES                  PIC X(20).
  5778         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5779         16  CF-PLAN-UNDERWRITING.
  5780             20  CF-PLAN-TERM-DATA.
  5781                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5782                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5783             20  CF-PLAN-AGE-DATA.
  5784                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5785                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5786                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5787             20  CF-PLAN-BENEFIT-DATA.
  5788                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5789                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5790                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5791                                            PIC S9(7)V99  COMP-3.
  5792         16  CF-PLAN-POLICY-FORMS.
  5793             20  CF-POLICY-FORM             PIC X(12).
  5794             20  CF-MASTER-APPLICATION      PIC X(12).
  5795             20  CF-MASTER-POLICY           PIC X(12).
  5796         16  CF-PLAN-RATING.
  5797             20  CF-RATE-CODE               PIC X(5).
  5798             20  CF-SEX-RATING              PIC X.
  5799                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5800                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5801             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5802             20  CF-SUB-STD-TYPE            PIC X.
  5803                 88  CF-PCT-OF-PREM            VALUE '1'.
  5804                 88  CF-PCT-OF-BENE            VALUE '2'.
  5805         16  CF-PLAN-PREM-TOLERANCES.
  5806             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5807             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5808         16  CF-PLAN-PYMT-TOLERANCES.
  5809             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5810             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5811         16  CF-PLAN-MISC-DATA.
  5812             20  FILLER                     PIC X.
  5813             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5814             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5815         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5816         16  CF-PLAN-IND-GRP                PIC X.
  5817             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5818                                                     '1'.
  5819             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5820                                                     '2'.
  5821         16  CF-MIB-SEARCH-SW               PIC X.
  5822             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5823             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5824             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5825             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5826         16  CF-ALPHA-SEARCH-SW             PIC X.
  5827             88  CF-MIB-ALPHA-ALL              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 106
* EL131.cbl
  5828             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5829             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5830             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5831             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5832             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5833             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5834             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5835             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5836             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5837                                                     'A' 'B' 'C'
  5838                                                     'X' 'Y' 'Z'.
  5839         16  CF-EFF-DT-RULE-SW              PIC X.
  5840             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5841             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5842             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5843             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5844             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5845         16  FILLER                         PIC X(4).
  5846         16  CF-HEALTH-QUESTIONS            PIC X.
  5847             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5848         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5849         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5850         16  CF-PLAN-SNGL-JNT               PIC X.
  5851             88  CF-COMBINED-PLAN              VALUE 'C'.
  5852             88  CF-JNT-PLAN                   VALUE 'J'.
  5853             88  CF-SNGL-PLAN                  VALUE 'S'.
  5854         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5855         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5856         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5857         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5858         16  CF-RERATE-CNTL                 PIC  X.
  5859             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5860             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5861             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5862             88  CF-AUTO-RECALC                 VALUE '4'.
  5863         16  CF-BENEFIT-TYPE                PIC  X.
  5864             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5865             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5866         16  CF-POLICY-FEE                  PIC S999V99
  5867                                                    COMP-3.
  5868         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5869         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5870         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5871         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5872         16  FILLER                         PIC  X(32).
  5873         16  CF-TERMINATION-FORM            PIC  X(04).
  5874         16  FILLER                         PIC  X(08).
  5875         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5876                                                       COMP-3.
  5877         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5878         16  CF-ISSUE-LETTER                PIC  X(4).
  5879         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5880         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5881             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5882             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5883         16  CF-MP-REFUND-CALC              PIC X.
  5884             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5885             88  CF-MP-REFD-BY-R78              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 107
* EL131.cbl
  5886             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5887             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5888             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5889             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5890             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5891             88  CF-MP-REFD-MEAN                VALUE '8'.
  5892         16  CF-ALT-RATE-CODE               PIC  X(5).
  5893
  5894
  5895         16  FILLER                         PIC X(498).
  5896****************************************************************
  5897*             MORTGAGE COMPANY MASTER RECORD                   *
  5898****************************************************************
  5899
  5900     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5901         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5902         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5903             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5904             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5905             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5906             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5907             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5908
  5909         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5910         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5911         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5912         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5913         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5914
  5915         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5916             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5917         16  CF-MP-RECON-USE-IND            PIC X(1).
  5918             88  CF-MP-USE-RECON             VALUE 'Y'.
  5919         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5920             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5921         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5922             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5923             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5924         16  FILLER                         PIC X(1).
  5925         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5926             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5927         16  CF-MORTG-MIB-VERSION           PIC X.
  5928             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5929             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5930             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5931         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5932             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5933                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5934             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5935                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5936             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5937                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5938             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5939                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5940             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5941                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5942             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5943                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 108
* EL131.cbl
  5944         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5945         16  FILLER                         PIC X(7).
  5946         16  CF-MORTG-DESTINATION-SYMBOL.
  5947             20  CF-MORTG-MIB-COMM          PIC X(5).
  5948             20  CF-MORTG-MIB-TERM          PIC X(5).
  5949         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5950             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5951         16  FILLER                         PIC X(03).
  5952         16  CF-MP-CHECK-NO-CONTROL.
  5953             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5954                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5955                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5956                                                ' ' LOW-VALUES.
  5957                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5958                                               VALUE '3'.
  5959         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5960         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5961         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5962             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5963                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5964             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5965                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5966             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5967                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5968             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5969                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5970             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5971                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5972             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5973                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5974         16  CF-MORTG-BILLING-AREA.
  5975             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5976                                            PIC X.
  5977         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5978         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5979         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5980         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5981             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5982             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5983         16  FILLER                         PIC X.
  5984         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5985             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5986             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5987         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5988         16  FILLER                         PIC X(8).
  5989         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5990         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5991         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5992         16  CF-ACH-COMPANY-ID.
  5993             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5994                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5995                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5996                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5997             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5998         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5999             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6000         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6001             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 109
* EL131.cbl
  6002             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6003         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6004         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6005         16  FILLER                         PIC X(536).
  6006
  6007****************************************************************
  6008*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6009****************************************************************
  6010
  6011     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6012         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6013             20  CF-FEMALE-HEIGHT.
  6014                 24  CF-FEMALE-FT           PIC 99.
  6015                 24  CF-FEMALE-IN           PIC 99.
  6016             20  CF-FEMALE-MIN-WT           PIC 999.
  6017             20  CF-FEMALE-MAX-WT           PIC 999.
  6018         16  FILLER                         PIC X(428).
  6019
  6020     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6021         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6022             20  CF-MALE-HEIGHT.
  6023                 24  CF-MALE-FT             PIC 99.
  6024                 24  CF-MALE-IN             PIC 99.
  6025             20  CF-MALE-MIN-WT             PIC 999.
  6026             20  CF-MALE-MAX-WT             PIC 999.
  6027         16  FILLER                         PIC X(428).
  6028******************************************************************
  6029*             AUTOMATIC ACTIVITY RECORD                          *
  6030******************************************************************
  6031     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6032         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6033             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6034             20  CF-SYS-LETTER-ID           PIC X(04).
  6035             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6036             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6037             20  CF-SYS-RESET-SW            PIC X(01).
  6038             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6039             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6040
  6041         16  FILLER                         PIC X(50).
  6042
  6043         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6044             20  CF-USER-ACTIVE-SW          PIC X(01).
  6045             20  CF-USER-LETTER-ID          PIC X(04).
  6046             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6047             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6048             20  CF-USER-RESET-SW           PIC X(01).
  6049             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6050             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6051             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6052
  6053         16  FILLER                         PIC X(246).
  6054
  6055*                                COPY ELCACTQ.
  6056******************************************************************
  6057*                                                                *
  6058*                            ELCACTQ.                            *
  6059*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 110
* EL131.cbl
  6060*                            VMOD=2.004                          *
  6061*                                                                *
  6062*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6063*                                                                *
  6064*   FILE TYPE = VSAM,KSDS                                        *
  6065*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6066*                                                                *
  6067*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6068*       ALTERNATE INDEX = NONE                                   *
  6069*                                                                *
  6070*   LOG = YES                                                    *
  6071*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6072*                                                                *
  6073*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6074******************************************************************
  6075
  6076 01  ACTIVITY-QUE.
  6077     12  AQ-RECORD-ID                PIC XX.
  6078         88  VALID-AQ-ID                VALUE 'AQ'.
  6079
  6080     12  AQ-CONTROL-PRIMARY.
  6081         16  AQ-COMPANY-CD           PIC X.
  6082         16  AQ-CARRIER              PIC X.
  6083         16  AQ-CLAIM-NO             PIC X(7).
  6084         16  AQ-CERT-NO.
  6085             20  AQ-CERT-PRIME       PIC X(10).
  6086             20  AQ-CERT-SFX         PIC X.
  6087
  6088     12  AQ-PENDING-ACTIVITY-FLAGS.
  6089         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6090         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6091             88  PENDING-PAYMENTS       VALUE '1'.
  6092         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6093             88  PENDING-FULL-PRINT     VALUE '1'.
  6094             88  PENDING-PART-PRINT     VALUE '2'.
  6095         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6096             88  PENDING-LETTERS        VALUE '1'.
  6097         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6098             88  PENDING-RESTORE        VALUE 'C'.
  6099             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6100
  6101     12  FILLER                      PIC X(20).
  6102
  6103     12  AQ-RESEND-DATE              PIC XX.
  6104     12  AQ-FOLLOWUP-DATE            PIC XX.
  6105     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6106     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6107     12  AQ-AUTO-LETTER              PIC X(4).
  6108     12  FILLER                      PIC XX.
  6109     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6110*****************************************************************
  6111
  6112*                                COPY ERCACCT.
  6113******************************************************************
  6114*                                                                *
  6115*                                                                *
  6116*                            ERCACCT                             *
  6117*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 111
* EL131.cbl
  6118*                            VMOD=2.031                          *
  6119*                                                                *
  6120*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6121*                                                                *
  6122*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6123*   VSAM ACCOUNT MASTER FILES.                                   *
  6124*                                                                *
  6125*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6126*                                                                *
  6127*   FILE TYPE = VSAM,KSDS                                        *
  6128*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6129*                                                                *
  6130*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6131*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6132*                                                                *
  6133*   LOG = NO                                                     *
  6134*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6135*                                                                *
  6136*                                                                *
  6137******************************************************************
  6138*                   C H A N G E   L O G
  6139*
  6140* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6141*-----------------------------------------------------------------
  6142*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6143* EFFECTIVE    NUMBER
  6144*-----------------------------------------------------------------
  6145* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6146* 092705    2005050300006  PEMA  ADD SPP LEASES
  6147* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6148* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6149* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6150* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6151* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6152******************************************************************
  6153
  6154 01  ACCOUNT-MASTER.
  6155     12  AM-RECORD-ID                      PIC XX.
  6156         88  VALID-AM-ID                      VALUE 'AM'.
  6157
  6158     12  AM-CONTROL-PRIMARY.
  6159         16  AM-COMPANY-CD                 PIC X.
  6160         16  AM-MSTR-CNTRL.
  6161             20  AM-CONTROL-A.
  6162                 24  AM-CARRIER            PIC X.
  6163                 24  AM-GROUPING.
  6164                     28 AM-GROUPING-PREFIX PIC XXX.
  6165                     28 AM-GROUPING-PRIME  PIC XXX.
  6166                 24  AM-STATE              PIC XX.
  6167                 24  AM-ACCOUNT.
  6168                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6169                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6170             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6171                                           PIC X(19).
  6172             20  AM-CNTRL-B.
  6173                 24  AM-EXPIRATION-DT      PIC XX.
  6174                 24  FILLER                PIC X(4).
  6175             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 112
* EL131.cbl
  6176                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6177
  6178     12  AM-CONTROL-BY-VAR-GRP.
  6179         16  AM-COMPANY-CD-A1              PIC X.
  6180         16  AM-VG-CARRIER                 PIC X.
  6181         16  AM-VG-GROUPING                PIC X(6).
  6182         16  AM-VG-STATE                   PIC XX.
  6183         16  AM-VG-ACCOUNT                 PIC X(10).
  6184         16  AM-VG-DATE.
  6185             20  AM-VG-EXPIRATION-DT       PIC XX.
  6186             20  FILLER                    PIC X(4).
  6187         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6188                                           PIC 9(11)      COMP-3.
  6189     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6190         16  FILLER                        PIC X(10).
  6191         16  AM-VG-KEY3.
  6192             20  AM-VG3-ACCOUNT            PIC X(10).
  6193             20  AM-VG3-EXP-DT             PIC XX.
  6194         16  FILLER                        PIC X(4).
  6195     12  AM-MAINT-INFORMATION.
  6196         16  AM-LAST-MAINT-DT              PIC XX.
  6197         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6198         16  AM-LAST-MAINT-USER            PIC X(4).
  6199         16  FILLER                        PIC XX.
  6200
  6201     12  AM-EFFECTIVE-DT                   PIC XX.
  6202     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6203
  6204     12  AM-PREV-DATES  COMP-3.
  6205         16  AM-PREV-EXP-DT                PIC 9(11).
  6206         16  AM-PREV-EFF-DT                PIC 9(11).
  6207
  6208     12  AM-REPORT-CODE-1                  PIC X(10).
  6209     12  AM-REPORT-CODE-2                  PIC X(10).
  6210
  6211     12  AM-CITY-CODE                      PIC X(4).
  6212     12  AM-COUNTY-PARISH                  PIC X(6).
  6213
  6214     12  AM-NAME                           PIC X(30).
  6215     12  AM-PERSON                         PIC X(30).
  6216     12  AM-ADDRS                          PIC X(30).
  6217     12  AM-CITY.
  6218         16  AM-ADDR-CITY                  PIC X(28).
  6219         16  AM-ADDR-STATE                 PIC XX.
  6220     12  AM-ZIP.
  6221         16  AM-ZIP-PRIME.
  6222             20  AM-ZIP-PRI-1ST            PIC X.
  6223                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6224             20  FILLER                    PIC X(4).
  6225         16  AM-ZIP-PLUS4                  PIC X(4).
  6226     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6227         16  AM-CAN-POSTAL-1               PIC XXX.
  6228         16  AM-CAN-POSTAL-2               PIC XXX.
  6229         16  FILLER                        PIC XXX.
  6230     12  AM-TEL-NO.
  6231         16  AM-AREA-CODE                  PIC 999.
  6232         16  AM-TEL-PRE                    PIC 999.
  6233         16  AM-TEL-NBR                    PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 113
* EL131.cbl
  6234     12  AM-TEL-LOC                        PIC X.
  6235         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6236         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6237
  6238     12  AM-COMM-STRUCTURE.
  6239         16  AM-DEFN-1.
  6240             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6241                 24  AM-AGT.
  6242                     28  AM-AGT-PREFIX     PIC X(4).
  6243                     28  AM-AGT-PRIME      PIC X(6).
  6244                 24  AM-COM-TYP            PIC X.
  6245                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6246                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6247                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6248                 24  AM-RECALC-LV-INDIC    PIC X.
  6249                 24  AM-RETRO-LV-INDIC     PIC X.
  6250                 24  AM-GL-CODES           PIC X.
  6251                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6252                 24  FILLER                PIC X(01).
  6253         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6254             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6255                 24  FILLER                PIC X(11).
  6256                 24  AM-L-COMA             PIC XXX.
  6257                 24  AM-J-COMA             PIC XXX.
  6258                 24  AM-A-COMA             PIC XXX.
  6259                 24  FILLER                PIC X(6).
  6260
  6261     12  AM-COMM-CHANGE-STATUS             PIC X.
  6262         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6263
  6264     12  AM-CSR-CODE                       PIC X(4).
  6265
  6266     12  AM-BILLING-STATUS                 PIC X.
  6267         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6268         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6269     12  AM-AUTO-REFUND-SW                 PIC X.
  6270         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6271         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6272     12  AM-GPCD                           PIC 99.
  6273     12  AM-IG                             PIC X.
  6274         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6275         88  AM-HAS-GROUP                     VALUE '2'.
  6276     12  AM-STATUS                         PIC X.
  6277         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6278         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6279         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6280         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6281         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6282         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6283     12  AM-REMIT-TO                       PIC 99.
  6284     12  AM-ID-NO                          PIC X(11).
  6285
  6286     12  AM-CAL-TABLE                      PIC XX.
  6287     12  AM-LF-DEVIATION                   PIC XXX.
  6288     12  AM-AH-DEVIATION                   PIC XXX.
  6289     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6290     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6291     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 114
* EL131.cbl
  6292     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6293     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6294     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6295
  6296     12  AM-USER-FIELDS.
  6297         16  AM-FLD-1                      PIC XX.
  6298         16  AM-FLD-2                      PIC XX.
  6299         16  AM-FLD-3                      PIC XX.
  6300         16  AM-FLD-4                      PIC XX.
  6301         16  AM-FLD-5                      PIC XX.
  6302
  6303     12  AM-1ST-PROD-DATE.
  6304         16  AM-1ST-PROD-YR                PIC XX.
  6305         16  AM-1ST-PROD-MO                PIC XX.
  6306         16  AM-1ST-PROD-DA                PIC XX.
  6307     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6308     12  AM-CERTS-PURGED-DATE.
  6309         16  AM-PUR-YR                     PIC XX.
  6310         16  AM-PUR-MO                     PIC XX.
  6311         16  AM-PUR-DA                     PIC XX.
  6312     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6313     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6314     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6315     12  AM-INACTIVE-DATE.
  6316         16  AM-INA-MO                     PIC 99.
  6317         16  AM-INA-DA                     PIC 99.
  6318         16  AM-INA-YR                     PIC 99.
  6319     12  AM-AR-HI-CERT-DATE                PIC XX.
  6320
  6321     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6322     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6323
  6324     12  AM-OB-PAYMENT-MODE                PIC X.
  6325         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6326         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6327         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6328         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6329
  6330     12  AM-AH-ONLY-INDICATOR              PIC X.
  6331         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6332         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6333
  6334     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6335
  6336     12  AM-OVER-SHORT.
  6337         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6338         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6339
  6340     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6341     12  AM-DCC-CLP-STATE                  PIC XX.
  6342
  6343     12  AM-RECALC-COMM                    PIC X.
  6344     12  AM-RECALC-REIN                    PIC X.
  6345
  6346     12  AM-REI-TABLE                      PIC XXX.
  6347     12  AM-REI-ET-LF                      PIC X.
  6348     12  AM-REI-ET-AH                      PIC X.
  6349     12  AM-REI-PE-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 115
* EL131.cbl
  6350     12  AM-REI-PE-AH                      PIC X.
  6351     12  AM-REI-PRT-ST                     PIC X.
  6352     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6353     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6354     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6355     12  AM-REI-GROUP-A                    PIC X(6).
  6356     12  AM-REI-MORT                       PIC X(4).
  6357     12  AM-REI-PRT-OW                     PIC X.
  6358     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6359     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6360     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6361     12  AM-REI-GROUP-B                    PIC X(6).
  6362
  6363     12  AM-TRUST-TYPE                     PIC X(2).
  6364
  6365     12  AM-EMPLOYER-STMT-USED             PIC X.
  6366     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6367
  6368     12  AM-STD-AH-TYPE                    PIC XX.
  6369     12  AM-EARN-METHODS.
  6370         16  AM-EARN-METHOD-R              PIC X.
  6371             88 AM-REF-RL-R78                 VALUE 'R'.
  6372             88 AM-REF-RL-PR                  VALUE 'P'.
  6373             88 AM-REF-RL-MEAN                VALUE 'M'.
  6374             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6375         16  AM-EARN-METHOD-L              PIC X.
  6376             88 AM-REF-LL-R78                 VALUE 'R'.
  6377             88 AM-REF-LL-PR                  VALUE 'P'.
  6378             88 AM-REF-LL-MEAN                VALUE 'M'.
  6379             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6380         16  AM-EARN-METHOD-A              PIC X.
  6381             88 AM-REF-AH-R78                 VALUE 'R'.
  6382             88 AM-REF-AH-PR                  VALUE 'P'.
  6383             88 AM-REF-AH-MEAN                VALUE 'M'.
  6384             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6385             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6386             88 AM-REF-AH-NET                 VALUE 'N'.
  6387
  6388     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6389     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6390     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6391
  6392     12  AM-RET-Y-N                        PIC X.
  6393     12  AM-RET-P-E                        PIC X.
  6394     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6395     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6396     12  AM-RET-GRP                        PIC X(6).
  6397     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6398         16  AM-POOL-PRIME                 PIC XXX.
  6399         16  AM-POOL-SUB                   PIC XXX.
  6400     12  AM-RETRO-EARNINGS.
  6401         16  AM-RET-EARN-R                 PIC X.
  6402         16  AM-RET-EARN-L                 PIC X.
  6403         16  AM-RET-EARN-A                 PIC X.
  6404     12  AM-RET-ST-TAX-USE                 PIC X.
  6405         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6406         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6407     12  AM-RETRO-BEG-EARNINGS.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 116
* EL131.cbl
  6408         16  AM-RET-BEG-EARN-R             PIC X.
  6409         16  AM-RET-BEG-EARN-L             PIC X.
  6410         16  AM-RET-BEG-EARN-A             PIC X.
  6411     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6412     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6413
  6414     12  AM-USER-SELECT-OPTIONS.
  6415         16  AM-USER-SELECT-1              PIC X(10).
  6416         16  AM-USER-SELECT-2              PIC X(10).
  6417         16  AM-USER-SELECT-3              PIC X(10).
  6418         16  AM-USER-SELECT-4              PIC X(10).
  6419         16  AM-USER-SELECT-5              PIC X(10).
  6420
  6421     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6422
  6423     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6424
  6425     12  AM-RPT045A-SWITCH                 PIC X.
  6426         88  RPT045A-OFF                   VALUE 'N'.
  6427
  6428     12  AM-INSURANCE-LIMITS.
  6429         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6430         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6431
  6432     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6433         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6434
  6435     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6436         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6437         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6438
  6439     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6440
  6441     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6442     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6443     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6444     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6445     12  AM-DCC-UEF-STATE                  PIC XX.
  6446     12  FILLER                            PIC XXX.
  6447     12  AM-REPORT-CODE-3                  PIC X(10).
  6448*    12  FILLER                            PIC X(22).
  6449
  6450     12  AM-RESERVE-DATE.
  6451         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6452         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6453         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6454
  6455     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6456     12  AM-NOTIFICATION-TYPES.
  6457         16  AM-NOTIF-OF-LETTERS           PIC X.
  6458         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6459         16  AM-NOTIF-OF-REPORTS           PIC X.
  6460         16  AM-NOTIF-OF-STATUS            PIC X.
  6461
  6462     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6463         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6464         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6465         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 117
* EL131.cbl
  6466         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6467
  6468     12  AM-BENEFIT-CONTROLS.
  6469         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6470             20  AM-BENEFIT-CODE           PIC XX.
  6471             20  AM-BENEFIT-TYPE           PIC X.
  6472             20  AM-BENEFIT-REVISION       PIC XXX.
  6473             20  AM-BENEFIT-REM-TERM       PIC X.
  6474             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6475             20  FILLER                    PIC XX.
  6476         16  FILLER                        PIC X(80).
  6477
  6478     12  AM-TRANSFER-DATA.
  6479         16  AM-TRANSFERRED-FROM.
  6480             20  AM-TRNFROM-CARRIER        PIC X.
  6481             20  AM-TRNFROM-GROUPING.
  6482                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6483                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6484             20  AM-TRNFROM-STATE          PIC XX.
  6485             20  AM-TRNFROM-ACCOUNT.
  6486                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6487                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6488             20  AM-TRNFROM-DTE            PIC XX.
  6489         16  AM-TRANSFERRED-TO.
  6490             20  AM-TRNTO-CARRIER          PIC X.
  6491             20  AM-TRNTO-GROUPING.
  6492                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6493                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6494             20  AM-TRNTO-STATE            PIC XX.
  6495             20  AM-TRNTO-ACCOUNT.
  6496                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6497                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6498             20  AM-TRNTO-DTE              PIC XX.
  6499         16  FILLER                        PIC X(10).
  6500
  6501     12  AM-SAVED-REMIT-TO                 PIC 99.
  6502
  6503     12  AM-COMM-STRUCTURE-SAVED.
  6504         16  AM-DEFN-1-SAVED.
  6505             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6506                 24  AM-AGT-SV             PIC X(10).
  6507                 24  AM-COM-TYP-SV         PIC X.
  6508                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6509                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6510                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6511                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6512                 24  FILLER                PIC X.
  6513                 24  AM-GL-CODES-SV        PIC X.
  6514                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6515                 24  FILLER                PIC X.
  6516         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6517             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6518                 24  FILLER                PIC X(11).
  6519                 24  AM-L-COMA-SV          PIC XXX.
  6520                 24  AM-J-COMA-SV          PIC XXX.
  6521                 24  AM-A-COMA-SV          PIC XXX.
  6522                 24  FILLER                PIC X(6).
  6523
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 118
* EL131.cbl
  6524     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6525         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6526            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6527            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6528            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6529
  6530     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6531     12  FILLER                            PIC X(120).
  6532
  6533     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6534         16  AM-CONTROL-NAME               PIC X(30).
  6535         16  AM-EXECUTIVE-ONE.
  6536             20  AM-EXEC1-NAME             PIC X(15).
  6537             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6538                                                          COMP-3.
  6539             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6540                                                          COMP-3.
  6541         16  AM-EXECUTIVE-TWO.
  6542             20  AM-EXEC2-NAME             PIC X(15).
  6543             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6544                                                          COMP-3.
  6545             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6546                                                          COMP-3.
  6547
  6548     12  AM-RETRO-ADDITIONAL-DATA.
  6549         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6550         16  AM-RETRO-PREM-P-E             PIC X.
  6551         16  AM-RETRO-CLMS-P-I             PIC X.
  6552         16  AM-RETRO-RET-BRACKET-LF.
  6553             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6554                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6555                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6556             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6557                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6558                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6559             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6560                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6561                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6562         16  AM-RETRO-RET-BRACKET-AH.
  6563             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6564                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6565                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6566                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6567             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6568                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6569                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6570             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6571                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6572                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6573
  6574     12  AM-COMMENTS.
  6575         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6576
  6577     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6578         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6579         16  AM-FLI-BILLING-CODE           PIC X.
  6580         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6581         16  AM-FLI-UNITED-IDENT           PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 119
* EL131.cbl
  6582         16  AM-FLI-INTEREST-LOST-DATA.
  6583             20  AM-FLI-BANK-NO            PIC X(5).
  6584             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6585             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6586             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6587         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6588             20  AM-FLI-AGT                PIC X(9).
  6589             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6590             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6591         16  FILLER                        PIC X(102).
  6592
  6593     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6594         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6595             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6596             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6597             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6598             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6599             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6600         16  FILLER                          PIC X(10).
  6601******************************************************************
  6602
  6603*                                COPY ELCCHKQ.
  6604******************************************************************
  6605*                                                                *
  6606*                                                                *
  6607*                            ELCCHKQ.                            *
  6608*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6609*                            VMOD=2.007                          *
  6610*                                                                *
  6611*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6612*                                                                *
  6613*   FILE TYPE = VSAM,KSDS                                        *
  6614*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6615*                                                                *
  6616*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6617*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6618*                                                                *
  6619*   LOG = YES                                                    *
  6620*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6621******************************************************************
  6622 01  CHECK-QUE.
  6623     12  CQ-RECORD-ID                PIC XX.
  6624         88  VALID-CQ-ID         VALUE 'CQ'.
  6625
  6626     12  CQ-CONTROL-PRIMARY.
  6627         16  CQ-COMPANY-CD           PIC X.
  6628         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6629         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6630
  6631     12  CQ-CONTROL-BY-PAYEE.
  6632         16  CQ-CONTROL-BY-NUMBER.
  6633             20  CQ-COMPANY-CD-A1     PIC X.
  6634             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6635         16  CQ-PAYEE-CARRIER        PIC X.
  6636         16  CQ-PAYEE-GROUPING       PIC X(6).
  6637         16  CQ-PAYEE-STATE          PIC XX.
  6638         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6639         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 120
* EL131.cbl
  6640
  6641     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6642         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6643         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6644         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6645         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6646         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6647         16  FILLER                  PIC X(3).
  6648
  6649     12  CQ-ENTRY-TYPE               PIC X.
  6650             88  CHECK-ON-QUE           VALUE 'Q'.
  6651             88  ALIGNMENT-CHECK        VALUE 'A'.
  6652             88  SPOILED-CHECK          VALUE 'S'.
  6653             88  PAYMENT-ABORTED        VALUE 'X'.
  6654
  6655     12  CQ-CLAIM-MAST-CNTL.
  6656         16  CQ-CARRIER              PIC X.
  6657         16  CQ-CLAIM-NO             PIC X(7).
  6658         16  CQ-CERT-NO.
  6659             20  CQ-CERT-PRIME       PIC X(10).
  6660             20  CQ-CERT-SFX         PIC X.
  6661         16  CQ-CLAIM-TYPE           PIC X.
  6662             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6663             88  CQ-AH-CLAIM            VALUE 'A'.
  6664         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6665             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6666             88  CQ-O-B-COVERAGE        VALUE '2'.
  6667             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6668
  6669     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6670     12  CQ-CHECK-NUMBER             PIC X(7).
  6671     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6672     12  CQ-PAYMENT-TYPE             PIC X.
  6673             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6674             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6675             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6676             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6677             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6678             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6679             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6680             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6681     12  CQ-VOID-INDICATOR           PIC X.
  6682             88  CHECK-IS-STOPPED          VALUE 'S'.
  6683             88  CHECK-IS-VOID             VALUE 'V'.
  6684     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6685     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6686     12  CQ-CHECK-BY-USER            PIC X(4).
  6687     12  CQ-PRE-NUMBERING-SW         PIC X.
  6688       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6689       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6690
  6691     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6692     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6693     12  CQ-LEDGER-FLAG              PIC X(01).
  6694     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6695     12  CQ-LAST-UPDATED-DT          PIC XX.
  6696     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6697     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 121
* EL131.cbl
  6698
  6699     12  FILLER                      PIC X(04).
  6700
  6701******************************************************************
  6702
  6703*                                COPY ELCARCH.
  6704******************************************************************
  6705*                                                                *
  6706*                            ELCARCH.                            *
  6707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6708*                            VMOD=2.007                          *
  6709*                                                                *
  6710*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6711*                                                                *
  6712*   FILE TYPE = VSAM,KSDS                                        *
  6713*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6714*                                                                *
  6715*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6716*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6717*                                                                *
  6718*   LOG = NO                                                     *
  6719*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6720*                                                                *
  6721*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6722******************************************************************
  6723 01  LETTER-ARCHIVE.
  6724     12  LA-RECORD-ID                PIC XX.
  6725         88  VALID-LA-ID                VALUE 'LA'.
  6726
  6727     12  LA-CONTROL-PRIMARY.
  6728         16  LA-COMPANY-CD           PIC X.
  6729         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6730         16  LA-RECORD-TYPE          PIC X.
  6731             88  LA-HEADER-DATA         VALUE '1'.
  6732             88  LA-ADDRESS-DATA        VALUE '2'.
  6733             88  LA-TEXT-DATA           VALUE '3'.
  6734             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6735         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6736
  6737     12  LA-CONTROL-BY-TYPE.
  6738         16  LA-COMPANY-CD-A1        PIC X.
  6739         16  LA-RECORD-TYPE-A1       PIC X.
  6740         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6741         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6742
  6743     12  LA-TEXT-RECORD.
  6744         16  LA-SKIP-CONTROL         PIC XX.
  6745             88  NO-LINES-SKIPPED       VALUE SPACES.
  6746             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6747         16  LA-TEXT-LINE            PIC X(70).
  6748
  6749     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6750         16  FILLER                  PIC XX.
  6751         16  LA-ADDRESS-LINE         PIC X(30).
  6752         16  FILLER                  PIC X(40).
  6753
  6754     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6755         16  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 122
* EL131.cbl
  6756         16  LA-CARRIER              PIC X.
  6757         16  LA-CLAIM-NO             PIC X(7).
  6758         16  LA-CERT-NO.
  6759             20  LA-CERT-PRIME       PIC X(10).
  6760             20  LA-CERT-SFX         PIC X.
  6761         16  LA-NO-OF-COPIES         PIC S9.
  6762         16  LA-RESEND-DATE          PIC XX.
  6763         16  LA-PROCESSOR-CD         PIC X(4).
  6764         16  LA-CREATION-DT          PIC XX.
  6765         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6766         16  LA-RESEND-PRINT-DATE    PIC XX.
  6767         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6768         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6769*
  6770* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6771*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6772*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6773*   I        20  LA-DMD-RES-ST           PIC XX.
  6774*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6775*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6776*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6777*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6778*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6779*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6780*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6781*   I        20  LA-DMD-UND-CODE         PIC XX.
  6782*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6783*   V    16  FILLER                  PIC X(15).
  6784* -----
  6785*
  6786* REINSERTED  CSO  MODS
  6787*
  6788         16  FILLER.
  6789             20  FILLER                  PIC X(29).
  6790             20  LA-CSO-LETTER-STATUS    PIC X.
  6791                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6792                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6793                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6794             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6795             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6796*
  6797
  6798     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6799         16  FILLER                  PIC XX.
  6800         16  LA4-CARRIER             PIC X.
  6801         16  LA4-CLAIM-NO            PIC X(7).
  6802         16  LA4-CERT-NO.
  6803             20  LA4-CERT-PRIME      PIC X(10).
  6804             20  LA4-CERT-SFX        PIC X.
  6805         16  LA4-NO-OF-COPIES        PIC S9.
  6806         16  LA4-RESEND-DATE         PIC XX.
  6807         16  LA4-PROCESSOR-CD        PIC X(4).
  6808         16  LA4-CREATION-DT         PIC XX.
  6809         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6810         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6811         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6812         16  LA4-FORM-TYPE           PIC X.
  6813             88  LA4-INITIAL-FORM    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 123
* EL131.cbl
  6814             88  LA4-PROGRESS-FORM   VALUE '2'.
  6815         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6816         16  LA4-STATE               PIC X(02).
  6817         16  FILLER                  PIC X(31).
  6818******************************************************************
  6819
  6820*                                COPY ELCBENE.
  6821******************************************************************
  6822*                                                                *
  6823*                            ELCBENE.                            *
  6824*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6825*                            VMOD=2.006                          *
  6826*                                                                *
  6827*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6828*                                                                *
  6829*   FILE TYPE = VSAM,KSDS                                        *
  6830*   RECORD SIZE = 500   RECFORM = FIX                            *
  6831*                                                                *
  6832*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6833*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6834*                                                                *
  6835*   LOG = YES                                                    *
  6836*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6837*                                                                *
  6838*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6839******************************************************************
  6840
  6841 01  BENEFICIARY-MASTER.
  6842     12  BE-RECORD-ID                PIC XX.
  6843         88  VALID-BE-ID                VALUE 'BE'.
  6844
  6845     12  BE-CONTROL-PRIMARY.
  6846         16  BE-COMPANY-CD           PIC X.
  6847         16  BE-RECORD-TYPE          PIC X.
  6848             88  BENEFICIARY-RECORD  VALUE 'B'.
  6849             88  ADJUSTOR-RECORD     VALUE 'A'.
  6850         16  BE-BENEFICIARY          PIC X(10).
  6851     12  BE-CONTROL-BY-NAME.
  6852         16  BE-COMPANY-CD-A1        PIC X.
  6853         16  BE-RECORD-TYPE-A1       PIC X.
  6854         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6855         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6856
  6857     12  BE-LAST-MAINT-DT            PIC XX.
  6858     12  BE-LAST-MAINT-BY            PIC X(4).
  6859     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6860
  6861     12  BE-ADDRESS-DATA.
  6862         16  BE-MAIL-TO-NAME         PIC X(30).
  6863         16  BE-ADDRESS-LINE-1       PIC X(30).
  6864         16  BE-ADDRESS-LINE-2       PIC X(30).
  6865         16  BE-ADDRESS-LINE-3       PIC X(30).
  6866         16  BE-CITY-STATE.
  6867             20  BE-CITY             PIC X(28).
  6868             20  BE-STATE            PIC XX.
  6869         16  BE-ZIP-CODE.
  6870             20  BE-ZIP-PRIME.
  6871                 24  BE-ZIP-1ST      PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 124
* EL131.cbl
  6872                     88  BE-CANADIAN-POST-CODE
  6873                                         VALUE 'A' THRU 'Z'.
  6874                 24  FILLER          PIC X(4).
  6875             20  BE-ZIP-PLUS4        PIC X(4).
  6876         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6877             20  BE-CAN-POSTAL-1     PIC XXX.
  6878             20  BE-CAN-POSTAL-2     PIC XXX.
  6879             20  FILLER              PIC XXX.
  6880         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6881         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6882
  6883******************************************************************
  6884*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6885*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6886******************************************************************
  6887     12  BE-CARRIER                  PIC X.
  6888
  6889     12  BE-ADDRESS-DATA2.
  6890         16  BE-MAIL-TO-NAME2        PIC X(30).
  6891         16  BE-ADDRESS-LINE-12      PIC X(30).
  6892         16  BE-ADDRESS-LINE-22      PIC X(30).
  6893         16  BE-ADDRESS-LINE-32      PIC X(30).
  6894         16  BE-CITY-STATE2.
  6895             20  BE-CITY2            PIC X(28).
  6896             20  BE-STATE2           PIC XX.
  6897         16  BE-ZIP-CODE2.
  6898             20  BE-ZIP-PRIME2.
  6899                 24  BE-ZIP-1ST2     PIC X.
  6900                     88  BE-CANADIAN-POST-CODE2
  6901                                         VALUE 'A' THRU 'Z'.
  6902                 24  FILLER          PIC X(4).
  6903             20  BE-ZIP-PLUS42       PIC X(4).
  6904         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6905             20  BE-CAN-POSTAL-12    PIC XXX.
  6906             20  BE-CAN-POSTAL-22    PIC XXX.
  6907             20  FILLER              PIC XXX.
  6908         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6909         16  BE-BILLING-STMT-DATA.
  6910             20  BE-BSR              PIC X.
  6911                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6912                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6913             20  BE-BSR-FROM         PIC X(30).
  6914             20  BE-BSR-DEPT         PIC X(30).
  6915             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6916             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6917             20  BE-OUTPUT-TYPE      PIC X.
  6918                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6919                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6920
  6921     12  FILLER                      PIC X(28).
  6922******************************************************************
  6923
  6924*                                COPY ELCDAR.
  6925******************************************************************
  6926*                                                                *
  6927*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6928*   FILE TYPE = VSAM,KSDS                                        *
  6929*   RECORD SIZE = 25   RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 125
* EL131.cbl
  6930*   BASE CLUSTER = DLYACTV                                       *
  6931*   LOG = YES                                                    *
  6932*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6933*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6934*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6935*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6936*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6937*               BY PROGRAM "LGINFCE".                            *
  6938*                                                                *
  6939******************************************************************
  6940 01  DAILY-ACTIVITY-RECORD.
  6941     05  DA-KEY.
  6942         10  DA-COMP-CD          PIC X.
  6943         10  DA-CARRIER          PIC X.
  6944         10  DA-CLAIM-NO         PIC X(7).
  6945         10  DA-CERT-NO.
  6946             15  DA-CERT-PRIME   PIC X(10).
  6947             15  DA-CERT-SFX     PIC X.
  6948     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6949     05  DA-RECORD-TYPE          PIC X.
  6950     05  FILLER                  PIC X(2).
  6951******************************************************************
  6952
  6953*                                COPY ELCALPH.
  6954******************************************************************
  6955*                                                                *
  6956*                            ELCALPH.                            *
  6957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6958*                            VMOD=2.003                          *
  6959*                                                                *
  6960*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  6961*                                                                *
  6962*   FILE TYPE = VSAM,KSDS                                        *
  6963*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6964*                                                                *
  6965*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6966*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6967*                                                                *
  6968*   LOG = YES                                                    *
  6969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6970*                                                                *
  6971*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  6972******************************************************************
  6973
  6974 01  ALPHA-INDEX.
  6975     12  AI-RECORD-ID                         PIC XX.
  6976         88  VALID-AI-ID                  VALUE 'AI'.
  6977     12  AI-CONTROL-PRIMARY.
  6978         16  AI-COMPANY-CD                     PIC X.
  6979         16  AI-SOURCE                         PIC X.
  6980             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  6981             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  6982         16  AI-NAME.
  6983             20  AI-LAST-NAME                  PIC X(15).
  6984             20  AI-FIRST-NAME.
  6985                 24  AI-FIRST-INITIAL          PIC X.
  6986                 24  FILLER                    PIC X(11).
  6987             20  AI-MIDDLE-INIT                PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 126
* EL131.cbl
  6988         16  AI-DATE                           PIC X(8).
  6989         16  AI-TIME                           PIC S9(07) COMP-3.
  6990
  6991     12  AI-CONTROL-BY-ADMIN-KEY.
  6992         16  AI-CM-COMPANY-CD                  PIC X.
  6993         16  AI-CM-SOURCE                      PIC X.
  6994         16  AI-CM-CARRIER                     PIC X.
  6995         16  AI-CM-GROUPING.
  6996             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  6997             20  AI-CM-GROUPING-PRIME          PIC X(3).
  6998         16  AI-CM-STATE                       PIC XX.
  6999         16  AI-CM-PRODUCER.
  7000             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7001             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7002         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7003         16  AI-CM-CERTIFICATE-NUMBER.
  7004             20  AI-CM-CERT-PRIME              PIC X(10).
  7005             20  AI-CM-CERT-SFX                PIC X.
  7006         16  AI-CM-DATE                        PIC X(8).
  7007         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7008         16  FILLER                            PIC X(11).
  7009
  7010     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7011         AI-CONTROL-BY-ADMIN-KEY.
  7012         16  AI-CL-COMPANY-CD                  PIC X.
  7013         16  AI-CL-SOURCE                      PIC X.
  7014         16  AI-CL-CARRIER                     PIC X.
  7015         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7016         16  AI-CL-CERTIFICATE-NUMBER.
  7017             20  AI-CL-CERT-PRIME              PIC X(10).
  7018             20  AI-CL-CERT-SFX                PIC X.
  7019         16  AI-CL-DATE                        PIC X(8).
  7020         16  AI-CL-INCURRED-DATE               PIC XX.
  7021         16  AI-CL-CLOSE-DATE                  PIC XX.
  7022         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7023         16  AI-CREDIT-CARD-NUMBER.
  7024             20  AI-CCN.
  7025                 24  AI-CCN-PREFIX             PIC X(4).
  7026                 24  AI-CCN-PRIME              PIC X(12).
  7027             20  AI-CCN-FILLER                 PIC X(4).
  7028
  7029     12  AI-MAINT-INFO.
  7030         16  AI-LAST-MAINT-BY                  PIC X(4).
  7031         16  AI-LAST-MAINT-DT                  PIC XX.
  7032         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7033
  7034     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7035
  7036     12  FILLER                                PIC X(15).
  7037
  7038
  7039*                                COPY ERCDMDNT.
  7040******************************************************************
  7041*                                                                *
  7042*                            ERCDMDNT                            *
  7043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7044*                            VMOD=2.005                          *
  7045*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 127
* EL131.cbl
  7046*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7047*                                                                *
  7048*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7049*                                                                *
  7050*        FILE TYPE= VSAM,KSDS                                    *
  7051*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7052*                                                                *
  7053*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7054*                                                                *
  7055*        LOG = YES                                               *
  7056*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7057*                                                                *
  7058******************************************************************
  7059
  7060 01  CERTIFICATE-NOTE.
  7061     12  CN-RECORD-ID                     PIC  XX.
  7062         88  VALID-CN-ID                      VALUE 'CN'.
  7063
  7064     12  CN-CONTROL-PRIMARY.
  7065         16  CN-COMPANY-CD                PIC X.
  7066         16  CN-CERT-KEY.
  7067             20  CN-CARRIER               PIC X.
  7068             20  CN-GROUPING.
  7069                 24  CN-GROUPING-PREFIX   PIC XXX.
  7070                 24  CN-GROUPING-PRIME    PIC XXX.
  7071             20  CN-STATE                 PIC XX.
  7072             20  CN-ACCOUNT.
  7073                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7074                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7075             20  CN-CERT-EFF-DT           PIC XX.
  7076             20  CN-CERT-NO.
  7077                 24  CN-CERT-PRIME        PIC X(10).
  7078                 24  CN-CERT-SFX          PIC X.
  7079
  7080     12  CN-BILLING-START-LINE-NO         PIC 99.
  7081     12  CN-BILLING-END-LINE-NO           PIC 99.
  7082
  7083     12  CN-LINES.
  7084         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7085
  7086     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7087         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7088         16  CN-CSI-GENERAL-DATA-AREA.
  7089             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7090
  7091         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7092             CN-CSI-GENERAL-DATA-AREA.
  7093             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7094             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7095             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7096             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7097             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7098             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7099             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7100             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7101             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7102             20  FILLER                       PIC XX.
  7103             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 128
* EL131.cbl
  7104             20  FILLER                       PIC X(38).
  7105
  7106         16  CN-CSI-PRODUCT-DATA-AREA.
  7107             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7108
  7109         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7110             CN-CSI-PRODUCT-DATA-AREA.
  7111             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7112             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7113             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7114             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7115             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7116             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7117             20  FILLER                   PIC XX.
  7118             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7119             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7120             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7121             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7122             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7123             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7124             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7125             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7126             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7127             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7128             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7129             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7130             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7131             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7132             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7133             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7134             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7135             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7136             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7137             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7138             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7139             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7140             20  FILLER                   PIC X(25).
  7141
  7142         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7143             CN-CSI-CREDIT-CARD-DATA.
  7144             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7145             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7146             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7147             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7148             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7149             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7150             20  FILLER                   PIC XX.
  7151             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7152             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7153             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7154             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7155             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7156             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7157             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7158             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7159             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7160             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7161             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 129
* EL131.cbl
  7162             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7163             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7164             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7165             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7166             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7167             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7168             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7169             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7170             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7171             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7172             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7173             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7174             20  FILLER                   PIC X(17).
  7175
  7176         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7177             CN-CSI-FAMILY-LEAVE-DATA.
  7178             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7179             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7180             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7181             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7182             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7183             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7184             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7185             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7186             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7187             20  CN-CSI-SL-INT-ON-PROCEEDS
  7188                                          PIC S9(5)V99  COMP-3.
  7189             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7190             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7191             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7192             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7193             20  CN-CSI-SL-POLICY-BENEFITS
  7194                                          PIC S9(5)V99  COMP-3.
  7195             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7196             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7197             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7198             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7199             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7200             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7201             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7202             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7203             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7204             20  CN-CSI-SL-STATE-NOT      PIC X.
  7205             20  FILLER                   PIC XX.
  7206
  7207         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7208             CN-CSI-SENIOR-LIFE-DATA.
  7209             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7210             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7211             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7212                                          PIC S9(5)V99  COMP-3.
  7213             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7214             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7215             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7216             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7217             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7218             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7219             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 130
* EL131.cbl
  7220             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7221             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7222             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7223             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7224             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7225             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7226             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7227             20  CN-CSI-PP-REPAIR         PIC X.
  7228             20  CN-CSI-PP-REPLACE        PIC X.
  7229             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7230             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7231             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7232             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7233             20  FILLER                   PIC X(5).
  7234
  7235         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7236             CN-CSI-PURCH-PROP-DATA.
  7237             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7238             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7239             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7240             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7241             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7242             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7243             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7244             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7245             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7246             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7247             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7248             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7249             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7250             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7251             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7252             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7253             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7254             20  CN-CSI-EW-REPLACE        PIC X.
  7255             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7256             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7257             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7258             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7259             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7260             20  FILLER                   PIC X(4).
  7261
  7262     12  CN-LAST-MAINT-DT                 PIC XX.
  7263     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7264     12  CN-LAST-MAINT-USER               PIC X(4).
  7265     12  FILLER                           PIC X(6).
  7266
  7267******************************************************************
  7268
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 131
* EL131.cbl
  7270 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7271                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7272                          CONTROL-FILE ACTIVITY-QUE
  7273                          ACCOUNT-MASTER CHECK-QUE
  7274                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7275                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7276                          CERTIFICATE-NOTE.
  7277 0000-DFHEXIT SECTION.
  7278     MOVE '9#                    $   ' TO DFHEIV0.
  7279     MOVE 'EL131' TO DFHEIV1.
  7280     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7281
  7282     IF EIBCALEN = ZERO
  7283         GO TO 8800-UNAUTHORIZED-ACCESS.
  7284
  7285     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7286     MOVE '5'                    TO DC-OPTION-CODE.
  7287     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7288     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7289     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7290     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7291
  7292     IF SAVE-DATE-YY GREATER 70
  7293         MOVE 19                 TO SAVE-DATE-CC
  7294      ELSE
  7295         MOVE 20                 TO SAVE-DATE-CC.
  7296
  7297
  7298* EXEC CICS HANDLE CONDITION
  7299*        PGMIDERR (8820-XCTL-ERROR)
  7300*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7301*        ERROR    (9990-ABEND)
  7302*    END-EXEC.
  7303*    MOVE '"$LI.                 ! " #00007293' TO DFHEIV0
  7304     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7306     MOVE X'2220233030303037323933' TO DFHEIV0(25:11)
  7307     CALL 'kxdfhei1' USING DFHEIV0
  7308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7309
  7310
  7311     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7312     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7313     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7314
  7315     INITIALIZE    EDIT-WORK-AREA.
  7316     MOVE '/'                    TO WORK-SLASH.
  7317     MOVE SPACES                 TO ERROR-SWITCHES.
  7318
  7319     MOVE TRAN-ID                TO TRANS-ID.
  7320     MOVE EIBTRMID               TO PI-TERM.
  7321     MOVE MAP-ID                 TO PI-QUAL.
  7322
  7323     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7324
  7325     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7326         MOVE LOW-VALUES         TO EL131AO
  7327         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 132
* EL131.cbl
  7328         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7329         MOVE -1                 TO MAINTL
  7330         GO TO 8110-SEND-DATA.
  7331
  7332     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7333         MOVE LOW-VALUES         TO EL131AO
  7334         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7335         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7336         MOVE 'X'                TO PI-RETURN-CD-1
  7337         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7338         MOVE -1                 TO MAINTL
  7339         IF WS-RETURNED-FROM = XCTL-EL114
  7340             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7341         END-IF
  7342         GO TO 8100-SEND-MAP.
  7343
  7344     IF EIBAID = DFHCLEAR
  7345         GO TO 8200-RETURN-PRIOR.
  7346
  7347     IF PI-PROCESSOR-ID = 'LGXX'
  7348         NEXT SENTENCE
  7349     ELSE
  7350
  7351* EXEC CICS READQ TS
  7352*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7353*            INTO    (SECURITY-CONTROL)
  7354*            LENGTH  (SC-COMM-LENGTH)
  7355*            ITEM    (SC-ITEM)
  7356*        END-EXEC
  7357*    MOVE '*$II   L              ''   #00007338' TO DFHEIV0
  7358     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7359     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7360     MOVE X'2020233030303037333338' TO DFHEIV0(25:11)
  7361     CALL 'kxdfhei1' USING DFHEIV0,
  7362           PI-SECURITY-TEMP-STORE-ID,
  7363           SECURITY-CONTROL,
  7364           SC-COMM-LENGTH,
  7365           SC-ITEM,
  7366           DFHEIV99,
  7367           DFHEIV99
  7368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7369         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7370         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7371         IF NOT DISPLAY-CAP
  7372             MOVE 'READ'               TO  SM-READ
  7373             PERFORM 9995-SECURITY-VIOLATION
  7374             MOVE ER-0070              TO  EMI-ERROR
  7375             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7376             GO TO 8100-SEND-MAP.
  7377
  7378
  7379* EXEC CICS RECEIVE
  7380*        MAP    ('EL131A')
  7381*        MAPSET ('EL131S')
  7382*    END-EXEC.
  7383     MOVE 'EL131A' TO DFHEIV1
  7384     MOVE 'EL131S' TO DFHEIV2
  7385*    MOVE '8"T                   ''   #00007353' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 133
* EL131.cbl
  7386     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7387     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7388     MOVE X'2020233030303037333533' TO DFHEIV0(25:11)
  7389     CALL 'kxdfhei1' USING DFHEIV0,
  7390           DFHEIV1,
  7391           EL131AI,
  7392           DFHEIV99,
  7393           DFHEIV2,
  7394           DFHEIV99,
  7395           DFHEIV99
  7396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7397
  7398
  7399     IF PFKEYL GREATER THAN ZERO
  7400         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7401
  7402     IF SCREEN-ERROR
  7403         MOVE ER-0004 TO EMI-ERROR
  7404         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7405         MOVE -1 TO MAINTL
  7406         GO TO 8110-SEND-DATA.
  7407
  7408     IF EIBAID = DFHPF3
  7409         GO TO 8500-TRLR-MNT.
  7410
  7411     IF EIBAID = DFHPF4
  7412         GO TO 8600-ADDR-MNT.
  7413
  7414     IF EIBAID = DFHPF5
  7415         GO TO 8700-CERT-MNT.
  7416
  7417     IF PI-COMPANY-ID = 'DMD'
  7418       IF EIBAID = DFHPF6
  7419         GO TO 8750-DMD-CLM-FIX.
  7420
  7421     IF EIBAID = DFHPF7
  7422         GO TO 4000-FORCE-ERRORS.
  7423
  7424     IF EIBAID = DFHPF12
  7425         GO TO 8300-GET-HELP.
  7426
  7427     IF EIBAID = DFHPF15
  7428         GO TO 8725-BENEFICIARY-MNT
  7429     END-IF.
  7430
  7431     IF EIBAID = DFHPF23
  7432         GO TO 8810-PF23-ENTERED.
  7433
  7434     IF EIBAID = DFHPF24
  7435         GO TO 8400-RETURN-MASTER.
  7436
  7437     IF EIBAID NOT = DFHENTER
  7438         MOVE ER-0029            TO EMI-ERROR
  7439         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7440         MOVE -1                 TO MAINTL
  7441         GO TO 8110-SEND-DATA.
  7442
  7443     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 134
* EL131.cbl
  7444         MOVE ER-0311            TO EMI-ERROR
  7445         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7446         MOVE -1                 TO MAINTL
  7447         GO TO 8110-SEND-DATA.
  7448
  7449     IF MAINTI = 'A'
  7450         GO TO 0500-ADD-ALPHA-ONLY.
  7451
  7452     IF MAINTI = 'N'
  7453         GO TO 0600-CHANGE-NAME.
  7454
  7455     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7456
  7457     IF SCREEN-ERROR
  7458         GO TO 8110-SEND-DATA.
  7459
  7460     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7461         MOVE ER-0276            TO EMI-ERROR
  7462         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7463         MOVE -1                 TO MAINTL
  7464         GO TO 8110-SEND-DATA.
  7465
  7466     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7467
  7468     IF SCREEN-ERROR
  7469         GO TO 8110-SEND-DATA.
  7470
  7471     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7472
  7473     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7474
  7475     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7476         GO TO 8110-SEND-DATA.
  7477
  7478     IF EMI-FATAL-CTR GREATER THAN ZERO
  7479         GO TO 8110-SEND-DATA.
  7480
  7481     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7482
  7483     IF WS-OPEN-CLOSE-SW = 'Y'
  7484         IF PI-LETTER-SW = 'Y'
  7485             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7486             MOVE 'T'            TO  CNTL-REC-TYPE
  7487             MOVE SPACES         TO  CNTL-PROC-ID
  7488             MOVE +0             TO  CNTL-SEQ-NO
  7489
  7490* EXEC CICS READ
  7491*                DATASET   (CNTL-FILE-ID)
  7492*                RIDFLD    (CNTL-KEY)
  7493*                SET       (ADDRESS OF CONTROL-FILE)
  7494*            END-EXEC
  7495*    MOVE '&"S        E          (   #00007448' TO DFHEIV0
  7496     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7497     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7498     MOVE X'2020233030303037343438' TO DFHEIV0(25:11)
  7499     CALL 'kxdfhei1' USING DFHEIV0,
  7500           CNTL-FILE-ID,
  7501           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 135
* EL131.cbl
  7502           DFHEIV99,
  7503           CNTL-KEY,
  7504           DFHEIV99,
  7505           DFHEIV99,
  7506           DFHEIV99
  7507     SET ADDRESS OF CONTROL-FILE TO
  7508         DFHEIV20
  7509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7510             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7511
  7512     MOVE ER-0000                TO EMI-ERROR.
  7513     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7514
  7515     MOVE SPACE                  TO MAINTO.
  7516     MOVE -1                     TO MAINTL.
  7517     GO TO 8100-SEND-MAP.
  7518
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 136
* EL131.cbl
  7520 0100-UPDATE-PI.
  7521
  7522     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7523     IF WS-RETURNED-FROM = XCTL-EL114
  7524***sometimes there is crap in positions 7-10 when no code was sele
  7525        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7526          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7527        END-IF
  7528     END-IF.
  7529
  7530     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7531         GO TO 0110-UPDATE-UP.
  7532
  7533     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7534     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7535     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7536     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7537     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7538     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7539     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7540     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7541     GO TO 0120-UPDATE-PI-EXIT.
  7542
  7543 0110-UPDATE-UP.
  7544     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7545     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7546     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7547     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7548     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7549     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7550     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7551     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7552
  7553
  7554* EXEC CICS HANDLE CONDITION
  7555*         QIDERR    (0130-TS-ERROR)
  7556*         ITEMERR   (0130-TS-ERROR)
  7557*    END-EXEC.
  7558*    MOVE '"$N<                  ! # #00007496' TO DFHEIV0
  7559     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7561     MOVE X'2320233030303037343936' TO DFHEIV0(25:11)
  7562     CALL 'kxdfhei1' USING DFHEIV0
  7563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7564
  7565
  7566     IF WS-RETURNED-FROM = XCTL-EL114
  7567
  7568* EXEC CICS READQ TS
  7569*            QUEUE    (PI-KEY)
  7570*            INTO     (EL131AI)
  7571*            LENGTH   (MAP-LENGTH)
  7572*       END-EXEC
  7573*    MOVE '*$I    L              ''   #00007502' TO DFHEIV0
  7574     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7575     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7576     MOVE X'2020233030303037353032' TO DFHEIV0(25:11)
  7577     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 137
* EL131.cbl
  7578           PI-KEY,
  7579           EL131AI,
  7580           MAP-LENGTH,
  7581           DFHEIV99,
  7582           DFHEIV99,
  7583           DFHEIV99
  7584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7585
  7586        IF WS-SAVE-BENEFICIARY > SPACES
  7587            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7588            MOVE +10            TO BENEL
  7589            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7590        END-IF
  7591        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7592     END-IF.
  7593
  7594
  7595* EXEC CICS READQ TS
  7596*         QUEUE    (PI-KEY)
  7597*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7598*         LENGTH   (PI-COMM-LENGTH)
  7599*    END-EXEC.
  7600*    MOVE '*$I    L              ''   #00007516' TO DFHEIV0
  7601     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7602     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7603     MOVE X'2020233030303037353136' TO DFHEIV0(25:11)
  7604     CALL 'kxdfhei1' USING DFHEIV0,
  7605           PI-KEY,
  7606           PROGRAM-INTERFACE-BLOCK,
  7607           PI-COMM-LENGTH,
  7608           DFHEIV99,
  7609           DFHEIV99,
  7610           DFHEIV99
  7611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7612
  7613
  7614
  7615* EXEC CICS DELETEQ TS
  7616*         QUEUE    (PI-KEY)
  7617*    END-EXEC.
  7618*    MOVE '*&                    #   #00007522' TO DFHEIV0
  7619     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7620     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7621     MOVE X'2020233030303037353232' TO DFHEIV0(25:11)
  7622     CALL 'kxdfhei1' USING DFHEIV0,
  7623           PI-KEY,
  7624           DFHEIV99
  7625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7626
  7627
  7628 0120-UPDATE-PI-EXIT.
  7629     EXIT.
  7630
  7631 0130-TS-ERROR.
  7632     MOVE LOW-VALUES             TO EL131AO.
  7633     MOVE ER-0192                TO EMI-ERROR.
  7634
  7635     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 138
* EL131.cbl
  7636
  7637     GO TO 8100-SEND-MAP.
  7638
  7639 0200-TRANS-PF.
  7640     IF EIBAID NOT = DFHENTER
  7641         MOVE 'X'                TO ERROR-SWITCH
  7642         GO TO 0210-EXIT.
  7643
  7644     IF PFKEYI NOT NUMERIC
  7645         MOVE 'X'                TO ERROR-SWITCH
  7646         GO TO 0210-EXIT.
  7647
  7648     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7649
  7650     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7651         MOVE 'X' TO ERROR-SWITCH
  7652         GO TO 0210-EXIT.
  7653
  7654     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7655
  7656 0210-EXIT.
  7657     EXIT.
  7658
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 139
* EL131.cbl
  7660 0500-ADD-ALPHA-ONLY.
  7661******************************************************************
  7662*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7663*    RECORD.                                                     *
  7664******************************************************************
  7665
  7666     IF MLNAMEL = +0 AND
  7667        MFNAMEL = +0 AND
  7668        MMINITL = +0
  7669         MOVE ER-0797                TO  EMI-ERROR
  7670         MOVE -1                     TO  MAINTL
  7671         MOVE AL-UABON               TO  MAINTA
  7672         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7673         GO TO 8110-SEND-DATA.
  7674
  7675     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7676     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7677     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7678     MOVE PI-CERT-NO                 TO  CERT-NO.
  7679
  7680
  7681* EXEC CICS READ
  7682*        DATASET   (CLMS-FILE-ID)
  7683*        RIDFLD    (MSTR-KEY)
  7684*        SET       (ADDRESS OF CLAIM-MASTER)
  7685*    END-EXEC.
  7686*    MOVE '&"S        E          (   #00007578' TO DFHEIV0
  7687     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7689     MOVE X'2020233030303037353738' TO DFHEIV0(25:11)
  7690     CALL 'kxdfhei1' USING DFHEIV0,
  7691           CLMS-FILE-ID,
  7692           DFHEIV20,
  7693           DFHEIV99,
  7694           MSTR-KEY,
  7695           DFHEIV99,
  7696           DFHEIV99,
  7697           DFHEIV99
  7698     SET ADDRESS OF CLAIM-MASTER TO
  7699         DFHEIV20
  7700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7701
  7702
  7703
  7704* EXEC CICS GETMAIN
  7705*        SET       (ADDRESS OF ALPHA-INDEX)
  7706*        LENGTH    (ALPH-LENGTH)
  7707*        INITIMG   (GETMAIN-SPACE)
  7708*    END-EXEC.
  7709*    MOVE ',"IL                  $   #00007584' TO DFHEIV0
  7710     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7711     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7712     MOVE X'2020233030303037353834' TO DFHEIV0(25:11)
  7713     CALL 'kxdfhei1' USING DFHEIV0,
  7714           DFHEIV20,
  7715           ALPH-LENGTH,
  7716           GETMAIN-SPACE
  7717     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 140
* EL131.cbl
  7718         DFHEIV20
  7719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7720
  7721
  7722     MOVE 'AI'                       TO  AI-RECORD-ID.
  7723     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7724                                         AI-CL-COMPANY-CD.
  7725     MOVE 'C'                        TO  AI-SOURCE
  7726                                         AI-CL-SOURCE.
  7727
  7728     IF MLNAMEL IS GREATER THAN +0
  7729         MOVE MLNAMEI                TO  AI-LAST-NAME
  7730     ELSE
  7731         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7732
  7733     IF MFNAMEL IS GREATER THAN +0
  7734         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7735     ELSE
  7736         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7737
  7738     IF MMINITL IS GREATER THAN +0
  7739         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7740     ELSE
  7741         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7742
  7743     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7744     MOVE '5'                        TO  DC-OPTION-CODE.
  7745     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7746     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7747     IF BUILD-YEAR IS GREATER THAN 50
  7748         MOVE '19'                   TO  WS-ALPHA-YY-1
  7749         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7750         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7751         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7752     ELSE
  7753         MOVE '20'                   TO  WS-ALPHA-YY-1
  7754         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7755         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7756         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7757
  7758     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7759                                         AI-CL-DATE.
  7760
  7761     MOVE EIBTIME                    TO  AI-TIME
  7762                                         AI-CL-TIME.
  7763
  7764     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7765     MOVE 'C'                        TO  AI-CL-SOURCE.
  7766     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7767     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7768     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7769     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7770     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7771
  7772     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7773     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7774     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7775
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 141
* EL131.cbl
  7776
  7777* EXEC CICS WRITE
  7778*        DATASET   (ALPH-FILE-ID)
  7779*        RIDFLD    (AI-CONTROL-PRIMARY)
  7780*        FROM      (ALPHA-INDEX)
  7781*    END-EXEC.
  7782     MOVE LENGTH OF
  7783      ALPHA-INDEX
  7784       TO DFHEIV11
  7785*    MOVE '&$ L                  ''   #00007644' TO DFHEIV0
  7786     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7787     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7788     MOVE X'2020233030303037363434' TO DFHEIV0(25:11)
  7789     CALL 'kxdfhei1' USING DFHEIV0,
  7790           ALPH-FILE-ID,
  7791           ALPHA-INDEX,
  7792           DFHEIV11,
  7793           AI-CONTROL-PRIMARY,
  7794           DFHEIV99,
  7795           DFHEIV99
  7796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7797
  7798
  7799     MOVE LOW-VALUES                 TO  EL131AO.
  7800     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7801     MOVE ER-0000                    TO  EMI-ERROR.
  7802     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7803     MOVE -1                         TO  MAINTL.
  7804     GO TO 8100-SEND-MAP.
  7805
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 142
* EL131.cbl
  7807 0600-CHANGE-NAME.
  7808******************************************************************
  7809*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7810*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7811******************************************************************
  7812
  7813     IF MLNAMEL = +0 AND
  7814        MFNAMEL = +0 AND
  7815        MMINITL = +0
  7816         MOVE ER-0276                TO  EMI-ERROR
  7817         MOVE -1                     TO  MAINTL
  7818         MOVE AL-UABON               TO  MAINTA
  7819         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7820         GO TO 8110-SEND-DATA.
  7821
  7822     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7823     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7824     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7825     MOVE PI-CERT-NO                 TO  CERT-NO.
  7826
  7827
  7828* EXEC CICS READ
  7829*        DATASET   (CLMS-FILE-ID)
  7830*        RIDFLD    (MSTR-KEY)
  7831*        SET       (ADDRESS OF CLAIM-MASTER)
  7832*    END-EXEC.
  7833*    MOVE '&"S        E          (   #00007678' TO DFHEIV0
  7834     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7836     MOVE X'2020233030303037363738' TO DFHEIV0(25:11)
  7837     CALL 'kxdfhei1' USING DFHEIV0,
  7838           CLMS-FILE-ID,
  7839           DFHEIV20,
  7840           DFHEIV99,
  7841           MSTR-KEY,
  7842           DFHEIV99,
  7843           DFHEIV99,
  7844           DFHEIV99
  7845     SET ADDRESS OF CLAIM-MASTER TO
  7846         DFHEIV20
  7847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7848
  7849
  7850
  7851* EXEC CICS GETMAIN
  7852*        SET       (ADDRESS OF ALPHA-INDEX)
  7853*        LENGTH    (ALPH-LENGTH)
  7854*        INITIMG   (GETMAIN-SPACE)
  7855*    END-EXEC.
  7856*    MOVE ',"IL                  $   #00007684' TO DFHEIV0
  7857     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7858     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7859     MOVE X'2020233030303037363834' TO DFHEIV0(25:11)
  7860     CALL 'kxdfhei1' USING DFHEIV0,
  7861           DFHEIV20,
  7862           ALPH-LENGTH,
  7863           GETMAIN-SPACE
  7864     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 143
* EL131.cbl
  7865         DFHEIV20
  7866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7867
  7868
  7869     MOVE 'AI'                       TO  AI-RECORD-ID.
  7870     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7871                                         AI-CL-COMPANY-CD.
  7872     MOVE 'C'                        TO  AI-SOURCE
  7873                                         AI-CL-SOURCE.
  7874
  7875     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7876     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7877     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7878
  7879     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7880     MOVE '5'                        TO  DC-OPTION-CODE.
  7881     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7882     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7883     IF BUILD-YEAR IS GREATER THAN 50
  7884         MOVE '19'                   TO  WS-ALPHA-YY-1
  7885         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7886         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7887         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7888     ELSE
  7889         MOVE '20'                   TO  WS-ALPHA-YY-1
  7890         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7891         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7892         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7893
  7894     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7895                                         AI-CL-DATE.
  7896
  7897     MOVE EIBTIME                    TO  AI-TIME
  7898                                         AI-CL-TIME.
  7899
  7900     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7901     MOVE 'C'                        TO  AI-CL-SOURCE.
  7902     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7903     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7904     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7905     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7906     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7907
  7908     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7909     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7910     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7911
  7912     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7913         MOVE 'Y'                TO CL-YESNOSW
  7914     END-IF.
  7915
  7916
  7917* EXEC CICS WRITE
  7918*        DATASET   (ALPH-FILE-ID)
  7919*        RIDFLD    (AI-CONTROL-PRIMARY)
  7920*        FROM      (ALPHA-INDEX)
  7921*    END-EXEC.
  7922     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 144
* EL131.cbl
  7923      ALPHA-INDEX
  7924       TO DFHEIV11
  7925*    MOVE '&$ L                  ''   #00007737' TO DFHEIV0
  7926     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7927     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7928     MOVE X'2020233030303037373337' TO DFHEIV0(25:11)
  7929     CALL 'kxdfhei1' USING DFHEIV0,
  7930           ALPH-FILE-ID,
  7931           ALPHA-INDEX,
  7932           DFHEIV11,
  7933           AI-CONTROL-PRIMARY,
  7934           DFHEIV99,
  7935           DFHEIV99
  7936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7937
  7938
  7939
  7940* EXEC CICS READ
  7941*        DATASET   (CLMS-FILE-ID)
  7942*        RIDFLD    (MSTR-KEY)
  7943*        SET       (ADDRESS OF CLAIM-MASTER)
  7944*        UPDATE
  7945*    END-EXEC.
  7946*    MOVE '&"S        EU         (   #00007743' TO DFHEIV0
  7947     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7948     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7949     MOVE X'2020233030303037373433' TO DFHEIV0(25:11)
  7950     CALL 'kxdfhei1' USING DFHEIV0,
  7951           CLMS-FILE-ID,
  7952           DFHEIV20,
  7953           DFHEIV99,
  7954           MSTR-KEY,
  7955           DFHEIV99,
  7956           DFHEIV99,
  7957           DFHEIV99
  7958     SET ADDRESS OF CLAIM-MASTER TO
  7959         DFHEIV20
  7960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7961
  7962
  7963     if (cl-priority-cd = '8')
  7964        and (pi-processor-id not = 'PEMA'and 'JMS '
  7965             AND 'AMWA' AND 'KMSB')
  7966        MOVE ER-8003             TO EMI-ERROR
  7967        PERFORM 9900-ERROR-FORMAT
  7968                                 THRU 9900-EXIT
  7969        MOVE -1                  TO MAINTL
  7970        GO TO 8110-SEND-DATA
  7971     end-if
  7972
  7973     IF MLNAMEL IS GREATER THAN +0
  7974         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  7975
  7976     IF MFNAMEL IS GREATER THAN +0
  7977         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  7978
  7979     IF MMINITL IS GREATER THAN +0
  7980         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 145
* EL131.cbl
  7981
  7982     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  7983     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  7984     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  7985     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  7986
  7987     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7988         MOVE 'Y'                TO CL-YESNOSW
  7989     END-IF.
  7990
  7991
  7992* EXEC CICS HANDLE CONDITION
  7993*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  7994*    END-EXEC.
  7995*    MOVE '"$$                   ! $ #00007778' TO DFHEIV0
  7996     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  7997     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7998     MOVE X'2420233030303037373738' TO DFHEIV0(25:11)
  7999     CALL 'kxdfhei1' USING DFHEIV0
  8000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8001
  8002
  8003
  8004* EXEC CICS REWRITE
  8005*        DATASET   (CLMS-FILE-ID)
  8006*        FROM      (CLAIM-MASTER)
  8007*    END-EXEC.
  8008     MOVE LENGTH OF
  8009      CLAIM-MASTER
  8010       TO DFHEIV11
  8011*    MOVE '&& L                  %   #00007782' TO DFHEIV0
  8012     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8013     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8014     MOVE X'2020233030303037373832' TO DFHEIV0(25:11)
  8015     CALL 'kxdfhei1' USING DFHEIV0,
  8016           CLMS-FILE-ID,
  8017           CLAIM-MASTER,
  8018           DFHEIV11,
  8019           DFHEIV99
  8020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8021
  8022
  8023 0600-CONTINUE-NAME-UPDATE.
  8024
  8025     MOVE LOW-VALUES                 TO  EL131AO.
  8026     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8027     MOVE ER-0000                    TO  EMI-ERROR.
  8028     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8029     MOVE -1                         TO  MAINTL.
  8030     GO TO 8100-SEND-MAP.
  8031
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 146
* EL131.cbl
  8033 1000-EDIT-SCREEN.
  8034
  8035     MOVE MAINTI                 TO CHECK-MAINT.
  8036
  8037     IF NOT VALID-OPTIONS
  8038         MOVE 'X'                TO ERROR-SWITCH
  8039         MOVE -1                 TO MAINTL
  8040         MOVE AL-UABON           TO MAINTA
  8041         MOVE ER-0023            TO EMI-ERROR
  8042         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8043         GO TO 1010-EXIT.
  8044
  8045     IF NOT MODIFY-CAP
  8046         MOVE 'UPDATE'           TO  SM-READ
  8047         PERFORM 9995-SECURITY-VIOLATION
  8048         MOVE ER-0070               TO  EMI-ERROR
  8049         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8050         GO TO 8100-SEND-MAP.
  8051
  8052     IF DELETE-CLAIM
  8053         MOVE AL-UANON TO MAINTA
  8054         GO TO 1010-EXIT.
  8055
  8056     MOVE AL-UANON               TO MAINTA.
  8057
  8058     IF CCNOI GREATER THAN LOW-VALUES
  8059         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8060
  8061     IF PI-COMPANY-ID = 'CSL'
  8062        CONTINUE
  8063     ELSE
  8064        IF TYPEL > ZERO
  8065           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8066              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8067                    PI-LIFE-OVERRIDE-L1))
  8068                       OR
  8069              ((PI-COMPANY-ID = 'DCC')
  8070              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8071                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  8072              MOVE AL-UANON      TO TYPEA
  8073              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8074           ELSE
  8075              MOVE ER-0199       TO EMI-ERROR
  8076              PERFORM 9900-ERROR-FORMAT
  8077                                 THRU 9900-EXIT
  8078              MOVE AL-UABON      TO TYPEA
  8079              MOVE -1            TO TYPEL
  8080              MOVE 'X'           TO ERROR-SWITCH
  8081           END-IF
  8082        ELSE
  8083           MOVE AL-UANOF         TO TYPEA
  8084        END-IF
  8085     END-IF
  8086     IF STATUSI GREATER THAN LOW-VALUES
  8087         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8088             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8089             MOVE AL-UANON       TO STATUSA
  8090             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 147
* EL131.cbl
  8091             MOVE 'Y'            TO DLYACTV-SW
  8092         ELSE
  8093             MOVE ER-0333        TO EMI-ERROR
  8094             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8095             MOVE AL-UABON       TO STATUSA
  8096             MOVE -1             TO STATUSL
  8097             MOVE 'X'            TO ERROR-SWITCH
  8098         END-IF
  8099     ELSE
  8100         MOVE SPACE              TO TRLR-SWITCH
  8101         MOVE 'N'                TO DLYACTV-SW
  8102         MOVE AL-UANOF           TO STATUSA.
  8103
  8104     IF PROCI GREATER THAN LOW-VALUES
  8105         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8106     ELSE
  8107         MOVE AL-UANOF TO PROCA.
  8108
  8109     IF SEXI GREATER THAN LOW-VALUES
  8110         IF SEXI = 'F' OR 'M'
  8111             MOVE AL-UANON       TO SEXA
  8112             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8113           ELSE
  8114             MOVE ER-0219        TO EMI-ERROR
  8115             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8116             MOVE AL-UABON       TO SEXA
  8117             MOVE -1             TO SEXL
  8118             MOVE 'X'            TO ERROR-SWITCH
  8119       ELSE
  8120         MOVE AL-UANOF           TO SEXA.
  8121
  8122     IF BIRTHL = +0
  8123         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8124         MOVE AL-UANOF           TO  BIRTHA
  8125         GO TO 1000-CONTINUE-EDITS.
  8126
  8127     IF BIRTHI = SPACES
  8128         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8129         MOVE 'X'                TO  UPDATE-SWITCH
  8130                                     MSTR-SWITCH
  8131         GO TO 1000-CONTINUE-EDITS.
  8132
  8133     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8134     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8135     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8136     MOVE '4'                    TO  DC-OPTION-CODE.
  8137     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8138     IF DATE-CONVERSION-ERROR
  8139         MOVE ER-0220            TO  EMI-ERROR
  8140         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8141         MOVE AL-UABON           TO  BIRTHA
  8142         MOVE -1                 TO  BIRTHL
  8143         MOVE 'X'                TO  ERROR-SWITCH
  8144         GO TO 1000-CONTINUE-EDITS.
  8145
  8146******************************************************************
  8147**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8148**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 148
* EL131.cbl
  8149**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8150******************************************************************
  8151     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8152         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8153         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8154         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8155         MOVE '4'                TO  DC-OPTION-CODE
  8156         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8157         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8158                                     DC-ELAPSED-DAYS
  8159         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8160         IF DATE-CONVERSION-ERROR
  8161             MOVE ER-0220        TO  EMI-ERROR
  8162             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8163             MOVE AL-UABON       TO  BIRTHA
  8164             MOVE -1             TO  BIRTHL
  8165             MOVE 'X'            TO  ERROR-SWITCH
  8166             GO TO 1000-CONTINUE-EDITS.
  8167
  8168     MOVE AL-UANON               TO  BIRTHA.
  8169     MOVE 'X'                    TO  UPDATE-SWITCH
  8170                                     MSTR-SWITCH.
  8171     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8172     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8173     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8174
  8175 1000-CONTINUE-EDITS.
  8176
  8177     IF SOCIALI GREATER THAN LOW-VALUES
  8178         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8179         IF WS-SOC-SEC-NO NUMERIC AND
  8180           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8181             NEXT SENTENCE
  8182         ELSE
  8183            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8184               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8185               WS-SSN-DASH2 = '-'
  8186                 NEXT SENTENCE
  8187            ELSE
  8188                 MOVE ER-0887        TO  EMI-ERROR
  8189                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8190                 MOVE AL-UABON       TO  SOCIALA
  8191                 MOVE -1             TO  SOCIALL
  8192                 MOVE 'X'            TO  ERROR-SWITCH
  8193            END-IF
  8194        END-IF
  8195     END-IF.
  8196
  8197     IF SOCIALI GREATER THAN LOW-VALUES
  8198         MOVE AL-UANON           TO SOCIALA
  8199         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8200     ELSE
  8201         MOVE AL-UANOF           TO SOCIALA.
  8202
  8203     IF OCCI GREATER THAN LOW-VALUES
  8204         MOVE AL-UANON           TO OCCA
  8205         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8206     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 149
* EL131.cbl
  8207         MOVE AL-UANOF           TO OCCA.
  8208
  8209     IF BENEL NOT GREATER THAN ZERO
  8210            GO TO 1005-CONTINUE-EDITS.
  8211
  8212     IF BENEI = SPACES
  8213        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8214           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8215           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8216           IF AUTO-PAY-TO-BENE = 'Y'
  8217               MOVE ER-1773      TO  EMI-ERROR
  8218               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8219               MOVE 'X'          TO ERROR-SWITCH
  8220               MOVE AL-UABON     TO BENEA
  8221               MOVE -1           TO BENEL
  8222           ELSE
  8223               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8224           END-IF
  8225        ELSE
  8226           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8227        END-IF
  8228        GO TO 1005-CONTINUE-EDITS.
  8229
  8230
  8231* EXEC CICS HANDLE CONDITION
  8232*        NOTFND (1004-BENE-NOT-FOUND)
  8233*    END-EXEC.
  8234*    MOVE '"$I                   ! % #00007994' TO DFHEIV0
  8235     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8237     MOVE X'2520233030303037393934' TO DFHEIV0(25:11)
  8238     CALL 'kxdfhei1' USING DFHEIV0
  8239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8240
  8241
  8242     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8243     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8244     MOVE BENEI                  TO  WS-ELBENE-ID.
  8245
  8246
  8247* EXEC CICS READ
  8248*        DATASET ('ELBENE')
  8249*        RIDFLD  (WS-ELBENE-KEY)
  8250*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8251*    END-EXEC.
  8252     MOVE 'ELBENE' TO DFHEIV1
  8253*    MOVE '&"S        E          (   #00008002' TO DFHEIV0
  8254     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8256     MOVE X'2020233030303038303032' TO DFHEIV0(25:11)
  8257     CALL 'kxdfhei1' USING DFHEIV0,
  8258           DFHEIV1,
  8259           DFHEIV20,
  8260           DFHEIV99,
  8261           WS-ELBENE-KEY,
  8262           DFHEIV99,
  8263           DFHEIV99,
  8264           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 150
* EL131.cbl
  8265     SET ADDRESS OF BENEFICIARY-MASTER TO
  8266         DFHEIV20
  8267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8268
  8269
  8270     MOVE AL-UANON               TO  BENEA.
  8271     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8272
  8273     GO TO 1005-CONTINUE-EDITS.
  8274
  8275 1004-BENE-NOT-FOUND.
  8276     MOVE ER-0565                TO  EMI-ERROR.
  8277
  8278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8279     MOVE 'X'                    TO ERROR-SWITCH.
  8280     MOVE AL-UABON               TO BENEA.
  8281     MOVE -1                     TO BENEL.
  8282
  8283 1005-CONTINUE-EDITS.
  8284
  8285     IF DIAGI GREATER THAN LOW-VALUES
  8286         MOVE AL-UANON           TO DIAGA
  8287         MOVE 'X'                TO UPDATE-SWITCH
  8288                                    NINETY-TRLR-SWITCH
  8289     ELSE
  8290         MOVE AL-UANOF           TO DIAGA.
  8291
  8292     IF CAUSEI GREATER THAN LOW-VALUES
  8293         MOVE AL-UANON           TO CAUSEA
  8294         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8295     ELSE
  8296         MOVE AL-UANOF           TO CAUSEA.
  8297
  8298     IF ENDL GREATER THAN ZERO
  8299         MOVE LOW-VALUES         TO HOLD-END
  8300         IF ENDI = SPACES
  8301             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8302         ELSE
  8303             MOVE ENDI           TO DEEDIT-DATE-INPUT
  8304
  8305* EXEC CICS BIF DEEDIT
  8306*                FIELD    (DEEDIT-DATE-INPUT)
  8307*                LENGTH   (DATE-LENGTH)
  8308*            END-EXEC
  8309*    MOVE '@"L                   #   #00008042' TO DFHEIV0
  8310     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8311     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8312     MOVE X'2020233030303038303432' TO DFHEIV0(25:11)
  8313     CALL 'kxdfhei1' USING DFHEIV0,
  8314           DEEDIT-DATE-INPUT,
  8315           DATE-LENGTH
  8316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8317             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8318             MOVE '4'            TO DC-OPTION-CODE
  8319             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8320             IF NOT DATE-CONVERSION-ERROR
  8321                 MOVE DC-BIN-DATE-1      TO HOLD-END
  8322                 MOVE AL-UANON   TO ENDA
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 151
* EL131.cbl
  8323                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8324                 MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8325             ELSE
  8326                 MOVE ER-0224    TO EMI-ERROR
  8327                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8328                 MOVE AL-UABON   TO ENDA
  8329                 MOVE -1         TO ENDL
  8330                 MOVE 'X'        TO ERROR-SWITCH
  8331       ELSE
  8332           MOVE AL-UANOF         TO ENDA.
  8333
  8334     IF INCL GREATER THAN ZERO
  8335         MOVE LOW-VALUES         TO HOLD-INCUR
  8336         IF INCI = SPACES
  8337             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8338         ELSE
  8339             MOVE INCI           TO DEEDIT-DATE-INPUT
  8340
  8341* EXEC CICS BIF DEEDIT
  8342*                FIELD    (DEEDIT-DATE-INPUT)
  8343*                LENGTH   (DATE-LENGTH)
  8344*            END-EXEC
  8345*    MOVE '@"L                   #   #00008069' TO DFHEIV0
  8346     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8347     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8348     MOVE X'2020233030303038303639' TO DFHEIV0(25:11)
  8349     CALL 'kxdfhei1' USING DFHEIV0,
  8350           DEEDIT-DATE-INPUT,
  8351           DATE-LENGTH
  8352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8353             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8354             MOVE '4'            TO DC-OPTION-CODE
  8355             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8356             IF NOT DATE-CONVERSION-ERROR
  8357                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8358                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8359                 MOVE AL-UANON           TO INCA
  8360                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8361             ELSE
  8362                 MOVE ER-0222    TO EMI-ERROR
  8363                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8364                 MOVE AL-UABON   TO INCA
  8365                 MOVE -1         TO INCL
  8366                 MOVE 'X'        TO ERROR-SWITCH
  8367       ELSE
  8368           IF PI-NO-PMTS = ZEROS
  8369               MOVE AL-UANOF     TO INCA.
  8370
  8371     IF REPL GREATER THAN ZERO
  8372         MOVE LOW-VALUES         TO HOLD-REPORTED
  8373         IF REPI = SPACES
  8374             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8375         ELSE
  8376             MOVE REPI           TO DEEDIT-DATE-INPUT
  8377
  8378* EXEC CICS BIF DEEDIT
  8379*                FIELD    (DEEDIT-DATE-INPUT)
  8380*                LENGTH   (DATE-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 152
* EL131.cbl
  8381*            END-EXEC
  8382*    MOVE '@"L                   #   #00008097' TO DFHEIV0
  8383     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8384     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8385     MOVE X'2020233030303038303937' TO DFHEIV0(25:11)
  8386     CALL 'kxdfhei1' USING DFHEIV0,
  8387           DEEDIT-DATE-INPUT,
  8388           DATE-LENGTH
  8389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8390             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8391             MOVE '4'            TO DC-OPTION-CODE
  8392             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8393             IF NOT DATE-CONVERSION-ERROR
  8394                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8395                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8396                 MOVE AL-UANON   TO REPA
  8397                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8398             ELSE
  8399                 MOVE ER-0223    TO EMI-ERROR
  8400                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8401                 MOVE AL-UABON   TO REPA
  8402                 MOVE -1         TO REPL
  8403                 MOVE 'X'        TO ERROR-SWITCH
  8404       ELSE
  8405         MOVE AL-UANOF TO REPA.
  8406
  8407     IF PDTHRUI GREATER THAN LOW-VALUES
  8408        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8409        IF PDTHRUI = SPACES
  8410           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8411        ELSE
  8412           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8413
  8414* EXEC CICS BIF DEEDIT
  8415*               FIELD    (DEEDIT-DATE-INPUT)
  8416*               LENGTH   (DATE-LENGTH)
  8417*          END-EXEC
  8418*    MOVE '@"L                   #   #00008124' TO DFHEIV0
  8419     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8420     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8421     MOVE X'2020233030303038313234' TO DFHEIV0(25:11)
  8422     CALL 'kxdfhei1' USING DFHEIV0,
  8423           DEEDIT-DATE-INPUT,
  8424           DATE-LENGTH
  8425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8426           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8427           MOVE '4'            TO DC-OPTION-CODE
  8428           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8429           IF NOT DATE-CONVERSION-ERROR
  8430              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8431              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8432              MOVE AL-UANON   TO PDTHRUA
  8433              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8434              IF PI-USES-PAID-TO
  8435                 MOVE '6'            TO DC-OPTION-CODE
  8436                 MOVE -1             TO DC-ELAPSED-DAYS
  8437                 MOVE +0             TO DC-ELAPSED-MONTHS
  8438                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 153
* EL131.cbl
  8439                 IF NO-CONVERSION-ERROR
  8440                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8441                 ELSE
  8442                    NEXT SENTENCE
  8443              ELSE
  8444                 NEXT SENTENCE
  8445           ELSE
  8446              MOVE ER-0475    TO EMI-ERROR
  8447              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8448              MOVE AL-UABON   TO PDTHRUA
  8449              MOVE -1         TO PDTHRUL
  8450              MOVE 'X'        TO ERROR-SWITCH
  8451     ELSE
  8452        IF MODIFY-CAP
  8453           MOVE AL-UANOF        TO PDTHRUA.
  8454
  8455     IF PDAMTL GREATER THAN +0
  8456         MOVE ZEROS              TO HOLD-PDAMT
  8457
  8458* EXEC CICS BIF DEEDIT
  8459*            FIELD    (PDAMTI)
  8460*            LENGTH   (9)
  8461*        END-EXEC
  8462     MOVE 9
  8463       TO DFHEIV11
  8464*    MOVE '@"L                   #   #00008159' TO DFHEIV0
  8465     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8466     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8467     MOVE X'2020233030303038313539' TO DFHEIV0(25:11)
  8468     CALL 'kxdfhei1' USING DFHEIV0,
  8469           PDAMTI,
  8470           DFHEIV11
  8471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8472         IF PDAMTI NUMERIC
  8473             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8474             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8475             MOVE AL-UNNON       TO PDAMTA
  8476         ELSE
  8477             MOVE ER-0547        TO EMI-ERROR
  8478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8479             MOVE AL-UNBON       TO PDAMTA
  8480             MOVE -1             TO PDAMTL
  8481             MOVE 'X'            TO ERROR-SWITCH
  8482     ELSE
  8483         IF MODIFY-CAP
  8484            MOVE AL-UNNOF        TO PDAMTA.
  8485
  8486     IF NODAYSI GREATER THAN LOW-VALUES
  8487         MOVE ZEROS              TO HOLD-NODAYS
  8488
  8489* EXEC CICS BIF DEEDIT
  8490*            FIELD (NODAYSI)
  8491*            LENGTH (5)
  8492*        END-EXEC
  8493     MOVE 5
  8494       TO DFHEIV11
  8495*    MOVE '@"L                   #   #00008179' TO DFHEIV0
  8496     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 154
* EL131.cbl
  8497     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8498     MOVE X'2020233030303038313739' TO DFHEIV0(25:11)
  8499     CALL 'kxdfhei1' USING DFHEIV0,
  8500           NODAYSI,
  8501           DFHEIV11
  8502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8503         IF NODAYSI NUMERIC
  8504             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8505             MOVE AL-UNNON       TO NODAYSA
  8506             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8507         ELSE
  8508             MOVE ER-0491        TO EMI-ERROR
  8509             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8510             MOVE AL-UNBON       TO NODAYSA
  8511             MOVE -1             TO NODAYSL
  8512             MOVE 'X'            TO ERROR-SWITCH
  8513     ELSE
  8514         IF MODIFY-CAP
  8515            MOVE AL-UNNOF        TO NODAYSA.
  8516
  8517     IF NOPMTSI GREATER THAN LOW-VALUES
  8518         MOVE ZEROS              TO HOLD-NOPMTS
  8519
  8520* EXEC CICS BIF DEEDIT
  8521*            FIELD (NOPMTSI)
  8522*            LENGTH (4)
  8523*        END-EXEC
  8524     MOVE 4
  8525       TO DFHEIV11
  8526*    MOVE '@"L                   #   #00008199' TO DFHEIV0
  8527     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8528     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8529     MOVE X'2020233030303038313939' TO DFHEIV0(25:11)
  8530     CALL 'kxdfhei1' USING DFHEIV0,
  8531           NOPMTSI,
  8532           DFHEIV11
  8533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8534         IF NOPMTSI NUMERIC
  8535             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8536             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8537             MOVE AL-UNNON       TO NOPMTSA
  8538           ELSE
  8539             MOVE ER-0548        TO EMI-ERROR
  8540             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8541             MOVE AL-UNBON       TO NOPMTSA
  8542             MOVE -1             TO NOPMTSL
  8543             MOVE 'X'            TO ERROR-SWITCH
  8544       ELSE
  8545         IF MODIFY-CAP
  8546            MOVE AL-UNNOF        TO NOPMTSA.
  8547
  8548     IF FORMTYPI GREATER THAN LOW-VALUES
  8549         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8550             MOVE AL-UANON       TO FORMTYPA
  8551             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8552           ELSE
  8553             MOVE ER-7650        TO EMI-ERROR
  8554             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 155
* EL131.cbl
  8555             MOVE AL-UABON       TO FORMTYPA
  8556             MOVE -1             TO FORMTYPL
  8557             MOVE 'X'            TO ERROR-SWITCH
  8558       ELSE
  8559         MOVE AL-UANOF           TO FORMTYPA.
  8560
  8561     IF PRICDL GREATER THAN ZERO
  8562         IF (PRICDI = ' ') OR
  8563            (PRICDI GREATER THAN ZERO   AND
  8564             PRICDI NOT GREATER THAN '9')
  8565             MOVE AL-UANON       TO PRICDA
  8566             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8567         ELSE
  8568             MOVE ER-0274        TO EMI-ERROR
  8569             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8570             MOVE AL-UABON       TO PRICDA
  8571             MOVE -1             TO PRICDL
  8572             MOVE 'X'            TO ERROR-SWITCH
  8573     ELSE
  8574         MOVE AL-UANOF TO PRICDA.
  8575
  8576     IF PI-COMPANY-ID = 'DMD'
  8577     IF PRICDL GREATER THAN ZERO
  8578       IF SYSTEM-MODIFY-CAP  OR
  8579          PI-PROCESSOR-ID = 'LGXX'
  8580             NEXT SENTENCE
  8581           ELSE
  8582            IF CL-PRIORITY-CD = '9'  OR
  8583               PRICDI         = '9'
  8584                  MOVE ER-0938        TO EMI-ERROR
  8585                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8586                  MOVE AL-UABON       TO PRICDA
  8587                  MOVE -1             TO PRICDL
  8588                  MOVE 'X'            TO ERROR-SWITCH.
  8589
  8590     IF FILETOL GREATER THAN ZERO
  8591         MOVE AL-UANON           TO FILETOA
  8592         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8593     ELSE
  8594         MOVE AL-UANOF TO FILETOA.
  8595
  8596     IF SUPVL GREATER THAN ZERO
  8597         IF SUPVI = 'Y' OR 'N' OR SPACE
  8598             MOVE AL-UANON       TO SUPVA
  8599             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8600         ELSE
  8601             MOVE ER-0230        TO EMI-ERROR
  8602             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8603             MOVE AL-UABON       TO SUPVA
  8604             MOVE -1             TO SUPVL
  8605             MOVE 'X'            TO ERROR-SWITCH
  8606     ELSE
  8607         MOVE AL-UANOF           TO SUPVA.
  8608
  8609     IF MLNAMEL GREATER THAN ZERO
  8610         IF MLNAMEI GREATER THAN SPACES
  8611            MOVE AL-UANON        TO MLNAMEA
  8612            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 156
* EL131.cbl
  8613                                     MSTR-KEY-SWITCH
  8614         ELSE
  8615            MOVE ER-0236         TO EMI-ERROR
  8616            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8617            MOVE AL-UABON        TO MLNAMEA
  8618            MOVE -1              TO MLNAMEL
  8619            MOVE 'X'             TO ERROR-SWITCH
  8620     ELSE
  8621         MOVE AL-UANOF           TO MLNAMEA.
  8622
  8623     IF MFNAMEI GREATER THAN LOW-VALUES
  8624         MOVE AL-UANON           TO MFNAMEA
  8625         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8626     ELSE
  8627         MOVE AL-UANOF           TO MFNAMEA.
  8628
  8629     IF MMINITI GREATER THAN LOW-VALUES
  8630         MOVE AL-UANON           TO MMINITA
  8631         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8632     ELSE
  8633         MOVE AL-UANOF           TO MMINITA.
  8634
  8635     IF CRTLNMEI GREATER THAN LOW-VALUES
  8636         IF CRTLNMEI NOT = SPACES
  8637            MOVE AL-UANON        TO CRTLNMEA
  8638            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8639                                     CERT-KEY-SWITCH
  8640        ELSE
  8641            MOVE ER-0236         TO EMI-ERROR
  8642            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8643            MOVE AL-UABON        TO CRTLNMEA
  8644            MOVE -1              TO CRTLNMEL
  8645            MOVE 'X'             TO ERROR-SWITCH
  8646     ELSE
  8647         MOVE AL-UANOF           TO CRTLNMEA.
  8648
  8649     IF CRTFNMEI GREATER THAN LOW-VALUES
  8650         MOVE AL-UANON           TO CRTFNMEA
  8651         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8652     ELSE
  8653         MOVE AL-UANOF           TO CRTFNMEA.
  8654
  8655     IF CRTINITI GREATER THAN LOW-VALUES
  8656         MOVE AL-UANON           TO CRTINITA
  8657         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8658     ELSE
  8659         MOVE AL-UANOF           TO CRTINITA.
  8660
  8661     IF ISSAGEL GREATER THAN ZERO
  8662         IF ISSAGEI NUMERIC
  8663            MOVE AL-UANON        TO ISSAGEA
  8664            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8665         ELSE
  8666            MOVE ER-0237         TO EMI-ERROR
  8667            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8668            MOVE AL-UABON        TO ISSAGEA
  8669            MOVE -1              TO ISSAGEL
  8670            MOVE 'X'             TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 157
* EL131.cbl
  8671     ELSE
  8672         MOVE AL-UANOF           TO ISSAGEA.
  8673
  8674     IF JNTFNMEI GREATER THAN LOW-VALUES
  8675         MOVE AL-UANON           TO JNTFNMEA
  8676         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8677     ELSE
  8678         MOVE AL-UANOF           TO JNTFNMEA.
  8679
  8680     IF JNTLNMEI GREATER THAN LOW-VALUES
  8681         MOVE AL-UANON           TO JNTLNMEA
  8682         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8683     ELSE
  8684         MOVE AL-UANOF           TO JNTLNMEA.
  8685
  8686     IF JNTINITI GREATER THAN LOW-VALUES
  8687         MOVE AL-UANON           TO JNTINITA
  8688         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8689     ELSE
  8690         MOVE AL-UANOF           TO JNTINITA.
  8691
  8692     IF JNTAGEL GREATER THAN ZERO
  8693         IF JNTAGEI NUMERIC
  8694            MOVE AL-UANON        TO JNTAGEA
  8695            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8696         ELSE
  8697            MOVE ER-0238         TO EMI-ERROR
  8698            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8699            MOVE AL-UABON        TO JNTAGEA
  8700            MOVE -1              TO JNTAGEL
  8701            MOVE 'X'             TO ERROR-SWITCH
  8702     ELSE
  8703         MOVE AL-UANOF           TO JNTAGEA.
  8704
  8705     IF ADDONDTI GREATER THAN LOW-VALUES
  8706         MOVE LOW-VALUES         TO HOLD-ADDON
  8707         IF ADDONDTI = SPACES
  8708             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8709         ELSE
  8710             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8711
  8712* EXEC CICS BIF DEEDIT
  8713*                FIELD    (DEEDIT-DATE-INPUT)
  8714*                LENGTH   (DATE-LENGTH)
  8715*            END-EXEC
  8716*    MOVE '@"L                   #   #00008380' TO DFHEIV0
  8717     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8718     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8719     MOVE X'2020233030303038333830' TO DFHEIV0(25:11)
  8720     CALL 'kxdfhei1' USING DFHEIV0,
  8721           DEEDIT-DATE-INPUT,
  8722           DATE-LENGTH
  8723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8724             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8725             MOVE '4'            TO DC-OPTION-CODE
  8726             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8727             IF NOT DATE-CONVERSION-ERROR
  8728                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 158
* EL131.cbl
  8729                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8730                                                  CERT-SWITCH
  8731                 MOVE AL-UANON   TO ADDONDTA
  8732                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8733             ELSE
  8734                 MOVE ER-7651    TO EMI-ERROR
  8735                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8736                 MOVE AL-UABON   TO ADDONDTA
  8737                 MOVE -1         TO ADDONDTL
  8738                 MOVE 'X'        TO ERROR-SWITCH
  8739       ELSE
  8740         MOVE AL-UANOF TO ADDONDTA.
  8741
  8742     IF LCVCDI GREATER THAN LOW-VALUES
  8743         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8744         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8745     ELSE
  8746         MOVE AL-UANOF           TO LCVCDA.
  8747
  8748     IF ACVCDI GREATER THAN LOW-VALUES
  8749         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8750         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8751     ELSE
  8752         MOVE AL-UANOF           TO ACVCDA.
  8753
  8754     IF LCVOTRMI GREATER THAN LOW-VALUES
  8755
  8756* EXEC CICS BIF DEEDIT
  8757*            FIELD (LCVOTRMI)
  8758*            LENGTH(3)
  8759*        END-EXEC
  8760     MOVE 3
  8761       TO DFHEIV11
  8762*    MOVE '@"L                   #   #00008415' TO DFHEIV0
  8763     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8764     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8765     MOVE X'2020233030303038343135' TO DFHEIV0(25:11)
  8766     CALL 'kxdfhei1' USING DFHEIV0,
  8767           LCVOTRMI,
  8768           DFHEIV11
  8769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8770         IF LCVOTRMI IS NUMERIC
  8771             MOVE LCVOTRMI       TO LCVOTRMO
  8772             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8773             MOVE AL-UANON       TO LCVOTRMA
  8774         ELSE
  8775             MOVE ER-0241        TO EMI-ERROR
  8776             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8777             MOVE AL-UNBON       TO LCVOTRMA
  8778             MOVE 'X'            TO ERROR-SWITCH
  8779             MOVE -1             TO LCVOTRML
  8780     ELSE
  8781         MOVE AL-UANOF           TO LCVOTRMA.
  8782
  8783     IF ACVOTRMI GREATER THAN LOW-VALUES
  8784
  8785* EXEC CICS BIF DEEDIT
  8786*            FIELD (ACVOTRMI)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 159
* EL131.cbl
  8787*            LENGTH(3)
  8788*        END-EXEC
  8789     MOVE 3
  8790       TO DFHEIV11
  8791*    MOVE '@"L                   #   #00008433' TO DFHEIV0
  8792     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8793     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8794     MOVE X'2020233030303038343333' TO DFHEIV0(25:11)
  8795     CALL 'kxdfhei1' USING DFHEIV0,
  8796           ACVOTRMI,
  8797           DFHEIV11
  8798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8799         IF ACVOTRMI IS NUMERIC
  8800             MOVE ACVOTRMI       TO ACVOTRMO
  8801             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8802             MOVE AL-UANON       TO ACVOTRMA
  8803         ELSE
  8804             MOVE ER-0241        TO EMI-ERROR
  8805             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8806             MOVE AL-UNBON       TO ACVOTRMA
  8807             MOVE 'X'            TO ERROR-SWITCH
  8808             MOVE -1             TO ACVOTRML
  8809     ELSE
  8810         MOVE AL-UANOF           TO ACVOTRMA.
  8811
  8812     IF LCVRATEL GREATER THAN +0
  8813
  8814* EXEC CICS BIF DEEDIT
  8815*            FIELD (LCVRATEI)
  8816*            LENGTH(6)
  8817*        END-EXEC
  8818     MOVE 6
  8819       TO DFHEIV11
  8820*    MOVE '@"L                   #   #00008451' TO DFHEIV0
  8821     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8822     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8823     MOVE X'2020233030303038343531' TO DFHEIV0(25:11)
  8824     CALL 'kxdfhei1' USING DFHEIV0,
  8825           LCVRATEI,
  8826           DFHEIV11
  8827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8828         IF LCVRATEI IS NUMERIC
  8829             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8830             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8831             MOVE AL-UNNON       TO LCVRATEA
  8832         ELSE
  8833             MOVE ER-2280        TO EMI-ERROR
  8834             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8835             MOVE AL-UNBON       TO LCVRATEA
  8836             MOVE 'X'            TO ERROR-SWITCH
  8837             MOVE -1             TO LCVRATEL
  8838     ELSE
  8839         MOVE AL-UNNOF           TO LCVRATEA.
  8840
  8841     IF ACVRATEL GREATER THAN +0
  8842
  8843* EXEC CICS BIF DEEDIT
  8844*            FIELD (ACVRATEI)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 160
* EL131.cbl
  8845*            LENGTH(6)
  8846*        END-EXEC
  8847     MOVE 6
  8848       TO DFHEIV11
  8849*    MOVE '@"L                   #   #00008469' TO DFHEIV0
  8850     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8851     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8852     MOVE X'2020233030303038343639' TO DFHEIV0(25:11)
  8853     CALL 'kxdfhei1' USING DFHEIV0,
  8854           ACVRATEI,
  8855           DFHEIV11
  8856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8857         IF ACVRATEI IS NUMERIC
  8858             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  8859             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8860             MOVE AL-UNNON       TO ACVRATEA
  8861         ELSE
  8862             MOVE ER-2280        TO EMI-ERROR
  8863             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8864             MOVE AL-UNBON       TO ACVRATEA
  8865             MOVE 'X'            TO ERROR-SWITCH
  8866             MOVE -1             TO ACVRATEL
  8867     ELSE
  8868         MOVE AL-UNNOF           TO ACVRATEA.
  8869
  8870     IF LCVBENEL GREATER THAN ZERO
  8871
  8872* EXEC CICS BIF DEEDIT
  8873*            FIELD (LCVBENEI)
  8874*            LENGTH (11)
  8875*        END-EXEC
  8876     MOVE 11
  8877       TO DFHEIV11
  8878*    MOVE '@"L                   #   #00008487' TO DFHEIV0
  8879     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8880     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8881     MOVE X'2020233030303038343837' TO DFHEIV0(25:11)
  8882     CALL 'kxdfhei1' USING DFHEIV0,
  8883           LCVBENEI,
  8884           DFHEIV11
  8885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8886         IF LCVBENEI IS NUMERIC
  8887            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8888            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8889            MOVE AL-UNNON        TO LCVBENEA
  8890         ELSE
  8891            MOVE ER-0243         TO EMI-ERROR
  8892            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8893            MOVE AL-UNBON        TO LCVBENEA
  8894            MOVE -1              TO LCVBENEL
  8895            MOVE 'X'             TO ERROR-SWITCH
  8896     ELSE
  8897         MOVE AL-UANOF           TO LCVBENEA.
  8898
  8899     IF ACVBENEL GREATER THAN ZERO
  8900
  8901* EXEC CICS BIF DEEDIT
  8902*            FIELD (ACVBENEI)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 161
* EL131.cbl
  8903*            LENGTH (11)
  8904*        END-EXEC
  8905     MOVE 11
  8906       TO DFHEIV11
  8907*    MOVE '@"L                   #   #00008505' TO DFHEIV0
  8908     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8909     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8910     MOVE X'2020233030303038353035' TO DFHEIV0(25:11)
  8911     CALL 'kxdfhei1' USING DFHEIV0,
  8912           ACVBENEI,
  8913           DFHEIV11
  8914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8915         IF ACVBENEI IS NUMERIC
  8916            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  8917            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8918            MOVE AL-UNNON        TO ACVBENEA
  8919         ELSE
  8920            MOVE ER-0243         TO EMI-ERROR
  8921            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8922            MOVE AL-UNBON        TO ACVBENEA
  8923            MOVE -1              TO ACVBENEL
  8924            MOVE 'X'             TO ERROR-SWITCH
  8925     ELSE
  8926         MOVE AL-UANOF           TO ACVBENEA.
  8927
  8928     IF LCVFORMI GREATER THAN LOW-VALUES
  8929        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8930        MOVE AL-UANON            TO LCVFORMA
  8931     ELSE
  8932        MOVE AL-UANOF            TO LCVFORMA.
  8933
  8934     IF ACVFORMI GREATER THAN LOW-VALUES
  8935        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8936        MOVE AL-UANON            TO ACVFORMA
  8937     ELSE
  8938        MOVE AL-UANOF            TO ACVFORMA.
  8939
  8940     IF LCVCNDTL GREATER THAN ZERO
  8941         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8942         IF LCVCNDTI = SPACES
  8943             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8944         ELSE
  8945             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  8946             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8947             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8948             MOVE '4'            TO DC-OPTION-CODE
  8949             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8950             IF NOT DATE-CONVERSION-ERROR
  8951                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  8952                 MOVE AL-UANON   TO LCVCNDTA
  8953                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8954                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  8955             ELSE
  8956                 MOVE ER-0246    TO EMI-ERROR
  8957                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8958                 MOVE AL-UABON   TO LCVCNDTA
  8959                 MOVE -1         TO LCVCNDTL
  8960                 MOVE 'X'        TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 162
* EL131.cbl
  8961     ELSE
  8962         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8963         MOVE AL-UANOF           TO LCVCNDTA.
  8964
  8965     IF ACVCNDTL GREATER THAN ZERO
  8966         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8967         IF ACVCNDTI = SPACES
  8968             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8969         ELSE
  8970             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  8971             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8972             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8973             MOVE '4'            TO DC-OPTION-CODE
  8974             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8975             IF NOT DATE-CONVERSION-ERROR
  8976                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  8977                 MOVE AL-UANON   TO ACVCNDTA
  8978                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8979                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  8980             ELSE
  8981                 MOVE ER-0246    TO EMI-ERROR
  8982                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8983                 MOVE AL-UABON   TO ACVCNDTA
  8984                 MOVE -1         TO ACVCNDTL
  8985                 MOVE 'X'        TO ERROR-SWITCH
  8986     ELSE
  8987         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8988         MOVE AL-UANOF           TO ACVCNDTA.
  8989
  8990     IF APRL GREATER THAN +0
  8991
  8992* EXEC CICS BIF DEEDIT
  8993*            FIELD    (APRI)
  8994*            LENGTH   (8)
  8995*        END-EXEC
  8996     MOVE 8
  8997       TO DFHEIV11
  8998*    MOVE '@"L                   #   #00008585' TO DFHEIV0
  8999     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9000     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9001     MOVE X'2020233030303038353835' TO DFHEIV0(25:11)
  9002     CALL 'kxdfhei1' USING DFHEIV0,
  9003           APRI,
  9004           DFHEIV11
  9005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9006         IF APRI NUMERIC
  9007            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9008            MOVE APRI            TO HOLD-APR APRO
  9009            MOVE AL-UANON        TO APRA
  9010          ELSE
  9011            MOVE ER-0259         TO EMI-ERROR
  9012            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9013            MOVE AL-UABON        TO APRA
  9014            MOVE -1              TO APRL
  9015            MOVE 'X'             TO ERROR-SWITCH
  9016     ELSE
  9017         MOVE AL-UANOF           TO APRA.
  9018
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 163
* EL131.cbl
  9019     IF PMTFREQL GREATER THAN ZERO
  9020
  9021* EXEC CICS BIF DEEDIT
  9022*            FIELD    (PMTFREQI)
  9023*            LENGTH   (2)
  9024*        END-EXEC
  9025     MOVE 2
  9026       TO DFHEIV11
  9027*    MOVE '@"L                   #   #00008603' TO DFHEIV0
  9028     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9029     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9030     MOVE X'2020233030303038363033' TO DFHEIV0(25:11)
  9031     CALL 'kxdfhei1' USING DFHEIV0,
  9032           PMTFREQI,
  9033           DFHEIV11
  9034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9035         IF PMTFREQI NUMERIC
  9036            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9037            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9038            MOVE AL-UANON        TO PMTFREQA
  9039          ELSE
  9040            MOVE ER-0427         TO EMI-ERROR
  9041            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9042            MOVE AL-UABON        TO PMTFREQA
  9043            MOVE -1              TO PMTFREQL
  9044            MOVE 'X'             TO ERROR-SWITCH
  9045     ELSE
  9046         MOVE AL-UANOF           TO PMTFREQA.
  9047
  9048     IF INDGRPL GREATER THAN ZERO
  9049         IF INDGRPI = 'I' OR 'G' OR SPACE
  9050             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9051             MOVE AL-UANON       TO INDGRPA
  9052          ELSE
  9053             MOVE ER-0260        TO EMI-ERROR
  9054             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9055             MOVE AL-UABON       TO INDGRPA
  9056             MOVE -1             TO INDGRPL
  9057             MOVE 'X'            TO ERROR-SWITCH
  9058     ELSE
  9059         MOVE AL-UANOF           TO INDGRPA.
  9060
  9061     IF PREMTYPL GREATER THAN ZERO
  9062         IF PREMTYPI = '1' OR '2' OR '3'
  9063            MOVE PREMTYPI        TO PI-PREM-TYPE
  9064            MOVE AL-UNNON        TO PREMTYPA
  9065            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9066          ELSE
  9067            MOVE ER-0227         TO EMI-ERROR
  9068            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9069            MOVE AL-UNBON        TO PREMTYPA
  9070            MOVE -1              TO PREMTYPL
  9071            MOVE 'X'             TO ERROR-SWITCH
  9072     ELSE
  9073         MOVE AL-UANOF           TO PREMTYPA.
  9074
  9075     IF LOANBALL GREATER THAN ZERO
  9076
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 164
* EL131.cbl
  9077* EXEC CICS BIF DEEDIT
  9078*             FIELD    (LOANBALI)
  9079*             LENGTH   (9)
  9080*        END-EXEC
  9081     MOVE 9
  9082       TO DFHEIV11
  9083*    MOVE '@"L                   #   #00008648' TO DFHEIV0
  9084     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9085     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9086     MOVE X'2020233030303038363438' TO DFHEIV0(25:11)
  9087     CALL 'kxdfhei1' USING DFHEIV0,
  9088           LOANBALI,
  9089           DFHEIV11
  9090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9091         IF LOANBALI NUMERIC
  9092             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9093             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9094             MOVE AL-UNNON TO LOANBALA
  9095         ELSE
  9096             MOVE ER-0639        TO EMI-ERROR
  9097             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9098             MOVE AL-UNBON       TO LOANBALA
  9099             MOVE -1             TO LOANBALL
  9100             MOVE 'X'            TO ERROR-SWITCH
  9101     ELSE
  9102         MOVE AL-UNNOF           TO LOANBALA.
  9103
  9104     IF LOANNOL GREATER THAN ZERO
  9105        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9106        MOVE AL-UANON            TO LOANNOA
  9107     ELSE
  9108        MOVE AL-UANOF            TO LOANNOA.
  9109
  9110     IF REINCDI GREATER THAN LOW-VALUES
  9111        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9112        MOVE AL-UANON            TO REINCDA
  9113     ELSE
  9114        MOVE AL-UANOF            TO REINCDA.
  9115
  9116     IF CERTI GREATER THAN LOW-VALUES
  9117         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9118     ELSE
  9119         MOVE AL-UANOF           TO CERTA.
  9120
  9121     IF CERTEFFI GREATER THAN LOW-VALUES
  9122         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9123     ELSE
  9124         MOVE AL-UANOF           TO CERTEFFA.
  9125
  9126     IF CERTACTI GREATER THAN LOW-VALUES
  9127         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9128     ELSE
  9129         MOVE AL-UANOF           TO CERTACTA.
  9130
  9131     IF CERTSTI GREATER THAN LOW-VALUES
  9132         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9133     ELSE
  9134         MOVE AL-UANOF           TO CERTSTA.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 165
* EL131.cbl
  9135
  9136     IF CERTCARI GREATER THAN LOW-VALUES
  9137         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9138     ELSE
  9139         MOVE AL-UANOF           TO CERTCARA.
  9140
  9141     IF DLYACTV-RECORD-NEEDED
  9142         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9143                 1150-EXIT
  9144     END-IF.
  9145
  9146     IF CERTEFFI GREATER LOW-VALUES OR
  9147        CERTACTI GREATER LOW-VALUES OR
  9148        CERTSTI  GREATER LOW-VALUES OR
  9149        CERTCARI GREATER LOW-VALUES OR
  9150        CERTGRPI GREATER LOW-VALUES
  9151        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9152
  9153*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9154*      IF PI-PREM-TYPE NOT = '1'  AND
  9155*         PI-NO-PMTS = ZEROS
  9156*          IF LOANBALL GREATER +0 OR
  9157*             ACVBENEL GREATER +0
  9158*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9159
  9160     if accswl > zeros
  9161        if accswi = 'Y' OR 'N'
  9162           MOVE 'X'              TO UPDATE-SWITCH
  9163                                    MSTR-SWITCH
  9164           MOVE AL-UANON         TO accswa
  9165        else
  9166           move er-1656          to emi-error
  9167           PERFORM 9900-ERROR-FORMAT
  9168                                 THRU 9900-EXIT
  9169           move al-uabon         to accswa
  9170           move -1               to accswl
  9171           move 'X'              to error-switch
  9172           move al-uanof         to accswa
  9173        end-if
  9174     end-if
  9175     IF CERTL = ZEROS AND
  9176        SUFXL = ZEROS
  9177          GO TO 1010-EXIT.
  9178
  9179     IF CERTL GREATER THAN ZEROS
  9180         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9181             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9182             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9183             MOVE 'X'            TO ERROR-SWITCH
  9184             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9185
  9186     IF SUFXL GREATER THAN ZEROS
  9187         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9188             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9189             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9190             MOVE 'X'            TO ERROR-SWITCH
  9191             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9192
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 166
* EL131.cbl
  9193 1010-EXIT.
  9194     EXIT.
  9195
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 167
* EL131.cbl
  9197 1120-EDIT-PROC.
  9198     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9199     MOVE '2'                    TO CNTL-REC-TYPE.
  9200     MOVE PROCI                  TO CNTL-PROC-ID.
  9201     MOVE ZERO                   TO CNTL-SEQ-NO.
  9202
  9203
  9204* EXEC CICS HANDLE CONDITION
  9205*         NOTFND    (1120-CNTL-NOTFND)
  9206*    END-EXEC.
  9207*    MOVE '"$I                   ! & #00008764' TO DFHEIV0
  9208     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9209     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9210     MOVE X'2620233030303038373634' TO DFHEIV0(25:11)
  9211     CALL 'kxdfhei1' USING DFHEIV0
  9212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9213
  9214
  9215
  9216* EXEC CICS READ
  9217*         SET      (ADDRESS OF CONTROL-FILE)
  9218*         DATASET  (CNTL-FILE-ID)
  9219*         RIDFLD   (CNTL-KEY)
  9220*    END-EXEC.
  9221*    MOVE '&"S        E          (   #00008768' TO DFHEIV0
  9222     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9223     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9224     MOVE X'2020233030303038373638' TO DFHEIV0(25:11)
  9225     CALL 'kxdfhei1' USING DFHEIV0,
  9226           CNTL-FILE-ID,
  9227           DFHEIV20,
  9228           DFHEIV99,
  9229           CNTL-KEY,
  9230           DFHEIV99,
  9231           DFHEIV99,
  9232           DFHEIV99
  9233     SET ADDRESS OF CONTROL-FILE TO
  9234         DFHEIV20
  9235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9236
  9237
  9238     MOVE AL-UANON               TO PROCA.
  9239     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9240     GO TO 1120-EXIT.
  9241
  9242 1120-CNTL-NOTFND.
  9243     MOVE ER-0273                TO EMI-ERROR.
  9244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9245     MOVE AL-UABON               TO PROCA.
  9246     MOVE -1                     TO PROCL.
  9247     MOVE 'X'                    TO ERROR-SWITCH.
  9248
  9249 1120-EXIT.
  9250     EXIT.
  9251
  9252*************************************************************
  9253*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9254*************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 168
* EL131.cbl
  9255
  9256 1150-OUTPUT-ACTIVITY-RECORD.
  9257
  9258
  9259* EXEC CICS GETMAIN
  9260*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9261*        LENGTH (25)
  9262*        INITIMG (WS-BLANK)
  9263*    END-EXEC.
  9264     MOVE 25
  9265       TO DFHEIV11
  9266*    MOVE ',"IL                  $   #00008794' TO DFHEIV0
  9267     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9268     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9269     MOVE X'2020233030303038373934' TO DFHEIV0(25:11)
  9270     CALL 'kxdfhei1' USING DFHEIV0,
  9271           DFHEIV20,
  9272           DFHEIV11,
  9273           WS-BLANK
  9274     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9275         DFHEIV20
  9276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9277
  9278
  9279     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9280     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9281     MOVE PI-CARRIER             TO DA-CARRIER.
  9282     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9283     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9284     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9285     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9286
  9287
  9288* EXEC CICS HANDLE CONDITION
  9289*        NOTOPEN (1150-NOTOPEN-ERROR)
  9290*        DUPREC (1150-EXIT)
  9291*    END-EXEC.
  9292*    MOVE '"$J%                  ! '' #00008808' TO DFHEIV0
  9293     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9294     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9295     MOVE X'2720233030303038383038' TO DFHEIV0(25:11)
  9296     CALL 'kxdfhei1' USING DFHEIV0
  9297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9298
  9299     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9300     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9301     MOVE 'A'                    TO JP-RECORD-TYPE.
  9302     MOVE +48                    TO JOURNAL-LENGTH.
  9303
  9304
  9305* EXEC CICS WRITE
  9306*        DATASET ('DLYACTV')
  9307*        RIDFLD (DA-KEY)
  9308*        FROM (DAILY-ACTIVITY-RECORD)
  9309*        LENGTH (25)
  9310*    END-EXEC.
  9311     MOVE 'DLYACTV' TO DFHEIV1
  9312     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 169
* EL131.cbl
  9313       TO DFHEIV11
  9314*    MOVE '&$ L                  ''   #00008817' TO DFHEIV0
  9315     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9316     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9317     MOVE X'2020233030303038383137' TO DFHEIV0(25:11)
  9318     CALL 'kxdfhei1' USING DFHEIV0,
  9319           DFHEIV1,
  9320           DAILY-ACTIVITY-RECORD,
  9321           DFHEIV11,
  9322           DA-KEY,
  9323           DFHEIV99,
  9324           DFHEIV99
  9325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9326
  9327
  9328     GO TO 1150-EXIT.
  9329
  9330 1150-NOTOPEN-ERROR.
  9331
  9332     MOVE '2955'                 TO EMI-ERROR.
  9333     MOVE -1                     TO MAINTL.
  9334     MOVE AL-UANON               TO MAINTA.
  9335     MOVE 'X'                    TO ERROR-SWITCH.
  9336     PERFORM 9900-ERROR-FORMAT THRU
  9337             9900-EXIT.
  9338
  9339 1150-EXIT.
  9340     EXIT.
  9341
  9342*************************************************************
  9343*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9344*************************************************************
  9345
  9346 1240-EDIT-LIFE-CODE.
  9347
  9348     IF INVALID-BENEFIT-CODE
  9349         GO TO 1240-SET-ERROR.
  9350
  9351     MOVE SPACES                 TO BENEFIT-KEY.
  9352     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9353     MOVE '4'                    TO BEN-REC-TYPE.
  9354     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9355     MOVE ZERO                   TO BEN-SEQ-NO.
  9356
  9357
  9358* EXEC CICS READ GTEQ
  9359*         DATASET  (CNTL-FILE-ID)
  9360*         RIDFLD   (BENEFIT-KEY)
  9361*         SET      (ADDRESS OF CONTROL-FILE)
  9362*    END-EXEC.
  9363*    MOVE '&"S        G          (   #00008853' TO DFHEIV0
  9364     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9365     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9366     MOVE X'2020233030303038383533' TO DFHEIV0(25:11)
  9367     CALL 'kxdfhei1' USING DFHEIV0,
  9368           CNTL-FILE-ID,
  9369           DFHEIV20,
  9370           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 170
* EL131.cbl
  9371           BENEFIT-KEY,
  9372           DFHEIV99,
  9373           DFHEIV99,
  9374           DFHEIV99
  9375     SET ADDRESS OF CONTROL-FILE TO
  9376         DFHEIV20
  9377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9378
  9379
  9380     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9381        CF-RECORD-TYPE NOT = '4'
  9382         GO TO 1240-SET-ERROR.
  9383
  9384     MOVE ZERO                   TO COUNT-2.
  9385     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9386
  9387     IF SCREEN-ERROR
  9388         GO TO 1240-SET-ERROR.
  9389
  9390 1240-SET-CODE-SWITCHES.
  9391     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9392     MOVE AL-UANON               TO LCVCDA.
  9393     GO TO 1240-EXIT.
  9394
  9395 1240-SET-ERROR.
  9396     MOVE ER-0240                TO EMI-ERROR.
  9397     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9398     MOVE 'X'                    TO ERROR-SWITCH.
  9399     MOVE AL-UABON               TO LCVCDA.
  9400     MOVE -1                     TO LCVCDL.
  9401
  9402 1240-EXIT.
  9403     EXIT.
  9404
  9405 1310-EDIT-AH-CODE.
  9406     IF INVALID-BENEFIT-CODE
  9407         GO TO 1310-SET-ERROR.
  9408
  9409     MOVE SPACES                 TO BENEFIT-KEY.
  9410     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9411     MOVE '5'                    TO BEN-REC-TYPE.
  9412     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9413     MOVE ZERO                   TO BEN-SEQ-NO.
  9414
  9415
  9416* EXEC CICS READ GTEQ
  9417*         DATASET  (CNTL-FILE-ID)
  9418*         RIDFLD   (BENEFIT-KEY)
  9419*         SET      (ADDRESS OF CONTROL-FILE)
  9420*    END-EXEC.
  9421*    MOVE '&"S        G          (   #00008894' TO DFHEIV0
  9422     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9423     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9424     MOVE X'2020233030303038383934' TO DFHEIV0(25:11)
  9425     CALL 'kxdfhei1' USING DFHEIV0,
  9426           CNTL-FILE-ID,
  9427           DFHEIV20,
  9428           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 171
* EL131.cbl
  9429           BENEFIT-KEY,
  9430           DFHEIV99,
  9431           DFHEIV99,
  9432           DFHEIV99
  9433     SET ADDRESS OF CONTROL-FILE TO
  9434         DFHEIV20
  9435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9436
  9437
  9438     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9439        CF-RECORD-TYPE NOT = '5'
  9440         GO TO 1310-SET-ERROR.
  9441
  9442     MOVE ZERO                   TO COUNT-2.
  9443     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9444     IF SCREEN-ERROR
  9445         GO TO 1310-SET-ERROR.
  9446
  9447 1310-SET-CODE-SWITCHES.
  9448     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9449     MOVE AL-UANON               TO ACVCDA.
  9450     GO TO 1310-EXIT.
  9451
  9452 1310-SET-ERROR.
  9453     MOVE ER-0250                TO EMI-ERROR.
  9454     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9455     MOVE AL-UABON               TO ACVCDA.
  9456     MOVE 'X'                    TO ERROR-SWITCH.
  9457     MOVE -1                     TO ACVCDL.
  9458
  9459 1310-EXIT.
  9460     EXIT.
  9461
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 172
* EL131.cbl
  9463 1460-EDIT-CERT-NO.
  9464     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9465     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9466
  9467     IF WS-SAVE-CERT-NO = SPACES
  9468         MOVE ER-0203            TO EMI-ERROR
  9469         GO TO 1460-CERT-NO-ERROR.
  9470
  9471     IF WS-CERT-NO-PRIME = SPACES AND
  9472        WS-CERT-NO-SUFX GREATER THAN SPACE
  9473            MOVE ER-0210         TO EMI-ERROR
  9474            GO TO 1460-CERT-NO-ERROR.
  9475
  9476     MOVE 'X'                    TO UPDATE-SWITCH.
  9477     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9478     MOVE AL-UANON               TO CERTA.
  9479
  9480     IF SUFXL IS GREATER THAN 0
  9481         MOVE AL-UANON           TO SUFXA.
  9482
  9483     GO TO 1460-EXIT.
  9484
  9485 1460-CERT-NO-ERROR.
  9486     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9487     MOVE AL-UABON               TO SUFXA.
  9488     MOVE AL-UABON               TO CERTA.
  9489     MOVE -1                     TO CERTL.
  9490     MOVE 'X'                    TO ERROR-SWITCH.
  9491
  9492 1460-EXIT.
  9493     EXIT.
  9494
  9495 1470-EDIT-EFF.
  9496     IF CERTEFFI = SPACES
  9497         GO TO 1470-DATE-ERROR.
  9498
  9499     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9500     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9501     IF DEEDIT-DATE = ZERO
  9502         GO TO 1470-DATE-ERROR.
  9503
  9504     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9505     MOVE '4'                    TO DC-OPTION-CODE.
  9506     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9507     IF NOT DATE-CONVERSION-ERROR
  9508         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9509         MOVE AL-UANON           TO CERTEFFA
  9510         MOVE 'X'                TO UPDATE-SWITCH
  9511         MOVE 'Y'                TO CERT-KEY-SWITCH
  9512         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9513         GO TO 1470-EXIT.
  9514
  9515 1470-DATE-ERROR.
  9516     MOVE ER-0215                TO EMI-ERROR.
  9517     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9518     MOVE AL-UABON               TO CERTEFFA.
  9519     MOVE -1                     TO CERTEFFL.
  9520     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 173
* EL131.cbl
  9521
  9522 1470-EXIT.
  9523     EXIT.
  9524
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 174
* EL131.cbl
  9526 1480-EDIT-ACCT.
  9527     IF CERTACTI = SPACES
  9528         MOVE ER-0232            TO EMI-ERROR
  9529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9530         MOVE AL-UABON           TO CERTACTA
  9531         MOVE -1                 TO CERTACTL
  9532         MOVE 'X'                TO ERROR-SWITCH
  9533     ELSE
  9534         MOVE 'X'                TO UPDATE-SWITCH
  9535         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9536
  9537 1480-EXIT.
  9538     EXIT.
  9539
  9540 1490-EDIT-STATE.
  9541     IF CERTSTI = SPACES
  9542         MOVE ER-0233            TO EMI-ERROR
  9543         GO TO 1490-STATE-ERROR.
  9544
  9545     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9546     MOVE '3'                    TO CNTL-REC-TYPE.
  9547     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9548     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9549     MOVE ZERO                   TO CNTL-SEQ-NO.
  9550
  9551
  9552* EXEC CICS HANDLE CONDITION
  9553*         NOTFND (1490-STATE-NOTFND)
  9554*    END-EXEC.
  9555*    MOVE '"$I                   ! ( #00009013' TO DFHEIV0
  9556     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9558     MOVE X'2820233030303039303133' TO DFHEIV0(25:11)
  9559     CALL 'kxdfhei1' USING DFHEIV0
  9560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9561
  9562
  9563
  9564* EXEC CICS READ
  9565*         SET        (ADDRESS OF CONTROL-FILE)
  9566*         DATASET    ('ELCNTL')
  9567*         RIDFLD     (CNTL-KEY)
  9568*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9569*         GENERIC
  9570*    END-EXEC.
  9571     MOVE 'ELCNTL' TO DFHEIV1
  9572*    MOVE '&"S  KG    E          (   #00009017' TO DFHEIV0
  9573     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9574     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9575     MOVE X'2020233030303039303137' TO DFHEIV0(25:11)
  9576     CALL 'kxdfhei1' USING DFHEIV0,
  9577           DFHEIV1,
  9578           DFHEIV20,
  9579           DFHEIV99,
  9580           CNTL-KEY,
  9581           CNTL-GENERIC-LENGTH,
  9582           DFHEIV99,
  9583           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 175
* EL131.cbl
  9584     SET ADDRESS OF CONTROL-FILE TO
  9585         DFHEIV20
  9586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9587
  9588
  9589     MOVE AL-UANON               TO CERTSTA.
  9590     MOVE 'X'                    TO UPDATE-SWITCH.
  9591     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9592     GO TO 1490-EXIT.
  9593
  9594 1490-STATE-NOTFND.
  9595     MOVE ER-0149                TO EMI-ERROR.
  9596
  9597 1490-STATE-ERROR.
  9598     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9599     MOVE AL-UABON               TO CERTSTA.
  9600     MOVE -1                     TO CERTSTL.
  9601     MOVE 'X'                    TO ERROR-SWITCH.
  9602
  9603 1490-EXIT.
  9604     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 176
* EL131.cbl
  9606 1500-EDIT-CARR.
  9607     IF CERTCARI = SPACES
  9608         GO TO 1500-CARR-NOTFND.
  9609
  9610     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9611     MOVE '6'                    TO CNTL-REC-TYPE.
  9612     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9613     MOVE CERTCARI               TO CNTL-CARRIER.
  9614     MOVE ZERO                   TO CNTL-SEQ-NO.
  9615
  9616
  9617* EXEC CICS HANDLE CONDITION
  9618*         NOTFND   (1500-CARR-NOTFND)
  9619*    END-EXEC.
  9620*    MOVE '"$I                   ! ) #00009052' TO DFHEIV0
  9621     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9623     MOVE X'2920233030303039303532' TO DFHEIV0(25:11)
  9624     CALL 'kxdfhei1' USING DFHEIV0
  9625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9626
  9627
  9628
  9629* EXEC CICS READ
  9630*         SET        (ADDRESS OF CONTROL-FILE)
  9631*         DATASET    ('ELCNTL')
  9632*         RIDFLD     (CNTL-KEY)
  9633*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9634*         GENERIC
  9635*    END-EXEC.
  9636     MOVE 'ELCNTL' TO DFHEIV1
  9637*    MOVE '&"S  KG    E          (   #00009056' TO DFHEIV0
  9638     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9639     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9640     MOVE X'2020233030303039303536' TO DFHEIV0(25:11)
  9641     CALL 'kxdfhei1' USING DFHEIV0,
  9642           DFHEIV1,
  9643           DFHEIV20,
  9644           DFHEIV99,
  9645           CNTL-KEY,
  9646           CNTL-GENERIC-LENGTH,
  9647           DFHEIV99,
  9648           DFHEIV99
  9649     SET ADDRESS OF CONTROL-FILE TO
  9650         DFHEIV20
  9651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9652
  9653
  9654     MOVE AL-UANON               TO CERTCARA.
  9655     MOVE 'X'                    TO UPDATE-SWITCH.
  9656     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9657     GO TO 1500-EXIT.
  9658
  9659 1500-CARR-NOTFND.
  9660     MOVE ER-0360                TO EMI-ERROR.
  9661     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9662     MOVE AL-UABON               TO CERTCARA.
  9663     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 177
* EL131.cbl
  9664     MOVE 'X'                    TO ERROR-SWITCH.
  9665
  9666 1500-EXIT.
  9667     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 178
* EL131.cbl
  9669 1510-DEEDIT-DATE.
  9670
  9671* EXEC CICS BIF DEEDIT
  9672*         FIELD    (DEEDIT-DATE-INPUT)
  9673*         LENGTH   (DATE-LENGTH)
  9674*    END-EXEC.
  9675*    MOVE '@"L                   #   #00009080' TO DFHEIV0
  9676     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9677     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9678     MOVE X'2020233030303039303830' TO DFHEIV0(25:11)
  9679     CALL 'kxdfhei1' USING DFHEIV0,
  9680           DEEDIT-DATE-INPUT,
  9681           DATE-LENGTH
  9682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9683
  9684
  9685 1510-EXIT.
  9686     EXIT.
  9687
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 179
* EL131.cbl
  9689 1620-VERIFY-ACCT.
  9690
  9691     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9692     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9693     MOVE PI-GROUPING            TO ACCT-GROUP.
  9694     MOVE PI-STATE               TO ACCT-STATE.
  9695     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9696
  9697     IF CERTEFFI GREATER THAN LOW-VALUES
  9698         MOVE HOLD-EFF           TO ACCT-DATE
  9699     ELSE
  9700         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9701
  9702     IF CERTACTI GREATER THAN LOW-VALUES
  9703         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9704     IF CERTSTI GREATER THAN LOW-VALUES
  9705         MOVE CERTSTI            TO  ACCT-STATE.
  9706     IF CERTCARI GREATER THAN LOW-VALUES
  9707         MOVE CERTCARI           TO  ACCT-CARRIER.
  9708     IF CERTGRPI GREATER THAN LOW-VALUES
  9709         MOVE CERTGRPI           TO ACCT-GROUP.
  9710
  9711     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9712
  9713
  9714* EXEC CICS HANDLE CONDITION
  9715*         NOTFND  (1620-ACCT-NOTFND)
  9716*    END-EXEC.
  9717*    MOVE '"$I                   ! * #00009113' TO DFHEIV0
  9718     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9719     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9720     MOVE X'2A20233030303039313133' TO DFHEIV0(25:11)
  9721     CALL 'kxdfhei1' USING DFHEIV0
  9722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9723
  9724
  9725
  9726* EXEC CICS STARTBR
  9727*         DATASET   (ACCT-FILE-ID)
  9728*         RIDFLD    (ACCT-KEY)
  9729*    END-EXEC.
  9730     MOVE 0
  9731       TO DFHEIV11
  9732*    MOVE '&,         G          &   #00009117' TO DFHEIV0
  9733     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9734     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9735     MOVE X'2020233030303039313137' TO DFHEIV0(25:11)
  9736     CALL 'kxdfhei1' USING DFHEIV0,
  9737           ACCT-FILE-ID,
  9738           ACCT-KEY,
  9739           DFHEIV99,
  9740           DFHEIV11,
  9741           DFHEIV99
  9742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9743
  9744
  9745 1620-ACCT-LOOP.
  9746
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 180
* EL131.cbl
  9747
  9748* EXEC CICS READNEXT
  9749*         DATASET  (ACCT-FILE-ID)
  9750*         RIDFLD   (ACCT-KEY)
  9751*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9752*    END-EXEC.
  9753     MOVE 0
  9754       TO DFHEIV11
  9755*    MOVE '&.S                   )   #00009124' TO DFHEIV0
  9756     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9757     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9758     MOVE X'2020233030303039313234' TO DFHEIV0(25:11)
  9759     CALL 'kxdfhei1' USING DFHEIV0,
  9760           ACCT-FILE-ID,
  9761           DFHEIV20,
  9762           DFHEIV99,
  9763           ACCT-KEY,
  9764           DFHEIV99,
  9765           DFHEIV11,
  9766           DFHEIV99,
  9767           DFHEIV99
  9768     SET ADDRESS OF ACCOUNT-MASTER TO
  9769         DFHEIV20
  9770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9771
  9772
  9773     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9774         GO TO 1620-ACCT-NOTFND.
  9775
  9776     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9777        HOLD-EFF     LESS AM-EXPIRATION-DT
  9778         NEXT SENTENCE
  9779     ELSE
  9780         GO TO 1620-ACCT-LOOP.
  9781
  9782     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9783         GO TO 1620-ACCT-END-BROWSE.
  9784
  9785     IF LOANBALL GREATER THAN +0
  9786         IF AM-MAX-TOT-BEN NUMERIC  AND
  9787            AM-MAX-TOT-BEN GREATER THAN ZERO
  9788             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9789                 MOVE AL-UNBON     TO LOANBALA
  9790                 MOVE -1           TO LOANBALL
  9791                 MOVE 'X'          TO ERROR-SWITCH
  9792                 MOVE ER-7641      TO EMI-ERROR
  9793                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9794
  9795     IF ACVBENEL GREATER THAN +0
  9796         IF AM-MAX-MON-BEN NUMERIC  AND
  9797            AM-MAX-MON-BEN GREATER THAN ZERO
  9798             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9799                 MOVE AL-UNBON     TO ACVBENEA
  9800                 MOVE -1           TO ACVBENEL
  9801                 MOVE 'X'          TO ERROR-SWITCH
  9802                 MOVE ER-7642      TO EMI-ERROR
  9803                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9804
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 181
* EL131.cbl
  9805 1620-ACCT-END-BROWSE.
  9806
  9807
  9808* EXEC CICS ENDBR
  9809*         DATASET (ACCT-FILE-ID)
  9810*    END-EXEC.
  9811     MOVE 0
  9812       TO DFHEIV11
  9813*    MOVE '&2                    $   #00009164' TO DFHEIV0
  9814     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9815     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9816     MOVE X'2020233030303039313634' TO DFHEIV0(25:11)
  9817     CALL 'kxdfhei1' USING DFHEIV0,
  9818           ACCT-FILE-ID,
  9819           DFHEIV11,
  9820           DFHEIV99
  9821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9822
  9823
  9824     GO TO 1620-EXIT.
  9825
  9826 1620-ACCT-NOTFND.
  9827
  9828     MOVE -1                     TO MAINTL.
  9829     MOVE 'X'                    TO ERROR-SWITCH.
  9830     MOVE ER-0426                TO EMI-ERROR.
  9831     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9832
  9833 1620-EXIT.
  9834     EXIT.
  9835
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 182
* EL131.cbl
  9837 2000-UPDATE-CLAIM.
  9838
  9839     MOVE SPACES                 TO ERROR-SWITCH.
  9840     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9841     MOVE PI-CARRIER             TO CARRIER-CODE.
  9842     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9843     MOVE PI-CERT-NO             TO CERT-NO.
  9844
  9845     IF DELETE-CLAIM
  9846         GO TO 3000-DELETE-CLAIM.
  9847
  9848     IF  NOT MODIFY-CAP
  9849         MOVE ER-0070            TO EMI-ERROR
  9850         MOVE 'X'                TO ERROR-SWITCH
  9851         MOVE -1                 TO MAINTL
  9852         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9853         GO TO 2000-EXIT.
  9854
  9855     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9856     MOVE ZERO                   TO TRLR-SEQ-NO.
  9857
  9858
  9859* EXEC CICS READ UPDATE
  9860*         SET       (ADDRESS OF CLAIM-MASTER)
  9861*         DATASET   (CLMS-FILE-ID)
  9862*         RIDFLD    (MSTR-KEY)
  9863*    END-EXEC.
  9864*    MOVE '&"S        EU         (   #00009202' TO DFHEIV0
  9865     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9866     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9867     MOVE X'2020233030303039323032' TO DFHEIV0(25:11)
  9868     CALL 'kxdfhei1' USING DFHEIV0,
  9869           CLMS-FILE-ID,
  9870           DFHEIV20,
  9871           DFHEIV99,
  9872           MSTR-KEY,
  9873           DFHEIV99,
  9874           DFHEIV99,
  9875           DFHEIV99
  9876     SET ADDRESS OF CLAIM-MASTER TO
  9877         DFHEIV20
  9878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9879
  9880
  9881     if (incl > zeros)
  9882        and (cl-no-of-pmts-made > 0)
  9883        and (hold-incur > low-values)
  9884        and (hold-incur not = cl-incurred-dt)
  9885        if hold-incur > cl-incurred-dt
  9886           move cl-incurred-dt   to dc-bin-date-1
  9887           move hold-incur       to dc-bin-date-2
  9888        else
  9889           move hold-incur       to dc-bin-date-1
  9890           move cl-incurred-dt   to dc-bin-date-2
  9891        end-if
  9892        move '1'                 to dc-option-code
  9893        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9894        if dc-elapsed-days > +60
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 183
* EL131.cbl
  9895           MOVE ER-1663             TO EMI-ERROR
  9896           PERFORM 9900-ERROR-FORMAT
  9897                                 THRU 9900-EXIT
  9898           MOVE -1                  TO MAINTL
  9899           GO TO 8110-SEND-DATA
  9900        end-if
  9901     end-if
  9902     IF (CL-PRIORITY-CD = '8')
  9903        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  9904             AND 'AMWA' AND 'KMSB')
  9905        MOVE ER-8003             TO EMI-ERROR
  9906        PERFORM 9900-ERROR-FORMAT
  9907                                 THRU 9900-EXIT
  9908        MOVE -1                  TO MAINTL
  9909        GO TO 8110-SEND-DATA
  9910     END-IF
  9911
  9912     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
  9913         MOVE ER-0068            TO EMI-ERROR
  9914         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9915         GO TO 2000-EXIT.
  9916
  9917     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
  9918         MOVE ER-0068            TO EMI-ERROR
  9919         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9920         GO TO 2000-EXIT.
  9921
  9922     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  9923         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
  9924
  9925     IF CL-PURGED-DT NOT = LOW-VALUES
  9926         MOVE ER-7691            TO EMI-ERROR
  9927         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9928         GO TO 2000-EXIT.
  9929
  9930     IF CERT-KEY-CHANGED
  9931         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
  9932
  9933     IF SCREEN-ERROR
  9934         MOVE ER-0068            TO EMI-ERROR
  9935         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9936         GO TO 2000-EXIT.
  9937
  9938     IF NINETY-TRLR-UPDATED
  9939         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
  9940
  9941     IF MSTR-KEY-CHANGED
  9942         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
  9943        ELSE
  9944         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
  9945
  9946     IF TRLR-UPDATE-REQUIRED
  9947         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
  9948
  9949 2000-CHECK-CERT.
  9950     IF NOT CERT-UPDATES
  9951         GO TO 2000-EXIT.
  9952
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 184
* EL131.cbl
  9953     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9954     MOVE PI-CARRIER             TO CERT-CARRIER.
  9955     MOVE PI-GROUPING            TO CERT-GROUP.
  9956     MOVE PI-STATE               TO CERT-STATE.
  9957     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9958     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9959     MOVE PI-CERT-NO             TO CERT-CERT.
  9960
  9961     IF CERT-ALT-KEY-CHANGED
  9962         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
  9963     ELSE
  9964         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
  9965
  9966 2000-EXIT.
  9967     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 185
* EL131.cbl
  9969 2010-RELEASE-REC.
  9970
  9971* EXEC CICS UNLOCK
  9972*         DATASET  (CLMS-FILE-ID)
  9973*    END-EXEC
  9974*    MOVE '&*                    #   #00009297' TO DFHEIV0
  9975     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9976     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9977     MOVE X'2020233030303039323937' TO DFHEIV0(25:11)
  9978     CALL 'kxdfhei1' USING DFHEIV0,
  9979           CLMS-FILE-ID,
  9980           DFHEIV99
  9981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9982
  9983     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9984     MOVE 'X'                    TO ERROR-SWITCH.
  9985
  9986 2010-EXIT.
  9987     EXIT.
  9988
  9989 2020-NORMAL-UPDATE.
  9990     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9991
  9992     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9993
  9994     IF WS-OPEN-CLOSE-SW = 'Y'
  9995       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9996       IF PI-REC-FOUND-SW = 'Y'
  9997         IF CL-ACTIVITY-CODE = 09
  9998           NEXT SENTENCE
  9999         ELSE
 10000           IF WS-RESET-SW = 'Y'
 10001             IF CL-CLAIM-STATUS = 'C'
 10002               MOVE 07               TO  CL-ACTIVITY-CODE
 10003               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10004               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10005             ELSE
 10006               MOVE 08               TO  CL-ACTIVITY-CODE
 10007               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10008               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10009
 10010     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10011         MOVE 'Y'                TO CL-YESNOSW
 10012     END-IF.
 10013
 10014     if pi-company-id = 'DCC'
 10015        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10016        perform 2120-check-pdef  thru 2120-exit
 10017     end-if
 10018
 10019* EXEC CICS HANDLE CONDITION
 10020*         DUPKEY   (2020-EXIT)
 10021*    END-EXEC.
 10022*    MOVE '"$$                   ! + #00009336' TO DFHEIV0
 10023     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10024     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10025     MOVE X'2B20233030303039333336' TO DFHEIV0(25:11)
 10026     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 186
* EL131.cbl
 10027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10028
 10029
 10030
 10031* EXEC CICS REWRITE
 10032*         DATASET   (CLMS-FILE-ID)
 10033*         FROM      (CLAIM-MASTER)
 10034*    END-EXEC.
 10035     MOVE LENGTH OF
 10036      CLAIM-MASTER
 10037       TO DFHEIV11
 10038*    MOVE '&& L                  %   #00009340' TO DFHEIV0
 10039     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10040     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10041     MOVE X'2020233030303039333430' TO DFHEIV0(25:11)
 10042     CALL 'kxdfhei1' USING DFHEIV0,
 10043           CLMS-FILE-ID,
 10044           CLAIM-MASTER,
 10045           DFHEIV11,
 10046           DFHEIV99
 10047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10048
 10049
 10050 2020-EXIT.
 10051     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 187
* EL131.cbl
 10053 2030-KEY-UPDATE.
 10054     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10055
 10056
 10057* EXEC CICS DELETE
 10058*        DATASET  (CLMS-FILE-ID)
 10059*    END-EXEC.
 10060*    MOVE '&(                    &   #00009351' TO DFHEIV0
 10061     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10062     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10063     MOVE X'2020233030303039333531' TO DFHEIV0(25:11)
 10064     CALL 'kxdfhei1' USING DFHEIV0,
 10065           CLMS-FILE-ID,
 10066           DFHEIV99,
 10067           DFHEIV99,
 10068           DFHEIV99,
 10069           DFHEIV99
 10070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10071
 10072
 10073
 10074* EXEC CICS GETMAIN
 10075*         SET      (ADDRESS OF CLAIM-MASTER)
 10076*         LENGTH   (MSTR-LENGTH)
 10077*         INITIMG  (GETMAIN-SPACE)
 10078*    END-EXEC.
 10079*    MOVE ',"IL                  $   #00009355' TO DFHEIV0
 10080     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10081     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10082     MOVE X'2020233030303039333535' TO DFHEIV0(25:11)
 10083     CALL 'kxdfhei1' USING DFHEIV0,
 10084           DFHEIV20,
 10085           MSTR-LENGTH,
 10086           GETMAIN-SPACE
 10087     SET ADDRESS OF CLAIM-MASTER TO
 10088         DFHEIV20
 10089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10090
 10091
 10092     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10093
 10094     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10095
 10096     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10097
 10098     IF WS-OPEN-CLOSE-SW = 'Y'
 10099       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10100         IF PI-REC-FOUND-SW = 'Y'
 10101           IF CL-ACTIVITY-CODE = 09
 10102             NEXT SENTENCE
 10103           ELSE
 10104             IF WS-RESET-SW = 'Y'
 10105               IF CL-CLAIM-STATUS = 'C'
 10106                 MOVE 07             TO  CL-ACTIVITY-CODE
 10107                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10108                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10109               ELSE
 10110                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 188
* EL131.cbl
 10111                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10112                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10113
 10114
 10115* EXEC CICS HANDLE CONDITION
 10116*         DUPKEY    (2030-EXIT)
 10117*    END-EXEC.
 10118*    MOVE '"$$                   ! , #00009383' TO DFHEIV0
 10119     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10121     MOVE X'2C20233030303039333833' TO DFHEIV0(25:11)
 10122     CALL 'kxdfhei1' USING DFHEIV0
 10123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10124
 10125
 10126** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10127*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10128
 10129     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10130         MOVE 'Y'                TO CL-YESNOSW
 10131     END-IF.
 10132
 10133
 10134* EXEC CICS WRITE
 10135*         DATASET   (CLMS-FILE-ID)
 10136*         RIDFLD    (MSTR-KEY)
 10137*         FROM      (CLAIM-MASTER)
 10138*    END-EXEC.
 10139     MOVE LENGTH OF
 10140      CLAIM-MASTER
 10141       TO DFHEIV11
 10142*    MOVE '&$ L                  ''   #00009394' TO DFHEIV0
 10143     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10144     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10145     MOVE X'2020233030303039333934' TO DFHEIV0(25:11)
 10146     CALL 'kxdfhei1' USING DFHEIV0,
 10147           CLMS-FILE-ID,
 10148           CLAIM-MASTER,
 10149           DFHEIV11,
 10150           MSTR-KEY,
 10151           DFHEIV99,
 10152           DFHEIV99
 10153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10154
 10155
 10156 2030-EXIT.
 10157     EXIT.
 10158
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 189
* EL131.cbl
 10160 2040-NORMAL-UPDATE.
 10161
 10162* EXEC CICS READ UPDATE
 10163*         DATASET  (CERT-FILE-ID)
 10164*         RIDFLD   (CERT-KEY)
 10165*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10166*    END-EXEC.
 10167*    MOVE '&"S        EU         (   #00009405' TO DFHEIV0
 10168     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10169     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10170     MOVE X'2020233030303039343035' TO DFHEIV0(25:11)
 10171     CALL 'kxdfhei1' USING DFHEIV0,
 10172           CERT-FILE-ID,
 10173           DFHEIV20,
 10174           DFHEIV99,
 10175           CERT-KEY,
 10176           DFHEIV99,
 10177           DFHEIV99,
 10178           DFHEIV99
 10179     SET ADDRESS OF CERTIFICATE-MASTER TO
 10180         DFHEIV20
 10181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10182
 10183
 10184     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10185
 10186
 10187* EXEC CICS HANDLE CONDITION
 10188*         DUPKEY   (2040-EXIT)
 10189*    END-EXEC.
 10190*    MOVE '"$$                   ! - #00009413' TO DFHEIV0
 10191     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10193     MOVE X'2D20233030303039343133' TO DFHEIV0(25:11)
 10194     CALL 'kxdfhei1' USING DFHEIV0
 10195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10196
 10197
 10198
 10199* EXEC CICS REWRITE
 10200*         DATASET  (CERT-FILE-ID)
 10201*         FROM     (CERTIFICATE-MASTER)
 10202*    END-EXEC.
 10203     MOVE LENGTH OF
 10204      CERTIFICATE-MASTER
 10205       TO DFHEIV11
 10206*    MOVE '&& L                  %   #00009417' TO DFHEIV0
 10207     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10208     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10209     MOVE X'2020233030303039343137' TO DFHEIV0(25:11)
 10210     CALL 'kxdfhei1' USING DFHEIV0,
 10211           CERT-FILE-ID,
 10212           CERTIFICATE-MASTER,
 10213           DFHEIV11,
 10214           DFHEIV99
 10215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10216
 10217
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 190
* EL131.cbl
 10218 2040-EXIT.
 10219     EXIT.
 10220
 10221 2050-KEY-UPDATE.
 10222
 10223* EXEC CICS READ UPDATE
 10224*         DATASET  (CERT-FILE-ID)
 10225*         RIDFLD   (CERT-KEY)
 10226*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10227*    END-EXEC.
 10228*    MOVE '&"S        EU         (   #00009426' TO DFHEIV0
 10229     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10230     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10231     MOVE X'2020233030303039343236' TO DFHEIV0(25:11)
 10232     CALL 'kxdfhei1' USING DFHEIV0,
 10233           CERT-FILE-ID,
 10234           DFHEIV20,
 10235           DFHEIV99,
 10236           CERT-KEY,
 10237           DFHEIV99,
 10238           DFHEIV99,
 10239           DFHEIV99
 10240     SET ADDRESS OF CERTIFICATE-MASTER TO
 10241         DFHEIV20
 10242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10243
 10244
 10245     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10246
 10247
 10248* EXEC CICS DELETE
 10249*         DATASET   (CERT-FILE-ID)
 10250*    END-EXEC.
 10251*    MOVE '&(                    &   #00009434' TO DFHEIV0
 10252     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10253     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10254     MOVE X'2020233030303039343334' TO DFHEIV0(25:11)
 10255     CALL 'kxdfhei1' USING DFHEIV0,
 10256           CERT-FILE-ID,
 10257           DFHEIV99,
 10258           DFHEIV99,
 10259           DFHEIV99,
 10260           DFHEIV99
 10261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10262
 10263
 10264
 10265* EXEC CICS GETMAIN
 10266*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10267*         LENGTH    (CERT-LENGTH)
 10268*         INITIMG   (GETMAIN-SPACE)
 10269*    END-EXEC.
 10270*    MOVE ',"IL                  $   #00009438' TO DFHEIV0
 10271     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10272     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10273     MOVE X'2020233030303039343338' TO DFHEIV0(25:11)
 10274     CALL 'kxdfhei1' USING DFHEIV0,
 10275           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 191
* EL131.cbl
 10276           CERT-LENGTH,
 10277           GETMAIN-SPACE
 10278     SET ADDRESS OF CERTIFICATE-MASTER TO
 10279         DFHEIV20
 10280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10281
 10282
 10283     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10284
 10285     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10286
 10287
 10288* EXEC CICS HANDLE CONDITION
 10289*         DUPKEY (2050-EXIT)
 10290*    END-EXEC.
 10291*    MOVE '"$$                   ! . #00009448' TO DFHEIV0
 10292     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10294     MOVE X'2E20233030303039343438' TO DFHEIV0(25:11)
 10295     CALL 'kxdfhei1' USING DFHEIV0
 10296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10297
 10298
 10299
 10300* EXEC CICS WRITE
 10301*         DATASET  (CERT-FILE-ID)
 10302*         RIDFLD   (CERT-KEY)
 10303*         FROM     (CERTIFICATE-MASTER)
 10304*    END-EXEC.
 10305     MOVE LENGTH OF
 10306      CERTIFICATE-MASTER
 10307       TO DFHEIV11
 10308*    MOVE '&$ L                  ''   #00009452' TO DFHEIV0
 10309     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10310     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10311     MOVE X'2020233030303039343532' TO DFHEIV0(25:11)
 10312     CALL 'kxdfhei1' USING DFHEIV0,
 10313           CERT-FILE-ID,
 10314           CERTIFICATE-MASTER,
 10315           DFHEIV11,
 10316           CERT-KEY,
 10317           DFHEIV99,
 10318           DFHEIV99
 10319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10320
 10321
 10322 2050-EXIT.
 10323     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 192
* EL131.cbl
 10325 2060-CHANGE-CERT.
 10326     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10327     MOVE PI-CARRIER             TO CERT-CARRIER.
 10328     MOVE PI-GROUPING            TO CERT-GROUP.
 10329     MOVE PI-STATE               TO CERT-STATE.
 10330     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10331     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10332     MOVE PI-CERT-NO             TO CERT-CERT.
 10333     IF CERTEFFI GREATER THAN LOW-VALUES
 10334         MOVE HOLD-EFF           TO CERT-DATE.
 10335     IF CERTACTI GREATER THAN LOW-VALUES
 10336         MOVE CERTACTI           TO CERT-ACCOUNT.
 10337     IF CERTSTI GREATER THAN LOW-VALUES
 10338         MOVE CERTSTI            TO CERT-STATE.
 10339     IF CERTCARI GREATER THAN LOW-VALUES
 10340         MOVE CERTCARI           TO CERT-CARRIER.
 10341     IF CERTGRPI GREATER THAN LOW-VALUES
 10342         MOVE CERTGRPI           TO CERT-GROUP.
 10343     IF CERTI GREATER THAN LOW-VALUES
 10344         MOVE CERTI              TO CERT-CERT-PRIME.
 10345     IF SUFXI GREATER THAN LOW-VALUES
 10346         MOVE SUFXI              TO CERT-CERT-SUFX.
 10347
 10348
 10349* EXEC CICS HANDLE CONDITION
 10350*         NOTFND   (2060-CERT-NOTFND)
 10351*    END-EXEC.
 10352*    MOVE '"$I                   ! / #00009484' TO DFHEIV0
 10353     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10355     MOVE X'2F20233030303039343834' TO DFHEIV0(25:11)
 10356     CALL 'kxdfhei1' USING DFHEIV0
 10357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10358
 10359
 10360
 10361* EXEC CICS READ UPDATE
 10362*         DATASET  (CERT-FILE-ID)
 10363*         RIDFLD   (CERT-KEY)
 10364*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10365*    END-EXEC.
 10366*    MOVE '&"S        EU         (   #00009488' TO DFHEIV0
 10367     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10368     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10369     MOVE X'2020233030303039343838' TO DFHEIV0(25:11)
 10370     CALL 'kxdfhei1' USING DFHEIV0,
 10371           CERT-FILE-ID,
 10372           DFHEIV20,
 10373           DFHEIV99,
 10374           CERT-KEY,
 10375           DFHEIV99,
 10376           DFHEIV99,
 10377           DFHEIV99
 10378     SET ADDRESS OF CERTIFICATE-MASTER TO
 10379         DFHEIV20
 10380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10381
 10382
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 193
* EL131.cbl
 10383     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10384
 10385     IF CM-CLAIM-INTERFACE-SW = SPACES
 10386        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10387
 10388
 10389* EXEC CICS HANDLE CONDITION
 10390*         DUPKEY   (2060-DUPKEY)
 10391*    END-EXEC.
 10392*    MOVE '"$$                   ! 0 #00009499' TO DFHEIV0
 10393     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10394     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10395     MOVE X'3020233030303039343939' TO DFHEIV0(25:11)
 10396     CALL 'kxdfhei1' USING DFHEIV0
 10397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10398
 10399
 10400
 10401* EXEC CICS REWRITE
 10402*         DATASET  (CERT-FILE-ID)
 10403*         FROM     (CERTIFICATE-MASTER)
 10404*    END-EXEC.
 10405     MOVE LENGTH OF
 10406      CERTIFICATE-MASTER
 10407       TO DFHEIV11
 10408*    MOVE '&& L                  %   #00009503' TO DFHEIV0
 10409     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10410     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10411     MOVE X'2020233030303039353033' TO DFHEIV0(25:11)
 10412     CALL 'kxdfhei1' USING DFHEIV0,
 10413           CERT-FILE-ID,
 10414           CERTIFICATE-MASTER,
 10415           DFHEIV11,
 10416           DFHEIV99
 10417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10418
 10419
 10420 2060-DUPKEY.
 10421
 10422     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10423
 10424 2060-CHANGE-TRLR-ACTQ.
 10425     IF SCREEN-ERROR
 10426         GO TO 2060-EXIT.
 10427
 10428     IF CERTI    GREATER LOW-VALUES OR
 10429        SUFXI    GREATER LOW-VALUES OR
 10430        CERTCARI GREATER LOW-VALUES
 10431         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10432         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10433
 10434     MOVE SPACES                 TO CERT-KEY-SWITCH
 10435                                    CERT-SWITCH
 10436                                    TRLR-SWITCH
 10437                                    NINETY-TRLR-SWITCH.
 10438     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10439     GO TO 2060-EXIT.
 10440
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 194
* EL131.cbl
 10441 2060-CERT-NOTFND.
 10442     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10443
 10444     IF WS-REC-FOUND-SW = 'N'
 10445         MOVE ER-0206            TO  EMI-ERROR
 10446         MOVE -1                 TO  MAINTL
 10447         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10448
 10449* EXEC CICS UNLOCK
 10450*            DATASET   (CLMS-FILE-ID)
 10451*        END-EXEC
 10452*    MOVE '&*                    #   #00009536' TO DFHEIV0
 10453     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10454     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10455     MOVE X'2020233030303039353336' TO DFHEIV0(25:11)
 10456     CALL 'kxdfhei1' USING DFHEIV0,
 10457           CLMS-FILE-ID,
 10458           DFHEIV99
 10459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10460         GO TO 8110-SEND-DATA.
 10461
 10462     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10463
 10464     GO TO 2060-CHANGE-TRLR-ACTQ.
 10465
 10466 2060-EXIT.
 10467     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 195
* EL131.cbl
 10469 2070-CHECK-OLD.
 10470
 10471
 10472* EXEC CICS HANDLE CONDITION
 10473*        NOTFND   (2070-NOT-FOUND)
 10474*    END-EXEC.
 10475*    MOVE '"$I                   ! 1 #00009550' TO DFHEIV0
 10476     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10478     MOVE X'3120233030303039353530' TO DFHEIV0(25:11)
 10479     CALL 'kxdfhei1' USING DFHEIV0
 10480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10481
 10482
 10483     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10484     MOVE PI-CARRIER             TO CERT-CARRIER.
 10485     MOVE PI-GROUPING            TO CERT-GROUP.
 10486     MOVE PI-STATE               TO CERT-STATE.
 10487     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10488     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10489     MOVE PI-CERT-NO             TO CERT-CERT.
 10490
 10491
 10492* EXEC CICS READ UPDATE
 10493*         DATASET  (CERT-FILE-ID)
 10494*         RIDFLD   (CERT-KEY)
 10495*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10496*    END-EXEC.
 10497*    MOVE '&"S        EU         (   #00009562' TO DFHEIV0
 10498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10499     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10500     MOVE X'2020233030303039353632' TO DFHEIV0(25:11)
 10501     CALL 'kxdfhei1' USING DFHEIV0,
 10502           CERT-FILE-ID,
 10503           DFHEIV20,
 10504           DFHEIV99,
 10505           CERT-KEY,
 10506           DFHEIV99,
 10507           DFHEIV99,
 10508           DFHEIV99
 10509     SET ADDRESS OF CERTIFICATE-MASTER TO
 10510         DFHEIV20
 10511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10512
 10513
 10514     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10515     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10516     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10517
 10518     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10519         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10520
 10521     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10522       AND
 10523        CERT-WAS-CREATED-FOR-CLAIM
 10524         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10525
 10526* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 196
* EL131.cbl
 10527*             DATASET   (CERT-FILE-ID)
 10528*        END-EXEC
 10529*    MOVE '&(                    &   #00009579' TO DFHEIV0
 10530     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10531     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10532     MOVE X'2020233030303039353739' TO DFHEIV0(25:11)
 10533     CALL 'kxdfhei1' USING DFHEIV0,
 10534           CERT-FILE-ID,
 10535           DFHEIV99,
 10536           DFHEIV99,
 10537           DFHEIV99,
 10538           DFHEIV99
 10539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10540         GO TO 2070-EXIT.
 10541
 10542     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10543         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10544
 10545
 10546* EXEC CICS HANDLE CONDITION
 10547*         DUPKEY   (2070-EXIT)
 10548*    END-EXEC.
 10549*    MOVE '"$$                   ! 2 #00009587' TO DFHEIV0
 10550     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10552     MOVE X'3220233030303039353837' TO DFHEIV0(25:11)
 10553     CALL 'kxdfhei1' USING DFHEIV0
 10554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10555
 10556
 10557
 10558* EXEC CICS REWRITE
 10559*         DATASET  (CERT-FILE-ID)
 10560*         FROM     (CERTIFICATE-MASTER)
 10561*    END-EXEC.
 10562     MOVE LENGTH OF
 10563      CERTIFICATE-MASTER
 10564       TO DFHEIV11
 10565*    MOVE '&& L                  %   #00009591' TO DFHEIV0
 10566     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10567     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10568     MOVE X'2020233030303039353931' TO DFHEIV0(25:11)
 10569     CALL 'kxdfhei1' USING DFHEIV0,
 10570           CERT-FILE-ID,
 10571           CERTIFICATE-MASTER,
 10572           DFHEIV11,
 10573           DFHEIV99
 10574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10575
 10576
 10577     GO TO 2070-EXIT.
 10578
 10579 2070-NOT-FOUND.
 10580     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10581
 10582 2070-EXIT.
 10583     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 197
* EL131.cbl
 10585 2080-CREATE-CERT.
 10586
 10587* EXEC CICS GETMAIN
 10588*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10589*         LENGTH    (CERT-LENGTH)
 10590*         INITIMG   (GETMAIN-SPACE)
 10591*    END-EXEC.
 10592*    MOVE ',"IL                  $   #00009605' TO DFHEIV0
 10593     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10594     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10595     MOVE X'2020233030303039363035' TO DFHEIV0(25:11)
 10596     CALL 'kxdfhei1' USING DFHEIV0,
 10597           DFHEIV20,
 10598           CERT-LENGTH,
 10599           GETMAIN-SPACE
 10600     SET ADDRESS OF CERTIFICATE-MASTER TO
 10601         DFHEIV20
 10602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10603
 10604
 10605     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10606
 10607     IF CERTEFFI GREATER THAN LOW-VALUES
 10608         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10609                                    DC-BIN-DATE-1
 10610         MOVE '6'                TO DC-OPTION-CODE
 10611         MOVE +1                 TO DC-ELAPSED-MONTHS
 10612         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10613         IF NO-CONVERSION-ERROR
 10614             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10615
 10616     IF CERTACTI GREATER THAN LOW-VALUES
 10617         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10618     IF CERTSTI GREATER THAN LOW-VALUES
 10619         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10620     IF CERTCARI GREATER THAN LOW-VALUES
 10621         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10622     IF CERTGRPI GREATER THAN LOW-VALUES
 10623         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10624     IF CERTI GREATER THAN LOW-VALUES
 10625         MOVE CERTI              TO CERT-CERT-PRIME
 10626                                    CM-CERT-PRIME
 10627         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10628
 10629     IF SUFXI GREATER THAN LOW-VALUES
 10630         MOVE SUFXI              TO CERT-CERT-SUFX
 10631                                    CM-CERT-SFX
 10632         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10633
 10634     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10635
 10636     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10637
 10638     MOVE SPACES                 TO CM-ENTRY-BATCH
 10639                                    CM-LF-EXIT-BATCH
 10640                                    CM-AH-EXIT-BATCH
 10641                                    CM-CREDIT-INTERFACE-SW-1
 10642                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 198
* EL131.cbl
 10643
 10644     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10645                               '9' OR 'D' OR 'V'
 10646         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10647
 10648     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10649                               '9' OR 'D' OR 'V'
 10650         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10651
 10652     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10653                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10654     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10655
 10656
 10657* EXEC CICS HANDLE CONDITION
 10658*         DUPKEY (2080-EXIT)
 10659*    END-EXEC.
 10660*    MOVE '"$$                   ! 3 #00009662' TO DFHEIV0
 10661     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10663     MOVE X'3320233030303039363632' TO DFHEIV0(25:11)
 10664     CALL 'kxdfhei1' USING DFHEIV0
 10665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10666
 10667
 10668
 10669* EXEC CICS WRITE
 10670*         DATASET  (CERT-FILE-ID)
 10671*         RIDFLD   (CERT-KEY)
 10672*         FROM     (CERTIFICATE-MASTER)
 10673*    END-EXEC.
 10674     MOVE LENGTH OF
 10675      CERTIFICATE-MASTER
 10676       TO DFHEIV11
 10677*    MOVE '&$ L                  ''   #00009666' TO DFHEIV0
 10678     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10679     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10680     MOVE X'2020233030303039363636' TO DFHEIV0(25:11)
 10681     CALL 'kxdfhei1' USING DFHEIV0,
 10682           CERT-FILE-ID,
 10683           CERTIFICATE-MASTER,
 10684           DFHEIV11,
 10685           CERT-KEY,
 10686           DFHEIV99,
 10687           DFHEIV99
 10688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10689
 10690
 10691 2080-EXIT.
 10692     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 199
* EL131.cbl
 10694 2100-MOVE-MSTR.
 10695     IF TYPEI GREATER THAN LOW-VALUES
 10696         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10697
 10698     IF STATUSI = LOW-VALUES
 10699         GO TO 2100-NO-STATUS-CHANGE.
 10700
 10701     IF STATUSI = 'OPEN' OR 'O'
 10702         IF CL-CLAIM-STATUS = 'O'
 10703             MOVE SPACES         TO TRLR-SWITCH
 10704                 GO TO 2100-NO-STATUS-CHANGE.
 10705
 10706     IF STATUSI = 'CLOSED' OR 'C'
 10707         IF CL-CLAIM-STATUS = 'C'
 10708             MOVE SPACES         TO TRLR-SWITCH
 10709                 GO TO 2100-NO-STATUS-CHANGE.
 10710
 10711     IF PI-COMPANY-ID = 'DMD'
 10712        IF STATUSI = 'OPEN' OR 'O'
 10713           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10714              MOVE ZERO       TO STATUSL
 10715              MOVE LOW-VALUES TO STATUSI
 10716              GO TO 2100-NO-STATUS-CHANGE.
 10717
 10718     IF PI-COMPANY-ID = 'DMD'
 10719         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10720
 10721     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10722
 10723 2100-NO-STATUS-CHANGE.
 10724
 10725     IF CCNOI GREATER THAN LOW-VALUES
 10726         MOVE CCNOI              TO CL-CCN.
 10727
 10728     IF PROCI GREATER THAN LOW-VALUES
 10729         MOVE PROCI              TO CL-PROCESSOR-ID.
 10730
 10731     if accswi > low-values
 10732        and accswi = 'Y' OR 'N'
 10733        move accswi              to cl-accident-claim-sw
 10734     end-if
 10735     IF SEXI GREATER THAN LOW-VALUES
 10736         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10737
 10738     IF BIRTHI GREATER THAN LOW-VALUES
 10739         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10740
 10741     IF SOCIALI GREATER THAN LOW-VALUES
 10742       AND
 10743        SOCIALI = SPACES
 10744         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10745         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10746         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10747     ELSE
 10748         IF SOCIALI GREATER THAN LOW-VALUES
 10749             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10750
 10751     IF OCCI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 200
* EL131.cbl
 10752         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10753
 10754     IF BENEL GREATER THAN ZERO
 10755         MOVE BENEI              TO CL-BENEFICIARY.
 10756
 10757     IF DIAGI GREATER THAN LOW-VALUES
 10758         MOVE DIAGI              TO WS-DIAGNOSIS.
 10759
 10760     IF PREMTYPI GREATER THAN LOW-VALUES
 10761         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10762
 10763     IF CAUSEI GREATER THAN LOW-VALUES
 10764         MOVE CAUSEI             TO CL-CAUSE-CD.
 10765
 10766     IF ENDI GREATER THAN LOW-VALUES
 10767         MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10768
 10769     IF PDTHRUI GREATER THAN LOW-VALUES
 10770        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10771
 10772     IF PDAMTL GREATER THAN +0
 10773        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10774
 10775     IF NODAYSI GREATER THAN LOW-VALUES
 10776        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10777
 10778     IF NOPMTSI GREATER THAN LOW-VALUES
 10779        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10780
 10781     IF FORMTYPI GREATER THAN LOW-VALUES
 10782        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10783
 10784     IF INCI GREATER THAN LOW-VALUES
 10785        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10786
 10787     IF REPI GREATER THAN LOW-VALUES
 10788        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10789
 10790     IF ADDONDTI GREATER THAN LOW-VALUES
 10791        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10792
 10793     IF PRICDI GREATER THAN LOW-VALUES
 10794         MOVE PRICDI             TO CL-PRIORITY-CD.
 10795
 10796     IF CRITPTL > ZEROS
 10797        MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 10798     END-IF
 10799
 10800     IF RTWMOSL > ZEROS
 10801        MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 10802     END-IF
 10803     IF FILETOI GREATER THAN LOW-VALUES
 10804         MOVE FILETOI            TO CL-FILE-LOCATION.
 10805
 10806     IF SUPVI GREATER THAN LOW-VALUES
 10807         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10808
 10809     IF MLNAMEI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 201
* EL131.cbl
 10810         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10811
 10812     IF MFNAMEI GREATER THAN LOW-VALUES
 10813         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10814
 10815     IF MMINITI GREATER THAN LOW-VALUES
 10816         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10817
 10818     IF CERTEFFI GREATER THAN LOW-VALUES
 10819         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10820
 10821     IF CERTACTI GREATER THAN LOW-VALUES
 10822         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10823
 10824     IF CERTSTI GREATER THAN LOW-VALUES
 10825         MOVE CERTSTI            TO CL-CERT-STATE.
 10826
 10827     IF CERTCARI GREATER THAN LOW-VALUES
 10828         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10829                                    CL-CARRIER.
 10830
 10831     IF CERTGRPI GREATER THAN LOW-VALUES
 10832         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10833
 10834     IF CERTI GREATER THAN LOW-VALUES
 10835         MOVE CERTI              TO CERT-NO-PRIME.
 10836
 10837     IF SUFXI GREATER THAN LOW-VALUES
 10838         MOVE SUFXI              TO CERT-NO-SUFX.
 10839
 10840     MOVE CERT-NO                TO CL-CERT-NO
 10841                                    CL-CERT-NO-A4.
 10842
 10843     IF PI-COMPANY-ID = 'FLA'
 10844          NEXT SENTENCE
 10845     ELSE
 10846         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10847         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10848         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10849         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10850
 10851     IF TRLR-UPDATE-REQUIRED
 10852        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10853        MOVE ZEROS              TO TRLR-SEQ-NO
 10854
 10855* EXEC CICS READ
 10856*            DATASET   (TRLR-FILE-ID)
 10857*            RIDFLD    (TRLR-KEY)
 10858*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10859*       END-EXEC
 10860*    MOVE '&"S        E          (   #00009835' TO DFHEIV0
 10861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10863     MOVE X'2020233030303039383335' TO DFHEIV0(25:11)
 10864     CALL 'kxdfhei1' USING DFHEIV0,
 10865           TRLR-FILE-ID,
 10866           DFHEIV20,
 10867           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 202
* EL131.cbl
 10868           TRLR-KEY,
 10869           DFHEIV99,
 10870           DFHEIV99,
 10871           DFHEIV99
 10872     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10873         DFHEIV20
 10874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10875        IF AT-TRAILER-TYPE = '1'
 10876           MOVE +1 TO MISC-SUB
 10877           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10878           MISC-SUB GREATER THAN +6 OR
 10879           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10880           IF MISC-SUB GREATER THAN +1
 10881              SUBTRACT +1 FROM MISC-SUB
 10882              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10883                 GO TO 2100-BYPASS-LAST-UPDATE.
 10884
 10885     IF TRLR-UPDATE-REQUIRED AND
 10886        CLAIM-IS-OPEN
 10887         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10888     ELSE
 10889         IF TRLR-UPDATE-REQUIRED AND
 10890            CLAIM-IS-CLOSED
 10891             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10892             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10893
 10894 2100-BYPASS-LAST-UPDATE.
 10895     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10896     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10897
 10898     GO TO 2100-EXIT.
 10899
 10900 2100-BUMP-OPEN-CLOSE-HIST.
 10901     ADD +1                      TO MISC-SUB.
 10902
 10903 2100-EXIT.
 10904     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 203
* EL131.cbl
 10906 2120-check-pdef.
 10907
 10908
 10909     move +0                     to s1
 10910     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 10911     move spaces                 to ws-dcc-error-line
 10912     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 10913     IF ERPDEF-FOUND
 10914        perform 2130-check-trlr  thru 2130-exit
 10915        move +1                  to s1
 10916*       if cl-accident-claim-sw = ' '
 10917*          move er-1655             to ws-error-no (s1)
 10918*          add +1 to s1
 10919*       end-if
 10920        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 10921        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 10922        MOVE '1'                 TO DC-OPTION-CODE
 10923        MOVE +0                  TO DC-ELAPSED-MONTHS
 10924                                    DC-ELAPSED-DAYS
 10925        PERFORM 9800-CONVERT-DATE
 10926                                 THRU 9800-EXIT
 10927        IF NO-CONVERSION-ERROR
 10928           MOVE DC-ELAPSED-MONTHS
 10929                                 TO WS-MONTHS-BETWEEN
 10930           IF DC-ELAPSED-DAYS > 1
 10931              ADD 1 TO WS-MONTHS-BETWEEN
 10932           END-IF
 10933        ELSE
 10934           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 10935        END-IF
 10936        IF (WS-EXCL-PERIOD = ZEROS)
 10937           OR (WS-MONTHS-BETWEEN = ZEROS)
 10938           CONTINUE
 10939        ELSE
 10940           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 10941              MOVE ER-1651       TO ws-error-no (s1)
 10942              add +1             to s1
 10943           END-IF
 10944        END-IF
 10945        IF (WS-COV-ENDS = ZEROS)
 10946           OR (WS-MONTHS-BETWEEN = ZEROS)
 10947           CONTINUE
 10948        ELSE
 10949           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 10950              MOVE -1            TO MAINTL
 10951              MOVE ER-1653       TO ws-error-no (s1)
 10952              add +1 to s1
 10953           END-IF
 10954        END-IF
 10955        IF (WS-ACC-PERIOD = ZEROS)
 10956           OR (WS-MONTHS-BETWEEN = ZEROS)
 10957           CONTINUE
 10958        ELSE
 10959           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
 10960              and (cl-accident-claim-sw = ' ')
 10961              move er-1655       to ws-error-no (s1)
 10962              add +1             to s1
 10963           end-if
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 204
* EL131.cbl
 10964           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 10965              if cl-accident-claim-sw not = 'Y'
 10966                 MOVE ER-1652    TO ws-error-no (s1)
 10967              else
 10968                 move er-1662    to ws-error-no (s1)
 10969              end-if
 10970              MOVE -1            TO MAINTL
 10971              add +1             to s1
 10972           END-IF
 10973        END-IF
 10974        if cl-claim-type  = 'I'
 10975           move er-1661          to ws-error-no (s1)
 10976           add +1                to s1
 10977        end-if
 10978        perform 2130-check-trlr  thru 2130-exit
 10979     END-IF
 10980
 10981     .
 10982 2120-exit.
 10983     exit.
 10984
 10985 2130-check-trlr.
 10986
 10987     evaluate true
 10988        when s1 = +0
 10989           move cl-control-primary
 10990                                 to trlr-key
 10991           MOVE +95              TO TRLR-SEQ-NO
 10992
 10993* EXEC CICS READ
 10994*             update
 10995*             DATASET  ('ELTRLR')
 10996*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10997*             RIDFLD   (TRLR-KEY)
 10998*             RESP     (WS-RESPONSE)
 10999*          END-EXEC
 11000     MOVE 'ELTRLR' TO DFHEIV1
 11001*    MOVE '&"S        EU         (  N#00009957' TO DFHEIV0
 11002     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11003     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11004     MOVE X'204E233030303039393537' TO DFHEIV0(25:11)
 11005     CALL 'kxdfhei1' USING DFHEIV0,
 11006           DFHEIV1,
 11007           DFHEIV20,
 11008           DFHEIV99,
 11009           TRLR-KEY,
 11010           DFHEIV99,
 11011           DFHEIV99,
 11012           DFHEIV99
 11013     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11014         DFHEIV20
 11015     MOVE EIBRESP  TO WS-RESPONSE
 11016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11017           if ws-resp-normal
 11018              move spaces        to at-info-line-1
 11019           end-if
 11020        when s1 = +1
 11021           if ws-resp-normal
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 205
* EL131.cbl
 11022
 11023* exec cics rewrite
 11024*                dataset   ('ELTRLR')
 11025*                from      (activity-trailers)
 11026*             end-exec
 11027     MOVE LENGTH OF
 11028      activity-trailers
 11029       TO DFHEIV11
 11030     MOVE 'ELTRLR' TO DFHEIV1
 11031*    MOVE '&& L                  %   #00009969' TO DFHEIV0
 11032     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11033     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11034     MOVE X'2020233030303039393639' TO DFHEIV0(25:11)
 11035     CALL 'kxdfhei1' USING DFHEIV0,
 11036           DFHEIV1,
 11037           activity-trailers,
 11038           DFHEIV11,
 11039           DFHEIV99
 11040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11041           end-if
 11042        when s1 > +1
 11043           if ws-resp-normal
 11044              move ws-dcc-error-line
 11045                                 to at-info-line-1
 11046
 11047* exec cics rewrite
 11048*                dataset   ('ELTRLR')
 11049*                from      (activity-trailers)
 11050*             end-exec
 11051     MOVE LENGTH OF
 11052      activity-trailers
 11053       TO DFHEIV11
 11054     MOVE 'ELTRLR' TO DFHEIV1
 11055*    MOVE '&& L                  %   #00009978' TO DFHEIV0
 11056     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11057     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11058     MOVE X'2020233030303039393738' TO DFHEIV0(25:11)
 11059     CALL 'kxdfhei1' USING DFHEIV0,
 11060           DFHEIV1,
 11061           activity-trailers,
 11062           DFHEIV11,
 11063           DFHEIV99
 11064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11065           else
 11066
 11067* EXEC CICS GETMAIN
 11068*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11069*                LENGTH   (TRLR-LENGTH)
 11070*                INITIMG  (GETMAIN-SPACE)
 11071*             END-EXEC
 11072*    MOVE ',"IL                  $   #00009983' TO DFHEIV0
 11073     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11074     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11075     MOVE X'2020233030303039393833' TO DFHEIV0(25:11)
 11076     CALL 'kxdfhei1' USING DFHEIV0,
 11077           DFHEIV20,
 11078           TRLR-LENGTH,
 11079           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 206
* EL131.cbl
 11080     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11081         DFHEIV20
 11082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11083              move 'AT'          to at-record-id
 11084              move cl-control-primary
 11085                                 to at-control-primary
 11086              move +95           to at-sequence-no
 11087              move '6'           to at-trailer-type
 11088              move ws-dcc-error-line
 11089                                 to at-info-line-1
 11090              move 'E'           to at-info-trailer-type
 11091              move save-bin-date to at-recorded-dt
 11092                                    at-gen-info-last-maint-dt
 11093              move pi-processor-id
 11094                                 to at-recorded-by
 11095                                    at-gen-info-last-updated-by
 11096              move eibtime       to at-last-maint-hhmmss
 11097
 11098* exec cics write
 11099*                dataset   ('ELTRLR')
 11100*                from      (activity-trailers)
 11101*                ridfld    (trlr-key)
 11102*             end-exec
 11103     MOVE LENGTH OF
 11104      activity-trailers
 11105       TO DFHEIV11
 11106     MOVE 'ELTRLR' TO DFHEIV1
 11107*    MOVE '&$ L                  ''   #00010002' TO DFHEIV0
 11108     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11109     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11110     MOVE X'2020233030303130303032' TO DFHEIV0(25:11)
 11111     CALL 'kxdfhei1' USING DFHEIV0,
 11112           DFHEIV1,
 11113           activity-trailers,
 11114           DFHEIV11,
 11115           trlr-key,
 11116           DFHEIV99,
 11117           DFHEIV99
 11118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11119              perform varying s1 from +1 by +1 until
 11120                 ws-error-no (s1) = spaces
 11121                 move ws-error-no (s1)
 11122                                 to emi-error
 11123                 PERFORM 9900-ERROR-FORMAT
 11124                                 THRU 9900-EXIT
 11125              end-perform
 11126           end-if
 11127     end-evaluate
 11128
 11129     .
 11130 2130-exit.
 11131     exit.
 11132 2200-MOVE-CERT.
 11133     IF CRTLNMEI GREATER THAN LOW-VALUES
 11134         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11135
 11136     IF CRTFNMEI GREATER THAN LOW-VALUES
 11137         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 207
* EL131.cbl
 11138         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11139
 11140     IF CRTINITI GREATER THAN LOW-VALUES
 11141         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11142
 11143     IF CM-INSURED-INITIALS = SPACES
 11144         MOVE '**'               TO CM-INSURED-INITIALS.
 11145
 11146     IF ISSAGEI GREATER THAN LOW-VALUES
 11147         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11148
 11149     IF JNTFNMEI GREATER THAN LOW-VALUES
 11150         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11151
 11152     IF JNTLNMEI GREATER THAN LOW-VALUES
 11153         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11154
 11155     IF JNTINITI GREATER THAN LOW-VALUES
 11156         MOVE JNTINITI           TO CM-JT-INITIAL.
 11157
 11158     IF JNTAGEI GREATER THAN LOW-VALUES
 11159         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11160
 11161     IF ADDONDTI GREATER THAN LOW-VALUES
 11162        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11163
 11164     IF LCVCDI GREATER THAN LOW-VALUES
 11165        IF LCVCDI = SPACES OR ZEROS
 11166           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11167        ELSE
 11168           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11169
 11170     IF LCVOTRMI GREATER THAN LOW-VALUES
 11171         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11172
 11173     IF LCVRATEL GREATER THAN +0
 11174         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11175
 11176     IF LCVBENEL GREATER THAN +0
 11177         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11178
 11179     IF LCVFORMI GREATER THAN LOW-VALUES
 11180         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11181
 11182     IF LCVCNDTI = LOW-VALUES
 11183        GO TO 2210-SET-STATUS.
 11184
 11185     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11186        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11187        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11188        GO TO 2210-SET-STATUS.
 11189
 11190     IF CM-LF-CURRENT-STATUS = '7'
 11191        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11192        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11193        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11194                                    CM-LF-DEATH-DT
 11195        GO TO 2210-SET-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 208
* EL131.cbl
 11196
 11197     IF CM-LF-CURRENT-STATUS = '8'
 11198        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11199        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11200                                    CM-LF-CANCEL-DT.
 11201
 11202 2210-SET-STATUS.
 11203
 11204     IF CM-LF-CURRENT-STATUS = SPACES
 11205         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11206
 11207     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11208         MOVE '6'                TO DC-OPTION-CODE
 11209         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11210         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11211         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11212         IF NO-CONVERSION-ERROR
 11213             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11214         ELSE
 11215             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11216     ELSE
 11217         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11218
 11219 2215-PROCESS-AH-SIDE.
 11220
 11221     IF ACVCDI GREATER THAN LOW-VALUES
 11222        IF ACVCDI = SPACES OR ZEROS
 11223           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11224        ELSE
 11225           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11226
 11227     IF ACVOTRMI GREATER THAN LOW-VALUES
 11228         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11229
 11230     IF ACVRATEL GREATER THAN +0
 11231         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11232
 11233     IF ACVBENEL GREATER THAN +0
 11234         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 11235                                    PI-PAYMENT-AMT.
 11236
 11237     IF ACVFORMI GREATER THAN LOW-VALUES
 11238         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11239
 11240     IF ACVCNDTI = LOW-VALUES
 11241        GO TO 2220-SET-STATUS.
 11242
 11243     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11244        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11245        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11246        GO TO 2220-SET-STATUS.
 11247
 11248     IF CM-AH-CURRENT-STATUS = '6'
 11249        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11250                                 TO CM-AH-CURRENT-STATUS
 11251        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11252        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11253                                    CM-AH-SETTLEMENT-DT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 209
* EL131.cbl
 11254        GO TO 2220-SET-STATUS.
 11255
 11256     IF CM-AH-CURRENT-STATUS = '8'
 11257        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11258        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11259                                    CM-AH-CANCEL-DT.
 11260
 11261 2220-SET-STATUS.
 11262     IF CM-AH-CURRENT-STATUS = SPACES
 11263         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11264
 11265     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11266         MOVE '6'                TO DC-OPTION-CODE
 11267         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11268         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11269         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11270         IF NO-CONVERSION-ERROR
 11271             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 11272         ELSE
 11273             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 11274     ELSE
 11275         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 11276
 11277 2225-FINISH-CERT.
 11278     IF APRL GREATER THAN +0
 11279         MOVE HOLD-APR           TO CM-LOAN-APR.
 11280
 11281     IF PMTFREQI GREATER THAN LOW-VALUES
 11282         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 11283
 11284     IF INDGRPI GREATER THAN LOW-VALUES
 11285         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 11286
 11287     IF LOANNOI GREATER THAN LOW-VALUES
 11288        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 11289
 11290     IF LOANBALL GREATER THAN +0
 11291        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 11292
 11293     IF PREMTYPI GREATER THAN LOW-VALUES
 11294         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 11295
 11296     IF REINCDI GREATER THAN LOW-VALUES
 11297         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 11298                                    WS-REIN-1
 11299                                    WS-REIN-2
 11300                                    WS-REIN-3
 11301         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 11302
 11303     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 11304
 11305     MOVE ZEROS                  TO CM-LOAN-TERM
 11306                                    CM-LIFE-COMM-PCT
 11307                                    CM-AH-COMM-PCT.
 11308
 11309*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 11310*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 11311*         PI-NO-PMTS = ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 210
* EL131.cbl
 11312*          IF LOANBALL GREATER THAN +0          OR
 11313*             ACVBENEL GREATER THAN +0          OR
 11314*             APRL     GREATER THAN +0          OR
 11315*             LCVRATEL GREATER THAN +0          OR
 11316*             ACVRATEL GREATER THAN +0
 11317*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 11318
 11319 2200-EXIT.
 11320     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 211
* EL131.cbl
 11322 2300-UPDATE-TRLR.
 11323     MOVE ZERO                   TO TRLR-SEQ-NO.
 11324
 11325* EXEC CICS READ UPDATE
 11326*         DATASET  (TRLR-FILE-ID)
 11327*         RIDFLD   (TRLR-KEY)
 11328*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11329*    END-EXEC.
 11330*    MOVE '&"S        EU         (   #00010212' TO DFHEIV0
 11331     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11332     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11333     MOVE X'2020233030303130323132' TO DFHEIV0(25:11)
 11334     CALL 'kxdfhei1' USING DFHEIV0,
 11335           TRLR-FILE-ID,
 11336           DFHEIV20,
 11337           DFHEIV99,
 11338           TRLR-KEY,
 11339           DFHEIV99,
 11340           DFHEIV99,
 11341           DFHEIV99
 11342     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11343         DFHEIV20
 11344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11345
 11346
 11347     MOVE ZERO                   TO COUNT-2.
 11348
 11349     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11350         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11351
 11352     IF NOT UPDATE-MADE
 11353         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11354
 11355
 11356* EXEC CICS REWRITE
 11357*         DATASET  (TRLR-FILE-ID)
 11358*         FROM     (ACTIVITY-TRAILERS)
 11359*    END-EXEC.
 11360     MOVE LENGTH OF
 11361      ACTIVITY-TRAILERS
 11362       TO DFHEIV11
 11363*    MOVE '&& L                  %   #00010226' TO DFHEIV0
 11364     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11365     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11366     MOVE X'2020233030303130323236' TO DFHEIV0(25:11)
 11367     CALL 'kxdfhei1' USING DFHEIV0,
 11368           TRLR-FILE-ID,
 11369           ACTIVITY-TRAILERS,
 11370           DFHEIV11,
 11371           DFHEIV99
 11372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11373
 11374
 11375 2300-EXIT.
 11376     EXIT.
 11377
 11378 2310-INS-STATUS.
 11379     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 212
* EL131.cbl
 11380     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 11381         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 11382         MOVE 'Y'                TO TRLR-SWITCH.
 11383
 11384 2310-EXIT.
 11385     EXIT.
 11386
 11387 2320-SHIFT-STATUS.
 11388     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 11389        MOVE 6                   TO COUNT-2
 11390        GO TO 2320-EXIT.
 11391
 11392     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 11393     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 11394     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 11395     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 11396     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 11397     MOVE 6       TO COUNT-2.
 11398     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 11399
 11400 2320-EXIT.
 11401     EXIT.
 11402
 11403 2330-ADD-UPDATE.
 11404
 11405     IF COUNT-2 GREATER THAN 1
 11406        COMPUTE MISC-SUB = (COUNT-2 - 1)
 11407        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11408           GO TO 2330-EXIT.
 11409
 11410     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 11411                                   AT-RESERVES-LAST-MAINT-DT
 11412
 11413     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 11414     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 11415     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 11416     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 11417
 11418 2330-EXIT.
 11419     EXIT.
 11420
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 213
* EL131.cbl
 11422 2400-UPDATE-TRLR.
 11423
 11424* EXEC CICS HANDLE CONDITION
 11425*         NOTFND    (2400-TRLR-NOTFND)
 11426*         ENDFILE   (2410-EXIT)
 11427*    END-EXEC.
 11428*    MOVE '"$I''                  ! 4 #00010279' TO DFHEIV0
 11429     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11431     MOVE X'3420233030303130323739' TO DFHEIV0(25:11)
 11432     CALL 'kxdfhei1' USING DFHEIV0
 11433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11434
 11435
 11436
 11437* EXEC CICS STARTBR
 11438*        DATASET (TRLR-FILE-ID)
 11439*        RIDFLD  (TRLR-KEY)
 11440*    END-EXEC.
 11441     MOVE 0
 11442       TO DFHEIV11
 11443*    MOVE '&,         G          &   #00010284' TO DFHEIV0
 11444     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11445     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11446     MOVE X'2020233030303130323834' TO DFHEIV0(25:11)
 11447     CALL 'kxdfhei1' USING DFHEIV0,
 11448           TRLR-FILE-ID,
 11449           TRLR-KEY,
 11450           DFHEIV99,
 11451           DFHEIV11,
 11452           DFHEIV99
 11453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11454
 11455
 11456
 11457* EXEC CICS GETMAIN
 11458*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11459*         LENGTH    (TRLR-LENGTH)
 11460*         INITIMG   (GETMAIN-SPACE)
 11461*    END-EXEC.
 11462*    MOVE ',"IL                  $   #00010289' TO DFHEIV0
 11463     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11464     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11465     MOVE X'2020233030303130323839' TO DFHEIV0(25:11)
 11466     CALL 'kxdfhei1' USING DFHEIV0,
 11467           DFHEIV20,
 11468           TRLR-LENGTH,
 11469           GETMAIN-SPACE
 11470     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11471         DFHEIV20
 11472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11473
 11474
 11475     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 11476
 11477
 11478* EXEC CICS ENDBR
 11479*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 214
* EL131.cbl
 11480*    END-EXEC.
 11481     MOVE 0
 11482       TO DFHEIV11
 11483*    MOVE '&2                    $   #00010297' TO DFHEIV0
 11484     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11485     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11486     MOVE X'2020233030303130323937' TO DFHEIV0(25:11)
 11487     CALL 'kxdfhei1' USING DFHEIV0,
 11488           TRLR-FILE-ID,
 11489           DFHEIV11,
 11490           DFHEIV99
 11491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11492
 11493
 11494     GO TO 2400-EXIT.
 11495
 11496 2400-TRLR-NOTFND.
 11497     MOVE ER-0205                TO EMI-ERROR.
 11498     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11499     MOVE 'X'                    TO ERROR-SWITCH.
 11500
 11501 2400-EXIT.
 11502     EXIT.
 11503
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 215
* EL131.cbl
 11505 2410-CHANGE-TRLR.
 11506
 11507* EXEC CICS READNEXT
 11508*        DATASET (TRLR-FILE-ID)
 11509*        RIDFLD  (TRLR-KEY)
 11510*        INTO    (ACTIVITY-TRAILERS)
 11511*    END-EXEC.
 11512     MOVE LENGTH OF
 11513      ACTIVITY-TRAILERS
 11514       TO DFHEIV12
 11515     MOVE 0
 11516       TO DFHEIV11
 11517*    MOVE '&.IL                  )   #00010313' TO DFHEIV0
 11518     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11519     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11520     MOVE X'2020233030303130333133' TO DFHEIV0(25:11)
 11521     CALL 'kxdfhei1' USING DFHEIV0,
 11522           TRLR-FILE-ID,
 11523           ACTIVITY-TRAILERS,
 11524           DFHEIV12,
 11525           TRLR-KEY,
 11526           DFHEIV99,
 11527           DFHEIV11,
 11528           DFHEIV99,
 11529           DFHEIV99
 11530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11531
 11532
 11533     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 11534        GO TO 2410-CHANGE-TRLR.
 11535
 11536     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 11537                                    CHECK-KEY.
 11538
 11539     IF CHECK-KEY NOT = MSTR-KEY
 11540         GO TO 2410-EXIT.
 11541
 11542
 11543* EXEC CICS ENDBR
 11544*        DATASET (TRLR-FILE-ID)
 11545*    END-EXEC.
 11546     MOVE 0
 11547       TO DFHEIV11
 11548*    MOVE '&2                    $   #00010328' TO DFHEIV0
 11549     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11550     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11551     MOVE X'2020233030303130333238' TO DFHEIV0(25:11)
 11552     CALL 'kxdfhei1' USING DFHEIV0,
 11553           TRLR-FILE-ID,
 11554           DFHEIV11,
 11555           DFHEIV99
 11556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11557
 11558
 11559
 11560* EXEC CICS READ UPDATE
 11561*        DATASET (TRLR-FILE-ID)
 11562*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 216
* EL131.cbl
 11563*        INTO    (ACTIVITY-TRAILERS)
 11564*    END-EXEC.
 11565     MOVE LENGTH OF
 11566      ACTIVITY-TRAILERS
 11567       TO DFHEIV11
 11568*    MOVE '&"IL       EU         (   #00010332' TO DFHEIV0
 11569     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11570     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11571     MOVE X'2020233030303130333332' TO DFHEIV0(25:11)
 11572     CALL 'kxdfhei1' USING DFHEIV0,
 11573           TRLR-FILE-ID,
 11574           ACTIVITY-TRAILERS,
 11575           DFHEIV11,
 11576           TRLR-KEY,
 11577           DFHEIV99,
 11578           DFHEIV99,
 11579           DFHEIV99
 11580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11581
 11582
 11583
 11584* EXEC CICS DELETE
 11585*        DATASET (TRLR-FILE-ID)
 11586*    END-EXEC.
 11587*    MOVE '&(                    &   #00010338' TO DFHEIV0
 11588     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11589     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11590     MOVE X'2020233030303130333338' TO DFHEIV0(25:11)
 11591     CALL 'kxdfhei1' USING DFHEIV0,
 11592           TRLR-FILE-ID,
 11593           DFHEIV99,
 11594           DFHEIV99,
 11595           DFHEIV99,
 11596           DFHEIV99
 11597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11598
 11599
 11600     IF AT-SEQUENCE-NO = ZERO AND
 11601        TRLR-UPDATE-REQUIRED
 11602         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 11603
 11604     IF CERTI GREATER THAN LOW-VALUES
 11605        MOVE CERTI               TO AT-CERT-PRIME.
 11606
 11607     IF SUFXI GREATER THAN LOW-VALUES
 11608        MOVE SUFXI               TO AT-CERT-SFX.
 11609
 11610     IF CERTCARI GREATER THAN LOW-VALUES
 11611        MOVE CERTCARI            TO AT-CARRIER.
 11612
 11613     IF PAYMENT-TR
 11614        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 11615           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 11616              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 11617
 11618     IF CORRESPONDENCE-TR
 11619        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 11620           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 217
* EL131.cbl
 11621
 11622
 11623* EXEC CICS WRITE
 11624*         DATASET  (TRLR-FILE-ID)
 11625*         RIDFLD   (AT-CONTROL-PRIMARY)
 11626*         FROM     (ACTIVITY-TRAILERS)
 11627*    END-EXEC.
 11628     MOVE LENGTH OF
 11629      ACTIVITY-TRAILERS
 11630       TO DFHEIV11
 11631*    MOVE '&$ L                  ''   #00010364' TO DFHEIV0
 11632     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11633     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11634     MOVE X'2020233030303130333634' TO DFHEIV0(25:11)
 11635     CALL 'kxdfhei1' USING DFHEIV0,
 11636           TRLR-FILE-ID,
 11637           ACTIVITY-TRAILERS,
 11638           DFHEIV11,
 11639           AT-CONTROL-PRIMARY,
 11640           DFHEIV99,
 11641           DFHEIV99
 11642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11643
 11644
 11645
 11646* EXEC CICS STARTBR
 11647*         DATASET  (TRLR-FILE-ID)
 11648*         RIDFLD   (TRLR-KEY)
 11649*    END-EXEC.
 11650     MOVE 0
 11651       TO DFHEIV11
 11652*    MOVE '&,         G          &   #00010370' TO DFHEIV0
 11653     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11654     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11655     MOVE X'2020233030303130333730' TO DFHEIV0(25:11)
 11656     CALL 'kxdfhei1' USING DFHEIV0,
 11657           TRLR-FILE-ID,
 11658           TRLR-KEY,
 11659           DFHEIV99,
 11660           DFHEIV11,
 11661           DFHEIV99
 11662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11663
 11664
 11665     GO TO 2410-CHANGE-TRLR.
 11666
 11667 2410-EXIT.
 11668     EXIT.
 11669
 11670 2420-UPDATE-TRLR.
 11671     MOVE ZERO TO COUNT-2.
 11672     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11673         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11674
 11675     IF NOT UPDATE-MADE
 11676         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11677
 11678 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 218
* EL131.cbl
 11679     EXIT.
 11680
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 219
* EL131.cbl
 11682 2425-UPDATE-NINETY-TRLR.
 11683
 11684     MOVE +90                    TO TRLR-SEQ-NO.
 11685
 11686
 11687* EXEC CICS HANDLE CONDITION
 11688*         NOTFND    (2425-NINETY-NOTFND)
 11689*         ENDFILE   (2425-NINETY-NOTFND)
 11690*    END-EXEC.
 11691*    MOVE '"$I''                  ! 5 #00010396' TO DFHEIV0
 11692     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11693     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11694     MOVE X'3520233030303130333936' TO DFHEIV0(25:11)
 11695     CALL 'kxdfhei1' USING DFHEIV0
 11696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11697
 11698
 11699
 11700* EXEC CICS READ UPDATE
 11701*        DATASET (TRLR-FILE-ID)
 11702*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11703*        RIDFLD  (TRLR-KEY)
 11704*    END-EXEC.
 11705*    MOVE '&"S        EU         (   #00010401' TO DFHEIV0
 11706     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11707     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11708     MOVE X'2020233030303130343031' TO DFHEIV0(25:11)
 11709     CALL 'kxdfhei1' USING DFHEIV0,
 11710           TRLR-FILE-ID,
 11711           DFHEIV20,
 11712           DFHEIV99,
 11713           TRLR-KEY,
 11714           DFHEIV99,
 11715           DFHEIV99,
 11716           DFHEIV99
 11717     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11718         DFHEIV20
 11719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11720
 11721
 11722     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 11723
 11724     MOVE DIAGI                 TO AT-INFO-LINE-1.
 11725
 11726
 11727* EXEC CICS REWRITE
 11728*        DATASET (TRLR-FILE-ID)
 11729*        FROM    (ACTIVITY-TRAILERS)
 11730*    END-EXEC.
 11731     MOVE LENGTH OF
 11732      ACTIVITY-TRAILERS
 11733       TO DFHEIV11
 11734*    MOVE '&& L                  %   #00010411' TO DFHEIV0
 11735     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11736     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11737     MOVE X'2020233030303130343131' TO DFHEIV0(25:11)
 11738     CALL 'kxdfhei1' USING DFHEIV0,
 11739           TRLR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 220
* EL131.cbl
 11740           ACTIVITY-TRAILERS,
 11741           DFHEIV11,
 11742           DFHEIV99
 11743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11744
 11745
 11746     IF DIAGI NOT = WS-DIAGNOSIS
 11747         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11748         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11749         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11750
 11751     GO TO 2425-EXIT.
 11752
 11753 2425-NINETY-NOTFND.
 11754
 11755
 11756* EXEC CICS GETMAIN
 11757*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11758*         LENGTH    (TRLR-LENGTH)
 11759*         INITIMG   (GETMAIN-SPACE)
 11760*    END-EXEC.
 11761*    MOVE ',"IL                  $   #00010425' TO DFHEIV0
 11762     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11763     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11764     MOVE X'2020233030303130343235' TO DFHEIV0(25:11)
 11765     CALL 'kxdfhei1' USING DFHEIV0,
 11766           DFHEIV20,
 11767           TRLR-LENGTH,
 11768           GETMAIN-SPACE
 11769     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11770         DFHEIV20
 11771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11772
 11773
 11774     MOVE +90                  TO TRLR-SEQ-NO.
 11775     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11776
 11777     MOVE 'AT'                 TO AT-RECORD-ID
 11778     MOVE '6'                  TO AT-TRAILER-TYPE
 11779     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11780                                  AT-GEN-INFO-LAST-MAINT-DT
 11781     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11782                                  AT-GEN-INFO-LAST-UPDATED-BY
 11783     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11784     MOVE DIAGI                TO AT-INFO-LINE-1.
 11785
 11786
 11787* EXEC CICS WRITE
 11788*        DATASET (TRLR-FILE-ID)
 11789*        FROM    (ACTIVITY-TRAILERS)
 11790*        RIDFLD  (TRLR-KEY)
 11791*    END-EXEC.
 11792     MOVE LENGTH OF
 11793      ACTIVITY-TRAILERS
 11794       TO DFHEIV11
 11795*    MOVE '&$ L                  ''   #00010443' TO DFHEIV0
 11796     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11797     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 221
* EL131.cbl
 11798     MOVE X'2020233030303130343433' TO DFHEIV0(25:11)
 11799     CALL 'kxdfhei1' USING DFHEIV0,
 11800           TRLR-FILE-ID,
 11801           ACTIVITY-TRAILERS,
 11802           DFHEIV11,
 11803           TRLR-KEY,
 11804           DFHEIV99,
 11805           DFHEIV99
 11806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11807
 11808
 11809 2425-EXIT.
 11810     EXIT.
 11811
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 222
* EL131.cbl
 11813 2430-UPDATE-ACTQ.
 11814
 11815* EXEC CICS HANDLE CONDITION
 11816*         NOTFND    (2430-EXIT)
 11817*         ENDFILE   (2440-EXIT)
 11818*    END-EXEC.
 11819*    MOVE '"$I''                  ! 6 #00010454' TO DFHEIV0
 11820     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11821     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11822     MOVE X'3620233030303130343534' TO DFHEIV0(25:11)
 11823     CALL 'kxdfhei1' USING DFHEIV0
 11824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11825
 11826
 11827
 11828* EXEC CICS STARTBR
 11829*         DATASET  (ACTQ-FILE-ID)
 11830*         RIDFLD   (ACTQ-KEY)
 11831*    END-EXEC.
 11832     MOVE 0
 11833       TO DFHEIV11
 11834*    MOVE '&,         G          &   #00010459' TO DFHEIV0
 11835     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11836     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11837     MOVE X'2020233030303130343539' TO DFHEIV0(25:11)
 11838     CALL 'kxdfhei1' USING DFHEIV0,
 11839           ACTQ-FILE-ID,
 11840           ACTQ-KEY,
 11841           DFHEIV99,
 11842           DFHEIV11,
 11843           DFHEIV99
 11844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11845
 11846
 11847
 11848* EXEC CICS GETMAIN
 11849*         SET      (ADDRESS OF ACTIVITY-QUE)
 11850*         LENGTH   (ACTQ-LENGTH)
 11851*         INITIMG  (GETMAIN-SPACE)
 11852*    END-EXEC.
 11853*    MOVE ',"IL                  $   #00010464' TO DFHEIV0
 11854     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11855     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11856     MOVE X'2020233030303130343634' TO DFHEIV0(25:11)
 11857     CALL 'kxdfhei1' USING DFHEIV0,
 11858           DFHEIV20,
 11859           ACTQ-LENGTH,
 11860           GETMAIN-SPACE
 11861     SET ADDRESS OF ACTIVITY-QUE TO
 11862         DFHEIV20
 11863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11864
 11865
 11866     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11867
 11868 2430-EXIT.
 11869     EXIT.
 11870
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 223
* EL131.cbl
 11871 2440-CHANGE-ACTQ.
 11872
 11873
 11874* EXEC CICS READNEXT
 11875*         DATASET  (ACTQ-FILE-ID)
 11876*         RIDFLD   (ACTQ-KEY)
 11877*         INTO     (ACTIVITY-QUE)
 11878*    END-EXEC.
 11879     MOVE LENGTH OF
 11880      ACTIVITY-QUE
 11881       TO DFHEIV12
 11882     MOVE 0
 11883       TO DFHEIV11
 11884*    MOVE '&.IL                  )   #00010477' TO DFHEIV0
 11885     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11886     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11887     MOVE X'2020233030303130343737' TO DFHEIV0(25:11)
 11888     CALL 'kxdfhei1' USING DFHEIV0,
 11889           ACTQ-FILE-ID,
 11890           ACTIVITY-QUE,
 11891           DFHEIV12,
 11892           ACTQ-KEY,
 11893           DFHEIV99,
 11894           DFHEIV11,
 11895           DFHEIV99,
 11896           DFHEIV99
 11897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11898
 11899
 11900
 11901* EXEC CICS ENDBR
 11902*         DATASET (ACTQ-FILE-ID)
 11903*    END-EXEC.
 11904     MOVE 0
 11905       TO DFHEIV11
 11906*    MOVE '&2                    $   #00010483' TO DFHEIV0
 11907     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11908     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11909     MOVE X'2020233030303130343833' TO DFHEIV0(25:11)
 11910     CALL 'kxdfhei1' USING DFHEIV0,
 11911           ACTQ-FILE-ID,
 11912           DFHEIV11,
 11913           DFHEIV99
 11914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11915
 11916
 11917     IF ACTQ-KEY NOT = MSTR-KEY
 11918         GO TO 2440-EXIT.
 11919
 11920
 11921* EXEC CICS READ UPDATE
 11922*         DATASET  (ACTQ-FILE-ID)
 11923*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11924*         SET      (ADDRESS OF ACTIVITY-QUE)
 11925*    END-EXEC.
 11926*    MOVE '&"S        EU         (   #00010490' TO DFHEIV0
 11927     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11928     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 224
* EL131.cbl
 11929     MOVE X'2020233030303130343930' TO DFHEIV0(25:11)
 11930     CALL 'kxdfhei1' USING DFHEIV0,
 11931           ACTQ-FILE-ID,
 11932           DFHEIV20,
 11933           DFHEIV99,
 11934           AQ-CONTROL-PRIMARY,
 11935           DFHEIV99,
 11936           DFHEIV99,
 11937           DFHEIV99
 11938     SET ADDRESS OF ACTIVITY-QUE TO
 11939         DFHEIV20
 11940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11941
 11942
 11943     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 11944
 11945
 11946* EXEC CICS DELETE
 11947*         DATASET (ACTQ-FILE-ID)
 11948*    END-EXEC.
 11949*    MOVE '&(                    &   #00010498' TO DFHEIV0
 11950     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11951     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11952     MOVE X'2020233030303130343938' TO DFHEIV0(25:11)
 11953     CALL 'kxdfhei1' USING DFHEIV0,
 11954           ACTQ-FILE-ID,
 11955           DFHEIV99,
 11956           DFHEIV99,
 11957           DFHEIV99,
 11958           DFHEIV99
 11959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11960
 11961
 11962     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 11963     IF CERTI GREATER THAN LOW-VALUES
 11964        MOVE CERTI               TO AQ-CERT-PRIME.
 11965     IF SUFXI GREATER THAN LOW-VALUES
 11966        MOVE SUFXI               TO AQ-CERT-SFX.
 11967     IF CERTCARI GREATER THAN LOW-VALUES
 11968        MOVE CERTCARI            TO AQ-CARRIER.
 11969
 11970
 11971* EXEC CICS HANDLE CONDITION
 11972*         DUPREC   (2440-EXIT)
 11973*    END-EXEC.
 11974*    MOVE '"$%                   ! 7 #00010510' TO DFHEIV0
 11975     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11976     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11977     MOVE X'3720233030303130353130' TO DFHEIV0(25:11)
 11978     CALL 'kxdfhei1' USING DFHEIV0
 11979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11980
 11981
 11982
 11983* EXEC CICS WRITE
 11984*         DATASET  (ACTQ-FILE-ID)
 11985*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11986*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 225
* EL131.cbl
 11987*    END-EXEC.
 11988     MOVE LENGTH OF
 11989      ACTIVITY-QUE
 11990       TO DFHEIV11
 11991*    MOVE '&$ L                  ''   #00010514' TO DFHEIV0
 11992     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11993     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11994     MOVE X'2020233030303130353134' TO DFHEIV0(25:11)
 11995     CALL 'kxdfhei1' USING DFHEIV0,
 11996           ACTQ-FILE-ID,
 11997           ACTIVITY-QUE,
 11998           DFHEIV11,
 11999           AQ-CONTROL-PRIMARY,
 12000           DFHEIV99,
 12001           DFHEIV99
 12002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12003
 12004
 12005 2440-EXIT.
 12006     EXIT.
 12007
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 226
* EL131.cbl
 12009 2460-UPDATE-CHECKQ.
 12010
 12011* EXEC CICS HANDLE CONDITION
 12012*         NOTFND   (2460-EXIT)
 12013*    END-EXEC.
 12014*    MOVE '"$I                   ! 8 #00010525' TO DFHEIV0
 12015     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12016     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12017     MOVE X'3820233030303130353235' TO DFHEIV0(25:11)
 12018     CALL 'kxdfhei1' USING DFHEIV0
 12019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12020
 12021
 12022     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12023     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12024     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12025
 12026
 12027* EXEC CICS READ UPDATE
 12028*         DATASET   (CHKQ-FILE-ID)
 12029*         RIDFLD    (CHKQ-KEY)
 12030*         SET       (ADDRESS OF CHECK-QUE)
 12031*    END-EXEC.
 12032*    MOVE '&"S        EU         (   #00010533' TO DFHEIV0
 12033     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12034     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12035     MOVE X'2020233030303130353333' TO DFHEIV0(25:11)
 12036     CALL 'kxdfhei1' USING DFHEIV0,
 12037           CHKQ-FILE-ID,
 12038           DFHEIV20,
 12039           DFHEIV99,
 12040           CHKQ-KEY,
 12041           DFHEIV99,
 12042           DFHEIV99,
 12043           DFHEIV99
 12044     SET ADDRESS OF CHECK-QUE TO
 12045         DFHEIV20
 12046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12047
 12048
 12049     IF CERTI GREATER THAN LOW-VALUES
 12050        MOVE CERTI               TO CQ-CERT-PRIME.
 12051     IF SUFXI GREATER THAN LOW-VALUES
 12052        MOVE SUFXI               TO CQ-CERT-SFX.
 12053     IF CERTCARI GREATER THAN LOW-VALUES
 12054        MOVE CERTCARI            TO CQ-CARRIER.
 12055
 12056
 12057* EXEC CICS REWRITE
 12058*         DATASET  (CHKQ-FILE-ID)
 12059*         FROM     (CHECK-QUE)
 12060*    END-EXEC.
 12061     MOVE LENGTH OF
 12062      CHECK-QUE
 12063       TO DFHEIV11
 12064*    MOVE '&& L                  %   #00010546' TO DFHEIV0
 12065     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12066     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 227
* EL131.cbl
 12067     MOVE X'2020233030303130353436' TO DFHEIV0(25:11)
 12068     CALL 'kxdfhei1' USING DFHEIV0,
 12069           CHKQ-FILE-ID,
 12070           CHECK-QUE,
 12071           DFHEIV11,
 12072           DFHEIV99
 12073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12074
 12075
 12076 2460-EXIT.
 12077     EXIT.
 12078
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 228
* EL131.cbl
 12080 2475-UPDATE-LETTER.
 12081
 12082* EXEC CICS HANDLE CONDITION
 12083*         NOTFND   (2475-EXIT)
 12084*    END-EXEC.
 12085*    MOVE '"$I                   ! 9 #00010556' TO DFHEIV0
 12086     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12087     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12088     MOVE X'3920233030303130353536' TO DFHEIV0(25:11)
 12089     CALL 'kxdfhei1' USING DFHEIV0
 12090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12091
 12092
 12093     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12094     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12095     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12096     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12097
 12098
 12099* EXEC CICS READ UPDATE
 12100*         DATASET   (ARCH-FILE-ID)
 12101*         RIDFLD    (ARCH-KEY)
 12102*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12103*    END-EXEC.
 12104*    MOVE '&"S        EU         (   #00010565' TO DFHEIV0
 12105     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12106     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12107     MOVE X'2020233030303130353635' TO DFHEIV0(25:11)
 12108     CALL 'kxdfhei1' USING DFHEIV0,
 12109           ARCH-FILE-ID,
 12110           DFHEIV20,
 12111           DFHEIV99,
 12112           ARCH-KEY,
 12113           DFHEIV99,
 12114           DFHEIV99,
 12115           DFHEIV99
 12116     SET ADDRESS OF LETTER-ARCHIVE TO
 12117         DFHEIV20
 12118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12119
 12120
 12121* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12122* TO THIS MASTER-KEY INFORMATION.
 12123
 12124     IF LA-CARRIER  = CARRIER-CODE AND
 12125        LA-CLAIM-NO = CLAIM-NO     AND
 12126        LA-CERT-NO  = CERT-NO
 12127        NEXT SENTENCE
 12128     ELSE
 12129        GO TO 2475-UNLOCK.
 12130
 12131     IF CERTI GREATER THAN LOW-VALUES
 12132        MOVE CERTI               TO LA-CERT-PRIME.
 12133     IF SUFXI GREATER THAN LOW-VALUES
 12134        MOVE SUFXI               TO LA-CERT-SFX.
 12135     IF CERTCARI GREATER THAN LOW-VALUES
 12136        MOVE CERTCARI            TO LA-CARRIER.
 12137
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 229
* EL131.cbl
 12138
 12139* EXEC CICS REWRITE
 12140*         DATASET  (ARCH-FILE-ID)
 12141*         FROM     (LETTER-ARCHIVE)
 12142*    END-EXEC.
 12143     MOVE LENGTH OF
 12144      LETTER-ARCHIVE
 12145       TO DFHEIV11
 12146*    MOVE '&& L                  %   #00010588' TO DFHEIV0
 12147     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12148     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12149     MOVE X'2020233030303130353838' TO DFHEIV0(25:11)
 12150     CALL 'kxdfhei1' USING DFHEIV0,
 12151           ARCH-FILE-ID,
 12152           LETTER-ARCHIVE,
 12153           DFHEIV11,
 12154           DFHEIV99
 12155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12156
 12157
 12158     GO TO 2475-EXIT.
 12159
 12160 2475-UNLOCK.
 12161
 12162* EXEC CICS UNLOCK
 12163*         DATASET  (ARCH-FILE-ID)
 12164*    END-EXEC.
 12165*    MOVE '&*                    #   #00010596' TO DFHEIV0
 12166     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12167     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12168     MOVE X'2020233030303130353936' TO DFHEIV0(25:11)
 12169     CALL 'kxdfhei1' USING DFHEIV0,
 12170           ARCH-FILE-ID,
 12171           DFHEIV99
 12172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12173
 12174
 12175 2475-EXIT.
 12176     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 230
* EL131.cbl
 12178 2600-CREATE-MAINT-NOTE.
 12179     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12180     MOVE '1'                    TO CNTL-REC-TYPE.
 12181     MOVE SPACES                 TO CNTL-PROC-ID.
 12182     MOVE ZERO                   TO CNTL-SEQ-NO.
 12183
 12184
 12185* EXEC CICS READ
 12186*         SET        (ADDRESS OF CONTROL-FILE)
 12187*         DATASET    ('ELCNTL')
 12188*         RIDFLD     (CNTL-KEY)
 12189*    END-EXEC.
 12190     MOVE 'ELCNTL' TO DFHEIV1
 12191*    MOVE '&"S        E          (   #00010609' TO DFHEIV0
 12192     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12193     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12194     MOVE X'2020233030303130363039' TO DFHEIV0(25:11)
 12195     CALL 'kxdfhei1' USING DFHEIV0,
 12196           DFHEIV1,
 12197           DFHEIV20,
 12198           DFHEIV99,
 12199           CNTL-KEY,
 12200           DFHEIV99,
 12201           DFHEIV99,
 12202           DFHEIV99
 12203     SET ADDRESS OF CONTROL-FILE TO
 12204         DFHEIV20
 12205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12206
 12207
 12208     IF CO-NO-USE-AUDIT-CHANGES
 12209         GO TO 2600-EXIT.
 12210
 12211     IF PROCL GREATER ZERO
 12212     IF PROCI NOT = LOW-VALUES
 12213     IF PROCI NOT = CL-PROCESSOR-ID
 12214         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12215         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12216         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12217
 12218     IF SEXL GREATER ZERO
 12219     IF SEXI NOT = LOW-VALUES
 12220     IF SEXI NOT = CL-INSURED-SEX-CD
 12221         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12222         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 12223         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12224
 12225     IF BIRTHL GREATER ZERO
 12226     IF HOLD-BIRTH NOT = LOW-VALUES
 12227     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 12228         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 12229         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 12230         MOVE SPACES               TO DC-OPTION-CODE
 12231         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12232         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12233         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12234
 12235     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 231
* EL131.cbl
 12236     IF SOCIALI NOT = LOW-VALUES
 12237     IF SOCIALI NOT = CL-SOC-SEC-NO
 12238         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 12239         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 12240         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12241
 12242     IF OCCL GREATER ZERO
 12243     IF OCCI NOT = LOW-VALUES
 12244     IF OCCI NOT = CL-INSURED-OCC-CD
 12245         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 12246         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 12247         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12248
 12249     IF BENEL GREATER ZERO
 12250     IF BENEI NOT = LOW-VALUES
 12251     IF BENEI NOT = CL-BENEFICIARY
 12252         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 12253         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 12254         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12255
 12256     IF PREMTYPL GREATER ZERO
 12257     IF PREMTYPI NOT = LOW-VALUES
 12258     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 12259         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 12260         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 12261         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12262
 12263     IF CAUSEL GREATER ZERO
 12264     IF CAUSEI NOT = LOW-VALUES
 12265     IF CAUSEI NOT = CL-CAUSE-CD
 12266         MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 12267         MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 12268         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12269
 12270     IF ENDL GREATER ZERO
 12271     IF HOLD-END NOT = LOW-VALUES
 12272     IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 12273         MOVE 'END DT'             TO SPLIT-INFO-DESC
 12274         MOVE CL-EST-END-OF-DISAB-DT
 12275                                   TO DC-BIN-DATE-1
 12276         MOVE SPACES               TO DC-OPTION-CODE
 12277         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12278         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12279         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12280
 12281     IF PDTHRUL GREATER ZERO
 12282     IF HOLD-PDTHRU NOT = LOW-VALUES
 12283     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 12284         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 12285         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 12286         MOVE SPACES               TO DC-OPTION-CODE
 12287         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12288         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12289         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12290
 12291     IF PDAMTL GREATER ZERO
 12292     IF HOLD-PDAMT NOT = ZEROS
 12293     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 232
* EL131.cbl
 12294         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 12295         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 12296         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 12297         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12298
 12299     IF NODAYSL GREATER ZERO
 12300     IF HOLD-NODAYS NOT = ZEROS
 12301     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 12302         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 12303         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 12304         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12305         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12306
 12307     IF NOPMTSL GREATER ZERO
 12308     IF HOLD-NOPMTS NOT = ZEROS
 12309     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 12310         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 12311         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 12312         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12313         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12314
 12315     IF FORMTYPL GREATER ZERO
 12316     IF FORMTYPI NOT = LOW-VALUES
 12317     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 12318         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 12319         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 12320         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12321
 12322     IF REPL GREATER ZERO
 12323     IF HOLD-REPORTED NOT = LOW-VALUES
 12324     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 12325         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 12326         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 12327         MOVE SPACES               TO DC-OPTION-CODE
 12328         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12329         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12330         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12331
 12332     IF ADDONDTL GREATER ZERO
 12333     IF HOLD-ADDON NOT = LOW-VALUES
 12334     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 12335         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 12336         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 12337         MOVE SPACES               TO DC-OPTION-CODE
 12338         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12339         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12340         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12341
 12342     IF PRICDL GREATER ZERO
 12343     IF PRICDI NOT = LOW-VALUES
 12344     IF PRICDI NOT = CL-PRIORITY-CD
 12345         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 12346         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 12347         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12348
 12349     IF FILETOL GREATER ZERO
 12350     IF FILETOI NOT = LOW-VALUES
 12351     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 233
* EL131.cbl
 12352         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 12353         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 12354         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12355
 12356     IF SUPVL GREATER ZERO
 12357     IF SUPVI NOT = LOW-VALUES
 12358     IF SUPVI NOT = CL-SUPV-ATTN-CD
 12359         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 12360         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 12361         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12362     IF (CRITPTL > ZERO)
 12363        AND (CRITPTI NOT = LOW-VALUES)
 12364        AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 12365        MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 12366        MOVE CL-CRIT-PER-RECURRENT
 12367                                 TO SPLIT-INFO-OLD
 12368        PERFORM 2650-WRITE-MAINT-NOTE
 12369                                 THRU 2650-EXIT
 12370     END-IF
 12371
 12372     IF (RTWMOSL > ZERO)
 12373        AND (RTWMOSI NOT = LOW-VALUES)
 12374        AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 12375        MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 12376        MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 12377        PERFORM 2650-WRITE-MAINT-NOTE
 12378                                 THRU 2650-EXIT
 12379     END-IF
 12380     IF MLNAMEL GREATER ZERO
 12381     IF MLNAMEI NOT = LOW-VALUES
 12382     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 12383         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 12384         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 12385         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12386
 12387     IF MFNAMEL GREATER ZERO
 12388     IF MFNAMEI NOT = LOW-VALUES
 12389     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 12390         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 12391         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 12392         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12393
 12394     IF MMINITL GREATER ZERO
 12395     IF MMINITI NOT = LOW-VALUES
 12396     IF MMINITI NOT = CL-INSURED-MID-INIT
 12397         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 12398         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 12399         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12400
 12401     IF CERTEFFL GREATER ZERO
 12402     IF HOLD-EFF NOT = LOW-VALUES
 12403     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 12404         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 12405         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 12406         MOVE SPACES               TO DC-OPTION-CODE
 12407         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12408         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12409         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 234
* EL131.cbl
 12410
 12411     IF CERTACTL GREATER ZERO
 12412     IF CERTACTI NOT = LOW-VALUES
 12413     IF CERTACTI NOT = CL-CERT-ACCOUNT
 12414         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 12415         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 12416         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12417
 12418     IF CERTSTL GREATER ZERO
 12419     IF CERTSTI NOT = LOW-VALUES
 12420     IF CERTSTI NOT = CL-CERT-STATE
 12421         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 12422         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 12423         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12424
 12425     IF CERTCARL GREATER ZERO
 12426     IF CERTCARI NOT = LOW-VALUES
 12427     IF CERTCARI NOT = CL-CERT-CARRIER
 12428         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 12429         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 12430         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12431
 12432     IF CERTGRPL GREATER ZERO
 12433     IF CERTGRPI NOT = LOW-VALUES
 12434     IF CERTGRPI NOT = CL-CERT-GROUPING
 12435         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 12436         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 12437         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12438
 12439     IF CERTL GREATER ZERO OR
 12440        SUFXL GREATER ZERO
 12441     IF (CERTI NOT = LOW-VALUES AND
 12442                     CL-CERT-PRIME)
 12443                OR
 12444        (SUFXI NOT = LOW-VALUES AND
 12445                     CL-CERT-SFX)
 12446         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 12447         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 12448         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12449     IF incl > zeros
 12450        IF (HOLD-INCUR NOT = LOW-VALUES)
 12451           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 12452           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 12453           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 12454           MOVE SPACES           TO DC-OPTION-CODE
 12455           PERFORM 9800-CONVERT-DATE
 12456                                 THRU 9800-EXIT
 12457           MOVE DC-GREG-DATE-1-EDIT
 12458                                 TO SPLIT-INFO-OLD
 12459           PERFORM 2650-WRITE-MAINT-NOTE
 12460                                 THRU 2650-EXIT
 12461        END-IF
 12462     END-IF
 12463     .
 12464 2600-EXIT.
 12465      EXIT.
 12466
 12467 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 235
* EL131.cbl
 12468
 12469* EXEC CICS GETMAIN
 12470*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12471*         LENGTH   (TRLR-LENGTH)
 12472*         INITIMG  (GETMAIN-SPACE)
 12473*    END-EXEC.
 12474*    MOVE ',"IL                  $   #00010875' TO DFHEIV0
 12475     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12476     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12477     MOVE X'2020233030303130383735' TO DFHEIV0(25:11)
 12478     CALL 'kxdfhei1' USING DFHEIV0,
 12479           DFHEIV20,
 12480           TRLR-LENGTH,
 12481           GETMAIN-SPACE
 12482     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12483         DFHEIV20
 12484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12485
 12486
 12487
 12488* EXEC CICS HANDLE CONDITION
 12489*         DUPREC   (2650-EXIT)
 12490*    END-EXEC.
 12491*    MOVE '"$%                   ! : #00010881' TO DFHEIV0
 12492     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12493     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12494     MOVE X'3A20233030303130383831' TO DFHEIV0(25:11)
 12495     CALL 'kxdfhei1' USING DFHEIV0
 12496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12497
 12498
 12499     MOVE SPACES             TO ACTIVITY-TRAILERS.
 12500
 12501     IF CERTL GREATER ZERO
 12502         MOVE CERTI          TO CL-CERT-PRIME.
 12503
 12504     IF SUFXL GREATER ZERO
 12505         MOVE SUFXI          TO CL-CERT-SFX.
 12506
 12507     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 12508
 12509     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 12510     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 12511
 12512     MOVE 'AT'               TO AT-RECORD-ID.
 12513
 12514     MOVE '6'                TO AT-TRAILER-TYPE.
 12515     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 12516                                AT-GEN-INFO-LAST-MAINT-DT.
 12517     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 12518                                AT-GEN-INFO-LAST-UPDATED-BY.
 12519     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 12520     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 12521     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 12522
 12523
 12524* EXEC CICS WRITE
 12525*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 236
* EL131.cbl
 12526*         RIDFLD   (AT-CONTROL-PRIMARY)
 12527*         FROM     (ACTIVITY-TRAILERS)
 12528*    END-EXEC.
 12529     MOVE LENGTH OF
 12530      ACTIVITY-TRAILERS
 12531       TO DFHEIV11
 12532*    MOVE '&$ L                  ''   #00010909' TO DFHEIV0
 12533     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12534     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12535     MOVE X'2020233030303130393039' TO DFHEIV0(25:11)
 12536     CALL 'kxdfhei1' USING DFHEIV0,
 12537           TRLR-FILE-ID,
 12538           ACTIVITY-TRAILERS,
 12539           DFHEIV11,
 12540           AT-CONTROL-PRIMARY,
 12541           DFHEIV99,
 12542           DFHEIV99
 12543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12544
 12545
 12546 2650-EXIT.
 12547      EXIT.
 12548
 12549 2800-CHECK-AUTO-PAY.
 12550
 12551     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 12552     MOVE PI-CARRIER         TO TRLR-CARRIER.
 12553     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 12554     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 12555     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 12556
 12557
 12558* EXEC CICS HANDLE CONDITION
 12559*         NOTFND    (2800-EXIT)
 12560*         ENDFILE   (2800-EXIT)
 12561*    END-EXEC.
 12562*    MOVE '"$I''                  ! ; #00010926' TO DFHEIV0
 12563     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12565     MOVE X'3B20233030303130393236' TO DFHEIV0(25:11)
 12566     CALL 'kxdfhei1' USING DFHEIV0
 12567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12568
 12569
 12570
 12571* EXEC CICS READ
 12572*        DATASET (TRLR-FILE-ID)
 12573*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12574*        RIDFLD  (TRLR-KEY)
 12575*    END-EXEC.
 12576*    MOVE '&"S        E          (   #00010931' TO DFHEIV0
 12577     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12579     MOVE X'2020233030303130393331' TO DFHEIV0(25:11)
 12580     CALL 'kxdfhei1' USING DFHEIV0,
 12581           TRLR-FILE-ID,
 12582           DFHEIV20,
 12583           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 237
* EL131.cbl
 12584           TRLR-KEY,
 12585           DFHEIV99,
 12586           DFHEIV99,
 12587           DFHEIV99
 12588     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12589         DFHEIV20
 12590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12591
 12592
 12593     IF BENEFICIARY-PAID-AUTO
 12594         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 12595     END-IF.
 12596
 12597 2800-EXIT.
 12598      EXIT.
 12599
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 238
* EL131.cbl
 12601 3000-DELETE-CLAIM.
 12602     IF  NOT MODIFY-CAP
 12603         MOVE ER-0070            TO EMI-ERROR
 12604         MOVE -1                 TO MAINTL
 12605         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12606         GO TO 8110-SEND-DATA.
 12607
 12608
 12609* EXEC CICS READ
 12610*         SET      (ADDRESS OF CLAIM-MASTER)
 12611*         DATASET  (CLMS-FILE-ID)
 12612*         RIDFLD   (MSTR-KEY)
 12613*    END-EXEC.
 12614*    MOVE '&"S        E          (   #00010952' TO DFHEIV0
 12615     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12617     MOVE X'2020233030303130393532' TO DFHEIV0(25:11)
 12618     CALL 'kxdfhei1' USING DFHEIV0,
 12619           CLMS-FILE-ID,
 12620           DFHEIV20,
 12621           DFHEIV99,
 12622           MSTR-KEY,
 12623           DFHEIV99,
 12624           DFHEIV99,
 12625           DFHEIV99
 12626     SET ADDRESS OF CLAIM-MASTER TO
 12627         DFHEIV20
 12628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12629
 12630
 12631     IF CL-1ST-TRL-AVAIL
 12632         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 12633     ELSE
 12634        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 12635        MOVE 0                   TO TRLR-SEQ-NO
 12636
 12637* EXEC CICS STARTBR
 12638*            DATASET (TRLR-FILE-ID)
 12639*            RIDFLD  (TRLR-KEY)
 12640*        END-EXEC
 12641     MOVE 0
 12642       TO DFHEIV11
 12643*    MOVE '&,         G          &   #00010963' TO DFHEIV0
 12644     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12645     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12646     MOVE X'2020233030303130393633' TO DFHEIV0(25:11)
 12647     CALL 'kxdfhei1' USING DFHEIV0,
 12648           TRLR-FILE-ID,
 12649           TRLR-KEY,
 12650           DFHEIV99,
 12651           DFHEIV11,
 12652           DFHEIV99
 12653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12654         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 12655
 12656* EXEC CICS ENDBR
 12657*            DATASET (TRLR-FILE-ID)
 12658*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 239
* EL131.cbl
 12659     MOVE 0
 12660       TO DFHEIV11
 12661*    MOVE '&2                    $   #00010968' TO DFHEIV0
 12662     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12663     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12664     MOVE X'2020233030303130393638' TO DFHEIV0(25:11)
 12665     CALL 'kxdfhei1' USING DFHEIV0,
 12666           TRLR-FILE-ID,
 12667           DFHEIV11,
 12668           DFHEIV99
 12669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12670        IF SCREEN-ERROR
 12671            MOVE ER-0208         TO EMI-ERROR
 12672            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12673            MOVE -1              TO MAINTL
 12674            GO TO 8110-SEND-DATA
 12675        ELSE
 12676            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 12677
 12678     IF SCREEN-ERROR
 12679         MOVE -1                 TO MAINTL
 12680         GO TO 8110-SEND-DATA.
 12681
 12682     MOVE -1                     TO ONE-OR-MIN1.
 12683     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 12684
 12685     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 12686         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 12687                                    WS-SAVE-CLAIM-KEY
 12688         MOVE +1                 TO ONE-OR-MIN1
 12689         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 12690
 12691     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 12692
 12693     MOVE LOW-VALUES             TO EL131AO.
 12694     MOVE ER-0000                TO EMI-ERROR.
 12695     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12696     MOVE 'X'                    TO PI-RETURN-CD-1.
 12697     MOVE -1                     TO MAINTL.
 12698     GO TO 8100-SEND-MAP.
 12699
 12700 3010-DEL-MSTR-TRLR.
 12701
 12702* EXEC CICS READ UPDATE
 12703*         SET       (ADDRESS OF CLAIM-MASTER)
 12704*         DATASET   (CLMS-FILE-ID)
 12705*         RIDFLD    (MSTR-KEY)
 12706*    END-EXEC.
 12707*    MOVE '&"S        EU         (   #00011002' TO DFHEIV0
 12708     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12709     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12710     MOVE X'2020233030303131303032' TO DFHEIV0(25:11)
 12711     CALL 'kxdfhei1' USING DFHEIV0,
 12712           CLMS-FILE-ID,
 12713           DFHEIV20,
 12714           DFHEIV99,
 12715           MSTR-KEY,
 12716           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 240
* EL131.cbl
 12717           DFHEIV99,
 12718           DFHEIV99
 12719     SET ADDRESS OF CLAIM-MASTER TO
 12720         DFHEIV20
 12721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12722
 12723
 12724     if (cl-priority-cd = '8')
 12725        and (pi-processor-id not = 'PEMA' and 'JMS '
 12726             AND 'AMWA')
 12727        MOVE ER-8003             TO EMI-ERROR
 12728        PERFORM 9900-ERROR-FORMAT
 12729                                 THRU 9900-EXIT
 12730        MOVE -1                  TO MAINTL
 12731        GO TO 8110-SEND-DATA
 12732     end-if
 12733
 12734     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 12735     MOVE ZERO                   TO TRLR-SEQ-NO.
 12736
 12737
 12738* EXEC CICS HANDLE CONDITION
 12739*         NOTFND    (3010-DEL-ACTQ)
 12740*         ENDFILE   (3040-EXIT)
 12741*    END-EXEC.
 12742*    MOVE '"$I''                  ! < #00011021' TO DFHEIV0
 12743     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12745     MOVE X'3C20233030303131303231' TO DFHEIV0(25:11)
 12746     CALL 'kxdfhei1' USING DFHEIV0
 12747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12748
 12749
 12750     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 12751
 12752 3010-DEL-ACTQ.
 12753
 12754
 12755* EXEC CICS HANDLE CONDITION
 12756*         NOTFND    (3010-NO-ACTIVITY)
 12757*         ENDFILE   (3050-EXIT)
 12758*    END-EXEC.
 12759*    MOVE '"$I''                  ! = #00011030' TO DFHEIV0
 12760     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12761     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12762     MOVE X'3D20233030303131303330' TO DFHEIV0(25:11)
 12763     CALL 'kxdfhei1' USING DFHEIV0
 12764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12765
 12766
 12767
 12768* EXEC CICS STARTBR
 12769*         DATASET  (ACTQ-FILE-ID)
 12770*         RIDFLD   (ACTQ-KEY)
 12771*    END-EXEC.
 12772     MOVE 0
 12773       TO DFHEIV11
 12774*    MOVE '&,         G          &   #00011035' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 241
* EL131.cbl
 12775     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12776     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12777     MOVE X'2020233030303131303335' TO DFHEIV0(25:11)
 12778     CALL 'kxdfhei1' USING DFHEIV0,
 12779           ACTQ-FILE-ID,
 12780           ACTQ-KEY,
 12781           DFHEIV99,
 12782           DFHEIV11,
 12783           DFHEIV99
 12784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12785
 12786
 12787
 12788* EXEC CICS GETMAIN
 12789*         SET      (ADDRESS OF ACTIVITY-QUE)
 12790*         LENGTH   (ACTQ-LENGTH)
 12791*         INITIMG  (GETMAIN-SPACE)
 12792*    END-EXEC.
 12793*    MOVE ',"IL                  $   #00011040' TO DFHEIV0
 12794     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12795     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12796     MOVE X'2020233030303131303430' TO DFHEIV0(25:11)
 12797     CALL 'kxdfhei1' USING DFHEIV0,
 12798           DFHEIV20,
 12799           ACTQ-LENGTH,
 12800           GETMAIN-SPACE
 12801     SET ADDRESS OF ACTIVITY-QUE TO
 12802         DFHEIV20
 12803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12804
 12805
 12806     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 12807
 12808
 12809* EXEC CICS ENDBR
 12810*         DATASET (ACTQ-FILE-ID)
 12811*    END-EXEC.
 12812     MOVE 0
 12813       TO DFHEIV11
 12814*    MOVE '&2                    $   #00011048' TO DFHEIV0
 12815     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12816     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12817     MOVE X'2020233030303131303438' TO DFHEIV0(25:11)
 12818     CALL 'kxdfhei1' USING DFHEIV0,
 12819           ACTQ-FILE-ID,
 12820           DFHEIV11,
 12821           DFHEIV99
 12822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12823
 12824
 12825 3010-NO-ACTIVITY.
 12826
 12827
 12828* EXEC CICS HANDLE CONDITION
 12829*        NOTFND   (3010-CERT-NOT-FOUND)
 12830*    END-EXEC.
 12831*    MOVE '"$I                   ! > #00011054' TO DFHEIV0
 12832     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 242
* EL131.cbl
 12833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12834     MOVE X'3E20233030303131303534' TO DFHEIV0(25:11)
 12835     CALL 'kxdfhei1' USING DFHEIV0
 12836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12837
 12838
 12839     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12840     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12841     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12842     MOVE CL-CERT-STATE          TO CERT-STATE.
 12843     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12844     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12845     MOVE CL-CERT-NO             TO CERT-CERT.
 12846
 12847
 12848* EXEC CICS READ
 12849*        DATASET   (CERT-FILE-ID)
 12850*        RIDFLD    (CERT-KEY)
 12851*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12852*    END-EXEC.
 12853*    MOVE '&"S        E          (   #00011066' TO DFHEIV0
 12854     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12855     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12856     MOVE X'2020233030303131303636' TO DFHEIV0(25:11)
 12857     CALL 'kxdfhei1' USING DFHEIV0,
 12858           CERT-FILE-ID,
 12859           DFHEIV20,
 12860           DFHEIV99,
 12861           CERT-KEY,
 12862           DFHEIV99,
 12863           DFHEIV99,
 12864           DFHEIV99
 12865     SET ADDRESS OF CERTIFICATE-MASTER TO
 12866         DFHEIV20
 12867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12868
 12869
 12870     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12871       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 12872         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12873     ELSE
 12874         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 12875
 12876  3010-UPDATE-CERT-TRLR.
 12877
 12878      MOVE CERT-KEY              TO ELCRTT-KEY
 12879      MOVE 'B'                   TO CTRLR-REC-TYPE
 12880
 12881* EXEC CICS READ
 12882*        UPDATE
 12883*        DATASET   ('ELCRTT')
 12884*        RIDFLD    (ELCRTT-KEY)
 12885*        INTO      (CERTIFICATE-TRAILERS)
 12886*        RESP      (WS-RESPONSE)
 12887*     END-EXEC
 12888     MOVE LENGTH OF
 12889      CERTIFICATE-TRAILERS
 12890       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 243
* EL131.cbl
 12891     MOVE 'ELCRTT' TO DFHEIV1
 12892*    MOVE '&"IL       EU         (  N#00011082' TO DFHEIV0
 12893     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12894     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12895     MOVE X'204E233030303131303832' TO DFHEIV0(25:11)
 12896     CALL 'kxdfhei1' USING DFHEIV0,
 12897           DFHEIV1,
 12898           CERTIFICATE-TRAILERS,
 12899           DFHEIV11,
 12900           ELCRTT-KEY,
 12901           DFHEIV99,
 12902           DFHEIV99,
 12903           DFHEIV99
 12904     MOVE EIBRESP  TO WS-RESPONSE
 12905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12906      IF WS-RESP-NORMAL
 12907*    if cl-insured-claim = 'S'
 12908*       move +2 to s1
 12909*    else
 12910*       MOVE +1 to s1
 12911*    end-if
 12912
 12913     move +1 to s1
 12914     evaluate cl-claim-type
 12915        when 'A'
 12916           move +1 to s2
 12917        when 'I'
 12918           move +2 to s2
 12919        when 'G'
 12920           move +3 to s2
 12921        when 'L'
 12922           move +4 to s2
 12923        when 'P'
 12924           move +5 to s2
 12925     end-evaluate
 12926     SUBTRACT +1 FROM CS-NO-OF-CLAIMS (S1 S2)
 12927     IF CS-NO-OF-CLAIMS (S1 S2) < ZEROS
 12928        MOVE ZEROS               TO CS-NO-OF-CLAIMS (S1 S2)
 12929     END-IF
 12930     if cs-no-of-claims (s1 s2) = zeros
 12931        move spaces              to cs-claim-type (s1 s2)
 12932     end-if
 12933
 12934
 12935* EXEC CICS REWRITE
 12936*       DATASET   ('ELCRTT')
 12937*       FROM      (CERTIFICATE-TRAILERS)
 12938*    END-EXEC
 12939     MOVE LENGTH OF
 12940      CERTIFICATE-TRAILERS
 12941       TO DFHEIV11
 12942     MOVE 'ELCRTT' TO DFHEIV1
 12943*    MOVE '&& L                  %   #00011117' TO DFHEIV0
 12944     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12945     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12946     MOVE X'2020233030303131313137' TO DFHEIV0(25:11)
 12947     CALL 'kxdfhei1' USING DFHEIV0,
 12948           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 244
* EL131.cbl
 12949           CERTIFICATE-TRAILERS,
 12950           DFHEIV11,
 12951           DFHEIV99
 12952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12953     .
 12954 3010-CERT-NOT-FOUND.
 12955
 12956
 12957* EXEC CICS DELETE
 12958*        DATASET  (CLMS-FILE-ID)
 12959*    END-EXEC.
 12960*    MOVE '&(                    &   #00011124' TO DFHEIV0
 12961     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12962     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12963     MOVE X'2020233030303131313234' TO DFHEIV0(25:11)
 12964     CALL 'kxdfhei1' USING DFHEIV0,
 12965           CLMS-FILE-ID,
 12966           DFHEIV99,
 12967           DFHEIV99,
 12968           DFHEIV99,
 12969           DFHEIV99
 12970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12971
 12972
 12973 3010-EXIT.
 12974      EXIT.
 12975
 12976 3020-UPDATE-CERT.
 12977
 12978* EXEC CICS READ UPDATE
 12979*         DATASET  (CERT-FILE-ID)
 12980*         RIDFLD   (CERT-KEY)
 12981*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12982*    END-EXEC.
 12983*    MOVE '&"S        EU         (   #00011132' TO DFHEIV0
 12984     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12985     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12986     MOVE X'2020233030303131313332' TO DFHEIV0(25:11)
 12987     CALL 'kxdfhei1' USING DFHEIV0,
 12988           CERT-FILE-ID,
 12989           DFHEIV20,
 12990           DFHEIV99,
 12991           CERT-KEY,
 12992           DFHEIV99,
 12993           DFHEIV99,
 12994           DFHEIV99
 12995     SET ADDRESS OF CERTIFICATE-MASTER TO
 12996         DFHEIV20
 12997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12998
 12999
 13000     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13001
 13002
 13003* EXEC CICS HANDLE CONDITION
 13004*         DUPKEY   (3020-EXIT)
 13005*    END-EXEC.
 13006*    MOVE '"$$                   ! ? #00011140' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 245
* EL131.cbl
 13007     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13009     MOVE X'3F20233030303131313430' TO DFHEIV0(25:11)
 13010     CALL 'kxdfhei1' USING DFHEIV0
 13011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13012
 13013
 13014
 13015* EXEC CICS REWRITE
 13016*         DATASET  (CERT-FILE-ID)
 13017*         FROM     (CERTIFICATE-MASTER)
 13018*    END-EXEC.
 13019     MOVE LENGTH OF
 13020      CERTIFICATE-MASTER
 13021       TO DFHEIV11
 13022*    MOVE '&& L                  %   #00011144' TO DFHEIV0
 13023     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13024     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13025     MOVE X'2020233030303131313434' TO DFHEIV0(25:11)
 13026     CALL 'kxdfhei1' USING DFHEIV0,
 13027           CERT-FILE-ID,
 13028           CERTIFICATE-MASTER,
 13029           DFHEIV11,
 13030           DFHEIV99
 13031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13032
 13033
 13034 3020-EXIT.
 13035     EXIT.
 13036
 13037 3030-DELETE-CERT.
 13038
 13039* EXEC CICS READ UPDATE
 13040*         DATASET  (CERT-FILE-ID)
 13041*         RIDFLD   (CERT-KEY)
 13042*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13043*    END-EXEC.
 13044*    MOVE '&"S        EU         (   #00011153' TO DFHEIV0
 13045     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13046     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13047     MOVE X'2020233030303131313533' TO DFHEIV0(25:11)
 13048     CALL 'kxdfhei1' USING DFHEIV0,
 13049           CERT-FILE-ID,
 13050           DFHEIV20,
 13051           DFHEIV99,
 13052           CERT-KEY,
 13053           DFHEIV99,
 13054           DFHEIV99,
 13055           DFHEIV99
 13056     SET ADDRESS OF CERTIFICATE-MASTER TO
 13057         DFHEIV20
 13058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13059
 13060
 13061
 13062* EXEC CICS DELETE
 13063*         DATASET   (CERT-FILE-ID)
 13064*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 246
* EL131.cbl
 13065*    MOVE '&(                    &   #00011159' TO DFHEIV0
 13066     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13067     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13068     MOVE X'2020233030303131313539' TO DFHEIV0(25:11)
 13069     CALL 'kxdfhei1' USING DFHEIV0,
 13070           CERT-FILE-ID,
 13071           DFHEIV99,
 13072           DFHEIV99,
 13073           DFHEIV99,
 13074           DFHEIV99
 13075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13076
 13077
 13078 3030-EXIT.
 13079     EXIT.
 13080
 13081 3040-DELETE-TRLR.
 13082
 13083* EXEC CICS READ
 13084*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13085*         DATASET  (TRLR-FILE-ID)
 13086*         RIDFLD   (TRLR-KEY)
 13087*         GTEQ
 13088*    END-EXEC.
 13089*    MOVE '&"S        G          (   #00011167' TO DFHEIV0
 13090     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13091     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13092     MOVE X'2020233030303131313637' TO DFHEIV0(25:11)
 13093     CALL 'kxdfhei1' USING DFHEIV0,
 13094           TRLR-FILE-ID,
 13095           DFHEIV20,
 13096           DFHEIV99,
 13097           TRLR-KEY,
 13098           DFHEIV99,
 13099           DFHEIV99,
 13100           DFHEIV99
 13101     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13102         DFHEIV20
 13103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13104
 13105
 13106     IF PI-COMPANY-CD = AT-COMPANY-CD
 13107        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13108        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13109           GO TO 3040-EXIT
 13110        ELSE
 13111           NEXT SENTENCE
 13112     ELSE
 13113        GO TO 3040-EXIT.
 13114
 13115
 13116* EXEC CICS DELETE
 13117*         DATASET  (TRLR-FILE-ID)
 13118*         RIDFLD   (TRLR-KEY)
 13119*    END-EXEC.
 13120*    MOVE '&(  R                 &   #00011183' TO DFHEIV0
 13121     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13122     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 247
* EL131.cbl
 13123     MOVE X'2020233030303131313833' TO DFHEIV0(25:11)
 13124     CALL 'kxdfhei1' USING DFHEIV0,
 13125           TRLR-FILE-ID,
 13126           TRLR-KEY,
 13127           DFHEIV99,
 13128           DFHEIV99,
 13129           DFHEIV99
 13130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13131
 13132
 13133     GO TO 3040-DELETE-TRLR.
 13134
 13135 3040-EXIT.
 13136     EXIT.
 13137
 13138 3050-DELETE-ACTQ.
 13139
 13140* EXEC CICS READNEXT
 13141*         DATASET  (ACTQ-FILE-ID)
 13142*         RIDFLD   (ACTQ-KEY)
 13143*         INTO     (ACTIVITY-QUE)
 13144*    END-EXEC.
 13145     MOVE LENGTH OF
 13146      ACTIVITY-QUE
 13147       TO DFHEIV12
 13148     MOVE 0
 13149       TO DFHEIV11
 13150*    MOVE '&.IL                  )   #00011194' TO DFHEIV0
 13151     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13152     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13153     MOVE X'2020233030303131313934' TO DFHEIV0(25:11)
 13154     CALL 'kxdfhei1' USING DFHEIV0,
 13155           ACTQ-FILE-ID,
 13156           ACTIVITY-QUE,
 13157           DFHEIV12,
 13158           ACTQ-KEY,
 13159           DFHEIV99,
 13160           DFHEIV11,
 13161           DFHEIV99,
 13162           DFHEIV99
 13163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13164
 13165
 13166     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13167         GO TO 3050-EXIT.
 13168
 13169
 13170* EXEC CICS ENDBR
 13171*         DATASET  (ACTQ-FILE-ID)
 13172*    END-EXEC.
 13173     MOVE 0
 13174       TO DFHEIV11
 13175*    MOVE '&2                    $   #00011203' TO DFHEIV0
 13176     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13177     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13178     MOVE X'2020233030303131323033' TO DFHEIV0(25:11)
 13179     CALL 'kxdfhei1' USING DFHEIV0,
 13180           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 248
* EL131.cbl
 13181           DFHEIV11,
 13182           DFHEIV99
 13183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13184
 13185
 13186
 13187* EXEC CICS DELETE
 13188*         DATASET   (ACTQ-FILE-ID)
 13189*         RIDFLD    (ACTQ-KEY)
 13190*    END-EXEC.
 13191*    MOVE '&(  R                 &   #00011207' TO DFHEIV0
 13192     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13193     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13194     MOVE X'2020233030303131323037' TO DFHEIV0(25:11)
 13195     CALL 'kxdfhei1' USING DFHEIV0,
 13196           ACTQ-FILE-ID,
 13197           ACTQ-KEY,
 13198           DFHEIV99,
 13199           DFHEIV99,
 13200           DFHEIV99
 13201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13202
 13203
 13204
 13205* EXEC CICS STARTBR
 13206*         DATASET   (ACTQ-FILE-ID)
 13207*         RIDFLD    (ACTQ-KEY)
 13208*    END-EXEC.
 13209     MOVE 0
 13210       TO DFHEIV11
 13211*    MOVE '&,         G          &   #00011212' TO DFHEIV0
 13212     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13213     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13214     MOVE X'2020233030303131323132' TO DFHEIV0(25:11)
 13215     CALL 'kxdfhei1' USING DFHEIV0,
 13216           ACTQ-FILE-ID,
 13217           ACTQ-KEY,
 13218           DFHEIV99,
 13219           DFHEIV11,
 13220           DFHEIV99
 13221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13222
 13223
 13224     GO TO 3050-DELETE-ACTQ.
 13225
 13226 3050-EXIT.
 13227     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 249
* EL131.cbl
 13229 3060-READ-TRLR.
 13230
 13231* EXEC CICS HANDLE CONDITION
 13232*         NOTFND    (3060-EXIT)
 13233*         ENDFILE   (3060-EXIT)
 13234*    END-EXEC.
 13235*    MOVE '"$I''                  ! @ #00011223' TO DFHEIV0
 13236     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13238     MOVE X'4020233030303131323233' TO DFHEIV0(25:11)
 13239     CALL 'kxdfhei1' USING DFHEIV0
 13240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13241
 13242
 13243 3060-LOOP.
 13244
 13245* EXEC CICS READNEXT
 13246*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13247*         DATASET  (TRLR-FILE-ID)
 13248*         RIDFLD   (TRLR-KEY)
 13249*    END-EXEC.
 13250     MOVE 0
 13251       TO DFHEIV11
 13252*    MOVE '&.S                   )   #00011229' TO DFHEIV0
 13253     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13254     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13255     MOVE X'2020233030303131323239' TO DFHEIV0(25:11)
 13256     CALL 'kxdfhei1' USING DFHEIV0,
 13257           TRLR-FILE-ID,
 13258           DFHEIV20,
 13259           DFHEIV99,
 13260           TRLR-KEY,
 13261           DFHEIV99,
 13262           DFHEIV11,
 13263           DFHEIV99,
 13264           DFHEIV99
 13265     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13266         DFHEIV20
 13267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13268
 13269
 13270     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13271         GO TO 3060-EXIT.
 13272
 13273     IF FORM-CONTROL-TR
 13274         IF AT-RECORDED-DT = SAVE-BIN-DATE
 13275             NEXT SENTENCE
 13276         ELSE
 13277             MOVE 'X'            TO ERROR-SWITCH
 13278             GO TO 3060-EXIT
 13279     ELSE
 13280         IF PAYMENT-TR OR CORRESPONDENCE-TR
 13281            MOVE 'X'                 TO ERROR-SWITCH
 13282            GO TO 3060-EXIT.
 13283
 13284     GO TO 3060-LOOP.
 13285
 13286 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 250
* EL131.cbl
 13287     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 251
* EL131.cbl
 13289 3997-GET-ERPDEF.
 13290
 13291     move cl-company-cd          to cert-company-code
 13292     move cl-cert-key-data       to cert-key (2:21)
 13293     move cl-cert-no             to cert-cert
 13294
 13295
 13296* EXEC CICS READ
 13297*        DATASET   (CERT-FILE-ID)
 13298*        RIDFLD    (CERT-KEY)
 13299*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13300*        resp      (ws-response)
 13301*    END-EXEC
 13302*    MOVE '&"S        E          (  N#00011260' TO DFHEIV0
 13303     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13304     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13305     MOVE X'204E233030303131323630' TO DFHEIV0(25:11)
 13306     CALL 'kxdfhei1' USING DFHEIV0,
 13307           CERT-FILE-ID,
 13308           DFHEIV20,
 13309           DFHEIV99,
 13310           CERT-KEY,
 13311           DFHEIV99,
 13312           DFHEIV99,
 13313           DFHEIV99
 13314     SET ADDRESS OF CERTIFICATE-MASTER TO
 13315         DFHEIV20
 13316     MOVE EIBRESP  TO ws-response
 13317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13318
 13319     MOVE SPACES                 TO WS-CRIT-PER-RECURRENT
 13320                                    WS-ERPDEF-SW
 13321     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 13322                                    WS-CRIT-PER-RTW-MOS
 13323
 13324     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 13325     MOVE CM-STATE               TO ERPDEF-STATE
 13326     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 13327     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 13328     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
 13329     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 13330     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 13331
 13332
 13333* EXEC CICS STARTBR
 13334*        DATASET  ('ERPDEF')
 13335*        RIDFLD   (ERPDEF-KEY)
 13336*        GTEQ
 13337*        RESP     (WS-RESPONSE)
 13338*    END-EXEC
 13339     MOVE 'ERPDEF' TO DFHEIV1
 13340     MOVE 0
 13341       TO DFHEIV11
 13342*    MOVE '&,         G          &  N#00011280' TO DFHEIV0
 13343     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13344     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13345     MOVE X'204E233030303131323830' TO DFHEIV0(25:11)
 13346     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 252
* EL131.cbl
 13347           DFHEIV1,
 13348           ERPDEF-KEY,
 13349           DFHEIV99,
 13350           DFHEIV11,
 13351           DFHEIV99
 13352     MOVE EIBRESP  TO WS-RESPONSE
 13353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13354
 13355     IF WS-RESP-NORMAL
 13356
 13357* EXEC CICS READNEXT
 13358*          DATASET  ('ERPDEF')
 13359*          INTO     (PRODUCT-MASTER)
 13360*          RIDFLD   (ERPDEF-KEY)
 13361*          RESP     (WS-RESPONSE)
 13362*       END-EXEC
 13363     MOVE LENGTH OF
 13364      PRODUCT-MASTER
 13365       TO DFHEIV12
 13366     MOVE 'ERPDEF' TO DFHEIV1
 13367     MOVE 0
 13368       TO DFHEIV11
 13369*    MOVE '&.IL                  )  N#00011288' TO DFHEIV0
 13370     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13371     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13372     MOVE X'204E233030303131323838' TO DFHEIV0(25:11)
 13373     CALL 'kxdfhei1' USING DFHEIV0,
 13374           DFHEIV1,
 13375           PRODUCT-MASTER,
 13376           DFHEIV12,
 13377           ERPDEF-KEY,
 13378           DFHEIV99,
 13379           DFHEIV11,
 13380           DFHEIV99,
 13381           DFHEIV99
 13382     MOVE EIBRESP  TO WS-RESPONSE
 13383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13384        IF WS-RESP-NORMAL
 13385           IF (ERPDEF-KEY-SAVE (1:16) =
 13386              PD-CONTROL-PRIMARY (1:16))
 13387              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 13388              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 13389                 (A1 > +8)
 13390                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 13391              END-PERFORM
 13392              IF A1 < +9
 13393                 SET ERPDEF-FOUND TO TRUE
 13394                 MOVE PD-CRIT-PERIOD (A1)
 13395                              TO WS-CRITICAL-PERIOD
 13396                 MOVE PD-REC-CRIT-PERIOD (A1)
 13397                              TO WS-CRIT-PER-RECURRENT
 13398                 IF PD-RTW-MOS (A1) NUMERIC
 13399                    MOVE PD-RTW-MOS (A1)
 13400                              TO WS-CRIT-PER-RTW-MOS
 13401                 ELSE
 13402                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 13403                 END-IF
 13404                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 253
* EL131.cbl
 13405                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 13406                                 TO WS-EXCL-PERIOD
 13407                 END-IF
 13408                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 13409                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 13410                                 TO WS-COV-ENDS
 13411                 END-IF
 13412                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 13413                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 13414                                 TO WS-ACC-PERIOD
 13415                 END-IF
 13416              END-IF
 13417           END-IF
 13418        END-IF
 13419     END-IF
 13420
 13421     .
 13422 3997-EXIT.
 13423     EXIT.
 13424 4000-FORCE-ERRORS.
 13425     IF PI-RETURN-CD-1 = 'X'
 13426         MOVE ER-0311            TO EMI-ERROR
 13427         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13428         MOVE -1                 TO MAINTL
 13429         GO TO 8110-SEND-DATA.
 13430
 13431     IF NOT FORCE-CAP
 13432         MOVE ER-0416            TO EMI-ERROR
 13433         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13434         MOVE -1                 TO MAINTL
 13435         GO TO 8110-SEND-DATA.
 13436
 13437     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 13438     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 13439     IF EMI-FATAL-CTR GREATER THAN ZERO
 13440         GO TO 4000-FATAL-ERRORS.
 13441
 13442     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 13443
 13444     IF EMI-FATAL-CTR GREATER THAN ZERO
 13445         GO TO 4000-FATAL-ERRORS.
 13446
 13447     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 13448
 13449     IF EMI-FATAL-CTR GREATER THAN ZERO
 13450         GO TO 4000-FATAL-ERRORS.
 13451
 13452     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 13453     MOVE AL-UANOF               TO CERTA.
 13454     MOVE ER-0000 TO EMI-ERROR.
 13455     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13456
 13457 4000-FATAL-ERRORS.
 13458     MOVE -1                     TO MAINTL.
 13459     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 254
* EL131.cbl
 13461
 13462 4100-SAVE-CHANGES.
 13463     IF MAINTL > 0
 13464         MOVE MAINTI  TO WS-SAVE-MAINTI
 13465         MOVE MAINTL  TO WS-SAVE-MAINTL
 13466     END-IF
 13467     IF STATUSL > 0
 13468         MOVE STATUSI  TO WS-SAVE-STATUSI
 13469         MOVE STATUSL  TO WS-SAVE-STATUSL
 13470     END-IF
 13471     IF REPL > 0
 13472         MOVE REPI  TO WS-SAVE-REPI
 13473         MOVE REPL  TO WS-SAVE-REPL
 13474     END-IF
 13475     IF CAUSEL > 0
 13476         MOVE CAUSEI  TO WS-SAVE-CAUSEI
 13477         MOVE CAUSEL  TO WS-SAVE-CAUSEL
 13478     END-IF
 13479     IF ENDL > 0
 13480         MOVE ENDI  TO WS-SAVE-ENDI
 13481         MOVE ENDL  TO WS-SAVE-ENDL
 13482     END-IF
 13483     IF DIAGL > 0
 13484         MOVE DIAGI  TO WS-SAVE-DIAGI
 13485         MOVE DIAGL  TO WS-SAVE-DIAGL
 13486     END-IF
 13487     IF BENEL > 0
 13488         MOVE BENEI  TO WS-SAVE-BENEI
 13489         MOVE BENEL  TO WS-SAVE-BENEL
 13490     END-IF
 13491     IF BIRTHL > 0
 13492         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 13493         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 13494     END-IF
 13495     IF SOCIALL > 0
 13496         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 13497         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 13498     END-IF
 13499     IF SEXL > 0
 13500         MOVE SEXI  TO WS-SAVE-SEXI
 13501         MOVE SEXL  TO WS-SAVE-SEXL
 13502     END-IF
 13503     IF MLNAMEL > 0
 13504         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 13505         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 13506     END-IF
 13507     IF MFNAMEL > 0
 13508         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 13509         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 13510     END-IF
 13511     IF MMINITL > 0
 13512         MOVE MMINITI  TO WS-SAVE-MMINITI
 13513         MOVE MMINITL  TO WS-SAVE-MMINITL
 13514     END-IF
 13515     IF LOANNOL > 0
 13516         MOVE LOANNOI  TO WS-SAVE-LOANNOI
 13517         MOVE LOANNOL  TO WS-SAVE-LOANNOL
 13518     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 255
* EL131.cbl
 13519     IF LOANBALL > 0
 13520         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 13521         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 13522     END-IF
 13523     IF PROCL > 0
 13524         MOVE PROCI  TO WS-SAVE-PROCI
 13525         MOVE PROCL  TO WS-SAVE-PROCL
 13526     END-IF
 13527     IF SUPVL > 0
 13528         MOVE SUPVI  TO WS-SAVE-SUPVI
 13529         MOVE SUPVL  TO WS-SAVE-SUPVL
 13530     END-IF
 13531     IF PRICDL > 0
 13532         MOVE PRICDI  TO WS-SAVE-PRICDI
 13533         MOVE PRICDL  TO WS-SAVE-PRICDL
 13534     END-IF
 13535     IF FILETOL > 0
 13536         MOVE FILETOI  TO WS-SAVE-FILETOI
 13537         MOVE FILETOL  TO WS-SAVE-FILETOL
 13538     END-IF
 13539     IF PDTHRUL > 0
 13540         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 13541         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 13542     END-IF
 13543     IF PDAMTL > 0
 13544         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 13545         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 13546     END-IF
 13547     IF NODAYSL > 0
 13548         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 13549         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 13550     END-IF
 13551     IF NOPMTSL > 0
 13552         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 13553         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 13554     END-IF
 13555     IF FORMTYPL > 0
 13556         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 13557         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 13558     END-IF
 13559     IF OCCL > 0
 13560         MOVE OCCI  TO WS-SAVE-OCCI
 13561         MOVE OCCL  TO WS-SAVE-OCCL
 13562     END-IF.
 13563 4100-EXIT.
 13564      EXIT.
 13565
 13566 4200-LOAD-CHANGES.
 13567     IF WS-SAVE-MAINTL > 0
 13568         MOVE WS-SAVE-MAINTI  TO MAINTI
 13569         MOVE WS-SAVE-MAINTL  TO MAINTL
 13570         MOVE AL-UANON        TO MAINTA
 13571     END-IF
 13572     IF WS-SAVE-STATUSL > 0
 13573         MOVE WS-SAVE-STATUSI  TO STATUSI
 13574         MOVE WS-SAVE-STATUSL  TO STATUSL
 13575         MOVE AL-UANON         TO STATUSA
 13576     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 256
* EL131.cbl
 13577     IF WS-SAVE-REPL > 0
 13578         MOVE WS-SAVE-REPI  TO REPI
 13579         MOVE WS-SAVE-REPL  TO REPL
 13580         MOVE AL-UANON      TO REPA
 13581     END-IF
 13582     IF WS-SAVE-CAUSEL > 0
 13583         MOVE WS-SAVE-CAUSEI  TO CAUSEI
 13584         MOVE WS-SAVE-CAUSEL  TO CAUSEL
 13585         MOVE AL-UANON        TO CAUSEA
 13586     END-IF
 13587     IF WS-SAVE-ENDL > 0
 13588         MOVE WS-SAVE-ENDI  TO ENDI
 13589         MOVE WS-SAVE-ENDL  TO ENDL
 13590         MOVE AL-UANON      TO ENDA
 13591     END-IF
 13592     IF WS-SAVE-DIAGL > 0
 13593         MOVE WS-SAVE-DIAGI  TO DIAGI
 13594         MOVE WS-SAVE-DIAGL  TO DIAGL
 13595         MOVE AL-UANON       TO DIAGA
 13596     END-IF
 13597     IF WS-SAVE-BENEL > 0
 13598         MOVE WS-SAVE-BENEI  TO BENEI
 13599         MOVE WS-SAVE-BENEL  TO BENEL
 13600         MOVE AL-UANON       TO BENEA
 13601     END-IF
 13602     IF WS-SAVE-BIRTHL > 0
 13603         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 13604         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 13605         MOVE AL-UANON        TO BIRTHA
 13606     END-IF
 13607     IF WS-SAVE-SOCIALL > 0
 13608         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 13609         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 13610         MOVE AL-UANON         TO SOCIALA
 13611     END-IF
 13612     IF WS-SAVE-SEXL > 0
 13613         MOVE WS-SAVE-SEXI  TO SEXI
 13614         MOVE WS-SAVE-SEXL  TO SEXL
 13615         MOVE AL-UANON      TO SEXA
 13616     END-IF
 13617     IF WS-SAVE-MLNAMEL > 0
 13618         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 13619         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 13620         MOVE AL-UANON         TO MLNAMEA
 13621     END-IF
 13622     IF WS-SAVE-MFNAMEL > 0
 13623         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 13624         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 13625         MOVE AL-UANON         TO MFNAMEA
 13626     END-IF
 13627     IF WS-SAVE-MMINITL > 0
 13628         MOVE WS-SAVE-MMINITI  TO MMINITI
 13629         MOVE WS-SAVE-MMINITL  TO MMINITL
 13630         MOVE AL-UANON         TO MMINITA
 13631     END-IF
 13632     IF WS-SAVE-LOANNOL > 0
 13633         MOVE WS-SAVE-LOANNOI  TO LOANNOI
 13634         MOVE WS-SAVE-LOANNOL  TO LOANNOL
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 257
* EL131.cbl
 13635         MOVE AL-UANON         TO LOANNOA
 13636     END-IF
 13637     IF WS-SAVE-LOANBALL > 0
 13638         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 13639         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 13640         MOVE AL-UANON          TO LOANBALA
 13641     END-IF
 13642     IF WS-SAVE-PROCL > 0
 13643         MOVE WS-SAVE-PROCI  TO PROCI
 13644         MOVE WS-SAVE-PROCL  TO PROCL
 13645         MOVE AL-UANON       TO PROCA
 13646     END-IF
 13647     IF WS-SAVE-SUPVL > 0
 13648         MOVE WS-SAVE-SUPVI  TO SUPVI
 13649         MOVE WS-SAVE-SUPVL  TO SUPVL
 13650         MOVE AL-UANON       TO SUPVA
 13651     END-IF
 13652     IF WS-SAVE-PRICDL > 0
 13653         MOVE WS-SAVE-PRICDI  TO PRICDI
 13654         MOVE WS-SAVE-PRICDL  TO PRICDL
 13655         MOVE AL-UANON        TO PRICDA
 13656     END-IF
 13657     IF WS-SAVE-FILETOL > 0
 13658         MOVE WS-SAVE-FILETOI  TO FILETOI
 13659         MOVE WS-SAVE-FILETOL  TO FILETOL
 13660         MOVE AL-UANON         TO FILETOA
 13661     END-IF
 13662     IF WS-SAVE-PDTHRUL > 0
 13663         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 13664         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 13665         MOVE AL-UANON         TO PDTHRUA
 13666     END-IF
 13667     IF WS-SAVE-PDAMTL > 0
 13668         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 13669         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 13670         MOVE AL-UANON        TO PDAMTA
 13671     END-IF
 13672     IF WS-SAVE-NODAYSL > 0
 13673         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 13674         MOVE WS-SAVE-NODAYSL  TO NODAYSL
 13675         MOVE AL-UANON         TO NODAYSA
 13676     END-IF
 13677     IF WS-SAVE-NOPMTSL > 0
 13678         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 13679         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 13680         MOVE AL-UANON         TO NOPMTSA
 13681     END-IF
 13682     IF WS-SAVE-FORMTYPL > 0
 13683         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 13684         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 13685         MOVE AL-UANON          TO FORMTYPA
 13686     END-IF
 13687     IF WS-SAVE-OCCL > 0
 13688         MOVE WS-SAVE-OCCI  TO OCCI
 13689         MOVE WS-SAVE-OCCL  TO OCCL
 13690         MOVE AL-UANON      TO OCCA
 13691     END-IF.
 13692 4200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 258
* EL131.cbl
 13693      EXIT.
 13694
 13695 5000-BUILD-MAP.
 13696     IF PI-RETURN-CD-1 = SPACE
 13697         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 13698
 13699     MOVE SPACE                  TO PI-RETURN-CD-1.
 13700
 13701     MOVE LOW-VALUES             TO EL131AI.
 13702
 13703     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 13704     MOVE PI-CARRIER             TO CARRIER-CODE.
 13705     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 13706     MOVE PI-CERT-NO             TO CERT-NO.
 13707
 13708 5000-READ-CLAIM-MASTER.
 13709
 13710
 13711* EXEC CICS READ
 13712*         SET      (ADDRESS OF CLAIM-MASTER)
 13713*         DATASET  (CLMS-FILE-ID)
 13714*         RIDFLD   (MSTR-KEY)
 13715*    END-EXEC.
 13716*    MOVE '&"S        E          (   #00011620' TO DFHEIV0
 13717     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13718     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13719     MOVE X'2020233030303131363230' TO DFHEIV0(25:11)
 13720     CALL 'kxdfhei1' USING DFHEIV0,
 13721           CLMS-FILE-ID,
 13722           DFHEIV20,
 13723           DFHEIV99,
 13724           MSTR-KEY,
 13725           DFHEIV99,
 13726           DFHEIV99,
 13727           DFHEIV99
 13728     SET ADDRESS OF CLAIM-MASTER TO
 13729         DFHEIV20
 13730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13731
 13732
 13733     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 13734
 13735 5000-READ-DIAGNOSIS-TRAILER.
 13736
 13737
 13738* EXEC CICS HANDLE CONDITION
 13739*         NOTFND (5000-TRLR-NOT-FOUND)
 13740*    END-EXEC.
 13741*    MOVE '"$I                   ! A #00011630' TO DFHEIV0
 13742     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13743     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13744     MOVE X'4120233030303131363330' TO DFHEIV0(25:11)
 13745     CALL 'kxdfhei1' USING DFHEIV0
 13746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13747
 13748
 13749     MOVE MSTR-KEY               TO TRLR-KEY.
 13750     MOVE NINETY                 TO TRLR-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 259
* EL131.cbl
 13751
 13752
 13753* EXEC CICS READ
 13754*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13755*         DATASET  (TRLR-FILE-ID)
 13756*         RIDFLD   (TRLR-KEY)
 13757*    END-EXEC.
 13758*    MOVE '&"S        E          (   #00011637' TO DFHEIV0
 13759     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13760     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13761     MOVE X'2020233030303131363337' TO DFHEIV0(25:11)
 13762     CALL 'kxdfhei1' USING DFHEIV0,
 13763           TRLR-FILE-ID,
 13764           DFHEIV20,
 13765           DFHEIV99,
 13766           TRLR-KEY,
 13767           DFHEIV99,
 13768           DFHEIV99,
 13769           DFHEIV99
 13770     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13771         DFHEIV20
 13772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13773
 13774
 13775     MOVE AT-INFO-LINE-1         TO DIAGO.
 13776
 13777 5000-READ-CERTIFICATE-MASTER.
 13778
 13779     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 13780     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 13781     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 13782     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 13783     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 13784     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 13785     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 13786
 13787
 13788* EXEC CICS HANDLE CONDITION
 13789*         NOTFND (5000-CERT-NOT-FOUND)
 13790*    END-EXEC.
 13791*    MOVE '"$I                   ! B #00011655' TO DFHEIV0
 13792     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13794     MOVE X'4220233030303131363535' TO DFHEIV0(25:11)
 13795     CALL 'kxdfhei1' USING DFHEIV0
 13796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13797
 13798
 13799
 13800* EXEC CICS READ
 13801*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13802*         DATASET  (CERT-FILE-ID)
 13803*         RIDFLD   (CERT-KEY)
 13804*    END-EXEC.
 13805*    MOVE '&"S        E          (   #00011659' TO DFHEIV0
 13806     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13808     MOVE X'2020233030303131363539' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 260
* EL131.cbl
 13809     CALL 'kxdfhei1' USING DFHEIV0,
 13810           CERT-FILE-ID,
 13811           DFHEIV20,
 13812           DFHEIV99,
 13813           CERT-KEY,
 13814           DFHEIV99,
 13815           DFHEIV99,
 13816           DFHEIV99
 13817     SET ADDRESS OF CERTIFICATE-MASTER TO
 13818         DFHEIV20
 13819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13820
 13821
 13822     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 13823     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 13824
 13825     GO TO 5000-EXIT.
 13826
 13827 5000-TRLR-NOT-FOUND.
 13828     MOVE ER-7687                TO EMI-ERROR.
 13829     MOVE -1                     TO DIAGL.
 13830     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13831     GO TO 5000-EXIT.
 13832
 13833 5000-CERT-NOT-FOUND.
 13834     MOVE ER-0206                TO EMI-ERROR.
 13835     MOVE -1                     TO CERTL.
 13836     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13837
 13838 5000-EXIT.
 13839     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 261
* EL131.cbl
 13841 5010-RESET-PI-AREA.
 13842     IF CERTI GREATER THAN LOW-VALUES
 13843         MOVE CERTI              TO PI-CERT-PRIME.
 13844
 13845     IF SUFXI GREATER THAN LOW-VALUES
 13846         MOVE SUFXI              TO PI-CERT-SFX.
 13847
 13848     IF CERTEFFI GREATER THAN LOW-VALUES
 13849         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 13850
 13851     IF CERTACTI GREATER THAN LOW-VALUES
 13852         MOVE CERTACTI           TO PI-ACCOUNT.
 13853
 13854     IF CERTSTI GREATER THAN LOW-VALUES
 13855         MOVE CERTSTI            TO PI-STATE.
 13856
 13857     IF CERTCARI GREATER THAN LOW-VALUES
 13858         MOVE CERTCARI           TO PI-CARRIER.
 13859
 13860     IF CERTGRPI GREATER THAN LOW-VALUES
 13861         MOVE CERTGRPI           TO PI-GROUPING.
 13862
 13863 5010-EXIT.
 13864     EXIT.
 13865
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 262
* EL131.cbl
 13867 5020-MOVE-MSTR.
 13868
 13869     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 13870     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 13871     MOVE WS-CLAIM-SEQU          TO SEQUO.
 13872     MOVE AL-SABON               TO SEQUA.
 13873     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 13874     MOVE CL-CLAIM-TYPE          TO TYPEO
 13875                                    pi-claim-type
 13876
 13877     IF CL-TOTAL-PAID-AMT  = +0 AND
 13878        CL-LAST-PMT-AMT    = +0 AND
 13879        CL-NO-OF-PMTS-MADE = +0
 13880          MOVE AL-UANON          TO TYPEA.
 13881
 13882     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13883     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13884     MOVE CL-CERT-PRIME          TO CERTO.
 13885     MOVE CL-CERT-SFX            TO SUFXO.
 13886     MOVE CL-CERT-CARRIER        TO CARRO.
 13887
 13888     IF CL-CLAIM-STATUS = 'C'
 13889         MOVE 'CLOSED'           TO STATUSO
 13890     ELSE
 13891         MOVE 'OPEN  '           TO STATUSO.
 13892
 13893     move cl-accident-claim-sw   to accswo
 13894     MOVE CL-PROCESSOR-ID        TO PROCO.
 13895
 13896     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 13897     MOVE CL-CCN                 TO CCNOO.
 13898
 13899     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 13900     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 13901     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 13902     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13903
 13904     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 13905         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13906         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13907         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13908         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 13909     ELSE
 13910         MOVE SPACES             TO BIRTHO.
 13911
 13912     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 13913        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 13914         NEXT SENTENCE
 13915       ELSE
 13916         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 13917
 13918     IF PI-COMPANY-ID = 'DMD'
 13919       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 13920          IF SOCIALO = SPACES OR LOW-VALUES
 13921            MOVE ER-0885         TO EMI-ERROR
 13922            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13923
 13924     MOVE CL-INSURED-OCC-CD      TO OCCO.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 263
* EL131.cbl
 13925     MOVE CL-CAUSE-CD            TO CAUSEO.
 13926
 13927     IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 13928         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13929         MOVE SPACES                 TO DC-OPTION-CODE
 13930         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13931         MOVE DC-GREG-DATE-1-EDIT TO ENDO
 13932     ELSE
 13933         MOVE SPACES             TO ENDO.
 13934
 13935     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 13936        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13937        MOVE SPACES             TO DC-OPTION-CODE
 13938        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13939        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13940        IF PI-USES-PAID-TO
 13941           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13942           MOVE '6'                TO DC-OPTION-CODE
 13943           MOVE +1                 TO DC-ELAPSED-DAYS
 13944           MOVE +0                 TO DC-ELAPSED-MONTHS
 13945           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13946           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13947        ELSE
 13948           NEXT SENTENCE
 13949     ELSE
 13950        MOVE SPACES             TO PDTHRUO.
 13951
 13952     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 13953     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 13954     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 13955     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 13956
 13957     IF MODIFY-CAP
 13958        MOVE AL-UNNOF            TO PDAMTA
 13959                                    NODAYSA
 13960                                    NOPMTSA
 13961        MOVE AL-UANOF            TO PDTHRUA.
 13962     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 13963     MOVE '2'                    TO CNTL-REC-TYPE
 13964     MOVE +0                     TO CNTL-SEQ-NO
 13965     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 13966
 13967
 13968* EXEC CICS READ
 13969*         DATASET  (CNTL-FILE-ID)
 13970*         SET      (ADDRESS OF CONTROL-FILE)
 13971*         RIDFLD   (CNTL-KEY)
 13972*         RESP     (WS-RESPONSE)
 13973*    END-EXEC
 13974*    MOVE '&"S        E          (  N#00011810' TO DFHEIV0
 13975     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13977     MOVE X'204E233030303131383130' TO DFHEIV0(25:11)
 13978     CALL 'kxdfhei1' USING DFHEIV0,
 13979           CNTL-FILE-ID,
 13980           DFHEIV20,
 13981           DFHEIV99,
 13982           CNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 264
* EL131.cbl
 13983           DFHEIV99,
 13984           DFHEIV99,
 13985           DFHEIV99
 13986     SET ADDRESS OF CONTROL-FILE TO
 13987         DFHEIV20
 13988     MOVE EIBRESP  TO WS-RESPONSE
 13989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13990
 13991     IF WS-RESP-NORMAL
 13992        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 13993     end-if
 13994     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 13995         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13996         MOVE SPACES             TO DC-OPTION-CODE
 13997         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13998         MOVE DC-GREG-DATE-1-EDIT TO INCO
 13999     ELSE
 14000         MOVE SPACES             TO INCO.
 14001
 14002     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14003        or (pi-approval-level = '4')
 14004        MOVE AL-UANOF            TO INCA
 14005     end-if
 14006     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14007
 14008     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14009         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14010         MOVE SPACES             TO DC-OPTION-CODE
 14011         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14012         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14013     ELSE
 14014         MOVE SPACES             TO REPO.
 14015
 14016     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14017         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14018         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14019         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14020         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14021     ELSE
 14022         MOVE SPACES             TO ESTO.
 14023
 14024     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14025         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14026         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14027         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14028         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14029     ELSE
 14030         MOVE SPACES             TO MNTDTO.
 14031
 14032
 14033     IF CL-LAST-MAINT-TYPE = SPACE
 14034         MOVE 'SET-UP'           TO MNTTYPEO
 14035     ELSE
 14036     IF CL-LAST-MAINT-TYPE = '1'
 14037         MOVE 'PAYMNT'           TO MNTTYPEO
 14038     ELSE
 14039     IF CL-LAST-MAINT-TYPE = '2'
 14040         MOVE 'LETTER'           TO MNTTYPEO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 265
* EL131.cbl
 14041     ELSE
 14042     IF CL-LAST-MAINT-TYPE = '3'
 14043         MOVE 'UPDATE'           TO MNTTYPEO
 14044     ELSE
 14045     IF CL-LAST-MAINT-TYPE = '4'
 14046         MOVE 'RESTOR'           TO MNTTYPEO
 14047     ELSE
 14048     IF CL-LAST-MAINT-TYPE = '5'
 14049         MOVE 'INC DT'           TO MNTTYPEO
 14050     ELSE
 14051     IF CL-LAST-MAINT-TYPE = '6'
 14052         MOVE ' CONV'            TO MNTTYPEO
 14053     ELSE
 14054     IF CL-LAST-MAINT-TYPE = 'C'
 14055         MOVE 'CHGBEN'           TO MNTTYPEO
 14056     ELSE
 14057     IF CL-LAST-MAINT-TYPE = 'E'
 14058         MOVE 'ERRCOR'           TO MNTTYPEO
 14059     ELSE
 14060         MOVE SPACES             TO MNTTYPEO.
 14061
 14062     MOVE CL-BENEFICIARY         TO BENEO.
 14063     MOVE CL-FILE-LOCATION       TO FILETOO.
 14064     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14065        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14066     END-IF
 14067     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14068     MOVE CL-CRIT-PER-RECURRENT
 14069                                 TO CRITPTO
 14070     IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14071        MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14072     END-IF
 14073     MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14074     MOVE CL-PRIORITY-CD         TO PRICDO.
 14075     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14076     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14077     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14078     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14079
 14080 5020-EXIT.
 14081     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 266
* EL131.cbl
 14083 5030-MOVE-CERT.
 14084
 14085     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 14086         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14087         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14088         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14089         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 14090       ELSE
 14091         MOVE SPACES             TO CERTEFFO
 14092         MOVE ZERO               TO HOLD-DATE.
 14093
 14094     MOVE CM-ACCOUNT             TO CERTACTO.
 14095     MOVE CM-STATE               TO CERTSTO PI-STATE.
 14096     MOVE CM-GROUPING            TO CERTGRPO.
 14097     MOVE CM-CARRIER             TO CERTCARO.
 14098     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14099     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14100     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14101     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14102     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14103     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14104     MOVE CM-JT-INITIAL          TO JNTINITO.
 14105     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14106
 14107*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14108     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 14109     MOVE '3'                    TO CNTL-REC-TYPE.
 14110     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 14111     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 14112     MOVE ZERO                   TO CNTL-SEQ-NO.
 14113
 14114
 14115* EXEC CICS READ
 14116*         SET        (ADDRESS OF CONTROL-FILE)
 14117*         DATASET    ('ELCNTL')
 14118*         RIDFLD     (CNTL-KEY)
 14119*         RESP       (WS-RESPONSE)
 14120*    END-EXEC.
 14121     MOVE 'ELCNTL' TO DFHEIV1
 14122*    MOVE '&"S        E          (  N#00011940' TO DFHEIV0
 14123     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14125     MOVE X'204E233030303131393430' TO DFHEIV0(25:11)
 14126     CALL 'kxdfhei1' USING DFHEIV0,
 14127           DFHEIV1,
 14128           DFHEIV20,
 14129           DFHEIV99,
 14130           CNTL-KEY,
 14131           DFHEIV99,
 14132           DFHEIV99,
 14133           DFHEIV99
 14134     SET ADDRESS OF CONTROL-FILE TO
 14135         DFHEIV20
 14136     MOVE EIBRESP  TO WS-RESPONSE
 14137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14138
 14139
 14140     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 267
* EL131.cbl
 14141        MOVE ZERO                TO CP-FREE-LOOK
 14142     ELSE
 14143        MOVE CF-ST-FREE-LOOK-PERIOD
 14144                                 TO CP-FREE-LOOK.
 14145
 14146     IF CM-LF-BENEFIT-CD = '00'
 14147        GO TO 5030-MOVE-CERT-AH.
 14148
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 268
* EL131.cbl
 14150     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 14151     MOVE '5'                    TO DC-OPTION-CODE
 14152     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14153     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 14154     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14155     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 14156     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 14157     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14158     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14159     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 14160     MOVE '4'                    TO CP-REM-TERM-METHOD
 14161     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 14162     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14163     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14164
 14165     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14166     IF CM-LF-PREMIUM-RATE NUMERIC
 14167         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14168     ELSE
 14169         MOVE ZEROS              TO LCVRATEO.
 14170
 14171     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14172         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 14173
 14174     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 14175
 14176     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 14177
 14178     IF CM-LF-CURRENT-STATUS = '8'
 14179        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14180            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14181            MOVE ' '             TO DC-OPTION-CODE
 14182            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14183            IF NOT DATE-CONVERSION-ERROR
 14184                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14185
 14186     IF CM-LF-CURRENT-STATUS = '7'
 14187        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14188            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 14189            MOVE ' '             TO DC-OPTION-CODE
 14190            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14191            IF NOT DATE-CONVERSION-ERROR
 14192                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14193
 14194     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14195         MOVE ' '                TO DC-OPTION-CODE
 14196         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 14197         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14198         IF NOT DATE-CONVERSION-ERROR
 14199             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 14200             MOVE HOLD-MONTH     TO WORK-MONTH
 14201             MOVE HOLD-YEAR      TO WORK-YEAR
 14202             MOVE WORK-DATE-MY   TO LCVEXITO.
 14203
 14204     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14205        IF CP-REMAINING-TERM-3 = ZEROS
 14206           MOVE 'EXPIRED'        TO LCVSTATO
 14207        ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 269
* EL131.cbl
 14208           MOVE 'ACTIVE'         TO LCVSTATO.
 14209
 14210     IF CM-LF-CURRENT-STATUS = '2'
 14211        MOVE 'PEND   '           TO LCVSTATO.
 14212     IF CM-LF-CURRENT-STATUS = '3'
 14213        MOVE 'RESTORE'           TO LCVSTATO.
 14214     IF CM-LF-CURRENT-STATUS = '5'
 14215        MOVE 'REISSUE'           TO LCVSTATO.
 14216     IF CM-LF-CURRENT-STATUS = '6'
 14217        MOVE 'LMP DIS'           TO LCVSTATO.
 14218     IF CM-LF-CURRENT-STATUS = '7'
 14219        MOVE 'DEATH  '           TO LCVSTATO.
 14220     IF CM-LF-CURRENT-STATUS = '8'
 14221        MOVE 'CANCEL '           TO LCVSTATO.
 14222     IF CM-LF-CURRENT-STATUS = '9'
 14223        MOVE 'RE-ONLY'           TO LCVSTATO.
 14224     IF CM-LF-CURRENT-STATUS = 'V'
 14225        MOVE 'VOID   '           TO LCVSTATO.
 14226     IF CM-LF-CURRENT-STATUS = 'D'
 14227        MOVE 'DECLINE'           TO LCVSTATO.
 14228
 14229     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14230     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14231     MOVE '4'                    TO BEN-REC-TYPE.
 14232     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 14233     MOVE ZERO                   TO BEN-SEQ-NO.
 14234
 14235
 14236* EXEC CICS READ GTEQ
 14237*         DATASET  (CNTL-FILE-ID)
 14238*         RIDFLD   (BENEFIT-KEY)
 14239*         SET      (ADDRESS OF CONTROL-FILE)
 14240*    END-EXEC.
 14241*    MOVE '&"S        G          (   #00012042' TO DFHEIV0
 14242     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14244     MOVE X'2020233030303132303432' TO DFHEIV0(25:11)
 14245     CALL 'kxdfhei1' USING DFHEIV0,
 14246           CNTL-FILE-ID,
 14247           DFHEIV20,
 14248           DFHEIV99,
 14249           BENEFIT-KEY,
 14250           DFHEIV99,
 14251           DFHEIV99,
 14252           DFHEIV99
 14253     SET ADDRESS OF CONTROL-FILE TO
 14254         DFHEIV20
 14255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14256
 14257
 14258     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14259        CF-RECORD-TYPE NOT = '4'
 14260         MOVE ER-0240            TO EMI-ERROR
 14261         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14262         GO TO 5030-MOVE-CERT-FINISH.
 14263
 14264     MOVE ZERO                   TO COUNT-2.
 14265     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 270
* EL131.cbl
 14266
 14267     IF SCREEN-ERROR
 14268         MOVE ER-0282            TO EMI-ERROR
 14269         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14270        ELSE
 14271         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 14272
 14273 5030-MOVE-CERT-AH.
 14274
 14275     IF CM-LF-BENEFIT-CD = '00'
 14276         IF CM-AH-BENEFIT-CD = '00'
 14277             GO TO 5030-MOVE-CERT-FINISH.
 14278
 14279     IF CM-AH-BENEFIT-CD = '00'
 14280        MOVE SPACES             TO ACVKINDO
 14281        COMPUTE PI-PAYMENT-AMT =
 14282                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 14283        GO TO 5030-MOVE-CERT-FINISH.
 14284
 14285     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14286     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 14287     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 14288     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 14289     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14290     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14291     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14292     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 14293
 14294**DMD **********************************************
 14295     IF PI-COMPANY-ID = 'DMD'
 14296         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 14297                                   CM-PMT-EXTENSION-DAYS
 14298         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 14299                                      CL-NO-OF-DAYS-PAID
 14300         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 14301             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 14302         MOVE WS-REM-MOS         TO ACVRTRMO
 14303                                    CP-REMAINING-TERM-3
 14304*        MOVE WS-REM-DAYS        TO DAYSPO
 14305         GO TO 5030-SKIP-RTRM.
 14306**DMD **********************************************
 14307
 14308     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14309     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14310     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14311     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14312
 14313 5030-SKIP-RTRM.
 14314     IF CM-AH-PREMIUM-RATE NUMERIC
 14315         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14316     ELSE
 14317         MOVE ZEROS              TO ACVRATEO.
 14318
 14319     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 14320     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 14321
 14322     IF CM-AH-CURRENT-STATUS = '8'
 14323        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 271
* EL131.cbl
 14324            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14325            MOVE ' '             TO DC-OPTION-CODE
 14326            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14327            IF NOT DATE-CONVERSION-ERROR
 14328                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14329
 14330     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14331        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14332            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 14333            MOVE ' '             TO DC-OPTION-CODE
 14334            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14335            IF NOT DATE-CONVERSION-ERROR
 14336                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14337
 14338     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14339        IF CP-REMAINING-TERM-3 = ZEROS
 14340           MOVE 'EXPIRED'        TO ACVSTATO
 14341        ELSE
 14342           MOVE 'ACTIVE'         TO ACVSTATO.
 14343
 14344     IF CM-AH-CURRENT-STATUS = '2'
 14345        MOVE 'PEND   '           TO ACVSTATO.
 14346     IF CM-AH-CURRENT-STATUS = '3'
 14347        MOVE 'RESTORE'           TO ACVSTATO.
 14348     IF CM-AH-CURRENT-STATUS = '5'
 14349        MOVE 'REISSUE'           TO ACVSTATO.
 14350     IF CM-AH-CURRENT-STATUS = '6'
 14351        MOVE 'LMP DIS'           TO ACVSTATO.
 14352     IF CM-AH-CURRENT-STATUS = '7'
 14353        MOVE 'DEATH  '           TO ACVSTATO.
 14354     IF CM-AH-CURRENT-STATUS = '8'
 14355        MOVE 'CANCEL '           TO ACVSTATO.
 14356     IF CM-AH-CURRENT-STATUS = '9'
 14357        MOVE 'RE-ONLY'           TO ACVSTATO.
 14358     IF CM-AH-CURRENT-STATUS = 'V'
 14359        MOVE 'VOID   '           TO ACVSTATO.
 14360     IF CM-AH-CURRENT-STATUS = '9'
 14361        MOVE 'DECLINE'           TO ACVSTATO.
 14362
 14363     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14364         MOVE ' '                TO DC-OPTION-CODE
 14365         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14366         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14367         IF NOT DATE-CONVERSION-ERROR
 14368             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 14369             MOVE HOLD-MONTH     TO WORK-MONTH
 14370             MOVE HOLD-YEAR      TO WORK-YEAR
 14371             MOVE WORK-DATE-MY   TO ACVEXITO.
 14372
 14373     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14374
 14375     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14376     MOVE '5'                    TO BEN-REC-TYPE.
 14377     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 14378     MOVE ZERO                   TO BEN-SEQ-NO.
 14379
 14380
 14381* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 272
* EL131.cbl
 14382*         DATASET  (CNTL-FILE-ID)
 14383*         RIDFLD   (BENEFIT-KEY)
 14384*         SET      (ADDRESS OF CONTROL-FILE)
 14385*    END-EXEC.
 14386*    MOVE '&"S        G          (   #00012170' TO DFHEIV0
 14387     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14388     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14389     MOVE X'2020233030303132313730' TO DFHEIV0(25:11)
 14390     CALL 'kxdfhei1' USING DFHEIV0,
 14391           CNTL-FILE-ID,
 14392           DFHEIV20,
 14393           DFHEIV99,
 14394           BENEFIT-KEY,
 14395           DFHEIV99,
 14396           DFHEIV99,
 14397           DFHEIV99
 14398     SET ADDRESS OF CONTROL-FILE TO
 14399         DFHEIV20
 14400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14401
 14402
 14403     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14404        CF-RECORD-TYPE NOT = '5'
 14405         MOVE ER-0250            TO EMI-ERROR
 14406         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14407         GO TO 5030-MOVE-CERT-FINISH.
 14408
 14409     MOVE ZERO                   TO COUNT-2.
 14410     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 14411
 14412     IF SCREEN-ERROR
 14413         MOVE ER-0283            TO EMI-ERROR
 14414         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14415       ELSE
 14416         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 14417
 14418 5030-MOVE-CERT-FINISH.
 14419
 14420     MOVE CM-LOAN-APR            TO APRO.
 14421     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14422     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14423     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 14424     MOVE CM-LOAN-NUMBER         TO LOANNOO
 14425     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 14426     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 14427
 14428     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 14429         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14430         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14431         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14432         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 14433     ELSE
 14434         MOVE SPACES               TO ADDONDTO.
 14435
 14436     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 14437
 14438 5030-EXIT.
 14439     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 273
* EL131.cbl
 14441 5040-FIND-BENEFIT.
 14442     ADD 1                       TO COUNT-2.
 14443     IF COUNT-2 GREATER THAN 8
 14444         GO TO 5050-BENEFIT-NOTFND.
 14445
 14446     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 14447         GO TO 5060-EXIT.
 14448
 14449     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 14450         GO TO 5050-BENEFIT-NOTFND.
 14451
 14452     GO TO 5040-FIND-BENEFIT.
 14453
 14454 5050-BENEFIT-NOTFND.
 14455     MOVE 'X'                    TO ERROR-SWITCH.
 14456
 14457 5060-EXIT.
 14458     EXIT.
 14459
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 274
* EL131.cbl
 14461 6000-CALCULATE-CERT-TERM.
 14462
 14463     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 14464         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 14465     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 14466         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 14467     IF CM-LOAN-APR NOT NUMERIC
 14468         MOVE ZEROS              TO CM-LOAN-APR.
 14469
 14470*    IF WS-CALC-METHOD  = 'G'
 14471         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 14472*     ELSE
 14473*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 14474
 14475     IF N GREATER 120
 14476         MOVE 120                TO N.
 14477
 14478     MOVE '6'                    TO DC-OPTION-CODE.
 14479     MOVE N                      TO DC-ELAPSED-MONTHS.
 14480     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14481     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 14482
 14483     IF CM-LF-BENEFIT-CD NOT = ZERO
 14484         MOVE N                  TO CM-LF-ORIG-TERM
 14485         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 14486         IF NO-CONVERSION-ERROR
 14487             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 14488
 14489     IF CM-AH-BENEFIT-CD NOT = ZERO
 14490         MOVE N                  TO CM-AH-ORIG-TERM
 14491         IF NO-CONVERSION-ERROR
 14492             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 14493
 14494 6000-EXIT.
 14495      EXIT.
 14496
 14497 6100-CALC-GROSS-TERM.
 14498     MOVE CM-LOAN-BALANCE         TO L.
 14499     MOVE PI-PAYMENT-AMT          TO M.
 14500
 14501     COMPUTE N = L / M.
 14502     IF N LESS 1
 14503         MOVE 1  TO N.
 14504
 14505     IF CM-LF-BENEFIT-CD NOT = ZERO
 14506         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 14507     ELSE
 14508         MOVE ZEROS               TO WS-LF-RATE.
 14509
 14510     IF CM-AH-BENEFIT-CD NOT = ZERO
 14511         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 14512     ELSE
 14513         MOVE ZEROS               TO WS-AH-RATE.
 14514
 14515     COMPUTE I = CM-LOAN-APR / +1200.
 14516
 14517 6105-LOOP.
 14518     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 275
* EL131.cbl
 14519         GO TO 6200-EXIT.
 14520     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 14521     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 14522         ADD 1 TO N
 14523         GO TO 6105-LOOP.
 14524
 14525 6200-EXIT.
 14526      EXIT.
 14527
 14528 6210-CALC-LEFT-RIGHTONE.
 14529      MOVE L         TO LEFT-TOT-1.
 14530      SUBTRACT 1 FROM N.
 14531      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14532      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 14533      ADD 1 TO N.
 14534 6211-CALC-TERM1.
 14535      MOVE N         TO TERM1.
 14536      MULTIPLY M BY TERM1.
 14537 6212-LOOP.
 14538      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 14539      ADD 1 TO A-N.
 14540      MULTIPLY A-N BY TERM1.
 14541      SUBTRACT 1 FROM A-N.
 14542      ADD TERM1 TO LEFT-TOT-1.
 14543 6213-CALC-TERM2.
 14544      MOVE M         TO TERM2.
 14545      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 14546      MULTIPLY IA-N BY TERM2.
 14547      SUBTRACT TERM2 FROM LEFT-TOT-1.
 14548 6215-CALC-RIGHTONE.
 14549      MOVE M         TO RIGHT-TOT-1.
 14550      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14551      MULTIPLY A-N BY RIGHT-TOT-1.
 14552 6220-EXIT.
 14553      EXIT.
 14554
 14555 6300-CALC-A-N.
 14556     IF N LESS 1
 14557         MOVE 0     TO A-N
 14558         GO TO 6300-EXIT.
 14559     IF I = 0
 14560         MOVE .00001 TO I.
 14561     ADD 1 TO I.
 14562     DIVIDE I INTO 1 GIVING V.
 14563     SUBTRACT 1 FROM I.
 14564     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14565     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 14566     DIVIDE I INTO TERM3 GIVING A-N.
 14567 6300-EXIT.
 14568      EXIT.
 14569
 14570 6350-CALC-IA-N.
 14571     IF N LESS 1
 14572         MOVE 0      TO IA-N
 14573         GO TO 6400-EXIT.
 14574     ADD 1 TO N.
 14575     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14576     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 276
* EL131.cbl
 14577     MULTIPLY N BY V-EX-N GIVING TERM3.
 14578     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 14579     SUBTRACT V FROM 1 GIVING TERM4.
 14580     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 14581 6400-EXIT.
 14582      EXIT.
 14583
 14584 6450-CALC-V-EX-N.
 14585     IF N LESS 1
 14586         MOVE 1    TO V-EX-N
 14587         GO TO 6490-EXIT.
 14588     MOVE N        TO NV-STORE.
 14589     IF V-EX-ONETIME = 1  OR
 14590        V NOT = V-EXPONENT (1)
 14591          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 14592 6460-LOOP.
 14593     IF N GREATER 248
 14594         MOVE 248 TO N.
 14595     IF N = 1
 14596         MOVE V               TO V-EX-N
 14597      ELSE
 14598         MOVE V-EXPONENT (N)  TO V-EX-N.
 14599     GO TO 6490-EXIT.
 14600
 14601 6470-BUILD-V-EX-TABLE.
 14602     MOVE 2      TO N.
 14603     MOVE V      TO V-EXPONENT (1)
 14604                    V-EX-N.
 14605 6471-LOOP.
 14606     MULTIPLY V BY V-EX-N.
 14607     MOVE V-EX-N   TO V-EXPONENT (N).
 14608     ADD 1 TO N.
 14609     IF N LESS 248
 14610         GO TO 6471-LOOP.
 14611     MOVE NV-STORE     TO N.
 14612     MOVE 0            TO V-EX-ONETIME.
 14613 6480-EXIT.
 14614      EXIT.
 14615
 14616 6490-EXIT.
 14617      EXIT.
 14618
 14619 6500-CALC-NET-TERM.
 14620     MOVE CM-LOAN-BALANCE         TO L.
 14621     MOVE PI-PAYMENT-AMT          TO M.
 14622
 14623     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 14624     IF WS-REMAIN GREATER ZERO
 14625         ADD 1 TO N.
 14626     IF N = 0
 14627         MOVE 1 TO N.
 14628
 14629 6700-EXIT.
 14630      EXIT.
 14631
 14632 6999-CALC-TERM-EXIT.
 14633     EXIT.
 14634
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 277
* EL131.cbl
 14636 7000-RESET-ATTRIBUTE.
 14637
 14638     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 14639                                    CERTSTA   CERTCARA
 14640                                    CERTGRPA.
 14641     MOVE -1                     TO CERTCARL.
 14642
 14643 7000-EXIT.
 14644     EXIT.
 14645
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 278
* EL131.cbl
 14647 7600-BROWSE-CLAIM.
 14648
 14649
 14650* EXEC CICS READ
 14651*        DATASET(CLMS-FILE-ID)
 14652*        SET    (ADDRESS OF CLAIM-MASTER)
 14653*        RIDFLD (MSTR-KEY)
 14654*        GENERIC
 14655*        EQUAL
 14656*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14657*    END-EXEC.
 14658*    MOVE '&"S  KG    E          (   #00012422' TO DFHEIV0
 14659     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14660     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14661     MOVE X'2020233030303132343232' TO DFHEIV0(25:11)
 14662     CALL 'kxdfhei1' USING DFHEIV0,
 14663           CLMS-FILE-ID,
 14664           DFHEIV20,
 14665           DFHEIV99,
 14666           MSTR-KEY,
 14667           ELMSTR-GENERIC-LENGTH,
 14668           DFHEIV99,
 14669           DFHEIV99
 14670     SET ADDRESS OF CLAIM-MASTER TO
 14671         DFHEIV20
 14672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14673
 14674
 14675     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 14676
 14677     if cl-assoc-cert-total = 0
 14678        move 1 to cl-assoc-cert-total
 14679     end-if
 14680     IF CL-ASSOC-CERT-SEQU = 0
 14681        MOVE 1 TO CL-ASSOC-CERT-SEQU
 14682     END-IF
 14683
 14684     IF CL-ASSOC-CERT-TOTAL = 1
 14685         MOVE AL-SADOF           TO BCERT1A
 14686                                    BSUFX1A
 14687                                    BCERT2A
 14688                                    BSUFX2A
 14689                                    BCERT3A
 14690                                    BSUFX3A
 14691                                    BCERT4A
 14692                                    BSUFX4A
 14693                                    BCERT5A
 14694                                    BSUFX5A
 14695                                    PCERTNOA
 14696                                    PSUFXA
 14697                                    LABEL1A
 14698                                    LABEL2A
 14699         GO TO 7699-EXIT.
 14700
 14701 7610-BROWSE-CLAIM-LOOP.
 14702
 14703     MOVE LOW-VALUES             TO BCERT1O
 14704                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 279
* EL131.cbl
 14705                                    BCERT2O
 14706                                    BSUFX2O
 14707                                    BCERT3O
 14708                                    BSUFX3O
 14709                                    BCERT4O
 14710                                    BSUFX4O
 14711                                    BCERT5O
 14712                                    BSUFX5O.
 14713
 14714
 14715* EXEC CICS HANDLE CONDITION
 14716*        ENDFILE  (7630-END-BROWSE)
 14717*    END-EXEC.
 14718*    MOVE '"$''                   ! C #00012470' TO DFHEIV0
 14719     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14721     MOVE X'4320233030303132343730' TO DFHEIV0(25:11)
 14722     CALL 'kxdfhei1' USING DFHEIV0
 14723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14724
 14725
 14726
 14727* EXEC CICS STARTBR
 14728*        DATASET    (CLMS-FILE-ID)
 14729*        RIDFLD     (MSTR-KEY)
 14730*    END-EXEC.
 14731     MOVE 0
 14732       TO DFHEIV11
 14733*    MOVE '&,         G          &   #00012474' TO DFHEIV0
 14734     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14735     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14736     MOVE X'2020233030303132343734' TO DFHEIV0(25:11)
 14737     CALL 'kxdfhei1' USING DFHEIV0,
 14738           CLMS-FILE-ID,
 14739           MSTR-KEY,
 14740           DFHEIV99,
 14741           DFHEIV11,
 14742           DFHEIV99
 14743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14744
 14745
 14746     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14747
 14748 7620-READ-CLAIM-LOOP.
 14749
 14750
 14751* EXEC CICS READNEXT
 14752*        DATASET   (CLMS-FILE-ID)
 14753*        SET       (ADDRESS OF CLAIM-MASTER)
 14754*        RIDFLD    (MSTR-KEY)
 14755*    END-EXEC.
 14756     MOVE 0
 14757       TO DFHEIV11
 14758*    MOVE '&.S                   )   #00012483' TO DFHEIV0
 14759     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14760     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14761     MOVE X'2020233030303132343833' TO DFHEIV0(25:11)
 14762     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 280
* EL131.cbl
 14763           CLMS-FILE-ID,
 14764           DFHEIV20,
 14765           DFHEIV99,
 14766           MSTR-KEY,
 14767           DFHEIV99,
 14768           DFHEIV11,
 14769           DFHEIV99,
 14770           DFHEIV99
 14771     SET ADDRESS OF CLAIM-MASTER TO
 14772         DFHEIV20
 14773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14774
 14775
 14776     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 14777        CL-CARRIER     NOT = CARRI           OR
 14778        CL-CLAIM-NO    NOT = CLAIMI
 14779        GO TO 7630-END-BROWSE.
 14780
 14781     IF WS-ASSOCIATED-CERTS = 1
 14782         MOVE CL-CERT-PRIME      TO BCERT1O
 14783         MOVE CL-CERT-SFX        TO BSUFX1O.
 14784
 14785     IF WS-ASSOCIATED-CERTS = 2
 14786         MOVE CL-CERT-PRIME      TO BCERT2O
 14787         MOVE CL-CERT-SFX        TO BSUFX2O.
 14788
 14789     IF WS-ASSOCIATED-CERTS = 3
 14790         MOVE CL-CERT-PRIME      TO BCERT3O
 14791         MOVE CL-CERT-SFX        TO BSUFX3O.
 14792
 14793     IF WS-ASSOCIATED-CERTS = 4
 14794         MOVE CL-CERT-PRIME      TO BCERT4O
 14795         MOVE CL-CERT-SFX        TO BSUFX4O.
 14796
 14797     IF WS-ASSOCIATED-CERTS = 5
 14798         MOVE CL-CERT-PRIME      TO BCERT5O
 14799         MOVE CL-CERT-SFX        TO BSUFX5O
 14800     ELSE
 14801         ADD +1                  TO WS-ASSOCIATED-CERTS
 14802         GO TO 7620-READ-CLAIM-LOOP.
 14803
 14804 7630-END-BROWSE.
 14805
 14806
 14807* EXEC CICS ENDBR
 14808*        DATASET   (CLMS-FILE-ID)
 14809*    END-EXEC.
 14810     MOVE 0
 14811       TO DFHEIV11
 14812*    MOVE '&2                    $   #00012519' TO DFHEIV0
 14813     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14814     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14815     MOVE X'2020233030303132353139' TO DFHEIV0(25:11)
 14816     CALL 'kxdfhei1' USING DFHEIV0,
 14817           CLMS-FILE-ID,
 14818           DFHEIV11,
 14819           DFHEIV99
 14820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 281
* EL131.cbl
 14821
 14822
 14823 7640-HIGHLIGHT-CERT-DISPLAYED.
 14824
 14825     MOVE AL-SANON               TO BCERT1A
 14826                                    BSUFX1A
 14827                                    BCERT2A
 14828                                    BSUFX2A
 14829                                    BCERT3A
 14830                                    BSUFX3A
 14831                                    BCERT4A
 14832                                    BSUFX4A
 14833                                    BCERT5A
 14834                                    BSUFX5A.
 14835
 14836     IF BCERT1O = CERTI AND
 14837        BSUFX1O = SUFXI
 14838            MOVE AL-SABON        TO BCERT1A
 14839                                    BSUFX1A.
 14840
 14841     IF BCERT2O = CERTI AND
 14842        BSUFX2O = SUFXI
 14843            MOVE AL-SABON        TO BCERT2A
 14844                                    BSUFX2A.
 14845
 14846     IF BCERT3O = CERTI AND
 14847        BSUFX3O = SUFXI
 14848            MOVE AL-SABON        TO BCERT3A
 14849                                    BSUFX3A.
 14850
 14851     IF BCERT4O = CERTI AND
 14852        BSUFX4O = SUFXI
 14853            MOVE AL-SABON        TO BCERT4A
 14854                                    BSUFX4A.
 14855
 14856     IF BCERT5O = CERTI AND
 14857        BSUFX5O = SUFXI
 14858            MOVE AL-SABON        TO BCERT5A
 14859                                    BSUFX5A.
 14860
 14861 7699-EXIT.
 14862     EXIT.
 14863
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 282
* EL131.cbl
 14865 7700-CHECK-SEQUENCE.
 14866
 14867
 14868* EXEC CICS HANDLE CONDITION
 14869*        ENDFILE  (7799-EXIT)
 14870*        NOTFND   (7799-EXIT)
 14871*    END-EXEC.
 14872*    MOVE '"$''I                  ! D #00012567' TO DFHEIV0
 14873     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14875     MOVE X'4420233030303132353637' TO DFHEIV0(25:11)
 14876     CALL 'kxdfhei1' USING DFHEIV0
 14877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14878
 14879
 14880
 14881* EXEC CICS READ
 14882*        DATASET(CLMS-FILE-ID)
 14883*        SET    (ADDRESS OF CLAIM-MASTER)
 14884*        RIDFLD (MSTR-KEY)
 14885*        GENERIC
 14886*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14887*    END-EXEC.
 14888*    MOVE '&"S  KG    E          (   #00012572' TO DFHEIV0
 14889     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14890     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14891     MOVE X'2020233030303132353732' TO DFHEIV0(25:11)
 14892     CALL 'kxdfhei1' USING DFHEIV0,
 14893           CLMS-FILE-ID,
 14894           DFHEIV20,
 14895           DFHEIV99,
 14896           MSTR-KEY,
 14897           ELMSTR-GENERIC-LENGTH,
 14898           DFHEIV99,
 14899           DFHEIV99
 14900     SET ADDRESS OF CLAIM-MASTER TO
 14901         DFHEIV20
 14902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14903
 14904
 14905     COMPUTE WS-ASSOC-CERT-TOTAL =
 14906             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14907
 14908     GO TO 7799-EXIT.
 14909
 14910 7710-RESEQUENCE-CLAIMS.
 14911
 14912
 14913* EXEC CICS HANDLE CONDITION
 14914*        ENDFILE  (7799-EXIT)
 14915*    END-EXEC.
 14916*    MOVE '"$''                   ! E #00012587' TO DFHEIV0
 14917     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14919     MOVE X'4520233030303132353837' TO DFHEIV0(25:11)
 14920     CALL 'kxdfhei1' USING DFHEIV0
 14921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14922
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 283
* EL131.cbl
 14923
 14924
 14925* EXEC CICS STARTBR
 14926*        DATASET(CLMS-FILE-ID)
 14927*        RIDFLD (MSTR-KEY)
 14928*    END-EXEC.
 14929     MOVE 0
 14930       TO DFHEIV11
 14931*    MOVE '&,         G          &   #00012591' TO DFHEIV0
 14932     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14933     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14934     MOVE X'2020233030303132353931' TO DFHEIV0(25:11)
 14935     CALL 'kxdfhei1' USING DFHEIV0,
 14936           CLMS-FILE-ID,
 14937           MSTR-KEY,
 14938           DFHEIV99,
 14939           DFHEIV11,
 14940           DFHEIV99
 14941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14942
 14943
 14944     COMPUTE WS-ASSOC-CERT-SEQU =
 14945             WS-ASSOC-CERT-SEQU + 1.
 14946
 14947     COMPUTE WS-READNEXT-SWITCH =
 14948             WS-READNEXT-SWITCH + 1.
 14949
 14950 7720-READ-CLAIM-LOOP.
 14951
 14952
 14953* EXEC CICS READNEXT
 14954*        DATASET(CLMS-FILE-ID)
 14955*        SET    (ADDRESS OF CLAIM-MASTER)
 14956*        RIDFLD (MSTR-KEY)
 14957*    END-EXEC.
 14958     MOVE 0
 14959       TO DFHEIV11
 14960*    MOVE '&.S                   )   #00012604' TO DFHEIV0
 14961     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14962     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14963     MOVE X'2020233030303132363034' TO DFHEIV0(25:11)
 14964     CALL 'kxdfhei1' USING DFHEIV0,
 14965           CLMS-FILE-ID,
 14966           DFHEIV20,
 14967           DFHEIV99,
 14968           MSTR-KEY,
 14969           DFHEIV99,
 14970           DFHEIV11,
 14971           DFHEIV99,
 14972           DFHEIV99
 14973     SET ADDRESS OF CLAIM-MASTER TO
 14974         DFHEIV20
 14975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14976
 14977
 14978     IF WS-READNEXT-SWITCH = 1
 14979         ADD 1                   TO WS-READNEXT-SWITCH
 14980         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 284
* EL131.cbl
 14981
 14982 7730-END-BROWSE.
 14983
 14984
 14985* EXEC CICS ENDBR
 14986*        DATASET(CLMS-FILE-ID)
 14987*    END-EXEC.
 14988     MOVE 0
 14989       TO DFHEIV11
 14990*    MOVE '&2                    $   #00012616' TO DFHEIV0
 14991     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14992     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14993     MOVE X'2020233030303132363136' TO DFHEIV0(25:11)
 14994     CALL 'kxdfhei1' USING DFHEIV0,
 14995           CLMS-FILE-ID,
 14996           DFHEIV11,
 14997           DFHEIV99
 14998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14999
 15000
 15001 7740-READ-CLAIM-UPDATE.
 15002
 15003     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15004        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15005        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15006        GO TO 7799-EXIT
 15007     ELSE
 15008        MOVE ZERO                TO WS-READNEXT-SWITCH.
 15009
 15010
 15011* EXEC CICS READ
 15012*        DATASET(CLMS-FILE-ID)
 15013*        SET    (ADDRESS OF CLAIM-MASTER)
 15014*        RIDFLD (MSTR-KEY)
 15015*        UPDATE
 15016*    END-EXEC.
 15017*    MOVE '&"S        EU         (   #00012629' TO DFHEIV0
 15018     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15019     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15020     MOVE X'2020233030303132363239' TO DFHEIV0(25:11)
 15021     CALL 'kxdfhei1' USING DFHEIV0,
 15022           CLMS-FILE-ID,
 15023           DFHEIV20,
 15024           DFHEIV99,
 15025           MSTR-KEY,
 15026           DFHEIV99,
 15027           DFHEIV99,
 15028           DFHEIV99
 15029     SET ADDRESS OF CLAIM-MASTER TO
 15030         DFHEIV20
 15031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15032
 15033
 15034     if (cl-priority-cd = '8')
 15035        and (pi-processor-id not = 'PEMA' and 'JMS '
 15036             AND 'AMWA')
 15037        MOVE ER-8003             TO EMI-ERROR
 15038        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 285
* EL131.cbl
 15039                                 THRU 9900-EXIT
 15040        MOVE -1                  TO MAINTL
 15041        GO TO 8110-SEND-DATA
 15042     end-if
 15043
 15044     IF PI-COMPANY-ID = 'CID' or 'AHL'
 15045         MOVE 'Y'                TO CL-YESNOSW
 15046     END-IF.
 15047
 15048     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15049     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15050
 15051
 15052* EXEC CICS REWRITE
 15053*         DATASET(CLMS-FILE-ID)
 15054*         FROM   (CLAIM-MASTER)
 15055*    END-EXEC.
 15056     MOVE LENGTH OF
 15057      CLAIM-MASTER
 15058       TO DFHEIV11
 15059*    MOVE '&& L                  %   #00012653' TO DFHEIV0
 15060     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15061     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15062     MOVE X'2020233030303132363533' TO DFHEIV0(25:11)
 15063     CALL 'kxdfhei1' USING DFHEIV0,
 15064           CLMS-FILE-ID,
 15065           CLAIM-MASTER,
 15066           DFHEIV11,
 15067           DFHEIV99
 15068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15069
 15070
 15071     GO TO 7710-RESEQUENCE-CLAIMS.
 15072
 15073 7799-EXIT.
 15074     EXIT.
 15075
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 286
* EL131.cbl
 15077 7800-CHECK-AUTO-ACTIVITY.
 15078
 15079
 15080* EXEC CICS HANDLE CONDITION
 15081*        NOTFND   (7800-NOT-FOUND)
 15082*    END-EXEC.
 15083*    MOVE '"$I                   ! F #00012666' TO DFHEIV0
 15084     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15086     MOVE X'4620233030303132363636' TO DFHEIV0(25:11)
 15087     CALL 'kxdfhei1' USING DFHEIV0
 15088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15089
 15090
 15091     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 15092     MOVE 'T'                        TO  CNTL-REC-TYPE.
 15093     MOVE SPACES                     TO  CNTL-PROC-ID.
 15094     MOVE +0                         TO  CNTL-SEQ-NO.
 15095
 15096
 15097* EXEC CICS READ
 15098*        DATASET   (CNTL-FILE-ID)
 15099*        RIDFLD    (CNTL-KEY)
 15100*        SET       (ADDRESS OF CONTROL-FILE)
 15101*    END-EXEC.
 15102*    MOVE '&"S        E          (   #00012675' TO DFHEIV0
 15103     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15104     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15105     MOVE X'2020233030303132363735' TO DFHEIV0(25:11)
 15106     CALL 'kxdfhei1' USING DFHEIV0,
 15107           CNTL-FILE-ID,
 15108           DFHEIV20,
 15109           DFHEIV99,
 15110           CNTL-KEY,
 15111           DFHEIV99,
 15112           DFHEIV99,
 15113           DFHEIV99
 15114     SET ADDRESS OF CONTROL-FILE TO
 15115         DFHEIV20
 15116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15117
 15118
 15119     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 15120         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 15121
 15122     IF CL-ACTIVITY-CODE NOT = ZEROS
 15123         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 15124         IF MISC-SUB IS GREATER THAN +9
 15125             SUBTRACT +9 FROM MISC-SUB
 15126             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 15127         ELSE
 15128             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 15129     ELSE
 15130         MOVE 'Y'                              TO  WS-RESET-SW.
 15131
 15132     IF STATUSI = 'C' OR 'CLOSED'
 15133         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 15134             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 287
* EL131.cbl
 15135                                         PI-LETTER-SW
 15136             GO TO 7800-EXIT.
 15137
 15138     IF STATUSI = 'C' OR 'CLOSED'
 15139         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 15140             MOVE 'N'                TO  PI-LETTER-SW
 15141         ELSE
 15142             MOVE 'Y'                TO  PI-LETTER-SW.
 15143
 15144     IF STATUSI = 'O' OR 'OPEN'
 15145         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 15146             MOVE 'N'                TO  PI-REC-FOUND-SW
 15147                                         PI-LETTER-SW
 15148             GO TO 7800-EXIT.
 15149
 15150     IF STATUSI = 'O' OR 'OPEN'
 15151         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 15152             MOVE 'N'                TO  PI-LETTER-SW
 15153         ELSE
 15154             MOVE 'Y'                TO  PI-LETTER-SW.
 15155
 15156     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 15157     GO TO 7800-EXIT.
 15158
 15159 7800-NOT-FOUND.
 15160
 15161     MOVE 'N'                        TO  PI-REC-FOUND-SW
 15162                                         PI-LETTER-SW.
 15163
 15164 7800-EXIT.
 15165     EXIT.
 15166
 15167 7850-AUTO-LETTER-WRITER.
 15168
 15169     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 15170     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 15171
 15172     IF STATUSI = 'C' OR 'CLOSED'
 15173         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 15174     ELSE
 15175         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 15176
 15177     IF STATUSI = 'C' OR 'CLOSED'
 15178         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 15179             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15180             MOVE '6'                TO  DC-OPTION-CODE
 15181             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 15182             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15183             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15184             IF NO-CONVERSION-ERROR
 15185                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15186             ELSE
 15187                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15188
 15189     IF STATUSI = 'C' OR 'CLOSED'
 15190         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 15191             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15192             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 288
* EL131.cbl
 15193             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 15194             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15195             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15196             IF NO-CONVERSION-ERROR
 15197                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15198             ELSE
 15199                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15200
 15201     IF STATUSI = 'O' OR 'OPEN'
 15202         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 15203             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15204             MOVE '6'                TO  DC-OPTION-CODE
 15205             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 15206             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15207             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15208             IF NO-CONVERSION-ERROR
 15209                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15210             ELSE
 15211                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15212
 15213     IF STATUSI = 'O' OR 'OPEN'
 15214         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 15215             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15216             MOVE '6'                TO  DC-OPTION-CODE
 15217             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 15218             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15219             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15220             IF NO-CONVERSION-ERROR
 15221                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15222             ELSE
 15223                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15224
 15225
 15226* EXEC CICS LINK
 15227*        PROGRAM    (LINK-1523)
 15228*        COMMAREA   (W-1523-LINKDATA)
 15229*        LENGTH     (W-1523-COMM-LENGTH)
 15230*    END-EXEC.
 15231*    MOVE '."C                   (   #00012787' TO DFHEIV0
 15232     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15234     MOVE X'2020233030303132373837' TO DFHEIV0(25:11)
 15235     CALL 'kxdfhei1' USING DFHEIV0,
 15236           LINK-1523,
 15237           W-1523-LINKDATA,
 15238           W-1523-COMM-LENGTH,
 15239           DFHEIV99,
 15240           DFHEIV99,
 15241           DFHEIV99,
 15242           DFHEIV99
 15243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15244
 15245
 15246     IF W-1523-ERROR-CODE = ZEROS
 15247         GO TO 7850-EXIT.
 15248
 15249     IF W-1523-FATAL-ERROR
 15250         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 289
* EL131.cbl
 15251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15252
 15253     IF W-1523-ERROR-CODE = 0191
 15254         MOVE ER-0803                TO  EMI-ERROR
 15255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15256
 15257 7850-EXIT.
 15258     EXIT.
 15259
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 290
* EL131.cbl
 15261 8000-CREATE-DMO-REC.
 15262     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 15263     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 15264     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 15265
 15266
 15267* EXEC CICS HANDLE CONDITION
 15268*         NOTFND   (8000-NOTE-NOT-FOUND)
 15269*    END-EXEC.
 15270*    MOVE '"$I                   ! G #00012813' TO DFHEIV0
 15271     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15272     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15273     MOVE X'4720233030303132383133' TO DFHEIV0(25:11)
 15274     CALL 'kxdfhei1' USING DFHEIV0
 15275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15276
 15277
 15278
 15279* EXEC CICS READ
 15280*         DATASET(NOTE-FILE-ID)
 15281*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 15282*         RIDFLD (NOTE-KEY)
 15283*    END-EXEC.
 15284*    MOVE '&"S        E          (   #00012817' TO DFHEIV0
 15285     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15286     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15287     MOVE X'2020233030303132383137' TO DFHEIV0(25:11)
 15288     CALL 'kxdfhei1' USING DFHEIV0,
 15289           NOTE-FILE-ID,
 15290           DFHEIV20,
 15291           DFHEIV99,
 15292           NOTE-KEY,
 15293           DFHEIV99,
 15294           DFHEIV99,
 15295           DFHEIV99
 15296     SET ADDRESS OF CERTIFICATE-NOTE TO
 15297         DFHEIV20
 15298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15299
 15300
 15301     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 15302     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 15303     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 15304
 15305     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 15306         MOVE 'CC'               TO DCT-PRODUCT-CODE
 15307     ELSE
 15308         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 15309
 15310     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 15311     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 15312
 15313
 15314* EXEC CICS LINK
 15315*        PROGRAM    ('DLO006')
 15316*        COMMAREA   (DCT-COMMUNICATION-AREA)
 15317*        LENGTH     (WS-DCT-LENGTH)
 15318*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 291
* EL131.cbl
 15319     MOVE 'DLO006' TO DFHEIV1
 15320*    MOVE '."C                   (   #00012835' TO DFHEIV0
 15321     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15323     MOVE X'2020233030303132383335' TO DFHEIV0(25:11)
 15324     CALL 'kxdfhei1' USING DFHEIV0,
 15325           DFHEIV1,
 15326           DCT-COMMUNICATION-AREA,
 15327           WS-DCT-LENGTH,
 15328           DFHEIV99,
 15329           DFHEIV99,
 15330           DFHEIV99,
 15331           DFHEIV99
 15332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15333
 15334
 15335     IF  DCT-RETURN-CODE = 'OK'
 15336         GO TO 8000-CONT.
 15337
 15338     IF DCT-RETURN-CODE = '01' OR '02'
 15339         GO TO 8000-EXIT.
 15340
 15341     IF DCT-RETURN-CODE = '03'
 15342         MOVE ER-0951            TO EMI-ERROR
 15343         MOVE -1                 TO MAINTL
 15344         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15345         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15346         GO TO 8110-SEND-DATA.
 15347
 15348     IF DCT-RETURN-CODE = '04'
 15349         MOVE ER-0946            TO EMI-ERROR
 15350         MOVE -1                 TO MAINTL
 15351         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15352         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15353         GO TO 8110-SEND-DATA.
 15354
 15355     IF DCT-RETURN-CODE = '05'
 15356         MOVE ER-0947            TO EMI-ERROR
 15357         MOVE -1                 TO MAINTL
 15358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15359         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15360         GO TO 8110-SEND-DATA.
 15361
 15362     IF DCT-RETURN-CODE = '06'
 15363         MOVE ER-0921            TO EMI-ERROR
 15364         MOVE -1                 TO MAINTL
 15365         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15366         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15367         GO TO 8110-SEND-DATA.
 15368
 15369     IF DCT-RETURN-CODE = '07'
 15370         MOVE ER-0919            TO EMI-ERROR
 15371         MOVE -1                 TO MAINTL
 15372         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15373         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15374         GO TO 8110-SEND-DATA.
 15375
 15376     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 292
* EL131.cbl
 15377         MOVE ER-0948            TO EMI-ERROR
 15378         MOVE -1                 TO MAINTL
 15379         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15380         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15381         GO TO 8110-SEND-DATA.
 15382
 15383     IF DCT-RETURN-CODE = 'N1'
 15384         MOVE ER-0950            TO EMI-ERROR
 15385         MOVE -1                 TO MAINTL
 15386         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15387         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15388         GO TO 8110-SEND-DATA.
 15389
 15390     IF DCT-RETURN-CODE = 'E1'
 15391         MOVE ER-0974            TO EMI-ERROR
 15392         MOVE -1                 TO MAINTL
 15393         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15394         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15395         GO TO 8110-SEND-DATA.
 15396
 15397     IF DCT-RETURN-CODE = 'E2'
 15398         MOVE ER-0975            TO EMI-ERROR
 15399         MOVE -1                 TO MAINTL
 15400         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15401         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15402         GO TO 8110-SEND-DATA.
 15403
 15404     IF DCT-RETURN-CODE NOT = 'OK'
 15405         MOVE ER-0949            TO EMI-ERROR
 15406         MOVE -1                 TO MAINTL
 15407         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15408         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15409         GO TO 8110-SEND-DATA.
 15410
 15411 8000-CONT.
 15412
 15413     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 15414     MOVE 'CS'                   TO DM-RECORD-TYPE.
 15415     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 15416     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 15417     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 15418     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 15419     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 15420     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 15421
 15422     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 15423     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 15424     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 15425     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 15426     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 15427
 15428     IF STATUSI = 'OPEN' OR 'O'
 15429         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 15430      ELSE
 15431         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 15432
 15433     IF STATUSI = 'OPEN' OR 'O'
 15434        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 293
* EL131.cbl
 15435         MOVE '1'                TO DM-CLAIM-STATUS
 15436      ELSE
 15437         MOVE '2'                TO DM-CLAIM-STATUS.
 15438
 15439     IF STATUSI = 'CLOSED' OR 'C'
 15440        IF NOT FINAL-PAID
 15441         MOVE '3'                TO DM-CLAIM-STATUS
 15442      ELSE
 15443         MOVE '4'                TO DM-CLAIM-STATUS.
 15444
 15445     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 15446
 15447
 15448* EXEC CICS LINK
 15449*        PROGRAM    ('DLO025')
 15450*        COMMAREA   (DMO-COMMUNICATION-AREA)
 15451*        LENGTH     (WS-DMO-LENGTH)
 15452*    END-EXEC.
 15453     MOVE 'DLO025' TO DFHEIV1
 15454*    MOVE '."C                   (   #00012953' TO DFHEIV0
 15455     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15457     MOVE X'2020233030303132393533' TO DFHEIV0(25:11)
 15458     CALL 'kxdfhei1' USING DFHEIV0,
 15459           DFHEIV1,
 15460           DMO-COMMUNICATION-AREA,
 15461           WS-DMO-LENGTH,
 15462           DFHEIV99,
 15463           DFHEIV99,
 15464           DFHEIV99,
 15465           DFHEIV99
 15466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15467
 15468
 15469     IF  DM-RETURN-CODE = 'OK'
 15470         GO TO 8000-EXIT.
 15471
 15472     IF DM-RETURN-CODE = '01'
 15473         MOVE ER-8051            TO EMI-ERROR
 15474         MOVE -1                 TO MAINTL
 15475         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15476         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15477         GO TO 8110-SEND-DATA.
 15478
 15479     IF DM-RETURN-CODE = '02'
 15480         MOVE ER-8052            TO EMI-ERROR
 15481         MOVE -1                 TO MAINTL
 15482         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15483         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15484         GO TO 8110-SEND-DATA.
 15485
 15486     IF DM-RETURN-CODE = '03'
 15487         MOVE ER-8053            TO EMI-ERROR
 15488         MOVE -1                 TO MAINTL
 15489         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15490         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15491         GO TO 8110-SEND-DATA.
 15492
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 294
* EL131.cbl
 15493     IF DM-RETURN-CODE = '04'
 15494         MOVE ER-8054            TO EMI-ERROR
 15495         MOVE -1                 TO MAINTL
 15496         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15497         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15498         GO TO 8110-SEND-DATA.
 15499
 15500     IF DM-RETURN-CODE = '05'
 15501         MOVE ER-8055            TO EMI-ERROR
 15502         MOVE -1                 TO MAINTL
 15503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15504         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15505         GO TO 8110-SEND-DATA.
 15506
 15507     IF DM-RETURN-CODE = '06'
 15508         MOVE ER-8056            TO EMI-ERROR
 15509         MOVE -1                 TO MAINTL
 15510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15511         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15512         GO TO 8110-SEND-DATA.
 15513
 15514     IF DM-RETURN-CODE = '07'
 15515         MOVE ER-8057            TO EMI-ERROR
 15516         MOVE -1                 TO MAINTL
 15517         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15518         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15519         GO TO 8110-SEND-DATA.
 15520
 15521     IF DM-RETURN-CODE = '08'
 15522         MOVE ER-8058            TO EMI-ERROR
 15523         MOVE -1                 TO MAINTL
 15524         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15525         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15526         GO TO 8110-SEND-DATA.
 15527
 15528     IF DM-RETURN-CODE = '09'
 15529         MOVE ER-8059            TO EMI-ERROR
 15530         MOVE -1                 TO MAINTL
 15531         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15532         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15533         GO TO 8110-SEND-DATA.
 15534
 15535     IF DM-RETURN-CODE = '10'
 15536         MOVE ER-8060            TO EMI-ERROR
 15537         MOVE -1                 TO MAINTL
 15538         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15539         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15540         GO TO 8110-SEND-DATA.
 15541
 15542     IF DM-RETURN-CODE = '11'
 15543         MOVE ER-8061            TO EMI-ERROR
 15544         MOVE -1                 TO MAINTL
 15545         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15546         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15547         GO TO 8110-SEND-DATA.
 15548
 15549     IF DM-RETURN-CODE = '12'
 15550         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 295
* EL131.cbl
 15551         MOVE -1                 TO MAINTL
 15552         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15553         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15554         GO TO 8110-SEND-DATA.
 15555
 15556     IF DM-RETURN-CODE = '13'
 15557         MOVE ER-8063            TO EMI-ERROR
 15558         MOVE -1                 TO MAINTL
 15559         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15560         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15561         GO TO 8110-SEND-DATA.
 15562
 15563     IF DM-RETURN-CODE = '14'
 15564         MOVE ER-8064            TO EMI-ERROR
 15565         MOVE -1                 TO MAINTL
 15566         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15567         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15568         GO TO 8110-SEND-DATA.
 15569
 15570     IF DM-RETURN-CODE = '15'
 15571         MOVE ER-8065            TO EMI-ERROR
 15572         MOVE -1                 TO MAINTL
 15573         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15574         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15575         GO TO 8110-SEND-DATA.
 15576
 15577     IF DM-RETURN-CODE = '16'
 15578         MOVE ER-8154            TO EMI-ERROR
 15579         MOVE -1                 TO MAINTL
 15580         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15581         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15582         GO TO 8110-SEND-DATA.
 15583
 15584     IF DM-RETURN-CODE = '17'
 15585         MOVE ER-8155            TO EMI-ERROR
 15586         MOVE -1                 TO MAINTL
 15587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15588         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15589         GO TO 8110-SEND-DATA.
 15590
 15591     IF DM-RETURN-CODE = 'N1'
 15592         MOVE ER-8152            TO EMI-ERROR
 15593         MOVE -1                 TO MAINTL
 15594         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15595         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15596         GO TO 8110-SEND-DATA.
 15597
 15598     IF DM-RETURN-CODE = 'E1'
 15599         MOVE ER-8153            TO EMI-ERROR
 15600         MOVE -1                 TO MAINTL
 15601         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15602         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15603         GO TO 8110-SEND-DATA.
 15604
 15605     MOVE ER-8066                TO EMI-ERROR.
 15606     MOVE -1                     TO MAINTL.
 15607     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15608     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 296
* EL131.cbl
 15609     GO TO 8110-SEND-DATA.
 15610
 15611 8000-NOTE-NOT-FOUND.
 15612
 15613* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15614*    MOVE '6"R                   !   #00013102' TO DFHEIV0
 15615     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15617     MOVE X'2020233030303133313032' TO DFHEIV0(25:11)
 15618     CALL 'kxdfhei1' USING DFHEIV0
 15619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15620
 15621     MOVE ER-0954                TO EMI-ERROR.
 15622     MOVE -1                     TO MAINTL.
 15623     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15624     GO TO 8110-SEND-DATA.
 15625
 15626 8000-EXIT.
 15627     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 297
* EL131.cbl
 15629 8050-FORMAT-LAST-NAME-1ST.
 15630*****************************************************************
 15631*             M O V E   N A M E   R O U T I N E                 *
 15632*                                                               *
 15633*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15634*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15635*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 15636*                                                               *
 15637*                  FIELD               VALUE                    *
 15638*                  -----               -----                    *
 15639*           W-NAME-LAST    (CL15)      SMITH                    *
 15640*           W-NAME-FIRST   (CL15)      JOHN                     *
 15641*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15642*                                                               *
 15643*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 15644*                SMITH, JOHN ALLEN                              *
 15645*                     OR                                        *
 15646*                SMITH, JOHN A.                                 *
 15647*                                                               *
 15648*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 15649*     COPYBOOK, ELCNWA.                                         *
 15650*****************************************************************.
 15651
 15652     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15653     MOVE ZERO                   TO WS-NAME-SW.
 15654     SET NWA-INDEX               TO +1.
 15655
 15656     IF W-NAME-LAST   = SPACES  AND
 15657        W-NAME-MIDDLE = SPACES
 15658          MOVE +1                TO WS-NAME-SW.
 15659
 15660     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15661     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15662
 15663     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15664     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15665
 15666     SET NWA-INDEX UP BY +1.
 15667
 15668     IF W-NAME-MIDDLE NOT = SPACES
 15669         IF W-NAME-MIDDLE-2 = SPACES
 15670             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15671             SET NWA-INDEX UP BY +1
 15672             MOVE '.'            TO WS-NW (NWA-INDEX)
 15673             SET NWA-INDEX UP BY +2
 15674         ELSE
 15675             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15676             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15677
 15678 8050-EXIT.
 15679     EXIT.
 15680
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 298
* EL131.cbl
 15682 8060-MOVE-NAME.
 15683     IF WS-NAME-SW GREATER THAN +1
 15684         GO TO 8060-EXIT.
 15685
 15686     IF WS-NAME-WORK2 = SPACES
 15687         GO TO 8060-EXIT.
 15688
 15689     SET NWA-INDEX2            TO +1.
 15690     SET NWA-INDEX3            TO +2.
 15691
 15692 8060-MOVE-NAME-CYCLE.
 15693     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15694
 15695     IF NWA-INDEX LESS THAN +30
 15696         SET NWA-INDEX UP BY +1
 15697     ELSE
 15698         ADD +2 TO  WS-NAME-SW
 15699         GO TO 8060-EXIT.
 15700
 15701     IF NWA-INDEX2 LESS THAN +20
 15702         SET NWA-INDEX3 UP BY +1
 15703         SET NWA-INDEX2 UP BY +1.
 15704
 15705     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 15706        WS-NW2 (NWA-INDEX3) = SPACES
 15707         IF WS-NAME-SW = ZERO
 15708             MOVE ','            TO WS-NW (NWA-INDEX)
 15709             SET NWA-INDEX UP BY +2
 15710             MOVE +1             TO WS-NAME-SW
 15711             GO TO 8060-EXIT
 15712         ELSE
 15713             GO TO 8060-EXIT.
 15714
 15715     GO TO 8060-MOVE-NAME-CYCLE.
 15716
 15717 8060-EXIT.
 15718     EXIT.
 15719
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 299
* EL131.cbl
 15721
 15722 8070-UNLOCK-CLAIM-MSTR.
 15723
 15724* EXEC CICS UNLOCK
 15725*        DATASET   (CLMS-FILE-ID)
 15726*    END-EXEC.
 15727*    MOVE '&*                    #   #00013205' TO DFHEIV0
 15728     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15729     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15730     MOVE X'2020233030303133323035' TO DFHEIV0(25:11)
 15731     CALL 'kxdfhei1' USING DFHEIV0,
 15732           CLMS-FILE-ID,
 15733           DFHEIV99
 15734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15735
 15736
 15737 8070-EXIT.
 15738      EXIT.
 15739
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 300
* EL131.cbl
 15741 8100-SEND-MAP.
 15742     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15743
 15744     IF NOT PI-NO-CARRIER-SECURITY
 15745        MOVE AL-SANOF            TO CERTCARA.
 15746     IF NOT PI-NO-ACCOUNT-SECURITY
 15747        MOVE AL-SANOF            TO CERTACTA.
 15748
 15749     IF PI-PROCESSOR-ID = 'LGXX'
 15750        MOVE AL-UANON            TO CCNOA.
 15751
 15752     IF PI-COMPANY-ID = 'DMD'
 15753        NEXT SENTENCE
 15754     ELSE
 15755        MOVE AL-SADOF            TO PFKEY6A.
 15756
 15757     IF PI-USES-PAID-TO
 15758        MOVE 'PAID TO  :' TO PTHRHDGO.
 15759
 15760
 15761* EXEC CICS SEND
 15762*         MAP     ('EL131A')
 15763*         MAPSET  ('EL131S')
 15764*         ERASE
 15765*         FREEKB
 15766*         CURSOR
 15767*    END-EXEC.
 15768     MOVE 'EL131A' TO DFHEIV1
 15769     MOVE -1
 15770       TO DFHEIV11
 15771     MOVE 'EL131S' TO DFHEIV2
 15772*    MOVE '8$     CT  E F  H     ,   #00013232' TO DFHEIV0
 15773     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15774     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15775     MOVE X'2020233030303133323332' TO DFHEIV0(25:11)
 15776     CALL 'kxdfhei1' USING DFHEIV0,
 15777           DFHEIV1,
 15778           EL131AO,
 15779           DFHEIV99,
 15780           DFHEIV2,
 15781           DFHEIV99,
 15782           DFHEIV99,
 15783           DFHEIV99,
 15784           DFHEIV11,
 15785           DFHEIV99,
 15786           DFHEIV99,
 15787           DFHEIV99
 15788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15789
 15790
 15791     GO TO 9000-RETURN-TRANS.
 15792
 15793 8110-SEND-DATA.
 15794     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15795
 15796     IF PI-USES-PAID-TO
 15797        MOVE 'PAID TO  :' TO PTHRHDGO.
 15798
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 301
* EL131.cbl
 15799     IF PI-PROCESSOR-ID = 'LGXX'
 15800        MOVE AL-UANON            TO CCNOA.
 15801
 15802     IF PI-COMPANY-ID = 'DMD'
 15803        NEXT SENTENCE
 15804     ELSE
 15805        MOVE AL-SADOF            TO PFKEY6A.
 15806
 15807
 15808* EXEC CICS SEND
 15809*         MAP      ('EL131A')
 15810*         MAPSET   ('EL131S')
 15811*         DATAONLY
 15812*         FREEKB
 15813*         CURSOR
 15814*    END-EXEC.
 15815     MOVE 'EL131A' TO DFHEIV1
 15816     MOVE -1
 15817       TO DFHEIV11
 15818     MOVE 'EL131S' TO DFHEIV2
 15819*    MOVE '8$D    CT    F  H     ,   #00013256' TO DFHEIV0
 15820     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15821     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15822     MOVE X'2020233030303133323536' TO DFHEIV0(25:11)
 15823     CALL 'kxdfhei1' USING DFHEIV0,
 15824           DFHEIV1,
 15825           EL131AO,
 15826           DFHEIV99,
 15827           DFHEIV2,
 15828           DFHEIV99,
 15829           DFHEIV99,
 15830           DFHEIV99,
 15831           DFHEIV11,
 15832           DFHEIV99,
 15833           DFHEIV99,
 15834           DFHEIV99
 15835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15836
 15837
 15838     GO TO 9000-RETURN-TRANS.
 15839
 15840 8120-FORMAT-TIME-DATE.
 15841     perform 8140-check-for-prev-errors
 15842                                 thru 8140-exit
 15843     IF SKIP-ATTRIBUTE = 'Y'
 15844        MOVE SPACES              TO SKIP-ATTRIBUTE
 15845        MOVE ER-0598             TO EMI-ERROR
 15846        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15847        GO TO 8125-SKIP-ATTRIBUTE.
 15848
 15849*     IF PI-COMPANY-ID = 'DMD'
 15850      IF PI-PROCESSOR-ID <> 'EMER'
 15851         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 15852                                    CERTCARA  CERTGRPA CERTA SUFXA
 15853
 15854     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 15855                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 15856                                    JNTINITA  JNTAGEA   APRA
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 302
* EL131.cbl
 15857                                    LCVCDA    LCVOTRMA  LCVRTRMA
 15858                                    LCVBENEA  LCVFORMA  LCVCNDTA
 15859                                    LCVEXITA  LCVSTATA  LCVKINDA
 15860                                    ACVCDA    ACVOTRMA  ACVRTRMA
 15861                                    ACVBENEA  ACVFORMA  ACVCNDTA
 15862                                    ACVEXITA  ACVSTATA  ACVKINDA
 15863                                    PMTFREQA  INDGRPA   PREMTYPA
 15864                                    REINCDA   LCVRATEA  ACVRATEA
 15865                                    ADDONDTA.
 15866
 15867*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 15868*       IF PI-COMPANY-ID = 'DMD'
 15869*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 15870*                                   SUFXA
 15871*                                   PDAMTA    NODAYSA   NOPMTSA
 15872*                                   INCA      OCCA
 15873*          IF NOT SYSTEM-MODIFY-CAP
 15874*              MOVE AL-SANOF         TO PDTHRUA.
 15875
 15876     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 15877         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15878
 15879 8125-SKIP-ATTRIBUTE.
 15880
 15881     MOVE SAVE-DATE              TO DATEO.
 15882
 15883* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 15884*    END-EXEC
 15885*    MOVE '0"A                   "   #00013308' TO DFHEIV0
 15886     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 15887     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 15888     MOVE X'2020233030303133333038' TO DFHEIV0(25:11)
 15889     CALL 'kxdfhei1' USING DFHEIV0,
 15890           LCP-CICS-TIME
 15891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15892
 15893* EXEC CICS FORMATTIME
 15894*              ABSTIME(LCP-CICS-TIME)
 15895*              TIME(LCP-TIME-OF-DAY-XX)
 15896*    END-EXEC
 15897*    MOVE 'j$(     (             #   #00013310' TO DFHEIV0
 15898     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 15899     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15900     MOVE X'2020233030303133333130' TO DFHEIV0(25:11)
 15901     CALL 'kxdfhei1' USING DFHEIV0,
 15902           LCP-CICS-TIME,
 15903           LCP-TIME-OF-DAY-XX
 15904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15905     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 15906     MOVE UN-HOURS               TO FOR-HOURS.
 15907     MOVE UN-MINUTES             TO FOR-MINUTES.
 15908     MOVE TIME-OUT               TO TIMEO.
 15909     MOVE PI-COMPANY-ID          TO COMPO.
 15910     MOVE PI-PROCESSOR-ID        TO USERIDO.
 15911     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 15912     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15913     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 15914     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 303
* EL131.cbl
 15915
 15916 8130-EXIT.
 15917     EXIT.
 15918
 15919 8140-check-for-prev-errors.
 15920
 15921     MOVE PI-COMPANY-CD          TO trlr-company-cd
 15922     MOVE PI-CARRIER             TO trlr-carrier
 15923     MOVE PI-CLAIM-NO            TO trlr-claim-no
 15924     MOVE PI-CERT-NO             TO trlr-cert-no
 15925     MOVE +95                    TO TRLR-SEQ-NO
 15926
 15927
 15928* EXEC CICS READ
 15929*       DATASET  ('ELTRLR')
 15930*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15931*       RIDFLD   (TRLR-KEY)
 15932*       RESP     (WS-RESPONSE)
 15933*    END-EXEC
 15934     MOVE 'ELTRLR' TO DFHEIV1
 15935*    MOVE '&"S        E          (  N#00013336' TO DFHEIV0
 15936     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15937     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15938     MOVE X'204E233030303133333336' TO DFHEIV0(25:11)
 15939     CALL 'kxdfhei1' USING DFHEIV0,
 15940           DFHEIV1,
 15941           DFHEIV20,
 15942           DFHEIV99,
 15943           TRLR-KEY,
 15944           DFHEIV99,
 15945           DFHEIV99,
 15946           DFHEIV99
 15947     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15948         DFHEIV20
 15949     MOVE EIBRESP  TO WS-RESPONSE
 15950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15951
 15952     if ws-resp-normal
 15953        perform varying s1 from +1 by +1 until
 15954           at-note-error-no (s1) = spaces
 15955           if at-note-error-no (s1) = '1652'
 15956              continue
 15957           else
 15958              move at-note-error-no (s1)
 15959                                 to emi-error
 15960              move -1 to maintl
 15961              if at-note-error-no (s1) = '1653'
 15962                 evaluate true
 15963                    when pi-claim-type = 'L'
 15964                       move '  LF  '
 15965                        to emi-claim-type
 15966                    when pi-claim-type = 'I'
 15967                       move '  IU  '
 15968                        to emi-claim-type
 15969                    when other
 15970                       move '  AH  '
 15971                        to emi-claim-type
 15972                 end-evaluate
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 304
* EL131.cbl
 15973              end-if
 15974              PERFORM 9900-ERROR-FORMAT
 15975                                 THRU 9900-EXIT
 15976           end-if
 15977*          if at-note-error-no (s1) = '1653'
 15978*             perform varying emi-sub from 1 by 1 until
 15979*                emi-sub > 3
 15980*                if emi-error-number (emi-sub) = '1653'
 15981*                   evaluate true
 15982*                      when pi-claim-type = 'L'
 15983*                         move '  LF  '
 15984*                          to emi-claim-type
 15985*                      when pi-claim-type = 'I'
 15986*                         move '  IU  '
 15987*                          to emi-claim-type
 15988*                      when other
 15989*                         move '  AH  '
 15990*                          to emi-claim-type
 15991*                   end-evaluate
 15992*                end-if
 15993*             end-perform
 15994*          end-if
 15995        end-perform
 15996     else
 15997        display ' resp not normal ' ws-response ' '
 15998        trlr-key (2:19)
 15999     end-if
 16000
 16001     .
 16002 8140-exit.
 16003     exit.
 16004 8150-ENTERED-CLAIM-NOTFOUND.
 16005
 16006     MOVE ER-0204                TO EMI-ERROR.
 16007     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16008     MOVE -1                     TO MAINTL.
 16009     GO TO 8100-SEND-MAP.
 16010
 16011 8200-RETURN-PRIOR.
 16012     MOVE SPACE                  TO PI-RETURN-CD-1.
 16013     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 16014     GO TO 9200-XCTL.
 16015
 16016 8300-GET-HELP.
 16017     MOVE XCTL-EL010             TO CALL-PGM.
 16018     GO TO 9200-XCTL.
 16019
 16020 8400-RETURN-MASTER.
 16021     MOVE SPACE                  TO PI-RETURN-CD-1.
 16022     MOVE XCTL-EL126             TO CALL-PGM.
 16023     GO TO 9200-XCTL.
 16024
 16025 8500-TRLR-MNT.
 16026     IF PI-RETURN-CD-1 = 'X'
 16027         MOVE ER-0311            TO EMI-ERROR
 16028         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16029         MOVE -1                 TO MAINTL
 16030         GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 305
* EL131.cbl
 16031
 16032
 16033* EXEC CICS WRITEQ TS
 16034*         QUEUE     (PI-KEY)
 16035*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16036*         LENGTH    (PI-COMM-LENGTH)
 16037*    END-EXEC.
 16038*    MOVE '*"                    ''   #00013423' TO DFHEIV0
 16039     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16040     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16041     MOVE X'2020233030303133343233' TO DFHEIV0(25:11)
 16042     CALL 'kxdfhei1' USING DFHEIV0,
 16043           PI-KEY,
 16044           PROGRAM-INTERFACE-BLOCK,
 16045           PI-COMM-LENGTH,
 16046           DFHEIV99,
 16047           DFHEIV99,
 16048           DFHEIV99
 16049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16050
 16051
 16052     MOVE XCTL-EL142             TO CALL-PGM.
 16053     GO TO 9200-XCTL.
 16054
 16055 8600-ADDR-MNT.
 16056     IF PI-RETURN-CD-1 = 'X'
 16057         MOVE ER-0311            TO EMI-ERROR
 16058         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16059         MOVE -1                 TO MAINTL
 16060         GO TO 8110-SEND-DATA.
 16061
 16062
 16063* EXEC CICS WRITEQ TS
 16064*         QUEUE     (PI-KEY)
 16065*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16066*         LENGTH    (PI-COMM-LENGTH)
 16067*    END-EXEC.
 16068*    MOVE '*"                    ''   #00013439' TO DFHEIV0
 16069     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16070     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16071     MOVE X'2020233030303133343339' TO DFHEIV0(25:11)
 16072     CALL 'kxdfhei1' USING DFHEIV0,
 16073           PI-KEY,
 16074           PROGRAM-INTERFACE-BLOCK,
 16075           PI-COMM-LENGTH,
 16076           DFHEIV99,
 16077           DFHEIV99,
 16078           DFHEIV99
 16079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16080
 16081
 16082     MOVE XCTL-EL141             TO CALL-PGM.
 16083     GO TO 9200-XCTL.
 16084
 16085 8700-CERT-MNT.
 16086     IF PI-RETURN-CD-1 = 'X'
 16087         MOVE ER-7690            TO EMI-ERROR
 16088         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 306
* EL131.cbl
 16089         MOVE -1                 TO MAINTL
 16090         GO TO 8110-SEND-DATA.
 16091
 16092
 16093* EXEC CICS WRITEQ TS
 16094*         QUEUE     (PI-KEY)
 16095*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16096*         LENGTH    (PI-COMM-LENGTH)
 16097*    END-EXEC.
 16098*    MOVE '*"                    ''   #00013455' TO DFHEIV0
 16099     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16100     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16101     MOVE X'2020233030303133343535' TO DFHEIV0(25:11)
 16102     CALL 'kxdfhei1' USING DFHEIV0,
 16103           PI-KEY,
 16104           PROGRAM-INTERFACE-BLOCK,
 16105           PI-COMM-LENGTH,
 16106           DFHEIV99,
 16107           DFHEIV99,
 16108           DFHEIV99
 16109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16110
 16111
 16112     MOVE XCTL-EL1273            TO CALL-PGM.
 16113     GO TO 9200-XCTL.
 16114
 16115 8725-BENEFICIARY-MNT.
 16116     IF PI-RETURN-CD-1 = 'X'
 16117         MOVE ER-0311            TO EMI-ERROR
 16118         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16119         MOVE -1                 TO MAINTL
 16120         GO TO 8110-SEND-DATA.
 16121
 16122
 16123* EXEC CICS WRITEQ TS
 16124*         QUEUE     (PI-KEY)
 16125*         FROM      (EL131AI)
 16126*         LENGTH    (MAP-LENGTH)
 16127*    END-EXEC.
 16128*    MOVE '*"                    ''   #00013471' TO DFHEIV0
 16129     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16130     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16131     MOVE X'2020233030303133343731' TO DFHEIV0(25:11)
 16132     CALL 'kxdfhei1' USING DFHEIV0,
 16133           PI-KEY,
 16134           EL131AI,
 16135           MAP-LENGTH,
 16136           DFHEIV99,
 16137           DFHEIV99,
 16138           DFHEIV99
 16139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16140
 16141
 16142
 16143* EXEC CICS WRITEQ TS
 16144*         QUEUE     (PI-KEY)
 16145*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16146*         LENGTH    (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 307
* EL131.cbl
 16147*    END-EXEC.
 16148*    MOVE '*"                    ''   #00013477' TO DFHEIV0
 16149     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16150     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16151     MOVE X'2020233030303133343737' TO DFHEIV0(25:11)
 16152     CALL 'kxdfhei1' USING DFHEIV0,
 16153           PI-KEY,
 16154           PROGRAM-INTERFACE-BLOCK,
 16155           PI-COMM-LENGTH,
 16156           DFHEIV99,
 16157           DFHEIV99,
 16158           DFHEIV99
 16159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16160
 16161
 16162     MOVE XCTL-EL114             TO CALL-PGM.
 16163     GO TO 9200-XCTL.
 16164
 16165 8750-DMD-CLM-FIX.
 16166
 16167* EXEC CICS WRITEQ TS
 16168*         QUEUE     (PI-KEY)
 16169*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16170*         LENGTH    (PI-COMM-LENGTH)
 16171*    END-EXEC.
 16172*    MOVE '*"                    ''   #00013487' TO DFHEIV0
 16173     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16174     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16175     MOVE X'2020233030303133343837' TO DFHEIV0(25:11)
 16176     CALL 'kxdfhei1' USING DFHEIV0,
 16177           PI-KEY,
 16178           PROGRAM-INTERFACE-BLOCK,
 16179           PI-COMM-LENGTH,
 16180           DFHEIV99,
 16181           DFHEIV99,
 16182           DFHEIV99
 16183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16184
 16185
 16186     MOVE XCTL-EL400DMD          TO CALL-PGM.
 16187     GO TO 9200-XCTL.
 16188
 16189 8800-UNAUTHORIZED-ACCESS.
 16190     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16191     GO TO 8990-SEND-TEXT.
 16192
 16193 8810-PF23-ENTERED.
 16194     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 16195     MOVE XCTL-EL005             TO CALL-PGM.
 16196     GO TO 9200-XCTL.
 16197
 16198 8820-XCTL-ERROR.
 16199
 16200* EXEC CICS HANDLE CONDITION
 16201*        PGMIDERR (8990-SEND-TEXT)
 16202*    END-EXEC.
 16203*    MOVE '"$L                   ! H #00013506' TO DFHEIV0
 16204     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 308
* EL131.cbl
 16205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16206     MOVE X'4820233030303133353036' TO DFHEIV0(25:11)
 16207     CALL 'kxdfhei1' USING DFHEIV0
 16208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16209
 16210
 16211     MOVE SPACE                 TO PI-ENTRY-CD-1.
 16212     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 16213     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 16214     MOVE XCTL-EL005            TO CALL-PGM.
 16215     GO TO 9200-XCTL.
 16216
 16217 8990-SEND-TEXT.
 16218
 16219* EXEC CICS SEND TEXT
 16220*         FROM      (LOGOFF-TEXT)
 16221*         LENGTH    (LOGOFF-LENGTH)
 16222*         ERASE
 16223*         FREEKB
 16224*    END-EXEC.
 16225*    MOVE '8&      T  E F  H   F -   #00013517' TO DFHEIV0
 16226     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16227     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16228     MOVE X'2020233030303133353137' TO DFHEIV0(25:11)
 16229     CALL 'kxdfhei1' USING DFHEIV0,
 16230           LOGOFF-TEXT,
 16231           LOGOFF-LENGTH,
 16232           DFHEIV99,
 16233           DFHEIV99,
 16234           DFHEIV99,
 16235           DFHEIV99,
 16236           DFHEIV99,
 16237           DFHEIV99,
 16238           DFHEIV99,
 16239           DFHEIV99,
 16240           DFHEIV99,
 16241           DFHEIV99
 16242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16243
 16244
 16245     GO TO 9100-RETURN-CICS.
 16246
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 309
* EL131.cbl
 16248 9000-RETURN-TRANS.
 16249
 16250* EXEC CICS RETURN
 16251*         TRANSID   (TRANS-ID)
 16252*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16253*         LENGTH    (PI-COMM-LENGTH)
 16254*    END-EXEC.
 16255*    MOVE '.(CT                  ''   #00013528' TO DFHEIV0
 16256     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16257     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16258     MOVE X'2020233030303133353238' TO DFHEIV0(25:11)
 16259     CALL 'kxdfhei1' USING DFHEIV0,
 16260           TRANS-ID,
 16261           PROGRAM-INTERFACE-BLOCK,
 16262           PI-COMM-LENGTH,
 16263           DFHEIV99,
 16264           DFHEIV99,
 16265           DFHEIV99
 16266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16267
 16268
 16269
 16270* GOBACK.
 16271     MOVE '9%                    "   ' TO DFHEIV0
 16272     MOVE 'EL131' TO DFHEIV1
 16273     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16274     GOBACK.
 16275
 16276 9100-RETURN-CICS.
 16277
 16278* EXEC CICS RETURN
 16279*    END-EXEC.
 16280*    MOVE '.(                    ''   #00013537' TO DFHEIV0
 16281     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16282     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16283     MOVE X'2020233030303133353337' TO DFHEIV0(25:11)
 16284     CALL 'kxdfhei1' USING DFHEIV0,
 16285           DFHEIV99,
 16286           DFHEIV99,
 16287           DFHEIV99,
 16288           DFHEIV99,
 16289           DFHEIV99,
 16290           DFHEIV99
 16291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16292
 16293
 16294
 16295* GOBACK.
 16296     MOVE '9%                    "   ' TO DFHEIV0
 16297     MOVE 'EL131' TO DFHEIV1
 16298     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16299     GOBACK.
 16300
 16301 9200-XCTL.
 16302
 16303* EXEC CICS XCTL
 16304*         PROGRAM    (CALL-PGM)
 16305*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 310
* EL131.cbl
 16306*         LENGTH     (PI-COMM-LENGTH)
 16307*    END-EXEC.
 16308*    MOVE '.$C                   %   #00013543' TO DFHEIV0
 16309     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16310     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16311     MOVE X'2020233030303133353433' TO DFHEIV0(25:11)
 16312     CALL 'kxdfhei1' USING DFHEIV0,
 16313           CALL-PGM,
 16314           PROGRAM-INTERFACE-BLOCK,
 16315           PI-COMM-LENGTH,
 16316           DFHEIV99
 16317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16318
 16319
 16320 9700-LINK-RTRM-FILE-ID.
 16321
 16322* EXEC CICS LINK
 16323*        PROGRAM  (RTRM-FILE-ID)
 16324*        COMMAREA (CALCULATION-PASS-AREA)
 16325*        LENGTH   (CP-COMM-LENGTH)
 16326*    END-EXEC.
 16327*    MOVE '."C                   (   #00013550' TO DFHEIV0
 16328     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16329     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16330     MOVE X'2020233030303133353530' TO DFHEIV0(25:11)
 16331     CALL 'kxdfhei1' USING DFHEIV0,
 16332           RTRM-FILE-ID,
 16333           CALCULATION-PASS-AREA,
 16334           CP-COMM-LENGTH,
 16335           DFHEIV99,
 16336           DFHEIV99,
 16337           DFHEIV99,
 16338           DFHEIV99
 16339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16340
 16341
 16342 9700-EXIT.
 16343      EXIT.
 16344
 16345 9800-CONVERT-DATE.
 16346     MOVE SPACES TO DC-ERROR-CODE.
 16347
 16348* EXEC CICS LINK
 16349*         PROGRAM    (DATE-CONV)
 16350*         COMMAREA   (DATE-CONVERSION-DATA)
 16351*         LENGTH     (DC-COMM-LENGTH)
 16352*    END-EXEC.
 16353*    MOVE '."C                   (   #00013561' TO DFHEIV0
 16354     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16355     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16356     MOVE X'2020233030303133353631' TO DFHEIV0(25:11)
 16357     CALL 'kxdfhei1' USING DFHEIV0,
 16358           DATE-CONV,
 16359           DATE-CONVERSION-DATA,
 16360           DC-COMM-LENGTH,
 16361           DFHEIV99,
 16362           DFHEIV99,
 16363           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 311
* EL131.cbl
 16364           DFHEIV99
 16365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16366
 16367
 16368 9800-EXIT.
 16369     EXIT.
 16370
 16371 9900-ERROR-FORMAT.
 16372
 16373* EXEC CICS LINK
 16374*         PROGRAM    (XCTL-EL001)
 16375*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 16376*         LENGTH     (EMI-COMM-LENGTH)
 16377*    END-EXEC.
 16378*    MOVE '."C                   (   #00013571' TO DFHEIV0
 16379     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16381     MOVE X'2020233030303133353731' TO DFHEIV0(25:11)
 16382     CALL 'kxdfhei1' USING DFHEIV0,
 16383           XCTL-EL001,
 16384           ERROR-MESSAGE-INTERFACE-BLOCK,
 16385           EMI-COMM-LENGTH,
 16386           DFHEIV99,
 16387           DFHEIV99,
 16388           DFHEIV99,
 16389           DFHEIV99
 16390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16391
 16392
 16393 9900-EXIT.
 16394     EXIT.
 16395
 16396 9990-ABEND.
 16397     MOVE DFHEIBLK               TO EMI-LINE1.
 16398
 16399* EXEC CICS LINK
 16400*         PROGRAM   (XCTL-EL004)
 16401*         COMMAREA  (EMI-LINE1)
 16402*         LENGTH    (72)
 16403*     END-EXEC.
 16404     MOVE 72
 16405       TO DFHEIV11
 16406*    MOVE '."C                   (   #00013582' TO DFHEIV0
 16407     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16408     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16409     MOVE X'2020233030303133353832' TO DFHEIV0(25:11)
 16410     CALL 'kxdfhei1' USING DFHEIV0,
 16411           XCTL-EL004,
 16412           EMI-LINE1,
 16413           DFHEIV11,
 16414           DFHEIV99,
 16415           DFHEIV99,
 16416           DFHEIV99,
 16417           DFHEIV99
 16418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16419
 16420
 16421     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 312
* EL131.cbl
 16422
 16423     GO TO 8110-SEND-DATA.
 16424
 16425 9995-SECURITY-VIOLATION.
 16426*           COPY ELCSCTP.
 16427******************************************************************
 16428*                                                                *
 16429*                            ELCSCTP                             *
 16430*                            VMOD=2.001                          *
 16431*                                                                *
 16432*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16433******************************************************************
 16434
 16435
 16436     MOVE EIBDATE          TO SM-JUL-DATE.
 16437     MOVE EIBTRMID         TO SM-TERMID.
 16438     MOVE THIS-PGM         TO SM-PGM.
 16439     MOVE EIBTIME          TO TIME-IN.
 16440     MOVE TIME-OUT         TO SM-TIME.
 16441     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16442
 16443
 16444* EXEC CICS LINK
 16445*         PROGRAM  ('EL003')
 16446*         COMMAREA (SECURITY-MESSAGE)
 16447*         LENGTH   (80)
 16448*    END-EXEC.
 16449     MOVE 'EL003' TO DFHEIV1
 16450     MOVE 80
 16451       TO DFHEIV11
 16452*    MOVE '."C                   (   #00013610' TO DFHEIV0
 16453     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16455     MOVE X'2020233030303133363130' TO DFHEIV0(25:11)
 16456     CALL 'kxdfhei1' USING DFHEIV0,
 16457           DFHEIV1,
 16458           SECURITY-MESSAGE,
 16459           DFHEIV11,
 16460           DFHEIV99,
 16461           DFHEIV99,
 16462           DFHEIV99,
 16463           DFHEIV99
 16464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16465
 16466
 16467******************************************************************
 16468
 16469
 16470
 16471 9999-DFHBACK SECTION.
 16472     MOVE '9%                    "   ' TO DFHEIV0
 16473     MOVE 'EL131' TO DFHEIV1
 16474     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16475     GOBACK.
 16476 9999-DFHEXIT.
 16477     IF DFHEIGDJ EQUAL 0001
 16478         NEXT SENTENCE
 16479     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 313
* EL131.cbl
 16480         GO TO 8820-XCTL-ERROR,
 16481               8150-ENTERED-CLAIM-NOTFOUND,
 16482               9990-ABEND
 16483         DEPENDING ON DFHEIGDI
 16484     ELSE IF DFHEIGDJ EQUAL 3
 16485         GO TO 0130-TS-ERROR,
 16486               0130-TS-ERROR
 16487         DEPENDING ON DFHEIGDI
 16488     ELSE IF DFHEIGDJ EQUAL 4
 16489         GO TO 0600-CONTINUE-NAME-UPDATE
 16490         DEPENDING ON DFHEIGDI
 16491     ELSE IF DFHEIGDJ EQUAL 5
 16492         GO TO 1004-BENE-NOT-FOUND
 16493         DEPENDING ON DFHEIGDI
 16494     ELSE IF DFHEIGDJ EQUAL 6
 16495         GO TO 1120-CNTL-NOTFND
 16496         DEPENDING ON DFHEIGDI
 16497     ELSE IF DFHEIGDJ EQUAL 7
 16498         GO TO 1150-NOTOPEN-ERROR,
 16499               1150-EXIT
 16500         DEPENDING ON DFHEIGDI
 16501     ELSE IF DFHEIGDJ EQUAL 8
 16502         GO TO 1490-STATE-NOTFND
 16503         DEPENDING ON DFHEIGDI
 16504     ELSE IF DFHEIGDJ EQUAL 9
 16505         GO TO 1500-CARR-NOTFND
 16506         DEPENDING ON DFHEIGDI
 16507     ELSE IF DFHEIGDJ EQUAL 10
 16508         GO TO 1620-ACCT-NOTFND
 16509         DEPENDING ON DFHEIGDI
 16510     ELSE IF DFHEIGDJ EQUAL 11
 16511         GO TO 2020-EXIT
 16512         DEPENDING ON DFHEIGDI
 16513     ELSE IF DFHEIGDJ EQUAL 12
 16514         GO TO 2030-EXIT
 16515         DEPENDING ON DFHEIGDI
 16516     ELSE IF DFHEIGDJ EQUAL 13
 16517         GO TO 2040-EXIT
 16518         DEPENDING ON DFHEIGDI
 16519     ELSE IF DFHEIGDJ EQUAL 14
 16520         GO TO 2050-EXIT
 16521         DEPENDING ON DFHEIGDI
 16522     ELSE IF DFHEIGDJ EQUAL 15
 16523         GO TO 2060-CERT-NOTFND
 16524         DEPENDING ON DFHEIGDI
 16525     ELSE IF DFHEIGDJ EQUAL 16
 16526         GO TO 2060-DUPKEY
 16527         DEPENDING ON DFHEIGDI
 16528     ELSE IF DFHEIGDJ EQUAL 17
 16529         GO TO 2070-NOT-FOUND
 16530         DEPENDING ON DFHEIGDI
 16531     ELSE IF DFHEIGDJ EQUAL 18
 16532         GO TO 2070-EXIT
 16533         DEPENDING ON DFHEIGDI
 16534     ELSE IF DFHEIGDJ EQUAL 19
 16535         GO TO 2080-EXIT
 16536         DEPENDING ON DFHEIGDI
 16537     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 314
* EL131.cbl
 16538         GO TO 2400-TRLR-NOTFND,
 16539               2410-EXIT
 16540         DEPENDING ON DFHEIGDI
 16541     ELSE IF DFHEIGDJ EQUAL 21
 16542         GO TO 2425-NINETY-NOTFND,
 16543               2425-NINETY-NOTFND
 16544         DEPENDING ON DFHEIGDI
 16545     ELSE IF DFHEIGDJ EQUAL 22
 16546         GO TO 2430-EXIT,
 16547               2440-EXIT
 16548         DEPENDING ON DFHEIGDI
 16549     ELSE IF DFHEIGDJ EQUAL 23
 16550         GO TO 2440-EXIT
 16551         DEPENDING ON DFHEIGDI
 16552     ELSE IF DFHEIGDJ EQUAL 24
 16553         GO TO 2460-EXIT
 16554         DEPENDING ON DFHEIGDI
 16555     ELSE IF DFHEIGDJ EQUAL 25
 16556         GO TO 2475-EXIT
 16557         DEPENDING ON DFHEIGDI
 16558     ELSE IF DFHEIGDJ EQUAL 26
 16559         GO TO 2650-EXIT
 16560         DEPENDING ON DFHEIGDI
 16561     ELSE IF DFHEIGDJ EQUAL 27
 16562         GO TO 2800-EXIT,
 16563               2800-EXIT
 16564         DEPENDING ON DFHEIGDI
 16565     ELSE IF DFHEIGDJ EQUAL 28
 16566         GO TO 3010-DEL-ACTQ,
 16567               3040-EXIT
 16568         DEPENDING ON DFHEIGDI
 16569     ELSE IF DFHEIGDJ EQUAL 29
 16570         GO TO 3010-NO-ACTIVITY,
 16571               3050-EXIT
 16572         DEPENDING ON DFHEIGDI
 16573     ELSE IF DFHEIGDJ EQUAL 30
 16574         GO TO 3010-CERT-NOT-FOUND
 16575         DEPENDING ON DFHEIGDI
 16576     ELSE IF DFHEIGDJ EQUAL 31
 16577         GO TO 3020-EXIT
 16578         DEPENDING ON DFHEIGDI
 16579     ELSE IF DFHEIGDJ EQUAL 32
 16580         GO TO 3060-EXIT,
 16581               3060-EXIT
 16582         DEPENDING ON DFHEIGDI
 16583     ELSE IF DFHEIGDJ EQUAL 33
 16584         GO TO 5000-TRLR-NOT-FOUND
 16585         DEPENDING ON DFHEIGDI
 16586     ELSE IF DFHEIGDJ EQUAL 34
 16587         GO TO 5000-CERT-NOT-FOUND
 16588         DEPENDING ON DFHEIGDI
 16589     ELSE IF DFHEIGDJ EQUAL 35
 16590         GO TO 7630-END-BROWSE
 16591         DEPENDING ON DFHEIGDI
 16592     ELSE IF DFHEIGDJ EQUAL 36
 16593         GO TO 7799-EXIT,
 16594               7799-EXIT
 16595         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 08:58 Page 315
* EL131.cbl
 16596     ELSE IF DFHEIGDJ EQUAL 37
 16597         GO TO 7799-EXIT
 16598         DEPENDING ON DFHEIGDI
 16599     ELSE IF DFHEIGDJ EQUAL 38
 16600         GO TO 7800-NOT-FOUND
 16601         DEPENDING ON DFHEIGDI
 16602     ELSE IF DFHEIGDJ EQUAL 39
 16603         GO TO 8000-NOTE-NOT-FOUND
 16604         DEPENDING ON DFHEIGDI
 16605     ELSE IF DFHEIGDJ EQUAL 40
 16606         GO TO 8990-SEND-TEXT
 16607         DEPENDING ON DFHEIGDI.
 16608     MOVE '9%                    "   ' TO DFHEIV0
 16609     MOVE 'EL131' TO DFHEIV1
 16610     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16611     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13420     Code:       56991
